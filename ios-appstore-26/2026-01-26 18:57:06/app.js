(()=>{function e(r){var o,i=n[r]
return void 0!==i?i.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,e),o.exports)}var t={172:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7691),t)},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.demoteByEngagements=void 0,t.demoteByEngagements=function(e,t){return[...e]}},2305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3745:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2305),t),o(n(3756),t)},7691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3745),t),o(n(230),t)},9100:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4908),t)},6451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LazyProxyFactory=void 0,t.LazyProxyFactory=class{static makeProxy(e,t){const r=new n(t),o={get:(t,n,o)=>{if(void 0===r.createRealObjectIfNeeded(e))return
const i=r.realObject[n]
return"function"==typeof i?i.bind(r.realObject):i},set:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.set(r.realObject,n,o,r.realObject),has:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.has(r.realObject,n),deleteProperty:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.deleteProperty(r.realObject,n),ownKeys:t=>void 0===r.createRealObjectIfNeeded(e)?[]:Reflect.ownKeys(r.realObject),getOwnPropertyDescriptor:(t,n)=>{if(void 0!==r.createRealObjectIfNeeded(e))return Reflect.getOwnPropertyDescriptor(r.realObject,n)},defineProperty:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.defineProperty(r.realObject,n,o),preventExtensions:t=>void 0!==r.createRealObjectIfNeeded(e)&&(Reflect.preventExtensions(r),Reflect.preventExtensions(r.realObject)),isExtensible:t=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.isExtensible(r.realObject),getPrototypeOf:t=>void 0===r.createRealObjectIfNeeded(e)?null:Reflect.getPrototypeOf(r.realObject),setPrototypeOf:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.setPrototypeOf(r.realObject,n)}
return new Proxy(r,o)}}
class n{constructor(e){this.lazyProvider=e}createRealObjectIfNeeded(e){return void 0===this.realObject&&(this.realObject=this.lazyProvider.lazyDependencyFor(e)),this.realObject}}},4908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.ObjectGraph=void 0
const r=n(2450)
t.ObjectGraph=class{constructor(e){this._members={},this.name=e}adding(e,t){const n=this.clone()
return n._members[e.name]=t,n}removing(e){const t=this.clone()
return delete t._members[e.name],t}optional(e){return this._members[e.name]}required(e){const t=this._members[e.name]
if((0,r.isNothing)(t)){const t=Object.keys(this._members).sort().join(", ")
throw new Error(`No member with type ${e.name} found in ${this.name}. Candidates ${t}`)}return t}clone(){const e=new(0,this.constructor)(this.name)
for(const[t,n]of Object.entries(this._members))e._members[t]=n
return e}},t.inject=function(e,t){return t.required(e)}},9089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseActionProvider=void 0
const r=n(2450)
t.isBaseActionProvider=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.actionFor)}},129:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9089),t)},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntentDispatcher=void 0
const r=n(2450),o=n(4395),i=n(3907),s=n(1222)
t.IntentDispatcher=class{constructor(){this.dispatchableMap={}}register(e){if((0,r.isNothing)(e.$intentKind))throw new Error("Dispatcher cannot register a controller without an $intentKind")
if(e.$intentKind in this.dispatchableMap)throw new Error(`Dispatcher already has a controller registered for ${e.$intentKind}`)
this.dispatchableMap[e.$intentKind]=e}async dispatch(e,t){if("$static"===e.$kind){const t=Reflect.get(e,"$data")
if((0,r.isNothing)(t))throw new Error("StaticIntent<R> contains no data")
return t}const n=this.dispatchableMap[e.$kind]
if((0,r.isNothing)(n)||!(0,o.isIntentController)(n))throw new Error(`No controller registered to handle ${e.$kind}`)
const a=e.$pageIntentInstrumentation,c=t.optional(s.net)
if((0,r.isSome)(a)&&(0,r.isSome)(c)){const r=new i.ProxiedNetwork(c,a),o=t.adding(s.net,r)
return await n.perform(e,o)}return await n.perform(e,t)}controller(e){return this.dispatchableMap[e.$kind]}get registeredControllers(){return Object.values(this.dispatchableMap)}}},8346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4395),t),o(n(3421),t),o(n(8770),t),o(n(867),t)},4395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIntentController=void 0
const r=n(2450)
t.isIntentController=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.perform)}},867:(e,t)=>{function n(e){return{$kind:"$static",$data:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Continuous=t.makeSidepackedIntent=t.makeStaticContinuousIntentsOf=t.makeStaticIntent=void 0,t.makeStaticIntent=n,t.makeStaticContinuousIntentsOf=function(e){const t=new Array
for(const o of e)t.push(n(r.of(o)))
return t},t.makeSidepackedIntent=function(e,t){return{$kind:"$sidepacked",$initial:e,$intent:t}}
class r{static of(e){return new r(new o(e))}static contentsOf(e){return new r(e)}constructor(e){this.base=e,this.$wrappedField="base"}toJSON(){if(this.base instanceof o)return this.base.toJSON()
throw new TypeError("Continuous was not created with a single element")}async*[Symbol.asyncIterator](){yield*this.base}}t.Continuous=r
class o{constructor(e){this.element=e,this.$wrappedField="element"}toJSON(){return this.element}async*[Symbol.asyncIterator](){yield this.element}}},5881:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(8346),t),o(n(129),t)},5542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(5827),t),o(n(8037),t),o(n(1777),t),o(n(1415),t),o(n(7312),t)},1777:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1077),t),o(n(4172),t)},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueAsNumber=t.valueAsString=t.valueAsBoolean=void 0
const r=n(2450),o=n(4172)
t.valueAsBoolean=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("boolean"==typeof e)return e
if("string"==typeof e){if("true"===e)return!0
if("false"===e)return!1}const i=Boolean(e)
switch(t){case"strict":o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)})
break
case"coercible":if((0,r.isNothing)(i))return o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)}),null}return i},t.valueAsString=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("string"==typeof e)return e
const i="object"==typeof e?null:String(e)
switch(t){case"strict":o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})
break
case"coercible":(0,r.isNothing)(i)&&o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})}return i},t.valueAsNumber=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("number"==typeof e)return e
const i=Number(e)
switch(t){case"strict":o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)})
break
case"coercible":if(isNaN(i))return o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)}),null}return i}},1077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4409),t),o(n(2506),t),o(n(6418),t)},2506:(e,t,n)=>{function r(e){if(Array.isArray(e))return e
switch(typeof e){case"string":{const t=i[e]
if((0,o.isSome)(t))return t
{const t=Object.freeze(e.split("."))
return i[e]=t,t}}case"number":case"symbol":return[e]
default:throw new TypeError(`${e.toString()} is not a KeyPath`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.keyPathContains=t.keyPathEndsWith=t.keyPathStartsWith=t.keyPathsEqual=t.isKeyPathThis=t.thisKeyPath=t.keysOf=void 0
const o=n(2450),i={}
t.keysOf=r,t.thisKeyPath=Object.freeze([]),t.isKeyPathThis=function(e){return Array.isArray(e)&&0===e.length},t.keyPathsEqual=function(e,t){if(e===t)return!0
const n=r(e),o=r(t)
if(n.length!==o.length)return!1
for(let e=0,t=n.length;e<t;e+=1)if(n[e]!==o[e])return!1
return!0},t.keyPathStartsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[0]===t}},t.keyPathEndsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[n.length-1]===t}},t.keyPathContains=function(e,t){return e===t||r(e).includes(t)}},6853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectCursor=void 0
const r=n(2450),o=n(2879),i=n(2506),s=n(7454)
t.ObjectCursor=class{constructor(e){this.values=[e],this.keyPaths=[i.thisKeyPath],this.savedDepths=[]}get currentValue(){return this.values[this.values.length-1]}get currentKeyPath(){return this.keyPaths[this.keyPaths.length-1]}interject(e,t){this.values.push(e),this.keyPaths.push(t)}reuse(e,t=i.thisKeyPath){this.values.length=0,this.values.push(e),this.keyPaths.length=0,this.keyPaths.push(t),this.savedDepths.length=0}moveTo(e){const t=(0,s.traverse)(this.currentValue,e)
return this.values.push(t),this.keyPaths.push(e),t}moveBack(){const e=this.values.length
if(1===e)throw new Error("Cannot move back past the root of a cursor")
const t=this.savedDepths.length
if(t>0&&e<=this.savedDepths[t-1])throw new Error("Cannot move back past the most recent saved state")
this.values.pop(),this.keyPaths.pop()}saveState(){this.savedDepths.push(this.values.length)}restoreState(){const e=this.savedDepths.pop()
if((0,r.isNothing)(e))throw new Error("Calls to restoreState must balance previous calls to saveState")
this.values.length=e,this.keyPaths.length=e}clone(){const e=(0,o.shallowCloneOf)(this)
return e.values=this.values.slice(),e.keyPaths=this.keyPaths.slice(),e.savedDepths=this.savedDepths.slice(),e}}},4409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectReader=void 0
const r=n(2450),o=n(2879),i=n(6418),s=n(2506),a=n(6853),c=n(7454),l=new Map
class u{constructor(e){this._cursor=new a.ObjectCursor(e)}get currentKeyPath(){return this._cursor.currentKeyPath}has(e){return(0,s.keyPathEndsWith)(this._cursor.currentKeyPath,e)||(0,r.isSome)(this.get(e))}select(e,t=!1){return!t&&(0,s.keyPathsEqual)(this._cursor.currentKeyPath,e)||this._cursor.moveTo(e),this}deselect(){return this._cursor.moveBack(),this}saveSelection(){return this._cursor.saveState(),this}restoreSelection(){return this._cursor.restoreState(),this}get(e=s.thisKeyPath){return(0,s.isKeyPathThis)(e)?this._cursor.currentValue:(0,c.traverse)(this._cursor.currentValue,e)}asBoolean(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsBoolean)(this.get(e),t,String(e))}asNumber(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsNumber)(this.get(e),t,String(e))}asString(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsString)(this.get(e),t,String(e))}*[Symbol.iterator](){const e=this.get()
if((0,r.isNothing)(e))return
const t=u._clone(this)
if(Array.isArray(e)){let n=0
for(const r of e)t.saveSelection(),t._cursor.interject(r,n),yield t,t.restoreSelection(),n+=1}else yield t
u._recycle(t)}reduce(e,t){const n=this.get()
if((0,r.isNothing)(n))return e
if(!Array.isArray(n))return t(e,this)
try{let r=e
for(let e=0,o=n.length;e<o;e+=1)this.saveSelection(),this._cursor.interject(n[e],e),r=t(r,this),this.restoreSelection()
return r}catch(e){throw this.restoreSelection(),e}}map(e){return this.reduce(new Array,(t,n)=>(t.push(e(n)),t))}compactMap(e){return this.reduce(new Array,(t,n)=>{const o=e(n)
return(0,r.isSome)(o)&&t.push(o),t})}applyTo(e,...t){this.saveSelection()
try{const n=e(this,...t)
return this.restoreSelection(),n}catch(e){throw this.restoreSelection(),e}}callOn(e,t,...n){this.saveSelection()
try{const r=e.call(t,this,...n)
return this.restoreSelection(),r}catch(e){throw this.restoreSelection(),e}}clone(){const e=(0,o.shallowCloneOf)(this)
return e._cursor=this._cursor.clone(),e}static optimizeIterationUpToDepth(e){for(let t=0;t<e;t+=1)u._recycle(new u(void 0))}static _clone(e){const t=l.get(e.constructor)
if((0,r.isSome)(t)){const n=t.pop()
if((0,r.isSome)(n))return n.onReuseToIterate(e),n}return e.clone()}onReuseToIterate(e){const t=e._cursor
this._cursor.reuse(t.currentValue,t.currentKeyPath)}static _recycle(e){const t=e.constructor,n=l.get(t)
if((0,r.isSome)(n)){if(n.length>=5)return
e.onRecycleForIteration(),n.push(e)}else e.onRecycleForIteration(),l.set(t,[e])}onRecycleForIteration(){this._cursor.reuse(void 0)}}t.ObjectReader=u},7454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverse=void 0
const r=n(2450),o=n(2506)
t.traverse=function(e,t){if("object"!=typeof e)return e
if(!(0,r.isSome)(e))return e
const n=(0,o.keysOf)(t)
switch(n.length){case 0:return e
case 1:return e[n[0]]
default:let t=e
for(const e of n){const n=t[e]
if("object"!=typeof n)return n
if(!(0,r.isSome)(n))return n
t=n}return t}}},4172:(e,t,n)=>{function r(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function o(e,t,n,o){u({type:"badType",expected:t,actual:`${r(n)} (${n})`,objectPath:(0,d.isSome)(o)&&o.length>0?o:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}function i(e){return!(0,d.isNothing)(e)&&(Object.prototype.hasOwnProperty.call(e,"$incidents")||Object.isExtensible(e))}function s(e){f.nameStack.push(e)}function a(){return 0===f.nameStack.length?["<empty stack>"]:f.nameStack.slice(0)}function c(){f.nameStack.length,f.nameStack.pop()}function l(e,t,n){let r,i=null;(0,d.isSome)(n)&&n.length>0&&(i=e,f.suppressedIncidentPaths.push(n))
try{s(e),r=t()}catch(e){throw e.hasThrown||(o("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===i&&f.suppressedIncidentPaths.pop(),c()}return r}function u(e){f.suppressedIncidentPaths.includes(e.objectPath)||f.incidents.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unexpectedNull=t.catchingContext=t.context=t.recordValidationIncidents=t.endContext=t.getContextNames=t.beginContext=t.messageForRecoveryAction=t.isValidatable=t.unexpectedType=t.extendedTypeof=void 0
const d=n(2450)
t.extendedTypeof=r,t.unexpectedType=o,t.isValidatable=i,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format"
case"defaultValue":return"Default value used"
case"ignoredValue":return"Ignored value"
default:return"Unknown"}}
const f={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()}
t.beginContext=s,t.getContextNames=a,t.endContext=c,t.recordValidationIncidents=function(e){i(e)&&(e.$incidents=f.incidents),f.incidents=[],f.nameStack=[],f.suppressedIncidentPaths=[]},t.context=l,t.catchingContext=function(e,t,n){let r=null
try{r=l(e,t)}catch(e){r=null,(0,d.isSome)(n)&&(r=n(e))}return r},t.unexpectedNull=function(e,t,n){u({type:"nullValue",expected:t,actual:"null",objectPath:(0,d.isSome)(n)&&n.length>0?n:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}},3647:(e,t,n)=>{function r(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function o(e,t){return r("back","button",{...e,actionType:"back"},t)}function i(e,t,n){const r=f.MetricsEventType.page
return u({...e,eventType:r,...t},n,r)}function s(e,t,n,r,o,i){const s=f.MetricsEventType.search,a={...o,eventType:s,term:e,targetType:t,actionType:n}
return(0,h.isSome)(r)&&(a.actionUrl=r),u(a,i,s)}function a(e,t,n=4){const r=f.MetricsEventType.impressions
return u({...e,eventType:r,impressionQueue:"data-metrics",eventVersion:n},t,r)}function c(e,t){const n=f.MetricsEventType.media
return u({...e,eventType:n},t,n)}function l(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function u(e,t,n){return{fields:e,includingFields:t.defaultIncludeRequests[n],excludingFields:t.defaultExcludeRequests[n],topic:d(e,t.defaultTopic),shouldFlush:!!(0,h.isSome)(t.shouldFlush)&&t.shouldFlush(e)}}function d(e,t){const n=e.topic
return(0,h.isSome)(n)?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.createMetricsMediaClickData=t.createMetricsMediaData=t.createMetricsImpressionsData=t.createMetricsSearchData=t.createMetricsPageData=t.createMetricsBackClickData=t.createMetricsClickData=t.MediaClickEventBuilder=t.MediaEventBuilder=t.ImpressionsEventBuilder=t.SearchEventBuilder=t.PageEventBuilder=t.BackClickEventBuilder=t.ClickEventBuilder=t.EventBuilder=void 0
const f=n(447),h=n(2450)
class p{constructor(e){this.configuration=e,this.eventFields={}}withEventFields(e){return this.eventFields=e,this}withConfiguration(e){return this.configuration=e,this}withDefaultTopic(e){return this.configuration={...this.configuration,defaultTopic:e},this}withDefaultIncludeRequests(e){return this.configuration={...this.configuration,defaultIncludeRequests:e},this}withDefaultExcludeRequests(e){return this.configuration={...this.configuration,defaultExcludeRequests:e},this}withShouldFlush(e){return this.configuration={...this.configuration,shouldFlush:e},this}}t.EventBuilder=p,t.ClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return r(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.BackClickEventBuilder=class extends p{build(){return o(this.eventFields,this.configuration)}},t.PageEventBuilder=class extends p{constructor(e){super(e),this.timingMetrics={}}withTimingMetrics(e){return this.timingMetrics=e,this}build(){return i(this.eventFields,this.timingMetrics,this.configuration)}},t.SearchEventBuilder=class extends p{constructor(e){super(e.configuration),this.term=e.term,this.targetType=e.targetType,this.actionType=e.actionType,this.actionUrl=null}withTerm(e){return this.term=e,this}withTargetType(e){return this.targetType=e,this}withActionType(e){return this.actionType=e,this}withActionUrl(e){return this.actionUrl=e,this}build(){return s(this.term,this.targetType,this.actionType,this.actionUrl,this.eventFields,this.configuration)}},t.ImpressionsEventBuilder=class extends p{constructor(){super(...arguments),this.impressionsEventVersion=4}withImpressionsEventVersion(e){return this.impressionsEventVersion=e,this}build(){return a(this.eventFields,this.configuration,this.impressionsEventVersion)}},t.MediaEventBuilder=class extends p{build(){return c(this.eventFields,this.configuration)}},t.MediaClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return l(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.createMetricsClickData=r,t.createMetricsBackClickData=o,t.createMetricsPageData=i,t.createMetricsSearchData=s,t.createMetricsImpressionsData=a,t.createMetricsMediaData=c,t.createMetricsMediaClickData=l},4927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cookieValueForKey=t.cookiesOf=void 0
const r=n(2450)
t.cookiesOf=function*(e){if((0,r.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}},t.cookieValueForKey=function(e,t){for(const n of e)if(n.key===t)return n.value
return null}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLinter=void 0
const r=n(4409),o=n(447),i=n(2450),s=n(7771)
t.EventLinter=class{constructor(e){this.options=Object.freeze(e)}get defaultTopic(){return this.options.defaultTopic}applyDeResolutionRules(e,t){const n=new r.ObjectReader(e)
for(const r of t){const t=n.asNumber(r.fieldName)
if((0,i.isNothing)(t))continue
let o=r.magnitude;(0,i.isNothing)(o)&&(o=1048576)
let a=r.significantDigits
if((0,i.isNothing)(a)&&(a=2),o<=0||a<0){e[r.fieldName]=Number.NaN
continue}const c=t/o
e[r.fieldName]=s.reduceSignificantDigits(c,a)}}decorateCommonEventFields(e,t){const n=new r.ObjectReader(e),o=this.options.configuration,s=o.baseFields(t);(0,i.isSome)(s)&&Object.assign(e,s),e.clientBuildType=this.options.environment.buildType,e.resourceRevNum=this.options.environment.jsVersion,e.xpSendMethod="jet-js"
const a=n.asString("pageType"),c=n.asString("pageId")
if((0,i.isSome)(a)&&(0,i.isSome)(c)&&(0,i.isNothing)(e.page)){const n=o.compoundSeparator(t),r=(0,i.isSome)(n)?(0,i.unwrapOptional)(n):"_"
e.page=`${a}${r}${c}`}const l=o.deResolutionRules(t)
this.applyDeResolutionRules(e,l)}decorateMediaEventEvents(e){const t=new r.ObjectReader(e).asNumber("position");(0,i.isSome)(t)&&(e.position=Math.round(t))}lint(e,t={}){const n=new r.ObjectReader(e),s=n.asString("eventType")
this.options.isLoggingEnabled
const a=JSON.parse(JSON.stringify(e)),c=n.asString("topic"),l=(0,i.isSome)(c)?(0,i.unwrapOptional)(c):this.options.defaultTopic
this.decorateCommonEventFields(a,l),s===o.MetricsEventType.media&&this.decorateMediaEventEvents(a)
for(const e of this.options.rules)e.apply(a,t)
return{fields:a}}}},8836:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTimingMetricsBuilderType=t.FetchTimingMetricsBuilder=void 0
const r=n(2450),o=n(900),i=n(2366)
t.FetchTimingMetricsBuilder=class{constructor(){this.metrics=[]}measureParsing(e,t){const n=e.metrics.length>0?[...e.metrics]:[],r=Date.now(),o=t(e),i=Date.now()
return n.length>0&&(n[0].parseStartTime=r,n[0].parseEndTime=i),this.metrics.push(...n),o}measureModelConstruction(e){const t=Date.now(),n=e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}async measureModelConstructionAsync(e){const t=Date.now(),n=await e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}saveModelConstructionTimes(e,t){this.metrics.length>0?(this.metrics[0].modelConstructionStartTime=e,this.metrics[0].modelConstructionEndTime=t):this.metrics.push({modelConstructionStartTime:e,modelConstructionEndTime:t})}decorate(e){if((0,r.isNothing)(e))throw new Error("Cannot decorate null or undefined")
if("object"!=typeof e)throw new Error("View model to decorate must be an object")
if((0,i.isPromise)(e))throw new Error("Cannot decorate a Promise object")
this.metrics.length>0&&(e.$networkPerformance=this.metrics)}},t.fetchTimingMetricsBuilderType=(0,o.makeMetatype)("jet-engine:fetchTimingMetricsBuilder")},8267:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7581),t),o(n(7764),t),o(n(7771),t),o(n(4698),t)},7581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsLocationTracker=void 0
const r=n(4172),o=n(2450),i=n(4698)
class s{constructor(e=0,t=[]){this.rootPosition=e,this.locationStack=t.map(e=>new a(e))}get isEmpty(){return 0===this.locationStack.length}pushLocation(e){this.locationStack.push(new a(e))}popLocation(){var e
return 0===this.locationStack.length?(r.unexpectedType("ignoredValue","non-empty location stack","empty location stack"),null):null===(e=this.locationStack.pop())||void 0===e?void 0:e.location}get currentPosition(){const e=this.lastStackItem
return(0,o.isSome)(e)?e.position:this.rootPosition}setCurrentPosition(e){const t=this.lastStackItem;(0,o.isSome)(t)?t.position=e:this.rootPosition=e}nextPosition(){const e=this.lastStackItem;(0,o.isSome)(e)?e.position+=1:this.rootPosition+=1}get stackItemsToLocations(){return this.locationStack.map(e=>e.location)}get lastStackItem(){const e=this.locationStack.length
return 0===e?null:this.locationStack[e-1]}static locationsByAddingBasicLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildBasicLocation(e,t)),n}static locationsByAddingContentLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildContentLocation(e,t)),n}static pushBasicLocation(e,t){e.locationTracker.pushLocation(s.buildBasicLocation(e,t))}static pushContentLocation(e,t){e.locationTracker.pushLocation(s.buildContentLocation(e,t))}static popLocation(e){return e.locationTracker.popLocation()}static buildBasicLocation(e,t){let n=t;(0,o.isSome)(e.anonymizationOptions)&&(n=e.anonymizationOptions.anonymizationString)
const r={locationPosition:e.locationTracker.currentPosition,locationType:i.targetTypeForMetricsOptions(e),name:n}
return(0,o.isSome)(e.recoMetricsData)&&Object.assign(r,e.recoMetricsData),r}static buildContentLocation(e,t){const n=s.buildBasicLocation(e,t)
if((0,o.isNothing)(e.id))n.idType="sequential",n.id=e.locationTracker.currentPosition.toString()
else{n.idType=i.idTypeForMetricsOptions(e)
let t=e.id;(0,o.isSome)(e.anonymizationOptions)&&(t=e.anonymizationOptions.anonymizationString),n.id=t}return(0,o.isSome)(e.fcKind)&&(n.fcKind=e.fcKind),(0,o.isSome)(e.displayStyle)&&(n.displayStyle=e.displayStyle),n}}t.MetricsLocationTracker=s
class a{constructor(e,t=0){this.location=e,this.position=t}}},7764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSignificantDigits=void 0,t.reduceSignificantDigits=function(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}},4698:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchTermFromRefURL=t.extractSiriRefAppFromRefURL=t.idTypeForMetricsOptions=t.targetTypeForMetricsOptions=void 0
const r=n(2450),o=n(1974)
t.targetTypeForMetricsOptions=function(e){let t=e.targetType
return(0,r.isNothing)(t)&&(t="lockup"),t},t.idTypeForMetricsOptions=function(e){let t=e.idType
return(0,r.isNothing)(t)&&(t="its_id"),t},t.extractSiriRefAppFromRefURL=function(e){const t=new o.URL(e)
if((0,r.isNothing)(t.query))return null
let n=null
for(const e of Object.keys(t.query))if("referrer"===e){"siri"===t.query[e]&&(n="com.apple.siri")
break}return n},t.searchTermFromRefURL=function(e){const t=new o.URL(e),n=t.query
if((0,r.isNothing)(n))return null
const i=n.term,s=t.pathname
return(0,r.isNothing)(i)||(0,r.isNothing)(s)?null:s.endsWith("/search")?i:null}},1415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3647),t),o(n(4927),t),o(n(8535),t),o(n(8836),t),o(n(8267),t),o(n(6094),t)},6094:(e,t,n)=>{function r(e,t){const n=e.optional(a.fetchTimingMetricsBuilderType)
if((0,s.isSome)(n))return e
if(t)throw new Error("Could not find FetchTimingMetricsBuilder in the object graph")
return e.adding(a.fetchTimingMetricsBuilderType,new a.FetchTimingMetricsBuilder)}async function o(e,t,n){const r=(0,i.inject)(a.fetchTimingMetricsBuilderType,t),o=await r.measureModelConstructionAsync(async()=>{const r=n(e,t)
return await Promise.resolve(r)})
if((0,s.isNothing)(o))throw new Error("model builder function returned null or undefined")
return r.decorate(o),o}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndBuildModel=t.requestAndBuildModel=void 0
const i=n(9100),s=n(2450),a=n(8836)
t.requestAndBuildModel=async function(e,t,n,i){const s=r(t,!0),a=await n(e,s)
return await o(a,s,i)},t.parseAndBuildModel=async function(e,t,n,c){const l=r(t,!1),u=(0,i.inject)(a.fetchTimingMetricsBuilderType,l).measureParsing(e,()=>n(e,l))
if((0,s.isNothing)(u))throw new Error("parser function returned null or undefined")
return await o(u,l,c)}},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompoundAction=t.isCompoundAction=void 0,t.isCompoundAction=function(e){return"compoundAction"===(null==e?void 0:e.$kind)},t.makeCompoundAction=function(e,t){return{$kind:"compoundAction",subactions:t,actionMetrics:e}}},9120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyAction=t.isEmptyAction=void 0,t.isEmptyAction=function(e){return"emptyAction"===(null==e?void 0:e.$kind)},t.makeEmptyAction=function(e){return{$kind:"emptyAction",actionMetrics:e}}},9634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4789),t),o(n(573),t),o(n(9120),t),o(n(9634),t),o(n(5599),t),o(n(2170),t),o(n(6158),t),o(n(9400),t),o(n(4362),t)},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeArtworkURLTemplate=void 0
const r=n(4172),o=n(2450),i=n(1974),s=new RegExp("^({w}|[0-9]+(?:.[0-9]*)?)x({h}|[0-9]+(?:.[0-9]*)?)({c}|[a-z]{2}).({f}|[a-z]+)$")
t.makeArtworkURLTemplate=function(e){if(void 0===new i.URL(e).pathname)return r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid URL string",e)}),null
const t=e.substring(e.lastIndexOf("/")+1),n=s.exec(t)
return(0,o.isNothing)(n)||5!==n.length?(r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid artwork URL template ending with {w}x{h}{c}.{f} format",t)}),null):e}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areEqual=t.luminanceFrom=t.dynamicWith=t.named=t.rgbWith=t.htmlWith=t.Color=void 0
const r=n(2450)
t.Color={fromHex:e=>(0,r.isNothing)(e)?null:{$kind:"html",value:e},fromRGB:(e,t,n,r=1)=>({$kind:"rgb",red:e,green:t,blue:n,alpha:r}),named:e=>({$kind:"named",name:e}),dynamicWith:(e,t,n,r)=>({$kind:"dynamic",lightColor:e,lightHighContrastColor:t,darkColor:n,darkHighContrastColor:r}),luminanceFrom:e=>.2126*e.red+.7152*e.green+.0722*e.blue,areEqual(e,n){if((0,r.isNothing)(e))return(0,r.isNothing)(n)
if((0,r.isNothing)(n))return(0,r.isNothing)(e)
const o=e.$kind,i=n.$kind
if("named"===o&&"named"===i){const t=n
return e.name===t.name}if("rgb"===o&&"rgb"===i){const t=e,r=n
return t.red===r.red&&t.green===r.green&&t.blue===r.blue&&t.alpha===r.alpha}if("dynamic"===o&&"dynamic"===i){const r=e,o=n
return t.Color.areEqual(r.lightColor,o.lightColor)&&t.Color.areEqual(r.lightHighContrastColor,o.lightHighContrastColor)&&t.Color.areEqual(r.darkColor,o.darkColor)&&t.Color.areEqual(r.darkHighContrastColor,o.darkHighContrastColor)}return!1}}
const o=t.Color.fromHex
t.htmlWith=o
const i=t.Color.fromRGB
t.rgbWith=i
const s=t.Color.named
t.named=s
const a=t.Color.dynamicWith
t.dynamicWith=a
const c=t.Color.luminanceFrom
t.luminanceFrom=c
const l=t.Color.areEqual
t.areEqual=l},5827:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1235),t),o(n(998),t),o(n(7615),t),o(n(6301),t),o(n(8681),t),o(n(5273),t),o(n(9184),t),o(n(7129),t),o(n(2359),t)},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.menuSeparatorID=void 0,t.menuSeparatorID="com.apple.JetEngine.separator"},5273:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9184:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6882:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportBootstrap=void 0
const r=n(6451)
t.exportBootstrap=function(e){"undefined"!=typeof $exportBootstrap&&$exportBootstrap(t=>(function(e){const t=e.$lazyDependencyNames,n=new Set(null!=t?t:[]),o=globalThis.$lazyGlobalNames,i=new Set(null!=o?o:[]),s=new Set([...n,...i]),a=new Map,c=globalThis.$lazyProvider
for(const e of s)a.set(e,r.LazyProxyFactory.makeProxy(e,c))
for(const t of n)e[t]=a.get(t)
for(const e of i)globalThis[e]=a.get(e)}(t),e(t)))},globalThis.has_lazy_support=!0},8706:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6882),t),o(n(4816),t)},4816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyRuntime=t.Runtime=void 0
const n="function"==typeof exportService
class r{constructor(e,t){this.dispatcher=e,this.objectGraph=t}async dispatch(e){return await this.dispatcher.dispatch(e,this.objectGraph)}}t.Runtime=r,t.LegacyRuntime=class extends r{constructor(e,t,n){super(e,t),this.services=n}serviceWithName(e){return this.services[e]}exportingService(e,t){return n&&function(e,t){exportService(e,t)}(e,t),this.services[e]=t,this}}},1219:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof preprocessor&&(globalThis.preprocessor={PRODUCTION_BUILD:!1,CARRY_BUILD:!1,DEBUG_BUILD:!1,INTERNAL_BUILD:!1}),"undefined"==typeof testContent&&(globalThis.testContent={INCLUDE_TEST_CONTENT:!1}),o(n(1219),t),o(n(8045),t),o(n(3922),t),o(n(9891),t),o(n(1121),t),o(n(9247),t),o(n(3907),t),o(n(6534),t),o(n(5817),t),o(n(3043),t),o(n(5037),t),o(n(5937),t),o(n(1222),t)},9247:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3907:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxiedNetwork=void 0,t.ProxiedNetwork=class{constructor(e,t){this.original=e,this.pageIntentInstrumentation=t}async fetch(e){return e.$pageIntentInstrumentation=this.pageIntentInstrumentation,await this.original.fetch(e)}}},6534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.services=t.random=t.plist=t.platform=t.net=t.localizer=t.host=t.cryptography=t.cookieProvider=t.bundle=t.bag=void 0
const r=n(900)
t.bag=(0,r.makeMetatype)("jet-engine:bag"),t.bundle=(0,r.makeMetatype)("jet-engine:bundle"),t.cookieProvider=(0,r.makeMetatype)("jet-engine:cookieProvider"),t.cryptography=(0,r.makeMetatype)("jet-engine:cryptography"),t.host=(0,r.makeMetatype)("jet-engine:host"),t.localizer=(0,r.makeMetatype)("jet-engine:localizer"),t.net=(0,r.makeMetatype)("jet-engine:net"),t.platform=(0,r.makeMetatype)("jet-engine:platform"),t.plist=(0,r.makeMetatype)("jet-engine:plist"),t.random=(0,r.makeMetatype)("jet-engine:random"),t.services=(0,r.makeMetatype)("jet-engine:services")},8037:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1721),t),o(n(9031),t),o(n(447),t),o(n(2024),t),o(n(2450),t)},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9031:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2490),t)},447:(e,t)=>{var n,r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.notInstrumented=t.NotInstrumentedMetricsType=t.MetricsEventType=t.PageInvocationPoint=t.EMPTY_LINTED_METRICS_EVENT=void 0,t.EMPTY_LINTED_METRICS_EVENT={fields:{},issues:[]},(o=t.PageInvocationPoint||(t.PageInvocationPoint={})).pageEnter="pageEnter",o.pageExit="pageExit",o.appExit="appExit",o.appEnter="appEnter",o.backButton="backButton",(r=t.MetricsEventType||(t.MetricsEventType={})).click="click",r.page="page",r.search="search",r.impressions="impressions",r.media="media",r.pageRender="pageRender",function(e){e[e.ActionMetrics=0]="ActionMetrics",e[e.FetchTimingMetrics=1]="FetchTimingMetrics",e[e.PageMetrics=2]="PageMetrics",e[e.ImpressionMetrics=3]="ImpressionMetrics"}(n=t.NotInstrumentedMetricsType||(t.NotInstrumentedMetricsType={})),t.notInstrumented=function(e){switch(e){case n.ActionMetrics:return{data:[],custom:{}}
case n.FetchTimingMetrics:return{}
case n.PageMetrics:return{instructions:[],custom:{}}
case n.ImpressionMetrics:return{id:{id:"",impressionIndex:-1},fields:{},custom:{}}
default:return{}}}},2024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2450:(e,t)=>{function n(e){return null==e}function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.flatMapOptional=t.mapOptional=t.unsafeUnwrapOptional=t.unwrapOptional=t.isSome=t.isNothing=t.unsafeUninitialized=void 0,t.unsafeUninitialized=function(){},t.isNothing=n,t.isSome=r,t.unwrapOptional=function(e){if(n(e))throw new ReferenceError
return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return r(e)?t(e):e},t.flatMapOptional=function(e,t){return r(e)?t(e):e}},2879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shallowCloneOf=void 0,t.shallowCloneOf=function(e){const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e)}},6151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0,t.ExpiringValue=class{constructor(e,t){this._value=e,this._maxAge=t}isValid(){return Date.now()<this._maxAge}get value(){return this.isValid()?this._value:null}}},7312:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2879),t),o(n(6151),t),o(n(900),t),o(n(2366),t),o(n(4805),t),o(n(3087),t),o(n(1974),t)},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMetatype=void 0,t.makeMetatype=function(e){return{name:e}}},2366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0,t.isPromise=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}},4805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RewindableValue=void 0
const r=n(2879)
t.RewindableValue=class{constructor(e){this._values=[e]}get(){return this._values[this._values.length-1]}set(e){this._values[this._values.length-1]=e}save(){this._values.push(this._values[this._values.length-1])}restore(){if(1===this._values.length)throw new RangeError("Calls to restore must balance previous calls to save")
this._values.pop()}clone(){const e=(0,r.shallowCloneOf)(this)
return e._values=this._values.slice(),e}}},3087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.difference=t.symmetricDifference=t.intersection=t.union=t.isSuperset=void 0,t.isSuperset=function(e,t){for(const n of t)if(!e.has(n))return!1
return!0},t.union=function(e,t){const n=new Set(e)
for(const e of t)n.add(e)
return n},t.intersection=function(e,t){const n=new Set
for(const r of t)e.has(r)&&n.add(r)
return n},t.symmetricDifference=function(e,t){const n=new Set(e)
for(const e of t)n.has(e)?n.delete(e):n.add(e)
return n},t.difference=function(e,t){const n=new Set(e)
for(const e of t)n.delete(e)
return n}},1974:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.QueryHandling=void 0
const o=n(2450),i=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,s=/([^=?&]+)=?([^&]*)/g,a=["hash","query","pathname","host"]
var c
!function(e){e.FORM_ENCODED="form-encoded",e.RFC3986="rfc3986"}(c=t.QueryHandling||(t.QueryHandling={}))
class l{constructor(e,t){var n
if(this.query={},this.queryHandling=null==t?void 0:t.queryHandling,(0,o.isNothing)(e))return
let s=e
const c=i.exec(e)
if((0,o.isSome)(c)){let e=c[1]
null!=e&&(e=e.split(":")[0]),this.protocol=null!=e?e:void 0,s=null!==(n=c[3])&&void 0!==n?n:void 0}let u={remainder:s,result:void 0}
for(const e of a){if(void 0===u||void 0===u.remainder)break
switch(e){case"hash":u=r(u.remainder,"#","suffix"),this.hash=null==u?void 0:u.result
break
case"query":u=r(u.remainder,"?","suffix"),void 0!==(null==u?void 0:u.result)&&(this.query=l.queryFromString(u.result,this.queryHandling))
break
case"pathname":u=r(u.remainder,"/","suffix"),void 0!==(null==u?void 0:u.result)&&(this.pathname="/"+u.result)
break
case"host":{const e=r(u.remainder,"@","prefix"),t=null==e?void 0:e.result,n=null==e?void 0:e.remainder
if(void 0!==t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(void 0!==n){const e=n.split(":")
this.host=e[0],this.port=e[1]}break}default:throw new Error("Unhandled case!")}}}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}set(e,t){if(void 0===t)return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}append(e,t){let n,r=this.get(e)
if("query"===e)void 0===r&&(r={}),"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),n="string"==typeof r?{existingValue:r,...t}:{...r,...t}
else{void 0===r&&(r="")
let o=r
void 0===o&&(o="")
let i=o
if("pathname"===e){const e=o.length
0!==e&&"/"===o[e-1]||(i+="/")}i+=t,n=i}return this.set(e,n)}param(e,t){return null===e||(void 0===this.query&&(this.query={}),void 0===t?delete this.query[e]:this.query[e]=t),this}removeParam(e){return void 0===e||void 0===this.query||e in this.query&&delete this.query[e],this}path(e){return this.append("pathname",e)}pathExtension(){var e,t
if(void 0===this.pathname)return
const n=null!==(t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split("."))&&void 0!==t?t:[]
return n.filter(function(e){return""!==e}).length<2?void 0:n.pop()}pathComponents(){return void 0===this.pathname?[]:this.pathname.split("/").filter(e=>e.length>0)}build(){return this.toString()}toString(){let e=""
return void 0!==this.protocol&&(e+=this.protocol+"://"),void 0!==this.username&&(e+=encodeURIComponent(this.username),void 0!==this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),void 0!==this.host&&(e+=this.host,void 0!==this.port&&(e+=":"+this.port)),void 0!==this.pathname&&(e+=this.pathname),void 0!==this.query&&0!==Object.keys(this.query).length&&(e+="?"+l.toQueryString(this.query,this.queryHandling)),void 0!==this.hash&&(e+="#"+this.hash),e}static queryFromString(e,t=c.FORM_ENCODED){const n={}
let r=s.exec(e)
for(;null!==r&&r.length>=3;){let o=r[1],i=r[2]
t===c.FORM_ENCODED&&(o=o.replace(/\+/g," "),i=i.replace(/\+/g," "))
const a=decodeURIComponent(o),l=decodeURIComponent(i)
n[a]=l,r=s.exec(e)}return n}static toQueryString(e,t=c.RFC3986){let n="",r=!0
for(const o of Object.keys(e)){r||(n+="&"),r=!1,n+=l.encodeQueryComponent(o,t)
const i=e[o]
null!==i&&i.length>0&&(n+="="+l.encodeQueryComponent(i,t))}return n}static encodeQueryComponent(e,t){return t===c.FORM_ENCODED?encodeURIComponent(e).replace(/%20/g,"+"):encodeURIComponent(e)}static from(e){return new l(e)}static fromComponents(e,t,n,r,o,i){const s=new l(void 0,i)
return s.protocol=e,s.host=t,s.pathname=n,s.query=null!=r?r:{},s.hash=o,s}}t.URL=l},4592:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAugmentedData=void 0
const s=i(n(8156))
t.fetchAugmentedData=async function(e,t,n,r,o){const i=n(e,t,o)
if(null==i)return await Promise.resolve({originalData:t,additionalData:null})
const a=Array.from(i),c=[]
for(const t of a){const n=r(e,t)
if(s.isNull(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}},4876:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6297),t),o(n(4592),t),o(n(2299),t),o(n(2930),t),o(n(7582),t),o(n(2390),t),o(n(8097),t)},9846:function(e,t,n){function r(e,t,n){return h.isNull(e)?null:h.asDictionary(e.attributes,t,n)}function o(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.attributes,t,n)}function i(e,t,n="coercible"){if(h.isNull(e))return null
const r=h.asString(e.attributes,t,n)
return(0,f.isNothing)(r)?null:new Date(r)}function s(e){return!h.isNull(h.asDictionary(e,"attributes"))}function a(e){const t=h.asDictionary(e,"meta")
if((0,f.isNothing)(t))throw new p.MissingFieldError(e,"meta")
return t}function c(e,t){let n
return n=Array.isArray(e)?e:[e],Array.isArray(t)?n.push(...t):n.push(t),n}var l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n)
return u(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.concatObjectPaths=t.requiredMetaAttributeAsNumber=t.requiredMetaAttributeAsString=t.requiredMeta=t.requiredAttributeAsDictionary=t.requiredAttributeAsDate=t.requiredAttributeAsString=t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=t.attributeKeyAsCustomAttributeKey=t.isNotHydrated=t.hasAttributes=t.attributeAsNumber=t.attributeAsBooleanOrFalse=t.attributeAsBoolean=t.attributeAsDate=t.metaAsString=t.attributeAsString=t.attributeAsArrayOrEmpty=t.attributeAsInterface=t.attributeAsDictionary=void 0
const f=n(2450),h=d(n(8156)),p=d(n(8747))
t.attributeAsDictionary=r,t.attributeAsInterface=function(e,t,n){return r(e,t,n)},t.attributeAsArrayOrEmpty=function(e,t){return h.isNull(e)?[]:h.asArrayOrEmpty(e.attributes,t)},t.attributeAsString=o,t.metaAsString=function(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.meta,t,n)},t.attributeAsDate=i,t.attributeAsBoolean=function(e,t,n="coercible"){return h.isNull(e)?null:h.asBoolean(e.attributes,t,n)},t.attributeAsBooleanOrFalse=function(e,t){return!h.isNull(e)&&h.asBooleanOrFalse(e.attributes,t)},t.attributeAsNumber=function(e,t,n="coercible"){return h.isNull(e)?null:h.asNumber(e.attributes,t,n)},t.hasAttributes=s,t.isNotHydrated=function(e){return!s(e)},t.attributeKeyAsCustomAttributeKey=function(e){return w[e]},t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=function(e){return"customArtwork"===e||"customIconArtwork"===e}
const w={artwork:"customArtwork",iconArtwork:"customIconArtwork",screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:"customScreenshotsByTypeForAd",customVideoPreviewsByTypeForAd:"customVideoPreviewsByTypeForAd"}
t.requiredAttributeAsString=function(e,t){const n=o(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDate=function(e,t){const n=i(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDictionary=function(e,t){const n=r(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredMeta=a,t.requiredMetaAttributeAsString=function(e,t){const n=a(e),r=h.asString(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.requiredMetaAttributeAsNumber=function(e,t){const n=a(e),r=h.asNumber(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.concatObjectPaths=c},3389:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.BagWrapper=void 0
const s=n(5542),a=i(n(1222)),c=n(8156)
t.BagWrapper=class{constructor(e){this.bag=e.required(a.bag)}get language(){return this.bag.string("language")}get mediaCountryCode(){return this.bag.string("countryCode")}get mediaHost(){return this.bag.url("apps-media-api-host")}get mediaPreviewHost(){return this.bag.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.bag.string("notification-settings-media-api-host")}get mediaApiLanguage(){const e=this.bag.string("language-tag")
return(0,s.isSome)(e)?e:this.bag.string("language")}get edgeEndpoints(){const e=this.bag.array("apps-media-api-edge-end-points")
return void 0===e?[]:(0,c.asArrayOrEmpty)((0,c.asJSONValue)(e))}get mediaEdgeSearchHost(){return this.bag.string("apps-media-api-search-edge-host")}get redirectUrlWhitelistedQueryParams(){let e=(0,c.asArrayOrEmpty)((0,c.asJSONValue)(this.bag.array("processRedirectUrl/whitelistedQueryParams")))
return(0,c.isNullOrEmpty)(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e}}},1031:function(e,t,n){function r(e){return c.isDefinedNonNull(e.attributes)}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.metricsFromMediaApiObject=t.dataCollectionFromResultsListContainer=t.isDataCollectionPartiallyHydrated=t.isDataCollectionHydrated=t.isDataHydrated=t.dataCollectionFromDataContainer=t.dataFromDataContainer=t.requiredStringID=void 0
const a=n(2450),c=s(n(8156))
n(2930),t.requiredStringID=function(e){const t=c.asString(e,"id")
if((0,a.isNothing)(t))throw new Error(`Data.id '${e.id}' is not a string.`)
return t},t.dataFromDataContainer=function(e){const t=c.asArrayOrEmpty(e,"data")
return t.length,1!==t.length?null:t[0]},t.dataCollectionFromDataContainer=function(e){return c.asArrayOrEmpty(e,"data")},t.isDataHydrated=r,t.isDataCollectionHydrated=function(e){for(let t=e.length-1;t>=0;t-=1)if(!r(e[t]))return!1
return!0},t.isDataCollectionPartiallyHydrated=function(e){for(const t of e)if(r(t))return!0
return!1},t.dataCollectionFromResultsListContainer=function(e){return c.asArrayOrEmpty(e,"results.contents")},t.metricsFromMediaApiObject=function(e){return c.asDictionary(e,"meta.metrics")}},8747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MissingFieldError=void 0
class n extends Error{constructor(e,t){super(),this.dataId=e.id,this.dataType=e.type,this.attributePath=t}}t.MissingFieldError=n},6297:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9846),t),o(n(3389),t),o(n(1031),t),o(n(3734),t),o(n(3665),t),o(n(2299),t),o(n(8156),t),o(n(4029),t),o(n(8747),t)},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2299:function(e,t,n){function r(e){switch(host.platform){case"iOS":return"iPad"===host.deviceModelFamily?"ipad":"iphone"
case"macOS":return"mac"
case"tvOS":return"appletv"
case"watchOS":return"watch"
case"xrOS":return"realityDevice"
default:return null}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.defaultPlatformForClient=void 0
const a=s(n(8156))
t.defaultPlatformForClient=r,t.Request=class{constructor(e,t){if(this.contentsResourceTypes=new Set,this.ids=new Set,this.seeds=new Set,this.relationshipIncludes=new Set,this.relationshipIncludesOnly=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.shouldOmitAutomaticRelationship=!1,this.objectGraph=e,this.platform=r(),!a.isNullOrEmpty(t))if("string"==typeof t)this.href=t
else if(Array.isArray(t)){const e=new Set
for(const n of t)e.add(n.type),this.ids.add(n.id)
1===e.size?this.resourceType=e.values().next().value:e.size>1&&(this.resourceType="contents",this.contentsResourceTypes=e)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.ids.add(t)
return this}withSeeds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.seeds.add(t)
return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingOnlyRelationships(e){for(const t of e)this.relationshipIncludesOnly.add(t)
return this}includingScopedRelationships(e,t){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){null==this.metaIncludes&&(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingAssociateKeys(e,t){null==this.associateIncludes&&(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t="marketing-items"
if(e){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get("editorial-items")
null==e&&(e=new Set),e.add(t),this.scopedRelationshipIncludes.set("editorial-items",e)}else this.relationshipIncludes.add(t)
{null==this.metaIncludes&&(this.metaIncludes=new Map)
let e=this.metaIncludes.get("marketing-items")
null==e&&(e=new Set),e.add("metrics"),this.metaIncludes.set("marketing-items",e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){null==this.scopedAttributeIncludes&&(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){null==this.scopedAvailableInIncludes&&(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return null==this.scopedSparseLimit&&(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}format(e){return this.responseFormat=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!a.isDefinedNonNull(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}}},8156:function(e,t,n){function r(e){return i(e)?null:Array.isArray(e)?e.join("."):e}function o(e,t,n){if(null==e)return n
if(s(t))return e
let r
if("string"==typeof t){if(r=w[t],s(r)){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),w[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function i(e){return null==e}function s(e){return i(e)||0===Object.keys(e).length}function a(e){return null!=e}function c(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return s
if("string"==typeof s)return s
{const e="object"==typeof s?null:String(s)
switch(n){case"strict":h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})
break
case"coercible":i(e)&&h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})}return e}}function l(e,t,n){const s=o(e,t,null)
return s instanceof Object&&!Array.isArray(s)?s:(i(s)||h.context("asDictionary",()=>{h.unexpectedType("defaultValue","object",s,r(t))}),a(n)?n:null)}var u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n)
return d(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.asJSONData=t.asJSONValue=t.asBoolean=t.asInterface=t.asDictionary=t.asNumber=t.asDate=t.asString=t.asBooleanOrFalse=t.asArrayOrEmpty=t.isArrayDefinedNonNullAndEmpty=t.isNumber=t.isDefinedNonNullNonEmpty=t.isDefinedNonNull=t.isNullOrEmpty=t.isNull=t.traverse=t.objectPathToString=void 0
const h=f(n(4172)),p=n(2450)
t.objectPathToString=r
const w={}
t.traverse=o,t.isNull=i,t.isNullOrEmpty=s,t.isDefinedNonNull=a,t.isDefinedNonNullNonEmpty=function(e){return a(e)&&0!==Object.keys(e).length},t.isNumber=function(e){if(i(e))return!1
let t
return t="string"==typeof e?parseInt(e):e,!Number.isNaN(t)},t.isArrayDefinedNonNullAndEmpty=function(e){return a(e)&&0===e.length},t.asArrayOrEmpty=function(e,t){const n=o(e,t,null)
return Array.isArray(n)?n:(i(n)||h.context("asArrayOrEmpty",()=>{h.unexpectedType("defaultValue","array",n,r(t))}),[])},t.asBooleanOrFalse=function(e,t){const n=o(e,t,null)
return"boolean"==typeof n?n:(i(n)||h.context("asBooleanOrFalse",()=>{h.unexpectedType("defaultValue","boolean",n,r(t))}),!1)},t.asString=c,t.asDate=function(e,t,n="coercible"){const r=c(e,t,n)
return(0,p.isNothing)(r)?null:new Date(r)},t.asNumber=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s)||"number"==typeof s)return s
{const e=Number(s)
switch(n){case"strict":h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(isNaN(e))return h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return e}},t.asDictionary=l,t.asInterface=function(e,t,n){return l(e,t,n)},t.asBoolean=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return null
if("boolean"==typeof s)return s
if("string"==typeof s){if("true"===s)return!0
if("false"===s)return!1}const a=Boolean(s)
switch(n){case"strict":h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(i(a))return h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return a},t.asJSONValue=function(e){if(null==e)return null
switch(typeof e){case"string":case"number":case"boolean":return e
case"object":return Array.isArray(e),e
default:return h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","JSONValue",typeof e)}),null}},t.asJSONData=function(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","object",typeof e)}),null)}},4029:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=n(8156),s=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,a=/([^=?&]+)=?([^&]*)/g,c=["hash","query","pathname","host"]
class l{constructor(e){if(this.query={},(0,i.isNullOrEmpty)(e))return
let t=e
const n=s.exec(e)
if(null!=n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let o={remainder:t,result:void 0}
for(const e of c){if(!o.remainder)break
switch(e){case"hash":o=r(o.remainder,"#","suffix"),this.hash=o.result
break
case"query":o=r(o.remainder,"?","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.query=l.queryFromString(o.result))
break
case"pathname":o=r(o.remainder,"/","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.pathname="/"+o.result)
break
case"host":if(o.remainder){const e=r(o.remainder,"@","prefix"),t=e.result,n=e.remainder
if((0,i.isDefinedNonNullNonEmpty)(t)){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if((0,i.isNullOrEmpty)(t))return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if("query"===e)"string"==typeof t&&(t=l.queryFromString(t)),r="string"==typeof n?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if("pathname"===e){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(null==this.query&&(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&null!=this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append("pathname",e)}pathExtension(){var e
if((0,o.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return(0,i.isNullOrEmpty)(this.pathname)?[]:this.pathname.split("/").filter(e=>e.length>0)}popPathComponent(){if((0,i.isNullOrEmpty)(this.pathname))return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return(0,i.isDefinedNonNullNonEmpty)(this.protocol)&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),(0,i.isDefinedNonNullNonEmpty)(this.host)&&(e+=this.host,this.port&&(e+=":"+this.port)),(0,i.isDefinedNonNullNonEmpty)(this.pathname)&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),null!=this.query&&Object.keys(this.query).length>0&&(e+="?"+l.toQueryString(this.query)),(0,i.isDefinedNonNullNonEmpty)(this.hash)&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=a.exec(e)
for(;null!=n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=a.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r];(0,i.isDefinedNonNullNonEmpty)(o)&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new l(e)}static fromComponents(e,t,n,r,o){const i=new l
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}t.URL=l},2930:function(e,t,n){async function r(e,t,n){const r=await e.network.fetch(t)
if(!r.ok)throw Error(`Bad Status code ${r.status} for ${t.url}`)
const o=Date.now(),i=n(r.body),s=Date.now(),c=function(e,t,n){return f.isNull(e)||0===e.length?null:{...e[0],parseStartTime:t,parseEndTime:n}}(r.metrics,o,s)
return f.isDefinedNonNull(c)&&(i[a.timingValues]=c),i[a.requestedUrl]=t.url.toString(),i}function o(e,t){return e.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return f.isDefinedNonNull(null===(n=t.query)||void 0===n?void 0:n[e])})}async function i(e,t,n,r,c={},l=!1,u){var p,m,y,A
const T=new h.URL(n),b=o(e,T)
for(const e of b)T.removeParam(e)
const S=T.toString()
let P=c.headers
null==P&&(P={}),P.Authorization="Bearer "+r
const I={url:S,excludeIdentifierHeadersForAccount:null!==(p=c.excludeIdentifierHeadersForAccount)&&void 0!==p&&p,alwaysIncludeAuthKitHeaders:null===(m=c.alwaysIncludeAuthKitHeaders)||void 0===m||m,alwaysIncludeMMeClientInfoAndDeviceHeaders:null===(y=c.alwaysIncludeMMeClientInfoAndDeviceHeaders)||void 0===y||y,headers:P,method:c.method,body:c.requestBodyString,timeout:c.timeout},C=await e.network.fetch(I)
try{if(401===C.status||403===C.status){if(l)throw Error("We refreshed the token but we still get 401 from the API")
return t.resetToken(),await t.refreshToken().then(async r=>await i(e,t,n,r,c,!0,u))}if(404===C.status)throw s()
if(!C.ok){const e=null!==(A=C.headers["x-apple-jingle-correlation-key"])&&void 0!==A?A:"N/A",t=new w(`Bad Status code ${C.status} (correlationKey: ${e}) for ${S}, original ${n}`)
throw t.statusCode=C.status,t}const r=t=>{const r=Date.now()
let o
if(f.isNull(t.body)||""===t.body){if(204!==t.status)throw s()
o={}}else o=JSON.parse(t.body)
const i=Date.now()
if(o[a.pageInformation]=f.asJSONData(function(e,t){const n=e.storefrontIdentifier
let r=null
if(f.isDefinedNonNullNonEmpty(n)){const e=n.split("-")
f.isDefinedNonNullNonEmpty(e)&&(r=e[0])}return{serverInstance:t.headers[g],storeFrontHeader:n,language:e.bagLanguage,storeFront:r,environmentDataCenter:t.headers[v]}}(e,t)),t.metrics.length>0){const e={...t.metrics[0],parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}else{const e={pageURL:t.url,parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}if(o[a.contentMaxAge]=function(e){const t=Object.keys(e.headers).find(e=>"cache-control"===e.toLowerCase())
if(f.isNull(t)||""===t)return null
const n=e.headers[t]
if(f.isNullOrEmpty(n))return null
const r=n.match(/max-age=(\d+)/)
return f.isNull(r)||r.length<2?null:f.asNumber(r[1])}(t),Array.isArray(o.data)&&f.isArrayDefinedNonNullAndEmpty(o.data)&&!f.asBooleanOrFalse(c.allowEmptyDataResponse))throw s()
return o[a.requestedUrl]=n,o}
return(0,d.isSome)(u)?u.measureParsing(C,r):r(C)}catch(e){if(e instanceof w)throw e
throw new Error(`Error Fetching - filtered: ${S}, original: ${n}, ${e.name}, ${e.message}`)}}function s(){const e=new w("No content")
return e.statusCode=204,e}var a,c=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n)
return l(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.redirectParametersInUrl=t.fetchData=t.fetchPlist=t.fetchJSON=t.fetch=t.ResponseMetadata=void 0
const d=n(2450),f=u(n(8156)),h=u(n(4029)),p=u(n(8097))
!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(a=t.ResponseMetadata||(t.ResponseMetadata={})),t.fetch=r,t.fetchJSON=async function(e,t){return await r(e,t,e=>(0,d.isSome)(e)?JSON.parse(e):{})},t.fetchPlist=async function(e,t){return await r(e,t,n=>{if((0,d.isSome)(n))return e.plist.parse(n)
throw new Error(`Could not fetch Plist, response body was not defined for ${t.url}`)})},t.fetchData=async function(e,t,n,r){const o=p.buildURLFromRequest(e,n).toString(),s=(Date.now(),await t.refreshToken()),c=await i(e,t,o,s,r,!1,e.fetchTimingMetricsBuilder)
return Date.now(),n.canonicalUrl&&(c[a.requestedUrl]=n.canonicalUrl),c},t.redirectParametersInUrl=o
class w extends Error{}t.NetworkError=w
const g="x-apple-application-instance",v="x-apple-application-site"},7582:function(e,t,n){function r(e,t){const n=d.attributeAsDictionary(e,"platformAttributes")
return u.traverse(n,t)}function o(e,t,n){const o=r(e,t)
return u.isNull(o)?null:u.asDictionary(o,n)}function i(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asString(i,n,o)}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredPlatformAttributeAsDictionary=t.requiredPlatformAttributeAsString=t.platformAttributeAsNumber=t.platformAttributeAsBooleanOrFalse=t.platformAttributeAsBoolean=t.platformAttributeAsString=t.platformAttributeAsArrayOrEmpty=t.platformAttributeAsDictionary=t.hasPlatformAttribute=void 0
const l=n(2450),u=c(n(8156)),d=c(n(9846)),f=c(n(8747))
t.hasPlatformAttribute=function(e,t){const n=r(e,t)
return u.isDefinedNonNullNonEmpty(n)},t.platformAttributeAsDictionary=o,t.platformAttributeAsArrayOrEmpty=function(e,t,n){const o=r(e,t)
return u.isNull(o)?[]:u.asArrayOrEmpty(o,n)},t.platformAttributeAsString=i,t.platformAttributeAsBoolean=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asBoolean(i,n,o)},t.platformAttributeAsBooleanOrFalse=function(e,t,n){const o=r(e,t)
return!u.isNull(o)&&u.asBooleanOrFalse(o,n)},t.platformAttributeAsNumber=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asNumber(i,n,o)},t.requiredPlatformAttributeAsString=function(e,t,n){const r=i(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r},t.requiredPlatformAttributeAsDictionary=function(e,t,n){const r=o(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r}},2390:function(e,t,n){function r(e,t){return l.asInterface(e.relationships,t)}function o(e,t){const n=l.asArrayOrEmpty(e.relationships,[t,"data"])
return 0===n.length?null:(n.length,n[0])}function i(e,t){return l.asArrayOrEmpty(e.relationships,[t,"data"])}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredRelationshipCollectionNonEmpty=t.requiredRelationshipData=t.relationshipViewsCollection=t.relationshipCollection=t.relationshipData=t.relationship=t.hasRelationship=void 0
const l=c(n(8156)),u=n(2450),d=c(n(8747))
t.hasRelationship=function(e,t,n=!0){const o=r(e,t)
return!((0,u.isNothing)(o)||n&&0===o.data.length)},t.relationship=r,t.relationshipData=o,t.relationshipCollection=i,t.relationshipViewsCollection=function(e,t){return l.asArrayOrEmpty(e.views,[t,"data"])},t.requiredRelationshipData=function(e,t){const n=o(e,t)
if((0,u.isNothing)(n))throw new d.MissingFieldError(e,["relationships",t,"data"])
return n},t.requiredRelationshipCollectionNonEmpty=function(e,t){const n=i(e,t)
if(0===n.length)throw new d.MissingFieldError(e,["relationships",t,"data"])
return n}},8097:function(e,t,n){function r(e){switch(e){case"apps":case"app-events":case"activities":case"arcade-apps":case"app-bundles":case"charts":case"contents":case"developers":case"eula":case"in-apps":case"multiple-system-operators":case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"chart-list":default:return"catalog"
case"games/recommendations":return"games/recommendations"
case"categories":case"editorial-items":case"editorial-item-groups":case"editorial-elements":case"groupings":case"multiplex":case"multirooms":case"rooms":case"today":case"collections":return"editorial"
case"ratings":return"ratings"
case"personalization-data":case"reviews":return"me"
case"upsellMarketingItem":case"landing":case"engagement-data":return"engagement"
case"landing:new-protocol":case"recommendations":case"personal-recommendations":return"recommendations"}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.buildURLFromRequest=void 0
const a=n(2450),c=s(n(8156)),l=s(n(4029)),u=s(n(9846))
t.buildURLFromRequest=function(e,t){var n,o
const i=c.isDefinedNonNullNonEmpty(t.href)?t.href:function(e,t){switch(t){case"games/search":return`/v1/games/${r(t)}/${e.mediaCountryCode}`
case"personalization-data":case"reviews":return`/v1/${r(t)}/`
default:return`/v1/${r(t)}/${e.mediaCountryCode}/`}}(e,t.resourceType),s=new l.URL(i)
if(c.isDefinedNonNullNonEmpty(t.resourceType))for(const e of function(e,t){switch(e){case"eula":return void 0===t?[e]:[e,t]
case"landing:new-protocol":case"recommendations":case"searchLanding:see-all":case"search-hints":case"games/recommendations":return[]
case"landing":return void 0===t?["search",e]:["search",e,t]
case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"game-highlights":return["apps"]
case"reviews":return["reviews","apps"]
case"multiplex":return["multiplex"]
case"upsellMarketingItem":return["upsell","marketing-items"]
case"trending-contents":return["search",e]
case"player-highlights":return["players"]
case"search-suggestions":case"games/search":case"games/search-suggestions":case"search-groups":return["search"]
case"chart-list":return["charts"]
default:return[e]}}(t.resourceType,t.targetResourceType))s.append("pathname",e)
if(t.ids.size>1||(0,a.isSome)(t.useIdsAsQueryParam))s.param("ids",Array.from(t.ids).join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
s.append("pathname",encodeURIComponent(e))}if(t.seeds.size>0&&s.param("seeds",Array.from(t.seeds).join(",")),void 0!==t.resourceType){const e=function(e){switch(e){case"user-reviews":return"reviews"
case"customers-also-bought-apps-with-download-intent":return"view/customers-also-bought-apps-with-download-intent"
case"collections":default:return null
case"searchLanding:see-all":return"view/see-all"
case"search-hints":return"search/suggestions"
case"game-highlights":case"player-highlights":return"view/highlights"
case"games/search":case"search-groups":return"groups"
case"games/search-suggestions":case"search-suggestions":return"suggestions"}}(t.resourceType)
c.isDefinedNonNullNonEmpty(e)&&s.append("pathname",e)}if(s.param("platform",null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&s.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t.push("customArtwork"),t}(e)),e.sort(),s.param("extend",e.join(","))}if(c.isDefinedNonNull(t.ageRestriction)&&s.param("restrict[ageRestriction]",t.ageRestriction.toString()),c.isDefinedNonNull(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())s.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludesOnly.size>0?s.param("includeOnly",Array.from(t.relationshipIncludesOnly).sort().join(",")):t.relationshipIncludes.size>0&&s.param("include",Array.from(t.relationshipIncludes).sort().join(",")),t.shouldOmitAutomaticRelationship&&s.param("omit[resource]","autos"),c.isDefinedNonNull(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())s.param(`include[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())s.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())s.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())s.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNullNonEmpty(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),s.param("fields",e.join(","))}if(c.isDefinedNonNull(t.limit)&&t.limit>0&&s.param("limit",`${t.limit}`),c.isDefinedNonNull(t.sparseLimit)&&s.param("sparseLimit",`${t.sparseLimit}`),c.isDefinedNonNull(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())s.param(`sparseLimit[${e}]`,String(n))
c.isDefinedNonNull(t.sparseCount)&&s.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
s.param(`limit[${e}]`,`${n}`)}c.isDefinedNonNullNonEmpty(t.additionalQuery)&&s.append("query",t.additionalQuery),c.isDefinedNonNullNonEmpty(t.searchTerm)&&(((0,a.isNothing)(t.resourceType)||"search-hints"!==t.resourceType)&&(s.append("pathname","search"),s.param("bubble[search]",t.searchTypes.join(","))),s.param("term",t.searchTerm)),c.isDefinedNonNullNonEmpty(t.enabledFeatures)&&s.param("with",t.enabledFeatures.join(",")),c.isDefinedNonNullNonEmpty(t.context)&&s.param("contexts",t.context),c.isDefinedNonNullNonEmpty(t.filterType)&&c.isDefinedNonNullNonEmpty(t.filterValue)&&s.param(`filter[${t.filterType}]`,t.filterValue)
const f=e.mediaApiLanguage
return c.isDefinedNonNull(f)&&c.isNull(t.additionalQuery.l)&&s.param("l",f),c.isDefinedNonNullNonEmpty(t.responseFormat)&&s.param("format[resources]",t.responseFormat),s.host=null!==(o=function(e,t,n){var r
const o=null!==(r=t.pathname)&&void 0!==r?r:""
let i=null
return i=n.isStorePreviewRequest?e.mediaPreviewHost:n.isMediaRealmRequest?e.mediaRealmHost:o.includes("search/landing")?-1!==e.edgeEndpoints.indexOf("landing")?e.mediaEdgeHost:e.mediaHost:e.edgeEndpoints.map(e=>o.includes(e)).reduce(d,!1)?o.includes("search")&&!o.includes("view/see-all")?e.mediaEdgeSearchHost:e.mediaEdgeHost:e.mediaHost,c.isNull(i)&&(i="api.apps.apple.com"),i}(e,s,t))&&void 0!==o?o:void 0,s.protocol="https",s}
const d=(e,t)=>e||t}},n={}
e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function t(e){return r(e)?null:Array.isArray(e)?e.join("."):e}function n(e,t,n){if(null==e)return n
if(!t)return e
let r
if(typeof t===zq){if(r=CW[t],!r){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),CW[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function r(e){return null==e}function o(e){return r(e)||0===Object.keys(e).length}function i(e){return typeof e!==_U&&null!==e}function s(e){return!(0,Zv.isNothing)(e)&&(typeof e===zq||Array.isArray(e)?e.length>0:0!==Object.keys(e).length)}function a(e){if(r(e))return!1
let t
return t=typeof e===zq?parseInt(e):e,!Number.isNaN(t)}function c(e){return!(0,Zv.isNothing)(e)&&typeof e===zq}function l(e,t){var n
return null!==(n=w(e,t,[]))&&void 0!==n?n:[]}function u(e,t){return d(e,!1,t)}function d(e,o,i){const s=n(e,i,null)
return typeof s===VF?s:(r(s)||Kv.context("asBooleanWithDefault",()=>{Kv.unexpectedType(BH,VF,s,t(i))}),o)}function f(e,o,i=qH){const s=n(e,o,null)
if(r(s))return s
if(typeof s===zq)return s
{const e=typeof s===vV?null:String(s)
switch(i){case J_:Kv.context(fk,()=>{Kv.unexpectedType(rU,zq,s,t(o))})
break
case qH:r(e)&&Kv.context(fk,()=>{Kv.unexpectedType(rU,zq,s,t(o))})}return e}}function h(e,o,i=qH){const s=n(e,o,null)
if(r(s)||typeof s===sj)return s
{const e=Number(s)
switch(i){case J_:Kv.context(hk,()=>{Kv.unexpectedType(rU,sj,s,t(o))})
break
case qH:if(isNaN(e))return Kv.context(hk,()=>{Kv.unexpectedType(rU,sj,s,t(o))}),null}return e}}function p(e,o,s){const a=n(e,o,null)
return a instanceof Object&&!Array.isArray(a)?a:(r(a)||Kv.context("asDictionary",()=>{Kv.unexpectedType(BH,vV,a,t(o))}),i(s)?s:null)}function w(e,o,s){const a=n(e,o,null)
return Array.isArray(a)?a:(r(a)||Kv.context("asArray",()=>{Kv.unexpectedType(BH,"array",a,t(o))}),i(s)?s:null)}function g(e,t,n){return p(e,t,n)}function v(e,o,i=qH){const s=n(e,o,null)
if(r(s))return null
if(typeof s===VF)return s
if(typeof s===zq){if(s===bq)return!0
if(s===WF)return!1}const a=Boolean(s)
switch(i){case J_:Kv.context(pk,()=>{Kv.unexpectedType(rU,sj,s,t(o))})
break
case qH:if(r(a))return Kv.context(pk,()=>{Kv.unexpectedType(rU,sj,s,t(o))}),null}return a}function m(e){if(null==e)return null
switch(typeof e){case zq:case sj:case VF:return e
case vV:return Array.isArray(e),e
default:return Kv.context(wk,()=>{Kv.unexpectedType(BH,"JSONValue",typeof e)}),null}}function y(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(Kv.context(wk,()=>{Kv.unexpectedType(BH,vV,typeof e)}),null)}function A(e){return(0,Jv.isSome)(e)&&typeof e.$kind===zq}function T(e){return A(e)&&function(e){return(0,Jv.isSome)(LW[e])}(e[PW])&&(0,Jv.isSome)(e.actionClass)&&function(e){return(0,Jv.isSome)(RW[e])}(e.actionClass)}function b(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
n===Tk?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}function S(e){if(null==e)return e
const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e),t}function P(e,t){return e instanceof t}function I(e){return!(!(0,Zv.isSome)(e.protocol)||-1===gz.indexOf(e.protocol))}function C(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t+1}function k(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t?e.substring(t+1,n):e}function O(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1))
return n>=0&&r>n?e.substring(n,r):e}function E(e){return{success:!0,value:e,error:null,[yz]:!0}}function R(e){return{success:!1,value:null,error:e instanceof Error?e:new Error(String(e)),[yz]:!0}}async function D(e){return await M(e)}async function _(e){return await e}async function L(e){return await Promise.all(e.map(D))}async function M(e){try{const t="function"==typeof e?e():e
return E(await t)}catch(e){return R(e)}}function x(e){throw new Error(`This method should never be called with value: ${e}`)}function $(e,t,r){return e?Kv.context(t,()=>{let o=e[cY],i=null
return o?(i=n(o,t),i||(i=F(o,t,r))):(o={},e[cY]=o,i=F(o,t,r)),i}):null}function F(e,t,n){const r=n()
return e[t]=r,r}function N(e){return g(function(e){return l(e,"meta.associations.editorial-cards.data")}(e)[0])}function B(e,t,n){return(0,Zv.isNothing)(e)?null:p(e.attributes,t,n)}function U(e,t){return r(e)?[]:w(e.attributes,t)}function G(e,t){var n
return null!==(n=U(e,t))&&void 0!==n?n:[]}function j(e,t,n=qH){return r(e)?null:f(e.attributes,t,n)}function V(e,t,n=qH){return r(e)?null:v(e.attributes,t,n)}function H(e,t){return!r(e)&&u(e.attributes,t)}function q(e,t,n=qH){return r(e)?null:h(e.attributes,t,n)}function W(e){return!r(p(e,UF))}function z(e){return!W(e)}function Y(e){return lY[e]}function J(e){return e===zx||e===K_}function K(e){if(e.client.isCompanionVisionApp)return aH
switch(e.client.deviceType){case lW:return Uq
case oW:return Bq
case"tv":return oU
case vW:return vW
case gW:return gW
case iW:return aH
case BV:return BV
default:return null}}function Z(e){return e.client.isPhone?2:1}function Q(e){switch(e.client.deviceType){case lW:return 4
case oW:return 5
case"tv":return 6
case vW:return 5
case gW:return 10
default:return null}}function X(e){switch(e.client.deviceType){case lW:return 9
case oW:return 12
case"tv":case vW:return 15
case gW:return 3
case BV:return 15
default:return null}}function ee(e){switch(e.host.clientIdentifier){case Fz:case Nz:case Gz:return[]
default:{const t=K(e)
return function(e,t){const n=new Set
if(n.add(Uq),n.add(Bq),n.add(oU),n.add(vW),n.add(gW),e.bag.enableVisionPlatform&&n.add(aH),(0,Zv.isSome)(t))for(const e of t)n.delete(e)
return Array.from(n)}(e,(0,Zv.isSome)(t)?new Set([t]):void 0)}}}function te(e){switch(e.client.deviceType){case lW:return 6
case oW:return 10
case vW:return 12
case iW:return 10
default:return 8}}function ne(e){let t=null
return e.host.clientIdentifier===pY?t=pq:e.host.clientIdentifier===hY&&(t=gW),t}function re(e,t){if(o(t))return null
const n=l(t,`meta.associations.${e}.data`)
return(0,Zv.isNothing)(n)?null:[...n]}function oe(e,t){return n(B(e,"platformAttributes"),null!=t?t:void 0)}function ie(e,t){return s(oe(e,t))}function se(e,t,n){const o=oe(e,t)
return r(o)?null:p(o,n)}function ae(e,t,n){const o=oe(e,t)
return r(o)?[]:l(o,n)}function ce(e,t,n,o=qH){const i=oe(e,t)
return r(i)?null:f(i,n,o)}function le(e,t,n,o=qH){const i=oe(e,t)
return r(i)?null:v(i,n,o)}function ue(e,t,n){const o=oe(e,t)
return!r(o)&&u(o,n)}function de(e,t,n=!0){const r=fe(e,t)
return!!r&&!(!r.data||n&&0===r.data.length)}function fe(e,t){return i(e)?g(e.relationships,t):null}function he(e,t){return g(e.views,t)}function pe(e,t,n){const r=l(t.relationships,[n,zj])
return 0===r.length?null:(r.length>1&&e.console.warn(`there was an array of relationships when only the first was asked for in relationship ${n}`),r[0])}function we(e,t,n=!1){return!de(e,t,!1)&&n?null:l(e.relationships,[t,zj])}function ge(e,t){return l(e.views,[t,zj])}function ve(e,t){var n,o,a
const c=t.href&&t.href.length>0?t.href:function(e,t,n,r){switch(n){case U_:case qq:case FF:return`/v1/${me(n)}/`
default:const o=(0,Zv.isSome)(r)&&r.length>0?r:e.bag.mediaCountryCode,i=`/v1/${me(n)}/${o}`
return t?i:`${i}/`}}(e,t.isMixedMediaRequest,t.resourceType,t.countryCodeOverride),l=new wz(c)
if(s(t.resourceType))for(const e of function(e,t){switch(e){case XU:return void 0===t?[e]:[e,t]
case t_:return[]
case OF:return void 0===t?[Rq,e]:[Rq,e,t]
case qx:return[yW]
case qq:return[qq,yW]
case Vx:return[Vx]
case Dj:return[LA,RV]
case ck:return[Rq,e]
case Hx:return[yW]
case Wx:case Mx:return[]
case FF:return[yW]
default:return[e]}}(t.resourceType,t.targetResourceType))l.append(SV,e)
if(t.isMixedMediaRequest)for(const[e,n]of t.idsByResourceType.entries())l.param(`ids[${e}]`,Array.from(n).sort().join(","))
else if(t.ids.size>1||t.useIdsAsQueryParam)l.param("ids",Array.from(t.ids).sort().join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
l.append(SV,e)}if(void 0!==t.resourceType){const e=function(e){switch(e){case qx:return qq
case Hx:return"view/customers-also-bought-apps-with-download-intent"
case WV:return mW
case Wx:return mk
case Mx:return"search/suggestions"
default:return null}}(t.resourceType)
s(e)&&l.append(SV,e)}if(l.param(nH,null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&l.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e,t){const n=t.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return n.push(zx),t.includes(EH)&&n.push(EH),n.push(Z$),n}(0,e)),e.sort(),l.param(BC,e.join(","))}if(i(t.ageRestriction)&&e.bag.enableAgeRatingFilter&&l.param("restrict[ageRestriction]",t.ageRestriction.toString()),t.includeAppBinaryTraitsAttribute&&t.includingScopedAttributes(yW,[IT]),i(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())l.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludes.size>0&&l.param("include",Array.from(t.relationshipIncludes).sort().join(",")),i(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())l.param(`include[${e}]`,Array.from(n).sort().join(","))
if(i(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())l.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(i(a=t.viewsIncludes)&&a.size>0&&l.param("views",Array.from(t.viewsIncludes).sort().join(",")),i(t.kindIncludes))for(const[e,n]of t.kindIncludes.entries())l.param(`kinds[${e}]`,Array.from(n).sort().join(","))
if(i(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())l.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(i(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())l.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(s(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),l.param(r$,e.join(","))}if(i(t.limit)&&t.limit>0&&l.param("limit",`${t.limit}`),i(t.sparseLimit)&&l.param("sparseLimit",`${t.sparseLimit}`),i(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())l.param(`sparseLimit[${e}]`,String(n))
i(t.sparseCount)&&l.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
l.param(`limit[${e}]`,`${n}`)}s(t.additionalQuery)&&l.append(vj,t.additionalQuery),s(t.searchTerm)&&(((0,Zv.isNothing)(t.resourceType)||t.resourceType!==Mx)&&(l.append(SV,Rq),l.param("bubble[search]",t.searchTypes.join(","))),l.param(rj,t.searchTerm)),s(t.enabledFeatures)&&l.param(ML,t.enabledFeatures.join(",")),s(t.context)&&l.param(HG,t.context),s(t.filterType)&&s(t.filterValue)&&l.param(`filter[${t.filterType}]`,t.filterValue)
const u=e.bag.mediaApiLanguage
return i(u)&&r(t.additionalQuery.l)&&l.param("l",u),l.host=null!==(o=function(e,t,n){var o
const i=null!==(o=t.pathname)&&void 0!==o?o:""
let s=null
return s=n.isStorePreviewRequest?e.bag.mediaPreviewHost:n.isMediaRealmRequest?e.bag.mediaRealmHost:i.includes("search/landing")?-1!==e.bag.edgeEndpoints.indexOf(OF)?e.bag.mediaEdgeHost(e):e.bag.mediaHost:n.resourceType===FF&&(0,Zv.isSome)(e.bag.appDistributionMediaAPIHost)?e.bag.appDistributionMediaAPIHost:n.isMixedMediaRequest&&e.bag.mediaAPICatalogMixedShouldUseEdge?e.bag.mediaEdgeHost(e):e.bag.edgeEndpoints.map(e=>i.includes(e)).reduce(AY,!1)?i.includes(Rq)&&!i.includes(mk)?e.bag.mediaEdgeSearchHost:e.bag.mediaEdgeHost(e):e.bag.mediaHost,r(s)&&(s="api.apps.apple.com"),s}(e,l,t))&&void 0!==o?o:void 0,l.protocol=H_,l}function me(e){switch(e){case yW:case hW:case oH:case aW:case dN:case mW:case yV:case XU:case rq:case GM:case qx:case Hx:return gk
case uB:case aq:case sW:case Nj:case C$:case UV:case Vx:case DF:case XN:case tW:case WV:return Yk
case Z_:return Z_
case U_:case qq:return"me"
case Dj:case OF:return vk
case t_:case xL:return mH
case FC:return vk
case FF:return"listing"
default:return gk}}function ye(e){if((0,Zv.isNothing)(e)||""===e)return null
const t=TY.exec(e)
return null===t||4!==t.length&&5!==t.length?null:{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,alpha:(0,Zv.isSome)(t[4])?parseInt(t[4],16)/255:void 0,type:GV}}function Ae(e,t,n,r){return{red:e,green:t,blue:n,alpha:r,type:GV}}function Te(e){return.2126*e.red+.7152*e.green+.0722*e.blue}function be(e,t=84){if((0,Zv.isNothing)(e))return!1
switch(e.type){case GV:return 100*Te(e)<t
case UN:return e.name===WO
default:return!1}}function Se(e){return{name:e,type:UN}}function Pe(e,t){return{lightColor:e,darkColor:t,type:Jx}}function Ie(e,t){return!(0,Zv.isNothing)(e)&&!(0,Zv.isNothing)(t)&&(e.type===GV&&t.type===GV?e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha:e.type===UN&&t.type===UN?e.name===t.name:e.type===Jx&&t.type===Jx&&Ie(e.lightColor,t.lightColor)&&Ie(e.darkColor,t.darkColor))}function Ce(e,t){if((0,Zv.isNothing)(e))return!1
const n=function(e){return typeof e===vV&&null!==e&&(jV in e&&e.type===Rk)}(e)?e:ke(e)
return function(e){if(typeof e!==vV||null===e)return!1
const t=e
return"colorHex"in t&&typeof t.colorHex===zq&&"maxSaturation"in t&&typeof t.maxSaturation===sj&&"maxBrightness"in t&&typeof t.maxBrightness===sj}(t)?n.saturation<=t.maxSaturation||n.brightness<=t.maxBrightness:n.hue>=t.minHue&&n.hue<=t.maxHue}function ke(e){const t=e.red,n=e.green,r=e.blue,o=Math.max(t,n,r),i=o-Math.min(t,n,r),s=100*o,a=0===o?0:i/o*100
let c=0
if(0!==i)switch(o){case t:c=60*((n-r)/i+(n<r?6:0))
break
case n:c=60*((r-t)/i+2)
break
case r:c=60*((t-n)/i+4)}return c=(c+360)%360,{type:Rk,hue:c,saturation:a,brightness:s}}function Oe(e){return r(e)||""===e?null:(-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/")))}function Ee(e){if(r(e))return null
const t=function(e){return r(e)?null:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e)
return r(t)?null:t.getTime()}function Re(e){if(r(e))return null
const t=new Date(e)
return t.setHours(0,0,0,0),t}function De(e){return r(e)?null:_e(e)}function _e(e){const t=new Date(e.getTime())
return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function Le(e,t){return r(e)||r(t)?null:Math.ceil((t.getTime()-_e(e).getTime())/36e5)}function Me(e,t,n,r=!1){return $(t,`dataHasDeviceFamily.${n}`,()=>!(!t||!n)&&-1!==Fe(e,t,r).indexOf(n))}function xe(e,t,n,r=!1){var o
return null!==(o=Me(e,t,n,r))&&void 0!==o&&o&&1===Fe(e,t,r).length}function $e(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
return n.length===o.size&&n.every(e=>o.has(e))}function Fe(e,t,n=!1){const r=G(t,dj)
if(0===r.length&&n){const r=we(t,yW)
if((0,Zv.isSome)(r))for(const t of r){const r=Fe(e,t,n)
if(s(r))return r}}return r}function Ne(e,t){var n
const r=e.optional(OY.metatype)
return null===(n=null==r?void 0:r.currentTreatmentForExperiment(t))||void 0===n?void 0:n.identifier}function Be(e){return Ne(e,nm.ProductPagePreloading)===EY}function Ue(e){return e.bag.enableProductPageVariants}function Ge(e,t,r){if(void 0===r&&(r=function(e){const t=function(e){return Ne(e,nm.ProductPageVariants)}(e)
return t}(e)),o(t.id))return
const i={adamID:t.id,productPageId:RY,treatmentPageIdMap:{[RY]:RY},experimentIdMap:{},experimentLocaleMap:{}}
return o(n(t,PV,null))||(function(e,t,r){const i=n(r,"meta.cppData",null)
if(o(i))return
const a=f(i,jU)
s(a)&&(t.productPageId=a)}(0,i,t),function(e,t,r,i,a){const c=n(a,"meta.experimentData",null)
if(o(c))return
const l=n(c,r,null)
if(o(l))return
const u=f(l,vD),d=f(l,OP)
let h=null
const p=n(l,"trafficAllocation",null)
h=s(p)?function(e,t,n){if(void 0===n||o(n))return RY
for(const[e,r]of Object.entries(t))if(s(r)&&-1!==r.indexOf(n))return e
return RY}(0,p,i):function(e,t,n){const r=Ke(e,t,`customAttributes.${n}`)
if(o(r))return RY
const i=Object.keys(r)[0]
return o(i)?RY:i}(e,a,r),s(h)&&s(u)&&(t.treatmentPageIdMap[r]=h,t.experimentIdMap[r]=u,s(d)&&(t.experimentLocaleMap[r]=d))}(e,i,RY,r,t)),i}function je(e,t,r,s,a){if(o(t))return null
let c
if(r.productPageId!==RY){const e=r.treatmentPageIdMap[RY]
c=a?[`${r.productPageId}.${RY}.${s}`,`${RY}.${e}.${s}`,`${RY}.${RY}.${s}`]:[`${r.productPageId}.${RY}.${s}`,`${RY}.${RY}.${s}`]}else{const e=r.treatmentPageIdMap[RY]
c=[`${RY}.${e}.${s}`,`${RY}.${RY}.${s}`]}for(const e of c){const r=n(t,e)
if(i(r))return r}return null}function Ve(e){return(0,Zv.isNothing)(e)||e.productPageId===RY?null:e.productPageId}function He(e,t){return Ve(Ge(e,t))}function qe(e,t){const n=Ke(e,t,hE)
return null===n||o(n)?null:Object.keys(n).filter(e=>e!==RY)}function We(e){const t={}
Ye(e,nx)&&(t[EP]=e.productPageId)
const n=e.treatmentPageIdMap[RY],r=e.experimentIdMap[RY],o=e.experimentLocaleMap[RY]
return Ye(e,LM)&&(t.pageVariantId=n,t.pageExperimentId=r,t.pageExperimentLocale=o),t}function ze(e){const t={}
Ye(e,nx)&&(t[EP]=e.productPageId)
const n=e.treatmentPageIdMap[RY],r=e.experimentIdMap[RY],o=e.experimentLocaleMap[RY]
return Ye(e,LM)&&(t.variantId=n,t[vD]=r,t[OP]=o),t}function Ye(e,t){if(r(e))return!1
switch(t){case nx:return s(e.productPageId)&&e.productPageId!==RY
case LM:return s(e.experimentIdMap)
default:x(t)}}function Je(e,t,n){for(const r of n){const n=He(e,r)
i(n)&&t.addingQuery(`ppid[apps:${r.id}]`,`${n}`)}}function Ke(e,t,n,r,o){if(r||(r=nt(e,t)),(0,Zv.isNothing)(r))return null
let i=se(t,r,n)
return i||(i=B(t,n,o)),i}function Ze(e,t,n,r){const i=null!=r?r:nt(e,t)
if((0,Zv.isNothing)(i))return[]
let s=ae(t,i,n)
return o(s)&&(s=G(t,n)),s}function Qe(e,t,n,r,o=qH){let i
const s=null!=r?r:nt(e,t)
return(0,Zv.isSome)(s)&&(i=ce(t,s,n,o)),i||(i=j(t,n,o)),i}function Xe(e,t,n,o,i=qH){if(o||(o=nt(e,t)),(0,Zv.isNothing)(o))return null
let s=le(t,o,n,i)
return r(s)&&(s=V(t,n,i)),s}function et(e,t,n,o){if(o||(o=nt(e,t)),(0,Zv.isNothing)(o))return!1
let i=le(t,o,n)
return r(i)&&(i=H(t,n)),i}function tt(e,t,n,o=qH){const i=nt(e,t)
if((0,Zv.isNothing)(i))return null
let s=function(e,t,n,o=qH){const i=oe(e,t)
return r(i)?null:h(i,n,o)}(t,i,n,o)
return r(s)&&(s=q(t,n)),s}function nt(e,t,n){const o="bestAttributePlatformFromData",i=(0,Zv.isSome)(n)?`${o}.${n}`:o
return $(t,i,()=>{const o=$e(e,t,[Uq,Bq,hN],!0),i=xe(e,t,oj),s=xe(e,t,vW),a=xe(e,t,gW),c=xe(e,t,aH)
let l=null
if(i?l=lV:s?l=vH:o?l=xq:a?l=gW:c&&(l=uH),!r(l))return l
const u=function(e,t){const n=rt(e)
if(null===n)return[]
switch(n){case xq:return t===Vz||t===jz?[uH,xq,lV,vH]:[xq,lV,vH,uH]
case vH:return[vH,xq,lV,uH]
case lV:return[lV,xq,vH,uH]
case gW:return[xq,gW,vH,uH]
case uH:return[uH,xq,lV,vH]
default:return[n]}}(e,n)
for(const e of u)if(ie(t,e))return e
return rt(e)})}function rt(e){var t
if(null===(t=e.activeIntent)||void 0===t?void 0:t.attributePlatform)return e.activeIntent.attributePlatform
switch(e.client.deviceType){case lW:case oW:return xq
case"tv":return lV
case vW:return vH
case gW:return gW
case iW:return uH
default:return null}}function ot(e,t,n,r,o){const i=Y(r)
if((0,Zv.isNothing)(i))return null
const a=je(0,Ke(e,t,hE,o),n,i,J(i))
return s(a)?p(a):Ke(e,t,r,o)}function it(e,t,n,r,o){const i=Y(r)
if((0,Zv.isNothing)(i))return null
const a=je(0,Ke(e,t,hE,o),n,i,J(i))
return s(a)?f(a):Qe(e,t,r)}function st(e){return null!==DY||(DY={bundleIdFromData:t=>Qe(e,t,kq),isSystemAppFromData:e=>H(e,sG),isUnsupportedDeletableSystemAppFromData:e=>!1,adamIdFromSystemBundleId(e){}}),DY}function at(e,t,n=rm.All){let o=!1
return n&rm.ThirtyTwoBit&&(o=o||function(e,t){return et(e,t,Qy)||et(e,t,Xy)}(e,t)),n&rm.UnsupportedSystemDeletableApps&&(o=o||function(e,t){return $(t,"shouldFilterDeletableSystemApp",()=>{const n=st(e)
if(!n.isSystemAppFromData(t))return!1
const r=n.bundleIdFromData(t),o=e.host.deviceModel,s=o.startsWith(nA),a=o.startsWith(rA)
let c
switch(c=!!th(e,"12.3")||e.bag.isTVAppEnabled,r){case"com.apple.Bridge":case"com.apple.Passbook":return!s
case"com.apple.Photo-Booth":return!a
case"com.apple.tv":return!c
case"com.apple.videos":return c
case"com.apple.iCloudDriveApp":return!0
case"com.apple.facetime":case"com.apple.mobilephone":return!lt(e,"any-telephony")||!lt(e,"venice")
case"com.apple.Fitness":if(a||s){let t=!1
return i(e.user.isFitnessAppInstallationAllowed)&&(t=e.user.isFitnessAppInstallationAllowed),!t}return!0
case"com.apple.measure":return!lt(e,"arkit")
case"com.apple.Jellyfish":return!lt(e,"front-depth-camera")
case eA:case tA:return!0
case"com.apple.NanoHeartRhythm":return!e.client.isElectrocardiogramInstallationAllowed
case oA:return!lt(e,"magnetometer")
case"com.apple.NanoOxygenSaturation.watchkitapp":return!e.client.isScandiumInstallationAllowed
case iA:case"com.apple.NanoRadio":return!0
case sA:return!e.client.isCharonSupported
case aA:return!e.client.isMandrakeSupported
case"com.apple.GenerativePlaygroundApp":return!lt(e,"generative-model-systems")
case zk:const t=a&&e.clientCapabilities.isEnabled(PY)
return!(s||t)}return!1})}(e,t)),n&rm.UnsupportedWatchAppOnWatchClient&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const n=et(e,t,hH),r=t.type===aW
return e.host.clientIdentifier===hY&&!n&&!r})}(e,t)),n&rm.DisabledMerchandisableIAPs&&(o=o||function(e,t){return t.type===rq&&!s(p(t,XF))&&!s(p(t,vL))&&!H(t,"isMerchandisedEnabled")}(0,t)),n&rm.LegacyApps&&(o=o||function(e,t){return $(t,"shouldFilterLegacyApps",()=>{switch(Qe(e,t,kq)){case"com.apple.mobileme.fmip1":case eA:return!0}return!1})}(e,t)),n&rm.LegacyProductionMacOSInstaller&&(o=o||function(e,t){return $(t,"isLegacyMacOSInstaller",()=>(Qe(e,t,kq),!1))}(e,t)),n&rm.UnsupportedPlatform&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatform",()=>!dh(e,t))}(e,t)),n&rm.UnsupportedPlatformForMacCharts&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatformForCharts",()=>{if(t.type!==yW&&t.type!==aW)return!1
const n=gf(e,t),r=Sf(0,t,!0)
return!Of(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&rm.UnsupportedPreorders&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!H(t,Sq))return!1
if(t.type!==yW)return!1
const n=gf(e,t),r=Sf(0,t,e.appleSilicon.isSupportEnabled)
return!Df(0,n,e.client.deviceType,r,!1)})}(e,t)),n&rm.MinimumOSRequirement&&(o=o||ct(e,t)),n&rm.SADWatchApps&&(o=o||function(e,t){const n=H(t,sG),r=!et(e,t,fO)&&et(e,t,FG)
return n&&r}(e,t)),n&rm.MinimumCompanionOSRequirement&&(o=o||function(e,t){return e.client.deviceType===gW&&(!et(e,t,FG)&&!et(e,t,dO)&&!function(e,t){return!(!r(t)&&0!==t.length)||e.client.isPairedSystemVersionAtLeast(t)}(e,ce(t,nt(e,t),LH)))}(e,t)),n&rm.MacOSCompatibleIOSBinary&&(o=o||function(e,t){return e.client.deviceType===vW&&(et(e,t,mL,rt(e))&&!e.appleSilicon.isSupportEnabled)}(e,t)),n&rm.MacOSRosetta&&(o=o||function(e,t){const n=gf(e,t)
return!(e.client.deviceType!==vW||!n.includes(vW))&&!Rf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable)}(e,t)),n&rm.VisionOSCompatibility&&(o=o||function(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=ue(t,xq,hO)
return!(gf(e,t).indexOf(iW)>-1||n)}(e,t)),n&rm.SADMinimumOSRequirement&&(o=o||function(e,t){return!!st(e).isSystemAppFromData(t)&&ct(e,t)}(e,t)),o}function ct(e,t){return!(!e.client.isPhone||!et(e,t,FG)||function(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.client.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(o,i,s)}(e,Qe(e,t,eN)))||!th(e,If(e,t,e.appleSilicon.isSupportEnabled))}function lt(e,t,n){return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp([t],!1)}function ut(e){if((0,Zv.isNothing)(e))return
const t=e.toLocaleLowerCase()
return function(e){return _Y.includes(e)}(t)?t:void 0}function dt(e){return e.startsWith("id")?e.substring(2):e}function ft(e){return A(e)&&function(e){return(0,Jv.isSome)(MY[e])}(e.$kind)}function ht(e){return T(e)&&e[PW]===Wy}function pt(e){var t
switch(e){case iL:return"arcadeAskToBuy"
case Pj:return by
case Qx:return Ay
case sL:return"arcadeLaunchRepair"
case cH:return rL
case"topShelfATV":return"arcadeTopShelfATV"
case"topShelfATVClickThrough":return"arcadeTopShelfATVClickThrough"
case Ij:return"arcadeTodayCard"
case aL:return"arcadeStoryCanvas"
case qF:return qF
case iU:return iU
case tO:return tO
default:return null!==(t=e)&&void 0!==t?t:by}}function wt(e){return T(e)&&e[PW]===By}function gt(e){return T(e)&&e[PW]===sO}function vt(e){return ft(e)&&e[PW]===Qk}function mt(e){return function(e){return A(e)&&function(e){return(0,Jv.isSome)(hJ[e])}(e[PW])}(e)&&e[PW]===my}function yt(e,t){const n=l(t,zj)
return n.length>1&&e.console.warn("tried to extract data from container but more than one member present"),1!==n.length?null:n[0]}function At(e){return l(e,zj)}function Tt(e){const t=uk,r=n(e,cR)
return e.label===t||i(r)}function bt(e){return l(e,zI)}function St(e){return p(e,ZR)}function Pt(e,t){return t&&t.remainingContent?t.remainingContent.slice(0,t.maxPerPage):[]}function It(e,t,n){const r={...t}
if(t&&t.remainingContent){const e=Ct(0,t.remainingContent,t.maxPerPage,n)
r.remainingContent=e}return r}function Ct(e,t,n,r){return t.slice(n,null!=r?r:t.length)}function kt(e,t=!1,n=!1,r=O6.Default){const o=function(e,t){let n
switch(e.host.clientIdentifier){case Fz:case Nz:case Gz:n=!1
break
default:n=e.client.supportsHEIF}return t?n?F$:EL:n?F$:ME}(e,t)
return function(e,t,n=!1,r=O6.Default){return new JJ(t,t===F$?60:70,n)}(0,o,n,r)}function Ot(e,t,n=0,r=0,o=null,i=null,s=null){const a=new bz(t,n,r,[kt(e,!1,!1,O6.Default)])
return a.backgroundColor=o,a.textColor=i,a.checksum=s,a}function Et(e){return`resource://${e}`}function Rt(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}function Dt(e,t){var n
const r=null!==(n=t.excludingFields)&&void 0!==n?n:[]
return r.push("amsMetricsID"),new mK(t.fields,t.includingFields,r,t.topic,t.shouldFlush)}function _t(e,t,n,r,o,i){const s={}
Object.assign(s,r),s[nV]=OG,s[Q$]=n,s[mR]=t
const a=["impressionsSnapshot",MU]
return a.push(uS),o&&a.push(...o),Ft(e,s),Dt(0,new mK(s,a,[],$t(e,s),xt(e,s,null,i)))}function Lt(e,t,n,r,o,i,s){const a={}
Object.assign(a,i),a[rj]=t,a[Q$]=n,a[jG]=r,o&&(a[jN]=o),a[nV]=Rq
const c=[jM]
return s&&c.push(...s),Ft(e,a),Dt(0,new mK(a,c,[],$t(e,a),xt(e,a)))}function Mt(e,t,n,r,o){const i={}
Object.assign(i,t),i[nV]=IH,i[VN]="data-metrics",i[HN]=4
const s=[IH,MU,jM]
return s.push(uS),n&&s.push(HM),r&&s.push(qN),o&&s.push("impressionsAppendix"),Ft(e,i),Dt(0,new mK(i,s,[HN],$t(e,i),xt(e,i)))}function xt(e,t,n=null,r){var o,i
const a=t[nV]
let c=!1
if(!s(a))return c
const l=null!=r&&r
switch(a){case OG:c=u(t,vK.hasIAdData)||l
break
case TR:c=!0
break
case IH:c=u(t,vK.hasIAdData),t[VN]!==yR||(null===(o=null==n?void 0:n.adPageInfo)||void 0===o?void 0:o.placementType)!==oq&&(null===(i=null==n?void 0:n.adPageInfo)||void 0===i?void 0:i.placementType)!==SH||(c=!0)
break
case SW:c=e.host.clientIdentifier===vY&&(u(t,vK.hasIAdData)||l)}return e.host.clientIdentifier,c}function $t(e,t){return t[p$]||e.bag.metricsTopic}function Ft(e,t){e.bag.isMetricsAb2DataFallbackEnabled&&(0,Jv.isSome)(e.experimentCache)&&(t.alt_ab2_data=JSON.stringify(e.experimentCache.createAb2Data()))}function Nt(e){var t
const n={}
if(!e)return n
Object.assign(n,e.baseFields),e.pageUrl?n[xU]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(n[xU]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(n,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(n,e.mercuryMetricsData),e.productVariantData&&Object.assign(n,We(e.productVariantData)),e.adPageInfo&&i(e.adPageInfo.pageFields[vK.hasIAdData])&&(n[vK.hasIAdData]=e.adPageInfo.pageFields[vK.hasIAdData])
const r=null===(t=e.adPageInfo)||void 0===t?void 0:t.pageFields[RG]
return i(r)&&(n[RG]=r),mh(n)}function Bt(e){return A(e)&&"TodayCard"===e[PW]}function Ut(e,t){return s(B(t,GG))}function Gt(e,t,n,o,i=!0,s){if(!o.isAdvert)return void Vt(e,t,n,o)
n.searchAdOpportunity=function(e,t,n,o){const i=function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=B(t,GG),a=j(t,"iad.impressionId"),c=j(t,"iad.privacy"),l=j(t,_M),u=new bK(c)
u.title=e.adsLoc.string("IAD_PRIVACY_MARKER_BUTTON_TITLE")
const d=Yf(e,t)?VB:DM,f=H(t,Sq)?iH:wW,h=Yt(0,n),p=new QY(i,t.id,l,d,"markerPress",f,h),w=Wt(i,n,a,o),g=zt(0,u,p)
return new SK(i,s,w,a,g)}(e,t,n,o)
return new TK(i.instanceId,i.eventPayloads,i)}(e,t,o.pageInformation,s)
const a=n.searchAdOpportunity.searchAd,c=Yf(e,t)?VB:DM,l=Yt(0,o.pageInformation),u=j(t,_M),d=H(t,Sq)?iH:wW,f=new QY(a.instanceId,t.id,u,c,qb,d,l)
n.clickAction=zt(0,n.clickAction,f)
const h=new QY(a.instanceId,t.id,u,c,Wb,d,l)
n.buttonAction=zt(0,n.buttonAction,h),n.itemBackground=e.clientCapabilities.isEnabled("insetAdItemBackground")?uR:"ad",n.offerDisplayProperties&&i&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,xj,"ad")),H(t,"iad.format.userRating")||(n.rating=null,n.ratingCount=null),Vt(e,t,n,o)}function jt(e){const t=u(B(e,GG),"passthroughAdInfo.deepLinkEligible"),n=u(e,"meta.passthroughAdInfo.deepLinkEligible")
return t||n}function Vt(e,t,n,o){const i=jh(e,t,n,Th(e,t,n.icon,null),o,!0)
!function(e,t,n){var o,i,s,a,c,l,u,d,f,h,p,w
const g=null!==(i=null===(o=t.searchAdOpportunity)||void 0===o?void 0:o.searchAd)&&void 0!==i?i:t.searchAd
if(r(g))return
null===(s=t.clickAction)||void 0===s||s.actionMetrics.clearAll(),t.clickAction&&Xs(e,t.clickAction,n,!0)
const v=n.pageInformation,m={actionType:"ad_transparency"};(null==v?void 0:v.adPageInfo)&&Object.assign(m,v.adPageInfo.clickFields),(null===(c=null===(a=null==n?void 0:n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType)===vq&&(0,Zv.isSome)(null===(l=null==n?void 0:n.adsMetricsData)||void 0===l?void 0:l.iAdSlotId)&&(m[uF]=null===(u=null==n?void 0:n.adsMetricsData)||void 0===u?void 0:u.iAdSlotId),(0,Zv.isSome)(null===(d=null==n?void 0:n.adsMetricsData)||void 0===d?void 0:d.iAdDuplicateLayoutType)&&(m[sx]=null===(f=null==n?void 0:n.adsMetricsData)||void 0===f?void 0:f.iAdDuplicateLayoutType)
const y=_t(e,t.adamId,TW,m)
null!==(w=null===(p=null===(h=null==v?void 0:v.adPageInfo)||void 0===h?void 0:h.shouldIncludeAdRotationFields)||void 0===p?void 0:p.call(h,e))&&void 0!==w&&w&&y.includingFields.push(qN),g.transparencyAction.actionMetrics.addMetricsData(y)}(e,n,i),Gh(e,n,i,i.pageInformation.adPageInfo)}function Ht(e){var t
return[zb,"U","I",(null!==(t=null==e?void 0:e.artwork)&&void 0!==t?t:[]).length].join("")}function qt(e,t){let n
const r=null==t?void 0:t.adPageInfo.placementType
if((0,Jv.isSome)(r))try{n=e.ads.getIdentifierForMissedOpportunity(r)}catch{n=e.random.nextUUID(),Zt(e,`Error: getIdentifierForMissedOpportunity threw exception. Assigned ${n}`)}else n=e.random.nextUUID(),Zt(e,`Error: placementType was null or empty. Assigned ${n}`)
const o=Wt(n,t,e.random.nextUUID())
return new TK(n,o)}function Wt(e,t,n,r){const o=null==t?void 0:t.baseFields.pageId,i=typeof o===zq?o:Xq
return{placed:{adInstanceId:e,impressionId:null!=n?n:void 0,slot:null!=r?r:void 0,pageIdentifier:i},pageEnter:{pageIdentifier:i},pageExit:{pageIdentifier:i},onScreen:{adInstanceId:e},offScreen:{adInstanceId:e},visible:{adInstanceId:e},completed:{adInstanceId:e}}}function zt(e,t,n){const r=new PK(n),o=new iK([r,t])
return o.title=t.title,o}function Yt(e,t){const n=null==t?void 0:t.adPageInfo
if(r(n))return _U
const o=n.placementType
switch(o){case kV:return Jb
case vq:return"searchAds"
case tW:case oq:case SH:return Jb
default:throw new Error(`This method should never be called with value: ${o}`)}}function Jt(e){return!!function(e){return e.host.clientIdentifier===fY||e.host.clientIdentifier===vY}(e)||e.host.platform===Xq}function Kt(e,t){if(!Jt(e))return!1
switch(t){case kV:const n=en(t)
return(0,Jv.isSome)(n)?e.bag.isSearchLandingAdsEnabled||e.bag.enabledAdPlacements.includes(n):e.bag.isSearchLandingAdsEnabled
case vq:return!0
case tW:const o=en(t)
return!r(o)&&e.bag.enabledAdPlacements.includes(o)&&(0,Jv.isSome)(Qt(e))
case oq:case SH:const i=en(t)
return!r(i)&&e.bag.enabledAdPlacements.includes(i)
default:return!1}}function Zt(e,t){e.console.log(`[Ads] ${t}`),e.client.buildType===cG&&e.isAvailable(Xz)&&i(e.ads.debugLog)&&((0,Jv.isNothing)(GK)&&(0,Jv.isSome)(e.ads.isNativeAdLoggingEnabled)&&(GK=e.ads.isNativeAdLoggingEnabled()),GK&&e.ads.debugLog(t))}function Qt(e){if(e.bag.todayAdMediumLockupScreenshotEnabled)return fq
if(e.bag.todayAdCondensedEnabled){if(!e.client.isPhone)return
return n$}return function(e){return!!e.client.isPhone&&Ne(e,nm.CondensedTodayAds)===AK}(e)?n$:void 0}function Xt(e,t,n){var r,o,i,s,a
const c=e.bag.adPlacementTimeouts,l=.3
switch(t){case vq:return n?null:null!==(r=null==c?void 0:c["search-results-in-seconds"])&&void 0!==r?r:l
case kV:return n?null:null!==(o=e.bag.searchLandingAdFetchTimeout)&&void 0!==o?o:l
case tW:return n?null!==(i=null==c?void 0:c["today-in-seconds"])&&void 0!==i?i:l:null
case oq:return n?null:null!==(s=null==c?void 0:c["product-page-ymal-in-seconds"])&&void 0!==s?s:l
case SH:return n?null:null!==(a=null==c?void 0:c["product-page-ymal-during-download-in-seconds"])&&void 0!==a?a:l
default:return l}}function en(e){switch(e){case vq:return rN
case kV:return oN
case tW:return tW
case oq:return"product-page-ymal"
case SH:return"product-page-ymal-during-download"
default:return}}function tn(e){return e.bag.enableSRPNextSlot&&e.clientCapabilities.isEnabled(IY)}function nn(e){return e.bag.enableSRPV5Impressions&&e.clientCapabilities.isEnabled(IY)}function rn(e,t){return t===vq&&nn(e)}function on(e,t){return t===vq&&!nn(e)}function sn(e,t){var n
if(!tn(e))return
const r=f(t,pA)
if((0,Jv.isNothing)(r))return
const o=null===(n=w(JSON.parse(r).intendedSlots))||void 0===n?void 0:n.filter(e=>typeof e===sj)
return(0,Jv.isNothing)(o)?void 0:o}function an(e,t,n,r){if((0,Jv.isNothing)(t))return
if(n)switch(t){case kV:return
case vq:if(!nn(e))return}if(t===vq){const t=sn(e,r)
if((0,Jv.isSome)(t)&&t.length>0)return t.map(e=>({shelfIdentifier:rN,slot:e}))}const o=en(t)
return(0,Jv.isNothing)(o)?void 0:e.bag.adPlacementEligibleSlotPositions[o]}function cn(e,t,n,r,o){var i
if((0,Jv.isNothing)(n)||(0,Jv.isNothing)(t))return!1
const s=null===(i=Rh(n))||void 0===i?void 0:i.id
if((0,Jv.isNothing)(s))return!1
const a=ln(e,t,s,r,o),c=Eh(n)
return a.includes(c)}function ln(e,t,n,r,o){const i=an(e,t,r,o)
if((0,Jv.isNothing)(i))return[]
const s=[]
for(const e of i)e.shelfIdentifier===n&&s.push(e.slot)
return s}function un(e,t,n,o,i){var s,a,c,l
if(!Jt(e)||r(i.adPageInfo))return
const u=ln(e,n,o,!1)
if(0===u.length)return
const d=[]
for(const e of t){if(e.contentType!==Lq&&e.contentType!==qj)continue
const t=e.items;(0,Jv.isSome)(t)&&t.length>0&&d.push(...t)}for(const t of u){const n=null===(s=i.adPageInfo)||void 0===s?void 0:s.missedOpportunityReason(o,t)
if((0,Jv.isNothing)(n)||n===wA||n===gA)return
const r=d[t]
if((0,Jv.isSome)(r.searchAdOpportunity))return
if(Bt(r)&&(0,Jv.isSome)(null===(a=r.media)||void 0===a?void 0:a.searchAdOpportunity))return
r.searchAdOpportunity=qt(e,i),null===(c=r.searchAdOpportunity)||void 0===c||c.setMissedOpportunityReason(n),null===(l=r.searchAdOpportunity)||void 0===l||l.setTemplateType(lG)}}function dn(e,t,n,o=null){var i,s
return!Jt(e)||r(n)?null:new s1(e,t,s1.createInitialPageSlotInfos(e,t,null===(i=null==n?void 0:n.onDeviceAd)||void 0===i?void 0:i.positionInfo,o,void 0),n.iAdId,n.clientRequestId,void 0,null===(s=n.onDeviceAd)||void 0===s?void 0:s.positionInfo)}function fn(e,t){return j(t,jK)}function hn(e,t,n){s(null==t?void 0:t.attributes)&&(t.attributes[jK]=n)}function pn(e,t,n,r){var i,a,c,l,u
const d=e.bag.adsOverrideLanguage
if(o(d)||o(t))return!0
let f=null===(i=t.meta)||void 0===i?void 0:i.resource
if(o(f)&&s(n)&&(f=null===(u=null===(l=null===(c=null===(a=null==n?void 0:n.appMetadata)||void 0===a?void 0:a.data)||void 0===c?void 0:c[0])||void 0===l?void 0:l.meta)||void 0===u?void 0:u.resource),o(f))return!1
if(j(f,"name.locale")!==d)return!1
const h=Qe(e,t,NH),p=Qe(e,f,"subtitle.locale")
if(s(h)&&p!==d)return!1
if(r===NK){const n=j(t,vA)
if((0,Jv.isSome)(n)&&n!==Iq){let r
const o=n
r=n===Mq?BG:n
const i=Qe(e,t,r),a=Qe(e,f,o.concat(".locale"))
if(s(i)&&a!==d)return!1}}return!0}function wn(e,t,n){const r=n.reco_algoId
if(o(r)||o(e)||o(t[r]))return e
const i=e.map(e=>{var t
return{identifier:h(e.id),score:null!==(t=h(e,wx))&&void 0!==t?t:0}}),s=t[r],a=(0,hm.demoteByEngagements)(i,s),c=e.reduce((e,t)=>({...e,[t.id]:t}),{})
return a.map(e=>c[e.identifier.toString()])}function gn(e,t){if(!s(t))return{}
const n=p(t,"data.engagementEvents.impression"),r={}
for(const e in n)if(s(e)){const t=l(n,e)
r[e]=t.map(e=>({adamIdentifier:h(e[HV]),timestamp:h(e.eventTimeMillis)}))}return r}function vn(e){return e.bag.enableRecoOnDeviceReordering}function mn(e){return e===JK.Apps.toString()?qK:e===JK.Games.toString()?WK:HK}function yn(e){const t=e.categories
if(s(t)){const e=t[0].genreId
if(e===JK.Games.toString())return WK
if(e===JK.Apps.toString())return qK}return HK}function An(e,t,n=e.host.clientIdentifier,r=[]){t||(t=JK.Apps)
const o=new yY(e).forType(uB).includingAdditionalPlatforms(r).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAgeRestrictions().addingQuery(_H,`${t}`)
return n===hY?o.addingContext(gW):n===pY&&o.addingContext(pq),o}function Tn(e,t,n=!0){return Kv.context("categoryListFromApiResponse",()=>{const r=l(t,"results.categories"),o=bn(e,p(r,"0"),n)
return o?new zK(o.children):null})}function bn(e,t,n=!0){return Kv.context("categoryFromApiResponse",()=>{if(!t)return null
const r=f(t,AW),o=f(t,_H),s=f(t,dB),a=Xd(e,p(t,fW),{allowingTransparency:!0,useCase:O6.CategoryIcon}),c=l(t,fH).map(t=>bn(e,p(t),n)).filter(e=>i(e)),u=function(e,t){return t.sort((t,n)=>{try{return t.name.localeCompare(n.name,e.loc.safeIdentifier,{usage:rH})}catch(e){return 0}})}(e,c),d=f(t,nq)
return d&&n&&u.unshift(new YK(d,o,a,s,[])),new YK(r,o,a,s,u)})}function Sn(e,t,n=!1,r=!1,o=!0){const i=n?"contentIconTrimmedMonochrome":"contentIconTrimmed",s="brandLogo",a=Ke(e,t,Hq)
if(r)return p(a,s)
{let e=p(a,i)
return o&&(0,Jv.isNothing)(e)&&(e=p(a,s)),e}}function Pn(e){const t=j(e.data,DN)
return t===vm.Horizontal?vm.Horizontal:t===vm.Condensed?vm.Condensed:vm.Vertical}function In(e,t){if(!t.isFirstRender)return s(t.remainingItems)?t.remainingItems:[]
const n=we(t.data,mW)
return s(n)?n:[]}function Cn(e,t){let n=null
switch(t.type){case sW:case aq:case bU:n=pe(e,t,RH)||pe(e,t,$H)||pe(e,t,mW)||pe(e,t,rW)
break
case yW:case rq:case aW:n=t}return n}function kn(e,t){if(o(t))return null
const n=l(t.meta,"associations.editorial-cards.data")
return o(n)?null:n[0]}function On(e,t){return g({...B(t,pj,{}),...B(kn(0,t),pj,{})})}function En(e){return{showAppIcon:d(e.showAppIcon,!1),suppressLockup:d(e.suppressLockup,!1),useGeneratedBackground:d(e.useGeneratedBackground,!1),useMaterialBlur:d(e.useMaterialBlur,!0),useTextProtectionColor:d(e.useTextProtectionColor,!1)}}function Rn(e,t){if(!W(t))return null
let n
return n=t.type===sW?sh(e,t):t,W(n)?n:null}function Dn(e,t){const n=s(B(t,jq)),r=H(t,wU)
return!n&&!r}function _n(e,t){const n=t.type
return n!==pm.Collection&&n!==pm.Recommendations?null:j(t,MH)}async function Ln(e,t,n){var r
const o=Date.now(),i=await e.mediaToken.refreshToken(),s=e.fetchTimingMetricsBuilder,a=null!=n?n:{},c=null===(r=e.personalizationMetricsIdentifiersCache)||void 0===r?void 0:r.getMetricsIdForType(im.user);(0,Zv.isSome)(c)&&((0,Zv.isSome)(null==a?void 0:a.headers)?a.headers[ZK]=c:a.headers={[ZK]:c})
const l=await xn(e,t,i,a,!1,s),u=Date.now()
t.canonicalUrl&&(l[Sm.requestedUrl]=t.canonicalUrl)
const d=u-o
if(d>500){const n=ve(e,t).toString()
e.console.warn("Fetch took too long ("+d.toString()+"ms) "+n)}return l}function Mn(e,t){return e.bag.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return i(null===(n=t.query)||void 0===n?void 0:n[e])})}async function xn(e,t,n,a={},c=!1,l){var d,f
const p=ve(e,t).toString(),w=new wz(p),g=Mn(e,w)
for(const e of g)w.removeParam(e)
const v=w.toString()
let m=a.headers
m||(m={}),m.Authorization="Bearer "+n
const A=await e.network.fetch({url:v,headers:m,method:a.method,body:a.requestBodyString,timeout:a.timeout})
try{if(401===A.status||403===A.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
return e.mediaToken.resetToken(),await e.mediaToken.refreshToken().then(async n=>await xn(e,t,n,a,!0,l))}if(404===A.status)throw $n()
if(!A.ok){const e=new QK(`Bad Status code ${A.status} for ${v}, original ${p}`)
throw e.statusCode=A.status,e}const n=n=>{var c,l
const d=Date.now()
let f
if(r(n.body)||""===n.body){if(204!==n.status)throw $n()
f={}}else try{f=JSON.parse(n.body)}catch(t){let r=t.message
throw[YG,cG].includes(e.client.buildType)&&(r=`${t.message}, body: ${n.body}`),new XK(r)}const w=Date.now()
if(f){if(f[Sm.pageInformation]=y(function(e,t){const n=e.client.storefrontIdentifier
let r=null
if((null==n?void 0:n.length)>0){const e=n.split("-")
s(e)&&(r=e[0])}return{serverInstance:t.headers[eZ],storeFrontHeader:n,language:e.bag.language,storeFront:r,environmentDataCenter:t.headers[tZ]}}(e,n)),n.metrics.length>0){const e={...n.metrics[0],parseStartTime:d,parseEndTime:w}
f[Sm.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:d,parseEndTime:w}
f[Sm.timingValues]=e}if(f[Sm.contentMaxAge]=function(e,t){const n=Object.keys(t.headers).find(e=>"cache-control"===e.toLowerCase())
if(r(n)||""===n)return null
const i=t.headers[n]
if(o(i))return null
const s=i.match(/max-age=(\d+)/)
return r(s)||s.length<2?null:h(s[1])}(0,n),Array.isArray(f.data)&&i(l=f.data)&&0===l.length&&!u(a.allowEmptyDataResponse))throw $n()
Array.isArray(f.data)&&t.originalOrdering.length>1&&(f.data=function(e,t,n,r=[]){const o={}
for(const e of n)o[e.id]=e
const i=[]
for(const e of t){const t=o[e.id]
if((0,Zv.isSome)(t)){if(s(r)){t.meta={...e.meta}
for(const n of r)Fn(0,n,t,e,o)}i.push(t)}}return i}(0,t.originalOrdering,null!==(c=f.data)&&void 0!==c?c:[],t.supplementaryMetadataAssociations)),f[Sm.requestedUrl]=p}return f}
return(0,Zv.isSome)(l)?l.measureParsing(A,n):n(A)}catch(e){if(e instanceof QK)throw e
const t=null!==(d=A.headers["x-apple-jingle-correlation-key"])&&void 0!==d?d:null===(f=A.metrics[0])||void 0===f?void 0:f.clientCorrelationKey
throw new Error(`Error Fetching - filtered: ${v}, original: ${p}, correlationKey: ${null!=t?t:"N/A"}, ${e.name}, ${e.message}`)}}function $n(){const e=new QK("No content")
return e.statusCode=204,e}function Fn(e,t,n,r,o){var i;(0,Zv.isNothing)(n.meta)?n.meta={associations:{}}:(0,Zv.isNothing)(n.meta.associations)&&(n.meta.associations={})
const a=re(t,r)
if(s(a)){const e=[]
for(const t of a){const n=o[t.id];(0,Zv.isSome)(n)&&e.push(n)}(null!==(i=p(n.meta.associations))&&void 0!==i?i:{})[t]={data:e}}}function Nn(e){return T(e)&&e[PW]===Uy}function Bn(e,t,n,r){const o=Eh(r.locationTracker),i={impressionIndex:o,id:o.toString(),idType:Oq,name:t.displayName,impressionType:n,parentId:rC}
t.impressionMetrics=new KY(i)}function Un(e,t,n,r,o,s){var a,c,l
const u=null!==(a=g(r,Sm.pageInformation,{}))&&void 0!==a?a:{},d=g(r,Sm.timingValues),h=f(r,Sm.requestedUrl)
let p
const w=u
if(w.pageType=t,w.pageId=n,o&&(w[NU]=o),t===NV){const t=yt(e,r)
if((0,Zv.isSome)(t)){const n=j(t,AW),r=j(t,pH)
w[NU]=`${r}_${n}`,Yf(e,t)&&(w[zN]=Pq),p=Ge(e,t)}}else t===QE?w[NU]=`${t}_${n}`:t===VV?w[NU]=dE:t===DG&&n===DG&&(w[NU]=`${t}_${n}`)
const v=new uK(null!==(c=mh(w))&&void 0!==c?c:{})
null!==d&&(v.timingMetrics=d,(0,Zv.isSome)(h)&&(v.pageUrl=h)),i(p)&&(v.productVariantData=p)
const m=null!=s?s:Js(e,n,r)
return(0,Zv.isSome)(m)&&(v.adPageInfo=m),v.recoMetricsData=null!==(l=St(r))&&void 0!==l?l:void 0,v}function Gn(e,t,n,r,o){var i
const s=new uK({pageType:t,pageId:n,page:`${t}_${n}`,pageDetails:r})
if(o){const t=s1.placementTypeFromPlacementId(e,f(o,EG))
s.adPageInfo=new s1(e,t,s1.createInitialPageSlotInfos(e,t,null,null,null),null!==(i=f(o,RG))&&void 0!==i?i:void 0),s.adPageInfo.applyClickFieldsFromPageRequest(n,o)}return s}function jn(e,t,n,o,i){if(r(n))return
t.pageMetrics.pageFields=Nt(n),t.pageMetrics.addManyInstructions(Qn(e,n,o)),t.pageMetrics.addData(Jn(e,n,o,i),[Im.PageInvocationPoint.pageEnter]),t.pageMetrics.addData(function(e,t,n){const r=Jn(e,t,n)
return r.fields[nV]=gS,r}(e,n,o),[Im.PageInvocationPoint.pageExit]),t.pageMetrics.pageRenderFields=Zn(e,n,o),t.pageRenderMetrics=Zn(e,n,o),function(e){const t=A(o=e)&&o[PW]===sV,n=function(e){return A(e)&&e[PW]===vy}(e),r=function(e){return A(e)&&e[PW]===Sy}(e)
var o
return!t&&!n&&!r}(t)&&t.pageMetrics.addData(Kn(e,n,o),[Im.PageInvocationPoint.backButton])
const s=e.fetchTimingMetricsBuilder;(0,Zv.isSome)(s)&&s.decorate(t)}function Vn(e,t){return new uK({pageType:XH,pageId:t,page:`${XH}_${t}`})}function Hn(e,t,n,r){const o={pageId:tF,pageType:VV}
r&&(o[pZ]=r)
const i=new uK(o)
return i.pageUrl=n,i}function qn(e,t,n,r,i,a,c,l,u){const d=Un(e,VV,a,n)
return d.searchTermContext=r,d.pageUrl=i,u&&(d.guidedSearch=function(e,t,n){const r={}
if(s(t.guidedSearchTokens)&&(r.searchSelectedGuidedFacets=t.guidedSearchTokens),n&&n.finalTerm&&(r.searchGuidedFinalQuery=n.finalTerm),!o(r))return r}(0,t,u)),Jt(e)&&(0,Zv.isSome)(c)&&(d.adPageInfo=new s1(e,vq,s1.createInitialPageSlotInfos(e,vq,null,null,n.meta),c.iAdId,c.appStoreClientRequestId,l)),d}function Wn(e,t,n,r,o,s){let a="",c=""
switch(t){case Pm.AppEvent:a=`${n}_${r}`,c=vB
break
case Pm.ContingentOffer:case Pm.OfferItem:a=`${n}`,c="OfferDetails"}const l={pageId:a,pageType:c}
i(o)&&(l[rF]=o[rW],l[WB]=o[lB])
const u=new uK(l)
return u.recoMetricsData=null!=s?s:void 0,u}function zn(e,t){if(r(t)||r(t.pageMetrics))return
const n=t.pageMetrics.instructions
if(!r(n))for(const e of n)e.data.fields[nV]===SW&&e.data.includingFields.push(VM)
let o=null
if(vt(t)?o=t:mt(t)&&(o=t.lockup),o){const e=[]
if(Nn(o.buttonAction))e.push(o.buttonAction)
else if(T(i=o.buttonAction)&&i[PW]===jy&&Nn(o.buttonAction.buyAction))e.push(o.buttonAction.buyAction)
else if(function(e){return T(e)&&e[PW]===Gy}(o.buttonAction)&&Nn(o.buttonAction.completionAction))e.push(o.buttonAction.completionAction)
else if(gt(o.buttonAction)){if(Nn(o.buttonAction.buyAction)&&e.push(o.buttonAction.buyAction),Nn(o.buttonAction.defaultAction)&&e.push(o.buttonAction.defaultAction),Nn(o.buttonAction.openAction)&&e.push(o.buttonAction.openAction),ht(o.buttonAction.subscribePageAction)&&o.buttonAction.subscribePageAction.page===zO&&(0,Zv.isSome)(o.buttonAction.subscribePageAction.pageUrl)&&o.buttonAction.subscribePageAction.pageUrl.length>0){const e=wz.from(o.buttonAction.subscribePageAction.pageUrl)
e.param(tz.includePostSubscribeAttribution,bq),o.buttonAction.subscribePageAction.pageUrl=e.build()}ht(o.buttonAction.subscribePageAction)&&function(e){return A(e)&&"MarketingItemRequestInfo"===e[PW]}(o.buttonAction.subscribePageAction.pageData)&&Nn(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)&&e.push(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const t of e)t.purchaseConfiguration&&(t.purchaseConfiguration.excludeAttribution=!1)}var i}function Yn(e){Object.keys(e).filter(e=>!vZ.has(e)).forEach(t=>delete e[t])}function Jn(e,t,n,r){var o,s,a,c,l,u
const d=Xn(t,n)
t.adPageInfo&&Object.assign(d,t.adPageInfo.pageFields),i(t.offerReleaseDate)&&(d[FR]=Ee(t.offerReleaseDate))
const f=t.searchTermContext
f&&(d[iq]=f.term,f.suggestedTerm&&(d.searchSuggestedTerm=f.suggestedTerm),f.correctedTerm&&(d.searchCorrectedTerm=f.correctedTerm),f.originatingTerm&&(d[UR]=f.originatingTerm)),t.guidedSearch&&Object.assign(d,t.guidedSearch)
const h=function(e,t,n,r,o,i){const s={}
Object.assign(s,o),s[nV]=SW,r&&(s[dS]=r.clientCorrelationKey,s.requestStartTime=r.requestStartTime,s.responseStartTime=r.responseStartTime,s.responseEndTime=r.responseEndTime)
const a=[MU,jM]
return a.push("userContentRestriction"),n&&a.push("crossfireReferralCandidate"),Ft(e,s),Dt(0,new mK(s,a,[],$t(e,s),xt(e,s,null,i)))}(e,0,null!==(o=t.isCrossfireReferralCandidate)&&void 0!==o&&o,t.timingMetrics,d,r),p=null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.adIsPresent)&&void 0!==a&&a,w=null!==(u=null===(l=null===(c=null==t?void 0:t.adPageInfo)||void 0===c?void 0:c.shouldIncludeAdRotationFields)||void 0===l?void 0:l.call(c,e))&&void 0!==u&&u
return p&&w&&h.includingFields.push(qN),h}function Kn(e,t,n){return function(e,t){const n={}
return Object.assign(n,t),n[jG]=cU,_t(e,cU,TW,n)}(e,Xn(t,n))}function Zn(e,t,n){const r=Xn(t,n)
return t.searchTermContext&&(r[iq]=t.searchTermContext.term),t.baseFields&&Object.assign(r,t.baseFields),function(e,t,n){const r={}
return Object.assign(r,n),r[nV]="pageRender",t&&(r[xU]||(r[xU]=t.pageURL),r[dS]=t.clientCorrelationKey,r.platformRequestStartTime=t.requestStartTime,r.platformResponseStartTime=t.responseStartTime,r.platformResponseEndTime=t.responseEndTime,r.platformResponseWasCached=t.responseWasCached,r.platformJsonParseStartTime=t.parseStartTime,r.platformJsonParseEndTime=t.parseEndTime),Ft(e,r),r}(e,t.timingMetrics,r)}function Qn(e,t,n){var r,o,s,a
const c=Xn(t,n)
t.searchTermContext&&(c[iq]=t.searchTermContext.term)
const l=S(c)
t.adPageInfo&&Object.assign(l,t.adPageInfo.impressionsFields),t.guidedSearch&&Object.assign(l,t.guidedSearch)
const u=i(t.adPageInfo),d=null!==(o=null===(r=t.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad(e))&&void 0!==o&&o,f=[{data:Mt(e,l,u&&d,null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields(e))&&void 0!==a&&a,!0),invocationPoints:[Im.PageInvocationPoint.appExit,Im.PageInvocationPoint.pageExit]}]
if(u){const n=function(e,t,n){var r,o,s,a,c,l
const u=null!==(s=null===(o=null===(r=null==n?void 0:n.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad)||void 0===o?void 0:o.call(r,e))&&void 0!==s&&s,d=null!==(l=null===(c=null===(a=null==n?void 0:n.adPageInfo)||void 0===a?void 0:a.shouldIncludeAdRotationFields)||void 0===c?void 0:c.call(a,e))&&void 0!==l&&l,f=[],h=Mt(e,t,u,d,!1).fields
if(h[VN]=yR,null!==n&&i(n.adPageInfo)){const t=n.adPageInfo.fastImpressionsEventVersion(e)
h[HN]=t,f.push(HN),5===t&&(h.viewableArea="excludingTabBar",delete h[EG])}const p=["fastImpressions",MU,jM]
return u&&p.push(HM),d&&p.push(qN),Dt(0,new mK(h,p,f,$t(e,h),xt(e,h,n)))}(e,l,t)
f.push({data:n,invocationPoints:[Im.PageInvocationPoint.appExit,Im.PageInvocationPoint.pageExit,Im.PageInvocationPoint.timer]})}return f}function Xn(e,t){const n={}
return i(e.offerType)&&(n[dF]=e.offerType),void 0!==t&&n&&t(n),n}function er(e,t){const n=et(e,t,"usesExternalPurchase"),r=et(e,t,"usesExternalLinkPurchase")
return n||r}function tr(e,t){return e.bag.enableExternalPurchases&&e.bag.enabledExternalPurchasesPlacements.includes(t)}function nr(e,t,n,r){const i=e.bag.externalPurchasesLearnMoreEditorialItemId
if(o(i)||!e.bag.enableExternalPurchases)return null
const s=new FY(Eq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Xs(e,s,{id:lU,targetType:jq,actionType:bW,pageInformation:n,locationTracker:r}),s}function rr(e){switch(e){case Ay:case rL:case cH:case Qx:return!0
default:return!1}}function or(e,t,n=!1){const r=j(t,"ageRating.name")
return(0,Jv.isSome)(r)?r:n?j(t,aT):void 0}function ir(e,t,n=!1){const r=q(t,cT)
return(0,Jv.isSome)(r)?r:n?q(t,"contentRatingsBySystem.appsApple.value"):void 0}function sr(e,t){const n=new Map([["br.100.official",uT],["br.100",dT],["br.210.official",fT],["br.210",hT],["br.300.official",pT],["br.300",wT],["br.314.official",gT],["br.314",vT],["br.416.official",mT],["br.416",yT],["br.618.official",AT],["br.618",TT]]),r=e.locale.activeStorefront+"."+j(t,cT)+(H(t,"ageRating.isOfficial")?".official":"")
return n.get(r)}function ar(e,t){var n
if(t<=0)return!1
if(t>=1)return!0
const r=null===(n=e.metricsIdentifiersCache)||void 0===n?void 0:n.getMetricsIdForType(im.user)
return!(0,Jv.isNothing)(r)&&0!==r.length&&!(r.length<2)&&function(e){function t(e){const t=e.charCodeAt(0)
return t>=48&&t<=57?52+t-48:t>=65&&t<=90?26+t-65:t>=97&&t<=122?t-97:t}const n=e.slice(-2)
return(62*t(n[0])+t(n[1]))/3843}(r)<t}function cr(e,t){switch(ur(e,t)){case TL:case i$:case SL:case bL:case WT:return!0
default:return!1}}function lr(e,t){return ar(e,e.bag.gameControllerRecommendedRolloutRate)&&ur(e,t)===WT}function ur(e,t){const n=rt(e)
if(null===n)return iG
if(!ie(t,n)){const r=Ke(e,t,OH)
if(null===r||o(r))return iG
const i=r[n]
return o(i)?iG:i}const r=Qe(e,t,Oj)
return s(r)?r:iG}function dr(e,t){return rt(e),zT}function fr(e,t=null){return e===vW?function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER"
return e&&(t+=`&installMajorOSBundle=${e}`),t}(t):null}function hr(e){var t
return null===_Z&&(_Z=new vK({defaultTopic:e.bag.metricsTopic,buildType:e.client.buildType,jsVersion:null!==(t=e.packageProperties.asString(EE))&&void 0!==t?t:Xq,buyDecorator:DZ,isLoggingEnabled:!0,bagProvider:(t,o)=>{const i=e.bag.metricsConfiguration
if(!r(o)){const e=n(i,[o,t])
if(!r(e))return e}return n(i,t)}})),_Z}function pr(e,t,n,a,c,l,u,d,h,p,w,g,v,m,A){const T=function(e,t){const n=new fK(t),r=f(e.bag.metricsConfiguration,"metricsBase.language")
return n.set("languageId",r),n.toString()}(e,n)
return function(e,t,n,o,s,a,c){const l=new fK(t)
return function(e,t,n,o,s,a,c){var l,u
const d=f(a,nF)
t.set(nF,d)
const h=e.clientCapabilities.isEnabled(xR)?e.bag.metricsPaymentTopic:void 0
t.set(p$,null!=h?h:e.bag.metricsTopic),DZ.useNativeValues(a)
const p=DZ.params
for(const e of Object.keys(p)){if(e===rx&&(0,Zv.isSome)(t.get(rx)))continue
const n=f(p,e)
t.set(e,n)}if(!r(c))for(const e of Object.keys(c)){const n=f(c,e)
t.set(e,n),t.set(e,n,null)}if(!a)return t.set(iq,null),void t.set(ox,null)
const w=f(a,FU);(0,Zv.isSome)(w)&&w.length>0&&t.set(FU,w)
const g=f(a,_S);(0,Zv.isSome)(g)&&g.length>0&&t.set(_S,g)
const v=(null===(l=t.get(kS,null))||void 0===l?void 0:l.length)>0,m=f(a,rW)
if(v?t.set(rW,e.host.clientIdentifier):(0,Zv.isSome)(m)&&m.length>0&&t.set(rW,m),!o&&!kW.shared.shouldUseJSReferralData){const e=f(a,lF),n=vh(e)
e&&n&&(a[rF]=n)
const r=f(a,"usageContext")
if((0,Zv.isSome)(r)){switch(r){case CH:t.set(FU,"com.apple.AppStore.overlay")
break
case $R:t.set(FU,MR)}t.set(cF,w,null)}else{const e=f(a,cF)
t.set(cF,e,null)
const n=f(a,lF)
t.set(lF,n,null),f(a,"extRefAppType")===RS&&t.set(FU,MR)}}const y=t.get(QG),A=t.get(rV),T=(null!==(u=null==y?void 0:y.split("_"))&&void 0!==u?u:[]).includes(n)
if(A!==NV||T){const e=Ah(f(a,zB))
i(e)&&t.set(iq,e)}t.set(wS,null,null)}(e,l,n,o,0,a,c),l.toString()}(e,function(e,t,n,a,c,l,u,d,h,p,w,g){const v=new fK(t)
return function(e,t,n,s,a,c,l,u,d,h,p,w){var g,v,m
const A=Nt(s)
a&&t.set(WN,a),c&&t.set(HH,c)
const T=f(y(A),QG)
t.set(QG,T)
const b=f(y(A),rV)
t.set(rV,b)
const S=f(y(A),YB);(0,Zv.isSome)(S)&&S.length>0&&t.set(LZ.containerId,S,null)
const P=(null!==(g=null==T?void 0:T.split("_"))&&void 0!==g?g:[]).includes(n),I=b===NV,C=(null===(v=t.get(kS,null))||void 0===v?void 0:v.length)>0
if(!I||P||C){let e=f(y(s),"searchTermContext.resultsTerm")
o(e)&&(e=function(e){if((0,Jv.isNothing)(e))return null
const t=new wz(e),n=t.query,r=null==n?void 0:n[iq],o=t.pathname
return(0,Jv.isNothing)(r)||(0,Jv.isNothing)(o)?null:o.includes("/app")?r:null}(null==s?void 0:s.pageUrl)),r(e)||t.set(iq,e)}if(I&&(0,Zv.isSome)(s)&&(0,Zv.isSome)(s.pageUrl)&&(null===(m=new wz(s.pageUrl).query)||void 0===m?void 0:m[_R])===OS&&(t.set(rx,LR),t.set(ES,"1",null)),function(e,t,n,r){const o=i(n)&&n.adamID===t,s=i(r)&&r.adamID===t&&!o
if(o&&i(n)){const t=We(n)
for(const n of Object.keys(t)){const r=f(t,n);(0,Zv.isSome)(r)&&e.set(n,r)}}if(s&&i(r)){const t=ze(r)
for(const n of Object.keys(t)){const r=f(t,n);(0,Zv.isSome)(r)&&e.set(n,r)}}}(t,n,null==s?void 0:s.productVariantData,null!=u?u:void 0),!r(l)&&l.length>0&&t.set(ox,l),t.set(h$,d),!h)if(i(kW.shared.activeReferralData)){if(t.set(cF,kW.shared.activeReferralData.extRefApp2,null),t.set(lF,kW.shared.activeReferralData.extRefUrl2,null),(0,Zv.isSome)(kW.shared.activeReferralData.kind)){const e=kW.shared.activeReferralData.kind.name
e!==RS&&"appClip"!==e||t.set(FU,MR)}}else t.set(cF,p,null),t.set(lF,w,null)}(0,v,n,a,c,l,u,d,h,p,w,g),function(e,t,n,r){var o
if((0,Zv.isNothing)(r))return
const i=[],a=r.adPageInfo
if((0,Zv.isSome)(a)){const e=(0,Zv.isSome)(a.clickFields[bR]),n=a.adAdamId===t
if(e&&n){const e=function(e,t){if((0,Zv.isNothing)(e))return!1
const n=e.baseFields[rV]
switch(t.placementType){case kV:return n===DG
case tW:return n===DS
case oq:case SH:const r=e.baseFields[QG],o=t.adAdamId===r
return(n===NV||n===ZM)&&!o
default:return n===VV}}(r,a)?"iAdSponsored":"iAdOriginated"
i.push({key:e,value:bq})}}if(s(i)){const t=i.map(e=>`${e.key}=${e.value}`).join(";"),r=null===(o=e.cryptography)||void 0===o?void 0:o.base64Encode(t);(0,Zv.isSome)(r)&&n.set("extraInfo",r)}}(e,n,v,a),v.toString()}(e,T,t,a,u,d,h,g,v,c,m,A),t,c,0,p,w)}function wr(e,t,n){return Kv.context("offerDataFromData",()=>{const r=Ze(e,t,Fj,n)
return 0===r.length?null:r[0]})}function gr(e,t){const n=G(t,Fj)
return 0===n.length?null:n[0]}function vr(e,t,n,o,a,c,l,u=Gq,d,h,p){return Kv.context(`offerActionFromOfferData: ${n.id}`,()=>{var w,g,v,m,y,A,T
let b=f(t,Ej)
if(r(b))return Kv.unexpectedNull(DH,zq,pR),null
if(n.type===aW&&(b.indexOf("rebuy")>=0?b=b.replace("rebuy=false",nP):(b.length>0&&(b+="&"),b+=nP)),s(l.inAppEventId)&&(b.length>0&&(b+="&"),b+=`mtInAppEventId=${l.inAppEventId}`),l.isAdvert){const e=null===(g=null===(w=l.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementId
i(e)&&(b.length>0&&(b+="&"),b+=`${LZ.placementId}=${e}`)
const t=null===(m=null===(v=l.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===m?void 0:m.containerId
i(t)&&(b.length>0&&(b+="&"),b+=`${LZ.containerId}=${t}`)
const n=null===(A=null===(y=l.pageInformation)||void 0===y?void 0:y.adPageInfo)||void 0===A?void 0:A.clickFields[mj]
i(n)&&(b.length>0&&(b+="&"),b+=`${LZ.templateType}=${n}`)}const S=n.id
if(r(S))return Kv.unexpectedNull(DH,zq,"item.offer.id"),null
const P=function(e,t,n,r,o,i,s,a,c,l){return Kv.context("purchaseConfigurationFromProduct",()=>{const u=j(t,AW)
let d=j(t,pH)
d||(d=tP)
const h=st(e).bundleIdFromData(t),p=gf(e,t),w=j(t,cS),g=Qe(e,t,"preflightPackageUrl"),v=Yf(e,t),m=Sf(0,t,e.appleSilicon.isSupportEnabled),y=f(c,rW),A=f(c,lB),T=_r(e,t)?e.client.remoteDownloadIdentifiers:[],b=function(e,t){return et(e,t,ZH)}(e,t),S=ir(0,t,!0),P=new kZ(n,d,u,h,p,r,o,s,w,!1,g,v,m,!1,a.inAppEventId,y,A,void 0,Pf(e,t),l,T,b,S)
return P.pageInformation={...i},P.productVariantData=Ge(e,t),P.targetType=a.targetType,P.metricsKind=a.kind,P})}(e,n,b,o,l.excludeAttribution,l.pageInformation,c,l,d,h),I=Tr(e,t,S,P,a,u,null!==(T=l.isAdvert)&&void 0!==T&&T,p)
return function(e,t,n,r,o){var i,s,a,c,l
const u=n.pageInformation,d={...n,targetType:TW},f=Ph(e,d,null!==(i=t.title)&&void 0!==i?i:"")
let h=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:t.adamId;(0,Zv.isSome)(n.targetId)&&(null===(c=n.targetId)||void 0===c?void 0:c.length)>0&&(h=n.targetId),Zs(e,t,h,r,u,f,null!==(l=n.isAdvert)&&void 0!==l&&l,n.recoMetricsData,o,d)}(e,I,l,o,h),I})}function mr(e,t){return r(t)||r(t.price)||0===t.price}function yr(e,t){return Kv.context("expectedReleaseDateFromData",()=>Oe(j(t,"offers.0.expectedReleaseDate")))}function Ar(e,t){const n=f(t,jV)
return n===T$||n===ux||n===iH?h(t,tN):null}function Tr(e,t,n,r,o,i=Gq,s=!1,a){return Kv.context("offerActionFromOfferData",()=>{const c=f(t,jV),l=s&&i===Gq&&(0,Zv.isSome)(e.bag.adsOverrideLanguage)?e.adsLoc:e.loc
let u
switch(c){case"get":if(i===uV)u=e.loc.string(rP,"Get")
else{const e=dx
u=l.string(e)}break
case iH:u=i===uV?e.loc.string(oP,"Pre-Order"):l.string(dx)
break
default:u=c}let d=null,h=null
const p=Ar(0,t)
p>0&&(d=p,h=f(t,cj))
const w=Oe(f(t,yU)),g=new uZ(u,n,r,a)
return g.price=d,g.priceFormatted=h,g.expectedReleaseDate=w,g.includeBetaApps=o,g})}function br(e,t,n,o,i,a=Gq,c=null,l=!1){if((0,Zv.isNothing)(t))return null
if(Zf(0,n)){if(a===uV)return null
if(a===Gq)return Bd(e,n,i,null)
const r=Qe(e,n,kq)
if(s(r)){const e=fr(vW,r)
if((0,Zv.isSome)(e)){const n=new JY(e)
return new ZY(t.adamId,n)}}}if(a===Gq&&(n.type===aW||Qf(e,n)||l))return Bd(e,n,i,null)
if(o&&"tv"!==e.client.deviceType&&!Yf(e,n)){const o=function(e,t,n,o,i){if(r(t))return null
const s=Pr(e,n,t,!1,o)
return s.buyAction=t,s}(e,t,n,i)
if(null!==o)return o}const u=xe(e,n,aH),d=e.client.isCompanionVisionApp
if(!Yf(e,n)&&(d||u&&e.client.deviceType!==iW))return function(e,t,n,r,o){const i=Rr(e,t,n,r,o),s=new ZY(t.adamId,i)
return s.title=t.title,s}(e,t,n,mr(0,t),Yf(e,n))
if(xe(e,n,oj)&&"tv"!==e.client.deviceType)return function(e,t,n){const r=new GY(Gq)
r.title=e.loc.string("Alert.Buy.TvOnly.Title"),r.message=e.loc.string("Alert.Buy.TvOnly.Message"),r.isCancelable=!0,r.buttonActions=n?[Mr(e,t)]:[t],r.buttonTitles=[e.loc.string("Alert.Buy.TvOnly.ButtonTitle")]
const o=new ZY(t.adamId,r)
return o.title=t.title,o}(e,t,et(e,n,o$))
if(!et(e,n,fO)&&et(e,n,FG)&&e.client.deviceType!==gW)return function(e,t){const n=new GY(Gq)
n.title=e.loc.string("Alert.Buy.WatchOnly.Title"),n.message=e.loc.string("Alert.Buy.WatchOnly.Message"),n.isCancelable=!0,n.buttonActions=[t],n.buttonTitles=[e.loc.string("Alert.Buy.WatchOnly.ButtonTitle")]
const r=new ZY(t.adamId,n)
return r.title=t.title,r}(e,t)
const f=Qe(e,n,eN)
if(s(c)&&c===hY&&(0,Zv.isSome)(f)&&nh(e,f))return function(e,t,n){const r=new GY(Gq)
r.title=e.loc.string("ProductPage.WatchOSUpdateRequired.Title").replace(ej,n),r.message=e.loc.string("ProductPage.WatchOSUpdateRequired.Message").replace(ej,n),r.buttonActions=[t],r.buttonTitles=[e.loc.string(BL)]
const o=new ZY(t.adamId,t)
return o.buyAction=r,o}(e,t,f)
if(function(e,t){return!!Yf(e,t)}(e,n)){if(Yf(e,n))return function(e,t,n,r,o,i,s){if(!Yf(e,n))return t
switch(e.client.deviceType){case"tv":return function(e,t,n,r,o,i){var s,a,c,l
const u=kr(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new hZ(pW,o,e.bag.metricsTopic,n.id);(0,Zv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[iq]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([im.user,im.client,im.canonical]);(0,Zv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new FY(Dj)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Qs(e,g,i),r){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=null,t}{const o=new ZY(n.id,d),i=kr(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
case iW:return function(e,t,n,r,o,i){var s,a,c,l
const u=Or(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new hZ(pW,o,e.bag.metricsTopic,n.id);(0,Zv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[iq]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([im.user,im.client,im.canonical]);(0,Zv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new FY(Dj)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Qs(e,g,i),r&&null!==f){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=Cr(e,g),t}{const o=new ZY(n.id,d),i=Or(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
default:return function(e,t,n,r,o,i,s){var a,c,l,u
const d=rr(i),f=new hZ(pW,i,e.bag.metricsTopic,n.id);(0,Zv.isSome)(null===(c=null===(a=s.pageInformation)||void 0===a?void 0:a.searchTermContext)||void 0===c?void 0:c.term)&&(f.metricsOverlay[iq]=null===(l=s.pageInformation.searchTermContext)||void 0===l?void 0:l.term)
const h=null===(u=e.metricsIdentifiersCache)||void 0===u?void 0:u.getMetricsFieldsForTypes([im.user,im.client,im.canonical]);(0,Zv.isSome)(h)&&(f.metricsOverlay={...f.metricsOverlay,...h}),e.client.isCompanionVisionApp&&(0,Zv.isNothing)(f.metricsOverlay[FU])&&(f.metricsOverlay[FU]=jz),d&&(f.purchaseSuccessAction=t,f.carrierLinkSuccessAction=t)
const p=new FY(Dj)
if(p.pageData=f,s&&s.pageInformation&&(p.referrerUrl=s.pageInformation.pageUrl),s.actionDetails={buyParams:t.purchaseConfiguration.buyParams,...s.actionDetails},Qs(e,p,s),r&&Nn(t)){const r=Pr(e,n,t,!0,s)
r.buyAction=t
const o=Pr(e,n,t,!0,s)
return o.buyAction=t,r.subscribePageAction=o,t.buyCompletedAction=Cr(e,p),r}const w=xe(e,n,aH)
if(_r(e,n)||w&&e.client.deviceType!==iW){const r=Rr(e,t,n,!0,!0),o=Rr(e,p,n,!0,!0),i=new ZY(n.id,r)
return i.subscribePageAction=new ZY(n.id,o),i}const g=new ZY(n.id,t)
return g.subscribePageAction=p,g}(e,t,n,r,0,i,s)}}(e,t,n,o,0,function(e,t,n){if(n)return pt(qF)
switch(t){case cH:return pt(cH)
case Gq:case uV:return pt(Qx)
default:return pt(Pj)}}(0,a,o),i)
const s=function(e,t,n,o,i){return"tv"===e.client.deviceType?kr(e,t,null,n,o):{startAction:r(t)?null:t,underlyingOfferAction:null}}(e,t,n,o),c=s.startAction
if(o){const t=Pr(e,n,s.underlyingOfferAction,!1,i)
return t.buyAction=c,t}return c}return Er(e,t,o,i)}function Sr(e,t,n,r,o,i,s=null){switch(r){case pt(cH):case pt(Qx):const r=rf(e,t,{useCase:O6.LockupIconLarge}),a=Ks(e,t,i)
return vr(e,wr(e,t),t,o,!1,Th(e,t,r,s),a,n)
default:return null}}function Pr(e,t,n,r,o){let i
if(r){const s=Ir(e,t,n.purchaseConfiguration.appName,r,!0,o),a=Ir(e,t,n.purchaseConfiguration.appName,r,!1,o)
i=new OZ(a,a,s,a)}else i=Ir(e,t,n.purchaseConfiguration.appName,!1,!1,o)
return new ZY(t.id,i)}function Ir(e,t,n,r,o,i){const s=new EZ(t.id,r)
let a,c,l,u
if(a=e.loc.string("CANCEL_COMING_SOON_TITLE"),e.client.isAutomaticDownloadingEnabled()&&(r&&o||!r)?(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON_DOWNLOAD"),l=e.loc.string("COMING_SOON_BODY_DOWNLOAD").replace(fx,n)):(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON"),l=e.loc.string("COMING_SOON_BODY").replace(fx,n)),c=e.loc.string("CANCEL_COMING_SOON_CANCEL"),e.client.deviceType===vW||"tv"===e.client.deviceType){const e=new GY(Gq)
e.title=a,e.message=l,e.buttonActions=[s],e.isCancelable=!0,e.cancelTitle=c,e.destructiveActionIndex=0,u=e}else if(e.client.deviceType===iW){const t=new GY(Gq)
t.title=a,t.artwork=Ot(e,"systemimage://bell.slash.fill",95,90),t.message=l,t.buttonActions=[s],t.isCancelable=!0,t.cancelTitle=c,u=t}else{const e=new IZ([s])
e.title=a,e.message=l,e.isCancelable=!0,e.cancelTitle=c,e.isCustom=!1,e.destructiveActionIndex=0,u=e}Xs(e,s,{...i,actionType:"cancelPreorder"})
const d=new rK(t.id,rW),f=new ZY(t.id,u)
return f.openAction=d,f}function Cr(e,t){const n=Ot(e,"systemimage://checkmark",95,90),r=Ot(e,PA,95,90)
let o,i
o=new GY(yB),o.title="",o.artwork=n,e.client.isAutomaticDownloadingEnabled()?(o.message=e.loc.string(tD),o.toastDuration=2.5):(o.message=e.loc.string(YN),o.toastDuration=1.5)
{const n=new GY(yB)
n.title="",n.artwork=r,n.message=e.loc.string(YN),n.toastDuration=1.5
const o=new RZ(nD,new iK([t,n]))
o.rateLimit=e.bag.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=n,i=o}const s=!e.client.isAuthorizedForUserNotifications()
return e.bag.newEventsForODJAreEnabled&&s?new OZ(new xW,new xW,new xW,new xW):new OZ(i,o,o,o)}function kr(e,t,n,o,s,a){if(r(t))return{startAction:null,underlyingOfferAction:null}
const c=new fZ,l=mr(0,t),u=t.purchaseConfiguration.appName
c.shouldCheckForAvailableDiskSpace=!s,c.remoteControllerRequirement=iG,c.shouldCheckForGameController=et(e,o,o$)
const d=ir(0,o,!0)
if(i(d)&&(c.checkRestrictionsForContentRating=d),l){const t=s?e.loc.string("OfferAlert.TV.Title.PredorderFree"):e.loc.string("OfferAlert.TV.Title.Free")
c.title=t.replace(BU,u)}else{const n=s?e.loc.string("OfferAlert.TV.Title.PreorderPaid"):e.loc.string("OfferAlert.TV.Title.Paid")
c.title=n.replace(BU,u).replace(pF,t.priceFormatted)}const f=S(t)
f.title=s?e.loc.string("OfferButton.Title.Preorder"):l?e.loc.string(dx):e.loc.string("OfferButton.Title.Buy")
const h=(0,Zv.isNothing)(n)?f:n
c.completionAction=h,c.shouldIncludeActiveAccountInFooterMessage=!0
const p=[]
et(e,o,_E)&&p.push(e.loc.string("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases")),p.length>0&&(c.footerMessage=p.join(e.loc.string("TV_OFFER_ALERT_FOOTER_LINE_BREAK"))),c.impressionMetrics=f.impressionMetrics
const w=S(c)
w.shouldPromptForConfirmation=!1,w.title=null,w.footerMessage=null
const g=new ZY(t.adamId,w)
return Yf(e,o)||(g.buyAction=c),g.openAction=t,{startAction:g,underlyingOfferAction:f}}function Or(e,t,n,o,i,s){if(r(t))return{startAction:null,underlyingOfferAction:null}
const a=new fZ,c=mr(0,t)
a.remoteControllerRequirement=ur(e,o),a.spatialControllerRequirement=dr(e)
const l=S(t)
l.title=i?e.loc.string("OFFER_BUTTON_TITLE_PREORDER"):c?e.loc.string("OFFER_BUTTON_TITLE_GET"):e.loc.string("OFFER_BUTTON_TITLE_BUY")
const u=(0,Zv.isNothing)(n)?l:n
a.completionAction=u,a.impressionMetrics=l.impressionMetrics
const d=S(a)
d.shouldPromptForConfirmation=!1,d.title=null,d.footerMessage=null
const f=new ZY(t.adamId,d)
return f.buyAction=a,f.cancelAction=l,f.openAction=l,{startAction:f,underlyingOfferAction:l}}function Er(e,t,n,o){if(r(t))return null
if(!e.bag.enableTwoPhaseOfferConfirmation||n)return t
const i=new xW
i.impressionMetrics=t.impressionMetrics
const s=S(o)
r(s)||(s.actionType=NR,s.targetType=TW,Xs(e,i,s))
const a=new dZ(t,i)
return a.confirmationAccessibilityAction=function(e,t){if(r(t))return null
const n=new GY(Gq)
r(t.priceFormatted)?(n.title=e.loc.string(aB),n.message="Are you sure you want to get "+t.purchaseConfiguration.appName):(n.title="Buy App",n.message=`Are you sure you want to buy ${t.purchaseConfiguration.appName} for ${t.priceFormatted}`),n.isCancelable=!0,n.buttonActions=[t]
const o=new ZY(t.adamId,t)
return o.buyAction=n,o}(e,t),a}function Rr(e,t,n,r,o){const i=new GY(Gq)
return i.isCancelable=!0,i.buttonActions=[t],i.imageName="vision.pro",_r(e,n)?r?(i.title=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Title"),i.message=o?e.loc.string("Alert.Buy.VisionOnly.Message.Arcade"):e.loc.string("Alert.Buy.VisionOnly.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.ButtonTitle")]),i}function Dr(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=gf(e,t).includes(iW)||function(e){return ue(e,xq,hO)}(t)
return!!n}function _r(e,t){return!!Dr(e,t)&&Lr(e)}function Lr(e){return!((0,Zv.isNothing)(e.client.remoteDownloadIdentifiers)||0===e.client.remoteDownloadIdentifiers.length)}function Mr(e,t){const n=new GY(Gq)
return n.title=e.loc.string("Alert.Buy.TvGameControllerRequired.Title"),n.message=e.loc.string("Alert.Buy.TvGameControllerRequired.Message"),n.buttonTitles=[e.loc.string("Alert.Buy.TvGameControllerRequired.ButtonTitle")],n.isCancelable=!0,n.buttonActions=[t],n}function xr(e,t,n,o,s,a,c,l,u,d,h=Gq,p=!1,w=!1,g,v,m=!1){return r(t)?null:Kv.context("displayPropertiesFromOfferAction",()=>{var r,a
let g=c
!m&&at(e,o,rm.Offers)&&(g=rG),m||zd(e,o)||(g=rG),m||!e.client.isCompanionVisionApp||_r(e,o)||(g=rG)
const y=null!==(r=Kd(e,o))&&void 0!==r?r:v
let A
y&&(A=y.id)
let T=new YY(n,t.adamId,t.bundleId,g,A,l)
T.isPreorder=s
const b=w&&h===Gq&&(0,Zv.isSome)(e.bag.adsOverrideLanguage),P=b?e.adsLoc:e.loc
if(T.useAdsLocale=b,s)if(Yf(e,o))T.offerLabelStyle=qF,T.subtitles[yU]=ih(e,o,e.loc.string(hF)),T.titleSymbolNames[iP]=wF,T.titleSymbolNames[rD]="bell.fill",T.subtitles[yU]===e.loc.string(db)&&(T.subtitles[yU]=e.loc.string(hF))
else{T.offerLabelStyle=iH,T.titleSymbolNames[wW]=wF
const t=ih(e,o,"");(0,Zv.isSome)(t)&&(T.subtitles[yU]=t)}const I=o.type===aW,C=mr(0,t),k=C&&I&&!dh(e,o,!1)
T.isFree=!k&&C
let O=null
if(h===Gq&&(o.type===aW||Zf(0,o)||Qf(e,o)||p))O=e.loc.string("OfferButton.Title.View")
else{if(h===uV&&(o.type===aW||Zf(0,o)||Qf(e,o)))return null
O=h===sP?e.loc.string("OfferButton.Title.Select"):C?h===uV?s?e.loc.string(oP):e.loc.string(rP):t.title:h===uV?s?e.loc.string("OfferButton.FlowPreview.PreorderWithPrice").replace(pF,t.priceFormatted):e.loc.string("OfferButton.FlowPreview.BuyWithPrice").replace(pF,t.priceFormatted):t.priceFormatted}if(T.titles[wW]=O,T.priceFormatted=t.priceFormatted,e.bag.enableTwoPhaseOfferConfirmation&&h!==uV&&(T.titles[oD]=C?e.loc.string("OfferButton.Title.ConfirmGet"):e.loc.string("OfferButton.Title.ConfirmBuy")),Yf(e,o))if(h===uV){const t=e.loc.string("OfferButton.FlowPreview.Arcade.Standard")
T.titles[wW]=t,T.titles[gF]=t,T.titles[XV]=e.loc.string("OfferButton.FlowPreview.Arcade.Open"),T.titles[hx]=t,s&&(T.titles[aP]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderSubscribed"),T.titles[iD]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderNotSubscribed"))}else{const e=P.string("OfferButton.Arcade.Title.Standard")
T.titles[wW]=e,T.titles[gF]=e,T.titles[XV]=P.string("OfferButton.Arcade.Title.Open"),T.titles[hx]=e,s&&(T.titles[aP]=P.string("OfferButton.Arcade.Title.PreorderSubscribed"),T.titles[iD]=P.string("OfferButton.Arcade.Title.PreorderNotSubscribed"),T.titles[iP]=P.string("OfferButton.Arcade.Title.PreorderedSubscribed"),T.titles[rD]=P.string("OfferButton.Arcade.Title.PreorderedNotSubscribed"))}if(u&&h!==uV){const t=f(u,ZS),n=f(u,cj)
if(i(n)&&i(t)){let r=null,o=null
switch(t){case QS:d?(r=e.loc.string(sD),o=e.loc.string(sD)):(r=e.loc.string(sD),o=e.loc.string(px))
break
case XS:const t=e.loc.string("OfferButton.IntroPrice.PaidUpfront.Trial").replace(pF,n)
d?(r=t,o=t):(r=t,o=e.loc.string(px))
break
case eP:r=e.loc.string(px),o=e.loc.string(px)}T.titles[aD]=r,T.titles[cD]=o,T.subtitles[aD]=e.loc.string(cP),T.subtitles[cD]=e.loc.string(cP)
const i=10
let s=!1
for(const e of Object.keys(T.titles))if(T.titles[e].length>i){s=!0
break}s&&(T=T.newOfferDisplayPropertiesChangingAppearance(!1,null,rS))}}const E=et(e,o,_E),R=er(e,o),D=tr(e,cW),_=R&&D
if(T.hasInAppPurchases=E,T.hasExternalPurchases=_,E||_){const t=_?uP:lP,n=P.string(t)
T.subtitles[wW]=n,e.bag.enableTwoPhaseOfferConfirmation&&h!==uV&&(T.subtitles[oD]=n)}T.isDeletableSystemApp=st(e).isSystemAppFromData(o)&&!Qf(e,o)
const L=ir(0,o,!0)
T.contentRating=null!=L?L:void 0,T.appCapabilities=t.purchaseConfiguration.appCapabilities
const M=null!==(a=we(o,yW))&&void 0!==a?a:[],x=[]
if((0,Zv.isSome)(M))for(const t of M)dh(e,t)&&x.push(t.id)
return o.type===aW&&h!==uV&&(T.offerToken={offerAction:t,offerDisplayProperties:S(T),freeBundleId:k?t.adamId:void 0,supportedBundleChildrenIds:x.length>0?x:void 0}),T})}function $r(e,t,n,o,i){return r(t)?null:Kv.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const r=new YY(n,t.adamId,t.bundleId,i),s=mr(0,t)
r.isFree=s
let a=null
a=s?t.title:t.priceFormatted,r.titles[wW]=a,r.priceFormatted=t.priceFormatted
const c=o.hasInAppPurchases,l=o.hasExternalPurchases
if(r.hasInAppPurchases=c,r.hasExternalPurchases=l,l){const t=e.loc.string(uP)
r.subtitles[wW]=t}else if(c){const t=e.loc.string(lP)
r.subtitles[wW]=t}return r.contentRating=o.contentRating,r.ignoresContentRestrictions=o.ignoresContentRestrictions,r.appCapabilities=t.purchaseConfiguration.appCapabilities,r})}function Fr(e){return A(e)&&function(e){return(0,Jv.isSome)(GZ[e])}(e[PW])}function Nr(e,t){switch(j(t,Kb)){case Zb:return Lz
case Qb:return Mz
case"RealityDevice":return e.bag.enableDeviceDrivenDiscoveryContent?Vz:null
default:return null}}function Br(e,t=!1){return{timeToLive:jr(e),nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:t}}function Ur(e,t){r(t)||r(e)||(r(t.nextPreferredContentRefreshDate)||e.getTime()<t.nextPreferredContentRefreshDate.getTime())&&e.getTime()>(new Date).getTime()&&(t.nextPreferredContentRefreshDate=e)}function Gr(e,t){if(!function(e){return e.bag.enableAutomaticPageRefresh}(e))return null
if(r(t))return null
let n,o=!1
if(i(t.timeToLive)&&i(t.nextPreferredContentRefreshDate)){const e=Vr(t.timeToLive)
e.getTime()<t.nextPreferredContentRefreshDate.getTime()&&e.getTime()>(new Date).getTime()?n=e:(n=t.nextPreferredContentRefreshDate,o=!0)}else if(i(t.timeToLive))n=Vr(t.timeToLive)
else{if(!i(t.nextPreferredContentRefreshDate))return null
n=t.nextPreferredContentRefreshDate,o=!0}if(n.getTime()<=(new Date).getTime())return null
const s=o&&t.refreshWhileVisibleForNextPreferredContentRefreshDate
return new WZ("timeToLive",0,null,n,s)}function jr(e){return e[Sm.contentMaxAge]}function Vr(e){const t=new Date
return t.setSeconds(t.getSeconds()+e),t}function Hr(e,t){return t?[TX,RX]:[]}function qr(e,t){return Xr(vQ,t)}function Wr(e,t){return Xr(GQ,t)}function zr(e){return VQ}function Yr(e){return qQ}function Jr(e){return YQ}function Kr(e){return XQ}function Zr(e){return nX}function Qr(e,t){return e.client.isCompanionVisionApp?uX:Xr(lX,t)}function Xr(e,t){const n={...e}
return(0,Jv.isSome)(t)&&(n.crops=t),n}function eo(e,t,n){const r=ko(t,n.coercedCollectionTodayCardDisplayStyle),o=n.isHorizontalShelfContext?function(e,t){const n=[]
return n.push(Qr(e,[cA])),t.horizontalCardContentType===UB&&n.push(zr()),n.push(Wr(0,["sr"]),qr(0,["sr"])),n}(e,n):function(e,t,n){const r=new Set([Cm.List,Cm.NumberedList])
if(e.client.isPad&&n.isHeroCard&&!r.has(t))return Hr(0,n.isHeroCard)
switch(t){case Cm.AppEventCard:return[Jr(),Kr(),Zr(),Qr(e),...Hr(0,n.isHeroCard),fQ]
case Cm.AppOfTheDay:case Cm.GameOfTheDay:return[Jr(),Kr(),Zr(),Qr(e),...Hr(0,n.isHeroCard),aQ]
case Cm.List:case Cm.NumberedList:return[EQ,$Q]
case Cm.ShortImage:return n.isSearchContext?[qr(),Jr(),Kr(),Zr(),Qr(e),...Hr(0,n.isHeroCard),zr(),Yr(),Wr()]:[Jr(),Kr(),Zr(),Qr(e),...Hr(0,n.isHeroCard),zr(),Yr(),qr(),Wr()]
case Cm.FullBleedImage:return[Jr(),Kr(),QZ,Xr(nQ,undefined),Zr(),Qr(e),...Hr(0,n.isHeroCard),zr(),Yr(),Wr(),qr()]
case Cm.SingleApp:case Cm.Video:default:return[Jr(),Kr(),Zr(),Qr(e),...Hr(0,n.isHeroCard),zr(),Yr(),Wr(),qr()]}}(e,r,n)
let i,s=!1
const a=N(t)
if(W(a)&&(i=o.find(e=>(0,Jv.isSome)(B(a,e.objectPath))),s=(0,Jv.isSome)(i)),(0,Jv.isNothing)(i)&&(i=o.find(e=>(0,Jv.isSome)(B(t,e.objectPath)))),!i)return
const c=B(s?a:t,i.objectPath)
if(i.type===pV){const t=i.crops.map(t=>{let r=t
return n.isSearchContext&&(0,Jv.isSome)(n.prevailingCropCodes)?r=n.prevailingCropCodes.defaultCrop:(0,Jv.isSome)(n.prevailingCropCodes)&&(0,Jv.isSome)(n.prevailingCropCodes[i.objectPath])&&(r=n.prevailingCropCodes[i.objectPath]),Xd(e,c,{withJoeColorPlaceholder:!0,cropCode:r,useCase:O6.TodayCardMedia,overrideHeight:i.sourceHeight,overrideWidth:i.sourceWidth})}),r=lh(c)
return{artworks:t,videos:[],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:r}}{const t=p(c,zG),r=h(t,mG),o=h(t,WG)>=r
let s=i.sourceHeight,a=i.sourceWidth
o&&([s,a]=[a,s])
const l=Xd(e,t,{withJoeColorPlaceholder:!0,cropCode:i.crops[0],useCase:O6.TodayCardMedia,overrideHeight:s,overrideWidth:a})
if((0,Jv.isNothing)(l))return
let u={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0};(0,Jv.isSome)(n.videoPlaybackControls)&&(u=n.videoPlaybackControls)
let d={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0};(0,Jv.isSome)(n.videoPlaybackControls)&&(d=n.videoAutoplayPlaybackControls)
const w=f(c,dq)
if((0,Jv.isNothing)(w))return
const g=new Cz(w,l,{playbackControls:u,autoPlayPlaybackControls:d,canPlayFullScreen:n.enableFullScreenVideo}),v=lh(t)
return{artworks:[],videos:[g],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:v}}}function to(e,t=hU,n,r,o,i,s,a=TW){const c=wz.fromComponents($W,null,`/${VW.arcadeSeeAllGames}`,{sort:t}),l=new FY(wG,c.build())
return l.title=null!=o?o:e.loc.string(A$),Xs(e,l,{id:null!=i?i:EA,idType:s,targetType:a,actionType:bW,actionContext:Pq,pageInformation:n,locationTracker:r}),l}function no(e,t,n,r,o){var s,a,c,l
const u=new hZ(pW,t,e.bag.metricsTopic,n)
u.purchaseSuccessAction=r,u.carrierLinkSuccessAction=r
const d=new FY(Dj);(0,Jv.isSome)(null===(a=null===(s=null==o?void 0:o.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(u.metricsOverlay[iq]=null===(c=o.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const f=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([im.user,im.client])
return(0,Jv.isSome)(f)&&(u.metricsOverlay={...u.metricsOverlay,...f}),d.pageData=u,i(o)&&Qs(e,d,o),d}function ro(e,t,n,r){{const e=new LX(pW)
return i(r)&&(e.popToRoot=r),new iK([e])}}function oo({objectGraph:e,metricsPageInformation:t,metricsLocationTracker:n,target:r={playNow:{}}}){const o=new MX(r)
return Xs(e,o,{targetType:jq,id:VG,actionType:bW,pageInformation:t,locationTracker:n}),o}function io(e,t,n,r){let o
o=Ot(e,"resource://GameCenterEyebrow",16,16)
const i=e.featureFlags.isEnabled(OJ),s=e.featureFlags.isEnabled(EJ),a=e.featureFlags.isGSEUIEnabled(HJ)
if(a){const r={eyebrowColor:Se(aN),includeSeparator:!i,prefersShelfHeader:s}
return{eyebrow:e.loc.string(RA),eyebrowArtwork:o,eyebrowArtworkType:dm.Icon,title:t,subtitle:n,configuration:r}}{const c={eyebrowColor:a?Se(LL):void 0,includeSeparator:!i,prefersShelfHeader:s}
return(0,Jv.isSome)(r)&&r?{title:t,titleArtwork:o,titleArtworkType:dm.Icon,subtitle:n,configuration:c}:{eyebrow:e.loc.uppercased(e.loc.string(RA)),eyebrowArtwork:o,eyebrowArtworkType:dm.Icon,title:t,subtitle:n,configuration:c}}}function so(e,t=!1){let n=new yY(e).forType(oH).includingAgeRestrictions()
return t&&(n=n.addingQuery(ML,LO)),n}function ao(e,t){return so(e).withSparseLimit(t).asPartialResponseLimitedToFields([fW]).usingCustomAttributes(Ue(e))}function co(e,t,n){return function(e,t,n){o(t)&&(t=pt(Pj))
const r=new yY(e).forType(Dj).addingQuery("serviceType",pW).addingQuery("placement",t).includingMetaKeys(RV,[_j]).includingRelationships([mW]).includingAttributes([DA,MO]).includingAgeRestrictions()
return i(n)&&r.addingQuery(_A,n),r}(e,t,n)}function lo(e,t){let n=null
const s=fe(t,LA)||fe(t,RV)
if(o(s)||o(s.data))return null
const a=s.data.map(e=>e.type===RV?e:null).filter(e=>i(e))
if(o(a))return null
const c=e.bag.marketingItemSelectionTimeout
if(1===a.length||0===c)n=a[0]
else try{n=e.arcade.getMarketingItemWithTimeout(a,c)}catch{n=a[0]}return r(n)?null:{marketingItemData:n}}function uo(e,t){if(!t)return null
let n=null
const r=l(t,vO)
return r.length>0&&(n=r[0]),i(n)?{marketingItemData:n}:null}function fo(e,t,n,r,o){const i=On(0,r)
if((0,Jv.isSome)(i.suppressLockup)&&i.suppressLockup)return null
let s=null
const a=(0,Jv.isSome)(o)&&1===o.length,c=(0,Jv.isSome)(o)&&o.length>1
return a?s=new qZ(o[0]):c&&(s=new DX(o)),s}function ho(e,t,n,r,o,i,s){if(!H(o,O_))return
let a=lo(e,o);(0,Zv.isNothing)(a)&&(0,Jv.isSome)(i)&&(a=uo(0,i.arcadeUpsellEditorialResponse))
const c=function(e,t,n,r,o,i,s){if(!function(e){const t=e.host.platform
return t===gV||t===KV}(e))return null
po(e,t,n,r)
const a=Fo(),c=$d(e,i,s,pt(Ij),a,qj)
return new _X(c)}(e,o,t,n,0,a,s)
if(c){t.overlay=c,t.impressionMetrics.fields[NS]=!0
const r=po(e,o,t,n)
t.style!==r&&(t.style=r)}}function po(e,t,n,r){const o=!r.enableListCardToMultiAppFallback,i=eo(e,t,r),s=xo(null==i?void 0:i.joeColors)
return o?n.style:s}function wo(e,t,n){if((0,Jv.isNothing)(t))return
const r=Nt(n.pageInformation)
if(null===r)return
r.id=gh(n.id)
const o=hh(n);(0,Jv.isSome)(o)&&(r[cx]=o),r[jV]=dq,r.typeDetails="iTunesStoreContent",r[dG]=Ph(e,n,""),n.actionDetails&&(r[XG]=n.actionDetails),t.templateMediaEvent=function(e,t){const n={}
return Object.assign(n,t),n[nV]=AR,Ft(e,n),Dt(0,new mK(n,[],[],$t(e,n),xt(e,n)))}(e,r)
const i=S(r)
i[jN]=t.videoUrl,t.templateClickEvent=function(e,t,n,r){const o={}
Object.assign(o,r),o[nV]=OG,o[Q$]=n,o[mR]=null
const i=[MU]
return Ft(e,o),Dt(0,new mK(o,i,[],$t(e,o),xt(e,o)))}(e,0,TW,i)}function go(e,t){return u(t,xX)}function vo(e,t,n,r,o){return Kv.context("createTodayBaseCard",()=>{const i=new yK,s=ko(t,null==n?void 0:n.coercedCollectionTodayCardDisplayStyle),a=mo(e,t,s,n)
i.heading=a
const c=function(e,t,n){var r
let o=null
if((null==n?void 0:n.useOTDTextStyle)&&(o=null!==(r=j(t,"ofTheDayLabel"))&&void 0!==r?r:j(t,nq),(0,Zv.isSome)(o)&&(o=o.replace(/\n/g,m$))),(0,Zv.isNothing)(o)&&(o=Jf(e,t,AW,!0)),(0,Zv.isNothing)(o)){const e=yo(0,t)
o=(0,Zv.isSome)(e)?j(e,AW):null}return o}(e,t,n)
i.title=null!=c?c:void 0
const l=Qe(e,t,[N$,AW])
i.shortTitle=l
const u=function(e,t){return Xd(e,B(t,LT),{contentMode:tm.scaleAspectFit,allowingTransparency:!0,useCase:O6.TodayCardBrandedTitle})}(e,t)
i.titleArtwork=u
const d=function(e,t){var n
const r=On(0,t)
if(H(t,GE)||r.suppressNoteShort)return null
let o=Jf(e,t,cV,!0)
if((0,Zv.isNothing)(o)&&!r.suppressNoteTagline){const r=yo(0,t);(0,Zv.isSome)(r)&&(o=null!==(n=Jf(e,r,$j))&&void 0!==n?n:Sd(e,r))}return o}(e,t)
i.inlineDescription=d
const f=Io(e,t,n,r,c)
return f.adSlotOverride=r.parsedCardCount,i.clickAction=function(e,t,n,r,o,i,s){var a
const c=i,l={cardType:n,franchise:j(t,nq)},u=go(0,t)
return u&&(l[US]=u),c[XG]=l,(0,Zv.isSome)(s)&&s(c),jd(e,t,c,null!==(a=null==r?void 0:r.clientIdentifierOverride)&&void 0!==a?a:e.host.clientIdentifier,zs(o.currentTodayItem),r)}(e,t,s,n,r,f,o),Uh(e,i,f,a,s,go(0,t)),i.editorialDisplayOptions=function(e,t,n){var r
const o=On(0,t),i=e.client.isPad&&(null==n?void 0:n.isHeroCard)
return{suppressTagline:V(t,GE),suppressLockup:v(o.suppressLockup),showBadgeInSmallCards:null!==(r=n.alwaysShowBadgeInSmallCards)&&void 0!==r?r:v(o.showBadgeInSmallCards),useMaterialBlur:n.alwaysUseMaterialBlur||i||v(o.useMaterialBlur)}}(e,t,n),i})}function mo(e,t,n,o){var i,s
let a=null
if(null==o?void 0:o.useOTDTextStyle)a=o.isHorizontalShelfContext?j(t,nq):null
else if(function(e,t){let n=j(e,"ofTheDayIntent")
if((0,Jv.isNothing)(n))switch(ko(e,null==t?void 0:t.coercedCollectionTodayCardDisplayStyle)){case Cm.AppOfTheDay:n=Em.AppOfTheDay
break
case Cm.GameOfTheDay:n=Em.GameOfTheDay}return n===Em.AppOfTheDay||n===Em.GameOfTheDay}(t,o))a=null!==(i=j(t,f_))&&void 0!==i?i:j(t,nq),r(a)&&n===Cm.AppOfTheDay?a="FEATURED APP":r(a)&&n===Cm.GameOfTheDay&&(a="FEATURED GAME")
else if(n===Cm.AppEventCard){const n=yo(0,t);(0,Zv.isSome)(n)&&(a=null!==(s=Kf(e,t,uU,!0))&&void 0!==s?s:j(n,HH))}else a=j(t,nq)
return a}function yo(e,t){const n=we(t,RH)
if(1===(null==n?void 0:n.length))return n[0]
const r=Eo(0,t)
return 1===r.length?r[0]:null}function Ao(e,t,n,r,o){return Kv.context("addArtworkMediaToBaseCard",()=>{var i
if(H(t,__))return!1
const s=eo(e,t,r)
return!(0,Zv.isNothing)(s)&&((0,Zv.isSome)(o)&&wo(e,null==s?void 0:s.videos[0],{pageInformation:o.pageInformation,locationTracker:o.locationTracker,id:t.id}),n.media=new NZ(s.artworks,s.videos,s.artworkLayoutsWithMetrics,null!==(i=Lo(0,t,r))&&void 0!==i?i:void 0),n.style=xo(s.joeColors,uj),(0,Zv.isSome)(n.clickAction)&&wt(n.clickAction)&&(n.overlay=new VZ(n.clickAction),n.style=mq),!0)})}function To(e,t,n,r,o){return Kv.context("createTodaySingleAppCard",()=>{const s=vo(e,t,n,r)
Po(e,t,n,r)
const a=Ao(e,t,s,n,r),c=Eo(0,t),l=Oo(e,c,n,r.pageInformation,r.locationTracker,qj,null,ra(0,t)),u=fo(0,0,0,t,l)
var d
return i(u)&&Fr(d=u)&&d[PW]===My&&(u.style=mq),s.overlay=u,a||1!==c.length||bo(e,t,s,c,n,r)?(ho(e,s,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),s):(Co(r),null)})}function bo(e,t,n,r,o,i){if(1!==r.length)return!1
o.useJoeColorIconPlaceholder=!0,n.style=Jq
const s=Fo(0,n.style),a=Oo(e,r,o,i.pageInformation,i.locationTracker,No(n.style),s,ra(0,t))
if(1!==a.length)return!1
const c=a[0]
return n.media=new FX(c.icon),!0}function So(e,t,n,a,c){return Kv.catchingContext("todayCardFromData",()=>{const l=ko(t,n.coercedCollectionTodayCardDisplayStyle),d=Nr(e,t);(0,Jv.isSome)(d)&&(function(e,t,n,r){var o
if(n===jz||n===Vz)return!0
const i=Eo(0,t),s=ko(t,r.coercedCollectionTodayCardDisplayStyle)
if(!new Set([Cm.AppEventCard,Cm.Grid,Cm.InAppPurchase,Cm.List,Cm.NumberedList,Cm.River,Cm.ShortImage,Cm.SingleApp]).has(s))return!1
if(i.length>=6&&s===Cm.Grid)return!1
const a=Do(0,s)
return!(!H(t,__)&&_o(e,B(t,a),null===(o=r.prevailingCropCodes)||void 0===o?void 0:o.defaultCrop)||function(e,t){if(1===t.length){const e=t[0]
if(e.type===rq)return e}return null}(0,i))}(e,t,d,n)?n.clientIdentifierOverride=d:n.clientIdentifierOverride=null),n.crossLinkSubtitle=Uo(e,t)
let f=null
switch(l){case Cm.AppOfTheDay:case Cm.GameOfTheDay:f=function(e,t,n,r,i){return Kv.context("createTodayBrandedCard",()=>{const s=vo(e,t,n,r)
Po(e,t,n,r)
const a=eo(e,t,n)
if(!((0,Zv.isSome)(a)&&(0,Zv.isSome)(a.joeColors.bgColor)&&(a.artworks.length>0||a.videos.length>0)))return Co(r),To(e,t,n,r)
s.style=xo(null==a?void 0:a.joeColors,uj)
const c=Fo(0,s.style),l=Eo(0,t),u=Oo(e,l,n,r.pageInformation,r.locationTracker,No(s.style),c,ra(0,t),!0)
if(o(u)||1!==u.length)return Co(r),null
n.isHorizontalShelfContext||(s.overlay=fo(0,0,0,t,u))
const d=u[0]
return s.media=new $X(d.icon,a.artworks,a.videos,a.artworkLayoutsWithMetrics,Lo(0,t,n)),s.media.impressionMetrics=d.impressionMetrics,ho(e,s,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Co(r),s})}(e,t,n,a,c)
break
case Cm.Video:f=function(e,t,n,r,o){return Kv.context("createTodayVideoCard",()=>{const i=vo(e,t,n,r)
Ao(e,t,i,n,r),Po(e,t,n,r)
const s=Fo(0,i.style),a=Eo(0,t),c=Oo(e,a,n,r.pageInformation,r.locationTracker,qj,s,ra(0,t)),l=fo(0,0,0,t,c)
return i.overlay=l,ho(e,i,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i})}(e,t,n,a,c)
break
case Cm.FullBleedImage:f=function(e,t,n,r,o){return Kv.context("createTodayFullBleedImageCard",()=>{const i=vo(e,t,n,r)
if(Po(e,t,n,r),!Ao(e,t,i,n,r))return Co(r),null
const s=Eo(0,t),a=Fo(0,i.style),c=Oo(e,s,n,r.pageInformation,r.locationTracker,No(i.style),a,ra(0,t)),l=fo(0,0,0,t,c)
return i.overlay=l,ho(e,i,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i})}(e,t,n,a,c)
break
case Cm.InAppPurchase:f=function(e,t,n,r,i){return Kv.context("createTodayInAppPurchaseCard",()=>{const s=vo(e,t,n,r)
Po(e,t,n,r)
const a=function(e,t){if(1===t.length){const e=t[0]
if(e.type===rq)return e}return null}(0,Eo(0,t))
if(o(a))return Co(r),null
const c=Ed(e,a,{offerStyle:xj,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker},artworkUseCase:O6.LockupIconSmall})
return o(c)?(Co(r),null):(c.theme=WH,s.media=new NX(c),s.media.impressionMetrics=c.impressionMetrics,s.media.impressionMetrics.fields[UM]=s.impressionMetrics.fields.id,s.style=mq,ho(e,s,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Co(r),s)})}(e,t,n,a,c)
break
case Cm.AppEventCard:f=function(e,t,n,r,o){return Kv.context("createTodayAppEventCard",()=>{var i,s,a,c,l
if(!ii(e))return null
const d=function(e,t){let n
const r=we(t,RH)
if(r.length>0)n=r[0]
else{const e=we(t,$H)
if(0===e.length)return null
n=e[0]}return n}(0,t)
if((0,Zv.isNothing)(d))return null
const f=vo(e,t,n,r,t=>{t.inAppEventId=d.id
const n=pe(e,d,rW);(0,Jv.isSome)(n)&&(t.relatedSubjectIds=[n.id])});(0,Jv.isSome)(f.editorialDisplayOptions)&&(f.editorialDisplayOptions.useMaterialBlur=!0),Po(e,t,n,r)
const h=eo(e,t,n)
if((0,Zv.isNothing)(h))return Co(r),null
const p=null!==(s=null===(i=h.joeColors)||void 0===i?void 0:i.textColor4)&&void 0!==s?s:bY,w=be(null!==(c=null===(a=h.joeColors)||void 0===a?void 0:a.bgColor)&&void 0!==c?c:bY)?Jq:Tq,g={pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:f$}
f.style=null!==(l=Mo(h.joeColors,mB))&&void 0!==l?l:be(p)?Jq:Tq
const v=Fo(0,f.style),m=j(t,nq),y=gi(e,d,null,!1,!1,No(f.style),v,!0,g,!0,!0,m,!1,u(n.allowUnpublishedAppEventPreviews))
if((0,Zv.isNothing)(y)||y instanceof Date)return Ur(y,r.refreshController),Co(r),null
const A=y
return f.media=new HZ(A.formattedDates,A.startDate,p,h.artworks,h.videos,h.artworkLayoutsWithMetrics,w),(0,Jv.isSome)(A.lockup)&&(f.overlay=new qZ(A.lockup)),ho(e,f,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),f})}(e,t,n,a,c)
break
case Cm.List:case Cm.NumberedList:f=function(e,t,n,r,o){return Kv.context("createTodayListCard",()=>{var i,s,a
const c=vo(e,t,n,r)
Po(e,t,n,r),n.useJoeColorIconPlaceholder=!0
let l=Eo(0,t)
const u=Oo(e,l,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0)
if(0===u.length)return Co(r),null
if(n.canDisplayArcadeOfferButton=!1,u.length<function(e){return"tv"===e.client.deviceType?3:4}(e)&&n.enableListCardToMultiAppFallback)Ro(e,t,u,c)
else{if(ko(t,n.coercedCollectionTodayCardDisplayStyle)===Cm.NumberedList){let e=1
for(const t of u)t.ordinal=`${e}`,e++}const r=eo(e,t,n),o=Mo(null==r?void 0:r.joeColors,uj),l=!0
null==r||r.videos.forEach(e=>{e.canPlayFullScreen=!1,e.playbackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},e.autoPlayPlaybackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}}),c.style=l?void 0:mq,c.media=new BX(u,null!==(i=null==r?void 0:r.artworks)&&void 0!==i?i:[],null!==(s=null==r?void 0:r.videos)&&void 0!==s?s:[],null!==(a=null==r?void 0:r.artworkLayoutsWithMetrics)&&void 0!==a?a:[],void 0,l?o!==mq:o===Jq)}return ho(e,c,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),c})}(e,t,n,a,c)
break
case Cm.River:case Cm.Grid:f=function(e,t,n,r,o){return Kv.context("createTodayRiverCard",()=>{const i=vo(e,t,n,r)
n.useJoeColorIconPlaceholder=!0,Po(e,t,n,r)
const s=function(e,t,n,r,o){const i=Eo(0,t).filter(t=>{const n=qf(e,t)
return!Vf(e,t)||!n})
return Oo(e,i,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0,!1)}(e,t,n,r)
return 0===s.length?(Co(r),null):(n.canDisplayArcadeOfferButton=!1,s.length<function(e){return"tv"===e.client.deviceType?2:4}(e)?Ro(e,t,s,i):(i.style=Jq,function(e){for(const t of e)be(t.icon.backgroundColor,90)||(t.icon.backgroundColor=Ae(.8,.8,.8))}(s),i.media=new UX(s)),ho(e,i,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i)})}(e,t,n,a,c)
break
case Cm.SingleApp:f=To(e,t,n,a,c)
break
case Cm.ShortImage:f=function(e,t,n,r,o){return Kv.context("createTodayShortImageCard",()=>{const i=vo(e,t,n,r)
Po(e,t,n,r)
const s=Ao(e,t,i,n,r)
let a=!1
const c=Eo(0,t),l=Fo(0,i.style),u=Oo(e,c,n,r.pageInformation,r.locationTracker,No(i.style),l,ra(0,t)),d=fo(0,0,0,t,u)
return i.overlay=d,s||1!==c.length||(a=bo(e,t,i,c,n,r)),s||a?(ho(e,i,n,ko(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i):(Co(r),null)})}(e,t,n,a,c)
break
default:f=null}return r(f)?(e.console.log(`Unknown style: ${l}`),f):(function(e,t,n,r){const o=ko(r,n.coercedCollectionTodayCardDisplayStyle),s=Bo(e,r,n.heroDisplayContext,o,n.prevailingCropCodes)
let a=[],c=[]
var l
i(s)&&(a=[s]),i(t.media)&&(A(l=t.media)&&l[PW]===_y||function(e){return A(e)&&e[PW]===Ey}(t.media))&&(c=t.media.videos),new UZ(a,c)}(e,f,n,t),function(e){(0,Jv.isSome)(e.clickAction)&&wt(e.clickAction)&&(e.overlay=new VZ(e.clickAction),e.style=mq)}(f),function(e,t){(0,Jv.isNothing)(e.media)||(e.media.otdTextStyle=t.useOTDTextStyle)}(f,n),function(e,t){const n=t.media
if(!function(e){return A(e)&&function(e){return Object.values(xZ).includes(e)}(e[PW])}(r=n)||!function(e){return Object.values(MZ).includes(e)}(r[PW]))return
var r
const o=s(n.videos)
t.supportsMediaMirroring=o}(0,f),(0,Jv.isNothing)(f.media)&&(e.console.log(`Missing required media: ${l}`),f=null),f)},t=>(e.console.log(t),null))}function Po(e,t,n,r,i){const a=s(i)?i:function(e,t,n){let r=Jf(e,t,AW)
if(o(r))switch(n){case Cm.AppOfTheDay:case Cm.GameOfTheDay:r=j(t,nq)}return r}(e,t,ko(t,n.coercedCollectionTodayCardDisplayStyle))
Ch(e,Io(e,t,n,r,a),null!=a?a:"")}function Io(e,t,n,r,o){var i
return Vh(e,t,null!=o?o:"",{...null==n?void 0:n.baseMetricsOptions,targetType:qj,pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdEligible:null!==(i=null==n?void 0:n.isAdEligible)&&void 0!==i&&i,optimizationId:f(t,AC),optimizationEntityId:f(t,TC),rowIndex:null==n?void 0:n.currentRowIndex,displayStyle:null==n?void 0:n.metricsDisplayStyle})}function Co(e){Oh(e.locationTracker)}function ko(e,t){const n=j(e,GN)
return GX.has(n)&&(0,Jv.isSome)(t)?t:n}function Oo(e,t,n,r,i,a,c,l,u=!0){return o(t)?[]:Nd(e,t.filter(e=>!s(e.attributes)||e.type!==rq),{lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},offerEnvironment:a,offerStyle:c,clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:l,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:O6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,useJoeColorIconPlaceholder:n.useJoeColorIconPlaceholder,skipDefaultClickAction:!u},filter:rm.TodayCard})}function Eo(e,t){return we(t,$H)}function Ro(e,t,n,r){const o=Jf(e,t,cV)
if(r.media=new BZ(n,o),r.style=Jq,(0,Jv.isSome)(r.clickAction)&&ht(r.clickAction)){const e=wz.from(r.clickAction.pageUrl)
e.param(tz.showingFallbackMedia,bq),r.clickAction.pageUrl=e.build()}}function Do(e,t){switch(t){case Cm.AppOfTheDay:case Cm.GameOfTheDay:return E_
case Cm.AppEventCard:return R_
case Cm.Video:case Cm.FullBleedImage:return CM
default:return D_}}function _o(e,t,n){if(o(t))return null
const r=Xd(e,t,{withJoeColorPlaceholder:!0,useCase:O6.TodayCardMedia})
return r.crop=n||"sr",r}function Lo(e,t,n){const r=B(t,Do(0,ko(t,n.coercedCollectionTodayCardDisplayStyle)))
return i(r)?f(r,"bgGradientKind"):null}function Mo(e,t=uj){if((0,Jv.isNothing)(e))return
if((0,Jv.isSome)(null==e?void 0:e.textGradient)&&2===e.textGradient.length)return be(e.textGradient[0])?mq:Jq
const n=e[t]
if((0,Jv.isNothing)(n))return
const r=Te(n)
return r<=.1?Jq:r>=.84?mq:Tq}function xo(e,t=uj){var n
return null!==(n=Mo(e,t))&&void 0!==n?n:Tq}function $o(e,t){return i(t.heading)?t.heading.replace(/\n/g," "):t.collapsedHeading}function Fo(e,t){return Rj}function No(e){return e===mq?Tq:qj}function Bo(e,n,r,o,i){const s=function(e,t,n,r){return t===Eq?Do(0,n):"editorialArtwork.crossoverCard"}(0,r,o,Object.keys(B(n,Hq)))
return _o(e,B(n,s),function(e,t,n,r){return _m.Article,_m.Article,null==r?void 0:r.defaultCrop}(0,0,t(s),i))}function Uo(e,t){let n=Kf(e,t,cV)
if(s(n)||(n=Jf(e,t,AW)),!s(n)){const e=j(t,MH)
e!==Cm.AppOfTheDay&&e!==Cm.GameOfTheDay||(n=j(t,nq))}return n}function Go(e,t,n){const r=j(t,n)
if(o(r))return null
const s=new wz(r)
let a=null
switch(e.host.clientIdentifier){case pY:a=pq
break
case hY:a=gW}a&&s.param(lz,a)
const c=Ve(Ge(e,t))
return i(c)&&s.param(tz.productVariantID,c),s.toString()}function jo(e,t,n){if(o(t))return null
const r=new tK(t)
return r.title=null!=n?n:e.loc.string("ShareSheet.CopyLink.Title"),r.artwork=Ot(e,"systemimage://link"),new yZ("com.apple.AppStore.copyLinkActivity",r)}function Vo(e,t,n){return Kv.context("shareSheetDataForProductFromProductData",()=>{if(r(t))return null
const o=Go(e,t,eW),s=j(t,AW),a=j(t,pH),c=t.id,l=e.client.storefrontIdentifier
if(!(o&&s&&a&&c))return null
const u=Go(e,t,"shortUrl")
let d=null,f=null
const h=Qe(e,t,NH)||a
let p
const w=xe(e,t,vW)
Me(e,t,vW),p=w?wO:gV,i(t)&&j(t,eW)&&(d=rf(e,t,{useCase:O6.LockupIconSmall},n),f=function(e,t){return Kv.context("notesMetadataFromProductData",()=>{var n
if(r(t))return null
const o=j(t,AW)
if((0,Jv.isNothing)(o)||0===o.length)return null
const i=Go(e,t,eW),s=j(t,pH),a=j(t,"genreNames.0"),c=null===(n=Lf(e,t))||void 0===n?void 0:n.fileSizeByDevice
let l
switch(t.type){case yW:l=rW
break
case aW:l=Wk
break
case rq:l=aG
break
default:l=null}return new mZ(o,i,s,a,c,l)})}(e,t))
const g=new PZ(c,l,s,p,d,[],[],!1,h,null,null,f)
return new TZ(g,o,u)})}function Ho(e,t,n,o,s){return Kv.context(`shareActionFromData: ${t.type}`,()=>{var a
const c=t.id
switch(e.client.deviceType){case vW:{const r=Vo(e,t)
if(r){const t=new oZ(r,[])
return Xs(e,t,{targetType:TW,id:c,actionType:fB,pageInformation:n,locationTracker:o}),t}break}case lW:case oW:case iW:{const l=Vo(e,t,s),u=[]
if((null===(a=null==l?void 0:l.url)||void 0===a?void 0:a.length)>0){const t=jo(e,l.url)
i&&u.push(t)}const d=function(e,t){if(!e.bag.isContentGiftingEnabled)return null
if(r(t))return null
const n=wr(e,t)
return r(n)||V(t,Sq)?null:h(n,tN)>0?t.id:null}(e,t)
if(d){const t=new FY(kj)
t.presentationContext=yL,t.title=e.loc.string("SHARE_GIFT_APP"),t.artwork=Ot(e,"systemimage://app.gift"),t.pageUrl=`gift/${d}`,Xs(e,t,{targetType:TW,id:c,actionType:QF,actionContext:uA,pageInformation:n,locationTracker:o})
const r=new yZ("com.apple.AppStore.giftActivity",t)
u.push(r)}if(l){const t=new oZ(l,u,zy)
return t.title=e.loc.string("SHARE_APP"),t.artwork=Ot(e,gO),Xs(e,t,{targetType:TW,id:c,actionType:fB,actionContext:uA,pageInformation:n,locationTracker:o}),t}if(u.length>0){const t=u.map(e=>e.action),r=new IZ(t)
return r.isCancelable=!0,r.isCustom=!0,Xs(e,r,{targetType:TW,id:c,actionType:"actionSheet",pageInformation:n,locationTracker:o}),r}break}}return null})}function qo(e,t,n){if((0,Jv.isNothing)(t))return null
const r=t.match(/P(\d+)([A-Z]+)/)
if(!r||3!==r.length)return null
let o=h(r[1]),i=r[2]
return o&&i?("D"===i&&o>0&&o%7==0&&(i="W",o/=7),new WX(o,null!=n?n:1,i)):null}function Wo(e,t){const n=l(t,fR)[0]
if(!n)return null
const r=f(n,fG),o=h(n,hG),i=f(t,fG),s=h(t,hG)
if(!r||!i)return null
const a=f(n,ZS),c=qo(0,r,o),u=qo(0,i,s),d=f(n,cj).replace(/ /g,"\xa0"),p=f(t,cj).replace(/ /g,"\xa0")
let w=zo(e,u.type,u.periodDuration,p)
switch(w=w.replace(/\//g,"\u2060/\u2060"),a){case QS:const t=Yo(e,c.type,c.periodDuration*c.periodCount)
if(t&&w)return e.loc.string("InAppOfferPage.Description.FreeTrialTemplate").replace(XR,t).replace(eD,w)
break
case XS:const n=Yo(e,c.type,c.periodDuration*c.periodCount)
if(n&&w)return e.loc.string("InAppOfferPage.Description.PaidUpFrontTemplate").replace(XR,n).replace("@@trialPrice@@",d).replace(eD,w)
break
case eP:const r=zo(e,c.type,c.periodDuration,d),o=Yo(e,c.type,c.periodDuration*c.periodCount)
if(o&&w)return e.loc.string("InAppOfferPage.Description.PaidTrialTemplate").replace("@@trialPriceDuration@@",r).replace(XR,o).replace(eD,w)
break
default:return null}return null}function zo(e,t,n,r){let o
switch(t){case"D":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Days.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Days",n)
break
case"W":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Weeks.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Weeks",n)
break
case"M":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Months.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Months",n)
break
case"Y":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Years.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Years",n)}return o.replace("@@price@@",r)}function Yo(e,t,n){switch(t){case"D":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Days.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Days",n)
case"W":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Weeks.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Weeks",n)
case"M":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Months.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Months",n)
case"Y":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Years.one").replace(pG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Years",n)}return null}function Jo(e,t){var n,r,i
const s=pe(e,t,dU)
if((0,Zv.isNothing)(s))return
const a=wr(e,s),c=p(s,XF)
if(o(a)||o(c))return
const l=null===(n=Ko(e,f(a,fG),h(a,hG),f(a,cj)))||void 0===n?void 0:n.replace("/","/\u2060"),u=null===(r=Ko(e,f(c,fG),h(c,hG),f(c,cj)))||void 0===r?void 0:r.replace("/","/\u2060")
if(o(l)||o(u))return null
const d=j(t,AW),w={"@@discountedPrice@@/@@recurringSubscriptionPeriod@@":u,"@@regularPrice@@/@@recurringSubscriptionPeriod@@":l,"@@discountedPricePerRecurringSubscriptionPeriod@@":u,"@@regularPricePerRecurringSubscriptionPeriod@@":l}
let g=null!=d?d:""
Object.keys(w).forEach(e=>{g=g.replace(e,w[e])})
const v=g.replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,""),m=new qX(g,EV,IA),y=null!==(i=j(t,BG))&&void 0!==i?i:"",A=e.loc.string("ContingentOffer.Description.Format"),T={"@@BranchName@@":j(s,AW),"@@RegularPrice@@":l,"@@DiscountedPrice@@":u}
let b=A
return Object.keys(T).forEach(e=>{b=b.replace(e,T[e])}),{title:m,rawTitle:v,description:[b,y].join(" ")}}function Ko(e,t,n,r){const o=qo(0,t,n)
if(!(0,Zv.isNothing)(o)&&!(0,Zv.isNothing)(r))return zo(e,o.type,o.periodDuration,r)}function Zo(e,t,n,r,o){let i
switch(t){case lU:i=bW
break
case cU:i=cU
break
case RL:i=aj}const s={targetType:TW,actionType:i,targetId:t,idType:void 0,location:Ph(e,{pageInformation:n,locationTracker:r,targetType:TW,id:t},null!=o?o:t)}
return _t(e,t,TW,s)}function Qo(e,t,n,r){const o=qo(0,t,n)
return(0,Zv.isNothing)(o)||(0,Zv.isNothing)(r)?null:zo(e,null==o?void 0:o.type,null==o?void 0:o.periodDuration,r)}function Xo(e,t,n,r,o){let i
switch(t){case lU:i=bW
break
case cU:i=cU
break
case RL:i=aj}const s={targetType:TW,actionType:i,targetId:t,idType:void 0,location:Ph(e,{pageInformation:n,locationTracker:r,targetType:TW,id:t},null!=o?o:t)}
return _t(e,t,TW,s)}function ei(e){switch(e.type){case hW:return Pm.AppEvent
case OV:return Pm.ContingentOffer
case ZV:return Pm.OfferItem
default:return null}}function ti(e){switch(e.type){case hW:return f$
case OV:case ZV:return CO
default:return null}}function ni(e){switch(e.type){case hW:return SA
case OV:return"contingentPriceOffer"
case ZV:return"winbackPriceOffer"
default:return null}}function ri(e,t,n,s,a,c,l,u,d,w,v,m,y,A){const T=ei(t),b={...d,targetType:ti(t)}
switch(T){case Pm.AppEvent:return gi(e,t,n,s,a,c,l,u,b,w,v,m,y,A)
case Pm.ContingentOffer:return function(e,t,n,s,a,c,l,u){var d,f,h,w
if(t.type!==OV)return null
const v=li(e,t,c$)
if(r(v))return null
const m=be(v.backgroundColor)?Jq:Tq,y=j(t,uU),A=j(t,NH),T=j(t,nq),b=e.loc.string("ContingentOffer.AdditionalInfoButton.Title")
if((0,Zv.isNothing)(y)||(0,Zv.isNothing)(T))return null
const S=pe(e,t,dU)
if((0,Zv.isNothing)(S)||o(p(S,XF)))return null
const P=Jo(e,t)
if((0,Zv.isNothing)(P)||(0,Zv.isNothing)(null==P?void 0:P.title))return null
const I=pe(e,t,w$),C=H(I,iN),k=di(e,t,I,"",s,a,!1,c,l,null,u,!0)
if((0,Zv.isNothing)(k))return null
const O=pe(e,t,EO)
let E;(0,Zv.isSome)(O)&&(0,Zv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(d=li(e,O,fW))&&void 0!==d?d:ci(e,O,fW)),(0,Zv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(f=function(e,t){var n,r
const o=g(t,"meta.associations.trunks")
if((0,Zv.isNothing)(o))return null
const i=o.data[0]
if(null!==(r=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n[RO])&&void 0!==r&&r){const t=Ke(e,i,DO)
return(0,Zv.isNothing)(t)?null:Xd(e,t,{useCase:O6.LockupIconSmall,style:AB})}return null}(e,t))&&void 0!==f?f:E)
const R=function(e,t,n){const r=g$+j(n,AW)+v$,o=j(n,BG)+m$,i=g$+e.loc.string("ContingentOffer.Terms.Title")+v$,s=j(t,sN)
return new qX([r,o,i,s].join(m$),EV)}(e,t,S),D=new HX(v,m,C,b,P.title,null!=A?A:void 0,null!==(h=P.description)&&void 0!==h?h:void 0,T,y,R,null!=E?E:void 0,k)
return D.title=null!==(w=P.rawTitle)&&void 0!==w?w:void 0,i(I)&&(D.clickAction=hi(e,t,I,D,c,l)),D}(e,t,0,c,l,b,v,y)
case Pm.OfferItem:return function(e,t,n,s,a,c,l,u){var d,w,g,v,m,y
if(t.type!==ZV)return null
const A=j(t,HH)
if("resubscription"!==A&&A!==y$)return null
const T=Tq,b=pe(e,t,fU)
if((0,Zv.isNothing)(b))return null
const S=p(b,vL),P=wr(e,b)
if((0,Zv.isNothing)(S))return null
const I=null!==(d=null!=n?n:pe(e,t,rW))&&void 0!==d?d:pe(e,b,rW),C=H(I,iN),k=j(t,DL)
if((0,Zv.isNothing)(k)||!function(e){if((0,Zv.isNothing)(e)||o(e))return!1
const t=new Date(e)
if(r(t))return!1
const n=new Date
return!(t.getTime()<=n.getTime())}(k))return null
const O=new Date(k)
let E=function(e,t){if((0,Zv.isNothing)(t))return null
const n=Re(t),o=new Date,i=(a=n,r(s=o)||r(a)?null:Math.floor((a.getTime()-s.getTime())/864e5))
var s,a
if((0,Zv.isNothing)(i))return null
const c=function(e,t){var n,r
return(null===(n=Re(e))||void 0===n?void 0:n.getTime())===(null===(r=Re(t))||void 0===r?void 0:r.getTime())}(o,t)
if(i>90)return e.loc.string(kA)
if(i>5){const n=o.getFullYear()!==t.getFullYear()?e.loc.string("OfferItems.FormattedDate.NextYear.DateFormat"):e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.DateFormat"),r=e.loc.uppercased(e.loc.formatDate(n,t))
return(0,Zv.isNothing)(r)?null:e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.Title").replace(OA,r)}return i>1?e.loc.string("OfferItems.FormattedDate.FiveDaysOrLess.Title").replace(pG,e.loc.formattedCount(i)):1!==i||c?e.loc.string("OfferItems.FormattedDate.Today.Title"):e.loc.string("OfferItems.FormattedDate.Tomorrow.Title")}(e,O);(0,Zv.isNothing)(E)&&(E=e.loc.string(kA))
let R=rf(e,b,{useCase:O6.LockupIconLarge,withJoeColorPlaceholder:!0,overrideTextColorKey:mB})
o(R)&&(R=Ot(e,_O,200,200,{type:GV,red:0,green:0,blue:0,alpha:1}),R.style=aG)
const D=qo(0,f(S,fG),h(S,hG)),_=(0,Zv.isSome)(D)?Yo(e,D.type,D.periodDuration*D.periodCount):void 0,L=null===(w=Qo(e,f(P,fG),h(P,hG),f(P,cj)))||void 0===w?void 0:w.replace("/","/\u2060"),M=null===(g=Qo(e,f(S,fG),h(S,hG),f(S,cj)))||void 0===g?void 0:g.replace("/","/\u2060"),x=e.loc.string(CA),$={"@@redemptionDate@@":e.loc.formatDate(x,O),"@@skuName@@":null!==(v=j(b,AW))&&void 0!==v?v:"@@skuName@@","@@discountedPrice@@":null!=M?M:"@@discountedPrice@@","@@regularPricePerDuration@@":null!=L?L:"@@regularPricePerDuration@@","@@discountDuration@@":null!=_?_:"@@discountDuration@@","@@payUpfrontPrice@@":null!==(m=f(S,cj))&&void 0!==m?m:"@@payUpfrontPrice@@"},F=j(t,uU)
if((0,Zv.isNothing)(F))return null
const N=wi(j(t,Wq),$),B=new qX(N,EV,IA),U=wi(j(t,NH),$),G=wi(null!==(y=j(t,_L))&&void 0!==y?y:"",$)
let V
if(i(I)&&(V=di(e,t,I,"",s,a,!1,c,l,null,u,!0)),(0,Zv.isNothing)(V))return null
const q=new zX(null,null,T,C,B,E,U,G,F,O,R,V)
return q.title=N,i(I)&&(q.clickAction=hi(e,t,I,q,c,l)),q}(e,t,n,c,l,b,v,y)
default:return null}}function oi(e,t,n,o,a,c,l,u){const d=ei(t),f={...a,targetType:ti(t)}
switch(d){case Pm.AppEvent:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=ci(e,t,uG),p=ui(e,t,gB,!0,!0),w=S(o),g=null!==(d=null==p?void 0:p.preview)&&void 0!==d?d:h
let v=Jq,m=!0,y=!1
i(g)&&(m=be(g.backgroundColor),y=be(g.backgroundColor,10),v=m?Jq:Tq)
const A=Wn(0,Pm.AppEvent,t.id,n.id,l,null!==(f=a.recoMetricsData)&&void 0!==f?f:null),T={...a,pageInformation:A,locationTracker:{rootPosition:0,locationStack:[]},targetType:vB},b={...T,id:n.id,inAppEventId:t.id,relatedSubjectIds:[n.id]}
w.notificationConfig=fi(e,t,o,b,!1)
const P=function(e,t,n,r){var o,s
const a=j(t,eW)
if((0,Jv.isNothing)(a)||0===a.length)return null
const c=null!==(o=n.moduleArtwork)&&void 0!==o?o:null===(s=n.moduleVideo)||void 0===s?void 0:s.preview
let l=e.loc.string(TA)
l===TA&&(l=n.subtitle)
const u=function(e,t,n,r,o,i){return Kv.context("shareSheetDataForAppEvent",()=>{const e=new bZ(t,n,i)
return new TZ(e,r,void 0)})}(0,n.title,l,a,0,c)
if(!i(u))return null
const d=function(e,t,n){var r
const o=[]
if((null==n?void 0:n.length)>0){const t=jo(e,n)
i&&o.push(t)}if(t.startDate.getTime()<=Date.now())return o
if(e.host.clientIdentifier===vY)return o
const s=new GY(Gq)
s.title=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_TITLE"),s.message=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_DETAIL"),s.isCancelable=!0,s.buttonTitles=[e.loc.string(lA)],s.buttonActions=[new JY("prefs:root=Privacy&path=CALENDARS",!0)]
let a=!1
if(i(t.endDate)){const e=Re(t.startDate),n=Re(t.endDate),r=t.endDate.getTime()-t.startDate.getTime(),o=216e5
n.getTime()>e.getTime()&&r>o&&(a=!0)
const i=8634e4
e.getTime()===n.getTime()&&r>=i&&(a=!0)}const c=new SZ(t.startDate,t.endDate,a,t.title,null===(r=t.lockup)||void 0===r?void 0:r.title,t.detail,n,s,pO)
c.title=e.loc.string("SHARE_SHEET_ADD_TO_CALENDAR"),c.artwork=Ot(e,"systemimage://calendar.circle")
const l=new yZ("com.apple.AppStore.createCalendarEventActivity",c)
return o.unshift(l),o}(e,n,a),f=new oZ(u,d)
return Xs(e,f,{...r,targetType:cW,actionType:fB,idType:Dq}),f}(e,t,o,b),I=m?Jq:Tq,C=di(e,t,n,w.title,I,Rj,!1,T,c,l,!1,!1)
if(r(C))return null
w.lockup=C
const k=new rZ(w,h,p,P,v,y)
return jn(e,k,A,e=>{s(l)&&kW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),k}(e,t,n,o,a,l,u),f=new FY("appEventDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case Pm.ContingentOffer:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=li(e,t,uG),p=S(o)
let w=Jq,g=!0
i(h)&&(g=be(h.backgroundColor),w=g?Jq:Tq)
const v=Wn(0,Pm.ContingentOffer,t.id,n.id,l,null!==(d=a.recoMetricsData)&&void 0!==d?d:null),m={...a,pageInformation:v,locationTracker:{rootPosition:0,locationStack:[]}},y=g?Jq:Tq,A=di(e,t,n,null!==(f=p.title)&&void 0!==f?f:void 0,y,Rj,!1,m,c,l,!1,!1)
if(r(A))return null
p.offerLockup=A,p.trunkAppIcon=o.trunkAppIcon
const T=new cZ(p,null!=h?h:void 0,w)
return T.backButtonActionMetrics.addMetricsData(Zo(e,cU,v,m.locationTracker)),T.learnMoreActionMetrics.addMetricsData(Zo(e,lU,v,m.locationTracker,o.learnMoreTitle)),T.closeButtonActionMetrics.addMetricsData(Zo(e,RL,v,m.locationTracker)),jn(e,T,v,e=>{s(l)&&kW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),T}(e,t,n,o,a,l,u),f=new FY("contingentOfferDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case Pm.OfferItem:return function(e,t,n,o,i,a,c,l){const u=function(e,t,n,o,i,a,c,l){var u,d
let f=li(e,t,uG)
f=null
const h=Jq,p=S(o),w=Wn(0,Pm.OfferItem,t.id,n.id,c,null!==(u=i.recoMetricsData)&&void 0!==u?u:null),g={...i,pageInformation:w,locationTracker:{rootPosition:0,locationStack:[]}},v=Jq,m=di(e,t,n,null!==(d=p.title)&&void 0!==d?d:void 0,v,Rj,!1,g,a,c,!1,!1)
if(r(m))return null
p.offerLockup=m
const y=e.loc.string("Winback.AdditionalInfoButton.Title"),A=pe(e,t,fU),T=j(t,DL)
let b;(0,Zv.isSome)(T)&&(0,Zv.isSome)(A)&&(b=function(e,t,n,r){if((0,Zv.isNothing)(n))return
const o=j(n,AW),i=(0,Zv.isSome)(o)?g$+o+v$:void 0,s=j(n,BG),a=(0,Zv.isSome)(s)?s+m$:void 0,c=g$+e.loc.string("Promotion.Terms.Title")+v$
let l
const u=e.loc.string(CA)
if((0,Zv.isSome)(o)&&(0,Zv.isSome)(r)){const n={"@@redemptionDate@@":e.loc.formatDate(u,r),"@@skuName@@":o}
l=wi(j(t,sN),n)}const d=[i,a,c,l].filter(Zv.isSome).join(m$)
return new qX(d,EV)}(e,t,A,new Date(T)))
const P=new lZ(p,void 0,void 0,h,!1,y,b)
return P.backButtonActionMetrics.addMetricsData(Xo(e,cU,w,g.locationTracker)),P.learnMoreActionMetrics.addMetricsData(Xo(e,lU,w,g.locationTracker,y)),P.closeButtonActionMetrics.addMetricsData(Xo(e,RL,w,g.locationTracker)),jn(e,P,w,e=>{s(c)&&kW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),P}(e,t,n,o,i,c,l),d=new FY("offerItemDetail")
return d.title=o.title,d.pageData=u,d.animationBehavior=a,i&&i.pageInformation&&(d.referrerUrl=i.pageInformation.pageUrl),d}(e,t,n,o,f,c,l,u)
default:return null}}function ii(e){return e.bag.enableAppEvents&&!0}function si(e){return e.bag.enableContingentOffers&&!0}function ai(e){return e.bag.enableOfferItems&&!0}function ci(e,t,n){const r=B(t,n)
return(0,Jv.isNothing)(r)?null:Xd(e,r,{useCase:O6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function li(e,t,n){const r=nt(e,t)
if((0,Jv.isNothing)(r))return null
const o=se(t,r,n)
return(0,Jv.isNothing)(o)?null:Xd(e,o,{useCase:O6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function ui(e,t,n,o,i){const s=ci(e,t,`${n}.previewFrame`)
if(r(s))return null
const a=j(t,`${n}.video`)
if(r(a))return null
const c=new Cz(a,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:o,playbackControls:i?{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}:{},autoPlayPlaybackControls:i?{muteUnmute:!0}:{}})
return c.canPlayFullScreen=o,c.allowsAutoPlay=!0,c.looping=!0,c}function di(e,t,n,i,s,a,c,l,u,d,f,h){var p,w,g,v
if((0,Jv.isNothing)(t)||(0,Jv.isNothing)(n))return null
const m=ei(t),y={...l,id:t.id,relatedSubjectIds:[n.id],idType:Dq},A={...l,id:n.id,relatedSubjectIds:[n.id],targetType:cW,idType:Dq,kind:null,softwareType:null,title:null!==(p=j(n,AW))&&void 0!==p?p:"",excludeAttribution:o(d)}
if(m===Pm.AppEvent&&(y[h$]=t.id,A[h$]=t.id),(v=l)&&Object.prototype.hasOwnProperty.call(v,"id")&&(y.id=l.id,y.idType=l.idType),h){const n=m===Pm.ContingentOffer?null===(w=Jo(e,t))||void 0===w?void 0:w.rawTitle:j(t,AW)
Ch(e,y,null!=n?n:"")}const T=j(t,OL),b={metricsOptions:A,artworkUseCase:O6.LockupIconSmall,externalDeepLinkUrl:null!=T?T:void 0,crossLinkSubtitle:c?i:void 0,offerEnvironment:s,offerStyle:a,skipDefaultClickAction:!u,includeBetaApps:!0,referrerData:null!=d?d:void 0,shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ)&&f,parentAppData:n,useJoeColorIconPlaceholder:!0,overrideArtworkTextColorKey:mB},S=Od(e,m===Pm.AppEvent?n:t,b)
return h&&Oh(l.locationTracker),r(S)?null:(c&&(S.crossLinkTitle=null!==(g=e.loc.uppercased(S.title))&&void 0!==g?g:void 0),S)}function fi(e,t,n,r,o){if(n.startDate.getTime()<=Date.now())return null
if((0,Jv.isNothing)(n.lockup))return null
const i=e.loc.string("APP_EVENTS_NOTIFICATION_TITLE").replace("{appTitle}",n.lockup.title),s=e.loc.string("APP_EVENTS_NOTIFICATION_DETAIL").replace("{eventTitle}",n.title),a=n.startDate,c=n.lockup.icon,l=n.lockup.icon.template.replace("{w}",`${c.width}`).replace("{h}",`${c.height}`).replace("{c}","wd").replace("{f}",EL)
let u,d
if(o&&(u=new GY(yB),u.title=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_TITLE"),u.message=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_DETAIL"),u.artwork=Ot(e,PA)),e.bag.newEventsForODJAreEnabled){const o=new xW,i=Nt(r.pageInformation)
i[jG]="notifyActivateNotificationsDisabled",i[dG]=Ph(e,{...r,id:t.id},""),i[p$]=""
const s=_t(e,n.lockup.adamId,cW,i)
o.actionMetrics.addMetricsData(s),d=o}else{const t=new GY(Gq)
t.title=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_TITLE"),t.message=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_DETAIL"),t.isCancelable=!0,t.buttonTitles=[e.loc.string(lA)],t.buttonActions=[new JY("prefs:root=NOTIFICATIONS_ID&path=com.apple.AppStore",!0)],d=t}const f=new GY(Gq)
f.title=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_TITLE"),f.message=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_DETAIL"),f.isCancelable=!0
const h=(new wz).set(Wj,jW).param(tz.appId,n.lockup.adamId).param(tz.bundleId,n.lockup.bundleId).param(tz.appEventId,n.appEventId)
h.host=ZW
const p=j(t,OL);(0,Jv.isSome)(p)&&(null==p?void 0:p.length)>0&&h.param(tz.appEventDeepLink,encodeURIComponent(p))
const w=Nt(r.pageInformation)
w[jG]="notifyActivate",w[dG]=Ph(e,{...r,id:t.id},"")
const g=_t(e,n.lockup.adamId,cW,w),v=S(w)
v[jG]="notifyDeactivate"
const m=_t(e,n.lockup.adamId,cW,v)
return new YX(t.id,i,s,l,a,u,d,f,h.build(),g,m)}function hi(e,t,n,r,o,i){const s=oi(e,t,n,r,o,WH,i,null)
if((0,Jv.isNothing)(s))return
const a={id:t.id,actionDetails:{action:"Open",contentType:ti(t)},relatedSubjectIds:[n.id],...o}
return ei(t)===Pm.AppEvent&&(a[h$]=t.id),Xs(e,s,a),s}function pi(e,t,n=null,o,s,a,c,l,u,d){var f
const h=[]
let p
for(const w of t){const t=ri(e,w,n,o,!0,Tq,WH,s,a,c,l,null,u,d)
if(r(t))continue
if(t instanceof Date){((0,Jv.isNothing)(p)||t.getTime()<p.getTime())&&(p=t)
continue}const g=t,v={...a,id:w.id,kind:ni(w),targetType:ti(w),title:null!==(f=g.title)&&void 0!==f?f:"",softwareType:null},m=null!=n?n:pe(e,w,rW)
i(m)&&(v.relatedSubjectIds=[m.id]),Nh(e,g,v),_h(v.locationTracker),h.push(g)}return{appPromotions:h,nextAppEventPromotionStartDate:p}}function wi(e,t){let n=null!=e?e:""
return Object.keys(t).forEach(e=>{n=n.replace(e,t[e])}),n}function gi(e,t,n,r,a,c,l,u,d,f,h,p,w,g){var v,m,y
if(t.type!==hW)return null
const A=j(t,"promotionStartDate")
if((0,Jv.isNothing)(A)||0===A.length)return null
const T=new Date(A)
if((0,Jv.isNothing)(T))return null
const b=new Date
if(T.getTime()>b.getTime()&&!g)return T
const S=ci(e,t,c$),P=ui(e,t,"lockupVideo",!1,!1)
if((0,Jv.isNothing)(S)&&o(P))return null
const I=null!==(v=null==P?void 0:P.preview)&&void 0!==v?v:S,C=be(null==I?void 0:I.backgroundColor)?Jq:Tq,k=be(null==I?void 0:I.backgroundColor,10),O=j(t,AW)
let E=j(t,HH)
s(p)&&(E=p)
const R=j(t,l$)
if((0,Jv.isNothing)(O)||0===O.length||(0,Jv.isNothing)(E)||0===E.length||(0,Jv.isNothing)(R)||0===R.length)return null
const D=new Date(R)
if((0,Jv.isNothing)(D))return null
const _=null!==(m=j(t,BG))&&void 0!==m?m:"",L=null!=n?n:pe(e,t,rW)
let M=null
if((0,Jv.isSome)(L)&&(M=di(e,t,L,O,c,l,u,d,h,null,w,!0)),(0,Jv.isNothing)(M))return e.console.warn(`Parent app for event ${t.id} is missing, returning null.`),null
const x=j(t,"requirement"),$=j(t,NH),F=j(t,u$)
let N
if((0,Jv.isSome)(F)&&F.length>0&&(N=new Date(F)),void 0!==N&&N.getTime()<=b.getTime()&&!f)return null
const B=vi(null!==(y=j(t,d$))&&void 0!==y?y:void 0,D,N),U=mi(e,B,D,N),G=new JX(t.id,null!=S?S:void 0,null!=P?P:void 0,O,null!=$?$:void 0,_,D,N,B,E,null!=x?x:void 0,M,r,U,C,k)
if(i(L)){const n={...d,id:L.id,inAppEventId:t.id,relatedSubjectIds:[L.id]}
G.notificationConfig=fi(e,t,G,n,!0)}return a&&i(L)&&(G.clickAction=hi(e,t,L,G,d,h)),G}function vi(e,t,n){let r=null!=e?e:Mm.live
return r===Mm.live&&i(n)&&n.getTime()-t.getTime()>216e5&&(r=Mm.happening),r}function mi(e,t,n,r){const o=[],i=Re(n)
if((0,Jv.isNothing)(i))return[]
const s=e.loc.string("AppEvents.FormattedDate.SevenDaysOrMore.DateFormat"),a=e.loc.uppercased(e.loc.formatDate(s,n)),c=new KX(!1,void 0,null!=a?a:void 0,void 0,void 0)
o.push(c)
const l=new Date(i)
l.setDate(l.getDate()-6)
const u=e.loc.string("AppEvents.FormattedDate.SixDaysOrLess.DateFormat"),d=e.loc.formatDate(u,n),f=e.loc.uppercased(d),h=new KX(!1,l,null!=f?f:void 0,void 0,void 0)
o.push(h)
const p=new Date(i)
p.setDate(p.getDate()-1)
const w=e.loc.string("AppEvents.FormattedDate.Tomorrow"),g=e.loc.formatDateInSentence(w,bA,n),v=e.loc.uppercased(g),m=new KX(!1,p,null!=v?v:void 0,void 0,void 0)
if(o.push(m),n.getHours()>1||1===n.getHours()&&n.getMinutes()>0){let t
t=n.getHours()>=19?e.loc.string("AppEvents.FormattedDate.Tonight"):e.loc.string("AppEvents.FormattedDate.Today")
const r=e.loc.formatDateInSentence(t,bA,n),s=e.loc.uppercased(r),a=new KX(!1,null!=i?i:void 0,null!=s?s:void 0,void 0,void 0)
o.push(a)}const y=new Date(n)
let A
switch(y.setHours(y.getHours()-1),t){case Mm.available:A="AppEvents.FormattedDate.AvailableIn.MinutesCountdown"
break
case Mm.happening:case Mm.live:default:A="AppEvents.FormattedDate.StartsIn.MinutesCountdown"}const T=new KX(!1,y,void 0,n,A)
let b,S
switch(o.push(T),t){case Mm.available:b=e.loc.string("AppEvents.FormattedDate.NowAvailable"),S=!1
break
case Mm.happening:b=e.loc.string("AppEvents.FormattedDate.HappeningNow"),S=!1
break
case Mm.live:default:b=e.loc.string("AppEvents.FormattedDate.Live"),S=!0}const P=new KX(S,n,b,void 0,void 0)
if(o.push(P),null!==r){const t=new KX(!1,r,e.loc.string("AppEvents.FormattedDate.EventEnded"),void 0,void 0)
o.push(t)}return o}function yi(e){e.includingScopedRelationships(OV,[EO,w$,dU]),e.includingViews([kO,XO]),e.includingScopedAttributes(OV,[AW,NH,sN]),e.includingMetaKeys(KA,[ZA]),e.includingMetaKeys(QA,[RO]),e.includingAssociateKeys(OV,[XA])}function Ai(e){e.includingScopedRelationships(OV,[EO,w$,dU]),e.includingScopedAttributes(OV,[AW,NH,sN]),e.includingMetaKeys(KA,[ZA]),e.includingMetaKeys(QA,[RO]),e.includingAssociateKeys(OV,[XA])}function Ti(e){e.enablingFeature(_V),e.includingScopedAttributes(_V,[Hq]),e.addingQuery("associate[tags]",yW),e.includingScopedRelationships(C$,[mW,eE])}function bi(e){e.includingScopedRelationships(ZV,[fU]),e.includingScopedAttributes(ZV,[Wq,NH,sN,DL]),e.includingMetaKeys(eT,[tT]),e.includingKindsKeys(ZV,[y$])}function Si(e){const{id:t,platform:n,...r}=e
return{...r,id:dt(t),platform:ut(n),$kind:ZX}}function Pi(e){return 0===e.length}function Ii(e){return!Pi(e)}function Ci(e){if(null===QX){QX=new Set
for(const t of e.bag.suppressedAccessibilityAppIds)QX.add(t)}}function ki(e){return e.featureFlags.isEnabled(IJ)&&e.bag.enableAppAccessibilityLabels}function Oi(e,t){return Ci(e),(0,Jv.isSome)(QX)&&Ii(t)&&QX.has(t)}function Ei(e,t){return Ci(e),!!t.startsWith(dA)||(0,Jv.isSome)(QX)&&Ii(t)&&QX.has(t)}function Ri(e){const t=[Hq,$q,wH,LH]
return t.push(hH),e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}function Di(e,t){return t.includingAdditionalPlatforms(ee(e)).includingRelationships(function(e){let t=[]
switch(e.client.deviceType){case vW:t=t.concat(t0),e.appleSilicon.isSupportEnabled&&t.push(PN)
break
case gW:t.push(r0)
break
case iW:t=t.concat(e0)
break
case BV:t=t.concat(n0)
break
default:t=t.concat(XX)}return t}(e)).includingAttributes(Ri(e)).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e)),t}function _i(e){return{storefront:e.locale.activeStorefront,language:e.locale.activeLanguage}}function Li(e,t){return e.locale.normalize(t)}function Mi(e){if(null===o0){o0=new Set
for(const t of e.bag.suppressedPrivacyAppIds)o0.add(t)}}function xi(e,t){return Mi(e),!(0,Zv.isNothing)(o0)&&!o(t)&&o0.has(t)}function $i(e,t){return Mi(e),!(0,Zv.isNothing)(o0)&&!o(t)&&(!(!o0.has("com.apple.InstallAssistant.*")||!t.startsWith(dA))||o0.has(t))}function Fi(e,t){const n=t.host
if(r(n))return!1
const o=[e.bag.mediaHost,e.bag.mediaEdgeHost(e),e.bag.mediaEdgeSearchHost]
for(const e of o)if(!r(e)&&-1!==n.indexOf(e))return!0
return!1}function Ni(e,t,n){if(!(0,Zv.isNothing)(t))return ve(e,new yY(e,t).addingQueryValues(n)).toString()}function Bi(e){let t=e.query.id
const n=e.pathname
if(r(t)&&(null==n?void 0:n.length)>0){const e=s0.exec(n)
e&&e.length>1&&(t=e[1])}if(!a(t)){const n=e.pathComponents()
s(n)&&(t=n[n.length-1])}return t}function Ui(e,t,n=!1){var r,o
let s=Bi(t)
if(!a(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
s in a0&&(s=a0[s])
let c=yW,l=i0,u=[]
u=[MG,qq,aW,HL,O$,k$]
const d=null===(r=t.pathname)||void 0===r?void 0:r.split("/"),f=(0,Zv.isSome)(d)&&d.includes(VW.productBundle)
f&&(c=aW,l=[eV,Lj,LH,nE,Oj],u=[yW,qq,O$]),u.push(jF),e.bag.enablePrivacyNutritionLabels&&!xi(e,s)&&l.push(E$),ki(e)&&!Oi(e,s)&&l.push(R$),e.appleSilicon.isSupportEnabled&&l.push(xH),e.bag.enableUpdatedAgeRatings&&l.push(Fq),of(e)&&l.push(EH),e.bag.enableLicenses&&l.push(sE)
const h=v(t.query[tz.isArcade]);(null===h||h)&&(l.push(hB,pB,$q),u.push(VH)),e.bag.enableSellerInfo&&l.push(PB),e.bag.enableSellerICPAnnotation&&l.push(aE),e.bag.gameCenterExtendSupportedFeatures&&l.push(D$),ma(e)&&u.push(cE)
const p=new yY(e).withIdOfType(s,c).includingAdditionalPlatforms(ee(e)).includingAgeRestrictions().includingRelationships(u).includingAttributes(l).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e)).includingViews([lE,HL])
p.addingRelationshipLimit(qq,te(e)),(null===(o=t.query[tz.productVariantID])||void 0===o?void 0:o.length)>0&&p.addingQuery(tz.productVariantID,t.query[tz.productVariantID])
const w=t.query[iz]
return i(w)&&p.addingQuery(iz,w),ii(e)&&!f&&(si(e)||p.includingScopedRelationships(yW,[hW]),p.includingScopedAttributes(hW,nZ),p.includingScopedAvailableIn(hW,[uE])),si(e)&&yi(p),ai(e)&&bi(p),Kt(e,oq)&&p.enablingFeature(zL),n&&p.enablingFeature(qL),si(e)||p.includingRelationships([YL]),p.attributingTo(t.build())}function Gi(e,t,n,r,o,i){const s=i0
e.bag.enablePrivacyNutritionLabels&&!xi(e,t)&&s.push(E$),ki(e)&&!Oi(e,t)&&s.push(R$),e.appleSilicon.isSupportEnabled&&s.push(xH),e.bag.enableUpdatedAgeRatings&&s.push(Fq),of(e)&&s.push(EH),e.bag.enableLicenses&&s.push(sE),e.bag.gameCenterExtendSupportedFeatures&&s.push(D$)
const a=new yY(e).withIdOfType(t,yW).includingAdditionalPlatforms(ee(e)).includingAttributes(s).includingRelationships([VH,MG,jF,qq,aW,O$,k$]).addingRelationshipLimit(qq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingViews([HL]).usingCustomAttributes(Ue(e))
return n&&a.addingQuery("availability",WL),(0,Zv.isSome)(r)&&a.addingQuery(tz.productVariantID,r),i&&a.enablingFeature(qL),ii(e)&&!o&&(si(e)||a.includingScopedRelationships(yW,[hW]),a.includingScopedAttributes(hW,nZ),a.includingScopedAvailableIn(hW,[uE])),si(e)&&yi(a),ai(e)&&bi(a),si(e)||a.includingRelationships([YL]),ma(e)&&a.includingRelationships([cE]),Kt(e,oq)&&a.enablingFeature(zL),a}function ji(e,t){if(!e.client.isPhone||!e.featureFlags.isEnabled(VJ))return!1
if((0,Jv.isNothing)(t))return!0
switch(t){case tV:return e.bag.isAppsGroupingTagsEnabled
case kH:return e.bag.isAppsProductPageTagsEnabled
case xx:return e.bag.isAppsSlpTagsEnabled
default:return!1}}function Vi(e){return z0.has(e)}function Hi(e){return j0.has(e)}function qi(e){return q0.has(e)}function Wi(e){return H0.has(e)}function zi(e,t,n){const r=q(t,Xj)
let o=null
const i=j(t,"gamesFilter")
switch(i){case pW:case kM:case"all":o=i
break
default:r!==D0&&r!==M0||(o=pW)}let a=null,c=j(t,Ji(0,r)),l=null,d=null,h=j(t,$j)
const p={}
let w=!1
const g=we(t,PU)[0]
if(r===R0&&s(g))if(a=e.loc.uppercased(j(t,Ji(0,r))),h=null,g.type===WV){c=Jf(e,g,AW)
const t=Sn(e,g,!1)
if((0,Jv.isSome)(t)){l=Xd(e,t,{useCase:O6.LockupIconSmall,style:gN})
const n={type:UN,name:aN}
p.eyebrowColor=n}d={forYou:!0}}else w=!0,c=j(g,Ji(0,r)),l=rf(e,g,{useCase:O6.LockupIconSmall})
const v={featuredContentId:r,id:f(t,"id"),presentationHints:{},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,featuredContentData:t,title:c,subtitle:h,eyebrow:a,titleArtwork:l,shelfHeaderConfiguration:p,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
return{shelfToken:v,metricsOptions:{id:v.id,kind:null,softwareType:u(null==n?void 0:n.isArcadePage)?Pq:null,targetType:yq,title:w?v.eyebrow:v.title,badges:d,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:bV,fcKind:r,recoMetricsData:ts(e,t)}}}function Yi(e){return e&&e.isDeferring&&e.isFirstRender}function Ji(e,t){switch(t){case F0:case D0:case _0:return Wq
default:return AW}}function Ki(e){let t=(new wz).set(Wj,$W).append(SV,VW.grouping).append(SV,VW.shelf).append(SV,encodeURIComponent(JSON.stringify(e))).param(tz.groupingFeaturedContentId,`${e.featuredContentId}`)
return(0,Jv.isSome)(e.nativeGroupingShelfId)&&(t=t.param(tz.nativeGroupingShelfId,`${e.nativeGroupingShelfId}`)),t.build()}function Zi(e,t,n){if(o(n))return null
r(n.shelfStyle)&&(n.shelfStyle=t.contentType)
const i=t.contentType!==LN&&s(t.items)
return n.hasExistingContent=n.hasExistingContent||i&&n.isFirstRender,(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?Ki(n):null}function Qi(e,t){e.remainingItems=e.remainingItems.filter(e=>!t.has(e.id))}function Xi(e,t,n){var r
const o=s(t.remainingItems),i=!o&&(null===(r=t.recommendationsHref)||void 0===r?void 0:r.length)>0
if(o){const n=function(e,t){var n
const r=(null===(n=t.relationshipToFetch)||void 0===n?void 0:n.length)>0
let o=t.remainingItems
return r&&(o=t.remainingItems.map(n=>pe(e,n,t.relationshipToFetch))),o}(e,t),r=new yY(e,n,!0)
return Je(e,r,n),es(e,r),r}if(i){const n=new yY(e,t.recommendationsHref).includingAgeRestrictions()
return es(e,n),ii(e)&&(n.enablingFeature(tq),n.includingMetaKeys(NB,[H$,yM]),n.includingScopedAttributes(hW,nZ),n.includingScopedRelationships(hW,[rW])),si(e)&&(n.enablingFeature(AM),Ai(n)),ai(e)&&(n.enablingFeature(BB),bi(n)),ji(e,tV)&&Ti(n),n}return null}function es(e,t){t.includingAdditionalPlatforms(ee(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
let n=[Hq,$q,LH]
t.includesResourceType(hW)&&ii(e)&&(t.enablingFeature(tq),t.includingMetaKeys(NB,[H$,yM]),t.includingScopedAttributes(hW,nZ),t.includingScopedRelationships(hW,[rW])),t.includesResourceType(OV)&&si(e)&&(t.enablingFeature(AM),Ai(t),n=[]),t.includesResourceType(ZV)&&ai(e)&&(t.enablingFeature(BB),bi(t),n=[]),(t.includesResourceType(yW)||t.includesResourceType(hW))&&(n=n.concat(eV,Lj,LV)),e.bag.enableUpdatedAgeRatings&&n.push(Fq),ji(e,tV)&&Ti(t),t.includingAttributes(n)}function ts(e,t){const n=q(t,Xj)
switch(n){case I0:case g0:case v0:case m0:case x0:case c0:case T0:case b0:case S0:case l0:case B0:case U0:return St(fe(t,fH))
case E0:case u0:{const e=fe(t,fH),n=G(t,NN)
return s(e)?St(e):s(n)?St(t):null}case w0:case P0:case G0:return null
default:if(function(e){return Hi(e)||Vi(e)||Y0.has(e)||e===$0}(n)){let e=fe(t,mW)
if(r(e))return null
const n=e.data
return n&&0!==n.length||(e=fe(t,fH)),St(e)}return e.console.warn("Unknown featured content ID:",n),null}}function ns(e,t,n){const r=Xd(e,t,n)
return r&&(r.crop="sr"),r}function rs(e,t,n,r,o){const i=B(t,fW)
if(i instanceof Array){const t=function(e,t,n,r){const o=n/r
let i=0,s=null
for(const e of t){const t=h(e,mG),r=t/h(e,WG);(r===o||Math.abs(o-r)<=Math.abs(o-i))&&(!s||t<=n&&t>s.width||s.width>n&&t<s.width&&t>s.width)&&(s=e,i=r)}return s?Ot(e,f(s,eW),h(s,mG),h(s,WG),null,null,f(s,gE)):null}(e,i,n,r)
return t.crop="bb",t}return null!=i?ns(e,i,o):null}function os(e,t,n,r,o,i){const s=l(t.meta,rb),a=[]
if((0,Jv.isSome)(s))for(const t of s){const n=Od(e,t,{artworkUseCase:O6.LockupIconSmall,metricsOptions:i,useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:uh}),r=null==n?void 0:n.icon;(0,Jv.isSome)(r)&&a.push(r)}return a}function is(e,t,n,a,c,l,u,d){var h,p,w
const g=(null===(h=f(t,eW))||void 0===h?void 0:h.length)>0,v=(null===(p=j(t,Pb))||void 0===p?void 0:p.length)>0,m=de(t,RH,!1),y=de(t,mW,!1)||m
let A=j(t,HH)===JE
if(v||g)return function(e,t,n,o,s){const a=i(f(t,eW))?t:B(t,jq)
if(r(a)||Yi(n))return c=t,s?s():null==n||n.remainingItems.push(c),null
var c
const l=f(a,S$),u=f(a,eW),d=f(a,nq),h=ds(j(t,oR))||d
let p=null
if(l===NL)p=new JY(u),p.title=h
else{const t=e.required(O3).fetchFlowPage(u),n=new FY(t)
n.pageUrl=u,n.title=h,p=n}return p.presentationStyle=[nO],Xs(e,p,{...o,id:""}),{action:p,caption:null,title:h,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,l,d)
if(y){let h,p,g
if(a&&!m){g=Ts(e,"groupingCommon",we(t,mW),!0,c,!1,1)
const n=g.personalizedData
if(0===n.length)return null
h=n[0]}else h=pe(e,t,m?RH:mW)
if(j(h,HH)===JE&&(p=h,h=pe(e,h,RH),A=!0),r(h))return null
if(r(h.attributes)||Yi(n))return s(n)&&(n.isDeferring=!0),function(e){d?d():null==n||n.remainingItems.push(e)}(h),null
let v=Jf(e,h,$j)||Sd(e,h)
const y=Ks(e,t,l)
y.targetType=l.targetType
let T=Bd(e,h,y,null==n?void 0:n.clientIdentifierOverride)
const b=H(h,wU)
let S,P=null,I=null,C=null
const k=j(h,"itunesNotes.short"),O=(null===(w=h.id)||void 0===w?void 0:w.length)>0,E={...l,id:O?h.id:t.id,idType:O?Dq:OU}
switch(h.type){case UV:P=B(h,fW),A&&(h=null!=p?p:t)
break
case sW:{const t=pe(e,h,$H)
if(s(t)){const r={...E,inAppEventId:t.id},s=pe(e,t,rW)
i(s)&&(r.relatedSubjectIds=[s.id])
const a=gi(e,t,null,!1,!0,Jq,mq,!1,r,!1,!0,null,n.isArcadePage,!1)
if("AppEventCard"===j(h,GN)){if(a instanceof Date)return Ur(a,u.refreshController),null
if((0,Jv.isNothing)(a))return null
S=a,b||(T=S.clickAction),o(v)&&(v=Jf(e,t,cV))}}I=j(h,nq),I&&(I=I.replace(/\n/g," "))
const a=pe(e,h,mW),c=f(h,TV)
o(v)&&(c?v=c:a&&(v=Jf(e,a,cV))),o(v)&&i(S)&&(v=S.subtitle)
let d=j(h,jE);((0,Jv.isNothing)(d)||0===d.length)&&(d=v)
const p={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
if(r(S)&&ra(0,h),p.clientIdentifierOverride=Nr(e,h),i(S))C=S.lockup
else{const t=null,r=null
{Ch(e,E,null==n?void 0:n.title)
const o=Oo(e,we(h,$H),p,l.pageInformation,l.locationTracker,t,r,ra(0,h))
1===o.length&&(C=o[0]),Oh(E.locationTracker)}}}default:{const t=[yW,oH,aW,rq]
if(r(C)&&t.indexOf(h.type)>-1){Ch(e,E,null==n?void 0:n.title)
const t={metricsOptions:{pageInformation:l.pageInformation,locationTracker:l.locationTracker,recoMetricsData:St(h)},clientIdentifierOverride:null==n?void 0:n.clientIdentifierOverride,artworkUseCase:Qd(0,null==n?void 0:n.shelfStyle),canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ)&&n.isArcadePage}
C=Od(e,h,t),Oh(E.locationTracker)}P=Ke(e,h,Hq)||B(h,Hq),o(v)&&i(C)&&(v=C.subtitle)
break}}if(i(T)&&(T.presentationStyle=[nO],!A)){const n=ds(j(t,oR)),r=Jf(e,h,AW)
T.title=n||r||T.title||v||I}return{action:T,caption:I,title:null==T?void 0:T.title,subtitle:v,artwork:P,shortEditorialDescription:k,content:h,lockup:C,appEvent:S,onDevicePersonalizationDataProcessingType:null==g?void 0:g.processingType}}return null}function ss(e,t,n,r){const o=j(t,AW),i=Ni(e,f(t,CG)),s=e.required(O3).fetchFlowPage(i),a=new FY(s)
return a.pageUrl=i,{action:a,caption:jb,title:o,subtitle:jb,artwork:null,shortEditorialDescription:o}}function as(e,t){const n={}
for(const t of e)n[t.id]=t
const r=[mW,tV],o=[]
for(const e of t){let t=!0
for(const o of r){const r=we(e,o)
if(i(r)){const i=[]
for(const e of r){const t=n[e.id]
s(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function cs(e,t,n){t.seeAllAction=null,t.isHorizontal=!1,t.shouldFilterApps&&(t.filteredItemsMinimumCount=0,t.filteringExcludedItems=n.includedAdAdamIds)}function ls(e,t){switch(t){case eq:return xV
case qV:return xN
case _q:return UB
case FV:return iR
default:return null}}function us(e,t){let n=j(t,HV)
return n||(n=j(t,"contentId")),n||(n=j(t,"id")),n}function ds(e){if(r(e))return null
const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"")
return t.match(/^\s*$/)?null:t}function fs(e,t,n){e.featureFlags.isEnabled(OJ)?t.titleAction=n:t.accessoryAction=n}function hs(e,t,n){e.featureFlags.isEnabled(OJ)?(0,Jv.isSome)(t.header)?fs(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}async function ps(e,t,n){const r=n===IW?"OnDeviceRecommendationsShelfController":pP
return await new Promise((n,i)=>{if(o(e.user.dsid)){const e=`${r}: User is currently not signed in.`
return Kv.unexpectedType(BH,e,null),void i(new Error(e))}if(o(t)){const e=`${r}: Missing valid useCase for ODP: ${t}`
return Kv.unexpectedType(BH,e,null),void i(new Error(e))}e.onDeviceRecommendationsManager.performRequest({type:wP,dsId:e.user.dsid,useCase:t}).then(a=>{const c=l(a[gP]),u=y(a[_j])
if(o(c)){const e=`${r}: ODP returned no candidate ids for useCase: ${t}`
return Kv.unexpectedType(BH,e,null),void i(new Z0(e))}if(o(u)){const e=`${r}: ODP returned no metrics for useCase: ${t}`
return Kv.unexpectedType(BH,e,null),void i(new Error(e))}const d=[]
for(const e of c)s(e)&&d.push({id:e,type:yW})
const f=new yY(e,d).withFilter("apps:recommendable",bq).addingQuery(tz.onDevicePersonalizationUseCase,t)
es(e,f),Ln(e,f).then(e=>{n({candidates:c,recoMetrics:u,dataContainer:e})}).catch(e=>{const t=`${r}: Failed to fetch Media API data for candidates: ${c}`
Kv.unexpectedType(BH,t,null),i(new Error(t))})}).catch(e=>{const n=`${r}: Failed to perform ODP for useCase: ${t}, ${e}`
Kv.unexpectedType(BH,n,null),i(new Error(n))})})}function ws(e){const t=new Set,n=[]
return e.forEach((e,r)=>{t.has(e.appId)||(n.push(e.appId),t.add(e.appId))}),n}function gs(e,t){var n
const r=Number(null!==(n=t[dP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.onDeviceScore
t.modifiedScore=r*n+(1-r)*e}return e.sort((e,t)=>t.modifiedScore-e.modifiedScore),e}function vs(e,t){const n=e.filter(e=>i(e.pinnedPosition))
e=e.filter(e=>r(e.pinnedPosition))
const o=new Map
e.reverse(),e.forEach((e,t)=>{e.appId in o?o[e.appId].push(e):o[e.appId]=[e]})
const s=[],a=Math.max(...Object.values(o).map(e=>e.length))
for(let e=0;e<a;e++){const e=[]
t.forEach(t=>{t in o&&o[t].length>0&&(s.push(o[t].pop()),0!==o[t].length&&e.push(t))}),t=e}const c=new Array(n.length+s.length)
n.sort((e,t)=>e.pinnedPosition-t.pinnedPosition)
for(const e of n)e.pinnedPosition<c.length?c[e.pinnedPosition]=e:s.push(e)
s.reverse()
for(const[e,t]of c.entries())r(t)&&s.length&&(c[e]=s.pop())
return c}function ms(e){const t=new Map
return s(e)&&e.split(",").forEach(e=>{const n=e.split("=")
2===n.length&&t.set(n[0],Number(n[1]))}),t}function ys(e,t,n,s,a,c,l,u){var d
let p={sortedDataItems:[],processingType:0}
if(null!==(d=null==n?void 0:n.metricsData[lD])&&void 0!==d&&d){const e=function(e,t,n,r,o){const s=[]
for(const e of t){const t=new X0(e),a=h(e,wx)
let c=f(e,EU)
if(((0,Jv.isNothing)(c)||0===c.length)&&(null==o?void 0:o.length)>0&&(c=o),(0,Jv.isNothing)(c)||0===c.length)r&&(t.isUnpersonalizedMatch=!0,s.push(t))
else{if(i(n)){const e=n[c]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=c,t.score=null!=a?a:0,s.push(t)}}return s}(0,t,null==n?void 0:n.personalizationData,s,l),r=gs(e,null==n?void 0:n.metricsData),o=e.every((e,t)=>e===r[t])
p={sortedDataItems:r,processingType:o?t1.contentsNotChanged:t1.contentsSorted},i(c)&&p.sortedDataItems.length>=c&&(p.sortedDataItems=p.sortedDataItems.slice(0,c))}else{const d=function(e,t,n,r,s){const a=[]
for(const c of t){const t=new X0(c),l=f(c,hP)
let u=f(c,EU),d=f(c,uD)
if(((0,Jv.isNothing)(u)||0===u.length)&&(null==s?void 0:s.length)>0&&(u=s,d=e.random.nextUUID()),o(l)||o(u)||o(d)){r&&(t.isUnpersonalizedMatch=!0,a.push(t))
continue}const h=l.split(",")
if(h.includes(e1)&&(t.isWildcardMatch=!0),i(n)){const e=n[u]
if(i(e))for(const n of h)if(e.userSegments.includes(n)){t.isExactMatch=!0
break}}t.appId=u,t.groupId=d,a.push(t)}return a}(e,t,null==n?void 0:n.personalizationData,s,l),h=ws(d),w=function(e,t){var n
const r=new Set,i=[],s=t.filter(e=>e.isExactMatch).map(e=>e.groupId),a=new Set(s)
t.forEach((e,t)=>{if(o(e.groupId))i.push(e)
else if(!r.has(e.groupId))if(e.isUnpersonalizedMatch)i.push(e)
else{if(e.isExactMatch)return r.add(e.groupId),void i.push(e)
if(!a.has(e.groupId)){if(e.isWildcardMatch)return r.add(e.groupId),void i.push(e)
e.isFallbackMatch=!0,i.push(e)}}})
const c=[],l=i.slice().reverse()
for(const e of l)e.isFallbackMatch&&r.has(e.groupId)||(c.push(e),(null===(n=e.groupId)||void 0===n?void 0:n.length)>0&&r.add(e.groupId))
return c.reverse(),c}(0,d)
p=function(e,t,n,o,i,s){let a
const c=t.filter(e=>e.isExactMatch||e.isWildcardMatch||e.isUnpersonalizedMatch||r(e.groupId))
return r(i)?a=As(c,o,s):c.length>=i||!n?(a=As(c,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)):(a=As(t,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)),a}(0,w,a,h,c,u)}const w=p.sortedDataItems.map(e=>e.rawData)
return{personalizedData:w,processingType:(t.length!==w.length?t1.contentsFiltered:t1.contentsNotChanged)+p.processingType}}function As(e,t,n){const r=e.filter(e=>e.isExactMatch)
let o=e.filter(e=>!e.isExactMatch)
i(n)&&n&&(o=vs(o,t))
const s=r.concat(o),a=e.every((e,t)=>e===s[t])
return{sortedDataItems:s,processingType:a?t1.contentsNotChanged:t1.contentsSorted}}function Ts(e,t,n,r,a,c=!1,l,u,d){return bs(e)?t===Tb?function(e,t,n,r,o){var a,c
let l=t,u=!1
const d=[]
e.featureFlags.isEnabled(UJ)||(l=t.filter((e,t)=>!s(e.type)||e.type===hW||(d.push(t),!1)),u=l.length!==t.length)
const p=null==r?void 0:r.metricsData,w=null!==(a=p.use_segment_scores)&&void 0!==a&&a,g=null!==(c=p[lD])&&void 0!==c&&c
let m
if(m=w||g?function(e,t,n,r){var o
let s=[],a=[]
null!==(o=null==n?void 0:n.metricsData[lD])&&void 0!==o&&o?(s=function(e,t,n){const r=[]
for(const[e,o]of t.entries()){const t=new Q0(o),s=v(o,fP),a=f(o,EU),c=h(o,wx)
if(i(n)){const e=n[a]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=a,t.score=null!=c?c:0,s&&(t.pinnedPosition=e),r.push(t)}return r}(0,t,null==n?void 0:n.personalizationData),a=gs(s,null==n?void 0:n.metricsData)):(s=function(e,t){const n=[]
for(const[e,r]of t.entries()){const t=new Q0(r),o=f(r,EU),i=f(r,uD),s=h(r,wx),a=f(r,"meta.personalizationData.segScores"),c=v(r,fP),l=ms(a)
t.appId=o,t.groupId=i,t.score=null!=s?s:0,t.segScores=l,c&&(t.pinnedPosition=e),n.push(t)}return n}(0,t),a=function(e,t){const n=function(e,t){var n
for(const r of e){const e=r.appId,o=r.segScores,s=r.score
if(i(t)){const a=t[e]
if(i(a)){let e=0,t=0
for(const n of a.userSegments)o.has(n)&&(t+=o.get(n),e+=1)
if(e){const n=t/e
r.modifiedScore=s*n}}else{const e=null!==(n=o.get("0"))&&void 0!==n?n:0
r.modifiedScore=s*e}}else r.modifiedScore=s}return e}(e,null==t?void 0:t.personalizationData),r=function(e,t){var n
const r=Number(null!==(n=t[dP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.modifiedScore
t.modifiedScore=r*n+(1-r)*e}return e}(n,null==t?void 0:t.metricsData)
return r.sort((e,t)=>t.modifiedScore-e.modifiedScore),r}(s,n),i(r)&&r&&(a=vs(a,ws(a))))
const c=a.map(e=>e.rawData),l=a.every((e,t)=>e===s[t])?t1.contentsNotChanged:t1.contentsSorted
return{personalizedData:c,processingType:(t.length!==c.length?t1.contentsFiltered:t1.contentsNotChanged)+l}}(0,l,r,o):ys(e,l,r,n,null,null,null,o),u){const e=m.personalizedData
d.forEach(n=>{const r=t[n]
n<e.length?e.splice(n,0,r):e.push(r)}),m={personalizedData:e,processingType:m.processingType}}return m}(e,n,r,a,d):ys(e,n,a,r,c,l,u,d):function(e,t,n){let r=[]
const s=new Set
for(const e of t){const t=f(e,hP),n=f(e,EU),i=f(e,uD)
o(t)||o(n)||o(i)?r.push(e):s.has(i)||t.split(",").includes(e1)&&(r.push(e),s.add(i))}return i(n)&&r.length>n&&(r=r.slice(0,n)),{personalizedData:r,processingType:null}}(0,n,l)}function bs(e){return e.user.isOnDevicePersonalizationEnabled&&e.bag.enableOnDevicePersonalization}function Ss(e,t){return bs(e)?e.host.platform===gV?e.user.onDevicePersonalizationDataContainerForAppIds(Array.from(t)):{personalizationData:{},metricsData:null}:null}function Ps(e){return bs(e)&&e.host.platform===gV?e.user.onDevicePersonalizationDataContainerForAppIds([]).metricsData:null}function Is(e,t,n,r){return xd(e,t,{offerEnvironment:"ad",offerStyle:Rj,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdvert:!0,adSlotOverride:r.parsedCardCount,disableFastImpressionsForAds:!0},clientIdentifierOverride:n.clientIdentifierOverride,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:O6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton},{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{}},null,!1)}function Cs(e){for(const t of e)switch(t.type){case xm.EditorialItem:case xm.EditorialItemGroup:return W(t.data)}return!1}function ks(e,t){if(!bs(e))return null
const n=new Set
for(const e of t){if(r(e.contents))continue
const t=e=>f(e,EU)
for(const r of e.contents)if(r.type===Nj){const e=l(r.meta,F_)
for(const r of e){const e=t(r)
s(e)&&n.add(e.toString())}}else{const e=t(r)
s(e)&&n.add(e.toString())}}return Ss(e,n)}function Os(e,t,n,r,o,i){var s
const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
return a.useOTDTextStyle=null!==(s=v(t,"meta.personalizationData.isOfTheDay"))&&void 0!==s&&s,a.replaceIfAdPresent=v(t,bC),a.isAdEligible=n,a.currentRowIndex=r,a.metricsDisplayStyle=o,a.isHeroCard=i,a}function Es(e,t){if(e.client.isPhone)return t.currentRowIndex}function Rs(e,t,n){switch(t){case lm.Grid:n%2==1&&e.currentRowIndex++
break
case lm.Hero:0!==n&&(n-1)%2!=1||e.currentRowIndex++
break
case lm.Standard:e.currentRowIndex++}}function Ds(e,t,n,r){if(e.client.isPad)t.currentRowMetricsDisplayStyle=km.MediumCard
else switch(n){case lm.Grid:t.currentRowMetricsDisplayStyle=km.SmallCard
break
case lm.Hero:t.currentRowMetricsDisplayStyle=0===r?km.MediumCard:km.SmallCard
break
case lm.Standard:t.currentRowMetricsDisplayStyle=km.MediumCard}}function _s(e,t){var n
if(t.type===sW)return lm.Standard
let r
const o=N(t)
return W(o)&&(r=j(o,"editorialItemGroupDisplayStyle")),(0,Jv.isNothing)(r)&&(r=null!==(n=j(t,MH))&&void 0!==n?n:lm.Standard),function(e,t){return!(0,Jv.isNothing)(t)&&(t!==lm.Grid||e.client.isPhone)}(e,r)?r:lm.Standard}function Ls(e){return e.adLocation===e.parsedCardCount||!(0,Jv.isNothing)(e.eligibleAdLocations)&&e.eligibleAdLocations.includes(e.parsedCardCount)}function Ms(e,t,n){var r
const o=$s(e,t,n,()=>{var r,o,i
const s=[]
null===(r=n.pageInformation.adPageInfo)||void 0===r||r.updateContainerId(e,null===(o=n.pageInformation.adPageInfo)||void 0===o?void 0:o.containerIdForSlotIndex(null!==(i=n.parsedCardCount)&&void 0!==i?i:0))
const a=_s(e,t.data)
Ds(e,n,a,0)
const c=Os(0,t.data,Ls(n),Es(e,n),n.currentRowMetricsDisplayStyle,!1)
c.baseMetricsOptions={recoMetricsData:zs(t)}
const l=Fs(e,n,c,t.data)
return(0,Jv.isNothing)(l)||(s.push(l),_h(n.locationTracker),n.parsedCardCount++,Rs(n,a,0)),s})
if(o.contentsMetadata={type:N_,debugSectionTypeIndicatorColor:t.type===xm.EditorialItemGroup?Se(LE):Se(LL),groupDisplayStyle:lm.Standard},!t.isFirstItemInModule){const e=Ws(0,t);(0,Jv.isSome)(e)&&(o.background=e.shelfBackground,(0,Jv.isSome)(null===(r=o.header)||void 0===r?void 0:r.configuration)&&(o.header.configuration.eyebrowColor=e.eyebrowColor,o.header.configuration.titleColor=e.titleColor,o.header.configuration.subtitleColor=e.subtitleColor))}return o}function xs(e,t,n){var r
let o=!0
const i=$s(e,t,n,()=>{var r,i,s,a,c,u,d
const f=[],h=vn(e)&&null!==(r=(0,Xv.asNumber)(t.data,"meta.personalizationData.displayEICount"))&&void 0!==r?r:100
let p=l(t.data.meta,F_);(0,Jv.isSome)(n.recoImpressionData)&&(p=wn(p,n.recoImpressionData,null!==(i=n.pageInformation.recoMetricsData)&&void 0!==i?i:{}))
const w=_s(e,t.data)
let g=0
for(const[r,i]of p.entries()){null===(s=n.pageInformation.adPageInfo)||void 0===s||s.updateContainerId(e,null===(a=n.pageInformation.adPageInfo)||void 0===a?void 0:a.containerIdForSlotIndex(null!==(c=n.parsedCardCount)&&void 0!==c?c:0)),Ds(e,n,w,g)
const l=Os(0,i,Ls(n),Es(e,n),n.currentRowMetricsDisplayStyle,w===lm.Hero&&0===r),d=Fs(e,n,l,i)
if((0,Jv.isSome)(d)&&(f.push(d),_h(n.locationTracker),n.parsedCardCount++,Rs(n,w,g),g++),l.isHeroCard&&(0,Jv.isNothing)(d)&&([YG,cG].includes(e.client.buildType)&&Kv.unexpectedType(BH,`Hero story group ${null===(u=t.data)||void 0===u?void 0:u.id} must contain a valid hero card at index ${r}. Unable to parse card ${i.id}.`,null),o=!1),r<p.length-1&&n.adPlacementBehavior===um.insertIntoShelf){const t=Bs(e,n,Os(0,n.adData,Ls(n),Es(e,n),void 0,!1));(0,Jv.isSome)(t)&&(n.parsedCardCount++,Rs(n,lm.Standard,0),_h(n.locationTracker),f.push(t))}if(f.length===h)break}if(o){const n=3
f.length!==n&&([YG,cG].includes(e.client.buildType)&&Kv.unexpectedType(BH,`Hero story group ${null===(d=t.data)||void 0===d?void 0:d.id} must contain exactly ${n} items but only found ${f.length} items.`,null),o=!1)}return f})
let s=_s(e,t.data)
if(s!==lm.Hero||o||(s=lm.Standard),i.contentsMetadata={type:N_,debugSectionTypeIndicatorColor:Se(LE),groupDisplayStyle:s},!t.isFirstItemInModule){const e=Ws(0,t);(0,Jv.isSome)(e)?(i.background=e.shelfBackground,(0,Jv.isSome)(null===(r=i.header)||void 0===r?void 0:r.configuration)&&(i.header.configuration.eyebrowColor=e.eyebrowColor,i.header.configuration.titleColor=e.titleColor,i.header.configuration.subtitleColor=e.subtitleColor)):s===lm.Hero&&Array.isArray(i.items)&&(i.background=function(e){const t=e.map(e=>e.media.bestBackgroundColor()).filter(e=>(0,Jv.isSome)(e))
let n=null
if(t.length>0&&t.length<=4&&t.length===e.length)switch(t.length){case 1:n={type:Ux,colors:{colorCount:"oneColor",color:t[0]}}
break
case 2:n={type:Ux,colors:{colorCount:"twoColor",top:t[0],bottom:t[1]}}
break
case 3:n={type:Ux,colors:{colorCount:"threeColor",top:t[0],bottomLeading:t[1],bottomTrailing:t[2]}}
break
case 4:n={type:Ux,colors:{colorCount:"fourColor",topLeading:t[0],topTrailing:t[1],bottomLeading:t[2],bottomTrailing:t[3]}}}else n={type:DV,color:Se("secondarySystemBackground")}
return n}(i.items))}return i}function $s(e,t,n,r){const i=t.type===xm.EditorialItemGroup,s=new yJ(qj)
if(s.id=t.data.id,s.isHorizontal=!1,s.header=function(e,t,n){var r
if(null!==(r=v(t.data,"meta.personalizationData.suppressHeader"))&&void 0!==r&&r)return null
const o={eyebrow:Us(0,t),eyebrowArtwork:Vs(e,t,Rm.Eyebrow),eyebrowArtworkType:Hs(e,t,Rm.Eyebrow),title:Gs(0,t),titleArtwork:Vs(e,t,Rm.Title),titleArtworkType:Hs(e,t,Rm.Title),subtitle:js(0,t),configuration:{eyebrowImageColor:null,titleImageColor:null,includeSeparator:!1}}
return(0,Jv.isSome)(o.eyebrow)||(0,Jv.isSome)(o.title)||(0,Jv.isSome)(o.subtitle)?o:null}(e,t),i){const r={id:s.id,kind:dD,softwareType:null,targetType:yq,title:Gs(0,t,!0),pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:Dq,recoMetricsData:zs(t)}
t.type===xm.EditorialItemGroup&&(r[jS]=f(t.data,AC),r[GS]=f(t.data,TC)),Nh(e,s,r),Ch(e,r,r.title)}return s.items=r(),s.isHidden=o(s.items),i&&(Oh(n.locationTracker),_h(n.locationTracker)),s}function Fs(e,t,n,r){var o
let a
if(t.adPlacementBehavior===um.replaceOrganic&&i(n.replaceIfAdPresent)&&v(n.replaceIfAdPresent)){const o=Bs(e,t,n)
a=s(o)?o:So(e,r,n,t)}else t.adPlacementBehavior===um.dropAd&&i(n.replaceIfAdPresent)&&!v(n.replaceIfAdPresent)?(a=So(e,r,n,t),s(t.adData)&&(null===(o=t.pageInformation.adPageInfo)||void 0===o||o.setMissedOpportunity(e,wA,"0",t.parsedCardCount))):a=So(e,r,n,t)
return a}function Ns(e,t){let n=null
if(!Kt(e,tW)||(0,Jv.isNothing)(t.adData)||t.adPlacementBehavior!==um.insertIntoShelf)return n
if(t.adLocation!==t.parsedCardCount)return n
n=new yJ(qj),n.id=t.adData.id,n.isHorizontal=!1,n.contentsMetadata={type:N_,debugSectionTypeIndicatorColor:Se(LL),groupDisplayStyle:lm.Standard}
const r=[],o=Bs(e,t,Os(0,t.adData,Ls(t),Es(e,t),void 0,!1))
return(0,Jv.isSome)(o)&&(t.parsedCardCount++,Rs(t,lm.Standard,0),_h(t.locationTracker),r.push(o)),n.items=r,s(n.items)?n:null}function Bs(e,t,n){var o,s,a
if(!Kt(e,tW))return null
if(t.adLocation!==t.parsedCardCount&&t.adPlacementBehavior!==um.replaceOrganic)return null
null===(o=t.pageInformation.adPageInfo)||void 0===o||o.updateContainerId(e,null===(s=t.pageInformation.adPageInfo)||void 0===s?void 0:s.containerIdForSlotIndex(null!==(a=t.parsedCardCount)&&void 0!==a?a:0))
const c=function(e,t,n,o){return Kv.context("createTodayAdCard",()=>{var s,a,c,l,u,d,h
if(r(t))return null
const p=vo(e,t,n,o)
Po(e,t,n,o,f(t.attributes.name))
const w=Vh(e,t,f(t.attributes.name),{targetType:qj,pageInformation:o.pageInformation,locationTracker:o.locationTracker,isAdvert:!0,rowIndex:n.currentRowIndex,displayStyle:n.metricsDisplayStyle}),g=Ge(e,t)
w.productVariantData=g,w.adSlotOverride=o.parsedCardCount,w.kind=v_
const v=w
let m
null===(s=w.pageInformation)||void 0===s||s.adPageInfo.apply(e,t),i(n)&&(m=n.clientIdentifierOverride)
const y=(0,Jv.isSome)(null)
switch(p.style=Jq,Qt(e)){case n$:null===(c=null===(a=w.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c||c.setTemplateType(e,lG)
break
case fq:y&&(null===(u=null===(l=w.pageInformation)||void 0===l?void 0:l.adPageInfo)||void 0===u||u.setTemplateType(e,[zb,"U","I",1,"_2x1"].join("")))}let A=Is(e,t,n,o)
if(r(A))return null===(d=o.pageInformation.adPageInfo)||void 0===d||d.recordLockupFromDataFailed(e,"0",o.parsedCardCount),Co(o),Uh(e,p,w,null,null,!1,!1),null
switch(null===(h=A.searchAdOpportunity)||void 0===h||h.setTemplateType(lG),Qt(e)){case n$:const i=new n1(A,A.icon)
p.media=new r1(i),p.media.impressionMetrics=A.impressionMetrics
break
case fq:p.media=function(e,t,n,o,i,s,a){return e.media=function(e,t,n,r,o){var i,s
const a=t.screenshots[0],c=Ht(a)
null===(i=r.adPageInfo)||void 0===i||i.setTemplateType(e,c),null===(s=t.searchAdOpportunity)||void 0===s||s.setTemplateType(c)
const l=rf(e,o,{useCase:O6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:$$})
let u=l.backgroundColor,d=l.textColor
const f={type:GV,red:1,green:1,blue:1}
Ie(f,u)?(u=d,d=void 0):Ie(f,d)&&(d=void 0)
const h=new o1(t,[a],n,d,u,8)
return new i1(h)}(t,n,t.bag.todayAdMediumLockupScreenshotAnimationEnabled,a.pageInformation,o),r(n=Is(t,o,i,s))?null:(n.searchAdOpportunity=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity,n.searchAd=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAd,e.media.mediumAdLockupWithScreenshotsBackground.lockup=n,e.media.impressionMetrics=n.impressionMetrics,e.media)}(p,e,A,t,n,o,w)
break
default:return null}Co(o)
const T=jt(t)
return p.clickAction=Bd(e,t,v,m,void 0,T),function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=Yf(e,t)?VB:DM,a=Yt(0,o.pageInformation),c=j(t,_M),l=H(t,Sq)?iH:wW,u=new QY(i,t.id,c,s,qb,l,a)
n.clickAction=zt(0,n.clickAction,u)}(e,t,p,w),Uh(e,p,w,null,null,!1,!1),p})}(e,t.adData,n,t)
return(0,Jv.isSome)(c)?c:null}function Us(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderBadge)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,M_)),(0,Jv.isSome)(r))return r
switch(t.data.type){case sW:r=j(t.data,M_)
break
case Nj:r=j(t.data,[mV,uU])}return r}function Gs(e,t,n=!1){const r=On(0,t.data)
if((t.isFirstItemInModule||r.suppressHeaderName)&&!n)return null
let o
const i=N(t.data)
if(W(i)&&(o=j(i,L_)),(0,Jv.isSome)(o))return o
switch(t.data.type){case sW:o=j(t.data,L_)
break
case Nj:o=j(t.data,[mV,AW])}return o}function js(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderTagline)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,x_)),(0,Jv.isSome)(r))return r
switch(t.data.type){case sW:r=j(t.data,x_)
break
case Nj:r=j(t.data,[mV,$j])}return r}function Vs(e,t,n){var r
const o=On(0,t.data),i=pe(e,t.data,Bx),s=null!==(r=o.headerArtworkBehavior)&&void 0!==r?r:Om.NoArtwork
switch(n){case Rm.Eyebrow:return s===Om.CategoryArtworkWithBadge?qs(e,i):null
case Rm.Title:switch(s){case Om.CategoryArtworkWithTitle:return qs(e,i)
case Om.ContentArtworkWithTitle:return rf(e,i,{useCase:O6.LockupIconSmall})
default:return null}default:return null}}function Hs(e,t,n){const r=pe(e,t.data,Bx),o=j(t.data,[pj,"headerArtworkBehavior"])
switch(n){case Rm.Eyebrow:return o===Om.CategoryArtworkWithBadge&&(0,Jv.isSome)(qs(e,r))?dm.Category:null
case Rm.Title:switch(o){case Om.CategoryArtworkWithTitle:return(0,Jv.isSome)(qs(e,r))?dm.Category:null
case Om.ContentArtworkWithTitle:return(0,Jv.isSome)(qs(e,r))?dm.Icon:null
default:return null}default:return null}}function qs(e,t){const n=Sn(e,t,!1,!1,!1)
return(0,Jv.isNothing)(n)?null:Xd(e,n,{useCase:O6.CategoryIcon,allowingTransparency:!0,cropCode:"sr"})}function Ws(e,t){const n=B(t.data,SC,null),r=null==n?void 0:n[jV]
if((0,Jv.isNothing)(r))return null
let o=null
if(r===Dm.LinearGradient){const e=g(n).stops.map(e=>ye(e.color)),t={type:"gradient",colors:e,start:fm.Top,end:fm.Bottom},r=be(e[0]),i={type:GV,red:60/255,green:60/255,blue:67/255,alpha:.6},s={type:GV,red:235/255,green:235/255,blue:245/255,alpha:.6}
o={shelfBackground:t,eyebrowColor:r?s:i,titleColor:Se(r?mq:WO),subtitleColor:r?s:i}}else o=null
return o}function zs(e){var t,n
return(0,Jv.isNothing)(e)?{}:null!==(n=Sh(null!==(t=p(e.moduleMetadata,ZR))&&void 0!==t?t:{},e.moduleMetadata.onDevicePersonalizationProcessingType,null))&&void 0!==n?n:{}}function Ys(e,t){let n
if((0,Jv.isSome)(t))n=t
else{const t=Rh(e),o=(r=e).locationStack.length<2?null:r.locationStack[1].position
n=(0,Jv.isSome)(t)&&(0,Jv.isSome)(o)&&(t.locationType===qj||t.name===aF)?o:Eh(e)}var r
return n}function Js(e,t,n,r=null,o=null){var i
const s=f(n,aK)
if((0,Jv.isNothing)(s))return null
const a=JSON.parse(s),c=s1.placementTypeFromPlacementId(e,f(a,EG)),l=new s1(e,c,s1.createInitialPageSlotInfos(e,c,r,o,void 0),null!==(i=f(a,RG))&&void 0!==i?i:void 0,void 0,void 0,r)
return l.applyClickFieldsFromPageRequest(null!=t?t:void 0,a),l}function Ks(e,t,n,i){return Kv.context("clickOptionsForLockup",()=>{var s,a,c
const l=t.id.slice()
let u=t.id
void 0!==n.anonymizationOptions&&n.anonymizationOptions.anonymizationString.length>0&&(u=n.anonymizationOptions.anonymizationString)
const d={...n,...i,id:u,contextualAdamId:l,softwareType:ph(e,t)}
if(o(d.targetType)&&(d.targetType=cW),r(d.kind)&&(d.kind=wh(e,t)),V(t,Sq)&&(d.offerType=iH),n.isAdvert||n.isAdEligible){const t=null!==(s=d.adsMetricsData)&&void 0!==s?s:{},r=null===(c=null===(a=n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,o=s1.containerIdFromType(e,r)
if(r===vq&&(0,Zv.isSome)(o)){const e=Ys(n.locationTracker,n.adSlotOverride)
t[uF]=`${o}_${e}`}d.adsMetricsData=t}return d})}function Zs(e,t,n,r,o,a,c,l,u,d){var f,h,p,w,g,v,m,y,A,T,b,S
const P={}
if(o){const e=o
c&&(null!==(p=null===(h=null===(f=e.adPageInfo)||void 0===f?void 0:f.adAdamId)||void 0===h?void 0:h.length)&&void 0!==p?p:0)>0&&(0,Zv.isSome)(e.adPageInfo)&&e.adPageInfo.adAdamId===t.adamId&&Object.assign(P,e.adPageInfo.clickFields),s(e.searchTermContext)&&(P[iq]=e.searchTermContext.term)}(0,Zv.isSome)(l)&&Object.assign(P,l),P[XG]={buyParams:t.purchaseConfiguration.buyParams},void 0!==a&&(P[dG]=a),P[sK]=t.adamId,t.actionMetrics.custom[sK]=t.adamId,r&&(P[dF]=iH,i(t.expectedReleaseDate)&&(P[FR]=Ee(t.expectedReleaseDate))),(null===(g=null===(w=null==d?void 0:d.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementType)===vq&&(0,Zv.isSome)(null===(v=null==d?void 0:d.adsMetricsData)||void 0===v?void 0:v.iAdSlotId)&&(P[uF]=null===(m=null==d?void 0:d.adsMetricsData)||void 0===m?void 0:m.iAdSlotId),(0,Zv.isSome)(null===(y=null==d?void 0:d.adsMetricsData)||void 0===y?void 0:y.iAdDuplicateLayoutType)&&(P[sx]=null===(A=null==d?void 0:d.adsMetricsData)||void 0===A?void 0:A.iAdDuplicateLayoutType)
const I=_t(e,n,TW,P,void 0,u)
P[sK]=t.adamId,t.actionMetrics.custom[sK]=t.adamId,I.includingFields.push("appState"),t.purchaseConfiguration.isArcadeApp&&I.includingFields.push(LS)
const C=null!==(S=null===(b=null===(T=null==o?void 0:o.adPageInfo)||void 0===T?void 0:T.shouldIncludeAdRotationFields)||void 0===b?void 0:b.call(T,e))&&void 0!==S&&S
c&&C&&I.includingFields.push(qN),c&&e.client.isPad&&I.includingFields.push(HM),t.actionMetrics.addMetricsData(I)}function Qs(e,t,n){var r
Xs(e,t,{...n,actionType:NR,subscriptionSKU:null!==(r=e.bag.arcadeProductId)&&void 0!==r?r:void 0,actionContext:Pq,targetType:TW})}function Xs(e,t,n,r=!1,o){var s,a,c,l,u,d,f,h,p,w,g,v,m,y,A
let b=n.actionType
b||(b=bW)
const S={actionType:b}
let P
P=T(A=t)&&A[PW]===Ny?t.actions:[t],P.forEach(e=>{if(ht(e)){const t=e
S[jN]=t.pageUrl}else if(wt(e)){const t=e
S[jN]=t.url}}),n.actionDetails&&(S[XG]=n.actionDetails),n.actionContext&&(S[MS]=n.actionContext),i(n.offerType)&&(S[dF]=n.offerType),i(n.offerReleaseDate)&&(S[FR]=Ee(n.offerReleaseDate))
const I=null!==(c=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:null==t?void 0:t.title)&&void 0!==c?c:""
let C
S[dG]=Ph(e,n,I),n.pageInformation&&n.pageInformation.searchTermContext&&(S[iq]=n.pageInformation.searchTermContext.term),i(n.softwareType)&&(S[zN]=n.softwareType),(n.isAdvert||n.isAdEligible)&&r&&(null===(l=n.pageInformation)||void 0===l?void 0:l.adPageInfo)&&(Object.assign(S,n.pageInformation.adPageInfo.clickFields),e.client.isPad&&(C=[HM])),n.mercuryMetricsData&&Object.assign(S,n.mercuryMetricsData),(0,Zv.isSome)(n.subjectIds)&&(S.subjectIds=n.subjectIds),(null===(d=null===(u=null==n?void 0:n.pageInformation)||void 0===u?void 0:u.adPageInfo)||void 0===d?void 0:d.placementType)===vq&&(0,Zv.isSome)(null===(f=n.adsMetricsData)||void 0===f?void 0:f.iAdSlotId)&&(S[uF]=null===(h=n.adsMetricsData)||void 0===h?void 0:h.iAdSlotId),(0,Zv.isSome)(null===(p=n.adsMetricsData)||void 0===p?void 0:p.iAdDuplicateLayoutType)&&(S[sx]=null===(w=n.adsMetricsData)||void 0===w?void 0:w.iAdDuplicateLayoutType)
const k=_t(e,n.id,null!=o?o:fh(0,n),S,C)
n.actionContext===Pq&&(n.actionType===T$||n.actionType===NR)&&(k.includingFields.push(LS),k.fields[sK]=n.contextualAdamId,(0,Zv.isSome)(t.adamId)&&(t.actionMetrics.custom[sK]=t.adamId))
const O=null!==(y=null===(m=null===(v=null===(g=n.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===v?void 0:v.shouldIncludeAdRotationFields)||void 0===m?void 0:m.call(v,e))&&void 0!==y&&y
n.isAdvert&&O&&k.includingFields.push(qN),t.actionMetrics.addMetricsData(k)}function ea(e,t,n,r){const o={}
i(n)&&(o[jN]=n),r.targetType||(r.targetType=TW),o[dG]=Ih(0,r,t.title),o[jG]=bW,o[S$]="button_See All"
const s=_t(e,BR,TW,o)
t.actionMetrics.addMetricsData(s)}function ta(e,t,n){const r={}
r[jG]="filter"
const o=_t(e,`filter_${n}`,TW,r)
o.includingFields.push(xS),t.actionMetrics.addMetricsData(o)}function na(e,t,n,r,o){var i,a,c,l
const u=function(e){switch(e){case JB:return JB
case jB:return jB
case GR:return"recentQuery"
case tF:return oF
case jR:return"searchInsteadFor"
case VR:return FS
case HR:return HR
default:return KM}}(t.origin);(0,Zv.isNothing)(o)&&(o=new uK({page:VV,pageType:VV,pageId:VV,pageDetails:dE}))
const d={pageInformation:o,locationTracker:r,targetType:n},f={...Nt(o),actionType:u,actionUrl:gh(t.url),location:Ih(0,d,t.term),searchTerm:t.term},h={targetId:t.term},p={};(null===(i=t.prefixTerm)||void 0===i?void 0:i.length)&&(p[fF]=t.prefixTerm),(null===(a=t.entity)||void 0===a?void 0:a.length)&&(p[ax]=t.entity),s(p)&&(h[XG]=p),(null===(c=t.originatingTerm)||void 0===c?void 0:c.length)&&(f[UR]=t.originatingTerm,h[UR]=t.originatingTerm)
const w=_t(e,t.term,n,f,[$S])
t.actionMetrics.addMetricsData(w)
const g=Lt(e,t.term,n,u,null!==(l=t.url)&&void 0!==l?l:null,h,[$S])
t.actionMetrics.addMetricsData(g)}function ra(e,t){return i(t)?j(t,"customUrl"):null}function oa(e,t,n,r,o,i,a){if(!s(o)&&e.client.deviceType!==vW)return t
let c
{const e=new rK(n,rW)
c=new oK(r,o,e)}const l=S(a)
if(l.actionType=XV,l.actionDetails={actionUrl:o},Xs(e,c,l,!0,TW),gt(t))return t.openAction=c,t.includeBetaApps=i,t
{const e=new ZY(n,t)
return e.openAction=c,e.includeBetaApps=i,e}}function ia(e,t,n,o,a,c,l,u,d,f){return Kv.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const h=sa(e,t)
if(!s(h))return null
const p=[]
let w=null,g=null
const v=H(h,Sq)
if(n){const t=Yf(e,h),n=md(0,h.type,t),s=function(e,t,n,o,i,s,a){return r(t)||t.type!==yW?null:vr(e,wr(e,t),t,n,!1,Th(e,t,rf(e,t,null,s),s),a,uV)}(e,h,v,0,0,o,l)
g=xr(e,s,n,h,v,0,null,null,null,null,uV)
const a=function(e,t,n,o,i,s,a,c){if(r(n))return null
let l=br(e,n,t,o,s,uV,i)
return(null==c?void 0:c.length)>0&&(l=oa(e,l,n.adamId,null,c,!1,s)),l}(e,h,s,v,o,l,0,u)
i(a)&&i(g)&&(w=p.length,a.artwork=Ot(e,"systemimage://arrow.down.circle"),p.push(a))}const m=function(e,t,n){const r=Ho(e,t,n.pageInformation,n.locationTracker)
return i(r)?(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SHARE"),r.artwork=Ot(e,gO),r):r}(e,h,c)
i(m)&&p.push(m)
const y=ua(e,h)
if(!v&&!y){if(i(a)&&ht(a)&&(vt(a.pageData)||mt(a.pageData))){const t=function(e,t,n){const r=function(e,t,n){return Kv.context("seeRatingsAndReviewsActionFromData",()=>{const t=S(n)
if(vt(n.pageData)||mt(n.pageData)){let r
r=new gJ(FH)
const o=td(e)?r:new vJ(new mJ(IW,qq)),i=S(n.pageData)
i.fullProductFetchedAction=o,t.pageData=i}return t})}(e,t.id,n)
return i(r)&&(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),r.artwork=Ot(e,"systemimage://star"),r.animationBehavior=dH),r}(e,h,a)
i(t)&&p.push(t)}if(!xe(e,t,oj)){const t=function(e,t,n,r){const o=Ca(e,t,n,r)
return i(o)&&(o.title=e.loc.string("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),o.artwork=Ot(e,UT)),o}(e,h,d,f)
i(t)&&p.push(t)}}return new KJ(p,g,w)})}function sa(e,t){return Kv.context(`productDataFromData: ${t.type}`,()=>{switch(t.type){case yW:case aW:return t
case sW:{const n=we(t,$H)
if(s(n)&&1===n.length){const t=n[0]
return sa(e,t)}break}case C$:{const n=we(t,mW)
if(s(n)&&1===n.length){const t=n[0]
return sa(e,t)}break}default:return null}return null})}function aa(e,t,n,r){const o=e.bag.voteUrl,i=f(t,"id",qH),s=new wz(o).param(GT,i),a=new XJ(s.build()),c=new GY(yB)
return r?(a.title=e.loc.string("ACTION_REVIEW_HELPFUL"),c.title=e.loc.string("TOAST_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,jT),c.artwork=Ot(e,jT)):(a.title=e.loc.string("ACTION_REVIEW_NOT_HELPFUL"),c.title=e.loc.string("TOAST_NOT_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_NOT_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,VT),c.artwork=Ot(e,VT)),a.method=yG,a.isStoreRequest=!0,a.disableCache=!0,a.headers={"Content-Type":nK.contentType},a.body=(new nK).param("vote",r?"1":"0").param(HT,n).build(),a.successAction=c,a}function ca(e,t,n){return Kv.context("reportConcernActionFromApiRow",()=>{const r=f(t,"id",qH),i=e.bag.reportConcernUrl,s=new XY(i)
s.method=yG,s.isStoreRequest=!0,s.disableCache=!0,s.needsAuthentication=!0,s.headers={"Content-Type":nK.contentType},s.body=(new nK).param(GT,r).param(HT,n).build()
const a=new tJ("selectedReason",qT,RE),c=new tJ("explanation",qT,sH)
s.parameters=[a,c]
{const t=new GY(yB)
t.title=e.loc.string(NT),t.message=e.loc.string(BT),t.artwork=Ot(e,aM),s.successAction=t}const l=new GY(Gq)
l.title=e.loc.string(kE),l.message=e.loc.string(OE),l.isCancelable=!0,s.failureAction=l
let u=e.bag.reportConcernReasons
o(u)&&(u=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}])
const d=u.map(e=>new ZJ(f(e,"reasonId"),f(e,AW),f(e,"upperCaseName"))),h=new eK(d)
return h.title=e.loc.string(FT),h.explanation=e.bag.reportConcernExplanation,o(h.explanation)&&(h.explanation="Tell us a little more (Optional)"),h.artwork=Ot(e,aM),h.sendAction=s,h})}function la(e,t,n){return`${$W}:/${VW.reviews}/${VW.shelf}/${t}/${n}`}function ua(e,t){return!(!i(t)||da(e,t)||!H(t,sG)&&!H(t,"reviewsRestricted"))}function da(e,t){return!(o(t)||!e.bag.enableSystemAppReviews)&&st(e).isSystemAppFromData(t)}function fa(e){return e.featureFlags.isEnabled(qJ)&&(0,Jv.isSome)(e.bag.saveUserReviewURL)}function ha(e,t){const n=wz.from(e),r=f(n.query,LP)
return t&&(null==r?void 0:r.length)>0&&(n.query[LP]=u1[r]||r),n}function pa(e,t,n,r=!1,o,a,c){return Kv.context("createProductReviewsList",()=>{const l=[]
if(s(a)){if((0,Jv.isSome)(c)){const t={id:`${c.getSequenceId()}`,kind:null,softwareType:null,targetType:oV,title:e.loc.string(TF),pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,idType:Oq}
Ch(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:oV,id:`${c.getSequenceId()}`,idType:Oq},e.loc.string(TF)),Nh(e,a,t),Oh(c.locationTracker),_h(c.locationTracker)}l.push(a)}if(s(o),i(n)&&n.length>0){const o=!1,i=!o,s=o?n.slice(0,1):n,a=!1,u=wa(e,e.client.guid,t,s,r&&i,a&&i,i,c);(0,Jv.isSome)(c)&&Ch(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:yD,id:`${c.getSequenceId()}`,idType:Oq},null),u.forEach((t,n)=>{const r=new nJ
if(r.sourceType=DP,r.review=t,l.push(r),(0,Jv.isSome)(c)){const t={id:r.id,idType:Dq,kind:null,softwareType:null,title:null,pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:"helpfulReview"}
Nh(e,r,t),_h(c.locationTracker)}}),(0,Jv.isSome)(c)&&(Oh(c.locationTracker),_h(c.locationTracker))}return l})}function wa(e,t,n,r,i=!1,s=!1,a=!0,c){return Kv.context("createReviewItems",()=>{const l=function(t,n){return n?1e3*((new Date).getTime()-t.getTime())<3600?e.loc.string("TimeAgo.Edited.JustNow"):e.loc.string("TimeAgo.Edited.Time").replace("{time}",e.loc.timeAgoWithContext(t,"standalone")):e.loc.timeAgoWithContext(t,"standalone")}
return r.map(r=>{var u
const d=new rJ
d.id=f(r,"id",qH),d.title=j(r,Wq)
const h=j(r,cR)
h&&(d.date=new Date(h),d.dateText=l(d.date,H(r,"isEdited"))),d.contents=j(r,"review"),d.rating=q(r,Tj),d.reviewerName=j(r,"userName"),d.dateAuthorText=e.loc.string("ProductPage.Section.Reviews.DateAuthor").replace("{date}",d.dateText).replace("{author}",d.reviewerName)
let p=null
const w=j(r,"developerResponse.id")
if((null==w?void 0:w.length)>0){const e=new oJ
e.id=w,e.contents=j(r,"developerResponse.body")
const t=j(r,"developerResponse.modified")
t&&(e.date=new Date(t),e.dateText=l(e.date,!1)),d.response=e,p=d.response.contents}if(a&&(f(n,HV),d.flowPreviewActionsConfiguration=function(e,t,n,r,i){var s
if(o(t)||e.client.deviceType!==lW&&e.client.deviceType!==oW&&e.client.deviceType!==vW)return null
const a=[aa(e,t,n,!0),aa(e,t,n,!1)]
return(null===(s=e.bag.reportConcernUrl)||void 0===s?void 0:s.length)>0&&a.push(ca(e,t,n)),(null==i?void 0:i.length)>0&&a.push(function(e,t){const n=new tK(t)
return n.title=e.loc.string("ACTION_REVIEW_COPY"),n.artwork=Ot(e,"systemimage://doc.on.doc"),n}(e,i)),new KJ(a)}(e,r,t,0,p)),s){const n=[aa(e,r,t,!0),aa(e,r,t,!1)];(null===(u=e.bag.reportConcernUrl)||void 0===u?void 0:u.length)>0&&n.push(ca(e,r,t)),d.voteActions=n}return i&&(d.moreAction=function(e,t,n,r,o){return r?Kv.context("singleReviewActionFromReviewData",()=>{const t=ka(e,0,n,[r],null,null,null,o),i=new SJ
i.adamId=f(n,HV),i.targetReviewId=f(r,"id",qH),i.shelves=[t]
const s=new FY(qq)
return s.pageData=i,s.title=xa(e),s}):null}(e,0,n,r,c)),d})})}function ga(e,t,n,r){return r?Kv.context("ratingsFromApiResponses",()=>{const t=new iJ
t.productId=f(r,HV,qH),t.ratingAverage=h(r,"ratingAverage"),t.totalNumberOfRatings=h(r,$P),t.totalNumberOfReviews=h(r,"totalNumberOfReviews"),t.context=n
const o=l(r,"ratingCountList").slice().reverse(),i=o.reduce((e,t)=>e+t,0)
if(t.ratingCounts=i>0?o.map(e=>e/i*t.totalNumberOfRatings):o,!(t.ratingAverage>0&&t.ratingCounts)){const n=u(r,AD)
t.status=n?e.loc.string("RATINGS_STATUS_DEVELOPER_RESET"):e.loc.string("RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return t}):null}function va(e,t,n){if(!ma(e))return null
const r=fe(t,cE)
if((0,Jv.isNothing)(r))return null
const i=r.data
if(o(i))return null
const s=i[0],a=f(s,"id",qH),c=ya(e,s,!0),u=ya(e,s,!1),d=e.loc.string("ProductPage.ReviewSummary.Subtitle"),h=e.bag.reviewSummaryReportConcernData
if((0,Jv.isNothing)(u)||(0,Jv.isNothing)(c))return null
const p=j(t,AW),w=Qe(e,s,sH),g=Ot(e,"systemimage://text.line.2.summary"),m=new sJ(c,u,d,g,uW,Tx,function(e,t,n,r,o,i,s){const a=[],c=function(e,t,n,r){return Kv.context("reviewSummaryReportConcernActionFromApiRow",()=>{if(!v(t,xT))return null
const r=function(e,t){const n=new yY(e)
n.includeAppBinaryTraitsAttribute=!1,n.resourceType=$T
const r=ve(e,n),o=new XY(r.toString())
o.method=yG,o.disableCache=!0,o.needsMediaToken=!0,o.headers={"Content-Type":cM},o.bodyDictionary={report:{contentId:t,contentKind:"review-summaries",concerns:null}}
const i=new GY(yB)
i.title=e.loc.string(NT),i.message=e.loc.string(BT),i.artwork=Ot(e,aM),o.successAction=i
const s=new GY(Gq)
return s.title=e.loc.string(kE),s.message=e.loc.string(OE),s.isCancelable=!0,o.failureAction=s,o}(e,n),o=l(t,$T).map(t=>{let n,r
const o=f(t,HH)
switch(o){case"OFFENSIVE":case"OFFENSIVE_OR_HARMFUL":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.UppercaseName")
break
case"MISREPRESENTING_THE_APP":case"MISREPRESENT":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.UppercaseName")
break
case"SOMETHING_ELSE":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.UppercaseName")}return new ZJ(o,n,r)})
if(0===o.length)return null
const i=e.loc.string(FT),s=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Explanation"),a=new QJ(o,i,s,r)
return a.artwork=Ot(e,aM),a})}(e,t,o);(0,Jv.isSome)(c)&&a.push(c)
const u=Ra(e);(0,Jv.isSome)(u)&&a.push(u)
const d=function(e,t,n,r,o){if(![YG,cG].includes(e.client.buildType))return null
const i=new JY(`tap-to-radar://new/problem?componentid=999915&title=Review Summary Feedback: ${n}&description=App ID: ${t}\nApp name: ${n}\nReview summary ID: ${r}\nReview summary: ${o}\n\nFeedback: `,!0)
return i.title=e.loc.string("Action.ProvideFeedback"),i.artwork=Ot(e,"systemimage://ant.circle"),i}(e,n,r,o,i)
return(0,Jv.isSome)(d)&&a.push(d),new KJ(a)}(e,h,t.id,p,a,w,e.client.guid)),y={id:`${n.getSequenceId()}`,kind:null,softwareType:null,targetType:oV,title:e.loc.string(TF),pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,idType:Oq}
return Ch(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:oV,id:`${n.getSequenceId()}`,idType:Oq},m.title),Nh(e,m,y),Oh(n.locationTracker),_h(n.locationTracker),m}function ma(e){return e.bag.enableReviewSummarization}function ya(e,t,n){const r=Qe(e,t,sH)
if((0,Jv.isNothing)(r))return null
const o=`^[${e.loc.string(TF)}](jetFont: 'reviewSummaryTitle')`,i=`^[${r}](jetFont: 'reviewSummaryText')`
return n?e.loc.string("ProductPage.ReviewSummary.Body").replace("{styledTitle}",o).replace("{reviewSummary}",i):i}function Aa(e){if(!e)return null
const t=new aJ
return Sa(e,t),t}function Ta(e){if(!e)return null
const t=new cJ
return Sa(e,t),t}function ba(e){if(!e)return null
const t=new lJ
return Sa(e,t),t}function Sa(e,t){t.ratingAverage=e.ratingAverage,t.ratingCounts=e.ratingCounts,t.totalNumberOfRatings=e.totalNumberOfRatings,t.totalNumberOfReviews=e.totalNumberOfReviews,t.status=e.status,t.reviews=e.reviews,t.actions=e.actions,t.nextPage=e.nextPage}function Pa(e,t,n,r=null,o=null){const i=new uJ
switch(e.client.deviceType){case"tv":i.title=e.loc.string("TV_SELECT_TO_RATE")
break
case vW:i.title=e.loc.string("CLICK_TO_RATE")
break
default:i.title=e.loc.string("TAP_TO_RATE")}return i.rating=o,i.rateAction=function(e,t,n,r=null){const o=new GY(yB)
o.title=e.loc.string("TOAST_TAP_TO_RATE_TITLE"),o.message=e.loc.string("TOAST_TAP_TO_RATE_DESCRIPTION"),o.artwork=Ot(e,"resource://ToastStar.png",95,90)
const i=new eJ(function(e,t,n){return ha(fa(e)?e.bag.saveUserReviewURL:e.bag.userRateURL,n).param("id",t).build()}(e,t,n))
i.useModernRatingsAPI=fa(e),i.adamId=t,i.method=yG,fa(e)&&(i.headers={"Content-Type":cM}),i.isStoreRequest=!0,i.disableCache=!0,i.successAction=o
const s=new tJ(Tj,MP,RE),a=new tJ(fa(e)?EE:"versionToReview",MP,RE)
return i.parameters=[s,a],i}(e,t,n,r),i}function Ia(e,t,n,r,o=!1,i,s){return Kv.context("createWriteReviewAction",()=>{const a=o?e.loc.string("EDIT_REVIEW"):e.loc.string("WRITE_A_REVIEW"),c=function(e,t,n){return ha(e.bag.writeReviewURL,n).param("id",t).build()}(e,t,n)
let l,u
if((0,Jv.isSome)(r)){const t=kt(e,!0,!1,O6.LockupIconSmall),n=r.template.replace("{c}",`${r.crop}-${t.quality}`).replace("{f}",t.format)
l=new bz(n,r.width,r.height,r.variants),l.backgroundColor=r.backgroundColor,l.textColor=r.textColor,l.checksum=r.checksum,l.style=r.style,l.crop=r.crop,l.contentMode=r.contentMode,l.imageScale=r.imageScale}switch(e.client.deviceType){case vW:{const e=new dJ(t,c)
e.title=a,e.appIcon=l,e.itemDescription=i,e.appName=s,u=e
break}default:{const n=new dJ(t,c)
n.title=a,n.appName=s,n.itemDescription=i,n.appIcon=l,n.artwork=Ot(e,UT),u=n
break}}return u})}function Ca(e,t,n,r,o){return Kv.context("writeReviewActionFromData",()=>{const s=t.id
if((null==s?void 0:s.length)>0){const a=t.type===aW,c=q(t,Tj),l=i(c)&&c>0
return Ia(e,s,a,o,l,n,r)}return null})}function ka(e,t,n,r,o=!1,i=!1,s=!0,a){return Kv.context("reviewsShelfForReviewsData",()=>{{const t=new yJ(e$)
return null==a||a.addImpressionsToShelf(e,t,TD),t.items=pa(e,n,r,o,null,null,a),t}})}function Oa(e,t,n,o){return Kv.context("personalizedReviewsContainerShelf",()=>{const s=yt(e,o),a=q(s,Tj)
return function(e,t,n,o,s,a,c,l,d,h,p=!1,w=!0,g=null,v=!1){return Kv.context("reviewsContainerShelfForReviewsData",()=>{const w=function(e,t,n,o,s,a,c,l,d,h=null,p=!1){return Kv.context("reviewsContainerForReviewsData",()=>{const w=new AJ,g=f(n,HV),v=u(n,"isBundle")
w.adamId=g,w.ratings=ga(e,0,_L,n)
{const t=va(e,s,d)
i(t)&&(w.reviewSummary=t)}if(p||(w.tapToRate=Pa(e,g,v,a,h)),i(o)&&o.length>0){const r=!1,i=!r,s=r?o.slice(0,1):o
w.reviews=wa(e,t,n,s,i,!1,i,d)}if(r(w.reviews)||0===w.reviews.length){const t=w.ratings.ratingAverage>0&&w.ratings.ratingCounts,r=u(n,AD)
t||r||(w.ratings.status=e.loc.string(bD))}if(r(l)||(w.editorsChoice=l),!p){const t=i(h)&&h>0
w.writeReviewAction=Ia(e,g,v,c,t,Sd(e,s),a)}const m=f(n,SD)
if(m){const t=new JY(m,!1)
t.title=e.loc.string(FP),w.supportAction=t}let y=!1
for(const t of o)if(da(e,t)){y=!0
break}return w.alwaysAllowReviews=y,w})}(e,t,n,o,a,s,c,l,d,g,v),m=new yJ(_P)
return m.title=xa(e),m.items=[w],null==d||d.addImpressionsToShelf(e,m,TD),p&&i(w.reviews)&&w.reviews.length>0&&(m.seeAllAction=Ma(e,0,n,o,h,s,c,!1,!1)),m})}(e,t,n.ratingsData,n.reviewItems,n.appName,s,n.appIcon,n.editorsChoice,n.shelfMetrics,n.nextPageHref,n.includeSeeAllAction,!1,a)})}function Ea(e,t,n,r,o,i=null){const a=function(e,t,n,r=null){let o=`${$W}:/${VW.reviews}/${t}/${n}`
return s(r)&&(o=`${o}/?${tz.token}=${encodeURIComponent(JSON.stringify(r))}`),o}(0,t,n,i)
return new TJ(n,r,o,a)}function Ra(e){const t=e.bag.reviewSummarizationLearnMoreEditorialItemId
if(o(t))return null
const n=e.loc.string(SN),r=new FY(Eq)
return r.title=n,r.pageUrl=`https://apps.apple.com/story/id${t}`,r.artwork=Ot(e,_O),r}function Da(e,t,n,o,i,s=null,a=null,c,l=null,u,d,h=!1,p=!1,w=d1,g=null){const v=new SJ
return v.shelves=[],Kv.context("reviewsPageForReviewsData",()=>{const t=r(a)?f(n,HV):a
i&&r(n)
const c=_a(e,0,t,n,o,s,h,p,w,g,d)
return c.reviewsShelf.presentationHints={...c.reviewsShelf.presentationHints,isSortable:i&&c.reviewsShelf.presentationHints.isSortable},v.adamId=t,v.shelves.push(c.reviewsShelf),v.nextPage=c.paginationToken,v.initialSortOptionIdentifier=c.initialSortId,v.sortActionSheetTitle=c.sortActionSheetTitle,v.sortOptions=c.sorts,v.alwaysAllowReviews=da(e,u),v})}function _a(e,t,n,r,i,a=null,c=!1,l=!1,u=d1,d=null,f){const h=(null==a?void 0:a.length)>0&&s(i)&&i.length%2>0,p=h?i.slice(0,i.length-1):i,w=h?i.slice(i.length-1):[],g=ka(e,0,r,p,c,l,!0,f)
var v
g.id=o(v=u)?f1:`${f1}.${v}`
const m={reviewsShelf:g}
return g.presentationHints={isSortable:i.length>0||(null==a?void 0:a.length)>0,isSeeAllContext:!0},m.initialSortId=u,m.sortActionSheetTitle=e.loc.string("REVIEWS_SORT_BY"),m.sorts=[Ea(0,n,mD,e.loc.string(NP),e.loc.string(NP),d),Ea(0,n,"favorable",e.loc.string(BP),e.loc.string(BP),d),Ea(0,n,"critical",e.loc.string(UP),e.loc.string(UP),d),Ea(0,n,GP,e.loc.string(jP),e.loc.string(jP),d)],(null==a?void 0:a.length)>0&&(m.paginationToken=function(e,t,n,r,o){return{url:la(0,t,r),remainingContent:o,nextHref:n,profile:cW,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(0,n,a,u,w)),m}function La(e,t,n,r,o,i,a,c,l){return Kv.context("reviewsPageForReviewsMediaContainer",()=>{let t
return t=s(o.data)?r.concat(o.data):r,Da(e,0,null,t,i,o.next,n,0,null,null,l,!1,!1,a,c)})}function Ma(e,t,n,r,o=null,i=null,s=null,a,c,l,u){return n?Kv.context(VP,()=>{const t=Da(e,0,n,r,!0,o,null,0,s,l,u,a,c)
t.title=null
const i=new FY(qq)
return i.pageData=t,i.title=e.loc.string(gH),i}):null}function xa(e){switch(e.client.deviceType){case"tv":return e.loc.string("TV_PRODUCT_SECTION_RATINGS")
case gW:return null
default:return e.loc.string("PRODUCT_SECTION_REVIEWS")}}function $a(e,t){return t.map(t=>t.createProductPageSection(e))}function Fa(e,t,n,r,o,i,s){const a=function(e,t,n){switch(t){case ZG:return n?jv:Gv
case Cx:return qv
case gV:return n?Nv:ly
case KV:return n?Uv:Bv
case kx:return n?Hv:Vv
case BV:return n?zv:Wv
default:return ly}}(0,n,r)
let c=[]
c=t?o&&a.purchasedOrderingCompact?a.purchasedOrderingCompact.slice():a.purchasedOrdering.slice():i&&a.downloadingOrdering?o&&a.downloadingOrderingCompact?a.downloadingOrderingCompact.slice():a.downloadingOrdering.slice():o&&a.notPurchasedOrderingCompact?a.notPurchasedOrderingCompact.slice():a.notPurchasedOrdering.slice()
const l=t?a.purchasedSpotlightIndex:a.notPurchasedSpotlightIndex
if(s&&s.spotlightSection){const e=function(e,t){for(let n=0;n<t.length;n++){const r=t[n]
if(e.sectionType===r.sectionType&&e.shelfId===r.shelfId&&JSON.stringify(e.shelfBasedMappedIds)===JSON.stringify(r.shelfBasedMappedIds))return n}return-1}(s.spotlightSection,c);-1!==e&&(c.splice(e,1),c.splice(l,0,s.spotlightSection))}return c}function Na(e){return new p1(IW,e?Vj:jj)}function Ba(e){var t
return(0,Jv.isSome)(e)&&(null===(t=e.id)||void 0===t?void 0:t.indexOf(S2))>-1}function Ua(e,t,n){if(!e.featureFlags.isEnabled(jJ))return null
const r=new b2(t)
jn(e,r,Gn(e,"ProductMediaGallery",n,""))
const o=new FY("productMediaGallery")
return o.pageData=r,o}function Ga(e,t){var n
return r(t)?1:i(null===(n=t.video)||void 0===n?void 0:n.preview)&&t.video.preview.height>0?t.video.preview.width/t.video.preview.height:i(t.screenshot)&&t.screenshot.height>0?t.screenshot.width/t.screenshot.height:1}function ja(e,t,n,r){return Kv.context("createProductPageFromShelfBasedProductPage",()=>{var o,a,c,l
const u=new fJ
return u.adamId=t.lockup.adamId,u.bundleId=t.lockup.bundleId,u.icon=t.lockup.icon,u.isEditorsChoice=t.lockup.isEditorsChoice,u.ordinal=t.lockup.ordinal,u.title=t.lockup.title,u.subtitle=t.lockup.subtitle,u.developerTagline=t.lockup.developerTagline,u.editorialTagline=t.lockup.editorialTagline,u.editorialDescription=t.lockup.editorialDescription,u.shortEditorialDescription=t.lockup.shortEditorialDescription,u.rating=t.lockup.rating,u.ratingCount=t.lockup.ratingCount,u.ageRating=t.lockup.ageRating,u.buttonAction=t.lockup.buttonAction,u.offerDisplayProperties=t.lockup.offerDisplayProperties,u.titleOfferDisplayProperties=t.titleOfferDisplayProperties,u.clickAction=t.lockup.clickAction,u.children=t.lockup.children,u.contextMenuData=t.lockup.contextMenuData,u.shelfBackground=t.lockup.shelfBackground,u.searchAd=t.lockup.searchAd,u.searchAdOpportunity=t.lockup.searchAdOpportunity,u.crossLinkTitle=t.lockup.crossLinkTitle,u.crossLinkSubtitle=t.lockup.crossLinkSubtitle,u.tertiaryTitle=t.lockup.tertiaryTitle,u.tertiaryTitleAction=t.lockup.tertiaryTitleAction,u.tertiaryTitleArtwork=t.lockup.tertiaryTitleArtwork,u.flowPreviewActionsConfiguration=t.lockup.flowPreviewActionsConfiguration,u.productDescription=t.lockup.productDescription,u.itemBackground=t.lockup.itemBackground,u.developerAction=t.developerAction,u.ageRatingAction=t.ageRatingAction,u.logoArtwork=t.logoArtwork,u.navigationBarIconArtwork=t.navigationBarIconArtwork,u.uberArtwork=null===(o=t.uber)||void 0===o?void 0:o.artwork,u.uberArtworkForCompactDisplay=null===(a=t.uber)||void 0===a?void 0:a.compactArtwork,u.uberVideo=null===(c=t.uber)||void 0===c?void 0:c.video,u.uberStyle=null===(l=t.uber)||void 0===l?void 0:l.style,u.media=function(e){const t=[]
for(const n of Object.values(e.shelfMapping))if(Ba(n)){const e=n.contentsMetadata,r=n.items
t.push(new Oz(r,e.platform,e.allPlatforms,e.platformDescription,e.allPlatformsDescription,e.allPlatformsDescriptionPlacement))}return t}(t),i(t.shelfMapping[lq])&&(u.badges=od(e,t.shelfMapping[lq])),u.shareAction=t.shareAction,u.pageMetrics=t.pageMetrics,u.pageRenderMetrics=t.pageRenderMetrics,u.isComplete=!t.isIncomplete,u.hasDarkUserInterfaceStyle=t.hasDarkUserInterfaceStyle,u.mediaSectionTitle=e.loc.string(RP),u.expandedOfferDetails=t.expandedOfferDetails,u.regularPriceFormatted=t.regularPriceFormatted,u.theme=t.theme,u.externalVersionIdentifier=t.externalVersionIdentifier,u.updateBuyParams=t.updateBuyParams,u.appPlatforms=t.appPlatforms,u.descriptionHeader=t.descriptionHeader,u.description=t.description,u.banner=t.banner,u.secondaryBanner=t.secondaryBanner,u.fullProductFetchedAction=t.fullProductFetchedAction,u.appPromotionDetailPageFlowAction=t.appPromotionDetailPageFlowAction,u.pageRefreshPolicy=t.pageRefreshPolicy,u.purchasedOrdering=$a(e,Fa(0,!0,e.host.platform,n,!1,!1,r)),u.notPurchasedOrdering=$a(e,Fa(0,!1,e.host.platform,n,!1,!1,r)),u.shelfMapping=function(e,t){const n={}
for(const r of P2){let o
o=r===qq?Va(e,t):t.shelfMapping[r],s(o)&&(n[r]=o)}return n}(e,t),u.alwaysAllowReviews=t.alwaysAllowReviews,u})}function Va(e,t){const n=t.shelfMapping[FH],r=t.shelfMapping[HU],i=t.shelfMapping[UH],a=t.shelfMapping[qU],c=t.shelfMapping[WU]
if(o(n)&&o(r)&&o(i)&&o(a)&&o(c))return null
let l=null,u=[],d=null,f=null,h=null,p=null,w=null
if(s(null==r?void 0:r.items))for(const e of r.items){const t=e
switch(t.sourceType){case UH:l=t.review
break
case DP:u.push(t.review)}}else u=null
if(s(null==i?void 0:i.items)&&(l=i.items[0]),s(null==a?void 0:a.items)&&(f=a.items[0].action),s(null==c?void 0:c.items)){const e=c.items[0].action
h=e.writeReviewAction,p=e.supportAction}s(null==n?void 0:n.items)&&(d=n.items[0],w=null==n?void 0:n.seeAllAction)
const g=new AJ
g.adamId=t.lockup.adamId,g.ratings=d,g.tapToRate=f,g.editorsChoice=l,g.reviews=u,g.supportAction=p,g.writeReviewAction=h,g.alwaysAllowReviews=t.alwaysAllowReviews
const v=new yJ(_P)
return v.title=xa(e),v.items=[g],v.seeAllAction=w,v}async function Ha(e,t,n){Kv.beginContext(e)
let r=await M(t())
if(!r.success&&(0,Jv.isSome)(n)&&(r=await M(n(r.error))),Kv.endContext(),r.success)return r.value
throw r.error}function qa(e,t,n,r,i){if(!ii(e))return null
if(o(t))return null
const s={pageInformation:n,locationTracker:r},a=pi(e,t,null,!1,!1,s,!0,!0,!1,i.allowUnpublishedAppEventPreviews);(0,Jv.isSome)(a.nextAppEventPromotionStartDate)&&(0,Jv.isSome)(null==i?void 0:i.refreshController)&&Ur(a.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const c=a.appPromotions
if(0===c.length)return null
const l=Wa(0,c,void 0)
return l.isHorizontal=!1,Nh(e,l,{...s,id:"",kind:null,softwareType:null,targetType:yq,title:""}),l}function Wa(e,t,n){const r=new yJ(OO)
return r.isHorizontal=!0,r.title=n,r.items=t,r}function za(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n){const n=r.replace(/\//g,"\\/")
if(new RegExp(n).test(t)){const n=new FY(nN,t)
return n.pageData=new D2(e.bag.metricsTopic),n}}const r=e.bag.webViewRegexStrings
for(const e of r){const n=e.replace(/\//g,"\\/")
if(new RegExp(n).test(t))return new FY(s$,t)}return new FY(kj,t)}function Ya(e){switch(e){case iB:return iB
case qk:return qk
default:return Xq}}function Ja(e){return`${e.shelfIdentifier}.${e.slot}`}function Ka(e,t){if(r(e))return null
const n=Ja(t),o=e.tasks[n]
return r(o)?null:(delete e.tasks[n],o)}function Za(e,t,n){var r
const o=(null==n?void 0:n.meta)||null,i=null===(r=null==o?void 0:o.adDisplayStyle)||void 0===r?void 0:r.slot
return(0,Jv.isSome)(i)?Qa(e,t,{shelfIdentifier:x2,slot:i}):Qa(e,t,M2)}function Qa(e,t,n){const o=null==t?void 0:t.mediaResponse
if((0,Jv.isNothing)(o)||(0,Jv.isSome)(null==t?void 0:t.failureReason))return null
const i={tasks:{}}
return function(e,t){if(r(e))return
const n=Ja(t.positionInfo)
e.tasks[n]=t}(i,{data:yt(e,o),positionInfo:n}),i}function Xa(e,t,n){e.bag.isOnDemandShelfFetchingEnabled&&(0,Zv.isSome)(t)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=nc(e,t,n.remainingItems.length))}function ec(e,t,n,r,i){(0,Zv.isSome)(t)&&(0,Zv.isSome)(t.url)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=nc(e,t,null!=r?r:n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,i))}function tc(e,t,n,r){n.showingPlaceholders=nc(e,t,n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,r)}function nc(e,t,n,r=!1,i=!1,a=null){if(s(t.items))return!1
if(!function(e,t){switch(t){case Lq:case fq:case CB:case bG:case W$:case Cb:case FB:case lN:case AN:case OO:case oB:case xV:case Hb:case vF:return!0
default:return!1}}(0,t.contentType)||r)return!1
const c=function(e,t,n){return t>0?t:(0,Zv.isSome)(n)&&!Vi(n)?0:e.client.isPad?15:6}(e,n,a),l=new Array(c)
for(let e=0;e<c;e+=1)l[e]=new L2
if(o(l))return!1
const u=function(e,t){if((0,Zv.isSome)(t.rowsPerColumn))return t.rowsPerColumn
switch(t.contentType){case Lq:return 3
case fq:return 2
case CB:return 1
case W$:return null
default:return 1}}(0,t)
return(0,Zv.isSome)(u)&&(t.rowsPerColumn=u),t.placeholderContentType=t.contentType,t.contentType=LN,t.items=l,s(i)&&(t.presentationHints={...t.presentationHints,isAppleArcadeContext:i}),t.isHidden=!1,!0}function rc(e){return e.contentType===LN}function oc(e){const t=[Hq,$q,hH,wH]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}function ic(e){const{platform:t,id:n,...r}=e
return{...r,platform:ut(t),id:dt(n),$kind:F2}}async function sc(e,t,n){var r
const o=Object.keys(n),i=o.map(async e=>await n[e]),s=await async function(e){const t=await Promise.all(e.map(async e=>{try{const t=await e
return function(e){return null!==e&&typeof e===vV&&yz in e}(t)?t:E(t)}catch(e){return R(e instanceof Error?e:new Error(String(e)))}})),n=[]
if(t.forEach(e=>{e.success||n.push(e.error)}),n.length>0)throw 1===n.length?n[0]:new Az(n)
return t}([t,...i]),a=s[0],c=a.value
if(!a.success||(0,Jv.isNothing)(c))throw null!==(r=a.error)&&void 0!==r?r:new Error("Unknown primaryPageData error")
const l={},u=s.slice(1)
for(const[t,n]of u.entries()){const r=o[t]
n.success?l[r]=n.value:(l[r]=null,e.console.log(`Builder - failed to fetch additionalPageRequirement ${r}, reason: ${n.error}`))}return{primaryPageData:c,additionalData:l}}async function ac(e,t,n,o,i){const s=n(e,t,i)
if(!s)return await Promise.resolve({originalData:t})
const a=Array.from(s),c=[]
for(const t of a){const n=o(e,t)
if(r(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}function cc(e,t,n){if(o(t))return
const r=function(e){return f(e,"meta.metrics.clusterId")}(n)
o(r)||function(e,t,n){const r=uc(t)
e.storage.storeString(r,n)}(e,t,r)}function lc(e,t){return o(t)?null:function(e,t){const n=uc(t)
return e.storage.retrieveString(n)}(e,t)}function uc(e){return e+"-cohort-id"}function dc(e,t,n=[],r){const o={exclusions:null==r?void 0:r.exclusions},i=n.slice()
return(null==r?void 0:r.optionalQuery)&&i.push(...r.optionalQuery.map(e=>`${e}?`)),{routes(n){var s,a
return[{rules:[...null!==(s=null==r?void 0:r.prependRules)&&void 0!==s?s:[],{...o,path:t,query:[`${tz.language}?`,...i]},{...o,path:`/{${VW.storeFront}}${t}`,query:[`${tz.language}?`,...i],regex:[/^https?:\/\/[^/]+\/[a-z]{2}(\/.*)?$/i]},...null!==(a=null==r?void 0:r.extraRules)&&void 0!==a?a:[]],handler(t,r){const{[VW.storeFront]:o,[tz.language]:i,...s}=r
return e({...s,...Li(n,{storefront:o,language:i})})}}]},makeCanonicalUrl(e,o){const i=function(e,t,n){const r=new Nm.URL("https://apps.apple.com"),{storefront:o,language:i}=function(e,t){return e.locale.deriveLocaleForUrl(t)}(e,n)
return r.path(o),r.path(t.substr(1)),(0,Jv.isSome)(i)&&r.param("l",i),r}(e,t,o),s=i.pathComponents()
for(const[e,t]of s.entries())if(t.startsWith("{")&&t.endsWith("}")){const n=t.substring(1,t.length-1)
s[e]=o[n]}i.set(SV,"/"+s.join("/"))
const a=n.slice()
a.sort((e,t)=>e.localeCompare(t))
for(const e of a){if(!(e in o))throw new Error(`expected queryParmeters to contain: ${e}`)
const t=o[e]
i.param(e,t)}if(null==r?void 0:r.optionalQuery){const e=r.optionalQuery.slice()
e.sort((e,t)=>e.localeCompare(t)),e.forEach(e=>{const t=o[e]
t&&i.param(e,t)})}return i.toString()}}}function fc(e,t,n=[],r){const{makeCanonicalUrl:o}=dc(e,t,n,r),i=["tv",Uq,Bq,vW,iW,gW].map(o=>dc(t=>e({...t,platform:o}),`/${o}${t.replace(/^\/\{platform\}/,"")}`,n,r).routes)
return{routes:e=>i.map(t=>t(e)).reduce((e,t)=>[...e,...t]),makeCanonicalUrl:o}}function hc(e,t,n){const r=new yJ(n||$2)
r.isHorizontal=!1,r.items=Ub
const o=new bJ([r])
return o.isIncomplete=!0,o.title=t,o}function pc(e,t){if(!(0,Zv.isNothing)(t))switch(t){case Y2:return z2
case z2:return Y2
default:return}}async function wc(e,t,n,r=null){const o=function(e,t,n,r=null,o=e.host.clientIdentifier){const i=[hH,wH,LH]
e.bag.enableUpdatedAgeRatings&&i.push(Fq),e.appleSilicon.isSupportEnabled&&i.push(xH)
const a=new yY(e).forType(dN).addingQuery(_H,t).includingAttributes(i).addingQuery(fN,yW).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
return s(n)&&a.addingQuery(tz.charts,n),o===hY?a.addingContext(gW):o===pY&&a.addingContext(pq),e.appleSilicon.isSupportEnabled&&a.includingAdditionalPlatforms([Uq,Bq]),(0,Zv.isSome)(r)&&a.addingQuery(tz.ages,r),a}(e,t,n,r)
return o.withLimit(200),o.enablingFeature("newChartsElements"),await Ln(e,o)}async function gc(e,t,n){let r
return r=e.host.clientIdentifier===pY||function(e){return s(e)&&(-1!==e.indexOf(J2)||-1!==e.indexOf(K2))}(t)?Promise.resolve({}):Ln(e,An(e,n)).catch(()=>{}),await r}function vc(e){return e===t4}function mc(e,t){var n
let r=e.loc.string(hb)
return(0,Jv.isSome)(t.title)?r=`${t.title}, ${r}`:(0,Jv.isSome)(null===(n=t.header)||void 0===n?void 0:n.title)&&(r=`${t.header.title}, ${r}`),{label:r,roleDescription:e.loc.string(pb)}}function yc(e,t,n){const r=s(n)?[...n]:[]
return r.push(`${tz.groupingFeaturedContentId}=${e}`),s(t)&&r.push(`${tz.nativeGroupingShelfId}=${t}`),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:r}}function Ac(e,t){const n=[]
for(const r of e)n.push(yc(r,null,t))
return n}function Tc(e,t){if([gV,KV,ZG].includes(e.host.platform)&&ht(t)){const e={app:"com.apple.gamecenter.from.browse",kind:{name:MV}}
return t.referrerData=e,new iK([new o4(e),t])}return t}function bc(e,t,n,r){const o={...n,shouldFilter:!H(t,J$),chartUrl:j(t,NG),chartIdentifier:j(t,gq),roomRelationshipData:pe(e,t,"room")}
return Hi(o.featuredContentId)?(o.seeAllUrl=function(e,t,n){const r=j(t,NG),o=new wz(r),i=j(t,gq)
s(i)&&o.param(tz.chart,i)
const a=function(e,t,n){var r
const o=(null!==(r=null==n?void 0:n.editorialCharts.length)&&void 0!==r?r:0)>1,i=null==n?void 0:n.editorialCharts.map(e=>e.type.toString()).join(",")
if((0,Zv.isSome)(i)&&i.includes(t)&&o)return i
const s=pc(0,t)
return void 0===s?t:[t,s].join(",")}(0,i,n)
return s(a)&&o.param(tz.charts,a),o.toString()}(0,t,r.chartSet),o.showOrdinals=!0,o.shouldFilter=!1):s(o.roomRelationshipData)&&(o.seeAllUrl=Ni(e,o.roomRelationshipData.href)),o.shelfStyle=function(e,t,n,r){const o=n.featuredContentId
if(o===N0||o===y0||o===D0||function(e){return W0.has(e)}(o)){let e=j(t,MH)
return e||(e=o===h0||o===p0?_q:o===D0||o===N0?qV:eq),`${e}Lockup`}if(o===O0)return RM
if(o===C0)return AN
if(o===d0||o===f0||o===k0||o===A0)return lN
if(Hi(o))return Lq
if(o===L0)return FB
switch(r.shelves.length%3){case 0:return Lq
case 1:return fq
default:return CB}}(0,t,o,r),o.clientIdentifierOverride=Nr(e,t),o}function Sc(e,t,n,a){const c=(l=t.featuredContentId,V0.has(l)?rm.ChartsMac:rm.All)
var l
let u,d,h=[]
if(s(n.shelfContents)){const o=function(e,t,n,o){var s
const a=Ka(t,n)
if(r(a))return null
const c=a.data,l=Pc(e,c,o)
return i(l)?o.includedAdAdamIds=[c.id]:null===(s=o.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,n.shelfIdentifier,n.slot),l}(e,null==a?void 0:a.adStitcher,M2,t)
o&&ft(o)&&(h.push(o),_h(t.metricsLocationTracker),t.ordinalIndex++,n.shelfContents=n.shelfContents.filter(e=>e.id!==o.adamId))}for(const o of n.shelfContents){if(o.type===hW)return null
if(t.featuredContentId===N0&&o.type===sW){u=o
continue}if(r(o.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}if(at(e,o,c))continue
const n=Pc(e,o,t)
n&&(h.push(n),_h(t.metricsLocationTracker),t.ordinalIndex++)}!Hi(t.featuredContentId)||Wi(t.featuredContentId)||qi(t.featuredContentId)||(h=function(e,t){if(!e)return null
const n=e.length,r=n%3
return n>=3?e.slice(0,n-r):e}(h)),delete t.maxItemCount,d=qi(t.featuredContentId)?io(e,t.title):{eyebrow:t.eyebrow,eyebrowArtwork:t.eyebrowArtwork,title:t.title,titleArtwork:t.titleArtwork,subtitle:t.subtitle,configuration:t.shelfHeaderConfiguration}
const w=new yJ(t.shelfStyle)
let g
if(w.isHorizontal=!0,w.items=h,w.shouldFilterApps=t.shouldFilter,qi(t.featuredContentId)&&(w.footerTitle=e.loc.string(z$),w.footerAction=oo({objectGraph:e,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker}),w.footerStyle={$kind:sq,bundleID:FN,width:16,height:16},w.items.forEach((t,n)=>{(0,Zv.isSome)(t)&&ft(t)&&(t.clickAction=Tc(e,t.clickAction))})),t.featuredContentId===N0?function(e,t,n,r,o,i,a){if((0,Zv.isNothing)(i)&&(i=pe(e,t.featuredContentData,eE)),r.configuration.includeTrailingArtwork=!0,!W(i)){const e=j(t.featuredContentData,AW)
return r.eyebrow=e,r.title="",n.footerTitle="",t.isDeferring=!0,void t.remainingItems.push(i)}const c=j(t.featuredContentData,AW)
r.eyebrow=c
const l=B(i,mV),u=f(l,AW)
r.title=u,Rh(t.metricsLocationTracker).name=u,s(t.originalPlaceholderShelfImpressionMetrics)&&(t.originalPlaceholderShelfImpressionMetrics.fields.name=u)
const d=B(i,Hq)
if((0,Zv.isNothing)(d))return void(n.isHidden=!0)
const h=p(d,"storyBackgroundStatic16x9"),w={useCase:O6.CategoryBreakoutShelf,withJoeColorPlaceholder:!0},g=ns(e,h,w),v=be(g.backgroundColor)?Jq:Tq
n.background={type:fW,artwork:g,style:v},o.forEach((t,n)=>{(0,Zv.isSome)(t)&&ft(t)&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Rj,v),t.subtitleTextFilter=VA,e.clientCapabilities.isNotEnabled(Bb)&&(t.redownloadButtonTint=Se(mq)))})
const m=p(d,lR)
if((0,Zv.isNothing)(m))return void(n.isHidden=!0)
const y={contentMode:tm.scaleAspectFit,useCase:O6.GroupingBrick},A=ns(e,m,y)
r.trailingArtwork=A
const T=f(i.attributes,eW),b=f(i.attributes,b$),S={id:i.id,idType:Dq,targetType:TW,actionType:bW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
if((0,Zv.isSome)(T)){n.footerTitle=b
const t=e.required(O3).fetchFlowPage(T),r=new FY(t)
r.title=b,r.pageUrl=T,Xs(e,r,S),n.footerAction=r}else{const r={targetType:TW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},o=is(e,i,t,!1,null,r,a);(0,Zv.isSome)(o.action)&&(o.action.actionMetrics.clearAll(),o.action.title=null!=b?b:f(l,"callToAction"),Xs(e,o.action,S),n.footerAction=o.action,n.footerTitle=o.action.title)}}(e,t,w,d,h,u,a):e.clientCapabilities.isNotEnabled(Bb)&&w.items.forEach((e,t)=>{(0,Zv.isSome)(e)&&ft(e)&&(e.redownloadButtonTint=Se(LL))}),w&&o(w.items)&&t.isFirstRender&&tc(e,w,t,t.featuredContentId),Hi(t.featuredContentId))g=new FY(vG)
else if(g=new FY(SW),!rc(w)){const e=function(e,t){if(!t)return null
switch(t){case pN:case RM:return t
default:return null}}(0,t.shelfStyle)
g.pageData=hc(0,t.title,e)}g.pageUrl=t.seeAllUrl,g.title=e.loc.string(gH),g.referrerUrl=t.metricsPageInformation.pageUrl,ea(e,g,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})
const v=function(e,t,n){return n.featuredContentId!==N0&&!Wi(n.featuredContentId)&&!qi(n.featuredContentId)&&n.featuredContentId!==L0}(0,w.items,t),m=i(g.pageUrl)||i(g.pageData)
if(v&&m&&fs(e,d,g),t.shelfStyle===AN||t.shelfStyle===lN){const e=j(t.featuredContentData,"suppressTagline")!==bq
r(w.presentationHints)?w.presentationHints={showSupplementaryText:e}:w.presentationHints={...w.presentationHints,showSupplementaryText:e}}return t.shelfStyle,w.header=d,w.url=Zi(0,w,t),w}function Pc(e,t,n){if(o(t))return null
let a
n.showOrdinals&&(a=e.loc.decimal(n.ordinalIndex))
let c,l=null
!i(n.shelfBackground)||n.shelfBackground.type!==DV&&n.shelfBackground.type!==fM||(l=mq),s(n)&&(c=n.clientIdentifierOverride)
const u={ordinal:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},clientIdentifierOverride:c,artworkUseCase:Qd(0,n.shelfStyle),offerStyle:l,canDisplayArcadeOfferButton:rh(0,n.shelfStyle),isContainedInPreorderExclusiveShelf:n.featuredContentId===L0,shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ)&&n.isArcadePage}
let d
switch(n.shelfStyle){case lN:d=function(e,t,n,r){return Kv.context("trailersLockupFromData",()=>{const o=new HY
return function(e,t,n,r,o){t&&Kv.context("copyDataIntoTrailersLockup",()=>{Ad(e,t,n,o),n.trailers=lf(e,t,r,o.metricsOptions,n.adamId)})}(e,t,o,r,n),o})}(e,t,u,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
break
case AN:d=Rd(e,t,u)
break
case FB:d=Dd(e,t,u)
break
case pN:case RM:d=Ed(e,t,u)
break
case"smallImageLockup":case kU:case V$:d=Ld(e,t,u,wm.EditorialLockupLarge)
break
default:d=Od(e,t,u)}return r(d)||!d.isValid()?null:d}function Ic(e,t,n=!1){const r=_c(e,t),o=e.client.isPhone
let i=o?mb:tR
n&&(i="topShelf")
const a=p(r,i)
let c=null,l=null
return s(a)&&(c=Xd(e,a,{withJoeColorPlaceholder:!0,useCase:O6.ArcadeLargeBreakout}),s(c)&&(c.crop=o?"oa":n?"ta":"ob",l=c.backgroundColor)),{artwork:c,artworkData:a,backgroundColor:l}}function Cc(e,t,n=!1,r=!1){const o=function(e,t){switch(t.type){case sW:return B(t,$q)
case RV:return B(t,MO)
default:return se(t,nt(e,t),MO)}}(e,t),i=e.client.isPhone||r,a=i?"breakoutVideo9x16":"breakoutVideo16x9",c=p(o,i?"sizzleVideo9x16":"sizzleVideo16x9")||p(o,a)
let l=null,u=null,d=null
if(s(c)){d=p(c,zG)
const t=Xd(e,d,{withJoeColorPlaceholder:!0,useCase:O6.ArcadeLargeBreakout})
s(t)&&(t.crop="sr",u=t.backgroundColor)
const r=f(c,dq)
s(t)&&(null==r?void 0:r.length)>0&&(l=new Cz(r,t,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:n},autoPlayPlaybackControls:{}}))}return{video:l,artworkData:d,backgroundColor:u}}function kc(e,t,n=!0,r,o){const i=Cc(e,t),s=Ic(e,t),a=i.backgroundColor||s.backgroundColor
return Ec(e,t,0,o),(t.type===RV?u(Dc(0,t),"displayMaterial"):H(t,UA))&&n?GA:Oc(0,a)}function Oc(e,t){return t?be(t,50)?Jq:Tq:Jq}function Ec(e,t,n,r){if(e.client.isPhone||r)return Nq
const o=t.type===RV?f(Dc(0,t),"textPosition"):j(t,VO)
if((0,Jv.isNothing)(o)||0===o.length)return uW
switch(o.toLowerCase()){case HO:return uW
case Nq:return Nq
case qO:return aV
default:return uW}}function Rc(e,t,n,r=!1){switch(t){case uW:case aV:return uW
case Nq:return r||n.type===RV?Nq:function(e,t){var n
switch((null!==(n=j(t,VO))&&void 0!==n?n:"").toLowerCase()){case HO:return uW
case Nq:return Nq
case qO:return aV
default:return uW}}(0,n)
default:return uW}}function Dc(e,t){return t.type!==RV?null:B(t,"display.templateParameters")}function _c(e,t){switch(t.type){case sW:return B(t,Hq)
case RV:return B(t,DA)
default:return se(t,nt(e,t),Hq)}}function Lc(e,t){return t.type===RV?f(gr(0,t),"callToActionLabel"):j(t,b$)}function Mc(e,t){const n=s(B(t,jq)),r=H(t,wU)
return!n&&!r}function xc(e,t){const n=B(t,jq),o=s(n),i=(j(t,HH),H(t,wU)),a=pe(e,t,RH)
if(!o&&!i&&!W(a))return null
let c=null
if(c=o?f(n,eW):j(i?t:a,eW),r(c))return null
let l=null
if(o&&f(n,S$)===NL)l=new JY(c)
else if(e.isAvailable(O3)){const t=e.required(O3).fetchFlowPage(c),n=new FY(t)
n.pageUrl=c,t===kH&&(n.pageData=rd(e,a)),l=n}return l&&(l.title=Lc(0,t)),l}function $c(e,t,n=!1){if(o(t))return null
let r=null
const i=Se(mq),s=Se(WO),a=ye(f(t,uj)),c=l(t,jA).map(e=>ye(e)),u=Oc(0,a)
if(2===c.length){r=new $4("horizontalGradient")
const e=c[0],t=c[1]
r.gradientStartColor=Pe(e,e),r.gradientEndColor=Pe(t,t),r.filter=VA,n||(r.accessoryColor=r.gradientEndColor)}else r=new $4(DV),r.color=u===Jq?i:s,n||(r.accessoryColor=r.color),r.isFallbackStyle=!0
return r}function Fc(e,t,n,r=mq){if(o(t)||o(t.attributes))return null
const s=Cc(e,t,!0),a=Ic(e,t),c=s.backgroundColor||a.backgroundColor,l=Ec(e,t,0,!0),u=kc(e,t,!1,0,!0)!==GA&&!0,d=Uc(e,t,0,!1,u,FL)
let h=null
"tv"!==e.client.deviceType&&(h=d.description,d.description=null)
const p=function(e,t){const n=Dc(0,t),r=f(n,"ctaButtonBackgroundColor"),o=f(n,"ctaButtonTextColor")
return i(r)&&i(o)?{type:GO,fillColor:ye(r),textColor:ye(o)}:{type:cL,fillColor:null,textColor:null}}(0,t),w=new YY(pW,e.bag.arcadeAppAdamId,null,r,null,pW,p,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId),g=new z4(d,w,{backgroundColor:c,wantsMaterialDetailBackground:!1,wantsBlur:u,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:l},null,h,a.artwork,s.video),v=Vh(e,t,g.details.title,{...n,targetType:gG})
return v.displaysArcadeUpsell=!0,Nh(e,g,v),Ch(e,v,g.details.title),g.offerButtonAction=Gc(e,t,pt(iU),n),Oh(n.locationTracker),g}function Nc(e,t){return Lc(0,t)}function Bc(e,t){return j(t,NH)}function Uc(e,t,n,r,o,i){let s=null
switch(i){case FL:s={type:FL}
break
case sH:const e=j(t,uU)
s=(null==e?void 0:e.length)>0?{type:sH,title:e}:{type:Iq}
break
default:s={type:Iq}}let a=kc(e,t,r,0,!0)
const c=Ec(e,t,0,!0)
return o&&(a=Jq),new Y4(function(e,t){return j(t,Wq)}(0,t),Bc(0,t),s,null,a,Rc(0,c,t,!0))}function Gc(e,t,n,r){const o={marketingItemData:t},i=n===pt(iU)&&e.bag.arcadeDownloadPackPostSubscribeTrigger&&ar(e,e.bag.arcadeDownloadPackRolloutRate)
return jc(e,o,Nc(0,t),r,i)}function jc(e,t,n,r,o){const s=t.marketingItemData
if(!i(s))return null
const a=gr(0,s),c=f(a,HH)===jq,u=f(a,eW)
if(c&&u){const t=function(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n)if(new RegExp(r).test(t)){const n=new FY(nN,t)
return n.pageData=new D2(e.bag.metricsTopic),n}const r=e.bag.financeUIRegexStrings
for(const e of r)if(new RegExp(e).test(t))return new FY(kj,t)
const o=e.bag.webViewRegexStrings
for(const e of o)if(new RegExp(e).test(t))return new FY(s$,t)
return new JY(t,!1)}(e,u),o={id:e.bag.arcadeAppAdamId,actionType:T$,actionContext:Pq,contextualAdamId:e.bag.arcadeAppAdamId,offerType:UO,targetType:TW,mercuryMetricsData:bh(0,s),...r}
return t.title=n,Xs(e,t,o),t}{const t=function(e,t,n,r){const o=gr(0,t),s=f(o,lj),a=f(o,Ej)
if(!i(s)||!i(a))return null
const c=l(o,"serviceTypes").length>1&&e.bag.aristotleParentAppAdamId?e.bag.aristotleParentAppAdamId:e.bag.arcadeAppAdamId,u=new J4(s,c,{buyParams:a,productIdentifier:s,pageInformation:r.pageInformation},null,null),d={id:c,actionType:T$,targetType:TW,subscriptionSKU:s,actionContext:Pq,contextualAdamId:c,actionDetails:{buyParams:a},offerType:UO,mercuryMetricsData:bh(0,t),...r}
return u.title=n,Xs(e,u,d),u}(e,s,n,r)
if(o){const e=new FY(bB),r=iB
e.pageData=r,e.presentationContext=Qj
const o=new OZ(void 0,void 0,e,void 0),i=new iK([t,o])
return i.title=n,i}return t}}function Vc(e,t,n){switch(n){case xV:return X4.has(t)
case xN:return Z4.has(t)
case UB:return Q4.has(t)
default:return!1}}function Hc(e,t,n,o,s,a){const c=new zZ(o.metricsPageInformation,o.metricsLocationTracker)
null==a&&((a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}).isHorizontalShelfContext=!0),e.client.deviceType!==gW&&(a.coercedCollectionTodayCardDisplayStyle=Cm.Grid)
const l=ko(t,a.coercedCollectionTodayCardDisplayStyle)
if(a.prevailingCropCodes=function(e,t,n){switch(t){case xV:return null
case xN:return{defaultCrop:"el"}
case UB:return n===Cm.Video?{defaultCrop:"sr"}:{defaultCrop:"ek"}
default:return null}}(0,n,l),a.horizontalCardContentType=n,!i(t.attributes))return s&&s(t),null
const u=So(e,t,a,c,o.augmentingData)
if(r(u))return null
{u.collapsedHeading=$o(0,u),u.inlineDescription=zc(e,u,t),u.inlineDescription===u.collapsedHeading&&(u.inlineDescription=null)
const n=u.media
n&&n.kind===Cj&&(u.title=null)}if(n===UB){const e=u.heroMedia
if(!i(e)||0===e.artworks.length&&0===e.videos.length)return null}return Vc(0,u.media.kind,n)&&i(o.filterOutMediaCardKinds)&&o.filterOutMediaCardKinds.has(u.media.kind)?null:(function(e,t,n){if("tv"!==e.client.deviceType||!H(n,O_))return
const r=new JY("com.apple.Arcade://")
t.clickAction=r}(e,u,t),u)}function qc(e,t,n,r,s,a,c){if(!i(n))return null
const l=new yJ(n)
return r&&(l.title=r),l.subtitle=s,l.isHorizontal=!0,l.items=n===DU?[Yc(e,t,a.metricsPageInformation,a.metricsLocationTracker,()=>!0,c)]:function(e,t,n,r,i,s){const a=[]
for(const s of t){const t=Hc(e,s,n,r,i,void 0)
o(t)||(a.push(t),_h(r.metricsLocationTracker))}return a}(e,t,n,a,c),l}function Wc(e,t,n,r,s,a){const c=new yJ(vF)
n&&(c.title=n),c.subtitle=r,c.isHorizontal=!0
const l=[],u={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
u.metricsDisplayStyle=km.SmallCard,u.alwaysShowBadgeInSmallCards=!0,u.alwaysUseMaterialBlur=!0
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=So(e,n,u,s)
o(t)||(l.push(t),_h(s.locationTracker))}return c.items=l,c}function zc(e,t,n){{let o=Kf(e,n,AW)
return i(o)&&(o=o.replace(/\n/g," ")),t.media.kind===Cj&&Fr(r=t.overlay)&&r[PW]===Oy&&i(t.overlay.lockup)?t.overlay.lockup.title:o}var r}function Yc(e,t,n,o,s,a){return Kv.context("todayCardsFromPlatformData",()=>{if(!t)return null
const c={useOTDTextStyle:!1,enableFullScreenVideo:!1,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
c.coercedCollectionTodayCardDisplayStyle=Cm.Grid,c.prevailingCropCodes={defaultCrop:"fo"},c.isHorizontalShelfContext=!0
const l=new zZ(n,o),u=[]
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=So(e,n,c,l)
if(!r(t)&&s(t)){t.collapsedHeading=$o(0,t),t.inlineDescription=zc(e,t,n),t.inlineDescription===t.collapsedHeading&&(t.inlineDescription=null)
const r=t.media
r&&r.kind===Cj&&(t.title=null),u.push(t)}}return u.length?new K4(u):null})}function Jc(e,t){const n=new Set,r=yt(e,t),o=we(r,EN)
for(const t of o){const o=Zc(e,t,r)
if(s(o))for(const e of o)n.add(e)}return n}function Kc(e,t){let n
return t===P_&&(n=co(e,pt(aL))),t===I_&&(n=ao(e,10)),r(n)?null:Ln(e,n).catch(()=>null)}function Zc(e,t,n){if(j(t,lC)!==C_)return null
const o=j(t,uC),i=r(lo(e,n)),s=[]
return o===dC&&(s.push(I_),i&&s.push(P_)),s}function Qc(e,t,n,a,c){return Kv.catchingContext(`module: ${a.module}`,()=>{var c
const l=[]
switch(a.module){case"Header":a.titleForNextShelf=j(t,IG)
break
case"TextBlock":{const e=function(e,t,n){const r=j(t,IG)
if(!r)return null
const o=new qX(r,EV,Eq)
nl(0,o,n)
const i=new yJ(Hj)
return i.items=[o],i}(0,t,a);(0,Jv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"CollectionLockup":{const n=function(e,t,n){const r=H(t,"showOrdinals"),o="OrdinalDesc"===j(t,"collectionLockupDisplayType")?iS:"ascending",i=j(t,"collectionLockupSize")
let s
if(n.subStyle=i,i)switch(i){case mC:s=CB
break
case vC:s=fq
break
default:s=Lq}const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Qd(0,s),canDisplayArcadeOfferButton:rh(0,s)},c=we(t,mW)
if((0,Jv.isNothing)(c))return null
let l=[]
if(l=Nd(e,c,{includeOrdinals:r,ordinalDirection:o,lockupOptions:a}),!l||0===l.length)return null
const u=new yJ(s)
return u.items=l,u}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case fC:{const n=function(e,t,n){const r=j(t,"inlineImageDisplayType"),o=Xd(e,B(t,fW),{useCase:O6.ArticleImage,allowingTransparency:r===LF&&!0,withJoeColorPlaceholder:!1})
if(!o)return null
const i=new B4(o,!1,EV)
i.caption=j(t,IG),n.subStyle=r,r&&("BoundingBox"===r?(i.isFullWidth=!1,i.hasRoundedCorners=!0):(i.isFullWidth=!0,i.hasRoundedCorners=!1)),nl(0,i,n)
const s=new yJ(k_)
return s.items=[i],s}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case hC:{const n=function(e,t,n){const r=tl(e,t)
if(!r)return null
let o=null
const a=we(t,hW)
if(s(a)&&(o=qa(e,a,n.metricsPageInformation,n.metricsLocationTracker,n),i(o)))return o
const c=j(t,"appLockupSize")
let l
n.subStyle=c
let u=!1
if(c)switch(c){case gC:l=Lq,u=!0
break
case vC:l=fq,u=!0
break
default:l=pE}const d=ra(0,t)
if(u){const t=new yJ(l)
let i
if(i=Od(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:d,artworkUseCase:Qd(0,l)}),(0,Jv.isNothing)(i))return null
t.items=[i],o=t}else o=function(e,t,n){const r=new yJ(pE),o="tv"!==e.client.deviceType,i=tl(e,t),s=ra(0,t),a=Od(e,i,{offerStyle:xj,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:O6.LockupIconSmall}),c=new j4(_q,a)
c.description=Sd(e,i)
let l=null
switch(j(t,"appLockupVideo")){case"AppTrailer":{const t=df(e,i)
t&&t.length>0&&(l=t[0])
break}}return l&&(wo(e,l,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId}),c.video=l),o&&(r.background={type:DV,color:t5}),r.items=[c],r}(e,t,n)
return o}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TipBlock":{const n=function(e,t,n){const r=Xd(e,B(t,fW),{useCase:O6.ArticleImage})
if(!r)return null
const o=j(t,IG),i=j(t,"tipNumber"),s=new B4(r,!1,EV)
s.isFullWidth=!1,s.hasRoundedCorners=!0,s.caption=o,s.ordinal=i,nl(0,s,n)
const a=new yJ(k_)
return a.items=[s],a}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"PullQuote":{const n=function(e,t,n){const r=j(t,wC),o=j(t,"quoteAttribution"),i=Xd(e,B(t,fW),{useCase:O6.ArticleImage}),s=j(t,"pullQuoteDisplayType")===LF,a=new U4(r,o,i,s)
nl(0,a,n)
const c=new yJ(wC)
return c.items=[a],c}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"HorizontalRule":{const e=function(e,t,n){const r=j(t,"lineStyle"),i=j(t,MH)===LF
let s=Se("defaultLine")
const a=B(t,"customColor"),c=ye(f(a,"lightMode")),l=ye(f(a,"darkMode"))
o(c)||o(l)||(s=Pe(c,l))
const u=new G4(r,s,i),d=new yJ("horizontalRule")
return d.items=[u],d}(0,t);(0,Jv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case pC:{const n=function(e,t,n){const r=Xd(e,B(t,"video.previewFrame"),{useCase:O6.ArticleImage})
if(!r)return null
const o=j(t,"video.video")
if(!o)return null
const i=j(t,"inlineVideoDisplayType")===LF,s=new Cz(o,r,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
wo(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const a=new T2(s,i,EV)
a.caption=j(t,IG),nl(0,a,n)
const c=new yJ(Lx)
return c.items=[a],c}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppMedia":{const n=function(e,t,n){const o=tl(e,t)
if(!o)return null
const s=j(t,"appMediaOption"),a=j(t,"appMediaPlatform")
switch(n.subStyle=s,s){case Py:{let t=null
if(t=new yJ(nW),r(a)){const n=ff(e,o,O6.ArticleScreenshots)
n&&n.length>0&&(t.items=[n[0]])}else{const n=function(e,t){switch(t){case Zb:return gW
case gV:return e.client.isPad?oW:lW
case ZG:return"tv"
case Qb:return pq
case"visionOS":return iW
default:return null}}(e,a)
if(n){const r=ff(e,o,O6.ArticleScreenshots,[n])
r&&r.length&&(t.items=[r[0]])}}return i(t)&&0===t.items.length?null:t}case"AppTrailers":const t=new yJ(Lx),s=df(e,o)
if(s&&s.length>0){const r=s[0]
wo(e,r,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const o=new T2(r,!1,JV,null,null,!0)
return t.items=[o],t}return null
default:return null}}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"LinkBlock":{const r=function(e,t,n,r){const o=j(t,eW)
if(!o)return null
const i=new wz(o),s=j(t,"urlTitle")
let a=j(t,IG)
a||(a=i.host)
const c=[yC,ZU,"music.apple.com","books.apple.com","podcasts.apple.com","watch-app.cdn-apple.com","tv.apple.com"]
let l=!1
for(const e of c)i.host.endsWith(e)&&(l=!0)
{const t=e.required(O3).fetchFlowPage(o)
!(0,Jv.isSome)(t)||t!==Eq&&t!==nN||(i.protocol=NW)}e.bag.disabledRichLinkPresentationEditorialItemIds.includes(r.id)&&(l=!1)
const u=new JY(i.build())
Xs(e,u,{targetType:jq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const d=new H4(s,a,u,l)
nl(0,d,n)
const f=new yJ(S_)
return f.items=[d],f}(e,t,a,n);(0,Jv.isSome)(r)&&(l.push(r),a.hasFocusableElements=!0)
break}case"TextList":{const e=function(e,t,n){const r=G(t,IG)
if(!r.length)return null
const o=j(t,"textListDisplayType")
n.subStyle=o
let i,s=!1
s="Bulleted"===o,i=s?"<ul>":"<ol>"
for(const e of r){const t=JSON.stringify(e)
i=`${i}<li>${JSON.parse(t)}</li>`}i=s?`${i}</ul>`:`${i}</ol>`
const a=new qX(i,EV,Eq)
nl(0,a,n)
const c=new yJ(Hj)
return c.items=[a],c}(0,t,a);(0,Jv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"IAPLockup":{const n=function(e,t,n){const r=tl(e,t)
if(!r)return null
const o=Ed(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:O6.LockupIconSmall})
if(!o)return null
const i=new V4(o),s=new yJ("inAppPurchaseShowcase")
return s.background={type:DV,color:e5},s.items=[i],s}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case C_:{const o=function(e,t,n,o){const a=j(t,uC)
o.subStyle=a
let c=null
switch(a){case"OSUpgrade":c=function(e,t,n){const r=e.client.deviceType
if(r!==vW)return null
const o=fr(r)
if(null===o)return null
const i=new JY(o)
Xs(e,i,{targetType:jq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const s=e.loc.string("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),a=new q4(s,i)
nl(0,a,n)
const c=new yJ("clientControlButton")
return c.items=[a],c}(e,0,o)
break
case dC:c=function(e,t,n,o){let a=lo(e,n)
if(!a&&o.additionalData&&(a=uo(0,o.additionalData.get(P_))),!i(a))return null
const c={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},l=ro(0,o.metricsPageInformation,o.metricsLocationTracker,!1)
let u
l.title=e.loc.string(HB,qB)
const d=Lc(0,a.marketingItemData)
s(d)?(u=Gc(e,a.marketingItemData,pt(aL),c),i(u)&&(u.title=d)):(u=ro(0,o.metricsPageInformation,o.metricsLocationTracker,!1),u.title=e.loc.string(HB,qB))
const f=new W4(u,l),h=Bc(0,a.marketingItemData)
f.unsubscribedDescription=h
const p=new YY(pW,e.bag.arcadeAppAdamId,null,xj,null,Jq,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
p.titles[LU]=e.loc.string(HB,qB),f.offerDisplayProperties=p,Nh(e,f,{...c,targetType:iM,title:d,id:t.id,kind:iM,softwareType:null,displaysArcadeUpsell:!0})
{if(r(o.additionalData))return null
const t=o.additionalData.get(I_)
if(s(t)){const n={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},r=bt(t)
f.iconArtworks=tf(e,r,n,{useCase:O6.LockupIconMedium})}}const w=new yJ(iM)
return w.items=[f],w.background={type:DV,color:n5},w}(e,t,n,o)}return c}(e,t,n,a);(0,Jv.isSome)(o)&&(l.push(o),a.hasFocusableElements=!0)
break}case"StoryList":{const n=function(e,t,n,r){const o=we(t,mW)
if(!o)return null
const i=j(t,AW),s=j(t,$j)
let a=null
if(e.featureFlags.isEnabled(BJ))a=Wc(e,o,i,s,new zZ(n.metricsPageInformation,n.metricsLocationTracker))
else{const t=!0,r=t?xV:DU
a=qc(e,o,r,i,s,n,null),t&&Array.isArray(a.items)&&(a.items=a.items.filter(e=>!Bt(e)||Vc(0,e.media.kind,r)))}return a}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppEventLockup":{const n=function(e,t,n){const r=tl(e,t)
return r?qa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n):null}(e,t,a);(0,Jv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"OfferItemLockup":{const n=function(e,t,n){const r=pe(e,t,mW)
if(o(r))return null
const i=j(t,IG),s=new qX(i,EV,Eq),a=new yJ(Hj)
return a.items=[s],[a,qa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n)]}(e,t,a);(0,Jv.isSome)(n)&&(l.push(...n),a.hasFocusableElements=!0)
break}default:e.console.log(`Unknown module: ${a.module}`)}for(const e of l){const t=null!==(c=e.presentationHints)&&void 0!==c?c:{}
e.presentationHints={...t,isArticleContext:!0}}return l})}function Xc(e,t){const n=we(t,$H)
if(1!==n.length)return null
const r=n[0]
if(!r)return null
switch(r.type){case yW:case aW:return r
default:return null}}function el(e){return e.client.deviceType===vW?mq:WH}function tl(e,t,n){return pe(e,t,mW)||null}function nl(e,t,n,o){if(!t)return
let i=n.module
n.subStyle&&(i=i+"_"+n.subStyle),r(o)&&(o={id:`${n.index}`,impressionIndex:n.index,idType:Oq,impressionType:i,kind:"iosModule"}),t.impressionMetrics=new KY(mh(o))}function rl(e,t,n){const r=new i5
r.overlayType=ol(e,t),r.displayOptions={horizontalPlacement:cl(e,t),textAlignment:ll(e,t),isOverDarkContent:al(e,t)}
const a=sh(e,t),c=j(t,nq)
if(et(e,t,SG)?r.badgeText=e.loc.uppercased(ih(e,a,c)):r.badgeText=c,r.titleText=Kf(e,t,AW)||Qe(e,a,AW),r.overlayType===bM||r.overlayType===XE?r.descriptionText=Kf(e,t,$j):r.descriptionText=Kf(e,t,cV)||Qe(e,a,$j),r.callToActionText=j(t,b$),r.buttonTitle=sl(e,t),r.overlayType!==cW&&r.overlayType!==bM||(r.lockup=function(e,t,n){let r=pe(e,t,RH)
const i=we(t,$H)
if(o(r)&&s(i)&&(r=i[0]),o(r))return null
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},artworkUseCase:n.lockupArtworkUseCase,offerStyle:Rj,offerEnvironment:Jq,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ),isContainedInPreorderExclusiveShelf:n.isContainedInPreorderExclusiveShelf},c=Od(e,r,a),l=sh(e,t),u=Kf(e,t,cV)||Qe(e,l,$j)
return(null==u?void 0:u.length)>0&&(c.subtitle=u),c}(e,t,n)),(null==c?void 0:c.length)>0&&i(r.lockup)&&(r.lockup.heading=c),r.collectionIcons=function(e,t){const n=we(t,$H)
if(o(n))return null
const r=[]
for(const t of n){const n=rf(e,t,{useCase:O6.LockupIconSmall,withJoeColorPlaceholder:!0})
s(n)&&r.push(n)}return s(r)?r:null}(e,t),s(r.lockup))r.clickAction=r.lockup.clickAction,r.impressionMetrics=r.lockup.impressionMetrics
else{const o={targetType:cW,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i=il(e,t),s=xc(e,t)
s.title=i,Xs(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:cW,id:t.id}),r.clickAction=s,Nh(e,r,Vh(e,t,i,o))}return r}function ol(e,t){const n=H(t,UA),r=j(t,HH),a=we(t,$H),c=Kf(e,t,$j),l=function(e){return ar(e,e.bag.hero3RolloutRate)}(e)&&(null==c?void 0:c.length)>0
let u=pe(e,t,RH)
return o(u)&&s(a)&&(u=a[0]),i(u)&&"App"===r?l?bM:cW:s(a)&&"Collection"===r?l?XE:eR:n?SM:sH}function il(e,t){const n=ol(e,t),r=pe(e,t,RH)
switch(n){case cW:case bM:return j(r,AW)
case SM:case sH:case eR:case XE:return Kf(e,t,AW)||Qe(e,r,AW)
default:return null}}function sl(e,t){if("tv"!==e.client.deviceType)return null
switch(ol(e,t)){case cW:return e.loc.string(vb)
case SM:case sH:let t=e.loc.string(VE)
return t===VE&&(t=e.loc.string(vb)),t
case eR:return e.loc.string("HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_COLLECTION")
default:return null}}function al(e,t){const n=Cc(e,t),r=Ic(e,t),o=n.backgroundColor||r.backgroundColor
return!o||be(o,50)}function cl(e,t){if(e.client.isPhone)return Nq
const n=j(t,VO)
if(!s(n))return uW
switch(n.toLowerCase()){case HO:return uW
case Nq:return Nq
case qO:return aV
default:return uW}}function ll(e,t){return cl(e,t),uW}function ul(e,t,n){Kv.catchingContext("parseGrouping",()=>{for(const r of t.data){const o=q(r,Xj)
if(Hi(o)){const e=f(r,"id")
n.chartSet=dl(e,t.editorialChartSets)}else n.chartSet=null
const s=zi(e,r,n),a=s.shelfToken,c=s.metricsOptions
let l
for(const t of I5)if(t.supports(e,r,o)){l=Kv.catchingContext("parseGroupingShelf",()=>t.createShelf(e,r,n,a,c))
break}i(l)&&(n.shelves.push(l),un(e,n.shelves,kV,c.id,n.metricsPageInformation))}})}function dl(e,t){for(const n of t){if(n.id===e)return n
for(const t of n.editorialCharts)if(t.id===e)return n}return null}function fl(e,t){const n=[],r=[]
return function t(o){const s=q(o,Xj)
Kv.catchingContext(`flattenGroupingTree.addMediaApiDataToGroupingData: ${s}`,()=>{const a=pe(e,o,ij)
if(i(a))t(a)
else if(function(e){return J0.has(e)}(s)){const e=we(o,fH)
for(const n of e)t(n)}else if(s===P0){const e=q(c=o,Xj)!==P0?null:{id:f(c,"id"),name:j(c,AW),editorialCharts:we(c,fH).map(e=>function(e){return Hi(q(e,Xj))?{id:f(e,"id"),href:j(e,NG),name:j(e,AW),type:j(e,gq)}:null}(e)).filter(e=>(0,Jv.isSome)(e))};(0,Jv.isSome)(e)&&r.push(e)
const n=we(o,fH)
for(const e of n)t(e)}else n.push(o)
var c})}(t),{data:n,editorialChartSets:r,originalGroupingData:t}}function hl(e,t,n){var r,o,i,s,a,c
if(e.user&&e.user.isManagedAppleID)return null
{const t=[],n=e.loc.string("FOOTER_REDEEM",bO),l=za(e,e.bag.redeemUrl),u=new b5(n,l)
if(u.id=ZF,t.push(u),e.bag.isMonetaryGiftingEnabled){const n=e.loc.string("FOOTER_SEND_GIFT",fA),r=za(e,QF),o=new b5(n,r)
o.id=QF,t.push(o)}const d=e.bag.accountTopUpURL
if((0,Jv.isSome)(d)){const n=null!==(r=e.bag.accountTopUpTitle)&&void 0!==r?r:e.loc.string("FOOTER_ADD_MONEY"),o=za(e,d),i=new b5(n,o)
i.id="topUp",t.push(i)}let f
{f=new yJ("titledButtonStack")
const n=new S5(t)
n.compactLineBreaks=n.buttons.map((e,t)=>t),f.items=[n]
const r=e.loc.string(hb),l=e.loc.string(pb)
f.accessibilityMetadata={label:null!==(s=null!==(o=f.title)&&void 0!==o?o:null===(i=f.header)||void 0===i?void 0:i.title)&&void 0!==s?s:r,roleDescription:l.replace("%d",`${null!==(c=null===(a=n.buttons)||void 0===a?void 0:a.length)&&void 0!==c?c:0}`)}}return f}}function pl(e,t,n=!0){const r=new JY(t),o=e.loc.string(zE),i=new u4(o)
i.clickAction=r,i.presentationStyle=[pM,wM],n&&i.presentationStyle.push(gM)
const s=new yJ("footnote")
if(s.items=[i],e.bag.emailSupportLinkURL){const t=new JY(e.bag.emailSupportLinkURL),r=new u4("Email Support")
r.clickAction=t,r.presentationStyle=[pM,wM],n&&r.presentationStyle.push(gM),s.items.push(r)}return s}function wl(e,t,n,r){const o=new yJ("unifiedMessage")
return o.id=t,o.items=[new P5(t,n,r)],o.isHidden=!0,o}function gl(e,t,n,r,o,a,c){var u
const d=l(t,uq),f=[]
for(const t of d){const l=y(t)
if(s(l)){const t=vl(e,l,n,r,o,a,c)
i(t)&&f.push(t)}}if(0===f.length){const t=function(e,t,n,r,o){const i=fD,s=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),a=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),c=Ot(e,mx),l=ml(e,t,i,n,r,o)
return new C5(i,s,a,c,n,[],[],l)}(e,n,r,a,c)
f.push(t)}for(const t of f)Nh(e,t,{id:null,kind:null,softwareType:null,title:null!==(u=t.title)&&void 0!==u?u:"",pageInformation:a,locationTracker:c,targetType:gD}),_h(c)
return f}function vl(e,t,n,r,a,c,u){const d=f(t,AF),h=f(t,vx),p=f(t,Mq)
if((0,Zv.isNothing)(d)||o(d)||(0,Zv.isNothing)(h)||o(h)||(0,Zv.isNothing)(p)||o(p))return null
const w=bl(e,t,function(e,t){switch(t){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash"
case"DATA_USED_TO_TRACK_YOU":return"systemimage://person.fill.viewfinder"
case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle"
case"DATA_LINKED_TO_YOU":return PP
default:return null}}(0,d)),g=a?yl(e,t,r):[],v=function(e,t,n){const r=l(t,"purposes"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Tl(e,r,n)
i(t)&&o.push(t)}}return o}(e,t,r),m=ml(e,n,d,r,c,u)
return new C5(d,h,p,w,r,v,g,m)}function ml(e,t,n,r,o,i){let s=null
return r!==cH&&r!==mF||(s=Ol(e,t,Sl(e)&&r===cH?mF:Aj,o,i,n)),s}function yl(e,t,n){const r=l(t,"dataCategories"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Al(e,r,n===cH?cH:Aj)
i(t)&&o.push(t)}}return o}function Al(e,t,n){const i=f(t,AF),s=f(t,"dataCategory")
if((0,Zv.isNothing)(i)||o(i)||(0,Zv.isNothing)(s)||o(s))return null
const a=bl(e,t,function(e,t){switch(t){case"FINANCIAL_INFO":return"systemimage://creditcard.fill"
case"CONTACT_INFO":return"systemimage://info.circle.fill"
case"OTHER":return"systemimage://ellipsis.circle.fill"
case"SENSITIVE_INFO":return"systemimage://eye.fill"
case SP:return"systemimage://chart.bar.fill"
case"CONTACTS":return PP
case"PURCHASES":return"systemimage://bag.fill"
case"LOCATION":return"systemimage://location.fill"
case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill"
case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill"
case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill"
case"BROWSING_HISTORY":return"systemimage://clock.fill"
case"DIAGNOSTICS":return"systemimage://gearshape.fill"
case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill"
case"BODY":return"systemimage://figure"
case"SURROUNDING":return"systemimage://arkit"
default:return null}}(0,i))
if(r(a))return null
let c=[]
n===Aj&&(c=l(t,"dataTypes"))
const u=new k5(i,s,a,n,c)
return i===SP&&(u.prefersSmallArtwork=!0),u}function Tl(e,t,n){const r=f(t,AF),i=f(t,"purpose"),s=yl(e,t,n)
return(0,Zv.isNothing)(r)||o(r)||(0,Zv.isNothing)(i)||o(i)||0===s.length?null:new O5(r,i,s)}function bl(e,t,n){let o=null
if((0,Zv.isSome)(n)&&(null==n?void 0:n.length)>0&&(o=Ot(e,n)),r(o)){const n=p(t,fW)
i(n)&&(o=Xd(e,n,{useCase:O6.Default,allowingTransparency:!0}))}return o}function Sl(e){return e.client.deviceType===gW}function Pl(e,t,n,a,c,l){return Kv.context("createPrivacyHeaderFromData",()=>{const u=function(e,t,n,r,a,c){let l,u=EV
const d=pe(e,t,VH),h=s(d)&&KK.indexOf(d.id)>-1
l=n&&!h?e.loc.string("PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_HEADER_TEMPLATE")
const p=kl(e,t,r,Aj,a,c),w=1===p.length&&p[0].identifier===fD||0===p.length
w&&(l=e.loc.string("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"))
const g=j(t,pH)
i(g)?l=l.replace(yF,g$+g+v$):(l=w?e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE"):n?e.loc.string("PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),u=JV)
const v=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK")
l=l.replace("{privacyPolicyLink}",v)
const m=function(e,t,n,r){let i
{const n=Qe(e,t,uN)
if((0,Zv.isNothing)(n)||o(n))return null
i=new JY(n,!1)}return i.title=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),Xs(e,i,{targetType:jq,id:yP,pageInformation:n,locationTracker:r}),i}(e,t,a,c),y={}
if(i(m)&&(y[v]=m),n){const n=function(e,t,n,r){const i=f(B(t,_$),"managePrivacyChoicesUrl")
if((0,Zv.isNothing)(i)||o(i))return null
const s=new JY(i,!1)
return Xs(e,s,{targetType:jq,id:"managePrivacyChoices",pageInformation:n,locationTracker:r}),s}(e,t,a,c)
if(i(n)){const t=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK")
l+=mP,l+=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",t),n.title=t,y[t]=n}}const A=new D5(l,u)
return new _5(A,y)}(e,t,n,a,c,l),d=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(AP),a=e.loc.string("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",s),c=Cl(e,o,i)
if(r(c))return null
c.title=s
const l={}
l[s]=c
const u=new D5(a,JV)
return new _5(u,l)}(e,0,n,c,l)
let h,p
n&&(h=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(hD),a=Il(e,o,i)
let c
const l={}
r(a)?c=e.loc.string(pD):(c=e.loc.string(vP).replace(Mj,s),a.title=s,l[s]=a)
const u=new D5(c,JV)
return new _5(u,l)}(e,0,n,c,l),s(h)&&(p=Il(e,c,l)))
const w=[]
if(i(d)){const e=new E5(d,void 0)
w.push(e)}if(i(h)){const e=new E5(h,p)
w.push(e)}return new R5(u,n,[],[],w,void 0)})}function Il(e,t,n){const r=e.bag.appPrivacyLearnMoreEditorialItemId
if((0,Zv.isNothing)(r)||0===r.length)return null
const o=new FY(Eq)
return o.title=e.loc.string(hD),o.pageUrl=`https://apps.apple.com/story/id${r}`,Xs(e,o,{targetType:TW,id:"privacyLearnMore",pageInformation:t,locationTracker:n}),o}function Cl(e,t,n){const r=e.bag.appPrivacyDefinitionsEditorialItemId
if((0,Zv.isNothing)(r)||0===r.length)return null
const o=new FY(Eq)
return o.title=e.loc.string(AP),o.pageUrl=`https://apps.apple.com/story/id${r}`,Xs(e,o,{targetType:TW,id:TP,pageInformation:t,locationTracker:n}),o}function kl(e,t,n,r,o,i){var a
let c=[]
const l=B(t,n?_$:E$)
return s(l)&&(c=null!==(a=gl(e,l,t,r,e.client.deviceType!==gW||r===mF,o,i))&&void 0!==a?a:[],1===c.length&&0===c[0].categories.length&&(c[0].style=cH)),c}function Ol(e,t,n,o,a,c){if(r(t.id))return null
const l=new FY(wD)
l.title=e.loc.string(bP),l.pageData=function(e,t,n,r,o){const i=[]
if(e.client.deviceType!==gW||n!==Aj){const n=new yJ(wq),s=Pl(e,t,!0,!1,r,o)
n.items=[s],n.presentationHints={isFirstShelf:!0},i.push(n)}const s=new bJ(i)
return e.client.deviceType===gW&&n!==Aj||(s.isIncomplete=!0),s.title=e.loc.string(gx),s}(e,t,n,o,a)
const u=t.type===aW?VW.productBundle:VW.product
let d
s(c)&&(d={privacyTypeId:c})
const f=wz.fromComponents($W,null,`/${VW.privacyDetail}/${u}/${t.id}`,d)
l.pageUrl=f.build()
const h={targetType:TW,id:"seeDetails",pageInformation:o,locationTracker:a}
return i(c)&&(h.targetType=gD,h.id=c),Xs(e,l,h),l}function El(e,t,n){if(!s(t))return null
let r=null
r=(0,Zv.isNothing)(n)?"sr":n
const i=Xd(e,t,{cropCode:r,useCase:O6.ProductPageBadge,allowingTransparency:!0})
return o(i)?null:i}function Rl(e,t,n,r){let o=0
for(const i of t){const t=n[i.key]
if(t){let n
if(td(e))n=new gJ(t.shelfId,null,null,void 0,t.index,!0)
else if((0,Zv.isSome)(t.section)){const e=new vJ(t.section,!0)
e.index=t.index,n=e}i.clickAction=n}let s
switch(i.key){case $U:case UH:case Tj:case bF:case JN:case SF:case Zj:case PD:s=PF
break
default:s=bW}i.clickAction&&Xs(e,i.clickAction,{targetType:uU,id:i.key,idType:Oq,actionType:s,actionDetails:{position:o},pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o+=1}}function Dl(e,t,n){return new C2(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,{type:"canPerformAppAction",appAction:e,appCapabilities:t})}function _l(e,t,n,r,o,i,s){return Kv.context("createHeaderShelf",()=>{const a=new yJ(tI)
a.presentationHints={isSeeAllContext:r}
const c=e.loc.string("ProductPage.Accessibility.Shelf.Title")
if(!r){a.title=c
const o=xl(t,n,r)
if((0,Jv.isSome)(o)&&Ii(o)){const r=$l(e,t,n,TW,i,s)
a.seeAllAction=r}}const l=function(e,t,n,r,o,i){const s=xl(t,n,r),a=function(e,t,n){const r=e.bag.accessibilityLearnMoreEditorialItemId
if((0,Jv.isNothing)(r))return null
const o=new FY(Eq)
return o.title=e.loc.string(SN),o.pageUrl=`https://apps.apple.com/story/id${r}`,e.clientCapabilities.isEnabled(MD)&&Xs(e,o,{id:lU,targetType:TW,pageInformation:t,locationTracker:n}),o}(e,o,i),c=(0,Xv.attributeAsString)(t,pH),l=(0,Jv.isSome)(c)&&Ii(c)
let u
u=function(e,t,n,r){if(e)return(0,Jv.isSome)(n)&&r?"AccessibilityDetails.Header":r?oI:(0,Jv.isSome)(n)?"AccessibilityDetails.Header.NoDeveloperName":iI
{const e=(0,Jv.isSome)(t)
return e&&Ii(t)?(0,Jv.isSome)(n)?"ProductPage.Accessibility.Header.SupportedFeatures":"ProductPage.Accessibility.Header.SupportedFeatures.NoLearnMoreLink":e?(0,Jv.isSome)(n)?"ProductPage.Accessibility.Header.NoSupportedFeatures":sI:(0,Jv.isSome)(n)?"ProductPage.Accessibility.Header.NoReportedFeatures":aI}}(r,s,a,l)
let d=e.loc.string(u),f=JV
const h={}
if((0,Jv.isSome)(a)){const t=e.loc.string(SN)
d=d.replace(Mj,t),h[t]=a}l&&(d=d.replace(yF,`<b>${c}</b>`),f=EV)
const p=new D5(d,f)
return new _5(p,h)}(e,t,n,r,i,s),u=new x5(l,[])
return(0,Jv.isSome)(o)&&!r&&(o.addImpressionsToShelf(e,a,"accessibilityOverview"),_h(o.locationTracker)),a.items=[u],a})}function Ll(e,t,n,r,o=null,i,s){return Kv.context("createFeaturesShelf",()=>{const a=function(e,t,n,r){const o=xl(t,n,r)
return(0,Jv.isNothing)(o)?[]:o.reduce((t,n)=>{const r=f(n,AF),o=f(n,Wq),i=f(n,Mq)
if((0,Jv.isNothing)(r)||0===r.length||(0,Jv.isNothing)(o)||0===o.length)return t
const s=function(e){switch(e){case"VOICEOVER":return"voiceover"
case rI:return"voice.control"
case"LARGER_TEXT":return"textformat.size"
case"SUFFICIENT_CONTRAST":return"circle.lefthalf.filled.inverse"
case"DARK_INTERFACE":return"appearance.darkmode"
case"DIFFERENTIATE_WITHOUT_COLOR_ALONE":return"xmark.triangle.circle.square.fill"
case"REDUCED_MOTION":return"circle.dotted.and.circle"
case"CAPTIONS":return"captions.bubble.fill"
case"AUDIO_DESCRIPTIONS":return"quote.bubble.fill"
default:return null}}(r)
if((0,Jv.isNothing)(s))return t
const a=Ot(e,`systemimage://${s}`)
return a.imageScale=function(e){return e===rI?eq:null}(r),t.push(new F5(o,null!=i?i:null,a)),t},[])}(e,t,n,r)
if(Pi(a))return null
const c=new yJ(zH)
c.presentationHints={isSeeAllContext:r}
const l=e.loc.string("ProductPage.Accessibility.Card.SupportedFeaturesTitle"),u=new $5(l,Ot(e,"systemimage://accessibility"),a)
return r||((0,Jv.isSome)(o)&&(o.addImpressionsToShelf(e,c,"supportedFeaturesCard",void 0,void 0,null,l),_h(o.locationTracker)),u.clickAction=$l(e,t,n,FV,i,s)),c.items=[u],c})}function Ml(e,t,n,r,o){return Kv.context("createDeveloperLinkShelf",()=>{const i=function(e,t,n,r,o){const i=function(e,t,n,r,o){const i=function(e,t){const n=t?IB:R$
return(0,Xv.attributeAsString)(e,`${n}.developerUrl`)}(t,n)
if((0,Jv.isNothing)(i)||Pi(i))return null
const s=new JY(i,!1)
return s.title=e.loc.string("Accessibility.DeveloperUrlLinkActionTitle"),e.clientCapabilities.isEnabled(MD)&&Xs(e,s,{id:"AccessibilitySite",targetType:jq,pageInformation:r,locationTracker:o}),s}(e,t,n,r,o)
if((0,Jv.isNothing)(i))return null
const s=e.loc.string("Accessibility.DeveloperUrlLinkTitle"),a=e.loc.string("Accessibility.DeveloperUrlText").replace("{accessibilitySite}",s),c={}
c[s]=i
const l=new D5(a,JV)
return new _5(l,c)}(e,t,n,r,o)
if((0,Jv.isNothing)(i))return null
const s=new yJ(tI)
return s.items=[new x5(i,[])],s.presentationHints={isSeeAllContext:n},s})}function xl(e,t,n){return U(e,`${n?IB:R$}.${t}.supportedCategories`)}function $l(e,t,n,r,o,i){const s=new FY(IB)
s.title=e.loc.string(bP),s.pageData=function(e,t,n,r,o){const i=[],s=_l(e,t,n,!0,null,r,o)
i.push(s)
const a=Ml(e,t,!0,r,o);(0,Jv.isSome)(a)&&i.push(a)
const c=new bJ(i)
return c.title=e.loc.string(xD),c.isIncomplete=!0,c.presentationOptions=[hj,Ox,nI],c}(e,t,n,o,i)
const a=t.type===aW?VW.productBundle:VW.product,c=Xv.URL.fromComponents($W,null,`/${VW.accessibilityDetails}/${a}/${t.id}`,{deviceFamily:n})
return s.pageUrl=c.build(),e.clientCapabilities.isEnabled(MD)&&Xs(e,s,{id:"AccessibilityDetails",targetType:r,pageInformation:o,locationTracker:i}),s}function Fl(e,t,n,r,o,i){if(r)return null
const s=kd(e,t)
if((0,Jv.isNothing)(s))return null
const a=new N5(s),c=o?"":e.loc.string("InfoList.Category.Title")
return new B5(c,[a],void 0)}function Nl(e,t,n,a,c,l){const u=B(t,nE)
let d=[],f=function(e,t){let n
if(zd(e,t)){const r=Sf(0,t,e.appleSilicon.isSupportEnabled),o=!1,i=gf(e,t),s=Rf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),a=function(e,t,n,r,o,i=!0){return!!Cf(0,n,r,o).some(e=>kf(t,e))}(0,i,e.client.deviceType,r,o,s),c=e.loc.deviceDisplayName(e)
a&&c&&(n=e.loc.string("InfoList.Requirements.Summary").replace("{deviceName}",c))}return n}(e,t)
const h=et(e,t,CT,rt(e))
if(s(u)){const t=function(e){const t=[Uq,Bq,hN,vW,aH,oj,gW],n=function(e,t,n){let r=null
switch(t){case lW:r=Uq
break
case oW:r=Bq
break
case vW:r=vW
break
case"tv":r=oj
break
case gW:r=gW
break
case iW:r=aH}return i(n)&&n===hN&&(r=hN),r}(0,e.client.deviceType,e.host.deviceModel)
if(i(n)){const e=t.indexOf(n)
e>0&&(t.splice(e,1),t.unshift(n))}return t}(e)
for(const n of t){const t=p(u,n)
if(s(t)){const r=Bl(0,t,e.appleSilicon.isSupportEnabled&&n===vW&&h&&!e.appleSilicon.isRosettaAvailable)
i(r)&&d.push(r)}}!i(f)&&d.length>0&&(f=d[0].text)}else{const n=function(e,t){const n=Qe(e,t,"requirementsString")
return r(n)?null:new N5(n)}(e,t)
i(n)&&(d=[n])}if(o(d))return null
const w=c?"":e.loc.string("Requirements"),g=new B5(w,d,f)
return 0===g.items_V3.length&&(g.items_V3=bu(0,g)),g}function Bl(e,t,n){var r
const o=null!==(r=f(t,PI))&&void 0!==r?r:void 0
let i=f(t,"requirementString")
const a=l(t,"devices")
if(n){const e=f(t,"rosettaUnavailableRequirementString")
s(e)&&(i=e)}if((0,Jv.isNothing)(i))return null
const c=[]
for(const e of a)c.push("\u2022\t\u2068"+e+"\u2069")
const u=c.length>0?c.join("\n"):void 0
return new N5(i,{heading:o,listText:u})}function Ul(e,t){const n=B(t,"contentRatingsBySystem.appsKorea")
if((0,Jv.isNothing)(n))return null
const r=h(n,eU)
if((0,Jv.isNothing)(r))return null
const o=l(n,DI)[0]
if((0,Jv.isNothing)(o))return null
const i=jf(0,r),s=[]
return(0,Jv.isSome)(i)&&s.push(Ot(e,`resource://${i}`)),new N5(o,{headingArtworks:s})}function Gl(e,t,n,o,s,a){var c
return null!==(c=function(e,t,n,r,o,i){const s=or(0,t)
if((0,Jv.isNothing)(s))return null
const a=e.loc.string(II),c=jl(e,a)
let u,d
u=e.loc.string(qD),d=s
const p=new B5(u,[],d,c),w=sr(e,t)
if((0,Jv.isSome)(w)){const t=Ot(e,Et(w),30,30)
p.items_V3.push({$kind:fW,artwork:t})}else p.items_V3.push({$kind:"textEncapsulation",text:s})
let g=""
const v=se(t,nt(e,t),CI),m=h(v,kI),y=h(v,OI);(0,Jv.isSome)(m)&&(0,Jv.isSome)(y)&&(g+=e.loc.string("InfoList.AgeRating.AgeRange").replace(EI,e.loc.decimal(m)).replace(RI,e.loc.decimal(y)))
const A=function(e,t){return j(t,"ageRating.description")}(0,t);(0,Jv.isSome)(A)&&(g.length>0&&(g+="\n"),g+=A)
const T={};(0,Jv.isSome)(c)&&(T[a]=c,g.length>0&&(g+="\n"),g+=a)
const b=new _5(new D5(g,Tx),T)
p.items_V3.push({$kind:iV,linkableText:b})
const S=function(e,t){const n=G(t,lT)
let r=""
for(const e of n){const t=f(e,"level"),n=l(e,"contentDescriptors")
if(0!==n.length){r.length>0&&(r+="\n\n"),r+=`**${t}**`
for(const e of n){const t=f(e,Mq);(0,Jv.isSome)(t)&&(r+="\n",r+=t)}}}if(0===r.length)return
const o=new _5(new D5(r,Tx))
return{$kind:iV,linkableText:o}}(0,t);(0,Jv.isSome)(S)&&(p.items_V3.push({$kind:XB}),p.items_V3.push(S))
const P=function(e,t){return j(t,"ageRating.ageGuidanceUrl")}(0,t)
if((0,Jv.isSome)(P)){const t=new JY(P)
t.title=e.loc.string("InfoList.AgeRating.DeveloperInfo"),p.items_V3.push({$kind:XB}),p.items_V3.push({$kind:TW,action:t})}return p}(e,t))&&void 0!==c?c:function(e,t,n,o,s,a){const c=B(t,"contentRatingsBySystem.appsApple")
if(r(c))return null
const u=f(c,AW)
if(r(u))return null
if(99===h(c,eU))return null
const d=l(c,DI)
let p
const w=se(t,nt(e,t),CI),g=h(w,kI),v=h(w,OI)
p=i(g)&&i(v)?e.loc.string("InfoList.AgeRating.Summary").replace("{ageRating}",u).replace(EI,e.loc.decimal(g)).replace(RI,e.loc.decimal(v)):u
const m=[]
let y,A="";(0,Jv.isSome)(p)&&(A+=p)
for(const e of d)A+="\n",A+=e
m.push(new N5(A))
{const n=Ul(e,t);(0,Jv.isSome)(n)&&m.push(n)
const r=Vl(e,t);(0,Jv.isSome)(r)&&m.push(r)}(m.length>1||m[0].text!==p)&&(y=p)
const T=s?"":e.loc.string(qD),b=e.loc.string(II),S=jl(e,b)
return new B5(T,m,y,S)}(e,t,0,0,s)}function jl(e,t){let n
if((0,Jv.isSome)(e.bag.ageRatingLearnMoreEditorialItemId)&&e.bag.ageRatingLearnMoreEditorialItemId.length>0){const r=new FY(Eq)
r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.ageRatingLearnMoreEditorialItemId}`
const o=Si({..._i(e),id:e.bag.ageRatingLearnMoreEditorialItemId})
r.destination=o,n=r}return n}function Vl(e,t){if(e.bag.requireAgeVerification&&function(e,t,n){const r=q(t,"contentRatingsBySystem.appsApple.rank")
if((0,Jv.isNothing)(r))return!1
let o
switch(n){case MI:o=3
break
case _I:o=4
break
case"adultOnly":o=5
break
default:o=1}return r>=o}(0,t,_I)&&function(e,t){var n
const r=null!==(n=we(t,BN))&&void 0!==n?n:[]
for(const e of r)if(f(e,"id")===JK.Games.toString())return!0
return!1}(0,t)){let n
if(t.type===aW){const r=fe(t,yW)
if(i(r))for(const t of r.data)if(i(j(t,LI))){n=e.loc.string("AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles")
break}}else i(j(t,LI))&&(n=e.loc.string("AgeVerification.ProductPage.Rating.UnsuitableForJuveniles"))
return(0,Jv.isNothing)(n)?null:new N5(n)}return null}function Hl(e,t,n,r,o,i){const s=ar(e,e.bag.gameControllerRecommendedRolloutRate),a=lr(e,t)
if(s&&a){const n=o?"":e.loc.string("ProductPage.Info.GameController.Title")
let r
r=a?"ProductPage.Info.GameController.Recommended":"ProductPage.Info.GameController.Required"
const i=e.loc.string(r),s=j(t,pH),c=a?"ProductPage.Info.GameController.Recommended.Summary.v2":"ProductPage.Info.GameController.Required.Summary.v2",l=e.loc.string(c).replace(yF,s),u=[new N5(l)]
let d
const f=e.bag.gameControllerLearnMoreEditorialItemId
if((0,Jv.isSome)(f)&&f.length>0){const t=new FY(Eq),n=a?"ProductPage.Info.GameController.Recommended.LearnMore":"ProductPage.Info.GameController.Required.LearnMore"
t.title=e.loc.string(n),t.pageUrl=`https://apps.apple.com/story/id${f}`,d=t}return new B5(n,u,i,d)}return null}function ql(e,t,n,r,o,i){const s=Qe(e,t,"copyright")
if((0,Jv.isNothing)(s))return null
const a=new N5(s),c=o?"":e.loc.string("InfoList.Copyright")
return new B5(c,[a])}function Wl(e,t,n,r,i,s){var a
if(!function(e,t){var n
const r=Pf(e,t),o=new Set(["uses-non-webkit-browser-engine","is-custom-browser-engine-app"])
return null!==(n=null==r?void 0:r.some(e=>o.has(e)))&&void 0!==n&&n}(e,t))return null
const c=null!==(a=function(e,t,n){const r=e.bag.externalBrowserLearnMoreEditorialItemId
if(o(r))return null
const i=new FY(Eq)
return i.title=e.loc.string(SN),i.pageUrl=`https://apps.apple.com/story/id${r}`,Xs(e,i,{id:lU,targetType:jq,actionType:bW,pageInformation:t,locationTracker:n}),i}(e,s.metricsPageInformation,s.locationTracker))&&void 0!==a?a:void 0
let l=c
const u=i?"":e.loc.string("Annotations.ExternalBrowser.Title"),d=e.loc.string("Annotations.ExternalBrowser.Value.Summary"),f=e.loc.string("Annotations.ExternalBrowser.Value.Expanded"),h=[new N5(f)]
return new B5(u,h,d,l)}function zl(e,t,n,r,o,i){const s=er(e,t),a=tr(e,SI)
if(!s||!a)return null
const c=o?"":e.loc.string("Annotations.ExternalPurchases.Title"),l=e.loc.string("YES")
let u
if((0,Zv.isSome)(e.bag.externalPurchasesProductPageAnnotationVariant)){const t=`Annotations.ExternalPurchases.Expanded.Variant${e.bag.externalPurchasesProductPageAnnotationVariant}`
u=e.loc.string(t)}else u=e.loc.string("Annotations.ExternalPurchases.Expanded")
const d=new N5(u),f=e.loc.string("Annotations.ExternalPurchases.Expanded.LearnMore")
let h=nr(e,f,i.metricsPageInformation,i.locationTracker)
return new B5(c,[d],l,null!=h?h:void 0)}function Yl(e,t,n,r,o,i){const s=(0,Xv.attributeAsDictionary)(t,"licenses.gameLicenseVietnam"),a=[Zl(e.loc.string("InfoList.GameLicense.Disclaimer"))],c=(0,Xv.asString)(s,"licenseId")
if(!(0,Jv.isSome)(c)||!Ii(c))return null
a.push(Jl(),Kl(e.loc.string("InfoList.GameLicense.Id.Title")),Zl(c))
const l=(0,Xv.asString)(s,"licenseUrl");(0,Jv.isSome)(l)&&Ii(l)&&a.push(Jl(),Kl(e.loc.string("InfoList.GameLicense.Url.Title")),function(e){const t={}
return t[e]=new JY(e,!1),{$kind:iV,linkableText:new _5(new D5(e),t)}}(l))
const u=o?"":e.loc.string("InfoList.GameLicense.Title"),d=new B5(u,[],c)
return d.items_V3=a,d}function Jl(){return{$kind:XB}}function Kl(e){return{$kind:iV,linkableText:new _5(new D5(`**${e}**`))}}function Zl(e){return{$kind:iV,linkableText:new _5(new D5(e))}}function Ql(e,t,n,r,o,i){return null}function Xl(e,t,n,r,s,a){var c
const l=Ze(e,t,"languageList")
if(o(l))return null
const u=l.length
if(u<1)return null
let d,f
switch(u){case 0:break
case 1:f=l[0]
break
case 2:f=e.loc.string("InfoList.Two.Languages.Summary").replace("{first}",l[0]).replace("{second}",l[1])
break
default:const t=u-1
d=e.loc.string("InfoList.More.Languages.Summary").replace("{language}",l[0]).replace(RD,e.loc.formattedCount(t)),f=null!==(c=function(e,t){if(null==e||null==t)return null
if(0===e.length)return""
let n=e.length,r=""
return e.forEach((e,o)=>{null===e?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(l,e.loc.string("Conjunction.Separator")))&&void 0!==c?c:void 0}if(!i(f))return null
const h=new N5(f),p=s?"":e.loc.string("Supported.Languages")
return new B5(p,[h],d)}function eu(e,t,n,r,o,i){if(!H(t,"usesLocationBackgroundMode"))return null
const s=o?"":e.loc.string("InfoList.Location.Title"),a=e.loc.string("InfoList.Location.Description"),c=new N5(a)
return new B5(s,[c])}function tu(e,t,n,r,o,i){const s=(0,Xv.attributeAsDictionary)(t,zP)
if((0,Jv.isNothing)(s)||(0,Jv.isNothing)(e.bag.medicalDeviceComplianceStatementRegion)||Pi(e.bag.medicalDeviceComplianceStatementRegion))return null
const a=[],c=j(t,pH)
if((0,Jv.isSome)(c)&&Ii(c)){const t=`InfoList.MedicalDevice.Compliance.Statement.${e.bag.medicalDeviceComplianceStatementRegion}`,n=e.loc.string(t).replace(yF,`**${c}**`)
a.push(ou(n))}const l=e.loc.string("InfoList.MedicalDevice.Disclaimer")
nu(a),a.push(ou(l))
const u=(0,Xv.asString)(s,"manufacturerSRN");(0,Jv.isSome)(u)&&Ii(u)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.ManufacturerSRN.Title")),ou(u)))
const d=(0,Xv.asString)(s,"fdaNumber");(0,Jv.isSome)(d)&&Ii(d)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.FDANumber.Title")),ou(d)))
const f=(0,Xv.asDictionary)(s,"sellerContactInfo"),h=(0,Xv.asString)(f,"address");(0,Jv.isSome)(h)&&Ii(h)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.Address.Title")),ou(h)))
const p=(0,Xv.asString)(f,"phoneNumber");(0,Jv.isSome)(p)&&Ii(p)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.PhoneNumber.Title")),ou(p)))
const w=(0,Xv.asString)(f,"email");(0,Jv.isSome)(w)&&Ii(w)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.Email.Title")),ou(w)))
const g=(0,Xv.asString)(s,"useStatement");(0,Jv.isSome)(g)&&Ii(g)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.UseStatement.Title")),ou(g)))
const v=(0,Xv.asString)(s,"safetyInfo");(0,Jv.isSome)(v)&&Ii(v)&&(nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.SafetyInfo.Title")),ou(v)))
const m=(0,Xv.asString)(s,"instructionsForUseUrl")
if((0,Jv.isSome)(m)&&Ii(m)){nu(a),a.push(ru(e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Title")))
{const t=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.Hyperlink"),n=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.FullText").replace("{externalLink}",t),r=new D5(n),o={}
o[t]=new JY(m,!1)
const i=new _5(r,o)
a.push({$kind:iV,linkableText:i})}}if(0===a.length)return null
const y=o?"":e.loc.string("InfoList.MedicalDevice.Title"),A=new B5(y,[],"Yes")
return A.items_V3=a,A}function nu(e){e.length>0&&e.push({$kind:XB})}function ru(e){return{$kind:iV,linkableText:new _5(new D5(`**${e}**`))}}function ou(e){return{$kind:iV,linkableText:new _5(new D5(e))}}function iu(e){var t
return{platform:null===(t=e.activeIntent)||void 0===t?void 0:t.previewPlatform}}function su(e,t){var n
return(null===(n=e.activeIntent)||void 0===n?void 0:n.previewPlatform)?t.addingQuery("previewPlatform",e.activeIntent.platform).addingQuery(nH,BV):t}function au(e,t){const n={...t,id:`id${t.id}`}
return t.platform?j5(e,n):H5(e,n)}function cu(e,t,n,r,o){return Kv.context("capabilitiesFromData",()=>[lu(e,t,r,o),uu(e,t),wu(e,t),du(e,t),fu(e,t),hu(e,t,n),null,pu(e,t)].filter(e=>e))}function lu(e,t,n,r){if(!(0,Jv.isSome)(t)||!et(e,t,LB))return null
if(e.bag.gameCenterExtendSupportedFeatures){const o=function(e){var t
if(!(0,Zv.isNothing)(e))return null!==(t=$(e,"supportedGameCenterFeaturesFromData",()=>{const t=[],n=l(e,"attributes.supportedGameCenterFeatures")
return n.includes(Qq)&&t.push(Qq),n.includes(QV)&&t.push(QV),n.includes(QH)&&t.push(QH),n.includes(vN)&&t.push(vN),t}))&&void 0!==t?t:void 0}(t),i=null==o?void 0:o.includes(QH),s=null==o?void 0:o.includes(Qq)
let a
a=i&&s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ALL_FEATURES"):i?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_LEADERBOARDS"):s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_ACHIEVEMENTS"):e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_NO_FEATURES")
const c=e.loc.string(YT),u=Ot(e,JT,46,45)
{let o
o=(0,Jv.isSome)(t)&&e.clientCapabilities.isEnabled("gameProductIdOpenGamesUIAction")?oo({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r,target:{gamePage:{productID:t.id}}}):oo({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r})
const i=e.loc.string("ProductPage.Capability.GameCenter.ActionTitle")
a=`${a}\n${i}`
const s=new D5(a),l={}
l[i]=o
const d=new _5(s,l),f=Ot(e,"systemimage://arrow.up.forward.square.fill",16,16)
return new U5(MV,c,d,f,void 0,u)}}{const t=e.loc.string(YT),n=new D5(e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION")),r=new _5(n),o=Ot(e,JT,46,45)
return new U5(MV,t,r,void 0,null,o)}}function uu(e,t){if(!et(e,t,"isSiriSupported"))return null
const n=e.loc.string("CAPABILITY_SIRI_TITLE"),r=new D5(e.loc.string("CAPABILITY_SIRI_EXPLANATION")),o=new _5(r),i=Ot(e,"resource://ProductCapabilitySiri",46,45)
return new U5(DE,n,o,void 0,null,i)}function du(e,t){if(!et(e,t,"supportsPassbook"))return null
const n=e.loc.string("CAPABILITY_WALLET_TITLE"),r=new D5(e.loc.string("CAPABILITY_WALLET_EXPLANATION")),o=new _5(r),i=Ot(e,"resource://ProductCapabilityWallet",46,45)
return new U5("wallet",n,o,void 0,null,i)}function fu(e,t){if(!cr(e,t))return null
const n=e.loc.string("CAPABILITY_MFI_CONTROLLERS_TITLE")
let r=null
const o=e.bag.gameControllerLearnMoreEditorialItemId
if(ar(e,e.bag.gameControllerRecommendedRolloutRate)&&(0,Jv.isSome)(o)&&(null==o?void 0:o.length)>0){const t=Si({..._i(e),...iu(e),id:o})
r=new FY(Eq),r.title=e.loc.string("ProductPage.Capability.GameController.ActionTitle"),r.pageUrl=au(e,t)}let i=r?e.loc.string("ProductPage.Capability.GameController.Explanation.v2.WithNewlineActionTemplate"):e.loc.string("ProductPage.Capability.GameController.Explanation.v2")
const s={};(null==r?void 0:r.title)&&(i=i.replace(Mj,r.title),s[r.title]=r)
const a=new D5(i),c=new _5(a,s),l=Ot(e,"resource://ProductCapabilityController",46,45)
return new U5("controllers",n,c,void 0,null,l)}function hu(e,t,n){const r=j(t,"familyShareEnabledDate")
if(!r||H(t,sG))return null
const o=new Date(r),i=new Date
if(!o||o>i)return null
const s=et(e,t,_E),a=s&&et(e,t,"hasFamilyShareableInAppPurchases")
let c=null
const l=e.bag.familySubscriptionsLearnMoreEditorialItemId
if((0,Jv.isSome)(l)&&(null==l?void 0:l.length)>0&&a){const t=Si({..._i(e),...iu(e),id:l})
c=new FY(Eq),c.title=e.loc.string("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),c.pageUrl=au(e,t)}const u=e.loc.string("CAPABILITY_FAMILY_SHARING_TITLE")
let d
if(a?d=c?"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION":s||n||(d=c?"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION"),!d)return null
let f=e.loc.string(d)
const h={};(null==c?void 0:c.title)&&(f=f.replace(Mj,c.title),h[c.title]=c)
const p=new D5(f),w=new _5(p,h),g=Ot(e,"resource://ProductCapabilityFamilySharing",46,45)
return new U5(IL,u,w,void 0,c,g)}function pu(e,t){if(!et(e,t,"hasSafariExtension"))return null
const n=e.loc.string("CAPABILITY_SAFARI_EXTENSION_TITLE"),r=new D5(e.loc.string("CAPABILITY_SAFARI_EXTENSION_EXPLANATION")),o=new _5(r),i=Ot(e,"resource://ProductCapabilitySafariExtension",129,129)
return new U5(KT,n,o,void 0,null,i)}function wu(e,t){if(!et(e,t,xO))return null
const n=e.loc.string("CAPABILITY_SHAREPLAY_TITLE"),r=new D5(e.loc.string("CAPABILITY_SHAREPLAY_EXPLANATION")),o=new _5(r),i=Ot(e,"systemimage://shareplay"),s=Se(LE)
return new U5("sharePlay",n,o,void 0,null,i,s)}function gu(e,t,n,r,o,i){if(r)return null
const s=Qe(e,t,"seller"),a=Ke(e,t,PB),c=Ke(e,t,aE),l=e.bag.enableSellerICPAnnotation&&!0
if((0,Jv.isNothing)(s))return null
const u=Qe(e,t,"sellerLabel")||e.loc.string(xI)
let d,h=[]
const p=f(a,AW),w=(0,Jv.isSome)(p)&&(null==p?void 0:p.length)>0?p:s,g=o?"":u
let m=null
if((0,Jv.isSome)(a)){const[t,n]=function(e,t){const n=[],r={name:"ProductPage.SellerInfo.Name.Title",dunsNumber:"ProductPage.SellerInfo.DunsNumber.Title",address:"ProductPage.SellerInfo.Address.Title",brn:"ProductPage.SellerInfo.BusinessRegistrationNumber.Title",phoneNumber:"ProductPage.SellerInfo.PhoneNumber.Title",email:"ProductPage.SellerInfo.Email.Title",usci:"ProductPage.SellerInfo.UnifiedSocialCreditIdentifier.Title"},o=f(t,AW),i=(0,Jv.isSome)(o)&&(null==o?void 0:o.length)>0?o:e.loc.string(xI),s=(0,Jv.isSome)(f(t,$I))
if(s){const r=v(t,$I),o=r?"ProductPage.SellerInfo.VerifiedSeller.Subtitle":"ProductPage.SellerInfo.UnverifiedSeller.Subtitle"
if(n.push(new N5(e.loc.string(o).replace("{seller}",i))),!r)return[n,i]}let a=null
1!==Object.keys(t).length||Object.keys(t).includes(AW)||(a=e.loc.string("ProductPage.SellerInfo.SeeDetails.Title"))
for(const[o,i]of Object.entries(r)){if(o===AW&&s)continue
const r=vu(e,o,e.loc.string(i),t);(0,Jv.isSome)(r)&&n.push(r)}return[n,a]}(e,a)
m=n,h=h.concat(t)}if(l&&(0,Jv.isSome)(c)){const t=vu(e,"filingNumber",e.loc.string("ProductPage.Info.ICPNumber.Title"),c)
if(0===h.length){const e=new N5(w)
h.push(e)}(0,Jv.isSome)(t)&&h.push(t)}if(h.length>0)(0,Jv.isNothing)(m)&&(m=h.length>1?w:void 0),d=new B5(g,h,m,void 0)
else{const e=new N5(s)
d=new B5(g,[e])}return(0,Jv.isSome)(d),d}function vu(e,t,n,r){let o=f(r,t)
return(0,Jv.isSome)(o)?("brn"===t&&(o=o+"\n"+e.loc.string("ProductPage.SellerInfo.BusinessRegistrationNumber.Subtitle")),new N5(o,{heading:n})):null}function mu(e,t,n,o,s,a){const c=Lf(e,t)
if(n||r(c)||r(c.fileSizeByDevice))return null
const l=e.loc.fileSize(c.fileSizeByDevice),u=s?"":e.loc.string("File.Size")
let d,f=c.fileSizeByDevice
if(i(c.maxEssentialInstallSizeInBytes)){const t=c.fileSizeByDevice+c.maxEssentialInstallSizeInBytes,n=e.loc.string(WD).replace(zD,e.loc.fileSize(t)),r=new N5(n)
d=new B5(u,[r],void 0)}else if(i(c.maxInstallSizeInBytes)){const t=[],n=new N5(l,{heading:e.loc.string("Initial.App.Size")})
t.push(n)
const r=e.loc.string(WD).replace(zD,e.loc.fileSize(c.maxInstallSizeInBytes)),o=new N5(r,{heading:e.loc.string("Additional.Content.After.App.Install")})
t.push(o),f+=c.maxInstallSizeInBytes
const i=e.loc.string(WD).replace(zD,e.loc.fileSize(f))
d=new B5(u,t,i)}else{const e=new N5(l)
d=new B5(u,[e],void 0)}return d}function yu(e,t,n,r,o,i){return null}function Au(e,t,n,r,o,i){const s=ge(t,HL)
if((0,Jv.isNothing)(s)||Pi(s))return null
const a=[],c=[]
for(const t of s){const n=j(t,AW)
if((0,Jv.isNothing)(n))continue
const r=wr(e,t)
if((0,Jv.isNothing)(r))continue
const o=f(r,cj)
if((0,Jv.isNothing)(o))continue
const i=f(r,fG),s=h(r,hG)
let l=e.loc.string("InfoList.IAP.Duration")
if((0,Jv.isSome)(i)){l=l.replace("{name}",n)
const t=qo(0,i,s)
let r
switch(null==t?void 0:t.type){case"D":r="days"
break
case"W":r="weeks"
break
case"M":r="months"
break
case"Y":r="years"
break
default:l=`${n}`}if((0,Jv.isSome)(r)&&(0,Jv.isSome)(t)){const n=e.loc.formatDuration(t.periodDuration,r);(0,Jv.isSome)(n)&&(l=l.replace("{duration}",n))}}else l=`${n}`
a.push([l,o]),c.push({$kind:bI,leadingText:l,trailingText:o})}const l=e.loc.string("ProductPage.Info.InAppPurchases.LearnMore"),u=function(e,t){const n=e.bag.inAppPurchasesLearnMoreEditorialItemId
if((0,Jv.isNothing)(n)||Pi(n))return null
const r=new FY(Eq)
return r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.inAppPurchasesLearnMoreEditorialItemId}`,r}(e,l)
if((0,Jv.isSome)(u)){c.push({$kind:XB,size:eq})
const e={}
e[l]=u,c.push({$kind:iV,linkableText:new _5(new D5(l),e)})}const d=o?"":e.loc.string("InfoList.InAppPurchases"),p=[new N5(void 0,{textPairs:a})],w=new B5(d,p,e.loc.string("YES"))
return w.items_V3=c,w}function Tu(e,t,n,r,o,i,s,a){const c=[]
for(const l of t){const t=l(e,n,r,o,i,s);(0,Jv.isSome)(t)&&(0===t.items_V3.length&&(t.items_V3=bu(0,t)),t.expandAction=void 0,c.push(t),a&&a(l,t,c.length-1))}return c}function bu(e,t){const n=[]
for(const e of t.items){if(n.length>0&&n.push({$kind:XB}),(0,Jv.isSome)(e.headingArtworks))for(const t of e.headingArtworks)n.push({$kind:fW,artwork:t})
let t=""
if((0,Jv.isSome)(e.heading)&&(t+=`**${e.heading}**`),(0,Jv.isSome)(e.text)&&(t.length>0&&(t+="\n"),t+=e.text),(0,Jv.isSome)(e.listText)&&(t.length>0&&(t+="\n"),t+=e.listText),t.length>0&&n.push({$kind:iV,linkableText:new _5(new D5(t,Tx))}),(0,Jv.isSome)(e.textPairs))for(const t of e.textPairs)n.push({$kind:bI,leadingText:t[0],trailingText:t[1]})}return(0,Jv.isSome)(t.linkAction)&&n.push({$kind:TW,action:t.linkAction}),n}function Su(e,t){const n=Ke(e,t,aE),r=e.bag.enableSellerICPAnnotation&&(0,Jv.isSome)(n),o=Ke(e,t,PB),i=e.bag.enableSellerInfo&&(0,Jv.isSome)(o)
return r||i}function Pu(e,t,n,r){const o=new yJ(dI)
o.isHorizontal=!0
let i=null
i=n?t.slice(0,8):t
const a=[]
for(let t=0;t<i.length;t++){const n=i[t]
if(n.action=new MX({player:{playerID:n.playerId}}),s(r)){const o="friendPlayer",i={pageInformation:r.destinationPageInformation,locationTracker:r.sourceLocationTracker,id:"",idType:Oq,anonymizationOptions:{anonymizationString:`FRIEND${t+1}`}}
if(Nh(e,n,{...i,kind:o,title:"",softwareType:null}),e.bag.productPageFriendsPlayingClickEventsEnabled){const t={...i,kind:o,targetType:cW,actionType:bW,softwareType:null}
Xs(e,n.action,t)}}a.push(n),s(r)&&_h(r.sourceLocationTracker)}if(o.items=a,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=MV,n&&t.length>8){const n=new yJ("smallGameCenterPlayer")
n.title=e.loc.stringWithCount("ProductPage.FriendsPlaying.SeeAllTitle",t.length),n.items=t.map(e=>(e.action=new s6(e.playerId),e)),n.rowsPerColumn=1
const i=new bJ([n])
i.title=null==r?void 0:r.title
const s=new FY(SW)
s.title=e.loc.string(gH),s.pageData=i,o.seeAllAction=s}return s(r)&&(Nh(e,o,{id:"",kind:null,softwareType:null,targetType:yq,title:r.title,pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker,idType:Oq,badges:{gameCenter:!0}}),o.footerTitle=e.loc.string(z$),o.footerAction=oo({objectGraph:e,target:{friends:{}},metricsPageInformation:null==r?void 0:r.sourcePageInformation,metricsLocationTracker:null==r?void 0:r.sourceLocationTracker}),o.footerStyle={$kind:sq,bundleID:FN,width:16,height:16}),o}async function Iu(e,t,n,i){return await Ha("inAppPurchasesShelf",async()=>{var a
if(!function(e,t){return t!==KV&&!e.client.isCompanionVisionApp}(e,e.host.platform))return null
if(o(t))return null
let c
if(c=si(e)?he(t,XO):fe(t,YL),(0,Jv.isNothing)(c)||0===c.data.length)return null
if(0===c.data.filter(function(e){return H(e,NM)===i.isForSubscriptions}).length)return null
const l={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:yq,id:`${n.getSequenceId()}`,idType:Oq},u=pN,d=new yJ(u),f=V(t,Sq)?rG:WH,h=Qe(e,t,kq),p=null===(a=i.options)||void 0===a?void 0:a.spotlightInAppProductIdentifier
!function(e,t,n){const o=rW
for(const e of n.data){let n=fe(e,o)
n||(n={data:[t]}),r(e.relationships)&&(e.relationships={}),e.relationships[o]=n}}(0,t,c)
const w=[],g=function(e,t,n,r,o,i){const s=Nd(e,t,{lockupOptions:{metricsOptions:r,offerStyle:n,skipDefaultClickAction:!0,artworkUseCase:O6.LockupIconSmall},contentUnavailable:function(e,t){return w.push(t),!1}})
return o&&Xh(0,o,s),s}(e,c.data,f,l,p).filter(function(e){return e.productIdentifier===p&&(i.options.spotlightSection=new p1(IW,i.isForSubscriptions?Vj:jj)),e.isSubscription===i.isForSubscriptions})
if(0===g.length&&0===w.length)return null
if(d.items=await async function(e,t,n,r){if((0,Jv.isNothing)(n))return t
const o=[],i=[]
for(const e of t){const t=e.productIdentifier
o.push(t),e.isVisibleByDefault&&i.push(t)}const s=await M(e.clientOrdering.orderedVisibleIAPs(n,o,i,r))
return s.success?function(e,t){const n={}
for(const t of e)n[t.productIdentifier]=t
const r=[]
for(const e of t){const t=n[e]
if(t){const e=S(t)
r.push(e)}}return r}(t,s.value):t}(e,g,h,p),s(w)){const e=new C3(t.id,w,d.title,!1,void 0,u,f,null)
e.appBundleId=h,e.iapShelfContext=i,i.isForSubscriptions?e.inAppShelfId=Vj:e.inAppShelfId=jj,d.url=Jh(0,e,n)}let v
return i.isForSubscriptions?(d.title=e.loc.string("ProductPage.Section.Subscriptions.Title","Subscriptions"),v="subscription"):(d.title=e.loc.string("ProductPage.Section.InAppPurchases.Title"),v="iAP"),Ch(e,l,d.title),Oh(n.locationTracker),_h(n.locationTracker),d.isHorizontal=!0,n.addImpressionsToShelf(e,d,v),d})}function Cu(e,t,n,r,s,a){return Kv.context(yj,()=>o(t)?null:function(e,t,n,r,o){return Kv.context("standardLinksShelf",()=>{const s=new yJ("productPageLink"),{metricsPageInformation:a,locationTracker:c}=n,l=[]
if(e.client.deviceType!==vW){const n=Qe(e,t,VL)
if(n){const t=new JY(n,!1),r=e.loc.string("DEVELOPER_WEBSITE")
l.push(new Q5(r,t,X5))}}const u=Qe(e,t,uN)
if(u){const t=new JY(u,!1),n=e.loc.string(Ex)
l.push(new Q5(n,t,e6))}if(V(t,fI)){const n=function(e,t){const n=t.id,r=t.type
return i(t)&&i(n)&&i(r)?`${$W}:/${VW.eula}?resourceType=${r}&resourceId=${n}`:null}(0,t)
if(n){const t=new FY(SW)
t.pageUrl=n
const r=e.loc.string(kF)
l.push(new Q5(r,t,t6))}}const d=f(Ke(e,t,PB),ND)
if((null==d?void 0:d.length)>0){const t=new JY(d,!1),n=e.loc.string(Rx)
l.push(new Q5(n,t,o6))}const h=e.bag.productPageReportProblemSADSubscriptionArray,p=t.id,w=h.includes(p),g=st(e).isSystemAppFromData(t),v=t.type===aW,m=r&&!g,y=e.bag.productPageReportProblemSecondPartyAppArray.includes(p)
if(!v&&!y&&!o&&e.bag.reportProblemEnabled&&(w||m)){const n=function(e,t){const n=t.id,r=e.bag.productPageReportProblemURL
return i(n)&&i(r)?r.replace("{productId}",n):null}(e,t)
if((null==n?void 0:n.length)>0){const t=new JY(n,!1),r=e.loc.string(fb),o=new Q5(r,t,r6,w?null:p)
l.push(o)}}return l&&l.length>0&&(s.items=l),n.addImpressionsToShelf(e,s,NN),s})}(e,t,n,r,a))}function ku(e,t,n,i){const s=kd(e,t)
if(o(s))return null
const a=e.loc.string("BADGE_CATEGORY_HEADING"),c=new c6(fW,Zj,{},wW,a,s,null,s,a,WH)
if(new FY(SW).title=j(t,pH),n&&"tv"!==e.client.deviceType){const n=Sn(e,t,!0)
if(r(n))return null
c.artwork=El(e,n,"bb")}return c}function Ou(e,t,n,r){const o=Ke(e,t,ID)
if(o){const t=Bf(0,e.host.clientIdentifier)
if(t){const n=p(o,t)
if(n){const t=h(n,JM),r=f(n,HP),o=f(n,_H),i=f(n,gq),s=e.loc.string("BADGE_CHART_POSITION_HEADING"),a=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",t.toString()),c=new c6(bx,bx,{position:e.loc.decimal(t)},wW,s,r,null,a,r,IV),l=Nf(e,o,i)
if((0,Zv.isSome)(l)){const e=new FY(vG)
e.pageUrl=l,c.clickAction=e}return c}}}return null}function Eu(e,t,n,r){var o
return null!==(o=function(e,t,n,r){const o=or(0,t)
if((0,Jv.isNothing)(o))return null
let i
i=n?function(e,t){const n=G(t,lT)
for(const e of n)if("IAC"===f(e,HH))return!0
return!1}(0,t)?e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon.InAppControls"):e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon"):e.loc.string("ProductPage.Badge.AgeRating.Caption")
const s=e.loc.string("ProductPage.Badge.AgeRating.Heading"),a=e.loc.string("ProductPage.Badge.AgeRating.AX.Caption"),c=sr(e,t),l=(0,Jv.isSome)(c)?fW:$U,u=new c6(l,$U,{contentRating:o},wW,s,i,void 0,o,a,IV)
return(0,Jv.isSome)(c)&&(u.isMonochrome=!1,u.artwork=Ot(e,Et(c),26,26)),u}(e,t,n))&&void 0!==o?o:function(e,t,n,r){const o=j(t,aT)
if((0,Jv.isNothing)(o))return null
const i={contentRating:o},s=q(t,"contentRatingsBySystem.appsBrazil.rank"),a=jf(0,null!=s?s:void 0)
let c
a&&(i.contentRatingResource=a),c=n?e.loc.string(qP):e.loc.string(WP)
const l=e.loc.string("BADGE_AGE_RATING_HEADING"),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE")
return new c6($U,$U,i,wW,l,c,void 0,o,u,IV)}(e,t,n)}function Ru(e,t,n,r){return function(e,t,n,r){if(lr(e,t)){let t,n
t=e.loc.string(Sx),n=e.loc.string("ProductPage.Badge.GameController.Recommended")
const r=new c6(_u(e),SF,{},wW,t,n,void 0,void 0,n,IV)
return r.artwork=Lu(e),r.clickAction=td(e)?new gJ(Aq):new vJ(new mJ(IW,Aq)),r}return null}(e,t)}function Du(e,t,n,r){return function(e,t,n,r){if(!cr(e,t)||function(e,t){switch(ur(e,t)){case i$:case SL:case bL:return!0
default:return!1}}(e,t)||lr(e,t)||function(e,t){return"REQUIRED"===dr(e)}(e))return null
{let t,n
t=e.loc.string(Sx),n=e.loc.string(KB)
const r=new c6(_u(e),SF,{},wW,t,n,void 0,void 0,n,IV)
return r.artwork=Lu(e),r.clickAction=td(e)?new gJ(Aq):new vJ(new mJ(IW,Aq)),r}}(e,t)}function _u(e){return e.clientCapabilities.isEnabled("artworkControllerBadge")?fW:SF}function Lu(e){const t=Ot(e,QN)
return t.imageScale=eq,t}function Mu(e,t,n,o){const s=pe(e,t,VH),a=e.loc.string("BADGE_DEVELOPER_HEADING"),c=j(t,pH),l=new c6(fW,VH,{},wW,a,c,null,c,a,WH)
if(n&&"tv"!==e.client.deviceType){const t=Sn(e,s,!0)
r(t)?l.artwork=Ot(e,Px,26,26):l.artwork=El(e,t)}const u=Ff(0,s)
if(i(u)){const n=new FY(SW)
n.title=j(t,pH),n.pageUrl=u,s&&(n.destination=function({id:e,...t}){return{...t,id:dt(e),$kind:l6}}({..._i(e),id:s.id})),Xs(e,n,{targetType:lq,id:s.id,actionType:bW,pageInformation:o.pageInformation,locationTracker:o.locationTracker}),l.clickAction=n}return l}function xu(e,t,n,r){const o=Ke(e,t,kG)
if(o){const r=f(o,$M)
if(r&&r===FM){let r,o
r=G(t,vR)[0]===VG?e.loc.string("EDITORIAL_BADGE_GAMES"):e.loc.string("EDITORIAL_BADGE_APPS"),o=n?e.loc.string("EDITORS_CHOICE_RIBBON_HEADING"):e.loc.string("EDITORS_CHOICE_SINGLE_LINE")
const i=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),s=new c6(UH,UH,{},wW,o,r,null,i,r)
return td(e)?s.clickAction=new gJ(UH):s.clickAction=new vJ(new mJ(IW,qq)),s}}return null}function $u(e,t,r,o){const i=Ze(e,t,"supportedLocales"),s=(a=i).length<=0?null:{tag:f(n(a,"0.tag")).split("-")[0].toUpperCase(),name:f(n(a,"0.name"))}
var a
if(!s)return null
const c={paragraphText:s.tag}
let l
const u=i.length-1
l=u>0?e.loc.stringWithCount("ProductPage.Badge.Language.Caption",u).replace("{number_other_languages}",e.loc.formattedCount(u)):s.name
const d=e.loc.string("BADGE_LANGUAGE_HEADING")
return new c6(Hj,bF,c,wW,d,l,null,null,l,IV)}function Fu(e,t,n,r){const o=(0,Xv.attributeAsDictionary)(t,zP)
if(!(0,Jv.isSome)(o))return null
const i=e.loc.string("ProductPage.Badge.MedicalDevice.Heading"),s=e.loc.string("ProductPage.Badge.MedicalDevice.Label"),a=new c6(fW,PD,{},wW,i,s,void 0,s,i,WH)
return n&&(a.artwork=Ot(e,"systemimage://waveform.path.ecg.rectangle")),a}function Nu(e,t,n,r){const o=tt(e,t,hB),s=tt(e,t,pB)
if(!i(o)||!i(s))return null
if(o<=0||s<=0||o>s)return null
const a=e.loc.string(YP),c=Uu(e,o,s,!1),l=Uu(e,o,s,!0),u=e.loc.string(YP),d={paragraphText:Bu(e,o,s)}
return new c6(Hj,PH,d,wW,a,c,null,l,u,IV)}function Bu(e,t,n){return t===n?t<=32?e.loc.formattedCount(t):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(kD,e.loc.formattedCount(32)):n<=32?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(kD,e.loc.formattedCount(t)).replace(JP,e.loc.formattedCount(n)):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(kD,e.loc.formattedCount(t)).replace(JP,e.loc.formattedCount(32))}function Uu(e,t,n,r){return 1===t&&1===n?e.loc.string("BADGE_PLAYERS_CAPTION_SINGLE"):1===t||r?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER"):e.loc.string("BADGE_PLAYERS_CAPTION_REQUIRED")}function Gu(e,t,n,r){const o=B(t,JU)
let i=null
const s=ua(e,t)
if(!s&&o&&o.value&&o.ratingCount){const t=h(o,ED),n=Math.round(10*t)/10,r=e.loc.decimal(n,1),s=h(o,$P),a=e.loc.formattedCount(s)
let c
c=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.ShortTemplate",s).replace(RD,a)
const l=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.LongTemplate",s).replace(RD,a).replace("{rating}",r),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",r)
i=new c6(Tj,Tj,{rating:n,ratingFormatted:r},wW,c,c,l,u,c)}else{if(n)return null
const t=e.loc.string(KP)
if(s&&t!==KP)i=new c6(Tj,Tj,{},wW,null,t,null,t)
else if(!s){const t=e.loc.string("BADGE_NOT_ENOUGH_RATINGS_CAPTION")
i=new c6(Tj,Tj,{},wW,null,t,null,t)}}if(i){let t
return t=new gJ(FH),i.clickAction=td(e)?t:new vJ(new mJ(IW,qq)),i}return null}function ju(e,t,n,r){if((0,Jv.isSome)(B(t,Fq)))return null
const o=q(t,"contentRatingsBySystem.appsAustralia.rank"),i=j(t,"contentRatingsBySystem.appsAustralia.name")
if((0,Jv.isSome)(o)&&(0,Jv.isSome)(i))return Vu(e,n,"AU",o,i,!1)
const s=q(t,"contentRatingsBySystem.appsFrance.rank"),a=j(t,"contentRatingsBySystem.appsFrance.name")
if((0,Jv.isSome)(s)&&(0,Jv.isSome)(a))return Vu(e,n,"FR",s,a,!1)
const c=q(t,"contentRatingsBySystem.appsKorea.rank"),l=j(t,"contentRatingsBySystem.appsKorea.name")
return(0,Jv.isSome)(c)&&(0,Jv.isSome)(l)?Vu(e,n,"KR",c,l,!0):null}function Vu(e,t,n,r,o,i){const s=null===(c=Uf(0,r))||void 0===c?void 0:c[0],a=jf(0,r)
var c
if((0,Jv.isNothing)(a)||(0,Jv.isNothing)(s))return null
const l=fW,u=ZP,d={contentRating:s},f=wW,h=e.loc.string(`ProductPage.Badge.AgeRating.${n}.Heading`)
let p,w
p=t?e.loc.string(qP):e.loc.string(WP),w=o
const g=e.loc.string(`ProductPage.Badge.AgeRating.${n}.AX.Caption`),v=new c6(l,u,d,f,h,p,void 0,w,g,IV)
return v.isMonochrome=!i,v.artwork=Ot(e,`resource://${a}`,26,26),v}function Hu(e,t,n,r){return t?Kv.context("badgesFromLookupResponse",()=>{let o,i=!1
return H(t,Sq)?o=u6:n?(o=f6,-1===o.indexOf(xu)&&o.splice(1,0,xu),i=!0):o=d6,function(e,t,n,r,o,i){const s=[]
for(const o of t){const t=o(e,n,r,i)
t&&s.push(t)}if(o&&s.some(e=>e.key===bx)){const e=s.findIndex(e=>e.key===Zj)
e>=0&&s.splice(e,1)}return s}(e,o,t,n,i,r)}):[]}function qu(e,t,n,r,o,i){return Kv.context(pI,()=>i?null:Pa(e,t.id,o,n,null))}function Wu(e,t){const n=f(t,SD)
if(n){const t=new JY(n,!1)
return t.title=e.loc.string(FP),t.artwork=Ot(e,_O),t}return null}function zu(e){var t
if((0,Jv.isSome)(e)){const n=null!==(t=e.presentationHints)&&void 0!==t?t:{}
e.presentationHints={...n,isSeeAllContext:!0}}}function Yu(e,t,n,r,o){const i=`${$W}:/${VW.product}/${VW.shelf}/`+Kh(n,r,o),s=new wz(i)
return s.param(tz.shelfRefreshType,dz),s.param(tz.id,t),s.build()}function Ju(e){return e.featureFlags.isEnabled(NJ)}function Ku(e,t){return t?t.map(t=>Zu(e,t,yI)):[]}function Zu(e,t,n){return Kv.context("titledParagraphFromVersionHistoryEntry",()=>{let r=f(t,AI);(0,Jv.isSome)(r)&&(r=r.trim())
const o=new v6(r,n),i=f(t,VD),s=e.loc.string("VERSION_STRING_TEMPLATE")
o.primarySubtitle=n===yI?i:s.replace("{version}",i)
const a=f(t,"releaseTimestamp")
if(a){const t=new Date(a)
o.secondarySubtitle=e.loc.relativeDate(t)}return o})}async function Qu(e,t,n,a,c,l=!1){return await Ha("createProductPageFromResponse",async()=>{var d
const p=yt(e,t)
if(o(p))return null
p.type
const w=null==a?void 0:a[I3],g=yt(e,w),v=s(g)?c:null,m=s(g)?null:c,y=function(e,t,n){var r
const o=yt(e,t),s=o.type===aW
i(n)&&(n.iAdClickFields&&(t[aK]=JSON.stringify(n.iAdClickFields)),n.iAdLineItem&&(t[cK]=n.iAdLineItem))
const a=Un(e,s?ZM:NV,o.id,t),c=new wz(a.pageUrl)
return null!==(r=null==n?void 0:n.webBrowser)&&void 0!==r&&r&&(c.param(_R,OS),c.removeParam(yx),c.removeParam(XP),a.pageUrl=c.build()),new b3(a,{rootPosition:0,locationStack:[]})}(e,t,n),b=Xu(e,p,y,n,g,m,v,l)
y.metricsPageInformation.baseFields[ox]=Th(e,p,b.lockup.icon,null==n?void 0:n.clientIdentifierOverride),(Kt(e,oq)||Kt(e,SH))&&(y.metricsPageInformation.adPageInfo=new s1(e,oq,s1.createInitialPageSlotInfos(e,oq,null,null,null)))
const P=gf(e,p),I=null!==(d=null==n?void 0:n.webBrowser)&&void 0!==d&&d
I||jn(e,b,y.metricsPageInformation,t=>{const n=Sf(0,p,e.appleSilicon.isSupportEnabled),r=Rf(e,p,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),o=Of(e,p,P,e.client.deviceType,n,!1,r),i=Df(0,P,e.client.deviceType,n,!1),a=P&&(o||i),c=function(e,t,n,r){if(!zd(e,t))return!1
if(at(e,t,rm.ThirtyTwoBit|rm.UnsupportedSystemDeletableApps|rm.MinimumOSRequirement|rm.UnsupportedPlatform|rm.MacOSRosetta))return!1
const o=Cf(0,n,Sf(0,t,r),!1),i=gf(e,t)
return o.some(e=>kf(i,e))}(e,p,e.client.deviceType,e.appleSilicon.isSupportEnabled)
t[DD]=a&&c?"runnable":a?"purchasable":Iq,s(m)&&kW.shared.addReferralContextToMetricsFieldsIfNecessary(t)},I)
const C=Br(t,!0)
return await async function(e,t,n,a,c,l,d){var p,w
const g=gf(e,n),v=n.type===aW,m=V(n,Sq),y=!(1===g.length&&g[0]===vW),b=ua(e,n),P=!!y&&!m&&!b,I=s(c)?c.clientIdentifierOverride:null,C=H(n,sG),k=t.lockup.offerDisplayProperties,O=!i(k)||k.isFree
let E
if(v){const t=fe(n,yW)
E=function(e,t,n,r){return n?Kv.context("bundleChildrenShelf",()=>{const o=Lq,i=new yJ(o)
i.isHorizontal=!0
const s=n.data.length
if(!s)return null
i.title=e.loc.stringWithCount("ProductPage.AppsInBundleShelf.Title",s)
const a=Zh(e,n,r,O6.LockupIconSmall,o,null,rm.Bundles,null,e.featureFlags.isEnabled(GJ))
if(a.remainingItems.length){const e=new C3(t.id,a.remainingItems,i.title,!1,void 0,Lq,WH,null)
e.isBundleShelf=!0,i.url=Jh(0,e,r)}return Ch(e,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:yq,id:`${r.getSequenceId()}`,idType:Oq},i.title),i.items=a.items,Oh(r.locationTracker),r.addImpressionsToShelf(e,i,nj),_h(r.locationTracker),i.rowsPerColumn=s<2?1:2,i}):null}(e,n,t,a)}E&&(t.shelfMapping[nj]=E)
const R=fe(n,aW),D=function(e,t,n,r){return n?Kv.context("bundleParentsShelf",()=>{const o=n.data.length
if(!o)return null
const i=Lq,a=new yJ(i)
a.isHorizontal=!0,a.title=e.loc.string("ProductPage.Section.IncludedInBundles.Title")
const c=Zh(e,n,r,O6.LockupIconSmall,i)
if(0===c.remainingItems.length&&0===c.items.length)return null
if(a.items=c.items,s(c.remainingItems)){const e=new C3(t.id,c.remainingItems,a.title,!1,void 0,i,WH,null)
e.isBundleShelf=!0,a.url=Jh(0,e,r)}return a.rowsPerColumn=o<2?1:2,r.addImpressionsToShelf(e,a,"bundleParent"),a}):null}(e,n,R,a)
D&&(t.shelfMapping[xG]=D)
const _={productTitle:t.title,shouldShowRatingsAndReviews:P,isFirstPartyHideableApp:C,isBundle:v,isPreorder:m},L=function(e,t,n,r,i){return Kv.context("createReviewsShelves",()=>{const a={}
if(o(t))return a
const c=function(e,t){if(td(e))return!0
if(o(t))return!1
let n
return n=st(e).isSystemAppFromData(t),!n||e.bag.enableSystemAppReviews}(e,t),l=gf(e,t),d=fe(t,qq),p=At(d),w=B(t,JU)
w.ratingAverage=h(w,ED),w.adamId=t.id,w.isBundle=r.isBundle,w.supportUrl=Qe(e,t,jL)
const g=rf(e,t,{useCase:O6.LockupIconMedium}),v=1===l.length&&"tv"===l[0],m=xa(e),y=u(w,AD),T=function(e,t,n,r){return Kv.context("createProductRatings",()=>{const n=ga(e,e.client.guid,cH,t)
return n.ratingAverage>0&&n.ratingCounts||r||(n.status=e.loc.string(bD)),n})}(e,w,p.length,y),b=function(e,t,n,r,o,i){return Kv.context(pI,()=>{const r=qu(e,t,n,0,o,i)
if(r){const e=new p6
return e.actionType=Iy,e.action=r,e.id="ProductReviewAction.TapToRate",e}return null})}(e,t,r.productTitle,0,r.isBundle,v),P=function(e,t,n,r,o,i,s){return Kv.context("createWriteAReview",()=>{if(r)return null
{const r=new w6
r.writeReviewAction=Ca(e,t,i,s,o),r.supportAction=Wu(e,n)
const a=new p6
return a.actionType="writeAReview",a.action=r,a}})}(e,t,w,v,g,i,r.productTitle),I=Kv.context(xP,()=>null),C=function(e,t,n){return Kv.context("createReviewSummaryProductReview",()=>{const r=va(e,t,n)
if((0,Jv.isNothing)(r))return null
const o=new nJ
return o.review=r,o.sourceType=oV,o})}(e,t,n),k=va(e,t,n),O=pa(e,w,p,!0,I,C,n),E=pa(e,w,p,!0,null,null,n)
if(function(e,t,n,r,o,i,s,a){Kv.context("createProductReviewActions",()=>{const c=new g6
return c.tapToRate=qu(e,t,n,0,o,i),c.writeReviewAction=Ca(e,t,a,n,s),c.supportAction=Wu(e,r),c})}(e,t,r.productTitle,w,r.isBundle,v,g,i),v||0===p.length||Ma(e,e.client.guid,w,p,d.next,r.productTitle,g,!1,!1,t,n),r.shouldShowRatingsAndReviews){const o=new yJ(FH)
o.title=m,o.items=[T],a.ratingsShelf=o,n.addImpressionsToShelf(e,o,"ratingsOverview",null,null,null,e.loc.string("ProductPage.Section.Reviews.Title"))
const i=[]
if(s(b)&&c&&i.push(b),s(P)&&c&&i.push(P),s(i)){const e=new yJ(UD)
e.items=i,a.allReviewActionsShelf=e}if(s(k)){const e=new yJ(oV)
e.items=[k],a.reviewSummaryShelf=e}let l=null
s(b)&&c&&(l=new yJ(UD),l.items=[b],a.tapToRateActionsShelf=l)
let u=null
s(P)&&c&&(u=new yJ(UD),u.items=[P],a.writeAReviewActionsShelf=u)
const h=e.loc.string(GD),g=e.loc.string(TF),y=(0,Jv.isSome)(E)&&E.length>0
let D,_
if((0,Jv.isSome)(O)&&O.length>0&&(D=new yJ(e$),D.items=O,D.isHorizontal=!0,y?(D.title=h,D.contentsMetadata={type:"productReviewsSection",hasReviewSummary:(0,Jv.isSome)(C),reviewSummaryTitle:g},n.addImpressionsToShelf(e,D,yD,null,null,null,e.loc.string(GD))):D.title=g,a.allProductReviewsShelf=D),y&&(_=new yJ(e$),_.items=E,_.isHorizontal=!0,_.title=h,n.addImpressionsToShelf(e,_,yD,null,null,null,e.loc.string(GD)),a.userProductReviewsShelf=_),"tv"===e.client.deviceType){const t=new yJ(jD)
t.title=m
const n=[]
s(b)&&A(R=b.action)&&"TapToRate"===R[PW]&&c&&n.push(b.action),s(T.status)?e.featureFlags.isEnabled(jJ)?n.push(new h6(T.status)):n.push(ba(T)):(n.push(Aa(T)),n.push(Ta(T))),t.items=n,a.purchasedRatingsAndReviewsComponentShelf=t}if("tv"===e.client.deviceType){const t=new yJ(jD)
t.title=m
const n=[]
s(T.status)?e.featureFlags.isEnabled(jJ)?n.push(new h6(T.status)):n.push(ba(T)):(n.push(Aa(T)),n.push(Ta(T))),t.items=n,a.notPurchasedRatingsAndReviewsComponentShelf=t}let L=null
s(I)&&(L=new yJ(e$),L.items=[I],r.shouldShowRatingsAndReviews?I.review.showsBadge||(L.title=e.loc.string(lI)):L.title=m,a.editorsChoiceProductReviewsShelf=L),!v&&p.length>0&&(a.ratingsShelf.seeAllAction=function(e,t,n,r,o,i=null,s,a,c){return r?Kv.context(VP,()=>{var t
const l=new SJ
let u,d,h
if((0,Jv.isSome)(null==c?void 0:c.allReviewActionsShelf)){u=S(c.allReviewActionsShelf)
const e=null!==(t=u.presentationHints)&&void 0!==t?t:{}
u.presentationHints={...e,displayIfReviewable:!0},zu(u)}if((0,Jv.isSome)(null==c?void 0:c.ratingsShelf)){d=S(c.ratingsShelf)
const e=d.items[0]
if((0,Jv.isSome)(e)&&1===d.items.length){const t=S(e)
t.context=_L,d.items=[t]}d.seeAllAction=null,d.title=null,zu(d)}(0,Jv.isSome)(null==c?void 0:c.reviewSummaryShelf)&&(h=S(c.reviewSummaryShelf),zu(h))
const p=_a(e,0,n,r,o,i,s,a,mD,{ratingsShelf:d,reviewSummaryShelf:h,reviewActionsShelf:u})
l.title=null,l.adamId=f(r,HV),l.nextPage=p.paginationToken,l.initialSortOptionIdentifier=p.initialSortId,l.sortActionSheetTitle=p.sortActionSheetTitle,l.sortOptions=p.sorts,(0,Jv.isSome)(d)&&l.shelves.push(d),(0,Jv.isSome)(h)&&l.shelves.push(h),(0,Jv.isSome)(u)&&l.shelves.push(u),l.shelves.push(p.reviewsShelf)
const w=Ra(e);(0,Jv.isSome)(w)&&(l.trailingNavBarAction=w)
const g=new FY(qq)
return g.pageData=l,g.title=e.loc.string(gH),g}):null}(e,e.client.guid,t.id,w,p,d.next,!1,!1,a))}var R
return a})}(e,n,a,_,t.lockup.subtitle)
s(L)&&(t.shelfMapping[YU]=L.purchasedRatingsAndReviewsComponentShelf,t.shelfMapping[zU]=L.notPurchasedRatingsAndReviewsComponentShelf,t.shelfMapping[FH]=L.ratingsShelf,t.shelfMapping[IF]=L.allReviewActionsShelf,t.shelfMapping[HU]=L.allProductReviewsShelf,t.shelfMapping[_G]=L.userProductReviewsShelf,t.shelfMapping[UH]=function(e,t){const n=function(e,t){return Kv.context(xP,()=>{const n=f(Ke(e,t,mV),wW)
if(n){const r=new l1(n),o=Ke(e,t,kG)
if(o){const e=f(o,$M)
r.showsBadge=e&&e===FM}return r.showsBadge||(r.title=e.loc.string(_x)),r}return null})}(e,t)
if((0,Zv.isNothing)(n))return null
const r=new yJ(UH)
return r.items=[n],n.showsBadge?r.background={type:UH}:r.title=e.loc.string(lI),r}(e,n),t.shelfMapping[qU]=L.tapToRateActionsShelf,t.shelfMapping[WU]=L.writeAReviewActionsShelf,t.shelfMapping[CF]=L.productReviewsHeader)
{const n=function(e){if(o(e.bag.ratingsAndReviewsLearnMoreEditorialId))return null
const t=new yJ(iV),n=function(e){const t=e.loc.string(wI),n={},r=function(e){const t=e.bag.ratingsAndReviewsLearnMoreEditorialId
if(o(t))return null
const n=new FY(Eq)
return n.title=e.loc.string(wI),n.pageUrl=`https://apps.apple.com/story/id${t}`,n}(e)
if((0,Jv.isNothing)(r))return null
n[t]=r
let i=e.loc.string("ProductPage.RatingsAndReviews.Footer")
i=i.replace(Mj,t)
const s=new D5(i,JV)
return new _5(s,n)}(e)
return(0,Jv.isNothing)(n)?null:(t.items=[n],t)}(e);(0,Jv.isSome)(n)&&(t.shelfMapping[Kj]=n)}const $=function(e,t,n){const r=va(e,t,n)
if((0,Jv.isNothing)(r))return null
const o=new yJ(oV)
return o.items=[r],o}(e,n,a);(0,Jv.isSome)($)&&(t.shelfMapping[oV]=$)
const F=function(e,t,n,r){return Kv.context(yj,()=>function(e,t,n,r,o,i){return Kv.context("standardMostRecentVersionShelf",()=>{if(!n&&!r&&!o){const n=Ze(e,t,gU)
if(n.length>1&&Ku(e,n).length>0){const r=new yJ(mI)
r.title=e.loc.string(gI)
const o=Zu(e,n[0],vI)
if(r.items=[o],i.addImpressionsToShelf(e,r,gU),r)return e.client.deviceType!==gW&&(r.seeAllAction=function(e,t,n,r){return Kv.context("versionHistorySeeAllAction",()=>{const o=function(e,t,n){return Kv.context("versionHistoryPageAction",()=>{const r=Ku(e,t)
let o
if(r.length>0){const t=new yJ(mI)
t.items=r
const i=new bJ([t])
i.title=e.loc.string("VERSION_HISTORY_PAGE_TITLE","Version History"),e.client.deviceType!==gW&&(i.presentationOptions=[hj])
const s=Gn(e,"VersionHistory",n,"")
jn(e,i,s)
const a=new FY(gU)
a.title=e.loc.string("ACTION_VERSION_HISTORY_SEE_ALL"),a.pageData=i,o=a}return o})}(e,t,n)
return ea(e,o,null,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o})}(e,n,t.id,i)),r}}return null})}(e,t,r.isFirstPartyHideableApp,r.isBundle,r.isPreorder,n))}(e,n,a,{isFirstPartyHideableApp:C,isBundle:v,isPreorder:m})
F&&(t.shelfMapping[tH]=F),t.shelfMapping[$G]=function(e,t,n){return Kv.context("textCardShelfFromResponse",()=>(o(t),null))}(0,n)
const N=Qe(e,n,kq)
if(e.bag.enablePrivacyNutritionLabels&&!xi(e,n.id)&&!$i(e,N)){const s=function(e,t,n,r){return Kv.context("privacyShelf",()=>{if(o(t))return null
const i=new yJ(wq)
i.title=e.loc.string(gx)
const s=Pl(e,t,!1,!1,n,r)
return i.items=[s],e.client.deviceType!==gW&&"tv"!==e.client.deviceType&&(i.seeAllAction=Ol(e,t,Aj,n,r,null)),i})}(e,n,a.metricsPageInformation,a.locationTracker),c=function(e,t,n){return Kv.context(yj,()=>{if(o(t))return null
const r=B(t,E$)
if((0,Zv.isNothing)(r)||o(r))return null
const i=new yJ(vx),s=e.loc.string(gx)
Ch(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:gD,id:`${n.getSequenceId()}`,idType:Oq},s)
const a=gl(e,r,t,cH,!0,n.metricsPageInformation,n.locationTracker)
return null===a||0===a.length?null:(i.items=a,a.length<=2&&(i.presentationHints={isLowDensity:!0}),i.title=s,n.addImpressionsToShelf(e,i,"appPrivacy"),Oh(n.locationTracker),_h(n.locationTracker),i.title=null,i)})}(e,n,a)
if(i(s)&&i(c)){t.shelfMapping[wq]=s,i(c)&&(t.shelfMapping[uq]=c)
const l=function(e,t,n,s){return Kv.context(yj,()=>{if(o(t))return null
const a=kl(e,t,!1,Aj,n,s)
if((1===a.length&&a[0].identifier===fD||0===a.length)&&"tv"!==e.client.deviceType)return null
const c=new yJ(JH),l=function(e,t,n,o){return Kv.context("privacyFooterFromData",()=>{const t=function(e,t,n,o){let i
const s=e.loc.string(hD),a={},c=Il(e,n,o)
r(c)?i=e.loc.string(pD):(i=e.loc.string(vP),i=i.replace(Mj,s),r(c)?i=e.loc.string(pD):a[s]=c)
const l=new D5(i,JV)
return new _5(l,a)}(e,0,n,o),s=function(e,t,n,r){if("tv"!==e.client.deviceType)return[]
const o=[],s=Il(e,n,r)
i(s)&&o.push(s)
const a=Cl(e,n,r)
return i(a)&&o.push(a),o}(e,0,n,o)
return new L5(t,s,[].length)})}(e,0,n,s)
return c.items=[l],c})}(e,n,a.metricsPageInformation,a.locationTracker)
i(l)&&(t.shelfMapping[JH]=l)}}const U=new M5,G=new M5,q=new M5,W=new M5,z=new M5,Y=new M5,J=Yf(e,n),K=function(e,t,n,o,i,s,a,c){return Kv.context(yj,()=>{let l
switch(e.client.deviceType){case gW:l=function(e,t,n,o){return Kv.context(HD,()=>{let i
const s=Su(e,t)?Y5:z5,a=Tu(e,s,t,n,!1,!1,o,void 0)
return a.length>0&&(i=new yJ(UG),i.items=a,r(o)||o.addImpressionsToShelf(e,i,Vq)),i})}(e,t,n,o)
break
case"tv":l=function(e,t,n,o,i,s,a){return Kv.context("tvInformationShelf",()=>{let c
const l=Tu(e,J5,t,n,!1,!1,o,a),u=function(e,t,n,r){return Kv.context("productCapabilitiesAsAnnotations",()=>{const o=[],i=cu(e,t,n,r.metricsPageInformation,r.locationTracker)
for(const e of i){const t=e.title,n=e.caption.styledText.rawText
if((null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0){const e=new N5(n),r=new B5(t,[e])
0===r.items_V3.length&&(r.items_V3=bu(0,r)),o.push(r)}}return o})}(e,t,s,o).concat(Tu(e,K5,t,n,!1,!1,o,a)),d=tr(e,SI),f=Tu(e,d?[zl]:[Au],t,n,!1,!0,o,a),h=[]
if(l.length>0){const t=new q5(e.loc.string($D),l,i)
h.push(t)}if(u.length>0){const t=new q5(e.loc.string(FD),u,i)
h.push(t)}if(f.length>0){const t=d?e.loc.string("ProductPage.Section.ExternalPurchases.Title"):e.loc.string("ProductPage.Section.TopInAppPurchases.Title"),n=new q5(t,f,!0)
h.push(n)}return h.length>0&&(td(e)?(c=new yJ("annotationGroup"),c.items=h,c.background={type:BD},r(o)||o.addImpressionsToShelf(e,c,Vq)):(c=new yJ("informationContainer"),c.items=[new W5(h)],r(o)||o.addImpressionsToShelf(e,c,Vq))),c})}(e,t,n,o,c,a,i)
break
default:l=function(e,t,n,o,i,s){return Kv.context(HD,()=>{let a
const c=Su(e,t)?Y5:z5,l=Tu(e,c,t,n,i,!1,o,s)
return l.length>0&&(a=new yJ(UG),a.title=e.loc.string($D),a.items=l,r(o)||o.addImpressionsToShelf(e,a,Vq)),a})}(e,t,n,o,s,i)}return l})}(e,n,C,a,(n,r,o)=>{var s,a,c
if(n===Gl&&(U.setShelfId(Vq,o),U.annotation=r,t.ageRatingAction=new gJ(Vq,null,null,void 0,o,!0),t.ageRatingAction.title=e.loc.string("ProductPage.Banner.AskForException.Review.ViewAgeRatingLink")),n===Nl&&i(t.banner)){i(t.banner.fullProductAction)&&(t.banner.action=t.banner.fullProductAction)
const n=t.banner.action
i(n)&&(td(e)?T(c=n)&&c[PW]===qy&&(null===(s=n.shelfId)||void 0===s?void 0:s.length)>0&&n.shelfId===Vq&&n.indexId===GU&&(n.index=o):function(e){return T(e)&&e[PW]===Vy}(n)&&(null===(a=n.section.shelfId)||void 0===a?void 0:a.length)>0&&n.section.shelfId===Vq&&n.indexId===GU&&(n.index=o))}n===Xl&&(G.setShelfId(Vq,o),G.annotation=r),n===mu&&(q.setShelfId(Vq,o),q.annotation=r),n===Fl&&(W.setShelfId(Vq,o),W.annotation=r),n===Ql&&(z.setShelfId(Vq,o),z.annotation=r),n===tu&&(Y.setShelfId(Vq,o),Y.annotation=r)},J,O,!1)
K&&(t.shelfMapping[Vq]=K)
const Z=function(e,t,n,r){var o
if(!ii(e))return null
let i=ge(t,kO)
if(((0,Jv.isNothing)(i)||0===i.length)&&(i=we(t,hW)),(0,Jv.isNothing)(i)||0===i.length)return null
const s=he(t,kO),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:null!==(o=St(s))&&void 0!==o?o:void 0},c=i.some(e=>e.type!==hW),l=c?"ProductPage.Section.AppEventsAndOffers.Title":"ProductPage.Section.AppEvents.Title",u=e.loc.string(l),d=c?"EventsAndOffers":"Events"
Ch(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:a.recoMetricsData,targetType:yq,id:d,idType:Iq},u)
const f=pi(e,i,t,!c,!1,a,!1,!1,!1,!1);(0,Jv.isSome)(f.nextAppEventPromotionStartDate)&&Ur(f.nextAppEventPromotionStartDate,r)
const h=f.appPromotions
if(0===h.length)return Oh(a.locationTracker),null
const p=Wa(0,h,u)
return n.addImpressionsToShelf(e,p,yq,d,Iq,a.recoMetricsData),Oh(a.locationTracker),_h(a.locationTracker),p}(e,n,a,l)
if(i(Z)&&(t.shelfMapping[tq]=Z),J){const r=function(e,t,n){if(o(t))return null
const r=f(Ke(e,t,mV),wW)
if(r){const t=e.loc.string("APP_STORE_EDITORS_ATTRIBUTION"),o=new i6(r,t),i=new yJ(eH)
return i.items=[o],n.addImpressionsToShelf(e,i,eH),i.background={type:DV,color:Se(Dx)},i}return null}(e,n,a)
r&&(t.shelfMapping[eH]=r)}t.shelfMapping[Sj]=Cu(e,n,a,!1,0,J),t.shelfMapping[wV]=Cu(e,n,a,!0,0,J),t.shelfMapping[HF]=function(e,t,n){return Kv.context(yj,()=>{if("tv"!==e.client.deviceType)return null
if(o(t))return null
const r=new yJ(Hj)
r.isHorizontal=!1
const i=function(e,t){return t?Kv.context("externalProductLinksAsParagraphsFromData",()=>{const n=[],r=Qe(e,t,VL)
if(r){const t=e.loc.string("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",r),o=new qX(t)
e.featureFlags.isEnabled(jJ)&&(o.style=gN),o.alignment=Nq,n.push(o)}return n}):null}(e,t)
return i&&i.length>0&&(r.items=i),td(e)&&(r.background={type:BD}),n.addImpressionsToShelf(e,r,NN),r})}(e,n,a)
const Q=function(e,t,n,r){return Kv.context("capabilitiesShelf",()=>{if(o(t))return null
const i=nt(e,t)
if(o(ce(t,i,kq)))return null
const s=cu(e,t,n,r.metricsPageInformation,r.locationTracker)
if(o(s))return null
const a=new yJ("productCapability")
return a.title=e.loc.string(FD),a.items=s,a.mergeWhenFetched=!0,a.batchGroup=MV,r.addImpressionsToShelf(e,a,"supports"),a})}(e,n,O,a)
Q&&(t.shelfMapping[Aq]=Q)
const X=null!==(p=null==c?void 0:c.webBrowser)&&void 0!==p&&p
if(!X){const r=fe(n,O$)
if(s(r)){const i=function(e,t,n,r){return Kv.context("smallStoryShelf",()=>{var i
if(o(n))return null
const a={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:yq,id:`${r.getSequenceId()}`,idType:Oq},c=e.loc.string(uI)
Ch(e,a,c)
const l=[],u=function(e){return l.push(e),!1}
let d
if(Ju(e)){const t=new zZ(a.pageInformation,a.locationTracker)
d=Wc(e,n,c,null,t,u)}else{const t={metricsLocationTracker:a.locationTracker,metricsPageInformation:a.pageInformation,filterOutMediaCardKinds:new Set([sB])}
d=qc(e,n,xV,c,null,t,u),Array.isArray(d.items)&&(d.items=d.items.filter(e=>!Bt(e)||Vc(0,e.media.kind,xV)))}if(d.isHorizontal=!0,!(null===(i=d.items)||void 0===i?void 0:i.length)&&0===l.length)return null
if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=om.OnShelfWillAppear),s(l)){Oh(r.locationTracker),r.addImpressionsToShelf(e,d,TH),_h(r.locationTracker)
const n=new C3(t.id,l,d.title,!1,void 0,d.contentType,null,null,null,null,null,Hm.SmallStory)
Xa(e,d,n),d.url=Jh(0,n,r)}else Oh(r.locationTracker),r.addImpressionsToShelf(e,d,TH),_h(r.locationTracker)
return d})}(e,n,r.data,a)
i&&(t.shelfMapping[TH]=i)}}const ee={isPreorder:m},te=new M5,ne=function(e,t,n,r){return Kv.context("friendsPlayingShelf",()=>{if(o(t))return null
const i=t.id
if(o(i))return null
if(!et(e,t,LB))return null
if(r.isPreorder)return null
const s=e.loc.string("ProductPage.Section.FriendsPlaying.Title","Playing This Game"),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:yq,id:`${n.getSequenceId()}`,idType:Oq}
Ch(e,a,s)
const c=new yJ(dI)
c.header=io(e,s),c.isHidden=!0,c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new C3(t.id,[],c.title,!1,void 0,null,null,null)
c.url=`${$W}:/${VW.product}/${VW.shelf}/?${tz.isGameCenterPlayerShelf}=true&${tz.id}=${i}&${tz.token}=${Kh(l,n,n.metricsPageInformation)}`,c.batchGroup=MV,n.addImpressionsToShelf(e,c,Cq),Oh(n.locationTracker),_h(n.locationTracker)
const u=new FY(SW)
return ea(e,u,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),c})}(e,n,a,ee)
ne&&(t.shelfMapping[Cq]=ne,te.setShelfId(Cq))
const re=function(e,t,n,r){return Kv.context("achievementsShelf",()=>{if(o(t))return null
if(r.isPreorder)return null
if(!et(e,t,LB))return null
const i=nt(e,t),s=ce(t,i,kq)
if(o(s))return null
const a=e.loc.string("ProductPage.Section.Achievements.Title",bj),c=new yJ(cI)
c.header=io(e,a),c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new C3(t.id,[],c.title,!1,void 0,null,null,null)
return l.sourceLocationTracker=n.locationTracker,l.destinationPageInformation=n.metricsPageInformation,c.url=`${$W}:/${VW.product}/${VW.shelf}/?${tz.isGameCenterAchievementsShelf}=true&${tz.bundleId}=${s}&${tz.token}=${Kh(l,n,n.metricsPageInformation)}`,c.batchGroup=MV,_h(n.locationTracker),c.footerTitle=e.loc.string(z$),c.footerAction=oo({objectGraph:e,target:{achievements:{bundleID:null!=s?s:""}},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker}),c.footerStyle={$kind:sq,bundleID:FN,width:16,height:16},c})}(e,n,a,{isPreorder:m})
if(re&&(t.shelfMapping[Qq]=re),!d&&!X){const r=function(e,t,n){return Kv.context("moreByDeveloperShelf",()=>{if(o(t))return null
const r=Ff(0,pe(e,t,VH)),i=j(t,pH)
let a,c
if(a=fe(t,jF),!a||0===a.data.length)return null
c=a.data
const l=e.loc.string("ProductPage.Section.MoreByDeveloper.TitleTemplate").replace("{developer}",i)
let u
switch(Ch(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:yq,id:`${n.getSequenceId()}`,idType:Oq},l),e.client.deviceType){case vW:case"tv":u=fq
break
default:u=Lq}const d=new yJ(u)
d.title=l
const f=null,h=e.client.isCompanionVisionApp?rm.VisionOSCompatibility:void 0
let p
if((0,Jv.isSome)(a)?p=Zh(e,a,n,Qd(0,u),u,f,h):(0,Jv.isSome)(c)&&(p=Qh(e,c,n,Qd(0,u),u,f,h)),!p)return null
d.items=p.items,d.isHorizontal=!0,c.length<2?d.rowsPerColumn=1:d.rowsPerColumn=2
{const t=new FY(SW)
t.pageUrl=r,t.title=e.loc.string(gH),ea(e,t,t.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),d.seeAllAction=t}if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=om.OnShelfWillAppear),s(p.remainingItems)){Oh(n.locationTracker),n.addImpressionsToShelf(e,d,VH),_h(n.locationTracker)
const o=new C3(t.id,p.remainingItems,d.title,!1,void 0,u,f,null,null,null,null,Hm.MoreByDeveloper)
o.developerUrl=r,Xa(e,d,o),d.url=Jh(0,o,n)}else Oh(n.locationTracker),n.addImpressionsToShelf(e,d,VH),_h(n.locationTracker)
return d})}(e,n,a);(0,Jv.isSome)(r)&&(t.shelfMapping[YH]=r)}if(!d&&!X){const r=function(e,t,n){return Kv.context("similarItemsShelf",()=>{var r
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const i=fe(t,MG)
if(o(i))return null
const a=Yf(e,t),c=a?e.loc.string("Arcade.ProductPage.MoreFromAppleArcade"):e.loc.string("ProductPage.Section.SimilarItems.Title"),l=hq,u=VU
let d,f
switch(Ch(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:l,id:b3.similarItemsShelfId,idType:u},c),e.client.deviceType){case"tv":d=fq,f=!1
break
case vW:d=fq,f=!0
break
default:d=Lq,f=!0}const h=new yJ(d)
h.title=c
const p=St(i),w=Zh(e,i,n,Qd(0,d),d,null,null,p)
if(!w)return null
h.items=w.items
const g=Kt(e,oq),v=Gn(e,"SimilarItems",t.id,""),m=new C3(t.id,i.data,h.title,f,void 0,d,null,null,null,null,null,Hm.SimilarItems)
{const e=Yu(0,t.id,m,n,v)
h.refreshUrl=e}if(h.isHorizontal=!0,i.data.length<2?h.rowsPerColumn=1:h.rowsPerColumn=a?2:3,e.bag.isOnDemandShelfFetchingEnabled&&(h.fetchStrategy=om.OnShelfWillAppear),s(w.remainingItems)||g){Oh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),_h(n.locationTracker)
const o=new C3(t.id,null!==(r=w.remainingItems)&&void 0!==r?r:[],h.title,f,void 0,d,null,null,h.refreshUrl,p,a,Hm.SimilarItems)
if(Xa(e,h,o),h.url=Jh(0,o,n,v),g){const e=new wz(h.url)
e.param(tz.isShelfWithAd,bq),e.param(tz.shelfWithAdPlacementType,oq),e.param(tz.id,t.id),h.url=e.build()}}else Oh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),_h(n.locationTracker)
return h})}(e,n,a);(0,Jv.isSome)(r)&&(t.shelfMapping[hq]=r)}const oe={isForSubscriptions:!0,options:c},ie=await M(Iu(e,n,a,oe))
ie.success&&(0,Jv.isSome)(ie.value)&&(t.shelfMapping[Vj]=ie.value)
const se={isForSubscriptions:!1,options:c},ae=await M(Iu(e,n,a,se))
ae.success&&(0,Jv.isSome)(ae.value)&&(t.shelfMapping[jj]=ae.value)
const le=function(e,t,n,r){return Kv.context("productMediaShelves",()=>{if(o(t))return null
const i=(e.client.deviceType,null),a=(e.client.deviceType,null),c=Ge(e,t),l=hf(e,t,O6.ProductPageScreenshots,i,c,n),u=uf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},a)
let d=null
if(u)for(const e of l)if(e.mediaPlatform.isEqualTo(u.mediaPlatform)){d=e
break}let f=null
if(d){const e=d.mediaPlatform.appPlatform
if(e===lW||e===pq)for(const e of d.items){const t=e.screenshot
if(f=t.width/t.height,f<1)break}}const h=[],p=[]
if(d&&u&&u.videos)for(const n of u.videos){const o=new kz
o.video=n
const i=n.preview.width/n.preview.height,s=null===f||Math.abs(i-f)<.01,a=d.mediaPlatform.isEqualTo(u.mediaPlatform)
s&&a?h.push(o):p.push(n)
const c={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,id:t.id,isAdvert:!!r.metricsPageInformation.adPageInfo&&r.metricsPageInformation.adPageInfo.adIsPresent}
wo(e,n,c)}d&&(d.items=h.concat(d.items))
let w=[],g={}
for(let n=0;n<l.length;n++){const o=l[n],i=`${S2}_${o.mediaPlatform.appPlatform}_${o.mediaPlatform.supplementaryAppPlatforms.join("_")}`
w.push(new p1(IW,i))
const a=new yJ(hI,null,o.items)
a.isHorizontal=!0
let c=!1,u=Ga(0,o.items[0])
for(const e of o.items)if(s(e.screenshot)&&e.screenshot.isPortrait()||s(e.video)&&e.video.preview.isPortrait()){u=Ga(0,e),c=!0
break}a.contentsMetadata={type:"productMedia",platform:o.mediaPlatform,allPlatforms:o.allPlatforms,platformDescription:o.platformDescription,allPlatformsDescription:o.allPlatformsDescription,allPlatformsDescriptionPlacement:o.allPlatformsDescriptionPlacement,hasPortraitMedia:c,expandProductMediaAction:null,viewProductMediaGalleryAction:Ua(e,o,t.id),aspectRatio:u},r.addImpressionsToShelf(e,a,nW),0===n&&"tv"!==e.client.deviceType&&(a.title=e.loc.string(RP)),g[i]=a}return p.length>0&&(g[KH]=function(e,t,n){return Kv.context("videoShelf",()=>{if(!t||0===t.length)return null
let r
return td(e)?(r=new yJ(hI),r.title=e.loc.string(TI),r.items=t.map(e=>{const t=new kz
return t.video=e,t})):(r=new yJ(Lx),r.title=e.loc.string(TI),r.items=t.map(e=>new T2(e,!0,JV,null,null,!0))),r.isHorizontal=!0,n.addImpressionsToShelf(e,r,KH),r})}(e,p,r)),{sectionMappings:w,shelfMapping:g,allProductMedia:l}})}(e,n,I,a)
t.shelfMapping={...t.shelfMapping,...le.shelfMapping}
const ue=function(e){if((0,Jv.isNothing)(e))return null
switch(e){case lW:return Uq
case oW:return Bq
case vW:return vW
case"tv":return oj
case iW:return aH
case gW:return gW
case pq:return null
default:x(e)}}(null===(w=null==le?void 0:le.allProductMedia[0])||void 0===w?void 0:w.mediaPlatform.appPlatform),de=(t.title,function(e,t,n,r){return Kv.context("createActionLinks",()=>(o(t),null))}(0,n))
if(de&&(t.shelfMapping[Xx]=de),(0,Jv.isSome)(ue)&&function(e,t,n){var r
const o=(0,Xv.attributeAsDictionary)(t,`accessibility.${n}`),i=null!==(r=Qe(e,t,kq))&&void 0!==r?r:""
return ki(e)&&!Oi(e,t.id)&&!Ei(e,i)&&(0,Jv.isSome)(o)}(e,n,ue)){const r=_l(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker)
t.shelfMapping[jH]=r
const o=Ll(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker);(0,Jv.isSome)(o)&&(t.shelfMapping[zH]=o)
const i=Ml(e,n,!1,a.metricsPageInformation,a.locationTracker);(0,Jv.isSome)(i)&&(t.shelfMapping[GH]=i)}{const e=J?ZB:QB,n=wl(0,e)
t.shelfMapping[e]=n}!function(e,t,n){if(t&&t.spotlightSection){const e=t.spotlightInAppProductIdentifier
if(e&&t.spotlightSection){const r=n.shelfMapping[t.spotlightSection.shelfId]
if(!r)return
if(r.presentationHints={isInProductPageSpotlight:!0},Xh(0,e,r.items),r.url){const t=new wz(r.url)
t&&(r.url=t.param(tz.offerName,e).build())}}}}(0,c,t)
const ve={},me=ZP,ye=bF,Ae=JN,Te=Zj,be=PD,Pe=Cq,Ie=CD
ve[$U]=U,ve[me]=U,ve[ye]=G,ve[Ae]=q,ve[Te]=W,ve[be]=Y,ve[Pe]=te,ve[Ie]=z,t.badges&&Rl(e,t.badges,ve,a),null!=t.shelfMapping[lq]&&Rl(e,od(e,t.shelfMapping[lq]),ve,a),ed(e,t,le.sectionMappings,J,c)}(e,b,p,y,n,C,l),b.pageRefreshPolicy=Gr(e,C),b.isIncomplete=!1,b.alwaysAllowReviews=da(e,p),b.canonicalURL=j(p,eW),l&&(b.shareAction=null,b.titleOfferDisplayProperties=null,b.expandedOfferDetails=null,b.lockup.offerDisplayProperties=null,b.banner=null),I&&(b.shareAction=null),b})}function Xu(e,t,n,a,c,l,d,h=!1){return Kv.context("createProductPageSidePack",()=>{var h,p
let w
i(a)&&(w=a.clientIdentifierOverride)
const g=t.id,v=j(t,AW),m=H(t,sG),y=ua(e,t),T=Yf(e,t),b={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,id:g,isAdvert:!!n.metricsPageInformation.adPageInfo&&n.metricsPageInformation.adPageInfo.adIsPresent},S=new wJ,P=new xY,I=V(t,Sq)
I&&i(n)&&i(n.metricsPageInformation)&&(n.metricsPageInformation.offerType=iH,n.metricsPageInformation.offerReleaseDate=yr(0,t)),P.adamId=g,P.bundleId=Qe(e,t,kq),S.uber=function(e,t,n){af(e,t,n)
const r=Yf(e,t),s=function(e,t){return t&&!0}(0,r)?Zq:ZT,a=new E2(s)
if(a.artwork=Mf(e,t,{supportsArcade:r}),a.compactArtwork=Mf(e,t,{supportsArcade:r,prefersCompactVariant:!0}),a.video=xf(e,t,O6.Uber),i(a.video)&&(a.video.playbackId=function(e){return`ProductPage.${e.id}.productUberVideoPlaybackId`}(t)),r&&o(a.video)&&o(a.artwork)){const r=(e.client.deviceType,null),o=Ge(e,t),i=hf(e,t,O6.ProductPageScreenshots,r,o,n)
if(i.length>0&&i[0].items.length>0){const e=i[0].items[0]
a.video=e.video,a.artwork=e.screenshot}}return o(a.compactArtwork)&&(a.compactArtwork=a.artwork),a.isValidUber(!1,!1)?a:null}(e,t,w)
const C=S.uber&&S.uber.style===Zq
P.icon=rf(e,t,{useCase:O6.ProductPageIcon,withJoeColorPlaceholder:void 0},w),S.title=v,S.isIncomplete=!0,P.title=v,P.subtitle=Sd(e,t),P.developerTagline=Qe(e,t,NH),S.regularPriceFormatted=j(t,"regularPriceFormatted"),S.logoArtwork=function(e,t){let n=null,r=null
if("tv"!==e.client.deviceType)return null
n=LT,r="bb"
const o=Ke(e,t,n)
return i(o)&&i("bb")?Xd(e,o,{cropCode:"bb",useCase:O6.Default,withJoeColorPlaceholder:!0}):null}(e,t),S.navigationBarIconArtwork=null,y||(P.rating=q(t,xM)),P.children=Td(e,t,{metricsOptions:b,artworkUseCase:O6.LockupIconSmall})
const k=function(e,t,n,r,o,a,c){var l
const d=wr(e,t),f=Qe(e,t,kq),h=V(t,Sq),p=vr(e,d,t,h,!1,Th(e,t,n,null==a?void 0:a.clientIdentifierOverride),o,cH,c,null==a?void 0:a.webBrowser)
if(null!==(l=null==a?void 0:a.webBrowser)&&void 0!==l&&l&&(null==a?void 0:a.webBrowserFlowType)!==qm.PurchaseAndOpen)return{buttonAction:new R2(t.id),offerAction:p}
let w
if(s(p)){i(a)&&(p.lineItem=a.iAdLineItem)
const n=s(a)?a.clientIdentifierOverride:null
if(w=br(e,p,t,h,o,cH,n),i(a)&&s(w)){const n=rt(e),r=it(e,t,Ge(e,t),Z$,n),i=s(r)&&!u(a.isCppDeepLinkDisabled),c=s(a.externalDeepLinkUrl)
let l;(i||c)&&(l=i?r:a.externalDeepLinkUrl,w=oa(e,w,p.adamId,f,l,!1,o))}}return{buttonAction:w,offerAction:p}}(e,t,P.icon,0,b,a,l)
if(P.buttonAction=k.buttonAction,I){let n
S.theme=cL
let r=null
if(T)n="",r=e.loc.uppercased(ih(e,t,e.loc.string(_D)))
else if(n=e.loc.string(_D),i(k.offerAction.expectedReleaseDate)){const n=Ix,o=e.loc.formatDate(n,k.offerAction.expectedReleaseDate),i=e.loc.string("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(OD,o)
r=ih(e,t,i)}S.expandedOfferDetails=new I2(n,r)}let O,E
C&&T&&(S.theme=mq),C&&T?(O=mq,E=rL):(O=xj,E=cH)
const R=WE,D=xj,_=T?VB:rW,L=null!==(h=null==a?void 0:a.webBrowser)&&void 0!==h&&h
let M
switch(null==a?void 0:a.webBrowserFlowType){case qm.SelectionOnly:M=!0
break
case qm.PurchaseAndOpen:M=!1
break
default:M=!0}const x=L&&M?sP:cH
let $
P.offerDisplayProperties=xr(e,k.offerAction,_,t,I,0,O,E,null,null,x,!1,!1),S.titleOfferDisplayProperties=xr(e,k.offerAction,_,t,I,0,D,R,null,null,x),L&&(P.offerDisplayProperties.ignoresContentRestrictions=!0,S.titleOfferDisplayProperties.ignoresContentRestrictions=!0)
const F=pe(e,t,VH),N=Ff(0,F)
i(N)&&($=new FY(SW),$.title=j(t,pH),$.pageUrl=N,Xs(e,$,{targetType:TW,id:F.id,actionType:bW,pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker})),S.developerAction=$,S.shareAction=Ho(e,t,n.metricsPageInformation,n.locationTracker,w),P.tertiaryTitle=Pd(e,t),P.tertiaryTitleAction=Id(e,t),P.tertiaryTitleArtwork=null
const B={appPlatforms:gf(e,t),clientIdentifierOverride:w,offerButtonShouldBeDisabled:!1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker,webBrowser:null==a?void 0:a.webBrowser,webBrowserFlowType:null==a?void 0:a.webBrowserFlowType},U=function(e,t,n){let r=null,i=null,a=null,c=null,l=null,u=!1,d=null
const f=et(e,t,Qy),h=et(e,t,Xy)
if((f||h)&&(r=e.loc.string("ProductPage.Banner.UpdateRequired.iOS"),n.offerButtonShouldBeDisabled=!0),null===r&&at(e,t,rm.SADWatchApps)&&(r=e.loc.string("OFFER_WATCH_ONLY_BANNER"),n.offerButtonShouldBeDisabled=!0),null===r&&!zd(e,t)){if(r=e.loc.string(IP),td(e)){const t=new gJ(Vq)
t.title=e.loc.string(UU),t.indexId=GU,a=t}else{const t=new mJ(IW,Vq),n=new vJ(t)
n.title=e.loc.string(UU),n.indexId=GU,a=n}r=e.loc.string(KN).replace(ZN,a.title),n.offerButtonShouldBeDisabled=!0}if(null===r&&at(e,t,rm.UnsupportedSystemDeletableApps|rm.LegacyApps)&&(r=e.loc.string(CP),n.offerButtonShouldBeDisabled=!0),at(e,t,rm.MinimumOSRequirement)){const n=If(e,t,e.appleSilicon.isSupportEnabled)
switch(e.client.deviceType){case vW:r=e.loc.string("UNSUPPORTED_MACOS_VERSION").replace(ej,n)
break
case lW:case oW:r=e.loc.string("UNSUPPORTED_IOS_VERSION").replace(ej,n)
break
case"tv":r=e.loc.string("UNSUPPORTED_TVOS_VERSION").replace(ej,n)
break
case gW:const o=Qe(e,t,eN)
r=e.loc.string(kP).replace(ej,o)
break
case iW:r=e.loc.string("UNSUPPORTED_VISIONOS_VERSION").replace(ej,n)
break
default:r=e.loc.string(CP)}if(e.client.isPhone&&et(e,t,FG)){const n=Qe(e,t,eN)
r=e.loc.string(kP).replace(ej,n)}}if(at(e,t,rm.UnsupportedPlatform))if(n.offerButtonShouldBeDisabled=!0,r=e.loc.string(IP),td(e)){const t=new gJ(Vq)
t.title=e.loc.string(UU),t.indexId=GU,a=t,r=e.loc.string(KN).replace(ZN,t.title)}else{const t=new mJ(IW,Vq),n=new vJ(t)
n.title=e.loc.string(UU),n.indexId=GU,a=n,r=e.loc.string(KN).replace(ZN,n.title)}if(at(e,t,rm.MacOSRosetta)){if(td(e)){const t=new gJ(Vq)
t.title=e.loc.string(UU),t.indexId=GU,a=t}else{const t=new mJ(IW,Vq),n=new vJ(t)
n.title=e.loc.string(UU),n.indexId=GU,a=n}r=e.loc.string(KN).replace(ZN,a.title)}const p=H(t,Sq)
Qf(e,t)&&(r=p?e.loc.string("ProductPage.WatchOS.PreOrderRequiresiPhone"):e.loc.string("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),n.offerButtonShouldBeDisabled=!0)
const w=Qe(e,t,eN)
if(null===r&&n.clientIdentifierOverride===hY&&nh(e,w)&&(r=e.loc.string("ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace(ej,w)),xe(e,t,aH)&&!e.client.isCompanionVisionApp){const t=e.loc.string("BANNER_VISION_ONLY_APP_LEARN_MORE_LINK")
i=function(e,t,n,r){const i=e.bag.visionOnlyAppLearnMoreEditorialItemId
if(o(i))return null
const s=new FY(Eq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Xs(e,s,{id:lU,targetType:jq,actionType:bW,pageInformation:n,locationTracker:r}),s}(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){return t&&n?e.loc.string("BANNER_VISION_ONLY_APP_WITH_LINK").replace(Mj,t):e.loc.string("BANNER_VISION_ONLY_APP_NO_LINK")}(e,t,i),a=null,c=Ot(e,"systemimage://visionpro"),l=Se(aN),u=!0}Dr(e,t)&&!Lr(e)?(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.VisionDeviceRequired")):e.client.isCompanionVisionApp&&!Dr(e,t)&&(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.RemoteDownloadUnavailable"))
const g=er(e,t),v=tr(e,"product-page-banner")
if((null===r||!n.offerButtonShouldBeDisabled)&&g&&v){const t=e.loc.string("ProductPage.ExternalPurchasesBanner.LearnMore")
i=nr(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){if(t&&n){if((0,Zv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const n=`ProductPage.ExternalPurchasesBanner.WithLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(n).replace(Mj,t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.WithLink").replace(Mj,t)}if((0,Zv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const t=`ProductPage.ExternalPurchasesBanner.NoLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.NoLink")}(e,t,i),a=null,e.bag.externalPurchasesIncludeProductPageBannerIcon?"secondaryInfoCircle"===e.bag.externalPurchasesProductPageBannerIconVariant?(c=Ot(e,"systemimage://info.circle"),l=Se(aN)):(c=Ot(e,mx),l=Se("systemRed")):(c=null,l=null),u=!0}if(null!==r&&n.offerButtonShouldBeDisabled||!(0,Zv.isSome)(n.webBrowser)||!n.webBrowser||n.webBrowserFlowType!==qm.PurchaseAndOpen||(r=e.loc.string("ProductPage.Banner.DefaultBrowser.Message"),c=Ot(e,"systemimage://gear"),l=Se(aN),d=yx),(null==r?void 0:r.length)>0)return new C2(r,null,i,a,c,l,u,d)
if(!n.offerButtonShouldBeDisabled){const n=Pf(e,t)
if(s(n))return function(e,t){const n=e.loc.string("ProductPage.Banner.ExternalBrowser.Message")
let r=n,o=n,i=n,s=n,a=n
return[YG].includes(e.client.buildType)&&(r+="\n(Internal: unknown)",o+="\n(Internal: buyOrGet)",i+="\n(Internal: redownload)",s+="\n(Internal: update)",a+="\n(Internal: open)"),new k2(Dl(Ax,t,r),Dl(Ax,t,o),Dl(Ax,t,i),Dl(lx,t,s),Dl("launch",t,a))}(e,n)}return null}(e,t,B)
A(p=U)&&"Banner"===p[PW]?S.banner=U:function(e){return A(e)&&"AppStateBanner"===e[PW]}(U)&&(S.appStateBanner=U)
const G=P.offerDisplayProperties
B.offerButtonShouldBeDisabled&&s(G)&&(P.offerDisplayProperties=G.newOfferDisplayPropertiesChangingAppearance(!1,rG))
const W=!at(e,t,rm.MinimumOSRequirement)
if(!m&&!B.offerButtonShouldBeDisabled&&W){const n=function(e,t){return Kv.context("updateOfferDataFromData",()=>{const n=Ze(e,t,Fj)
if(0===n.length)return null
for(const e of n)if(f(e,jV)===lx)return e
return null})}(e,t)
S.updateBuyParams=f(n,Ej),S.externalVersionIdentifier=tt(e,t,LD)}if(T&&(P.editorialTagline=e.loc.string("APPLE_ARCADE")),S.lockup=P,S.appPlatforms=gf(e,t),i(c)){const n=ri(e,c,t,!1,!1,Jq,mq,!0,b,!0,!1,null,!1,!1)
if(i(c)&&function(e){return A(e)&&function(e){return(0,Jv.isSome)(jX[e])}(e.$kind)}(n)){const r=n
S.appPromotionDetailPageFlowAction=oi(e,c,t,r,b,dH,!1,d)}}!function(e,t,n,i,s,a){if(t.shelfMapping[Yq]=new yJ(eI,"productTopLockup"),"tv"!==e.client.deviceType){const s={developerAction:t.developerAction}
t.shelfMapping[Mq]=function(e,t,n,i){return Kv.context("descriptionShelf",()=>{if(o(t))return null
const s=new yJ("productDescription"),a=function(e,t){return t?Kv.context("productDescriptionLinksFromData",()=>{const n=[],r=Qe(e,t,VL)
if(r){const t=new JY(r,!1),o=e.loc.string("PRODUCT_DEVELOPER_WEBSITE")
n.push(new Q5(o,t,X5))}const o=Qe(e,t,jL)
if(o){const t=new JY(o,!1),r=e.loc.string("DEVELOPER_SUPPORT")
n.push(new Q5(r,t,n6))}return n}):null}(e,t),c=function(e,t,n,r){const o=ge(t,lE),i=[]
for(const t of o){const o=(0,Xv.attributeAsString)(t,AW)
if((0,Jv.isSome)(o)){let s=null
switch(t.type){case BN:s=(0,Xv.attributeAsString)(t,eW)
break
case _V:const n=f(t,CG)
n&&(s=Ni(e,n))}if((0,Jv.isNothing)(s))continue
const a=e.required(O3).fetchFlowPage(s),c=new FY(a)
c.pageUrl=s,c.title=o
const l=new w5(o,c),u={targetType:gj,pageInformation:n,locationTracker:r,recoMetricsData:null}
Nh(e,l,Hh(e,t,o,u))
const d=Ks(e,t,u)
d.targetType=u.targetType,Xs(e,c,d),i.push(l),_h(u.locationTracker)}}return i}(e,t,n.metricsPageInformation,n.locationTracker),l=function(e,t,n=null){return Kv.context("descriptionFromData",()=>{r(n)&&(n=Ge(e,t))
let o=function(e,t,n){return it(e,t,n,nT)}(e,t,n)
o||(o="")
let i=Qe(e,t,BG)
i||(i="")
let s=""
o.length>0&&i.length>0&&(s="\n\n")
const a=o+s+i
if(a.length>0){const e=new qX(a)
return e.isCollapsed=!0,e}return null})}(e,t)
if(null===l)return null
const u=new Z5(l,a,c,i.developerAction)
return s.items=[u],n.addImpressionsToShelf(e,s,Mq),s})}(e,n,i,s)}{const r={useInlineUberStyle:t.uber&&t.uber.style===Zq}
t.shelfMapping[lq]=function(e,t,n,r){if(td(e)){const r=new yJ("productBadge"),o=Hu(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation})
return r.items=o,r.isHorizontal=!0,n.addImpressionsToShelf(e,r,lq),r}{const o=new yJ(lq),i=Hu(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation}),s=!r.useInlineUberStyle,a=!1,c=r.useInlineUberStyle,l=new a6(i,s,a,c,"justified")
return o.items=[l],o.isHorizontal=!0,n.addImpressionsToShelf(e,o,lq),o}}(e,n,i,r)}ed(e,t,[],Yf(e,n),s)}(e,S,t,n,a),S.uber&&(S.presentationOptions.push(kN),S.presentationOptions.push(lM)),S.alwaysAllowReviews=da(e,t)
const z=null==a?void 0:a.iAdDismissAdActionMetrics
if((0,Jv.isSome)(z)){const e=new QY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),f(z.invocation),f(z.purchaseType),f(z.reportingDestination)),t=new PK(e)
S.pageDisappearedAction=t
const n=new QY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),Wb,f(z.purchaseType),f(z.reportingDestination))
S.lockup.buttonAction=zt(0,S.lockup.buttonAction,n)}return S})}function ed(e,t,n,r,o){const i=function(e,t,r){return e.map(e=>e.shelfId===nW&&r?n:e.shelfId===nW?n[0]?[n[0]]:[]:[e]).reduce((e,t)=>e.concat(t)).map(e=>e.createShelfIdList()).reduce((e,t)=>e.concat(t))},a=Fa(0,!0,e.host.platform,r,!1,!1,o),c=Fa(0,!1,e.host.platform,r,!1,!1,o),l=Fa(0,!0,e.host.platform,r,!0,!1,o),u=Fa(0,!1,e.host.platform,r,!0,!1,o),d=Fa(0,!1,e.host.platform,r,!1,!0,o),f=Fa(0,!1,e.host.platform,r,!0,!0,o)
t.shelfOrderings.purchasedOrdering=i(a,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia=i(a,0,!0),t.shelfOrderings[O2]=i(c,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia=i(c,0,!0),t.shelfOrderings.purchasedOrdering_Compact=i(l,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia_Compact=i(l,0,!0),t.shelfOrderings.notPurchasedOrdering_Compact=i(u,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia_Compact=i(u,0,!0),t.shelfOrderings.downloadingOrdering=i(d,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia=i(d,0,!0),t.shelfOrderings.downloadingOrdering_Compact=i(f,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia_Compact=i(f,0,!0),t.defaultShelfOrdering=O2
for(const e of Object.keys(t.shelfMapping))s(t.shelfMapping[e])&&(t.shelfMapping[e].id=e)}function td(e){return e.featureFlags.isEnabled(MJ)||!0}async function nd(e,t,n={},r={},o=null,i=!1,s=!1){const a=Yf(e,yt(e,t)),c=await Qu(e,t,n,r,o,s)
return td(e)&&!i?c:ja(e,c,a,n)}function rd(e,t,n={}){if(!e.client.isSidepackingEnabled)return null
const o=Yf(e,t),i=function(e,t,n){return Kv.context("createProductPageSidePackFromResponse",()=>{if(!e.client.isSidepackingEnabled)return null
const o=function(e,t,n){const r=j(t,eW),o=j(t,AW),i=j(t,pH)
let s=null
n&&(s=n.iAdClickFields)
const a=Gn(e,NV,t.id,`${i}_${o}`,s)
return a.pageUrl=r,new b3(a,{rootPosition:0,locationStack:[]})}(e,t,n),i=Xu(e,t,o,n)
return function(e,t,n){r(n)||(t.pageMetrics.addData(Kn(e,n,void 0),[Im.PageInvocationPoint.backButton]),r(t.pageMetrics.pageFields)&&(t.pageMetrics.pageFields={}))}(e,i,o.metricsPageInformation),i})}(e,t,n)
return td(e)?i:ja(e,i,o,n)}function od(e,t){if(o(null==t?void 0:t.items))return[]
if(td(e))return t.items
{const e=t.items
return e.length>0?e[0].badges:[]}}function id(e,t,n){const r=kn(0,t),o=sd(e,t,r,n,m6[n],!1),i=sd(e,t,r,n,y6[n],!0)
return o.rtlArtwork=i.rtlArtwork,o.rtlArtworkData=i.rtlArtworkData,o.rtlVideo=i.rtlVideo,o.rtlBackgroundColor=i.rtlBackgroundColor,o.rtlTextColorOverride=i.rtlTextColorOverride,o}function sd(e,t,n,r,o,a){let c={}
for(const l of o){if(i(n)&&(c=cd(e,n,r,l,a)||ad(e,n,r,l,a),s(c)))break
if(c=cd(e,t,r,l,a)||ad(e,t,r,l,a),s(c))break}return(0,Zv.isNothing)(c)&&(c={}),c}function ad(e,t,n,o,i){let a=null,c=null,l=null
const u=`editorialArtwork.${o}`,d=nt(e,t)
if(r(d))return null
if(c=B(t,u)||se(t,d,u),!s(c))return null
if(a=Xd(e,c,{withJoeColorPlaceholder:!0,useCase:ld(n),cropCode:ud(n,o,i)}),r(a))return null
l=a.backgroundColor
const f=fd(0,c,a)
return i?{rtlArtwork:a,rtlArtworkData:c,rtlBackgroundColor:l,rtlTextColorOverride:f}:{artwork:a,artworkData:c,backgroundColor:l,textColorOverride:f}}function cd(e,t,n,r,i){let a=null,c=null,l=null,u=null
const d=`editorialVideo.${r}`,h=nt(e,t)
if((0,Zv.isNothing)(h))return null
if(l=B(t,d)||se(t,h,d),o(l))return null
const w=p(l,zG)
s(w)&&(c=Xd(e,w,{withJoeColorPlaceholder:!0,useCase:ld(n),cropCode:"sr"})),s(c)&&(c.crop="sr",u=c.backgroundColor)
const g=f(l,dq)
if(s(c)&&(0,Zv.isSome)(g)&&g.length>0&&(a=new Cz(g,c,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:hd(0,n),autoPlayPlaybackControls:{}}),a.editorialMediaFlavor=r,a.editorialMediaPlacement=n),(0,Zv.isNothing)(w)||(0,Zv.isNothing)(c))return null
const v=fd(0,w,c)
return i?{rtlVideo:a,rtlArtwork:c,rtlArtworkData:w,rtlBackgroundColor:u,rtlTextColorOverride:v}:{video:a,artwork:c,artworkData:w,backgroundColor:u,textColorOverride:v}}function ld(e){switch(e){case jm.Hero:return O6.GroupingHero
case jm.LargeBreakout:return O6.ArcadeLargeBreakout
case jm.StoryCard:return O6.TodayCardMedia
case jm.StoryDetail:case jm.StoryDetailLandscape:return O6.ArticleImage
case jm.Search:return O6.SearchEditorialResult
default:return O6.Default}}function ud(e,t,n){switch(e){case jm.Hero:switch(t){case Gm.HeroStatic16x9:if(!n)return"gd"
break
case Gm.HeroStaticRTL16x9:if(n)return"gg"
break
case Gm.StoryCenteredStatic16x9:return n?"gh":"ge"
case Gm.UniversalAStatic16x9:return n?"gj":"gi"}break
case jm.LargeBreakout:switch(t){case Gm.StoryCenteredStatic16x9:return n?"gk":"gf"
case Gm.UniversalAStatic16x9:return n?"gl":"gm"}break
case jm.StoryCard:case jm.StoryDetail:case jm.StoryDetailLandscape:case jm.Search:if(t===Gm.UniversalAStatic16x9)return"gn"
break
case jm.Brick:if(t===Gm.SearchCategoryBrick)return ST}return"sr"}function dd(e,t,n=!1){if((0,Zv.isNothing)(t))return null
const r=n?t.rtlTextColorOverride:t.textColorOverride,o=n?t.rtlBackgroundColor:t.backgroundColor
return(0,Zv.isSome)(r)?Ie(r,SY):(0,Zv.isSome)(o)?be(o):null}function fd(e,t,n){const r=null==n?void 0:n.textColor
if((0,Zv.isNothing)(r))return null
const o=u(t,"useCustomTextColor"),i=Ie(r,bY)||Ie(r,SY)
return o&&i?r:null}function hd(e,t){switch(t){case jm.Hero:case jm.StoryDetail:case jm.StoryDetailLandscape:return{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}
default:return{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}}}function pd(e,t,n){switch(n){case _B:case DB:case bN:case TN:return id(e,t,jm.EditorialLockup)
case"BrickSmall":case"BrickMedium":case"BrickLarge":return id(e,t,jm.Brick)
case sM:case"StorySmall":return id(e,t,jm.StoryCard)
case fj:return id(e,t,jm.Hero)
case IE:return id(e,t,jm.LargeBreakout)
default:return{}}}function wd(e,t,n){const r=function(e,t,n){const r=function(e,t){let n=null
switch(t.type){case sW:case aq:case bU:n=we(t,SU,!0)||we(t,$H,!0)||we(t,mW,!0)
break
case _V:n=w(t.meta,rb)
break
default:n=null}return n}(0,t)
return o(r)?null:Nd(e,r,n)}(e,t,{lockupOptions:n})
if(!o(r))return null==r?void 0:r.map(e=>e.icon)}function gd(e,t,n){const r=Cn(e,t)
return o(r)?null:Od(e,r,n)}function vd(e,t,n,r,o){if((0,Jv.isNothing)(t)||0===t.length||r.has(t))return null
const i=new A6(_F)
return i.moduleType=T_,(0,Jv.isSome)(t)&&(i.labelText=t,Bh(e,i,qh(o,T_,i.labelText,dW))),r.add(t),[i]}function md(e,t,n){return t===rq?n?pW:tG:n?VB:rW}function yd(e,t,n,s,a){var c,u,d,f,h,w,g,v,m,y,A
if(o(t))return
if(n.showMetadataInformationInLockup=e.bag.isLLMSearchTagsEnabled||e.client.isPad,!e.client.isPhone)return
const T=p(t,PV),b=null!==(u=null===(c=null==T?void 0:T.displayStyle)||void 0===c?void 0:c.metadataRibbon)&&void 0!==u?u:null===(d=null==s?void 0:s.displayStyle)||void 0===d?void 0:d.metadataRibbon
let S=[]
S=e.bag.isLLMSearchTagsEnabled?null!==(g=null!==(h=null===(f=null==T?void 0:T.displayStyle)||void 0===f?void 0:f.llmRibbon)&&void 0!==h?h:null===(w=null==T?void 0:T.displayStyle)||void 0===w?void 0:w.metadataRibbon)&&void 0!==g?g:null===(v=null==s?void 0:s.displayStyle)||void 0===v?void 0:v.metadataRibbon:null!==(y=null===(m=null==T?void 0:T.displayStyle)||void 0===m?void 0:m.metadataRibbon)&&void 0!==y?y:null===(A=null==s?void 0:s.displayStyle)||void 0===A?void 0:A.metadataRibbon
const P=function(e,t,n,s,a,c=T6){if(o(s))return[]
const l=[],u=new Set
for(const d of s)if(!o(d))for(const o of d){const s=c[o]
if(r(s))continue
const d=s(e,t,n,u,a.metricsOptions)
if(i(d)){l.push(...d)
break}}return l}(e,t,n,b,a),I=function(e,t,n,s,a,c=T6){if(o(s))return[]
const u=l(t.meta,"associations.tags.data"),d=[]
let f=0,h=0
const w=new Set
for(const l of s){const s=Array.isArray(l)?l:[l]
if(!o(s))for(const o of s){const s=o===X$
let l,g=t,v=""
if(o===T_){const n=p(t,PV);(0,Jv.isSome)(null==n?void 0:n.rankedSecondaryGenreShortDisplayNames)&&(v=null==n?void 0:n.rankedSecondaryGenreShortDisplayNames[h]),(0,Jv.isSome)(v)?(l=vd(e,v,0,w,a.metricsOptions),h+=1):l=[]}else{const i=c[o]
if(r(i))continue
g=s?u[f]:t,l=i(e,g,n,w,a.metricsOptions),f=s?f+1:f}if(i(l)){d.push(...l)
for(const e of l)(0,Jv.isSome)(e.impressionMetrics)&&_h(a.metricsOptions.locationTracker)
break}}}return d}(e,t,n,S,a)
n.metadataRibbonItems=P,n.searchTagRibbonItems=I,n.shouldEvenlyDistributeRibbonItems=!e.bag.isLLMSearchTagsEnabled}function Ad(e,t,n,r,o,i){t&&Kv.context("copyDataIntoLockup",()=>{var s,a,c,u,d,h
const p=H(t,Sq)
if(r.isContainedInPreorderExclusiveShelf&&!p)return null
const w=null!==(s=null==r?void 0:r.attributePlatformOverride)&&void 0!==s?s:rt(e),g=Ge(e,t)
n.productVariantID=Ve(g),r.metricsOptions.productVariantData=g,n.adamId=t.id
const v=Qe(e,t,kq,null==r?void 0:r.attributePlatformOverride)
n.bundleId=v,n.decorations=[]
let m=null
r&&r.clientIdentifierOverride&&(m=r.clientIdentifierOverride),n.icon=rf(e,t,{useCase:r.artworkUseCase,withJoeColorPlaceholder:r.useJoeColorIconPlaceholder,joeColorPlaceholderSelectionLogic:r.joeColorPlaceholderSelectionLogic,overrideTextColorKey:r.overrideArtworkTextColorKey},m,g,r.attributePlatformOverride),r&&r.titleObjectPath?n.title=Qe(e,t,r.titleObjectPath,null==r?void 0:r.attributePlatformOverride):n.title=j(t,AW),n.useAdsLocale=r.metricsOptions.isAdvert&&(0,Zv.isSome)(e.bag.adsOverrideLanguage)
const y=Yf(e,t,null==r?void 0:r.attributePlatformOverride)
y&&!r.shouldHideArcadeHeader&&(n.heading=r.metricsOptions.isAdvert?e.adsLoc.string(dR):e.loc.string(dR)),r.shouldShowFriendsPlayingShowcase&&n.decorations.push("showcaseFriendsPlaying")
const A=!y&&!p&&(null===(a=r.isMultilineTertiaryTitleAllowed)||void 0===a||a)
if(r.isSubtitleHidden||function(e,t,n){return Kv.context("isBadgeMultilineFromData",()=>{if(!n)return!1
if(!Sf(0,t,!1))return!1
if(Cd(e,t))return!1
const r=gf(e,t)
return kf(r,oW)||kf(r,lW)})}(e,t,A)||(n.subtitle=Sd(e,t,r)),n.tertiaryTitle=Pd(e,t,A,r.hideCompatibilityBadge),n.tertiaryTitleAction=Id(e,t),n.tertiaryTitleArtwork=null,n.developerTagline=Qe(e,t,NH,null==r?void 0:r.attributePlatformOverride),n.editorialTagline=Jf(e,t,$j,!1,null==r?void 0:r.attributePlatformOverride),n.editorialDescription=Jf(e,t,wW,!1,null==r?void 0:r.attributePlatformOverride),n.shortEditorialDescription=Jf(e,t,cV,!1,null==r?void 0:r.attributePlatformOverride),n.ageRating=or(0,t,!0),n.productDescription=Qe(e,t,BG,null==r?void 0:r.attributePlatformOverride),null!==(c=null==r?void 0:r.shouldShowSupportedPlatformLabel)&&void 0!==c&&c&&function(e,t,n,r){const o=gf(e,t)
switch(n.tertiaryTitleIcons=o.map(e=>Xf(e)),n.tertiaryTitleIcons.length){case 1:const t=Gf(e,o[0])
n.tertiaryTitle=e.loc.string("Bundles.ProductPage.OnlyAvailable.Message").replace("@@platform@@",t),n.tertiaryIconPlacement=uW
break
case 2:const r=Gf(e,o[0]),i=Gf(e,o[1])
n.tertiaryTitle=e.loc.string("Bundles.ProductPage.AvailableOnTwo.Message").replace("@@platform1@@",r).replace("@@platform2@@",i),n.tertiaryIconPlacement=uW
break
case 6:n.tertiaryTitleIcons.includes(zF)?(n.tertiaryTitle=e.loc.string(tS),n.tertiaryIconPlacement=aV):(n.tertiaryTitleIcons=[],n.tertiaryTitle=e.loc.string(eS))
break
case 7:n.tertiaryTitleIcons=[],n.tertiaryTitle=e.loc.string(eS)
break
default:n.tertiaryTitle=e.loc.string(tS),n.tertiaryIconPlacement=aV}}(e,t,n),!ua(e,t)&&(q(t,MM)>0||!r||!r.hideZeroRatings)){n.rating=q(t,xM)
const o=q(t,MM),i=r.metricsOptions.isAdvert?e.bag.adsOverrideLanguage:null
n.ratingCount=e.loc.formattedCountForPreferredLocale(e,o,i)}const T=Ks(e,t,r.metricsOptions,r.metricsClickOptions)
Ch(e,T,n.title)
const b=wr(e,t,null==r?void 0:r.attributePlatformOverride),P=null!==(u=null==r?void 0:r.includeBetaApps)&&void 0!==u&&u,I=Th(e,t,n.icon,m),C=S(T),k=vr(e,b,t,p,P,I,C,Gq,null==r?void 0:r.referrerData),O=l(b,fR)
let E=br(e,k,t,p,C,Gq,m,r.shouldNavigateToProductPage)
const R=it(e,t,g,Z$,w),D=Ut(0,t),_=!D||jt(t),L=_&&(null==R?void 0:R.length)>0,M=(null===(d=null==r?void 0:r.externalDeepLinkUrl)||void 0===d?void 0:d.length)>0
let x;(L||M)&&(x=L?R:r.externalDeepLinkUrl),(0,Zv.isSome)(x)&&(E=oa(e,E,k.adamId,v,x,P,C),(null===(h=r.crossLinkSubtitle)||void 0===h?void 0:h.length)>0&&(n.crossLinkTitle=e.loc.uppercased(j(t,AW)),n.crossLinkSubtitle=r.crossLinkSubtitle)),n.buttonAction=E,n.includeBetaApps=P,n.developerName=j(t,pH),(0,Zv.isNothing)(n.developerName)&&(n.developerName=j(t,Xb)),n.children=Td(e,t,r),(0,Zv.isSome)(i)&&i(),Oh(r.metricsOptions.locationTracker)
const $=Vo(e,t,m)
if($){const t=new xW,r=S(T)
r.actionType=fB,r.targetType=cW,Xs(e,t,r)
const o=new LY
o.shareAction=t,o.shareSheetData=$,n.contextMenuData=o}const F=null!=o?o:Kd(e,t)
let N=!1
F&&(N=!(Ar(0,wr(e,F))>0))
const B=md(0,t.type,y)
n.offerDisplayProperties=r?xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,r.offerStyle,r.offerEnvironment,O[0],N,Gq,r.shouldNavigateToProductPage,r.metricsOptions.isAdvert,0,r.parentAppData,r.isBuyDisallowed):xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,null,null,O[0],N,Gq),r&&r.skipDefaultClickAction||(n.clickAction=Vd(e,t,T,{clientIdentifierOverride:m,productVariantData:g,isCppDeepLinkEligible:_})),r&&r.ordinal&&(n.ordinal=r.ordinal)
const U=Ke(e,t,kG,null==r?void 0:r.attributePlatformOverride)
if(U){const e=f(U,$M),t=e&&e===FM
n.isEditorsChoice=t}D||(n.flowPreviewActionsConfiguration=ia(e,t,!1,m,n.clickAction,r.metricsOptions,T,r.externalDeepLinkUrl,n.subtitle,n.title))
const G=jh(e,t,n,I,r.metricsOptions,r.canDisplayArcadeOfferButton)
Nh(e,n,G)})}function Td(e,t,n){const r=fe(t,yW)
return r?Fd(e,r,{lockupOptions:{...n,shouldCreateScreenshotsLockup:null==n?void 0:n.shouldIncludeScreenshotsForChildren},filter:rm.None}):null}function bd(e,t,n,r,s,a){var c
if(!t)return
if(s.isNetworkConstrained)return
const l=null!==(c=s.metricsOptions.isAdvert)&&void 0!==c&&c
Kv.context("copyMediaIntoMixedMediaLockup",()=>{n.screenshots=ff(e,t,O6.LockupScreenshots,null,s.clientIdentifierOverride,null,l,a)
const c=n.screenshots[0]
n.trailers=[]
const u=lf(e,t,r,s.metricsOptions,n.adamId,l,a)
i(u)&&(o(c)||u.mediaPlatform.isEqualTo(c.mediaPlatform))&&n.trailers.push(u)})}function Sd(e,t,n=null){return(0,Zv.isNothing)(t)?null:Kv.context("subtitleFromData",()=>{let r
return n&&n.subtitleObjectPath&&(r=Qe(e,t,n.subtitleObjectPath,null==n?void 0:n.attributePlatformOverride)),o(r)&&(r=Qe(e,t,NH,null==n?void 0:n.attributePlatformOverride)),r||kd(e,t,n)})}function Pd(e,t,n=!1,r){return Kv.context("badgeFromData",()=>{if(r)return null
const o=Sf(0,t,!1)
if(o){let r=""
const i=gf(e,t)
if(kf(i,oW)?r="Platform.DesignedForPad":kf(i,lW)&&(r="Platform.DesignedForPhone"),(null==r?void 0:r.length)>0)return o&&(Cd(e,t)||(r+=".NotVerified",n&&(r+=".Expanded"))),e.loc.string(r)}return null})}function Id(e,t){return Kv.context("badgeActionFromData",()=>{if(!Sf(0,t,!1))return null
if(Cd(e,t))return null
const n=gf(e,t)
if(!kf(n,oW)&&!kf(n,lW))return null
const r=new FY(Eq)
return r.pageUrl=`https://apps.apple.com/story/id${e.bag.appleSiliconMacUnverifiedBadgeEditorialItemId}`,r})}function Cd(e,t){if(!e.appleSilicon.isSupportEnabled)return!0
const n=Xe(e,t,gR,xq)
return!!i(n)&&n}function kd(e,t,n=null){return Kv.context("categoryFromData",()=>{const r=Qe(e,t,hV,null==n?void 0:n.attributePlatformOverride)
if((null==r?void 0:r.length)>0)return r
const o=we(t,BN)
if(o.length>0){let e=o[0]
const t=JK.Games.toString()
if(e.id===t)for(const n of o){const r=j(n,UM)
if(n.id!==t&&r===t){e=n
break}}return j(e,AW)}{const e=G(t,vR)
return e.length>0?e[0]:null}})}function Od(e,t,n){return Kv.context("lockupFromData",()=>{var r,i,s,a,c,l,u,d
if(!t)return Kv.unexpectedNull(DH,zj),null
const h=Ut(0,t)
n.metricsOptions.isAdvert=h
const p=cn(e,null===(i=null===(r=n.metricsOptions.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===i?void 0:i.placementType,n.metricsOptions.locationTracker,!0)
if(n.metricsOptions.isAdEligible=p,(h||p)&&(null===(a=null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a||a.apply(e,t)),h&&(null===(l=null===(c=n.metricsOptions.pageInformation)||void 0===c?void 0:c.adPageInfo)||void 0===l||l.setTemplateType(e,lG)),!W(t))return null
switch(t.type){case rq:return n.offerEnvironment=rS,Ed(e,t,n)
case hW:const r=pe(e,t,rW)
if(o(r))return null
const i=new xY
return Ad(e,r,i,n),i
case OV:case ZV:return function(e,t,n){return Kv.context("appPromotionOfferLockupFromData",()=>{var r,o,i
const s=null!==(r=Kd(e,t))&&void 0!==r?r:n.parentAppData,a=Yd(e,t)
if(H(s,iN)){const r=Ed(e,t,n)
if((0,Zv.isNothing)(r))return null
r.offerDisplayProperties.titles[wW]=e.loc.string(oS),r.offerDisplayProperties.isStreamlinedBuy=!0,r.offerDisplayProperties.hasDiscount=!1
const o=B(a,fW),i=li(e,s,fW),c=Xd(e,o,{useCase:n.artworkUseCase,withJoeColorPlaceholder:n.useJoeColorIconPlaceholder,style:aG,overrideTextColorKey:n.overrideArtworkTextColorKey})
return r.icon=null!=c?c:i,r}{const r=new xY
Ad(e,s,r,n)
const c=Ks(e,t,n.metricsOptions,n.metricsClickOptions)
Ch(e,c,r.title)
const l=Qe(e,s,kq),u=j(a,lj),d=j(s,nS),h=new UY(u,s.id,l,r.buttonAction,d)
if(h.appTitle=null!==(o=j(s,AW))&&void 0!==o?o:"",h.productTitle=null!==(i=j(a,AW))&&void 0!==i?i:"",t.type===ZV){const e=f(Jd(a),wR);(0,Zv.isSome)(e)&&e.length>0&&(h.additionalBuyParams="adHocOfferId="+e)}else h.additionalBuyParams="contingentItemId="+t.id
return r.buttonAction=h,Oh(n.metricsOptions.locationTracker),r}})}(e,t,n)
default:const s=new xY
return Ad(e,t,s,n),(0,Zv.isSome)(null===(u=n.metricsOptions.pageInformation)||void 0===u?void 0:u.adPageInfo)&&((h||p)&&Gt(e,t,s,n.metricsOptions,!0),h&&(null===(d=s.searchAdOpportunity)||void 0===d||d.setTemplateType(lG))),s}})}function Ed(e,t,n){return Kv.context("inAppPurchaseLockupFromData",()=>function(e,t,n){return t?Kv.context("makeInAppPurchaseLockup",()=>{var r
const o=null!==(r=Kd(e,t))&&void 0!==r?r:n.parentAppData
if((0,Zv.isNothing)(o))return null
const i=H(o,iN),a=Yd(e,t)
if((0,Zv.isNothing)(a))return null
t=a
const c=new $Y
Ad(e,t,c,n,o),c.productIdentifier=j(t,lj),c.parent=Od(e,o,n),c.description=j(t,BG),c.isVisibleByDefault=H(t,"isMerchandisedVisibleByDefault"),c.isSubscription=H(t,NM)
const u=wr(e,t),d=l(u,fR)
c.offerDisplayProperties&&(c.offerDisplayProperties.hasDiscount=d.length>0,c.offerDisplayProperties.subscriptionFamilyId=j(t,"subscriptionFamilyId"))
const h=new FY(hR)
h.presentationContext=Qj
const p=function(e,t,n){const r=(new nK).param(tz.id,n).param(nz,t).build()
return`${$W}:/${VW.product}/${VW.install}/?${r}`}(0,c.adamId,o.id)
h.pageUrl=p
const w=new BY
w.parentLockup=S(c.parent),w.lockup=S(c),w.preInstallOfferDescription=Wo(e,u),h.pageData=w
const g=j(t,lj),v=Qe(e,o,kq),m=j(o,nS),y=s(Jd(t)),A=jh(e,t,c,aG,n.metricsOptions,n.canDisplayArcadeOfferButton)
if(Ch(e,A,c.title),i&&y){const r=new UY(g,o.id,v,c.parent.buttonAction)
c.parent&&(r.appTitle=c.parent.title),r.productTitle=c.title,r.streamlineBuyAction=function(e,t,n,r,o){var i
const a={...o.metricsOptions,id:n.id,targetId:n.id,idType:Dq,actionDetails:{parentAdamId:n.id}},c=Th(e,t,r.icon,o.clientIdentifierOverride),l=S(a),u=Jd(t),d=wr(e,t),h=wr(e,n),p=new fK(f(h,Ej))
let w=null!==(i=f(u,Ej))&&void 0!==i?i:f(d,Ej)
w+=`&appAdamId=${f(n,"id")}`,w+=`&appExtVrsId=${p.get(BM,"")}`,w+=`&bid=${Qe(e,n,kq)}`,w+="&bvrs=1.0",w+=`&offerName=${Qe(e,t,lj)}`
const g=f(u,wR)
return s(g)&&(w+=`&adHocOfferId=${g}`),d[Ej]=w,vr(e,d,t,!1,!1,c,l,Gq,null==o?void 0:o.referrerData,!1,n.id)}(e,t,o,c,n),c.buttonAction=r,c.subtitle=j(o,AW)}else if(m){const t=new UY(g,o.id,v,h,m)
c.parent&&(t.appTitle=c.parent.title),t.productTitle=c.title
const r={...n.metricsOptions,id:c.adamId,idType:Dq,actionDetails:{parentAdamId:o.id}}
Xs(e,t,r),c.buttonAction=t}else{const t=new GY(Gq)
t.title=e.loc.string("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),t.message="",t.isCancelable=!0,c.buttonAction=t}if(Oh(n.metricsOptions.locationTracker),!n||!n.skipDefaultClickAction){const n=Ud(e,t,A)
c.clickAction=n,c.productAction=n}return function(e,t,n){t&&(t.impressionMetrics||Nh(e,t,n),t.parent&&t.parent.adamId&&(0,Jv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields.parentAdamId=gh(t.parent.adamId)))}(e,c,A),c},pR):null}(e,t,n))}function Rd(e,t,n){return Kv.context("screenshotsLockupFromData",()=>{const r=new jY
return function(e,t,n,r){t&&Kv.context("copyDataIntoScreenshotsLockup",()=>{Ad(e,t,n,r),n.screenshots=ff(e,t,O6.LockupScreenshots,null,r.clientIdentifierOverride)})}(e,t,r,n),r})}function Dd(e,t,n){return Kv.context("posterLockupFromData",()=>{const o=new VY
return function(e,t,n,o){t&&Kv.context("copyDataIntoPosterLockup",()=>{Ad(e,t,n,o),n.epicHeading=function(e,t){const n=Ke(e,t,"editorialArtwork.epicHeading")
return i(n)&&i("bb")?Xd(e,n,{cropCode:"bb",useCase:O6.Default}):null}(e,t),n.posterArtwork=function(e,t){const n=Ke(e,t,"editorialArtwork.postCard")
return i(n)?Xd(e,n,{cropCode:"sr",useCase:O6.Default,withJoeColorPlaceholder:!0}):null}(e,t),n.posterVideo=function(e,t,n){const o=Ke(e,t,[$q,MT]),s=Xd(e,Ke(e,t,[$q,MT,zG]),{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(o)){const e=f(o,dq)
return r(e)?null:new Cz(e,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},autoPlayPlaybackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}})}return null}(e,t,O6.GroupingHero),n.offerDisplayProperties&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,mq,CU)),n.posterVideo?n.isDark=be(n.posterVideo.preview.backgroundColor):n.posterArtwork?n.isDark=be(n.posterArtwork.backgroundColor):n.isDark=!1
const s=et(e,t,JG)
if(et(e,t,Sq)){const r=s?e.loc.string("Offer.Label.ComingSoon"):null
let o
o=e.loc.uppercased(ih(e,t,r)),(0,Zv.isSome)(o)&&(n.footerText=o)}})}(e,t,o,n),o})}function _d(e,t,n,r,o=null,i){return Kv.context("mixedMediaLockupFromData",()=>{var s,a,c
const l=new qY
if(Ad(e,t,l,n,null,()=>{yd(e,t,l,o,n),bd(e,t,l,r,n,i),Md(e,t,l,o)}),(0,Zv.isSome)(null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)){const r=cn(e,null===(c=null===(a=n.metricsOptions.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,n.metricsOptions.locationTracker,!0,o)
n.metricsOptions.isAdEligible=r,r&&Gt(e,t,l,n.metricsOptions,!0)}return l})}function Ld(e,t,n,r){const o=t.type===sW?pe(e,t,RH):t,i=Od(e,o,n),s=nt(e,o),a=pd(e,o,r),c=pd(e,t,r),l=null==a?void 0:a.artwork,u=null==c?void 0:c.artwork
let d,f
if((0,Zv.isSome)(u),(0,Zv.isSome)(l)&&(f=dd(0,a),d=l),(0,Zv.isSome)(d)&&(0,Zv.isSome)(i)){const e=new WY(d,i,null,null,f)
return e.caption=ce(o,s,PG),(0,Zv.isSome)(e.caption),e.title=ce(o,s,TV)||j(o,hV),e.impressionMetrics=i.impressionMetrics,e}return null}function Md(e,t,n,r){var o
if(!e.client.isPhone)return
const s=f(t.meta,"imageLockupFromData")
i(s)?n.screenshotsDisplayStyle=s:i(null===(o=null==r?void 0:r.displayStyle)||void 0===o?void 0:o.screenshots)&&(n.screenshotsDisplayStyle=r.displayStyle.screenshots)}function xd(e,t,n,r,o,i=!0,s){return Kv.context("mixedMediaAdLockupFromData",()=>{const a=new qY
return H(t,"iad.format.images")?(bd(e,t,a,r,n),function(e,t,n,r){var o
if(!function(e,t){const n=function(e,t,n){const r=Ge(e,t)
return(0,Zv.isNothing)(r)?null:Ye(r,n)}(e,t,LM)
return!n}(e,t))return
const i=G(t,"iad.assetOverride")
if(i.length){const e=function(e,t,n){const r=new Set(n),o=[],i=[],s=function(e,t){if(0===r.size)return!1
for(const o of n)if(o===t||-1!==e.indexOf(o))return r.delete(o),!0
return!1}
if(n.length&&(t.screenshots.length||t.trailers.length)){if(t.trailers.length)for(const e of t.trailers[0].videos)s(e.videoUrl,e.preview.checksum)&&o.push(e)
if(t.screenshots.length)for(const e of t.screenshots[0].artwork)s(e.template,e.checksum)&&i.push(e)}return!(0!==r.size||!o.length&&!i.length||(t.trailers.length&&(t.trailers[0].videos=o),t.screenshots.length&&(t.screenshots[0]=new Ez(i,t.screenshots[0].mediaPlatform)),0))}(0,n,i)
if(r.pageInformation.adPageInfo&&r.pageInformation.adPageInfo.adIsPresent){r.pageInformation.adPageInfo.setSpecifiedCreativeUsed(e)
const t=null!==(o=r.adsMetricsData)&&void 0!==o?o:{}
t[Yb]=e,r.adsMetricsData=t}}}(e,t,a,n.metricsOptions),Ad(e,t,a,n,null,()=>{Md(e,t,a,o),yd(e,t,a,o,n)})):(Ad(e,t,a,n,null,()=>{yd(e,t,a,o,n)}),a.screenshots=[]),Gt(e,t,a,n.metricsOptions,i,s),a})}function $d(e,t,n,r,i,s){return Kv.context("arcadeLockupFromData",()=>{const a=t.marketingItemData,c=new zY
c.title=e.loc.string("ARCADE_LOCKUP_TITLE","Apple Arcade")
const l=t.marketingItemData
n={...n,mercuryMetricsData:bh(0,l)}
let u,d=Bc(0,a);(null==d?void 0:d.length)>0&&(d=d.replace(/\n/g," "),c.nonsubscribedSubtitle=d,c.subscribedSubtitle=d)
const f=Nc(0,a)
u=Gc(e,t.marketingItemData,r,n),u.title=f,c.unsubscribedButtonAction=u
const h=ro(0,n.pageInformation,n.locationTracker)
h.title=e.loc.string(HB,qB),c.subscribedButtonAction=h
const p=Vh(e,t.marketingItemData,c.title,n)
p.displaysArcadeUpsell=!0,o(p.targetType)&&(p.targetType=cW),Nh(e,c,p)
const w=new YY(pW,e.bag.arcadeAppAdamId,null,i,null,s,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
return w.titles[LU]=e.loc.string(HB,qB),c.offerDisplayProperties=w,c})}function Fd(e,t,n){return r(t)?[]:Nd(e,t.data,n)}function Nd(e,t,n){return Kv.context("lockupsFromData",()=>{var o
if(!t)return[]
const s=[]
let a=!1
for(let c=0;c<t.length&&!a;c++){const l=t[c]
if(!W(l)){n.contentUnavailable&&(a=n.contentUnavailable(c,l))
continue}const u=n.lockupOptions
let d=rm.All
if(n.includeOrdinals){const r=n.ordinalDirection===iS?t.length-c:c+1
u.ordinal=e.loc.decimal(r).toString()}if(i(n.filter)&&(d=n.filter),at(e,l,d)&&!n.shouldShowOnUnsupportedPlatform)continue
const f=null!==(o=n.lockupOptions.shouldCreateScreenshotsLockup)&&void 0!==o&&o?Rd(e,l,u):Od(e,l,u)
!r(f)&&f.isValid()&&(s.push(f),_h(n.lockupOptions.metricsOptions.locationTracker))}return s})}function Bd(e,t,n,r,s=null,a){return Kv.context(`actionFromData: ${t.type}`,()=>{switch(t.type){case yW:case aW:return Vd(e,t,n,{clientIdentifierOverride:r,externalDeepLinkUrl:s,isCppDeepLinkEligible:a})
case rq:return Ud(e,t,n)
case sW:return jd(e,t,n,r)
case _V:case aq:return function(e,t,n){return t?Kv.context("editorialPageActionFromData",()=>{const r=new FY(SW)
{const n=t.href
if(o(n))return Kv.unexpectedNull(DH,zq,CG),null
r.pageUrl=Ni(e,n)}return r.title=Kf(e,t,AW),o(r.title)&&(r.title=j(t,AW)),Xs(e,r,n),r}):null}(e,t,n)
case GM:return function(e,t,n){return t?Kv.context("msoActionFromPlatformData",()=>{const r=j(t,eW)
if(!r)return Kv.unexpectedNull(DH,zq,eW),null
const o=new FY($N)
return o.pageUrl=r,o.title=j(t,AW),Xs(e,o,n),o}):null}(e,t,n)
case UV:return function(e,t,n){return t?Kv.context("groupingActionFromData",()=>{if(!t.href)return Kv.unexpectedNull(DH,zq,CG),null
const r=new FY(SW)
return r.pageUrl=ve(e,function(e,t){const n=[Hq,$q,hH,wH,LH,LV]
e.appleSilicon.isSupportEnabled&&n.push(xH),e.bag.enableUpdatedAgeRatings&&n.push(Fq),of(e)&&n.push(EH)
const r=new yY(e,t).includingAttributes(n).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported()
ii(e)&&(r.enablingFeature(tq),r.includingScopedAttributes(hW,nZ),r.includingScopedRelationships(hW,[rW]),r.includingScopedRelationships(rT,[hW]))
const o=ne(e)
return i(o)&&r.addingQuery(HG,o),r}(e,t.href)).toString(),r.title=Wd(0,t),Xs(e,r,n),r}):null}(e,t,n)
default:return function(e,t,n){return t?Kv.context("genericActionFromData",()=>{const r=f(t,jV),o=j(t,eW)
if(!o)return Kv.unexpectedNull(DH,zq,eW),null
const i=new FY(SW)
return i.pageUrl=o,i.title=r===UV?Wd(0,t):j(t,AW),Xs(e,i,n),i}):null}(e,t,n)}})}function Ud(e,t,n){return Kv.context("iAPActionFromData",()=>{var r
const o=Kd(e,t)
if(!o)return null
const s=new FY(kH),a=wz.from(j(o,eW)),c=Ve(null!==(r=n.productVariantData)&&void 0!==r?r:Ge(e,o))
i(c)&&a.param(tz.productVariantID,c)
const l=a.toString(),u=j(t,lj),d=H(t,NM)
return s.pageUrl=function(e,t,n,r){const o=(new nK).param(rz,t).param(tz.offerName,n).param(oz,r.toString()).build()
return`${$W}:/${VW.product}/${VW.lookup}/?${o}`}(0,l,u,d),s.title=j(t,AW),Xs(e,s,n),s})}function Gd(e,t){return o(t)?b6:Kv.context(sS,()=>{if(function(e){const t=f(e,S$)
return t&&t===NL}(B(t,jq)))return S6
const e=j(t,aS),n="List"===e||"NumberedList"===e
if(H(t,wU)||n)return P6
const r=we(t,RH),o=we(t,$H),i=s(r)&&1===r.length,a=s(o)&&1===o.length
return a&&o[0].type===hW||i&&r[0].type===hW?C6:a?I6:b6})}function jd(e,t,n,a,c,l){return o(t)?null:Kv.context(sS,()=>{var u
let d,h,p
switch(Gd(0,t)){case S6:return function(e,t,n){return Kv.context("editorialItemExternalLinkActionFromData",()=>{const r=f(B(t,jq),eW),o=new JY(r),i=Jf(e,t,cV)
if(i)o.title=i
else{const e=new wz(r)
o.title=e.host}return Xs(e,o,n),o})}(e,t,n)
case P6:d=Eq
const p=wz.from(j(t,eW))
i(c)&&p.param(tz.recoMetrics,JSON.stringify(c)),(0,Zv.isSome)(l)&&!l.isHorizontalShelfContext&&p.param(tz.todayCardConfig,JSON.stringify(l))
const w=null===(u=N(t))||void 0===u?void 0:u.id;(0,Zv.isSome)(w)&&p.param(tz.editorialCardId,w),h=p.build()
break
case I6:const g=we(t,$H)[0]
return Bd(e,g,n,a)
case C6:const v=we(t,RH),m=s(v)&&1===v.length?v[0]:we(t,$H)[0],y=pe(e,m,rW)
if(o(y))return null
const A=gi(e,m,y,!1,!1,Jq,WH,!1,n,!1,!0,null,!1,!1)
return r(A)||A instanceof Date?null:hi(e,m,y,A,n,!0)
case k6:d=SW,h=Ni(e,t.href)
break
default:d=Xq,h=f(B(t,jq),eW)}if((0,Zv.isNothing)(h))return null
const w=new FY(d)
w.pageUrl=h,(0,Zv.isSome)(p)&&(w.presentation=p)
let g=Jf(e,t,AW)
return r(g)&&(g=f(t,nq)),w.title=g,Xs(e,w,n),w})}function Vd(e,t,n,r){var o,s,a,c
if(!t)return null
const l=null!==(o=r.clientIdentifierOverride)&&void 0!==o?o:null,u=null!==(s=r.externalDeepLinkUrl)&&void 0!==s?s:null,d=!(null!==(a=r.isCppDeepLinkEligible)&&void 0!==a&&a),h=null!==(c=r.productVariantData)&&void 0!==c?c:Ge(e,t)
return Kv.context("productActionFromData",()=>{var r,o,s,a
let c=j(t,eW)
if(!c)return Kv.unexpectedNull(DH,zq,eW),null
let p={}
const w=new wz(c)
if(n.isAdvert){const i=f(t,cS)
null!==i&&i.length>0&&w.param(cK,i)
const s={...null===(o=null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===o?void 0:o.clickFields}
Object.assign(s,n.adsMetricsData),w.param(aK,JSON.stringify(s)),p={iAdClickFields:y(s),iAdLineItem:i}
const a=fn(0,t)
if((0,Zv.isSome)(a)){const r=Yf(e,t)?VB:DM,o=Yt(0,n.pageInformation),i=j(t,_M),s=H(t,Sq)?iH:wW,c=new QY(a,t.id,i,r,"productPageDismissed",s,o)
w.param(lK,JSON.stringify(c)),p.iAdDismissAdActionMetrics=y(c)}}const g=Ve(h)
i(g)&&w.param(tz.productVariantID,g),p.externalDeepLinkUrl=u,i(u)&&w.param(a1,u),iu(e).platform,Hd(e,t)
{p.isCppDeepLinkDisabled=d,w.param(c1,d.toString())
const e=null===(a=null===(s=n.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term;(0,Zv.isSome)(e)&&w.param(iq,e),p.clientIdentifierOverride=l,(null==l?void 0:l.length)>0&&w.param(lS,l)}c=w.toString()
const v=new FY(kH)
v.pageUrl=c,v.pageData=rd(e,t,p),v.title=j(t,AW),n&&n.pageInformation&&(v.referrerUrl=n.pageInformation.pageUrl)
const m=H(t,Sq)
Xs(e,v,m?{...n,offerType:iH,offerReleaseDate:yr(0,t)}:n,!0)
const A=f(t,"id")
return(0,Zv.isSome)(A)&&(v.destination=t.type===aW?function(e){const{id:t,platform:n,lic:r,...o}=e
return{$kind:"BundlePageIntent",id:dt(t),platform:ut(n),lic:r,...o}}({..._i(e),id:A}):function(e){const{id:t,platform:n,ppid:r,lic:o,...i}=e
return{...i,$kind:"ProductPageIntent",id:dt(t),platform:ut(n),ppid:r,lic:o}}({..._i(e),platform:qd(e,t),id:A})),v})}function Hd(e,t){try{return function(e,t){const n=(0,Zv.unwrapOptional)(yt(e,t)),r=new Set(Fe(e,n,!0))
if(r.has(Uq))return Uq
if(r.has(Bq))return Bq
if(r.has(vW))return vW
if(r.has(aH))return iW
if(r.has(oj))return"tv"
if(r.has(gW))return gW
throw new Error("Could not infer platform from device families")}(e,{data:[t]})}catch(t){return void e.console.error(`Error inferring preview platform from data: ${t}`)}}function qd(e,t){return iu(e).platform||Hd(e,t)}function Wd(e,t){const n=G(t,vR)
return s(n)?n[0]:j(t,AW)}function zd(e,t){if(!t)return!1
if(e.client.isCompanionVisionApp)return!0
const n=function(e,t,n){return Qe(e,t,Sf(0,t,n)?xH:wH)}(e,t,e.appleSilicon.isSupportEnabled)
if(o(n))return!0
const r=n.split(" ")
return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(r,!1)}function Yd(e,t){if(!t)return null
switch(t.type){case OV:return pe(e,t,dU)
case ZV:return pe(e,t,fU)}return t}function Jd(e){if(!e)return null
const t=p(e,XF)
if(s(t))return t
const n=p(e,vL)
return s(n)?n:null}function Kd(e,t){if(!t)return null
switch(t.type){case OV:return pe(e,t,w$)
case ZV:const n=pe(e,t,fU)
return pe(e,n,rW)}return pe(e,t,rW)}function Zd(e,t){t.bag.arcadeDownloadPacksMetricsEventsEnabled||(e.clickAction.actionMetrics.clearAll(),e.buttonAction.actionMetrics.clearAll(),gt(e.buttonAction)&&e.buttonAction.defaultAction.actionMetrics.clearAll()),t.bag.arcadeDownloadPacksImpressionEventsEnabled||(e.impressionMetrics=null)}function Qd(e,t){switch(t){case pN:case pE:case Lq:return O6.LockupIconSmall
case fq:return O6.LockupIconMedium
case CB:return O6.LockupIconLarge
default:return O6.Default}}function Xd(e,t,n){return Kv.context("artworkFromApiArtwork",()=>{var o,s,a
const c=!!i(n.allowingTransparency)&&n.allowingTransparency,l=!!i(n.withJoeColorPlaceholder)&&n.withJoeColorPlaceholder,d=f(t,eW)
if(r(d))return null
const p=u(t,"hasP3"),w=[kt(e,c,p,n.useCase)]
u(t,"supportsLayeredImage")
let g=null
if(c)g=Se(qG)
else if(l){const e=ch(t),i=ye(null!==(s=null===(o=n.joeColorPlaceholderSelectionLogic)||void 0===o?void 0:o.call(n,e))&&void 0!==s?s:f(t,uj))
r(i)||(g=i)}r(g)&&(g=Se(wE))
const v=null!==(a=n.overrideTextColorKey)&&void 0!==a?a:JL,m=ye(f(t,v)),y=new bz(d,n.overrideWidth||h(t,mG),n.overrideHeight||h(t,WG),w)
return y.backgroundColor=g,y.checksum=f(t,gE),i(m)&&(y.textColor=m),i(n.style)&&(y.style=n.style),i(n.cropCode)&&(y.crop=n.cropCode),i(n.contentMode)&&(y.contentMode=n.contentMode),y})}function ef(e,t,n,r){return Kv.context(bT,()=>{const o=rf(e,t,r)
if(!i(o))return null
const s=new Sz(o),a=j(t,AW),c=Vh(e,t,a,n)
return Nh(e,s,c),s})}function tf(e,t,n,r){return Kv.context(bT,()=>{const i=[]
o(n.targetType)&&(n.targetType=fW)
for(const o of t){const t=ef(e,o,n,r)
t&&(i.push(t),_h(n.locationTracker))}return i})}function nf(e,t,n,r){const i=Ke(e,t,"editorialArtwork.searchCategoryBrick")
if(o(i))return null
let s=r
n===Vm.seeAllPage&&(s=em.Density1)
let a=[],c=[]
switch(s){case em.Density1:const e=n===Vm.categoryBreakout?"1191":"2350"
i[mG]=e,i[WG]=KL,a=[ST,"SCB.ApSCBL03"],c=[tm.right,tm.left]
break
case em.Density2:i[mG]="2482",i[WG]=KL,a=["SCB.ApSCBS01","SCB.ApSCBS02"],c=[tm.left,tm.right]
break
case em.Density3:i[mG]=KL,i[WG]=KL,a=["cc"],c=[tm.scaleAspectFit]}return a.map((t,n)=>Xd(e,i,{cropCode:t,contentMode:n<c.length?c[n]:null,useCase:O6.Default,withJoeColorPlaceholder:!0}))}function rf(e,t,n,o,s,a){return Kv.context("iconFromData",()=>{if(!t)return Kv.unexpectedNull(DH,zj),null
const c=null!=a?a:af(e,t,o),l=sf(e,t),u=o||e.host.clientIdentifier,d=function(e,t,n,r,o,i){if(r!==hY&&!et(e,t,FG))return null
if(o){const r=se(t,i,PT)
if((0,Zv.isSome)(r))return Xd(e,r,{...n,style:ZL,cropCode:"bb",withJoeColorPlaceholder:!0})}const s=se(t,i,vE)
if((0,Zv.isSome)(s)){const t=o?ZL:L$,r=o?"ic":void 0
return Xd(e,s,{...n,style:t,cropCode:r,withJoeColorPlaceholder:!0})}return null}(e,t,n,u,l,c)
if((0,Zv.isSome)(d))return d
const f=function(e,t,n,r,o){const s=qf(e,t),a=Vf(e,t)&&(r===pY||s),c=se(t,o,mE)
return a&&i(c)?Xd(e,c,{...n,style:wN}):null}(e,t,n,u,c)
if((0,Zv.isSome)(f))return f
const h=function(e,t,n){if(t.type!==rq)return null
const r=B(t,fW)
return(0,Zv.isSome)(r)?Xd(e,r,{...n,style:aG}):null}(e,t,n)
if((0,Zv.isSome)(h))return h
const p=function(e,t,n,r){if(t.type!==aW)return null
if(r){const r=B(t,EH)
if((0,Zv.isSome)(r))return Xd(e,r,{...n,style:kB,cropCode:"bb"})}const o=B(t,fW)
if((0,Zv.isSome)(o)){const t=r?kB:AB,i=r?"ia":void 0
return Xd(e,o,{...n,style:t,cropCode:i,allowingTransparency:!0})}return null}(e,t,n,l)
if((0,Zv.isSome)(p))return p
r(s)&&(s=Ge(e,t))
const w=ot(e,t,s,fW,c),g=function(e,t,n,r,o){return o!==lV&&r!==gY?null:Xd(e,t,{...n,style:QL})}(e,w,n,u,c)
if((0,Zv.isSome)(g))return g
const v=function(e,t,n,r,o){return o!==uH&&r!==Vz?null:Xd(e,t,{...n,style:L$})}(e,w,n,u,c)
return(0,Zv.isSome)(v)?v:function(e,t,n,r,o,i,s){const a=s===vH,c=a&&!0
if(o){const n=ot(e,t,i,EH,s)
if((0,Zv.isSome)(n))return Xd(e,n,{...r,style:kB,cropCode:"bb",allowingTransparency:c})}let l,u
return o?(l=kB,u=a?"ib":"ia"):(l=a?gN:AB,u="bb"),Xd(e,n,{...r,style:l,cropCode:u,allowingTransparency:c})}(e,t,w,n,l,s,c)})}function of(e){return ar(e,e.bag.iconArtworkRolloutRate)&&e.bag.enableIconArtwork&&!0}function sf(e,t){const n=t.type===aW,r=gf(e,t),o=e.bag.enableIPadOnlyFallbackIcons&&-1!==r.indexOf(oW)&&-1===r.indexOf(lW)
return of(e)&&!o&&!n}function af(e,t,n){switch(n){case hY:case pY:return xq
case gY:return lV
case Vz:return uH
default:return nt(e,t,n)}}function cf(e,t,n,r){if(!t)return null
const o=Xf(t),i=eh(0,n),s=function(e,t){switch(t){case tM:return 13/K6.width
case eM:return 11/Z6.width
case XL:return 5.5/Q6.width
case M$:return p3/X6.width
case x$:return p3/e3.width
default:return null}}(0,n),a=function(e,t){switch(t){case tM:return 30/K6.width
case M$:return h3/X6.width
case x$:return h3/e3.width
default:return eh(0,t)}}(0,n)
return new Pz(t,n,o,r,i,s,a)}function lf(e,t,n,r,o,i=!1,s){const a=uf(e,t,n,null,null,i,s)
if(!a)return null
const c=a.videos,l=[]
if(c&&c.length>0)for(const t of c)wo(e,t,{...r,id:o}),l.push(t)
let u=null
return l.length>0&&(u=new Iz,u.videos=l,u.mediaPlatform=a.mediaPlatform),u}function uf(e,t,n,o=null,s=null,a=!1,c){return Kv.context("platformVideoPreviewFromData",()=>{r(s)&&(s=Ge(e,t))
const u=function(e,t,n,r,o){return ot(e,t,n,r?PE:Lj,void 0)}(e,t,s,a),d={}
if(!u)return null
let w=wf(e,t,e.host.clientIdentifier,e.client.deviceType)
if(i(o)){const e=[]
for(const t of w)o.includes(t)&&e.push(t)
w=e}if(0===w.length)return null
for(const t of w){const r=_f(e,t,e.client.screenSize)
for(const t of Object.keys(u)){const r=l(u,t),o=[]
for(const s of r){const r=p(s,zG)
if(!r){Kv.unexpectedNull(DH,vV,`videoPreviewsByType.${t}.previewFrame`)
continue}const a=f(s,dq)
if(!a){Kv.unexpectedNull(DH,zq,`videoPreviewsByType.${t}.video`)
continue}const l=Ot(e,f(r,eW),h(r,mG),h(r,WG),null,null,f(r,gE))
i(c)&&(l.crop=c),o.push(new Cz(a,l,n))}d[t]=o}for(const e of r)if(d[e])return new R6(d[e],cf(0,t,e))}return null})}function df(e,t){return Kv.context("videoPreviewsFromApiPlatformData",()=>{const n=uf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
return n?n.videos:[]})}function ff(e,t,n,o=null,i,s,a=!1,c){return Kv.context("screenshotsFromData",()=>{const l=[]
r(s)&&(s=Ge(e,t))
let u=o
if(!u||0===u.length){const n=i||e.host.clientIdentifier
let r=e.client.deviceType
n===hY&&(r=gW),i!==Vz&&i!==jz||(r=iW),u=wf(e,t,n,r)}for(const r of u){const o=[]
let i
if(r===pq?(i=Wf(e,t,xq),Hf(e,t,xq)&&o.push("faceTime")):i="tv"===r?zf(e,t,s,a,lV):r===iW?zf(e,t,s,a,uH):r===vW?zf(e,t,s,a,vH):zf(e,t,s,a),!i)continue
const u=pf(e,i,r,n,o,c)
u&&l.push(u)}return l})}function hf(e,t,n,r=null,o=null,i){return function(e,t,n){const r=[]
if(n&&n.length>0){const o=n.map(e=>e.mediaPlatform)
for(const i of n){const n=[]
for(const e of i.artwork){const t=new kz
t.screenshot=e,n.push(t)}const s=i.mediaPlatform,a=new Oz(n,s,o,Tf(e,s),mf(e,t,o),yf(e,t,o))
r.push(a)}}return r}(e,t,ff(e,t,n,r,i,o))}function pf(e,t,n,r,o,i){const a=function(e,t){return t===pq?e.client.deviceType===oW?oW:lW:t}(e,n),c=_f(e,a,e.client.screenSize)
let u,d=null
for(let e=0;e<c.length&&!s(d);e++)d=l(t,c[e]),u=c[e]
if(s(d)){const t=d.map(function(t){return Xd(e,t,{useCase:r,cropCode:i})}),s=cf(0,n,u,o)
return new Ez(t,s)}return null}function wf(e,t,n,r){return $(t,`sortedAppPlatformsFromData.${n}.${r}`,()=>{var o
const i=gf(e,t),s=[]
let a=[]
const c=function(e,t){-1===a.indexOf(e)&&-1===s.indexOf(e)&&-1!==i.indexOf(e)&&(a.push(e),t&&s.push(t))}
switch((null===(o=e.activeIntent)||void 0===o?void 0:o.appPlatform)&&c(e.activeIntent.appPlatform),n!==Vz&&n!==jz||c(iW),n){case hY:c(gW)
break
case pY:c(pq)}switch(r){case lW:c(lW)
break
case oW:c(oW)
break
case"tv":c("tv")
break
case gW:c(gW)
break
case vW:c(vW)
break
case iW:c(iW)}return n!==Vz&&n!==jz||(c(oW),c(lW)),e.appleSilicon.isSupportEnabled?(c(oW),c(lW)):(c(lW),c(oW)),c(vW),c(iW),c("tv"),c(gW),c(pq),a=a.filter(function(e){return-1===s.indexOf(e)}),a})}function gf(e,t){return t?$(t,"supportedAppPlatformsFromData",()=>vf(e,t,!0)):null}function vf(e,t,n){if(!t)return null
const r=Vf(e,t,xq),o=qf(e,t),i=function(e,t){return et(e,t,hH)}(e,t)
let s=G(t,dj)
if(t.type===aW&&n){const e=G(t,"unionDeviceFamilies")
e.length>0&&(s=e)}const a=[]
let c=!1
for(const e of s)switch(e){case Uq:o||a.push(lW)
break
case Bq:o||a.push(oW)
break
case oj:a.push("tv")
break
case gW:a.push(gW),c=!0
break
case aH:a.push(iW)}return r&&a.push(pq),!c&&i&&a.push(gW),Me(e,t,vW)&&a.push(vW),a}function mf(e,t,n){if(Af(e,t,n)){const t=n[0].appPlatform.toUpperCase()
return e.loc.string(`ONLY_FOR_${t}_APP`)}let r=n.reduce((e,t)=>e.concat(bf(t)),[])
try{return e.loc.tryString(`PLATFORMS_${r.join("_")}`)}catch(t){return r=["PHONE","PAD","MAC","VISION","TV","WATCH","MESSAGES","FACETIME"].filter(e=>r.includes(e)),e.loc.string(`PLATFORMS_${r.join("_")}`)}}function yf(e,t,n){return Af(e,t,n)?"top":"bottom"}function Af(e,t,n){if(1===n.length){const r=n[0],o=Sf(0,t,e.appleSilicon.isSupportEnabled),i=!1,s=kf(Cf(0,e.client.deviceType,o,i),r.appPlatform),a=0===r.supplementaryAppPlatforms.length,c=r.appPlatform!==e.client.deviceType
if(a&&c&&!s)return!0}return!1}function Tf(e,t){const n=bf(t)
return e.loc.string(`PLATFORMS_${n.join("_")}`)}function bf(e){const t=e.appPlatform.toUpperCase(),n=e.supplementaryAppPlatforms.map(e=>e.toUpperCase())
return[t].concat(n)}function Sf(e,t,n){let r=H(t,mL)
return n&&r}function Pf(e,t){let n
return e.isAvailable(Xz)&&[YG,cG].includes(e.client.buildType)&&(0,Zv.isSome)(e.ads.fetchAppBinaryTraitsOverride)&&(n=e.ads.fetchAppBinaryTraitsOverride()),(0,Zv.isNothing)(n)&&(n=ae(t,xq,IT)),n}function If(e,t,n){if(Sf(0,t,n)){const n=Qe(e,t,"minimumMacOSVersion")
if(s(n))return n}return ce(t,nt(e,t),LH)}function Cf(e,t,n,r){switch(t){case lW:return[lW,pq]
case oW:return[lW,oW,pq]
case"tv":return["tv"]
case gW:return[gW]
case vW:return n?[vW,lW,oW]:[vW]
case iW:return r?[iW,lW,oW]:[iW]
default:return[]}}function kf(e,t){return-1!==e.indexOf(t)}function Of(e,t,n,r,o,i,s=!0){const a=function(e,t,n,r,o){let i
switch(n){case lW:return i=st(e),(0,Zv.isSome)(t)&&i.isSystemAppFromData(t)?[lW,gW,pq]:[lW,gW,pq,"tv",iW]
case oW:return i=st(e),(0,Zv.isSome)(t)&&i.isSystemAppFromData(t)?[lW,oW,pq]:[lW,oW,pq,"tv",iW]
case"tv":return["tv"]
case gW:return[gW]
case vW:return r?[vW,lW,oW]:[vW]
case iW:return o?[iW,lW,oW]:[iW]
default:return[]}}(e,t,r,o,i)
return!!a.some(e=>kf(n,e))}function Ef(e,t){var n
const o=new E6
if(e.client.deviceType!==vW)return o
if(t.type!==aW)return o.runsOnIntel=null===(n=Xe(e,t,"runsOnIntel",rt(e)))||void 0===n||n,o.runsOnAppleSilicon=et(e,t,"runsOnAppleSilicon",rt(e)),o.requiresRosetta=et(e,t,CT,rt(e)),o
const i=we(t,yW)
if(0===i.length)return o
for(const t of i){if(r(t.attributes))continue
const n=Ef(e,t)
o.runsOnIntel=o.runsOnIntel&&n.runsOnIntel,o.runsOnAppleSilicon=o.runsOnAppleSilicon&&n.runsOnAppleSilicon,o.requiresRosetta=o.requiresRosetta||n.requiresRosetta}return o}function Rf(e,t,n,r){const o=Ef(e,t)
return n?o.runsOnAppleSilicon&&(!o.requiresRosetta||o.requiresRosetta&&r):o.runsOnIntel}function Df(e,t,n,r,o){const i=function(e,t,n,r){switch(t){case lW:return[lW,gW,pq]
case oW:return[lW,oW,pq]
case"tv":return["tv"]
case gW:return[gW]
case vW:return n?[vW,lW,oW]:[vW]
case iW:return r?[iW,lW,oW]:[iW]
default:return[]}}(0,n,r,o)
return i.some(e=>kf(t,e))}function _f(e,t,n){switch(t){case vW:return[vW]
case gW:return n.isEqualTo(t3)||n.isEqualTo(d3)?[M$,x$,XL,eM,tM]:[x$,M$,XL,eM,tM]
case"tv":return["appleTV"]
case iW:return["appleVisionPro"]
case oW:{const t=[]
return(n.isEqualTo(j6)||n.isEqualTo(V6)||n.isEqualTo(W6)||n.isEqualTo(z6))&&e.client.screenCornerRadius>0?(t.push(vU),t.push(mU),t.push(OB),t.push(EB),t.push(Bq)):n.isEqualTo(G6)?(t.push(OB),t.push(vU),t.push(mU),t.push(EB),t.push(Bq)):n.isEqualTo(B6)||n.isEqualTo(U6)||n.isEqualTo(H6)||n.isEqualTo(q6)||n.isEqualTo(Y6)||n.isEqualTo(J6)?(t.push(mU),t.push(vU),t.push(OB),t.push(EB),t.push(Bq)):n.isEqualTo(N6)?(t.push(EB),t.push(Bq),t.push(mU),t.push(OB),t.push(vU)):n.isEqualTo(n3)?(t.push(mU),t.push(OB),t.push(vU),t.push(EB),t.push(Bq)):n.isEqualTo(F6)?(t.push(Bq),t.push(EB),t.push(mU),t.push(OB),t.push(vU)):(t.push(vU),t.push(mU),t.push(Bq),t.push(EB),t.push(OB)),t}case lW:{let e
e=n.isEqualTo(D6)||n.isEqualTo(i3)?yE:n.isEqualTo(_6)||n.isEqualTo(r3)||n.isEqualTo(o3)?nM:n.isEqualTo($6)?Uq:n.isEqualTo(x6)?kT:n.isEqualTo(M6)?OT:n.isEqualTo(L6)?ET:n.isEqualTo(s3)||n.isEqualTo(c3)?AE:n.isEqualTo(a3)||n.isEqualTo(l3)||n.isEqualTo(u3)?TE:nM
const t=f3.indexOf(e),r=f3.slice(0,t)
r.reverse()
const o=f3.slice(t+1)
return[e].concat(r,o)}default:return[]}}function Lf(e,t){if(r(t))return null
const n=Ke(e,t,rE),o=Ke(e,t,oE),i=Sf(0,t,!0)
if(xe(e,t,vW)&&!i){const i=e.bag.enableProductPageInstallSize?function(e,t){const n=se(t,vH,iE)
if((0,Zv.isNothing)(n))return null
const r=n[wO]
return(0,Zv.isNothing)(r)?null:h(r)}(0,t):function(e,t){const n=wr(e,t)
if(r(n))return null
const o=l(n,"assets")
if(!o.length)return null
for(const e of o)if(f(e,"flavor")===HS)return h(e,JN)
return null}(e,t)
if(s(o)){const e=h(o,RT)
return new Rz(i,null,null,e)}if(s(n)){const e=h(n,DT),t=h(n,_T)
return new Rz(i,e,t,null)}return new Rz(i,null,null,null)}{const r=B(t,tE)
if(r){let t=[]
e.client.thinnedApplicationVariantIdentifier&&(t=e.client.thinnedApplicationVariantIdentifier.split(" ")),t=t.concat([e.host.deviceModel,"universal"])
for(const e of t){const t=h(r[e])
if(t){if(s(o)){const e=h(o,RT)
return new Rz(t,null,null,e)}if(s(n)){const e=h(n,DT),r=h(n,_T)
return new Rz(t,e,r,null)}return new Rz(t,null,null,null)}}}}return null}function Mf(e,t,n){let r,s=null,a=null,c=null,l=null
switch(e.client.deviceType){case vW:n.supportsArcade?(s=bE,c="sr"):(s="editorialArtwork.centeredFullscreenBackground",c="ep")
break
case"tv":n.presentedInTopShelf?(s=SE,c="sr"):(s=bE,c="ta",a="editorialArtwork.fullscreenBackground",l="sr")
break
case iW:s="editorialArtwork.productUberStatic16x9",c="sr"
break
default:n.supportsArcade?n.prefersCompactVariant||e.client.isPhone?(s="editorialArtwork.splashTall",c="oc"):(s=bE,c="oh"):(s=rM,c="sr")}return r=Ke(e,t,s),null!==a&&o(r)&&(r=Ke(e,t,a),null!==l&&(c=l)),i(r)&&i(c)?Xd(e,r,{cropCode:c,useCase:O6.Uber,withJoeColorPlaceholder:!0,overrideHeight:null,overrideWidth:null}):null}function xf(e,t,n,o,a){let c=[]
if(s(o))c=o
else switch(e.client.deviceType){case vW:case"tv":c=[mN]
break
case oW:c=[oM]
break
case iW:c=["productUberMotion16x9"]
break
default:c=[yN]}let l=null,u=null
for(const n of c)if(l=Ke(e,t,[$q,n]),u=Ke(e,t,[$q,n,zG]),s(l))break
const d=null!=a?a:Xd(e,u,{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(l)){const e=f(l,dq)
if(r(e))return null
let t,n
return t={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},n={muteUnmute:!0},new Cz(e,d,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:t,autoPlayPlaybackControls:n})}return null}function $f(e,t,n){let r=null
switch(e.client.deviceType){case vW:case"tv":case lW:case iW:r=[mN,oM,yN]
break
default:r=[oM,mN,yN]}return xf(e,t,O6.Uber,r,n)}function Ff(e,t){return i(t)?`${$W}:/${VW.developer}/${VW.href}?${tz.href}=${t.href}`:null}function Nf(e,t,n){return ve(e,new yY(e).forType(dN).addingQuery(fN,yW).addingQuery(gq,n).addingQuery(_H,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}function Bf(e,t){switch(t){case fY:case vY:return"appStore"
case hY:return gW
case pY:return pq
case gY:return oU
default:return null}}function Uf(e,t){switch(t){case 6:return["L",dT]
case 7:return["10",hT]
case 8:return["12",wT]
case 9:return["14",vT]
case 10:return["16",yT]
case 11:return["18",TT]
case 12:return["AL",uT]
case 13:return["A10",fT]
case 14:return["A12",pT]
case 15:return["A14",gT]
case 16:return["A16",mT]
case 17:return["A18",AT]
case 20:return["All","kr.all"]
case 21:return["12","kr.12"]
case 22:return["15","kr.15"]
case 31:return["15+","AgeRating-AU-15"]
case 32:return["R 18+","AgeRating-AU-18"]
case 47:return["18+","AgeRating-FR-18"]
default:return}}function Gf(e,t){switch(t){case lW:return e.loc.string("AppPlatform.Phone")
case oW:return e.loc.string("AppPlatform.Pad")
case iW:return e.loc.string("AppPlatform.Vision")
case"tv":return e.loc.string("AppPlatform.TV")
case gW:return e.loc.string("AppPlatform.Watch")
case pq:return e.loc.string("AppPlatform.Messages")
case vW:return e.loc.string("AppPlatform.Mac")
default:return""}}function jf(e,t){var n
return null===(n=Uf(0,t))||void 0===n?void 0:n[1]}function Vf(e,t,n){return et(e,t,"hasMessagesExtension",n)}function Hf(e,t,n){return et(e,t,GL,n)}function qf(e,t){return et(e,t,"isHiddenFromSpringboard")}function Wf(e,t,n){return Ke(e,t,UL,n)}function zf(e,t,n,r,o){return ot(e,t,n,r?wB:eV,o)}function Yf(e,t,n){return et(e,t,JG,n)}function Jf(e,t,n,r=!1,o){var i,s
if((0,Zv.isNothing)(t))return null
let a
if(r){const r=N(t)
W(r)&&(a=Qe(e,r,[mV,n],o))}return a=null!==(s=null!==(i=null!=a?a:Qe(e,t,[RB,n],o))&&void 0!==i?i:Qe(e,t,[mV,n],o))&&void 0!==s?s:Qe(e,t,["itunesNotes",n],o),a}function Kf(e,t,n,r=!1){var o
let i
if(r){const r=N(t)
W(r)&&(i=Qe(e,r,[mV,n]))}return i=null!==(o=null!=i?i:Qe(e,t,[RB,n]))&&void 0!==o?o:Qe(e,t,[mV,n]),i}function Zf(e,t){return $(t,"isMacOSInstaller",()=>!1)}function Qf(e,t){const n=st(e)
return!(!function(e,t,n){if(n&&st(e).isSystemAppFromData(t)){const e=j(t,"watchBundleId")
if(s(e))switch(e){case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0
default:return!1}}return!1}(e,t,e.client.isTinkerWatch)&&(!e.client.isTinkerWatch||(n.isSystemAppFromData(t)?et(e,t,fO)||et(e,t,FG):et(e,t,dO)||et(e,t,FG))))}function Xf(e){switch(e){case lW:return Uq
case oW:return Bq
case"tv":return"tv"
case gW:return lL
case vW:return"macbook"
case pq:return zF
case iW:return"visionpro"
default:x(e)}}function eh(e,t){switch(t){case vU:return 18/j6.width
case mU:return 18/B6.width
case yE:return 41.5/D6.width
case nM:return 39/_6.width
case AE:return 55/s3.width
case TE:return 55/a3.width
case eM:return 34/Z6.width
case XL:return 55/Q6.width
case M$:return 108/X6.width
case x$:return 108/e3.width
default:return null}}function th(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.host.isOSAtLeast(o,i,s)}function nh(e,t){return!r(t)&&0!==t.length&&e.client.isActivePairedWatchSystemVersionBelow(t)}function rh(e,t){switch(t){case Lq:case fq:case lN:case AN:case P$:case gG:case iM:return!0
default:return!1}}function oh(e,t){switch(t){case"LockupSmall":case"LockupLarge":case IE:case fj:case DB:case TN:case _B:case bN:case sM:return!0
default:return!1}}function ih(e,t,n){const r=wr(e,t)
if(f(r,jV)===iH){const n=f(r,yU),o=Qe(e,t,LV)
if(s(o)){if(s(n)){const t=Oe(n),r={"@@expectedDateMY@@":e.loc.string("PreOrder.Date.MonthYear"),"@@expectedDateMDY@@":e.loc.string("PreOrder.Date.MonthDayYear")}
for(const[n,i]of Object.entries(r))if(o.includes(n)){let r=e.loc.formatDateWithContext(i,t,"middleOfSentence")
return o.replace(n,r)}}return o}}return n}function sh(e,t){const n=pe(e,t,RH)
return s(n)?n:et(e,t,wU)?pe(e,t,$H):null}function ah(e){var t
return null!==(t=function(e,t,n){if((0,Zv.isNothing)(e)||0===t.length&&0===n.length)return null
const r=e
if((0,Zv.isNothing)(r))return null
const o=ke(r)
for(const e of t)if(Ce(o,e))return ye(e.colorHex)
for(const e of n)if(Ce(o,e))return ye(e.colorHex)
return null}(e,v3,m3))&&void 0!==t?t:ye(w3)}function ch(e){var t,n,r,o,i
const s=[]
for(const t of l(e,jA))(0,Zv.isSome)(t)&&c(t)&&s.push(t)
return{bgColor:null!==(t=f(e,uj))&&void 0!==t?t:void 0,textColor1:null!==(n=f(e,JL))&&void 0!==n?n:void 0,textColor2:null!==(r=f(e,$$))&&void 0!==r?r:void 0,textColor3:null!==(o=f(e,CE))&&void 0!==o?o:void 0,textColor4:null!==(i=f(e,mB))&&void 0!==i?i:void 0,textGradient:(0,Xv.isDefinedNonNullNonEmpty)(s)?s:void 0}}function lh(e){var t,n,r,o,i,s
const a=ch(e),c=[]
for(const e of null!==(t=a.textGradient)&&void 0!==t?t:[]){const t=ye(e);(0,Zv.isSome)(t)&&c.push(t)}return{bgColor:null!==(n=ye(a.bgColor))&&void 0!==n?n:void 0,textColor1:null!==(r=ye(a.textColor1))&&void 0!==r?r:void 0,textColor2:null!==(o=ye(a.textColor2))&&void 0!==o?o:void 0,textColor3:null!==(i=ye(a.textColor3))&&void 0!==i?i:void 0,textColor4:null!==(s=ye(a.textColor4))&&void 0!==s?s:void 0,textGradient:(0,Xv.isDefinedNonNullNonEmpty)(c)?c:void 0}}function uh(e){const t=[uj,JL,$$,CE,mB]
for(const n of t){const t=e[n]
if(c(t)&&!Ce(ye(t),g3))return t}return null}function dh(e,t,n=!0){return Kv.context("isSupportedOnCurrentPlatform",()=>{if(t.type!==yW&&t.type!==aW)return!0
const r=vf(e,t,n),o=Sf(0,t,e.appleSilicon.isSupportEnabled)
return Of(e,t,r,e.client.deviceType,o,!1)})}function fh(e,t){let n=t.targetType
return n||(n=cW),n}function hh(e){let t=e.idType
return t===Iq?t=null:t||(t=Dq),t}function ph(e,t){return Yf(e,t)?Pq:null}function wh(e,t,n){const r=f(t,jV),o=Me(e,t,vW,!0),i=xe(e,t,vW,!0),s=function(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
for(const e of n)if(o.has(e))return!0
return!1}(e,t,[Uq,Bq,hN,oj,gW],!0),a=$e(e,t,[Uq,Bq,hN,oj,gW],!0),c=Me(e,t,aH,!0),l=xe(e,t,aH,!0)
if(i||o&&n===vH)switch(r){case yW:return HS
case aW:return"macSoftwareBundle"}if((l||c&&n===uH)&&r===yW)return"visionSoftware"
if(a||s||s&&n===xq||s&&n===gW||s&&n===lV)switch(r){case yW:return qS
case aW:return"mobileSoftwareBundle"}switch(r){case rq:return"softwareAddOn"
case UV:return tV
case C$:case sW:return Ij
case yV:return WS
default:return null}}function gh(e){return null==e?"":e}function vh(e){if(!e)return null
let t=null
const n=new wz(e).query
if((0,Jv.isSome)(n))for(const e of Object.keys(n))if("referrer"===e){n[e]===DE&&(t="com.apple.siri")
break}return t}function mh(e){var t
return(0,Jv.isNothing)(e)?{}:null!==(t=g(yh(y(e))))&&void 0!==t?t:{}}function yh(e){if(r(e))return null
if(e instanceof Array){const t=[]
for(const n of e){const e=yh(n)
i(e)&&t.push(e)}return t}if(e instanceof Object){const t={}
return Object.keys(e).forEach((n,r,o)=>{const s=yh(e[n])
i(s)&&(t[n]=s)}),t}return e}function Ah(e){if(!e)return null
const t=new wz(e),n=t.query,o=null==n?void 0:n[rj],i=t.pathname
return r(o)||r(i)?null:i.endsWith("/search")?o:null}function Th(e,t,n,r){if(!t||!n)return Xq
if(t.type===aW)return Wk
const o=n.style
if((0,Jv.isNothing)(o))return Xq
switch(o){case AB:case kB:return xq
case gN:return vW
case QL:return"tv"
case L$:case ZL:return af(e,t,null!=r?r:void 0)===uH?iW:gW
case wN:return pq
case aG:return aG
default:return x(o),Xq}}function bh(e,t){if(!i(t))return null
const n={},r=p(t,ZR)
if(!s(r))return null
const o=f(r,YS);(0,Jv.isSome)(o)&&(null==o?void 0:o.length)>0&&(n[YS]=o)
const a=f(r,JS);(0,Jv.isSome)(a)&&(null==a?void 0:a.length)>0&&(n[JS]=a)
const c=f(r,KS)
return(0,Jv.isSome)(c)&&(null==c?void 0:c.length)>0&&(n[KS]=c),n.marketing={marketingItemId:t.id},n}function Sh(e,t,n){let o=null
return i(e)&&(o=S(e)),i(t)&&(r(o)&&(o={}),o.odpModuleUpdate=t.toString()),s(n)&&(r(o)&&(o={}),o.userSegment=n),o}function Ph(e,t,n){const r=xh(t.locationTracker)
return[Lh(0,t,n),...r]}function Ih(e,t,n){const r=xh(t.locationTracker)
return[Mh(0,t,n),...r]}function Ch(e,t,n){const r=new y3
r.location=Lh(0,t,n),t.locationTracker.locationStack.unshift(r)}function kh(e,t,n){const r=new y3
r.location=Mh(0,t,n),t.locationTracker.locationStack.unshift(r)}function Oh(e){0!==e.locationStack.length?e.locationStack.shift():Kv.unexpectedType(DH,"non-empty location stack","empty location stack")}function Eh(e){const t=$h(e)
return t?t.position:e.rootPosition}function Rh(e){const t=$h(e)
return t?t.location:null}function Dh(e,t){const n=$h(e)
n?n.position=t:e.rootPosition=t}function _h(e){const t=$h(e)
t?t.position++:e.rootPosition++}function Lh(e,t,n){var r
const o=Mh(0,t,n)
if(!t.id&&t.locationTracker)o.idType=Oq,o.id=Eh(t.locationTracker).toString()
else{const e=hh(t);(0,Zv.isSome)(e)&&(o.idType=e)
let n=t.id;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(n=t.anonymizationOptions.anonymizationString),o.id=(0,Zv.isNothing)(n)?"":n}return t.fcKind&&(o.fcKind=t.fcKind),t.displayStyle&&(o.displayStyle=t.displayStyle),t.inAppEventId&&(o.inAppEventId=t.inAppEventId),t.relatedSubjectIds&&(o.relatedSubjectIds=t.relatedSubjectIds),t.canonicalId&&(o.canonicalId=t.canonicalId),t.optimizationEntityId&&(o.optimizationEntityId=t.optimizationEntityId),t.optimizationId&&(o.optimizationId=t.optimizationId),(0,Zv.isSome)(t.rowIndex)&&(o.rowIndex=t.rowIndex),t.productVariantData&&Object.assign(o,ze(t.productVariantData)),o}function Mh(e,t,n){var r,o
let i=n;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(i=t.anonymizationOptions.anonymizationString)
const s={locationPosition:Eh(t.locationTracker),locationType:fh(0,t),name:(0,Zv.isNothing)(i)?"":i}
return(0,Zv.isSome)(t.badges)&&(s.badges=null!==(o=y(t.badges))&&void 0!==o?o:void 0),t.recoMetricsData&&Object.assign(s,t.recoMetricsData),s}function xh(e){return e.locationStack.map(e=>e.location)}function $h(e){return 0===e.locationStack.length?null:e.locationStack[0]}function Fh(e,t){var n,r,a,c,l,u,d,f
let h=t.id,p=t.title
if(s(t.anonymizationOptions)){const e=null!==(r=null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&void 0!==r?r:"ANONYMOUS"
h=e,p=e}else h&&t.createUniqueImpressionId&&(h=function(e,t){return`${t}${T3}${e.random.nextUUID()}`}(e,h))
const w={id:gh(h),name:gh(p),impressionType:fh(0,t)},g=hh(t);(0,Jv.isSome)(g)&&(w[cx]=g),t&&t.kind&&(w[HH]=t.kind),t&&t.softwareType&&(w[zN]=t.softwareType),t&&t.recoMetricsData&&Object.assign(w,t.recoMetricsData),t&&t.mercuryMetricsData&&Object.assign(w,t.mercuryMetricsData),t&&t.lockupDisplayStyle&&(w[ox]=t.lockupDisplayStyle)
const v=null!==(a=t.shouldOmitImpressionIndex)&&void 0!==a&&a
if(t&&t.locationTracker&&!v){const e=Eh(t.locationTracker)
w[kb]=e,""===w.id&&(w.id=e.toString(),w[cx]=Oq)}if(t&&t.modelSource&&(w.modelSource=t.modelSource),i(t.offerType)&&(w[dF]=t.offerType),t&&i(t.displaysArcadeUpsell)&&(w[NS]=t.displaysArcadeUpsell),t&&i(t.isPreorder)&&(w[Sq]=t.isPreorder),i(t.adamId)&&o(t.anonymizationOptions)&&(w[HV]=t.adamId),t&&i(t.badges)&&(w.badges=t.badges),t&&i(t.inAppEventId)&&(w[h$]=t.inAppEventId),t&&i(t.relatedSubjectIds)&&(w.relatedSubjectIds=t.relatedSubjectIds),(null===(c=null==t?void 0:t.hintsEntity)||void 0===c?void 0:c.length)&&(w[ax]=t.hintsEntity),t&&i(t.autoAdvanceInterval)&&(w.autoAdvanceInterval=t.autoAdvanceInterval),i(null==t?void 0:t.fcKind)&&(w.fcKind=t.fcKind),i(null==t?void 0:t.canonicalId)&&(w[RN]=t.canonicalId),i(null==t?void 0:t.displayStyle)&&(w[MH]=t.displayStyle),i(t.productVariantData)&&Object.assign(w,ze(t.productVariantData)),(0,Jv.isSome)(t.contentRating)&&(w[$U]=t.contentRating),(0,Jv.isSome)(t.bundleId)&&(w[kq]=t.bundleId),w.impressionType!==X$){if((0,Jv.isSome)(t.adsMetricsData)){const e=mh(t.adsMetricsData)
Object.assign(w,e)}if(null!==(l=t.isAdvert)&&void 0!==l&&l||null!==(u=t.isAdEligible)&&void 0!==u&&u){const e=null===(f=null===(d=t.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f?void 0:f.sharedImpressionsArrayFields
if((0,Jv.isSome)(e)){const t=mh(e)
Object.assign(w,t)}}}return""===w.id&&e.console.log(`impressionId missing. Tracking broken for ${w.name} of ${w.impressionType}`),w}function Nh(e,t,n){t&&(t.impressionMetrics=new KY(Fh(e,n)))}function Bh(e,t,n){var r
t&&(Nh(e,t,n),(n.isAdvert||n.isAdEligible)&&(null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)&&t.impressionMetrics&&(t.impressionMetrics=new A3(t.impressionMetrics,!0)))}function Uh(e,t,n,r,o,i,s=!0){var a,c,l,u,d,f
if(!t)return
const h=Fh(e,n)
if(s?(h[BS]=gh(r),h[qM]=gh(o)):(r&&(h[BS]=r),o&&(h[qM]=o)),i&&(h[US]=i),(null!==(c=null===(a=null==n?void 0:n.optimizationEntityId)||void 0===a?void 0:a.length)&&void 0!==c?c:0)>0&&(h[GS]=n.optimizationEntityId),(null!==(u=null===(l=null==n?void 0:n.optimizationId)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0&&(h[jS]=n.optimizationId),(0,Jv.isSome)(null==n?void 0:n.rowIndex)&&(h.rowIndex=n.rowIndex),t.impressionMetrics=new KY(h),(n.isAdvert||n.isAdEligible)&&(null===(d=n.pageInformation)||void 0===d?void 0:d.adPageInfo)){const r=mh(n.pageInformation.adPageInfo.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
Object.assign(t.impressionMetrics.fields,r),t.impressionMetrics=new A3(t.impressionMetrics,!0),n.isAdvert&&(null===(f=t.impressionMetrics)||void 0===f||delete f.fields[qM])}}function Gh(e,t,n,r){if(!t||!r)return
Nh(e,t,n)
const o=mh(r.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
if((0,Jv.isSome)(t.impressionMetrics)){Object.assign(t.impressionMetrics.fields,o)
const e=u(n.disableFastImpressionsForAds)
t.impressionMetrics=new A3(t.impressionMetrics,!e)}(0,Jv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields[UM]=aF)}function jh(e,t,n,r,a,c,l){var u
const d=Vh(e,t,n.title,a)
d.lockupDisplayStyle=r,d.contentRating=null===(u=n.offerDisplayProperties)||void 0===u?void 0:u.contentRating,d.bundleId=n.bundleId,o(d.targetType)&&(d.targetType=cW),c&&Yf(e,t)&&(d.displaysArcadeUpsell=!0)
const f=a.id
return s(Jd(t))&&i(f)&&f.length>0&&(d.id=f),d}function Vh(e,t,n,r,o){return Kv.context(qR,()=>{var i,s,a
const c=wh(e,t),l=ph(e,t),u={...r,kind:c,softwareType:l,title:n,id:t.id}
if(et(e,t,Sq,o)&&(u.offerType=iH),r.isAdvert||r.isAdEligible){const n=null!==(i=u.adsMetricsData)&&void 0!==i?i:{}
n[VS]=!0
const o=null===(a=null===(s=r.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a?void 0:a.placementType,c=s1.containerIdFromType(e,o)
if((0,Jv.isSome)(c)){n[YB]=c
const e=Ys(r.locationTracker,r.adSlotOverride)
n[uF]=`${c}_${e}`}const l=B(t,GG)
if((0,Jv.isSome)(l)){const e=gh(l[iF])
n[eF]=e
const t=gh(l[DR])
n[WM]=t}u.adsMetricsData=n}return u})}function Hh(e,t,n,r){return Kv.context(qR,()=>{const o=wh(e,t),i=ph(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:Dq,displayStyle:uM}})}function qh(e,t,n,r){return Kv.context("impressionOptionsForMetadataRibbonItem",()=>({...e,id:t,kind:null,softwareType:null,title:n,idType:r,targetType:X$}))}function Wh(e,t,n){var r,o,i,s
const a=Fh(e,(r=t.term,o=n,i=t.entity,s=t.source,Kv.context("impressionOptionsForSearchHint",()=>({...o,id:"",kind:null,softwareType:null,title:r,hintsEntity:i,modelSource:s}))))
t.impressionMetrics=new KY(a)}function zh(e){const t=l(e,IH)
for(const e of t){const t=f(e,"id");(0,Jv.isNothing)(t)||(e.id=Yh(t))}}function Yh(e){return e.includes(T3)?e.split(T3)[0]:e}function Jh(e,t,n,r){return o(t.remainingItems)?null:`${$W}:/${VW.product}/${VW.shelf}/`+Kh(t,n,r)}function Kh(e,t,n){return e.sourceSequenceId=t.getSequenceId(),e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function Zh(e,t,n,r,o,i,s,a,c){return Qh(e,t.data,n,r,o,i,s,a,c)}function Qh(e,t,n,i,s,a,c,l,u){if(o(t))return null
const d=[],f={shouldShowSupportedPlatformLabel:null!=u&&u}
return{items:Nd(e,t,{shouldShowOnUnsupportedPlatform:null!=u&&u,lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:l},artworkUseCase:i,canDisplayArcadeOfferButton:rh(0,s),...r(a)?{}:{offerStyle:a},...f},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(d.push(t),!1),filter:c}),remainingItems:d}}function Xh(e,t,n){if(!n)return
let r=-1,o=null
n.forEach((e,n)=>{const i=e,s=i,a=i&&i.adamId===t,c=s&&s.productIdentifier===t;(a||c)&&(r=n,o=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,xj,"ad",{type:cL})))}),-1!==r&&(n.splice(r,1),n.splice(0,0,o))}function ep(e){if(-1===k3.indexOf(e.media.kind))return!1
const t=e.clickAction
if(!t)return!0
const n=t.pageUrl
if(!n)return!0
const r=new wz(n),o=tp()
for(const e of o)if(new vz(e).matches(r))return!1
return!0}function tp(){return[{protocol:FW,path:`/{countryCode}/${VW.product}/{appName}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.isPPT}?`,`${tz.appEventId}?-caseInsensitive`,`${tz.offerItemId}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,path:`/{countryCode}/${VW.productBundle}/{appName}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:`/{countryCode}/${VW.product}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.appEventId}?-caseInsensitive`,`${tz.offerItemId}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,path:`/{countryCode}/${VW.productBundle}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:`/${VW.product}/{appName}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.appEventId}?-caseInsensitive`,`${tz.offerItemId}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,path:`/${VW.productBundle}/{appName}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:`/${VW.product}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.appEventId}?-caseInsensitive`,`${tz.offerItemId}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,path:`/${VW.product}/{id}`,query:[`${tz.v0}?`,`${tz.metrics}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,path:`/${VW.productBundle}/{id}`,query:[`${tz.action}?`,`${tz.offerName}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,query:[tz.bundleIdentifier,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]},{protocol:FW,query:[tz.action,tz.ids,`${tz.isPurchasesApp}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:FW,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.offerItemId}?`]},{protocol:FW,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,hostName:`${qW}`,path:`/${VW.siri}/{id}`,query:[`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:FW,path:`/${VW.store}/${VW.viewSoftware}`,query:[tz.id,`${tz.v0}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`]},{protocol:$W,path:`/${VW.product}/{id}`,query:[tz.invalidateWidgetsOnFailure,`${tz.metrics}?`,`${tz.offerItemId}?`,`${tz.appEventId}?`,`${tz.isPreloading}?`,`${tz.isViewOnly}?`,`${tz.includeUnlistedApps}?`,`${tz.webBrowser}?`,`${tz.webBrowserFlowType}?`]}]}function np(e,t,n){const r=n[fV],o=C3.fromJSON(e,r)
let i
if(o.isBundleShelf)i=aW
else switch(o.contentType){case xV:case DU:case vF:i=sW
break
case pN:i=rq
break
default:i=yW}const s=[Hq,$q,LH]
return e.appleSilicon.isSupportEnabled&&s.push(xH),e.bag.enableUpdatedAgeRatings&&s.push(Fq),of(e)&&s.push(EH),new yY(e).withIdsOfType(o.remainingItems.map(e=>e.id),i).includingAdditionalPlatforms(ee(e)).includingAttributes(i===rq?[]:s)}async function rp(e,t,n,s,a=!1){const c=n[fV],l=C3.fromJSON(e,c)
l.isFirstRender=!1
const u=St(t)
l.recoMetricsData=null!=u?u:l.recoMetricsData,n[tz.shelfRefreshType]===dz&&b3.resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,l)
const d=function(e,t,n,s){return Kv.context("shelfFromLookupResponse",()=>{switch(n.onDemandShelfType){case Hm.SimilarItems:return function(e,t,n,i){return Kv.context("similarItemsSecondaryShelf",()=>{var s,a,c
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const l=new b3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),u=hq,d=VU,f={pageInformation:l.metricsPageInformation,locationTracker:l.locationTracker,targetType:u,id:b3.similarItemsShelfId,idType:d,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
Ch(0,f,n.title)
const h=new yJ(n.contentType)
if(Kt(e,oq)||Kt(e,SH)){const o=null===(s=Rh(l.locationTracker))||void 0===s?void 0:s.id;(0,Jv.isSome)(o)&&(null===(a=n.sourcePageInformation.adPageInfo)||void 0===a||a.recordAdResponseEventsIfNeeded(e,null==i?void 0:i.failureReason,o,0))
const u=function(e,t){var n
const r=null===(n=null==t?void 0:t.onDeviceAd)||void 0===n?void 0:n.positionInfo
if((0,Jv.isNothing)(r)||(0,Jv.isNothing)(t))return null
let o
switch(t.placementType){case oq:o=MG
break
case SH:o=PO}return(0,Jv.isNothing)(o)?null:Qa(e,t,{shelfIdentifier:o,slot:r.slot-1})}(e,i)
null===(c=l.metricsPageInformation.adPageInfo)||void 0===c||c.updateForAdResponse(e,i)
const d=function(e,t){if(r(e))return[]
const n=[]
return Object.entries(e.tasks).forEach(([r,o])=>{r.startsWith(t)&&(n.push(o),delete e.tasks[r])}),n}(u,o)
d.forEach(e=>{(t=t.filter(t=>t.id!==e.data.id)).splice(e.positionInfo.slot,0,e.data)})}const p=Qh(e,t,l,Qd(0,n.contentType),n.contentType,n.offerStyle,null,n.recoMetricsData)
if(o(p))return null
h.title=n.title,h.items=p.items,h.isHorizontal=!0
const w=new C3(n.productId,t,n.title,n.shouldInferSeeAllFromFetchesItems,void 0,n.contentType,null,null,null,null,null,Hm.SimilarItems),g=Yu(0,n.productId,w,l,n.destinationPageInformation)
return h.refreshUrl=g,t.length<2?h.rowsPerColumn=1:n.supportsArcade?h.rowsPerColumn=2:h.rowsPerColumn=3,l.addImpressionsFieldsToSimilarItemsShelf(e,h,u,d),un(e,[h],oq,f.id,f.pageInformation),Oh(l.locationTracker),_h(l.locationTracker),h})}(e,t.data,n,s)
case Hm.MoreByDeveloper:return function(e,t,n){return Kv.context("moreByDeveloperSecondaryShelf",()=>{if(o(t))return null
const r=new b3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId)
Ch(0,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:yq,id:`${r.getSequenceId()}`,idType:Oq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData},n.title)
const i=new yJ(n.contentType)
i.title=n.title
const s=e.client.isCompanionVisionApp?rm.VisionOSCompatibility:void 0,a=Qh(e,t,r,Qd(0,n.contentType),n.contentType,n.offerStyle,s)
if(o(a))return null
if(i.items=a.items,i.isHorizontal=!0,t.length<2?i.rowsPerColumn=1:i.rowsPerColumn=2,(0,Jv.isSome)(n.developerUrl)){const t=new FY(SW)
t.pageUrl=n.developerUrl,t.title=e.loc.string(gH),ea(e,t,t.pageUrl,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),i.seeAllAction=t}return r.addImpressionsToShelf(e,i,VH),Oh(r.locationTracker),_h(r.locationTracker),i})}(e,t.data,n)
case Hm.SmallStory:return function(e,t,n){return Kv.context("smallStorySecondaryShelf",()=>{if(o(t))return null
const r=new b3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),i={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:yq,id:`${r.getSequenceId()}`,idType:Oq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
let s
if(Ch(0,i,n.title),Ju(e)){const r=new zZ(i.pageInformation,i.locationTracker)
s=Wc(e,null!=t?t:[],n.title,null,r)}else{const r={metricsLocationTracker:i.locationTracker,metricsPageInformation:i.pageInformation,filterOutMediaCardKinds:op(e.host.platform)}
s=qc(e,t,xV,n.title,null,r),Array.isArray(null==s?void 0:s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Vc(0,e.media.kind,xV)))}return s.isHorizontal=!0,r.addImpressionsToShelf(e,s,TH),Oh(r.locationTracker),_h(r.locationTracker),s})}(e,t.data,n)}const a=new yJ(n.contentType),c=St(t),l={pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,excludeAttribution:!0,recoMetricsData:null!=c?c:n.recoMetricsData}
let u
if(n.contentType===DU){const n=Yc(e,t.data,l.pageInformation,l.locationTracker,ep)
i(n)&&(u=[n])}else{const r={metricsOptions:l,offerStyle:n.offerStyle,artworkUseCase:Qd(0,n.contentType),canDisplayArcadeOfferButton:rh(0,n.contentType)}
n.contentType===pN&&(r.skipDefaultClickAction=!0)
const o={lockupOptions:r}
n.isBundleShelf&&(o.filter=rm.None)
const i=Fd(e,t,o),s={[hY]:L$,[pY]:wN}[e.host.clientIdentifier]
s&&i.sort((e,t)=>{const n=e.icon.style===s,r=t.icon.style===s
return n&&r?0:n&&!r?-1:1})
const a=n.spotlightInAppProductIdentifier
a&&Xh(0,a,i),u=i}return a.items=u,a.mergeWhenFetched=!0,a})}(e,t,l,s)
if(a&&function(e,t,n,o){if(r(n))return
let i=[]
const s=Nt(n),a=Jn(e,n,o)
i.push(a)
const c=Qn(e,n,o).map(e=>e.data)
i=i.concat(c),Yn(s),i.forEach(e=>Yn(e.fields)),t.pageChangeMetrics={pageFields:s,updatedEvents:i}}(e,d,l.sourcePageInformation),d.refreshUrl=l.refreshUrl,n[tz.shelfRefreshType]===dz&&b3.addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,d,l),l.shouldInferSeeAllFromFetchesItems){const t=new FY(SW)
t.title=e.loc.string(gH)
const n=new yJ(d.contentType)
n.items=function(e,t,n,r=!1){var o,s
if(!t)return null
let a=0
const c=[]
for(const e of t){if(r&&i(null!==(o=e.searchAd)&&void 0!==o?o:null===(s=e.searchAdOpportunity)||void 0===s?void 0:s.searchAd)){a+=1
continue}const t=S(e)
if(n&&t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,n)),a>0){const e=S(t.impressionMetrics.fields),n=h(e.impressionIndex);(0,Zv.isSome)(n)&&(e.impressionIndex=n-a,t.impressionMetrics=new KY(e,t.impressionMetrics.id,t.impressionMetrics.custom))}c.push(t)}return c}(0,d.items,WH,!0)
const r=new bJ([n])
jn(e,r,l.destinationPageInformation),r.title=l.title,t.pageData=r,ea(e,t,null,{pageInformation:l.sourcePageInformation,locationTracker:l.sourceLocationTracker}),d.seeAllAction=t}return o(d.items)&&!l.hasExistingContent&&(d.isHidden=!0),d}function op(e){const t=new Set([sB])
return e===KV&&(t.add(Cj),t.add(iO),t.add(tG),t.add(uL)),t}async function ip(e,t){return typeof campaignAttribution!==_U?await campaignAttribution.processRedirectURL(t):await e.network.fetch({url:e.bag.redirectUrlEndpoint,method:yG,headers:{"Content-Type":ix},body:`url=${encodeURIComponent(t)}`}).then(e=>e.ok)}async function sp(e,t){const n=e.required(O3)
0!==Mn(e,new wz(t.url)).length&&ip(e,t.url),t.url=function(e,t){const n=new wz(t.url)
if(JO in n.query){const r=f(t.referrerData,rW)===Uz,o=e.host.clientIdentifier===Bz
return r||o||delete n.query[JO],n.toString()}return t.url}(e,t)
const r=new $m.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r)
return await n.fetchAction(o,t.url,t.referrerData).then(n=>{if(!n)throw new Error(`Promise resolved to null action for: ${t.url}`)
if(t.isIncomingURL){const e=[n]
if(T(o=n)&&o[PW]===aO)for(const t of n.actions)e.push(t)
for(const t of e){const e=t.pageData
e&&typeof e===vV&&SB in e&&zn(0,e)}}var o
if(n.actionClass===fL){const e=n
e.page===kj||e.page===Eq||e.page===zO||e.page===Dj||e.page===nN||e.page===s$||e.page===bH||e.page===I$||e.page===YO?e.presentationContext=WH:e.page===WA?e.presentationContext=yL:e.page===bB?e.presentationContext=Qj:t.isIncomingURL?e.presentationContext=kL:(e.presentationContext="replace",e.animationBehavior=dH)}return t.isIncomingURL&&(e.deepLinks.hasResilientDeepLinks()||e.deepLinks.removeDeepLink(t.url)),r.decorate(n),n}).catch(n=>{let r=[]
n instanceof Az?r=n.reasons.filter(e=>e instanceof QK):n instanceof QK&&r.push(n)
for(const n of r)if(204===n.statusCode){const n=new GY(Gq)
n.title=e.loc.string("APP_NOT_AVAILABLE_TITLE"),n.message=e.loc.string("APP_NOT_AVAILABLE_MESSAGE"),n.isCancelable=!0
{const r=new LX(tW)
if(r.title=e.loc.string(BL),v(new wz(t.url).query[zA])){const e=new J3
r.actions=[n,e]}else r.actions=[n]
return r}}throw Error(n.message)})}function ap(e,t,n){switch(t){case mO:return function(e,t){const n=za(e,e.bag.accountUrl)
return n.title=e.loc.string("VIEW_ACCOUNT_INFO",a$),Xs(e,n,{...t,id:bH,actionType:bW},!1,aU),n}(e,n)
case yO:return function(e,t){const n=e.bag.signup
if((0,Zv.isNothing)(n))return null
const r=za(e,n)
return e.featureFlags.isEnabled(CJ)?r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID_REBRAND"):r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID"),Xs(e,r,{...t,id:bH,actionType:bW},!1,aU),r}(e,n)
case PL:return function(e,t){if((0,Zv.isNothing)(e.bag.purchaseHistoryUrl))return null
const n=za(e,e.bag.purchaseHistoryUrl)
return n.title=e.loc.string("ACCOUNT_PURCHASE_HISTORY"),n.presentationContext=kL,Xs(e,n,{...t,id:PL,actionType:bW},!1,aU),n}(e,n)
case ZF:return function(e,t){if(e.user&&e.user.isManagedAppleID)return null
const n=za(e,e.bag.redeemUrl)
return n.title=e.loc.string("ACCOUNT_REDEEM",bO),Xs(e,n,{...t,id:"redeemGiftCardOrCode",actionType:bW},!1,aU),n}(e,n)
case AO:return function(e,t){if(!e.bag.isMonetaryGiftingEnabled)return null
const n=za(e,QF)
return n.title=e.loc.string("ACCOUNT_SEND_GIFT",fA),Xs(e,n,{...t,id:"sendGiftCardByEmail",actionType:bW},!1,aU),n}(e,n)
case TO:return function(e,t){var n
const r=e.bag.accountTopUpURL
if((0,Zv.isNothing)(r)||o(r))return null
const i=za(e,r)
return i.title=null!==(n=e.bag.accountTopUpTitle)&&void 0!==n?n:e.loc.string("ACCOUNT_TOP_UP"),Xs(e,i,{...t,id:"addFundsToAppleId",actionType:bW},!1,aU),i}(e,n)
case IL:return function(e,t){const n=new t9(Pq,hA)
return n.title=e.loc.string("ACCOUNT_SETUP_FAMILY_SHARING"),Xs(e,n,{...t,id:"setUpFamilySharing",actionType:bW},!1,aU),n}(e,n)
case CL:return function(e,t){const n=za(e,e.bag.manageSubscriptionsV2Url)
return n.title=e.loc.string("ACCOUNT_SUBSCRIPTIONS"),n.presentationContext=kL,Xs(e,n,{...t,id:CL,actionType:bW},!1,aU),n}(e,n)
default:return null}}function cp(e){const t=new $m.FetchTimingMetricsBuilder,n=e.addingFetchTimingMetricsBuilder(t),r={pageInformation:Gn(e,a$,bH,""),locationTracker:{rootPosition:0,locationStack:[]},targetType:jq},o=t.measureModelConstruction(()=>{const t=new e9
return t.links[mO]=ap(e,mO,r),t.links[yO]=ap(e,yO,r),t.links[ZF]=ap(e,ZF,r),t.links[AO]=ap(e,AO,r),t.links[TO]=ap(e,TO,r),t.links[IL]=ap(e,IL,r),t.links[CL]=ap(e,CL,r),t.links[PL]=ap(e,PL,r),t})
return jn(n,o,r.pageInformation),o}async function lp(e,t){return await e.required(O3).fetchPage(e,t,s9)}async function up(e){let t
try{t=await Ln(e,function(e){return new yY(e).forType(U_)}(e))}catch{t=void 0}return function(e,t){const r=[],o=new c9,i=new qX(e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_IN"),JV,I$)
o.addContentItem(new u9(i))
const a=e.bag.personalizedRecommendationsToggleEnabled
if(!a){const t={}
t[e.loc.string(G_)]=hp(e)
const n=new D5(e.loc.string("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",e.loc.string(G_)))
o.footer=new _5(n,t)}if(r.push(o),a){const t=new c9
t.addContentItem(new d9(e.loc.string(LC),!1))
const n=new D5(e.loc.string(MC))
t.footer=new _5(n),r.push(t)}{const t=new c9(e.loc.string("PERSONALIZATION_SECTION_USAGE_HEADER")),n=new D5(e.loc.string("PERSONALIZATION_SECTION_USAGE_FOOTER"))
t.footer=new _5(n),t.addContentItem(new f9(e.loc.string("PERSONALIZATION_SECTION_USAGE_CLEAR_DATA"),function(e){const t=new p9
t.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_TITLE")
const n=new IZ([t])
return n.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_HEADER"),n.isCancelable=!0,n.destructiveActionIndex=0,n}(e))),r.push(t)}const c=new c9(e.loc.string("PERSONALIZATION_INTERACTIONS")),l=new D5(e.loc.string("PERSONALIZATION_INTERACTIONS_FOOTER"))
c.footer=new _5(l)
const u=e.bag.purchaseHistoryUrl;(0,Jv.isSome)(u)?c.addContentItem(new f9(e.loc.string(xC),fp(e,kj,u,!0),nB)):c.addContentItem(new f9(e.loc.string(xC),fp(e,Ky,null,!0),nB)),c.addContentItem(new f9(e.loc.string("PERSONALIZATION_SUBSCRIPTIONS"),fp(e,null,e.bag.manageSubscriptionsV2Url,!1),nB)),c.addContentItem(new f9(e.loc.string("PERSONALIZATION_PREORDERS"),fp(e,null,e.bag.managePreordersUrl,!0),nB)),c.addContentItem(new f9(e.loc.string("PERSONALIZATION_RATINGS"),fp(e,null,e.bag.ratingsReviewsUrl,!0),nB)),r.push(c)
const d=new c9(e.loc.string("PERSONALIZATION_ADDITIONAL_INFO")),h=[e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),p=new qX(h,JV,I$)
d.addContentItem(new u9(p)),r.push(d)
const w=n(t,"results.derived-user-info")
if(s(w)){const t=new c9(e.loc.string("ACCOUNT_INFO")),n=["gender","birthyear"]
for(const e of n){const n=f(w,`${e}.label`),r=f(w,`${e}.value`);(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0&&t.addContentItem(new h9(n,r))}const o=e.featureFlags.isEnabled(CJ)?"PERSONALIZATION_ACCOUNT_INFO_FOOTER_REBRAND":"PERSONALIZATION_ACCOUNT_INFO_FOOTER",i=new D5(e.loc.string(o))
t.footer=new _5(i),r.push(t)}return new s9(e.loc.string($C),r)}(e,t)}function dp(e){const t=[],n=e.bag.personalizedRecommendationsToggleEnabled,r=new c9,o=n?e.loc.string("PersonalizedRecommendations.OptedOut.Description"):e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_OUT"),i=new qX(o)
if(r.addContentItem(new u9(i)),t.push(r),n){const n=new c9
n.addContentItem(new d9(e.loc.string(LC),!1))
const r=new D5(e.loc.string(MC))
n.footer=new _5(r),t.push(n)}else{const n=new c9
n.addContentItem(new f9(e.loc.string(G_),hp(e),nB)),t.push(n)}return new s9(e.loc.string($C),t)}function fp(e,t,n,r){let o
if((0,Jv.isSome)(t))o=new FY(t,n)
else{if((0,Jv.isNothing)(n))return null
o=za(e,n)}return r&&(o.presentationContext=kL),o}function hp(e){return fp(e,void 0,e.bag.accountUrl,!1)}async function pp(e,t){const n=new yY(e).forType(FC).addingQuery(QD,"events-reminders").addingQuery("service",nL).addingQuery(cq,"explicit")
n.isMediaRealmRequest=!0
const r=function(e,t){const n={"events-reminders":{"com.apple.AppStore":{contents:[{id:e,type:hW,notify:t}]}}}
return{method:"PATCH",headers:{"Content-Type":cM},requestBodyString:JSON.stringify(n)}}(t.appEventId,t.shouldSchedule)
return await new Promise((t,o)=>{Ln(e,n,r).then(e=>{t(!0)}).catch(e=>{o(e)})})}function wp(e){return Ne(e,nm.ArcadeDownloadPackOnboarding)||Ym.LayoutB}function gp(e){K9||(K9=!0,Z9=new $9(e.loc.string("PAGE_FACETS_SORTS_RELEASE_DATE"),U9,hU),Q9=new $9(e.loc.string("PAGE_FACETS_SORTS_LAST_UPDATED"),G9,"lastUpdated"),X9=new $9(e.loc.string("PAGE_FACETS_SORTS_NAME"),j9,AW),e8=new $9(e.loc.string("PAGE_FACETS_SORTS_CATEGORY"),V9,Zj),t8=new $9(e.loc.string("PAGE_FACETS_DEFAULT_ALL"),null),n8=new $9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),r8=new $9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),o8=new $9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),i8=new $9(e.loc.string(MA),bq,null,"gamecontroller"),s8=new $9(e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER"),bq,null,"person.2"),a8=new $9(e.loc.string(xA),bq),J9[tz.sort]={releaseDate:[Z9],lastUpdated:[Q9],name:[X9],category:[e8]},J9[tz.ageRating]={"4plus":[n8],"9plus":[r8],"12plus":[o8]},J9[tz.controllerSupport]={true:[i8],false:[]},J9[tz.multiplayerSupport]={true:[s8],false:[]},J9[tz.comingSoon]={true:[a8],false:[]})}function vp(e,t={}){gp(e)
const n={"filter[ageRating]":[t8]}
n[H9]=[Z9],n[q9]=[a8]
const r=[tz.sort,tz.ageRating,tz.controllerSupport,tz.multiplayerSupport,tz.comingSoon]
for(const e of r){const r=t[e]
if(o(r))continue
const a=J9[e][r],c=c8[e]
i(a)&&s(c)&&(n[`${c}`]=a)}return n}function mp(e,t){const n=new xW
return ta(e,n,t),n}function yp(e){const t=[Hq,$q,hH,wH,Lj,eV]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}function Ap(e,t,n){return Kv.context("createShelves",()=>{const r=[]
if(0===t.length)return r
let o=!1
for(const s of t)if(o=o||!W(s.data[0]),o)n.remainingGroups.push(s)
else{const t={index:n.lastShelfIndex,title:bp(e,s),contentType:(i=n.isCompactMode,i?Lq:lN),shouldFilter:!1,remainingContent:s.data,groupKind:s.kind,isCompactMode:n.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker},o=Tp(e,t)
r.push(o),n.lastShelfIndex++}var i
return r})}function Tp(e,t){const n=[],r=new yJ(t.contentType)
r.title=t.title,r.presentationHints={showSupplementaryText:!1},r.isHorizontal=t.groupKind===pU||t.groupKind===Zj
const i={id:`${t.index}`,kind:null,softwareType:null,targetType:yq,title:r.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:Oq}
for(Nh(e,r,i),Ch(0,i,r.title);s(t.remainingContent)&&W(t.remainingContent[0]);){const r=t.remainingContent.shift(),o={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},artworkUseCase:O6.LockupIconSmall,canDisplayArcadeOfferButton:rh(0,t.contentType),shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ),isContainedInPreorderExclusiveShelf:t.groupKind===pU},i=_d(e,r,o,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},null,null)
Sp(e,i,r)&&(i.editorialTagline=null,i.developerTagline=null,n.push(i),_h(t.metricsLocationTracker))}return r.mergeWhenFetched=t.hasExistingContent,t.hasExistingContent=t.hasExistingContent||n.length>0,r.items=n,s(t.remainingContent)?r.url=function(e){return o(e.remainingContent)?null:`${$W}:/${VW.arcadeSeeAllGames}/${VW.shelf}/?${tz.token}=${encodeURIComponent(JSON.stringify(e))}`}(t):"tv"!==e.client.deviceType&&t.isCompactMode&&r.items.length<3&&(r.rowsPerColumn=r.items.length),Oh(t.metricsLocationTracker),r}function bp(e,t){let n,r,o=null,i=null
if((!t.name||0===t.name.length)&&t.kind!==pU)return""
switch(t.kind){case"releaseDateByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE"),n=e.loc.formatDateInSentence(r,HA,i)
break
case"lastUpdatedByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),n=e.loc.formatDateInSentence(r,HA,i)
break
case pU:n=e.loc.string("Arcade.SeeAllGames.ComingSoonShelf.Title")
break
default:n=t.name}return n}function Sp(e,t,n){if(o(t.trailers)){const r=$f(e,n)
if(s(r)){const e=new Iz
r.playbackControls={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},r.autoPlayPlaybackControls={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0},r.canPlayFullScreen=!0,e.videos=[r],t.trailers=[e]}}return o(t.trailers)&&function(e){const t=e.screenshots[0]
if(o(t))return
const n=t.artwork[0],r=new Cz(l8,n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,autoPlayPlaybackControls:{},playbackControls:{}}),i=new Iz
i.videos=[r],e.trailers=[i]}(t),s(t.trailers)}async function Pp(e,t){const n=e.required(O3),r=wz.from(t.url)
return r.param(tz.requestDescriptor,JSON.stringify(t)),await n.fetchPage(e,r.build(),x9)}async function Ip(e,t){const n=e.required(O3)
return await n.fetchMoreOfPage(e,t).then(function(e){return e})}function Cp(e,t){const n=vp(e,t),r={}
for(const e of Object.keys(n))r[e]=n[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue,systemImageName:e.systemImageName}))
const o={url:`${$W}:/${VW.arcadeSeeAllGames}`,isCompactMode:!1,selectedFacetOptions:r},i=t[tz.requestDescriptor]
if(s(i)){const e=g(JSON.parse(i))
o.isCompactMode=e.isCompactMode,Object.assign(o.selectedFacetOptions,e.selectedFacetOptions)}return o}async function kp(e,t){const n=wz.from(t)
return await e.required(O3).fetchPage(e,n.build(),h8)}function Op(e){let t=0,n=0
for(const r of e.shelves)(0,Jv.isSome)(r.batchGroup)&&r.batchGroup.length>0||(r.batchGroup=`shelfBatchGroup_${t}`,n++,5===n&&(n=0,t++))}async function Ep(e,t){const n=wz.from(t.url)
return n.param(tz.isArcade,"true"),n.param(tz.isSubscribed,`${t.isSubscribed}`),n.param(tz.isTrialAvailable,`${t.isTrialAvailable}`),n.param(tz.isTrialEnrolled,`${t.isTrialEnrolled}`),await e.required(O3).fetchPage(e,n.build(),g8)}function Rp(e,t){const n=new LX(pW)
n.popToRoot=!0
const r=new iK([n])
return r.title=t,r}async function Dp(e,t){return await e.required(O3).fetchPage(e,t,T8)}async function _p(e,t){const n=new Promise((n,r)=>{const o=t
s(o)||r(new Error("fetchUpsellGrid called with malformed contentDictionary"))
const i=we(o,mW),a={pageInformation:new uK({}),locationTracker:{rootPosition:0,locationStack:[]}},c=tf(e,i,a,{useCase:O6.LockupIconMedium}),l=c.shift()
n(new E8(l,c))})
return await n}async function Lp(e,t){const n=g(t,fV)
let r=n.buyParams
const o=g(t,HC),i=g(t,qC);(0,Jv.isSome)(i)&&(o.adPageInfo={adAdamId:i._adAdamId,...i}),r=pr(e,f(t,HV),r,o,u(t,WC),u(t,zC),f(t,YC),f(t,JC),f(t,V_),p(t,_j),p(t,KC),g(t,ZC),f(t,QC),f(t,"token.extRefApp2"),f(t,"token.extRefUrl2"))
const s=new fK(r),a={product:f(t,kH)||n.productIdentifier,adamId:f(t,HV),buyParams:s.toEncodedMap()}
return await Promise.resolve(a)}async function Mp(e,t){const n=t.offerAction,o=t.offerDisplayProperties
if(!n||!o)return await Promise.reject(new Error("Invalid offerToken for personalized offer fetch."))
const i=[n.adamId];(0,Jv.isSome)(t.supportedBundleChildrenIds)&&i.push(...t.supportedBundleChildrenIds)
const s={"Content-Type":ix},a={url:e.bag.buyButtonMetadataURL,method:yG,headers:s,body:"ids="+i.join(","),signingStyle:nH},c=e.network.fetch(a)
return await c.then(i=>{if(!i.ok)throw Error(`Bad Status code ${i.status} for ${a.url}`)
const s=JSON.parse(i.body)
if((0,Jv.isSome)(t.freeBundleId)&&(0,Jv.isSome)(t.supportedBundleChildrenIds)){let r=!0
for(const e of t.supportedBundleChildrenIds)if(!xp(p(s,e))){r=!1
break}if(r)return function(e,t,n){const r=$r(e,t,rW,n,rG)
return r.titles[wW]=e.loc.string(ek),new M8(KF,t,r)}(e,n,o)}const c=p(s,n.adamId)
let u=null,d=null
const h=function(e,t){return Kv.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const e=l(t,Fj)
if(0===e.length)return null
for(const t of e){const e=f(t,jV)
if(e)return e}return Iq})}(0,c)
if(r(h))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata")
if(h!==Iq){let t=xj
u=function(e,t,n,o){return Kv.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const o=l(t,Fj)
if(0===o.length)return null
let i,s=null
for(const e of o)switch(i=f(e,jV),i){case ux:case KF:s=e
break
default:s=null}if(!s)return null
let a=f(s,Ej)
if(i===ux&&r(a))return Kv.unexpectedNull(DH,zq,pR),null
a||(a="")
const c=n.purchaseConfiguration,u=new kZ(a,c.vendor,c.appName,c.bundleId,c.appPlatforms,c.isPreorder,c.excludeAttribution,c.metricsPlatformDisplayStyle,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.appCapabilities,c.isDefaultBrowser,c.remoteDownloadIdentifiers,c.hasMacIPAPackage,c.contentRating)
u.pageInformation=c.pageInformation
const d=Tr(e,s,n.adamId,u,!1)
return function(e,t,n,r){const o=n.purchaseConfiguration.pageInformation
let i
if((0,Zv.isSome)(n.actionMetrics))for(const e of n.actionMetrics.data)if(i=l(m(e.fields),dG),i)break
Zs(e,t,t.adamId,false,o,i,!1)}(e,d,n),d})}(e,c,n)
let i=null
switch(h){case KF:t=rG,i=e.loc.string(ek)
break
case ux:(r(u.price)||0===u.price)&&(i=e.loc.string(dx))}d=$r(e,u,rW,o,t),i&&(d.titles[wW]=i)}const w=Er(e,u,!1)
return new M8(h,w,d)})}function xp(e){if((0,Jv.isNothing)(e))return!1
const t=w(e,Fj)
if((0,Jv.isNothing)(t)||0===t.length)return!1
for(const e of t)if(f(e,jV)===WL)return!0
return!1}async function $p(e,t){var n
let r=f(t,"token.buyParams")
const s=f(t,"overrideBuyParams")
i(s)&&(r=function(e,t){const n=new fK(e),r=new fK(t),i=n.get(LZ.placementId,null);(null==i?void 0:i.length)>0&&o(r.get(LZ.placementId,null))&&r.set(LZ.placementId,i,null)
const s=n.get(LZ.containerId,null);(null==s?void 0:s.length)>0&&o(r.get(LZ.containerId,null))&&r.set(LZ.containerId,s,null)
const a=n.get(LZ.templateType,null)
return(null==a?void 0:a.length)>0&&o(r.get(LZ.templateType,null))&&r.set(LZ.templateType,a,null),r.toString()}(r,s))
const a=g(t,HC),c=g(t,qC);(0,Jv.isSome)(c)&&(a.adPageInfo={adAdamId:c._adAdamId,...c}),r=pr(e,f(t,HV),r,a,u(t,WC),u(t,zC),f(t,YC),f(t,JC),f(t,V_),p(t,_j),p(t,KC),g(t,ZC),f(t,QC),f(t,"metrics.extRefApp2"),f(t,"metrics.extRefUrl2"))
const d=l(t,"token.appPlatforms"),w=d&&d.length&&d.length>0&&d.indexOf("tv")>=0,m=d&&d.length&&d.length>0&&d.indexOf(iW)>=0,y=u(t,"token.isHalva")||u(t,"token.isMacOSCompatibleIOSApp"),A=u(t,"token.supportsVisionOSCompatibleIOSBinary"),T=Cf(0,e.client.deviceType,y,A).some(e=>-1!==d.indexOf(e)),b=y&&!1,S=(d.indexOf(iW),A&&!1),P=f(t,"instalationType"),I=P===lx,C=P===WL,k=u(t,"token.isPreorder"),O=!(k||(w||m)&&!T),E=f(t,V_)===gW&&e.client.deviceType!==gW,R=f(t,"token.preflightPackageUrl"),D={...p(t,"token.additionalHeaders",{}),...p(t,"additionalHeaders",{})}
let _={}
const L=null===(n=e.paymentMetricsIdentifiersCache)||void 0===n?void 0:n.getMetricsFieldsForTypes([im.user,im.client,im.canonical])
return(0,Jv.isSome)(L)&&(_={...L}),{adamId:f(t,HV),buyParams:r,vendor:f(t,"token.vendor"),appName:f(t,"token.appName"),bundleId:f(t,"token.bundleId"),appPlatforms:d,additionalHeaders:D,isUpdate:I,isRedownload:C,isPreorder:k,createsJobs:O,preflightPackageUrl:R,isArcadeApp:v(t,"token.isArcadeApp"),forceWatchInstall:E,isMacOSCompatibleIOSApp:b,isVisionOSCompatibleIOSApp:S,presentingSceneIdentifier:f(t,"presentingSceneIdentifier"),appCapabilities:l(t,"token.appCapabilities"),isDefaultBrowser:v(t,"token.isDefaultBrowser"),requiresExceptionRequest:v(t,"requiresExceptionRequest"),forceAskToBuyReason:f(t,"forceAskToBuyReason"),contentRating:h(t,"token.contentRating"),metricsOverlay:_,remoteDownloadIdentifiers:l(t,"token.remoteDownloadIdentifiers"),hasMacIPAPackage:v(t,"token.hasMacIPAPackage")}}async function Fp(e,t){const n=new yY(e).withIdsOfType(t,yW).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>{const n=At(t),r={}
for(const t of n)r[t.id]=rf(e,t,{useCase:O6.LockupIconLarge})
return r})}async function Np(e,t){const n=new IK(t.targetingData,e.random.nextUUID()),r=Up(e,t)
if(null===r)return null
const o=Ln(e,r,function(e,t){const n={}
return(0,Zv.isSome)(t)&&t.validAdRequest()&&(n["X-Apple-App-Store-Client-Request-Id"]=t.appStoreClientRequestId,n["X-Apple-iAd-Request-Data"]=t.requestData,n["X-Apple-iAd-Env-Name"]=t.routingInfo),{headers:n}}(0,n))
if(e.bag.mediaAPISearchFocusEnabled){const n={term:t.term.trim(),entity:t.searchEntity}
e.onDeviceSearchHistoryManager.saveRecentSearchWithLimit(n,30)}const s=async function(e,t,n,r){var o
if(!t.validAdRequest())return Zt(e,"ODML fetch skipped - Malformed request"),{adverts:[],odmlSuccess:!1}
const i=await r,s=function(e,t){const n=t.results[u_]
if((0,Jv.isNothing)(n))return[]
const r=At(n),o=[]
for(const t of r){const n=f(t,"id"),r=B(t,tU)
if((0,Jv.isNothing)(n)||0===n.length||(0,Jv.isNothing)(r))continue
let i=null,s=null
e.bag.enableCPPInSearchAds&&(i=Ve(Ge(e,t)),s=qe(e,t)),o.push({instanceId:e.random.nextUUID(),adamId:n,assetInformation:{},adData:r,cppIds:s,serverCppId:i,selectedCppId:i,appBinaryTraits:Pf(e,t)})}return o}(e,i),a=function(e,t,n){const r=At(t.results.search),o=[]
for(const e of r){const t=f(e,"id");(0,Jv.isNothing)(t)||0===t.length||o.push({adamId:t,assetInformation:{}})}return o}(0,i)
if(!e.isAvailable(Xz))return Zt(e,"ODML fetch skipped - Unsupported client"),{adverts:s,odmlSuccess:!1}
try{if(e.clientCapabilities.isEnabled(CY)&&e.bag.enableSRPOnDeviceAdsRanker){const t=function(e,t){const n=[],r=t.results[u_]
if((0,Jv.isNothing)(r))return[]
const o=At(r)
for(const t of o){const r=f(t,"id"),o=B(t,tU)
if((0,Jv.isNothing)(r)||0===r.length||(0,Jv.isNothing)(o))continue
const i=f(t.meta,"extraAdInfo"),s={instanceId:e.random.nextUUID(),adamId:r,assetInformation:{},appBinaryTraits:Pf(e,t),position:-1,adData:o,commonAdInfo:(0,Jv.isSome)(i)?JSON.parse(i):[]}
n.push(s)}const i=At(t.results.search)
for(const[t,r]of i.entries()){const o=f(r,"id")
if((0,Jv.isNothing)(o)||0===o.length)continue
const i={instanceId:e.random.nextUUID(),adamId:o,assetInformation:{},appBinaryTraits:Pf(e,r),position:t,adData:void 0,commonAdInfo:void 0}
n.push(i)}return n}(e,i),r=function(e,t){const n=f(t.meta,pA)
return(0,Jv.isNothing)(n)?{}:JSON.parse(n)}(0,i)
return await e.ads.processAndRankAds(t,r,n,e.bag.sponsoredSearchODMLTimeout)}{const t=await e.ads.processAdvertsForSponsoredSearch(s,a,n,e.bag.sponsoredSearchODMLTimeout,e.client.isPhone||e.client.isPad)
return t.odmlSuccess?Zt(e,"ODML processing completed"):Zt(e,"ODML processing failed"),{adverts:null!==(o=t.adverts)&&void 0!==o?o:s,odmlSuccess:t.odmlSuccess,installedStates:t.installedStates,appliedPolicy:t.appliedPolicy,appStates:t.appStates}}}catch(t){return Zt(e,`ODML fetch failed - ${t}`),{adverts:s,odmlSuccess:!1}}}(e,n,t.term,o),a=async function(e){if(function(e){switch(e){case oW:case vW:return!0
default:return!1}}(e.client.deviceType)){const t=An(e,null,null,ee(e))
if(t)return await Ln(e,t).catch(()=>null)}return null}(e)
return await Promise.all([o,s,a]).then(([o,s,a])=>{var c,l,u,d
if(function(e){var t
const n=St(e),r=YD
i(n)&&i(e.meta)&&i(null===(t=e.meta)||void 0===t?void 0:t.metrics)&&(e.meta.metrics[pZ]=f(n,r),delete e.meta.metrics[r])}(o),null===(u=null===(l=null===(c=o.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.naturalLanguage){const t=e.storage.retrieveString(n_),n=_e(new Date).getTime().toString()
e.storage.storeString(n_,n),null===(d=e.amsEngagement)||void 0===d||d.enqueueData({eventType:"lastNLSQueryDateChange",app:nL,oldState:t,newState:n})}return{catalogResponse:o,categoriesFilterData:a,searchResultsAdsRequestData:n,searchResultsAdData:s,requestMetadata:{requestDescriptor:t,searchRequestUrl:ve(e,r).toString()}}})}async function Bp(e,t){const n=function(e,t){const n=e.bag.isLLMSearchTagsEnabled||u(e.bag.supportedMixedMediaRequestUsecases[Rq]),r=new yY(e,t,n,[_V]).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(sW,[o_]).includingAttributes(Gp(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
return Je(e,r,t),r.includingRelationships(z8),ii(e)&&(r.includingAssociateKeys(yW,[hW]),r.includingScopedAttributes(hW,nZ),r.includingScopedRelationships(sW,[RH])),r}(e,t)
return await Ln(e,n)}function Up(e,t){var n
const r=null===(n=t.term)||void 0===n?void 0:n.trim()
if(o(r))return null
const i=t.origin,a=t.source,c=t.searchEntity,l=t.facets,d=t.selectedFacetOptions,f=t.spellCheckEnabled,h=t.excludedTerms,p=e.host.clientIdentifier,w=new yY(e).withSearchTerm(r).includingAdditionalPlatforms(ee(e)).includingAttributes(Gp(e)).includingScopedAttributes(sW,[o_]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
if(su(e,w),w.includingRelationships(z8),ii(e)&&(w.includingAssociateKeys(yW,[hW]),w.includingScopedAttributes(hW,nZ),w.includingScopedRelationships(sW,[RH])),u(e.client.isTinkerWatch)&&w.withFilter(HG,"tinker"),w.enablingFeature(Zx),w.enablingFeature(KI),s(t.guidedSearchTokens)&&w.addingQuery("selectedFacets",t.guidedSearchTokens.join(",")),s(t.guidedSearchOptimizationTerm)&&w.addingQuery("finalTerm",t.guidedSearchOptimizationTerm),e.bag.isLLMSearchTagsEnabled&&w.includingAssociateKeys("results:apps",[_V]),e.featureFlags.isEnabled(GJ)&&w.includingScopedAttributes(yW,[eV]),c===oG?w.searchingOverTypes([sW]):c===VH?w.searchingOverTypes([yV]):c===gW||c===pW?w.searchingOverTypes([yW]).withFilter(HG,c):w.searchingOverTypes([yW,yV,UV,sW,aW,rq]),e.appleSilicon.isSupportEnabled&&!e.appleSilicon.isRosettaAvailable&&w.addingQuery("restrict","!requiresRosetta"),l)for(const e of Object.keys(l))w.addingQuery(e,l[e])
if(d)for(const e of Object.keys(d)){const t=N9.requestValuesForSelectedFacetOptions(d[e])
if(s(t)){w.addingQuery(e,t.value)
for(const e of Object.keys(t.additionalKeyValuePairs))w.addingQuery(e,t.additionalKeyValuePairs[e])}}const g=e.bag.isNaturalLanguageSearchEnabled||e.bag.isNaturalLanguageSearchResultsEnabled,v=g?"source":"src"
if(i===tF){const e=g&&(null==a?void 0:a.length)?"hint:".concat(a):oF
w.addingQuery(v,e)}else i===GR?w.addingQuery(v,GP):i===JB?w.addingQuery(v,JB):i===jR?w.addingQuery(v,"searchInstead"):i===VR?w.addingQuery(v,FS):i===i_&&w.addingQuery(v,gj)
switch(p){case hY:w.addingContext(gW)
break
case pY:w.addingContext(pq)
break
case wY:w.addingContext(pW)}return w.addingQuery("limit[ads-result]",e.bag.mediaAdvertRequestLimit.toString()),s(e.bag.adsOverrideLanguage)&&w.enablingFeature(mA),f&&w.enablingFeature("spellCheck"),g&&w.enablingFeature(WI),w.enablingFeature("searchResultCpps"),h&&w.addingQuery("excludeTerms",h.join(",")),w}function Gp(e){const t=[eV,UL,Lj,wH,kG,GL,LH,wB,PE,s_,RF,$q]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),e.host.isOSAtLeast(15,5,0)&&t.push(Oj),t}function jp(e,t){return Kv.context("developerPageFromResponse",()=>{const n=t.data.length?t.data[0]:null
if(!n)return null
const r=Un(e,"Artist",n.id,t),i=function(e,t,n,r){switch(e.client.deviceType){case vW:return function(e,t,n,r){var i
e.appleSilicon.isSupportEnabled?(zp(t,oH,[AG,PN]),zp(t,AG,[PN])):zp(t,oH,[AG])
const a=Lq,c=O6.LockupIconSmall
let u=0
const d=[]
for(const f of i7){const h=fe(t,f),p=l(h,zj),w=p.length
if(0===w)continue
if(f===Yj&&0===w)continue
const g=qp(e,f,t)
Ch(0,{pageInformation:n,locationTracker:r,idType:Oq,id:`${u}`,targetType:yq},g)
const v={lockupOptions:{metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:c},filter:rm.DeveloperPage},m=p.filter(e=>o(e.attributes)),y=(null===(i=h.next)||void 0===i?void 0:i.length)>0||w>=8,A=Wp(e,g,t.id,p,f,a,v,n,r,h.href,y),T=A.items.length+m.length
T<3&&(A.rowsPerColumn=T)
const b={id:null,kind:null,softwareType:null,targetType:yq,title:A.title,pageInformation:n,locationTracker:r,idType:null}
if(Oh(r),Nh(e,A,b),_h(r),m.length){const e=new l7
e.title=g,e.developerId=t.id,e.contentType=Lq,e.remainingData=m,e.lockupListOptions=v,e.relationship=f,e.roomUrl=h.href,e.shouldShowSeeAll=y,e.hasExistingContent=s(A.items),A.url=`${$W}:/${VW.developer}/${VW.shelf}/`+encodeURIComponent(JSON.stringify(e))}A.items.length>0&&(d.push(A),u++)}return d}(e,t,n,r)
case gW:return function(e,t,n,r,i,a,c){const l=we(n,r),u={lockupOptions:{metricsOptions:{pageInformation:a,locationTracker:c},artworkUseCase:O6.LockupIconSmall},filter:rm.DeveloperPage}
Ch(0,{pageInformation:a,locationTracker:c,idType:Oq,id:"0",targetType:yq},i)
const d=Wp(e,i,n.id,l,r,t,u,a,c,null,!1),f=l.filter(e=>o(e.attributes)),h={id:null,kind:null,softwareType:null,targetType:yq,title:i,pageInformation:a,locationTracker:c,idType:null}
if(Oh(c),Nh(e,d,h),_h(c),f.length){const e=new l7
e.title=i,e.developerId=n.id,e.contentType=t,e.remainingData=f,e.lockupListOptions=u,e.hasExistingContent=s(d.items),d.url=`${$W}:/${VW.developer}/${VW.shelf}/`+encodeURIComponent(JSON.stringify(e))}return[d]}(e,Lq,t,r0,e.loc.string(xE),n,r)
case iW:return Hp(e,t,a7,n,r)
case BV:return Hp(e,t,c7,n,r)
default:return Hp(e,t,s7,n,r)}}(e,n,r,{rootPosition:0,locationStack:[]})
1===i.length&&(i[0].isHorizontal=!1)
const a=Jf(e,n,wW)
if(a){const e=new qX(a,EV),t=new yJ(Hj)
t.items=[e],i.unshift(t)}const c=new bJ(i)
c.title=j(n,AW),e.client.deviceType!==gW&&(c.presentationOptions=[hj]),c.canonicalURL=j(n,eW),jn(e,c,r)
const u=B(n,rM)
if(u){const t=Xd(e,u,{cropCode:"sr",useCase:O6.Uber})
c.uber=t
{const e=new yJ("uber"),n=new E2(ZT)
n.artwork=t,e.items=[n],n.title=c.title,i.unshift(e),c.presentationOptions.push(lM),c.presentationOptions.push(kN)}}return c})}function Vp(e,t,n){switch(t){case Yj:return e.loc.string($E)
case IN:return e.loc.string("DEVELOPER_SYSTEM_APPS")
case MB:return e.loc.string("DEVELOPER_IMESSAGE")
case AU:return e.loc.string(xE)
case TU:return e.loc.string("DEVELOPER_TV")
case aW:return e.loc.string(FE)
case CN:return e.loc.string("DEVELOPER_VISION")
case TG:const t=H(n,QT),r=H(n,XT)
return t&&r?e.loc.string(eb):r?e.loc.string(tb):e.loc.string(nb)
case oH:return e.loc.string(NE)
default:return null}}function Hp(e,t,n,r,i){var a,c
let u,d
switch(zp(t,oH,[TG,TU]),e.client.deviceType){case"tv":case BV:u=fq,d=O6.LockupIconMedium
break
default:u=Lq,d=O6.LockupIconSmall}let f=0
const h=[]
for(const p of n){const n=fe(t,p),w=l(n,zj),g=w.length
if(0===g)continue
if(p===Yj&&0===g)continue
let v,m
v=p===MB?pY:p===AU?hY:p===TU?gY:fY,m=Vp(e,p,t),Ch(0,{pageInformation:r,locationTracker:i,idType:Oq,id:`${f}`,targetType:yq},m)
const y={lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},clientIdentifierOverride:v,artworkUseCase:d},filter:rm.DeveloperPage},A=w.filter(e=>o(e.attributes)),T=((null===(a=n.next)||void 0===a?void 0:a.length)>0||g>=8)&&!0,b=Wp(e,m,t.id,w,p,u,y,r,i,n.href,T),S=b.items.length+A.length
S<3&&(b.rowsPerColumn=S)
const P={id:null,kind:null,softwareType:null,targetType:yq,title:b.title,pageInformation:r,locationTracker:i,idType:null}
if(Oh(i),Nh(e,b,P),_h(i),A.length){const e=new l7
e.title=m,e.developerId=t.id,e.contentType=u,e.remainingData=A,e.lockupListOptions=y,e.relationship=p,e.roomUrl=n.href,e.shouldShowSeeAll=T,e.hasExistingContent=s(b.items),b.url=`${$W}:/${VW.developer}/${VW.shelf}/`+encodeURIComponent(JSON.stringify(e))}(b.items.length>0||(null===(c=b.url)||void 0===c?void 0:c.length)>0)&&(h.push(b),f++)}return h}function qp(e,t,n){switch(t){case Yj:return e.loc.string($E)
case aW:return e.loc.string(FE)
case AG:if(e.appleSilicon.isSupportEnabled)return e.loc.string("DEVELOPER_MAC_APPS")
{const t=H(n,QT),r=H(n,XT)
return t&&r?e.loc.string(eb):r?e.loc.string(tb):e.loc.string(nb)}case PN:return e.loc.string("DEVELOPER_PHONE_PAD_APPS")
case oH:return e.loc.string(NE)
default:return null}}function Wp(e,t,n,o,s,a,c,l,u,d,f){const h=new yJ(a)
if(h.title=t,a===AN?(h.items=function(e,t,n){return Kv.context("screenshotsLockupsFromData",()=>{if(!t)return[]
const o=[]
for(let s=0;s<t.length;s++){const a=t[s]
if(r(a.attributes)){n.contentUnavailable&&n.contentUnavailable(s,a)
continue}const c=n.lockupOptions
let l=rm.All
if(i(n.filter)&&(l=n.filter),at(e,a,l))continue
const u=Rd(e,a,c)
u.isValid()&&(o.push(u),_h(n.lockupOptions.metricsOptions.locationTracker))}return o})}(e,o,c),h.isHorizontal=!1,h.presentationHints={showSupplementaryText:!1}):(h.items=Nd(e,o,c),h.isHorizontal=e.client.deviceType!==gW),f){const r=new o7
r.title=t,r.url=d,r.developerId=n,r.relationshipId=s,r.clientIdentifierOverride=c.lockupOptions.clientIdentifierOverride
const o=new FY(SW)
o.pageUrl=i(p=r)?`${$W}:/${VW.developer}/${VW.room}/`+encodeURIComponent(JSON.stringify(p)):null,o.title=e.loc.string(gH),o.pageData=hc(0,t),ea(e,o,o.pageUrl,{pageInformation:l,locationTracker:u}),h.seeAllAction=o}var p
return h}function zp(e,t,n){const o=fe(e,t)
if(r(o))return
const i=At(o)
if(r(i))return
const s=i.map(e=>e.id)
for(const t of n){const n=fe(e,t)
if(r(n))continue
const o=At(n)
r(n)||(e.relationships[t].data=o.filter(e=>!s.includes(e.id)))}}function Yp(e,t,n,r){const o=function(e,t,n,r){const o=Jp(0,n.collectionDisplayStyle)
return{...n.metricsImpressionOptions,...r,id:t.id,targetType:o}}(0,t,n,r)
return Bd(e,t,o,n.clientIdentifierOverride)}function Jp(e,t){switch(t){case wm.Hero:return nG
case wm.TextOnly:return uM
case wm.TextWithArtwork:return"textWithArtwork"
case wm.BrickSmall:return"brickSmall"
case wm.BrickMedium:return"brickMedium"
case wm.BrickLarge:return"brickLarge"
case wm.EditorialLockupMedium:case wm.EditorialLockupMediumVariant:return"editorialLockupMedium"
case wm.EditorialLockupLarge:case wm.EditorialLockupLargeVariant:return"editorialLockupLarge"
case wm.LockupSmall:return xB
case wm.LockupLarge:return"lockupLarge"
case wm.StorySmall:return"storySmall"
case wm.StoryMedium:return"storyMedium"
case wm.BreakoutLarge:return ON
default:return cW}}function Kp(e,t,n){let r=null,s=null,a=[]
const c=kn(0,t)
switch(t.type){case sW:case aq:case bU:a=["enrichedEditorialNotes.badge",PG,nq],r=nw(e,t,a,!1),s=nw(e,c,a,!1)
break
case yW:case rq:case aW:a=[PG],r=nw(e,t,a,!0),s=nw(e,c,a,!0)}const l=i(s)?s:r
return o(l)?null:l}function Zp(e,t,n){let r=null,s=[]
switch(n){case bN:case TN:switch(t.type){case sW:case aq:case bU:s=[UE,AV],r=ew(t,s)
break
case yW:case rq:case aW:s=[TV],r=nw(e,t,s,!0)}break
default:switch(t.type){case sW:case aq:case bU:s=[UE,AV],r=nw(e,t,s,!1)
break
case _V:case yW:case rq:case aW:s=[AW],r=nw(e,t,s,!1)}}const a=nw(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Qp(e,t,n=!1){let r=null,s=[]
switch(t.type){case sW:n?s=[ib,TV]:H(t,GE)||(s=["enrichedEditorialNotes.short",jE]),r=nw(e,t,s,!1)
break
case aq:case bU:s=[ib,TV],r=nw(e,t,s,!1)
break
case yW:case rq:case aW:s=[TV],r=nw(e,t,s,!0)}const a=nw(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Xp(e,t){let n=null,r=[]
switch(t.type){case sW:case aq:case bU:r=[sb,G$],n=nw(e,t,r,!1)
break
case yW:case rq:case aW:r=[sb,G$],n=nw(e,t,r,!0)}const o=nw(e,kn(0,t),r,!1)
let i=null
return i=(null==o?void 0:o.length)>0?o:s(n)?n:e.loc.string(VE),i}function ew(e,t){return o(e)?null:j(e,t)}function tw(e,t,n){return o(e)?null:ce(e,t,n)}function nw(e,t,n,r){if(o(t))return null
const i=nt(e,t)
for(const e of n){const n=r?tw(t,i,e):ew(t,e)
if(s(n))return n}return null}function rw(e,t,n){const r={}
kh(0,n.metricsOptions,HE)
const a=wd(e,t,n)
Oh(n.metricsOptions.locationTracker)
const c=gd(e,t,n)
return s(a)&&(a.length>1||o(c))?r.collectionIcons=a:i(c)&&(r.lockup=c,r.collectionIcons=[c.icon]),r}function ow(e,t,n,r){const o=[],s=new yJ(r)
s.isHorizontal=j(t.data,DN)===IU
const a=In(0,t)
for(const r of a){const i={...t.metricsImpressionOptions,targetType:Jp(0,n),recoMetricsData:St(r)}
if(r.attributes&&!Tw(t)){{const n=iw(e,r,t.collectionDisplayStyle,i,i,t.clientIdentifierOverride),s=j(r,HH)===JE,a=sh(e,r)
if(n.clickAction=Yp(e,s&&a?a:r,t),!n.isValid())continue
o.push(n)}_h(t.metricsImpressionOptions.locationTracker)}else t.remainingItems.push(r),t.isDeferring=!0}return i(t.presentationHints)&&(s.presentationHints=t.presentationHints),delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=o,s.rowsPerColumn=q(t.data,MN),s.url=bw(0,0,t),ec(e,s,t),s}function iw(e,t,n,r,i,a){const c=new f4,l=On(0,t)
if(!u(l.hideEditorialMedia)){const r=pd(e,t,n);(0,Zv.isSome)(null==r?void 0:r.artwork)&&(c.artworks=[r.artwork],c.isMediaDark=dd(0,r)),(0,Zv.isSome)(null==r?void 0:r.rtlArtwork)&&(c.rtlArtwork=null==r?void 0:r.rtlArtwork,c.isRTLMediaDark=dd(0,r,!0))}const d={metricsOptions:i,clientIdentifierOverride:a,artworkUseCase:O6.Default,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:ra(0,t)}
if(kh(0,d.metricsOptions,HE),c.collectionIcons=wd(e,t,d),Oh(d.metricsOptions.locationTracker),o(c.collectionIcons)){const n=rf(e,t,{useCase:O6.Default})
s(n)&&(c.collectionIcons=[n])}c.caption=Kp(e,t),c.title=Zp(e,t,n),c.subtitle=Qp(e,t),c.accessibilityLabel=c.title,c.editorialDisplayOptions=En(l)
const f=s(c.artworks)?bV:"collection_id",h={...r,id:t.id,idType:f}
return Nh(e,c,Vh(e,t,c.title,h)),c.artworkSafeArea=h4.defaultTileArtworkSafeArea,c.textSafeArea=h4.defaultTileTextSafeArea,c}function sw(e,t,n,r){const o=new i5
o.overlayType=ol(e,t),o.displayOptions={horizontalPlacement:uW,textAlignment:uW,isOverDarkContent:al(e,t)},o.badgeText=Kp(e,t,wm.Hero),o.titleText=Zp(e,t,wm.Hero),r.suppressTagline||(o.descriptionText=Qp(e,t,!0)),o.callToActionText=Xp(e,t),o.buttonTitle=sl(e,t)
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:xB,recoMetricsData:St(t)},metricsClickOptions:{id:t.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,actionDetails:{franchise:o.badgeText}},artworkUseCase:O6.LockupIconSmall,offerEnvironment:Jq,canDisplayArcadeOfferButton:oh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:ra(0,t)},c=gd(e,t,a),l=rw(e,t,a)
o.lockup=l.lockup,o.collectionIcons=l.collectionIcons
const u=j(t,nq)
s(u)&&i(c)&&(c.heading=u)
const d=(0,Zv.isSome)(r.suppressLockup)&&r.suppressLockup
if(s(o.lockup)&&!d)o.clickAction=o.lockup.clickAction,o.impressionMetrics=o.lockup.impressionMetrics
else{const r={targetType:nG,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i={...r,id:t.id,actionDetails:{franchise:o.badgeText}}
o.clickAction=jd(e,t,i,n.clientIdentifierOverride),Nh(e,o,Vh(e,t,o.titleText,r))}return o}function aw(e,t,n,r,o){if(!n){const e=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor
t.backgroundColor=e
const n=o?null==r?void 0:r.rtlArtworkData:null==r?void 0:r.artworkData
t.titleEffect=$c(0,n)
const i=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork
t.artwork=i
const s=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video
t.video=s}t.isMediaDark=dd(0,r,o)}function cw(e){return{isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}}function lw(e,t,n,a,c){if(o(t))return null
let l
n.showOrdinals&&(l=e.loc.decimal(n.ordinalIndex))
let u,d=null
!i(n.shelfBackground)||n.shelfBackground.type!==DV&&n.shelfBackground.type!==fM||(d=mq),s(n)&&(u=n.clientIdentifierOverride)
const f={ordinal:l,metricsOptions:{...{...n.metricsImpressionOptions,id:t.id,idType:Dq},recoMetricsData:St(t),isAdvert:Ut(0,t),targetType:Jp(0,c)},clientIdentifierOverride:u,artworkUseCase:O6.Default,offerStyle:d,canDisplayArcadeOfferButton:oh(0,c),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(mm.ShowOnlyPreorder)}
let h
switch(c){case bN:case _B:case TN:case DB:f.offerEnvironment=Tq,h=Ld(e,t,f,c)
break
case"Poster":h=Dd(e,t,f)
break
default:h=Od(e,t,f)}return r(h)||!h.isValid()?null:(h.id=function(e,t,n){return(0,Zv.isNothing)(n)?null:`${e.id}_${t}_${n}`}(n,a,h.adamId),h)}function uw(e,t){return pw(e,t,wm.EditorialLockupHierarchicalPortrait,kU,!0,vm.Vertical)}function dw(e,t){return pw(e,t,wm.EditorialLockupLarge,V$)}function fw(e,t,n=!0,r){return e.featureFlags.isEnabled(xJ)&&(t.showOrdinals=!0),pw(e,t,wm.LockupSmall,Lq,n,r)}function hw(e,t,n=!0){return pw(e,t,wm.LockupLarge,CB,n)}function pw(e,t,n,o,i=!0,s){const a=[],c=new yJ(o),l=null!=s?s:Pn(t)
c.isHorizontal=l===vm.Horizontal
const u=In(0,t),d=void 0
for(const[o,i]of u.entries()){if(i.type===hW)return null
if(r(i.attributes)||Tw(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}if(at(e,i,rm.All))continue
if((null==t?void 0:t.filterOverrides.includes(mm.ShowOnlyPreorder))&&!H(i,Sq))continue
let o=null
if(o=lw(e,i,t,a.length,n),o&&(a.push(o),_h(t.metricsImpressionOptions.locationTracker),t.ordinalIndex++,a.length===d))break}if(n!==wm.EditorialLockupMediumVariant&&n!==wm.EditorialLockupLargeVariant||(r(c.presentationHints)?c.presentationHints={showSupplementaryText:!0}:c.presentationHints={...c.presentationHints,showSupplementaryText:!0}),delete t.maxItemCount,c.eyebrow=t.eyebrow,c.eyebrowArtwork=t.eyebrowArtwork,c.title=t.title,c.subtitle=t.subtitle,c.items=a,c.rowsPerColumn=q(t.data,MN),c.shouldFilterApps=!t.filterOverrides.includes(mm.ShowInstalled),c.url=bw(0,0,t),i){let n=d;(0,Jv.isSome)(d),ec(e,c,t,n)}return c}function ww(e,t,n,r,o,a,c){var l,d,f
const h=On(0,t),p=new m4
if(p.title=Zp(e,t,o),h.suppressShort||(p.description=Qp(e,t)),!u(h.hideEditorialMedia)){const r=id(e,t,n)
if(p.artwork=null==r?void 0:r.artwork,p.video=null==r?void 0:r.video,p.isMediaDark=null!==(l=dd(0,r))&&void 0!==l?l:void 0,n===jm.StoryDetail){const n=id(e,t,jm.StoryDetailLandscape)
p.landscapeArtwork=null==n?void 0:n.artwork,p.landscapeVideo=null==n?void 0:n.video,p.isLandscapeMediaDark=null!==(d=dd(0,n))&&void 0!==d?d:void 0}}const w=rw(e,t,{metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,recoMetricsData:St(t)},artworkUseCase:O6.LockupIconSmall,offerEnvironment:h.useMaterialBlur?Tq:CU,canDisplayArcadeOfferButton:oh(0,o),isContainedInPreorderExclusiveShelf:null!==(f=null==c?void 0:c.filterOverrides.includes(mm.ShowOnlyPreorder))&&void 0!==f&&f,externalDeepLinkUrl:ra(0,t),useJoeColorIconPlaceholder:!1}),g=a&&u(h.suppressLockup)
g||(p.lockup=w.lockup)
const v=Cn(e,t)
if(H(v,Sq),Yf(e,v),s(v)&&!g&&at(e,v,rm.All)&&n!==jm.StoryDetail)return null
let m
if(m=Kp(e,t),p.badge={type:sH,title:m},p.collectionIcons=w.collectionIcons,i(c)){const n={id:t.id,pageInformation:c.metricsPageInformation,locationTracker:c.metricsLocationTracker,actionDetails:{franchise:p.badge.title},idType:OU}
p.clickAction=Yp(e,t,c,n)}p.editorialDisplayOptions=En(h)
const y={...r,id:t.id,idType:OU}
return Nh(e,p,Vh(e,t,p.title,y)),p}function gw(e,t,n,o){const i=[],s=new yJ(o),a=Pn(t)
s.isHorizontal=a===IU
const c=In(0,t)
for(const o of c){const s={...t.metricsImpressionOptions,targetType:Jp(0,n),recoMetricsData:St(o)}
if(!W(o)||Tw(t)){t.remainingItems.push(o),t.isDeferring=!0
continue}let a=null
a=ww(e,o,jm.StoryCard,s,t.collectionDisplayStyle,!0,t),r(a)||(i.push(a),_h(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=i,s.rowsPerColumn=q(t.data,MN),s.url=bw(0,0,t),ec(e,s,t),s}function vw(e,t,n){const r=_n(0,t)
o(r)||(n.displayStyle=r)}function mw(e,t,n,r,o,i,s,a=!1,c=null){const l={id:f(n,"id"),type:n.type,collectionDisplayStyle:null!=c?c:_n(0,n),filterOverrides:G(n,"filterOverrides"),pageId:t,data:n,presentationHints:{},clientIdentifierOverride:null,isFirstRender:!0,shouldFilter:!0,gamesFilter:Aw(n),hasExistingContent:!1,title:null,subtitle:null,eyebrow:null,titleArtwork:null,remainingItems:[],metricsImpressionOptions:null,metricsPageInformation:i,metricsLocationTracker:s,recoMetricsData:ts(e,n),isDeferring:!1,showOrdinals:!1,ordinalIndex:1,isSearchLandingPage:!1,isArcadePage:r,shelfIndex:o,isSeeAll:a}
return yw(e,n,l),l}function yw(e,t,n){let r=j(t,AV),o=j(t,TV),i=j(t,PG),a=null,c=!1
const l=pe(e,t,PU)
s(l)&&(i=e.loc.uppercased(j(t,AV)),r=j(l,AV),a=rf(e,l,{useCase:O6.LockupIconSmall}),o=null,c=!0)
const u=function(e,t,n,r,o){const i=t.type,s=_n(0,t),a={id:f(t,"id"),kind:null,softwareType:null,targetType:yq,title:n,pageInformation:r,locationTracker:o,idType:ab,shelfType:i,recoMetricsData:St(t),canonicalId:f(t.meta,RN)}
switch(i){case pm.Collection:vw(0,t,a),s===wm.Hero&&function(e,t){t.title=wj
const n=cw(e)
t.autoAdvanceInterval=n.autoScrollInterval}(e,a)
break
case pm.Recommendations:vw(0,t,a)}return a}(e,t,c?i:r,n.metricsPageInformation,n.metricsLocationTracker)
n.title=r,n.subtitle=o,n.eyebrow=i,n.titleArtwork=a,n.metricsImpressionOptions=u}function Aw(e){let t=null
switch(j(e,"clientFilter")){case ym.ArcadeGames:t=pW
break
case ym.AllGames:t="all"}return t}function Tw(e){return e&&e.isDeferring&&e.isFirstRender}function bw(e,t,n){return o(n)?null:(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?function(e){return(new wz).set(Wj,$W).append(SV,VW.editorialPage).append(SV,VW.shelf).param(tz.token,encodeURIComponent(JSON.stringify(e))).build()}(n):null}function Sw(e,t,n){if(o(n)||o(t))return null
if(function(e){if(e.isSeeAll)return!1
switch(e.collectionDisplayStyle){case wm.BreakoutLarge:case wm.Poster:return!1}return!e.filterOverrides.includes(mm.ShowOnlyPreorder)||!1}(n)){const r=new FY(SW)
if(!rc(t)){const o=`shelf_${n.id}`
r.pageData=function(e,t,n,r,o){const i=Iw(e,void 0,(_n(0,t.data),mw(e,t.pageId,t.data,t.isArcadePage,t.shelfIndex,t.metricsPageInformation,{rootPosition:0,locationStack:[]},!0,null)))
if(null===i)return null
let s
i.title=null,i.eyebrow=null,i.isHorizontal=!1,i.id=r,s=new A5(null,t.title,null)
const a=new yJ(hM)
a.id=qE,a.items=[s]
const c=new bJ([a,i])
return c.isIncomplete=!(null!=o&&o),(0,Jv.isNothing)(c.pageMetrics.pageFields)&&(c.pageMetrics.pageFields={}),c}(e,n,t.contentType,o,(0,Jv.isSome)(n.recommendationsHref))}const o={}
n.type===pm.Recommendations&&(o[tz.editorialPageId]=n.pageId),r.pageUrl=Ni(e,n.data.href,o),r.title=e.loc.string(gH),r.referrerUrl=n.metricsPageInformation.pageUrl
const i=function(e){const t=[]
for(const n of e.locationStack)t.push({...n})
return{rootPosition:e.rootPosition,locationStack:t}}(n.metricsLocationTracker)
return Dh(i,0),ea(e,r,n.seeAllUrl,{pageInformation:n.metricsPageInformation,locationTracker:i}),r}return null}function Pw(e,t,n,r,o){n||(t.backgroundColor=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor,t.artwork=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork,t.video=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video),t.isMediaDark=dd(0,r,o)}function Iw(e,t,n){let a=null
switch(n.isFirstRender&&Ch(0,n.metricsImpressionOptions,n.title),n.type){case pm.ArcadeSeeAllGames:a=function(e,t){const n=new l4,o=new yJ(BE)
o.items=[n]
const i={targetType:cb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(A$),id:t.id,kind:lb,softwareType:Pq}
Nh(e,n,i),Ch(0,i,i.title),n.buttonAction=to(e,hU,t.metricsPageInformation,t.metricsLocationTracker)
const a={targetType:TW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:n.buttonAction.title,id:"SeeAllGames",kind:TW,softwareType:Pq}
Nh(e,n.buttonAction,a),Oh(i.locationTracker)
const c=e.bag.termsAndConditionsURL
if(!r(c)&&"tv"!==e.client.deviceType){const t=e.loc.string(zE),r=new JY(c),o=new u4(t)
o.clickAction=r,o.presentationStyle=[pM,wM,gM],n.footnote=o}o.background={type:DV,color:Se(wE)}
const l=In(0,t)
if(s(l)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
n.icons=tf(e,l,r,{useCase:O6.LockupIconMedium})}else n.icons=[]
return o}(e,n)
break
case pm.Collection:a=function(e,t){let n=j(t.data,MH)
if(o(n))return null
let a=null
switch(n){case wm.Hero:a=function(e,t){if(0!==t.shelfIndex)return null
const n=new yJ(wj),r=new M4
r.autoScrollConfiguration=cw(e)
const o=In(0,t)
for(const n of o){const o=Rn(e,n)
if(Dn(0,n)&&!W(o)||Tw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i={...t.metricsImpressionOptions,idType:bV,targetType:nG,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},s=id(e,n,jm.Hero),a=rw(e,n,{metricsOptions:i,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:O6.Default,offerEnvironment:CU,canDisplayArcadeOfferButton:!0}),c=new x4,l=Xc(0,n),d=Zp(e,n,wm.Hero),f=Vh(e,n,d,i)
f.isPreorder=et(e,l,Sq),Nh(e,c,f),Ch(0,f,d)
const h=On(0,n),p=u(h.hideEditorialMedia)
c.overlay=sw(e,n,t,h),c.collectionIcons=a.collectionIcons,c.editorialDisplayOptions=En(h),aw(0,c,p,s,!1),c.isValid()&&r.items.push(c)
const w=S(c)
aw(0,w,p,s,!0),w.isValid()&&r.rtlItems.push(w),Oh(f.locationTracker),_h(f.locationTracker)}return delete t.maxItemCount,n.isHorizontal=!1,n.eyebrow=t.eyebrow,n.eyebrowArtwork=t.eyebrowArtwork,n.title=t.title,n.subtitle=t.subtitle,n.items=[r],n.url=bw(0,0,t),n}(e,t)
break
case wm.TextOnly:a=function(e,t){var n
const o=[],i=new yJ(cq)
i.isHorizontal=j(t.data,DN)===vm.Horizontal
const s=In(0,t)
for(const n of s){if(r(n.attributes)||Tw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Yp(e,n,t)
i.title=Zp(e,n,t.collectionDisplayStyle)
const s={...t.metricsImpressionOptions,id:n.id,idType:OU,targetType:uM}
Nh(e,i,Vh(e,n,i.title,s)),o.push(i),_h(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,MN))&&void 0!==n?n:1,i.url=bw(0,0,t),ec(e,i,t),i}(e,t)
break
case wm.TextWithArtwork:a=function(e,t){var n
const o=[],i=new yJ(cq)
i.isHorizontal=j(t.data,DN)===vm.Horizontal
const a=In(0,t)
for(const n of a){if(r(n.attributes)||Tw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Yp(e,n,t)
let a
i.title=Zp(e,n,t.collectionDisplayStyle),a=B(n,fW),s(a)&&(i.artwork=Xd(e,a,{allowingTransparency:!0,useCase:O6.CategoryIcon})),o.push(i),_h(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,MN))&&void 0!==n?n:1,i.url=bw(0,0,t),ec(e,i,t),i}(e,t)
break
case wm.BrickSmall:a=function(e,t){return ow(e,t,wm.BrickSmall,"smallBrick")}(e,t)
break
case wm.BrickMedium:a=function(e,t){return ow(e,t,wm.BrickMedium,bG)}(e,t)
break
case wm.BrickLarge:a=function(e,t){return ow(e,t,wm.BrickLarge,"largeBrick")}(e,t)
break
case wm.EditorialLockupHierarchicalPortrait:a=uw(e,t)
break
case wm.EditorialLockupHierarchicalRows:a=function(e,t){return pw(e,t,wm.EditorialLockupHierarchicalRows,kU,!0,vm.Vertical)}(e,t)
break
case wm.EditorialLockupMedium:a=function(e,t){return pw(e,t,wm.EditorialLockupMedium,kU)}(e,t)
break
case wm.EditorialLockupMediumVariant:a=function(e,t){return pw(e,t,wm.EditorialLockupMediumVariant,kU)}(e,t)
break
case wm.EditorialLockupLarge:a=dw(e,t)
break
case wm.EditorialLockupLargeVariant:a=function(e,t){return pw(e,t,wm.EditorialLockupLargeVariant,V$)}(e,t)
break
case wm.LockupMedium:a=function(e,t){return t.metricsImpressionOptions.shouldOmitImpressionIndex=!0,pw(e,t,wm.LockupMedium,fq)}(e,t)
break
case wm.Poster:a=function(e,t){const n=pw(e,t,wm.Poster,FB)
return(0,Jv.isSome)(n)&&(n.horizontalScrollTargetBehavior=Jm.CenterAligned),n}(e,t)
break
case wm.StorySmall:a=function(e,t){return gw(e,t,wm.StorySmall,xV)}(e,t)
break
case wm.StoryMedium:a=function(e,t){return gw(e,t,wm.StoryMedium,xN)}(e,t)
break
case wm.LockupSmall:a=fw(e,t)
break
case wm.LockupLarge:a=hw(e,t)
break
case wm.BreakoutLarge:a=function(e,t){const n=[],r=new yJ(B$)
r.isHorizontal=j(t.data,DN)===IU
const s=In(0,t)
for(const r of s){const s=Rn(e,r)
if(Dn(0,r)&&!W(s)||Tw(t)){t.isDeferring=!0,t.remainingItems.push(r)
continue}const a={targetType:ON,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},c=On(0,r),l=u(c.hideEditorialMedia)?null:pd(e,r,t.collectionDisplayStyle),d=rw(e,r,{metricsOptions:a,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:O6.Default,offerEnvironment:CU,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:ra(0,r)})
if(o(l)&&o(d.collectionIcons))continue
const f=Kp(e,r,t.collectionDisplayStyle),h=i(f)?{type:sH,title:f}:{type:Iq,title:null},p=new Y4(Zp(e,r,t.collectionDisplayStyle),Qp(e,r,!0),h,null),w=new c5(p,{position:uW,wantsBlur:!0},null,null==l?void 0:l.artwork,null==l?void 0:l.video,d.collectionIcons,null==l?void 0:l.backgroundColor)
w.rtlArtwork=null==l?void 0:l.rtlArtwork,w.rtlVideo=null==l?void 0:l.rtlVideo,w.rtlBackgroundColor=null==l?void 0:l.rtlBackgroundColor
const g={...a,id:r.id,idType:bV}
Nh(e,w,Vh(e,r,w.details.title,g))
const v=Yp(e,r,t)
i(v)&&(v.title=Xp(e,r)),w.details.callToActionButtonAction=v,w.clickAction=v,w.editorialDisplayOptions=En(c),w.lockup=d.lockup,w.isMediaDark=dd(0,l),w.isRTLMediaDark=dd(0,l,!0),n.push(w)}return delete t.maxItemCount,r.eyebrow=t.eyebrow,r.eyebrowArtwork=t.eyebrowArtwork,r.title=t.title,r.subtitle=t.subtitle,r.items=n,r.rowsPerColumn=q(t.data,MN),r.url=bw(0,0,t),ec(e,r,t),r}(e,t)}return s(a)&&(a.seeAllAction=Sw(e,a,t),a.id=`shelf_${t.id}`),a}(e,n)
break
case pm.Chart:a=function(e,t){let n
if(t.showOrdinals=!0,n=fw(e,t,!1,vm.Horizontal),!(0,Jv.isNothing)(n))return n.url=bw(0,0,t),ec(e,n,t),function(e,t,n){e.featureFlags.isEnabled(OJ)?(0,Jv.isSome)(t.header)?function(e,t,n){e.featureFlags.isEnabled(OJ)?t.titleAction=n:t.accessoryAction=n}(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}(e,n,function(e,t){const n=j(t.data,_H),r=j(t.data,gq),o=new FY(SW)
return o.pageUrl=Nf(e,n,r),o.title=e.loc.string(gH),o.referrerUrl=t.metricsPageInformation.pageUrl,ea(e,o,o.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),o}(e,t)),n}(e,n)
break
case pm.Tag:case pm.Engagement:case pm.Text:case pm.Image:case pm.VideoClip:a=null
break
case pm.Header:a=function(e,t,n){var r,o,i
const a=s(B(n.data,mV))?n.data:t
if(!a)return null
if(s(B(a,Hq))){const t=new M4,r=new x4,o=On(0,a),i=sw(e,a,n,o)
i.overlayType=sH,i.callToActionText=null,r.clickAction=null,i.collectionIcons=null,i.lockup=null,i.callToActionText=null,r.overlay=i
const s={artworkUseCase:O6.LockupIconSmall,offerStyle:Rj,offerEnvironment:Jq,canDisplayArcadeOfferButton:oh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(mm.ShowOnlyPreorder),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:ra(0,a)}
kh(0,s.metricsOptions,HE)
const c=wd(e,a,s)
Oh(s.metricsOptions.locationTracker),r.collectionIcons=c
const l=id(e,a,jm.Hero),d=u(o.hideEditorialMedia)
Pw(0,r,d,l,!1),r.editorialDisplayOptions=En(o),t.items=[r]
const f=S(r)
Pw(0,f,d,l,!0),t.rtlItems=[f]
const h=new yJ(wj)
return h.items=[t],h}{const t=(0,Xv.attributeAsString)(a,AW)
if(s(t)&&ji(e,null)){const s=new yJ(U$)
s.id=U$
const c=null!==(r=(0,Xv.attributeAsString)(a,PG))&&void 0!==r?r:null,l={artworkUseCase:O6.LockupIconSmall,offerStyle:Rj,offerEnvironment:Jq,canDisplayArcadeOfferButton:oh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(mm.ShowOnlyPreorder),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:ra(0,a),useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:uh}
let u,d=null!==(o=wd(e,n.data,l))&&void 0!==o?o:void 0
if((0,Zv.isSome)(d)&&(null==d?void 0:d.length)>=3){d=d.slice(0,3)
const r=d[0].backgroundColor;(0,Zv.isSome)(r)&&(null==r?void 0:r.type)===GV&&(u=ah(r))
const o=be(u),l=On(0,n.data),f=new T5(c,t,null,void 0,void 0,d,!1,null!=u?u:void 0,function(e,t){if(2===t)return vM
switch(e){case KG:return j$
case YE:return"Fan"
case ub:return mM
default:return j$}}(null!==(i=l.fallbackDisplayStyleHint)&&void 0!==i?i:KG,null==d?void 0:d.length),o?Jq:Tq),h=function(e,t,n,r){return Kv.context(qR,()=>{const o=wh(e,t),i=ph(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:bV,targetType:"tagHeader"}})}(e,a,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)})
return function(e,t,n){if(!t)return
const r=new KY(Fh(e,n))
delete r.fields.impressionIndex,t.impressionMetrics=r}(e,f,h),s.items=[f],s}return null}return null}}(e,t,n)
break
case pm.Recommendations:a=function(e,t){let n=null
switch(j(t.data,MH)){case wm.LockupSmall:n=fw(e,t,!1)
break
case wm.LockupLarge:n=hw(e,t,!1)
break
case wm.EditorialLockupHierarchicalPortrait:n=uw(e,t)
break
case wm.EditorialLockupLarge:n=dw(e,t)
break
default:n=t.isFirstRender?function(){const e=new yJ(LN)
return e.isHidden=!0,e}():null}return(0,Jv.isNothing)(n)?null:(n.id=`shelf_${t.id}`,function(e,t){const n=s(we(t.data,mW))||s(t.remainingItems),r=H(t.data,"isPersonalizationAvailable"),o=t.data.href
if(!r||n||!s(o))return
const i=ve(e,new yY(e,t.data.href).addingQuery(tz.editorialPageId,t.pageId).includingRelationships([mW]))
t.recommendationsHref=i.toString()}(e,t),n.url=bw(0,0,t),ec(e,n,t),n.seeAllAction=Sw(e,n,t),n)}(e,n)
break
case pm.GameCenter:a=null
break
case pm.Upsell:a=function(e,t){const n=lo(e,t.data)
if(o(n))return null
const r=n.marketingItemData
if(o(r)||o(r.attributes))return null
const i=Fc(e,r,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:bh(0,r)})
_h(t.metricsLocationTracker)
const s=new yJ(gG)
return s.items=[i],s}(e,n)
break
case pm.Marker:a=function(e,t){const n=j(t.data,HH)
if(o(n))return null
let r=null
return n===gm.QuickLinks&&(r=function(e,t){if(e.user&&e.user.isManagedAppleID)return null
{const n=[]
if((0,Zv.isSome)(e.bag.aboutAppStoreUrl)){const t=new JY(e.bag.aboutAppStoreUrl)
t.title=e.loc.string("QuickLinks.AboutTheAppStore.Title"),n.push(t)}if((0,Zv.isSome)(e.bag.aboutInAppPurchasesEditorialItemId)){const t=new FY(Eq)
t.title=e.loc.string("QuickLinks.AboutInAppPurchases.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutInAppPurchasesEditorialItemId}`,n.push(t)}if((0,Zv.isSome)(e.bag.reportProblemUrl)){const t=new JY(e.bag.reportProblemUrl)
t.title=e.loc.string(fb,"Report a Problem"),n.push(t)}if((0,Zv.isSome)(e.bag.requestARefundUrl)){const t=new JY(e.bag.requestARefundUrl)
t.title=e.loc.string("QuickLinks.RequestARefund.Title"),n.push(t)}if((0,Zv.isSome)(e.bag.changePaymentMethodUrl)){const t=new JY(e.bag.changePaymentMethodUrl)
t.title=e.loc.string("QuickLinks.ChangePaymentMethod.Title"),n.push(t)}if((0,Zv.isSome)(e.bag.aboutFrenchAppStoreEditorialItemId)){const t=new FY(Eq)
t.title=e.loc.string("QuickLinks.AboutFrenchAppStore.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutFrenchAppStoreEditorialItemId}`,n.push(t)}const r=new yJ(cq)
return r.title=e.loc.string("QuickLinks.Title"),r.items=n,r.isHorizontal=!0,r.rowsPerColumn=1,t.metricsImpressionOptions.title=r.title,r}}(e,t)),r}(e,n)}return o(null==a?void 0:a.items)&&o(null==a?void 0:a.url)&&(a=null),n.isFirstRender&&Oh(n.metricsImpressionOptions.locationTracker),Nh(e,a,n.metricsImpressionOptions),n.isFirstRender&&_h(n.metricsImpressionOptions.locationTracker),(0,Zv.isSome)(a)&&function(e,t,n){if((0,Jv.isNothing)(t.url)||(0,Jv.isNothing)(t.impressionMetrics)||!n.showingPlaceholders)return
const o=t.url
try{const e=wz.from(o).query[tz.token],n=JSON.parse(decodeURIComponent(e))
n.originalPlaceholderShelfImpressionMetrics=t.impressionMetrics,function(e,t,n){const o=wz.from(t.url),i=wz.from(bw(0,0,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,t,n)}catch{t.url=o}}(0,a,n),a}function Cw(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},r=lo(e,t.data)
return o(r)?null:$d(e,r,n,pt(iU),xj,WE)}function kw(e,t){const n=[Hq,$q,pj],r=[...n,SG,LV,RB,N$],o=[...n,RB],i=[...n,LH,eV,Lj,LV,hH,LH,OH]
e.appleSilicon.isSupportEnabled&&i.push(xH),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([Fq])
const s=[...i]
t.includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).enablingFeatures(["personalization","supportsCustomTextColor"]).includingRelationshipsForUpsell(!0).includingScopedAttributes(sW,r).includingScopedAttributes(aq,o).includingScopedAttributes(yW,s)}function Ow(e){const{platform:t,...n}=e
return{...n,$kind:p7,platform:ut(t)}}function Ew(e,t,n){var r
const o=function(e,t){switch(t){case P7:return"badge_hardware"
case I7:return"badge_trial_eligible"
default:return null}}(0,t),i={offerHints:o},s=new hZ(pW,pt(Pj),e.bag.metricsTopic,null,i)
s.metricsOverlay={...s.metricsOverlay,...n}
const a=null===(r=e.metricsIdentifiersCache)||void 0===r?void 0:r.getMetricsFieldsForTypes([im.user,im.client,im.canonical])
if((0,Jv.isSome)(a)&&(s.metricsOverlay={...s.metricsOverlay,...a}),e.bag.arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new FY(bB),t=iB
e.pageData=t,e.presentationContext=Qj,s.purchaseSuccessAction=e}const c=new FY(Dj)
return c.pageData=s,c}async function Rw(e,t){const n=t.eventString,r=t.featuresDictionary
if(!i(r))return await Promise.reject("Received non-defined engagement features.")
const o=function(e,t,n,r){switch(t){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t,n){const r=[]
for(const e of C7)if(e in t){const t=new b7(e,!1)
r.push(t)}for(const o of C7){if(n.includes(o)&&!e.bag.unrestrictedServerSideTabBadging)continue
const s=t[o]
if(i(s)){const t=Ew(e,o,s)
r.push(t)
break}}if(r.length>0)return new T7(new iK(r))
{const e=new xW
return new T7(e)}}(e,n,r)
case"didBecomeArcadeTrialEligible":if(!e.bag.enableArcadeTrialEligibleBadging)return e.console.log(`Bag prohibits badging for identifier ${I7}`),new T7(new xW)
if(r.includes(I7))return e.console.log(`Badging identifier ${I7} was previously invalidated.`),new T7(new xW)
const t=new b7(I7,!0),o=new S7(pW,e.loc.decimal(1)),s=new iK([t,o])
return new T7(s)
case"didSubscribeToArcade":return function(e){const t=[]
for(const e of C7){const n=new b7(e,!1)
t.push(n)}const n=new iK(t)
return new T7(n)}()
case"didBecomeSubscribed":if(!i(n[I7]))return new T7(new xW)
const a=new b7(I7,!1)
return new T7(a)
case"didBecomeNonSubscribed":return new T7(new xW)
default:return null}}(e,n,r,i(t.previouslyDisabledFeatures)?t.previouslyDisabledFeatures:[])
return i(o)?await Promise.resolve(o):await Promise.reject("Did not receive a valid engagement event.")}async function Dw(e,t){var n
const r=function(e,t,n,r){if(!C7.includes(t))return null
let o=null
if(n&&e.bag.unrestrictedServerSideTabBadging){const t=e.loc.decimal(1)
o=new S7(pW,t)}else if(n&&!r.includes(t)){const t=e.loc.decimal(1)
o=new S7(pW,t)}else n||(o=new S7(pW,null))
return new T7(o)}(e,t.identifier,t.isEnabled,null!==(n=t.previouslyDisabledFeatures)&&void 0!==n?n:[])
return i(r)?await Promise.resolve(r):await Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${t.identifier}, featuresDictionary: ${JSON.stringify(t.featuresDictionary)}, previouslyDisabledFeatures: ${t.previouslyDisabledFeatures}`))}async function _w(e,t){return await e.required(O3).fetchPage(e,t,BY)}async function Lw(e,t){const n=new yY(e).withIdOfType(t,GM),r=Ln(e,n)
return await r.then(t=>function(e,t){return Kv.context("msoProviderDataFromData",()=>{const n=yt(e,t),r=j(n,AW),o=j(n,eW),i=function(e,t){return Kv.context("msoProviderArtworkFromData",()=>{const n=B(t,"editorialArtwork.storeFlowcase")
if(n)return Xd(e,n,{useCase:O6.LockupIconLarge})
const r=B(t,fW)
return Xd(e,r,{useCase:O6.LockupIconLarge})})}(e,n)
i&&(i.crop="sr")
const s=function(e,t){const n=B(t,rM)
return n?Xd(e,n,{useCase:O6.Uber}):null}(e,n)
return new x7(r,o,i,s)})}(e,t))}async function Mw(e,t){if(r(t.providerAdamId)||r(t.subscribedChannelIds))return await e.required(O3).fetchPage(e,t.url,bJ)
{const n=xw(e,t.providerAdamId),r=Ln(e,n)
return await r.then(n=>{const r=function(e,t){return Kv.context("msoAppsFromResponse",()=>{const n=yt(e,t),r=we(n,q_),o={}
for(const t of r)o[pe(e,t,rW).id]=G(t,"channelNames")
const i=we(n,yW).map(e=>e.id)
return new $7(o,i)})}(e,n),o=function(e,t){const n=e.appsToAlwaysShow
for(const r of Object.keys(e.apps)){const o=e.apps[r]
for(const e of o)if(-1!==t.indexOf(e)){n.push(r)
break}}return n}(r,t.subscribedChannelIds)
return $w(e,n,o)})}}function xw(e,t){return new yY(e).withIdOfType(t,GM).includingRelationships([yW,q_]).addingQuery("limit[channel-apps]","100")}function $w(e,t,n){return Kv.context("msoRoomPageWithResponse",()=>{const r=yt(e,t),o=Un(e,XH,r.id,t),i=we(r,yW),a=we(r,q_)
for(const t of a){const n=pe(e,t,rW)
s(n)&&i.push(n)}const c=new U2
c.ids=i.map(e=>e.id),c.shouldFilter=!1,c.metricsPageInformation=o
const l=function(e,t,n,r,o=[]){return Kv.context("msoRoomPageWithContext",()=>{const i=[],s=[]
for(const e of t)-1!==n.indexOf(e.id)?i.push(e):s.push(e)
const a={rootPosition:0,locationStack:[]},c={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:a},artworkUseCase:O6.LockupIconMedium}},l=[],u={pageInformation:r.metricsPageInformation,locationTracker:a,targetType:yq,idType:Oq,id:"0"}
if(i.length>0){const t=e.loc.string("MSO_INCLUDED_IN_SUBSCRIPTION"),n=new U2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=fq,u.id="0",Ch(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(i[e]),!1}
const o=new yJ(fq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Nd(e,i,c),o.url=Fw(n),Oh(a),o.items.length>0&&(_h(a),l.push(o))}if(i.length>0&&s.length>0){const t=e.loc.string("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),n=new U2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=fq,u.id="1",Ch(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(s[e]),!1}
const o=new yJ(fq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Nd(e,s,c),o.url=Fw(n),Oh(a),o.items.length>0&&(_h(a),l.push(o))}if(0===l.length){const n=new U2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=Lq,u.id="0",Ch(0,u,null),c.contentUnavailable=function(e,r){return n.remainingContent.push(t[e]),!1}
const o=new yJ(fq)
o.shouldFilterApps=r.shouldFilter,o.items=Nd(e,t,c),o.url=Fw(n),Oh(a),_h(a),l.push(o)}for(const e of l)e.isHorizontal=l.length>1
const d=o.concat(l)
return new bJ(d)})}(e,i,n,c)
return l.title=j(r,AW),l.isIncomplete=!1,jn(e,l,o),l})}function Fw(e){return e.remainingContent.length?`${$W}:/${VW.mso}/${VW.shelf}/`+encodeURIComponent(JSON.stringify(e)):null}async function Nw(e,t){const n={url:`${e.bag.getCancellablePreorderItemsSrv}?&includeAllLockups=false&includeNonBookCancellablePreorderItems=true${t.isArcade?"&preorderItemType=ArcadeApp":""}`,signingStyle:nH}
return await e.network.fetch(n).then(async n=>{const r=JSON.parse(n.body)
if(0!==r.status)return await Promise.resolve("noAuthorization")
const o=r.cancellablePreorderItems.filter(e=>e.preorderAdamId.toString()===t.adamId)
if(null===o||0===o.length)return await Promise.reject("Expected AdamID was missing. This AdamId might have not been preordered before, or the isArcade flag may be incorrect.")
if(o.length>1)return await Promise.reject(`Multiple matches for adamId ${t.adamId}, when only one is expected.`)
const i=o[0].preorderId,s={url:e.bag.cancelPreorderItemSrv,method:yG,signingStyle:nH}
return s.body=`preorderId=${i}`,await e.network.fetch(s).then(async e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${s.url}`)
return 0!==JSON.parse(e.body).status?await Promise.resolve("unableToCancel"):await Promise.resolve("canceled")}).catch(async e=>await Promise.reject(e))}).catch(async e=>await Promise.reject(e))}async function Bw(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(ok))
0!==Mn(e,new wz(t.url)).length&&ip(e,t.url)
const n=Y7.generateProductPageOptions(e,void 0,new wz(t.url)),r=e.required(O3).fetchPage(e,t.url,wJ)
if(!r){const r=new yY(e,t.url),o=await Ln(e,r)
return await Qu(e,o,n,void 0,t.referrerData)}return await r.then(n=>(e.host.clientIdentifier===vY?n&&SB in n&&zn(0,n):i(t.referrerData)&&n&&SB in n&&zn(0,n),n))}async function Uw(e,t,n){const a=Xt(e,t,!1),c=new yY(e)
switch(t){case tW:c.usingCustomAttributes(Ue(e)),Qt(e)===fq&&c.includingAttributes([wB])
break
case oq:case SH:c.usingCustomAttributes(Ue(e))}const l=e.bag.adsOverrideLanguage
s(l)&&c.enablingFeature(mA).addingQuery("l",l)
const u=ve(e,c).query
try{const c=await e.ads.fetchOnDeviceAdPlacement(t,a,u,n)
return await async function(e,t,n){var a,c,l,u,d,f
o(t.clientRequestId)&&(t.clientRequestId=e.random.nextUUID(),Zt(e,`clientRequestId was nil. Assigned ${t.clientRequestId}`))
const h={clientRequestId:t.clientRequestId,iAdId:t.iAdId,placementType:null!==(c=null===(a=null==t?void 0:t.ad)||void 0===a?void 0:a.placementType)&&void 0!==c?c:n}
if(t.failureReason)return h.failureReason=t.failureReason,h
h.onDeviceAd=t.ad
let p=null===(l=t.ad)||void 0===l?void 0:l.appMetadata
const w=yt(e,p)
if(o(null===(u=null==w?void 0:w.attributes)||void 0===u?void 0:u.name)||o(null===(d=null==w?void 0:w.attributes)||void 0===d?void 0:d.platformAttributes)||o(wr(e,w)))try{const n=function(e,t){const n=new yY(e).withIdOfType(t.adamId,yW).usingCustomAttributes(Ue(e)).includingAttributes([wB])
s(t.cppIds)&&n.addingQuery(tz.productVariantID,t.cppIds[0])
const r=e.bag.adsOverrideLanguage
return s(r)&&n.addingQuery("l",r),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([Fq]),n}(e,t.ad)
p=await Ln(e,n)}catch(t){Zt(e,`fetchAds request failed - ${t}`),h.failureReason=yA}if(s(null===(f=yt(e,p))||void 0===f?void 0:f.attributes)){h.mediaResponse=function(e,t,n){const i=yt(e,t)
if(o(i)||r(i.attributes))return Zt(e,"decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null
const a=n.ad,c=`${a.adamId}|${a.metadata}`,l={clientRequestId:n.clientRequestId,impressionId:a.impressionId,metadata:a.metadata,privacy:a.privacy,lineItem:c},u=yt(e,a.appMetadata)
switch(s(i.meta)&&s(u)&&s(u.meta)&&(i.meta.passthroughAdInfo=u.meta.passthroughAdInfo,(0,Jv.isSome)(null==a?void 0:a.alignedRegionDetails)&&(i.meta.alignedRegionDetails=null==a?void 0:a.alignedRegionDetails[0])),a.placementType){case tW:const t=Qt(e)===fq
l.format={images:t,text:"",userRating:!1}
break
case kV:l.format={images:!0,text:"",userRating:!1}}return i.attributes[GG]=l,hn(0,i,a.instanceId),t}(e,p,t),pn(e,yt(e,p),h.onDeviceAd)||(Zt(e,"fetchAds request failed - localization not available"),h.failureReason=AA)
const a=function(e,t,n){return n===tW?function(e,t){var n,r
const o=Ge(e,yt(e,t.mediaResponse))
return(null===(r=null===(n=t.onDeviceAd)||void 0===n?void 0:n.cppIds)||void 0===r?void 0:r.includes(o.productPageId))?null:SO}(e,t):null}(e,h,n)
i(a)&&(Zt(e,`fetchAds request failed - ${a}`),h.failureReason=a)}return h}(e,c,t)}catch{return null}}function Gw(e,t,n,r){var o,i,s
const a=fe(t,mW),c=null===a?void 0:null!==(o=St(a))&&void 0!==o?o:void 0
let l=bV
return r.pageType===Zm.ChartsAndCategories&&(l=dW),{id:n.id,kind:null,softwareType:null,targetType:yq,title:null!==(i=n.title)&&void 0!==i?i:"",pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:l,fcKind:void 0,canonicalId:null!==(s=f(t.meta,RN))&&void 0!==s?s:void 0,recoMetricsData:c}}function jw(e,t,n,r){var o,i
return{...r.metricsOptions,...Vh(e,n,null!==(o=t.title)&&void 0!==o?o:"",r.metricsOptions),recoMetricsData:null!==(i=St(n))&&void 0!==i?i:void 0,targetType:Hw(t.density),idType:Dq}}function Vw(e,t,n,r){var o
return{pageInformation:r.metricsOptions.pageInformation,locationTracker:r.metricsOptions.locationTracker,recoMetricsData:null!==(o=St(n))&&void 0!==o?o:void 0,targetType:Hw(t),id:n.id}}function Hw(e){if((0,Zv.isNothing)(e))return Jj
switch(e){case em.Density1:return Jj
case em.Density2:return wN
default:return Jj}}function qw(e,t,n,r=Km.Default){var o,i,s
const a=null!==(o=j(t,Wq))&&void 0!==o?o:void 0
let c=null!==(i=function(e,t,n){return B(e,t,void 0)}(t,MH))&&void 0!==i?i:void 0;(0,Jv.isNothing)(c)&&r===Km.CategoriesAndCharts&&(c={layoutDensity:em.Density1,layout:void 0,layoutSize:void 0})
const l=g(B(t,"itemDisplayStyle")),u=H(t,rR),d=null!==(s=q(t,IM))&&void 0!==s?s:void 0,f=u?t.href:void 0
return new dee(t.id,a,c,d,u,f,l,n)}function Ww(e,t,n,r){return{metricsOptions:Gw(0,t,n,r)}}function zw(e,t){var n,r
const o=j(t,Wq),i=f(t,"meta.autoSelectedTabId"),a=f(t,"meta.sourceShelfCanonicalId"),c=Un(e,DG,a,t),u=Ps(e)
c.recoMetricsData=Sh(c.recoMetricsData,null,u)
const d={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:c,adStitcher:null,pageType:Zm.ChartsAndCategories},h=l(t,zj),p={},w=[],g=[],v={rootPosition:0,locationStack:[]}
for(const t of h){const o=qw(0,t,Qm.CategoriesAndCharts,Km.CategoriesAndCharts),i=Ww(0,t,o,{...d,metricsLocationTracker:{rootPosition:0,locationStack:[]}})
Ch(0,i.metricsOptions,o.title)
const s=Yw(e,t,!0,o,0,i)
if(Oh(i.metricsOptions.locationTracker),(0,Jv.isNothing)(s))continue
p[s.id]=s,w.push(s.id)
const a=new fee,c=new hee(t.id,o.title)
Xs(e,c,{id:o.title,canonicalId:null!==(n=f(t.meta,RN))&&void 0!==n?n:void 0,actionType:bW,targetType:TW,pageInformation:d.metricsPageInformation,locationTracker:v}),a.action=c,a.id=s.id,a.title=`${null!==(r=s.title)&&void 0!==r?r:""}`,g.push(a),_h(v)}if(!s(w))return new pee
const m=new wee
m.id=e.random.nextUUID()
const y=new yJ("pageTabs")
y.items=[m],p[m.id]=y
const A=new pee
A.shelfMapping=p
const T={}
for(const e of w)g.length>1?T[e]=[m.id,e]:T[e]=[e]
for(const e of Object.values(p))e.title=void 0
return A.title=o,A.pageTabs=m,A.columnCount=2,A.shelfOrderings=T,A.defaultShelfOrdering=w.includes(i)?i:w[0],m.tabs=g,m.selectedTabId=A.defaultShelfOrdering,jn(e,A,d.metricsPageInformation),A}function Yw(e,t,n,r,i,c){var l,u,d,h,p,w,g,v,m,y,A
const T=[],b=we(t,mW),S=new yJ(d_)
if(S.isHorizontal=!1,S.id=t.id,S.title=r.title,S.presentationHints={isWidthConstrained:!0},a(null===(l=r.displayStyle)||void 0===l?void 0:l.layoutSize)&&(S.contentsMetadata={type:"searchLandingChartsAndCategoriesSection",numberOfColumns:r.displayStyle.layoutSize}),r.hasSeeAll){const t=new FY(d_)
t.pageUrl=r.seeAllLink,t.title=e.loc.string(gH)
const n={...c.metricsOptions,targetType:TW}
ea(e,t,t.pageUrl,n),S.seeAllAction=t}Nh(e,S,c.metricsOptions)
const P=n?Vm.seeAllPage:Vm.other
for(const t of b){let n=null,i=null
if(t.type===_V)n=null!==(u=j(t,AW))&&void 0!==u?u:"tagbrick"
else{const e=B(t,mV)
s(e)&&(n=f(e,AW),i=f(e,uU))}const a=nf(e,t,P,null===(d=null==r?void 0:r.displayStyle)||void 0===d?void 0:d.layoutDensity),l=j(t,HH),b=B(t,jq),S=f(b,eW),I=we(t,RH)
let C=!0,k=null,O=!1
if(t.type===_V){const r=Ni(e,f(t,CG)),o=e.required(O3).fetchFlowPage(r),i=new FY(o)
i.pageUrl=r,i.title=n,k=i}else if((0,Jv.isSome)(S))switch(l){case"CategoryChart":const t=new FY(vG)
t.pageUrl=S,t.title=n,O=!0,k=t
break
case"External":if(C=!1,f(b,S$)===NL)k=new JY(S),k.title=null!=n?n:""
else{const t=e.required(O3).fetchFlowPage(S),r=new FY(t)
r.pageUrl=S,r.title=null!=n?n:"",k=r}}else{if(!s(I))continue
{const t=Ni(e,I[0].href)
if(!((null==t?void 0:t.length)>0))continue
{const e=new FY(SW)
e.pageUrl=t,e.title=n,k=e}}}if(Xs(e,k,Vw(0,null===(h=null==r?void 0:r.displayStyle)||void 0===h?void 0:h.layoutDensity,t,c)),C&&o(n))continue
let E=new gee(n,a,null,null,i,k,null===(p=null==r?void 0:r.displayStyle)||void 0===p?void 0:p.layoutDensity,O?void 0:Jw(null===(w=null==r?void 0:r.displayStyle)||void 0===w?void 0:w.layoutDensity),O?void 0:Kw(null===(g=null==r?void 0:r.displayStyle)||void 0===g?void 0:g.layoutDensity)),R=jw(e,E,t,c)
O6.GroupingBrick
const D=os(e,t,0,0,0,R)
if((0,Jv.isSome)(D)&&D.length>0){const o=D[0].backgroundColor;(0,Jv.isSome)(o)&&(null==o?void 0:o.type)===GV&&(E=new gee(n,null,D,null!==(v=ah(o))&&void 0!==v?v:void 0,i,k,null===(m=null==r?void 0:r.displayStyle)||void 0===m?void 0:m.layoutDensity,Jw(null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.layoutDensity),Kw(null===(A=null==r?void 0:r.displayStyle)||void 0===A?void 0:A.layoutDensity)),R=jw(e,E,t,c))}Nh(e,E,R),T.push(E),_h(c.metricsOptions.locationTracker)}return o(T)?null:(S.items=T,S)}function Jw(e){switch(e){case em.Density1:return h4.defaultTileArtworkSafeArea
case em.Density2:return h4.defaultPillArtworkSafeArea
case em.Density3:default:return}}function Kw(e){switch(e){case em.Density1:return h4.defaultTileTextSafeArea
case em.Density2:return h4.defaultPillTextSafeArea
default:return}}async function Zw(e,t){const n=new yY(t,e.url).forType(Wx).includingAgeRestrictions().includingScopedRelationships(ak,[mW]).enablingFeatures([PV,UF]).addingQuery(tz.name,oN)
ji(t,xx)&&Ti(n),t.bag.enableUpdatedAgeRatings&&n.includingAttributes([Fq])
const r=Ln(t,n)
return await r.then(e=>zw(t,e))}function Qw(e){switch(e){case VH:return rO
case oG:return JF
case gW:return lL
case pW:return"joystickcontroller.fill"
default:return}}function Xw(e,t,n,r,i){if(o(r))return null
const s=i_,a=n.term,c=r.displayLabel,l=t===QI?new d5(c,r.finalTerm,null,s):new yee(c,s)
!function(e,t,n,r,o){const i=Zx,s=nC,a={targetId:n},c=_t(e,n,s,{actionType:i,location:Ih(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},n),searchTerm:r},[Zx])
t.actionMetrics.addMetricsData(c)
const l=Lt(e,r,s,i,null,a,[Zx])
t.actionMetrics.addMetricsData(l)}(e,l,c,a,i)
const u=new Aee(c,r.isSelected,void 0,c,l)
return Bn(0,u,nC,i),u}function eg(e,t,n){const r=S(t),i=S(t.attributes)
return i[tU]=n.adData,r.attributes=i,function(e,t,n){var r
const i=Ve(Ge(e,t))
if(n.selectedCppId===i||o(null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.cppData))return
const s=S(t.meta)
s.cppData[jU]=n.selectedCppId,t.meta=s}(e,r,n),hn(0,r,n.instanceId),r}function tg(e,t,n){const r=S(t)
if((0,Jv.isNothing)(t.attributes))return r
const o=S(t.attributes)
return o[tU]=n.adData,o[FI]=n.failureReason,r.attributes=o,hn(0,r,n.instanceId),r}function ng(e,t,n){const r=t||{},o=[]
e.client.deviceType!==vW&&o.push(new See(eB,[new Pee(e.loc.string(NI),null,r[eB]),new Pee(e.loc.string(BI),Uq,r[eB])])),o.push(new See(tN,[new Pee(e.loc.string(JD,KU),null,r[tN]),new Pee(e.loc.string(UI,KU),pO,r[tN])]))
const s=Tn(e,n,!1)
if(s){const t=s.categories
if(t.length){const n=t.filter(e=>i(e.genreId)).map(e=>new Pee(e.name,e.genreId,r[_H]))
n.unshift(new Pee(e.loc.string(KD,KU),null,r[_H])),o.push(new See(_H,n))}}const a=e.bag.searchSortOptions,c=[]
c.push(new Pee(e.loc.string(ZD),null,r[rH]))
for(const t of a)c.push(new Pee(e.loc.string(GI+t),t,r[rH]))
c.length>1&&o.push(new See(rH,c))
const l=e.bag.ageBands.map(e=>new Pee(f(e,AW),f(e,fE),r[dB]))
return l.length>0&&e.client.deviceType!==vW&&o.push(new See(dB,l)),o}function rg(e,t){let n=null,r=null,o=null
const s=new F9(eB,eB,e.loc.string("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),TB,[new $9(e.loc.string(NI),null),new $9(e.loc.string(BI),Uq)],null,null,ig(e,eB)),a=new F9(jI,jI,e.loc.string("SEARCH_FACET_TYPE_TITLE_PRICE"),TB,[new $9(e.loc.string(JD,KU),null),new $9(e.loc.string(UI,KU),pO)],null,null,ig(e,tN)),c=Tn(e,t,!1)
if(c){const t=c.categories
if(t.length){const r=t.filter(e=>i(e.genreId))
n=new F9(VI,VI,e.loc.string("SEARCH_FACET_TYPE_TITLE_CATEGORY"),TB,[new $9(e.loc.string(KD,KU),null)],null,null,ig(e,_H))
for(const e of r)n.options.push(new $9(e.name,e.genreId))}}const l=e.bag.searchSortOptions
r=new F9(rH,rH,e.loc.string("SEARCH_FACET_TYPE_TITLE_SORT"),TB,[new $9(e.loc.string(ZD),null)],null,null,ig(e,rH))
for(const t of l)r.options.push(new $9(e.loc.string(GI+t),t))
const u=e.bag.ageBands.map(e=>new $9(f(e,AW),f(e,fE)))
u.length>0&&e.client.deviceType!==vW&&(o=new F9(HI,HI,e.loc.string("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),TB,u,null,null,ig(e,dB)))
const d=new N9([],!1,null)
{const e=[s,a]
i(n)&&e.push(n),e.push(r),i(o)&&e.push(o)
for(const t of e)t.showsSelectedOptions=!0
d.facetGroups.push(new B9(e))}return d}function og(e){return{targetPlatform:[new $9(e.loc.string("SEARCH_FACET_IPAD_ONLY"),null)],"filter[price]":[new $9(e.loc.string(JD,KU),null)],sort:[new $9(e.loc.string(ZD),null)],"filter[genre]":[new $9(e.loc.string(KD,KU),null)]}}function ig(e,t){const n=new xW
return ta(e,n,t),n}function sg(e,t){const n=e.bag.searchResultsLearnMoreEditorialId
if((0,Jv.isNothing)(n)||0===(null==n?void 0:n.length))return
const r={kind:Ij,softwareType:null,title:e.loc.string(ZI),id:n,targetType:jq,pageInformation:t.pageInformation,locationTracker:t.locationTracker},o=e.loc.string("SEARCH_TRANSPARENCY_TEXT"),i=new FY(Eq)
i.title=o,i.pageUrl=`https://apps.apple.com/story/id${n}`,Xs(e,i,r)
const s={}
s[`${e.loc.string(ZI)}`]=i
const a=new D5(o,JV)
return new _5(a,s)}function ag(e){return A(e)&&function(e){return(0,Jv.isSome)(Iee[e])}(e[PW])}function cg(e,t){if(!H(t,o_))return null
const n=j(t,f_)
if(s(n))return n
const r=j(t,nq)
return s(r)?r.replace(/\n/g," "):null}function lg(e){return ag(e)&&e[PW]===yy}function ug(e,t,n,a,c,l,d,f){return Kv.context("searchResultFromData",()=>{var h
let p
const w=t.type,g={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:FV,createUniqueImpressionId:!0},hideZeroRatings:!0,artworkUseCase:O6.SearchIcon,isNetworkConstrained:null!=l?l:void 0,canDisplayArcadeOfferButton:rh(0,P$),clientIdentifierOverride:null!==(h=wg(0,d))&&void 0!==h?h:void 0,isMultilineTertiaryTitleAllowed:!1},v=function(e,t,n){var r,o
if(!function(e){return e.client.deviceType===lW}(e))return dH
const s=t.meta,a=null===(r=null==s?void 0:s.displayStyle)||void 0===r?void 0:r.condensed
if(i(a))return fg(e,a)
const c=null===(o=null==n?void 0:n.displayStyle)||void 0===o?void 0:o.condensed
return i(c)?fg(e,c):hg(e)}(e,t,f)
switch(w){case XN:case DF:case yV:case sW:case UV:const l=So(e,t,{useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0},new zZ(c.pageInformation,c.locationTracker))
if(l&&l.media&&l.media.kind===tG){const e=l.media.lockup
e.theme=Jq,p=new Dee(e)}else if(function(e,t,n){if((u(n,"experiments.showGridCard")?Eee:Ree)!==Ree)return!1
switch(t.type){case UV:return s(G(t,h_))
case XN:case DF:return!0
case sW:switch(ko(t)){case Cm.List:case Cm.NumberedList:case Cm.Grid:case Cm.River:return!0
default:return!1}default:return!1}}(0,t,n)){const n=function(e,t,n){const r=function(e,t){if(t.type===yV)return e.loc.string(XI)
const n=cg(0,t)
return s(n)?n:e.loc.string("Search.EditorialSearchResultType.Heading.Collection")}(e,t),i=function(e,t){return t.type===yV?j(t,AW):Jf(e,t,AW)}(e,t),a=Vh(e,t,i,{targetType:FV,pageInformation:n.pageInformation,locationTracker:n.locationTracker})
Ch(0,a,i)
const c=Bd(e,t,{actionType:bW,targetType:TW,pageInformation:n.pageInformation,locationTracker:n.locationTracker,id:BR,idType:Oq},e.host.clientIdentifier)
c.title=e.loc.string(gH)
const l={lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:cW},skipDefaultClickAction:!1,artworkUseCase:O6.SearchIcon,hideCompatibilityBadge:!1},filter:rm.UnsupportedPlatform}
let u=we(t,$H)
o(u)&&(u=we(t,r_))
const d=Nd(e,u,l)
Oh(n.locationTracker)
const f=new Oee(r,i,d,c,null)
return Nh(e,f,a),o(d)?null:f}(e,t,c)
n&&(p=n)}else{const n=function(e,t,n,o){return Kv.context("editorialSearchResultFromData",()=>{var a
let c
const l=null!==(a=j(t,AW))&&void 0!==a?a:void 0
switch(t.type){case UV:{const n=new Mee(l),r=G(t,h_)
if(s(r))n.collectionAdamIds=r
else{const r=Xd(e,B(t,fW),{useCase:O6.SearchEditorialResult,allowingTransparency:!0})
n.iconArtwork=r}n.type=Zj,c=n
break}case XN:case DF:{const n=new Mee(l)
n.artwork=Xd(e,B(t,fW),{useCase:O6.SearchEditorialResult,cropCode:"sr"}),n.collectionAdamIds=G(t,h_),n.type=zV,c=n
break}case sW:{if(e.bag.searchFilterEditorialItemIds.has(t.id))return null
const a=new zZ(n.pageInformation,n.locationTracker),l=function(e,t,n,o){const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0}
a.prevailingCropCodes=o&&e.client.isPhone?{defaultCrop:"DMGE.AppST01"}:{defaultCrop:"fo"}
const c=So(e,t,a,n)
if(!c)return null
const l=new Mee(c.title)
l.type=oG,l.clickAction=c.clickAction
let u=null
if(c.media)switch(c.media.kind){case Cj:const n=c.media
switch(l.artwork=n.artworks[0],r(l.artwork)&&(l.iconArtwork=n.icon),j(t,GN)){case Cm.AppOfTheDay:case Cm.GameOfTheDay:const n=pe(e,t,$H)
n&&(l.title=j(n,AW)||l.title)}break
case iO:case uL:u=c.media.lockups
break
case fW:const o=c.media
l.artwork=o.artworks[0]
break
case AH:case t$:u=c.media.lockups
break
case dq:const s=c.media
if(l.artwork=s.videos[0].preview,l.video=s.videos[0],Fr(d=c.overlay)&&d[PW]===xy){const e=c.overlay
l.title=e.title,l.subtitle=e.description}else l.subtitle=s.description
break
case oB:const a=c.media
if(l.artwork=a.artworks[0],l.appEventFormattedDates=a.formattedDates,l.subtitle=c.inlineDescription,l.tintColor=a.tintColor,l.type="appEventStory",i(c.style))switch(c.style){case Tq:case mq:l.mediaOverlayStyle=Tq
break
case Jq:l.mediaOverlayStyle=Jq
break
default:x(c.style)}}var d
if(c.overlay)switch(c.overlay.kind){case cW:const e=c.overlay
l.artwork||(u=[e.lockup])
break
case Cy:u=c.overlay.lockups
break
case Hj:const t=c.overlay
l.subtitle=t.paragraph.text}if(i(u)){l.collectionAdamIds=[],l.collectionAppIcons=[]
for(const e of u)l.collectionAdamIds.push(e.adamId),l.collectionAppIcons.push(e.icon)
1===u.length&&(l.lockup=u[0])}const f=On(0,t)
l.editorialDisplayOptions=En(f)
const h=cg(0,t);(null==h?void 0:h.length)>0&&h!==l.title&&(l.tagline=h)
const p=c.heroMedia
return s(p)&&(s(p.artworks[0])?(l.artwork=p.artworks[0],l.artwork.crop="em"):s(p.videos[0])&&(l.video=p.videos[0])),l.video&&(l.video.canPlayFullScreen=!1,l.video.playbackControls={}),l.collectionAdamIds||l.artwork||l.iconArtwork?l:null}(e,t,a,o===sU)
c=l
break}case yV:{const n=new Mee(l)
if(n.artwork=Xd(e,B(t,rM),{useCase:O6.SearchEditorialResult,cropCode:"sr"}),n.type=VH,(0,Zv.isSome)(n.artwork))c=n
else{let r=we(t,r_)
r=r.filter(t=>!at(e,t,rm.DeveloperPage))
const o=[],s=[]
r.forEach(t=>{o.push(t.id)
const n=rf(e,t,{useCase:O6.SearchEditorialResult})
i(n)&&s.push(n)}),n.collectionAdamIds=o,n.collectionAppIcons=s,c=n}break}}if(r(c))return null
if(lg(c)&&null!=c.collectionAdamIds&&c.collectionAdamIds.length){const e=c.collectionAdamIds.length
c.artworkGridType=e<=5?"extraLarge":e<=8?_q:e<=16?tC:eq}const u=Vh(e,t,c.title,n)
return c.clickAction=Bd(e,t,u,null),Nh(e,c,u),c})}(e,t,g.metricsOptions,v)
n&&(n.title&&(n.title=n.title.replace(/\n/g," ")),lg(n)&&n.subtitle&&(n.subtitle=n.subtitle.replace(/\n/g," ")),p=n)}break
case rq:if(o(Kd(e,t)))return null
const d=Ed(e,t,g)
d.theme=Jq,pg(e,d,f),p=new Dee(d)
break
default:if(delete t.attributes[GG],w===aW){g.shouldIncludeScreenshotsForChildren=e.featureFlags.isEnabled(GJ)
const n=Od(e,t,g)
n.showMetadataInformationInLockup=!0,pg(e,n,f),p=new _ee(n)}else{const n=_d(e,t,g,{canPlayFullScreen:!1,playbackControls:{}},f)
pg(e,n,f)
const o=function(e,t,n,o,s,a){return Kv.context("appEventSearchResultFromData",()=>{if(!gg(e,t))return null
const{dataItems:c,personalizationData:l}=vg(e,t,s)
let d,f
for(const n of c){const r=mg(e,n,t,a,o.offerEnvironment,o.offerStyle)
if(i(r)){d=r,f=null!=t?t:pe(e,n,rW)
break}}if(r(d))return null
const h=u(t.meta,w_),p=new xee
p.lockup=n,p.appEvent=d,p.alwaysShowAppEvent=h,p.clickAction=n.clickAction
const w=Sh(null,null==l?void 0:l.processingType,null),g={...a,id:d.appEventId,kind:SA,targetType:f$,title:d.title,softwareType:null,recoMetricsData:w}
return i(f)&&(g.relatedSubjectIds=[f.id]),Nh(e,p,g),p})}(e,t,n,g,a,c)
i(o)?(p=o,p.condensedBehavior=dH):p=new Lee(n)}}return i(p)&&r(p.condensedBehavior)&&(p.condensedBehavior=v),p})}function dg(e,t,n,r,o,s){if(!gg(e,t))return!1
const{dataItems:a}=vg(e,t,null!=s?s:null)
let c
for(const n of a)if(c=mg(e,n,t,o,void 0,void 0),(0,Zv.isSome)(c))break
const l=!(!i(n)||!i(n[t.id]))&&n[t.id],u=!(!i(r)||!i(r[t.id]))&&["downloadable"].includes(r[t.id])
return(l||u)&&(0,Zv.isSome)(c)}function fg(e,t){switch(t){case sU:return sU
case dH:return dH
case"when-installed":return eC
default:return hg(e)}}function hg(e){return e.client.deviceType===lW?eC:dH}function pg(e,t,n){if(!n)return
const o=function(e,t,n,o){var i
if(r(t)||!e.client.isPhone)return null
const a=null===(i=null==t?void 0:t.displayStyle)||void 0===i?void 0:i.metadataPrecedenceOrder
if(!s(a))return null
const c=a.indexOf(n),l=a.indexOf(o)
return-1===c&&-1===l?null:-1!==c&&(-1===l||c<l)}(e,n,kG,JU)
i(o)&&(t.isEditorsChoice=t.isEditorsChoice&&o)}function wg(e,t){return t===gW?hY:null}function gg(e,t){if(!ii(e)||r(t.meta))return!1
const n=l(t.meta,p_).length>0
return![XN,DF,yV,sW,UV,rq,aW].includes(t.type)&&n}function vg(e,t,n){const r=u(t.meta,w_),o=l(t.meta,p_)
if(r)return{dataItems:[o[0]]}
const i=Ts(e,Rq,o,!1,n,!1,void 0,t.id),s=i.personalizedData
return s.length<=0?{dataItems:[]}:{dataItems:s,personalizationData:i}}function mg(e,t,n,o,i,s){const a=gi(e,t,n,!1,!0,i,s,!1,{...o,targetType:f$},!1,!0,null,!1,!1)
return r(a)||a instanceof Date?null:a}function yg(e,t,n,s,a,c,l,d,f){var h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E
const R=new $ee,D=function(e){if(e.client.isPhone&&!e.clientCapabilities.isNotEnabled(kY))switch(Ne(e,nm.SearchResultsAdBackground)){case Fee:return"ad"
case Nee:return"clearAdWithSeparator"
case Bee:return uR
default:return}}(e);(0,Jv.isSome)(D)&&(R.itemBackground=D)
const _=null!==(h=s.requestDescriptor.isNetworkConstrained)&&void 0!==h&&h,L={canPlayFullScreen:!1,playbackControls:{}}
tn(e)||Ch(0,{id:aF,kind:qS,softwareType:null,targetType:null,title:aF,pageInformation:a.pageInformation,locationTracker:a.locationTracker,idType:Oq},aF)
const M=t[n],x=Array.isArray(M)?M:[M],$=t[n-1],F=t[n+1]
let N
Zt(e,`Adverts received from ad server: ${x.filter(Jv.isSome).map(e=>`[${e.id}]`).join(", ")}`)
let B=!0
for(const s of x){if((0,Jv.isNothing)(null==s?void 0:s.attributes))continue
if(at(e,s)){Zt(e,`[${s.id}] filtered by shouldFilter() - app probably not supported on current os or device`)
continue}const h=Ag(s.id,$,F,c),I=(0,Jv.isSome)(h),C=kg(t,I)
if(s.attributes[GG]=Cg(s,C),o(s.attributes[GG])){Zt(e,`[${s.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`)
continue}const k={metricsOptions:{pageInformation:a.pageInformation,locationTracker:a.locationTracker,targetType:FV,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:O6.SearchIcon,isNetworkConstrained:_,canDisplayArcadeOfferButton:rh(0,P$)},O=u(Ke(e,s,GG),"format.images")
let E=!1
const D=o(N),M=Ig(xd(e,s,k,L,d,!0,n)),x=E?YF:null===(p=null==d?void 0:d.displayStyle)||void 0===p?void 0:p.screenshots,U=bg(e,M,s.id,C,O,N,x,h,c,l,a,f)
if(r(U)){Zt(e,`[${s.id}] will not be displayed because we could not create an ad style compatible with ${Rg(N)}`)
continue}if(!pn(e,s,null,U.style)){Zt(e,`[${s.id}] filtered because localization is not available`)
continue}if(D?(Zt(e,`[${s.id}] first ad dictates ad display style of: ${Rg(U)}`),N=U):Zt(e,`[${s.id}] will be displayed because it is compatible with the display style of: ${Rg(U)}, which is the same height as display style: ${Rg(N)}`),e.client.isPad&&0!==n&&U.style===NK){Zt(e,`[${s.id}] is being dropped because it has style TEXT in an unsupported position.`),null===(g=null===(w=a.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g||g.setMissedOpportunity(e,"TXT_NOAD","0",n)
continue}if(null===(v=a.pageInformation)||void 0===v||v.adPageInfo.apply(e,s),null===(y=null===(m=a.pageInformation)||void 0===m?void 0:m.adPageInfo)||void 0===y||y.setTemplateType(e,U.style),nn(e)){const e=null!==(A=k.metricsOptions.adsMetricsData)&&void 0!==A?A:{}
let t
e[mj]=U.style,Array.isArray(F)||(null==F?void 0:F.id)!==s.id?Array.isArray($)||(null==$?void 0:$.id)!==s.id||(t="Trailing"):t="Leading",(0,Jv.isSome)(t)&&(e[sx]=t),k.metricsOptions.adsMetricsData=e}let G=xd(e,s,k,L,d,"ad"===R.itemBackground||R.itemBackground===uR,n)
if(G=Og(e,G,U,I,$,B),null===(T=G.searchAdOpportunity)||void 0===T||T.setTemplateType(U.style),U.style===NK){const t=j(s,vA)
if(t!==Iq){let n
n=Qe(e,s,t===Mq?BG:null!=t?t:void 0)
const r=null!==(b=G.searchAd)&&void 0!==b?b:null===(S=G.searchAdOpportunity)||void 0===S?void 0:S.searchAd
i(r)&&i(n)&&(r.advertisingText=n)}R.displaysScreenshots=!1}if((0,Jv.isSome)(G)){const n=Tg(t,G.adamId);(0,Jv.isSome)(n)&&!E&&(null===(P=G.searchAdOpportunity)||void 0===P||P.setDuplicatePosition(n)),R.lockups.push(G),tn(e)||_h(a.locationTracker),B=!1}}if(tn(e)||Oh(a.locationTracker),(0,Jv.isSome)(R.lockups)&&R.lockups.length>0){const t=x[0]
null===(I=a.pageInformation)||void 0===I||I.adPageInfo.apply(e,t),_h(a.locationTracker)}return(0,Jv.isSome)(N)?null===(k=null===(C=a.pageInformation)||void 0===C?void 0:C.adPageInfo)||void 0===k||k.setTemplateType(e,N.style):null===(E=null===(O=a.pageInformation)||void 0===O?void 0:O.adPageInfo)||void 0===E||E.setTemplateType(e,null),R.condensedBehavior=dH,{result:R,displayStyle:null==N?void 0:N.style}}function Ag(e,t,n,r){return[t,n].find(t=>{var n
if((0,Jv.isNothing)(t)||Array.isArray(t))return!1
const o=t.id===e,i=null!==(n=null==r?void 0:r[t.id])&&void 0!==n&&n
return o&&!i})}function Tg(e,t){const n=e.findIndex(e=>!Array.isArray(e)&&e.id===t)
return-1===n?null:n}function bg(e,t,n,r,i,s,a,c,l,u,d,f){const h=Sg(e,t,n,i,s,a)
if((0,Jv.isNothing)(h))return null
const p={platform:t.mediaPlatformUsedForDisplayStyle,style:h}
return Zt(e,`[${n}] tentatively resolved to: ${Rg(p)}`),r===Gee.DUPE_AD&&(0,Jv.isSome)(c)?function(e,t,n,r,i,s,a,c,l,u,d,f){const h=f.style
if(function(e,t){var n,r,o,i
switch(e){case CK:t.portraitScreenshots.length<=5&&t.portraitScreenshots.splice(0,4)
break
case kK:t.portraitScreenshots.splice(0,3)
break
case OK:t.portraitScreenshots.splice(0,2)
break
case EK:t.portraitScreenshots.splice(0,1)
break
case RK:null===(n=t.videos)||void 0===n||n.splice(0,1),t.portraitScreenshots.length<=4&&t.portraitScreenshots.splice(0,3)
break
case DK:null===(r=t.videos)||void 0===r||r.splice(0,1),t.portraitScreenshots.splice(0,2)
break
case _K:null===(o=t.videos)||void 0===o||o.splice(0,1),t.portraitScreenshots.splice(0,1)
break
case xK:t.landscapeScreenshots.splice(0,1)
break
case LK:case MK:null===(i=t.videos)||void 0===i||i.splice(0,1)}}(h,t),BK.includes(h))return Zt(e,`[${n}] tentative style is unrestricted. No dupe logic applied.`),f
const p=o(i),w=Sg(e,t,n,r,null,s),g=function(e,t,n){switch(t){case RK:case CK:return!0
case DK:case kK:return 3===Eg(e,n)
case xK:case MK:return!0
case _K:case OK:return 2===Eg(e)
default:return!1}}(e,w,s),v=dg(e,a,c,l,u,d)
return(g||v)&&p?(Zt(e,`[${n}] Organic Dupe would be full creative as ${w} so choosing tentative style for ad`),f):g&&!p?(Zt(e,`[${n}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${h}`),f):Pg(NK,i)?(Zt(e,`[${n}] tentative style would not yield full creative for organic result so returning TEXT`),{style:NK}):(Zt(e,`[${n}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}(e,t,n,i,s,a,c,l,u,d,f,p):(null==s?void 0:s.style)===NK?(Zt(e,`[${n}] tentative style would be filtered since the first ad has style: ${Rg(s)}, so returning TEXT`),{style:NK}):p}function Sg(e,t,n,r,o,i){if(!r)return Zt(e,`[${n}] is not allowed to display media because of iAd configuration.`),NK
const s=null==o?void 0:o.mediaPlatform
if((0,Jv.isSome)(t.mediaPlatformUsedForDisplayStyle)&&(0,Jv.isSome)(s)&&!t.mediaPlatformUsedForDisplayStyle.isEqualTo(s))return Zt(e,`[${n}] filtered because media is derived from: ${t.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${s.mediaType}`),null
for(const n of Uee){const r=n.canDisplay(t),s=Pg(n.representativeDisplayStyle,o)
if(r&&s)return n.displayStyle(e,t,i)}return Zt(e,`[${n}] filtered because we could not create a compatible style for the first style of: ${Rg(o)}`),null}function Pg(e,t){if((0,Jv.isNothing)(t))return!0
let n=[]
for(const t of UK)if(t.includes(e)){n=t
break}return n.includes(t.style)}function Ig(e){var t
let n
const r=null===(t=e.trailers)||void 0===t?void 0:t[0]
let o
s(r)&&(r.videos.sort((e,t)=>jee(e.preview,t.preview)),o=r.videos,n=r.mediaPlatform)
const i=e.screenshots[0],a=[],c=[]
return s(i)&&(i.artwork.forEach(e=>{e.isPortrait()?a.push(e):c.push(e)}),n=i.mediaPlatform),{portraitScreenshots:a,landscapeScreenshots:c,alignedRegionArtwork:e.alignedRegionArtwork,alignedRegionVideo:e.alignedRegionVideo,videos:o,mediaPlatformUsedForDisplayStyle:n}}function Cg(e,t){let n
const r=f(B(e,tU),t)
return(0,Jv.isSome)(r)&&r.length>0&&(n=JSON.parse(r)),n}function kg(e,t){return t?Gee.DUPE_AD:e.some(e=>{if(Array.isArray(e))return!1
const t=B(e,tU)
return(0,Jv.isNothing)(t)})?Gee.NORMAL:Gee.NO_ORGANIC_RESULTS}function Og(e,t,n,r,o,i){var a,c,l,u,d,f,h,p,w,g
const v=null===(c=null===(a=t.impressionMetrics)||void 0===a?void 0:a.fields)||void 0===c?void 0:c.pageCustomId,m=(0,Jv.isSome)(v)&&v.length>0
let y,A=!1
if(r&&(A=e.bag.enableSRPNextSlot?(0,Jv.isSome)(o)&&!Array.isArray(o)&&t.adamId===o.id:!i&&!m),s(t.trailers)){const e=t.trailers.shift()
null==e||e.videos.sort((e,t)=>jee(e.preview,t.preview)),(0,Jv.isSome)(e)&&t.trailers.unshift(e)}let T=[],b=[]
if(s(t.screenshots)){const e=t.screenshots.shift()
null==e||e.artwork.forEach(e=>{e.isPortrait()?null==T||T.push(e):null==b||b.push(e)}),y=null==e?void 0:e.mediaPlatform}if((0,Jv.isNothing)(y))return t
switch(n.style){case CK:if(t.trailers=null,b=null,t.screenshotsDisplayStyle=YF,A)if(T.length>5&&T.length<8){const e=T.splice(0,4),t=4-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,4)
else T.splice(4)
break
case kK:t.trailers=null,b=null,A?T.splice(0,3):T.splice(3)
break
case OK:t.trailers=null,b=null,A?T.splice(0,2):T.splice(2)
break
case EK:t.trailers=null,b=null,A?T.splice(0,1):T.splice(1)
break
case xK:t.trailers=null,T=null,A?b.splice(0,1):b.splice(1)
break
case RK:if(b=null,t.screenshotsDisplayStyle=YF,A)if(null===(l=t.trailers)||void 0===l||l[0].videos.splice(0,1),T.length>4&&T.length<7){const e=T.splice(0,3),t=3-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,3)
else null===(u=t.trailers)||void 0===u||u[0].videos.splice(1),T.splice(3)
break
case DK:b=null,A?(null===(d=t.trailers)||void 0===d||d[0].videos.splice(0,1),T.splice(0,2)):(null===(f=t.trailers)||void 0===f||f[0].videos.splice(1),T.splice(2))
break
case _K:b=null,A?(null===(h=t.trailers)||void 0===h||h[0].videos.splice(0,1),T.splice(0,1)):(null===(p=t.trailers)||void 0===p||p[0].videos.splice(1),T.splice(1))
break
case MK:case LK:A?null===(w=t.trailers)||void 0===w||w[0].videos.splice(0,1):null===(g=t.trailers)||void 0===g||g[0].videos.splice(1),b=null,T=null
break
case NK:case FK:case $K:t.trailers=null,b=null,T=null}if(s(t.trailers)){const e=t.trailers.shift()
t.trailers=[e].filter(Jv.isSome)}const S=(null!=b?b:[]).concat(null!=T?T:[])
if(s(S)){const e=new Ez(S,y)
t.screenshots=[e]}else t.screenshots=[]
return t}function Eg(e,t=null){if(e.client.isPhone){const e=3
return(0,Jv.isNothing)(t)?e:t===YF?4:3}return 2}function Rg(e){if((0,Jv.isNothing)(e))return""
let t=""
return(0,Jv.isSome)(e.mediaPlatform)&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function Dg(e,t,n,r,o){var i,s
if(!(ag(s=n)&&s[PW]===dy||function(e){return ag(e)&&e[PW]===uy}(n)))return
const a=n.lockup,c=t.lockups[0]
if(c.adamId!==a.adamId)return
const l=new Set
if((0,Jv.isSome)(c.screenshots)&&c.screenshots.length>0)for(const e of c.screenshots[0].artwork)l.add(e.template)
if((0,Jv.isSome)(c.trailers)&&c.trailers.length>0)for(const e of c.trailers[0].videos)l.add(e.preview.template)
if((0,Jv.isSome)(a.screenshots)&&a.screenshots.length>0){const e=a.screenshots[0].artwork.filter(e=>!l.has(e.template))
a.screenshots[0]=new Ez(e,a.screenshots[0].mediaPlatform)}if((0,Jv.isSome)(a.trailers)&&a.trailers.length>0){const e=a.trailers[0].videos.filter(e=>!l.has(e.preview.template))
a.trailers[0]=new Iz(e,a.trailers[0].mediaPlatform)}if((null===(i=null==r?void 0:r.displayStyle)||void 0===i?void 0:i.screenshots)===YF)switch(o){case RK:case CK:(e=>{const t=a.screenshots[0].artwork
if(t.length>=4)return
let n=4-t.length
const r=c.screenshots[0].artwork.slice().reverse()
for(const e of r){if(n<=0)return
a.screenshots[0].artwork.unshift(e),n-=1}})()}}function _g(e,t,n,r,o,i,s,a,c){var l,u,d
let f
if((null===(l=null==r?void 0:r.lockups[0])||void 0===l?void 0:l.adamId)===t.id&&(0,Jv.isSome)(n))if(Array.isArray(n)){const e=r.lockups[0]
f=n.find(t=>t.id===(null==e?void 0:e.adamId))}else f=n;(0,Jv.isNothing)(f)&&(0,Jv.isSome)(o)&&o.id===t.id&&(f=o),(0,Jv.isNothing)(f)||dg(e,t,i,s,a,c)||function(e,t){var n
let r
r=(0,Jv.isSome)(null==t?void 0:t.meta)?S(t.meta):{},(0,Jv.isNothing)(e)?null===(n=r.cppData)||void 0===n||delete n[jU]:((0,Jv.isNothing)(r.cppData)&&(r.cppData={}),r.cppData[jU]=e),t.meta=r}(null===(d=null===(u=null==f?void 0:f.meta)||void 0===u?void 0:u.cppData)||void 0===d?void 0:d[jU],t)}function Lg(e,t){var n,r,o
const i=null===(n=t.userDefaults)||void 0===n?void 0:n.integer("GuidedSearchOverrides.position")
return a(i)&&i>1?i:null===(o=null===(r=null==e?void 0:e.displayStyle)||void 0===r?void 0:r.guidedSearch)||void 0===o?void 0:o.position}async function Mg(e,t,n,r,o,s,a,c,l){var u,d,f,h,p,w,g,v,m,y,A,T,b,S
const P=[],I=[],C=n||null,k=o.filter(e=>e.type===yW).map(e=>e.id),O=Ss(e,new Set(k)),E=o
let R=[0]
if((0,Zv.isSome)(s))if(tn(e)){const t=null!==(u=sn(e,n))&&void 0!==u?u:[0]
R=t.filter((e,n)=>0===e||o.length>=e-1||t[n-1]===e-1)
for(const[t,n]of R.entries()){const o=s[t]
if((0,Zv.isSome)(o)){const t=j(o,FI);(0,Zv.isSome)(t)?null===(f=null===(d=r.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f||f.recordAdResponseEventsIfNeeded(e,t,"0",n):E.splice(n,0,o)}else null===(p=null===(h=r.pageInformation)||void 0===h?void 0:h.adPageInfo)||void 0===p||p.setMissedOpportunity(e,sF,"0",n)}}else E.splice(0,0,s),nn(e)&&0===s.length&&(null===(g=null===(w=r.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g||g.setMissedOpportunity(e,sF,"0",0))
const D=Lg(n,e)
let _,L,M
for(const[s,u]of E.entries()){if(s===D){const o=xg(e,t.requestDescriptor,a,r)
if(o.length>0){const t=null!==(y=null===(m=null===(v=null==n?void 0:n.displayStyle)||void 0===v?void 0:v.guidedSearch)||void 0===m?void 0:m.title)&&void 0!==y?y:e.loc.string("Search.Guided.Title.ExploreMore"),i=new kee(t,o)
Nh(e,i,{...r,id:KI,kind:tV,targetType:CO,title:t,softwareType:null}),P.push(i),_h(r.locationTracker)}}if(Array.isArray(u)||(0,Zv.isSome)(fn(0,u))){const n=yg(e,E,s,t,r,null!=c?c:null,null!=l?l:null,C,O),o=n.result
_=o,L=n.displayStyle,M=u,(0,Zv.isSome)(null===(A=null==o?void 0:o.lockups)||void 0===A?void 0:A[0])&&(o.searchAdOpportunity=o.lockups[0].searchAdOpportunity,P.push(o))
continue}if(!i(u.attributes)){I.push(...o.slice(s))
break}if(at(e,u,rm.Search))continue
let d
const f=E[s+1]
Array.isArray(f)||!(0,Zv.isSome)(B(f,tU))||at(e,f)||(d=f),((0,Zv.isSome)(null==_?void 0:_.lockups)&&_.lockups.length>0||(0,Zv.isSome)(d))&&_g(e,u,M,_,d,c,l,r,O)
const h=ug(e,u,n,O,r,t.requestDescriptor.isNetworkConstrained,t.requestDescriptor.searchEntity,C)
!(0,Zv.isNothing)(h)&&((0,Zv.isSome)(null==_?void 0:_.lockups)&&_.lockups.length>0&&Dg(0,_,h,C,L),Jt(e)&&R.includes(s)&&(0,Zv.isSome)(null===(T=r.pageInformation)||void 0===T?void 0:T.adPageInfo)&&(h.searchAdOpportunity=qt(e,r.pageInformation),null===(b=h.searchAdOpportunity)||void 0===b||b.setMissedOpportunityReason(sF),null===(S=h.searchAdOpportunity)||void 0===S||S.setTemplateType(lG)),P.push(h),_h(r.locationTracker),_=void 0,L=void 0,M=void 0)}return await async function(e,t){return await Kv.context("applyClientFilteringToIAPs",async()=>{const n={}
for(const e of t)if(e.resultType===tG){const t=e.lockup
t.parent&&t.productIdentifier&&t.parent.bundleId?n[t.productIdentifier]=t.parent.bundleId:Kv.unexpectedNull(DH,zq,`required fields for ${t.adamId}`)}return 0===Object.keys(n).length?await Promise.resolve(t):await e.clientOrdering.visibilityForIAPs(n).then(e=>t.filter(t=>{if(t.resultType!==tG)return!0
const n=t.lockup
return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}))})}(e,P).then(e=>({builtSearchResults:e,deferredSearchResults:I}))}function xg(e,t,n,r){if((0,Zv.isNothing)(n)||0===n.length)return[]
kh(0,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:a_},"")
const o=[]
for(const i of n){const n=Xw(e,QI,t,i,r)
n&&(o.push(n),_h(r.locationTracker))}return Oh(r.locationTracker),o}function $g(e,t,n,r){const o=new d5(t,t,null,r)
return o.spellCheckEnabled=!1,o.excludedTerms=[n],o.originatingTerm=n,o}function Fg(e,t){return t&&t.results?t.results.slice(0,t.maxPerPage):[]}function Ng(e,t){let n=[]
if(t&&t.results&&(n=t.results.slice(t.maxPerPage,t.results.length)),o(n))return null
const r={...t}
return r.results=n,r}function Bg(e){return(0,Jv.isSome)(e)&&0!==e.length?`SearchResults.${e}.shelfId`:"SearchResults.shelfId"}function Ug(e){switch(e){case Xm.iOS:return xq
case Xm.visionOS:return"visionos"
default:return"SearchTopResults"}}function Gg(e,t){const n=new sZ
return i(t)&&(n.facets=ng(e,t),n.pageFacets=rg(e),n.selectedFacetOptions=og(e)),n.results=[],n}function jg(e,t){const n=new qee([])
return i(t)&&(n.facets=ng(e,t),n.pageFacets=rg(e),n.selectedFacetOptions=og(e)),n}async function Vg(e,t){return await Kv.context("searchResultsFromResponse",async()=>{var n
const r=null!==(n=e.fetchTimingMetricsBuilder)&&void 0!==n?n:new $m.FetchTimingMetricsBuilder,a=await r.measureModelConstructionAsync(async()=>{var n,r,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E
const R=t.catalogResponse,D=t.requestMetadata,_=D.searchRequestUrl,L=t.searchResultsAdsRequestData,M=R.results.guidedSearch,$=function(e,t,n){var r,o,i,s,a,c,l
return{term:t.term,suggestedTerm:null===(o=null===(r=n.results)||void 0===r?void 0:r.spellCheck)||void 0===o?void 0:o.suggestedTerm,correctedTerm:null===(s=null===(i=n.results)||void 0===i?void 0:i.spellCheck)||void 0===s?void 0:s.correctedTerm,resultsTerm:null!==(l=null===(c=null===(a=n.results)||void 0===a?void 0:a.spellCheck)||void 0===c?void 0:c.correctedTerm)&&void 0!==l?l:t.term,originatingTerm:t.originatingTerm}}(0,D.requestDescriptor,R),F=(O=t.searchResultsAdData,(0,Jv.isSome)(O)&&"odmlSuccess"in O&&O.odmlSuccess),N={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:qn(e,D.requestDescriptor,R,$,_,Ug(),L,F,M),createUniqueImpressionId:!0},B=e.featureFlags.isEnabled(LJ)||!0,U=B?new qee:new sZ,G=Lg(R.meta,e);(0,Jv.isNothing)(G)&&function(e,t,n,r,i){const a=n.requestDescriptor
kh(0,{pageInformation:i.pageInformation,locationTracker:i.locationTracker,targetType:a_},"")
const c=[]
if(s(r))for(const t of r){const n=Xw(e,cN,a,t,i)
n&&(c.push(n),_h(i.locationTracker))}if(o(c)&&n.requestDescriptor.searchEntity){const t=function(e,t,n){var r
const o=t.searchEntity
if(!o)return null
const i=new bee(null,i_)
let s
switch(function(e,t,n,r,o){const i=oF,s=ax,a={targetId:r},c=_t(e,r,s,{actionType:i,location:Ih(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},r),searchTerm:n})
t.actionMetrics.addMetricsData(c)
const l=Lt(e,n,s,i,null,a)
t.actionMetrics.addMetricsData(l)}(e,i,t.term,o,n),o){case pW:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE")
break
case VH:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS")
break
case oG:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_STORIES")
break
case gW:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_APPLEWATCH")
break
default:x(o)}const a=new Aee(s,!0,null!==(r=Qw(o))&&void 0!==r?r:oO,s,i)
return Bn(0,a,ax,n),a}(e,n.requestDescriptor,i)
c.push(t),_h(i.locationTracker)}const l=function(e,t,n){var r
if(o(n))return null
const i=t.term,s=null!==(r=t.guidedSearchTokens)&&void 0!==r?r:[],a=[]
for(const e of n){const t=e.displayLabel,n=Array.from(s)
if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t)
const r=new Tee(i,n,e.finalTerm)
a.push(r)}return a}(0,n.requestDescriptor,r)
Oh(i.locationTracker),s(c)&&(t.guidedSearchTokens=c,t.guidedSearchQueries=l,function(e,t,n){const r=Eh(n.locationTracker)
t.guidedSearchTokensParentImpressionMetrics=new KY({impressionIndex:r,impressionType:a_,idType:VU,id:rC,name:"Search Revisions"})}(0,t,i),_h(i.locationTracker))}(e,U,D,null==M?void 0:M.facets,N)
const j={id:rN,kind:null,softwareType:null,targetType:sV,title:nU,pageInformation:N.pageInformation,locationTracker:N.locationTracker,idType:VU}
let V
B&&(V=new yJ($x),V.id=Bg(),V.isHorizontal=!1,Nh(e,V,j),Ch(0,j,nU))
let H=function(e,t){return function(e,t,n){if((0,Jv.isNothing)(n))return t
const r=[],o=t.reduce((e,t)=>({...e,[t.id]:t}),{})
if("adverts"in n){if((0,Jv.isNothing)(n.adverts)||0===n.adverts.length)return t
for(const t of n.adverts){const n=o[t.adamId]
if((0,Jv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Jv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=eg(e,n,t)
r.push(i)}}else if("ads"in n){if((0,Jv.isNothing)(n.ads)||0===n.ads.length)return t
for(const t of n.ads){const n=o[t.adamId]
if((0,Jv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Jv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=tg(0,n,t)
r.push(i)}}return r}(e,At(t.catalogResponse.results[u_]),t.searchResultsAdData)}(e,t)
const q=t.searchResultsAdData
if((0,Jv.isSome)(q)&&"appliedPolicy"in q&&(0,Jv.isSome)(q.appliedPolicy)&&(H=[],"ageRestricted"===q.appliedPolicy)){const t=null!==(n=an(e,vq,!0,R.meta))&&void 0!==n?n:[]
for(const n of t)null===(a=null===(r=N.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===a||a.setMissedOpportunity(e,TS,"0",n.slot)}const W=null!==(d=null===(u=null===(l=null===(c=R.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.searchSafety)&&void 0!==d&&d,z=(null===(w=null===(p=null===(h=null===(f=R.meta)||void 0===f?void 0:f.results)||void 0===h?void 0:h.search)||void 0===p?void 0:p.reason)||void 0===w?void 0:w.kind)===l_?"NLS_NORESULTS":"NLS_NOAD"
if(W){H=[]
const t=null!==(g=an(e,vq,!0,R.meta))&&void 0!==g?g:[]
for(const n of t)null===(m=null===(v=N.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===m||m.setMissedOpportunity(e,z,"0",n.slot)}const Y=await Mg(e,D,R.meta,N,function(e,t){return At(t.catalogResponse.results.search)}(0,t),H,null==M?void 0:M.facets,function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.installedStates)&&void 0!==n?n:{}}(t),function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.appStates)&&void 0!==n?n:{}}(t))
if(W&&0!==Y.builtSearchResults.length){const e=Y.builtSearchResults[0].lockup.searchAdOpportunity
null==e||e.setMissedOpportunityReason(z),null==e||e.setTemplateType(lG)}if(B&&V){const t=U
V.items=Y.builtSearchResults,t.resultsParentImpressionMetrics=V.impressionMetrics,t.shelves.push(V)
const n=function(e,t){return Kv.context("createSearchResultsContextCard",()=>{var n,r
if((0,Jv.isNothing)(e)||![gV,KV].includes(t.host.platform))return
const o=null===(n=e.links)||void 0===n?void 0:n.map(Hg),i=null==o?void 0:o.reduce((e,t)=>{var n
return(null===(n=t.title)||void 0===n?void 0:n.length)&&(e[t.title]=t),e},{})
let s=e.text
1===(null==o?void 0:o.length)&&(null===(r=o[0].title)||void 0===r?void 0:r.length)?s+=" "+o[0].title:o&&o.length>1&&(s.length>0&&(s+="\n"),s+=o.map(e=>e.title).filter(e=>null==e?void 0:e.length).join("\n"))
const a=new D5(s),c=new _5(a,i)
return new Wee(c)})}(R.results.queryContext,e),r=null===(T=null===(A=null===(y=R.meta)||void 0===y?void 0:y.results)||void 0===A?void 0:A.search)||void 0===T?void 0:T.reason
if((null==r?void 0:r.kind)===l_)t.unavailableReason={title:e.loc.stringWithFallback("Search.Results.Empty.Title","No results"),message:r.text,action:(E=r.links,Kv.context("actionFromSearchResultsLinks",()=>{const e=null==E?void 0:E.find(e=>e.url.length>0)
return e?Hg(e):void 0})),contextCard:n}
else if(n){const e=new yJ("searchResultsContextCard")
e.items=[n]
const r=null!==(I=null===(P=null===(S=null===(b=R.meta)||void 0===b?void 0:b.displayStyle)||void 0===S?void 0:S.queryContext)||void 0===P?void 0:P.position)&&void 0!==I?I:0
if(r>0){const n=V.items.splice(r),o={...V,id:"searchResults2",items:n}
t.shelves.push(e),t.shelves.push(o)}else t.shelves.unshift(e)}W&&0===Y.builtSearchResults.length&&(null===(k=(C=e.onDeviceSearchHistoryManager).removeRecentSearchTerm)||void 0===k||k.call(C,$.term))}else{const e=U
e.results=Y.builtSearchResults,function(e,t,n){const r=Eh(n.locationTracker)
t.resultsParentImpressionMetrics=new KY({impressionIndex:r,impressionType:sV,idType:VU,id:rN,name:nU})}(0,e,N)}return Y.deferredSearchResults.length>0&&(U.nextPage=function(e,t,n,r,i){return o(t)?null:{results:t,maxPerPage:30,requestMetadata:n,metricsOptions:i,responseMetadata:null!=r?r:{},contentOffsetWithinResultsShelf:Eh(i.locationTracker)}}(0,Y.deferredSearchResults,D,R.meta,N)),B&&Oh(j.locationTracker),U.message=function(e,t,n){const r=i(t.correctedTerm),o=i(t.suggestedTerm)
return kh(0,{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:jq},"spellCorrection"),r?function(e,t,n){const r=t.term,o=$g(0,r,t.resultsTerm,jR)
na(e,o,TW,n.locationTracker)
const i=`<i>${t.correctedTerm}</i>`,s=e.loc.string("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(c_,i),a=new _5(new D5(s,EV),{}),c=e.loc.string("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(c_,r),l={}
l[`${c}`]=o
const u=new _5(new D5(c),l)
return new Vee(a,u,o)}(e,t,n):o?function(e,t,n){const r=t.suggestedTerm,o=$g(0,r,t.resultsTerm,VR)
na(e,o,TW,n.locationTracker)
const i=`<i>${r}</i>`,s=e.loc.string("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(c_,i),a={}
a[`${r}`]=o,a[`${r}?`]=o
const c=new _5(new D5(s,EV),a)
return new Vee(c,null,o)}(e,t,n):(Oh(n.locationTracker),null)}(e,$,N),!o(D.requestDescriptor.searchEntity)||(U.facets=ng(e,D.requestDescriptor.facets,t.categoriesFilterData),U.pageFacets=rg(e,t.categoriesFilterData),U.selectedFacetOptions=s(t.requestMetadata.requestDescriptor.selectedFacetOptions)?t.requestMetadata.requestDescriptor.selectedFacetOptions:og(e)),U.searchTermContext=$,U.isAutoPlayEnabled="tv"!==e.client.deviceType,U.isCondensedSearchLockupsEnabled=e.client.isPhone,U.transparencyLink=sg(e,N),jn(e,U,N.pageInformation),U.searchClearAction=qg(e,qG,N.pageInformation,N.locationTracker,$.term),U.searchCancelAction=qg(e,Uj,N.pageInformation,N.locationTracker,$.term),U})
return a})}function Hg(e){return Kv.context("actionFromSearchResultsLink",()=>{var t
const n=new JY(e.url,!1)
return n.title=null===(t=e.label)||void 0===t?void 0:t.replace(" ","\xa0"),n.artwork=new bz("systemimage://arrow.up.forward",0,0,[]),n})}function qg(e,t,n,r,o){const s=new xW
let a,c
switch(t){case Uj:a=aj,c=Uj
break
case qG:a="delete",c=qG}return function(e,t,n,r,o){const s={searchTerm:o,actionType:n.actionType}
n.actionDetails&&(s[XG]=n.actionDetails),n.actionContext&&(s[MS]=n.actionContext),o&&(s[iq]=o),i(n.softwareType)&&(s[zN]=n.softwareType),n.mercuryMetricsData&&Object.assign(s,n.mercuryMetricsData)
const a=_t(e,n.id,null!=r?r:fh(0,n),s)
t.actionMetrics.addMetricsData(a)}(e,s,{targetType:TW,id:c,idType:void 0,actionType:a,pageInformation:n,locationTracker:r},TW,o),s}async function Wg(e,t){return function(e,t,n){return Kv.context("searchHintsFromApiResponse",()=>{var r,o,i,s
const a={targetType:GB,pageInformation:Hn(0,0,n.hintsRequestUrl,n.dataSetId),locationTracker:{rootPosition:0,locationStack:[]}}
let c=null;(null===(r=n.userTypedTerm)||void 0===r?void 0:r.length)&&(c=new d5(n.userTypedTerm,n.userTypedTerm,null,HR),c.spellCheckEnabled=!0,c.prefixTerm=t,Wh(e,c,a),na(e,c,a.targetType,a.locationTracker,a.pageInformation),_h(a.locationTracker))
const l=null!==(i=null===(o=n.rawHints)||void 0===o?void 0:o.map(n=>function(e,t,n,r){var o,i,s,a,c
const l=null!==(o=function(e){switch(e.entity){case yW:return e.context
case yV:return VH
case sW:return oG
default:return null}}(t))&&void 0!==o?o:void 0,u=new d5(null!==(i=t.displayTerm)&&void 0!==i?i:"",null!==(s=t.searchTerm)&&void 0!==s?s:"",null,tF,l,t.source)
return u.artwork=function(e,t){return Ot(e,`systemimage://${t}`)}(e,null!==(a=Qw(l))&&void 0!==a?a:oO),u.spellCheckEnabled=!0,u.prefixTerm=n,Wh(e,u,r),na(e,u,r.targetType,r.locationTracker,null!==(c=r.pageInformation)&&void 0!==c?c:void 0),_h(r.locationTracker),u}(e,n,t,a)))&&void 0!==i?i:[]
null!=c&&l.unshift(c)
const u=new Hee(l,null!==(s=n.ghostHintsTerm)&&void 0!==s?s:null),d=Lt(e,t,"key",KR,n.hintsRequestUrl,{...Nt(a.pageInformation)})
return u.pageMetrics.pageFields=Nt(a.pageInformation),u.pageMetrics.addData(d,[Im.PageInvocationPoint.pageEnter]),u.searchClearAction=qg(e,qG,a.pageInformation,a.locationTracker,t),u.searchCancelAction=qg(e,Uj,a.pageInformation,a.locationTracker,t),u})}(e,t,await async function(e,t){const n=function(e,t){const n=new yY(e).includingAppBinaryTraitsAttribute(!1).forType(Mx).withLimit(10).withSearchTerm(t).addingQuery(QD,qI)
e.host.clientIdentifier===pY&&n.addingQuery(HG,pq)
const r=[]
return e.appleSilicon.isSupportEnabled&&r.push(XD),ii(e)&&r.push(tq),e.bag.isNaturalLanguageSearchEnabled&&r.push(WI),r.length>0&&n.enablingFeatures(r),n}(e,t)
return await Ln(e,n).then(t=>{var r
return{hintsRequestUrl:ve(e,n).toString(),userTypedTerm:f(t,"userTyped"),rawHints:l(t,"results.suggestions"),ghostHintsTerm:f(t,"ghosting"),dataSetId:f(null===(r=t.meta)||void 0===r?void 0:r.metrics,wZ)}})}(e,t))}function zg(e,t,n,r,i){const s=function(e,t,n,r,i){if(o(i))return[]
const s=[]
for(const[a,c]of i.entries()){const i=Yg(e,c,a,t,n,r)
o(i)||(s.push(i),_h(n))}return s}(e,n,r,t.itemDisplayStyle,i),a=new ete
a.title=e.loc.string("Action.ClearSearches"),function(e,t){const n=_t(e,"Clear Searches",TW,{actionType:"confirm"})
t.actionMetrics.addMetricsData(n)}(e,a)
const c=new IZ([a])
c.title=e.loc.string("Sheet.ClearSearches.Title"),c.message=e.loc.string("Sheet.ClearSearches.Message"),c.destructiveActionIndex=0,c.isCancelable=!0
const l=new iK([c])
l.title=e.loc.string("Action.Clear")
const u=(f=t.shelfDisplayStyle).layout===Qee?cC:2===f.layoutSize?"twoColumnList":oC,d=new yJ(u)
var f
return d.id=b_,d.presentationHints={isWidthConstrained:!0},d.header={title:t.title,accessoryAction:l},d.contentType===cC&&(d.isHorizontal=!0,d.rowsPerColumn=t.shelfDisplayStyle.layoutSize),d.contentsMetadata={type:"searchFocusTwoColumnList",numberOfColumns:s.length>1?t.shelfDisplayStyle.layoutSize:1},d.items=s,d.isHidden=o(s),d.refreshUrl=function(e){return`${$W}:/${VW.searchLandingPage}/${VW.shelf}/?${tz.isOnDeviceSearchHistoryShelf}=true&${tz.token}=${function(e){return encodeURIComponent(JSON.stringify(e))}(e)}`}(t),d}function Yg(e,t,n,r,o,i){const s=t.term,a=t.entity,c=Xg(e,function(e,t,n){if((0,Zv.isNothing)(n))return t
let r
return n===VH?r="Search.ResultsTitle.InDevelopers":n===oG?r="Search.ResultsTitle.InStories":n===gW?r="Search.ResultsTitle.InWatch":n===pW&&(r="Search.ResultsTitle.InArcade"),(0,Zv.isNothing)(r)?t:e.loc.string(r).replace("@@search_term@@",t)}(e,s,a),s,a,o,GR,void 0,r,i)
return(0,Zv.isNothing)(c)?null:(c.id=t.id,Nh(e,c,{targetType:jq,pageInformation:r,locationTracker:o,kind:jq,softwareType:null,title:t.term,hintsEntity:t.entity,id:`${n}`,idType:Oq}),c)}function Jg(e,t,n){var r
const i=t.data
if(o(i))return
let s=0
const a=e.bag.mediaAPISearchFocusEnabled&&(0,Zv.isSome)(n.pageType)
for(const c of i){if(o(c))continue
if(a){const e=p(c,PV),t=Kg(null==e?void 0:e.category)
if((0,Zv.isSome)(t)&&t!==n.pageType)continue}const i=nv(e,n,s,t.meta||null);(0,Zv.isSome)(i)&&(n.shelves.push(i),_h(n.metricsLocationTracker))
const l=j(c,"contentKind"),u=qw(0,c,l),d=rv(0,c,u,n,l)
Ch(0,d.metricsOptions,null!==(r=u.title)&&void 0!==r?r:"")
const f=Zg(e,c,n,d,u,l)
Oh(n.metricsLocationTracker),o(f)||(Nh(e,f,d.metricsOptions),un(e,[f],kV,d.metricsOptions.id,n.metricsPageInformation),n.shelves.push(f),s+=1,_h(n.metricsLocationTracker))}}function Kg(e){switch(e){case oN:return Zm.Landing
case"search-focus":return Zm.Focus
default:return}}function Zg(e,t,n,c,l,u){switch(u){case Qm.Suggestion:return n.pageType===Zm.Focus?function(e,t,n,r,i){var s,a,c
const l=we(t,mW)
if((0,Zv.isNothing)(l))return null
const u=[],d=new yJ(oC)
d.isHorizontal=!1,d.title=r.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,i]of l.entries()){const l=j(i,iq)
if((0,Zv.isNothing)(l)||0===l.length)continue
const d=null!==(s=j(i,y_))&&void 0!==s?s:l,f=Xg(e,null!=d?d:"",null!=l?l:"",void 0,n.metricsLocationTracker,jB,void 0,n.metricsPageInformation,null!==(a=r.searchLandingItemDisplayStyle)&&void 0!==a?a:void 0);(0,Zv.isNothing)(f)||o(f)||(Nh(e,f,{targetType:jq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,kind:jq,softwareType:null,title:null!==(c=f.title)&&void 0!==c?c:"",id:`${t}`,idType:Oq}),u.push(f),_h(n.metricsLocationTracker))}return o(u)?null:(d.items=u,d)}(e,t,n,l):function(e,t,n,i,s){var c
const l=we(t,mW),u=[],d=new yJ(cq)
d.isHorizontal=!1,d.title=i.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,o]of l.entries()){const s={targetType:jq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},a=Qg(e,o,n,i)
r(a)||r(a.action)||(Nh(e,a.action,{...s,kind:jq,softwareType:null,title:a.action.title,id:`${t}`,idType:Oq}),u.push(a),_h(n.metricsLocationTracker))}return o(u)?null:(d.items=u,a(null===(c=i.displayStyle)||void 0===c?void 0:c.layoutSize)?d.contentsMetadata={type:Y$,numberOfColumns:i.displayStyle.layoutSize}:(e.client.isPhone||e.client.isPad)&&(d.contentsMetadata={type:Y$,numberOfColumns:u.length>=6?2:1}),d)}(e,t,n,l)
case Qm.CategoriesAndCharts:return Yw(e,t,!1,l,0,c)
case Qm.Apps:return function(e,t,n,o,a){var c,l,u,d,f
const h=rm.All,p=[]
let w=!1,g=function(e){const t=fe(e,mW)
return null==t?void 0:t.data}(t)
const v=new yJ(a.shelfStyle)
if(v.isHorizontal=!1,v.title=o.title,v.shouldFilterApps=!1,v.filteringExcludedItems=a.filteringExcludedItems,s(g)){const t=function(e,t,n){var o,s,a,c,l,u,d,f,h,p
const w=Ka(t.adStitcher,n.adPositionInfo)
if(r(w))return null
const g=w.data
try{const r=tv(e,g,t,n)
return i(r)?n.filteringExcludedItems=[g.id]:null===(o=t.metricsPageInformation.adPageInfo)||void 0===o||o.recordLockupFromDataFailed(e,null!==(a=null===(s=n.adPositionInfo)||void 0===s?void 0:s.shelfIdentifier)&&void 0!==a?a:EF,null!==(l=null===(c=n.adPositionInfo)||void 0===c?void 0:c.slot)&&void 0!==l?l:0),r}catch(r){return Zt(e,`Failed to create SLP ad lockup: ${r}`),null===(u=t.metricsPageInformation.adPageInfo)||void 0===u||u.recordLockupFromDataFailed(e,null!==(f=null===(d=n.adPositionInfo)||void 0===d?void 0:d.shelfIdentifier)&&void 0!==f?f:EF,null!==(p=null===(h=n.adPositionInfo)||void 0===h?void 0:h.slot)&&void 0!==p?p:0),null}}(e,n,a)
t&&ft(t)&&(w=!0,p.push(t),_h(n.metricsLocationTracker),g=g.filter(e=>e.id!==t.adamId))}const m=(0,Zv.isSome)(o.displayCount)
s(g)&&(g=wn(g,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(u=null===(l=a.metricsOptions)||void 0===l?void 0:l.recoMetricsData)&&void 0!==u?u:{}))
for(const t of g){if(t.type===hW)return null
if(r(t.attributes))continue
if(at(e,t,h))continue
const o=tv(e,t,n,a)
o&&(p.push(o),_h(n.metricsLocationTracker))}if(m){const e=o.displayCount
v.items=p.slice(0,e)}else v.items=p
if(m){const r=new yJ(a.shelfStyle)
r.items=w?p.splice(1,p.length-1):p
const i=new bJ([r])
i.title=v.title
const s=new FY(SW)
s.pageUrl=o.seeAllLink,s.title=e.loc.string(gH),s.pageData=i,v.seeAllAction=s,ea(e,s,s.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),jn(e,i,Vn(0,t.id))}return(null===(d=o.displayStyle)||void 0===d?void 0:d.layout)===Xee&&(v.isHorizontal=!0,v.rowsPerColumn=null===(f=o.displayStyle)||void 0===f?void 0:f.layoutSize),v}(e,t,n,l,c)
case Qm.EditorialCollection:return null
default:return function(e,t,n,r,o){return"search-recommendations-marker"!==t.type?null:j(t,K$)===JI?function(e,t,n){return zg(e,new tte(n.title,n.displayCount,n.displayStyle,n.searchLandingItemDisplayStyle),t.metricsPageInformation,t.metricsLocationTracker,t.searchHistory)}(e,n,o):null}(e,t,n,0,l)}}function Qg(e,t,n,r){var o,i
const s=j(t,iq)
if((0,Zv.isNothing)(s)||0===s.length)return null
const a=null!==(o=j(t,y_))&&void 0!==o?o:s,c=new d5(a,s,null,jB,void 0,void 0)
return c.artwork=ev(null!==(i=r.searchLandingItemDisplayStyle)&&void 0!==i?i:void 0,e),na(e,c,TW,n.metricsLocationTracker),(0,Zv.isSome)(c)?new u5(c):null}function Xg(e,t,n,r,i,s,a,c,l){if(o(n))return null
const u=new d5(t,n,null,s,null!=r?r:void 0,a,[])
return u.artwork=ev(l,e),na(e,u,TW,i,c),u}function ev(e,t){var n
return(null==e?void 0:e.iconKind)===ty.Symbol&&(null===(n=null==e?void 0:e.iconKind)||void 0===n?void 0:n.length)?Ot(t,`systemimage://${e.iconSymbol}`):t.client.isPhone?Ot(t,q$):void 0}function tv(e,t,n,s){if(o(t))return null
if(s.shelfStyle!==Lq)return null
let a=null
!i(s.shelfBackground)||s.shelfBackground.type!==DV&&s.shelfBackground.type!==fM||(a=mq)
const c=Od(e,t,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},artworkUseCase:Qd(0,s.shelfStyle),offerStyle:a,canDisplayArcadeOfferButton:rh(0,s.shelfStyle),isContainedInPreorderExclusiveShelf:!1,shouldHideArcadeHeader:!1})
return r(c)||!c.isValid()?null:c}function nv(e,t,n,o){var i,s,a
const c=Ka(t.adStitcher,{shelfIdentifier:x2,slot:n})
if(r(c))return null
const l=c.data
try{switch(null===(i=null==o?void 0:o.adDisplayStyle)||void 0===i?void 0:i.format){case qV:return function(e,t,n){var r,o
const i=new yJ(g_)
i.isHorizontal=!1
const s=Jq,a=mq,c=Vh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:FV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=v_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Qd(0,g_),canDisplayArcadeOfferButton:rh(0,g_)},u={canPlayFullScreen:!1,playbackControls:{}}
let d=xd(e,t,l,u,null,!1)
const h=d.screenshots[0],p=Ht(h)
n.metricsPageInformation.adPageInfo.setTemplateType(e,p)
const w=rf(e,t,{useCase:O6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:$$})
d=xd(e,t,l,u,null,!1),null===(r=d.searchAdOpportunity)||void 0===r||r.setTemplateType(p)
const g=w.backgroundColor,v=w.textColor,m=new o1(d,[h],!0,v,g,null!==(o=e.bag.todayAdMediumLockupScreenshotsRiverSpeed)&&void 0!==o?o:8)
return Gh(e,m,c,c.pageInformation.adPageInfo),m.clickAction=Bd(e,t,c,null),i.items=[m],i}(e,l,t)
case"condensed":return function(e,t,n){var r,o
const i=new yJ(m_)
i.isHorizontal=!1
const s=Jq,a=mq,c=Vh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:FV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=v_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Qd(0,m_),canDisplayArcadeOfferButton:rh(0,m_)}
null===(r=n.metricsPageInformation.adPageInfo)||void 0===r||r.setTemplateType(e,lG)
const u=xd(e,t,l,{canPlayFullScreen:!1,playbackControls:{}},null,!1)
null===(o=u.searchAdOpportunity)||void 0===o||o.setTemplateType(lG)
const d=new n1(u,u.icon)
return Gh(e,d,c,c.pageInformation.adPageInfo),i.items=[d],i}(e,l,t)
default:return null===(s=t.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,x2,n),null}}catch(r){return Zt(e,`Failed to create SLP ad shelf: ${r}`),null===(a=t.metricsPageInformation.adPageInfo)||void 0===a||a.recordLockupFromDataFailed(e,x2,n),null}}function rv(e,t,n,r,o=null){const i=Ww(0,t,n,r)
return o===Qm.Apps?{...i,shelfStyle:Lq,adPositionInfo:M2}:i}function ov(e,t){const n=new yY(e).forType(t_).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e)).includingScopedRelationships("search-recommendations",[mW]).addingQuery(AW,oN)
ji(e,xx)&&Ti(n),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([Fq])
const r=lc(e,e.user.dsid)
return(null==r?void 0:r.length)>0&&n.addingQuery(e_,r),n.addingQuery(PV,"adDisplayStyle"),n}function iv(e,t,n,r){var i
if(o(t.data))return null
const s=Un(e,DG,DG,t),a=Ps(e)
s.recoMetricsData=Sh(s.recoMetricsData,null,a),s.adPageInfo=dn(e,kV,n),null===(i=s.adPageInfo)||void 0===i||i.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,EF,0)
const c={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:s,adStitcher:Za(e,n,t),pageType:Zm.Landing,recoImpressionData:gn(0,r)}
Jg(e,t,c)
const l=sv(e)
l&&c.shelves.unshift(l)
const u=new Kee(c.shelves)
return u.pageRefreshPolicy=new WZ(YI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null),jn(e,u,c.metricsPageInformation),u}function sv(e){var t
if(!e.bag.isNaturalLanguageSearchEnabled&&!e.bag.isNaturalLanguageSearchResultsEnabled)return
const n=wl(0,"searchFocusHeader",{signal:{lastNLSQueryDate:e.storage.retrieveString(n_),treatmentId:null!==(t=Ne(e,nm.SearchLandingPage))&&void 0!==t?t:null}},"pullOnly")
return n.refreshUrl=`${$W}:/${VW.searchLandingPage}/${VW.shelf}/?${tz.isSearchFocusHeaderShelf}=true`,n}function av(e,t,n){Jg(e,t,n)
const r=new Zee(n.shelves)
return o(r.shelves)?null:(jn(e,r,n.metricsPageInformation),r)}async function cv(e,t){const n=new $m.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await Np(r,t)
return null===o?jg(e,t.facets):await async function(e,t){return await Vg(e,t)}(r,o)}async function lv(e,t){return await async function(e,t){return await Kv.context("paginatedSearchResultsPageWithToken",async()=>{const n=Fg(0,t),r=Ng(0,t)
if(0===n.length)return await Promise.resolve(jg(e))
const o=t.metricsOptions.pageInformation
if((0,Jv.isSome)(o)&&(0,Jv.isSome)(null==o?void 0:o.adPageInfo)){const n=y(o.adPageInfo);(0,Jv.isSome)(n)&&(o.adPageInfo=s1.from(e,n),t.metricsOptions.pageInformation=o)}return await Bp(e,n).then(async n=>{const o=At(n),s={id:rN,kind:null,softwareType:null,targetType:sV,title:nU,pageInformation:t.metricsOptions.pageInformation,locationTracker:t.metricsOptions.locationTracker,idType:VU},a=new yJ($x)
return a.id=Bg(),a.isHorizontal=!1,Nh(e,a,s),Ch(0,s,nU),Dh(s.locationTracker,t.contentOffsetWithinResultsShelf),await Mg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(n=>{const o=sg(e,s),c=function(e,t,n,r,o=0){let i=function(e){const t=e.bag.searchResultsLearnMoreEditorialId
!(0,Jv.isNothing)(t)&&(null==t||t.length)}(e)
const s=n.builtSearchResults.length,a=n.deferredSearchResults.length>0,c=o+s
if(void 0===i||void 0===t||o>=i||a&&c<i||0===c&&!a)return r.items=n.builtSearchResults,[r]
i-=o,r.items=n.builtSearchResults.slice(0,i)
const l=new yJ("searchResultsLearnMoreNotice")
l.isHorizontal=!1
const u=new zee(t)
l.items=[u]
const d=[r,l],f=n.builtSearchResults.slice(i)
if(f.length>0){const e=new yJ($x)
e.impressionMetrics=r.impressionMetrics,e.isHorizontal=!1,e.items=f,d.push(e)}return d}(e,o,n,a,t.contentOffsetWithinResultsShelf),l=new qee(c)
return i(r)&&(r.contentOffsetWithinResultsShelf=Eh(s.locationTracker),l.nextPage=r),l.isCondensedSearchLockupsEnabled=e.client.isPhone,l.resultsParentImpressionMetrics=a.impressionMetrics,Oh(t.metricsOptions.locationTracker),l.searchClearAction=qg(e,qG,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l.searchCancelAction=qg(e,Uj,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l})})})}(e,t)}function uv(e){return ee(e)}function dv(e){const t=[Hq,$q,RB,LH,L_,M_,x_,pj,wH,N$]
return e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}function fv(e,t,n){var r,o
t.includingAgeRestrictions().includingAdditionalPlatforms(uv(e)).includingAttributes(dv(e)).includingScopedAttributes(Nj,[pj]).includingScopedRelationships(sW,[RH,Bx]).includingScopedRelationships(Nj,[Bx]).enablingFeature("editorialItemGroups").usingCustomAttributes(Ue(e)).includingRelationshipsForUpsell(!0),n&&(t.includingAssociateKeys(Nj,[mH,dV]),t.includingAssociateKeys(sW,[dV])),ii(e)&&(t.enablingFeature(tq),t.addingQuery(PV,H$),t.includingScopedRelationships(hW,[rW]),t.includingScopedAttributes(hW,nZ)),ai(e)&&(t.enablingFeature(BB),n&&t.includingKindsKeys(ZV,[y$])),vn(e)&&t.enablingFeature("eiGroupEISelectionOnDevice"),Kt(e,tW)&&t.enablingFeature("adSupport"),t.enablingFeature("heroStyles")
const i=null!==(o=null===(r=e.userDefaults)||void 0===r?void 0:r.bool(Gb))&&void 0!==o&&o
e.bag.enableDeviceDrivenDiscoveryContent&&i&&t.resourceType===tW&&t.addingQuery("pairedDevices","visionPro")}async function hv(e,t){const n=e.required(O3),i=t.url===qA,a=-1!==t.url.indexOf(VW.todayCardPreview)
if(i)return await n.fetchPage(e,t.url,ute)
if(a){const r=wz.from(t.url)
return r.param(tz.fetchData,bq),await n.fetchPage(e,r.build(),ute)}{const n=function(e){return su(e,new yY(e).forType(tW).withSparseCount(1).withSparseLimit(2))}(e)
fv(e,n,!0)
const i=(0,Jv.isSome)(t.experimentIdHeader)?{"X-Apple-User-Experiment-Ids":t.experimentIdHeader}:void 0
return await async function(e,t,n,i){var a
const c=new ny.FetchTimingMetricsBuilder,u=e.addingFetchTimingMetricsBuilder(c),d=Ln(u,t,{headers:null!=n?n:void 0})
d.then(t=>{Kt(e,tW)&&function(e,t){const n=Xt(e,t,!0)
r(n)||(e.ads.setTimeoutForCurrentOnDeviceAdFetch(t,n),function(e,t,n){e.timeoutManager.setTimeout(t,n)}(e,n,Q7))}(e,tW),cc(e,e.user.dsid,t)})
const h=_(d),p=function(e,t){const n={}
if(s(t)){const r=new yY(e).withIdsOfType(t,sW).includingAdditionalPlatforms(uv(e)).includingAttributes(dv(e))
n[ry.OnboardingCards]=D(Ln(e,r,{}))}Kt(e,tW)&&(n[ry.Ads]=D(Uw(e,tW))),function(e){const t=bs(e),n=ar(e,e.bag.todayTabArcadePersonalizationRate)
return t&&n}(e)&&(n[ry.ODP]=D(async function(e,t){return await async function(e,t,n,r){const o=[t,e.timeoutManager.makePromise(r,void 0)]
return await Promise.race(o).then(e=>e)}(e,async function(e){try{const t=await async function(e,t){if(o(t.user.dsid)){const e=`${X7}: User is currently not signed in.`
throw Kv.unexpectedType(BH,e,null),new Error(e)}try{const n=l((await t.onDeviceRecommendationsManager.performRequest({type:"fetchUseCases",tab:e,dsId:t.user.dsid})).useCases)
if(o(n)){const t=`${X7}: ODP returned no use cases for tab: ${e}`
throw Kv.unexpectedType(BH,t,null),new Error(t)}return n}catch(t){const n=`${X7}: Failed to fetch ODP use cases for tab: ${e}, with error: ${t}`
throw Kv.unexpectedType(BH,n,null),new Error(n)}}(tW,e),n=t.map(async t=>await async function(e,t){try{const n=await async function(e,t){if(o(t.user.dsid))throw new Error(`${X7}: User is currently not signed in.`)
try{return await t.onDeviceRecommendationsManager.performRequest({type:wP,dsId:t.user.dsid,useCase:e})}catch(t){const n=`${X7}: Failed to perform ODP Today recommendation for useCase: ${e}, with error: ${t}`
throw Kv.unexpectedType(BH,n,null),new Error(n)}}(t,e),i=await async function(e,t){const n=l(t[gP])
if(o(n)){const t=`${X7}: ODP returned no candidates for useCase: ${e}`
throw Kv.unexpectedType(BH,t,null),new Error(t)}const i=y(t[_j]),a=n.map(e=>function(e){const t=f(e.id),n=f(e.type)
if(r(t))return
let o,i=[]
switch(n){case dD:i=l(e.candidates).map(e=>f(e.id)).filter(e=>(0,Jv.isSome)(e)),o=Nj
break
case Ij:o=sW
break
default:return}let a=[]
if(a.push({id:t,type:o}),s(i)){const e=i.map(e=>({id:e,type:sW}))
a=a.concat(e)}return new nee(t,o,i,a)}(e)).filter(Jv.isSome)
if(r(i)||o(a)){const t=`${X7}: ODP candidates could not be parsed for useCase: ${e}`
throw Kv.unexpectedType(BH,t,null),new Error(t)}return{candidates:a,metrics:i}}(t,n),a=i.metrics,c=i.candidates
if(0===c.length)return
const u=c[0],d=await async function(e,t,n,r){const o=new yY(r,t.data,!0).addingQuery(tz.onDevicePersonalizationUseCase,e).addingQuery(tz.filterRecommendable,bq)
es(r,o)
try{const i=await Ln(r,o)
return new tee(e,[t],n,i)}catch(e){const n=`${X7}: Failed to fetch Media API data for: ${t.data}, with error: ${e}`
throw Kv.unexpectedType(BH,n,null),new Error(n)}}(t,u,a,e)
return d}catch(n){return void e.console.log(`${X7}: Failed to perform ODP Today recommendation for useCase: ${t}, with error: ${n}`)}}(e,t)),i=(await L(n)).map(e=>e.success?e.value:void 0).filter(Jv.isSome)
return new eee(i)}catch(t){return void e.console.log(`${X7}: Failed to perform ODP for Today recommendations: ${t}`)}}(e),0,Q7)}(e)))
const i=e.amsEngagement
if(i&&vn(e)){const e={timeout:1e3,eventType:VK,tab:tW}
n[ry.AMDData]=D(i.performRequest(e))}return n}(e,null!==(a=null==i?void 0:i.onboardingCardIds)&&void 0!==a?a:[]),w=await sc(e,h,p)
return c.measureModelConstruction(()=>{var t,n
const r=At(w.additionalData[ry.OnboardingCards]),i=w.additionalData[ry.Ads],s=w.additionalData[ry.ODP],a=w.additionalData[ry.AMDData],c=function(e,t,n,r,i){const s=[]
let a=o(r)
const c=ks(e,t)
let u=0
for(const i of t){if(o(i.contents))continue
const t=Ts(e,tW,i.contents,!0,c)
i.contents=t.personalizedData,i.onDevicePersonalizationProcessingType=t.processingType
let d=!0
const h={label:i.label,title:i.title,meta:i.meta,date:i.date,onDevicePersonalizationProcessingType:i.onDevicePersonalizationProcessingType,isTodayForAppsModule:Tt(i)}
if(!a){for(const e of r)s.push({type:xm.EditorialItem,data:e,isDataHydrated:W(e),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]})
d=!1,a=!0,u+=1}for(let t of i.contents){const r=f(t,"meta.personalizationData.onDeviceUseCase")
switch(t.type){case sW:if((0,Jv.isSome)(r)){const e=null==n?void 0:n.storyData(r);(0,Jv.isSome)(e)&&(t=e)}s.push({type:xm.EditorialItem,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]}),d=!1,u+=1
break
case Nj:const a=l(t,$_)
if(o(a))continue
let f
if((0,Jv.isSome)(r)&&(f=null==n?void 0:n.storyGroupData(r)),(0,Jv.isSome)(f))t=f
else{const n=Ts(e,tW,a,!0,c)
t[PV].associations[mH][zj]=n.personalizedData,i.onDevicePersonalizationProcessingType=n.processingType}s.push({type:xm.EditorialItemGroup,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:Array.from({length:a.length},(e,t)=>t+u)}),d=!1,u+=a.length}}}return s}(e,null!==(n=null===(t=w.primaryPageData.results)||void 0===t?void 0:t.data)&&void 0!==n?n:[],s,r)
return pv(u,c,w.primaryPageData,i,a)})}(e,n,i,t)}}function pv(e,t,n,r,i){return Kv.context(Bj,()=>{if(o(t))return null
const a=function(e,t,n,r,o){var i,a,c,u
const d=Un(e,DS,tW,n,null,null!==(i=dn(e,tW,r,t))&&void 0!==i?i:Js(e,tW,n,null===(a=null==r?void 0:r.onDeviceAd)||void 0===a?void 0:a.positionInfo,t)),f=Ps(e)
d.recoMetricsData=Sh(d.recoMetricsData,null,f)
const h=new YZ(t,d,{rootPosition:0,locationStack:[]},Br(n),gn(0,o))
if(Kt(e,tW)){const n=an(e,tW,!0);(0,Jv.isSome)(n)&&(h.eligibleAdLocations=n.map(e=>e.slot))
for(const t of null!=n?n:[])null===(c=d.adPageInfo)||void 0===c||c.recordAdResponseEventsIfNeeded(e,null==r?void 0:r.failureReason,t.shelfIdentifier,t.slot)
if(h.adPlacementBehavior=function(e){let t=um.insertIntoShelf
for(const n of e){let e=t
switch(n.type){case xm.EditorialItem:e=mv(n.data)
break
case xm.EditorialItemGroup:const t=l(n.data,$_)
if(s(t))for(const n of t)if(e=mv(n),e!==um.insertIntoShelf)break}if(e!==um.insertIntoShelf){t=e
break}}return t}(t),(0,Jv.isNothing)(null==r?void 0:r.failureReason)){h.adData=yt(e,null==r?void 0:r.mediaResponse)
const t=null===(u=null==r?void 0:r.onDeviceAd)||void 0===u?void 0:u.positionInfo
if(s(t)){const e=t.slot-1
h.adLocation=e}}}return h}(e,t,n,r,i),c=wv(e,a)
return c.shelves.splice(0,0,wl(0,"todayPageHeader")),c})}function wv(e,t){var n
const r=[],o=function(e,t){switch(e.client.buildType){case YG:case cG:const e=new wz
e.protocol=FW,e.host=ZU,e.pathname=`/${VW.todayCardPreview}`
const n=[]
for(const e of t)switch(e.type){case xm.EditorialItem:n.push(e.data.id)
break
case xm.EditorialItemGroup:const t=l(e.data.meta,F_)
n.push(`${e.data.id}:[${t.map(e=>e.id).join(",")}]`)}return e.param(tz.ids,n.join(",")),e.param(tz.isTodayFeedPreview,bq),decodeURIComponent(e.build())
default:return null}}(e,t.remainingContent)
let a=Cs(t.remainingContent)
const c=null===(n=t.remainingContent[0])||void 0===n?void 0:n.isFirstItemInModule
for(;a;){const n=t.remainingContent.shift()
if((0,Jv.isNothing)(n)){a=!1
break}const o=Ns(e,t);(0,Jv.isSome)(o)&&r.push(o),t.currentTodayItem=n
let i=null
switch(n.type){case xm.EditorialItem:i=Ms(e,n,t)
break
case xm.EditorialItemGroup:i=xs(e,n,t)}t.currentTodayItem=void 0,(0,Jv.isSome)(i)&&r.push(i)
const s=Ns(e,t);(0,Jv.isSome)(s)&&r.push(s),a=Cs(t.remainingContent)}c&&un(e,r,tW,tW,t.pageInformation)
const u=new ute(r),d=e.bag.tabsStandard.find(e=>e.id===tW),h=f(d,Wq),p=f(d,"image-identifier"),w=(0,Jv.isNothing)(p)||"doc.text.image"===p,g=null!=h?h:e.loc.string("PAGE_TITLE_TODAY")
return u.title=g,u.tabTitle=g,u.titleDetail=w?function(e){const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat")
return e.loc.formatDate(n,t)}(e):void 0,u.shortTitleDetail=w?function(e){const t=new Date
return e.loc.formatDate("MMM d",t)}(e):void 0,u.longTitle=w?function(e){if(!e.client.isPad)return
const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat.IPad")
return e.loc.formatDate(n,t)}(e):void 0,u.feedPreviewUrl=o,s(t.remainingContent)?(t.pageHasDisplayedContent=t.pageHasDisplayedContent||r.some(e=>{s(e.items)}),u.nextPage=t):function(e,t,n){const r=[],o=hl(e)
i(o)&&r.push(o)
const s=e.bag.termsAndConditionsURL
if(i(s)){const t=pl(e,s)
r.push(t)}return r}(e,t.pageInformation,t.locationTracker).forEach(e=>{u.shelves.push(e)}),jn(e,u,t.pageInformation),u}async function gv(e,t){const n=t.pageHasDisplayedContent?6:12
let r=!0,o=0,i=[]
for(;r;){const e=t.remainingContent[o]
switch(e.type){case xm.EditorialItem:i.push(e.data)
break
case xm.EditorialItemGroup:i.push(e.data)
const t=l(e.data,$_)
i=[...i,...t]}o++,r=i.length<n&&o<t.remainingContent.length}const s=new Set(i.map(e=>e.id)),a=new yY(e,i,!0,[mH,dV])
fv(e,a,!1)
const c=await Ln(e,a,{allowEmptyDataResponse:!0}),u={}
for(const e of c.data)u[e.id]=e
for(const e of t.remainingContent)vv(e,u)
return t.remainingContent=t.remainingContent.filter(e=>e.isDataHydrated||!s.has(e.data.id)),t}function vv(e,t){var n,r,o
switch(e.type){case xm.EditorialItem:s(t[e.data.id])&&(e.data={...e.data,...t[e.data.id]}),e.isDataHydrated=W(e.data)
break
case xm.EditorialItemGroup:s(t[e.data.id])&&(e.data={...e.data,attributes:null===(n=t[e.data.id])||void 0===n?void 0:n.attributes,relationships:null===(r=t[e.data.id])||void 0===r?void 0:r.relationships,meta:{...e.data.meta,...null===(o=t[e.data.id])||void 0===o?void 0:o.meta}}),e.isDataHydrated=W(e.data)}}function mv(e){const t=v(e,bC)
return i(t)&&t?um.replaceOrganic:i(t)&&!t?um.dropAd:um.insertIntoShelf}function yv(e,t){if(i(t.adPageInfo)){const n=y(t.adPageInfo)
s(n)&&(t.adPageInfo=s1.from(e,n))}}function Av(e,t,n,r,o){return Kv.context(sT,()=>Od(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:O6.LockupIconSmall}))}function Tv(e,t,n,o,i,s){return Kv.context("topChartsPageFromApiResponse",()=>{var a
const c=function(e){return l(e,"results.apps").filter(e=>!r(e.data))}(t),u=c.map(r=>function(e,t,n,r,o){return Kv.context("segmentFromData",()=>{const{shortName:i,longName:s}=function(e,t,n){const r=f(t,gq)
let o=f(t,"shortName"),i=f(t,AW)
if(n!==WK)return{shortName:(0,Zv.unsafeUnwrapOptional)(o),longName:(0,Zv.unsafeUnwrapOptional)(i)}
const s=e.client.isPad
switch(r){case Y2:s?(o=e.loc.string("TopCharts.iPadGames.Free.ShortName"),i=e.loc.string("TopCharts.iPadGames.Free.LongName")):(o=e.loc.string("TopCharts.Games.Free.ShortName"),i=e.loc.string("TopCharts.Games.Free.LongName"))
break
case z2:s?(o=e.loc.string("TopCharts.iPadGames.Paid.ShortName"),i=e.loc.string("TopCharts.iPadGames.Paid.LongName")):(o=e.loc.string("TopCharts.Games.Paid.ShortName"),i=e.loc.string("TopCharts.Games.Paid.LongName"))}return{shortName:(0,Zv.unsafeUnwrapOptional)(o),longName:(0,Zv.unsafeUnwrapOptional)(i)}}(e,t,o),a=f(t,gq),c=Un(e,$y,r,n,`${a} ${s}`),l={rootPosition:0,locationStack:[]},u=[]
let d=0
const h=[]
for(const n of t.data){const t=Av(e,d,n,c,l)
if(t){if(at(e,n,rm.Charts))continue
u.push(t),_h(l),d++}else h.push(n)}const p=[],w=new yJ(Lq)
w.items=u,e.featureFlags.isEnabled(_J),w.title=s,p.push(w)
const g=new wte(i,s,a,p),v=function(e,t,n,r=null,o,i){return{remainingContent:t,maxPerPage:20,highestOrdinal:0,url:n,metricsPageInformation:o,metricsLocationTracker:i}}(0,h,void 0,t.next,c,l)
return v.metricsPageInformation=c,v.metricsLocationTracker=l,v.highestOrdinal=d,g.nextPage=v,jn(e,g,c),g})}(e,r,t,n,s)).sort((e,t)=>e.chart.localeCompare(t.chart)),d=f(c,"0.chart"),h=[]
if((0,Zv.isSome)(o))for(const t of o.categories)if((0,Zv.isSome)(t.genreId)){const n=1===c.length&&(0,Zv.isSome)(d)&&vc(d)?d:void 0
h.push(bv(e,t,n))}const p=f(c,"0.href"),w=new wz(p),g=null!==(a=w.query[_H])&&void 0!==a?a:n,v=Sv(g,w.query[dB],h),m=function(e,t){return t.every(e=>function(e){switch(e){case Z2:case Q2:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_TRENDING_CHARTS"):t.every(e=>function(e){switch(e){case X2:case e4:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_EMERGING_CHARTS"):t.every(e=>vc(e.chart))?e.loc.string("TopCharts.Selling"):e.loc.string("TopCharts.Downloaded")}(e,u),y=new gte(g,null==v?void 0:v.ageBandId,m,u,null==v?void 0:v.name,h),A=u.findIndex(e=>e.chart===i)
A>=0&&(y.initialSegmentIndex=A)
const T=e.fetchTimingMetricsBuilder
return(0,Zv.isSome)(T)&&T.decorate(y),y})}function bv(e,t,n){const r=function(e,t,n=null,r=null){let o=new yY(e).forType(dN).addingQuery(fN,yW).addingQuery(_H,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)
return n&&(o=o.addingQuery(dB,n)),(0,Zv.isSome)(r)&&(o=o.addingQuery(gq,r)),e.appleSilicon.isSupportEnabled&&(o=o.includingAdditionalPlatforms([Uq,Bq])),o}(e,t.genreId,t.ageBandId,n),o=t.children.map(t=>bv(e,t,n))
return new vte(t,ve(e,r).toString(),o)}function Sv(e,t,n){for(const r of n){if(t&&r.ageBandId===t||!t&&!r.ageBandId&&r.genreId===e)return r
const n=Sv(e,t,r.children)
if(n)return n}return null}async function Pv(e,t){const n=Cv().map(e=>new vz(e)),i=new wz(t),s=n.find(e=>e.matches(i)).extractParameters(i),a=i.query[tz.genre]||s[tz.genre],c=i.query[tz.chart]||s[tz.chart],l=i.query[tz.charts],u=i.query[tz.ages]
return await async function(e,t,n,i,s){if(o(n)){const e=pc(0,i)
n=void 0!==e?`${i},${e}`:i}else n.includes(i)||(n+=`,${i}`)
const a=new $m.FetchTimingMetricsBuilder,c=e.addingFetchTimingMetricsBuilder(a),l=wc(c,t,n,s)
let u
return u=gc(e,n,t),await Promise.all([l,u]).then(([n,o])=>a.measureModelConstruction(()=>{const s=Tn(e,o),a=r(s)?mn(t):yn(s)
return Tv(c,n,t,s,i,a)}))}(e,a,l,c,u)}async function Iv(e,t){const n=Pt(0,t)
if(0===n.length)return await Promise.resolve(new wte(null,null,null,[]))
let r=new yY(e,n).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([Uq,Bq])),e.bag.enableUpdatedAgeRatings&&r.includingAttributes([Fq]),await Ln(e,r).then(n=>{const r=It(0,t)
return kv(e,n,t,r)})}function Cv(e){return[{path:`/{apiVersion}/catalog/{countryCode}/${VW.charts}`,query:[`${tz.genre}`,`${tz.isPPT}?`,`${tz.charts}?`]},{path:`/{countryCode}/${VW.charts}/{platform}/{chartType}/{genre}`,query:[`${tz.chart}`]},{path:`/{countryCode}/${VW.charts}/{platform}/{chart}/{genre}`,query:[`${tz.charts}?`]},{path:`/{countryCode}/${VW.charts}/{platform}`},{path:`/{countryCode}/{platform}/${VW.charts}`},{path:`/{countryCode}/{platform}/${VW.charts}/{genre}`}]}function kv(e,t,n,r){return Kv.context("topChartSegmentFromLookupResponse",()=>{const o=[]
let i=n.highestOrdinal
const s=At(t)
for(const t of s)at(e,t,rm.Charts)||(o.push(Ov(e,i,t,n.metricsPageInformation,n.metricsLocationTracker)),_h(n.metricsLocationTracker),i++)
const a=[]
if(o.length>0){const e=new yJ(Lq)
e.items=o,a.push(e),r.highestOrdinal=i}const c=new wte(null,null,null,a)
return c.nextPage=r,c})}function Ov(e,t,n,r,o){return Kv.context(sT,()=>Od(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:O6.LockupIconSmall}))}function Ev(e,t){const n=ks(e,[t])
if(i(t.contents)){const r=Ts(e,"todayWidget",t.contents,!0,n)
t.contents=r.personalizedData}return t}function Rv(e,t,n,r,s,a){const c=[]
let l=0,u=0,d=0
for(const a of t.contents){if(z(a)){l++
continue}const t=we(a,$H),f=$v(e,a,n,r),h=null===f?Lv(e,t):[],p=xv(a),w=[null==f?void 0:f.backgroundColor,1===h.length&&null!==h[0]?h[0].backgroundColor:void 0,ye("1C68E2")].find(e=>void 0!==e)
if(0===h.length&&null===f){u++
continue}const g=Dv(e,a,r)
let v=null,m=null,y=null
if(t.length>0&&t[0].type===hW){const e=j(t[0],l$)
if(o(e)){d++
continue}y=j(t[0],d$),v=new Date(e)
const n=j(t[0],u$)
m=i(n)?new Date(n):null}const A=ko(a)
c.push(new Ste(a.id,g,p,w,be(w),h,_v(e,a,n,g,s),A===dL,f,y,v,m))}return null!==a&&t.contents.length===l+u+d&&a(`All ${t.contents.length} cards in this ${r?"primary":"secondary"} module were filtered due to being unhydrated (${l}), missing artwork (${u}) or missing metadata (${d})`),c}function Dv(e,t,n){let r=j(t,nq)
if(!n){const n=ko(t)
switch(n){case Cm.AppOfTheDay:case Cm.GameOfTheDay:r=mo(e,t,n,null)}}return r.replace(/\n/g," ")}function _v(e,t,n,r,i){let a
switch(n){case tB:a=0
break
case EC:a=1
break
case B_:a=2
break
default:a=-1}const c={widgetId:i,size:a,targetId:t.id,name:r},l=encodeURIComponent(JSON.stringify(c))
switch(Gd(0,t)){case C6:const n=we(t,RH),r=s(n)&&1===n.length?n[0]:we(t,$H)[0],i=pe(e,r,rW)
if(o(i))break
return`${$W}:/${VW.product}/${tz.id}${i.id}?${tz.appEventId}=${r.id}${tz.invalidateWidgetsOnFailure}=true&${tz.metrics}=${l}`
case I6:const a=we(t,$H)[0]
return`${$W}:/${VW.product}/${tz.id}${a.id}?${tz.invalidateWidgetsOnFailure}=true&${tz.metrics}=${l}`
case S6:return f(B(t,jq),eW)}return`${$W}:/${VW.story}/${tz.id}${t.id}?${tz.invalidateWidgetsOnFailure}=true&${tz.metrics}=${l}`}function Lv(e,t){return t.map(t=>{if(t.type===rq)return null
if(sf(e,t)){const n=function(e,t){switch(Nr(e,t)){case Lz:return PT
case Mz:return null
default:return EH}}(e,t)
if((0,Jv.isSome)(n)){const r=Mv(e,t,n)
if((0,Jv.isSome)(r))return Xd(e,r,{cropCode:"bb",useCase:O6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}}const n=function(e,t){switch(Nr(e,t)){case Lz:return vE
case Mz:return mE
default:return fW}}(e,t),r=Mv(e,t,n),o=function(e,t){const n=Nr(e,t),r=of(e)
let o
switch(n){case Lz:o=r?"ic":"bb"
break
case Mz:o="bb"
break
default:o=r?"ia":"bb"}return o}(e,t)
return Xd(e,r,{cropCode:o,useCase:O6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}).filter(e=>null!==e)}function Mv(e,t,n){return ot(e,t,Ge(e,t),n)}function xv(e){var t
const n=B(e,mV)
let r=null
s(n)&&(r=f(n,AW))
let o=null
const i=we(e,$H)
switch(i.length>0&&(o=j(i[0],AW)),j(e,MH)){case Cm.AppOfTheDay:case Cm.GameOfTheDay:return null!==(t=null!=o?o:r)&&void 0!==t?t:""
default:return null!=r?r:""}}function $v(e,t,n,r,o){let i=null
ko(t)===dL&&(i=function(e,t,n,r){let o=null,i=null
const s=["editorialVideo.storyCardMotion16x9.previewFrame","editorialVideo.storyCenteredMotion16x9.previewFrame","editorialVideo.storeFrontVideo4x3.previewFrame"]
for(const e of s)if(i=B(t,e),(0,Jv.isSome)(i))break
return i&&(o=Xd(e,i,{withJoeColorPlaceholder:!0,useCase:O6.WidgetEditorial}),r||(o.crop="sr")),o}(e,t,0,r))
const s=[{artworkKeyPath:CC,crop:"sr"},{artworkKeyPath:Nx,crop:"sr"}]
switch(ko(t)){case Cm.AppOfTheDay:case Cm.GameOfTheDay:const e=n===tB?RC:"nr"
s.push({artworkKeyPath:E_,crop:r?e:"fn"})
break
case Cm.Video:case Cm.FullBleedImage:const t=n===tB?DC:_C
s.push({artworkKeyPath:CM,crop:r?t:"fn"})
break
case Cm.AppEventCard:const o=n===tB?RC:"nr"
s.push({artworkKeyPath:R_,crop:r?o:"fn"})
break
default:const i=n===tB?DC:_C
s.push({artworkKeyPath:D_,crop:r?i:"fn"})}let a=null
for(const n of s)if(a=Xd(e,B(t,n.artworkKeyPath),{cropCode:n.crop,useCase:O6.WidgetEditorial,withJoeColorPlaceholder:!0}),(0,Jv.isSome)(a))break
return null!=a?a:i}async function Fv(e,t){let n
switch(t.family){case 1:n=EC
break
case 2:n=B_
break
default:n=tB}let a=null
return typeof t.originalResponseHash!==_U&&null!==t.originalResponseHash&&""!==t.originalResponseHash&&typeof t.originalResponseDate!==_U&&null!==t.originalResponseDate&&""!==t.originalResponseDate&&(a={hash:t.originalResponseHash,creationDate:t.originalResponseDate}),await async function(e,t,n,a,c){return await new Promise((n,l)=>{if(!function(e,t,n,r){return!r||ar(e,e.bag.todayWidgetLivePreviewRolloutRate)}(e,0,0,a))return void l("No live preview will be shown due to losing the todayWidgetLivePreviewRolloutRate lottery.")
const u=new Ite,d=e=>l(e)
Ln(e,u.make(e)).then(a=>{const l=h(a,Sm.contentMaxAge),u=function(e,t){return r(e)||r(e.results)||o(e.results.data)?(t("Unable to create primary module; no results or data."),null):o(e.results.data[0].contents)?(t("Unable to create primary module; no contents."),null):e.results.data[0].contents.length===e.results.data[0].contents.filter(e=>z(e)).length?(t("Unable to create primary module; none of the cards are hydrated."),null):{label:"",title:"",meta:{},contents:e.results.data[0].contents}}(a,d)
if(null===u)return
const f=function(e){const t={label:"",title:"",meta:{},contents:[]}
if(r(e)||r(e.results)||o(e.results.data))return t
const n=e.results.data.slice(1)
return 0===n.length?t:{label:"",title:"",meta:{},contents:n.map(e=>e.contents).reduce((e,t)=>e.concat(t))}}(a),p=function(t,n,r,o,i){const a=(c=JSON.stringify(t.contents.concat(n.contents).map(e=>e.id))+(null!==r?r.toString():""),e.cryptography.hash("sha256",c))
var c
return null!==i&&s(i.hash)&&s(i.creationDate)&&i.hash===a?i:{hash:a,creationDate:(new Date).toUTCString()}}(u,f,l,0,c),w=function(e,t,n){null===n&&e.console.error("No TTL value was found--deferring to JS client for refresh time.")
const r=new Date(t.creationDate)
return r.setSeconds(r.getSeconds()+n),e.console.info(`Media API provided TTL: ${n} so timeline refresh date will be ${r}`),r}(e,p,l),g=Ev(e,u),v=Ev(e,f),m=function(e,t,n,s,a,c,l,u,d){if(r(t))return d("Unable to create a TodayWidgetContainer; primaryModule is null."),null
const f=Rv(e,t,s,!0,u,d)
if(0===f.length)return null
const h=Rv(e,n,s,!1,u,null),p=function(e,t,n,r,s,a){const c=De(t),l=Le(c,n),u={}
for(let e=0;e<r.length;e++){const t=e%r.length*2
u[r[e].storyId]=a===B_?s.slice(t,t+2):[]}const d=function(e,t,n){return function(e,r){const o=[],i=[]
return e.forEach(e=>{return void 0!==(r=e).eventStartDate&&null!==r.eventStartDate&&t<De(r.eventStartDate)&&De(r.eventStartDate)<=n?o.push(e):i.push(e)
var r}),[o,i]}(e)}(r,c,n),f=d[0]
let h=d[1]
const p=[...Array(l)].map(()=>[]),w=[...Array(l)].map((e,t)=>new Date(c.getTime()+60*t*60*1e3)),g=new Map
r.concat(s).forEach(t=>{if(i(t.eventStartDate)){const n=vi(t.eventBadgeKind,t.eventStartDate,t.eventEndDate)
g[t.storyId]=mi(e,n,t.eventStartDate,t.eventEndDate)}}),f.forEach(e=>{var t
for(let n=((Le(c,e.eventStartDate)-1)%(t=r.length)+t)%t;n<p.length&&!(e.eventEndDate<=w[n]);n+=r.length)for(let t=0;t<r.length&&!(p.length<=n+t);t++)if(0===p[n+t].length){p[n+t].push(S(e))
for(const r of u[e.storyId])p[n+t].push(S(r))
break}})
for(let e=0;e<p.length;e++){if(p[e].length>0)continue
const t=w[e]
if(h=h.filter(e=>void 0===e.eventEndDate||null===e.eventEndDate||e.eventEndDate>t),0===h.length)break
const n=h.shift()
h.push(n),p[e].push(S(n))
for(const t of u[n.storyId])p[e].push(S(t))}return p.map((e,t)=>{const n=w[t],r=e.map(e=>{const n=g[e.storyId],r=function(e,t){if(o(t))return null
const n=t.filter(t=>null===t.displayFromDate||t.displayFromDate<=e)
return 0===n.length?null:n.pop()}(w[t],n)
return null!==r?(e.heading=r.displayText,e.eventStartDate=r.countdownToDate):e.eventStartDate=null,e})
return new bte(r,n)})}(e,new Date(c.creationDate),l,f,h,s)
return new Tte(p,l,c.creationDate,c.hash)}(e,g,v,t,0,p,w,OC,d)
null!==m&&n(m)}).catch(e=>{l(e)})})}(e,n,t.isSnapshot,t.isPreview,a)}var Nv,Bv,Uv,Gv,jv,Vv,Hv,qv,Wv,zv,Yv,Jv,Kv,Zv,Qv,Xv,em,tm,nm,rm,om,im,sm,am,cm,lm,um,dm,fm,hm,pm,wm,gm,vm,mm,ym,Am,Tm,bm,Sm,Pm,Im,Cm,km,Om,Em,Rm,Dm,_m,Lm,Mm,xm,$m,Fm,Nm,Bm,Um,Gm,jm,Vm,Hm,qm,Wm,zm,Ym,Jm,Km,Zm,Qm,Xm,ey,ty,ny,ry,oy,iy,sy,ay,cy,ly={}
e.r(ly),e.d(ly,{downloadingOrdering:()=>T1,downloadingOrderingCompact:()=>b1,notPurchasedOrdering:()=>y1,notPurchasedOrderingCompact:()=>A1,notPurchasedSpotlightIndex:()=>g1,purchasedOrdering:()=>v1,purchasedOrderingCompact:()=>m1,purchasedSpotlightIndex:()=>w1}),Nv={},e.r(Nv),e.d(Nv,{downloadingOrdering:()=>E1,downloadingOrderingCompact:()=>R1,notPurchasedOrdering:()=>k1,notPurchasedOrderingCompact:()=>O1,notPurchasedSpotlightIndex:()=>P1,purchasedOrdering:()=>I1,purchasedOrderingCompact:()=>C1,purchasedSpotlightIndex:()=>S1}),Bv={},e.r(Bv),e.d(Bv,{notPurchasedOrdering:()=>M1,notPurchasedSpotlightIndex:()=>_1,purchasedOrdering:()=>L1,purchasedSpotlightIndex:()=>D1}),Uv={},e.r(Uv),e.d(Uv,{notPurchasedOrdering:()=>N1,notPurchasedSpotlightIndex:()=>$1,purchasedOrdering:()=>F1,purchasedSpotlightIndex:()=>x1}),Gv={},e.r(Gv),e.d(Gv,{notPurchasedOrdering:()=>j1,notPurchasedSpotlightIndex:()=>U1,purchasedOrdering:()=>G1,purchasedSpotlightIndex:()=>B1}),jv={},e.r(jv),e.d(jv,{notPurchasedOrdering:()=>W1,notPurchasedSpotlightIndex:()=>H1,purchasedOrdering:()=>q1,purchasedSpotlightIndex:()=>V1}),Vv={},e.r(Vv),e.d(Vv,{notPurchasedOrdering:()=>K1,notPurchasedSpotlightIndex:()=>Y1,purchasedOrdering:()=>J1,purchasedSpotlightIndex:()=>z1}),Hv={},e.r(Hv),e.d(Hv,{notPurchasedOrdering:()=>e2,notPurchasedSpotlightIndex:()=>Q1,purchasedOrdering:()=>X1,purchasedSpotlightIndex:()=>Z1}),qv={},e.r(qv),e.d(qv,{notPurchasedOrdering:()=>o2,notPurchasedSpotlightIndex:()=>n2,purchasedOrdering:()=>r2,purchasedSpotlightIndex:()=>t2}),Wv={},e.r(Wv),e.d(Wv,{downloadingOrdering:()=>d2,downloadingOrderingCompact:()=>f2,notPurchasedOrdering:()=>l2,notPurchasedOrderingCompact:()=>u2,notPurchasedSpotlightIndex:()=>s2,purchasedOrdering:()=>a2,purchasedOrderingCompact:()=>c2,purchasedSpotlightIndex:()=>i2}),zv={},e.r(zv),e.d(zv,{downloadingOrdering:()=>y2,downloadingOrderingCompact:()=>A2,notPurchasedOrdering:()=>v2,notPurchasedOrderingCompact:()=>m2,notPurchasedSpotlightIndex:()=>p2,purchasedOrdering:()=>w2,purchasedOrderingCompact:()=>g2,purchasedSpotlightIndex:()=>h2})
const uy="AppEventSearchResult",dy="AppSearchResult",fy="com.apple.MobileSMS",hy="com.apple.TVAppStore",py="com.apple.Arcade",wy="com.apple.AppStore.ProductPageExtension",gy="com.apple.appstorecomponentsd",vy="ContingentOfferDetailPage",my="ShelfBasedProductPage",yy="EditorialSearchResult",Ay="arcadeGroupingLockup",Ty="Lockup",by="arcadeGeneric",Sy="OfferItemDetailPage",Py="Screenshots",Iy="tapToRate",Cy="lockupList",ky="TodayCardLockupOverlay",Oy="TodayCardMarketingLockupOverlay",Ey="TodayCardMediaArtwork",Ry="TodayCardMediaBrandedSingleApp",Dy="TodayCardMediaList",_y="TodayCardMediaVideo",Ly="TodayCardMediaRiver",My="TodayCardParagraphOverlay",xy="TodayCardThreeLineOverlay",$y="TopChartsPage",Fy="ArcadeAction",Ny="CompoundAction",By="ExternalUrlAction",Uy="OfferAction",Gy="OfferAlertAction",jy="OfferConfirmationAction",Vy="ProductPageScrollAction",Hy="SearchAdAction",qy="ShelfBasedPageScrollAction",Wy="flowAction",zy="expanded",Yy="continuation",Jy="signup",Ky="purchases",Zy="donate",Qy="is32bitOnly",Xy="requires32bit",eA="is.workflow.my.app",tA="com.apple.mobileme.fmf1",nA="iPhone",rA="iPad",oA="com.apple.NanoCompass.watchkitapp",iA="com.apple.DeepBreathing",sA="com.apple.Depth",aA="com.apple.Mandrake",cA="SCS.ApDPCS01",lA="ACTION_SETTINGS",uA="shareSheet",dA="com.apple.InstallAssistant.",fA="Send Gift",hA="initiate",pA="additionalAdsInfo",wA="EDITORIALTAKEOVER",gA="SLPLOAD",vA="iad.format.text",mA="adsLocaleMetadata",yA="mapiFetchFail",AA="localizationNotAvailable",TA="SHARE_APP_EVENT_SUBTITLE",bA="j:mm",SA="inAppEvent",PA="systemimage://bell.fill",IA="appPromotionTitle",CA="OfferItems.FormattedDate.RedemptionDate.DateFormat",kA="OfferItems.Available.Now",OA="@@date@@",EA="arcade-see-all-games-button",RA="GAME_CENTER",DA="marketingArtwork",_A="seed",LA="upsell",MA="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",xA="PAGE_FACETS_FILTERS_COMING_SOON",$A="PAGE_FACETS_SORT_BY_TITLE",FA="PAGE_FACETS_INCLUDE_TITLE",NA="000000",BA="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",UA="displayBreakoutMaterial",GA="material",jA="textGradient",VA="plusLight",HA="MMMM d, y",qA="x-as3-internal:/today/test",WA="notificationSettings",zA="invalidateWidgetsOnFailure",YA="PageData",JA="ProductBuilder",KA="contingent-items:branch",ZA="contingentItemOffer",QA="contingent-items:association.trunks",XA="trunks",eT="offer-items:salables",tT="discountOffer",nT="promotionalText",rT="editorial-item-shelves",oT="viewEditorialItem",iT="preview",sT="lockupFromApiChartItem",aT="contentRatingsBySystem.appsApple.name",cT="ageRating.value",lT="ageRating.contentLevels",uT="br.l.official",dT="br.l",fT="br.10.official",hT="br.10",pT="br.12.official",wT="br.12",gT="br.14.official",vT="br.14",mT="br.16.official",yT="br.16",AT="br.18.official",TT="br.18",bT="impressionableAppIconFromData",ST="SCB.ApSCBL01",PT="circularIconArtwork",IT="appBinaryTraits",CT="requiresRosetta",kT="iphone5",OT="iphone6",ET="iphone6+",RT="maxEssentialInstallSizeInBytes",DT="maxDownloadSizeInBytes",_T="maxInstallSizeInBytes",LT="editorialArtwork.contentLogoTrimmed",MT="posterCardVideo16x9",xT="enabled",$T="concerns",FT="ACTION_REVIEW_REPORT",NT="TOAST_CONCERN_REPORTED_TITLE",BT="TOAST_CONCERN_REPORTED_DESCRIPTION",UT="systemimage://square.and.pencil",GT="userReviewId",jT="systemimage://hand.thumbsup",VT="systemimage://hand.thumbsdown",HT="guid",qT="formBody",WT="CONTROLLER_RECOMMENDED",zT="NOT_SUPPORTED",YT="CAPABILITY_GAME_CENTER_TITLE",JT="resource://ProductCapabilityGameCenter",KT="safariExtensions",ZT="above",QT="hasApps",XT="hasGames",eb="DEVELOPER_APPS_AND_GAMES",tb="DEVELOPER_GAMES",nb="DEVELOPER_APPS",rb="associations.apps.data",ob="prefersHiddenPageTitle",ib="enrichedEditorialNotes.tagline",sb="enrichedEditorialNotes.callToAction",ab="shelf_id",cb="arcadeSeeAllGamesFooter",lb="footer",ub="three",db="ARCADE_PREORDER_COMING_SOON",fb="REPORT_A_PROBLEM",hb="Shelves.Accessibility.Label",pb="Shelves.Accessibility.RoleDescription",wb="featuredCategories",gb="editorialCard",vb="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_GAME",mb="breakoutTall",yb="renderGroupingPage",Ab="noPersonalizationAvailable",Tb="groupingAppEvent",bb="suppressText",Sb="layoutStyle.layoutSize",Pb="link.url",Ib="GameCenter.ContinuePlayingShelf.Title",Cb="videoCard",kb="impressionIndex",Ob="Achievements Hero",Eb="inprogress",Rb="gameCenterFriendingViaPush",Db="legacy",_b="FRIEND_SUGGESTION",Lb="smallContactCard",Mb="INVITE",xb="FROM_CONTACTS",$b="inviteFriend",Fb="removeFriendSuggestion",Nb="friendSuggestion",Bb="redownloadButtonTintUsingOfferTheme",Ub="parentShelfItems",Gb="displayDeviceDrivenContent",jb="null",Vb="smallBreakout",Hb="tagBrick",qb="advertPressed",Wb="offerButtonPress",zb="MEDRIVER_",Yb="iAdIsSpecifiedCreativeUsed",Jb="promotedContent",Kb="editorialContext",Zb="Watch",Qb="Messages",Xb="developerName",eS="Bundles.ProductPage.AvailableOnAll.Message",tS="Bundles.ProductPage.AvailableOnMore.Message",nS="firstVersionSupportingInAppPurchaseApi",rS="widthConstrainedLockup",oS="OfferButton.Title.Subscribe",iS="descending",sS="editorialItemActionFromData",aS="displaySubStyle",cS="iad.lineItem",lS="clientIdentifierOverride",uS="contentRestrictionReasons",dS="clientCorrelationKey",fS="viewedInfo",hS="viewedInfoDetailed",pS="cookie",wS="ownerDsid",gS="pageExit",vS="trampoline",mS="trampolineContext",yS="widgetContext",AS="iAdOdmlSuccess",TS="ODP_NOAD",bS="APPSTORE_SEARCH_LANDING_PAGE",SS="APPSTORE_TODAY_TAB",PS="APPSTORE_PRODUCT_PAGE",IS="APPSTORE_PRODUCT_PAGE_DOWNLOAD",CS="iAdPageCustomId",kS="contingentItemId",OS="browserChoice",ES="browserChoiceScreenBuy",RS="clip",DS="Today",_S="subscriptionState",LS="buttonName",MS="actionContext",xS="selectedPageFacets",$S="searchGhostHint",FS="didYouMean",NS="displaysArcadeUpsell",BS="franchise",US="isOnboardingCard",GS="optimizationEntityId",jS="optimizationId",VS="iAdEligible",HS="macSoftware",qS="iosSoftware",WS="artist",zS="pending",YS="channelPartner",JS="eligibilityType",KS="upsellScenario",ZS="modeType",QS="FreeTrial",XS="PayUpFront",eP="PayAsYouGo",tP="test",nP="rebuy=true",rP="OfferButton.FlowPreview.Get",oP="OfferButton.FlowPreview.Preorder",iP="preorderedSubscribed",sP="productPageBrowserChoiceSelect",aP="preorderSubscribed",cP="INTRO_PRICE_OFFER_SUBTITLE",lP="Offer.InlineInAppPurchases",uP="OfferButton.ExternalPurchases.Subtitle",dP="weight_parameter",fP="meta.personalizationData.isPinned",hP="meta.personalizationData.segId",pP="OnDeviceRecommendationsPageController",wP="fetchRecommendations",gP="candidates",vP="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",mP="<br><br>",yP="privacyPolicy",AP="PRODUCT_PRIVACY_DEFINITIONS_LINK",TP="privacyDefinitions",bP="ACTION_SEE_DETAILS",SP="USAGE_DATA",PP="systemimage://person.circle",IP="NOT_COMPATIBLE_BANNER",CP="UNSUPPORTED_CAPABILITIES",kP="UNSUPPORTED_WATCHOS_VERSION",OP="experimentLocale",EP="pageCustomId",RP="ProductPage.Section.ScreenshotsPreview.Title",DP="user",_P="reviewsContainer",LP="displayable-kind",MP="urlQuery",xP="editorsChoiceItem",$P="ratingCount",FP="APP_SUPPORT",NP="REVIEWS_MOST_HELPFUL",BP="REVIEWS_MOST_FAVORABLE",UP="REVIEWS_MOST_CRITICAL",GP="recent",jP="REVIEWS_MOST_RECENT",VP="reviewsPageActionFromReviewsData",HP="genreName",qP="BADGE_AGE_RATING_YEARS",WP="BADGE_AGE_RATING",zP="medicalDeviceInfo",YP="BADGE_PLAYERS_HEADING",JP="{maxPlayers}",KP="BADGE_NO_RATINGS_CAPTION",ZP="storefrontContentRating",QP="{subtitle}",XP="webBrowserFlowType",eI="marker",tI="accessibilityParagraph",nI="prefersReadableContentAlignedTitle",rI="VOICE_CONTROL",oI="AccessibilityDetails.Header.NoLearnMoreLink",iI="AccessibilityDetails.Header.NoLearnMoreLink.NoDeveloperName",sI="ProductPage.Accessibility.Header.NoSupportedFeatures.NoLearnMoreLink",aI="ProductPage.Accessibility.Header.NoReportedFeatures.NoLearnMoreLink",cI="gameCenterPlayerGameAchievementSummary",lI="ProductPage.Section.EditorsNotes.Title",uI="ProductPage.Section.FeaturedIn.Title",dI="largeGameCenterPlayer",fI="hasEula",hI="productMediaItem",pI="createTapToRateProductReviewAction",wI="ProductPage.RatingsAndReviews.Footer.LearnMore",gI="ProductPage.Section.MostRecentVersion.Title",vI="overview",mI="titledParagraph",yI="detail",AI="releaseNotes",TI="ProductPage.Section.Videos.Title",bI="textPair",SI="product-page-info-section",PI="deviceFamily",II="InfoList.AgeRating.LearnMore",CI="ageBand",kI="minAge",OI="maxAge",EI="{minAgeRating}",RI="{maxAgeRating}",DI="advisories",_I="seventeenPlus",LI="gracRegistrationNumber",MI="twelvePlus",xI="Seller",$I="isTrader",FI="adFailureReason",NI="Search.Facets.iPadAndIPhone",BI="Search.Facets.iPhoneOnly",UI="SEARCH_FACET_FREE",GI="SEARCH_FACET_",jI="filter[price]",VI="filter[genre]",HI="filter[ages]",qI="terms",WI="naturalLanguage",zI="results.contents",YI="timeSinceOnScreen",JI="recentSearches",KI="midScrollGuidedSearch",ZI="SEARCH_TRANSPARENCY_LINK",QI="rewrite",XI="EDITORIAL_SEARCH_RESULT_TYPE_DEVELOPER_TITLE_CASE",eC="whenInstalled",tC="mixed",nC="guidedLabel",rC="search-revisions",oC="singleColumnList",iC="@@chartPosition@@",sC="developerInfo",aC="divider",cC="scrollablePill",lC="displayType",uC="appMarkerType",dC="Acquisition",fC="InlineImage",hC="AppLockup",pC="InlineVideo",wC="quote",gC="Small",vC="Medium",mC="Large",yC="itunes.apple.com",AC="meta.personalizationData.optimizationId",TC="meta.personalizationData.optimizationEntityId",bC="meta.personalizationData.replaceIfAdPresent",SC="editorialBackground",PC="MC.ApSCFB01",IC="LCS.ApLCXW01",CC="editorialArtwork.storyCardStatic16x9",kC="UAS.ApXWC01",OC="com.apple.AppStore.Widgets.Today",EC="systemMedium",RC="DCEC.AppWS01",DC="MCGC.AppWS01",_C="MCGC.AppWL01",LC="PersonalizedRecommendations.Toggle.Title",MC="PersonalizedRecommendations.Toggle.Footer",xC="PERSONALIZATION_PURCHASES",$C="RECOMMENDATIONS",FC="engagement-data",NC="ArcadeOnboarding",BC="extend",UC="ALL_ARCADE_GAMES",GC="arcadeSubscribePage",jC="release",VC="nonnull",HC="token.pageInformation",qC="token.pageInformation.adPageInfo",WC="token.excludeAttribution",zC="isAppInstalled",YC="token.targetType",JC="token.metricsKind",KC="systemInformation",ZC="token.productVariantData",QC="token.inAppEventId",XC="Purchases",ek="OfferButton.Title.BundlePurchased",tk="gameCenterProfile",nk="OnDeviceRecommendationsPageController:handleShelf not implemented",rk="ProductData",ok="Product page preloading is disabled",ik="lookup",sk="app-bundle",ak="search-recommendation-sections",ck="trending-contents",lk="TodayData",uk="TodayForApps",dk="Arcade.DownloadPack.Suggestions.GetAllButtonTitle",fk="asString",hk="asNumber",pk="asBoolean",wk="asJSONValue",gk="catalog",vk="engagement",mk="view/see-all",yk="its_qt",Ak="adId",Tk="prefix",bk="username",Sk="password",Pk="port",Ik="-caseInsensitive",Ck="signatureResumption",kk="checkForLongUrl",Ok="getPass",Ek="certId",Rk="hsb",Dk="metrics-identifiers",_k="advp",Lk="itsct",Mk="itscg",xk="itcCt",$k="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/accountSummary",Fk="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/redeemLandingPage",Nk="IPHONE_BRAND_NAME",Bk="IPAD_BRAND_NAME",Uk="APPLE_TV_BRAND_NAME",Gk="APPLE_WATCH_BRAND_NAME",jk="MAC_BRAND_NAME",Vk="SearchResultsPageIntent",Hk="ContingentOffer",qk="existing",Wk="bundle",zk="com.apple.visionproapp",Yk="editorial",Jk="InAppPurchaseLockup",Kk="MixedMediaLockup",Zk="PosterLockup",Qk="ProductPage",Xk="ScreenshotsLockup",eO="TrailersLockup",tO="arcadeTabNavBar",nO="textFollowsTintColor",rO="person.crop.square",oO="magnifyingglass",iO="list",sO="OfferStateAction",aO="TabChangeAction",cO="timer",lO="primaryTerm",uO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard",dO="isStandaloneWithCompanionForWatchOS",fO="isDeliveredInIOSAppForWatchOS",hO="isXROSCompatible",pO="free",wO="Mac",gO="systemimage://square.and.arrow.up",vO="results.data",mO="accountDetails",yO="createAccount",AO="sendGift",TO="addFunds",bO="Redeem",SO="cppAssetsMissing",PO="customers-also-bought-apps-download",IO="past",CO="module",kO="events-and-offers",OO="appPromotion",EO="trunk-app",RO="useTrunkArtwork",DO="editorialArtwork.brandLogo",_O="systemimage://questionmark.circle",LO="comingSoonApps",MO="marketingVideo",xO="supportsSharePlay",$O="filter[ageRating]",FO="filter[supportsGameController]",NO="filter[isMultiplayer]",BO="controllerSupport",UO="subscribe",GO="custom",jO="Arcade.Welcome.Family.Button.ExploreArcade",VO="breakoutTextAlignment",HO="left",qO="right",WO="black",zO="arcadeSubscribe",YO="hiddenPurchases",JO="isViewOnly",KO="action.kind",ZO="action.url",QO="Goto",XO="standalone-merchandised-in-apps",eE="see-all-contents",tE="fileSizeByDevice",nE="requirementsByDeviceFamily",rE="backgroundAssetsInfo",oE="backgroundAssetsInfoWithOptional",iE="installSizeByDeviceInBytes",sE="licenses",aE="internetContentProviderInfo",cE="review-summary",lE="categorizations",uE="future",dE="Apps",fE="ageBandId",hE="customAttributes",pE="appShowcase",wE="placeholderBackground",gE="checksum",vE="circularArtwork",mE="ovalArtwork",yE="iphone_6_5",AE="iphone_d73",TE="iphone_d74",bE="editorialArtwork.splashFullScreen",SE="editorialArtwork.topShelf",PE="customVideoPreviewsByTypeForAd",IE="BreakoutLarge",CE="textColor3",kE="Alert.GenericError.Title",OE="Alert.GenericError.Message",EE="version",RE="decimalPad",DE="siri",_E="hasInAppPurchases",LE="systemGreen",ME="jpeg",xE="DEVELOPER_WATCH",$E="DEVELOPER_LATEST_RELEASE",FE="DEVELOPER_BUNDLES",NE="DEVELOPER_APPLE_ARCADE",BE="arcadeFooter",UE="enrichedEditorialNotes.name",GE="ignoreITunesShortNotes",jE="editorialNotes.short",VE="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_VIEW",HE="collectionIcons",qE="shelf_page_header",WE="navigationBar",zE="TermsAndConditions.Title",YE="two",JE="CategoryGrouping",KE="ribbonBar",ZE="onDevicePersonalization",QE="Genre",XE="collectionModule",eR="collectionLockup",tR="breakoutFullScreen",nR="Browse Categories",rR="hasSeeAll",oR="designTag",iR="editorialStoryCard",sR="nonarcade",aR="isArcade",cR="date",lR="contentGraphicTrimmed",uR="insetAd",dR="Lockup.Heading.Arcade",fR="discounts",hR="inAppPurchaseInstall",pR="item.offer.buyParams",wR="offerId",gR="isVerifiedForAppleSiliconMac",vR="genreNames",mR="targetId",yR="data-metrics-impressions-low-latency",AR="media",TR="exit",bR="hasiAdData",SR="APPSTORE_SEARCH_RESULT_PAGE",PR="overridePageContext",IR="userId",CR="dsId",kR="refAppType",OR="widget",ER="iAdImpressionIndex",RR="iAdRotationCount",DR="metadata",_R="context",LR="BrowserChoice",MR="com.apple.AppStore.clipOverlay",xR="paymentTopicFromBag",$R="overlayClip",FR="offerReleaseDate",NR="buyInitiate",BR="See All",UR="searchOriginatingTerm",GR="recents",jR="undoSpellCorrection",VR="applySpellCorrection",HR="userTypedHint",qR="impressionOptions",WR="impressionParentId",zR="searchGhostHintPrefix",YR="searchGhostHintTermPhase",JR="searchGhostHintTerm",KR="input",ZR="meta.metrics",QR="dsid",XR="@@durationCount@@",eD="@@postTrialPriceDuration@@",tD="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",nD="arcade-preorder",rD="preorderedNotSubscribed",oD="confirmation",iD="preorderNotSubscribed",sD="OfferButton.IntroPrice.FreeTrial",aD="discountOwnedParent",cD="discountUnownedParent",lD="use_signals",uD="meta.personalizationData.grpId",dD="editorialItemGroup",fD="DATA_NOT_PROVIDED",hD="PRODUCT_PRIVACY_LEARN_MORE_LINK",pD="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",wD="privacyDetail",gD="privacyCard",vD="experimentId",mD="helpful",yD="mostHelpfulReviews",AD="wasReset",TD="ratingsDetails",bD="RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS",SD="supportUrl",PD="medicalDevice",ID="chartPositions",CD="highMotion",kD="{minPlayers}",OD="{releaseDate}",ED="value",RD="{count}",DD="deviceCompatibility",_D="Offer.Expanded.Title.ComingSoon",LD="externalVersionId",MD="supportsClickEventsOnSwiftUIHostingCell",xD="AccessibilityDetails.Title",$D="ProductPage.Section.Information.Title",FD="ProductPage.Section.Supports.Title",ND="safetyAndComplianceUrl",BD="darkOverlay",UD="productReviewAction",GD="ProductPage.Section.Reviews.MostHelpfulReviews.Title",jD="productRatingsAndReviewsComponent",VD="versionDisplay",HD="standardInformationShelf",qD="InfoList.AgeRating.Title",WD="Install.Size.String",zD="{fileSize}",YD="dataSetId",JD="SEARCH_FACET_ANY_PRICE",KD="SEARCH_FACET_ANY_CATEGORY",ZD="SEARCH_FACET_RELEVANCE",QD="kinds",XD="macOSCompatibleIOSApps",e_="clusterId",t_="landing:new-protocol",n_="lastNLSQueryDate",r_="top-apps",o_="showLabelInSearch",i_="guidedToken",s_="secondaryGenreShortDisplayNames",a_="SearchRevisions",c_="{searchTerm}",l_="no-results",u_="ads-result",d_="searchChartsAndCategories",f_="alternateLabel",h_="contentIds",p_="associations.app-events.data",w_="associations.app-events.attributes.forceAppEvent",g_="mediumAdLockupWithScreenshotsBackground",v_="adItem",m_="condensedAdLockupWithIconBackground",y_="displayTerm",A_="supportsGameController",T_="rankedSecondaryGenre",b_="onDeviceSearchHistory",S_="editorialLink",P_="upsellForNonacquisitionCanvas",I_="arcadeIcons",C_="AppMarker",k_="framedArtwork",O_="isAcquisition",E_="editorialArtwork.dayCard",R_="editorialArtwork.eventCard",D_="editorialArtwork.generalCard",__="ignoreEditorialArt",L_="headerName",M_="headerBadge",x_="headerTagline",$_="meta.associations.recommendations.data",F_="associations.recommendations.data",N_="todaySection",B_="systemLarge",U_="personalization-data",G_="ACCOUNT_SETTINGS",j_="upsellRecovery",V_="token.metricsPlatformDisplayStyle",H_="https",q_="channel-apps",W_="done",z_="chin",Y_="Arcade.DownloadPack.Suggestions.PrimaryButtonTitle",J_="strict",K_="customIconArtwork",Z_="ratings",Q_="suffix",X_="language",eL="AppEvent",tL="OfferItem",nL="com.apple.AppStore",rL="arcadeProductPage",oL="UpdatesLockup",iL="askToBuy",sL="launchRepair",aL="editorialItemCanvas",cL="blue",lL="applewatch",uL="river",dL="Video",fL="FlowAction",hL="pageChange",pL="originalUrl",wL="updates",gL="checkForPreorders",vL="meta.discountOffer",mL="isIOSBinaryMacOSCompatible",yL="presentModal",AL="viewGenre",TL="CONTROLLER_OPTIONAL",bL="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",SL="SIRI_REMOTE_REQUIRED",PL="purchaseHistory",IL="familySharing",CL="manageSubscriptions",kL="push",OL="deepLink",EL="png",RL="close",DL="redemptionExpirationDate",_L="details",LL="systemBlue",ML="with",xL="personal-recommendations",$L="comingSoon",FL="wordmark",NL="external",BL="Action.OK",UL="messagesScreenshots",GL="supportsFunCamera",jL="supportURLForLanguage",VL="websiteUrl",HL="top-in-app-purchasables",qL="unlistedApps",WL="redownload",zL="cabAdSupport",YL="merchandised-in-apps",JL="textColor1",KL="670",ZL="roundPrerendered",QL="tvRect",XL="appleWatch_2021",eM="appleWatch_2018",tM="appleWatch",nM="iphone_5_8",rM="editorialArtwork.bannerUber",oM="splashVideo4x3",iM="arcadeShowcase",sM="StoryMedium",aM="systemimage://exclamationmark.circle",cM="application/json",lM="prefersNonStandardBackButton",uM="textOnly",dM="subscriptionHero",fM="interactive",hM="pageHeader",pM="hasChevron",wM="textLightensOnHighlight",gM="hasSeparator",vM="TwoUp",mM="Asymmetrical",yM="cppData",AM="contingentItems",TM="prefersLargeTitleWhenRoot",bM="singleModule",SM="materialText",PM="arcadeDownloadPackCard",IM="displayCount",CM="editorialArtwork.mediaCard",kM="nonArcade",OM="locked",EM="friendingViaPush",RM="inAppPurchaseTiledLockup",DM="standardApp",_M="platformAttributes.ios.bundleId",LM="abExperiment",MM="userRating.ratingCount",xM="userRating.value",$M="editorialBadgeType",FM="editorialPriority",NM="isSubscription",BM="appExtVrsId",UM="parentId",GM="multiple-system-operators",jM="pageReferrer",VM="crossfireReferral",HM="advertDeviceWindow",qM="cardType",WM="iAdMetadata",zM="SearchFocus",YM="Focus",JM="position",KM="submit",ZM="SoftwareBundle",QM="iAdAppStoreClientRequestId",XM="METADATA",ex="iAdMissedOpportunityReason",tx="iAdSlotInfo",nx="customProductPage",rx="prevPage",ox="platformDisplayStyle",ix="application/x-www-form-urlencoded",sx="iAdDuplicateLayoutType",ax="hintsEntity",cx="idType",lx="update",ux="complete",dx="OfferButton.Title.Get",fx="{appName}",hx="notSubscribed",px="OfferButton.IntroPrice.Trial",wx="meta.personalizationData.score",gx="PRODUCT_PRIVACY_TITLE",vx="privacyType",mx="systemimage://exclamationmark.triangle",yx="webBrowser",Ax="install",Tx="text/markdown",bx="chartPosition",Sx="BADGE_MFI_HEADING",Px="systemimage://person.crop.square",Ix="MMM d, yyyy",Cx="watchOS",kx="xrOS",Ox="prefersIndirectTouch",Ex="PRIVACY_POLICY",Rx="ProductPage.Section.SafetyAndCompliance.Title",Dx="componentBackgroundStandout",_x="APP_STORE_EDITORS_NOTES",Lx="framedVideo",Mx="search-hints",xx="slp",$x="searchResult",Fx="imageWithLabel",Nx="editorialArtwork.storyCenteredStatic16x9",Bx="header-contents",Ux="materialGradient",Gx="fractionalWidth",jx="de7bbd8e",Vx="multiplex",Hx="customers-also-bought-apps-with-download-intent",qx="user-reviews",Wx="searchLanding:see-all",zx="customArtwork",Yx="hash",Jx="dynamic",Kx="apps-media-api-edge-host",Zx="guidedSearch",Qx="groupingLockup",Xx="actionLinks",e$="productReview",t$="multiApp",n$="singleLockup",r$="fields",o$="requiresGameController",i$="CONTROLLER_REQUIRED",s$="webView",a$="Account",c$="lockupArtwork",l$="startDate",u$="endDate",d$="badgeKind",f$="eventModule",h$="inAppEventId",p$="topic",w$="branch-app",g$="<b>",v$="</b>",m$="<br>",y$="winback",A$="Arcade.SeeAllGames.Button.Title",T$="buy",b$="breakoutCallToActionLabel",S$="target",P$="mixedMediaLockup",I$="personalizationTransparency",C$="editorial-elements",k$="alternate-apps",O$="related-editorial-items",E$="privacy",R$="accessibility",D$="supportedGameCenterFeatures",_$="privacyDetails",L$="round",M$="appleWatch_2022",x$="appleWatch_2024",$$="textColor2",F$="heic",N$="shortEditorialNotes",B$="largeHeroBreakout",U$="mediaPageHeader",G$="editorialNotes.callToAction",j$="ThreeUp",V$="largeImageLockup",H$="personalizationData",q$="systemimage://magnifyingglass",W$="categoryBrick",z$="Lockup.Footer.GamesApp",Y$="searchLandingTrendingSection",J$="doNotFilter",K$="onDevicePersonalizationUseCase",Z$="customDeepLink",Q$="targetType",X$="tag",eF="iAdImpressionId",tF="hints",nF="pageContext",rF="refApp",oF="hint",iF="impressionId",sF="NOAD",aF="ad_container",cF="extRefApp2",lF="extRefUrl2",uF="iAdSlotId",dF="offerType",fF="searchPrefix",hF="ARCADE_PREORDER_LOCKUP_COMING_SOON",pF="{price}",wF="checkmark",gF="trial",vF="miniTodayCard",mF="intermediateDetailPage",yF="{developerName}",AF="identifier",TF="ProductPage.ReviewSummary.Body.Title",bF="languages",SF="controller",PF="select",IF="allProductReviewActions",CF="productReviewsHeader",kF="LICENSE_AGREEMENT",OF="landing",EF="R8802",RF="genreShortDisplayName",DF="multirooms",_F="textLabel",LF="FullWidth",MF="work",xF="play",$F="develop",FF="app-distribution",NF="ArcadeData",BF="SearchData",UF="attributes",GF="many",jF="developer-other-apps",VF="boolean",HF="textLinksShelf",qF="arcadeComingSoon",WF="false",zF="message",YF="four-screenshots",JF="appstore",KF="purchased",ZF="redeem",QF="gift",XF="meta.contingentItemOffer",eN="minimumWatchOSVersion",tN="price",nN="dynamicUI",rN="search-results",oN="search-landing",iN="supportsStreamlinedBuy",sN="additionalTerms",aN="secondaryText",cN="toggle",lN="appTrailerLockup",uN="privacyPolicyUrl",dN="charts",fN="types",hN="ipod",pN="inAppPurchaseLockup",wN="pill",gN="unadorned",vN="multiplayer-activities",mN="splashVideo16x9",yN="splashVideo3x4",AN="screenshotsLockup",TN="EditorialLockupLargeVariant",bN="EditorialLockupMediumVariant",SN="Action.LearnMore",PN="mac-os-compatible-ios-apps",IN="system-apps",CN="xros-apps",kN="prefersOverlayedPageHeader",ON="largeBreakout",EN="canvas",RN="canonicalId",DN="layoutDirection",_N="AllGames",LN="placeholder",MN="rowCount",xN="mediumStoryCard",$N="mso",FN="com.apple.games",NN="links",BN="genres",UN="named",GN="cardDisplayStyle",jN="actionUrl",VN="impressionQueue",HN="eventVersion",qN="advertRotation",WN="impressionType",zN="softwareType",YN="PREORDER_NOTIFY_MESSAGE",JN="size",KN="NOT_COMPATIBLE_BANNER_TEMPLATE",ZN="{linkTitle}",QN="systemimage://gamecontroller.fill",XN="rooms",eB="targetPlatform",tB="systemSmall",nB="navigation",rB="few",oB="appEvent",iB="new",sB="appIcon",aB="GET",cB="code",lB="externalUrl",uB="categories",dB="ages",fB="share",hB="minPlayers",pB="maxPlayers",wB="customScreenshotsByTypeForAd",gB="productVideo",vB="EventDetails",mB="textColor4",yB="toast",AB="roundedRect",TB="singleSelection",bB="arcadeDownloadPackCategories",SB="pageMetrics",PB="sellerInfo",IB="accessibilityDetails",CB="largeLockup",kB="roundedRectPrerendered",OB="ipadPro",EB="ipad_10_5",RB="enrichedEditorialNotes",DB="EditorialLockupLarge",_B="EditorialLockupMedium",LB="isGameCenterEnabled",MB="imessage-apps",xB="lockupSmall",$B="editorial-shelves-collection:contents",FB="posterLockup",NB="editorial-elements:contents",BB="offerItems",UB="largeStoryCard",GB="listItem",jB="suggested",VB="arcadeApp",HB="ARCADE_ACTION_TITLE_EXPLORE",qB="EXPLORE",WB="extRefUrl",zB="refUrl",YB="iAdContainerId",JB="trending",KB="BADGE_MFI_SUPPORTED",ZB="arcadeProductPageInlineMessage",QB="productPageInlineMessage",XB="spacer",eU="rank",tU="iads",nU="Search Results",rU="coercedValue",oU="appletv",iU="arcadeTabHeader",sU="always",aU="menuItem",cU="back",lU="LearnMore",uU="badge",dU="branch",fU="salables",hU="releaseDate",pU="comingSoonGrouping",wU="isCanvasAvailable",gU="versionHistory",vU="ipadPro_2018",mU="ipad_11",yU="expectedReleaseDate",AU="watch-apps",TU="atv-apps",bU="editorial-shelves-header",SU="primary-contents",PU="badge-content",IU="Horizontal",CU="lightOverArtwork",kU="mediumImageLockup",OU="editorial_id",EU="meta.personalizationData.appId",RU="achievement",DU="todayBrick",_U="undefined",LU="subscribed",MU="pageFields",xU="pageUrl",$U="contentRating",FU="hostApp",NU="pageDetails",BU="{title}",UU="NOT_COMPATIBLE_BANNER_LINK_TITLE",GU="compatibilityAnnotation",jU="ppid",VU="relationship",HU="allProductReviews",qU="tapToRateProductReviewAction",WU="writeAReviewProductReviewAction",zU="notPurchasedRatingsAndReviews",YU="purchasedRatingsAndReviews",JU="userRating",KU="Any",ZU="apps.apple.com",QU="apps-and-games",XU="eula",eG="host",tG="inAppPurchase",nG="hero",rG="disabled",oG="story",iG="NO_BADGE",sG="isFirstPartyHideableApp",aG="iap",cG="internal",lG="APPLOCKUP",uG="productArtwork",dG="location",fG="recurringSubscriptionPeriod",hG="numOfPeriods",pG="@@count@@",wG="arcadeSeeAllGames",gG="upsellBreakout",vG="topCharts",mG="width",yG="POST",AG="mac-apps",TG="ios-apps",bG="brick",SG="showExpectedReleaseDate",PG="editorialNotes.badge",IG="editorialCopy",CG="href",kG="editorialBadgeInfo",OG="click",EG="iAdPlacementId",RG="iAdId",DG="SearchLanding",_G="userProductReviews",LG="discover",MG="customers-also-bought-apps",xG="bundleParents",$G="textCards",FG="isStandaloneForWatchOS",NG="chartHref",BG="description.standard",UG="annotation",GG="iad",jG="actionType",VG="Games",HG="contexts",qG="clear",WG="height",zG="previewFrame",YG="debug",JG="supportsArcade",KG="one",ZG="tvOS",QG="pageId",XG="actionDetails",ej="{osVersion}",tj="editorsChoiceProductReviews",nj="bundleChildren",rj="term",oj="tvos",ij="tabs",sj="number",aj="dismiss",cj="priceFormatted",lj="offerName",uj="bgColor",dj="deviceFamilies",fj="Hero",hj="prefersLargeTitle",pj="editorialClientParams",wj="heroCarousel",gj="facet",vj="query",mj="iAdTemplateType",yj="create",Aj="detailPage",Tj="rating",bj="Achievements",Sj="notPurchasedLinks",Pj="generic",Ij="editorialItem",Cj="brandedSingleApp",kj="finance",Oj="remoteControllerRequirement",Ej="buyParams",Rj="transparent",Dj="upsellMarketingItem",_j="metrics",Lj="videoPreviewsByType",Mj="{learnMoreLink}",xj="colored",$j="tagline",Fj="offers",Nj="editorial-item-groups",Bj="renderPage",Uj="cancel",Gj="other",jj="inAppPurchases",Vj="subscriptions",Hj="paragraph",qj="todayCard",Wj="protocol",zj="data",Yj="latest-release-app",Jj="tile",Kj="productReviewsFooter",Zj="category",Qj="presentModalFormSheet",Xj="editorialElementKind",eV="screenshotsByType",tV="grouping",nV="eventType",rV="pageType",oV="reviewSummary",iV="linkableText",sV="SearchResults",aV="trailing",cV="short",lV="appletvos",uV="flowPreview",dV="editorial-cards",fV="token",hV="genreDisplayName",pV="image",wV="purchasedLinks",gV="iOS",vV="object",mV="editorialNotes",yV="developers",AV="editorialNotes.name",TV="editorialNotes.tagline",bV="its_contentId",SV="pathname",PV="meta",IV="view",CV="No page routes specified",kV="searchLanding",OV="contingent-items",EV="text/x-apple-as3-nqml",RV="marketing-items",DV="color",_V="tags",LV="expectedReleaseDateDisplayFormat",MV="gameCenter",xV="smallStoryCard",$V="completed",FV="card",NV="Software",BV="web",UV="groupings",GV="rgb",jV="type",VV="Search",HV="adamId",qV="medium",WV="collections",zV="collection",YV="fractionalHeight",JV="text/plain",KV="macOS",ZV="offer-items",QV="challenges",XV="open",eH="editorialQuote",tH="mostRecentVersion",nH="platform",rH="sort",oH="arcade-apps",iH="preorder",sH="text",aH="realityDevice",cH="productPage",lH="preorderDisclaimer",uH="xros",dH="never",fH="children",hH="isAppleWatchSupported",pH="artistName",wH="requiredCapabilities",gH="ACTION_SEE_ALL",vH="osx",mH="recommendations",yH="absolute",AH="grid",TH="featuredIn",bH="account",SH="productPageYMALDuringDownload",PH="multiplayer",IH="impressions",CH="overlay",kH="product",OH="compatibilityControllerRequirement",EH="iconArtwork",RH="primary-content",DH="ignoredValue",_H="genre",LH="minimumOSVersion",MH="displayStyle",xH="macRequiredCapabilities",$H="card-contents",FH="productRatings",NH="subtitle",BH="defaultValue",UH="editorsChoice",GH="accessibilityDeveloperLink",jH="accessibilityHeader",VH="developer",HH="kind",qH="coercible",WH="infer",zH="accessibilityFeatures",YH="moreByDeveloper",JH="privacyFooter",KH="videos",ZH="hasMacIpaPackage",QH="leaderboards",XH="Room",eq="small",tq="appEvents",nq="label",rq="in-apps",oq="productPageYMAL",iq="searchTerm",sq="games",aq="editorial-pages",cq="action",lq="informationRibbon",uq="privacyTypes",dq="video",fq="mediumLockup",hq="similarItems",pq="messages",wq="privacyHeader",gq="chart",vq="searchResults",mq="white",yq="swoosh",Aq="capabilities",Tq="light",bq="true",Sq="isPreorder",Pq="Arcade",Iq="none",Cq="friendsPlaying",kq="bundleId",Oq="sequential",Eq="article",Rq="search",Dq="its_id",_q="large",Lq="smallLockup",Mq="description",xq="ios",$q="editorialVideo",Fq="ageRating",Nq="center",Bq="ipad",Uq="iphone",Gq="default",jq="link",Vq="information",Hq="editorialArtwork",qq="reviews",Wq="title",zq="string",Yq="topLockup",Jq="dark",Kq="header",Zq="inline",Qq="achievements",Xq="unknown",eW="url",tW="today",nW="screenshots",rW="app",oW="pad",iW="vision",sW="editorial-items",aW="app-bundles",cW="lockup",lW="phone",uW="leading",dW="static",fW="artwork",hW="app-events",pW="arcade",wW="standard",gW="watch",vW="mac",mW="contents",yW="apps",AW="name",TW="button",bW="navigate",SW="page",PW="$kind",IW="shelf"
Yv=e(8706),Jv=e(5542),Kv=e(4172),Zv=e(2450)
const CW={}
class kW{static createSharedMetricsReferralContext(e){kW.shared||(kW.shared=new kW(e))}constructor(e){this.currentReferral=null,this.isMetricsReferralContextRequired=!0,this.isEventDetailClickEventOverrideNecessary=!e.host.isOSAtLeast(16,2,0)}get shouldUseJSReferralData(){return this.isMetricsReferralContextRequired&&i(this.currentReferral)}get activeReferralData(){return this.shouldUseJSReferralData&&null!==this.currentReferral&&this.currentReferral.isActive?this.currentReferral.data:null}setReferralDataForProduct(e,t){var n,o,i
if(!this.isMetricsReferralContextRequired||r(t))return
const s=null!==(n=f(t,rW))&&void 0!==n?n:null,a=null!==(o=f(t,lB))&&void 0!==o?o:null,c=null!==(i=g(t,HH))&&void 0!==i?i:null
this.currentReferral={id:`${e}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,kind:c,refUrl:null},isActive:!1,productPageExtensionInfo:null}}setReferralDataForProductPageExtensionIfNecessary(e){var t,o
if(!this.isMetricsReferralContextRequired)return
const i=f(e,QG),s=f(e,rF)
if(!OW.isProductPageExtension(e)||!OW.isValidPageEvent(e)||r(i)||r(s))return
const a=null!==(t=f(e,WB))&&void 0!==t?t:null,c=f(e,kR)
let l
switch(c){case vS:l=y(n(e,mS))
break
case OR:l=y(n(e,yS))
break
default:l={}}const u=null!==(o=f(e,zB))&&void 0!==o?o:null
this.currentReferral={id:`${i}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,refUrl:u,kind:{name:c,context:l}},isActive:!1,productPageExtensionInfo:{productId:i}},this.addReferralContextToMetricsFieldsIfNecessary(e)}beginReferralContextForPageIfNecessary(e){this.isMetricsReferralContextRequired&&OW.isValidPageEvent(e)&&OW.isReferralForEvent(this.currentReferral,e)&&null!==this.currentReferral&&(this.currentReferral.isActive=!0)}endReferralContextIfNecessaryForPageEvent(e){this.isMetricsReferralContextRequired&&OW.isValidPageEvent(e)&&OW.isReferralForEvent(this.currentReferral,e)&&(this.currentReferral=null)}addReferralContextToMetricsFieldsIfNecessary(e){var t
this.isMetricsReferralContextRequired&&(e[kW.referralContextEventField]=null===(t=this.currentReferral)||void 0===t?void 0:t.id)}removeReferralContextInfoFromMetricsEvent(e){this.isMetricsReferralContextRequired&&delete e[kW.referralContextEventField]}addReferralDataToEventIfNecessary(e){if(!r(this.activeReferralData)&&OW.shouldAddReferralDataToEvent(e)&&(!OW.isEventDetailsClickEvent(e)||this.isEventDetailClickEventOverrideNecessary)&&(OW.isEventDetailsClickEvent(e)&&(e[rV]=vB),e[rF]=this.activeReferralData.extRefApp2,e[WB]=this.activeReferralData.extRefUrl2,s(this.activeReferralData.refUrl)&&(e[zB]=this.activeReferralData.refUrl),null!==this.activeReferralData&&null!==this.activeReferralData.kind))switch(e[kR]=this.activeReferralData.kind.name,e[kR]){case vS:e[mS]=this.activeReferralData.kind.context
break
case OR:e[yS]=this.activeReferralData.kind.context}}}kW.referralContextEventField="referralContextId"
class OW{static isProductPageExtension(e){return f(e,rW)===OW.productPageExtensionAppId}static isValidPageEvent(e){const t=f(e,rV)
return!(0,Jv.isNothing)(t)&&OW.validPageEventTypes.has(t)}static isReferralForEvent(e,t){var n
if(r(e))return!1
const o=t[kW.referralContextEventField],s=f(t,QG)
return i(o)?o===e.id:!(!OW.isProductPageExtension(t)||!i(s))&&s===(null===(n=null==e?void 0:e.productPageExtensionInfo)||void 0===n?void 0:n.productId)}static shouldAddReferralDataToEvent(e){return e.eventType!==OG||this.isEventDetailsClickEvent(e)}static isEventDetailsClickEvent(e){if(e.eventType!==OG)return!1
const t=e.location,n=null==t?void 0:t[0]
return i(n)&&n.locationType===vB}}OW.productPageExtensionAppId=wy,OW.eventDetailsPageType=vB,OW.validPageEventTypes=new Set([NV,ZM,OW.eventDetailsPageType]),Qv=e(900)
class EW{constructor(e){this.$kind="ActionMetrics",this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}const RW={AdInteractionAction:"AdInteractionAction",AdTransparencyAction:"AdTransparencyAction",AlertAction:"AlertAction",AppLaunchTrampolineAction:"AppLaunchTrampolineAction",ArcadeAction:Fy,ArcadeLaunchAttributionAction:"ArcadeLaunchAttributionAction",ArcadePackOfferAction:"ArcadePackOfferAction",ArcadeSeeAllGamesPageSegmentChangeAction:"ArcadeSeeAllGamesPageSegmentChangeAction",ArcadeSubscriptionStateAction:"ArcadeSubscriptionStateAction",BlankAction:"BlankAction",CancelPreorderAction:"CancelPreorderAction",ClearAppUsageDataAction:"ClearAppUsageDataAction",ClearSearchHistoryAction:"ClearSearchHistoryAction",CompoundAction:Ny,CopyTextAction:"CopyTextAction",CreateCalendarEventAction:"CreateCalendarEventAction",CrossfireReferralAction:"CrossfireReferralAction",EngagementToggleAction:"EngagementToggleAction",ExternalUrlAction:By,FamilyCircleAction:"FamilyCircleAction",FlowAction:fL,FlowBackAction:"FlowBackAction",GameCenterAchievementsAction:"GameCenterAchievementsAction",GameCenterDashboardAction:"GameCenterDashboardAction",GameCenterDenylistPlayerAction:"GameCenterDenylistPlayerAction",GameCenterInvitePlayerAction:"GameCenterInvitePlayerAction",GameCenterPlayerProfileAction:"GameCenterPlayerProfileAction",GSKWrappedAction:"GSKWrappedAction",GuidedSearchTokenToggleAction:"GuidedSearchTokenToggleAction",HttpAction:"HttpAction",HttpTemplateAction:"HttpTemplateAction",InAppPurchaseAction:"InAppPurchaseAction",InvalidateAllWidgetsAction:"InvalidateAllWidgetsAction",LegacyGameCenterInvitePlayerAction:"LegacyGameCenterInvitePlayerAction",OfferAction:Uy,OfferAlertAction:Gy,OfferConfirmationAction:jy,OfferStateAction:sO,OpenAppAction:"OpenAppAction",OpenGamesUIAction:"OpenGamesUIAction",PageFacetsChangeAction:"PageFacetsChangeAction",PageTabChangeAction:"PageTabChangeAction",ProductPageScrollAction:Vy,RateLimitedAction:"RateLimitedAction",ReportConcernAction:"ReportConcernAction",ReviewSummaryReportConcernAction:"ReviewSummaryReportConcernAction",ScrollingAlertAction:"ScrollingAlertAction",SearchAction:"SearchAction",SearchAdAction:Hy,SearchEntityChangeAction:"SearchEntityChangeAction",SearchSegmentChangeAction:"SearchSegmentChangeAction",SelectAppAction:"SelectAppAction",ShareSheetAction:"ShareSheetAction",SheetAction:"SheetAction",ShelfBasedPageScrollAction:qy,ShowSettingsAction:"ShowSettingsAction",TabBadgeAction:"TabBadgeAction",TabChangeAction:aO,WriteReviewAction:"WriteReviewAction"},{FlowAction:DW,..._W}=RW,LW={..._W,flowAction:Wy}
class MW{constructor(){this.title=void 0,this.artwork=void 0,this.presentationStyle=[],this.actionMetrics=new EW}}class xW extends MW{constructor(){super(...arguments),this.$kind="BlankAction",this.actionClass="BlankAction"}}const $W="x-as3-internal",FW=H_,NW="itms-appss",BW="itms-apps",UW=hy,GW=py,jW="appstore-ui",VW={shelf:IW,store:"WebObjects/MZStore.woa/wa",storeElements:"WebObjects/MZStoreElements.woa/wa",lookup:ik,docTypeLookup:"docTypeLookup",install:Ax,grouping:"viewGrouping",viewArtist:"viewArtist",viewSoftware:"viewSoftware",today:tW,arcade:pW,arcadeUpsellPreview:"arcadeUpsellPreview",arcadeSeeAllGames:wG,arcadeSeeAllGamesLoadMore:"arcadeSeeAllGamesLoadMore",genre:_H,viewGenre:AL,recommendationsSeeAll:"recommendationsSeeAll",screenshots:nW,room:"viewRoom",multiRoom:"viewMultiRoom",charts:dN,product:rW,game:"game",siri:DE,productBundle:sk,developer:VH,artist:WS,ratings:Z_,reviews:qq,viewReviews:"viewContentsUserReviews",personalizedReviews:"personalizedReviews",article:Eq,story:oG,editorialItem:Ij,viewEditorialItem:oT,todayCardPreview:"todayCardPreview",mso:$N,resetAndRedirect:"resetAndRedirect",account:bH,personalizationTransparency:I$,href:CG,eula:XU,tvEula:"tv-eula",privacyPolicy:yP,safetyCompliance:"safety-compliance",appsForYou:"apps-for-you",storeFront:"storeFront",tab:"tab",searchLandingPage:"searchLandingPage",searchTrendingApps:"searchTrendingApps",privacyDetail:wD,privacyDefinitions:TP,reportAProblem:"reportaproblem.apple.com/store",gameCenterProfile:tk,onDeviceRecommendations:"onDeviceRecommendations",editorialPage:"editorialPage",accessibilityDetails:IB,test:tP,shelfTypes:"shelfTypes",groupingTest:tV,builtIn:"builtIn",shelfTextTest:"shelfText",shelfLockupsTest:"shelfLockups",shelfMiscTest:"shelfMisc",lockupTest:"lockupTest",articleTestArtwork:"articleArtworkTest",articleTestSingleAppIcon:"articleSingleAppIconTest",articleTestSingleAppIconHeroArt:"articleSingleAppIconHeroArtTest",articleTestBrandedApp:"articleBrandedAppTest",articleTestMultiAppTwo:"articleMultiAppTwoTest",articleTestMultiAppThree:"articleMultiAppThreeTest",articleTestGrid:"articleGridTest",articleTestInAppPurchase:"articleInAppPurchaseTest"},HW="storepreview.apple.com",qW=kH,WW=GC,zW=wG,YW="familyCircle",JW="spamBlockingExtensions",KW=KT,ZW="launchApp",QW="sharePlayApps",XW="buddyOnboarding",ez=new Set([HW,"preview.apps.apple.com"]),tz={id:"id",ids:"ids",productVariantID:jU,countryCode:"cc",language:"l",featuredContentId:"fcId",fetchData:"fetchData",isTodaySection:"isTodaySection",isTodayFeedPreview:"isTodayFeedPreview",genre:_H,bundleIdentifier:"bundleIdentifier",bundleId:kq,offerName:lj,charts:dN,ages:dB,chart:gq,types:fN,v0:"v0",action:cq,type:jV,context:_R,isArcade:aR,isSubscribed:"isSubscribed",isTrialAvailable:"isTrialAvailable",isTrialEnrolled:"isTrialEnrolled",groupingFeaturedContentId:"groupingFeaturedContentId",editorialPageShelfType:"editorialPageShelfType",nativeGroupingShelfId:"nativeGroupingShelfId",isArcadeSeeAllGamesShelf:"isArcadeSeeAllGamesShelf",isGameCenterActivityFeedShelf:"isGameCenterActivityFeedShelf",isGameCenterPlayerShelf:"isGameCenterPlayerShelf",isGameCenterPlayerRibbonItem:"isGameCenterPlayerRibbonItem",isGameCenterAchievementsShelf:"isGameCenterAchievementsShelf",isGameCenterContinuePlayingShelf:"isGameCenterContinuePlayingShelf",isGameCenterPopularWithYourFriendsShelf:"isGameCenterPopularWithYourFriendsShelf",isGameCenterSuggestedFriendsShelf:"isGameCenterSuggestedFriendsShelf",isGameCenterReengagementShelf:"isGameCenterReengagementShelf",isOnDeviceRecommendationsShelf:"isOnDeviceRecommendationsShelf",isOnDeviceSearchHistoryShelf:"isOnDeviceSearchHistoryShelf",isSearchFocusHeaderShelf:"isSearchFocusHeaderShelf",isArcadeDownloadPackShelfPlaceholder:"isArcadeDownloadPackShelfPlaceholder",onDeviceRecommendationsUseCase:"onDeviceRecommendationsUseCase",onDevicePersonalizationUseCase:K$,isPurchasesApp:"isPurchasesApp",isViewOnly:JO,includeUnlistedApps:"includeUnlistedApps",enabled:xT,href:CG,recoMetrics:"recoMetrics",showingFallbackMedia:"showingFallbackMedia",path:"path",useReleaseId:"useReleaseId",clientIdentifierOverride:lS,subscribePageMessage:zF,editorialItem:Ij,askToBuyId:"askToBuyId",appId:"appId",isPPT:"isPPT",sort:rH,grouping:tV,code:cB,includePostSubscribeAttribution:"includePostSubscribeAttribution",campaignToken:"ct",providerToken:"pt",qToken:yk,advertisementId:Ak,token:fV,parseContext:"parseContext",privacyTypeId:"privacyTypeId",requestDescriptor:"requestDescriptor",ageRating:Fq,controllerSupport:BO,multiplayerSupport:"multiplayerSupport",comingSoon:$L,binCompatGames:"binCompatGames",gamePreviews:"gamePreviews",offerHints:"offerHints",invalidateWidgetsOnFailure:zA,metrics:_j,appEventId:"eventid",offerItemId:"offerItemId",appEventDeepLink:OL,useCaseShort:"uc",collectionId:"collection-id",seedId:"seed-id",isShelfWithAd:"isShelfWithAd",shelfWithAdPlacementType:"shelfWithAdPlacementType",shelfRefreshType:"refreshType",isPreloading:"isPreloading",name:AW,shelfType:"shelfType",shelfId:"shelfId",onbaordingCardIds:"onboardingCardIds",preview:iT,todayCardConfig:"todayCardConfig",experimentId:vD,shortEditorialNotes:N$,arcadeSubscriptionStatus:"subscriptionStatus",webBrowser:yx,webBrowserFlowType:XP,editorialPageId:"editorialPageId",editorialCardId:"filter[canvas:cardId]",filterRecommendable:"filter[recommendable]",deviceFamily:PI},nz="inAppPurchaseId",rz="productUrl",oz=NM,iz="minExternalVersionId",sz=HV,az=rH,cz="availableAdamIds",lz=rW,uz=qq,dz="productPageSimilarItems",fz=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,hz=/([^=?&]+)=?([^&]*)/g,pz=[Yx,vj,SV,eG]
class wz{constructor(e){if(this.query={},!e)return
let t=e
const n=fz.exec(e)
if(n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:void 0}
for(const e of pz){if(!r.remainder)break
switch(e){case Yx:r=b(r.remainder,"#",Q_),this.hash=r.result
break
case vj:r=b(r.remainder,"?",Q_),r.result&&(this.query=wz.queryFromString(r.result))
break
case SV:r=b(r.remainder,"/",Q_),r.result&&(this.pathname="/"+r.result)
break
case eG:if(r.remainder){const e=b(r.remainder,"@",Tk),t=e.result,n=e.remainder
if(t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this
switch(e===vj&&typeof t===zq&&(t=wz.queryFromString(t)),e){case Wj:this.protocol=t
break
case bk:this.username=t
break
case Sk:this.password=t
break
case Pk:this.port=t
break
case SV:this.pathname=t
break
case vj:this.query=t
break
case Yx:this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case Wj:return this.protocol
case bk:return this.username
case Sk:return this.password
case Pk:return this.port
case SV:return this.pathname
case vj:return this.query
case Yx:return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if(e===vj)typeof t===zq&&(t=wz.queryFromString(t)),r=typeof n===zq?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if(e===SV){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(SV,e)}pathExtension(){var e
if((0,Zv.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}popPathComponent(){if(!this.pathname)return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),this.query&&Object.keys(this.query).length&&(e+="?"+wz.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=hz.exec(e)
for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=hz.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new wz(e)}static fromComponents(e,t,n,r,o){const i=new wz
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}const gz=[FW,BW,NW,"itms-messages","itms-messagess","itms-watch","itms-watchs","macappstore","macappstores","com.apple.tvappstore",UW,GW]
class vz{constructor(e){var t
this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={}
return e.forEach((e,n)=>{C(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[]
if(!e)return t
for(const n of e){const e=n.split("=")
let r=e[0]
const o=-1!==r.indexOf("?")
r=r.replace("?","")
const i=-1!==r.indexOf(Ik)
r=r.replace(Ik,"")
let s=null
e.length>1&&(s=decodeURIComponent(e[1])),t.push({key:r,value:s,optional:o,caseInsensitive:i})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map(function(e){return new vz(e)}):this._exclusions=null}matches(e){var t,n
if(this._regex){if(!this._regex.length)return!1
let t=!1
for(const n of this._regex)if(n.test(e.toString())){t=!0
break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1
if(this._hostName&&e.host!==this._hostName)return!1
if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents()
if(t.length!==n.length)return!1
const r=t.length
for(let e=0;e<r;e++){const r=t[e]
if(!C(r)&&r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1
if(this._query)for(const r of this._query){let o
if(r.caseInsensitive)for(const[n,i]of Object.entries(null!==(t=e.query)&&void 0!==t?t:{}))r.key.toLocaleLowerCase()===n.toLocaleLowerCase()&&(o=i)
else o=null===(n=e.query)||void 0===n?void 0:n[r.key]
if(!o&&!r.optional)return!1
if(r.value&&r.value!==o)return!1}if(this._hash&&e.hash!==this._hash)return!1
if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?")
if(t.matches(e))return!1}return!0}extractParameters(e){var t,n
const r={}
if(null!==this._pathComponents&&null!==this._pathParameterMap){const t=e.pathComponents()
for(const e of Object.keys(this._pathParameterMap)){const n=k(e),o=O(t[this._pathParameterMap[e]],e)
r[n]=decodeURIComponent(o)}}if(this._query)for(const o of this._query)r[o.key]=null!==(n=null===(t=e.query)||void 0===t?void 0:t[o.key])&&void 0!==n?n:void 0
return r}}class mz{constructor(){this._routeMappings=[]}associate(e,t){const n=[]
for(const t of e)n.push(new vz(t))
this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===zq?new wz(e):e
t=function(e){let t=typeof e===zq?new wz(e):e
if(!I(t))return t
const n=t.query,r=null==n?void 0:n[eW]
return(!t.host||0===t.host.length)&&null!=r&&(t=new wz(r),(null==n?void 0:n[QR])&&(t=t.append(vj,{dsid:n[QR]})),(null==n?void 0:n[Ck])&&(t=t.append(vj,{signatureResumption:n[Ck]}))),wz.fromComponents(FW,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){var t,n,r
const o=typeof e===zq?new wz(e):e
if(!I(o))return o
const i=o.build()
let s,a=(0,Zv.isNothing)(o.query)?void 0:S(o.query)
const c={},l=[{key:"MZSearch.woa",action:Rq},{key:Rq,action:Rq},{key:"buyLandingPage",action:QF},{key:"buyCharityGiftWizard",action:Zy},{key:"longUrlHandler",action:kk},{key:gL,action:gL}],u={"accessory-lookup":"accessoryLookup","finance-app":bH,viewEula:XU,software:yW,primaryTerm:Rq}
let d=!1
for(const e of Object.keys(c))if(o.host&&-1!==o.host.indexOf(e)){d=!0,s=c[e]
break}let f=!1
for(const e of l){const t=e.key
if(o.pathname&&-1!==o.pathComponents().indexOf(t)){f=!0,s=e.action,void 0!==(null==a?void 0:a[t])&&delete a[t]
break}}for(const e of Object.keys(u)){const r=void 0!==(null===(t=o.query)||void 0===t?void 0:t[e])&&null!==o.query[e],i=(null===(n=o.query)||void 0===n?void 0:n[cq])&&-1!==o.query[cq].indexOf(e)
if(r||i){s=u[e],void 0!==(null==a?void 0:a[e])&&delete a[e]
break}}if(s===bH&&-1!==i.indexOf(Ok)&&(s="addToPassbook",void 0!==a&&delete a[Ok]),s){const e=null,t=null,n={action:s}
s===ZF&&void 0!==a&&(a[cB]||a[Ek])?n[cB]=a[cB]||a[Ek]:s!==bH&&s!==gL&&s!==kk||!f&&!d||(n[pL]=o.toString())
const i=null===(r=o.query)||void 0===r?void 0:r[lO]
return s===Rq&&void 0!==i&&void 0!==a&&(a[lO]=i),a={...a,...n},wz.fromComponents(o.protocol,t,e,a,o.hash)}return o}(t)
for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier}
return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}const yz=Symbol("PromiseResult")
class Az extends Error{constructor(e){super(function(e){return e.map(e=>e instanceof Error?e.message:JSON.stringify(e)).join("")}(e)),this.reasons=e,this.reasons=e}}class Tz extends Error{constructor(e){super(e.message),this.reason=e,this.reason=e}}Xv=e(4876)
class bz{constructor(e,t,n,r,o,i){this.$kind="Artwork",this.checksum=null,this.backgroundColor=null,this.textColor=null,this.style=null,this.crop="bb",this.contentMode=null,this.imageScale=null,this.template=e,this.width=t,this.height=n,this.variants=r,this.backgroundColor=o,this.textColor=i}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return""!==this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class Sz{constructor(e){this.$kind="ImpressionableArtwork",this.art=e}}!function(e){e.Density1="density_1",e.Density2="density_2",e.Density3="density_3"}(em||(em={})),function(e){e[e.scaleToFill=0]="scaleToFill",e[e.scaleAspectFit=1]="scaleAspectFit",e[e.scaleAspectFill=2]="scaleAspectFill",e[e.redraw=3]="redraw",e[e.center=4]="center",e[e.top=5]="top",e[e.bottom=6]="bottom",e[e.left=7]="left",e[e.right=8]="right",e[e.topLeft=9]="topLeft",e[e.topRight=10]="topRight",e[e.bottomLeft=11]="bottomLeft",e[e.bottomRight=12]="bottomRight"}(tm||(tm={}))
class Pz{constructor(e,t,n,r,o,i,s){this.$kind="MediaPlatform",this.appPlatform=e,this.supplementaryAppPlatforms=r||[],this.deviceCornerRadiusFactor=o,this.mediaType=t,this.systemImageName=n,this.deviceBorderThickness=i,this.outerDeviceCornerRadiusFactor=s}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort()
const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",")
return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&e.systemImageName===this.systemImageName&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class Iz{constructor(e,t){this.$kind="Trailers",e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0}}class Cz{constructor(e,t,n){this.$kind="Video",this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class kz{constructor(){this.$kind="ProductMediaItem"}}class Oz{constructor(e,t,n,r,o,i){this.$kind="ProductMedia",this.items=e,this.mediaPlatform=t,this.allPlatforms=n,this.platformDescription=r,this.allPlatformsDescription=o,this.allPlatformsDescriptionPlacement=i}}class Ez{constructor(e,t){this.$kind="Screenshots",this.artwork=e,this.mediaPlatform=t}}class Rz{constructor(e,t,n,r){this.fileSizeByDevice=e,this.maxDownloadSizeInBytes=t,this.maxInstallSizeInBytes=n,this.maxEssentialInstallSizeInBytes=r}}class Dz{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new Dz(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}const _z=nL,Lz="com.apple.AppStore.BridgeStoreExtension",Mz=fy,xz=hy,$z=py,Fz="com.apple.TVAppStore.AppStoreTopShelfExtension",Nz="com.apple.Arcade.ArcadeTopShelfExtension",Bz=wy,Uz=gy,Gz="com.apple.AppStore.Widgets",jz=zk,Vz="VisionAppStore",Hz=(0,Qv.makeMetatype)("app-store:storeMetrics"),qz=(0,Qv.makeMetatype)("app-store:amsEngagement"),Wz=(0,Qv.makeMetatype)("app-store:device"),zz=(0,Qv.makeMetatype)("app-store:user"),Yz=(0,Qv.makeMetatype)("games:player"),Jz=(0,Qv.makeMetatype)("app-store:metricsIdentifiers"),Kz=(0,Qv.makeMetatype)("app-store:arcade"),Zz=(0,Qv.makeMetatype)("app-store:gameCenter"),Qz=(0,Qv.makeMetatype)("app-store:resilientDeepLinks"),Xz=(0,Qv.makeMetatype)("app-store:ads"),eY=(0,Qv.makeMetatype)("app-store:onDeviceRecommendationsManager"),tY=(0,Qv.makeMetatype)("app-store:onDeviceSearchHistoryManager"),nY=(0,Qv.makeMetatype)("app-store:mediaTokenService"),rY=(0,Qv.makeMetatype)("app-store:adsLocalizer"),oY=(0,Qv.makeMetatype)("app-store:appDistribution"),iY=(0,Qv.makeMetatype)("app-store:timeoutManager"),sY=(0,Qv.makeMetatype)("app-store:treatmentStore"),aY=(0,Qv.makeMetatype)("app-store:userDefaults"),cY="_jet-internal:derived-data",lY={artwork:zx,iconArtwork:K_,screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:wB,customVideoPreviewsByTypeForAd:PE,customDeepLink:Z$}
class uY{constructor(e){this.implementation=e}}class dY{constructor(){this.clearCache=()=>{this.cache={}},this.cache={}}get(e,t){return t()}}const fY=_z,hY=Lz,pY=Mz,wY=$z,gY=xz,vY=Bz
class mY extends uY{get buildType(){return mY.cache.get("buildType",()=>this.implementation.buildType)}get buildVersion(){return this.implementation.buildVersion}get deviceType(){return mY.cache.get("deviceType",()=>this.implementation.deviceType)}get guid(){return this.implementation.guid}get isActivityAvailable(){return this.implementation.isActivityAvailable}get isElectrocardiogramInstallationAllowed(){return this.implementation.isElectrocardiogramInstallationAllowed}get isScandiumInstallationAllowed(){return this.implementation.isScandiumInstallationAllowed}get isSidepackingEnabled(){return this.implementation.isSidepackingEnabled}get isTinkerWatch(){return mY.cache.get("isTinkerWatch",()=>this.implementation.isTinkerWatch)}get screenCornerRadius(){return mY.cache.get("screenCornerRadius",()=>this.implementation.screenCornerRadius)}get screenSize(){return mY.cache.get("screenSize",()=>Dz.fromNativeSize(this.implementation.screenSize))}get storefrontIdentifier(){return this.implementation.storefrontIdentifier}get supportsHEIF(){return mY.cache.get("supportsHEIF",()=>this.implementation.supportsHEIF)}get thinnedApplicationVariantIdentifier(){return mY.cache.get("thinnedApplicationVariantIdentifier",()=>this.implementation.thinnedApplicationVariantIdentifier)}get isMandrakeSupported(){return this.implementation.isMandrakeSupported}get isCharonSupported(){return this.implementation.isCharonSupported}get maxAppContentRating(){return this.implementation.maxAppContentRating}get hostBundleId(){return mY.cache.get("hostBundleId",()=>this.implementation.hostBundleId)}isPairedSystemVersionAtLeast(e){var t,n,r
return null!==(r=null===(n=(t=this.implementation).isPairedSystemVersionAtLeast)||void 0===n?void 0:n.call(t,e))&&void 0!==r&&r}deletableSystemAppCanBeInstalledOnWatchWithBundleID(e){return this.implementation.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}deviceHasCapabilities(e){return this.implementation.deviceHasCapabilities(e)}deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t){return(!this.isPad||!e.includes("healthkit"))&&this.implementation.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t)}hasEligibilityDomain(e){return this.implementation.hasEligibilityDomain(e)}contextForEligibilityDomain(e){return this.implementation.contextForEligibilityDomain(e)}isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n){return this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}canDevicePerformAppActionWithAppCapabilities(e,t){return this.implementation.canDevicePerformAppActionWithAppCapabilities(e,t)}isAutomaticDownloadingEnabled(){return this.implementation.isAutomaticDownloadingEnabled()}isAuthorizedForUserNotifications(){return this.implementation.isAuthorizedForUserNotifications()}isActivePairedWatchSystemVersionBelow(e){const t=e.split("."),n=h(t[0])||0,r=h(t[1])||0,o=h(t[2])||0
return!this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(n,r,o)}get isPhone(){return this.deviceType===lW}get isPad(){return this.deviceType===oW}get isiOS(){return this.isPhone||this.isPad}get isMac(){return this.deviceType===vW}get isTV(){return"tv"===this.deviceType}get isWatch(){return this.deviceType===gW}get isVision(){return this.deviceType===iW}get isWeb(){return this.deviceType===BV}get isCompanionVisionApp(){return this.hostBundleId===zk}get remoteDownloadIdentifiers(){return this.implementation.remoteDownloadIdentifiers}}mY.type=(0,Qv.makeMetatype)("app-store:client-wrapper"),mY.cache=new dY
class yY{constructor(e,t,n,r){var i
this.contentsResourceTypes=new Set,this.ids=new Set,this.idsByResourceType=new Map,this.originalOrdering=[],this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.supplementaryMetadataAssociations=[],this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.countryCodeOverride=void 0,this.objectGraph=e,this.platform=K(e),this.isMixedMediaRequest=null!=n&&n,this.supplementaryMetadataAssociations=null!=r?r:[],this.includeAppBinaryTraitsAttribute=!0,(null===(i=e.activeIntent)||void 0===i?void 0:i.platform)&&(this.platform=e.activeIntent.platform),o(t)||(typeof t===zq?this.href=t:Array.isArray(t)&&this.withDataItems(t,r,n))}addDataToIDsByResourceType(e){const t=e.type,n=e.id
let r=this.idsByResourceType.get(t);(0,Zv.isNothing)(r)&&(r=new Set),r.add(n),this.idsByResourceType.set(t,r)}forType(e){return this.resourceType=e,this}withDataItems(e,t,n){if(0===e.length)return this
this.isMixedMediaRequest=this.isMixedMediaRequest||null!=n&&n
for(const r of e)if(this.ids.add(r.id),this.addDataToIDsByResourceType(r),(0,Zv.isSome)(n)&&n&&(0,Zv.isSome)(t)&&t.length>0)for(const e of t){const t=re(e,r);(0,Zv.isSome)(t)&&t.length>0&&t.forEach(e=>{this.addDataToIDsByResourceType(e)})}return 1===this.idsByResourceType.size?(this.resourceType=this.idsByResourceType.keys().next().value,this.isMixedMediaRequest=!1):this.idsByResourceType.size>1&&!this.isMixedMediaRequest&&(this.resourceType=mW,this.contentsResourceTypes=new Set(Array.from(this.idsByResourceType.keys()))),this.originalOrdering.push(...e),this}withIdOfType(e,t){return this.withDataItems([{id:e,type:t}])}withIdsOfType(e,t){return this.withDataItems(e.map(e=>({id:e,type:t})))}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingViews(e){this.viewsIncludes||(this.viewsIncludes=new Set)
for(const t of e)this.viewsIncludes.add(t)
return this}includingKindsKeys(e,t){this.kindIncludes||(this.kindIncludes=new Map)
let n=this.kindIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.kindIncludes.set(e,n),this}includingAssociateKeys(e,t){this.associateIncludes||(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t=RV
if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get(sW)
e||(e=new Set),e.add(t),this.scopedRelationshipIncludes.set(sW,e)}else this.relationshipIncludes.add(t)
{this.metaIncludes||(this.metaIncludes=new Map)
let e=this.metaIncludes.get(RV)
e||(e=new Set),e.add(_j),this.metaIncludes.set(RV,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAgeRestrictions(){const e=this.objectGraph.client.maxAppContentRating
return e<1e3&&(this.ageRestriction=e),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){this.scopedAvailableInIncludes||(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return this.scopedSparseLimit||(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return(0,Zv.isSome)(t)?this.additionalQuery[e]=t:delete this.addingQuery[e],this}addingQueryValues(e){return this.additionalQuery={...this.addingQuery,...e},this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return this.objectGraph.appleSilicon.isSupportEnabled&&(e||this.enablingFeature(XD),this.includingScopedAttributes(yW,[gR])),this}includingAppBinaryTraitsAttribute(e=!0){return this.includeAppBinaryTraitsAttribute=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!i(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}withCountryCodeOverride(e){return this.countryCodeOverride=e,this}}const AY=(e,t)=>e||t,TY=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])?"),bY=Ae(0,0,0),SY=Ae(1,1,1),PY="FBEF7E28-E3DF-4484-A7D7-2FE19E43D2B8",IY="21FD31A2-0631-4100-9942-D368B43F00C5",CY="9C29E652-9774-4219-9BEB-9414597AD175",kY="4198D0D5-B34F-4EA5-B3C6-99C90C7732B8";(iy=nm||(nm={})).ArcadeDownloadPackOnboarding="Tf5Kjqz",iy.CondensedTodayAds="tBc9hUt",iy.ProductPagePreloading="m0henFo",iy.ProductPageVariants="fNPb5Km",iy.ProductPageYMALRowCount="isj11bm",iy.SearchLandingPage="WqjkRLH",iy.SearchResultsAdBackground="Zh4zkDd"
class OY{constructor(){this.cachedTreatments={},this.cachedRawTreatments={}}async loadTreatments(e){const t=this.experimentAreasForPlatform(e)
if(t.length>0)try{this.cachedRawTreatments=await e.treatmentStore.treatmentsForAreas(t)
for(const[e,t]of Object.entries(this.cachedRawTreatments)){const n=t.identifier
this.cachedTreatments[e]={...t,identifier:n.split(":")[0]}}}catch(t){e.console.error("Failed to load treatments",t)}}currentTreatmentForExperiment(e){return this.cachedTreatments[e]}createAb2Data(){const e=[]
for(const[t,n]of Object.entries(this.cachedRawTreatments))e.push({areaId:t,bucket:-2,treatmentId:n.identifier})
return e}experimentAreasForPlatform(e){const t=[]
switch(e.client.deviceType){case lW:case oW:t.push(nm.ArcadeDownloadPackOnboarding,nm.CondensedTodayAds,nm.ProductPagePreloading,nm.ProductPageVariants,nm.ProductPageYMALRowCount,nm.SearchLandingPage,nm.SearchResultsAdBackground)}return t}}OY.metatype=(0,Qv.makeMetatype)("app-store:experimentCache")
const EY="3NepyQj01",RY=Gq
let DY=null
!function(e){e[e.None=0]="None",e[e.ThirtyTwoBit=2]="ThirtyTwoBit",e[e.UnsupportedSystemDeletableApps=4]="UnsupportedSystemDeletableApps",e[e.UnsupportedWatchAppOnWatchClient=8]="UnsupportedWatchAppOnWatchClient",e[e.DisabledMerchandisableIAPs=16]="DisabledMerchandisableIAPs",e[e.LegacyApps=32]="LegacyApps",e[e.LegacyProductionMacOSInstaller=64]="LegacyProductionMacOSInstaller",e[e.UnsupportedPlatform=128]="UnsupportedPlatform",e[e.UnsupportedPreorders=256]="UnsupportedPreorders",e[e.MinimumOSRequirement=512]="MinimumOSRequirement",e[e.SADWatchApps=1024]="SADWatchApps",e[e.MinimumCompanionOSRequirement=2048]="MinimumCompanionOSRequirement",e[e.MacOSCompatibleIOSBinary=4096]="MacOSCompatibleIOSBinary",e[e.MacOSRosetta=8192]="MacOSRosetta",e[e.UnsupportedPlatformForMacCharts=16384]="UnsupportedPlatformForMacCharts",e[e.VisionOSCompatibility=32768]="VisionOSCompatibility",e[e.SADMinimumOSRequirement=65536]="SADMinimumOSRequirement",e[e.DeveloperPage=76532]="DeveloperPage",e[e.Offers=77238]="Offers",e[e.TodayCard=76670]="TodayCard",e[e.Search=10750]="Search",e[e.Bundles=76286]="Bundles",e[e.Charts=68606]="Charts",e[e.ChartsMac=84862]="ChartsMac",e[e.All=80894]="All"}(rm||(rm={}))
const _Y=[Uq,Bq,vW,iW,gW,"tv"]
class LY{constructor(){this.$kind="LockupContextMenuData"}}const MY={Lockup:Ty,InAppPurchaseLockup:Jk,MixedMediaLockup:Kk,PosterLockup:Zk,ProductPage:Qk,ScreenshotsLockup:Xk,TrailersLockup:eO,UpdatesLockup:oL}
class xY{constructor(e){this.$kind=null!=e?e:Ty}isValid(){return!!this.title&&!(!this.icon||!this.icon.isValid())}}class $Y extends xY{constructor(){super(Jk)}}class FY extends MW{constructor(e,t){super(),this.$kind="flowAction",this.actionClass="FlowAction",this.page=e,this.pageUrl=t,this.pageData=null,this.referrerData=void 0,this.presentationContext=WH,this.animationBehavior=WH,this.origin="inapp"}}class NY{constructor(){this.$kind="PageMetrics",this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n={data:e,invocationPoints:t}
this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class BY{constructor(){this.$kind="InAppPurchaseInstallPage",this.pageMetrics=new NY,this.pageRenderMetrics={}}}class UY extends MW{constructor(e,t,n,r,o){super(),this.$kind="InAppPurchaseAction",this.actionClass="InAppPurchaseAction",this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class GY extends MW{constructor(e){super(),this.$kind="AlertAction",this.actionClass="AlertAction",this.style=e,this.title=void 0,this.message=null,this.isCancelable=!1,this.cancelTitle=null,this.cancelAction=null,this.buttonActions=[],this.buttonTitles=[],this.destructiveActionIndex=null,this.imageName=null}}class jY extends xY{constructor(){super(Xk),this.screenshots=[],this.screenshotsDisplayStyle=YF}isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class VY extends xY{constructor(){super(Zk)}isValid(){const e=this.posterArtwork,t=this.posterVideo
return!(!e&&!t)&&super.isValid()}}class HY extends xY{constructor(){super(eO)}isValid(){return!(!this.trailers||!this.trailers.isValid())&&!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid()}}class qY extends xY{constructor(){super(Kk),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null,this.screenshotsDisplayStyle="control",this.metadataRibbonItems=[],this.showMetadataInformationInLockup=!1,this.alignedRegionArtwork=null,this.alignedRegionVideo=null}}class WY{constructor(e,t,n,r,o=!1){this.$kind="ImageLockup",this.isDark=!1,this.artwork=e,this.lockup=t,this.caption=n,this.title=r,this.isDark=o}isValid(){return this.lockup.isValid()&&this.artwork.isValid()}}class zY{constructor(){this.$kind="ArcadeLockup"}}class YY{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S=!1,P=!1,I=!1){this.$kind="OfferDisplayProperties",this.offerType=e,this.adamId=t,this.bundleId=n,this.parentAdamId=o,this.style=null==r?WH:r,this.environment=null==i?Tq:i,this.offerTint=null==s?{type:cL}:s,this.titles=null==a?{}:a,this.titleSymbolNames=null==c?{}:c,this.subtitles=null==l?{}:l,this.hasInAppPurchases=u,this.hasExternalPurchases=d,this.isDeletableSystemApp=f,this.isFree=h,this.isPreorder=p,this.offerLabelStyle=null==w?Iq:w,this.hasDiscount=g,this.contentRating=v,this.subscriptionFamilyId=m,this.useAdsLocale=y,this.priceFormatted=A,this.isStreamlinedBuy=T,this.appCapabilities=b,this.ignoresContentRestrictions=S,this.isRedownloadDisallowed=P,this.isOpenBundleAllowed=I}newOfferDisplayPropertiesChangingAppearance(e,t,n,r){return new YY(this.offerType,this.adamId,this.bundleId,null==t||!e&&this.style===rG?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.offerTint:r,this.titles,this.titleSymbolNames,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId,this.useAdsLocale,this.priceFormatted,this.isStreamlinedBuy,this.appCapabilities,this.ignoresContentRestrictions,this.isRedownloadDisallowed,this.isOpenBundleAllowed)}}class JY extends MW{constructor(e,t=!0,n=new EW){super(),this.$kind="ExternalUrlAction",this.actionClass="ExternalUrlAction",this.url=e,this.isSensitive=t,this.actionMetrics=n}}class KY{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class ZY extends MW{constructor(e,t){super(),this.$kind="OfferStateAction",this.actionClass="OfferStateAction",this.title=t.title,this.adamId=e,this.defaultAction=t,this.includeBetaApps=!1}}class QY{constructor(e,t,n,r,o,i,s){this.$kind="AdvertActionMetrics",this.instanceId=e,this.adamId=t,this.bundleId=n,this.advertType=r,this.invocation=o,this.purchaseType=i,this.reportingDestination=s}}class XY extends MW{constructor(e){super(),this.$kind="HttpTemplateAction",this.actionClass="HttpTemplateAction",this.message=null,this.url=e,this.method=aB,this.headers={},this.body=null,this.bodyDictionary={},this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class eJ extends XY{}class tJ{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class nJ{constructor(){this.$kind="ProductReview",this.componentType=e$}}class rJ{constructor(){this.$kind="Review"}}class oJ{constructor(){this.$kind="Response"}}class iJ{constructor(e){this.$kind=null!=e?e:"Ratings"}}class sJ{constructor(e,t,n,r,o,i,s){this.$kind="ReviewSummary",this.body=e,this.bodyNoTitle=t,this.subtitle=n,this.subtitleArtwork=r,this.subtitleArtworkAlignment=o,this.bodyMediaType=i,this.flowPreviewActionsConfiguration=s}}class aJ extends iJ{constructor(){super("ProductStarRatings"),this.$kind="ProductStarRatings",this.componentType="starRatings"}}class cJ extends iJ{constructor(){super("ProductStarRatingsHistogram"),this.$kind="ProductStarRatingsHistogram",this.componentType="starRatingsHistogram"}}class lJ extends iJ{constructor(){super("ProductNoRatings"),this.$kind="ProductNoRatings",this.componentType="noRatings"}}class uJ{constructor(){this.$kind="TapToRate",this.componentType=Iy}}class dJ extends MW{constructor(e,t){super(),this.$kind="WriteReviewAction",this.actionClass="WriteReviewAction",this.adamId=e,this.url=t}}class fJ extends xY{constructor(){super(Qk),this.pageMetrics=new NY,this.pageRenderMetrics={}}}const hJ={DynamicGenericPage:"DynamicGenericPage",SearchChartsAndCategoriesPage:"SearchChartsAndCategoriesPage",ShelfBasedProductPage:my}
class pJ{constructor(){this.shelfOrderings={},this.shelfMapping={},this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class wJ extends pJ{constructor(){super(...arguments),this.$kind="ShelfBasedProductPage",this.appPlatforms=[]}}class gJ extends MW{constructor(e,t,n,r,o,i){super(),this.$kind="ShelfBasedPageScrollAction",this.actionClass="ShelfBasedPageScrollAction",this.shelfId=e,this.notPurchasedShelfId=t,this.purchasedShelfId=n,this.adamId=r,this.index=o,this.clicksOnScroll=i}}class vJ extends MW{constructor(e,t){super(),this.$kind="ProductPageScrollAction",this.actionClass="ProductPageScrollAction",this.section=e,this.clicksOnScroll=t}}class mJ{constructor(e,t){this.$kind="ProductPageSection",this.type=e,this.shelfId=t}}!function(e){e.OnPageLoad="onPageLoad",e.OnShelfWillAppear="onShelfWillAppear"}(om||(om={}))
class yJ{constructor(e,t=null,n=null){this.$kind="Shelf",this.impressionMetrics=null,this.contentType=e,this.marker=t,this.items=n||[],this.header=void 0,this.url=null,this.mergeWhenFetched=!1,this.fetchStrategy=om.OnPageLoad,this.batchGroup=null,this.seeAllAction=null,this.footerTitle=null,this.footerAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.footerStyle=null,this.title=void 0,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.rowsPerColumn=null,this.background={type:Iq},this.contentsMetadata={type:Iq},this.isPersonalized=!1,this.shouldFilterApps=!1}}class AJ{constructor(){this.$kind="ReviewsContainer"}}class TJ{constructor(e,t,n,r){this.$kind="ReviewsPageSortOption",this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class bJ{constructor(e,t){this.shelves=e,this.title=void 0,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new NY,this.$kind=null!=t?t:"GenericPage"}}class SJ extends bJ{constructor(){super([],"ReviewsPage")}}const PJ="5BB5F361-F7CA-4BE5-90D4-92A973A38B03",IJ="B77D6B43-8357-42AC-9455-0BC985A4CC20",CJ="3A904FFE-6C7A-43F3-A014-CF750E1CBF5D",kJ="ACEB64F5-C210-4A63-9E78-1FA652ACE3B8",OJ="68BBAC6D-7741-47E0-99CE-5BA3B62E88A7",EJ="DA1A9665-5984-4AB6-B886-100A648F430F",RJ="3263D5D9-4A36-4C59-9B78-1EC9B7E78A1C",DJ="3771A729-28D2-498B-8128-36F745619ED2",_J="CF3F5A4B-4F69-48AB-8FF9-CD6AA8D54A1C",LJ="DADF37D0-D667-4249-BA19-7C4A08E08281",MJ="33A25C07-53BB-4278-8C07-E6D00BE78609",xJ="3E45DDEC-6028-42C5-BA4C-7644C8E9316B",$J="A77D5208-7747-467B-864F-76AC0E8E0DCE",FJ="979360BA-DDB0-4698-BE4F-16072F3BFB9B",NJ="564053BF-441A-44D5-B37C-2D6E112E4956",BJ="9AC2B085-5CE6-45CC-87B5-61F6E1E64541",UJ="C2F1E751-7AC6-4368-917B-52900BA17FE8",GJ="5C63792A-E02C-4266-81BB-5B14330B1477",jJ="61FC0A9A-814D-46FF-AFE2-5D1907893829",VJ="7D0F61A1-4E25-40DF-A258-E028C4DCC5A1",HJ=jx,qJ="A134C61B-1BB0-45BE-B1C8-342ABE5DAACC",WJ=jx,zJ=jx,YJ=jx
class JJ{constructor(e,t,n){this.$kind="ArtworkVariant",this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class KJ{constructor(e,t=null,n=null){this.$kind="FlowPreviewActionsConfiguration",this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class ZJ{constructor(e,t,n){this.$kind="ReportConcernReason",this.reasonId=e,this.name=t,this.uppercaseName=n}}class QJ extends MW{constructor(e,t,n,r){super(),this.$kind="ReviewSummaryReportConcernAction",this.actionClass="ReviewSummaryReportConcernAction",this.concerns=e,this.title=t,this.explanation=n,this.sendAction=r}}class XJ extends MW{constructor(e){super(),this.$kind="HttpAction",this.actionClass="HttpAction",this.url=e,this.method=aB,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class eK extends MW{constructor(e){super(),this.$kind="ReportConcernAction",this.actionClass="ReportConcernAction",this.reasons=e}}class tK extends MW{constructor(e){super(),this.$kind="CopyTextAction",this.actionClass="CopyTextAction",this.text=e}}class nK{static get contentType(){return ix}constructor(){this._params=""}param(e,t){if(e&&t){const n=this._params.length>0?"&":""
this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}class rK extends MW{constructor(e,t=rW){super(),this.$kind="OpenAppAction",this.actionClass="OpenAppAction",this.adamId=e,this.destination=t}}class oK extends MW{constructor(e,t,n){super(),this.$kind="AppLaunchTrampolineAction",this.actionClass="AppLaunchTrampolineAction",this.bundleId=e,this.payloadUrl=t,this.fallbackAction=n}}class iK extends MW{constructor(e){super(),this.$kind="CompoundAction",this.actionClass="CompoundAction"
const t=[]
for(const n of e)(0,Jv.isSome)(n.actionMetrics)&&(this.actionMetrics.addManyMetricsData(n.actionMetrics.data),Object.assign(this.actionMetrics.custom,n.actionMetrics.custom),n.actionMetrics.clearAll()),t.push(n)
this.actions=t}}const sK="jet_adamId",aK="X-AppStore-iAdClickToken",cK="X-AppStore-iAdLineItem",lK="X-AppStore-iAdDismissAdActionMetrics"
class uK{constructor(e={}){this.baseFields=e}}class dK{constructor(e){this.$kind="LintedMetricsEvent",this.fields=e}}class fK{constructor(e){if(this._values={},(0,Zv.isSome)(e)&&e.length>0){const t=e.split("&")
for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=(0,Zv.isNothing)(n)?"":decodeURIComponent(n)
this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length")
return(0,Zv.isNothing)(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t)
return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n)
return(0,Zv.isNothing)(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e=""
for(const t of Object.keys(this._values)){const n=this._values[t]
e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={}
for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n)
e[r]=o}return e}toRawMap(){return{...this._values}}}!function(e){e.client="clientId",e.user="userId",e.canonical="canonicalAccountIdentifierOverride"}(im||(im={})),function(e){e.client="APPSTORE_ENGAGEMENT_CLIENT",e.user="APPSTORE_ENGAGEMENT"}(sm||(sm={})),function(e){e.client="APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT",e.user="APPSTORE_PAYMENTS_ENGAGEMENT"}(am||(am={})),function(e){e.user="APPSTORE_PERSONALIZATION"}(cm||(cm={}))
const hK={[im.client]:{keyType:im.client,bagNamespace:am.client,crossSyncDevice:!1},[im.user]:{keyType:im.user,bagNamespace:am.user,crossSyncDevice:!0}},pK={[im.client]:{keyType:im.client,bagNamespace:sm.client,crossSyncDevice:!1},[im.user]:{keyType:im.user,bagNamespace:sm.user,crossSyncDevice:!0}},wK={[im.user]:{keyType:im.user,bagNamespace:cm.user,crossSyncDevice:!0}}
class gK{constructor(e=pK){this.cachedMetricsIds={},this.cachedMetricsFields={},this.shouldAddDsIdFallbackField=!1,this.userDsId=null,this.identifierContextMapping=e}async loadValues(e,t){e.bag.isMetricsUserIdFallbackEnabled&&!e.user.isUnderThirteen?(this.shouldAddDsIdFallbackField=!0,this.userDsId=e.user.dsid):(this.shouldAddDsIdFallbackField=!1,this.userDsId=null)
const n=[]
for(const r of t){const t=await this.loadValuesForIdType(e,r)
n.push(t)}for(const{idType:e,id:t,fields:r}of n)t&&(this.cachedMetricsIds[e]=t),r&&(this.cachedMetricsFields[e]=r)}async loadValuesForIdType(e,t){const n={idType:t},r=this.identifierContextMapping[t]
if(r){try{const o=await Kv.context("MetricsIdentifiersCache:loadValues:metricsFields",async()=>await e.metricsIdentifiers.getMetricsFieldsForContexts([r]))
if((0,Jv.isSome)(o)){n[r$]=o
const e=o[t];(0,Jv.isSome)(e)&&typeof e===zq&&e.length>0&&(n.id=e)}}catch(n){e.console.error(`Unable to fetch metrics fields for idType ${t}`,n)}if((0,Jv.isNothing)(n.id))try{const t=await Kv.context("MetricsIdentifiersCache:loadValues:metricsIdentifier",async()=>await e.metricsIdentifiers.getIdentifierForContext(r));(0,Jv.isSome)(t)&&(n.id=t)}catch(n){e.console.error(`Unable to fetch metrics identifier for idType ${t}`,n)}}return n}getMetricsIdForType(e){return this.cachedMetricsIds[e]}getMetricsFieldsForTypes(e){const t=e.map(e=>{var t
return null!==(t=this.cachedMetricsFields[e])&&void 0!==t?t:{}}),n=Object.assign({},...t)
return this.shouldAddDsIdFallbackField&&-1!==e.indexOf(im.user)&&this.addDsIdFallbackFieldIfNecessary(n),n}addDsIdFallbackFieldIfNecessary(e){const t=e[im.user];((0,Jv.isNothing)(t)||typeof t!==zq||0===t.length||t.length===gK.clientGeneratedUserIdLength)&&(0,Jv.isSome)(this.userDsId)&&this.userDsId.length>0&&(e[CR]=this.userDsId)}setCanonicalAccountIdentifierOverride(e){e.length>=0&&(this.cachedMetricsFields[im.canonical]={[im.canonical]:e})}}gK.defaultMetatype=(0,Qv.makeMetatype)("app-store:metricsIdentifiersCache"),gK.paymentMetatype=(0,Qv.makeMetatype)("app-store:paymentMetricsIdentifiersCache"),gK.personalizationMetatype=(0,Qv.makeMetatype)("app-store:personalizationMetricsIdentifiersCache"),gK.clientGeneratedUserIdLength=24
class vK{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=f(n,"fieldName")
if(r(t))continue
const o=h(e,t)
if(r(o))continue
let i=h(n,"magnitude")
r(i)&&(i=1048576)
let s=h(n,"significantDigits")
if(r(s)&&(s=2),i<=0||s<0){e[t]=Number.NaN
continue}const a=o/i
e[t]=Rt(a,s)}}_urlScrubbingAdParameters(e){const t=new wz(e)
return t.removeParam(aK),t.removeParam(cK),t.removeParam(lK),t.build()}_urlScrubbingExtRefUrl(e){const t=new wz(e)
return t.username="",t.password="",t.pathname=void 0,t.query=void 0,t.hash=void 0,t.build()}_derezFastImpressions(e){const t=f(e,VN),n=h(e,HN)
if(t===yR){if(4===n){const t=l(e,IH)
e[IH]=t.map(e=>{if((0,Zv.isNothing)(e))return e
const t=l(e,fS)
return 0===t.length||(e[fS]=t.map(e=>{if((0,Zv.isNothing)(e))return e
const t=h(e,"d")
return e.s=0,(0,Zv.isSome)(t)&&(e.d=Rt(t,2)),e})),e})}if(5===n){const t=l(e,IH)
e[IH]=t.map(e=>{if((0,Zv.isNothing)(e))return e
delete e[qM],f(e,WN)!==X$&&(o(f(e,WM))||o(f(e,eF)))&&delete e.id
const t=p(e,hS)
if((0,Zv.isNothing)(t)||o(t))return e
const n=f(e,EG)
return Object.entries(t).forEach(([e,r])=>{const o=l(r)
t[e]=o.map(e=>{if((0,Zv.isNothing)(e))return e
if(n===SR){const t=h(e,"s");(0,Zv.isSome)(t)&&(e.s=Rt(t,3))}else e.s=0
const t=h(e,"d")
return(0,Zv.isSome)(t)&&(e.d=Rt(t,2)),e})}),e[hS]=t,e})}}}_stripContentRatingImpressionFields(e){const t=l(e,IH)
e[IH]=t.map(e=>((0,Zv.isSome)(e)&&(delete e[$U],delete e[kq]),e))}_decorateSearchResultImpressions(e){const t=f(e,rV),n=f(e,QG)
t===VV&&n!==tF&&function(e){const t=l(e,IH)
let n
for(const e of t){const t=f(e,WN)
if((0,Zv.isSome)(e)&&t===sV){n=e[iF]
break}}n&&(e[IH]=t.map(e=>{const t=f(e,WN),r=t===FV||t===f$
return(0,Zv.isSome)(e)&&r&&(e[WR]=n),e}))}(e)}_decorateSearchFocusImpressions(e){const t=f(e,rV),n=f(e,QG)
t===zM&&n===YM&&function(e){var t
const n=l(e,IH)
let r
for(const e of n)if("R8804"===f(e,RN)){r=null!==(t=f(e,iF))&&void 0!==t?t:void 0
break}r&&(e[IH]=n.map(e=>{const t=f(e,RN),n=f(e,WN)
return o(t)&&n===jq&&null!=e&&null==f(e,WR)&&(e[WR]=r),e}))}(e)}_decorateGamesSearchHintClick(e){}_decorateAll(e,t,n){var o,i,s
const a=this._options.bagProvider,c=a("metricsBase",n)
r(c)||typeof c!==vV||Object.assign(t,c),t.clientBuildType=this._options.buildType,t.resourceRevNum=this._options.jsVersion,t.xpSendMethod="jet-js",this._options.buyDecorator.useApp(f(t,rW)),delete t[sK]
const u=function*(e){if((0,Zv.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}}(f(t,pS))
for(const e of u)if("xp_ci"===e.key){this._options.buyDecorator.useClientId(e.value)
break}delete t[pS]
const d=null!==(i=null===(o=e.metricsIdentifiersCache)||void 0===o?void 0:o.getMetricsFieldsForTypes([im.client]))&&void 0!==i?i:{}
Object.assign(t,d),delete t.clientGeneratedId
const h=f(t,rV),p=f(t,QG)
if(!r(h)&&!r(p)){const e=f(a("compoundSeparator",n))||"_"
t[SW]=`${h}${e}${p}`}const w=l(a("deResFields",n))
this._reduceFieldAccuracy(t,w)
const g=[xU,jN,WB,zB,eW,"parentPageUrl"]
for(const e of g){const n=f(t,e);(0,Zv.isSome)(n)&&n.length>0&&(t[e]=e===WB?this._urlScrubbingExtRefUrl(n):this._urlScrubbingAdParameters(n))}const v=f(t,PR)
if((0,Zv.isSome)(v)&&(delete t[PR],t[nF]=v),e.bag.isMetricsUserIdFallbackEnabled){const n=f(t,IR)
let r=null;((0,Zv.isNothing)(n)||0===n.length||n.length===vK.clientGeneratedUserIdLength)&&(r=null!==(s=e.user.dsid)&&void 0!==s?s:null),(0,Zv.isSome)(r)&&r.length>0&&(t[CR]=r)}}_decorateClick(e){!function(e){const t=f(e,fF),n=f(e,zR)
r(t)&&(0,Jv.isSome)(n)&&(null==n?void 0:n.length)>0&&(e[fF]=n),f(e,YR)===zS&&delete e[JR]}(e),this._decorateSearchResultImpressions(e),this._decorateSearchFocusImpressions(e),kW.shared.addReferralDataToEventIfNecessary(e),this._filterBuyParams(e),this._decorateGamesSearchHintClick(e)
const t=f(e,rV)
!(0,Zv.isNothing)(t)&&t.toLowerCase().includes(Rq)||delete e[IH],zh(e)}_decorateImpressions(e,t){if(o(t[IH]))return!1
this._derezFastImpressions(t),this._decorateSearchResultImpressions(t),this._stripContentRatingImpressionFields(t)
const n=f(t,zB)
return(0,Zv.isSome)(n)&&n.length>0&&(t[iq]=Ah(n),delete t[zB]),zh(t),delete t[VN],!0}_decorateMedia(e){const t=h(e,JM)
r(t)||(e[JM]=Math.round(t))}_filterBuyParams(e){const t=f(e,"actionDetails.buyParams")
if((0,Zv.isSome)(t)&&t.length>0){const n=new fK(t);[wS].forEach(e=>{n.set(e,null,null)}),(0,Zv.isSome)(e[XG])&&(e[XG][Ej]=n.toString())}}_decoratePage(e,t){const n=f(t,SW)
r(n)||(t.pageHistory=this._options.buyDecorator.getPageHistoryFor(n)),kW.shared.setReferralDataForProductPageExtensionIfNecessary(t),kW.shared.beginReferralContextForPageIfNecessary(t),kW.shared.addReferralDataToEventIfNecessary(t)
const o=f(t,zB)
if(!r(o)){const e=vh(o),n=Ah(o)
null!==e&&e.length>0&&(t[rF]=e),null!==n&&n.length>0&&(t[iq]=n)}}_decoratePageChange(e,t){this._decoratePage(e,t)}_decorateSearch(e){e[HN]=3,function(e){var t
const n=null!==(t=e[XG])&&void 0!==t?t:{},o=n[fF],i=f(e,zR)
r(o)&&(0,Jv.isSome)(i)&&(null==i?void 0:i.length)>0&&(n[fF]=i,e[XG]=n),f(e,YR)===zS&&delete e[JR],e[jG]===KR&&delete e[JR]}(e)}_decoratePageExit(e){kW.shared.endReferralContextIfNecessaryForPageEvent(e)}_filterExtraneous(e){!function(e){delete e[zR],delete e[YR],delete e.searchGhostHintTermLastDisplayed}(e),kW.shared.removeReferralContextInfoFromMetricsEvent(e)}makeEvent(e,t){const n=f(t,nV)
if(this._options.isLoggingEnabled&&e.console.log(`Building event for topic: ${n}`),t[rW]===gy)return new dK({})
const r=f(t,p$)||this._options.defaultTopic
this._decorateAll(e,t,r),e.user.isUnderThirteen&&(delete t[CR],delete t[IR],delete t.canonicalAccountIdentifierOverride)
const o=t[WB]
switch(o&&""===o&&delete t[WB],n){case OG:this._decorateClick(t)
break
case TR:break
case IH:if(!this._decorateImpressions(e,t))return new dK({})
break
case AR:this._decorateMedia(t)
break
case SW:this._decoratePage(e,t)
break
case hL:this._decoratePageChange(e,t)
break
case gS:this._decoratePageExit(t)
break
case Rq:this._decorateSearch(t)}return this._filterExtraneous(t),e.bag.metricsIdMigrationEnabled&&function(e){delete e[QR],delete e.DSID}(t),new dK(t)}}vK.clientGeneratedUserIdLength=24,vK.hasIAdData=bR
class mK{constructor(e,t,n,r,o=!1){this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class yK{constructor(){this.$kind="TodayCard",this.heading=void 0,this.title=void 0,this.shortTitle=void 0,this.titleArtwork=void 0,this.media=void 0,this.heroMedia=void 0,this.overlay=void 0,this.style=void 0,this.clickAction=void 0,this.backgroundColor=void 0,this.inlineDescription=void 0,this.collapsedHeading=void 0,this.editorialDisplayOptions=void 0,this.supportsMediaMirroring=void 0}}const AK="5pdfhju01"
class TK{constructor(e,t,n){this.$kind="SearchAdOpportunity",this.instanceId=e,this.eventPayloads=t,this.searchAd=n}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}setMissedOpportunityReason(e){this.eventPayloads.placed.missedOpportunityReason=e}}class bK extends MW{constructor(e){super(),this.$kind="AdTransparencyAction",this.actionClass="AdTransparencyAction",this.adTransparencyData=e}}class SK{constructor(e,t,n,r,o){this.$kind="SearchAd",this.instanceId=e,this.iAd=t,this.eventPayloads=n,this.impressionId=r,this.transparencyAction=o}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}}class PK extends MW{constructor(e){super(),this.$kind="AdInteractionAction",this.actionClass="AdInteractionAction",this.adActionMetrics=e}}class IK{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[RG],this.requestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=(0,Jv.isSome)(this.requestData)&&this.requestData.length>0,t=(0,Jv.isSome)(this.routingInfo)&&this.routingInfo.length>0
return e&&t}}const CK="PI4",kK="PI3",OK="PI2",EK="PI1",RK="PV4",DK="PV3",_K="PV2",LK="PV1",MK="LV1",xK="LI1",$K="UV1_3x2",FK="UI1_3x2",NK="TEXT",BK=[FK],UK=[[NK],[MK,xK],[CK,kK,OK,EK,RK,DK,_K,LK],BK]
let GK=null
const jK="jet_native_advert_instanceid"
!function(e){e.Grid="grid",e.Hero="hero",e.Standard="standard"}(lm||(lm={})),function(e){e.insertIntoShelf="insertIntoShelf",e.replaceOrganic="replaceOrganic",e.dropAd="dropAd"}(um||(um={})),function(e){e.Icon="icon",e.Category="category"}(dm||(dm={})),function(e){e.TopLeading="topLeading",e.Top="top",e.TopTrailing="topTrailing",e.Trailing="trailing",e.BottomTrailing="bottomTrailing",e.Bottom="bottom",e.BottomLeading="bottomLeading",e.Leading="leading"}(fm||(fm={})),hm=e(172)
const VK="appStore.getEngagementEvents",HK=0,qK=1,WK=2
class zK{constructor(e){this.$kind="CategoryList",this.categories=e}}class YK{constructor(e,t,n,r,o){this.$kind="Category",this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}const JK={Apps:36,MacApps:39,Games:6014,Discover:39},KK=["284417353","1464590764","314638464","284993479","1351056256"];(cy=pm||(pm={})).ArcadeSeeAllGames="editorial-shelves-arcade-see-all-games",cy.Collection="editorial-shelves-collection",cy.Chart="editorial-shelves-chart",cy.Tag="editorial-shelves-tag",cy.Engagement="editorial-shelves-engagement",cy.Text="editorial-shelves-text",cy.Image="editorial-shelves-image",cy.VideoClip="editorial-shelves-video-clip",cy.Header="editorial-shelves-header",cy.Recommendations="editorial-shelves-recommendation",cy.GameCenter="editorial-shelves-game-center",cy.Upsell="editorial-shelves-upsell",cy.Marker="editorial-shelves-marker",(ay=wm||(wm={})).Hero="Hero",ay.TextOnly="TextOnly",ay.TextWithArtwork="TextWithArtwork",ay.BrickSmall="BrickSmall",ay.BrickMedium="BrickMedium",ay.BrickLarge="BrickLarge",ay.Charts="Charts",ay.EditorialLockupHierarchicalPortrait="EditorialLockupHierarchicalPortrait",ay.EditorialLockupHierarchicalRows="EditorialLockupHierarchicalRows",ay.EditorialLockupMedium="EditorialLockupMedium",ay.EditorialLockupMediumVariant="EditorialLockupMediumVariant",ay.EditorialLockupLarge="EditorialLockupLarge",ay.EditorialLockupLargeVariant="EditorialLockupLargeVariant",ay.LockupMedium="LockupMedium",ay.Lockup4Up="Lockup4Up",ay.Poster="Poster",ay.StorySmall="StorySmall",ay.StoryMedium="StoryMedium",ay.LockupSmall="LockupSmall",ay.LockupLarge="LockupLarge",ay.BreakoutLarge="BreakoutLarge",function(e){e.QuickLinks="QuickLinks"}(gm||(gm={})),(sy=vm||(vm={})).Vertical="Vertical",sy.Horizontal="Horizontal",sy.Condensed="Condensed",function(e){e.ShowInstalled="ShowInstalled",e.ShowAllPlatforms="ShowAllPlatforms",e.ShowOnlyPreorder="ShowOnlyPreorder"}(mm||(mm={})),function(e){e.AllGames="AllGames",e.ArcadeGames="ArcadeGames"}(ym||(ym={})),function(e){e.FriendsArePlaying="FriendsArePlaying",e.ContinuePlaying="ContinuePlaying"}(Am||(Am={})),function(e){e.ArcadeTabHeader="ArcadeTabHeader"}(Tm||(Tm={})),function(e){e.Arcade="Arcade"}(bm||(bm={})),function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(Sm||(Sm={}))
const ZK="X-Apple-AppStore-UserId-Secondary"
class QK extends Error{}class XK extends Error{}const eZ="x-apple-application-instance",tZ="x-apple-application-site",nZ=[Mq,uG,gB]
!function(e){e.AppEvent="appEvent",e.ContingentOffer="contingentOffer",e.OfferItem="offerItem"}(Pm||(Pm={}))
class rZ{constructor(e,t,n,r,o,i){this.$kind="AppEventDetailPage",this.appEvent=e,this.artwork=t,this.video=n,this.shareAction=r,this.mediaOverlayStyle=o,this.includeBorderInDarkMode=i,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class oZ extends MW{constructor(e,t,n=zy){super(),this.$kind="ShareSheetAction",this.actionClass="ShareSheetAction",this.data=e,this.activities=t,this.shareSheetStyle=n}}Im=e(447)
class iZ{constructor(){this.pageMetrics=new NY,this.pageRenderMetrics={}}}class sZ extends iZ{constructor(){super(...arguments),this.$kind="SearchResults"}}class aZ{constructor(e){this.promotionType=e}}class cZ extends aZ{constructor(e,t,n){super(Pm.ContingentOffer),this.$kind=vy,this.contingentOffer=e,this.artwork=t,this.mediaOverlayStyle=n,this.pageMetrics=new NY,this.pageRenderMetrics={},this.learnMoreActionMetrics=new EW,this.backButtonActionMetrics=new EW,this.closeButtonActionMetrics=new EW}}class lZ extends aZ{constructor(e,t,n,r,o,i,s){super(Pm.OfferItem),this.$kind=Sy,this.offerItem=e,this.artwork=t,this.learnMoreTitle=i,this.video=n,this.mediaOverlayStyle=r,this.pageMetrics=new NY,this.additionalInfo=s,this.pageRenderMetrics={},this.learnMoreActionMetrics=new EW,this.backButtonActionMetrics=new EW,this.closeButtonActionMetrics=new EW}}class uZ extends MW{constructor(e,t,n,r){super(),this.$kind="OfferAction",this.actionClass="OfferAction",this.title=e,this.adamId=t,this.parentAdamId=r,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem),this.includeBetaApps=!1}}class dZ extends MW{constructor(e,t){super(),this.$kind="OfferConfirmationAction",this.actionClass="OfferConfirmationAction",this.buyAction=e,this.confirmationInitiationAction=t}}class fZ extends MW{constructor(){super(),this.$kind="OfferAlertAction",this.actionClass="OfferAlertAction",this.title=void 0,this.message=null,this.footerMessage=null,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=iG,this.spatialControllerRequirement=null,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class hZ{constructor(e,t,n,r,o){this.$kind="MarketingItemRequestInfo",this.serviceType=e,this.placement=t,this.seed=r,this.clientOptions=o,this.metricsOverlay={topic:n}}}const pZ="data.search.dataSetId",wZ=YD,gZ=Im.PageInvocationPoint
gZ[Rq]=Rq,gZ[cO]=cO,gZ[dH]=dH,gZ[hL]=hL
const vZ=new Set([QM,RG,tx,AS,VS,YB,eF,WM,HV,"iAd",EG,ex,bR,mj,nV,VN])
class mZ{constructor(e,t,n,r,o,i){this.$kind="ShareSheetNotesMetadata",this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class yZ{constructor(e,t){this.$kind="ShareSheetActivity",this.activityType=e,this.action=t}}class AZ{constructor(e,t,n,r){this.$kind="ShareSheetArticleMetadata",this.context=Eq,this.id=e,this.text=t,this.subtitle=n,this.artwork=r}}class TZ{constructor(e,t,n){this.$kind="ShareSheetData",this.metadata=e,this.url=t,this.shortUrl=n}}class bZ{constructor(e,t,n){this.$kind="ShareSheetAppEventMetadata",this.context=oB,this.text=e,this.subtitle=t,this.artwork=n}}class SZ extends MW{constructor(e,t,n,r,o,i,s,a,c){super(),this.$kind="CreateCalendarEventAction",this.actionClass="CreateCalendarEventAction",this.startDate=e,this.endDate=t,this.isAllDay=n,this.name=r,this.location=o,this.notes=i,this.url=s,this.notAuthorizedAction=a,this.availability=c}}class PZ{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="ShareSheetProductMetadata",this.context=kH,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class IZ extends MW{constructor(e){super(),this.$kind="SheetAction",this.actionClass="SheetAction",this.actions=e,this.isCancelable=!1,this.cancelTitle=null,this.message=null,this.style=Gq,this.isCustom=!1,this.destructiveActionIndex=null}}class CZ{constructor(e,t,n){this.$kind="ShareSheetGenericMetadata",this.context=Pj,this.text=e,this.subtitle=t,this.artwork=n}}class kZ{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b){this.$kind="PurchaseConfiguration",this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=f,this.supportsVisionOSCompatibleIOSBinary=h,this.inAppEventId=p,this.extRefApp2=w,this.extRefUrl2=g,this.additionalHeaders=v,this.appCapabilities=m,this.isDefaultBrowser=y,this.remoteDownloadIdentifiers=A,this.hasMacIPAPackage=T,this.contentRating=b}}class OZ extends MW{constructor(e,t,n,r){super(),this.$kind="ArcadeSubscriptionStateAction",this.actionClass="ArcadeSubscriptionStateAction",this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class EZ extends MW{constructor(e,t){super(),this.$kind="CancelPreorderAction",this.actionClass="CancelPreorderAction",this.preorderAdamId=e,this.isArcade=t}}class RZ extends MW{constructor(e,t){super(),this.$kind="RateLimitedAction",this.actionClass="RateLimitedAction",this.actionKey=e,this.primaryAction=t}}const DZ=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase()
return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||r(e)||(this._app=e)}useClientId(e){r(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0
for(const t of e){const e=f(t)
r(e)||this._pages.push(e)}}}useNativeValues(e){const t=f(e,"nativeApp")
this.useApp(t)
const n=f(e,"nativeClientId")
this.useClientId(n)
const r=l(e,"nativePageHistory")
this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice()
return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}}
let _Z=null
const LZ={containerId:"mtContainerId",placementId:"mtIadPlacementId",templateType:"mtIadTemplateType"},MZ={TodayCardMediaAppEvent:"TodayCardMediaAppEvent",TodayCardMediaArtwork:Ey,TodayCardMediaBrandedSingleApp:Ry,TodayCardMediaHero:"TodayCardMediaHero",TodayCardMediaList:Dy,TodayCardMediaVideo:_y},xZ={TodayCardInAppPurchase:"TodayCardInAppPurchase",TodayCardMediaAppIcon:"TodayCardMediaAppIcon",TodayCardMediaGrid:"TodayCardMediaGrid",TodayCardMediaMediumLockupWithAlignedRegion:"TodayCardMediaMediumLockupWithAlignedRegion",TodayCardMediaMediumLockupWithScreenshots:"TodayCardMediaMediumLockupWithScreenshots",TodayCardMediaMultiApp:"TodayCardMediaMultiApp",TodayCardMediaRiver:Ly,TodayCardMediaSingleLockup:"TodayCardMediaSingleLockup",...MZ}
class $Z{constructor(e){this.impressionMetrics=null,this.kind=e}bestBackgroundColor(){}get searchAdOpportunity(){}}class FZ extends $Z{constructor(e,t,n,r){super(e),this.artworks=t,this.videos=n,this.artworkLayoutsWithMetrics=r}bestBackgroundColor(){var e,t,n
return null!==(t=null===(e=this.videos[0])||void 0===e?void 0:e.preview.backgroundColor)&&void 0!==t?t:null===(n=this.artworks[0])||void 0===n?void 0:n.backgroundColor}}class NZ extends FZ{constructor(e,t,n,r){super(fW,e,t,n),this.$kind="TodayCardMediaArtwork",this.titleBackingGradient=r}}class BZ extends $Z{constructor(e,t){super(t$),this.$kind="TodayCardMediaMultiApp",this.lockups=e,this.additionalText=t}}class UZ extends FZ{constructor(e,t){super(nG,e,t,[]),this.$kind="TodayCardMediaHero"}isValid(){const e=this.artworks.every(e=>e.isValid())&&this.artworks.length>0,t=this.videos.length>0
return e||t}}const GZ={TodayCardActionOverlay:"TodayCardActionOverlay",TodayCardAppEventLockupOverlay:"TodayCardAppEventLockupOverlay",TodayCardArcadeLockupOverlay:"TodayCardArcadeLockupOverlay",TodayCardLockupListOverlay:"TodayCardLockupListOverlay",TodayCardLockupOverlay:ky,TodayCardMarketingLockupOverlay:Oy,TodayCardParagraphOverlay:My,TodayCardThreeLineOverlay:xy}
class jZ{constructor(e){this.kind=e}}class VZ extends jZ{constructor(e){super(cq),this.$kind="TodayCardActionOverlay",this.action=e}}class HZ extends FZ{constructor(e,t,n,r,o,i,s){super(oB,r,o,i),this.$kind="TodayCardMediaAppEvent",this.formattedDates=e,this.startDate=t,this.tintColor=n,this.blurStyle=s}}class qZ extends jZ{constructor(e){super(cW),this.$kind="TodayCardLockupOverlay",this.lockup=e,this.displaysIcon=!0}}class WZ{constructor(e,t,n,r,o=!1,i=!1){this.$kind="PageRefreshPolicy",this.strategy=e,this.updateDelayInterval=t,this.timeSinceOnScreenInterval=n,this.timeToLiveEndDate=r,this.refreshWhileVisible=o,this.refreshForDeviceDrivenContentChange=i}}class zZ{constructor(e,t,n){this.locationTracker={rootPosition:0,locationStack:[]},this.parsedCardCount=0,this.currentRowIndex=0,this.pageInformation=e,this.locationTracker=null!=t?t:{rootPosition:0,locationStack:[]},this.refreshController=n}}class YZ extends zZ{constructor(e,t,n,r,o){super(t,n,r),this.pageHasDisplayedContent=!1,this.remainingContent=e,this.adPlacementBehavior=um.insertIntoShelf,this.recoImpressionData=o}}!function(e){e.AppEventCard="AppEventCard",e.AppOfTheDay="AppOfTheDay",e.FullBleedImage="FullBleedImage",e.GameOfTheDay="GameOfTheDay",e.Grid="Grid",e.InAppPurchase="InAppPurchase",e.List="List",e.NumberedList="NumberedList",e.River="River",e.ShortImage="ShortImage",e.SingleApp="SingleApp",e.Video="Video"}(Cm||(Cm={})),function(e){e.SmallCard="smallCard",e.MediumCard="mediumCard"}(km||(km={})),function(e){e.NoArtwork="no-artwork",e.ContentArtworkWithTitle="content-artwork-with-title",e.CategoryArtworkWithTitle="category-artwork-with-title",e.CategoryArtworkWithBadge="category-artwork-with-badge"}(Om||(Om={})),function(e){e.AppOfTheDay="app-of-the-day",e.GameOfTheDay="game-of-the-day"}(Em||(Em={})),function(e){e.Eyebrow="eyebrow",e.Title="title"}(Rm||(Rm={})),function(e){e.LinearGradient="linear-gradient"}(Dm||(Dm={})),function(e){e.Inline="inline",e.Article="article"}(_m||(_m={}))
const JZ={top:0,left:0,bottom:0,right:0}
!function(e){e.Mini="mini",e.ExtraWide="extraWide",e.None="none"}(Lm||(Lm={}))
const KZ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},ZZ={collapsedContentMode:tm.top,expandedContentMode:tm.top,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},QZ={objectPath:"editorialVideo.categoryDetailMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:KZ,rtl:KZ,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},{ltr:ZZ,rtl:ZZ,collapsedSize:{type:YV,height:1}}],sourceWidth:800,sourceHeight:450,type:dq,crops:["sr"]},XZ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},eQ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},tQ={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},nQ={objectPath:"editorialArtwork.categoryDetailStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:XZ,rtl:XZ,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},{maxWidth:704,ltr:eQ,rtl:eQ,collapsedSize:{type:YV,height:1.08}},{ltr:tQ,rtl:tQ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:pV},rQ={collapsedContentMode:tm.bottomLeft,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:JZ},oQ={collapsedContentMode:tm.bottomLeft,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},iQ={collapsedContentMode:tm.topLeft,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},sQ={maxWidth:250,ltr:rQ,rtl:rQ,collapsedSize:{type:YV,height:1},priority:Lm.Mini},aQ={objectPath:E_,cardArtLayoutMetrics:[sQ,{maxWidth:704,ltr:oQ,rtl:oQ,collapsedSize:{type:YV,height:1.062}},{ltr:iQ,rtl:iQ,collapsedSize:{type:Gx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:pV},cQ={collapsedContentMode:tm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:tm.bottomLeft,expandedLayoutInsets:JZ},lQ={collapsedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedContentMode:tm.bottomLeft,expandedLayoutInsets:JZ},uQ={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},dQ={maxWidth:250,ltr:cQ,rtl:cQ,collapsedSize:{type:YV,height:1},priority:Lm.Mini},fQ={objectPath:R_,cardArtLayoutMetrics:[dQ,{maxWidth:704,ltr:lQ,rtl:lQ,collapsedSize:{type:YV,height:1.062}},{ltr:uQ,rtl:uQ,collapsedSize:{type:Gx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:pV},hQ={collapsedContentMode:tm.bottomLeft,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:JZ},pQ={collapsedContentMode:tm.bottomLeft,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},wQ={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},gQ={maxWidth:250,ltr:hQ,rtl:hQ,collapsedSize:{type:YV,height:1},priority:Lm.Mini},vQ={objectPath:D_,cardArtLayoutMetrics:[gQ,{maxWidth:704,ltr:pQ,rtl:pQ,collapsedSize:{type:YV,height:1.062}},{ltr:wQ,rtl:wQ,collapsedSize:{type:Gx,width:1}}],crops:[PC],sourceWidth:800,sourceHeight:490,type:pV},mQ=tm.topRight,yQ={top:-108,left:495,bottom:0,right:0},AQ=tm.topLeft,TQ={top:-108,left:-495,bottom:0,right:0},bQ={type:yH,width:1124,height:482},SQ={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:mQ,expandedLayoutInsets:yQ},PQ={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:AQ,expandedLayoutInsets:TQ},IQ={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:-165,left:524,bottom:0,right:0},expandedContentMode:mQ,expandedLayoutInsets:yQ},CQ={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:-165,left:-524,bottom:0,right:0},expandedContentMode:AQ,expandedLayoutInsets:TQ},kQ={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:mQ,expandedLayoutInsets:yQ},OQ={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:AQ,expandedLayoutInsets:TQ},EQ={objectPath:"editorialVideo.listCardMotion21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:SQ,rtl:PQ,collapsedSize:{type:yH,width:914,height:392},expandedSize:bQ,priority:Lm.Mini},{ltr:IQ,rtl:CQ,collapsedSize:{type:yH,width:1188,height:509},expandedSize:bQ},{ltr:kQ,rtl:OQ,collapsedSize:{type:yH,width:1456,height:624},expandedSize:bQ,priority:Lm.ExtraWide}],crops:[],sourceWidth:1208,sourceHeight:518,type:dq},RQ={collapsedContentMode:tm.bottomRight,collapsedLayoutInsets:JZ,expandedContentMode:tm.topRight,expandedLayoutInsets:JZ},DQ={collapsedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedContentMode:tm.topLeft,expandedLayoutInsets:JZ},_Q={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:tm.right,expandedLayoutInsets:JZ},LQ={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:tm.left,expandedLayoutInsets:JZ},MQ={collapsedContentMode:tm.scaleAspectFill,collapsedLayoutInsets:JZ,expandedContentMode:tm.bottomRight,expandedLayoutInsets:{top:50,left:495,bottom:0,right:0}},xQ={collapsedContentMode:tm.scaleAspectFill,collapsedLayoutInsets:JZ,expandedContentMode:tm.bottomRight,expandedLayoutInsets:{top:50,left:-495,bottom:0,right:0}},$Q={objectPath:"editorialArtwork.listCardStatic21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:RQ,rtl:DQ,sourceCropOverrideLTR:"LCS.ApLCS01",sourceCropOverrideRTL:"LCS.ApLCS02",sourceSizeOverride:new Dz(550,264),priority:Lm.Mini},{ltr:_Q,rtl:LQ,collapsedSize:{type:yH,width:672,height:279}},{ltr:MQ,rtl:xQ,expandedSize:{type:yH,width:1124,height:482},sourceCropOverrideLTR:IC,sourceCropOverrideRTL:IC,priority:Lm.ExtraWide}],crops:["LCS.ApLCL01","LCS.ApLCL02"],sourceWidth:688,sourceHeight:286,type:pV},FQ={collapsedContentMode:tm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:tm.bottomLeft,expandedLayoutInsets:JZ},NQ={collapsedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedContentMode:tm.bottomLeft,expandedLayoutInsets:JZ},BQ={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottomLeft,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},UQ={maxWidth:250,ltr:FQ,rtl:FQ,collapsedSize:{type:YV,height:1},priority:Lm.Mini},GQ={objectPath:CM,cardArtLayoutMetrics:[UQ,{maxWidth:704,ltr:NQ,rtl:NQ,collapsedSize:{type:YV,height:1.062}},{ltr:BQ,rtl:BQ,collapsedSize:{type:Gx,width:1}}],crops:[PC],sourceWidth:800,sourceHeight:490,type:pV},jQ={collapsedContentMode:tm.center,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},VQ={objectPath:"editorialVideo.storeFrontVideo",cardArtLayoutMetrics:[{ltr:jQ,rtl:jQ,collapsedSize:{type:YV,height:1},expandedSize:{type:YV,height:1}}],crops:[],sourceWidth:875,sourceHeight:492,type:dq},HQ={collapsedContentMode:tm.center,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},qQ={objectPath:"editorialVideo.storeFrontVideo4x3",cardArtLayoutMetrics:[{ltr:HQ,rtl:HQ,collapsedSize:{type:YV,height:1},expandedSize:{type:YV,height:1}}],crops:[],sourceWidth:656,sourceHeight:492,type:dq},WQ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},zQ={collapsedContentMode:tm.top,expandedContentMode:tm.top,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},YQ={objectPath:"editorialVideo.storyCardMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:WQ,rtl:WQ,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},{ltr:zQ,rtl:zQ,collapsedSize:{type:YV,height:1}}],sourceWidth:800,sourceHeight:450,type:dq,crops:["sr"]},JQ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},KQ={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},ZQ={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},QQ={maxWidth:250,ltr:JQ,rtl:JQ,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},XQ={objectPath:CC,cardArtLayoutMetrics:[QQ,{maxWidth:704,ltr:KQ,rtl:KQ,collapsedSize:{type:YV,height:1.08}},{ltr:ZQ,rtl:ZQ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:pV},eX={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},tX={collapsedContentMode:tm.top,expandedContentMode:tm.top,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},nX={objectPath:"editorialVideo.storyCenteredMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:eX,rtl:eX,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},{ltr:tX,rtl:tX,collapsedSize:{type:YV,height:1}}],sourceWidth:800,sourceHeight:450,type:dq,crops:["sr"]},rX={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},oX={collapsedContentMode:tm.bottom,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},iX={collapsedContentMode:tm.scaleAspectFill,expandedContentMode:tm.bottom,collapsedLayoutInsets:JZ,expandedLayoutInsets:JZ},sX={maxWidth:250,ltr:rX,rtl:rX,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},aX={maxWidth:704,ltr:oX,rtl:oX,collapsedSize:{type:YV,height:1.08}},cX={ltr:iX,rtl:iX},lX={objectPath:Nx,cardArtLayoutMetrics:[sX,aX,cX],crops:["sr"],sourceWidth:800,sourceHeight:450,type:pV},uX={objectPath:Nx,cardArtLayoutMetrics:[sX,aX,cX],crops:["nr"],sourceWidth:1280,sourceHeight:586,type:pV},dX={type:yH,width:1200,height:675},fX={top:-130,left:0,bottom:0,right:0},hX={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-16,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},pX={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:-116,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},wX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:-116,left:-70,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},gX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:-116,left:70,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},vX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},mX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},yX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},AX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:fX},TX={objectPath:"editorialVideo.universalAMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:hX,rtl:hX,collapsedSize:{type:yH,width:455,height:256},expandedSize:dX,priority:Lm.Mini},{maxWidth:699,ltr:pX,rtl:pX,collapsedSize:{type:yH,width:1094,height:614},expandedSize:dX},{maxWidth:899,ltr:wX,rtl:gX,collapsedSize:{type:yH,width:1092,height:614},expandedSize:dX},{maxWidth:1090,ltr:vX,rtl:mX,collapsedSize:{type:yH,width:1392,height:783},expandedSize:dX},{ltr:yX,rtl:AX,collapsedSize:{type:yH,width:1600,height:900},expandedSize:dX}],crops:[kC],sourceWidth:1600,sourceHeight:900,type:dq},bX={collapsedContentMode:tm.top,collapsedLayoutInsets:{top:16,left:0,bottom:0,right:0},expandedContentMode:tm.top,expandedLayoutInsets:JZ},SX={collapsedContentMode:tm.scaleAspectFill,collapsedLayoutInsets:JZ,expandedContentMode:tm.scaleAspectFill,expandedLayoutInsets:JZ},PX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:{top:0,left:-70,bottom:0,right:0},expandedContentMode:tm.center,expandedLayoutInsets:JZ},IX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:{top:0,left:70,bottom:0,right:0},expandedContentMode:tm.center,expandedLayoutInsets:JZ},CX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},kX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},OX={collapsedContentMode:tm.topLeft,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},EX={collapsedContentMode:tm.topRight,collapsedLayoutInsets:JZ,expandedContentMode:tm.center,expandedLayoutInsets:JZ},RX={objectPath:"editorialArtwork.universalAStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:bX,rtl:bX,collapsedSize:{type:yH,width:455,height:256},priority:Lm.Mini},{maxWidth:699,ltr:SX,rtl:SX},{maxWidth:899,ltr:PX,rtl:IX},{maxWidth:1090,ltr:CX,rtl:kX,collapsedSize:{type:yH,width:1400,height:527}},{ltr:OX,rtl:EX,collapsedSize:{type:yH,width:1600,height:604}}],crops:[kC],sourceWidth:1600,sourceHeight:604,type:pV}
class DX extends jZ{constructor(e){super(Cy),this.$kind="TodayCardLockupListOverlay",this.lockups=e}}class _X extends jZ{constructor(e){super("arcadeLockup"),this.$kind="TodayCardArcadeLockupOverlay",this.arcadeLockup=e}}class LX extends MW{constructor(e){super(),this.$kind="TabChangeAction",this.actionClass="TabChangeAction",this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class MX extends MW{constructor(e){super(),this.$kind="OpenGamesUIAction",this.actionClass="OpenGamesUIAction",this.target=e}}Jv.Color.fromRGB(1,90/255,80/255)
const xX="isOnBoardingCard"
class $X extends FZ{constructor(e,t,n,r,o){super(Cj,t,n,r),this.$kind="TodayCardMediaBrandedSingleApp",this.icon=e,this.titleBackingGradient=o}bestBackgroundColor(){var e
return null!==(e=super.bestBackgroundColor())&&void 0!==e?e:this.icon.backgroundColor}}class FX extends $Z{constructor(e){super(sB),this.$kind="TodayCardMediaAppIcon",this.icon=e}bestBackgroundColor(){return this.icon.backgroundColor}}class NX extends $Z{constructor(e){super(tG),this.$kind="TodayCardInAppPurchase",this.lockup=e}bestBackgroundColor(){return this.lockup.icon.backgroundColor}}class BX extends FZ{constructor(e,t,n,r,o,i){super(iO,t,n,r),this.$kind="TodayCardMediaList",this.lockups=e,this.marketingText=o,this.isMediaDark=i}}class UX extends $Z{constructor(e){super(uL),this.$kind="TodayCardMediaRiver",this.lockups=e,this.lockupImpressionLimit=10}}const GX=new Set([Cm.Grid,Cm.List,Cm.NumberedList,Cm.River]),jX={AppEvent:eL,ContingentOffer:Hk,OfferItem:tL}
class VX{constructor(e){this.promotionType=e}}class HX extends VX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(Pm.ContingentOffer),this.$kind=Hk,this.backgroundArtwork=e,this.isStreamlinedBuy=n,this.mediaOverlayStyle=t,this.titleFormatted=o,this.subtitle=i,this.additionalInfo=l,this.description=s,this.label=a,this.badge=c,this.offerLockup=d,this.trunkAppIcon=u,this.learnMoreTitle=r,this.clickAction=null}}class qX{constructor(e,t,n){this.$kind="Paragraph",this.text=e,this.mediaType=t||JV,this.style=n||wW,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class WX{constructor(e,t,n){this.periodDuration=e,this.periodCount=t,this.type=n}isEqualTo(e){return e.periodDuration===this.periodDuration&&e.periodCount===this.periodCount&&e.type===this.type}}class zX extends VX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(Pm.OfferItem),this.$kind=tL,this.moduleArtwork=e,this.moduleVideo=t,this.isStreamlinedBuy=r,this.mediaOverlayStyle=n,this.titleFormatted=o,this.description=a,this.badge=c,this.offerLockup=d,this.subtitle=s,this.endDate=l,this.expiryDateFormatted=i,this.iapArtwork=u,this.clickAction=null}}class YX{constructor(e,t,n,r,o,i,s,a,c,l,u){this.$kind="AppEventNotificationConfig",this.appEventId=e,this.title=t,this.detail=n,this.artworkUrl=r,this.displayTime=o,this.scheduledAction=i,this.notAuthorizedAction=s,this.failureAction=a,this.destinationUrl=c,this.scheduleClickEvent=l,this.cancelScheduleClickEvent=u}}class JX extends VX{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w){super(Pm.AppEvent),this.$kind=eL,this.appEventId=e,this.moduleArtwork=t,this.moduleVideo=n,this.title=r,this.subtitle=o,this.detail=i,this.startDate=s,this.endDate=a,this.appEventBadgeKind=c,this.kind=l,this.requirements=u,this.lockup=d,this.hideLockupWhenNotInstalled=f,this.formattedDates=h,this.mediaOverlayStyle=p,this.includeBorderInDarkMode=w,this.clickAction=null}}!function(e){e.available="available",e.happening="happening",e.live="live"}(Mm||(Mm={}))
class KX{constructor(e,t,n,r,o){this.$kind="AppEventFormattedDate",this.showLiveIndicator=e,this.displayFromDate=t,this.displayText=n,this.countdownToDate=r,this.countdownStringKey=o}}const ZX="RoutableArticlePageIntent"
let QX=null
const XX=[Yj,IN,oH,aW,TG,MB,AU,TU],e0=[Yj,CN,oH,TG],t0=[Yj,oH,aW,AG],n0=[Yj,IN,oH,aW,TG,MB,AU,TU,CN,AG],r0=AU
let o0=null
const i0=[Mq,tE,UL,LH,uN,nT,eV,GL,jL,gU,Lj,VL,LV,nE,Oj,rE,oE,xO,iE,"miniGamesDeepLink","gameDisplayName"],s0=/id([0-9]+)\/?$/i,a0={915249334:"1462947752"},c0=258,l0=261,u0=265,d0=304,f0=305,h0=311,p0=312,w0=414,g0=415,v0=416,m0=417,y0=418,A0=420,T0=421,b0=422,S0=423,P0=424,I0=425,C0=429,k0=430,O0=431,E0=437,R0=476,D0=495,_0=496,L0=497,M0=500,x0=501,$0=518,F0=548,N0=557,B0=584,U0=587,G0=566,j0=new Set([117,122,118,195,194,197,369,370,371,372,373,374,375,376,377,378,379,380,395,396,397,398,399,400,491,492,493,504,505,506,520,521,522,523,524,525,530,531,532,533,567,571]),V0=new Set([491,492,493]),H0=new Set([530,531,532,533]),q0=new Set([567,571]),W0=new Set([h0,p0,R0]),z0=new Set([...W0,$0]),Y0=new Set([N0,y0,O0,C0,k0,A0,d0,f0,260,L0]),J0=new Set([413,w0,254,255,256,266,271,436])
class K0{}class Z0 extends Error{}class Q0 extends K0{constructor(e){super(),this.rawData=e,this.appId=null,this.groupId=null,this.score=0,this.segScores=new Map,this.modifiedScore=0,this.onDeviceScore=0}}class X0 extends K0{constructor(e){super(),this.rawData=e,this.isExactMatch=!1,this.isWildcardMatch=!1,this.isUnpersonalizedMatch=!1,this.isFallbackMatch=!1,this.appId=null,this.groupId=null,this.score=0,this.modifiedScore=0,this.onDeviceScore=0}}const e1="-1",t1={contentsNotChanged:0,contentsFiltered:1,contentsSorted:2}
class n1{constructor(e,t){this.$kind="CondensedAdLockupWithIconBackground",this.lockup=e,this.backgroundArtwork=t}}class r1 extends $Z{constructor(e){super(n$),this.$kind="TodayCardMediaSingleLockup",this.condensedAdLockupWithIconBackground=e}bestBackgroundColor(){var e
return null===(e=this.condensedAdLockupWithIconBackground)||void 0===e?void 0:e.backgroundArtwork.backgroundColor}get searchAdOpportunity(){return this.condensedAdLockupWithIconBackground.lockup.searchAdOpportunity}}class o1{constructor(e,t,n,r,o,i){this.$kind="MediumAdLockupWithScreenshotsBackground",this.lockup=e,this.screenshots=t,this.isAnimated=n,this.secondaryTextColor=r,this.backgroundColor=o,this.riverSpeed=i}}class i1 extends $Z{constructor(e){super("mediumLockupWithScreenshots"),this.$kind="TodayCardMediaMediumLockupWithScreenshots",this.mediumAdLockupWithScreenshotsBackground=e}get searchAdOpportunity(){return this.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity}}!function(e){e.EditorialItem="editorialItem",e.EditorialItemGroup="editorialItemGroup"}(xm||(xm={}))
class s1{constructor(e,t,n,r,o,s,a){this.missedOpportunityReasons={},this.placementType=t,this.placementId=null===t?null:this.placementIdFromType(t),this.pageFields={},this.clickFields={},this.impressionsFields={},this.sharedImpressionsArrayFields={},this._adApplied=!1,this._adAdamId=void 0,this.positionInfo=a,this.slotInfo=n,this.setInitialAdData(e,r,o),i(s)&&(this.pageFields[AS]=s)}static from(e,t){var n,r,o,i
const s=new s1(e,f(t.placementType),l(t.slotInfo),null!==(n=f(t.iAdId))&&void 0!==n?n:void 0,null!==(r=f(t.appStoreClientRequestId))&&void 0!==r?r:void 0,null!==(o=v(t.wasOdmlSuccessful))&&void 0!==o?o:void 0,g(t.positionInfo))
return s._adApplied=u(t._adApplied),s._adAdamId=null!==(i=f(t._adAdamId))&&void 0!==i?i:void 0,Object.assign(s.pageFields,t.pageFields),Object.assign(s.clickFields,t.clickFields),Object.assign(s.impressionsFields,t.impressionsFields),Object.assign(s.sharedImpressionsArrayFields,t.sharedImpressionsArrayFields),s.updateContainerId(e,f(t.containerId)),s}static createInitialPageSlotInfos(e,t,n,r,o){var i
const s=an(e,t,!0,o),a=(0,Jv.isNothing)(s)?[]:s.map(e=>e.slot),c=s1.containerIdFromType(e,t)
switch(t){case oq:case SH:const t=null!==(i=null==n?void 0:n.slot)&&void 0!==i?i:0
return[{containerId:c,slots:[{slotId:`${c}_${t}`,slotIndex:t,hasAdData:!1}]}]
case vq:if(!nn(e))return null
0===a.length&&a.push(0)
const o=a.map(e=>({slotId:`${c}_${e}`,slotIndex:e,hasAdData:!1}))
return[{containerId:c,slots:o}]
case tW:const s={},l=(0,Jv.isSome)(n)?n.slot-1:null
let u=!1
return a.forEach(e=>{var t
const n=u?e-1:e,o=null==r?void 0:r.find(e=>e.containedAdSlots.includes(n)),i=l===e,a=function(e,t,n){return(0,Jv.isNothing)(n)?"0":n.type===xm.EditorialItemGroup?(!(n.containedAdSlots.length>1)||e===n.containedAdSlots[0]||n.containedAdSlots[n.containedAdSlots.length-1],"0"):"0"}(n,0,o),c=null!==(t=s[a])&&void 0!==t?t:{containerId:a,slots:[]}
s[a]=c
const d={slotId:`${a}_${e}`,slotIndex:e,hasAdData:!1}
c.slots.push(d),u=u||i}),Object.values(s)
default:return null}}get adIsPresent(){return this._adApplied}get adAdamId(){return this._adAdamId}updateForAdResponse(e,t){var n
r(t)||(this.placementType=t.placementType,this.placementId=this.placementIdFromType(this.placementType),this.positionInfo=null===(n=t.onDeviceAd)||void 0===n?void 0:n.positionInfo,this.setInitialAdData(e,t.iAdId,t.clientRequestId))}setInitialAdData(e,t,n){if((0,Jv.isNothing)(n))return
const r=(0,Jv.isNothing)(t)?"-1":t
switch(this.pageFields[vK.hasIAdData]=!0,this.placementType){case tW:case oq:case SH:case vq:if(on(e,this.placementType))break
this.impressionsFields[vK.hasIAdData]=!0,this.clickFields[QM]=n,this.impressionsFields[QM]=n}if(rn(e,this.placementType)&&(this.pageFields[ER]=null,this.pageFields[RR]=null,this.pageFields[mj]=null,this.clickFields[ER]=null,this.clickFields[RR]=null,this.impressionsFields[eF]=null,this.impressionsFields[ER]=null,this.impressionsFields[RR]=null,this.impressionsFields[mj]=null),this.pageFields[QM]=n,this.pageFields[RG]=r,this.impressionsFields[RG]=r,this.clickFields[RG]=r,this.updateContainerId(e,null),this.updateSlotInfo(),(0,Jv.isSome)(this.placementId)&&this.placementId.length>0)switch(this.pageFields[EG]=this.placementId,this.clickFields[EG]=this.placementId,this.impressionsFields[EG]=this.placementId,this.placementType){case tW:case oq:case SH:case vq:if(on(e,this.placementType))break
this.sharedImpressionsArrayFields[EG]=this.placementId}}updateContainerId(e,t){this.placementType===tW?(this.containerId=null!=t?t:null,i(this.containerId)&&(this.clickFields[YB]=this.containerId,this.sharedImpressionsArrayFields[YB]=this.containerId)):(this.containerId=s1.containerIdFromType(e,this.placementType),i(this.containerId)&&(this.pageFields[YB]=this.containerId,this.clickFields[YB]=this.containerId))}containerIdForSlotIndex(e){if((0,Jv.isNothing)(e)||(0,Jv.isNothing)(this.slotInfo))return null
for(const t of this.slotInfo)for(const n of t.slots)if(n.slotIndex===e)return t.containerId
return this.containerId}apply(e,t){if((0,Jv.isNothing)(t)||o(t))return
const n=t.id,r=B(t,GG)
if(this._adAdamId=n,r){this.impressionsFields[vK.hasIAdData]=!0,this.clickFields[vK.hasIAdData]=!0
const o=gh(r[iF])
this.clickFields[eF]=o
const i=gh(r[DR])
this.clickFields[WM]=i,this.pageFields[HV]=n,this.pageFields.iAd={iAdFormat:mh(g(m(r),"format")),iAdAlgoId:gh(r.algoId),iAdImpressionId:gh(r[iF]),iAdMetadata:gh(r[DR])}
const s=Ge(e,t)
this.updateIAdMetricsFieldsForProductVariantData(s,this.clickFields),this._adApplied=!0}this.updateSlotInfo()}applyClickFieldsFromPageRequest(e,t){this._adApplied=!0,this._adAdamId=e,Object.assign(this.clickFields,t),Object.keys(this.pageFields).forEach(e=>delete this.pageFields[e])}setSpecifiedCreativeUsed(e){this.clickFields[Yb]=e}setTemplateType(e,t){this.placementType===vq&&nn(e)?this.sharedImpressionsArrayFields[mj]=t:(this.pageFields[mj]=t,this.impressionsFields[mj]=t),this.clickFields[mj]=t}recordLockupFromDataFailed(e,t,n){this.setMissedOpportunity(e,XM,t,n)}recordAdResponseEventsIfNeeded(e,t,n,r){if(!(0,Jv.isNothing)(t)&&0!==t.length)switch(t){case yA:case SO:case"insufficientAssets":this.setMissedOpportunity(e,XM,n,r)
break
case"noAdAvailable":this.setMissedOpportunity(e,sF,n,r)
break
case"timeout":this.setMissedOpportunity(e,"APSLA",n,r)
break
case AA:this.setMissedOpportunity(e,"NOLOC",n,r)
break
case"policyAdDrop":case"policyViolation":this.setMissedOpportunity(e,TS,n,r)}}setMissedOpportunity(e,t,n,r){var o,i,s
const a=null===(o=this.missedOpportunityReasons[n])||void 0===o?void 0:o[r]
if(!(0,Jv.isSome)(a)){switch(null!==(i=(s=this.missedOpportunityReasons)[n])&&void 0!==i||(s[n]={}),this.missedOpportunityReasons[n][r]=t,this.clickFields[ex]=t,this.placementType){case tW:case oq:case SH:break
default:if(rn(e,this.placementType))break
this.pageFields[ex]=t,this.impressionsFields[ex]=t}this.updateSlotInfo()}}missedOpportunityReason(e,t){var n
return null===(n=this.missedOpportunityReasons[e])||void 0===n?void 0:n[t]}placementIdFromType(e){switch(e){case kV:return bS
case vq:return SR
case tW:return SS
case oq:return PS
case SH:return IS
default:throw new Error(`This method should never be called with value: ${e}`)}}static placementTypeFromPlacementId(e,t){switch(t){case bS:return kV
case SR:return vq
case SS:return tW
case PS:return oq
case IS:return SH
default:return e.console.log(`Failed to get placementType from placementId ${t}. Defaulting to searchResults`),vq}}static containerIdFromType(e,t){switch(t){case oq:return MG
case SH:return PO
case tW:return null
case vq:return nn(e)?"0":null
default:return null}}impressionsArrayFieldsForCurrentItem(e,t,n){if(this.placementType!==tW)return{}
const r=Ys(t,n)
return{iAdSlotId:`${this.containerIdForSlotIndex(r)}_${r}`}}get adjustedSlotIndex(){var e
const t=null===(e=this.positionInfo)||void 0===e?void 0:e.slot
return i(t)?t-1:null}updateSlotInfo(){var e,t
if(!(0,Jv.isNothing)(this.slotInfo)){switch(this.placementType){case oq:case SH:case vq:for(const t of this.slotInfo)for(const n of t.slots){if((0,Jv.isSome)(t.containerId)){const r=null===(e=this.missedOpportunityReasons[t.containerId])||void 0===e?void 0:e[n.slotIndex];(0,Jv.isSome)(r)&&(n.missedOpportunityReason=r)}n.hasAdData=this.adIsPresent&&(0,Jv.isNothing)(n.missedOpportunityReason)}break
case tW:const n=this.adjustedSlotIndex
for(const e of this.slotInfo)for(const r of e.slots){const o=n===r.slotIndex,s=this.adIsPresent&&o
let a;(0,Jv.isSome)(e.containerId)&&(a=null===(t=this.missedOpportunityReasons[e.containerId])||void 0===t?void 0:t[r.slotIndex],(0,Jv.isSome)(a)&&(r.missedOpportunityReason=a)),!o&&i(n)&&(a=sF),r.hasAdData=s,(0,Jv.isSome)(a)&&(r.missedOpportunityReason=a)}}(0,Jv.isSome)(this.slotInfo)&&this.slotInfo.length>0&&(this.pageFields[tx]=this.slotInfo,this.clickFields[tx]=this.slotInfo,this.impressionsFields[tx]=this.slotInfo)}}updateIAdMetricsFieldsForProductVariantData(e,t){(0,Jv.isSome)(e)&&Ye(e,nx)?t[CS]=e.productPageId:delete t[CS]}updateIAdMetricsFieldsForAlignedRegion(e,t){}fastImpressionsEventVersion(e){switch(this.placementType){case oq:case SH:case tW:return 5
case vq:return nn(e)?5:4
default:return 4}}shouldIncludeAdRotationFields(e){switch(this.placementType){case oq:case SH:case tW:return!1
case kV:return!0
case vq:return!nn(e)
default:return!0}}shouldIncludeAdFieldsForPad(e){return!!e.client.isPad&&0===Object.keys(this.missedOpportunityReasons).length}}const a1="externalDeepLinkUrl",c1="isCppDeepLinkDisabled"
class l1{constructor(e){this.$kind="EditorsChoice",this.showsBadge=!1,this.title=void 0,this.notes=e,this.isCollapsed=!0}}const u1={11:"43",30:"44"},d1=mD,f1="ReviewsPage.ShelfId",h1=new Set([Kq,Yq,nW])
class p1{constructor(e,t,n){this.sectionType=e,this.shelfId=t,this.shelfBasedMappedIds=n}createProductPageSection(e){return h1.has(this.sectionType)?new mJ(this.sectionType,null):new mJ(this.sectionType,this.shelfId)}createShelfIdList(){return this.shelfBasedMappedIds||[this.shelfId]}}const w1=5,g1=5,v1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(IW,tq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,HU,IF,Kj]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],m1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(IW,tq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,oV,_G,tj,Kj,qU,WU]),new p1(IW,qU),new p1(IW,_G),new p1(IW,tj),new p1(IW,WU),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],y1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(nW,nW),new p1(IW,Mq),new p1(IW,tq),new p1(IW,eH),new p1(IW,KH),new p1(IW,UH),new p1(IW,qq,[FH,HU,Kj]),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],A1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(nW,nW),new p1(IW,Mq),new p1(IW,tq),new p1(IW,eH),new p1(IW,KH),new p1(IW,UH),new p1(IW,qq,[FH,oV,_G,tj,Kj]),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],T1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,hq),new p1(IW,nj),new p1(IW,xG),new p1(IW,tq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,HU,IF,Kj]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH)],b1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,QB),new p1(IW,lH),new p1(IW,hq),new p1(IW,nj),new p1(IW,xG),new p1(IW,tq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,oV,_G,tj,Kj,qU,WU]),new p1(IW,qU),new p1(IW,_G),new p1(IW,tj),new p1(IW,WU),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH)],S1=5,P1=5,I1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(IW,tq),new p1(IW,tH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,HU,IF,Kj]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],C1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(IW,tq),new p1(IW,tH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,oV,_G,tj,Kj,qU,WU]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],k1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,KH),new p1(IW,UH),new p1(IW,qq,[FH,HU,Kj]),new p1(IW,tq),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],O1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,KH),new p1(IW,UH),new p1(IW,qq,[FH,oV,_G,tj,Kj]),new p1(IW,tq),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],E1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(IW,hq),new p1(IW,tq),new p1(IW,tH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,IF,HU,Kj]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH)],R1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,ZB),new p1(IW,lH),new p1(IW,hq),new p1(IW,tq),new p1(IW,tH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,UH),new p1(IW,qq,[FH,qU,oV,_G,tj,Kj,WU]),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH)],D1=5,_1=5,L1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(IW,tq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,qq),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],M1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,lH),new p1(IW,nj),new p1(IW,xG),new p1(nW,nW),new p1(IW,Mq),new p1(IW,tq),new p1(IW,eH),new p1(IW,KH),new p1(IW,qq),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,Vj),new p1(IW,jj),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,YH),new p1(IW,hq)],x1=5,$1=5,F1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,lH),new p1(IW,tq),new p1(IW,tH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,qq),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],N1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lq),new p1(IW,lH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,eH),new p1(IW,KH),new p1(IW,qq),new p1(IW,tq),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,tH),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,TH),new p1(IW,hq),new p1(IW,YH)],B1=5,U1=5,G1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,KH),new p1(nW,nW),new p1(IW,$G),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,YU),new p1(IW,YH),new p1(IW,hq),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,HF)],j1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(nW,nW),new p1(IW,$G),new p1(IW,KH),new p1(IW,zU),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,YH),new p1(IW,hq),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,HF)],V1=5,H1=5,q1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,KH),new p1(nW,nW),new p1(IW,$G),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,YU),new p1(IW,hq),new p1(IW,YH),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,HF)],W1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(nW,nW),new p1(IW,$G),new p1(IW,KH),new p1(IW,zU),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,hq),new p1(IW,YH),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,HF)],z1=5,Y1=5,J1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lH),new p1(IW,KH),new p1(nW,nW),new p1(IW,$G),new p1(IW,CF),new p1(IW,YU),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,YH),new p1(IW,hq)],K1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lH),new p1(nW,nW),new p1(IW,$G),new p1(IW,KH),new p1(IW,CF),new p1(IW,zU),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,YH),new p1(IW,hq)],Z1=5,Q1=5,X1=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lH),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,KH),new p1(nW,nW),new p1(IW,$G),new p1(IW,CF),new p1(IW,YU),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,wV),new p1(IW,Aq),new p1(IW,hq),new p1(IW,YH)],e2=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,lH),new p1(nW,nW),new p1(IW,$G),new p1(IW,KH),new p1(IW,CF),new p1(IW,zU),new p1(IW,Qq),new p1(IW,Cq),new p1(IW,wq),new p1(IW,uq),new p1(IW,JH),new p1(IW,jH),new p1(IW,zH),new p1(IW,GH),new p1(IW,Vq),new p1(IW,Sj),new p1(IW,Aq),new p1(IW,hq),new p1(IW,YH)],t2=3,n2=3,r2=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(IW,tH),new p1(nW,nW),new p1(IW,Mq),new p1(IW,wq),new p1(IW,uq),new p1(IW,Xx)],o2=[new p1(Kq,Kq),new p1(Yq,Yq),new p1(nW,nW),new p1(IW,Mq),new p1(IW,tH),new p1(IW,wq),new p1(IW,uq),new p1(IW,Xx)],i2=w1,s2=g1,a2=[...v1],c2=[...m1],l2=[...y1],u2=[...A1],d2=[...T1],f2=[...b1],h2=S1,p2=P1,w2=[...I1],g2=[...C1],v2=[...k1],m2=[...O1],y2=[...E1],A2=[...R1]
class T2{constructor(e,t,n=JV,r=null,o=null,i=null){this.$kind="FramedVideo",this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===VF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class b2{constructor(e){this.$kind="ProductMediaGalleryPage",this.productMedia=e,this.pageMetrics=new NY,this.pageRenderMetrics={}}}const S2="product_media",P2=new Set([GH,zH,jH,Qq,Xx,tq,nj,xG,Aq,Mq,eH,TH,Cq,jj,Vq,lq,Sj,wV,YH,tH,lH,JH,wq,uq,qq,hq,Vj,$G,HF,KH])
class I2{constructor(e,t){this.$kind="ProductPageExpandedOfferDetails",this.title=e,this.subtitle=t}}class C2{constructor(e,t,n,r,o,i,s,a,c){this.$kind="Banner",this.message=e,this.focusedMessage=t,this.action=n,this.fullProductAction=r,this.leadingArtwork=o,this.leadingArtworkTintColor=i,this.includeBackgroundBorder=s,this.kind=a,this.hideCriteria=c}}class k2{constructor(e,t,n,r,o){this.$kind="AppStateBanner",this.unknownBanner=e,this.buyBanner=t,this.downloadBanner=n,this.updateBanner=r,this.openBanner=o}}const O2="notPurchasedOrdering"
class E2{constructor(e){this.$kind="Uber",this.style=e}isValidUber(e,t){function n(e){return null!=e&&0!==Object.keys(e).length}return n(this.artwork)||n(this.compactArtwork)||n(this.video)||n(this.compactVideo)||(e||t)&&n(this.iconArtwork)}}class R2 extends MW{constructor(e){super(),this.$kind="SelectAppAction",this.actionClass="SelectAppAction",this.adamId=e}}class D2{constructor(e,t){this.$kind="DynamicUIRequestInfo",this.clientOptions=t,this.metricsOverlay={topic:e}}}class _2{constructor(){this.$kind="ArcadeDownloadPackCard"}}class L2{constructor(){this.$kind="Placeholder"}}const M2={shelfIdentifier:"first",slot:0},x2="SLPPage",$2=fq,F2="RoomPageIntent"
$m=e(8836)
class N2{constructor(e){this.builderClass=e}async handleShelf(e,t,n,r){throw new Error(`${this.builderClass} does not implement handleShelf`)}async handlePagination(e,t,n,r,o){throw new Error(`${this.builderClass} does not implement handlePagination`)}shelfRoute(e){return[{protocol:$W,path:`${this.shelfPath}{data}`}]}paginationRoute(e){return[{protocol:$W,path:`${this.paginationPath}`}]}shelfUrl(e){return`${$W}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${VW.shelf}/`}get paginationUrl(){return`${$W}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${VW.lookup}/`}static createFlowAction(e,t,n){const r=new FY(t)
return r.pageUrl=n.build(),r.pageData=e,r}}!function(e){e.Page="page",e.Shelf="shelf",e.Pagination="pagination"}(Fm||(Fm={}))
class B2 extends N2{defaultAttributes(e){return[]}defaultTab(e){return null}prepareRequest(e,t,n,r,o){t.includingAdditionalPlatforms(this.defaultPlatforms(e)),t.includingAttributes(this.defaultAttributes(e)),t.usingCustomAttributes(Ue(e))}defaultAction(e,t,n,r){return B2.createFlowAction(t,this.pageType(),r)}async handlePage(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePage`,async()=>{var r
let i
const s=t.build()
if(Fi(e,t)?i=new yY(e,s):((0,Jv.isSome)(o)&&(n[tz.includeUnlistedApps]="1"),i=this.generatePageRequest(e,t,n)),!i)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,i,Fm.Page,t,n),i.attributingTo(s)
const a=null!==(r=e.fetchTimingMetricsBuilder)&&void 0!==r?r:new $m.FetchTimingMetricsBuilder,c=void 0===e.fetchTimingMetricsBuilder?e.addingFetchTimingMetricsBuilder(a):e
let l
l=_(Ln(c,i)),l.then(t=>{cc(e,e.user.dsid,t)})
const u=this.generateAdditionalPageRequirements(e,t,n),d=await sc(e,l,u)
let f={originalData:d.primaryPageData}
this.supportsDataAugmenting()&&(f=await this.augmentData(c,t,n,d.primaryPageData))
const h=await a.measureModelConstructionAsync(async()=>await this.renderPage(c,f.originalData,n,d.additionalData,f.additionalData,o)),p=this.defaultTab(h),w=this.defaultAction(e,h,n,t),g=n[tz.isPPT]
if(t.removeParam(tz.isPPT),null===p||g)return w
{const e=new LX(p)
return e.actions=[w],e}},async e=>await this.handlePageError(e,t,n))}async handlePageError(e,t,n){throw e}async handleShelf(e,t,n,r){return await Ha(`${this.builderClass}.handleShelf`,async()=>{let r
const o=t.build()
if(r=Fi(e,t)?new yY(e,o):this.generateShelfRequest(e,t,n),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,Fm.Shelf,t,n),r.attributingTo(t.build())
const i=await Ln(e,r),s=await this.renderShelf(e,i,n)
return this.shelfRequiresAdditionalModification(s,n)?await this.performAdditionalShelfModifications(e,s,n):s},async e=>await this.handleShelfError(e,n))}async performAdditionalShelfModifications(e,t,n){return t}shelfRequiresAdditionalModification(e,t){return!1}async handleShelfError(e,t){throw e}async handlePagination(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePagination`,async()=>{let r
const i=t.build()
if(r=Fi(e,t)?new yY(e,i):this.generatePaginationRequest(e,t,n,o),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,Fm.Pagination,t,n),r.attributingTo(t.build())
const s=await Ln(e,r)
return await this.renderPaginatedPage(e,s,o)},async e=>await this.handlePaginationError(e,n,o))}async handlePaginationError(e,t,n){throw e}generateAdditionalPageRequirements(e,t,n){return{}}generateShelfRequest(e,t,n){throw new Error(`generateShelfRequest is not supported on: ${this.builderClass}`)}generatePaginationRequest(e,t,n,r){throw new Error(`generatePaginationRequest is not supported on: ${this.builderClass}`)}supportsDataAugmenting(){return!1}async augmentData(e,t,n,r){const o={url:t,parameters:n}
return await ac(e,r,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,o)}additionalDataKeysNeededForData(e,t,n){return null}fetchAdditionalDataForKey(e,t){return null}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async renderPaginatedPage(e,t,n){throw new Error(`renderPaginatedPage is not supported on: ${this.builderClass}`)}}Nm=e(1974)
class U2{constructor(){this.profile=cW,this.maxPerPage=20}}class G2 extends B2{defaultAttributes(e){return oc(e)}defaultPlatforms(e){return ee(e)}pageType(){return SW}generatePaginationRequest(e,t,n,r){return new yY(e,r.remainingContent)}async renderPaginatedPage(e,t,n){const r=n
return await this.pageWithContent(e,t,r)}async pageWithContent(e,t,n,r=!0){return await Ha("pageWithContent",async()=>function(e,t,n,r=!0){var o
const i=n.preferredShelfContentType||$2,s=new yJ(i),a={id:null,kind:null,softwareType:null,targetType:yq,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:bV,recoMetricsData:null!==(o=St(t))&&void 0!==o?o:{}}
Nh(e,s,a),Ch(0,a,n.title),s.isHorizontal=!1,s.shouldFilterApps=n.shouldFilter
const c=At(t)
r&&(n.remainingContent=[]),s.items=Nd(e,c,{contentUnavailable:(e,t)=>(r&&(n.remainingContent=Ct(0,c,e)),!0),lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Qd(0,i)}})
const l=new bJ([s])
return n.remainingContent.length&&(l.nextPage=n),l}(e,t,n,r))}}class j2 extends G2{requestWithFilter(e,t,n){return new yY(e).forType(yW).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(t,n)}async renderPage(e,t,n,r){return await Ha(Bj,async()=>{const r=new U2
r.url=this.paginationUrl,r.metricsPageInformation=this.pageInformation(e,t,n),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const o=await this.pageWithContent(e,t,r)
return jn(e,o,r.metricsPageInformation),o})}}const{routes:V2,makeCanonicalUrl:H2}=dc(ic,"/room/{id}"),{routes:q2,makeCanonicalUrl:W2}=fc(ic,"/{platform}/room/{id}"),z2="top-paid",Y2="top-free",J2="top-free-safari-extensions",K2="top-paid-safari-extensions",Z2="top-trending-free",Q2="top-trending-paid",X2="top-emerging-free",e4="top-emerging-paid",t4="top-selling"
class n4{constructor(e,t,n,r){this.$kind="GameCenterGameplayHistory",this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class r4{constructor(e,t){this.$kind="GameCenterGameplayHistoryRecord",this.playerId=e,this.timestamp=t}}class o4 extends MW{constructor(e){super(),this.$kind="CrossfireReferralAction",this.actionClass="CrossfireReferralAction",this.referrerData=e}}class i4{supports(e,t,n,r){return this._supports(e,t,n,r)}_supports(e,t,n,r){const o=this.supportedFeaturedContentIds.has(n)
let s
return s=!i(r)||this.supportedNativeGroupingShelfIds.has(r),o&&s}createShelf(e,t,n,o,a){var c,l,u
const d=t,f=this.initialShelfDataFromGroupingMediaApiData(e,d),h=this.shelfTokenFromBaseTokenAndMediaApiData(e,d,o,n),p=this.shelfMetricsOptionsFromBaseMetricsOptions(e,h,a),w=s(p)
w&&this.shouldImpressShelf()&&Ch(0,p,h.title),s(f.shelfContents)&&(f.shelfContents=wn(f.shelfContents,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(l=null==a?void 0:a.recoMetricsData)&&void 0!==l?l:{}))
const g=this._createShelf(e,h,f,n)
if(w&&this.shouldImpressShelf()&&(Oh(p.locationTracker),i(g)&&(Nh(e,g,p),(null===(u=g.url)||void 0===u?void 0:u.length)>0&&s(g.impressionMetrics)&&h.showingPlaceholders))){const e=g.url
try{const t=wz.from(e).pathComponents().pop(),n=JSON.parse(decodeURIComponent(t))
n.originalPlaceholderShelfImpressionMetrics=g.impressionMetrics,function(e,t,n){const o=wz.from(t.url),i=wz.from(Zi(0,t,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,g,n)}catch{g.url=e}}return this.finalizeInitialShelfForDisplay(e,g,h,f,n),w&&this.shouldPrepareLocationTrackerForNextPosition()&&_h(n.metricsLocationTracker),g}constructor(e){this.supportedFeaturedContentIds=new Set([]),this.supportedNativeGroupingShelfIds=new Set([]),this.builderClass=e}incompleteShelfFetchStrategy(e){return om.OnShelfWillAppear}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return n}shouldImpressShelf(){return!0}shouldPrepareLocationTrackerForNextPosition(){return!0}finalizeInitialShelfForDisplay(e,t,n,r,i){var a,c
if(o(t))return
n.isSearchLandingPage&&cs(0,t,n),(null===(a=t.url)||void 0===a?void 0:a.length)>0&&s(i.additionalShelfParameters)&&(t.url=wz.from(t.url).append(vj,i.additionalShelfParameters).build()),t.fetchStrategy=this.incompleteShelfFetchStrategy(e)
const l=(0,Jv.isSome)(t)&&(null===(c=t.url)||void 0===c?void 0:c.length)>0
o(t.items)&&!l&&(t.isHidden=!0),t.accessibilityMetadata=mc(e,t)}finalizeSecondaryShelfForDisplay(e,t,n,i){if(!o(t)){if(n.remainingItems.length){const t=n.remainingItems.map(e=>e.id)
e.console.warn("Could not load items for: "+t.join(","))}var a,c
if(t&&(t.mergeWhenFetched=((c=n).shelfStyle,!(c.showingPlaceholders||c.shelfStyle===PM||c.shelfStyle===KE&&(0,Jv.isSome)(c.initialHydratedItems)&&c.initialHydratedItems.length>0)),t.networkTimingMetrics=i.responseTimingValues,t.nextPreferredContentRefreshDate=null==(a={timeToLive:null,nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:!1})?void 0:a.nextPreferredContentRefreshDate),s(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])
!n.hasExistingContent&&o(t.items)&&(t.isHidden=!0),n.isSearchLandingPage&&cs(0,t,n),t.accessibilityMetadata=mc(e,t)}}async handleShelf(e,t,n,r){const o=n[fV],i=JSON.parse(o)
i.isFirstRender=!1
try{const r=await this.secondaryShelfDataForShelfUrl(e,t,i,n),o=this._createShelf(e,i,r,null)
return this.finalizeSecondaryShelfForDisplay(e,o,i,r),o}catch(e){if(i&&!i.hasExistingContent){const e=new yJ(i.shelfStyle)
return e.isHidden=!0,e}throw e}}shelfRoute(e){return s(this.supportedNativeGroupingShelfIds)?function(e,t){const n=[]
for(const t of e)n.push(yc(-1,t,void 0))
return n}(this.supportedNativeGroupingShelfIds):Ac(this.supportedFeaturedContentIds)}static async secondaryGroupingShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const r=function(e,t,n){var r
const o=(null===(r=t.relationshipToFetch)||void 0===r?void 0:r.length)>0
let i=At(n)
if(o){const r={}
for(const e of n.data)r[e.id]=e
i=[]
for(const n of t.remainingItems){const o=pe(e,n,t.relationshipToFetch)
s(o)&&(n.relationships[t.relationshipToFetch].data=[r[o.id]]),i.push(n)}}return i}(e,n,t)
return{shelfContents:r,responseTimingValues:t[Sm.timingValues]}})}static async secondaryGroupingShelfMediaApiData(e,t,n,r){const o=t.build()
let i
return i=Fi(e,t)?new yY(e,o):Xi(e,n),i?(i.includingAdditionalPlatforms(function(e){return ee(e)}(e)),i.includingAttributes(function(e){const t=[Hq,hH,wH,PU]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}(e)),i.usingCustomAttributes(Ue(e)),i.attributingTo(t.build()),await Ln(e,i).then(e=>(Qi(n,i.ids),e))):await Promise.reject(new Error(`Could not construct media API request for: ${t}`))}}class s4 extends i4{constructor(){super("GroupingGameCenterPopularWithYourFriendsController"),this.batchGroupKey=MV,this.supportedFeaturedContentIds=new Set([D0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isGameCenterPopularWithYourFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.gameCenter.fetchGamesPopularWithFriends(this.gameCategoryFilter(n.gamesFilter),30)
return await o.then(async t=>{const n=t.map(e=>this.gameplayHistoryFromData(e)).sort((e,t)=>t.records.length-e.records.length).filter(t=>this.isCompatibleGameCenterPlatform(e,t.platformId)).map(e=>e.adamId)
if(0===n.length){const e={shelfContents:[]}
return await Promise.resolve(e)}const r=new yY(e).withIdsOfType(n.slice(0,100),yW).includingAgeRestrictions()
return es(e,r),await Ln(e,r,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Sm.timingValues]}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return om.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingPopularWithFriendsShelfForGrouping(e,n,t):this.popularWithFriendsShelfForGrouping(e,n,t)}pendingPopularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelfForGrouping(e,t,n),o=wz.from(Ki(n))
return r.url=o.param(tz.isGameCenterPopularWithYourFriendsShelf,bq).build(),r}popularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelf(e,t.shelfContents,n)
return r.mergeWhenFetched=!0,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header.title=n.title,r.header.subtitle=n.subtitle,r}popularWithFriendsShelf(e,t,n){const r=n.shelfStyle||fq,o=new yJ(r)
o.isHorizontal=!0
const s=[]
for(let o=0;o<t.length;o++){const a=t[o],c={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a),anonymizationOptions:{anonymizationString:`"GAME"${o+1}`}},artworkUseCase:Qd(0,r),canDisplayArcadeOfferButton:rh(0,r),shouldHideArcadeHeader:e.featureFlags.isEnabled(kJ)&&n.isArcadePage,shouldShowFriendsPlayingShowcase:!0},l=et(e,a,LB)
if(H(a,Sq)||!l)continue
const u=Od(e,a,c)
u.clickAction=Tc(e,u.clickAction),i(u)&&(s.push(u),_h(c.metricsOptions.locationTracker))}let a
switch(e.client.deviceType){case lW:a=2
break
case oW:case vW:case"tv":a=6
break
default:a=0}if(o.header=io(e),s.length<a)return o.isHidden=!0,o
if(o.items=s.slice(0,12),o.isHidden=!1,o.batchGroup=MV,s.length>12){const t=new yJ(fq)
t.items=s,t.rowsPerColumn=1
const r=new bJ([t])
r.title=n.title
const i=new FY(SW)
i.title=e.loc.string(gH),i.pageData=r,ea(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),hs(e,o,i)}return o.footerTitle=e.loc.string(z$),o.footerAction=oo({objectGraph:e,metricsLocationTracker:n.metricsLocationTracker,metricsPageInformation:n.metricsPageInformation}),o.footerStyle={$kind:sq,bundleID:FN,width:16,height:16},o}isCompatibleGameCenterPlatform(e,t){return 1===t}gameplayHistoryFromData(e){const t=f(e,HV),n=h(e,"platformId"),r=u(e,aR),o=this.gameplayHistoryRecordFromData(l(e,"records"))
return new n4(t,n,r,o)}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=f(e,"playerId"),n=h(e,"timestamp")
return new r4(t,n)})}gameCategoryFilter(e){return e===kM?sR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:bV}}}class a4 extends i4{constructor(){super("ArcadeDownloadPackShelfController"),this.shelfId="arcadeDownloadPackShelf",this.supportedFeaturedContentIds=new Set([G0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isArcadeDownloadPackShelfPlaceholder]}]}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return bc(e,t,n,r)}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],categoriesContents:[],apps:[],title:""}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Zv.isNothing)(o)||0===o.apps.length)return{shelfContents:[],categoriesContents:[],apps:[],title:""}
const i=o.apps,s=this.shelfTitle(e,Ya(o.subscriptionStatus))
if((0,Zv.isSome)(t.query[tz.isArcadeDownloadPackShelfPlaceholder]))return{shelfContents:[],categoriesContents:[],apps:i,title:s}
const a=i.map(e=>e.adamId),c=i.map(e=>e.categoryId),l=yW,u=sW,d=new yY(e).addingQuery(`ids[${l}]`,Array.from(a).join(",")).addingQuery(`ids[${u}]`,Array.from(c).join(",")).includingAdditionalPlatforms(ee(e)).includingAttributes(Ri(e))
return await Ln(e,d).then(async e=>({shelfContents:e.data.filter(e=>e.type===l),categoriesContents:e.data.filter(e=>e.type===u),apps:i,title:s,responseTimingValues:e[Sm.timingValues]}))}_createShelf(e,t,n,r){if(t.isFirstRender){const n=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Zv.isNothing)(n)||0===n.apps.length){const n=this.emptyShelfWithRefreshUrl(e)
return n.refreshUrl=this.shelfRefreshURL(t),_h(r.metricsLocationTracker),n}{const o=this.placeholderShelf(e,t,n.apps,this.shelfTitle(e,Ya(n.subscriptionStatus)))
return _h(r.metricsLocationTracker),o}}if(n.apps.length>0&&((0,Zv.isNothing)(n.shelfContents)||0===n.shelfContents.length))return this.placeholderShelf(e,t,n.apps,n.title)
{const r=this.shelfMetrics(n.title,t)
Ch(0,r,n.title)
const o=this.downloadPackShelf(e,t,n)
return o.refreshUrl=this.shelfRefreshURL(t),Oh(t.metricsLocationTracker),Nh(e,o,r),o}}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return null}emptyShelfWithRefreshUrl(e){const t=new yJ(this.useCustomDownloadPackCardShelf(e)?PM:Lq)
return t.id=this.shelfId,t.isHidden=!0,t}placeholderShelf(e,t,n,r){const o=this.useCustomDownloadPackCardShelf(e)?this.downloadPackCardPlaceholderShelf(e,t,n.length):this.smallLockupsPlaceholderShelf(e,t,n)
return o.url=wz.from(Ki(t)).build(),o.title=r,o}downloadPackCardPlaceholderShelf(e,t,n){const r=new yJ(PM)
r.id=this.shelfId
const o=new _2
return o.numberOfPlaceholders=n,r.items=[o],t.shelfStyle=r.contentType,r}smallLockupsPlaceholderShelf(e,t,n){const r=new yJ(Lq)
return r.id=this.shelfId,r.items=[],r.isHorizontal=!0,r.rowsPerColumn=2,r.items=Array(n.length).fill(new L2),r.placeholderContentType=r.contentType,r.contentType=LN,t.showingPlaceholders=!0,t.remainingItems=n.map(e=>({id:e.adamId,type:yW})),r}downloadPackShelf(e,t,n){const r=this.categoriesMapFromResponse(e,n.categoriesContents,n.apps),o=this.useCustomDownloadPackCardShelf(e),i=o?PM:Lq,s=this.lockupsFromResponse(e,t,r,o,o,Qd(0,i),(0,Zv.isSome)(n.shelfContents)?n.shelfContents:[],n.apps),a=new yJ(i)
if(a.id=this.shelfId,a.title=n.title,o){const e=new _2
e.lockups=s,a.items=[e]}else a.items=s,a.isHorizontal=!0,a.rowsPerColumn=2
return a.isHidden=0===s.length,a}useCustomDownloadPackCardShelf(e){return e.client.isPhone}shelfRefreshURL(e){return wz.from(Ki(e)).param(tz.isArcadeDownloadPackShelfPlaceholder,bq).build()}lockupsFromResponse(e,t,n,r,o,i,s,a){return Kv.context("lockupsFromResponse",()=>{const c=new Map
for(const e of s)c.set(e.id,e)
const l=t.metricsLocationTracker,u=t.metricsPageInformation,d=[]
for(const t of a){const s=c.get(t.adamId)
if((0,Zv.isNothing)(s))continue
const a=Od(e,s,{offerStyle:o?Rj:void 0,offerEnvironment:o?Jq:void 0,metricsOptions:{pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},metricsClickOptions:{id:s.id,pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},artworkUseCase:i,shouldHideArcadeHeader:!0,isSubtitleHidden:r});(0,Zv.isNothing)(a)||(Zd(a,e),_h(l),r?a.heading=n.get(a.adamId):a.subtitle=n.get(a.adamId),d.push(a))}return d})}categoriesMapFromResponse(e,t,n){const r=new Map
for(const o of n){const n=t.find(e=>e.id===o.categoryId)
if(!n)continue
const i=Kf(e,n,AW)
r.set(o.adamId,i)}return r}shelfTitle(e,t){return e.loc.string(t===iB?"Arcade.DownloadPack.ShelfTitle.NewUser":"Arcade.DownloadPack.ShelfTitle")}shelfMetrics(e,t){return{id:t.id,kind:null,softwareType:Pq,targetType:yq,title:e,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:bV,fcKind:t.featuredContentId}}}class c4 extends i4{constructor(){super("GroupingAppEventShelfController"),this.supportedFeaturedContentIds=new Set([519,$0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
if(!((null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0)){const t=[],r=[],o=[]
for(const e of n.remainingItems)switch(e.type){case OV:r.push(e)
break
case ZV:o.push(e)
break
case hW:t.push(e)}const i=new yY(e,t)
Je(e,i,t)
const s=new yY(e,r)
Je(e,s,r)
const a=new yY(e,o)
Je(e,a,o)
const c=await Promise.all([this.fetchRemainingItems(e,i),this.fetchRemainingItems(e,s),this.fetchRemainingItems(e,a)]),l={...c[0],...c[1],...c[2]},u=[]
for(const e of n.remainingItems){const t=l[e.id];(0,Jv.isSome)(t)&&u.push(t)}return Qi(n,new Set([...a.ids,...s.ids,...i.ids])),{shelfContents:u}}try{const o=await i4.secondaryGroupingShelfMediaApiData(e,t,n,r),s=yt(e,o),a=this.initialShelfDataFromGroupingMediaApiData(e,s)
a.responseTimingValues=o[Sm.timingValues]
const c=j(s,Ji(0,n.featuredContentId))
return i(c)&&(null==c?void 0:c.length)>0&&(a.shelfTitle=c),a}catch{return{shelfContents:[]}}}async fetchRemainingItems(e,t){const n={}
if(t.ids.size>0){es(e,t)
try{await Ln(e,t).then(e=>{(e=>{for(const t of e.data)n[t.id]=t})(e)})}catch(n){e.console.error("Error fetching remaining items",t.ids)}}return n}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=n.featuredContentId===$0
let i=null
const a=this.initialShelfDataFromGroupingMediaApiData(e,t)
o&&s(a.shelfContents)&&(i=this.personalizedDataResultFromDataItems(e,a.shelfContents))
const c={...n,shouldPersonalizeData:o,personalizedDataResult:i},l=s(a.shelfContents),u=!H(t,Ab)
return!l&&u?(c.recommendationsHref=t.href,c.isValidRecommendationsShelf=!0):c.isValidRecommendationsShelf=l,c}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(s(t.personalizedDataResult)){const e=Sh(n.recoMetricsData,t.personalizedDataResult.processingType,null)
r.recoMetricsData=e}return r}_createShelf(e,t,n,i){var a
if(!ii(e))return null
if(!t.isValidRecommendationsShelf)return null
const c={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:t.metricsPageInformation.recoMetricsData}
let l=n.shelfContents
s(t.personalizedDataResult)&&t.isFirstRender&&(l=t.personalizedDataResult.personalizedData)
const u=[]
for(const e of l)r(e.attributes)||Yi(t)?(t.isDeferring=!0,t.remainingItems.push(e)):u.push(e)
const d=pi(e,u,null,!1,!1,c,!1,!0,t.isArcadePage,!1)
Ur(d.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const f=d.appPromotions,h=new yJ(OO)
return h.isHorizontal=!0,h.title=null!==(a=n.shelfTitle)&&void 0!==a?a:t.title,h.items=f,o(h.items)&&t.isFirstRender&&tc(e,h,t,t.featuredContentId),h.url=Zi(0,h,t),o(h.items)&&o(h.url)?t.isFirstRender?null:c4.makeHiddenShelf(t):h}personalizedDataResultFromDataItems(e,t){const n=new Set
for(const e of t){const t=f(e,EU);(null==t?void 0:t.length)>0&&n.add(t)}const r=Ss(e,n)
return Ts(e,Tb,t,!1,r,null,null,null,!0)}static makeHiddenShelf(e){const t=new yJ(e.shelfStyle)
return t.isHidden=!0,t}}class l4{constructor(){this.$kind="ArcadeFooter"}}class u4{constructor(e){this.$kind="Footnote",this.text=e,this.presentationStyle=[],this.clickAction=null}}class d4 extends i4{constructor(){super("GroupingArcadeFooterShelfController"),this.supportedFeaturedContentIds=new Set([-1]),this.supportedNativeGroupingShelfIds=new Set([1])}shouldImpressShelf(){return!1}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:bt(t),responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=ao(e,this.numberOfIconsForArcadeAppGrid(e.client.deviceType))
return await Ln(e,o).then(t=>{const n=this.initialShelfDataFromGroupingMediaApiData(e,t)
return n.responseTimingValues=t[Sm.timingValues],n})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldIncludeShelfUrl:n.isFirstRender}
return o.showingPlaceholders=n.isFirstRender,o}_createShelf(e,t,n,o){const i=new l4,a=new yJ(BE)
a.items=[i]
const c={targetType:cb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(A$),id:t.id,kind:lb,softwareType:Pq}
Nh(e,i,c),Ch(0,c,c.title),i.buttonAction=to(e,hU,t.metricsPageInformation,t.metricsLocationTracker)
const l={targetType:TW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:i.buttonAction.title,id:EA,kind:TW,softwareType:Pq}
Nh(e,i.buttonAction,l),Oh(c.locationTracker)
const u=e.bag.termsAndConditionsURL
if(!r(u)&&"tv"!==e.client.deviceType){const t=e.loc.string(zE),n=new JY(u),r=new u4(t)
r.clickAction=n,r.presentationStyle=[pM,wM,gM],i.footnote=r}if(a.background={type:DV,color:Se(wE)},s(n.shelfContents)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
i.icons=tf(e,n.shelfContents,r,{useCase:O6.LockupIconMedium})}else i.icons=[]
return t.shouldIncludeShelfUrl&&(a.url=Ki(t)),a}numberOfIconsForArcadeAppGrid(e){return e===lW?9:20}}class f4{constructor(){this.$kind="Brick",this.artworks=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=Iq,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null,this.editorialDisplayOptions={},this.artworkSafeArea=null,this.textSafeArea=null}isValid(){var e,t,n,r
const o=null!==(t=null===(e=this.artworks)||void 0===e?void 0:e.every((e,t)=>(0,Jv.isSome)(e)&&e.isValid()))&&void 0!==t&&t,i=(null!==(r=null===(n=this.collectionIcons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0,s=(0,Jv.isSome)(this.backgroundColor)
return(0,Jv.isSome)(this.clickAction)&&(o||i||s)}}!function(e){e.TopRight="topRight",e.TopLeft="topLeft",e.MiddleLeft="middleLeft"}(Bm||(Bm={})),function(e){e.SquareByWidth="squareByWidth",e.SquareByHeight="squareByHeight",e.FreeForm="freeForm"}(Um||(Um={}))
class h4{constructor(e,t,n,r,o){this.width=e,this.height=t,this.asRatioOfSize=null!=n&&n,this.location=r,this.constraint=o}}h4.defaultTileArtworkSafeArea={width:.4,height:.4,asRatioOfSize:!0,constraint:Um.SquareByWidth,location:{relativeLocation:Bm.TopRight}},h4.defaultPillArtworkSafeArea={width:.28,height:1,asRatioOfSize:!0,constraint:Um.FreeForm,location:{relativeLocation:Bm.MiddleLeft}},h4.defaultTileTextSafeArea={width:.15,height:0,asRatioOfSize:!0},h4.defaultPillTextSafeArea={width:.28,height:0,asRatioOfSize:!0}
class p4 extends i4{constructor(){super("GroupingBrickShelfController"),this.supportedFeaturedContentIds=new Set([T0,b0,S0,l0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,fH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(e=>({shelfContents:as(e.shelfContents,we(n.featuredContentData,fH))}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,bb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Nr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,MH)===eq
let d
if(l){d=new yJ(W$)
const n=h(t.featuredContentData.attributes,Sb)
d.rowsPerColumn=null!=n?n:Z(e),Rh(t.metricsLocationTracker).name=nR}else d=new yJ(bG)
d.isHorizontal=!0
for(const n of r.shelfContents){const r=p4.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s)
r?(a.push(r),_h(t.metricsLocationTracker)):c.push(n)}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[fH].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,IM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const p=u(t.featuredContentData.attributes,rR)
if(l&&p){const n=new yJ(W$)
n.items=this.sortCategories(e,a),n.presentationHints={isSeeAllContext:!0}
const r=new bJ([n])
r.title=t.title
const o=new FY(SW)
o.title=e.loc.string(gH),o.pageData=r,d.seeAllAction=o,ea(e,o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}const w=d&&o(d.items)&&t.isFirstRender
if(w&&tc(e,d,t,t.featuredContentId),!w&&p4.shouldDisplayChooseYourFavoritesBrick(e,t,l,s)){const n=p4.createChooseYourFavoritesBrick(e,t.metricsPageInformation,t.metricsLocationTracker)
d.items.splice(0,0,n)}return t.presentationHints=d.presentationHints,d.url=Zi(0,d,t),d}static shouldDisplayChooseYourFavoritesBrick(e,t,n,r){return t.isArcadePage&&n&&e.featureFlags.isEnabled($J)&&(0,Jv.isSome)(null==r?void 0:r.additionalShelfParameters)&&((null==r?void 0:r.additionalShelfParameters.isSubscribed)===bq||(null==r?void 0:r.additionalShelfParameters.isTrialEnrolled)===bq)}static createBrick(e,t,n,r,o,s,a){const c={targetType:n?Jj:bG,pageInformation:r,locationTracker:o,recoMetricsData:St(t)},l=is(e,t,s,!1,null,c,a)
if(!l)return null
const u=new f4,d={useCase:O6.GroupingBrick}
if(n){const t=nf(e,l.content,Vm.categoryBreakout,em.Density1)
u.artworks=t}else if(l.artwork&&(null==s?void 0:s.featuredContentId)!==l0){let t=p(l.artwork,dM)
t||(t=p(l.artwork,"originalFlowcaseBrick"))
const n=ns(e,t,d)
u.artworks=[n]}else{const n=rs(e,t,1060,520,d)
u.artworks=[n]}u.accessibilityLabel=l.title,u.shortEditorialDescription=l.title,u.clickAction=l.action,435===q(t,Xj)&&(u.personalizationStyle=$N)
const f=pe(e,t,mW)
if(i(f)){const n=Ks(e,f,c)
u.flowPreviewActionsConfiguration=ia(e,t,!0,null==s?void 0:s.clientIdentifierOverride,u.clickAction,c,n)}return Nh(e,u,Vh(e,t,l.title,c)),u.artworkSafeArea=h4.defaultTileArtworkSafeArea,u.textSafeArea=h4.defaultTileTextSafeArea,u.isValid()?u:null}static createChooseYourFavoritesBrick(e,t,n){const r=new f4,o=new bz("",1060,520,[],ye("efac78"))
r.artworks=[o]
const i=e.loc.string("ARCADE_CHOOSE_YOUR_FAVORITES_BRICK_TITLE")
r.accessibilityLabel=i,r.shortEditorialDescription=i
const s=new FY(bB)
var a
return s.presentationContext=Qj,s.pageData=Xq,r.clickAction=s,Nh(e,r,(a={targetType:bG,pageInformation:t,locationTracker:n,recoMetricsData:null},Kv.context("impressionOptionsForArcadeChooseYourFavoritesBrick",()=>({...a,id:"",kind:null,softwareType:null,title:"choose_your_games_brick"})))),r.artworkSafeArea=h4.defaultTileArtworkSafeArea,r.textSafeArea=h4.defaultTileTextSafeArea,r}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,MH)===eq&&(r.title=nR),r}sortCategories(e,t){return t.sort((t,n)=>{try{return t.shortEditorialDescription.localeCompare(n.shortEditorialDescription,e.loc.safeIdentifier,{usage:rH})}catch(e){return 0}})}}class w4 extends i4{constructor(){super("GroupingCategoryShelfController"),this.supportedFeaturedContentIds=new Set([I0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=pe(e,t,fH)
return n?{shelfContents:we(n,fH)}:{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(t=>{const r=pe(e,n.featuredContentData,fH)
return r?{shelfContents:as(t.shelfContents,we(r,fH))}:{shelfContents:[]}})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,i){var a
if(o(n.shelfContents))return null
const c=[]
let l=!1
for(const o of n.shelfContents){const n=pe(e,o,tV)
if(r(n))continue
const a=us(0,n)
if(r(o.attributes)||r(n.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const d={targetType:GB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)},f=Bd(e,n,{...d,id:a},t.clientIdentifierOverride)
Nh(e,f,{...d,kind:jq,softwareType:u(null==i?void 0:i.isArcadePage)?Pq:null,title:f.title,id:a})
const h=B(n,fW)
h.width>h.height&&(l=!0),s(h)&&(f.artwork=Xd(e,h,{allowingTransparency:!0,useCase:O6.CategoryIcon})),c.push(f),_h(t.metricsLocationTracker)}const d=this.shelfForCategoryActions(e,c,t)
if(d.title=t.title,d.subtitle=t.subtitle,d.url=Zi(0,d,t),l){const e=null!==(a=d.presentationHints)&&void 0!==a?a:{}
d.presentationHints={...e,itemsHaveRectangularArtwork:!0}}return d}shelfForCategoryActions(e,t,n){const r=new yJ(cq)
let o
switch(e.client.deviceType){case"tv":r.isHorizontal=!0,o=8
break
case vW:r.isHorizontal=!1,o=null
break
case BV:r.isHorizontal=!0,r.rowsPerColumn=3,o=24
break
default:r.isHorizontal=!1,o=6}if(null!==o&&t.length>o){r.items=t.slice(0,o)
const i=new FY(SW)
i.title=e.loc.string(gH),ea(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),r.seeAllAction=i
const s=new yJ(cq)
s.isHorizontal=!1,this.sortCategories(e,t),s.items=t
const a=new bJ([s])
a.title=e.loc.string("PAGE_TITLE_CATEGORIES"),i.pageData=a}else r.items=t
return r}sortCategories(e,t){t.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:rH})}catch(e){return 0}})}}class g4{constructor(){this.$kind="EditorialCard",this.adamId=void 0,this.caption=null,this.title=void 0,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.decorations=[],this.flowPreviewActionsConfiguration=null,this.appEventFormattedDates=null,this.mediaOverlayStyle=null}isValid(){return!!(this.clickAction&&this.artwork&&this.artwork.isValid()&&this.caption&&this.title)}}class v4 extends i4{constructor(){super("GroupingEditorialCardShelfController"),this.supportedFeaturedContentIds=new Set([g0,v0,x0,m0,c0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,fH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){const i=new yJ(gb)
i.isHorizontal=!0
const s=this.personalizationDataContainerForEditorialCardItemsDataArray(e,n.shelfContents),a=[]
for(const i of n.shelfContents){const n=v4.makeEditorialCard(e,i,s,r,t)
!o(n)&&n.isValid()&&(a.push(n),_h(t.metricsLocationTracker))}return delete t.maxItemCount,i.items=a,i.url=Zi(0,i,t),i}static makeEditorialCard(e,t,n,o,s){var a,c,l
const u={targetType:nG,pageInformation:null==s?void 0:s.metricsPageInformation,locationTracker:null==s?void 0:s.metricsLocationTracker,recoMetricsData:St(t),id:t.id,idType:OU},d=q(t,Xj),h=is(e,t,s,d===x0,n,u,o,()=>{null==s||s.remainingItems.push(t)})
if(!h)return null;(null===(c=null===(a=h.content)||void 0===a?void 0:a.id)||void 0===c?void 0:c.length)>0&&(u.id=h.content.id,u.idType=Dq,u.adamId=h.content.id)
const w=new g4
let g=j(t,"designBadge")
g||(g=h.caption),w.caption=g
let v=j(t,Wq)
v||(v=h.title),w.title=v
let m=ds(j(t,oR))
m||(m=h.subtitle),w.subtitle=m
const y={useCase:O6.GroupingHero,withJoeColorPlaceholder:!0}
if(h.artwork&&(null==s?void 0:s.featuredContentId)!==c0){let t=p(h.artwork,dM)
r(t)&&i(h.appEvent)&&(t=p(h.artwork,"eventCard")),w.artwork=ns(e,t,y)}else w.artwork=rs(e,t,416,204,y)
if(w.clickAction=h.action,i(h.appEvent)&&(w.appEventFormattedDates=h.appEvent.formattedDates),w.lockup=h.lockup,i(w.artwork)&&i(w.artwork.backgroundColor)){const e=be(w.artwork.backgroundColor)
if(w.mediaOverlayStyle=e?Jq:Tq,i(w.lockup)&&i(w.lockup.offerDisplayProperties)){const t=e?Jq:Tq
w.lockup.offerDisplayProperties=w.lockup.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Rj,t)}}w.adamId=f(h.content,"id")
const A=pe(e,t,mW)
if(i(A)){const n=Ks(e,A,u)
n.targetType=u.targetType,w.flowPreviewActionsConfiguration=ia(e,t,!1,null==s?void 0:s.clientIdentifierOverride,w.clickAction,u,n)}const T=Vh(e,null!==(l=h.content)&&void 0!==l?l:t,h.title,u)
if(i(h.onDevicePersonalizationDataProcessingType)){const e=Sh(T.recoMetricsData,h.onDevicePersonalizationDataProcessingType,null)
T.recoMetricsData=e}return i(h.appEvent)&&(T.inAppEventId=h.appEvent.appEventId,i(h.appEvent.lockup)&&(T.relatedSubjectIds=[h.appEvent.lockup.adamId])),i(s)&&Nh(e,w,T),w}personalizationDataContainerForEditorialCardItemsDataArray(e,t){var n,r
if(!bs(e))return null
const o=new Set
for(const e of t){const t=q(e,Xj)===x0,i=(null===(n=f(e,eW))||void 0===n?void 0:n.length)>0,s=(null===(r=j(e,Pb))||void 0===r?void 0:r.length)>0,a=de(e,mW,!1)
if(t&&!i&&!s&&a){const t=we(e,mW)
for(const e of t){const t=f(e,EU);(null==t?void 0:t.length)>0&&o.add(t)}}}return Ss(e,o)}}class m4{constructor(e,t,n,r,o,i,s){this.$kind="EditorialStoryCard",this.title=e,this.artwork=t,this.video=n,this.heading=r,this.badge=o,this.description=i,this.clickAction=s,this.shelfBackground=null,this.collectionIcons=null,this.editorialDisplayOptions={}}}class y4 extends i4{constructor(){super("GroupingEditorialStoryCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}shelfRoute(e){return Ac(this.supportedFeaturedContentIds,["shelfContentType=editorialStoryCard"])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&ls(0,j(t,MH))===iR}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,fH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,MH)
return o.shelfStyle=ls(0,i),o}_createShelf(e,t,n,r){const i=[]
for(const r of n.shelfContents){if(!W(r)||Yi(t)){t.remainingItems.push(r),t.isDeferring=!0
continue}const n=y4.makeStoryCard(e,r,t)
o(n)||(i.push(n),_h(t.metricsLocationTracker))}const s=new yJ(t.shelfStyle)
return s.title=t.title,s.items=i,s.isHorizontal=!0,s.background={type:fM},s.url=Zi(0,s,t),s.isHorizontal=!0,s}static makeStoryCard(e,t,n){let s=B(t,"editorialArtwork.subscriptionHero")
o(s)&&(s=B(t,CM))
const a=Xd(e,s,{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:O6.TodaySmallStoryCard})
if(r(a))return null
const c=j(t,AV),l=j(t,nq),u=j(t,jE),d=new m4(c,a,null,l,{type:sH,title:l},u),f=vo(e,t,null,new zZ(null==n?void 0:n.metricsPageInformation,null==n?void 0:n.metricsLocationTracker))
i(f)&&(d.clickAction=f.clickAction)
const h=be(a.backgroundColor)?Jq:Tq
return d.shelfBackground={type:fW,artwork:a,style:h},d}}class A4 extends MW{constructor(){super(...arguments),this.$kind="GameCenterDashboardAction",this.actionClass="GameCenterDashboardAction"}}class T4 extends i4{constructor(){super("GroupingGameCenterActivityFeedController"),this.batchGroupKey=MV,this.supportedFeaturedContentIds=new Set([F0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isGameCenterActivityFeedShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],activities:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=this.gameCategoryFilter(n.gamesFilter)
return await e.gameCenter.fetchActivityFeedCards(o,20).then(e=>({shelfContents:[],activities:e}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return om.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingActivityFeedShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.activityFeedShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingActivityFeedShelfForGrouping(e,t,n){if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const r=this.activityFeedShelfForGrouping(e,{shelfContents:[],activities:[]},t,n),o=wz.from(Ki(t))
return r.url=o.param(tz.isGameCenterActivityFeedShelf,bq).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}activityFeedShelfForGrouping(e,t,n,r){if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const o=this.activityFeedShelf(e,t.activities,n,r),i=e.loc.string("Arcade.ActivityFeed.RecentActivity")
return o.header=io(e,i),hs(e,o,o.seeAllAction),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o}activityFeedShelf(e,t,n,r=!1){const o=new yJ("gameCenterActivityFeedCard")
let i
return o.isHorizontal=!0,o.mergeWhenFetched=!0,o.batchGroup=this.batchGroupKey,o.items=t,o.isHidden=0===o.items.length,t.forEach((t,o)=>{const i={id:"friendActivity",idType:dW,targetType:"chiclet",kind:null,softwareType:r?Pq:null,title:"",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}
Nh(e,t,i)
const s=new EW,a=new EW,c=new EW,l=new EW,u=new EW;[{targetId:"playerName",metrics:s},{targetId:"profileImage",metrics:a},{targetId:"leaderboardAchievement",metrics:c},{targetId:RU,metrics:l},{targetId:t.adamID||"gameIcon",metrics:u}].forEach(t=>function(e,t,n,r,o){const i={actionType:bW,id:r,idType:dW,location:Ih(0,o,n)},s=_t(e,r,jq,i)
t.addMetricsData(s)}(e,t.metrics,n.title,t.targetId,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),t.profileActionMetrics=s,t.profileAvatarActionMetrics=a,t.leaderboardActionMetrics=c,t.achievementActionMetrics=l,t.appActionMetrics=u,_h(n.metricsLocationTracker)}),e.featureFlags.isGSEUIEnabled(HJ)||(i=new A4,i.title=e.loc.string("Arcade.ActivityFeed.AllActivity",e.loc.string(gH)),ea(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),o.seeAllAction=i,o}gameCategoryFilter(e){return e===kM?sR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,title:"Friend Activity",badges:{gameCenter:!0},idType:ab}}}class b4{constructor(){this.$kind="VideoCard",this.flowPreviewActionsConfiguration=null}}class S4 extends i4{constructor(){super("GroupingGameCenterContinuePlayingShelfController"),this.batchGroupKey="gameCenterContinuePlaying",this.supportedFeaturedContentIds=new Set([M0])}_supports(e,t,n,r){return super._supports(e,t,n,r)&&this.supportsVideoCardShelf(e,e.host.platform)}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isGameCenterContinuePlayingShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=Date.now(),i=this.maximumNumberOfRecentGamesToRequest(),s=e.gameCenter.fetchRecentlyPlayedGamesWithinSeconds(this.gameCategoryFilter(n.gamesFilter),i,e.bag.recentlyPlayedGamesWindowInSeconds)
return await s.then(async t=>{const n=Date.now()
let r
if(e.console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-o).toString(10)+" milliseconds."),0===t.length){const e={shelfContents:[]}
return await Promise.resolve(e)}{const n=new yY(e).withIdsOfType(t.slice(0,this.maximumNumberOfRecentGamesToShow()),yW).includingAgeRestrictions()
es(e,n),r=Ln(e,n,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Sm.timingValues]}))}return await r})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return om.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingContinuePlayingForGrouping(e,t):this.continuePlayingShelfForGrouping(e,n.shelfContents,t)}pendingContinuePlayingForGrouping(e,t){const n=this.continuePlayingShelfForGrouping(e,[],t)
if(!n)return null
const r=wz.from(Ki(t))
return n.url=r.param(tz.isGameCenterContinuePlayingShelf,bq).build(),n.batchGroup=this.batchGroupKey,n}continuePlayingShelfForGrouping(e,t,n){return Kv.context("continuePlayingShelfForGrouping",()=>{const r=this.videoCardContinuePlayingShelf(e,t,n)
return r.mergeWhenFetched=!1,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header=io(e,e.loc.string(Ib),n.subtitle),r})}supportsVideoCardShelf(e,t){switch(t){case gV:case ZG:case KV:return!0
default:return!1}}videoCardContinuePlayingShelf(e,t,n){return Kv.context("videoCardContinuePlayingShelf",()=>{const r=new yJ(Cb)
r.isHorizontal=!0,r.batchGroup=this.batchGroupKey
const o=[]
for(const r of t){if(at(e,r))continue
const t=this.editorialSplashVideoCardForContinuePlaying(e,r,n)
t&&o.push(t)}return r.items=o,r})}editorialSplashVideoCardForContinuePlaying(e,t,n){return Kv.context("editorialSplashVideoCardForContinuePlaying",()=>{var r
const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:cW},i=e.featureFlags.isEnabled(kJ)&&u(n.isArcadePage),s=Yf(e,t),a={metricsOptions:o,artworkUseCase:O6.LockupIconSmall,offerEnvironment:Jq,offerStyle:mq,canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:i,isSubtitleHidden:s&&!i},c=this.editorialSplashVideoWithTopShelfStill(e,t)
if(!c||!c.preview)return null
const l=Od(e,t,a)
if(!l)return null
l.clickAction=Tc(e,l.clickAction)
const d=this.clickActionForVideoCard(e,t,e.host.platform,o,n.clientIdentifierOverride)
if(!d)return null
const f=new b4
f.video=c,f.lockup=l,f.overlayStyle=Jq,f.clickAction=d
const h=Ks(e,t,o)
f.flowPreviewActionsConfiguration=ia(e,t,!0,n.clientIdentifierOverride,f.clickAction,o,h)
const p=Vh(e,t,l.title,o)
return Nh(e,f,p),null===(r=f.impressionMetrics)||void 0===r||delete r.fields[kb],f})}editorialSplashVideoWithTopShelfStill(e,t){return Kv.context("editorialSplashVideoWithTopShelfStill",()=>{let n=null
const r=Ke(e,t,SE)
return i(r)&&(n=Xd(e,r,{withJoeColorPlaceholder:!0,useCase:O6.VideoCardStill,cropCode:"sr"})),$f(e,t,n)})}clickActionForVideoCard(e,t,n,r,o){let i=Bd(e,t,Ks(e,t,r),o)
if(i=Tc(e,i),n===ZG){const n=new rK(t.id,rW)
Xs(e,n,{actionType:XV,id:t.id,contextualAdamId:t.id,anonymizationOptions:r.anonymizationOptions,pageInformation:r.pageInformation,locationTracker:r.locationTracker})
const o=new ZY(t.id,i)
return o.openAction=n,o.cancelAction=i,o}return i}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}gameCategoryFilter(e){return e===kM?sR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:bV,title:e.loc.string(Ib)}}}class P4 extends MW{constructor(e){super(),this.$kind="GameCenterAchievementsAction",this.actionClass="GameCenterAchievementsAction",this.bundleId=e}}class I4{constructor(e,t,n,r,o,i,s,a,c){this.$kind="GameCenterReengagement",this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class C4{constructor(e){this.$kind="GameCenterAchievementStatus",this.type=e}}class k4{constructor(e,t,n,r){this.$kind="GameCenterAchievement",this.id=e,this.title=t,this.subtitle=n,this.status=r}}class O4 extends i4{constructor(){super("GroupingGameCenterReengagementShelfController"),this.batchGroupKey=MV,this.supportedFeaturedContentIds=new Set([494])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isGameCenterReengagementShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],achievementData:null,achievementSummaryData:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchRengagementDataForLocalPlayer().then(async t=>{const n=f(t,HV),r=y(t[RU]),i=y(t.achievementSummary)
if(o(n)){const e={shelfContents:[],responseTimingValues:null,achievementData:null,achievementSummaryData:null}
return await Promise.resolve(e)}const s=new yY(e).withIdOfType(n,yW).includingAgeRestrictions()
return es(e,s),await Ln(e,s,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Sm.timingValues],achievementData:r,achievementSummaryData:i}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingGameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage):this.gameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage)}pendingGameCenterReengagementShelf(e,t,n,r){const o=this.gameCenterReengagementShelf(e,t,n,r)
if(!o)return null
const i=wz.from(Ki(n))
return o.url=i.param(tz.isGameCenterReengagementShelf,bq).build(),o.batchGroup=this.batchGroupKey,o}gameCenterReengagementShelf(e,t,n,r=!1){return Kv.context("gameCenterReengagementShelf",()=>{if(!s(t.shelfContents))return null
const o=new yJ("gameCenterReengagement")
o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=this.batchGroupKey
const i={id:n.id,kind:null,softwareType:r?Pq:null,targetType:Qq,title:Ob,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:bV,fcKind:n.featuredContentId,badges:{gameCenter:!0}},a=xf(e,t.shelfContents[0],O6.Uber)
let c=Se("componentBackground"),l=null
s(a)&&(l=a.preview,c=l.backgroundColor)
const u={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},offerStyle:mq,artworkUseCase:Qd(0,Lq),isSubtitleHidden:!0}}
Ch(0,i,i.title)
const d=Nd(e,t.shelfContents,u)[0]
d.clickAction=Tc(e,d.clickAction),Oh(n.metricsLocationTracker)
let f=null
s(d)&&(f=new P4(d.bundleId),f.title=Ob,Xs(e,f,i))
const h=e.loc.string("GameCenter.Reengagement.Badge.GameCenter"),p=this.achievementFromData(e,t.achievementData),w=this.achievementCountsFromData(e,t.achievementSummaryData),g=this.shelfMetadataForAchievement(e,p,w),v=new I4("gamecenter.fill",h,g.title,g.subtitle,p,d,c,l,f)
return o.items=[v],Nh(e,v,i),o})}achievementStatusFromData(e,t){const n=f(t,jV),r=new C4(n)
return r.percent=h(t,"percent"),r.date=f(t,cR),r.artwork=new bz(f(t,"artwork.template"),h(t,"artwork.width"),h(t,"artwork.height"),[]),r}achievementFromData(e,t){const n=f(t,"id"),r=f(t,Wq),o=f(t,NH),i=this.achievementStatusFromData(e,p(t,"status"))
return new k4(n,r,o,i)}achievementCountsFromData(e,t){return{completed:h(t,"completedAchievements"),total:h(t,"totalAchievements")}}shelfMetadataForAchievement(e,t,n){if(!i(t))return{title:"",subtitle:null}
if(0===n.completed)return{title:e.loc.string("GameCenter.Reengagement.Achievement.First.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.First.Subtitle")}
switch(t.status.type){case OM:case"hidden":case Eb:return{title:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Subtitle")}
case $V:const t=e.loc.stringWithCount("GameCenter.AchievementSummary.TotalToCompleteCount",n.total),r=e.loc.stringWithCount("GameCenter.AchievementSummary.NumberCompletedCount",n.completed),o=e.loc.string("GameCenter.AchievementSummary.CompletedCount.Subtitle").replace("@@completedCount@@",r).replace("@@totalCount@@",t)
return{title:e.loc.string("GameCenter.Reengagement.Achievement.CompletedCount.Title"),subtitle:o}
default:return{title:"",subtitle:null}}}}class E4 extends MW{constructor(e){super(),this.$kind="GameCenterInvitePlayerAction",this.actionClass="GameCenterInvitePlayerAction",this.invitationType=e}}class R4 extends MW{constructor(e){super(),this.$kind="GameCenterDenylistPlayerAction",this.actionClass="GameCenterDenylistPlayerAction",this.contactId=e}}class D4{constructor(e,t,n,r,o,i,s,a){this.$kind="SmallContactCard",this.id=e,this.title=t,this.subtitle=n,this.buttonText=r,this.contactId=o,this.buttonAction=i,this.removeButtonAction=s,this.shouldShowMessagesBadge=a}}class _4 extends MW{constructor(e){super(),this.$kind="LegacyGameCenterInvitePlayerAction",this.actionClass="LegacyGameCenterInvitePlayerAction",this.contactId=e}}class L4 extends i4{constructor(){super("GroupingGameCenterSuggestedFriendsController"),this.batchGroupKey=MV,this.supportedFeaturedContentIds=new Set([_0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:$W,path:`/${VW.grouping}/${VW.shelf}/{token}`,query:[tz.isGameCenterSuggestedFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{$kind:EM,shelfContents:[],suggestedFriends:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchSuggestedFriends(10).then(t=>e.clientCapabilities.isEnabled(Rb)?{$kind:EM,shelfContents:[],suggestedFriends:t}:{$kind:Db,shelfContents:[],suggestedFriends:t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return om.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingSuggestedFriendsShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.suggestedFriendsShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingSuggestedFriendsShelfForGrouping(e,t,n){if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const r=this.suggestedFriendsShelfForGrouping(e,{$kind:e.clientCapabilities.isEnabled(Rb)?EM:Db,shelfContents:[],suggestedFriends:[]},t,n),o=wz.from(Ki(t))
return r.url=o.param(tz.isGameCenterSuggestedFriendsShelf,bq).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}suggestedFriendsShelfForGrouping(e,t,n,r){if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
let o
return o=t.$kind===EM?this.suggestedFriendsShelf(e,t.suggestedFriends,n,r):this.legacySuggestedFriendsShelf(e,t.suggestedFriends,n,r),o.header=io(e,n.title,n.subtitle),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o.footerTitle=e.loc.string(z$),o.footerAction=oo({objectGraph:e,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker}),o.footerStyle={$kind:sq,bundleID:FN,width:16,height:16},o}suggestedFriendsShelf(e,t,n,r=!1){const o=_b
if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const i=new yJ(Lb)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=MV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i],l=e.loc.string(Mb),u=e.loc.string(xb),d={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
let f,h
c.supportsFriendingViaPush&&c.contactAssociationID?(f={contact:{contactID:c.contactID,contactAssociationID:c.contactAssociationID}},h=!1):(f={messages:{contactID:c.contactID}},h=!0)
const p=new E4(f)
Xs(e,p,{...d,actionType:$b})
const w=new R4(c.contactID)
Xs(e,w,{...d,actionType:Fb})
const g={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Nb,softwareType:r?Pq:null,anonymizationOptions:{anonymizationString:a}},v=new D4(c.contactID,c.fullName,u,l,c.contactID,p,w,h)
Nh(e,v,g),s.push(v),_h(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}legacySuggestedFriendsShelf(e,t,n,r=!1){const o=_b
if(e.client.deviceType!==lW&&e.client.deviceType!==oW)return null
const i=new yJ(Lb)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=MV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i]
c.buttonText=e.loc.string(Mb),c.subtitle=e.loc.string(xb)
const l={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
c.buttonAction=new _4(c.contactId),Xs(e,c.buttonAction,{...l,actionType:$b}),c.removeButtonAction=new R4(c.contactId),Xs(e,c.removeButtonAction,{...l,actionType:Fb}),Nh(e,c,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Nb,softwareType:r?Pq:null,anonymizationOptions:{anonymizationString:a}}),s.push(c),_h(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:bV}}}class M4{constructor(){this.$kind="HeroCarousel",this.items=[],this.rtlItems=[]}}class x4{constructor(){this.$kind="HeroCarouselItem"}isValid(){const e=(0,Jv.isSome)(this.collectionIcons)&&this.collectionIcons.length>0,t=(0,Jv.isSome)(this.artwork)&&this.artwork.isValid(),n=(0,Jv.isSome)(this.video),r=t||n||e,o=(0,Jv.isSome)(this.overlay)&&this.overlay.isValid()
return r&&o}}class $4{constructor(e){this.$kind="TitleEffect",this.isFallbackStyle=!1,this.type=e}}class F4{constructor(e,t,n){this.$kind="ArticlePage",this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class N4{constructor(e,t,n,r){this.$kind="RoundedButton",this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class B4{constructor(e,t,n=JV,r=null,o=null,i=null){this.$kind="FramedArtwork",this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===VF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class U4{constructor(e,t,n,r){this.$kind="Quote",this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class G4{constructor(e,t,n){this.$kind="HorizontalRule",this.style=e,this.color=t,this.isFullWidth=n}}class j4{constructor(e,t){this.$kind="AppShowcase",this.type=e,this.lockup=t}}class V4{constructor(e){this.$kind="InAppPurchaseShowcase",this.lockup=e}}class H4{constructor(e,t,n,r=!0){this.$kind="EditorialLink",this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class q4{constructor(e,t){this.$kind="ClientControlButton",this.title=e,this.buttonAction=t}}class W4{constructor(e,t){this.$kind="ArcadeShowcase",this.unsubscribedAction=e,this.subscribedAction=t}}class z4{constructor(e,t,n,r,o,i,s){this.$kind="UpsellBreakout",this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s}}class Y4{constructor(e,t,n,r,o,i){this.$kind="BreakoutDetails",this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class J4 extends MW{constructor(e,t,n,r,o){super(),this.$kind="ArcadeAction",this.actionClass="ArcadeAction",this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n,this.paymentMetricsOverlay=o}}class K4{constructor(e){this.$kind="InlineTodayCards",this.cards=e}}new Set([fW,sB,AH,t$,dq])
const Z4=new Set([Cj,fW,sB,AH,t$,dq]),Q4=new Set([Cj,fW,sB,AH,t$,dq]),X4=new Set([Cj,fW,AH,dq]),e5=(new Set([Cj,fW,uL,sB,dq]),Se(Dx)),t5=Se(Dx),n5=Se(Dx)
class r5{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1,this.allowUnpublishedAppEventPreviews=!1}}const o5=[hC,fC,pC,C_]
class i5{constructor(){this.$kind="HeroCarouselItemOverlay"}isValid(){const e=void 0!==this.callToActionText&&null!==this.callToActionText&&void 0!==this.clickAction&&null!==this.clickAction,t=void 0!==this.titleText&&null!==this.titleText,n=void 0!==this.lockup&&null!==this.lockup,r=void 0!==this.collectionIcons&&null!==this.collectionIcons
return t&&(n||r||e)}}class s5 extends i4{constructor(){super("GroupingHeroCarouselShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,MH)===nG}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,i){if(0!==i.shelves.length)return null
const a=new yJ(wj),c=t.featuredContentData,l={targetType:yq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(c)},u=new M4
u.autoScrollConfiguration={isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}
const d=Vh(e,c,wj,l)
d.autoAdvanceInterval=u.autoScrollConfiguration.autoScrollInterval,Nh(e,a,d),Ch(0,d,wj)
for(const i of n.shelfContents){if(r(i.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}const n=sh(e,i)
if(Mc(0,i)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(i),t.relationshipToFetch=RH
continue}const s={targetType:ON,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},a=Cc(e,i),c=Ic(e,i)
if(o(a.video)&&o(c.artwork))continue
const l=new x4,d=Xc(0,i),f=il(e,i),h=Vh(e,i,f,s)
h.isPreorder=et(e,d,Sq),Nh(e,l,h),Ch(0,h,f)
const p=a.artworkData||c.artworkData,w=a.backgroundColor||c.backgroundColor,g={metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,canDisplayArcadeOfferButton:rh(0,t.shelfStyle),lockupArtworkUseCase:Qd(0,t.shelfStyle),isContainedInPreorderExclusiveShelf:t.featuredContentId===L0}
l.overlay=rl(e,i,g),l.backgroundColor=w,l.titleEffect=$c(0,p),l.artwork=c.artwork,l.video=a.video
const v=xc(e,i),m={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i),targetType:ON,id:i.id}
v&&(Xs(e,v,m),l.clickAction=v),u.items.push(l),Oh(h.locationTracker),_h(h.locationTracker)}return s(u.items)&&(a.items=[u],i.pageTitleEffect=u.items[0].titleEffect),a.url=Zi(0,a,t),Oh(d.locationTracker),_h(d.locationTracker),a}}class a5 extends i4{constructor(){super("GroupingHorizontalCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&ls(0,j(t,MH))!==iR}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,MH)
return o.shelfStyle=ls(0,i),o}_createShelf(e,t,n,r){var o
const i=function(e){return t.remainingItems.push(e),!1}
let s
if(e.featureFlags.isEnabled(FJ)){const r=new zZ(t.metricsPageInformation,t.metricsLocationTracker)
s=Wc(e,null!==(o=n.shelfContents)&&void 0!==o?o:[],t.title,t.subtitle,r)}else{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation}
let o
if(t.shelfStyle===xV)o=t.shelfStyle
else switch(e.client.deviceType){case vW:case"tv":case BV:o=t.shelfStyle
break
case gW:o=qj
break
default:o=DU}s=qc(e,n.shelfContents,o,t.title,t.subtitle,r,i),s.contentType===xV&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Vc(0,e.media.kind,xV)))}return s.url=Zi(0,s,t),s.isHorizontal=!0,s}}class c5{constructor(e,t,n,r,o,i,s){this.$kind="LargeHeroBreakout",this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.collectionIcons=i,this.backgroundColor=s,this.editorialDisplayOptions={}}}class l5 extends i4{constructor(e=null){super(e||"GroupingLargeBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,MH)===_q}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}isInHeroPosition(){return!1}_createShelf(e,t,n,i){const a=s(i)&&o(i.pageTitleEffect)&&0===i.shelves.length,c=s(n.shelfContents)?[n.shelfContents[0]]:[],l=[]
for(const n of c){if(r(n.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const s={targetType:this.isInHeroPosition()?"heroBreakout":ON,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},c=Cc(e,n),u=Ic(e,n),d=c.artworkData||u.artworkData,f=l5.createLargeBreakout(e,n,t,this.isInHeroPosition(),a,s)
o(f)||(l.push(f),a&&(i.pageTitleEffect=$c(0,d)))}const u=new yJ(B$)
return u.isHorizontal=!1,u.items=l,u.url=Zi(0,u,t),0===i.shelves.length&&(u.presentationHints={isFirstShelf:!0}),u}static createLargeBreakout(e,t,n,r,i,s){const a=sh(e,t)
if(Mc(0,t)&&!W(a))return n.isDeferring=!0,n.remainingItems.push(t),n.relationshipToFetch=RH,null
const c=Cc(e,t),l=Ic(e,t)
if(o(c.video)&&o(l.artwork))return null
const u=c.backgroundColor||l.backgroundColor,d=r?null:j(t,"breakoutBadge")
let f
const h=j(t,nq)
f=et(e,t,SG)?e.loc.uppercased(ih(e,a,h)):h
let p={type:Iq};(null==f?void 0:f.length)>0&&(p={type:sH,title:f})
const w=Kf(e,t,AW)||Qe(e,a,AW),g=Kf(e,t,cV)||Qe(e,a,$j),v=kc(e,t,!0,0,!1),m=Ec(e,t,0,!1),y=new Y4(w,g,p,null,v,Rc(0,m,t)),A=new c5(y,{position:m||uW},d,l.artwork,c.video,null,u),T=Vh(e,t,A.details.title,s),b=et(e,Xc(0,t),Sq)
T.isPreorder=b,Nh(e,A,T),Ch(0,T,A.details.title)
const S=xc(e,t),P={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:TW,id:t.id}
return Xs(e,S,P),A.details.callToActionButtonAction=S,A.clickAction=S,Oh(s.locationTracker),A.flowPreviewActionsConfiguration=ia(e,t,!0,n.clientIdentifierOverride,S,s,P),A}}class u5 extends MW{constructor(e){super(),this.$kind="SearchAdAction",this.actionClass="SearchAdAction",this.action=e}}class d5 extends MW{constructor(e,t,n,r,o,i,s,a){super(),this.$kind="SearchAction",this.actionClass="SearchAction",this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.source=i,this.presentationStyle=null!=s?s:[nO],this.referrerData=a}}class f5 extends i4{constructor(){super("GroupingLinkShelfController"),this.supportedFeaturedContentIds=new Set([E0,u0])}initialShelfDataFromGroupingMediaApiData(e,t){let n=we(t,fH)
return o(n)&&(n=G(t,NN)),{shelfContents:n}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldHideShelf:H(t,"hide"),areContentLinks:s(we(t,fH))}
return o.clientIdentifierOverride=Nr(e,t),o}_createShelf(e,t,n,i){if(t.shouldHideShelf)return null
const s=[]
for(let a=0;a<n.shelfContents.length;a++){const c=n.shelfContents[a],l={targetType:jq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
t.areContentLinks&&(l.recoMetricsData=St(c))
let d=null
if(t.isSearchLandingPage){const n=this.trendingSearchLinkFromData(e,c,t.metricsLocationTracker)
if(r(n)||r(n.action))continue
Nh(e,null==n?void 0:n.action,{...l,kind:jq,softwareType:u(null==i?void 0:i.isArcadePage)?Pq:null,title:n.action.title,id:`${a}`,idType:Oq}),d=n}else{const n=is(e,c,t,!1,null,l,null)
if(o(n)||o(n.action.title))continue
d=n.action
const r=us(0,c)
r&&Nh(e,d,{...l,kind:jq,softwareType:u(null==i?void 0:i.isArcadePage)?Pq:null,title:d.title,id:r})}o(d)||(s.push(d),_h(t.metricsLocationTracker))}if(o(s))return null
if(t.isSearchLandingPage&&e.client.isPhone&&s.length>=6)for(const t of s)T(a=t)&&a[PW]===Hy&&(t.action.artwork=Ot(e,q$))
var a
const c=new yJ(cq)
return c.isHorizontal=!1,c.items=s,c.title=t.title,c.subtitle=t.subtitle,c.presentationHints={isWidthConstrained:!0},c.url=Zi(0,c,t),t.isSearchLandingPage&&(e.client.isPhone||e.client.isPad)&&(c.contentsMetadata={type:Y$,numberOfColumns:s.length>=6?2:1}),c}trendingSearchLinkFromData(e,t,n){const r=f(t,nq)
if((0,Jv.isNothing)(r)||0===r.length)return null
const o=new d5(r,r,null,jB)
return na(e,o,TW,n),_h(n),new u5(o)}}class h5 extends i4{constructor(e=null){super(e||"GroupingLockupShelfController"),this.supportedFeaturedContentIds=new Set([...j0,...Y0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,mW)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,fH)),{shelfContents:r}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return bc(e,t,n,r)}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(r.displayStyle=t.shelfStyle,t.featuredContentId===N0){const n=f(B(pe(e,t.featuredContentData,eE),mV),AW)
r.title=n,r.idType=bV,r.badges={forYou:!0},r.targetType="swooshBreakout"}return r}_createShelf(e,t,n,r){if(t.featuredContentId===N0){const t=!s(n.shelfContents),r=e.client.isPad
if(t||r)return null}return Sc(e,t,n,r)}}class p5 extends i4{constructor(){super("GroupingPersonalizedLockupShelfController"),this.supportedFeaturedContentIds=W0}shelfRoute(e){return Ac(this.supportedFeaturedContentIds,[`${tz.isOnDeviceRecommendationsShelf}?`,`${tz.onDeviceRecommendationsUseCase}?`])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,mW)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,fH)),{shelfContents:r||[],containsODPShelfContents:!1,recoMetrics:St(n),candidates:null,isHiddenShelf:!1,responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
const i=r[tz.onDeviceRecommendationsUseCase]
return(null==i?void 0:i.length)>0?await ps(e,i,IW).then(e=>({shelfContents:At(e.dataContainer),containsODPShelfContents:!0,recoMetrics:e.recoMetrics,candidates:e.candidates,isHiddenShelf:!1})).catch(async o=>o instanceof Z0?await p5.fetchODPFallbackContent(e,t,n,r).catch(e=>p5.makeHiddenShelfData(n)):p5.makeHiddenShelfData(n)):(null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0?await i4.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const n=yt(e,t),r=this.initialShelfDataFromGroupingMediaApiData(e,n)
return r.responseTimingValues=t[Sm.timingValues],r.shelfTitle=j(n,AW),r}):await i4.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>{const t={shelfContents:At(e)||[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!1,responseTimingValues:e[Sm.timingValues]}
return t.shelfTitle=n.title,t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=bc(e,t,n,r)
return this.addPersonalizationValuesToShelfToken(e,o,t,r),o}_createShelf(e,t,n,r){var s,a
if(!t.isValidRecommendationsShelf)return null
let c=null
if((0,Jv.isNothing)(t.title)&&(t.title=n.shelfTitle),n.containsODPShelfContents){c=this.personalizedShelf(e,n,t,r)
const o=(new wz).set(Wj,$W).path(`${VW.onDeviceRecommendations}`).param(tz.onDeviceRecommendationsUseCase,t.onDeviceRecommendationsUseCase).param(tz.token,JSON.stringify(t)).build(),i=new FY(SW,o)
i.title=e.loc.string(gH),i.pageData=this.odpSeeAllPage(e,n.shelfTitle,$2),hs(e,c,i),c.mergeWhenFetched=!1}else n.isHiddenShelf?c=p5.makeHiddenShelf(t):i(t.recommendationsHref)?(c=this.personalizedShelf(e,n,t,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t)):(c=Sc(e,t,n,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t))
const l=(0,Jv.isSome)(c.header),u=l&&o(null===(s=c.header)||void 0===s?void 0:s.title),d=!l&&o(c.title),f=(null===(a=n.shelfTitle)||void 0===a?void 0:a.length)>0
return u&&f?c.header.title=n.shelfTitle:d&&f&&(c.title=n.shelfTitle),c}personalizedShelf(e,t,n,r){const o=Rh(n.metricsLocationTracker)
o&&o.fcKind===n.featuredContentId&&Oh(n.metricsLocationTracker)
const i={id:n.id,kind:null,softwareType:u(null==r?void 0:r.isArcadePage)?Pq:null,targetType:yq,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:bV,fcKind:n.featuredContentId,recoMetricsData:t.recoMetrics,displayStyle:n.shelfStyle}
Ch(0,i,n.title)
const s=Sc(e,n,t,r)
return Oh(n.metricsLocationTracker),Nh(e,s,i),s}addPersonalizationValuesToShelfToken(e,t,n,r){const o=t.featuredContentId===R0
if(!r.hasAuthenticatedUser&&!t.isSearchLandingPage&&!o)return void e.console.log(`Skipping recommendations shelf with fcID ${t.featuredContentId}: No user logged-in`)
const i=j(n,K$)
if((null==i?void 0:i.length)>0)return t.onDeviceRecommendationsUseCase=i,t.recommendationsHref=n.href,void(t.isValidRecommendationsShelf=!0)
const a=s(we(n,mW)),c=!H(n,Ab)
!a&&c?(t.recommendationsHref=n.href,t.isValidRecommendationsShelf=!0):t.isValidRecommendationsShelf=a}addOnDeviceQueryParamsIfNecessary(e,t,n){var r
if(o(t))return null
if((null===(r=n.onDeviceRecommendationsUseCase)||void 0===r?void 0:r.length)>0){const e=new wz(t)
return e.param(tz.isOnDeviceRecommendationsShelf,bq),e.param(tz.onDeviceRecommendationsUseCase,n.onDeviceRecommendationsUseCase),e.build()}return t}odpSeeAllPage(e,t,n){const r=new yJ(n||$2)
r.isHorizontal=!1,r.items=Ub
const o=new bJ([r])
return o.isIncomplete=!0,o.title=t,o}static async fetchODPFallbackContent(e,t,n,r){return await new Promise((r,o)=>{const i=Xi(e,n)
if(!i){const e=`OnDeviceRecommendationsShelfController: Could not construct media API request for: ${t}`
return Kv.unexpectedType(BH,e,null),void o(new Error(e))}es(e,i),i.attributingTo(t.build()),Ln(e,i).then(t=>{const n=fe(yt(e,t),mW),o=St(n),i={shelfContents:At(n),containsODPShelfContents:!1,recoMetrics:o,candidates:null,responseTimingValues:t[Sm.timingValues]}
r(i)}).catch(e=>{const n=`OnDeviceRecommendationsShelfController: Failed to fetch fallback shelf contents: ${t}`
Kv.unexpectedType(BH,n,null),o(e)})})}static makeHiddenShelfData(e){return{shelfContents:[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!0}}static makeHiddenShelf(e){const t=new yJ(e.shelfStyle)
return t.isHidden=!0,t}}class w5{constructor(e,t){this.$kind="RibbonBarItem",this.title=e,this.clickAction=t,this.artwork=null,this.accessibilityLabel=null}}class g5 extends i4{constructor(){super("GroupingRibbonBarShelfController"),this.supportedFeaturedContentIds=new Set([556])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,o){var i
const s=[],a=new yJ(KE)
a.isHorizontal=!0
const c=ar(e,e.bag.arcadeCategoryBarSAGUpliftDisplayRate)
if(t.isArcadePage&&t.isFirstRender&&c){const n=g5.createSeeAllGamesRibbonItem(e,t.metricsPageInformation,t.metricsLocationTracker)
s.push(n),_h(t.metricsLocationTracker)}let l=null!==(i=n.shelfContents)&&void 0!==i?i:[];(0,Jv.isSome)(t.initialHydratedItems)&&t.initialHydratedItems.length>0&&(l=t.initialHydratedItems.concat(l))
const u=[]
let d=!1
for(const n of l){if(r(n.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(n),g5.shouldPriorizeItemWithData(e,n)&&(d=!0)
continue}let i=!1;(0,Jv.isSome)(t.featuredContentData)&&(i=(0,Xv.attributeAsString)(t.featuredContentData,MH)===uM)
const a=g5.createRibbonItem(e,n,t.metricsPageInformation,t.metricsLocationTracker,i,t,o);(0,Jv.isSome)(a)&&(g5.shouldPriorizeItemWithData(e,n)?s.unshift(a):s.push(a),u.push(n)),_h(t.metricsLocationTracker)}return a.items=s,d&&u.length>0&&(t.initialHydratedItems=u),a.url=Zi(0,a,t),a}static createRibbonItem(e,t,n,r,o,i,s){var a,c,l
const u={targetType:gj,pageInformation:n,locationTracker:r,recoMetricsData:St(t)}
let d
if(t.type===_V){if(!ji(e,tV))return null
d=ss(e,t)}else d=is(e,t,i,!1,null,u,s)
const f=Ks(e,t,u)
f.targetType=u.targetType
const h=Bd(e,t,f,null==i?void 0:i.clientIdentifierOverride),p=null!==(a=null==d?void 0:d.action)&&void 0!==a?a:h,w=null!==(c=Kf(e,t,AW))&&void 0!==c?c:(0,Xv.attributeAsString)(t,AW),g=null!==(l=null==d?void 0:d.title)&&void 0!==l?l:w,v=new w5(g,p),m=Sn(e,t)
let y
if(o)y=null
else if((0,Jv.isSome)(m))y=Xd(e,m,{useCase:O6.RibbonBarFacet})
else{let t
t=i.isArcadePage?"resource://arcade-ribbon-bar-fallback-icon":"resource://appstore-ribbon-bar-fallback-icon",y=Ot(e,t,36,36)}return v.artwork=y,v.accessibilityLabel=g,Nh(e,v,Vh(e,t,g,u)),v}static createSeeAllGamesRibbonItem(e,t,n){const r=e.loc.string("Arcade.CategoryBar.AllGames.Title"),o=to(e,hU,t,n,r,_N,Iq,gj),i=new w5(r,o),s=Ot(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACACAYAAADHy7H2AAABdWlDQ1BrQ0dDb2xvclNwYWNlRGlzcGxheVAzAAAokXWQvUvDUBTFT6tS0DqIDh0cMolD1NIKdnFoKxRFMFQFq1OafgltfCQpUnETVyn4H1jBWXCwiFRwcXAQRAcR3Zw6KbhoeN6XVNoi3sfl/Ticc7lcwBtQGSv2AijplpFMxKS11Lrke4OHnlOqZrKooiwK/v276/PR9d5PiFlNu3YQ2U9cl84ul3aeAlN//V3Vn8maGv3f1EGNGRbgkYmVbYsJ3iUeMWgp4qrgvMvHgtMunzuelWSc+JZY0gpqhrhJLKc79HwHl4plrbWD2N6f1VeXxRzqUcxhEyYYilBRgQQF4X/8044/ji1yV2BQLo8CLMpESRETssTz0KFhEjJxCEHqkLhz634PrfvJbW3vFZhtcM4v2tpCAzidoZPV29p4BBgaAG7qTDVUR+qh9uZywPsJMJgChu8os2HmwiF3e38M6Hvh/GMM8B0CdpXzryPO7RqFn4Er/QcXKWq8UwZBywAAAARjSUNQDA0AAW4D4+8AAAB4ZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAASAAAAAEAAABIAAAAAQACoAIABAAAAAEAAACCoAMABAAAAAEAAACAAAAAACBAcQEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIGaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yMTk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIxNjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KIUPY5gAAGmtJREFUeAHtXXuMJMV5r+qZ2Qe7h299bA7O3B0GGwOXBwEsbMXCC1H+QJjHgpbHEcyBEiLl4cgJxLKElIkUS4DtQCCSpZOSEAx3hjW+YwmclAfa4MQScfBL2Tg5ED5uyfFYw0Lu9nZvHl35/b7qmu3Z65numZ3dndnpupvt7np+31e/+qq6uuorpVKXSiCVQCqBVAKpBFIJpBJIJZBKIJVAKoF6EtD1ApcbZpRa0fxJHwpAMe3hVprfleS1ZRVlRkayqr8/ozbPa7Wh36gTW3118KBRw8NG7djR2sqamrJ0D73mqdmztRqY8QQKc8M+yirpfN5fSWgYA/zdOJarKnfoNQNabLkrwe/MjFbnnqvV9LRXkfGm+bLOT5ZaweuygWCuvLKXhOgDB060gqDl5mHyylNTY6SpoMfHy8vNL5ze5PPIe2pF8g6X08i9GRvrUacf0/qR5cm/aSCIUA5N9uhHJxcc4ebma7aoTHabMmYLNPZpaDcbAJE+hGfg13RZLn939Y0xnucVlPGPI/9ZlPUO7t9Qpb7XUfnHXDyza6QvTJ/zb+YqgD9woAAmRLuhAvpVdmG70t6ZyujTkecQaBnwld/jad0yXgNayyjjBCB+FGX8HH5vqkJxWo8/e9jxIoCYmfH1ZHMaoimCTR7dgJr0dV755o6xYVUo3YiKvgJEfgJyolAAANWjPKuxhdimSnJsLrm6jgY6GuVSHc/jbhbiP4xq+gGENqH37vtHpjK7dgEMj1bAuiSnRI8EgdN45pbRzyDX6wDyS5D4LFw/jDIHlNYefja/leCVOVt+i7gj2N/B7xXw+qLKZZ/Uj40LKAgINIYCwhpyDZNs7rorp3fvJjHK3Dx6p9LmbuXp86XSSajvs5oYTrXMSqIvZcRLSxwydCIH0lABymThw58UpMrl4xDQ8ypT/rJ+fOLV5WgGJ1gzduWwyvU+AAauA68bAQBwB5aMKYOeEoq2/LaQz4qwOCYBZ/ixZWVQak5D7Qjrvoj4Z/B/WD+x/yFcVRi4fE7imHlixwGhUz1m57V/CUK+IML3/XmQeYI1LjVkQDDIRNVL/ga1whsE0xvRws8n+yMWo8KFuxP6uWcXbiPhr0iDCRApi7JOUdlMRpXK00iyC9rhhWbA4Pg1t157AYh/Gt3eeQAZKxxdklQ8LsIjKygkS0un47eaboYt5WWRLysbKyOXOa+ShhLlP2SIH3lmmTkIfQCNERSZx1Qx+9vUCA7ACE/kyEAiZzgI4xsAnNl53UMqm/0CxF6EBkAfrUogrQe13YP7HpCHrgPjAotgkEgcoOO0fad9to8MQqDghF2rPCM9gYSfe+YVz4xHvyDfIF4GVwhDyu1FIHk6BhB8gJa7FTL/trn1+k9xrMBuAmGJHMdABL0Zu3obyj2gvAxB8AESUy2TPvLJH8smDSw3+JFGchPQKtfwPdPjORwuz6xOGw+PEkF4DvyQP8uB5pMye3GlvAENM6vK/hy6iM/72eJfw08JGKQL51O8o1ATOSCsH5nPm1tHb0eCR1E4+6HjATEWo4lyWoVI5Mq2nKKocd9Mqb7yp/XfTBwNd21JKDE7R19QWe9yAOs9xOcbAytbGkSS9Csex/JKFcOBbAYNdFCVS3ejm/g6/LTK53WS12kyFesCNTNvdl6FkbH5kiTQAQgokvYRi5DG/gEioIiyxi/PoZ3tUAven0hg4SA1VV1n7ro4xwgCeguC9/FIbWLFzsB2cVb27FuoHU5Aa6HT0F80O2/4OPyMOnIkll+ykggIiGcz0z03Ievz8eMoPFEBLGS1HWsrACdVbRndFwcPNxLI0kXw3bue2/2ynaQx5nehCRiTKjnIsl7CNQ0jJPqkm8hlPoLX6RtIDQf28qofQ1osEKANMuwSmA9e1H5d3g6UKUCwmBuIyX2tgwUR0oqL6HC3o9FcJiQtLHAME+lkgAhWzW2jv4gIv4IfB4bCq80uMlm7eLI+MYhExWhzBTW5JWwytp5jIyAjafnm86ObIMxz2bTg7LDfltK+fy1Q2UkUMd5C/24uFmLPss08kvDhYSuTkvokQM8xgaiEyLjt6ekFWuw8lfPPFBKPHI3FcDwQBgZsnEIZo2ezOQBCe4ogmiq+dPky8DbqYxJl06Xx6tIzO6Kza2NfO4eBhmvYdaOu/K1CrfsGUof0eCDMzVk0efoM5DOIH/vPWITVKXO1g0gr1CWclqlgJaPoyRrqkh+P6Hy9XUDfSZxaylGnmm9LPZiXxlQ/3FPjnPqqy0k8EAYGbPZKnYYsOXKmqqybKcLbz0mXZjaaO6/h9LfCnEg071uutl2BNsMSL5gUk/vO+MO6KXNGIqPVJpKMLt2+TNehP1oY4QRvv22BoD0KkGqns0RTBVnTr+Yx60h37FhVCL3YakLv3IP4tkXvTnPkCxqQF3Nqhfg/y5/EbyUMN/FAGBwMpGH6pJ/l9GhnQYH8BjzoHIa5diRtRwthWSiVt5qOb0pIgVlKbbuU6ljt/WSrO6gh+fKbiN54ICxmY+cN7IBk0bez7sCvtnxE0p23vjuwCESmjIl59x0gMkGbe9bjtZr0RoBQnbJLnoCIjuwfpHoaWAOSAiEW0J2sEWKZq0RIgVARRfRN56qDaH5q+aZAqCEZ+25Ud6BdI2VneqdAqFtv3aIPkrw+1hVUGrheJJBqhPVSk8vkIwXCMgW4XpKnQFgvNblMPlIgLFOA6yV5CoT1UpPL5CMFwjIFuF6Sp0BYLzW5TD5SICxTgOsleQqE9VKTy+Sju4DQPZ8OGoZFdwGhgU8Hss4P4uwW7HQXEBpuJ0zQwQtTGuA3BUIDwlrPUZMDwV8XLQOWG7z4DmKSVe747eAVSl7yxbfxQKgs+4YtBDqsjxVJxotTorfJH9fVl1WxYDe4vhpBWT5vuZqcxN4QE2zkcYCIiN++XpZf2q9I6OKB4JZ9e3oOwuFSf2ydIBwSlrDW0cKAhdE/1Z+z9pQqy/SrCUR0jBMF7tz42ylcLjJh+Q3Wmpu5xYD6d/FAOLrZCsMo2ggoQEpMExZv/RLaKVTDKtnMAi2ewAba0Ek8CADGxgKZwFobIdF5jnx5sl1PLM5JZdFgxkn8hlmLB4Lb+6j020jIVsJ9AXUzDRfQJvdYlS6V+q6zjqZmZ2ttXrH7HgxM2DFNJ+3jIIta9nlmxWCGljrDxp08OalbZ/FAGJgJMtBv4IatJD5Nm9R+QAbpB8286NfpJxZRxsejgRCMiXxP2VFEwD3TdYTjzm+Y+AHZ7wMM/ys019rwG2IovlJ7zrWbQgc3TQNVh4OWFYOvUAlrfSstBDt+YKUT28T/S8iZPZuW16KrOBg7QDA/oqUVOETtEGdHbtgA62UxxH0dw/ppofzcVthH2L27tGiASv8gkF8WBUS3qDaTmd3Harjf8V2A+HtC3uIO75OphS1n8SzkXkI/+xbQwrTRoDk59Zr5hAiELRvAWOvv673P0kor9HhgI7oOdbEaQVrO7CwrHq68Hy3r/3DD7fEwPkG/tnacBOD4gHz+u96z/0cQmFZnnVXTMil3Q7PrgLmg95DuOZ3xepCmRF5Dwm47pjkIgCOd/apYQgdRfpYeYgoogU3qWCAwM1g8PyF2B/dMvIiCngPiOKBKsOteUq/lH2qtHrRsvE+bB4WQsbG+0Nb3aNoqLShzP/rZBcgYecB0RnTs9vC13cIJmNfjtv/n1HkX/b0QNpKMvERAEMG99JKYnINhx7vxO4TZBNpLoBptx4ZCmggCDxZYqdof0Xue+SdnJhDPdR20QVmMiO15+hXg/R4YsuxHAlgdsR1N3cSrHCjCtwiF9Vt9GrTBDOrmXtFstMuc0Ix/IiCQN752iRnbb00cwSBqDGJBgd6HQIgTOgXPe6GNaVbRuXJJQ0AHbDNnswOqWN6LLuGPA1rswDcBYQQDoyHtX6lS8avI61T0MZQX8hdArDG/jgZcjRgLg3FwQwOot+vH9/04eDNKPLPYsLZzBp/NTaPnm4x5XGcyF0F9oiJgRl7DAB/JWn0wOD5YUbCJCGMYtNquzdf1E8+IoU1p4Qn6SqSvODKFjMmPglX2P4KQv4IfbRlyjEGgIIwVsurT0MAk/uG0AvQIOdRBBlr6FYwM7szt3fevYj0/P1l2tJP+OOcEGBevKjxQsbS1qNXO0buN9u+EMM6B9WDbfTC2AJaCopDwv6WOZBtmbMdIwUjJ1gnen43C24F/v+aYhjGtrcjE2iBMKsvgM4UK49y/hLt7UfTleMR5FEHBlldGY3T88L+lzvKLLDnwreSM+X5W9mF471XHyvfpCZgYXi0z/Y6KxVdKsE3DjtnSZyGDSxF+Pn4fAXE018uBC8HBltpqh/GJwakx+igynsH1Z3j+iSrr7+on9/2UhQld4+NFCGtZNYPEWo2N8U1C3jbMbVd/VJUzn0URF+J3NkJ/AddTUQrMC0Ej2YEbvFrmSD/VPFU/p/rfRBn/A2h+X/WbSdqYZknNgoBpF+HFpwadPcXlEE5xOflgDDnxZMg7RRVP6VWZEx5U17LKqiItA42Yy5RUrjyvtl00t/QtgK9MPF+qMp1clbj5BwEWvlG48yrCOSGMpgf7wWuupbyykIH+sppTBTUwcDxS1jipRs0NF924JkxX0vuWVA6EkAGROcXvEkNDpShBJSWomXgCyHfxVvPWIDVPWbVAC9SjQwDBsQin35dZAfXKqRUmA0HMjkr4zEzRnaFRK34S/5YAYWlBUjGc3+apZLOzK1KGfD3cglPkpnCGBL4boJBlqf+lPCR9DroNT9EA15EV5pen5o2M+PySuFb8JpVLGi+VQCqBVAKpBFIJpBJYHxJYkYFcOlhcAXBwaV0wWFz6utyK0loChPT1sbVHD8dVbNu9Pq7phFJ/L05lObGgtk1gQkk+NFXkl04oVUSR+KZpjVA1xcyDwjf2XYYp5k+h5PPwSzLFzLL57i9Xvo/jxj3DuzIv4OLRT1wQKXKKuYAp5t6VnmLeecPZmLe6DMQ0MsXs+JAvVHwIXBXPITm4cF4Zp/2mmDmzxnl30QgHf3gPiNyFejwHVdnAR6eKXAI+cRHn/Gs9O3/5umM/wbgPMfbjz/uQ2ve0b+7T33rmu4zNrqvZ6VdWDPPAH2NuueaX8SX6Xjxejt+m6I9OFQAzWcg5vsJXBrOOnV8oetWthPNP1UcnUMT1INOQxB5V6LkPPB5zdVOVPMEDM2/IVT5D3zZ6Po6gfVy182doo76m9+7/EhlsBgwEAQTEmsJn6Ou4puErWPTRiwoIfYaWcInDeKvkKp+hQWIOdYDP0OVXcLzEHfqJiX9b8c/Q7nxlc/M1l+CI3OchlGHj++GjUByw3HWV5FJphaEK4cKUTB9W7OwFGHaSkGbAIOluvfYBlcndo0ol7uvA52xZCsmyHJ/uyuir4Ryf0IE8cE9jraL+EACKownNGFZjPS8DSpxfCcJc3Lp0Jf48LJqA5yv/5vVnYGXSU/iwPIyVSh+gIAqB+fDHe/5W27lyQ3RAbZZKOC85cwuO9f2LgCCutUzkCBpGxGmwv6eyAgIu2uWaBpQhfVGb8Esc4FO/MVxsewq+gP8dzu6+UO9+uchP5+QhiSMzsU7GAoOD7I+w3sP/GhavfhRL1fgNnF/A1qLiSUk9R5rIm48zEKnGfx8rjH5DxjU447peQoY5zWFuuu4cCPirqljkfknml0hezGO1nAjftvl+0PpznctywcyfBzxgHIdP8glcMsampno52IIwP4M8P4fv7XaZFrHY3o78FaTFaPNFIXV8fEGAXY/uodesXDycg53JADhchqcS7Kevl+kKh9mteb3Qgsexcukq1Vu+SkqcTFZuLBAANlljINlpM4pxAU8Osy0kUe+TjJAVikWgYo8T1i8q9UmMbX4VHkYdOsSVzZGOIKFalQPRtQboRaNkk/W0kVmuimewWi6L67zOZqG4/WtYMNcquG6uHiGxQFB3XZyVg6a56kepi4OegN1EfNp6Ja9WGLUWV/na171PS7GVjb0RRLjT1U0Pl93x0FN2LaL52ln9OdpwxSY/n+rrEnPL1TyrEzu/Aw0nD9F/4iuzsMEOsLZs2oYstqIfsjm5kqPzbR9f2nPQ2H/Bv0rbY36HXsOCX1u5JxE6Pe1kciEGxQxuf73nmLDdA/Z5+iW812zHC8VWCTq4IZYHx7TL6uTr3HBQ5cUzEci181SzneRIP2gmDhTBrIIRdTTvFQMa5uOdxGSFVmu/4gS43YjxDWZ44bCqqSbwg4TRwggC5VLZMJrZjMy4KpkDxQAc4YhtfY/XbTYKc5osqiWpQ0O1eCd/5PCMQPt1Dq/ConTZJYAA7OJQd7oYIxmMUksYDLNugzsSWG2ERPBeqjsRCJYXowfVcB9XG2OH8MlrKaXVVOwmmKEACDZt5/wlcLG5hxfwAIc7Q2MZvK/l4oHwapDUNwPInHmybdneqFau7eQvUggI0qpXzRe5kzvybGh6C4PCn+Z8A9tYZzlb3cHOCj2QlPh4IFT6zOCDEiAgZdkCk5azpvFYuQEBGZXrsRMsH4sgybWakRFum2M8gN6yGxG7nb0sv+GPgDHUxgPBZeB1pEAc9e7KV6t4CI8wusO7fDV26Tvr6pvE9Zs4YmdJIKW2UQmkQIiV2LrQhLFcdhcQ4juFisAwOJDYbnBRCVinN90FhG6p1SbA2l1AaEJA3ZIkBUK31HQMnykQYgTULcEpELqlpmP4TIEQI6BuCU6B0C01HcNnCoQYAXVLcAqEbqnpGD5TIMQIqFuCUyB0S03H8JkCIUZA3RKcAqFGTWMtVld9mUiBUAMIzruBD5YuSUdeUyDEVlsHr1CK5W0xQgqERVlE3nXomkXLi04O4uRA8GU/A5eBdrK2xEYXY/ctRFZ73vrSrK8cm8f9csmFGZnlmnrW47WasHgguLOhPb1g1/lj6VbnDaQC8OJsJy3WTlRwqmO1NPJ2gChmdjSOD1bJF39WZ7SGT8H6ZcuJsccfJyAnHgib3ZHAPu0hYPNrh42nq8b+eh6G9GFVBK6yTF+e5A/QYipb5nl8sGwSWQzvkDtyjHrlRdO4h3V/mq+ShPN213ggLO4c5hmC3BnMTbF1M3WZt9VVKlW/7w65UDMz0Xs4jzxrN/362p6Z2Hnaj3XDA09xsTzI+suYDj0eCG7vo2/eRM7OSkonAYG0Cp8wlPAW7pW0epq7j3KzZ1uRaWNPve0kTi3l4AubkXy/gObKOlPqxjGP2i6KXednd/24p6jr3JwVWE/msCqZd6AuN9uxQlTktvTj8Naenq6DkQEO+dCPHMAYoI7TeqpOaHsG2YE8BsOG2/pgds+bFkKtfYQ6g+Qkm2Dt7melH9v3LiB1MOg3NTdAtr2zLYRvADQ2hfOE9MtC86GsVf9RDLguwy//ByzGua4wKmZb+qFafFiTI20/VUXvDSFySwvsI4jtpMAAFeT6z7TGAcT14L7c9i+SFqz8S+tih1SP+RcRTF8fLb5EOncsjt478RPw+GNEsqYA8NABjvv50A2SWPMCjYdZmmt0gyGG4scINrJVK8Xckyjkv6FyqHrqqppQGat+K/VvK46nt2YCyydP6Uf3vy+2IisCiiaN5oUlxJhv4OBP3pbr97DR+ayyLzlegMYegkGtN2A752mWL6aScd51HC2JgEBkmV27+nB9Txn/gSDTUyAcWiyzAIwraRXD5QWBHQJed7WXGQDN/6mKOUt3z9FYALvDyfTeZ/4WBjsnoWo3gkm+k7NHtBBbRX7qFmWp4V+2fpyoh27B6Af14xOvCq1btsTyy/wTAYERFU5YF9t9FI5RD0M4tEwGIWPixQTawYHCXSVh6I8l2nq4OLX8wuHuninj4kMM+EfjWbCb5G1EPz+L1vFbAPEx0QY0RJnAVeYTcrnbYatxGjaYPsw8UTwFbodlji53XZqvo9VdGe7uw2ncvQtbGs/lG4onlcxnmQEVK3dZlcsNQht8U+/dZw2M5kcySc92CBftiqt5lSPoYa6NEWDd8yGooT+UwaPv44BqAQRbDF9VZG42EBdjyzytna519+TBysVeOf6kOVk6N60b3oDqwl2YROQfJpeBS3DPkdIAgJqRCjR6FwTzgjMfjLDEzvGLE2AvAE3fhtlh2J8uc2x0HKW6lkaS2aBCsnQ8ktZqHuxz2H/pPcljGscvnwOeOafBf4s8s8wc6mBApF72vwnNR9Cz0YrhdKZO4kLEJ4kOCtB/OtVpbrn2DhBxN34XSD9MGPgyk8FWR0HZCmrxpAyKCQAjAyNUgsnChz/IDL9ymbOHBzCv8mWNE9/NH1zZG/u6WIN9J1AxVedl7kc1wNakNyTVTlZxLC/oKaFYxy8hwcpqnVvUPwRcBuXhPGiUyDPLOXg35hAKfVjv2fcgC3WG03mf1DUMBGZszbqO+FQ7ENSw6indCGKuADGfQCgNONEoZ08wSGMSCqd1zomZwBPVaOaROWwR493ZmB8CDBP6if3/wAJlbBNxUm0jxISBZG69/tcg/FGUdQnyOAtXWJqDBtKoFYKQbiV4Zb7CL76XwPAPfu/g9wqUx4so9ym95zuv45nmgxvSBExD1zTJ0ocemsRxwJOVDxuwbLpFZbLbQPAWkASbwGoDiuAbBs5LDqtIKbv5P2LGycNA1UfL17Mo6x0MCN9Qpb7XORZwGTfTHbi0S69ije3SA0WdFy1Hgfer7MJ2tMozURmnIz4MV0FFa8M3DrbcVjq8tcAMsIeZXaPeRcUfUYXitB5/9rArhADgtLl7/XX+Sa9NA8EV4MzVtfocZpd/o1c0Go0pVYKvAFC4frzRbCLjC/hhl3ol8o4sMIGnAOD0Y7rZrs8VsWwguIzcOUpq8zz0QD/eJbb6cirZML7t0+3Y4RS6S9L8dWrK0s2pU34bGJixLXBu2Ec5paQj5WYJELD9zl1ZVThoZyhZ7tBrBrTY9/VW8koiye8MjhzmEcu0DOtkvGm+rPN28N4sLy5dy4DgMgxfUfMrmj/LQgGtA1iY+CbuV5rfduK1CfGkSVIJpBJIJZBKIJVAKoFUAqkEUgmkEuhoCfw/vJfHMO4YqncAAAAASUVORK5CYII=",36,36)
var a
return i.artwork=s,i.accessibilityLabel=r,Nh(e,i,(a={targetType:gj,pageInformation:t,locationTracker:n,recoMetricsData:null},Kv.context("impressionOptionsForArcadeSeeAllGamesRibbonItem",()=>({...a,id:_N,idType:Iq,kind:null,softwareType:null,title:"All Games"})))),i}static createTagsRibbonShelf(e,t){const n=ge(t,lE),r=new yJ("ribbonFlow"),o=[]
for(const t of n){const n=(0,Xv.attributeAsString)(t,AW)
let r=null
switch(t.type){case BN:r=(0,Xv.attributeAsString)(t,eW)
break
case _V:r=Ni(e,f(t,CG))}if((0,Jv.isNothing)(r))continue
const i=e.required(O3).fetchFlowPage(r),s=new FY(i)
if(s.pageUrl=r,(0,Jv.isSome)(n)){const e=new w5(n,s)
o.push(e)}}return r.items=o,r.isHorizontal=!0,r}static shouldPriorizeItemWithData(e,t){var n,r
return null!==(r=null===(n=e.userDefaults)||void 0===n?void 0:n.bool(Gb))&&void 0!==r&&r&&e.bag.ribbonBarVisionEditorialItemIds.includes(t.id)&&e.bag.enableDeviceDrivenDiscoveryContent}}class v5{constructor(e,t,n){this.$kind="SmallBreakout",this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class m5 extends i4{constructor(){super("GroupingSmallBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,MH)===eq}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,o){const i=[]
for(const o of n.shelfContents){if(r(o.attributes)||Yi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}const n=sh(e,o)
if(Mc(0,o)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(o),t.relationshipToFetch=RH
continue}const s={targetType:Vb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)}
let a
const c=j(o,nq)
a=et(e,o,SG)?e.loc.uppercased(ih(e,n,c)):c
let l={type:Iq};(null==a?void 0:a.length)>0&&(l={type:sH,title:a})
const u=Kf(e,o,AW)||Qe(e,n,AW),d=Kf(e,o,cV)||Qe(e,n,$j),h=rf(e,n,{useCase:O6.ArcadeSmallBreakout,withJoeColorPlaceholder:!0}),p=ye(f(se(n,nt(e,o),fW),mB))||(null==h?void 0:h.backgroundColor),w=new Y4(u,d,l,null,Oc(0,p),null),g=new v5(w,h,p),v=Vh(e,o,g.details.title,s),m=et(e,Xc(0,o),Sq)
v.isPreorder=m,Nh(e,g,v),Ch(0,v,g.details.title)
const y=xc(e,o),A={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o),targetType:TW,id:o.id}
Xs(e,y,A),g.details.callToActionButtonAction=y,g.clickAction=y,Oh(s.locationTracker),g.flowPreviewActionsConfiguration=ia(e,o,!0,null==t?void 0:t.clientIdentifierOverride,y,s,A),i.push(g)}const s=new yJ(Vb)
return s.isHorizontal=!1,s.items=i,s.url=Zi(0,s,t),0===o.shelves.length&&(s.presentationHints={isFirstShelf:!0}),s}}class y5 extends i4{constructor(){super("GroupingTagBrickShelfController"),this.supportedFeaturedContentIds=new Set([B0,U0])}initialShelfDataFromGroupingMediaApiData(e,t){var n
return(0,Jv.isSome)(t)?{shelfContents:null!==(n=we(t,mW))&&void 0!==n?n:null}:{shelfContents:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>({shelfContents:e.data}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,bb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Nr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,MH)===eq,d=new yJ(Hb),p=h(t.featuredContentData.attributes,Sb)
if(d.rowsPerColumn=null!=p?p:Z(e),d.isHorizontal=!0,(0,Jv.isSome)(r.shelfContents))for(const n of r.shelfContents){const r=y5.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s);(0,Jv.isSome)(null==r?void 0:r.shortEditorialDescription)?((0,Jv.isSome)(r)&&a.push(r),_h(t.metricsLocationTracker)):(t.remainingItems.push(n),c.push(n))}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.contents.data"))&&(0,Jv.isSome)(t.featuredContentData.relationships)&&(t.featuredContentData.relationships[mW].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,IM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const w=u(t.featuredContentData.attributes,rR)
if(l&&w){const n=new yJ(W$)
n.items=a,n.presentationHints={isSeeAllContext:!0}
const r=new bJ([n])
r.title=t.title
const o=new FY(SW)
o.title=e.loc.string(gH),o.pageData=r,d.seeAllAction=o,ea(e,o,"",{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}return d&&o(d.items)&&t.isFirstRender&&tc(e,d,t,t.featuredContentId),t.presentationHints=d.presentationHints,d.url=Zi(0,d,t),d}static createBrick(e,t,n,r,o,s,a){var c,l,u
const d=null!==(c=St(t))&&void 0!==c?c:void 0,f={targetType:n?Jj:bG,pageInformation:r,locationTracker:o,recoMetricsData:d},h=ss(e,t)
if(!h){const e=new f4
return e.shortEditorialDescription=j(t,AW),e}const p=new f4,w=(O6.GroupingBrick,os(e,t,0,0,0,f))
if(w.length>0){const e=w[0].backgroundColor
p.collectionIcons=w,(0,Jv.isSome)(e)&&(null==e?void 0:e.type)===GV&&(p.backgroundColor=null!==(l=ah(e))&&void 0!==l?l:void 0)}p.accessibilityLabel=h.title,p.shortEditorialDescription=h.shortEditorialDescription,p.clickAction=h.action,435===q(t,Xj)&&(p.personalizationStyle=$N)
const g=pe(e,t,mW)
if(i(g)){const n=Ks(e,g,f),r=null!==(u=null==s?void 0:s.clientIdentifierOverride)&&void 0!==u?u:null
p.flowPreviewActionsConfiguration=ia(e,t,!0,r,p.clickAction,f,n)}return Nh(e,p,Vh(e,t,h.title,f)),p.artworkSafeArea=h4.defaultTileArtworkSafeArea,p.textSafeArea=h4.defaultTileTextSafeArea,p.isValid()?p:null}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,MH)===eq&&(r.title=nR),r}}class A5{constructor(e,t,n,r){this.impressionMetrics=null,this.badge=e,this.title=t,this.subtitle=n,this.$kind=null!=r?r:"PageHeader"}}class T5 extends A5{constructor(e,t,n,r,o,i,s,a,c,l){super(e,t,n,"MediaPageHeader"),this.artwork=r,this.video=o,this.collectionIcons=i,this.useGeneratedBackgroundGradient=s,this.backgroundColor=a,this.style=c,this.backgroundStyle=l}}class b5{constructor(e,t){this.$kind="TitledButton",this.title=e,this.action=t}}class S5{constructor(e){this.$kind="TitledButtonStack",this.buttons=e}}class P5{constructor(e,t,n){this.$kind="UnifiedMessage",this.placement=e,this.context=t,this.deliveryMethod=null!=n?n:"pushAndPull"}}const I5=[new c4,new d4,new p4,new g5,new w4,new v4,new y4,new S4,new s4,new O4,new L4,new T4,new s5,new a5,new l5,new f5,new h5,new p5,new m5,new a4,new class extends i4{constructor(){super("GroupingMediaPageHeaderShelfController"),this.supportedFeaturedContentIds=new Set([585])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,mW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await i4.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){var o
if(!ji(e,tV))return null
const i=n.shelfContents[0]
let s
if((0,Jv.isSome)(i)){s=null!==(o=null==r?void 0:r.pageTitle)&&void 0!==o?o:null
const t=Xd(e,p(_c(e,i),"categoryDetailStatic16x9"),{withJoeColorPlaceholder:!0,useCase:O6.Default,cropCode:"CDS.ApTCHM01"})
if((0,Jv.isSome)(s)&&(0,Jv.isSome)(t)){const e=be(t.backgroundColor),n=new T5(null,s,null,t,null,null,!1,null,null,e?Jq:Tq),r=new yJ(U$)
return r.items=[n],r}return null}return null}},new y5]
class C5{constructor(e,t,n,r,o,i,s,a){this.$kind="PrivacyType",this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class k5{constructor(e,t,n,r,o=[]){this.$kind="PrivacyCategory",this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}class O5{constructor(e,t,n){this.$kind="PrivacyPurpose",this.identifier=e,this.title=t,this.categories=n}}class E5{constructor(e,t){this.$kind="PrivacyHeaderSupplementaryItem",this.bodyText=e,this.action=t}}class R5{constructor(e,t,n,r,o,i){this.$kind="PrivacyHeader",this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class D5{constructor(e,t=JV){this.$kind="StyledText",this.rawText=e,this.rawTextType=t}}class _5{constructor(e,t){this.$kind="LinkableText",this.styledText=e,this.linkedSubstrings=t}}class L5{constructor(e,t,n){this.$kind="PrivacyFooter",this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class M5{setShelfId(e,t){this.shelfId=e,this.index=t,P2.has(e)&&(this.section=new mJ(IW,e))}}class x5{constructor(e,t){this.$kind="AccessibilityParagraph",this.text=e,this.actions=t}}class $5{constructor(e,t,n){this.$kind="AccessibilityFeatures",this.title=e,this.artwork=t,this.features=n}}class F5{constructor(e,t,n){this.$kind="AccessibilityFeature",this.title=e,this.description=t,this.artwork=n}}class N5{constructor(e,t={}){this.$kind="AnnotationItem",this.text=e,this.heading=t.heading,this.headingArtworks=t.headingArtworks,this.listText=t.listText,this.textPairs=t.textPairs}}class B5{constructor(e,t,n,r){this.$kind="Annotation",this.title=e,this.summary=n,this.items=t,this.items_V3=[],this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class U5{constructor(e,t,n,r,o,i,s){this.$kind="ProductCapability",this.type=e,this.title=t,this.caption=n,this.captionTrailingArtwork=r,this.linkAction=o,this.artwork=i,this.artworkTintColor=s}}const{routes:G5,makeCanonicalUrl:j5}=fc(Si,"/{platform}/story/{id}"),{routes:V5,makeCanonicalUrl:H5}=dc(Si,"/story/{id}")
class q5{constructor(e,t,n){this.$kind="AnnotationGroup",this.title=e,this.annotations=t,this.forceExpanded=n}}class W5{constructor(e){this.$kind="InformationContainer",this.annotationGroups=e}}const z5=[gu,mu,Fl,Hl,yu,Nl,Wl,eu,Xl,Ql,Gl,Au,zl,Yl,tu,ql],Y5=[mu,Fl,Hl,yu,Nl,Wl,eu,Xl,Ql,Gl,Au,zl,gu,Yl,tu,ql],J5=[gu,Fl,function(e,t,n,r,o,i){const s=Ze(e,t,gU)
if(0===s.length)return null
const a=s[0]
let c=null
const l=f(a,hU)
if(l){const t=e.loc.string("ProductPage.VersionAnnotation.Value.DateFormat")
c=e.loc.formatDate(t,new Date(l))}const u=f(a,VD)
if(0===s.length)return null
let d
if(u&&c)d=e.loc.string("ProductPage.VersionAnnotation.Value").replace("@@version@@",u).replace(OA,c)
else{if(!u)return null
d=u}const h=new N5(d),p=o?"":e.loc.string("ProductPage.VersionAnnotation.Title"),w=new B5(p,[h])
return w&&!r?w:null},mu,Yl,ql],K5=[Nl,Xl,Gl,function(e,t,n,r,o,i){const s=[],a=Ul(e,t);(0,Jv.isSome)(a)&&s.push(a)
const c=Vl(e,t)
if((0,Jv.isSome)(c)&&s.push(c),0===s.length)return null
const l=e.loc.string("InfoList.AgeRating.Title.KR"),u=new B5(l,s)
return u.shouldAlwaysPresentExpanded=!0,u}]
class Z5{constructor(e,t,n,r){this.$kind="ProductDescription",this.paragraph=e,this.developerAction=r,this.tags=n,this.developerLinks=t}}class Q5{constructor(e,t,n,r){this.$kind="ProductPageLink",this.text=e,this.clickAction=t,this.systemImageName=n,this.adamIdForPurchaseHistoryFilter=r}}const X5="safari",e6="hand.raised.fill",t6="doc.plaintext",n6="questionmark.circle",r6="exclamationmark.triangle",o6="checkmark.seal"
class i6{constructor(e,t){this.$kind="EditorialQuote",this.text=e,this.attribution=t}}class s6 extends MW{constructor(e){super(),this.$kind="GameCenterPlayerProfileAction",this.actionClass="GameCenterPlayerProfileAction",this.playerId=e}}class a6{constructor(e,t,n,r,o){this.$kind="InformationRibbon",this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class c6{constructor(e,t,n,r,o,i,s,a,c,l=WH){this.$kind="Badge",this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r,this.isMonochrome=!0}}const l6="DeveloperPageIntent",u6=[Eu,ju,ku,Fu,Nu,Mu,function(e,t,n,r){var o
return null!==(o=Ru(e,t))&&void 0!==o?o:Du(e,t)},$u],d6=[Gu,xu,Ou,Eu,ju],f6=[Gu,Eu,ju,Ru,function(e,t,n,r){if(!et(e,t,LB))return null
const o=e.loc.string("BADGE_FRIENDS_HEADING","Friends"),i=wW,s=Cq,a=Cq,c={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:t.id}
return new c6(s,a,c,i,o,"",null,"",o,WH)},Ou,ku,Fu,Nu,Mu,Du,$u,function(e,t,n,o){if(st(e).isSystemAppFromData(t))return null
const i=Lf(e,t)
if(r(i)||r(i.fileSizeByDevice))return null
const s=function(e,t){let n
if(n=(0,Zv.isSome)(t.maxEssentialInstallSizeInBytes)?t.fileSizeByDevice+t.maxEssentialInstallSizeInBytes:(0,Zv.isSome)(t.maxInstallSizeInBytes)?t.fileSizeByDevice+t.maxInstallSizeInBytes:t.fileSizeByDevice,n<=0)return null
const r=e.loc.fileSize(n).trim().split(/\s+/)
return 2!==r.length?null:{size:r[0],unit:r[1]}}(e,i)
if(!s)return null
const a={paragraphText:s.size},c=s.unit,l=e.loc.string("BADGE_SIZE_HEADING")
return new c6(Hj,JN,a,wW,l,c,null,null,c,IV)}]
class h6{constructor(e){this.componentType=zF,this.$kind="ProductRatingsAndReviewsMessage",this.messageText=e}}class p6{constructor(){this.$kind="ProductReviewAction"}}class w6{constructor(){this.$kind="ProductWriteAReview"}}class g6{constructor(){this.$kind="ProductReviewActions",this.componentType="productReviewActions"}}class v6{constructor(e,t,n){this.$kind="TitledParagraph",this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}!function(e){e.StoryCenteredMotion16x9="storyCenteredMotion16x9",e.StoryCenteredStatic16x9="storyCenteredStatic16x9",e.StoryDetailMotion3x4="storyDetailMotion3x4",e.StoryDetailStatic3x4="storyDetailStatic3x4",e.HeroMotion16x9="heroMotion16x9",e.HeroStatic16x9="heroStatic16x9",e.HeroMotionRTL16x9="heroMotionRTL16x9",e.HeroStaticRTL16x9="heroStaticRTL16x9",e.LargeBreakoutMotion16x9="largeBreakoutMotion16x9",e.LargeBreakoutStatic16x9="largeBreakoutStatic16x9",e.LargeBreakoutRTLMotion16x9="largeBreakoutRTLMotion16x9",e.LargeBreakoutRTLStatic16x9="largeBreakoutRTLStatic16x9",e.StoryCardMotion3x4="storyCardMotion3x4",e.StoryCardStatic3x4="storyCardStatic3x4",e.StorySearchStatic16x9="storySearchStatic16x9",e.SubscriptionHero="subscriptionHero",e.UniversalAMotion16x9="universalAMotion16x9",e.UniversalAStatic16x9="universalAStatic16x9",e.BrickStatic16x9="brickStatic16x9",e.BrickStaticRTL16x9="brickStaticRTL16x9",e.SearchCategoryBrick="searchCategoryBrick"}(Gm||(Gm={})),function(e){e.Hero="hero",e.LargeBreakout="largeBreakout",e.StoryCard="storyCard",e.StoryDetail="storyDetail",e.StoryDetailLandscape="storyDetailLandscape",e.Search="search",e.Brick="brick",e.EditorialLockup="editorialLockup",e.EditorialPage="editorialPage"}(jm||(jm={}))
const m6={hero:[Gm.HeroMotion16x9,Gm.HeroStatic16x9,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],largeBreakout:[Gm.LargeBreakoutMotion16x9,Gm.LargeBreakoutStatic16x9,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyCard:[Gm.StoryCardMotion3x4,Gm.StoryCardStatic3x4,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyDetail:[Gm.StoryDetailMotion3x4,Gm.StoryDetailStatic3x4,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyDetailLandscape:[Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9,Gm.StoryDetailMotion3x4,Gm.StoryDetailStatic3x4],search:[Gm.StorySearchStatic16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAStatic16x9],brick:[Gm.BrickStatic16x9,Gm.HeroStatic16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAStatic16x9,Gm.SearchCategoryBrick],editorialLockup:[Gm.SubscriptionHero],editorialPage:[Gm.StoryCardStatic3x4,Gm.HeroStatic16x9,Gm.StoryCenteredStatic16x9,Gm.SubscriptionHero]},y6={hero:[Gm.HeroMotionRTL16x9,Gm.HeroStaticRTL16x9,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],largeBreakout:[Gm.LargeBreakoutRTLMotion16x9,Gm.LargeBreakoutRTLStatic16x9,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyCard:[Gm.StoryCardMotion3x4,Gm.StoryCardStatic3x4,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyDetail:[Gm.StoryDetailMotion3x4,Gm.StoryDetailStatic3x4,Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9],storyDetailLandscape:[Gm.StoryCenteredMotion16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAMotion16x9,Gm.UniversalAStatic16x9,Gm.StoryDetailMotion3x4,Gm.StoryDetailStatic3x4],search:[Gm.StorySearchStatic16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAStatic16x9],brick:[Gm.BrickStaticRTL16x9,Gm.HeroStatic16x9,Gm.StoryCenteredStatic16x9,Gm.UniversalAStatic16x9,Gm.SearchCategoryBrick],editorialLockup:[Gm.SubscriptionHero],editorialPage:[Gm.StoryCardStatic3x4,Gm.HeroStatic16x9,Gm.StoryCenteredStatic16x9,Gm.SubscriptionHero]}
class A6{constructor(e){this.$kind="MetadataRibbonItem",this.viewType=e,this.moduleType=null,this.labelText=null,this.borderedText=null,this.highlightedText=null,this.starRating=null,this.secondaryViewPlacement=uW,this.artwork=null,this.maxCharacterCount=null,this.truncationLegibilityCharacterCountThreshold=null,this.allowsTruncation=null}}const T6={chartPositions:function(e,t,n,r,i){var s,a
const c=function(e,t){const n=Ke(e,t,ID)
if(o(n))return null
const r=Bf(0,e.host.clientIdentifier)
return o(r)?null:p(n,r)}(e,t)
if(o(c))return null
const l=h(c,JM)
if((0,Zv.isNothing)(l)||l>50)return null
const u=null!==(s=f(c,"genreShortName"))&&void 0!==s?s:f(c,HP)
if(null!=u){if(r.has(u))return null
r.add(u)}let d
d=e.bag.isLLMSearchTagsEnabled?new A6("highlightedText"):new A6("borderedTextLabel"),d.moduleType=ID
const w=(0,Zv.isSome)(null===(a=n.searchAdOpportunity)||void 0===a?void 0:a.searchAd)||(0,Zv.isSome)(n.searchAd)?e.bag.adsOverrideLanguage:null,g=(0,Zv.isSome)(w)?e.adsLoc:e.loc
{const t=g.string("MetadataRibbon.ChartPosition").replace(iC,e.loc.formattedCountForPreferredLocale(e,l,w))
e.bag.isLLMSearchTagsEnabled?(d.highlightedText=t,d.labelText=g.string("MetadataRibbon.ChartPositionAndCategory.Tags").replace(iC,e.loc.formattedCountForPreferredLocale(e,l,w)).replace("@@category@@",u)):(d.labelText=u,d.borderedText=t)}return d.secondaryViewPlacement=uW,Bh(e,d,qh(i,bx,d.labelText,dW)),[d]},genreDisplayName:function(e,t,n,r,i){const s=Sn(e,t,!0),a=(0,Jv.isSome)(s),c=kd(e,t)
if(o(c))return null
if(null!=c){if(r.has(c))return null
r.add(c)}const l=new A6(a?Fx:_F)
if(l.moduleType=hV,l.labelText=c,a){const t=Xd(e,s,{useCase:O6.CategoryIcon})
t.crop="sr",l.artwork=t}return Bh(e,l,qh(i,hV,l.labelText,dW)),[l]},genreShortDisplayName:function(e,t,n,r,o){const i=Sn(e,t,!0),s=(0,Jv.isSome)(i),a=j(t,RF)
if(null!=a){if(r.has(a))return null
r.add(a)}if((0,Jv.isNothing)(a)||0===a.length)return null
const c=new A6(s?Fx:_F)
return c.moduleType=RF,c.labelText=a,s&&(c.artwork=Xd(e,i,{useCase:O6.CategoryIcon,cropCode:"sr"})),Bh(e,c,qh(o,hV,c.labelText,dW)),[c]},secondaryGenreShortDisplayNames:function(e,t,n,r,i){const s=G(t,s_)
return o(s)?null:s.map(t=>{const n=new A6(_F)
n.moduleType=RF,n.labelText=t
const r=qh(i,hV,n.labelText,dW)
return Bh(e,n,r),_h(i.locationTracker),n}).filter(e=>null!=e.labelText&&!r.has(e.labelText))},developerInfo:function(e,t,n,r,o){var i
let s=n.developerName
if((0,Jv.isNothing)(s)&&(s=null!==(i=j(t,pH))&&void 0!==i?i:j(t,Xb)),null!=s){if(r.has(s))return null
r.add(s)}if((0,Jv.isSome)(s)&&s.length>0){const t=new A6(Fx)
t.moduleType=sC,t.labelText=s,t.artwork=Ot(e,Px)
const n=6
return t.maxCharacterCount=16,t.truncationLegibilityCharacterCountThreshold=Math.min(n,s.length),t.allowsTruncation=s.length>=n,Bh(e,t,qh(o,sC,t.labelText,dW)),[t]}return null},editorialBadgeInfo:function(e,t,n,r,o){var i
if(n.isEditorsChoice){const t=new A6(UH)
return t.moduleType=kG,t.useAdsLocale=((0,Zv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd)||(0,Zv.isSome)(n.searchAd))&&(0,Zv.isSome)(e.bag.adsOverrideLanguage),Bh(e,t,qh(o,kG,"Editors Choice",dW)),[t]}return null},userRating:function(e,t,n,r,o){const s=et(e,t,Sq)
if(i(n.ratingCount)&&i(n.rating)&&!s){const t=new A6("starRating")
return t.moduleType=JU,t.starRating=n.rating,t.labelText=n.ratingCount,Bh(e,t,qh(o,JU,"User Rating",dW)),[t]}return null},supportsGameController:function(e,t,n,r,o){var i
let s=!1
switch(Qe(e,t,Oj)){case i$:case TL:s=!0}if(et(e,t,A_)&&(s=!0),!s)return null
const a=new A6(Fx)
a.moduleType=A_
const c=((0,Zv.isSome)(n.searchAd)||(0,Zv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd))&&(0,Zv.isSome)(e.bag.adsOverrideLanguage)
return a.labelText=c?e.adsLoc.string(KB):e.loc.string(KB),a.artwork=Ot(e,QN),Bh(e,a,qh(o,A_,"Supports Game Controller",dW)),[a]},tag:function(e,t,n,r,o){const i=t,s=new A6(_F)
return s.moduleType=X$,s.labelText=j(i,AW),(0,Jv.isNothing)(s.labelText)||0===s.labelText.length||r.has(s.labelText)?null:(Bh(e,s,qh(o,i.id,s.labelText,"tag_id")),r.add(s.labelText),[s])},divider:function(e,t,n,r,o){const i=new A6(aC)
return i.moduleType=aC,i.labelText="|",[i]}},b6=0,S6=1,P6=2,I6=3,C6=4,k6=5,O6={Default:0,LockupIconSmall:1,LockupIconMedium:2,LockupIconLarge:3,LockupScreenshots:4,ArcadeSmallBreakout:5,ArcadeLargeBreakout:6,ArcadeContextualUpsell:7,SearchIcon:8,SearchEditorialResult:9,ProductPageIcon:10,ProductPageScreenshots:11,ProductPageBadge:12,ArticleImage:13,ArticleScreenshots:14,TodayCardMedia:15,TodaySmallStoryCard:16,TodayCardBrandedTitle:17,GroupingBrick:18,GroupingHero:19,CategoryIcon:20,Uber:21,TVTopShelf:22,VideoCardStill:23,ArcadeWelcomeSheet:24,WidgetLockupIcon:25,WidgetEditorial:26,ImageLockup:27,CategoryBreakoutShelf:28,RibbonBarFacet:29,MediaPageHeader:30}
class E6{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}!function(e){e[e.seeAllPage=0]="seeAllPage",e[e.categoryBreakout=1]="categoryBreakout",e[e.other=2]="other"}(Vm||(Vm={}))
class R6{constructor(e,t){this.videos=e,this.mediaPlatform=t}}const D6=new Dz(414,896),_6=new Dz(375,812),L6=new Dz(414,736),M6=new Dz(375,667),x6=new Dz(320,568),$6=new Dz(320,480),F6=(new Dz(768,1024),new Dz(810,1080)),N6=new Dz(834,1112),B6=new Dz(834,1194),U6=new Dz(1194,834),G6=new Dz(1024,1366),j6=new Dz(1024,1366),V6=new Dz(1366,1024),H6=new Dz(744,1133),q6=new Dz(1133,744),W6=new Dz(1032,1376),z6=new Dz(1376,1032),Y6=new Dz(834,1210),J6=new Dz(1210,834),K6=new Dz(312,390),Z6=new Dz(368,448),Q6=new Dz(396,484),X6=new Dz(410,502),e3=new Dz(416,496),t3=new Dz(410,502),n3=new Dz(820,1180),r3=new Dz(360,780),o3=new Dz(390,844),i3=new Dz(428,926),s3=new Dz(393,852),a3=new Dz(430,932),c3=new Dz(402,874),l3=new Dz(440,956),u3=new Dz(420,912),d3=new Dz(422,514),f3=[TE,yE,AE,nM,ET,OT,kT,Uq],h3=112.5,p3=4.5,w3="#9BA9BD",g3={colorHex:w3,maxSaturation:4,maxBrightness:9},v3=[g3],m3=[{colorHex:"#F7816F",minHue:0,maxHue:16},{colorHex:"#FF9034",minHue:17,maxHue:33},{colorHex:"#E3B059",minHue:34,maxHue:59},{colorHex:"#74BD66",minHue:60,maxHue:129},{colorHex:"#72C792",minHue:130,maxHue:169},{colorHex:"#61BFE2",minHue:170,maxHue:209},{colorHex:"#6EA3E9",minHue:210,maxHue:239},{colorHex:"#7D69FA",minHue:240,maxHue:259},{colorHex:"#B363F7",minHue:260,maxHue:289},{colorHex:"#EE7CBD",minHue:290,maxHue:360}]
class y3{constructor(){this.position=0}}class A3 extends KY{constructor(e,t){super(e.fields,e.id,e.custom||{}),void 0!==this.custom&&(this.custom.isFast=t),this.isFast=t}}const T3="::"
class b3{constructor(e,t,n=0){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t,this.sequenceId=n}addImpressionsToShelf(e,t,n,r,o,i,s){Nh(e,t,{id:null!=r?r:`${this.sequenceId}`,idType:null!=o?o:Oq,kind:null,softwareType:null,targetType:n,title:null!=s?s:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,recoMetricsData:i}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n,r){t&&(Nh(e,t,{id:b3.similarItemsShelfId,kind:null,softwareType:null,targetType:n,title:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:r}),this.sequenceId++)}static resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,t){const n=t.sourceLocationTracker
Dh(n,0),Rh(n).id=b3.similarItemsDuringDownloadShelfId}static addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,t,n){t&&Nh(e,t,{id:b3.similarItemsDuringDownloadShelfId,kind:null,softwareType:null,targetType:hq,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:VU})}}b3.similarItemsShelfId=MG,b3.similarItemsDuringDownloadShelfId=PO
const S3="write-review",P3=qq,I3="appPromotionRequirementKey"
Pe(ye("F0F0F8"),ye("303031")),function(e){e.MoreByDeveloper="moreByDeveloper",e.SimilarItems="similarItems",e.SmallStory="smallStory"}(Hm||(Hm={})),function(e){e.SelectionOnly="selectionOnly",e.PurchaseAndOpen="purchaseAndOpen"}(qm||(qm={}))
class C3{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.isFirstRender=!0,this.isBundleShelf=!1,this.showingPlaceholders=!1,this.productId=e,this.onDemandShelfType=d,this.remainingItems=t,this.title=n,this.shouldInferSeeAllFromFetchesItems=r,this.capabilities=o,this.contentType=i,this.offerStyle=s,this.spotlightInAppProductIdentifier=a,this.refreshUrl=c,this.recoMetricsData=l,this.supportsArcade=u}static fromJSON(e,t){if((0,Zv.isNothing)(t))throw new Error("tokenJson is required")
const n=JSON.parse(t,(t,n)=>typeof n===vV&&"adPageInfo"===t&&s(n)&&(0,Zv.isSome)(e)?s1.from(e,n):n)
return n}}const k3=[Cj,AH,fW,dq],O3=(0,Qv.makeMetatype)("app-store:page-router")
class E3{constructor(){this.registeredBuilders=new Set,this.pageRouter=new mz,this.shelfRouter=new mz,this.paginationRouter=new mz}registerPageBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.pageRouter.associate(t.pageRoute(e),t),this.shelfRouter.associate(t.shelfRoute(e),t),this.paginationRouter.associate(t.paginationRoute(e),t)}registerShelfBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.shelfRouter.associate(t.shelfRoute(e),t)}registerPaginationBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.paginationRouter.associate(t.paginationRoute(e),t)}fetchFlowPage(e){const t=this.pageRouter.routedObjectForUrl(e)
if(!t.object)return"unknown"
const n=t.object
return n.builderClass===JA&&t.parameters[tz.action]!==P3&&t.parameters[tz.action]!==S3?kH:n.pageType()}async fetchPage(e,t,n){return await this.fetchAction(e,t,null).then(async r=>await new Promise((o,i)=>{if(!r)throw new Error(`Promise resolved to null action for: ${t}`)
if(r.actionClass!==fL){if(r.actionClass===aO){const e=r
if(1===e.actions.length&&e.actions[0].actionClass===fL){const t=e.actions[0].pageData
return P(t,n)?void o(t):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(t)}`))}}i(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const s=r.pageData
if(!P(s,n)){const a=r.pageUrl
return a&&a!==t?void this.fetchPage(e,a,n).then(e=>{o(e)}).catch(e=>{i(e)}):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(s)}`))}o(s)}}))}async fetchAction(e,t,n,r=new Set){var o
const i=this.pageRouter.routedObjectForUrl(t)
if(!i.object)return await this.redirectAndRefetchActionIfPossible(e,i.normalizedUrl,r)
const s=i.object
return await s.handlePage(e,i.normalizedUrl,null!==(o=i.parameters)&&void 0!==o?o:{},i.matchedRuleIdentifier,n)}async fetchMoreOfPage(e,t){const n=t.url
if(!n)throw new Error("Page token missing required `url` property")
const r=this.paginationRouter.routedObjectForUrl(n)
if(!r.object)throw new Error(`fetchMoreOfPage: Unhandled pagination url: ${n}`)
const o=r.object
return await o.handlePagination(e,r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t)}async fetchShelves(e,t){const n=Object.keys(t),r=n.map(e=>t[e]),o=await L(r.map(async t=>{if((0,Jv.isNothing)(t))throw new Error("fetchShelves: Null shelf url")
const n=this.shelfRouter.routedObjectForUrl(t)
if((0,Jv.isNothing)(n.object))throw new Error(`fetchShelves: Unhandled shelf url: ${t}`)
const r=n.object
return await r.handleShelf(e,n.normalizedUrl,n.parameters,n.matchedRuleIdentifier)})),i={shelves:{},errors:{}}
for(const[e,t]of o.entries()){const r=n[e];(0,Jv.isNothing)(r)||(t.success?i.shelves[r]=t.value:i.errors[r]=t.error)}if(Object.keys(i.shelves).length>0)return i
{const e=Object.keys(i.errors).map(e=>i.errors[e].message)
throw 0===e.length?new Error(`Could not load any shelves: ${JSON.stringify(t)}`):new Error(e.join("\n"))}}async redirectAndRefetchActionIfPossible(e,t,n=new Set){const r=t.toString()
if(n.has(r))throw new Error(`redirectAndRefetchActionIfPossible: Redirect cycle detected for URL: ${r}`)
n.add(r)
const o=await M(e.network.fetch({url:r,method:aB}))
if(!o.success)throw new Error(`redirectAndRefetchActionIfPossible: Failed to fetch page at url: ${t}`)
const i=o.value
if(this.hasGotoURLInResponse(e,i))return new xW
if(200===i.status&&i.redirected&&i.url)return await this.fetchAction(e,i.url,null,n)
throw new Error(`redirectAndRefetchActionIfPossible: Unhandled page url: ${t}`)}hasGotoURLInResponse(e,t){if(o(t.body))return!1
try{const n=m(e.plist.parse(t.body)),r=f(n,KO),o=f(n,ZO)
return!(r!==QO||!(0,Jv.isSome)(o))}catch{return!1}}fetchBuilder(e){const t=this.pageRouter.routedObjectForUrl(e)||this.shelfRouter.routedObjectForUrl(e)||this.paginationRouter.routedObjectForUrl(e)
return t?t.object:null}}Wm=e(9100)
const R3={bag:(zm=e(1222)).bag,dispatcher:(0,Qv.makeMetatype)("dispatcher"),host:zm.host,localizer:zm.localizer,network:zm.net,plist:zm.plist,platform:zm.platform,router:(0,Qv.makeMetatype)("router"),client:(0,Qv.makeMetatype)("client"),debugSettings:(0,Qv.makeMetatype)("debugSettings"),nativeIntentDispatcher:(0,Qv.makeMetatype)("nativeIntentDispatcher"),personNameComponentsFormatter:(0,Qv.makeMetatype)("personNameComponentsFormatter")},D3=(0,Qv.makeMetatype)("app-store:active-intent")
class _3{constructor(e){this.implementation=e,this.inferredPreviewPlatform=void 0}setInferredPreviewPlatform(e){this.inferredPreviewPlatform=e}get previewPlatform(){var e
return null!==(e=this.inferredPreviewPlatform)&&void 0!==e?e:this.implementation.previewPlatform}get platform(){if((0,Zv.isSome)(this.previewPlatform))switch(this.previewPlatform){case Bq:case Uq:case vW:case gW:return this.previewPlatform
case"tv":return oU
case iW:return aH
default:x(this.previewPlatform)}}get attributePlatform(){if((0,Zv.isSome)(this.previewPlatform))switch(this.previewPlatform){case Uq:case Bq:return xq
case vW:return vH
case"tv":return lV
case iW:return uH
case gW:return gW
default:x(this.previewPlatform)}}get appPlatform(){if((0,Zv.isSome)(this.previewPlatform))switch(this.previewPlatform){case Bq:return oW
case Uq:return lW
case vW:return vW
case"tv":return"tv"
case iW:return iW
case gW:return gW
default:x(this.previewPlatform)}}}const L3=(0,Qv.makeMetatype)("app-store:locale")
class M3{constructor(e){this.objectGraph=e}get activeStorefront(){return this.objectGraph.bag.mediaCountryCode}get activeLanguage(){return this.objectGraph.bag.language}setActiveLocale(e){}normalize(e){return{storefront:this.activeStorefront,language:this.activeLanguage}}deriveLocaleForUrl(e){return e}}const x3=(0,Qv.makeMetatype)("app-store:seo")
class $3 extends uY{get isSupportEnabled(){return $3.cache.get("isSupportEnabled",()=>i(this.implementation)&&this.implementation.isSupportEnabled)}get isRosettaAvailable(){return $3.cache.get("isRosettaAvailable",()=>i(this.implementation)&&this.implementation.isRosettaAvailable)}}$3.type=(0,Qv.makeMetatype)("app-store:as-wrapper"),$3.cache=new dY
class F3 extends uY{constructor(){super(...arguments),this.cache={}}registerBagKeys(e){this.implementation.registerBagKeys(e)}string(e,t=!1){return this.fromCache(e,t,()=>this.implementation.string(e))}double(e,t=!1){return this.fromCache(e,t,()=>this.implementation.double(e))}integer(e,t=!1){return this.fromCache(e,t,()=>this.implementation.integer(e))}boolean(e,t=!1){return this.fromCache(e,t,()=>this.implementation.boolean(e))}array(e,t=!1){return this.fromCache(e,t,()=>this.implementation.array(e))}dictionary(e,t=!1){return this.fromCache(e,t,()=>this.implementation.dictionary(e))}url(e,t=!1){return this.fromCache(e,t,()=>this.implementation.url(e))}fromCache(e,t=!1,n){if(t)return n()
{const t=this.cache[e]
if((0,Jv.isSome)(t))return t.value
{const t=n()
return this.cache[e]={value:t},t}}}}class N3 extends uY{constructor(e){super(new F3(e)),this.underlyingBag=e}get todayAdMediumLockupScreenshotEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-enabled"))&&void 0!==e&&e}get todayAdMediumLockupScreenshotAnimationEnabled(){var e
return null===(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-animation-enabled"))||void 0===e||e}get trendingSearchesURL(){return this.implementation.url("trending-searches")}get userRateURL(){return this.implementation.url("p2-application-user-rate-content")}get saveUserReviewURL(){return this.implementation.url("save-user-review")}get writeReviewURL(){return this.implementation.url("p2-application-user-write-review")}get passbookMainURL(){return this.implementation.url("passbook")}get metricsConfiguration(){return y(this.implementation.dictionary(_j))}get metricsPaymentNamespaceEnabled(){if(o(this.metricsPaymentTopic))return!1
const e=y(this.implementation.dictionary(Dk)),t=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT"),n=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT")
return(0,Jv.isSome)(t)&&0!==t.length&&(0,Jv.isSome)(n)&&0!==n.length}get metricsPaymentTopic(){var e
return null!==(e=f(this.metricsConfiguration,"topics.APPSTORE_PAYMENTS_ENGAGEMENT_TOPIC"))&&void 0!==e?e:null}get personalizationUserIdEnabled(){const e=p(y(this.implementation.dictionary(Dk)),"APPSTORE_PERSONALIZATION")
return(0,Jv.isSome)(e)&&0!==Object.keys(e).length}get language(){return this.implementation.string(X_)}get mediaApiLanguage(){return this.implementation.string("language-tag")||this.implementation.string(X_)}get termsAndConditionsURL(){return this.implementation.url("p2-service-terms-url")}get isMonetaryGiftingEnabled(){return this.implementation.boolean("isBuyingScheduledGiftCertificateEnabled")}get accountTopUpURL(){return this.implementation.url("AddFundsUrl")}get accountTopUpTitle(){return this.implementation.string("account-top-up-title")}get isContentGiftingEnabled(){return this.implementation.boolean("isScheduledGiftingEnabled")}get buyButtonMetadataURL(){return this.implementation.url("personalized-buy-buttons/software")}get isTVAppEnabled(){return this.implementation.boolean("uvSearch/nowplaying-enabled")}get emailSupportLinkURL(){return this.implementation.url("supportLinkUrl")}get voteUrl(){return this.implementation.url("voteUrl")}get enableReviewSummarization(){return this.implementation.boolean("enable-review-summarization")}get reviewSummaryReportConcernData(){return y(this.implementation.dictionary("review-summarization-report-concern"))}get reportConcernUrl(){return this.implementation.url("reportConcernUrl")}get reportConcernExplanation(){return this.implementation.string("reportConcernExplanation")}get reportConcernReasons(){return l(m(this.implementation.array("reportConcernReasons")))}get reportProblemEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-report-problem-enabled"))&&void 0!==e&&e}get productPageReportProblemURL(){return this.implementation.string("product-page-report-problem-url")}get productPageReportProblemSADSubscriptionArray(){return l(m(this.implementation.array("product-page-report-problem-sad-subscriptions")))}get productPageReportProblemSecondPartyAppArray(){const e=l(m(this.implementation.array("product-page-report-problem-second-party-apps")))
return o(e)?["1473505534","1416238567","640199958","1529498570","915061776","1130498044","1070072560"]:e}get createAccountUrl(){var e
return null!==(e=this.implementation.url("createAccountUrl"))&&void 0!==e?e:uO}get mediaCountryCode(){return this.implementation.string("countryCode")}get mediaHost(){return this.implementation.url("apps-media-api-host")}mediaEdgeHost(e){return e.host.clientIdentifier===Uz?this.implementation.url(Kx):this.implementation.string(Kx)}get mediaAPICatalogMixedShouldUseEdge(){var e
return null!==(e=this.implementation.boolean("apps-media-api-catalog-mixed-should-use-edge"))&&void 0!==e&&e}get mediaEdgeSearchHost(){return this.implementation.string("apps-media-api-search-edge-host")}get mediaPreviewHost(){return this.implementation.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.implementation.string("notification-settings-media-api-host")}get edgeEndpoints(){return l(m(this.implementation.array("apps-media-api-edge-end-points")))}get mediaAdvertRequestLimit(){var e
return null!==(e=this.implementation.double("apps-media-api-search-ads-limit"))&&void 0!==e?e:4}get searchSortOptions(){return l(m(this.implementation.array("searchSortOptions")))}get ageBands(){return l(m(this.implementation.array("ageBands")))}get redirectUrlWhitelistedQueryParams(){let e=l(m(this.implementation.array("processRedirectUrl/whitelistedQueryParams")))
return o(e)&&(e=["affC",Ak,_k,"at","ct",Lk,Mk,"itscc",xk,yk,"ls","partnerId","pt","qtkid","uo"]),e}get redirectUrlEndpoint(){var e
return null!==(e=this.implementation.string("processRedirectUrl/endpoint"))&&void 0!==e?e:"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"}get aristotleParentAppAdamId(){var e
return null!==(e=this.implementation.string("aristotle-app-id"))&&void 0!==e?e:"383941000"}get arcadeAppAdamId(){return this.implementation.string("app-store-app-id")}get arcadeProductFamilyId(){var e
return null!==(e=this.implementation.string("arcade-iap-family-id"))&&void 0!==e?e:this.implementation.string("ocelot-iap-family-id")}get arcadeProductId(){var e
return null!==(e=this.implementation.string("arcade-iap-offer-name"))&&void 0!==e?e:this.implementation.string("ocelot-iap-offer-name")}get arcadeCategoryBarSAGUpliftDisplayRate(){var e
return null!==(e=this.implementation.double("arcade-category-bar-see-all-games-display-rate"))&&void 0!==e?e:0}get isArcadeEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-enabled"))&&void 0!==e&&e}get isAppsGroupingTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-groupings-tags-enabled"))&&void 0!==e&&e}get isAppsProductPageTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-product-page-tags-enabled"))&&void 0!==e&&e}get isAppsSlpTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-slp-tags-enabled"))&&void 0!==e&&e}get searchResultsLearnMoreEditorialId(){return this.implementation.string("transparencyLawEditorialItemId")}get systemApps(){return l(m(this.implementation.array("hideableSystemApps")))}get nonDeletableSystemApps(){const e=m(this.implementation.array("nonDeletableSystemApps"))
return s(e)?l(e):[{id:1635387927,"bundle-id":sA},{id:1635862301,"bundle-id":aA},{id:1584216343,"bundle-id":"com.apple.findmy.finddevices"},{id:1584215960,"bundle-id":"com.apple.NanoWorldClock"},{id:1584215812,"bundle-id":"com.apple.HeartRate"},{id:1584215851,"bundle-id":"com.apple.SessionTrackerApp"},{id:1146562108,"bundle-id":"com.apple.NanoPhone"},{id:1146560473,"bundle-id":fy},{id:1584215428,"bundle-id":"com.apple.NanoPhotos"},{id:1459455352,"bundle-id":iA},{id:1067456176,"bundle-id":oA}]}get tabsStandard(){return l(m(this.implementation.array("tabs/standard")))}get watchAppsGroupingURL(){var e
return null!==(e=this.implementation.url("watchAppsGrouping"))&&void 0!==e?e:"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"}get requireAgeVerification(){return this.implementation.boolean("requireAgeVerification")}get ageRatingLearnMoreEditorialItemId(){return this.implementation.string("ageRatingLearnMoreEditorialItemId")}get appleSiliconMacUnverifiedBadgeEditorialItemId(){return this.implementation.string("appleSiliconMacUnverifiedBadgeEditorialItemId")}get safariExtensionsGroupingURL(){return this.implementation.url("safariExtensionsGrouping")}get familySubscriptionsLearnMoreEditorialItemId(){return this.implementation.string("familySubscriptionsLearnMoreEditorialItemId")}get dynamicUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/dynamic-url-patterns")))}get financeUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/url-patterns")))}get webViewRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/v2-url-patterns")))}get arcadePreOrderUpsellLimitSeconds(){var e
return null!==(e=this.implementation.double("arcadePreOrderUpsellLimitSeconds"))&&void 0!==e?e:86400}get recentlyPlayedGamesWindowInSeconds(){var e
return null!==(e=this.implementation.double("recentlyPlayedGamesWindowInSeconds"))&&void 0!==e?e:7776e3}get gamesFriendsPlayedWindowInSeconds(){var e
return null!==(e=this.implementation.integer("games-friends-played-window-in-seconds"))&&void 0!==e?e:15778800}get enableComingSoonToggle(){return this.implementation.boolean("enableComingSoonToggle")}get enableAppAccessibilityLabels(){var e
return null!==(e=this.implementation.boolean("enable-app-accessibility-labels"))&&void 0!==e&&e}get enablePrivacyNutritionLabels(){var e
return null!==(e=this.implementation.boolean("enable-privacy-nutrition-labels"))&&void 0!==e&&e}get enableSellerInfo(){var e
return null!==(e=this.implementation.boolean("enable-seller-info"))&&void 0!==e&&e}get enableSellerICPAnnotation(){var e
return null!==(e=this.implementation.boolean("enable-seller-icp"))&&void 0!==e&&e}get enableFeaturedCategoriesOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-featured-categories-on-groupings"))&&void 0!==e&&e}get enableCategoryBricksOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-category-bricks-on-groupings"))&&void 0!==e&&e}get sponsoredSearchODMLTimeout(){var e
return null!==(e=this.implementation.double("sponsored-search-odml-timeout"))&&void 0!==e?e:3}get isSearchLandingAdsEnabled(){var e
return null!==(e=this.implementation.boolean("isSearchLandingAdsEnabled"))&&void 0!==e&&e}get isLLMSearchTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-tags-enabled"))&&void 0!==e&&e}get searchLandingAdFetchTimeout(){var e
return null!==(e=this.implementation.double("search-landing-ad-fetch-timeout"))&&void 0!==e?e:.175}get searchLandingPageOffscreenRefreshInterval(){var e
return null!==(e=this.implementation.double("search-landing-offscreen-refresh-interval-in-seconds"))&&void 0!==e?e:60}get searchLandingPageRefreshUpdateDelayInterval(){var e
return null!==(e=this.implementation.double("search-landing-page-update-delay-interval-in-seconds"))&&void 0!==e?e:.3}get appPrivacyLearnMoreEditorialItemId(){return this.implementation.string("appPrivacyLearnMoreEditorialItemId")}get ratingsAndReviewsLearnMoreEditorialId(){return this.implementation.string("ratings-and-reviews-learn-more-editorial-item-id")}get reviewSummarizationLearnMoreEditorialItemId(){return this.implementation.string("review-summarization-learn-more-editorial-item-id")}get suppressedPrivacyAppIds(){return l(m(this.implementation.array("suppressedPrivacyLabels")))}get suppressedAccessibilityAppIds(){return l(m(this.implementation.array("suppressed-accessibility-labels")))}get appPrivacyDefinitionsEditorialItemId(){return this.implementation.string("appPrivacyDefinitionsEditorialItemId")}get webNavigationCategoryTabsEditorialItemId(){return this.implementation.string("web-navigation-category-tabs-editorial-item-id")}get todayWidgetLivePreviewRolloutRate(){var e
return null!==(e=this.implementation.double("todayWidgetLivePreviewRolloutRate"))&&void 0!==e?e:1}get hero3RolloutRate(){var e
return null!==(e=this.implementation.double("arcade-hero-shelf-tagline-style-rollout-rate"))&&void 0!==e?e:1}get arcadeTrialEnrolledStateRate(){var e
return null!==(e=this.implementation.double("arcade-trial-enrolled-state-rate"))&&void 0!==e?e:0}get marketingItemSelectionTimeout(){var e
return null!==(e=this.implementation.double("marketing-item-selection-timeout"))&&void 0!==e?e:1}get enableAppEvents(){var e
return null!==(e=this.implementation.boolean("enableAppEvents"))&&void 0!==e&&e}get enableProductPageVariants(){var e
return null!==(e=this.implementation.boolean("enableProductPageVariants"))&&void 0!==e&&e}get enableArcadeTrialEligibleBadging(){return this.implementation.boolean("enable-arcade-trial-eligible-badging")}get heroCarouselAutoScrollDuration(){var e
return null!==(e=this.implementation.double("heroCarouselAutoScrollDuration"))&&void 0!==e?e:7}get enableAdditionalLoggingForPPV(){var e
return null!==(e=this.implementation.boolean("enableAdditionalLoggingForPPV"))&&void 0!==e&&e}get enableOnDevicePersonalization(){const e=this.implementation.boolean("enable-on-device-personalization")
return!!r(e)||e}get enableAutomaticPageRefresh(){var e
return null===(e=this.implementation.boolean("enable-automatic-page-refresh"))||void 0===e||e}get enableSystemAppReviews(){var e
return null!==(e=this.implementation.boolean("enable-system-app-reviews"))&&void 0!==e&&e}get enableCPPInSearchAds(){return this.implementation.boolean("enableCPPsInSearchAds")||!1}get cancelPreorderItemSrv(){return this.implementation.url("cancelPreorderItemSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancel"}get getCancellablePreorderItemsSrv(){return this.implementation.url("getCancellablePreorderItemsSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancellable"}get enabledAdPlacements(){return l(m(this.implementation.array("enabled-ad-placements")))}get adPlacementTimeouts(){return p(y(this.implementation.dictionary("ad-placement-timeouts")))}get inAppPurchasesLearnMoreEditorialItemId(){return this.implementation.string("in-app-purchases-learn-more-editorial-item-id")}get enableExternalPurchases(){var e
return null!==(e=this.implementation.boolean("enable-external-purchase"))&&void 0!==e&&e}get enabledExternalPurchasesPlacements(){return l(m(this.implementation.array("enabled-external-purchase-placements")))}get externalPurchasesLearnMoreEditorialItemId(){return this.implementation.string("external-purchase-learn-more-editorial-item-id")}get externalBrowserLearnMoreEditorialItemId(){return this.implementation.string("external-browser-learn-more-editorial-item-id")}get sharePlayAppsEditorialItemId(){return this.implementation.string("share-play-apps-editorial-item-id")}get externalPurchasesIncludeProductPageBannerIcon(){var e
return null!==(e=this.implementation.boolean("external-purchase-product-page-banner-include-icon"))&&void 0!==e&&e}get externalPurchasesProductPageAnnotationVariant(){return this.implementation.string("external-purchase-product-page-annotation-variant")}get newEventsForODJAreEnabled(){var e
return null!==(e=this.implementation.boolean("new-events-for-odj-are-enabled"))&&void 0!==e&&e}get defaultChart(){return y(this.implementation.dictionary("default-chart"))}get accountUrl(){var e
return null!==(e=this.implementation.url("accountUrl"))&&void 0!==e?e:$k}get redeemUrl(){var e
return null!==(e=this.implementation.url("redeemUrl"))&&void 0!==e?e:Fk}get manageSubscriptionsUrl(){var e
return null!==(e=this.implementation.url("manageSubscriptionsUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink"}get manageSubscriptionsV2Url(){var e
return null!==(e=this.implementation.url("manageSubscriptionsV2Url"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/"}get medicalDeviceComplianceStatementRegion(){return this.implementation.string("medical-devices-compliance-statement-region")}get adsOverrideLanguage(){return this.implementation.string("ads-override-language")}get gameControllerRecommendedRolloutRate(){var e
return null!==(e=this.implementation.double("game-controller-recommended-rollout-rate"))&&void 0!==e?e:0}get gameControllerLearnMoreEditorialItemId(){return this.implementation.string("game-controller-learn-more-editorial-item-id")}get spatialControlsLearnMoreEditorialItemId(){return this.implementation.string("spatial-controllers-learn-more-editorial-item-id")}get mediaAPISearchFocusEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-focus-suggestions-enabled"))&&void 0!==e&&e}get supportsSearchLandingPageV2(){var e
return null!==(e=this.implementation.boolean("supports-apps-slp-v2"))&&void 0!==e&&e}get searchLandingPageV2RolloutRate(){var e
return null!==(e=this.implementation.double("apps-slp-v2-rollout-rate"))&&void 0!==e?e:0}get todayTabArcadePersonalizationRate(){var e
return null!==(e=this.implementation.double("today-tab-arcade-personalization-rate"))&&void 0!==e?e:0}get gameCenterExtendSupportedFeatures(){var e
return null!==(e=this.implementation.boolean("game-center-extend-supported-features"))&&void 0!==e&&e}get adPlacementEligibleSlotPositions(){const e=y(this.implementation.dictionary("ad-placement-eligible-slot-positions"))
return s(e)?e:{today:[{shelfIdentifier:"0",slot:0},{shelfIdentifier:"0",slot:1}],"product-page-ymal":[{shelfIdentifier:MG,slot:0}]}}get managePreordersUrl(){var e
return null!==(e=this.implementation.url("preordersUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/preorders"}get modifyAccount(){var e
return null!==(e=this.implementation.url("modifyAccount"))&&void 0!==e?e:$k}get purchaseHistoryUrl(){return this.implementation.url("purchaseHistoryUrl")}get ratingsReviewsUrl(){var e
return null!==(e=this.implementation.url("ratingsReviewsUrl"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/ratings-reviews"}get signup(){var e
return null!==(e=this.implementation.url(Jy))&&void 0!==e?e:uO}get redeemCodeLanding(){var e
return null!==(e=this.implementation.url("redeemCodeLanding"))&&void 0!==e?e:Fk}get reportProblemUrl(){return this.implementation.string("reportProblemUrl")}get unrestrictedServerSideTabBadging(){var e
return null!==(e=this.implementation.boolean("unrestricted-server-side-tab-badging"))&&void 0!==e&&e}get todayAdCondensedEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-condensed-enabled"))&&void 0!==e&&e}get safariExtensionsEditorialPageId(){return this.implementation.url("safari-extensions-editorial-page-id")}get buddyOnboardingEditorialItemId(){return this.implementation.string("buddy-onboarding-editorial-item-id")}get productPageFriendsPlayingClickEventsEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-friends-playing-click-events-enabled"))&&void 0!==e&&e}get highMotionLearnMoreEditorialItemId(){return this.implementation.string("high-motion-learn-more-editorial-item-id")}get todayAdMediumLockupScreenshotsRiverSpeed(){return this.implementation.double("today-ad-medium-lockup-screenshots-river-speed")}get arcadeDownloadPackCategoriesCollectionId(){return this.implementation.string("arcade-download-packs-onboarding-collection-id")}get arcadeDownloadPackShelfTTLInSeconds(){var e
return null!==(e=this.implementation.integer("arcade-starter-pack-ttl-in-seconds"))&&void 0!==e?e:0}get enableOfferItems(){var e
return null!==(e=this.implementation.boolean("enable-winback-offers"))&&void 0!==e&&e}get appDistributionMediaAPIHost(){return this.implementation.string("app-distribution-media-api-host")}get appDistributionLanguageTag(){return this.implementation.string("app-distribution-language-tag")}get arcadeDownloadPackPostSubscribeTrigger(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-post-subscribe-trigger"))||void 0===e||e}get enableContingentOffers(){var e
return null!==(e=this.implementation.boolean("enable-contingent-offers"))&&void 0!==e&&e}get arcadeDownloadPackRolloutRate(){var e
return null!==(e=this.implementation.double("arcade-download-packs-rollout-rate"))&&void 0!==e?e:0}get enableVisionPlatform(){var e
return null!==(e=this.implementation.boolean("enable-vision-platform"))&&void 0!==e&&e}get supportedMixedMediaRequestUsecases(){var e
return null!==(e=p(y(this.implementation.dictionary("supported-mixed-media-request-usecases"))))&&void 0!==e?e:{}}get arcadeDownloadPacksMetricsEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-metrics-events-enabled"))||void 0===e||e}get arcadeDownloadPacksImpressionEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-impression-events-enabled"))||void 0===e||e}get visionOnlyAppLearnMoreEditorialItemId(){return this.implementation.string("vision-only-app-learn-more-editorial-item-id")}get arcadeDownloadPacksCIPDeeplinkIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-cip-deeplink-trigger"))&&void 0!==e&&e}get arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-hw-tabbadge-trigger"))&&void 0!==e&&e}get aboutAppStoreUrl(){return this.implementation.string("about-app-store-url")}get aboutInAppPurchasesEditorialItemId(){return this.implementation.string("about-in-app-purchases-editorial-item-id")}get requestARefundUrl(){return this.implementation.string("request-a-refund-url")}get personalizedRecommendationsToggleEnabled(){var e
return null!==(e=this.implementation.boolean("enable-personalized-recommendations-toggle"))&&void 0!==e&&e}get metricsIdMigrationEnabled(){var e
return null===(e=this.implementation.boolean("metrics-id-migration-enabled"))||void 0===e||e}get isNaturalLanguageSearchEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-enabled"))&&void 0!==e&&e}get isNaturalLanguageSearchResultsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-results-enabled"))&&void 0!==e&&e}get changePaymentMethodUrl(){return this.implementation.string("change-payment-method-url")}get aboutFrenchAppStoreEditorialItemId(){return this.implementation.string("about-app-store-editorial-item-id")}get isOnDemandShelfFetchingEnabled(){var e
return null===(e=this.implementation.boolean("on-demand-product-shelf-fetching-enabled"))||void 0===e||e}get isMetricsUserIdFallbackEnabled(){var e
return null!==(e=this.implementation.boolean("metrics-user-id-fallback-enabled"))&&void 0!==e&&e}get isMetricsAb2DataFallbackEnabled(){var e
return null===(e=this.implementation.boolean("metrics-ab2data-fallback-enabled"))||void 0===e||e}get enableRecoOnDeviceReordering(){var e
return null!==(e=this.implementation.boolean("enable-on-device-reco-reordering"))&&void 0!==e&&e}get ribbonBarVisionEditorialItemIds(){return l(m(this.implementation.array("ribbon-bar-vision-editorial-item-ids")))}get searchFilterEditorialItemIds(){const e=l(m(this.implementation.array("search-filter-editorial-item-ids")))
return new Set(e)}get accessibilityLearnMoreEditorialItemId(){return this.implementation.string("accessibility-learn-more-editorial-item-id")}get enableDeviceDrivenDiscoveryContent(){var e
return null!==(e=this.implementation.boolean("enable-device-driven-discovery-content"))&&void 0!==e&&e}get enableProductPageInstallSize(){var e
return null!==(e=this.implementation.boolean("enable-product-page-install-size"))&&void 0!==e&&e}get enableIconArtwork(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork"))&&void 0!==e&&e}get iconArtworkRolloutRate(){var e
return null!==(e=this.implementation.double("icon-artwork-rollout-rate"))&&void 0!==e?e:0}get enableUpdatedAgeRatings(){var e
return null!==(e=this.implementation.boolean("enable-app-store-age-ratings"))&&void 0!==e&&e}get enableAgeRatingFilter(){var e
return null!==(e=this.implementation.boolean("enable-age-rating-filter"))&&void 0!==e&&e}get enableTwoPhaseOfferConfirmation(){var e
return null!==(e=this.implementation.boolean("enable-two-phase-offer-confirmation"))&&void 0!==e&&e}get externalPurchasesProductPageBannerTextVariant(){return this.implementation.string("external-purchase-product-page-banner-text-variant")}get externalPurchasesProductPageBannerIconVariant(){return this.implementation.string("external-purchase-product-page-banner-icon-variant")}get maxGamesForFetchingEvents(){var e
return null!==(e=this.implementation.integer("max-games-for-fetching-events"))&&void 0!==e?e:30}get mockHomeFeedURL(){return this.implementation.string("mock-home-feed-url")}get metricsTopic(){var e
{const t="xp_ase_appstore_ue"
return null!==(e=this.implementation.string("metrics_topic"))&&void 0!==e?e:t}}get playTogetherGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("play-together-arcade-game-recommendations"))&&void 0!==e?e:"1803255513"}get playTogetherGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("play-together-non-arcade-game-recommendations"))&&void 0!==e?e:"1804480915"}get multiplayerActivityGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-arcade-game-recommendations"))&&void 0!==e?e:"1821553042"}get multiplayerActivityGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-non-arcade-game-recommendations"))&&void 0!==e?e:"1821553152"}get showArcadeSubscriberAccessBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-subscriber-access-badge"))&&void 0!==e&&e}get gamesCrossUseConsentLearnMoreURL(){return this.implementation.string("games-crossuse-consent-learn-more-url")}get gamesPlayNowHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesPlayNowHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get gamesEditorialHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesEditorialHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get completedChallengesInActiveShelfTimeThreshold(){var e
return null!==(e=this.implementation.integer("completed-challenges-in-active-shelf-time-threshold"))&&void 0!==e?e:86400}get requestReviewEnabled(){var e
return null===(e=this.implementation.boolean("request-review-enabled"))||void 0===e||e}get requestReviewMinAppLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-app-launch-count"))&&void 0!==e?e:15}get requestReviewMinGameLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-game-launch-count"))&&void 0!==e?e:5}get enableLicenses(){var e
return null!==(e=this.implementation.boolean("enable-licenses"))&&void 0!==e&&e}get chartDetailPageItemCount(){var e
return null!==(e=this.implementation.integer("chart-detail-page-item-count"))&&void 0!==e?e:25}get enableSRPNextSlot(){var e
return null!==(e=this.implementation.boolean("enable-srp-next-slot"))&&void 0!==e&&e}get enableSRPV5Impressions(){var e
return null!==(e=this.implementation.boolean("enable-srp-v5-impressions"))&&void 0!==e&&e}get enableSRPOnDeviceAdsRanker(){var e
return null!==(e=this.implementation.boolean("enable-srp-on-device-ads-ranker"))&&void 0!==e&&e}get editorialShelvesCollectionContentsLimit(){var e
return null!==(e=this.implementation.integer("editorial-shelves-collection-contents-limit"))&&void 0!==e?e:75}get metricsAllowedListURLParams(){let e=l(m(this.implementation.array("metrics-allowed-list-url-params")))
return o(e)&&(e=[Lk,Mk,xk,"ct","pt",_k,"mttn3pid","mttnagencyid","mttncc","mttnpid","mttnsiteid","mttnsub1","mttnsub2","mttnsubad","mttnsubkw","mttnsubplmnt","id",rj,"salableAdamId","ign-itscg","ign-itsct","utm_campaign",e_]),e}get enableIPadOnlyFallbackIcons(){var e
return null!==(e=this.implementation.boolean("enable-ipad-only-fallback-icons"))&&void 0!==e&&e}get disablePaginatedGameLibraryShelf(){var e
return null!==(e=this.implementation.boolean("disable-paginated-game-library-shelf"))&&void 0!==e&&e}get gameLibraryNumberOfItemsFromBelowToFetchNextPage(){var e
return null!==(e=this.implementation.integer("game-library-number-of-items-from-below-to-fetch-next-page"))&&void 0!==e?e:48}get disabledRichLinkPresentationEditorialItemIds(){var e
return l(m(null!==(e=this.implementation.array("disabled-rich-link-presentation-editorial-item-ids"))&&void 0!==e?e:["1842906680"]))}}N3.type=(0,Qv.makeMetatype)("app-store:bag-wrapper")
class B3 extends uY{constructor(e,t){super(e),this.cache={},this.packageProperties=t}isEnabled(e){return this.fromCache(e,()=>{var t,n
return!(!(0,Jv.isSome)(this.implementation)||!this.implementation.isEnabled(e))||!!(0,Jv.isSome)(null===(t=this.packageProperties)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.packageProperties)||void 0===n?void 0:n.clientFeatures[e])})}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Jv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}}B3.type=(0,Qv.makeMetatype)("app-store:client-capabilities-wrapper")
class U3 extends uY{async orderedVisibleIAPs(e,t,n,r){return await new Promise((o,i)=>{const s=t.filter(e=>null!=e),a=n.filter(e=>null!=e)
this.implementation.orderedVisibleIAPs(e,s,a,r,(e,t)=>{t?i(t):o(e)})})}async visibilityForIAPs(e){return await new Promise((t,n)=>{this.implementation.visibilityForIAPs(e,(e,n)=>{t(n?{}:e)})})}}U3.type=(0,Qv.makeMetatype)("app-store:client-ordering-wrapper")
class G3 extends uY{info(...e){return this.implementation.info(...e)}error(...e){return this.implementation.error(...e)}log(...e){return this.implementation.log(...e)}warn(...e){return this.implementation.warn(...e)}}G3.type=(0,Qv.makeMetatype)("app-store:console-wrapper")
class j3 extends uY{constructor(){super(...arguments),this.cache={}}isEnabled(e){return this.fromCache(e,()=>{if(this.implementation.isEnabled(e))return!0
const t=this.legacyFeatureFlagFromModernFeatureFlag(e)
return!!(0,Jv.isSome)(t)&&this.implementation.isEnabled(t)})}isGSEUIEnabled(e){return Boolean(this.implementation.isGSEUIEnabled(e))}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Jv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}legacyFeatureFlagFromModernFeatureFlag(e){switch(e){case PJ:return"open_in_story_share_sheet"
case IJ:return"product_accessibility_support_2025A"
case CJ:return"AppleAccount.AABranding"
case"FA3FF1EE-3B29-4131-8A33-31C764E6B6DC":return"aligned_region_artwork_2025A"
case kJ:return"hide_arcade_header_on_arcade_tab"
case OJ:return"shelf_header"
case EJ:return"game_center_shelf_header"
case RJ:return"arcade_see_all_games_menu_uplift"
case DJ:return"see_all_games_segmented_nav_2024A"
case _J:return"shelves_2_0_top_charts"
case"D4105739-EE9B-4C2E-AEE6-5F5744B016B1":return"shelves_2_0_arcade"
case"FF4FF053-4635-431B-A32C-19921296CD83":return"shelves_2_0_generic"
case LJ:return"shelves_2_0_search"
case MJ:return"shelves_2_0_product"
case"75A39BC1-112E-473B-8CB8-83D5D155982F":return"shelves_2_0_privacy_detail_page_2025C"
case xJ:return"force_display_lockup_ordinals"
case $J:return"arcade_choose_your_favorites_brick_Future"
case FJ:return"mini_today_cards_grouping"
case NJ:return"mini_today_cards_product"
case BJ:return"mini_today_cards_article"
case UJ:return"contingent_offers_personalization"
case GJ:return"voyager_bundles_2025A"
case jJ:return"tv_product_page_2024E"
case VJ:return"app_genome_2025A"
case HJ:return WJ
case"0027F7B8-F19A-4C57-8F1C-17DF011F98DA":return"spatial_controllers_2025A"
case"6707A833-E8E1-4C9E-9B83-19564F590B5D":return zJ
case"336CC1B2-6AD8-45EC-AF22-B23023110241":return YJ
case"BE3D1F90-21C1-4161-B2B9-88FA3B6CE4AF":return"5pqn2upm"
case"9EB5A10B-BE28-449D-AFE9-706A5ACF043B":return"ma1h52"
case"A50E8778-88AD-45BC-993A-B5BF157633DF":return"now_playing_feature_entry_points"
case"46669451-9170-4764-8534-348007111CDB":return"arcade_dashboard"
case qJ:return null
default:x(e)}}}j3.type=(0,Qv.makeMetatype)("app-store:feature-flags-wrapper")
class V3 extends uY{get clientIdentifier(){return V3.cache.get("clientIdentifier",()=>this.implementation.clientIdentifier)}get clientVersion(){return V3.cache.get("clientVersion",()=>this.implementation.clientVersion)}get deviceLocalizedModel(){return this.implementation.deviceLocalizedModel}get deviceModel(){return V3.cache.get("deviceModel",()=>this.implementation.deviceModel)}get deviceModelFamily(){return V3.cache.get("deviceModelFamily",()=>this.implementation.deviceModelFamily)}get devicePhysicalModel(){return V3.cache.get("devicePhysicalModel",()=>this.implementation.devicePhysicalModel)}get deviceMarketingFamilyName(){return V3.cache.get("deviceMarketingFamilyName",()=>this.implementation.deviceMarketingFamilyName)}get osBuild(){return V3.cache.get("osBuild",()=>this.implementation.osBuild)}get platform(){return this.implementation.platform}isOSAtLeast(e,t,n){return this.implementation.isOSAtLeast(e,t,n)}get isiOS(){return this.platform===gV}get isMac(){return this.platform===KV}get isTV(){return this.platform===ZG}get isWatch(){return this.platform===Cx}get isWeb(){return this.platform===BV}get isWindows(){return"Windows"===this.platform}get isVision(){return this.platform===kx}}V3.type=(0,Qv.makeMetatype)("app-store:host-wrapper"),V3.cache=new dY
class H3{constructor(){this.locData={},this.language="en"}updateLocalizationData(e,t){this.locData=e,this.language=t}localize(e,t){let n=this.locData[e]
return void 0!==n&&typeof n===zq||(n=e),t&&(n=this.replaceTokens(n,t)),n=this.replaceMarkupTokens(n,t),n}localizeWithCount(e,t,n,r){let o,i,s=null
return 0===n&&(o=`${t}.zero`,this.isLocalized(e,o)&&(s=o)),null===s&&(s=t,i=this.pluralCategory(e,n),i!==Gj&&(o=`${t}.${i}`,this.isLocalized(e,o)&&(s=o))),r||(r={}),void 0===r.count&&(r.count=this.formatNumber(n.toString())),void 0===r.number&&(r.number=this.formatNumber(n.toString())),this.localize(null!=s?s:t,r)}replaceTokens(e,t){return Object.entries(t).forEach(([t,n])=>{const r="@@"+t+"@@"
e=this.replaceSubstring(e,r,n)}),e}replaceMarkupTokens(e,t){if(e.indexOf("##")<=-1)return e
let n
return t?(n={...H3.MARKUP_PARAMS},Object.entries(t).forEach(([e,t])=>{n[e]=t})):n=H3.MARKUP_PARAMS,Object.entries(n).forEach(([t,n])=>{const r="##"+t+"##"
e=e.replace(new RegExp(r,"gi"),n)}),e=e.replace(/##([^##]+)##/gi,"<$1>")}replaceSubstring(e,t,n){return e.split(t).join(n)}formatNumber(e){let t=this.locData._decimalSeparator
void 0!==t&&typeof t===zq||(t=".")
let n=this.locData._thousandsSeparator
void 0!==n&&typeof n===zq||(n=".")
const r=parseFloat(e).toString().split("."),o=r[0].split("")
for(let e=o.length-3;e>0;e-=3)o.splice(e,0,n)
return r[0]=o.join(""),r.join(t)}isLocalized(e,t){const n=this.locData[t]
return void 0!==n&&typeof n===zq&&(-1===t.indexOf(".")||n!==t&&(0!==n.indexOf("**")||n.lastIndexOf("**")!==n.length-2)||(e.console.error("Unlocalized key in keys dictionary",t),!1))}pluralCategory(e,t){const n=H3.pluralCategoryFnByLanguage[this.language]
return void 0!==n?n(t):(e.console.warn("Missing plural category function for: "+this.language),Gj)}}H3.MARKUP_PARAMS={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},H3.pluralCategoryDefault=function(e){return Gj},H3.pluralCategoryOne=function(e){return 1===e?KG:Gj},H3.pluralCategoryArabic=function(e){const t=e>>0
if(t!==e)return Gj
if(0===t)return"zero"
if(1===t)return KG
if(2===t)return YE
const n=t%100
return n>=11?GF:n>=3?rB:Gj},H3.pluralCategoryFrench=function(e){return e<2&&e>=0?KG:Gj},H3.pluralCategoryHebrew=function(e){const t=e>>0
return t!==e?Gj:1===t?KG:2===t?YE:0==t%10&&t>10?GF:Gj},H3.pluralCategoryPolish=function(e){const t=e>>0
if(t!==e)return Gj
if(1===t)return KG
const n=t%10
if(n<=4&&n>=2){const e=t%100
if(e>14||e<12)return rB}return GF},H3.pluralCategoryRomanian=function(e){const t=e>>0
if(t!==e)return rB
if(0===t)return rB
if(1===t)return KG
const n=e%100
return n<=19&&n>=1?rB:Gj},H3.pluralCategoryRussian=function(e){const t=e>>0
if(t!==e)return Gj
const n=t%10
if(n>=5||0===n)return GF
const r=t%100
return r<=14&&r>=11?GF:1===n?KG:rB},H3.pluralCategoryFnByLanguage={zh:H3.pluralCategoryDefault,id:H3.pluralCategoryDefault,ja:H3.pluralCategoryDefault,ko:H3.pluralCategoryDefault,ms:H3.pluralCategoryDefault,th:H3.pluralCategoryDefault,vi:H3.pluralCategoryDefault,en:H3.pluralCategoryOne,ca:H3.pluralCategoryOne,da:H3.pluralCategoryOne,nl:H3.pluralCategoryOne,de:H3.pluralCategoryOne,el:H3.pluralCategoryOne,fi:H3.pluralCategoryOne,hu:H3.pluralCategoryOne,it:H3.pluralCategoryOne,nb:H3.pluralCategoryOne,no:H3.pluralCategoryOne,pt:H3.pluralCategoryOne,es:H3.pluralCategoryOne,sv:H3.pluralCategoryOne,tr:H3.pluralCategoryOne,ar:H3.pluralCategoryArabic,fr:H3.pluralCategoryFrench,iw:H3.pluralCategoryHebrew,pl:H3.pluralCategoryPolish,ro:H3.pluralCategoryRomanian,ru:H3.pluralCategoryRussian}
class q3 extends uY{constructor(e,t){super(e),this.locFile=null,this.ampLoc=new H3,this.LOC_STRING_CACHE={},this.objectGraph=t}get identifier(){return this.implementation.identifier}get safeIdentifier(){return this.implementation.identifier.split("_")[0]}string(e,t){return this.implementation.string(e)}tryString(e){const t=this.implementation.string(e)
if(t===e||t===`**${e}**`)throw Kv.context("tryString",()=>{Kv.unexpectedType(rU,"Localization key",e,null)}),new Error(`No value exists for localization key '${e}'`)
return t}stringWithFallback(e,t){const n=this.implementation.string(e)
return n===`**AppStore.${e}**`?t:n}stringForPreferredLocale(e,t,n,r){if(o(n))return this.string(t,r)
const i=`${t}_${n}`
let s=this.LOC_STRING_CACHE[i]
if(!s)if(s=this.implementation.stringForPreferredLocale(t,n),s&&s!==t)this.LOC_STRING_CACHE[i]=s
else{const e=this.ampLoc.localize(t)
s=e!==t?e:r||t}return s}stringWithCount(e,t,n){let r=this.implementation.stringWithCount(e,t)
if(!r||r===e){const o=this.ampLoc.localizeWithCount(this.objectGraph,e,t,n)
o&&(r=o)}return r}stringWithCounts(e,t,n){return this.implementation.stringWithCounts(e,t)}uppercased(e){return e?e.toLocaleUpperCase(this.safeIdentifier):null}decimal(e,t){let n=this.implementation.decimal(e,t)
return n||(n=typeof e===sj?`* ${e.toString()} *`:this.nullString()),n}fileSize(e){let t=this.implementation.fileSize(e)
return t||(t=this.nullString()),t}formattedCount(e){let t=this.implementation.formattedCount(e)
return t||(t=this.nullString()),t}formattedCountForPreferredLocale(e,t,n){if(o(n))return this.formattedCount(t)
let r=this.implementation.formattedCountForPreferredLocale(t,n)
return r||(r=this.nullString()),r}timeAgoWithContext(e,t){let n=this.implementation.timeAgoWithContext(e,t)
return n||(n=this.nullString()),n}formatDate(e,t){let n=this.implementation.formatDate(e,t)
return n||(n=this.nullString()),n}formatDateWithContext(e,t,n){let r=this.implementation.formatDateWithContext(e,t,n)
return r||(r=this.nullString()),r}formatDateInSentence(e,t,n){let r=this.implementation.formatDateInSentence(e,t,n)
return r||(r=this.nullString()),r}relativeDate(e){let t=this.implementation.relativeDate(e)
return t||(t=this.nullString()),t}formatDuration(e,t){let n=this.implementation.formatDuration(e,t)
return n||(n=this.nullString()),n}applyLocalizations(e,t,n){this.isLocFileLoaded(e)||(this.locFile=e,this.ampLoc.updateLocalizationData(t,n.slice(0,2)))}isLocFileLoaded(e){return this.locFile===e}normalizedLocale(e,t,n){if("yue-hant"===(t=t.toLowerCase())){const t=e.packageProperties.asString("macauStorefrontIdentifier")
return typeof n===zq&&typeof t===zq&&-1!==n.indexOf(t)?"zh-ma":"zh-hk"}return t}nullString(){return"* null *"}load(e){if(void 0===e.bag.language||null===e.bag.language)throw new Error("Bag language is not available. Unable to load localizations.")
const t=this.normalizedLocale(e,e.bag.language,e.client.storefrontIdentifier),n=`local/${t}`
if(!this.isLocFileLoaded(n)){const r=e.packageProperties.asDictionary(`localizations.${t}`)
if(null!=r)this.applyLocalizations(n,r,t)
else{const r=e.packageProperties.asDictionary("localizations.en-us")
null!=r&&this.applyLocalizations(n,r,t)}}}deviceDisplayName(e){if(e.host.deviceLocalizedModel)return e.host.deviceLocalizedModel
switch(e.client.deviceType){case lW:const e=this.string(Nk)
return e===Nk?nA:e
case oW:const t=this.string(Bk)
return t===Bk?rA:t
case"tv":const n=this.string(Uk)
return n===Uk?"Apple\xa0TV":n
case gW:const r=this.string(Gk)
return r===Gk?"Apple\xa0Watch":r
case vW:const o=this.string(jk)
return o===jk?wO:o
default:return null}}}q3.type=(0,Qv.makeMetatype)("app-store:loc-wrapper")
class W3 extends uY{value(e){return n(this.implementation,e)}enabled(e){var t,n
const r=this.value(e)
return typeof r!==_U?Boolean(r):!!(0,Zv.isSome)(null===(t=this.implementation)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.implementation)||void 0===n?void 0:n.clientFeatures[e])}isEnabled(e){return this.enabled(e)}isNotEnabled(e){return!this.enabled(e)}asDictionary(e){return p(this.implementation,e)}asString(e){return f(this.implementation,e)}asNumber(e){return h(this.implementation,e)}asArray(e){return l(this.implementation,e)}}W3.type=(0,Qv.makeMetatype)("app-store:package-properties-wrapper")
class z3 extends uY{retrieveString(e){const t=this.implementation.retrieveString(e)
return(null==t?void 0:t.length)>0&&"<null>"!==t?t:null}storeString(e,t){this.implementation.storeString(t,e)}}z3.type=(0,Qv.makeMetatype)("app-store:storage-wrapper")
class Y3 extends Wm.ObjectGraph{configureDefaults(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x){let $=this.addingCryptography(t).addingHost(n).addingNetwork(r).addingPlatform(o).addingPlist(i).addingRandom(s).addingServices(a).addingCookieProvider(c).addingBag(e).addingConsole(l).addingStoreMetrics(u).addingAMSEngagement(d).addingLoc(f).addingAdsLoc(h).addingDevice(p).addingClient(w).addingPackageProperties(g).addingUser(v).addingPlayer(m).addingMetricsIdentifiers(y).addingClientOrdering(A).addingArcade(T).addingGameCenter(b).addingDeepLinks(S).addingAppleSilicon(P).addingStorage(I).addingAds(C).addingOnDeviceRecommendationsManager(k).addingOnDeviceSearchHistoryManager(O).addingFeatureFlags(E).addingClientCapabilities(R,g).addingMediaToken(D).addingAppDistribution(_).addingTimeoutManager(L).addingAdsLoc(h).addingTreatmentStore(M).addingUserDefaults(x)
return $.loc.load($),$=$.addingLocale(new M3($)),$}get bag(){return this.required(N3.type)}addingBag(e){return this.addingBagWrapper(new N3(e)).adding(zm.bag,e)}addingBagWrapper(e){return this.adding(N3.type,e)}get console(){return this.required(G3.type)}addingConsole(e){return this.addingConsoleWrapper(new G3(e))}addingConsoleWrapper(e){return this.adding(G3.type,e)}get cryptography(){return this.required(zm.cryptography)}addingCryptography(e){return this.adding(zm.cryptography,e)}get host(){return this.required(V3.type)}addingHost(e){return this.addingHostWrapper(new V3(e))}addingHostWrapper(e){return this.adding(V3.type,e)}get locale(){return this.required(L3)}addingLocale(e){return this.adding(L3,e)}get network(){return this.required(zm.net)}addingNetwork(e){return this.adding(zm.net,e)}get platform(){return this.required(zm.platform)}addingPlatform(e){return this.adding(zm.platform,e)}get plist(){return this.required(zm.plist)}addingPlist(e){return this.adding(zm.plist,e)}get random(){return this.required(zm.random)}addingRandom(e){return this.adding(zm.random,e)}get services(){return this.required(zm.services)}addingServices(e){return this.adding(zm.services,e)}get cookieProvider(){return this.required(zm.cookieProvider)}addingCookieProvider(e){return this.adding(zm.cookieProvider,e)}get fetchTimingMetricsBuilder(){return this.optional($m.fetchTimingMetricsBuilderType)}addingFetchTimingMetricsBuilder(e){return this.adding($m.fetchTimingMetricsBuilderType,e)}get storeMetrics(){return this.required(Hz)}addingStoreMetrics(e){return this.adding(Hz,e)}get amsEngagement(){return this.optional(qz)}addingAMSEngagement(e){return this.adding(qz,e)}get loc(){return this.required(q3.type)}addingLoc(e){return this.addingLocWrapper(new q3(e,this))}addingLocWrapper(e){return this.adding(q3.type,e)}get adsLoc(){return this.required(rY)}addingAdsLoc(e){return this.adding(rY,e)}get device(){return this.required(Wz)}addingDevice(e){return this.adding(Wz,e)}get client(){return this.required(mY.type)}addingClient(e){return this.addingClientWrapper(new mY(e))}addingClientWrapper(e){return this.adding(mY.type,e)}get packageProperties(){return this.required(W3.type)}addingPackageProperties(e){return this.addingPackagePropertiesWrapper(new W3(e))}addingPackagePropertiesWrapper(e){return this.adding(W3.type,e)}get clientCapabilities(){return this.required(B3.type)}addingClientCapabilities(e,t){return this.addingClientCapabilitiesWrapper(new B3(e,t))}addingClientCapabilitiesWrapper(e){return this.adding(B3.type,e)}get user(){return this.required(zz)}addingUser(e){return this.adding(zz,e)}get player(){}addingPlayer(e){return this.adding(Yz,e)}get metricsIdentifiers(){return this.required(Jz)}addingMetricsIdentifiers(e){return this.adding(Jz,e)}get clientOrdering(){return this.required(U3.type)}addingClientOrdering(e){return this.addingClientOrderingWrapper(new U3(e))}addingClientOrderingWrapper(e){return this.adding(U3.type,e)}get arcade(){return this.required(Kz)}addingArcade(e){return this.adding(Kz,e)}get gameCenter(){return this.required(Zz)}addingGameCenter(e){return this.adding(Zz,e)}get deepLinks(){return this.required(Qz)}addingDeepLinks(e){return this.adding(Qz,e)}get appleSilicon(){return this.required($3.type)}addingAppleSilicon(e){return this.addingAppleSiliconWrapper(new $3(e))}addingAppleSiliconWrapper(e){return this.adding($3.type,e)}get storage(){return this.required(z3.type)}addingStorage(e){return this.addingStorageWrapper(new z3(e))}addingStorageWrapper(e){return this.adding(z3.type,e)}get ads(){return this.required(Xz)}addingAds(e){return this.adding(Xz,e)}get onDeviceRecommendationsManager(){return this.required(eY)}addingOnDeviceRecommendationsManager(e){return this.adding(eY,e)}get onDeviceSearchHistoryManager(){return this.required(tY)}addingOnDeviceSearchHistoryManager(e){return this.adding(tY,e)}get featureFlags(){return this.required(j3.type)}addingFeatureFlags(e){return this.addingFeatureFlagsWrapper(new j3(e))}addingFeatureFlagsWrapper(e){return this.adding(j3.type,e)}get mediaToken(){return this.required(nY)}addingMediaToken(e){return this.adding(nY,e)}get appDistribution(){return this.required(oY)}addingAppDistribution(e){return this.adding(oY,e)}get timeoutManager(){return this.required(iY)}addingTimeoutManager(e){return this.adding(iY,e)}get treatmentStore(){return this.required(sY)}addingTreatmentStore(e){return this.adding(sY,e)}get experimentCache(){return this.optional(OY.metatype)}get metricsIdentifiersCache(){return this.optional(gK.defaultMetatype)}get paymentMetricsIdentifiersCache(){return this.optional(gK.paymentMetatype)}get personalizationMetricsIdentifiersCache(){return this.optional(gK.personalizationMetatype)}get userDefaults(){if(this.client.isiOS)return this.required(aY)}addingUserDefaults(e){return this.adding(aY,e)}isAvailable(e){return i(this.optional(e))}get activeIntent(){return this.optional(D3)}addingActiveIntent(e){return this.adding(D3,new _3(e))}get seo(){return this.optional(x3)}addingSEO(e){return this.adding(x3,e)}get dispatcher(){return this.required(R3.dispatcher)}get nativeIntentDispatcher(){return this.required(R3.nativeIntentDispatcher)}get debugSettings(){return this.required(R3.debugSettings)}get router(){return this.required(R3.router)}get localizer(){return this.required(R3.localizer)}get personNameComponentsFormatter(){return this.required(R3.personNameComponentsFormatter)}}class J3 extends MW{constructor(){super(...arguments),this.$kind="InvalidateAllWidgetsAction",this.actionClass="InvalidateAllWidgetsAction"}}class K3{constructor(){this.$intentKind="GenericPageIntent"}async perform(e,t){const n=t.required(O3)
return await n.fetchPage(t,e.url,bJ)}}class Z3{constructor(){this.$intentKind="GenericPageMoreIntent"}async perform(e,t){const n=t.required(O3)
return await n.fetchMoreOfPage(t,e.pageToken)}}class Q3{constructor(){this.$intentKind="ShelvesIntent"}async perform(e,t){const n=t.required(O3)
return await n.fetchShelves(t,e.requests)}}class X3{constructor(){this.$intentKind="ActionIntent"}async perform(e,t){return await sp(t,e)}}class e9{constructor(){this.$kind="AccountLinks",this.links={},this.pageMetrics=new NY,this.pageRenderMetrics=null}}class t9 extends MW{constructor(e,t,n){super(),this.$kind="FamilyCircleAction",this.actionClass="FamilyCircleAction",this.clientName=e,this.eventType=t,this.additionalParameters=n}}class n9{constructor(){this.$intentKind="AccountLinksIntent"}async perform(e,t){return cp(t)}}class r9 extends N2{constructor(e,t){super("AccountController"),t.exportingService("AccountData",{fetchAccountLinks:async t=>cp(e)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class o9 extends N2{constructor(){super("DynamicUIBuilder")}pageType(){return nN}async handlePage(e,t,n,r,o){const i=new FY(nN)
i.pageUrl=t.toString(),i.referrerUrl=t.build()
const s=new D2(e.bag.metricsTopic)
if(e.bag.arcadeDownloadPacksCIPDeeplinkIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new FY(bB),t=iB
e.pageData=t,e.presentationContext=Qj,s.carrierLinkSuccessAction=e}return i.pageData=s,i}pageRoute(e){const t=e.bag.dynamicUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class i9 extends N2{constructor(){super("FinancePageBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=new FY(kj)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.financeUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class s9{constructor(e,t){this.$kind="GenericAccountPage",this.title=e,this.sections=t||[],this.pageMetrics=new NY,this.pageRenderMetrics={}}}class a9{constructor(e,t){this.$kind="PersonalizationTransparencyPage",this.personalizationEnabledPage=e,this.personalizationDisabledPage=t}}class c9{constructor(e,t){this.$kind="AccountSection",this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class l9{constructor(e){this.type=e}}class u9 extends l9{constructor(e){super(sH),this.$kind="AccountSectionText",this.text=e}}class d9 extends l9{constructor(e,t){super("personalizedRecommendationsToggle"),this.$kind="AccountSectionPersonalizedRecommendationsToggle",this.title=e,this.defaultValue=t}}class f9 extends l9{constructor(e,t,n){super(jq),this.$kind="AccountSectionLink",this.title=e,this.action=t,this.displayType=n||cq}}class h9 extends l9{constructor(e,t){super("infoListItem"),this.$kind="AccountSectionInfoListItem",this.title=e,this.value=t}}class p9 extends MW{constructor(){super(...arguments),this.$kind="ClearAppUsageDataAction",this.actionClass="ClearAppUsageDataAction"}}class w9{constructor(){this.$intentKind="GenericAccountPageIntent"}async perform(e,t){return await lp(t,e.url)}}class g9{constructor(){this.$intentKind="PersonalizationTransparencyPageIntent"}async perform(e,t){return await async function(e){const t=e.required(O3),n=`${$W}:///${VW.account}/${VW.personalizationTransparency}`
return await t.fetchPage(e,n,a9)}(t)}}class v9 extends N2{constructor(e,t){super("PersonalizationTransparencyBuilder"),t.exportingService(YA,{fetchGenericAccount:async t=>await lp(e,t.url)})}async handlePage(e,t,n,r,o){return await async function(e,t,n){let r,o
if(e.bag.personalizedRecommendationsToggleEnabled){o=I$
const t=await up(e),n=dp(e)
r=new a9(t,n)}else o=bH,r=v(n[tz.enabled])?await up(e):dp(e)
return N2.createFlowAction(r,o,t)}(e,t,n)}pageRoute(e){return e.bag.personalizedRecommendationsToggleEnabled?[{protocol:$W,path:`/${VW.account}/${VW.personalizationTransparency}`},{path:`${VW.personalizationTransparency}`}]:[{protocol:$W,path:`/${VW.account}/${VW.personalizationTransparency}`,query:[tz.enabled]},{path:`${VW.personalizationTransparency}`,query:[tz.enabled]}]}pageType(){return bH}}class m9 extends N2{constructor(){super("ShowAccountPageBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){let i,s=[]
{i=wL
const e=new FY(bH)
e.presentationContext=Qj,e.animationBehavior=dH,s=[e]}const a=new LX(i)
return a.actions=s,a}pageRoute(e){return[{hostName:"showAccountPage"},{hostName:"showPurchasesPage"}]}}class y9 extends N2{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){return new FY(kj,e.bag.manageSubscriptionsUrl)}pageRoute(e){return[{hostName:"showSubscriptionsPage"}]}}class A9 extends N2{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=new LX(wL)
if(e.client.deviceType!==vW){const e=new FY(bH)
e.presentationContext=Qj,e.animationBehavior=dH,i.actions=[e]}return i}pageRoute(e){return[{hostName:"showUpdatesPage"},{path:"updates"},{path:"{countryCode}/updates"},{query:[`${tz.action}=updates`]}]}}class T9 extends N2{constructor(){super("StorefrontChangeController")}async handlePage(e,t,n,r,o){const i={url:t.toString(),signingStyle:nH}
return await e.network.fetch(i),null}pageRoute(e){return[{protocol:FW,path:`/${VW.store}/${VW.resetAndRedirect}`}]}pageType(){return Xq}}class b9 extends N2{constructor(){super("WebUIPageBuilder")}pageType(){return s$}async handlePage(e,t,n,r,o){const i=new FY(s$)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.webViewRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class S9{constructor(){this.$intentKind="UpdateAppEventNotificationIntent"}async perform(e,t){return await pp(t,e)}}class P9 extends N2{constructor(e,t){super("AppEventsController"),t.exportingService("AppEvents",{updateAppEventNotification:async t=>await pp(e,t)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class I9 extends N2{constructor(){super("AppClipSubscribeBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const s=f(n[tz.appId])
if(!i(s))throw new Error(`No adamId supplied in appClipSubscribe url: ${t}`)
const a=new yY(e).withIdOfType(s,yW).includingAdditionalPlatforms(ee(e)),c=Od(e,yt(e,await Ln(e,a)),{metricsOptions:{pageInformation:new uK({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),l=(new wz).set(Wj,BW).set(eG,ZU).path(VW.product).path(s).build(),u=new FY(kH)
u.pageUrl=l
const d=no(e,pt(Pj),s,c.buttonAction),h=new LX(pW)
return h.actions=[u,d],h}pageRoute(e){return[{hostName:"appClipSubscribe",query:[tz.appId,tz.context]}]}}class C9{constructor(e,t,n,r,o){this.$kind="ArcadeDownloadPackCategory",this.id=e,this.title=t,this.artwork=n,this.gradientStartColor=r,this.gradientEndColor=o,this.selectActionMetrics=new EW,this.deselectActionMetrics=new EW}}class k9{constructor(e,t){this.$kind="ArcadeDownloadPackSuggestion",this.lockup=e,this.categoryId=t}}class O9 extends MW{constructor(e){super(),this.$kind="ArcadePackOfferAction",this.actionClass="ArcadePackOfferAction",this.offerActions=e}}class E9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackCategoriesPage",this.title=e,this.categories=t,this.maxNumberOfCategoriesToChoose=n,this.maxNumberOfCategoriesToChooseTemplate=r,this.numberOfChosenCategoriesTemplate=o,this.primaryAction=i,this.dismissAction=s,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class R9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackSuggestionsPage",this.title=e,this.suggestions=t,this.getAllAction=n,this.getAllButtonStyle=r,this.primaryAction=o,this.primaryActionKind=i,this.primaryActionSecondaryTitle=s,this.pageMetrics=new NY,this.pageRenderMetrics={}}}!function(e){e.Control="Tf5Kjqz00",e.LayoutA="Tf5Kjqz01",e.LayoutB="Tf5Kjqz02"}(Ym||(Ym={}))
class D9{constructor(){this.$intentKind="ArcadeDownloadPackCategoriesPageIntent",this.maxNumberOfCategoriesToChoose=4}async perform(e,t){return await this.fetchDownloadPackPage(t,Ya(e.subscriptionStatus))}async fetchDownloadPackPage(e,t){const n=new xW
n.title=e.loc.string("Arcade.DownloadPack.CategorySelection.PrimaryButtonTitle")
const r=new xW
r.title=e.loc.string("Arcade.DownloadPack.CategorySelection.SecondaryButtonTitle")
const o=await this.fetchCategories(e),i=new E9(e.loc.string(t===qk?"Arcade.DownloadPack.CategorySelection.Title.CurrentUser":"Arcade.DownloadPack.CategorySelection.Title"),o,this.maxNumberOfCategoriesToChoose,"Arcade.DownloadPack.CategorySelection.MaxCount","Arcade.DownloadPack.CategorySelection.Selected.Full",n,r),s=new uK({pageId:"SelectCategories",pageType:NC}),a={rootPosition:0,locationStack:[]}
return e.bag.arcadeDownloadPacksMetricsEventsEnabled&&(n.actionMetrics.addMetricsData(_t(e,"Ok",TW,{actionType:bW})),r.actionMetrics.addMetricsData(_t(e,"Skip",TW,{actionType:aj})),o.forEach(t=>{t.selectActionMetrics.addMetricsData(_t(e,t.id,gj,{actionType:PF})),t.deselectActionMetrics.addMetricsData(_t(e,t.id,gj,{actionType:"remove"}))}),jn(e,i,s)),e.bag.arcadeDownloadPacksImpressionEventsEnabled&&o.forEach(t=>{const n={id:t.id,idType:Dq,kind:TW,locationTracker:a,pageInformation:s,softwareType:Pq,targetType:gj,title:t.title}
Nh(e,t,n),_h(a)}),i}async fetchCategories(e){const t=e.bag.arcadeDownloadPackCategoriesCollectionId,n=new yY(e).withIdOfType(t,WV).addingQuery(BC,SC).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>this.categoriesFromResponse(e,t))}categoriesFromResponse(e,t){return Kv.context("categoriesFromResponse",()=>{const n=At(t),r=[]
for(const t of n){const n=t.id,o=Kf(e,t,AW),i=p(Ke(e,t,Hq),lR)
if((0,Jv.isNothing)(i))continue
const s=Xd(e,i,{useCase:O6.CategoryIcon}),a=Ze(e,t,"editorialBackground.stops").map(e=>ye(f(e,DV))).filter(e=>(0,Jv.isSome)(e))
if(0===a.length){e.console.log(`Empty gradient for category: ${n}`)
continue}const c=a[0],l=1===a.length?a[0]:a[1],u=new C9(n,o,s,c,l)
r.push(u)}return r.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:rH})}catch(e){return 0}})})}}class _9{constructor(){this.$intentKind="ArcadeDownloadPackSuggestionsPageIntent",this.maxGamesCount=4}async perform(e,t){const n={rootPosition:0,locationStack:[]},r=new uK({pageId:"DownloadStarterPack",pageType:NC})
return await this.fetchSuggestedGames(t,e.categories,this.maxGamesCount,r,n).then(o=>this.createSuggestionsPage(o,t,Ya(e.subscriptionStatus),r,n))}async fetchSuggestedGames(e,t,n,r,o){const i=new yY(e).forType(xL).addingQuery("include[personal-recommendations]",mW).addingQuery("associate[apps]",Zj).addingQuery("limit[personal-recommendations:contents]",`${n}`).addingQuery("omit[resource:apps]","autos").addingQuery("sparseLimit[apps:association.category]","0").addingQuery("sparseLimit[personal-recommendations:contents]",`${n}`).addingQuery(cq,"arcade-onboarding").includingAdditionalPlatforms(ee(e)),s=this.fetchOptions(t,sW)
return await Ln(e,i,s).then(n=>this.suggestionFromResponse(e,t,n,r,o))}suggestionFromResponse(e,t,n,r,o){return Kv.context("suggestionFromResponse",()=>{const i={}
for(const e of t)i[e.id]=e
const s=At(fe(yt(e,n),mW)),a=[]
for(const t of s){const n=l(t.meta,"associations.category.data")[0].id,s=Od(e,t,{offerStyle:Rj,offerEnvironment:Jq,metricsOptions:{pageInformation:r,locationTracker:o,badges:{categoryId:n}},metricsClickOptions:{id:t.id,pageInformation:r,locationTracker:o,badges:{categoryId:n}},artworkUseCase:O6.LockupIconSmall,isSubtitleHidden:!0});(0,Jv.isNothing)(s)||(s.heading=i[n].title,_h(o),Zd(s,e),a.push(new k9(s,n)))}return a})}createSuggestionsPage(e,t,n,r,o){const i=e.map(e=>this.offerAction(e.lockup.buttonAction)).filter(e=>(0,Jv.isSome)(e)),s=new O9(i)
s.title=function(e){switch(wp(e)){case Ym.Control:return e.loc.string(dk)
case Ym.LayoutA:case Ym.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.DownloadAllButtonTitle")
default:return e.loc.string(dk)}}(t)
const a=i.map(e=>e.adamId),c=new xW
c.title=function(e){switch(wp(e)){case Ym.Control:return e.loc.string(Y_)
case Ym.LayoutA:case Ym.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.NotNowButtonTitle")
default:return e.loc.string(Y_)}}(t)
const l=new R9(t.loc.string(n===iB?"Arcade.DownloadPack.Suggestions.Title.NewUser":"Arcade.DownloadPack.Suggestions.Title"),e,s,function(e){switch(wp(e)){case Ym.Control:return z_
case Ym.LayoutA:return"withinLockups"
case Ym.LayoutB:default:return z_}}(t),c,function(e){switch(wp(e)){case Ym.Control:case Ym.LayoutA:return W_
case Ym.LayoutB:return"getAll"
default:return W_}}(t),function(e){switch(wp(e)){case Ym.Control:return null
case Ym.LayoutA:case Ym.LayoutB:return e.loc.string(Y_)
default:return null}}(t))
return t.bag.arcadeDownloadPacksMetricsEventsEnabled&&(Xs(t,s,{id:"GetAll",actionType:T$,subjectIds:a,actionDetails:{subjectIds:a},pageInformation:r,locationTracker:o,targetType:TW}),c.actionMetrics.addMetricsData(_t(t,"Done",TW,{actionType:bW})),jn(t,l,r)),l}offerAction(e){return Nn(e)?e:gt(e)?Nn(e.defaultAction)?e.defaultAction:Nn(e.buyAction)?e.buyAction:null:null}fetchOptions(e,t){const n={selected:e.map(e=>({id:e.id,type:t}))}
return{method:yG,headers:{"Content-Type":cM},requestBodyString:JSON.stringify(n)}}}class L9 extends N2{constructor(e,t){super("ArcadeDownloadPackBuilder")}pageRoute(e){return ar(e,e.bag.arcadeDownloadPackRolloutRate)?[{hostName:"arcadeDownloadPack",query:[`${tz.arcadeSubscriptionStatus}?`]}]:[]}async handlePage(e,t,n,r,o){const i=new FY(bB),s=f(n,tz.arcadeSubscriptionStatus)
return i.pageData=Ya(s),i}pageType(){return bB}}class M9 extends N2{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return Eq}defaultTab(e){return pW}pageRoute(e){return[{path:"arcade/offers",query:[`${tz.offerHints}?`]},{path:"/{countryCode}/arcade/offers",query:[`${tz.offerHints}?`]}]}async handlePage(e,t,n,r,o){var i
const s=null!==(i=n[tz.offerHints])&&void 0!==i?i:"deeplink_hardware_firstchance",a={offerHints:s},c=new hZ(pW,pt(Pj),e.bag.metricsTopic,null,a)
c.offerHints=s
const l=new FY(Dj)
return l.pageData=c,l.referrerUrl=t.build(),l}}class x9 extends bJ{constructor(e){super(e,"ArcadeSeeAllGamesPage"),this.pageSegments=[]}}class $9{constructor(e,t,n=null,r){this.$kind="PageFacetOption",this.title=e,this.value=t,this.systemImageName=r,this.metricsValue=n}}$9.defaultValue="pageFacetsDefaultValue",$9.trueValue=new $9(bq,WF),$9.falseValue=new $9(WF,WF)
class F9{constructor(e,t,n,r,o=[],i=null,s=null,a=null,c=!1,l=!1,u=!1){this.$kind="PageFacetsFacet",this.id=e,this.parameterName=t,this.title=n,this.displayType=r,this.defaultOptions=i,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l,this.isHiddenFromMenu=u}}class N9{constructor(e,t,n){this.$kind="PageFacets",this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return(0,Jv.isSome)(e)&&0!==Object.keys(e).length}}N9.requestValuesForSelectedFacetOptions=function(e){if(N9.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>N9.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={}
for(const e of r){const t=e.split("=")
2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null}
class B9{constructor(e=[],t=null){this.$kind="PageFacetsGroup",this.title=t,this.facets=e}}const U9="-releaseDateByDay&sort=name",G9="-lastUpdatedByDay&sort=name",j9="alphabet&sort=name",V9="category&sort=-releaseDate",H9="groupBy",q9=ML,W9=LO,z9=pU,Y9="filter[platform]",J9={}
let K9=!1,Z9=null,Q9=null,X9=null,e8=null,t8=null,n8=null,r8=null,o8=null,i8=null,s8=null,a8=null
const c8={}
c8[tz.sort]=H9,c8[tz.ageRating]=$O,c8[tz.controllerSupport]=FO,c8[tz.multiplayerSupport]=NO,c8[tz.comingSoon]=q9,c8[tz.binCompatGames]=Y9
const l8=qA
class u8{constructor(){this.$intentKind="ArcadeSeeAllGamesPageIntent"}async perform(e,t){return await Pp(t,e.requestDescriptor)}}class d8{constructor(){this.$intentKind="ArcadeSeeAllGamesPageMoreIntent"}async perform(e,t){return await Ip(t,e.pageToken)}}class f8 extends B2{constructor(e,t){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,t.exportingService(NF,{fetchArcadeSeeAllGames:async t=>await Pp(e,t),fetchMoreArcadeSeeAllGames:async t=>await Ip(e,t.pageToken)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Hq,$q,hH,wH,Lj,eV,LV]
return e.bag.enableUpdatedAgeRatings&&t.push(Fq),e.appleSilicon.isSupportEnabled&&t.push(xH),t}defaultTab(e){return pW}pageType(){return wG}pageRoute(e){return[{identifier:wG,path:`/${VW.arcadeSeeAllGames}`,query:[`${tz.requestDescriptor}?`,`${tz.sort}?`,`${tz.ageRating}?`,`${tz.controllerSupport}?`,`${tz.multiplayerSupport}?`,`${tz.comingSoon}?`]},{identifier:wG,hostName:`${zW}`,query:[`${tz.requestDescriptor}?`,`${tz.sort}?`,`${tz.ageRating}?`,`${tz.controllerSupport}?`,`${tz.multiplayerSupport}?`,`${tz.comingSoon}?`]},{path:"/{countryCode}/{platform}/arcade/see-all",query:[`${tz.requestDescriptor}?`,`${tz.sort}?`,`${tz.ageRating}?`,`${tz.controllerSupport}?`,`${tz.multiplayerSupport}?`,`${tz.comingSoon}?`]}]}paginationRoute(e){return[{identifier:wG,protocol:$W,path:`/${VW.arcadeSeeAllGames}/${VW.arcadeSeeAllGamesLoadMore}`}]}shelfRoute(e){return[{protocol:$W,path:`/${VW.arcadeSeeAllGames}/${VW.shelf}/`,query:[`${tz.token}`]}]}generatePageRequest(e,t,n){return Kv.context("generatePageRequest",()=>{const t=Cp(e,n),r=so(e).includingAdditionalPlatforms(ee(e)).includingRelationships([]).withSparseLimit(10).includingAttributes(yp(e)).usingCustomAttributes(Ue(e))
return function(e,t){let n=!1
for(const e of Object.keys(t)){if(e===q9&&s(t[e])){const r=t[H9]
if(s(r))switch(r[0].value){case U9:case G9:t[e][0].value=z9
break
case j9:t[e][0].value=W9
break
case V9:t[e][0].value=W9,n=!0}}e===Y9&&o(t[e])&&(t[e]=J9[tz.binCompatGames].false)}n&&e.withSparseCount(4)
for(const n of Object.keys(t)){const r=N9.requestValuesForSelectedFacetOptions(t[n])
if(s(r)){s(r.value)&&e.addingQuery(n,r.value)
for(const t of Object.keys(r.additionalKeyValuePairs))e.addingQuery(t,r.additionalKeyValuePairs[t])}}}(r,s(t.selectedFacetOptions)?t.selectedFacetOptions:vp(e)),r})}async renderPage(e,t,n,o){return await Ha(Bj,async()=>{const o=g(t),i=Cp(e,n),a=Un(e,XH,wG,o),c=function(e,t,n){return{url:wz.fromComponents($W,null,`/${VW.arcadeSeeAllGames}/${VW.arcadeSeeAllGamesLoadMore}`).build(),metricsPageInformation:n,metricsLocationTracker:{rootPosition:0,locationStack:[]},remainingGroups:[],lastShelfIndex:0,isCompactMode:t.isCompactMode}}(0,i,a),u=new x9(Ap(e,l(o,"results.groups"),c))
u.title=e.loc.string(UC),u.pageFacets=function(e){gp(e),e.featureFlags.isEnabled(DJ)
const t=e.loc.string("PAGE_FACETS_FILTERS_AGE_RATINGS"),n=new F9(tz.ageRating,$O,t,TB,[t8,n8,r8,o8],[t8],"age",mp(e,rH)),r=e.featureFlags.isEnabled(RJ)||!1,o=new F9(tz.sort,H9,e.loc.string($A),TB,[Z9,Q9,X9,e8],r?[Z9]:null,rH,mp(e,rH)),i=e.loc.string(MA),s=new F9(tz.controllerSupport,FO,i,cN,[i8],null,BO,mp(e,rH)),a=e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),c=new F9(tz.multiplayerSupport,NO,a,cN,[s8],null,PH,mp(e,rH)),l=new F9(tz.comingSoon,q9,e.loc.string(xA),cN,[a8],[a8],$L,mp(e,$L))
l.isHiddenFromMenu=r
const u=new N9([],!1,null)
switch(e.client.deviceType){case vW:u.facetGroups.push(new B9([n])),e.bag.enableComingSoonToggle&&u.facetGroups.push(new B9([l],e.loc.string(FA))),u.facetGroups.push(new B9([s,c],e.loc.string("PAGE_FACETS_SUPPORTS_TITLE"))),u.facetGroups.push(new B9([o]))
break
case"tv":u.facetGroups.push(new B9([n],e.loc.string("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")))
const t=[s,c]
e.bag.enableComingSoonToggle&&t.push(l),u.facetGroups.push(new B9(t,e.loc.string("PAGE_FACETS_FILTERS_TITLE"))),u.facetGroups.push(new B9([o],e.loc.string("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")))
break
default:o.displayOptionsInline=!0,u.facetGroups.push(new B9([o],e.loc.string($A))),n.showsSelectedOptions=!0,u.facetGroups.push(new B9([s,c,n],e.loc.string("PAGE_FACETS_FILTER_BY_TITLE"))),e.bag.enableComingSoonToggle&&u.facetGroups.push(new B9([l],e.loc.string(FA)))}return u}(e),u.selectedFacetOptions=s(i.selectedFacetOptions)?i.selectedFacetOptions:vp(e),u.pageSegments=[],jn(e,u,a)
const d=u.pageMetrics.instructions
if(!r(d))for(const e of d)e.data.includingFields.push(xS)
return c.remainingGroups.length>0&&(u.nextPage=c),u})}generatePaginationRequest(e,t,n,r){const o=g(r)
let i=[],s=20,a=!0
for(const e of o.remainingGroups)a=a&&(e.data.length<s||0===i.length),a&&(i=i.concat(e.data),s-=e.data.length)
return new yY(e,i).includingAdditionalPlatforms(ee(e)).includingAttributes(yp(e)).usingCustomAttributes(Ue(e))}async renderPaginatedPage(e,t,n){const r=g(n),o=[]
let i=20
const a={}
for(const e of t.data)a[e.id]=e
let c=!0
for(const e of r.remainingGroups){if(c=c&&(e.data.length<i||0===o.length),c){for(let t=0;t<e.data.length;t++){const n=a[e.data[t].id]
s(n)&&(e.data[t]=n)}i-=e.data.length}o.push(e)}r.remainingGroups=[]
const l=Ap(e,o,r),u=new x9(l)
return u.title=e.loc.string(UC),r.remainingGroups.length>0&&(u.nextPage=r),u}generateShelfRequest(e,t,n){const r=g(JSON.parse(n[fV])).remainingContent.slice(0,20),o=new yY(e,r).includingAdditionalPlatforms(ee(e)).includingAttributes(yp(e)).usingCustomAttributes(Ue(e))
return Je(e,o,r),o}async renderShelf(e,t,n){const r=g(JSON.parse(n[fV]))
return r.remainingContent=t.data.concat(r.remainingContent.slice(20,r.remainingContent.length)),r.isFirstRender=!1,Tp(e,r)}}class h8{constructor(e,t,n,r){this.$kind="ArcadeSubscribePage",this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class p8{constructor(){this.$intentKind="ArcadeSubscribePageIntent"}async perform(e,t){return await kp(t,e.url)}}class w8 extends B2{constructor(e,t){super("ArcadeSubscribeBuilder"),t.exportingService(NF,{fetchSubscribePage:async t=>await kp(e,t.url)})}defaultPlatforms(e){return ee(e)}defaultTab(e){return pW}defaultAttributes(e){const t=[Hq,hH,wH]
return e.appleSilicon.isSupportEnabled&&t.push(xH),t}pageType(){return zO}pageRoute(e){return[{hostName:"arcadeSubscribePageCustomContext",query:[`${tz.appId}?`,`${tz.context}?`,`${tz.subscribePageMessage}?`,`${tz.askToBuyId}?`,`${tz.editorialItem}?`,`${tz.includePostSubscribeAttribution}?`]},{hostName:`${WW}`,query:[`${tz.appId}?`,`${tz.context}?`,`${tz.subscribePageMessage}?`,`${tz.askToBuyId}?`,`${tz.editorialItem}?`,`${tz.includePostSubscribeAttribution}?`]},{path:"arcade/subscribe",query:[`${tz.appId}?`,`${tz.context}?`,`${tz.subscribePageMessage}?`,`${tz.askToBuyId}?`,`${tz.editorialItem}?`,`${tz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${tz.appId}?`,`${tz.context}?`,`${tz.subscribePageMessage}?`,`${tz.askToBuyId}?`,`${tz.editorialItem}?`,`${tz.includePostSubscribeAttribution}?`]}]}generatePageRequest(e,t,n){return co(e,this.marketingItemContextFromParameters(n),f(n,tz.appId)).attributingTo(t.build())}async renderPage(e,t,n,o){var a,c
const u=o[w8.contextualAppRequirementKey]
let d=null
s(u)&&(d=yt(e,u))
const h=l(t,vO).map(e=>y(e)),p=e.arcade.getMarketingItemFromMarketingItems(h),w=p,g=Uc(e,w,0,!1,!1,FL),m=this.marketingItemContextFromParameters(n),A=e.client.isPhone,b=m===pt(sL),S=new YY(pW,e.bag.arcadeAppAdamId,null,xj,null,b&&A?"arcadeLaunchRepairCompactSheet":GC,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
S.titles[LU]=e.loc.string(HB,qB)
const P=f(n,tz.appId),I=function(e,t,n,r){var o
const s=Un(e,"Upsell",n,r)
return i(r)&&(s.mercuryMetricsData=null!==(o=bh(0,r))&&void 0!==o?o:void 0),s}(e,0,w.id,w)
I.offerType=UO,I.baseFields.upsellType=this.metricsUpsellType(m),I.baseFields.subscriptionSKU=e.bag.arcadeProductId
const C={pageInformation:I,locationTracker:{rootPosition:0,locationStack:[]}},k=jc(e,{marketingItemData:p},Nc(0,w),C,!1)
if(!T(c=k)||c[PW]!==Fy)throw new Error("Only buy actions are supported on the upsell page")
const O=new h8(g,e.loc.string(BA),k,S)
let E
O.askToBuyMessage=f(n,tz.subscribePageMessage),O.askToBuyId=f(n,tz.askToBuyId),jn(e,O,I)
let R=!1
if(s(d)){O.primaryIcon=ef(e,d,C,{useCase:O6.LockupIconLarge})
const t=V(d,Sq),r=Ks(e,d,C)
r.excludeAttribution=!v(n[tz.includePostSubscribeAttribution]),E=Sr(e,d,Gq,m,t,r),R=!0}if(!v(n[tz.includePostSubscribeAttribution])){const e=O.pageMetrics.instructions
if(!r(e))for(const t of e)t.data.includingFields.push(VM)}let D=[]
const _=o[w8.contextualIconsRequirementKey]
if(s(_)&&(D=bt(_)),i(p)&&(D=we(p,mW)),s(D)){const t=[]
for(const n of D)if(n.id===P){if(!R){O.primaryIcon=ef(e,n,C,{useCase:O6.LockupIconLarge})
const t=V(d,Sq),r=Ks(e,n,C)
E=Sr(e,n,Gq,m,t,r)}}else t.push(ef(e,n,C,{useCase:O6.LockupIconMedium}))
O.icons=t}return i(E)&&(k.postSubscribeAction=E),b&&i(P)&&(O.openAppAction=new rK(P)),s(O.icons)||i(O.primaryIcon)||(O.artwork=this.genericArtworkFromData(e,w)),b&&(O.singleIcon=O.primaryIcon,(null===(a=O.singleIcon)||void 0===a?void 0:a.art)&&(O.singleIcon.art.contentMode=tm.scaleAspectFit)),O.subscribedOfferButtonAction=new LX(pW),O}genericArtworkFromData(e,t){if(!i(t))return null
const n=e.client.isPhone,r=function(e,t,n){const r=function(e,t){return _c(e,t)}(e,t)
return p(r,n)}(e,t,n?mb:tR)
if(!s(r))return null
let o=null,a=h(r,WG)
return n?(o="of",a=a-296-1602):(o="og",a=a-344-772),Xd(e,r,{cropCode:o,allowingTransparency:!0,useCase:O6.ArcadeContextualUpsell,overrideHeight:a})}metricsUpsellType(e){return i(e)?e:pt(Pj)}marketingItemContextFromParameters(e){let t=f(e,tz.context)
const n=f(e,tz.askToBuyId)
switch(o(t)&&s(n)&&(t=iL),t){case sL:return pt(sL)
case iL:return pt(iL)
default:return t}}}w8.contextualIconsRequirementKey="contextualIconsRequirement",w8.contextualAppRequirementKey="contextualPrimaryIconRequirement"
class g8 extends bJ{constructor(e){super(e,"ArcadePage")}}const v8="amdImpressionData"
class m8 extends B2{constructor(e=null){super(e||"AbstractGroupingPageController")}generateAdditionalPageRequirements(e,t,n){var r
const o=super.generateAdditionalPageRequirements(e,t,n),i=e.amsEngagement
if(!i||!vn(e))return o
const s=[sq,yW,pW],a=null===(r=e.bag.tabsStandard.find(e=>e.url===t.toString()))||void 0===r?void 0:r.id
if(!s.includes(a))return o
const c={timeout:1e3,eventType:VK,tab:a}
return o[v8]=D(i.performRequest(c)),o}async renderPage(e,t,n,r,o,s){return await Ha(yb,async()=>{const a=function(e,t){const n=yt(e,t)
return n&&de(n,ij)?fl(e,n):null}(e,t),c=function(e,t,n){const r=yt(e,t)
if((0,Zv.isNothing)(r))return null
const o=Un(e,QE,r.id,t),s=Ps(e)
return o.recoMetricsData=Sh(o.recoMetricsData,null,s),{shelves:[],metricsPageInformation:o,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:j(r,"id"),pageGenreId:null,hasAuthenticatedUser:i(e.user.dsid),refreshController:Br(t),recoImpressionData:gn(0,null==n?void 0:n[v8])}}(e,t,r)
return(0,Zv.isNothing)(a)||(0,Zv.isNothing)(c)?null:this.renderGroupingPage(e,a,c,n,r,o,s)})}}class y8{constructor(){this.$intentKind="ArcadePageIntent"}async perform(e,t){return await Ep(t,e)}}class A8 extends m8{constructor(e,t){super("ArcadePageBuilder"),t.exportingService(NF,{fetchPage:async t=>await Ep(e,t)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Hq,hH,wH,PU]
return e.bag.enableUpdatedAgeRatings&&t.push(Fq),e.appleSilicon.isSupportEnabled&&t.push(xH),t}pageType(){return pW}pageRoute(e){return[{protocol:FW,path:`/${VW.store}/${VW.grouping}`,query:[tz.isArcade,`${tz.isTrialAvailable}?`,`${tz.isTrialEnrolled}?`,`${tz.isSubscribed}?`,tz.id]},{hostName:HW,path:`/WebObjects/{storePreviewInstance}/wa/${VW.grouping}`,query:[tz.isArcade,`${tz.isTrialAvailable}?`,`${tz.isTrialEnrolled}?`,`${tz.isSubscribed}?`,tz.id,`${tz.useReleaseId}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[tz.isArcade,`${tz.isTrialAvailable}?`,`${tz.isTrialEnrolled}?`,`${tz.isSubscribed}?`]},{protocol:FW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[tz.isArcade,`${tz.isTrialAvailable}?`,`${tz.isTrialEnrolled}?`,`${tz.isSubscribed}?`]},{protocol:FW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[tz.isArcade,`${tz.isTrialAvailable}?`,`${tz.isTrialEnrolled}?`,`${tz.isSubscribed}?`]}]}generatePageRequest(e,t,n){const r=n[tz.id],o=v(n[tz.isSubscribed]),s=v(n[tz.isTrialEnrolled])
if(!a(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
const c=[Hq,$q,hH,wH,LV,SG]
e.appleSilicon.isSupportEnabled&&c.push(xH),e.bag.enableUpdatedAgeRatings&&c.push(Fq),of(e)&&c.push(EH)
let l=new yY(e).includingAgeRestrictions().includingAttributes(c).includingMacOSCompatibleIOSAppsWhenSupported()
ii(e)&&(l.enablingFeature(tq),l.includingScopedAttributes(hW,nZ),l.includingScopedRelationships(hW,[rW])),si(e)&&(l.enablingFeature(AM),Ai(l)),ai(e)&&(l.enablingFeature(BB),bi(l))
const u=ne(e)
if(i(u)&&l.addingQuery(HG,u),o){const t=!0,n=ar(e,e.bag.arcadeTrialEnrolledStateRate)
t&&s&&n?l.addingQuery(ij,"trial-enrolled"):l.addingQuery(ij,"subscriber")}else l.addingQuery(ij,"nonsubscriber"),l.includingRelationshipsForUpsell(!1)
l.withIdOfType(r,UV)
const d=t.query[tz.useReleaseId]
return ez.has(t.host)&&(null==d?void 0:d.length)>0&&(l=l.addingQuery(jC,d),l.isStorePreviewRequest=!0),l.enablingFeature(ZE),l.enablingFeature(wb),l.withSparseCount(Q(e)),l.includingScopedSparseLimit(NB,X(e)),l.attributingTo(t.build())}renderGroupingPage(e,t,n,r,i,a,c){return Kv.context(Bj,()=>{const i=v(r[tz.isSubscribed]),c=v(r[tz.isTrialAvailable]),l=v(r[tz.isTrialEnrolled]),u={}
u[tz.isArcade]="true",u[tz.isSubscribed]=`${i}`,u[tz.isTrialAvailable]=`${c}`,u[tz.isTrialEnrolled]=`${l}`,n.additionalShelfParameters=u,n.isArcadePage=!0,n.metricsPageInformation.isCrossfireReferralCandidate=!0
let d=null,f=null
if(!i){const r=lo(e,t.originalGroupingData)
if(r)d=r.marketingItemData
else if(a){Kv.unexpectedNull(BH,VC,"relationships.upsell")
const e=uo(0,a.get(j_))
e&&(d=e.marketingItemData)}if(s(d)&&s(d.attributes)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,mercuryMetricsData:bh(0,d)}
f=Fc(e,d,t),s(n)&&o(n.pageTitleEffect)&&0===n.shelves.length&&(n.pageTitleEffect=function(e,t){const n=Cc(e,t,!0),r=Ic(e,t)
return $c(0,n.artworkData||r.artworkData,!0)}(e,d)),_h(n.metricsLocationTracker)}}const h=A8.insertUpsellBreakoutShelfIntoParseContextIfNecessary(f,i,n)
ul(e,t,n)
const p=new g8(n.shelves)
jn(e,p,n.metricsPageInformation),p.tabTitle=j(t.originalGroupingData,AW)
const w=j(t.originalGroupingData,AW)
e.host.clientIdentifier,h||(p.title=w)
const g=new $4(DV)
g.color=Se("primaryText"),g.isFallbackStyle=!0,e.clientCapabilities.isEnabled("arcadeStandardLargeTitle")?p.presentationOptions=[TM]:p.presentationOptions=[]
let m=!1
if(n.shelves.length>0){const e=n.shelves[0].contentType===B$,t=n.shelves[0].contentType===gG,r=n.shelves[0].contentType===wj
m=e||t||r}if(m&&(p.presentationOptions.push(kN),p.titleEffect=n.pageTitleEffect||g),!i&&s(f)){p.subscriptionOfferAction=A8.createSubscribeAction(e,f,{id:null,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:TW}),p.subscriptionOfferDisplayProperties=new YY(pW,e.bag.arcadeAppAdamId,null,xj,null,pW,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r={marketingItemData:d}
p.subscriptionLockup=$d(e,r,t,pt(iU),xj,WE)}const y={id:"arcade-see-all-games-footer",presentationHints:{},featuredContentId:-1,featuredContentData:null,nativeGroupingShelfId:1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
if(this.insertUnifiedMessageShelves(e,p),p.shelves.length>0){const t=A8.groupingArcadeFooterShelfController.createShelf(e,null,n,y,null)
p.shelves.push(t)}if(0===p.shelves.length)throw new Error(`Missing content for Arcade grouping ${JSON.stringify(r)}`)
return p.autoUpsellAction=no(e,pt(Pj),null,null),Op(p),p})}static insertUpsellBreakoutShelfIntoParseContextIfNecessary(e,t,n){return Kv.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(o(e))return t||Kv.unexpectedNull(DH,VC,gG),!1
const r=new yJ(gG)
return r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t,n){if(o(t))return null
{const r=no(e,pt(tO),null,null,n)
return r.title=t.offerButtonAction.title,r}}createTermsAndConditionsShelf(e){return!r(e.bag.termsAndConditionsURL)&&e.client.deviceType,null}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t,n){if(r(n))return null
const o=yt(e,t),i=v(n.parameters[tz.isSubscribed]),s=lo(e,o)
return!i&&r(s)?new Set([j_]):null}fetchAdditionalDataForKey(e,t){return Kv.context("fetchAdditionalDataForKey",async()=>{let n
return t===j_&&(n=co(e,pt(iU)),Kv.unexpectedNull(DH,RV,"upsellRecovery.marketingItem")),r(n)?null:await Ln(e,n).catch(()=>null)})}insertUnifiedMessageShelves(e,t){t.shelves.length<=0||(t.shelves.splice(1,0,wl(0,"arcadePageHeader")),t.shelves.splice(6,0,wl(0,"arcadePageMid")),t.shelves.push(wl(0,"arcadePageFooter")))}}A8.groupingArcadeFooterShelfController=new d4
class T8{constructor(e,t){this.$kind="ArcadeWelcomePage",this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class b8{constructor(e,t,n,r,o){this.$kind="ArcadeWelcomeContent",this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class S8{constructor(e,t,n){this.$kind="ArcadeWelcomeItem",this.headline=e,this.body=t,this.artwork=n}}const P8={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:NA,textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},I8={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:NA,textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"}
class C8{constructor(){this.$intentKind="ArcadeWelcomePageIntent"}async perform(e,t){return await Dp(t,e.url)}}class k8 extends N2{constructor(e,t){super("ArcadeWelcomeBuilder"),t.exportingService(NF,{fetchArcadeWelcomePage:async t=>await Dp(e,t.url)})}pageType(){return"arcadeWelcome"}async handlePage(e,t,n,r,o){const i=await this.generatePage(e,n,r)
return N2.createFlowAction(i,this.pageType(),t)}pageRoute(e){return[{hostName:"arcadeWelcomePage",query:[`${tz.context}?`]}]}async generatePage(e,t,n){return function(e,t){return function(e,t){const n={rootPosition:0,locationStack:[]},r=function(e,t){if(rr(t)){const t=new xW
return t.title=e.loc.string("ARCADE_WELCOME_TV_CONTINUE_BUTTON"),t}return Rp(0,e.loc.string("ARCADE_WELCOME_CONTINUE_BUTTON"))}(e,t)
Xs(e,r,{id:"arcade-welcome-continue",actionType:bW,pageInformation:new uK,locationTracker:n,targetType:TW})
const o=function(e,t){return rr(t)?Rp(0,e.loc.string(jO)):null}(e,t)
o&&Xs(e,o,{id:"arcade-welcome-create-family",actionType:bW,pageInformation:new uK,locationTracker:n,targetType:TW})
let i=P8,s="oe"
e.client.isPad&&(i=I8,s="og")
const a=new b8(e.loc.string("ARCADE_WELCOME_INDIVIDUAL_TITLE"),e.loc.string("Arcade.Welcome.Family.Description"),[new S8(null,null,Xd(e,i,{useCase:O6.ArcadeWelcomeSheet,cropCode:s}))],r,o)
if(rr(t)){a.nonDismissingContinueAction=Rp(0,e.loc.string(jO)),r.title=a.nonDismissingContinueAction.title
const t=new xW
t.title=e.loc.string(BA),a.dismissingFamilyAction=t,o.title=a.dismissingFamilyAction.title}else a.nonDismissingContinueAction=Rp(0,e.loc.string(jO)),r.title=a.nonDismissingContinueAction.title
return new T8(a,a)}(e,t)}(e,t[tz.context])}}class O8 extends N2{constructor(){super("FamilyCircleBuilder")}pageType(){return Xq}defaultTab(e){return pW}async handlePage(e,t,n,r,o){var i
const s=new LX(pW),a=null!==(i=t.query[nV])&&void 0!==i?i:hA,c=new t9(Pq,a,t.query)
return s.actions.push(c),s}pageRoute(e){return[{hostName:`${YW}`},{path:`${YW}`}]}}class E8{constructor(e,t){this.$kind="UpsellGridContent",this.primaryIcon=e,this.icons=t}}class R8{constructor(){this.$intentKind="ArcadeUpsellGridIntent"}async perform(e,t){return await _p(t,e.contentDictionary)}}class D8 extends N2{constructor(e,t){super("MarketingItemUpsellBuilder"),t.exportingService(NF,{fetchUpsellGrid:async t=>await _p(e,t.contentDictionary)})}pageType(){return Dj}pageRoute(e){return[{hostName:`${WW}`,query:[`${tz.appId}?`,`${tz.context}?`,`${tz.includePostSubscribeAttribution}?`],exclusions:[{query:[`${tz.askToBuyId}`]}]},{path:"arcade/subscribe",query:[`${tz.appId}?`,`${tz.context}?`,`${tz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${tz.appId}?`,`${tz.context}?`,`${tz.includePostSubscribeAttribution}?`]}]}async handlePage(e,t,n,r,o){var i
const s=pt(f(n,tz.context)),a=f(n,tz.appId),c=new hZ(pW,s,e.bag.metricsTopic,a),l=new FY(Dj),u=null===(i=e.metricsIdentifiersCache)||void 0===i?void 0:i.getMetricsFieldsForTypes([im.user,im.client,im.canonical])
return(0,Jv.isSome)(u)&&(c.metricsOverlay={...c.metricsOverlay,...u}),l.pageData=c,l}}class _8{constructor(){this.$intentKind="ArcadeSubscriptionDecorationIntent"}async perform(e,t){return await Lp(t,e.json)}}class L8 extends N2{constructor(e,t){super("ArcadePurchaseDecorationController"),t.exportingService(XC,{decorateArcadePurchase:async t=>await Lp(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class M8{constructor(e,t,n){this.$kind="PersonalizedOfferContext",this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}class x8{constructor(){this.$intentKind="PersonalizedOfferContextIntent"}async perform(e,t){return await Mp(t,e.offerToken)}}class $8 extends N2{constructor(e,t){super("CompleteCollectionController"),t.exportingService("CMCPersonalizationData",{fetchPersonalizedOfferContext:async t=>await Mp(e,t.offerToken)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class F8{constructor(e,t){this.purchase=e,this.buyParams=t}}class N8{constructor(e,t){this.items=e,this.commonBuyParams=t}}class B8{constructor(){this.$intentKind="PurchaseDecorationIntent"}async perform(e,t){return await $p(t,e.json)}}class U8{constructor(){this.$intentKind="PurchasesDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await $p(t,r))
return n}}class G8{constructor(){this.$intentKind="BatchPurchaseDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await $p(t,r))
const r=n.map(e=>e.buyParams),[o,i]=function(e){const t=[]
for(const n of e)t.push(new fK(n).toRawMap())
const n=function(e){if(0===e.length)return{}
const t={},n=e[0]
for(const r of Object.keys(n)){let o=!0
for(let t=1;t<e.length;t++)if(e[t][r]!==n[r]){o=!1
break}o&&(t[r]=n[r])}return t}(t)
for(const e of t)for(const t of Object.keys(n))delete e[t]
return[t,n]}(r),s=[]
for(let e=0;e<n.length;e++)s.push(new F8(n[e],o[e]))
return new N8(s,i)}}class j8 extends N2{constructor(e,t){super("PurchaseDecorationController"),t.exportingService(XC,{decoratePurchase:async t=>await $p(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class V8{constructor(){this.$intentKind="IconArtworkIntent"}async perform(e,t){return await Fp(t,e.adamIds)}}class H8 extends N2{constructor(e,t){super("IconLookupController"),t.exportingService("ContentData",{fetchIconArtwork:async t=>await Fp(e,t.adamIds)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class q8 extends N2{constructor(){super("ContentLink")}pageType(){return SW}async handlePage(e,t,n,o,s){if(r(f(n,tz.path)))throw new Error(`Unhandled search url: ${t}`)
const a=await M(e.network.fetch({url:t.build(),method:aB}))
if(!a.success)throw new Error(`Unhandled search url: ${t}`)
const c=a.value
if(this.hasGotoURLInResponse(e,c))return new xW
if(i(c.url))return await e.required(O3).fetchAction(e,c.url,s)
throw new Error(`Unhandled search url: ${t}`)}pageRoute(e){return[{hostName:"search.itunes.apple.com",path:"WebObjects/MZContentLink.woa/wa/link",query:[tz.path]}]}hasGotoURLInResponse(e,t){const n=t.body
if((0,Jv.isNothing)(n)||0===n.length)return!1
try{const t=m(e.plist.parse(n)),r=f(t,KO),o=f(t,ZO)
return!!(r===QO&&(0,Jv.isSome)(o)&&o.length>0)}catch{return!1}}}class W8 extends N2{constructor(){super("ExperimentLink")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i={url:t.toString()},s=await M(e.network.fetch(i))
if(!s.success)throw s.error
const a=s.value
if(a.status>=200&&a.status<300){const e=new GY(Gq)
return e.title="You have been enrolled in the AB test",e.message=`Test ${t.query.ab2} is now active on your device.`,e.buttonTitles=["OK"],e.buttonActions=[new LX(WH)],e}throw new Error(`unexpected response status: ${a.status} from ${a.url}`)}pageRoute(e){return[{protocol:FW,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}const z8=[yW,r_]
class Y8 extends N2{constructor(){super("FallbackActionBuilder")}async handlePage(e,t,n,i,s){return await async function(e,t,n,i){var s
const a=t.query[cq]
switch(a){case bH:const n=new FY(kj)
n.presentationContext=Qj,n.animationBehavior=sU
const c=t.query[pL]
return c?n.pageUrl=c:t.query[Yy]?n.pageUrl=wz.fromComponents(null,a,null,{continuation:t.query[Yy]}).toString():n.pageUrl=a,await Promise.resolve(n)
case Jy:const l=new FY(kj)
return l.presentationContext=Qj,l.animationBehavior=sU,l.pageUrl=function(e){let t=e.bag.createAccountUrl
return(r(t)||typeof t!==zq)&&(t=uO),new wz(t)}(e).build(),await Promise.resolve(l)
case KF:let u,d=[]
{u=wL
const e=new FY(bH)
e.presentationContext=Qj,e.animationBehavior=dH
const t=new FY(Ky)
t.animationBehavior=dH,d=[e,t]}const f=new LX(u)
return f.actions=d,await Promise.resolve(f)
case gL:const h=t.query[pL]
if(h.length>0){const t={url:h,signingStyle:nH}
return e.network.fetch(t),await Promise.resolve(new xW)}return await Promise.reject(new Error("Original url is missing when creating deep-link for checkForPreorders."))
case ZF:const p=new FY(kj)
p.presentationContext=Qj,p.animationBehavior=sU
const w=new wz(a)
return t.query[cB]&&t.query[cB].length>0&&w.param(tz.code,t.query[cB]),p.pageUrl=w.build(),await Promise.resolve(p)
case QF:const g=new FY(kj)
return g.presentationContext=Qj,g.animationBehavior=sU,g.pageUrl=a,await Promise.resolve(g)
case Zy:const v=new FY(kj)
return v.presentationContext=Qj,v.animationBehavior=sU,v.pageUrl="charity",await Promise.resolve(v)
case Rq:let m=t.query[rj]
if(m||(m=null!==(s=t.query.q)&&void 0!==s?s:t.query[lO]),m&&m.length>0){const t=m
if(m=m.replace(/\+/g," ").trim(),t.endsWith("+")&&m.length>0&&(m+="+"),o(m))return await Promise.reject(new Error("Empty search term."))
const n=ve(e,Up(e,{term:m,origin:lB})).toString(),r=new d5(m,m,n,lB,null,null,null,i)
na(e,r,TW,{rootPosition:0,locationStack:[]})
{const e=new FY(Rq)
return e.pageData=r,await Promise.resolve(e)}}{const e=new LX(Rq)
return await Promise.resolve(e)}}return await Promise.reject(new Error(`FlowAction was not able to be created for this action URL: ${t}`))}(e,t,0,s)}pageRoute(e){return[{query:[`${tz.action}=account`]},{query:[`${tz.action}=signup`]},{query:[`${tz.action}=purchased`]},{query:[`${tz.action}=checkForPreorders`]},{query:[`${tz.action}=redeem`]},{query:[`${tz.action}=gift`]},{query:[`${tz.action}=donate`]},{query:[`${tz.action}=search`]}]}pageType(){return Xq}}class J8 extends N2{constructor(){super("GameCenterProfileLinkController")}defaultTab(e){return pW}pageType(){return Xq}async handlePage(e,t,n,r,o){let i=!1
if(e.host.clientIdentifier===wY)i=!0
else for(const t of e.bag.tabsStandard)if("ocelot"===f(t,"id")){i=!0
break}const s=new LX(i?pW:sq),a=n[tz.id]||"GameCenter.localPlayer"
return s.actions.push(new s6(a)),s}pageRoute(e){return[{identifier:tk,path:`/${VW.gameCenterProfile}`,query:[`${tz.id}?`]}]}}class K8 extends N2{constructor(){super("HiddenPurchasesLinkController")}pageType(){return YO}async handlePage(e,t,n,r,o){const i=new FY(YO)
return i.presentationContext=yL,i}pageRoute(e){const t=[]
return t.push({hostName:"showHiddenPurchases"}),t}}class Z8 extends N2{constructor(){super("LibraryLink")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${t.query.g}&mt=8`
return await e.required(O3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${tz.action}=library-link`]}]}}class Q8 extends N2{constructor(){super("LongUrlBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const a=t.query[pL]
if((0,Jv.isNothing)(a)||0===a.length)throw new Error("Original url is missing when creating deep-link for checkForLongUrl.")
const c=await M(e.network.fetch({url:a,method:aB,signingStyle:nH}))
if(!c.success)throw new Error(`Unable to fetch long url: ${a}`)
const l=c.value
let u
const d=l.headers["Content-Type"]
if(l.ok&&l.redirected&&i(l.url))u=l.url
else{if(l.ok&&a!==l.url)return e.console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${a}. Redirected url: ${l.url}`),new xW
if(l.ok&&s(d)&&-1!==d.toLowerCase().indexOf("text/xml")){const t=m(e.plist.parse(l.body)),n=f(t,KO),r=f(t,ZO)
n===QO&&r&&(u=r)}}if((null==u?void 0:u.length)>0)return await e.required(O3).fetchAction(e,u,o)
throw new Error(`Unable to map long url for: ${a}`)}pageRoute(e){return[{query:[`${tz.action}=checkForLongUrl`]}]}}class X8 extends N2{constructor(){super("MultiplexingBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=new yY(e).withIdOfType(n.id,Vx)
return await Ln(e,i).then(async t=>await this.actionFromMultiplexResponse(e,t))}pageRoute(e){return[{protocol:FW,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[tz.id]}]}async actionFromMultiplexResponse(e,t){const n=p(t,"results.target"),r=p(t,"results.target-link")
return n?await this.targetDataToAction(e,n):r?await this.targetLinkDataToAction(r):null}async targetDataToAction(e,t){const n=f(t,CG)
if(!n)return null
const r=Ni(e,n)
return await e.required(O3).fetchAction(e,r,null)}async targetLinkDataToAction(e){const t=f(e,eW),n=new wz(t),r=this.addProtocolToURLIfNeeded(n).toString()
return await Promise.resolve(new JY(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol=H_),e}}class e7 extends N2{constructor(){super("NotificationSettingsLinkController")}pageType(){return Xq}async handlePage(e,t,n,r,o){return new FY(WA)}pageRoute(e){const t=[]
return t.push({path:"notifications/settings"}),t}}class t7 extends N2{constructor(){super("TabSelectionBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=t.pathComponents(),s=i.length-1
let a,c
return a=s>=0?i[s]:t.query[cq],null!=a&&this.currentDeviceSupportsUrlAction(e,a)&&(c=new LX(a),c.popToRoot=t.query.popToRoot===bq),void 0===c&&(c=new LX(tW)),c}pageRoute(e){const t=[tW,"home",sq,yW,LG,yj,MF,xF,$F,uB,pW,QU],n=[]
for(const e of t){const t=`${tz.action}=${e}`,r=`${e}`
n.push({query:[t]}),n.push({path:r}),n.push({path:`{countryCode}/${r}`})}return n.push({path:"{countryCode}/ipad"}),n.push({path:"{countryCode}/iphone"}),t7.supportedIOSTabs.forEach(e=>{n.push({path:`{countryCode}/ipad/${e}`}),n.push({path:`{countryCode}/iphone/${e}`})}),n}currentDeviceSupportsUrlAction(e,t){return!!t7.supportedIOSTabs.includes(t)}}t7.supportedMacTabs=[LG,pW,yj,MF,xF,$F,uB,Rq],t7.supportedIOSTabs=[tW,yW,sq,pW,Rq],t7.supportedTvTabs=[LG,yW,sq,pW,Rq],t7.supportedVisionOSTabs=[QU,pW,Rq]
class n7 extends N2{constructor(){super("PassbookBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){const i=this.assemblePassbookRoomURL(e,t).build()
return await e.required(O3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${tz.action}=passbook`]}]}assemblePassbookRoomURL(e,t){let n=e.bag.passbookMainURL
return null!=n&&typeof n===zq||(n="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new wz(n)}}class r7 extends N2{constructor(){super("WatchCategoryBuilder")}pageType(){return Xq}async handlePage(e,t,n,r,o){if(e.client.deviceType!==lW)throw new Error(`Unsupported url for current platform: ${t}`)
const i=e.bag.watchAppsGroupingURL,s=await M(e.required(O3).fetchAction(e,i,o))
if(!s.success)throw s.error
const a=s.value,c=new LX(yW)
return c.actions=[a],c}pageRoute(e){return[{query:[`${tz.action}=watchCategory`]}]}}class o7 extends U2{}const i7=[Yj,oH,aW,AG,PN],s7=[Yj,oH,IN,aW,TG,MB,AU,TU],a7=[Yj,CN,oH,TG],c7=[Yj,IN,aW,TG,AG,oH,CN,TU,AU,MB]
class l7{}class u7 extends N2{constructor(){super("DeveloperBuilder")}async handlePage(e,t,n,r,o){const i=function(e,t){const n=Bi(t)
if(!a(n))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return Di(e,new yY(e).withIdOfType(t,yV))}(e,n)}(e,t)
return await Ln(e,i).then(t=>jp(e,t)).then(e=>N2.createFlowAction(e,SW,t))}pageRoute(e){return[{protocol:FW,path:`/${VW.developer}/{id}`},{protocol:FW,path:`/${VW.developer}/{developerName}/{id}`},{protocol:FW,path:`/{countryCode}/${VW.developer}/{developerName}/{id}`},{protocol:FW,path:`/{countryCode}/${VW.artist}/{developerName}/{id}`},{protocol:FW,path:`/${VW.store}/${VW.viewArtist}`,query:[tz.id,`${tz.v0}?`]}]}async handleShelf(e,t,n,r){const i=n[fV],s=JSON.parse(i),a=new yY(e,s.remainingData).includingAdditionalPlatforms(ee(e)).includingAttributes(Ri(e)).includingMacOSCompatibleIOSAppsWhenSupported()
return function(e,t,n){const r=Wp(e,n.title,n.developerId,At(t),n.relationship,n.contentType,n.lockupListOptions,n.lockupListOptions.lockupOptions.metricsOptions.pageInformation,n.lockupListOptions.lockupOptions.metricsOptions.locationTracker,n.roomUrl,(0,Jv.isSome)(n.roomUrl))
return r.mergeWhenFetched=!0,!n.hasExistingContent&&o(r.items)&&(r.isHidden=!0),r}(e,await Ln(e,a),s)}shelfRoute(e){return[{protocol:$W,path:`/${VW.developer}/${VW.shelf}/{token}`}]}pageType(){return SW}}class d7 extends N2{constructor(){super("DeveloperHrefBuilder")}async handlePage(e,t,n,r,o){const i=n[tz.href],s=function(e,t){return Di(e,new yY(e,t))}(e,i)
return await Ln(e,s).then(t=>jp(e,t)).then(e=>N2.createFlowAction(e,SW,t))}pageRoute(e){return[{protocol:$W,path:`/${VW.developer}/${VW.href}`,query:[tz.href]}]}pageType(){return SW}}class f7 extends G2{constructor(){super("DeveloperRoomBuilder")}pageRoute(e){return[{protocol:$W,path:`/${VW.developer}/${VW.room}/{token}`}]}paginationRoute(e){return[{protocol:$W,path:`${this.paginationPath}`,query:[`${tz.token}`]}]}generatePageRequest(e,t,n){const o=n[fV],i=JSON.parse(o)
if(r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new yY(e,i.url).withSparseLimit(i.maxPerPage).includingAdditionalPlatforms(ee(e)).includingAttributes(Ri(e))}async renderPage(e,t,n,r){return await Ha(Bj,async()=>{const r=n[fV],o=JSON.parse(r),i=Un(e,XH,`${o.developerId}_${o.relationshipId}`,t)
o.metricsPageInformation=i,o.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=await this.pageWithContent(e,t,o)
return s.title=o.title,this.configurePaginationForPage(s,o,t.next),jn(e,s,i),s})}generatePaginationRequest(e,t,n,r){var o
const i=r,a=Pt(0,i)
let c
return s(a)?c=new yY(e,a):(null===(o=i.nextHref)||void 0===o?void 0:o.length)>0&&(c=new yY(e,i.nextHref).withSparseLimit(i.maxPerPage)),c.includingAdditionalPlatforms(ee(e)).includingAttributes(Ri(e)),c}async renderPaginatedPage(e,t,n){const r=n,o=s(r.remainingContent),i=await this.pageWithContent(e,t,r,!o),a=It(0,r)
return this.configurePaginationForPage(i,a,o?r.nextHref:t.next),i}configurePaginationForPage(e,t,n){const r=(null==n?void 0:n.length)>0,o=s(t.remainingContent)
r||o?(t.nextHref=n,t.url=`${this.paginationUrl}?${tz.token}=${JSON.stringify(t)}`,e.nextPage=t):e.nextPage=null}}!function(e){e.ViewAligned="viewAligned",e.CenterAligned="centerAligned"}(Jm||(Jm={}))
class h7 extends B2{constructor(){super("EditorialPageController")}defaultPlatforms(e){return ee(e)}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o)
const s=r.pathname===`/${VW.editorialPage}/${VW.shelf}`
let a
t.includingScopedRelationships("editorial-shelves",[mW]).includingScopedRelationships(aq,[SU]),s?t.includingAssociateKeys(yW,[dV]).includingAssociateKeys(sW,[dV]):(t.includingRelationships([EN]).withSparseCount(5).withSparseLimit(12).includingAssociateKeys($B,[dV]),t.includingAssociateKeys(_V,[yW])),kw(e,t),a=r.query[tz.context]||ne(e),i(a)&&t.addingQuery(HG,a)}generatePageRequest(e,t,n){var r
let i
i=t.host===KW?e.bag.safariExtensionsEditorialPageId:t.query[tz.id]||n[tz.id]
const s=n[tz.name]
if(o(i)&&o(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
const a=new yY(e)
let c=!1
return(null===(r=t.pathname)||void 0===r?void 0:r.includes(_V))&&(a.forType(_V),c=!0),c||a.forType(aq),(null==i?void 0:i.length)>0&&(c?a.withIdOfType(i,_V):a.withIdOfType(i,aq)),(null==s?void 0:s.length)>0&&a.addingQuery(tz.name,s),a.attributingTo(t.build())}pageRoute(e){return[{protocol:$W,path:`${VW.editorialPage}`,query:[`${tz.name}`,`${tz.isArcade}?`]},{protocol:$W,path:`${VW.editorialPage}`,query:[`${tz.id}`,`${tz.isArcade}?`]},{protocol:FW,path:"/{countryCode}/editorial-page/id{id}"},{protocol:FW,path:"/editorial-page/id{id}"},{protocol:FW,path:"/{countryCode}/{platform}/editorial/{id}"},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{path:"{apiVersion}/editorial/{countryCode}/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{path:"{apiVersion}/editorial/editorial-pages/{id}",query:[`${tz.name}?`,`${tz.isArcade}?`]},{path:"{apiVersion}/catalog/{countryCode}/tags/{id}",query:[`${tz.deviceFamily}?`]}]}pageType(){return SW}async renderPage(e,t,n,a,c,l){return await Ha("renderEditorialPage",async()=>await async function(e,t,n){var a,c
const l=yt(e,t)
if(!s(l))return null
const u=we(l,EN)
if(!s(u))return null
let d="Editorial"
f(l,jV)===_V&&(d="TagRoom")
const h=Un(e,d,l.id,t),p={rootPosition:0,locationStack:[]},w=Ps(e)
h.recoMetricsData=Sh(h.recoMetricsData,null,w)
const g=Br(t),{isArcadePage:v}=n,m=[]
let y=null,A=null
if(!i(l.attributes))return null
y={id:l.id,type:l.type,attributes:l.attributes,relationships:l.relationships,meta:l.meta}
let T=!1
for(const t of u){const n=m.length,o=mw(e,y.id,t,v,n,h,p),i=Iw(e,y,o)
if(!r(i)){if(0===m.length){const e=i.presentationHints
i.presentationHints={...e,isFirstShelf:!0}}o.type===pm.Upsell&&(T=!0),i.contentType===gG&&(A=Cw(e,o)),m.push(i)}}const b=v?new g8(m):new bJ(m)
b.title=T?null:null!==(a=j(l,AV))&&void 0!==a?a:j(l,AW),b.canonicalURL=j(l,eW),b.shareAction=function(e,t){var n
const s=j(t,eW),a=j(t,AV)
if(r(s)||r(a))return null
const c=function(e,t,n,r,i,s){return Kv.context("shareSheetDataForGenericPage",()=>{if(o(n))return null
const e=new CZ(t,r,null!=s?s:void 0)
return new TZ(e,n,null)})}(0,a,s,e.loc.string("SHARE_EDITORIAL_PAGE_SUBTITLE"),0,null===(n=id(e,t,jm.EditorialPage))||void 0===n?void 0:n.artwork)
if((0,Jv.isNothing)(c))return null
const l=function(e,t){const n=[]
if((null==t?void 0:t.length)>0){const r=jo(e,t)
i&&n.push(r)}return n}(e,s)
return new oZ(c,l)}(e,l),b.pageRefreshPolicy=Gr(e,g),v&&i(A)&&(b.subscriptionLockup=A),v&&(h.isCrossfireReferralCandidate=!0),jn(e,b,h)
const S=(null===(c=m[m.length-1])||void 0===c?void 0:c.contentType)===BE
if(e.client.deviceType!==gW&&"tv"!==e.client.deviceType&&!S){const t=e.bag.termsAndConditionsURL
if(!r(t)){const n=pl(e,t)
m.push(n)}}if(m.length>0){const e=m[0].contentType===B$,t=m[0].contentType===gG,n=m[0].contentType===wj,r=m[0].contentType===U$;(e||t||n||r)&&b.presentationOptions.push(kN),r&&(b.presentationOptions.push(lM),b.presentationOptions.push(ob))}return Op(b),b}(e,t,{isArcadePage:v(n,tz.isArcade)}))}shelfRoute(e){return[{protocol:$W,path:`/${VW.editorialPage}/${VW.shelf}/`,query:[`${tz.token}`]}]}generateShelfRequest(e,t,n){const r=n[tz.token],o=JSON.parse(decodeURIComponent(r)),i=s(o.remainingItems),a=!i&&(0,Zv.isSome)(o.recommendationsHref)&&o.recommendationsHref.length>0
if(i){const t=o.remainingItems,n=new yY(e,t,!0,[dV])
return Je(e,n,t),n}if(a){const t=new yY(e,o.recommendationsHref)
return ii(e)&&(t.enablingFeature(tq),t.includingMetaKeys(NB,[H$,yM]),t.includingScopedAttributes(hW,[Mq,uG,gB]),t.includingScopedRelationships(hW,[rW])),ai(e)&&(t.enablingFeature(BB),bi(t)),t}return null}async renderShelf(e,t,n){var i
const a=n[tz.token],c=JSON.parse(decodeURIComponent(a)),l=s(c.remainingItems),u=!l&&(null===(i=c.recommendationsHref)||void 0===i?void 0:i.length)>0
if(c.isFirstRender=!1,l)c.remainingItems=this.buildHydratedShelfItems(e,c.remainingItems,t)
else if(u){c.data={...c.data,...yt(e,t)}
const n=we(c.data,mW)
c.remainingItems=s(n)?n:[],yw(e,c.data,c)}const d=Iw(e,void 0,c)
return o(d)&&!c.hasExistingContent?this.makeHiddenShelf():(function(e,t,n){if(!o(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])}(0,d,c),!c.hasExistingContent&&o(d.items)&&(d.isHidden=!0),d)}buildHydratedShelfItems(e,t,n){var r,o,i,s
const a=new Map,c=At(n)
for(const t of c)a[this.dataMapKey(e,t.type,t.id)]=t
const l=[]
for(const n of t){const t=a[this.dataMapKey(e,n.type,n.id)]
if((0,Zv.isSome)(t)){const c=kn(0,n)
if((0,Zv.isSome)(c)){const n=a[this.dataMapKey(e,dV,c.id)]
if((0,Zv.isSome)(n)){const e=null!==(r=t.meta)&&void 0!==r?r:{},a=null!==(o=y(e.associations))&&void 0!==o?o:{},c=null!==(i=y(a[dV]))&&void 0!==i?i:{},l=null!==(s=y(n))&&void 0!==s?s:{}
c.data=[l],a[dV]=c,e.associations=a,t.meta=e}}l.push(t)}}return l}dataMapKey(e,t,n){return`${t}_${n}`}makeHiddenShelf(){const e=new yJ(LN)
return e.isHidden=!0,e}}const p7="EditorialShelfCollectionPageIntent",{routes:w7,makeCanonicalUrl:g7}=dc(Ow,"/collections/{id}"),{routes:v7,makeCanonicalUrl:m7}=fc(Ow,"/{platform}/collections/{id}")
class y7 extends B2{constructor(){super("EditorialShelfCollectionPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){return function(e){const t=[Hq,$q,hH,wH,LV,SG,PU,OH]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH),t}(e)}pageType(){return SW}pageRoute(e){return[{protocol:FW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${tz.shelfId}}`},{protocol:FW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${tz.shelfId}}`},{protocol:FW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-collection/{${tz.shelfId}}`}]}generatePageRequest(e,t,n){if(o(n[tz.shelfId]))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new yY(e).forType("editorial-shelves-collection").attributingTo(t.build())}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([mW]).includingScopedRelationships(aq,[SU]).includingAssociateKeys($B,[dV]),kw(e,t)}async renderPage(e,t,n,r,o,i){return await Ha("renderEditorialShelfCollectionPage",async()=>function(e,t){const n=yt(e,t)
if(!s(n))return null
const r=Un(e,XH,n.id,t),o=Br(t),i=(_n(0,n),mw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=[],c=(0,Zv.unwrapOptional)(Iw(e,void 0,i))
c.title=null,c.eyebrow=null,c.isHorizontal=!1
const l=j(n,AV)
if((0,Zv.isSome)(l)){const e=new yJ(hM)
let t
e.id=qE,t=new A5(null,l,j(n,TV)),e.items=[t],a.push(e)}a.push(c)
const u=new bJ(a)
return u.pageRefreshPolicy=Gr(e,o),jn(e,u,r),u}(e,t))}}class A7 extends B2{constructor(){super("EditorialShelfRecommendationPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Hq,$q,hH,wH,LV,SG,PU,OH]
return e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),t}pageType(){return SW}pageRoute(e){return[{protocol:FW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${tz.shelfId}}`,query:[`${tz.editorialPageId}?`]},{protocol:FW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${tz.shelfId}}`,query:[`${tz.editorialPageId}?`]},{protocol:FW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-recommendation/{${tz.shelfId}}`,query:[`${tz.editorialPageId}?`]}]}generatePageRequest(e,t,n){const r=n[tz.shelfId],o=n[tz.editorialPageId]
if((0,Jv.isNothing)(r)||0===r.length||(0,Jv.isNothing)(o)||0===o.length)throw new Error(`Unable to map ${t.build()} to a media api url`)
const i=new yY(e,t.toString())
return i.addingQuery(tz.editorialPageId,o),i}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([mW]),kw(e,t)}async renderPage(e,t,n,r,o,i){return await Ha("renderEditorialShelfRecommendationPage",async()=>{const n=yt(e,t)
if(!s(n))return null
const r=Un(e,XH,n.id,t),o=Br(t),i=(_n(0,n),mw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=Iw(e,void 0,i)
let c
a.title=null,a.eyebrow=null,a.isHorizontal=!1,c=new A5(null,j(n,AV),j(n,TV))
const l=new yJ(hM)
l.id=qE,l.items=[c]
const u=new bJ([l,a])
return u.pageRefreshPolicy=Gr(e,o),jn(e,u,r),u})}}class T7{constructor(e){this.$kind="AppStoreEngagementTask",this.action=e}}class b7 extends MW{constructor(e,t){super(),this.$kind="EngagementToggleAction",this.actionClass="EngagementToggleAction",this.identifier=e,this.value=t}}class S7 extends MW{constructor(e,t){super(),this.$kind="TabBadgeAction",this.actionClass="TabBadgeAction",this.navigationTab=e,this.text=t}}const P7="com.apple.Arcade.ArcadeHardware1",I7="com.apple.Arcade.TrialEligible1",C7=[P7,I7]
class k7{constructor(){this.$intentKind="EngagementEventIntent"}async perform(e,t){return await Rw(t,e)}}class O7{constructor(){this.$intentKind="BadgingEventIntent"}async perform(e,t){return await Dw(t,e)}}class E7 extends N2{constructor(e,t){super("UserEngagementController"),t.exportingService("AppStoreEngagement",{fetchEngagementTask:async t=>await Rw(e,t),fetchBadgingTask:async t=>await Dw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class R7 extends m8{constructor(){super("GroupingPageBuilder")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Hq,hH,wH,PU]
return e.bag.enableUpdatedAgeRatings&&t.push(Fq),e.appleSilicon.isSupportEnabled&&t.push(xH),t}prepareRequest(e,t,n,r,o){if(function(e,t){t.includingAdditionalPlatforms(ee(e)),t.includingAgeRestrictions(),t.usingCustomAttributes(Ue(e)),t.includingMacOSCompatibleIOSAppsWhenSupported(),ii(e)&&(t.enablingFeature(tq),t.includingMetaKeys(NB,[H$,yM]),t.includingScopedAttributes(hW,nZ),t.includingScopedRelationships(hW,[rW])),ji(e,tV)&&Ti(t),si(e)&&(t.enablingFeature(AM),Ai(t)),ai(e)&&(t.enablingFeature(BB),bi(t)),t.enablingFeature("categoryHeaders"),t.enablingFeature(ZE),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([Fq]),e.bag.enableFeaturedCategoriesOnGroupings&&t.enablingFeature(wb),e.bag.enableCategoryBricksOnGroupings&&t.enablingFeature("categoryBricks")}(e,t),n===Fm.Page){const n=r.query.id
let o,i
const s=r.pathComponents();-1!==s.indexOf(AL)?o=n:-1!==s.indexOf(_H)?o=Bi(r):i=n,a(i)?t=t.withIdOfType(i,UV):a(o)&&(t=t.addingQuery(_H,o)),t.withSparseCount(Q(e)),t.includingScopedSparseLimit(NB,X(e))}const s=r.query[tz.context]||ne(e)
i(s)&&t.addingQuery(HG,s)
const c=r.query[tz.useReleaseId]
r.host===HW&&(null==c?void 0:c.length)>0&&(t.isStorePreviewRequest=!0,t=t.addingQuery(jC,c))}pageType(){return SW}pageRoute(e){return[{protocol:FW,path:`/${VW.store}/${VW.grouping}`,query:[tz.id,`${tz.context}?`]},{hostName:HW,path:`/WebObjects/{storePreviewInstance}/wa/${VW.grouping}`,query:[tz.id,`${tz.useReleaseId}?`]},{protocol:FW,path:`/{countryCode}/${VW.genre}/{genreName}/{id}`},{protocol:FW,path:`/{countryCode}/${VW.genre}/{id}`},{protocol:FW,path:`/{countryCode}/{platform}/${VW.grouping}/{id}`},{protocol:FW,path:`/${VW.store}/${VW.viewGenre}`,query:[tz.id]},{hostName:HW,path:`/WebObjects/{storePreviewInstance}/wa/${VW.viewGenre}`,query:[tz.id,`${tz.useReleaseId}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:FW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:FW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:FW,hostName:`${KW}`}]}generatePageRequest(e,t,n){var r
let o,s,c=t.query.id
if(t.host===KW&&(null===(r=e.bag.safariExtensionsGroupingURL)||void 0===r?void 0:r.length)>0){const n=wz.from(e.bag.safariExtensionsGroupingURL)
i(n)&&(c=Bi(n),t.query.id=c)}const l=t.pathComponents()
if(-1!==l.indexOf(AL)?o=c:-1!==l.indexOf(_H)?o=Bi(t):s=c,!a(s)&&!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
const u=function(e){const t=[Hq,$q,hH,wH,LV,SG,PU]
e.appleSilicon.isSupportEnabled&&t.push(xH),e.bag.enableUpdatedAgeRatings&&t.push(Fq),of(e)&&t.push(EH)
const n=new yY(e).forType(UV).includingAgeRestrictions().includingAttributes(t).includingRelationshipsForUpsell(!0)
return ji(e,tV)&&Ti(n),n}(e)
return u.attributingTo(t.build())}renderGroupingPage(e,t,n,o,i,s,a){return Kv.context(yb,()=>function(e,t,n){var o
n.pageGenreId=q(t.originalGroupingData,_H)||(r(o=j(t.originalGroupingData,"chartUrl"))?null:h(wz.from(o).query,_H))
const i=function(e,t,n){let r=null
switch(n){case JK.Apps:r=e.host.clientIdentifier===fY?e.loc.string("GROUPING_APPS"):e.loc.string("GROUPING_APP_STORE","App Store")
break
case JK.Discover:r=e.loc.string("GROUPING_DISCOVER")
break
default:r=Wd(0,t)}return r}(e,t.originalGroupingData,n.pageGenreId)
if(n.pageTitle=i,ul(e,t,n),"tv"!==e.client.deviceType&&e.client.deviceType!==BV){const t=hl(e,n.metricsPageInformation,n.metricsLocationTracker)
t&&n.shelves.push(t)}if(e.client.deviceType!==gW&&"tv"!==e.client.deviceType){const t=e.bag.termsAndConditionsURL
if(!r(t)){const r=pl(e,t)
n.shelves.push(r)}}const s=new bJ(n.shelves)
switch(e.client.deviceType){case"tv":s.title=i
break
case gW:s.title=i,s.presentationOptions=[TM]
break
case BV:s.title=i,s.presentationOptions=[TM]
const e=s.shelves[0].contentType;[wj,gb,UB].includes(e)&&s.presentationOptions.push(kN)
break
default:s.title=i,s.presentationOptions=[TM]}return n.shelves[0].contentType===U$&&(s.presentationOptions.push(lM),s.presentationOptions.push(ob),s.presentationOptions.push(kN)),s.pageRefreshPolicy=Gr(e,null==n?void 0:n.refreshController),jn(e,s,n.metricsPageInformation),function(e,t,n){if(!(t.shelves.length<=0))switch(n){case JK.Apps:t.shelves.splice(0,0,wl(0,"appsPageHeader")),t.shelves.splice(6,0,wl(0,"appsPageMid")),t.shelves.push(wl(0,"appsPageFooter"))
break
case JK.Games:t.shelves.splice(0,0,wl(0,"gamesPageHeader")),t.shelves.splice(6,0,wl(0,"gamesPageMid")),t.shelves.push(wl(0,"gamesPageFooter"))}}(0,s,n.pageGenreId),Op(s),s}(e,t,n))}}class D7 extends N2{constructor(){super(pP)}pageRoute(e){return[{protocol:$W,path:`${VW.onDeviceRecommendations}`,query:[tz.onDeviceRecommendationsUseCase,tz.token]}]}async handlePage(e,t,n,r,o){const i=n[tz.onDeviceRecommendationsUseCase]
return await ps(e,i,IW).then(r=>{const o=JSON.parse(n[tz.token]),i=new U2
i.title=o.title
const s=this.makePage(e,r.dataContainer,r.recoMetrics,i),a=new FY(SW,t.build())
return a.pageData=s,a})}makePage(e,t,n,r){const o=Ps(e)
r.url=this.paginationUrl,r.metricsPageInformation=Un(e,XH,"onDevicePersonalizationSeeAll",t),r.metricsPageInformation.recoMetricsData=Sh(n,null,o),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const i=new yJ($2),s={id:null,kind:null,softwareType:null,targetType:yq,title:r.title,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:bV,recoMetricsData:n}
Nh(e,i,s),Ch(0,s,r.title),i.isHorizontal=!1,i.shouldFilterApps=r.shouldFilter
const a=At(t)
r.remainingContent=[],i.items=Nd(e,a,{contentUnavailable:(e,t)=>(r.remainingContent=Ct(0,a,e),!0),lockupOptions:{metricsOptions:{pageInformation:s.pageInformation,locationTracker:s.locationTracker},clientIdentifierOverride:r.clientIdentifierOverride,artworkUseCase:Qd(0,i.contentType)}})
const c=new bJ([i])
return c.title=r.title,r.remainingContent.length&&(c.nextPage=r),jn(e,c,r.metricsPageInformation),c}async handleShelf(e,t,n,r){throw new Error(nk)}shelfRoute(e){return[]}pageType(){return SW}}class _7{constructor(){this.$intentKind="InAppPurchaseInstallPageIntent"}async perform(e,t){return await _w(t,e.url)}}class L7 extends N2{constructor(e,t){super("InAppPurchaseInstallController"),t.exportingService(rk,{fetchInstallPage:async t=>await _w(e,t.url)})}async handlePage(e,t,n,r,o){const i=n[tz.id],s=n[nz],a=new yY(e).withIdOfType(s,rq),c=await Ln(e,a,{}),l=function(e,t,n){const r={pageId:n||"",pageType:"IAPInstallPage",parentId:gh(t)}
return new uK(r)}(0,i,s),u=yt(e,c)
let d
const f={metricsOptions:{pageInformation:l,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:O6.LockupIconSmall}
s&&u&&(d=Ed(e,u,f),d.theme=Jq)
const h=pe(e,u,rW)
let p
i&&h&&(p=Od(e,h,f))
const w=new BY
w.isComplete=!0,w.lockup=d,w.parentLockup=p
const g=wr(e,u)
return w.preInstallOfferDescription=Wo(e,g),function(e,t,n){jn(e,t,n)}(e,w,l),N2.createFlowAction(w,hR,t)}pageRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.install}`,query:[`${tz.id}`,`${nz}?`]}]}pageType(){return hR}}class M7 extends N2{constructor(e,t){super("MetricsLinterController"),t.exportingService("Metrics",{async lintEvent(t){const n=hr(e).makeEvent(e,t.fields)
return await Promise.resolve(n)}})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class x7{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class $7{constructor(e,t){this.$kind="MSOAppsResponse",this.apps=e,this.appsToAlwaysShow=t}}class F7{constructor(){this.$intentKind="MSOProviderDataIntent"}async perform(e,t){return await Lw(t,e.providerAdamId)}}class N7{constructor(){this.$intentKind="MSOPageIntent"}async perform(e,t){return await Mw(t,e)}}class B7 extends N2{constructor(e,t){super("MSOBuilder"),t.exportingService("MSOData",{fetchProviderData:async t=>await Lw(e,t.providerAdamId),fetchPage:async t=>await Mw(e,t)})}async handlePage(e,t,n,r,o){const i=function(e){const t=e[cz]
return t?t.split(","):[]}(n),s=function(e,t){return xw(e,Bi(t))}(e,t.removeParam(cz)),a=$w(e,await Ln(e,s),i)
return N2.createFlowAction(a,$N,t)}pageRoute(e){return[{protocol:FW,path:`/{countryCode}/${VW.mso}/{appName}/{id}`,query:[`${cz}?`]},{protocol:FW,path:`/${VW.mso}/{providerName}/{id}`,query:[`${cz}?`]},{protocol:FW,path:`/{countryCode}/${VW.mso}/{id}`,query:[`${cz}?`]},{protocol:FW,path:`/${VW.mso}/{id}`,query:[`${cz}?`]},{protocol:FW,path:`/${VW.mso}`,query:[tz.id,`${cz}?`]},{protocol:FW,path:`{countryCode}/${VW.mso}`,query:[tz.id,`${cz}?`]}]}async handleShelf(e,t,n,r){const o=n[fV],i=JSON.parse(o),s=new yY(e,i.remainingContent).includingAdditionalPlatforms(ee(e)).includingAttributes([Hq,$q,LH])
return function(e,t,n){const r=At(t),o=n
o.remainingContent=[]
const i={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},artworkUseCase:Qd(0,n.preferredShelfContentType)},contentUnavailable:function(e,t){return o.remainingContent=Ct(0,o.remainingContent,e),o.remainingContent.push(r[e]),!1}},s=new yJ(n.preferredShelfContentType)
return s.shouldFilterApps=n.shouldFilter,s.items=Nd(e,r,i),s.mergeWhenFetched=!0,s.url=Fw(o),s}(e,await Ln(e,s),i)}shelfRoute(e){return[{protocol:$W,path:`/${VW.mso}/${VW.shelf}/{token}`}]}pageType(){return $N}}class U7{constructor(){this.$intentKind="CancelPreorderIntent"}async perform(e,t){return await Nw(t,e)}}class G7 extends N2{constructor(e,t){super("CancelPreorderController"),t.exportingService("Preorder",{cancelPreorder:async t=>await Nw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class j7 extends B2{constructor(){super("AccessibilityDetailsBuilder")}defaultPlatforms(e){return[]}pageType(){return IB}pageRoute(e){return[{protocol:$W,path:`${VW.accessibilityDetails}/${VW.product}/{id}`,query:[`${tz.deviceFamily}`]},{protocol:$W,path:`${VW.accessibilityDetails}/${VW.productBundle}/{id}`,query:[`${tz.deviceFamily}`]}]}generatePageRequest(e,t,n){const r=Bi(t)
if((0,Zv.isNothing)(r)||Pi(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
const o=function(e){switch(e[tz.deviceFamily]){case Uq:return Uq
case Bq:return Bq
case vW:return vW
case oj:return oU
case aH:return aH
case gW:return gW
default:return null}}(n)
if((0,Zv.isNothing)(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing required platform.`)
let i=yW;(0,Zv.isSome)(t.pathname)&&-1!==t.pathname.indexOf(VW.productBundle)&&(i=aW)
const s=new yY(e).withIdOfType(r,i).includingAttributes([IB,pH])
return s.platform=o,s}async renderPage(e,t,n,r){return await Ha(Bj,async()=>{const r=yt(e,t)
if((0,Zv.isNothing)(r))return null
const o=n[tz.deviceFamily]
if((0,Zv.isNothing)(o))return null
const i=Un(e,"AppAccessibilityDetails",r.id,t),s={rootPosition:0,locationStack:[]},a=[]
{const t=_l(e,r,o,!0,null,i,s)
a.push(t)
const n=Ml(e,r,!0,i,s);(0,Zv.isSome)(n)&&a.push(n)
const c=Ll(e,r,o,!0,null,i,s);(0,Zv.isSome)(c)&&a.push(c)}const c=new bJ(a)
return c.title=e.loc.string(xD),c.presentationOptions=[hj,Ox,nI],jn(e,c,i),c})}}class V7 extends B2{constructor(){super("EulaBuilder")}defaultPlatforms(e){return ee(e)}generatePageRequest(e,t,n){const o=t.query.resourceId,i=t.query.resourceType
if(r(o)||r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
const s=new yY(e).withIdOfType(o,XU)
return s.targetResourceType=i,s}pageRoute(e){return[{protocol:$W,path:`${VW.eula}`}]}pageType(){return SW}async renderPage(e,t,n,r){return await Ha(Bj,async()=>{const n=f(t,"results.eula.text").split(/\n{1,2}/),r=[]
for(const e of n){const t=new qX(e)
t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,r.push(t)}const o=new yJ(Hj)
o.isHorizontal=!1,o.items=r
const i=new bJ([o])
return i.title=e.loc.string(kF),i})}}class H7 extends N2{constructor(){super("PersonalizedReviewsBuilder")}async handlePage(e,t,n,r,o){throw new Error("PersonalizedReviewsBuilder:handlePage not implemented")}pageRoute(e){return[]}async handleShelf(e,t,n,r){const o=n[fV],i=JSON.parse(o),s=new yY(e).withIdOfType(i.adamId,qq)
try{const t=await Ln(e,s)
return Oa(e,e.client.guid,i,t)}catch{return Oa(e,e.client.guid,i)}}shelfRoute(e){return[{protocol:$W,path:`/${VW.personalizedReviews}/${VW.shelf}/{token}`}]}pageType(){return Xq}}class q7 extends B2{constructor(){super("PrivacyDetailBuilder")}defaultPlatforms(e){return ee(e)}pageType(){return wD}pageRoute(e){return[{protocol:$W,path:`${VW.privacyDetail}/${VW.product}/{id}`,query:[`${tz.privacyTypeId}?`]},{protocol:$W,path:`${VW.privacyDetail}/${VW.productBundle}/{id}`,query:[`${tz.privacyTypeId}?`]}]}generatePageRequest(e,t,n){const r=Bi(t)
if((0,Zv.isNothing)(r)||0===r.length)throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
let o=yW
const i=[_$,pH,uN]
return-1!==t.pathname.indexOf(VW.productBundle)&&(o=aW),new yY(e).withIdOfType(r,o).addingQuery(r$,i.join(","))}async renderPage(e,t,n,s){return await Ha(Bj,async()=>{const s=n[tz.privacyTypeId]
return function(e,t,n){return Kv.context("privacyDetailPageFromResponse",()=>{const s=yt(e,t)
if(o(s))return null
const a=Un(e,"PrivacyDetails",s.id,t),c={rootPosition:0,locationStack:[]}
let l=[]
if(!Sl(e)){const t=function(e,t,n,r){const o=new yJ(wq)
o.isHorizontal=!1
const i=Pl(e,t,!0,!0,n,r)
return o.items=[i],o.presentationHints={isFirstShelf:!0},o}(e,s,a,c)
i(t)&&l.push(t)}const u=function(e,t,n,s,a){const c=B(t,_$)
if(o(c))return[]
const l=gl(e,c,t,Aj,!0,n,s)
if(0===l.length)return[]
const u=[]
for(const t of l)if(r(a)||t.identifier===a||e.client.deviceType!==gW){const e=new yJ(vx)
i(t.identifier)&&t.identifier===a?(t.wantsScrollFocus=!0,e.id="privacyTypeShelf_"+t.identifier):t.wantsScrollFocus=!1,e.items=[t],e.presentationHints={isSingleDensity:!0},u.push(e)
for(const e of t.purposes){const t=new yJ("privacyCategory")
t.title=e.title,t.items=e.categories,u.push(t)}}return u}(e,s,a,c,n)
l=l.concat(u)
const d=new bJ(l)
d.title=e.loc.string(gx)
for(const e of u)if((0,Zv.isSome)(e.id)){d.loadCompletedAction=new gJ(e.id)
break}return jn(e,d,a),d})}(e,t,s)})}}class W7 extends N2{constructor(){super("ProductInAppPurchaseBuilder")}async handlePage(e,t,n,r,o){const i=n[rz],s=Ui(e,new wz(i)),a={},c=n[oz]===bq
a.spotlightSection=Na(c),a.spotlightInAppProductIdentifier=n[tz.offerName]
const l=await Ln(e,s),u=await nd(e,l,a)
return N2.createFlowAction(u,kH,t)}pageRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.lookup}`,query:[rz,tz.offerName,oz]}]}pageType(){return kH}}class z7{constructor(){this.$intentKind="ShelfBasedProductPageIntent"}async perform(e,t){return await Bw(t,e)}}class Y7 extends B2{constructor(e,t){super(JA),t.exportingService(rk,{fetchPage:async t=>await async function(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(ok))
if(0!==Mn(e,new wz(t.url)).length&&ip(e,t.url),t.preloading){const e=new wz(t.url)
e.param(tz.isPreloading,bq),t.url=e.build()}const n=Y7.generateProductPageOptions(e,void 0,new wz(t.url)),r=e.required(O3).fetchPage(e,t.url,fJ)
if(!r){const r=new yY(e,t.url),o=await Ln(e,r)
return await nd(e,o,n,{},null,t.preloading)}return await r.then(n=>(e.host.clientIdentifier===vY?n&&SB in n&&zn(0,n):i(t.referrerData)&&n&&SB in n&&zn(0,n),n))}(e,t),fetchShelfBasedPage:async t=>await Bw(e,t)})}defaultPlatforms(e){return ee(e)}pageType(){return kH}defaultTab(e){return Y7.representsArcadeApp(e)?pW:super.defaultTab(e)}defaultAction(e,t,n,r){if(ht(t))return t
const o=super.defaultAction(e,t,n,r)
if(!vt(t)&&!mt(t))return o
const i=1===t.appPlatforms.length&&"tv"===t.appPlatforms[0]
if(n[tz.action]!==S3||i){if(n[tz.action]!==P3||i)return o
{const e=t.shelfMapping[qq]||t.shelfMapping[FH]
let n=null
return e&&e.seeAllAction&&(n=e.seeAllAction,n.animationBehavior=dH),o.animationBehavior=dH,new iK([o,n])}}{const n=Y7.representsBundle(t)
let r=null,i=null,s=null,a=null
vt(t)?(r=t.adamId,i=t.icon,s=t.title,a=t.subtitle):mt(t)&&(r=t.lockup.adamId,i=t.lockup.icon,s=t.lockup.title,a=t.lockup.subtitle)
const c=Ia(e,r,n,i,!1,a,s)
return o.animationBehavior=dH,new iK([o,c])}}static generateProductPageOptions(e,t,n){const r={clientIdentifierOverride:n.query[tz.clientIdentifierOverride]},o=null==t?void 0:t[tz.offerName]
if(o){const e=t[oz]===bq
r.spotlightSection=Na(e),r.spotlightInAppProductIdentifier=o}const s=n.query[aK]
s&&(r.iAdClickFields=JSON.parse(s))
const a=n.query[cK]
a&&(r.iAdLineItem=a)
const c=n.query[lK];(0,Jv.isSome)(c)&&(r.iAdDismissAdActionMetrics=JSON.parse(c))
const l=n.query[a1]
i(l)&&(r.externalDeepLinkUrl=l)
const u=n.query[c1]
i(u)&&(r.isCppDeepLinkDisabled=JSON.parse(u))
const d=null==t?void 0:t[tz.webBrowser];(0,Jv.isSome)(d)&&(r.webBrowser="1"===d)
const f=null==t?void 0:t[tz.webBrowserFlowType]
return(0,Jv.isSome)(f)&&(r.webBrowserFlowType=f),e.client.isCompanionVisionApp&&(r.clientIdentifierOverride=jz),r}pageRoute(e){return tp()}generatePageRequest(e,t,n){var o
const i=n[tz.bundleIdentifier],s=n[tz.ids],a=n[tz.productVariantID],c="1"===n[tz.includeUnlistedApps]||"1"===n[tz.isViewOnly]
let l=null
if(i){const t=st(e).adamIdFromSystemBundleId(i)
l=(0,Jv.isSome)(t)?Gi(e,t,!1,void 0,!1,c):function(e,t,n,r){const o=i0
e.bag.enablePrivacyNutritionLabels&&!$i(e,t)&&o.push(E$),ki(e)&&!Ei(e,t)&&o.push(R$),e.appleSilicon.isSupportEnabled&&o.push(xH),e.bag.enableUpdatedAgeRatings&&o.push(Fq),of(e)&&o.push(EH),e.bag.enableLicenses&&o.push(sE)
const i=new yY(e).forType(yW).withFilter(kq,t).includingAdditionalPlatforms(ee(e)).includingRelationships([VH,MG,jF,qq,aW,O$,k$]).includingAttributes(o).addingRelationshipLimit(qq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Zv.isSome)(n)&&i.addingQuery(tz.productVariantID,n),Kt(e,oq)&&i.enablingFeature(zL),r&&i.enablingFeature(qL),si(e)?i.includingViews([XO]):i.includingRelationships([YL]),i}(e,i,a,c)}else if(n[tz.action]===ik&&s){const r=(null===(o=t.pathname)||void 0===o?void 0:o.length)>0&&-1!==t.pathname.indexOf(sk)
l=Gi(e,s,v(n,tz.isPurchasesApp),a,r,c)}else l=Ui(e,t,c)
if(r(l))throw new Error(`Unable to map ${t.build()} to a media api url`)
return l}generateAdditionalPageRequirements(e,t,n){const r=super.generateAdditionalPageRequirements(e,t,n),o=function(e){for(const[t,n]of Object.entries(e))if(t.toLocaleLowerCase()===tz.appEventId.toLocaleLowerCase())return n
return null}(n),i=n[tz.offerItemId]
if((null==o?void 0:o.length)>0&&ii(e)){const t=new yY(e).withIdOfType(o,hW).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(hW,nZ).includingScopedAvailableIn(hW,[IO,uE])
r[I3]=D(Ln(e,t))}else if(s(i)&&ai(e)){const t=new yY(e).withIdOfType(i,ZV).includingAdditionalPlatforms(ee(e))
bi(t),r[I3]=D(Ln(e,t))}return r}async renderPage(e,t,n,r,o,i){return await Ha(Bj,async()=>{const o=Un(e,NV,"",t),a=Y7.generateProductPageOptions(e,n,new wz(o.pageUrl)),c=yt(e,t),l=Y7.alternativeAppForPlatform(e,c,rt(e))
if(null!==l)return l
const u="1"===n[tz.isViewOnly]
s(i)&&kW.shared.setReferralDataForProduct(c.id,i)
const d=await nd(e,t,a,r,i,v(n[tz.isPreloading]),u),f=e.fetchTimingMetricsBuilder
return(0,Jv.isSome)(f)&&f.decorate(d),d})}shelfRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.shelf}/{token}`}]}generateShelfRequest(e,t,n){return np(e,0,n)}async renderShelf(e,t,n){return await rp(e,t,n)}shelfRequiresAdditionalModification(e,t){return!0}async performAdditionalShelfModifications(e,t,n){const r=n[fV],o=C3.fromJSON(e,r)
return new Set([xV,DU,vF]).has(t.contentType)&&0===t.items.length&&!o.isFirstRender&&(t.isHidden=!0),t}async handleShelfError(e,t){const n=t[fV],r=C3.fromJSON(null,n)
if(r&&!r.hasExistingContent){const e=new yJ(r.contentType)
return e.isHidden=!0,e}return await super.handleShelfError(e,t)}static alternativeAppForPlatform(e,t,n){if(!ie(t,n)){const r=we(t,k$)
if(s(r))for(const t of r){const r=Qe(e,t,eW)
if(ie(t,n)&&(null==r?void 0:r.length)>0)return new FY(Xq,r)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&rV in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[rV]===ZM}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&rV in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[zN]===Pq}}class J7{constructor(e,t,n,r,o,i){this.$kind="GameCenterPlayerGameAchievementSummary",this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.completedText=r,this.action=o,this.achievements=i}}class K7 extends N2{async handlePage(e,t,n,r,o){throw new Error(`handlePage is not supported on: ${this.builderClass}`)}async renderPage(e,t,n){throw new Error(`renderPage is not supported on: ${this.builderClass}`)}async handleShelf(e,t,n,r){const o=await M(this.renderShelf(e,t,n))
return o.success?o.value:await this.handleShelfError(o.error,n)}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async handleShelfError(e,t){throw e}}class Z7 extends K7{constructor(){super("ProductBuilderNative")}pageType(){return kH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.shelf}`,query:[tz.isGameCenterPlayerShelf,tz.token]},{protocol:$W,path:`/${VW.product}/${VW.shelf}`,query:[tz.isGameCenterPlayerRibbonItem]},{protocol:$W,path:`/${VW.product}/${VW.shelf}`,query:[tz.isGameCenterAchievementsShelf,tz.token]}]}async renderShelf(e,t,n){if(t.query[tz.isGameCenterPlayerShelf]){const r=t.query[tz.id],o=await e.gameCenter.fetchFriendsThatPlayGame(r),i=n[tz.token]
return Pu(e,o,!0,C3.fromJSON(e,i))}if(t.query[tz.isGameCenterPlayerRibbonItem]){const n=t.query[tz.id],r=await e.gameCenter.fetchFriendsThatPlayGame(n)
return Pu(e,r,!1)}if(t.query[tz.isGameCenterAchievementsShelf]){const r=t.query[tz.bundleId],o=await e.gameCenter.fetchAchievementSummaryForGame(r),i=n[tz.token],s=C3.fromJSON(e,i)
let a=null
if(o.length>0){const t=oo({objectGraph:e,target:{achievements:{bundleID:r}},metricsPageInformation:s.sourcePageInformation,metricsLocationTracker:s.sourceLocationTracker}),n=e.loc.string("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed"),i=o[0].achievements
let c=null
const l=i.filter(e=>e.status.type===$V)
if(l.length>0&&(c=l[0]),null===c){const e=i.filter(e=>e.status.type===Eb||e.status.type===OM)
e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(c=e[0])}null!==c&&(a=new J7(o[0].bundleId,o[0].completedAchievements,o[0].totalAchievements,n,t,[c]))}const c=function(e,t,n){const r=new yJ(cI)
if(r.isHorizontal=!0,t){const o={pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:Qq,title:bj,id:"achievements_summary",idType:Dq,softwareType:null,targetType:Qq,badges:{gameCenter:!0}}
Nh(e,r,o),Xs(e,t.action,o),r.items=[t]}return r.mergeWhenFetched=!0,r.batchGroup=MV,r.isHidden=0===r.items.length,r}(e,a,s)
return c}return await super.renderShelf(e,t,n)}}const Q7="todayTabPersonalization",X7="OnDeviceRecommendationsTodayShelfController"
class eee{constructor(e){this.recommendations=e}storyData(e){var t
const n=this.recommendationForUseCase(e),r=null==n?void 0:n.candidate(sW)
if(!(0,Jv.isNothing)(n)&&!(0,Jv.isNothing)(r))return null===(t=null==n?void 0:n.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===r.id)}storyGroupData(e){var t,n
const r=this.recommendationForUseCase(e),o=null==r?void 0:r.candidate(Nj)
if((0,Jv.isNothing)(r)||(0,Jv.isNothing)(o))return
const i=null===(t=null==r?void 0:r.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===(null==o?void 0:o.id)),s=null===(n=null==r?void 0:r.dataContainer)||void 0===n?void 0:n.data.filter(e=>o.candidateIDs.includes(e.id))
return(0,Jv.isNothing)(i)||(0,Jv.isNothing)(s)?void 0:(i[PV]={associations:{recommendations:{data:s}}},i)}recommendationForUseCase(e){return this.recommendations.find(t=>t.useCase===e)}}class tee{constructor(e,t,n,r){this.useCase=e,this.candidates=t,this.recoMetrics=n,this.dataContainer=r}candidate(e){return this.candidates.find(t=>t.type===e)}}class nee{constructor(e,t,n,r){this.id=e,this.type=t,this.candidateIDs=n,this.data=r}}class ree extends K7{constructor(){super("ProductPageShelfWithAdController")}pageType(){return kH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.shelf}/{token}`,query:[tz.isShelfWithAd,tz.shelfWithAdPlacementType]}]}async renderShelf(e,t,n){const r=n[tz.shelfWithAdPlacementType],o=t.query[tz.id],i=Uw(e,r,o).catch(()=>null),s=np(e,0,n)
s.attributingTo(t.build())
const a=Ln(e,s)
return await Promise.all([a,i]).then(async([t,r])=>await rp(e,t,n,r,!0))}}class oee extends K7{constructor(){super("ProductPageSimilarItemsShelfRefreshController")}pageType(){return kH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:$W,path:`/${VW.product}/${VW.shelf}/{token}`,query:[`${tz.shelfRefreshType}=${dz}`]}]}async renderShelf(e,t,n){const r=t.query[tz.id]
let o=Promise.resolve(null),i=!1
i=Kt(e,SH),i&&(o=Uw(e,SH,r).catch(()=>null))
const s=function(e,t){const n=[Hq,$q,LH]
return e.bag.enableUpdatedAgeRatings&&n.push(Fq),of(e)&&n.push(EH),new yY(e).withIdOfType(t,Hx).enablingFeature(PV).includingAdditionalPlatforms(ee(e)).includingAttributes(n).enablingFeature(zL)}(e,r)
s.attributingTo(t.build())
const a=Ln(e,s).catch(async()=>{const r=np(e,0,n)
return r.attributingTo(t.build()),await Ln(e,r)})
return await Promise.all([a,o]).then(async([t,r])=>await rp(e,t,n,r,i))}}class iee extends N2{constructor(){super("ReviewsAdapterBuilder")}async handlePage(e,t,n,r,o){const i=Ui(e,t),s=await Ln(e,i),a=await nd(e,s)
let c,l
if(td(e)){const e=a
c=e.shelfMapping[FH],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}else{const e=a
c=e.shelfMapping[qq],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}const u=N2.createFlowAction(a,kH,t)
let d=null
return c&&c.seeAllAction&&!l&&(d=c.seeAllAction,d.animationBehavior=dH),d?(u.animationBehavior=dH,new iK([u,d])):u}pageRoute(e){return[{protocol:FW,path:`/{countryCode}/${VW.product}/{appName}/{id}`,hash:uz},{protocol:FW,path:`/${VW.store}/${VW.viewReviews}`,query:[tz.id]}]}async handlePagination(e,t,n,r,o){const i=n[sz],s=n[az],a=l(o.remainingContent),c=new yY(e,o.nextHref).includingAdditionalPlatforms(ee(e)).addingQuery(rH,s),u=await Ln(e,c,{})
return La(e,e.client.guid,i,a,u,!1,s)}paginationRoute(e){return[{protocol:$W,path:`/${VW.reviews}/${VW.shelf}/{adamId}/{sort}`}]}pageType(){return kH}}class see extends N2{constructor(){super("SortedReviewsBuilder")}async handlePage(e,t,n,r,o){const a=n[sz],c=n[az],l=new yY(e).withIdOfType(a,qx).includingAdditionalPlatforms(ee(e)).addingQuery(rH,c),u=await Ln(e,l,{}),d=n[tz.token]
let f=null
if(s(d))try{f=JSON.parse(d)}catch(e){}const h=La(e,e.client.guid,a,[],u,!0,c,f)
return i(null==f?void 0:f.reviewActionsShelf)&&h.shelves.unshift(f.reviewActionsShelf),i(null==f?void 0:f.reviewSummaryShelf)&&h.shelves.unshift(f.reviewSummaryShelf),i(null==f?void 0:f.ratingsShelf)&&h.shelves.unshift(f.ratingsShelf),N2.createFlowAction(h,qq,t)}pageRoute(e){return[{protocol:$W,path:`/${VW.reviews}/{adamId}/{sort}`,query:[`${tz.token}?`]}]}pageType(){return qq}}class aee extends j2{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t,n){return Vn(0,"accessory")}generatePageRequest(e,t,n){const r=[]
for(const e of Object.keys(t.query))e.startsWith("id")&&r.push(t.query[e])
return this.requestWithFilter(e,"deviceProtocol",r.join(","))}pageRoute(e){return[{query:[`${tz.action}=accessoryLookup`]}]}}class cee extends N2{constructor(){super("CollectionDeepLinkingController")}pageType(){return SW}pageRoute(e){return[{protocol:FW,path:"{countryCode}/{tab}/recommendations",query:[`${tz.useCaseShort}`,`${tz.collectionId}?`,`${tz.seedId}?`]}]}async handlePage(e,t,n,r,o){const i=n[VW.tab],s=n[tz.useCaseShort],a=n[tz.collectionId],c=n[tz.seedId]
let l=new yY(e).forType(xL).addingQuery(AW,i).addingQuery("filter[recoUseCase]",s).includingRelationships([mW]).includingAdditionalPlatforms(ee(e))
l.enablingFeature(ZE),(null==a?void 0:a.length)>0&&(l=l.addingQuery(zV,a)),(null==c?void 0:c.length)>0&&(l=l.addingQuery(_A,c))
const u=await M(Ln(e,l))
if(!u.success)throw new Error(`CollectionDeeplinkingController: Failed to fetch Media API data for useCase: ${s}`)
const d=u.value,f=j(yt(e,d),K$),h=await((null==f?void 0:f.length)>0?this.makeODPPage(e,s,f,d):this.makeCollectionPage(e,s,d))
let p
const w=this.createTabChangeActionForRequest(i),g=new FY(SW,t.build())
return g.pageData=h,null!=w?(w.actions=[g],p=w):p=g,p}async makeODPPage(e,t,n,r){const o=new Promise((o,i)=>{ps(e,n,SW).then(n=>{const i=yt(e,r),s=new U2
s.title=j(i,Wq),s.metricsPageInformation=Un(e,XH,t,r),s.metricsPageInformation.recoMetricsData=Sh(St(r),null,n.recoMetrics),s.shouldFilter=!1,s.metricsLocationTracker={rootPosition:0,locationStack:[]}
const a=this.makePage(e,s,n.dataContainer)
o(a)}).catch(e=>{i(e)})})
return await o}async makeCollectionPage(e,t,n){const r=yt(e,n),o=fe(r,mW),i=new U2
return i.url=this.paginationUrl,i.title=j(r,Wq),i.metricsPageInformation=Un(e,XH,t,n),i.metricsPageInformation.recoMetricsData=St(n),i.shouldFilter=!1,i.metricsLocationTracker={rootPosition:0,locationStack:[]},await Promise.resolve(this.makePage(e,i,o))}makePage(e,t,n){return Kv.context("makePage",()=>{const r=t.preferredShelfContentType||$2,o=new yJ(r),i={id:null,kind:null,softwareType:null,targetType:yq,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:bV,recoMetricsData:St(n)}
Nh(e,o,i),Ch(0,i,t.title),o.isHorizontal=!1,o.shouldFilterApps=t.shouldFilter
const s=At(n)
t.remainingContent=[],o.items=Nd(e,s,{contentUnavailable:(e,n)=>(t.remainingContent=Ct(0,s,e),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:Qd(0,r)}})
const a=new bJ([o])
return a.title=t.title,t.remainingContent.length&&(a.nextPage=t),a})}createTabChangeActionForRequest(e){const t=e
return new Set([tW,yW,sq,Rq,wL,pW,LG,yj,MF,xF,$F,uB,bH,QU]).has(t)?new LX(t):null}async handleShelf(e,t,n,r){throw new Error(nk)}shelfRoute(e){return[]}paginationRoute(e){return[{protocol:$W,path:`${this.paginationPath}`}]}async handlePagination(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePagination`,async()=>{const n=o,r=new yY(e,n.remainingContent)
if(!r)throw new Error(`Could not construct media API request for: ${t}`)
r.includingAdditionalPlatforms(ee(e))
const i=[Hq,$q,hH,wH]
e.appleSilicon.isSupportEnabled&&i.push(xH),e.bag.enableUpdatedAgeRatings&&i.push(Fq),of(e)&&i.push(EH),r.includingAttributes(i),r.usingCustomAttributes(Ue(e)),r.attributingTo(t.build())
const s=await Ln(e,r)
return this.makePage(e,n,s)})}}class lee extends G2{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t,n){const r=Bi(t),o=n[tz.grouping]
if(!this.isValidId(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
if(!this.isValidId(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing grouping.`)
return new yY(e).withIdOfType(r,C$).addingQuery(tV,o).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}async renderPage(e,t,n){return await Ha(Bj,async()=>{const r=yt(e,t),o=fe(r,mW),i=n[tz.grouping],s=Un(e,XH,`${r.id}-${i}`,t),a=new U2
a.remainingContent=o.data,a.url=this.paginationUrl,a.shouldFilter=!H(r,J$),a.metricsPageInformation=s,a.metricsLocationTracker={rootPosition:0,locationStack:[]},a.title=j(r,AW)
const c=await this.pageWithContent(e,o,a)
return c.title=a.title,jn(e,c,s),c})}pageRoute(e){return[{protocol:FW,path:`/{countryCode}/${VW.appsForYou}/{title}/{id}`,query:[tz.grouping]},{protocol:FW,path:`/{countryCode}/${VW.appsForYou}/{id}`,query:[tz.grouping]},{protocol:FW,path:`/${VW.appsForYou}/{title}/{id}`,query:[tz.grouping]},{protocol:FW,path:`/${VW.appsForYou}/{id}`,query:[tz.grouping]}]}isValidId(e){return!(r(e)||isNaN(e))}}class uee extends G2{constructor(){super("RoomBuilder")}generatePageRequest(e,t,n){let r=t.query[tz.featuredContentId]
if(this.isValidRoomId(r)||(r=n.id),!this.isValidRoomId(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return new yY(e).withIdOfType(t,XN).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,r)}prepareRequest(e,t,n,r,o){!function(e,t){t.includingAdditionalPlatforms(ee(e)).includingAttributes(oc(e)).usingCustomAttributes(Ue(e)).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,t)}async renderPage(e,t,n,r){return await Ha(Bj,async()=>{const n=yt(e,t),r=fe(n,mW),o=Un(e,XH,n.id,t),i=new U2
i.remainingContent=r.data,i.url=this.paginationUrl,i.shouldFilter=!H(n,J$),i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=j(n,Xj)
var a
i.preferredShelfContentType=null==(a=Number(s))?null:a===O0?RM:null,i.clientIdentifierOverride=Nr(e,n),i.title=j(n,Wq)
const c=await this.pageWithContent(e,r,i)
return c.title=i.title,jn(e,c,o),c})}pageRoute(e){return[{protocol:FW,path:`/${VW.store}/${VW.room}`,query:[tz.featuredContentId]},{protocol:FW,path:`/${VW.storeElements}/${VW.recommendationsSeeAll}`},{protocol:FW,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:FW,path:"/{countryCode}/collection/today-view-widgets",query:[tz.featuredContentId]},{protocol:FW,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return a(e)}}!function(e){e[e.Default=0]="Default",e[e.CategoriesAndCharts=1]="CategoriesAndCharts"}(Km||(Km={}))
class dee{constructor(e,t,n,r,o,i,s=null,a){this.id=e,this.title=t,this.searchLandingItemDisplayStyle=s,this.displayStyle=n,this.displayCount=r,this.hasSeeAll=o,this.seeAllLink=i,this.searchShelfKind=a}}!function(e){e[e.Landing=0]="Landing",e[e.Results=1]="Results",e[e.ChartsAndCategories=2]="ChartsAndCategories",e[e.Focus=3]="Focus"}(Zm||(Zm={})),function(e){e.Suggestion="Query",e.CategoriesAndCharts="EditorialLink",e.Apps="AppsLockup",e.EditorialCollection="EditorialCollection"}(Qm||(Qm={}))
class fee{constructor(){this.$kind="PageTab"}}class hee extends MW{constructor(e,t,n){super(),this.$kind="PageTabChangeAction",this.actionClass="PageTabChangeAction",this.selectedTabId=e,this.title=t}}class pee extends pJ{constructor(){super(...arguments),this.$kind="SearchChartsAndCategoriesPage"}}class wee{constructor(){this.$kind="PageTabs",this.id=random.nextUUID()}}class gee{constructor(e,t,n,r,o,i,s,a,c){this.$kind="SearchChartOrCategory",this.title=e,this.artwork=t,this.collectionIcons=n,this.backgroundColor=r,this.badge=o,this.action=i,this.density=s,this.artworkSafeArea=a,this.textSafeArea=c}}class vee{constructor(){this.$intentKind="SearchChartsAndCategoriesPageIntent"}async perform(e,t){return await Zw(e,t)}}class mee extends N2{constructor(e,t){super("SearchChartsAndCategoriesPageBuilder"),t.exportingService(BF,{fetchSearchChartsAndCategoriesPage:async t=>await Zw(t,e)})}pageType(){return d_}pageRoute(e){return[{path:"/{apiVersion}/recommendations/{countryCode}/search-recommendations/{search-recommendations-id}"}]}async handlePage(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePage`,async()=>{const n=new yY(e,t.toString()).forType(Wx).includingAgeRestrictions().includingScopedRelationships(ak,[mW]).enablingFeature(PV).enablingFeature(UF).addingQuery(tz.name,oN)
ji(e,xx)&&Ti(n)
const r=await this.fetchCategoriesAndChartsPage(e,n)
return N2.createFlowAction(r,this.pageType(),t)})}async fetchCategoriesAndChartsPage(e,t){const n=Ln(e,t)
return await n.then(t=>zw(e,t))}}class yee extends MW{constructor(e,t){super(),this.$kind="GuidedSearchTokenToggleAction",this.actionClass="GuidedSearchTokenToggleAction",this.targetToken=e,this.searchOrigin=t}}class Aee{constructor(e,t,n,r,o){this.$kind="GuidedSearchToken",this.value=e,this.isSelected=t,this.leadingIcon=n,this.displayName=r,this.clickAction=o}}class Tee{constructor(e,t,n){this.$kind="GuidedSearchQuery",this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class bee extends MW{constructor(e,t){super(),this.$kind="SearchEntityChangeAction",this.actionClass="SearchEntityChangeAction",this.entity=e,this.searchOrigin=t}}class See{constructor(e,t){this.$kind="SearchFacetSet",this.type=e,this.values=t}}class Pee{constructor(e,t,n=null){this.$kind="SearchFacetValue",this.name=e,this.value=t,this.isSelected=t===n}}const Iee={AdvertsSearchResult:"AdvertsSearchResult",AppEventSearchResult:uy,AppSearchResult:dy,BundleSearchResult:"BundleSearchResult",EditorialSearchResult:yy,GuidedSearchResult:"GuidedSearchResult",InAppPurchaseSearchResult:"InAppPurchaseSearchResult",SearchLockupCollection:"SearchLockupCollection"}
class Cee{constructor(e){this.impressionMetrics=null,this.resultType=e,this.clickAction=void 0}}class kee extends Cee{constructor(e,t){super(Zx),this.$kind="GuidedSearchResult",this.title=e,this.tokens=t}}class Oee extends Cee{constructor(e,t,n,r,o){super("lockupCollection"),this.$kind="SearchLockupCollection",this.heading=e,this.headingArtwork=o,this.title=t,this.items=n,this.detailAction=r}}const Eee=0,Ree=1
class Dee extends Cee{constructor(e){super(tG),this.$kind="InAppPurchaseSearchResult",this.lockup=e}}class _ee extends Cee{constructor(e){super(Wk),this.$kind="BundleSearchResult",this.lockup=e}}class Lee extends Cee{constructor(e){super("content"),this.$kind="AppSearchResult",this.lockup=e}}class Mee extends Cee{constructor(e){super(Yk),this.$kind="EditorialSearchResult",this.title=e}}class xee extends Cee{constructor(){super(oB),this.$kind="AppEventSearchResult"}}class $ee extends Cee{constructor(){super("advert"),this.$kind="AdvertsSearchResult",this.lockups=[],this.displaysScreenshots=!0,this.itemBackground="ad"}}const Fee="E1Aan4l00",Nee="E1Aan4l01",Bee="E1Aan4l02",Uee=[new class{canDisplay(e){return(0,Jv.isSome)(e.alignedRegionArtwork)||(0,Jv.isSome)(e.alignedRegionVideo)}get representativeDisplayStyle(){return FK}displayStyle(e,t,n){return(0,Jv.isSome)(t.alignedRegionArtwork)?FK:$K}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isLandscape())&&void 0!==r&&r}get representativeDisplayStyle(){return MK}displayStyle(e,t,n){return MK}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isPortrait())&&void 0!==r&&r}get representativeDisplayStyle(){return RK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Eg(e,n)
return 4===o&&r>=4?RK:3===o&&r>=3?DK:r>=2?_K:LK}},new class{canDisplay(e){return e.landscapeScreenshots.length>0}get representativeDisplayStyle(){return xK}displayStyle(e,t,n){return xK}},new class{canDisplay(e){return e.portraitScreenshots.length>0}get representativeDisplayStyle(){return CK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Eg(e,n)
return 4===o&&r>=4?CK:3===o&&r>=3?kK:r>=2?OK:EK}},new class{canDisplay(e){return!0}get representativeDisplayStyle(){return NK}displayStyle(e,t,n){return NK}}],Gee={NO_ORGANIC_RESULTS:"NOORGANIC",NORMAL:"NORMAL",DUPE_AD:"DUP"},jee=(e,t)=>{const n=e.isLandscape()
return n===t.isLandscape()?0:n?-1:1}
class Vee{constructor(e,t,n=null){this.$kind="SearchResultsMessage",this.primaryText=e,this.secondaryText=t,this.messageClickAction=n}}class Hee{constructor(e,t){this.$kind="SearchHintSet",this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new NY,this.pageRenderMetrics={}}}!function(e){e.visionOS="xros",e.iOS="ios"}(Xm||(Xm={}))
class qee extends iZ{constructor(e=[]){super(),this.$kind="SearchResultsPage",this.shelves=[],this.shelves=e}}class Wee{constructor(e,t){this.$kind="SearchResultsContextCard",this.message=e,this.action=t}}class zee{constructor(e){this.$kind="SearchResultsLearnMoreNotice",this.linkableText=e}}!function(e){e[e.EmptyResults=0]="EmptyResults",e[e.Picker=1]="Picker",e[e.NonNative=2]="NonNative"}(ey||(ey={}))
class Yee{constructor(){this.$intentKind="SearchHintsIntent"}async perform(e,t){return await Wg(t,e.term)}}class Jee extends N2{constructor(e,t){super("SearchHintsBuilder"),t.exportingService(BF,{fetchHints:async t=>await Wg(e,t.term)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class Kee extends bJ{constructor(e){super(e,"SearchLandingPage")}}class Zee extends bJ{constructor(e){super(e,"SearchFocusPage")}}!function(e){e.Chiclet="chiclet",e.App="app",e.Symbol="symbol"}(ty||(ty={}))
const Qee="word_cloud",Xee="horizontal"
class ete extends MW{constructor(){super(...arguments),this.$kind="ClearSearchHistoryAction",this.actionClass="ClearSearchHistoryAction"}}class tte{constructor(e,t,n,r){this.title=e,this.maxItems=t,this.shelfDisplayStyle=n,this.itemDisplayStyle=r}}class nte extends N2{constructor(){super("SearchLandingPageBuilder")}pageRoute(e){return[{protocol:$W,path:`${VW.searchLandingPage}`}]}shelfRoute(e){return[{protocol:$W,path:`${VW.searchLandingPage}/${VW.shelf}`,query:[tz.isOnDeviceSearchHistoryShelf]},{protocol:$W,path:`${VW.searchLandingPage}/${VW.shelf}`,query:[tz.isSearchFocusHeaderShelf]}]}pageType(){return SW}async handlePage(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePage`,async()=>{const n=await this.fetchPage(e)
return N2.createFlowAction(n,this.pageType(),t)})}async handleShelf(e,t,n,r){return await Ha(`${this.builderClass}.handleShelf`,async()=>{var o,s,a
const c=v(null!==(o=n[tz.isOnDeviceSearchHistoryShelf])&&void 0!==o?o:t.query[tz.isOnDeviceSearchHistoryShelf]),l=c?function(e){if(!(0,Zv.isNothing)(e))return JSON.parse(decodeURIComponent(e))}(null!==(s=n[tz.token])&&void 0!==s?s:t.query[tz.token]):void 0,u=v(null!==(a=n[tz.isSearchFocusHeaderShelf])&&void 0!==a?a:t.query[tz.isSearchFocusHeaderShelf])
return c&&i(l)?await this.handleSearchHistoryShelfAsync(e,l):u?sv(e):await super.handleShelf(e,t,n,r)})}handleSearchHistoryShelf(e,t,n,r){e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems).then(n=>{const r=Gn(e,zM,YM," ")
return Ch(0,{locationTracker:{rootPosition:0,locationStack:[]},id:b_,pageInformation:r},t.title),zg(e,t,r,{rootPosition:0,locationStack:[]},n)}).then(n,r)}async handleSearchHistoryShelfAsync(e,t){const n=await e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems),r=Gn(e,zM,YM," ")
return Ch(0,{locationTracker:{rootPosition:0,locationStack:[]},id:b_,pageInformation:r},t.title),zg(e,t,r,{rootPosition:0,locationStack:[]},n)}async fetchPage(e){return await async function(e){const t=Kt(e,kV)?Uw(e,kV).catch(()=>null):null
return await async function(e,t){return function(e){return!e.bag.supportsSearchLandingPageV2||!ar(e,e.bag.searchLandingPageV2RolloutRate)}(e)?await async function(e,t){const n=new yY(e).forType(OF).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
n.targetResourceType=UV
const r=lc(e,e.user.dsid);(null==r?void 0:r.length)>0&&n.addingQuery(e_,r)
const s=new $m.FetchTimingMetricsBuilder,a=e.addingFetchTimingMetricsBuilder(s),c=Ln(a,n)
return await Promise.all([c,t]).then(([e,t])=>s.measureModelConstruction(()=>function(e,t,n){var r
const s=l(t,zI)[0]
if(o(s))return null
if(!de(s,ij))return null
const a=j(s,"id"),c=Un(e,QE,s.id,t),u=Ps(e)
c.recoMetricsData=Sh(c.recoMetricsData,null,u),c.adPageInfo=dn(e,kV,n),null===(r=c.adPageInfo)||void 0===r||r.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,EF,0)
const d={shelves:[],metricsPageInformation:c,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:a,pageGenreId:q(s,_H),hasAuthenticatedUser:i(e.user.dsid),isSearchLandingPage:!0,adStitcher:Za(e,n)}
ul(e,fl(e,s),d)
const f=new Kee(d.shelves),h=new WZ(YI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null)
return f.pageRefreshPolicy=h,jn(e,f,d.metricsPageInformation),f}(a,e,t)))}(e,t):e.bag.mediaAPISearchFocusEnabled?await async function(e,t){const n=ov(e).enablingFeature("search-focus-suggestions"),r=new $m.FetchTimingMetricsBuilder,i=e.addingFetchTimingMetricsBuilder(r),s=Ln(i,n),a=e.amsEngagement
let c=null
if(a&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:VK,tab:Rq}
c=a.performRequest(e)}return await Promise.all([s,t,c]).then(async([e,t,n])=>await r.measureModelConstructionAsync(async()=>await async function(e,t,n,r){const i=iv(e,t,n,r)
return await async function(e,t){var n
if(o(t.data))return null
const r=Un(e,zM,YM,t," "),i=Ps(e)
r.recoMetricsData=Sh(r.recoMetricsData,null,i)
const s={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:r,pageType:Zm.Focus},a=function(e,t,n){const r=e.data
if(o(r))return null
for(const e of r){if(o(e))continue
const r=p(e,PV)
if(Kg(null==r?void 0:r.category)===t.pageType&&n===j(e,K$))return e}return null}(t,s,JI)
if((0,Zv.isNothing)(a))return av(e,t,s)
const c=null!==(n=q(a,IM))&&void 0!==n?n:0,l=e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(c)
return await l.then(n=>(s.searchHistory=n,av(e,t,s)))}(e,t).then(e=>(i.searchFocusPage=e,i))}(i,e,t,n)))}(e,t):await async function(e,t){const n=ov(e),r=new $m.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r),i=Ln(o,n),s=e.amsEngagement
let a
if(s&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:VK,tab:Rq}
a=s.performRequest(e)}return await Promise.all([i,t,a]).then(([e,t,n])=>r.measureModelConstruction(()=>iv(o,e,t,n)))}(e,t)}(e,t).catch(async n=>{if((0,Zv.isSome)(e.bag.trendingSearchesURL))return await async function(e,t){const n={url:e.bag.trendingSearchesURL},r=e.network.fetch(n).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${n.url}`)
return JSON.parse(e.body)})
return await Promise.all([r,t]).then(([t,n])=>{var r
const o=new Kee(function(e,t){return Kv.context("trendingSearchesShelfForResponse",()=>{const n={rootPosition:0,locationStack:[]},r=l(t,"trendingSearches").map(t=>{const r=f(t,nq),o=new d5(r,r,f(t,eW),JB)
return e.client.isPhone&&(o.artwork=Ot(e,q$)),na(e,o,TW,n),_h(n),o})
let o=0
switch(e.client.deviceType){case oW:o=10
break
case lW:o=7}const i=new yJ(cq)
return i.title=r.length>0?f(t,"header.label"):null,i.isHorizontal=!1,i.items=r.slice(0,o),[i]})}(e,t)),i=Gn(e,DG,JB,"")
return i.adPageInfo=dn(e,kV,n),null===(r=i.adPageInfo)||void 0===r||r.setMissedOpportunity(e,gA,EF,0),jn(e,o,i),o})}(e,t)
throw n})}(e)}}const{routes:rte,makeCanonicalUrl:ote}=fc(function(e){return function(e){const{platform:t,...n}=e
return{...n,platform:ut(t),$kind:Vk}}({...e,origin:"userText"})},"/{platform}/search",[rj])
class ite{constructor(){this.$intentKind=Vk,this.routes=rte}async perform(e,t){return await function(e,t,n){return n(e.addingActiveIntent({previewPlatform:t.platform}))}(t,e,async t=>{const n=await cv(t,e)
return(0,Jv.isNothing)(n.canonicalURL)&&(n.canonicalURL=this.staticCanonicalUrlFor(e,t)),n})}actionFor(e,t){const n=new FY(Rq)
return n.destination=e,n.pageUrl=ote(t,e),n}staticCanonicalUrlFor(e,t){return ote(t,e)}}class ste{constructor(){this.$intentKind="SearchResultsPageMoreIntent"}async perform(e,t){return await lv(t,e.pageToken)}}class ate extends N2{constructor(e,t){super("SearchResultsBuilder"),t.exportingService(BF,{fetchResults:async t=>await async function(e,t){const n=new $m.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await Np(r,t)
return null===o?Gg(r,t.facets):await async function(e,t){return await Vg(e,t)}(r,o)}(e,t),fetchMoreResults:async t=>await async function(e,t){return await async function(e,t){return await Kv.context("paginatedSearchResultsWithToken",async()=>{const n=Fg(0,t),r=Ng(0,t)
return 0===n.length?await Promise.resolve(Gg(e)):await Bp(e,n).then(async n=>{const o=At(n)
return await Mg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(e=>{const t=new sZ
return t.results=e.builtSearchResults,t.nextPage=r,t})})})}(e,t)}(e,t.pageToken),fetchSearchResultsPage:async t=>await cv(e,t),fetchMoreOfSearchResultsPage:async t=>await lv(e,t.pageToken)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class cte{constructor(){this.$intentKind="ArticlePageIntent"}async perform(e,t){return await t.required(O3).fetchPage(t,e.url,F4)}}class lte extends N2{constructor(e,t){super("ArticleBuilder"),t.exportingService(lk,{fetchArticle:async t=>await e.required(O3).fetchPage(e,t.url,F4)})}async handlePage(e,t,n,c,l){const u=new $m.FetchTimingMetricsBuilder,d=e.addingFetchTimingMetricsBuilder(u),h=JSON.parse(f(t.query,tz.recoMetrics)),p=function(e,t,n){const r=t.pathComponents()
if(r.indexOf(oG)<0&&r.indexOf(Ij)<0&&r.indexOf(oT)<0&&t.host!==JW&&t.host!==QW&&t.host!==XW)throw new Error(`Unable to map ${t.build()} to a media api url`)
let o
if(o=t.host===JW?e.packageProperties.asString("spamBlockingExtensionsEditorialItemID"):t.host===QW?e.bag.sharePlayAppsEditorialItemId:t.host===XW?e.bag.buddyOnboardingEditorialItemId:Bi(t),!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
if(!a(o))throw new Error(`Unable to map ${t} to a media api url`)
const i=function(e,t,n){const r=new yY(e).withIdOfType(t.id,sW).includingAdditionalPlatforms(ee(e)).includingAttributes(function(e){const t=[eV,Lj,wH,LH,Hq,$q,pj,N$,RB]
return e.bag.enableUpdatedAgeRatings&&t.push(Fq),e.appleSilicon.isSupportEnabled&&t.push(xH),of(e)&&t.push(EH),t}(e)).includingRelationships([EN]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Jv.isNothing)(n)&&r.includingAgeRestrictions(),ii(e)&&(r.enablingFeature(tq),r.includingScopedAttributes(hW,nZ),r.includingScopedRelationships(hW,[rW]),r.includingScopedRelationships(rT,[hW]),r.includingScopedAvailableIn(hW,[IO])),ai(e)&&(r.enablingFeature(BB),r.includingScopedRelationships(ZV,[fU]),r.includingAssociateKeys(sW,[dV]),r.includingMetaKeys(eT,[tT]),r.includingScopedAttributes(ZV,[Wq,NH,sN,DL])),r}(e,Si({..._i(e),id:o}),n),c=t.query[tz.editorialCardId]
s(c)&&i.withFilter("canvas:cardId",c)
const l=t.query[tz.preview]
return ez.has(t.host)&&(null==l?void 0:l.length)>0&&(i.addingQuery(iT,l),i.isStorePreviewRequest=!0),i.attributingTo(t.build())}(e,t,l),w=await Ln(d,p),g=await async function(e,t){return await ac(e,t,Jc,Kc)}(e,w),v=new r5
v.todayShelfRecoMetricsData=h,v.showingFallbackMediaInline=Boolean(n[tz.showingFallbackMedia]),v.additionalData=g.additionalData
const y=f(t.query,tz.todayCardConfig);(null==y?void 0:y.length)>0&&(v.todayCardConfig=JSON.parse(y)),v.allowUnpublishedAppEventPreviews=(0,Jv.isSome)(n[tz.preview]),v.isResilientDeepLink=e.deepLinks.hasResilientDeepLinks(),e.client.isCompanionVisionApp&&(v.clientIdentifierOverride=jz)
const T=u.measureModelConstruction(()=>function(e,t,n){return Kv.context("articlePageWithResponse",()=>{var s
const a=yt(e,t)
n.metricsPageInformation=Un(e,Ij,a.id,t),n.metricsLocationTracker={rootPosition:0,locationStack:[]},n.pageId=a.id
const c=new zZ(n.metricsPageInformation,n.metricsLocationTracker,n.refreshController),l=function(e,t){if(!i(t))return null
if((0,Jv.isSome)(t.todayCardConfig))return t.todayCardConfig
const n={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!1,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
switch(n.clientIdentifierOverride=t.clientIdentifierOverride,n.useOTDTextStyle=!1,n.allowUnpublishedAppEventPreviews=t.allowUnpublishedAppEventPreviews,n.currentRowIndex=void 0,e.client.deviceType){case vW:n.prevailingCropCodes={defaultCrop:"en"},n.coercedCollectionTodayCardDisplayStyle=Cm.Grid,n.heroDisplayContext=_m.Article
break
case"tv":n.prevailingCropCodes={defaultCrop:"ek","editorialArtwork.storyCenteredStatic16x9":"SCS.ApDHXL01"},n.coercedCollectionTodayCardDisplayStyle=Cm.Grid,n.heroDisplayContext=_m.Article
break
case BV:n.coercedCollectionTodayCardDisplayStyle=Cm.River,n.prevailingCropCodes={defaultCrop:"sr","editorialArtwork.dayCard":"grav.west"}}return n}(e,n)
let u=So(e,a,l,c)
const d=null==u?void 0:u.media;(0,Jv.isNothing)(u)&&(u=null)
const h=null!==(s=null==u?void 0:u.title)&&void 0!==s?s:void 0,p=j(a,HH)
n.crossLinkSubtitle=Uo(e,a),n.clientIdentifierOverride=l.clientIdentifierOverride,Ch(0,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:Eq,id:n.pageId,idType:Dq},h)
const w=function(e,t,n,r){return Kv.context("renderArticle",()=>{var o
const s=[],a=null!==(o=we(t,EN))&&void 0!==o?o:[]
for(const n of a){r.module=j(n,lC),r.subStyle=null,s.length
const o=Qc(e,n,t,r)
if(o.length>0)for(const e of o)e.title=r.titleForNextShelf,s.push(e),r.titleForNextShelf=null
r.index++,_h(r.metricsLocationTracker)}if(r.showingFallbackMediaInline&&0===s.length){const e=function(e,t){if(A(n=t)&&n[PW]===Dy||function(e){return A(e)&&e[PW]===Ly}(t)){const e=new yJ(Lq)
return e.items=t.lockups,e}var n
return null}(0,n)
i(e)&&s.push(e)}return s})}(e,a,d,n),g=w[w.length-1],v=n.isResilientDeepLink||p===tL?null:function(e,t,n){const s=Xc(0,t)
let a=null
const c=Jf(e,t,AW),l=Jf(e,t,cV)
if(c&&l&&(a=e.loc.string("ShareSheet.TitleSubtitle.Format","{title}: {subtitle}").replace(BU,c).replace(QP,l)),!a&&c&&(a=c),!a&&l&&(a=l),!a&&s){const n=j(s,AW),r=j(t,GN)
switch(r){case Cm.GameOfTheDay:a=e.loc.string("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(BU,n)
break
case Cm.AppOfTheDay:a=e.loc.string("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(BU,n)
break
default:e.console.log(`No title for article with unknown style: ${r}`)}}const u=j(t,eW)
let d
switch(j(t,GN)){case Cm.Grid:case Cm.List:case Cm.River:d=Ot(e,"resource://ShareCollectionThumbnail",40,40)
break
default:d=null}const f=function(e,t,n,o,s,a){return r(a)?null:Kv.context("shareSheetDataForArticle",()=>{let r=s;(0,Jv.isNothing)(r)&&(0,Jv.isSome)(a)&&(r=function(e,t){const n=ko(t)
{const r=Bo(e,t,_m.Article,n)
if(i(r))return r}return _o(e,B(t,Do(0,n)),void 0)}(e,a))
const o=e.loc.string("ShareSheet.Story.Subtitle"),c=new AZ(a.id,t,o,r)
return new TZ(c,n,null)})}(e,a,u,0,d,t)
if(!i(f))return null
const h=function(e,t,n,r){const s=[]
if((null==t?void 0:t.length)>0){const n=jo(e,t)
i(n)&&s.push(n)}if((null==n?void 0:n.length)>0){const t=jo(e,n,"Copy Card Preview Link")
i(t)&&s.push(t)}if((0,Jv.isSome)(r)){let t
e.featureFlags.isGSEUIEnabled(HJ)&&e.featureFlags.isEnabled(PJ)&&(t=function(e,t){if(o(e))return
const n=new JY(e)
return n.title=t,new yZ("com.apple.AppStore.openInGameCenterActivity",n)}(`games:///story/id${r}`,e.loc.string("ShareSheet.OpenInGameCenter.Title"))),i(t)&&s.push(t)}return s}(e,u,function(e,t,n){if((0,Jv.isNothing)(t))return null
switch(e.client.buildType){case YG:case cG:const e=new wz
return e.protocol=FW,e.host=ZU,e.pathname=`/${VW.todayCardPreview}`,e.param(tz.ids,`${t}`),e.param(tz.isTodayFeedPreview,bq),e.param(tz.isTodaySection,n.useOTDTextStyle?bq:WF),decodeURIComponent(e.build())
default:return null}}(e,t.id,n),t.id)
return new oZ(f,h)}(e,a,l)
if(i(v)){Xs(e,v,{targetType:TW,id:n.pageId,actionType:fB,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})
const t=function(e,t,n){if(t&&n){const e=t.items.length
if(e>0&&-1!==o5.indexOf(n)){const n=t.items[e-1]
switch(t.contentType){case k_:case Lx:return n&&n.isFullWidth
default:return!0}}}return!1}(0,g,n.module),r=function(e,t,n,r){if(!i(t)||e.client.isCompanionVisionApp)return null
const o=new N4(fB,e.loc.string("SHARE_STORY"),!r,t),s=new yJ("roundedButton")
return s.items=[o],s}(e,v,0,t)
r&&w.push(r)}const y=new F4(u,w,v)
if(y.editorialStoryCard=null,y.title=null==u?void 0:u.title,y.subtitle=null==u?void 0:u.inlineDescription,function(e,t,n,r){const o=Xc(0,n)
if(o){const i=ra(0,n)
return void(t.footerLockup=function(e,t,n,r){return Od(e,t,{offerStyle:el(e),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:r,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:O6.Default,canDisplayArcadeOfferButton:rh(0,Lq)})}(e,o,r,i))}const s=H(n,O_)
if(i(r.additionalData)&&s){const o=lo(e,n)
t.arcadeFooterLockup=function(e,t,n){return $d(e,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},pt(Ij),WH,null)}(e,o,r)}}(e,y,a,n),y.shouldTerminateOnClose=n.isResilientDeepLink,jn(e,y,n.metricsPageInformation,e=>{let t=h
var n
if(A(n=null==u?void 0:u.media)&&n[PW]===Ry&&function(e){return Fr(e)&&e[PW]===ky}(null==u?void 0:u.overlay)&&(t=(null==u?void 0:u.overlay).lockup.title),!t)return
let r=f(m(e[NU]),qH)
r=r||f(m(e[QG])),e[NU]=r?`${r}_${t}`:`unknown_${t}`}),y.canonicalURL=j(a,eW),(0,Jv.isSome)(a)){const e=j(a,eW);(0,Jv.isSome)(e)&&(y.viewArticleAction=new JY(e,!0))}return y})}(d,g.originalData,v)),b=N2.createFlowAction(T,Eq,t)
{const e=new LX(tW)
return e.actions=[b],e}}pageRoute(e){return[{protocol:FW,path:`/{countryCode}/${VW.editorialItem}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/{countryCode}/${VW.editorialItem}/{seoSlug}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/{countryCode}/${VW.story}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/{countryCode}/{platform}/${VW.story}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/{countryCode}/${VW.story}/{seoSlug}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/${VW.story}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/${VW.story}/{seoSlug}/{id}`,query:[`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:`/${VW.store}/${VW.viewEditorialItem}`,query:[tz.id,`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[tz.id,`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[tz.id,`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[tz.id,`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[tz.id,`${tz.showingFallbackMedia}?`,`${tz.preview}?`,`${tz.todayCardConfig}?`]},{protocol:FW,hostName:`${JW}`},{protocol:$W,path:`/${VW.story}/{id}`,query:[`${tz.metrics}?`,`${tz.invalidateWidgetsOnFailure}?`]},{protocol:FW,hostName:`${QW}`},{protocol:FW,hostName:`${XW}`}]}pageType(){return Eq}}ny=e(1415)
class ute{constructor(e,t,n,r,o,i){this.$kind="TodayPage",this.shelves=e,this.title=n,this.titleDetail=o,this.shortTitleDetail=i,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new NY,this.pageRenderMetrics={}}}!function(e){e.OnboardingCards="onboardingCards",e.Ads="ads",e.ODP="ODP",e.AMDData="amdData"}(ry||(ry={}))
class dte extends N2{constructor(){super("TodayCardPreviewBuilder")}pageType(){return tW}pageRoute(e){return[{protocol:FW,path:`/${VW.todayCardPreview}`,query:[`${tz.ids}?`,`${tz.isTodaySection}?`,`${tz.isTodayFeedPreview}?`,`${tz.preview}?`,`${tz.experimentId}?`,`${tz.fetchData}?`]}]}async handlePage(e,t,n,r,i){return await Ha(`${this.builderClass}.pageHandler`,async()=>{var r
const i=new FY(this.pageType())
if(i.pageUrl=t.build(),!v(n[tz.fetchData]))return i
const a=null===(r=n[tz.experimentId])||void 0===r?void 0:r.split(","),c=n[tz.ids]
if(s(a)&&o(c)){const t={}
for(const e of a){const n=e.split(":")[0],r=e.split(":")[1]
t[n]=r}const n=s(t)?JSON.stringify(t):void 0,r=await hv(e,{experimentIdHeader:n,url:"",onboardingCardIds:[]})
return i.pageData=r,i}{const n=pv(e,this.createFlattenedTodayItemsFromUrl(t),dte.emptyTodayPageResponse,null,null)
return i.pageData=n,i}})}createFlattenedTodayItemsFromUrl(e){const t=[],n=f(e.query[tz.ids]),r=(0,Jv.isSome)(e.query[tz.isTodayFeedPreview])&&v(e.query[tz.isTodayFeedPreview]),o=(0,Jv.isSome)(e.query[tz.isTodaySection])&&v(e.query[tz.isTodaySection])
if(!s(n))return t
const i=n.match(/([a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?:\[[^\]]+\]|[a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?)/g)
let a=r,c=0
for(const e of i){const n=e.split(":")[0],r=dte.storyGroupIdRegex.exec(e)
if((0,Jv.isSome)(r)){const e=r[1].split(",").map(e=>this.createUnhydratedEditorialItemFromId(e,o))
t.push({type:xm.EditorialItemGroup,data:{id:n,type:Nj,relationships:{},meta:{associations:{recommendations:{data:e}}}},isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...dte.previewModuleData},containedAdSlots:Array.from({length:e.length},(e,t)=>t+c)}),a=!1,c+=e.length}else t.push({type:xm.EditorialItem,data:this.createUnhydratedEditorialItemFromId(e,o),isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...dte.previewModuleData},containedAdSlots:[c]}),a=!1,c+=1}return t}createUnhydratedEditorialItemFromId(e,t){const n=e.split(":")[0],r=e.split(":")[1],o=(0,Jv.isSome)(r)?{"editorial-cards":{data:[{id:`${n}-${r}`,type:dV}]}}:{}
return{id:n,type:sW,relationships:{},meta:{personalizationData:{isOfTheDay:t},associations:o}}}}dte.storyGroupIdRegex=/\[(.*)\]/,dte.previewModuleData={label:uk,title:"Today Preview",meta:{},isTodayForAppsModule:!1},dte.emptyTodayPageResponse={results:{data:[]}}
class fte{constructor(){this.$intentKind="TodayPageIntent"}async perform(e,t){const n=e.isRunningPPTs?JSON.stringify({NyCxKBD:"client-perf"}):void 0
return await hv(t,{url:e.url,onboardingCardIds:e.onboardingCardIds,experimentIdHeader:n})}}class hte{constructor(){this.$intentKind="TodayPageMoreIntent"}async perform(e,t){const n=e.pageToken
return yv(t,n.pageInformation),await gv(t,n),wv(t,n)}}class pte extends N2{constructor(e,t){super("TodayPageBuilder"),t.exportingService(lk,{fetchPage:async t=>await hv(e,{url:t.url,onboardingCardIds:t.onboardingCardIds}),async fetchMoreOfPage(t){const n=t.pageToken
return yv(e,n.pageInformation),await gv(e,n),wv(e,n)}})}defaultTab(e){return tW}pageType(){return tW}pageRoute(e){return[]}async handlePage(e,t,n,r,o){throw new Error("handlePage not implemented for TodayBuilder")}}class wte{constructor(e,t,n,r){this.$kind="TopChartSegment",this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new NY,this.pageRenderMetrics={}}}class gte{constructor(e,t,n,r,o,i,s){this.genreId=e,this.ageBandId=t,this.title=n,this.segments=r,this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0,this.$kind=null!=s?s:$y}}class vte extends YK{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.$kind="TopChartCategory",this.shortName=this.name,this.longName=this.name,this.url=t}}class mte{constructor(){this.$intentKind="TopChartsPageIntent"}async perform(e,t){return await Pv(t,e.url)}}class yte{constructor(){this.$intentKind="TopChartsPageMoreIntent"}async perform(e,t){return await Iv(t,e.pageToken)}}class Ate extends N2{constructor(e,t){super("TopChartsBuilder"),t.exportingService("TopChartData",{fetchPage:async t=>await Pv(e,t.url),fetchMoreOfSegment:async t=>await Iv(e,t.pageToken)})}pageRoute(e){return Cv()}async handlePage(e,t,n,i,a){const c=n[tz.isPPT]
t.removeParam(tz.isPPT)
let l=t.query[tz.chart],u=n[tz.genre]
o(u)&&(u=f(e.bag.defaultChart,"genre-id"),o(l)&&(l=f(e.bag.defaultChart,"chart-id")))
let d=n[tz.charts]
if(o(d)){const e=pc(0,l)
d=void 0!==e?`${l},${e}`:l}else d.includes(l)||(d+=`,${l}`)
const h=wc(e,u,d,n[tz.ages])
let p
p=gc(e,d,u)
const[w,g]=await Promise.all([h,p]),v=Tn(e,g)
let m,y
if(m=Tv(e,w,u,v,l,r(v)?mn(u):yn(v)),y=vG,c&&s(m.segments)){const t=m.segments[0],n=t.nextPage,r=Pt(0,n)
if(s(r)){const o=new yY(e,r),i=await Ln(e,o),s=It(0,n)
s.remainingContent=[],s.maxPerPage=0
const a=kv(e,i,n,s),c=t.shelves.concat(a.shelves),l=new wte(t.shortName,t.longName,t.chart,c)
l.pageMetrics=t.pageMetrics,l.nextPage=null,m.segments[0]=l}}return N2.createFlowAction(m,y,t)}pageType(){return vG}async handlePagination(e,t,n,r,o){return await Ha(`${this.builderClass}.handlePagination`,async()=>function(e){var t,n
const r=new bJ(e.shelves)
return r.title=null!==(t=e.longName)&&void 0!==t?t:e.shortName,r.pageMetrics=e.pageMetrics,r.pageRenderMetrics=e.pageRenderMetrics,s(null===(n=null==e?void 0:e.nextPage)||void 0===n?void 0:n.remainingContent)&&(r.nextPage=e.nextPage),r}(await Iv(e,o)))}}class Tte{constructor(e,t,n,r){this.$kind="TodayWidgetContainerTemplate",this.collections=e,this.refreshDate=t,this.originalResponseDate=n,this.originalResponseHash=r}}class bte{constructor(e,t){this.$kind="TodayWidgetCardCollectionTemplate",this.cards=e,this.displayDate=t}}class Ste{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="WidgetTodayCardTemplate",this.storyId=e,this.heading=t,this.title=n,this.backgroundColor=r,this.isDark=o,this.iconArtwork=i,this.url=s,this.eventBadgeKind=l,this.editorialArtwork=c,this.isVideoArtwork=a,this.eventStartDate=u,this.eventEndDate=d}}class Pte{make(e){const t=new yY(e).forType(this.typeForUseCase()).withIdsOfType(this.ids(),this.typeForUseCase()).addingContext(this.context()).includingAttributes(this.attributesForUseCase()).asPartialResponseLimitedToFields(this.fieldsForRequest()).withSparseCount(this.sparseCountForUseCase()).withSparseLimit(this.sparseLimitForUseCase()).enablingFeature(this.enablingFeature(e)).usingCustomAttributes(this.shouldUseCustomAttributes(e)),n=this.addingQuery()
if(null!==n)for(const e of n)t.addingQuery(e.key,e.value)
return t}}class Ite extends Pte{context(){return OR}typeForUseCase(){return tW}attributesForUseCase(){return[Hq,$q,LH]}sparseCountForUseCase(){return null}sparseLimitForUseCase(){return null}addingQuery(){return null}ids(){return[]}fieldsForRequest(){return[f_,fW,d$,GN,vE,MH,aS,Hq,Kb,mV,$q,u$,"id",wU,HH,nq,jq,LH,AW,mE,l$]}enablingFeature(e){return ii(e)?tq:null}shouldUseCustomAttributes(e){return Ue(e)}}class Cte{constructor(){this.$intentKind="WidgetIntent"}async perform(e,t){const n=e.widgetKind
if(n===OC)return await Fv(t,e)
throw Error(`Invalid widgetKind of '${n}'`)}}class kte extends N2{constructor(e,t){super("WidgetController"),t.exportingService("WidgetData",{fetchTodayWidget:async t=>await Fv(e,t)})}async handlePage(e,t,n,r,o){throw new Error(CV)}pageRoute(e){return[]}pageType(){return Xq}}class Ote{constructor(){this.$intentKind="MetricsFieldLintingIntent"}async perform(e,t){const n=hr(t).makeEvent(t,y(e.fields))
return await Promise.resolve(n)}}class Ete{constructor(){this.$intentKind="AppUpdateLockupsIntent"}async perform(e,t){const n=this.createUpdateLockups(t,e.appUpdateMetadata)
return await Promise.resolve(n)}createUpdateLockups(e,t){const n={lockupOptions:{metricsOptions:{pageInformation:Gn(e,a$,"Updates",""),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:O6.LockupIconSmall}}
return this.updatesLockupsFromData(e,t,n)}updatesLockupsFromData(e,t,n){return Kv.context("updatesLockupsFromData",()=>{const a=[]
return null==t||t.forEach((t,c)=>{var l
const u=t.updateMetadata
if(r(u.attributes))return void(n.contentUnavailable&&n.contentUnavailable(c,u))
const d=n.lockupOptions
let h=rm.All
if(i(n.filter)&&(h=n.filter),at(e,u,h))return
const p=function(e){return e?{...e,isValid:e.isValid,$kind:oL}:null}(Od(e,u,d))
if(r(p)||!p.isValid())return
const w=se(u,nt(e,u),"latestVersionInfo"),g=f(w,VD),v=f(w,hU)
p.releaseDate=new Date(v),p.installDate=t.updateInstallDate
const m=t.isUpdateAvailable||t.isUpdating?p.releaseDate:p.installDate
let y=this.timeAgoStringForDate(e,m)
o(y)&&(y=e.loc.string("UPDATES_VERSION_FORMAT").replace("{updateVersion}",g)),s(y)&&(p.subtitle=y)
const A=f(w,AI);(0,Jv.isSome)(A)&&(p.whatsNew=new qX(A.trim())),p.version=g,p.size=null===(l=Lf(e,u))||void 0===l?void 0:l.fileSizeByDevice,p.externalVersionId=tt(e,u,LD),a.push(p),_h(n.lockupOptions.metricsOptions.locationTracker)}),a})}timeAgoStringForDate(e,t){if((0,Jv.isNothing)(t))return
const n=(new Date).getTime()-t.getTime(),r=Math.floor(n/864e5)
switch(r){case 0:return e.loc.string("LOCKUPS_TODAY")
case 1:return e.loc.string("LOCKUPS_YESTERDAY")
case 2:case 3:return e.loc.string("LOCKUPS_DAYS_AGO_FORMAT").replace("{daysAgo}",r.toString())
default:const n=Ix
return e.loc.formatDate(n,t)}}}oy=e(5881)
class Rte{constructor(){this.dispatcher=new oy.IntentDispatcher}register(e){this.dispatcher.register(e)}async dispatch(e,t){const n=await this.createIntentObjectGraphWithAsyncValues(t)
return await this.dispatcher.dispatch(e,n)}controller(e){return this.dispatcher.controller(e)}get registeredControllers(){return this.dispatcher.registeredControllers}async createIntentObjectGraphWithAsyncValues(e){const t=new OY,n=new gK,r=new gK(wK)
let o
if(e instanceof Y3){let i=e
i=i.addingBag(i.bag.underlyingBag),await t.loadTreatments(i),await n.loadValues(i,[im.client,im.user]),e.bag.personalizationUserIdEnabled&&await r.loadValues(e,[im.user]),i.clientCapabilities.isEnabled(xR)&&i.bag.metricsPaymentNamespaceEnabled&&(o=new gK(hK),await o.loadValues(i,[im.client,im.user])),e=i}return e.adding(OY.metatype,t).adding(gK.defaultMetatype,n).adding(gK.paymentMetatype,o||n).adding(gK.personalizationMetatype,r)}}class Dte extends Yv.LegacyRuntime{constructor(e,t){super(e,t,{})}exportingService(e,t){this.wrapServiceInValidation(t)
const n={...this.serviceWithName(e)||{},...t}
return super.exportingService(e,n)}exportingServiceName(e,t,n){const r={}
r[t]=n,this.exportingService(e,r)}wrapServiceInValidation(e){for(const t of Object.keys(e)){const n=e[t]
n instanceof Function&&(e[t]=function(...e){const t=n.apply(this,e)
return t instanceof Promise?t.then(e=>(Kv.recordValidationIncidents(e),e)):(Kv.recordValidationIncidents(t),t)})}}}(0,Yv.exportBootstrap)(function(e){const[t,n]=function(){const e=new E3,t=function(e,t,n){var r,o
const i=function(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x,$,F){return e.configureDefaults(n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x,$,F).adding(O3,t)}(new Y3("app-store"),e,bag,cryptography,host,net,platform,plist,random,services,cookieProvider,console,ask.storeMetrics,ask.amsEngagement,ask.loc,ask.adsLoc,ask.device,ask.client,ask.props,ask.user,ask.player,ask.metricsIdentifiers,ask.clientOrdering,ask.arcade,ask.gameCenter,ask.resilientDeepLinks,ask.appleSilicon,ask.storage,ask.ads,ask.onDeviceRecommendationsManager,ask.onDeviceSearchHistoryManager,null!==(r=ask.featureFlags)&&void 0!==r?r:{isEnabled:()=>!1,isGSEUIEnabled:()=>!1},null!==(o=ask.clientCapabilities)&&void 0!==o?o:{isEnabled:()=>!1},mediaToken,ask.appDistribution,ask.timeoutManager,ask.treatmentStore,ask.userDefaults)
return kW.createSharedMetricsReferralContext(i),i}(e),n=new Rte,r=new Dte(n,t)
return function(e,t){const n=e.required(O3)
t.exportingService(YA,{fetchGeneric:async t=>await n.fetchPage(e,t.url,bJ),fetchMoreOfGeneric:async t=>await n.fetchMoreOfPage(e,t.pageToken),fetchShelves:async t=>await n.fetchShelves(e,t.requests),fetchAction:async t=>await sp(e,t)})}(t,r),e.registerPageBuilder(t,new pte(t,r)),e.registerPageBuilder(t,new lte(t,r)),e.registerPageBuilder(t,new dte),e.registerPageBuilder(t,new Ate(t,r)),e.registerShelfBuilder(t,new c4),e.registerShelfBuilder(t,new d4),e.registerShelfBuilder(t,new p4),e.registerShelfBuilder(t,new y5),e.registerShelfBuilder(t,new w4),e.registerShelfBuilder(t,new g5),e.registerShelfBuilder(t,new v4),e.registerShelfBuilder(t,new y4),e.registerShelfBuilder(t,new T4),e.registerShelfBuilder(t,new S4),e.registerShelfBuilder(t,new s4),e.registerShelfBuilder(t,new O4),e.registerShelfBuilder(t,new L4),e.registerShelfBuilder(t,new s5),e.registerShelfBuilder(t,new a5),e.registerShelfBuilder(t,new l5),e.registerShelfBuilder(t,new f5),e.registerShelfBuilder(t,new h5),e.registerShelfBuilder(t,new p5),e.registerShelfBuilder(t,new m5),e.registerPageBuilder(t,new D7),e.registerPageBuilder(t,new A8(t,r)),e.registerPageBuilder(t,new f8(t,r)),e.registerPageBuilder(t,new D8(t,r)),e.registerPageBuilder(t,new M9),e.registerPageBuilder(t,new w8(t,r)),e.registerPageBuilder(t,new k8(t,r)),e.registerPageBuilder(t,new O8),e.registerPageBuilder(t,new I9),e.registerPageBuilder(t,new L9(t,r)),e.registerShelfBuilder(t,new a4),e.registerPageBuilder(t,new h7),e.registerPageBuilder(t,new y7),e.registerPageBuilder(t,new A7),e.registerPageBuilder(t,new R7),e.registerPageBuilder(t,new Z7),e.registerPageBuilder(t,new ree),e.registerPageBuilder(t,new oee),e.registerPageBuilder(t,new Y7(t,r)),e.registerPageBuilder(t,new W7),e.registerPageBuilder(t,new iee),e.registerPageBuilder(t,new see),e.registerPageBuilder(t,new H7),e.registerPageBuilder(t,new V7),e.registerPageBuilder(t,new q7),e.registerPageBuilder(t,new j7),e.registerPageBuilder(t,new nte),e.registerPageBuilder(t,new mee(t,r)),e.registerPageBuilder(t,new ate(t,r)),e.registerPageBuilder(t,new Jee(t,r)),e.registerPageBuilder(t,new u7),e.registerPageBuilder(t,new d7),e.registerPageBuilder(t,new f7),e.registerPageBuilder(t,new r9(t,r)),e.registerPageBuilder(t,new v9(t,r)),e.registerPageBuilder(t,new o9),e.registerPageBuilder(t,new b9),e.registerPageBuilder(t,new i9),e.registerPageBuilder(t,new T9),e.registerPageBuilder(t,new m9),e.registerPageBuilder(t,new y9),e.registerPageBuilder(t,new A9),e.registerPageBuilder(t,new t7),e.registerPageBuilder(t,new n7),e.registerPageBuilder(t,new Z8),e.registerPageBuilder(t,new K8),e.registerPageBuilder(t,new q8),e.registerPageBuilder(t,new Q8),e.registerPageBuilder(t,new r7),e.registerPageBuilder(t,new W8),e.registerPageBuilder(t,new Y8),e.registerPageBuilder(t,new X8),e.registerPageBuilder(t,new J8),e.registerPageBuilder(t,new e7),e.registerPageBuilder(t,new B7(t,r)),e.registerPageBuilder(t,new L7(t,r)),e.registerPageBuilder(t,new uee),e.registerPageBuilder(t,new lee),e.registerPageBuilder(t,new aee),e.registerPageBuilder(t,new cee),e.registerPageBuilder(t,new E7(t,r)),e.registerPageBuilder(t,new kte(t,r)),e.registerPageBuilder(t,new P9(t,r)),e.registerPageBuilder(t,new M7(t,r)),e.registerPageBuilder(t,new $8(t,r)),e.registerPageBuilder(t,new j8(t,r)),e.registerPageBuilder(t,new L8(t,r)),e.registerPageBuilder(t,new G7(t,r)),e.registerPageBuilder(t,new H8(t,r)),[n,r]}()
return t.register(new n9),t.register(new X3),t.register(new Ete),t.register(new y8),t.register(new u8),t.register(new d8),t.register(new p8),t.register(new _8),t.register(new R8),t.register(new C8),t.register(new D9),t.register(new _9),t.register(new cte),t.register(new O7),t.register(new G8),t.register(new U7),t.register(new k7),t.register(new w9),t.register(new K3),t.register(new Z3),t.register(new V8),t.register(new _7),t.register(new Ote),t.register(new N7),t.register(new F7),t.register(new g9),t.register(new x8),t.register(new B8),t.register(new U8),t.register(new Yee),t.register(new ite),t.register(new ste),t.register(new vee),t.register(new z7),t.register(new Q3),t.register(new fte),t.register(new hte),t.register(new mte),t.register(new yte),t.register(new S9),t.register(new Cte),n})})()})()

//# sourceMappingURL=main.js.map