(()=>{function e(r){var o,i=n[r]
return void 0!==i?i.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,e),o.exports)}var t={172:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7691),t)},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.demoteByEngagements=void 0,t.demoteByEngagements=function(e,t){return[...e]}},2305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3745:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2305),t),o(n(3756),t)},7691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3745),t),o(n(230),t)},9100:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4908),t)},6451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LazyProxyFactory=void 0,t.LazyProxyFactory=class{static makeProxy(e,t){const r=new n(t),o={get:(t,n,o)=>{if(void 0===r.createRealObjectIfNeeded(e))return
const i=r.realObject[n]
return"function"==typeof i?i.bind(r.realObject):i},set:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.set(r.realObject,n,o,r.realObject),has:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.has(r.realObject,n),deleteProperty:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.deleteProperty(r.realObject,n),ownKeys:t=>void 0===r.createRealObjectIfNeeded(e)?[]:Reflect.ownKeys(r.realObject),getOwnPropertyDescriptor:(t,n)=>{if(void 0!==r.createRealObjectIfNeeded(e))return Reflect.getOwnPropertyDescriptor(r.realObject,n)},defineProperty:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.defineProperty(r.realObject,n,o),preventExtensions:t=>void 0!==r.createRealObjectIfNeeded(e)&&(Reflect.preventExtensions(r),Reflect.preventExtensions(r.realObject)),isExtensible:t=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.isExtensible(r.realObject),getPrototypeOf:t=>void 0===r.createRealObjectIfNeeded(e)?null:Reflect.getPrototypeOf(r.realObject),setPrototypeOf:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.setPrototypeOf(r.realObject,n)}
return new Proxy(r,o)}}
class n{constructor(e){this.lazyProvider=e}createRealObjectIfNeeded(e){return void 0===this.realObject&&(this.realObject=this.lazyProvider.lazyDependencyFor(e)),this.realObject}}},4908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.ObjectGraph=void 0
const r=n(2450)
t.ObjectGraph=class{constructor(e){this._members={},this.name=e}adding(e,t){const n=this.clone()
return n._members[e.name]=t,n}removing(e){const t=this.clone()
return delete t._members[e.name],t}optional(e){return this._members[e.name]}required(e){const t=this._members[e.name]
if((0,r.isNothing)(t)){const t=Object.keys(this._members).sort().join(", ")
throw new Error(`No member with type ${e.name} found in ${this.name}. Candidates ${t}`)}return t}clone(){const e=new(0,this.constructor)(this.name)
for(const[t,n]of Object.entries(this._members))e._members[t]=n
return e}},t.inject=function(e,t){return t.required(e)}},9089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseActionProvider=void 0
const r=n(2450)
t.isBaseActionProvider=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.actionFor)}},129:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9089),t)},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntentDispatcher=void 0
const r=n(2450),o=n(4395),i=n(3907),s=n(1222)
t.IntentDispatcher=class{constructor(){this.dispatchableMap={}}register(e){if((0,r.isNothing)(e.$intentKind))throw new Error("Dispatcher cannot register a controller without an $intentKind")
if(e.$intentKind in this.dispatchableMap)throw new Error(`Dispatcher already has a controller registered for ${e.$intentKind}`)
this.dispatchableMap[e.$intentKind]=e}async dispatch(e,t){if("$static"===e.$kind){const t=Reflect.get(e,"$data")
if((0,r.isNothing)(t))throw new Error("StaticIntent<R> contains no data")
return t}const n=this.dispatchableMap[e.$kind]
if((0,r.isNothing)(n)||!(0,o.isIntentController)(n))throw new Error(`No controller registered to handle ${e.$kind}`)
const a=e.$pageIntentInstrumentation,c=t.optional(s.net)
if((0,r.isSome)(a)&&(0,r.isSome)(c)){const r=new i.ProxiedNetwork(c,a),o=t.adding(s.net,r)
return await n.perform(e,o)}return await n.perform(e,t)}controller(e){return this.dispatchableMap[e.$kind]}get registeredControllers(){return Object.values(this.dispatchableMap)}}},8346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4395),t),o(n(3421),t),o(n(8770),t),o(n(867),t)},4395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIntentController=void 0
const r=n(2450)
t.isIntentController=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.perform)}},867:(e,t)=>{function n(e){return{$kind:"$static",$data:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Continuous=t.makeSidepackedIntent=t.makeStaticContinuousIntentsOf=t.makeStaticIntent=void 0,t.makeStaticIntent=n,t.makeStaticContinuousIntentsOf=function(e){const t=new Array
for(const o of e)t.push(n(r.of(o)))
return t},t.makeSidepackedIntent=function(e,t){return{$kind:"$sidepacked",$initial:e,$intent:t}}
class r{static of(e){return new r(new o(e))}static contentsOf(e){return new r(e)}constructor(e){this.base=e,this.$wrappedField="base"}toJSON(){if(this.base instanceof o)return this.base.toJSON()
throw new TypeError("Continuous was not created with a single element")}async*[Symbol.asyncIterator](){yield*this.base}}t.Continuous=r
class o{constructor(e){this.element=e,this.$wrappedField="element"}toJSON(){return this.element}async*[Symbol.asyncIterator](){yield this.element}}},5881:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(8346),t),o(n(129),t)},5542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(5827),t),o(n(8037),t),o(n(1777),t),o(n(1415),t),o(n(7312),t)},1777:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1077),t),o(n(4172),t)},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueAsNumber=t.valueAsString=t.valueAsBoolean=void 0
const r=n(2450),o=n(4172)
t.valueAsBoolean=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("boolean"==typeof e)return e
if("string"==typeof e){if("true"===e)return!0
if("false"===e)return!1}const i=Boolean(e)
switch(t){case"strict":o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)})
break
case"coercible":if((0,r.isNothing)(i))return o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)}),null}return i},t.valueAsString=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("string"==typeof e)return e
const i="object"==typeof e?null:String(e)
switch(t){case"strict":o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})
break
case"coercible":(0,r.isNothing)(i)&&o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})}return i},t.valueAsNumber=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("number"==typeof e)return e
const i=Number(e)
switch(t){case"strict":o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)})
break
case"coercible":if(isNaN(i))return o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)}),null}return i}},1077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4409),t),o(n(2506),t),o(n(6418),t)},2506:(e,t,n)=>{function r(e){if(Array.isArray(e))return e
switch(typeof e){case"string":{const t=i[e]
if((0,o.isSome)(t))return t
{const t=Object.freeze(e.split("."))
return i[e]=t,t}}case"number":case"symbol":return[e]
default:throw new TypeError(`${e.toString()} is not a KeyPath`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.keyPathContains=t.keyPathEndsWith=t.keyPathStartsWith=t.keyPathsEqual=t.isKeyPathThis=t.thisKeyPath=t.keysOf=void 0
const o=n(2450),i={}
t.keysOf=r,t.thisKeyPath=Object.freeze([]),t.isKeyPathThis=function(e){return Array.isArray(e)&&0===e.length},t.keyPathsEqual=function(e,t){if(e===t)return!0
const n=r(e),o=r(t)
if(n.length!==o.length)return!1
for(let e=0,t=n.length;e<t;e+=1)if(n[e]!==o[e])return!1
return!0},t.keyPathStartsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[0]===t}},t.keyPathEndsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[n.length-1]===t}},t.keyPathContains=function(e,t){return e===t||r(e).includes(t)}},6853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectCursor=void 0
const r=n(2450),o=n(2879),i=n(2506),s=n(7454)
t.ObjectCursor=class{constructor(e){this.values=[e],this.keyPaths=[i.thisKeyPath],this.savedDepths=[]}get currentValue(){return this.values[this.values.length-1]}get currentKeyPath(){return this.keyPaths[this.keyPaths.length-1]}interject(e,t){this.values.push(e),this.keyPaths.push(t)}reuse(e,t=i.thisKeyPath){this.values.length=0,this.values.push(e),this.keyPaths.length=0,this.keyPaths.push(t),this.savedDepths.length=0}moveTo(e){const t=(0,s.traverse)(this.currentValue,e)
return this.values.push(t),this.keyPaths.push(e),t}moveBack(){const e=this.values.length
if(1===e)throw new Error("Cannot move back past the root of a cursor")
const t=this.savedDepths.length
if(t>0&&e<=this.savedDepths[t-1])throw new Error("Cannot move back past the most recent saved state")
this.values.pop(),this.keyPaths.pop()}saveState(){this.savedDepths.push(this.values.length)}restoreState(){const e=this.savedDepths.pop()
if((0,r.isNothing)(e))throw new Error("Calls to restoreState must balance previous calls to saveState")
this.values.length=e,this.keyPaths.length=e}clone(){const e=(0,o.shallowCloneOf)(this)
return e.values=this.values.slice(),e.keyPaths=this.keyPaths.slice(),e.savedDepths=this.savedDepths.slice(),e}}},4409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectReader=void 0
const r=n(2450),o=n(2879),i=n(6418),s=n(2506),a=n(6853),c=n(7454),l=new Map
class u{constructor(e){this._cursor=new a.ObjectCursor(e)}get currentKeyPath(){return this._cursor.currentKeyPath}has(e){return(0,s.keyPathEndsWith)(this._cursor.currentKeyPath,e)||(0,r.isSome)(this.get(e))}select(e,t=!1){return!t&&(0,s.keyPathsEqual)(this._cursor.currentKeyPath,e)||this._cursor.moveTo(e),this}deselect(){return this._cursor.moveBack(),this}saveSelection(){return this._cursor.saveState(),this}restoreSelection(){return this._cursor.restoreState(),this}get(e=s.thisKeyPath){return(0,s.isKeyPathThis)(e)?this._cursor.currentValue:(0,c.traverse)(this._cursor.currentValue,e)}asBoolean(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsBoolean)(this.get(e),t,String(e))}asNumber(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsNumber)(this.get(e),t,String(e))}asString(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsString)(this.get(e),t,String(e))}*[Symbol.iterator](){const e=this.get()
if((0,r.isNothing)(e))return
const t=u._clone(this)
if(Array.isArray(e)){let n=0
for(const r of e)t.saveSelection(),t._cursor.interject(r,n),yield t,t.restoreSelection(),n+=1}else yield t
u._recycle(t)}reduce(e,t){const n=this.get()
if((0,r.isNothing)(n))return e
if(!Array.isArray(n))return t(e,this)
try{let r=e
for(let e=0,o=n.length;e<o;e+=1)this.saveSelection(),this._cursor.interject(n[e],e),r=t(r,this),this.restoreSelection()
return r}catch(e){throw this.restoreSelection(),e}}map(e){return this.reduce(new Array,(t,n)=>(t.push(e(n)),t))}compactMap(e){return this.reduce(new Array,(t,n)=>{const o=e(n)
return(0,r.isSome)(o)&&t.push(o),t})}applyTo(e,...t){this.saveSelection()
try{const n=e(this,...t)
return this.restoreSelection(),n}catch(e){throw this.restoreSelection(),e}}callOn(e,t,...n){this.saveSelection()
try{const r=e.call(t,this,...n)
return this.restoreSelection(),r}catch(e){throw this.restoreSelection(),e}}clone(){const e=(0,o.shallowCloneOf)(this)
return e._cursor=this._cursor.clone(),e}static optimizeIterationUpToDepth(e){for(let t=0;t<e;t+=1)u._recycle(new u(void 0))}static _clone(e){const t=l.get(e.constructor)
if((0,r.isSome)(t)){const n=t.pop()
if((0,r.isSome)(n))return n.onReuseToIterate(e),n}return e.clone()}onReuseToIterate(e){const t=e._cursor
this._cursor.reuse(t.currentValue,t.currentKeyPath)}static _recycle(e){const t=e.constructor,n=l.get(t)
if((0,r.isSome)(n)){if(n.length>=5)return
e.onRecycleForIteration(),n.push(e)}else e.onRecycleForIteration(),l.set(t,[e])}onRecycleForIteration(){this._cursor.reuse(void 0)}}t.ObjectReader=u},7454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverse=void 0
const r=n(2450),o=n(2506)
t.traverse=function(e,t){if("object"!=typeof e)return e
if(!(0,r.isSome)(e))return e
const n=(0,o.keysOf)(t)
switch(n.length){case 0:return e
case 1:return e[n[0]]
default:let t=e
for(const e of n){const n=t[e]
if("object"!=typeof n)return n
if(!(0,r.isSome)(n))return n
t=n}return t}}},4172:(e,t,n)=>{function r(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function o(e,t,n,o){u({type:"badType",expected:t,actual:`${r(n)} (${n})`,objectPath:(0,d.isSome)(o)&&o.length>0?o:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}function i(e){return!(0,d.isNothing)(e)&&(Object.prototype.hasOwnProperty.call(e,"$incidents")||Object.isExtensible(e))}function s(e){f.nameStack.push(e)}function a(){return 0===f.nameStack.length?["<empty stack>"]:f.nameStack.slice(0)}function c(){f.nameStack.length,f.nameStack.pop()}function l(e,t,n){let r,i=null;(0,d.isSome)(n)&&n.length>0&&(i=e,f.suppressedIncidentPaths.push(n))
try{s(e),r=t()}catch(e){throw e.hasThrown||(o("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===i&&f.suppressedIncidentPaths.pop(),c()}return r}function u(e){f.suppressedIncidentPaths.includes(e.objectPath)||f.incidents.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unexpectedNull=t.catchingContext=t.context=t.recordValidationIncidents=t.endContext=t.getContextNames=t.beginContext=t.messageForRecoveryAction=t.isValidatable=t.unexpectedType=t.extendedTypeof=void 0
const d=n(2450)
t.extendedTypeof=r,t.unexpectedType=o,t.isValidatable=i,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format"
case"defaultValue":return"Default value used"
case"ignoredValue":return"Ignored value"
default:return"Unknown"}}
const f={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()}
t.beginContext=s,t.getContextNames=a,t.endContext=c,t.recordValidationIncidents=function(e){i(e)&&(e.$incidents=f.incidents),f.incidents=[],f.nameStack=[],f.suppressedIncidentPaths=[]},t.context=l,t.catchingContext=function(e,t,n){let r=null
try{r=l(e,t)}catch(e){r=null,(0,d.isSome)(n)&&(r=n(e))}return r},t.unexpectedNull=function(e,t,n){u({type:"nullValue",expected:t,actual:"null",objectPath:(0,d.isSome)(n)&&n.length>0?n:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}},3647:(e,t,n)=>{function r(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function o(e,t){return r("back","button",{...e,actionType:"back"},t)}function i(e,t,n){const r=f.MetricsEventType.page
return u({...e,eventType:r,...t},n,r)}function s(e,t,n,r,o,i){const s=f.MetricsEventType.search,a={...o,eventType:s,term:e,targetType:t,actionType:n}
return(0,h.isSome)(r)&&(a.actionUrl=r),u(a,i,s)}function a(e,t,n=4){const r=f.MetricsEventType.impressions
return u({...e,eventType:r,impressionQueue:"data-metrics",eventVersion:n},t,r)}function c(e,t){const n=f.MetricsEventType.media
return u({...e,eventType:n},t,n)}function l(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function u(e,t,n){return{fields:e,includingFields:t.defaultIncludeRequests[n],excludingFields:t.defaultExcludeRequests[n],topic:d(e,t.defaultTopic),shouldFlush:!!(0,h.isSome)(t.shouldFlush)&&t.shouldFlush(e)}}function d(e,t){const n=e.topic
return(0,h.isSome)(n)?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.createMetricsMediaClickData=t.createMetricsMediaData=t.createMetricsImpressionsData=t.createMetricsSearchData=t.createMetricsPageData=t.createMetricsBackClickData=t.createMetricsClickData=t.MediaClickEventBuilder=t.MediaEventBuilder=t.ImpressionsEventBuilder=t.SearchEventBuilder=t.PageEventBuilder=t.BackClickEventBuilder=t.ClickEventBuilder=t.EventBuilder=void 0
const f=n(447),h=n(2450)
class p{constructor(e){this.configuration=e,this.eventFields={}}withEventFields(e){return this.eventFields=e,this}withConfiguration(e){return this.configuration=e,this}withDefaultTopic(e){return this.configuration={...this.configuration,defaultTopic:e},this}withDefaultIncludeRequests(e){return this.configuration={...this.configuration,defaultIncludeRequests:e},this}withDefaultExcludeRequests(e){return this.configuration={...this.configuration,defaultExcludeRequests:e},this}withShouldFlush(e){return this.configuration={...this.configuration,shouldFlush:e},this}}t.EventBuilder=p,t.ClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return r(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.BackClickEventBuilder=class extends p{build(){return o(this.eventFields,this.configuration)}},t.PageEventBuilder=class extends p{constructor(e){super(e),this.timingMetrics={}}withTimingMetrics(e){return this.timingMetrics=e,this}build(){return i(this.eventFields,this.timingMetrics,this.configuration)}},t.SearchEventBuilder=class extends p{constructor(e){super(e.configuration),this.term=e.term,this.targetType=e.targetType,this.actionType=e.actionType,this.actionUrl=null}withTerm(e){return this.term=e,this}withTargetType(e){return this.targetType=e,this}withActionType(e){return this.actionType=e,this}withActionUrl(e){return this.actionUrl=e,this}build(){return s(this.term,this.targetType,this.actionType,this.actionUrl,this.eventFields,this.configuration)}},t.ImpressionsEventBuilder=class extends p{constructor(){super(...arguments),this.impressionsEventVersion=4}withImpressionsEventVersion(e){return this.impressionsEventVersion=e,this}build(){return a(this.eventFields,this.configuration,this.impressionsEventVersion)}},t.MediaEventBuilder=class extends p{build(){return c(this.eventFields,this.configuration)}},t.MediaClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return l(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.createMetricsClickData=r,t.createMetricsBackClickData=o,t.createMetricsPageData=i,t.createMetricsSearchData=s,t.createMetricsImpressionsData=a,t.createMetricsMediaData=c,t.createMetricsMediaClickData=l},4927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cookieValueForKey=t.cookiesOf=void 0
const r=n(2450)
t.cookiesOf=function*(e){if((0,r.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}},t.cookieValueForKey=function(e,t){for(const n of e)if(n.key===t)return n.value
return null}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLinter=void 0
const r=n(4409),o=n(447),i=n(2450),s=n(7771)
t.EventLinter=class{constructor(e){this.options=Object.freeze(e)}get defaultTopic(){return this.options.defaultTopic}applyDeResolutionRules(e,t){const n=new r.ObjectReader(e)
for(const r of t){const t=n.asNumber(r.fieldName)
if((0,i.isNothing)(t))continue
let o=r.magnitude;(0,i.isNothing)(o)&&(o=1048576)
let a=r.significantDigits
if((0,i.isNothing)(a)&&(a=2),o<=0||a<0){e[r.fieldName]=Number.NaN
continue}const c=t/o
e[r.fieldName]=s.reduceSignificantDigits(c,a)}}decorateCommonEventFields(e,t){const n=new r.ObjectReader(e),o=this.options.configuration,s=o.baseFields(t);(0,i.isSome)(s)&&Object.assign(e,s),e.clientBuildType=this.options.environment.buildType,e.resourceRevNum=this.options.environment.jsVersion,e.xpSendMethod="jet-js"
const a=n.asString("pageType"),c=n.asString("pageId")
if((0,i.isSome)(a)&&(0,i.isSome)(c)&&(0,i.isNothing)(e.page)){const n=o.compoundSeparator(t),r=(0,i.isSome)(n)?(0,i.unwrapOptional)(n):"_"
e.page=`${a}${r}${c}`}const l=o.deResolutionRules(t)
this.applyDeResolutionRules(e,l)}decorateMediaEventEvents(e){const t=new r.ObjectReader(e).asNumber("position");(0,i.isSome)(t)&&(e.position=Math.round(t))}lint(e,t={}){const n=new r.ObjectReader(e),s=n.asString("eventType")
this.options.isLoggingEnabled
const a=JSON.parse(JSON.stringify(e)),c=n.asString("topic"),l=(0,i.isSome)(c)?(0,i.unwrapOptional)(c):this.options.defaultTopic
this.decorateCommonEventFields(a,l),s===o.MetricsEventType.media&&this.decorateMediaEventEvents(a)
for(const e of this.options.rules)e.apply(a,t)
return{fields:a}}}},8836:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTimingMetricsBuilderType=t.FetchTimingMetricsBuilder=void 0
const r=n(2450),o=n(900),i=n(2366)
t.FetchTimingMetricsBuilder=class{constructor(){this.metrics=[]}measureParsing(e,t){const n=e.metrics.length>0?[...e.metrics]:[],r=Date.now(),o=t(e),i=Date.now()
return n.length>0&&(n[0].parseStartTime=r,n[0].parseEndTime=i),this.metrics.push(...n),o}measureModelConstruction(e){const t=Date.now(),n=e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}async measureModelConstructionAsync(e){const t=Date.now(),n=await e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}saveModelConstructionTimes(e,t){this.metrics.length>0?(this.metrics[0].modelConstructionStartTime=e,this.metrics[0].modelConstructionEndTime=t):this.metrics.push({modelConstructionStartTime:e,modelConstructionEndTime:t})}decorate(e){if((0,r.isNothing)(e))throw new Error("Cannot decorate null or undefined")
if("object"!=typeof e)throw new Error("View model to decorate must be an object")
if((0,i.isPromise)(e))throw new Error("Cannot decorate a Promise object")
this.metrics.length>0&&(e.$networkPerformance=this.metrics)}},t.fetchTimingMetricsBuilderType=(0,o.makeMetatype)("jet-engine:fetchTimingMetricsBuilder")},8267:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7581),t),o(n(7764),t),o(n(7771),t),o(n(4698),t)},7581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsLocationTracker=void 0
const r=n(4172),o=n(2450),i=n(4698)
class s{constructor(e=0,t=[]){this.rootPosition=e,this.locationStack=t.map(e=>new a(e))}get isEmpty(){return 0===this.locationStack.length}pushLocation(e){this.locationStack.push(new a(e))}popLocation(){var e
return 0===this.locationStack.length?(r.unexpectedType("ignoredValue","non-empty location stack","empty location stack"),null):null===(e=this.locationStack.pop())||void 0===e?void 0:e.location}get currentPosition(){const e=this.lastStackItem
return(0,o.isSome)(e)?e.position:this.rootPosition}setCurrentPosition(e){const t=this.lastStackItem;(0,o.isSome)(t)?t.position=e:this.rootPosition=e}nextPosition(){const e=this.lastStackItem;(0,o.isSome)(e)?e.position+=1:this.rootPosition+=1}get stackItemsToLocations(){return this.locationStack.map(e=>e.location)}get lastStackItem(){const e=this.locationStack.length
return 0===e?null:this.locationStack[e-1]}static locationsByAddingBasicLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildBasicLocation(e,t)),n}static locationsByAddingContentLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildContentLocation(e,t)),n}static pushBasicLocation(e,t){e.locationTracker.pushLocation(s.buildBasicLocation(e,t))}static pushContentLocation(e,t){e.locationTracker.pushLocation(s.buildContentLocation(e,t))}static popLocation(e){return e.locationTracker.popLocation()}static buildBasicLocation(e,t){let n=t;(0,o.isSome)(e.anonymizationOptions)&&(n=e.anonymizationOptions.anonymizationString)
const r={locationPosition:e.locationTracker.currentPosition,locationType:i.targetTypeForMetricsOptions(e),name:n}
return(0,o.isSome)(e.recoMetricsData)&&Object.assign(r,e.recoMetricsData),r}static buildContentLocation(e,t){const n=s.buildBasicLocation(e,t)
if((0,o.isNothing)(e.id))n.idType="sequential",n.id=e.locationTracker.currentPosition.toString()
else{n.idType=i.idTypeForMetricsOptions(e)
let t=e.id;(0,o.isSome)(e.anonymizationOptions)&&(t=e.anonymizationOptions.anonymizationString),n.id=t}return(0,o.isSome)(e.fcKind)&&(n.fcKind=e.fcKind),(0,o.isSome)(e.displayStyle)&&(n.displayStyle=e.displayStyle),n}}t.MetricsLocationTracker=s
class a{constructor(e,t=0){this.location=e,this.position=t}}},7764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSignificantDigits=void 0,t.reduceSignificantDigits=function(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}},4698:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchTermFromRefURL=t.extractSiriRefAppFromRefURL=t.idTypeForMetricsOptions=t.targetTypeForMetricsOptions=void 0
const r=n(2450),o=n(1974)
t.targetTypeForMetricsOptions=function(e){let t=e.targetType
return(0,r.isNothing)(t)&&(t="lockup"),t},t.idTypeForMetricsOptions=function(e){let t=e.idType
return(0,r.isNothing)(t)&&(t="its_id"),t},t.extractSiriRefAppFromRefURL=function(e){const t=new o.URL(e)
if((0,r.isNothing)(t.query))return null
let n=null
for(const e of Object.keys(t.query))if("referrer"===e){"siri"===t.query[e]&&(n="com.apple.siri")
break}return n},t.searchTermFromRefURL=function(e){const t=new o.URL(e),n=t.query
if((0,r.isNothing)(n))return null
const i=n.term,s=t.pathname
return(0,r.isNothing)(i)||(0,r.isNothing)(s)?null:s.endsWith("/search")?i:null}},1415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3647),t),o(n(4927),t),o(n(8535),t),o(n(8836),t),o(n(8267),t),o(n(6094),t)},6094:(e,t,n)=>{function r(e,t){const n=e.optional(a.fetchTimingMetricsBuilderType)
if((0,s.isSome)(n))return e
if(t)throw new Error("Could not find FetchTimingMetricsBuilder in the object graph")
return e.adding(a.fetchTimingMetricsBuilderType,new a.FetchTimingMetricsBuilder)}async function o(e,t,n){const r=(0,i.inject)(a.fetchTimingMetricsBuilderType,t),o=await r.measureModelConstructionAsync(async()=>{const r=n(e,t)
return await Promise.resolve(r)})
if((0,s.isNothing)(o))throw new Error("model builder function returned null or undefined")
return r.decorate(o),o}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndBuildModel=t.requestAndBuildModel=void 0
const i=n(9100),s=n(2450),a=n(8836)
t.requestAndBuildModel=async function(e,t,n,i){const s=r(t,!0),a=await n(e,s)
return await o(a,s,i)},t.parseAndBuildModel=async function(e,t,n,c){const l=r(t,!1),u=(0,i.inject)(a.fetchTimingMetricsBuilderType,l).measureParsing(e,()=>n(e,l))
if((0,s.isNothing)(u))throw new Error("parser function returned null or undefined")
return await o(u,l,c)}},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompoundAction=t.isCompoundAction=void 0,t.isCompoundAction=function(e){return"compoundAction"===(null==e?void 0:e.$kind)},t.makeCompoundAction=function(e,t){return{$kind:"compoundAction",subactions:t,actionMetrics:e}}},9120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyAction=t.isEmptyAction=void 0,t.isEmptyAction=function(e){return"emptyAction"===(null==e?void 0:e.$kind)},t.makeEmptyAction=function(e){return{$kind:"emptyAction",actionMetrics:e}}},9634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4789),t),o(n(573),t),o(n(9120),t),o(n(9634),t),o(n(5599),t),o(n(2170),t),o(n(6158),t),o(n(9400),t),o(n(4362),t)},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeArtworkURLTemplate=void 0
const r=n(4172),o=n(2450),i=n(1974),s=new RegExp("^({w}|[0-9]+(?:.[0-9]*)?)x({h}|[0-9]+(?:.[0-9]*)?)({c}|[a-z]{2}).({f}|[a-z]+)$")
t.makeArtworkURLTemplate=function(e){if(void 0===new i.URL(e).pathname)return r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid URL string",e)}),null
const t=e.substring(e.lastIndexOf("/")+1),n=s.exec(t)
return(0,o.isNothing)(n)||5!==n.length?(r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid artwork URL template ending with {w}x{h}{c}.{f} format",t)}),null):e}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areEqual=t.luminanceFrom=t.dynamicWith=t.named=t.rgbWith=t.htmlWith=t.Color=void 0
const r=n(2450)
t.Color={fromHex:e=>(0,r.isNothing)(e)?null:{$kind:"html",value:e},fromRGB:(e,t,n,r=1)=>({$kind:"rgb",red:e,green:t,blue:n,alpha:r}),named:e=>({$kind:"named",name:e}),dynamicWith:(e,t,n,r)=>({$kind:"dynamic",lightColor:e,lightHighContrastColor:t,darkColor:n,darkHighContrastColor:r}),luminanceFrom:e=>.2126*e.red+.7152*e.green+.0722*e.blue,areEqual(e,n){if((0,r.isNothing)(e))return(0,r.isNothing)(n)
if((0,r.isNothing)(n))return(0,r.isNothing)(e)
const o=e.$kind,i=n.$kind
if("named"===o&&"named"===i){const t=n
return e.name===t.name}if("rgb"===o&&"rgb"===i){const t=e,r=n
return t.red===r.red&&t.green===r.green&&t.blue===r.blue&&t.alpha===r.alpha}if("dynamic"===o&&"dynamic"===i){const r=e,o=n
return t.Color.areEqual(r.lightColor,o.lightColor)&&t.Color.areEqual(r.lightHighContrastColor,o.lightHighContrastColor)&&t.Color.areEqual(r.darkColor,o.darkColor)&&t.Color.areEqual(r.darkHighContrastColor,o.darkHighContrastColor)}return!1}}
const o=t.Color.fromHex
t.htmlWith=o
const i=t.Color.fromRGB
t.rgbWith=i
const s=t.Color.named
t.named=s
const a=t.Color.dynamicWith
t.dynamicWith=a
const c=t.Color.luminanceFrom
t.luminanceFrom=c
const l=t.Color.areEqual
t.areEqual=l},5827:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1235),t),o(n(998),t),o(n(7615),t),o(n(6301),t),o(n(8681),t),o(n(5273),t),o(n(9184),t),o(n(7129),t),o(n(2359),t)},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.menuSeparatorID=void 0,t.menuSeparatorID="com.apple.JetEngine.separator"},5273:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9184:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6882:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportBootstrap=void 0
const r=n(6451)
t.exportBootstrap=function(e){"undefined"!=typeof $exportBootstrap&&$exportBootstrap(t=>(function(e){const t=e.$lazyDependencyNames,n=new Set(null!=t?t:[]),o=globalThis.$lazyGlobalNames,i=new Set(null!=o?o:[]),s=new Set([...n,...i]),a=new Map,c=globalThis.$lazyProvider
for(const e of s)a.set(e,r.LazyProxyFactory.makeProxy(e,c))
for(const t of n)e[t]=a.get(t)
for(const e of i)globalThis[e]=a.get(e)}(t),e(t)))},globalThis.has_lazy_support=!0},8706:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6882),t),o(n(4816),t)},4816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyRuntime=t.Runtime=void 0
const n="function"==typeof exportService
class r{constructor(e,t){this.dispatcher=e,this.objectGraph=t}async dispatch(e){return await this.dispatcher.dispatch(e,this.objectGraph)}}t.Runtime=r,t.LegacyRuntime=class extends r{constructor(e,t,n){super(e,t),this.services=n}serviceWithName(e){return this.services[e]}exportingService(e,t){return n&&function(e,t){exportService(e,t)}(e,t),this.services[e]=t,this}}},1219:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof preprocessor&&(globalThis.preprocessor={PRODUCTION_BUILD:!1,CARRY_BUILD:!1,DEBUG_BUILD:!1,INTERNAL_BUILD:!1}),"undefined"==typeof testContent&&(globalThis.testContent={INCLUDE_TEST_CONTENT:!1}),o(n(1219),t),o(n(8045),t),o(n(3922),t),o(n(9891),t),o(n(1121),t),o(n(9247),t),o(n(3907),t),o(n(6534),t),o(n(5817),t),o(n(3043),t),o(n(5037),t),o(n(5937),t),o(n(1222),t)},9247:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3907:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxiedNetwork=void 0,t.ProxiedNetwork=class{constructor(e,t){this.original=e,this.pageIntentInstrumentation=t}async fetch(e){return e.$pageIntentInstrumentation=this.pageIntentInstrumentation,await this.original.fetch(e)}}},6534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.services=t.random=t.plist=t.platform=t.net=t.localizer=t.host=t.cryptography=t.cookieProvider=t.bundle=t.bag=void 0
const r=n(900)
t.bag=(0,r.makeMetatype)("jet-engine:bag"),t.bundle=(0,r.makeMetatype)("jet-engine:bundle"),t.cookieProvider=(0,r.makeMetatype)("jet-engine:cookieProvider"),t.cryptography=(0,r.makeMetatype)("jet-engine:cryptography"),t.host=(0,r.makeMetatype)("jet-engine:host"),t.localizer=(0,r.makeMetatype)("jet-engine:localizer"),t.net=(0,r.makeMetatype)("jet-engine:net"),t.platform=(0,r.makeMetatype)("jet-engine:platform"),t.plist=(0,r.makeMetatype)("jet-engine:plist"),t.random=(0,r.makeMetatype)("jet-engine:random"),t.services=(0,r.makeMetatype)("jet-engine:services")},8037:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1721),t),o(n(9031),t),o(n(447),t),o(n(2024),t),o(n(2450),t)},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9031:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2490),t)},447:(e,t)=>{var n,r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.notInstrumented=t.NotInstrumentedMetricsType=t.MetricsEventType=t.PageInvocationPoint=t.EMPTY_LINTED_METRICS_EVENT=void 0,t.EMPTY_LINTED_METRICS_EVENT={fields:{},issues:[]},(o=t.PageInvocationPoint||(t.PageInvocationPoint={})).pageEnter="pageEnter",o.pageExit="pageExit",o.appExit="appExit",o.appEnter="appEnter",o.backButton="backButton",(r=t.MetricsEventType||(t.MetricsEventType={})).click="click",r.page="page",r.search="search",r.impressions="impressions",r.media="media",r.pageRender="pageRender",function(e){e[e.ActionMetrics=0]="ActionMetrics",e[e.FetchTimingMetrics=1]="FetchTimingMetrics",e[e.PageMetrics=2]="PageMetrics",e[e.ImpressionMetrics=3]="ImpressionMetrics"}(n=t.NotInstrumentedMetricsType||(t.NotInstrumentedMetricsType={})),t.notInstrumented=function(e){switch(e){case n.ActionMetrics:return{data:[],custom:{}}
case n.FetchTimingMetrics:return{}
case n.PageMetrics:return{instructions:[],custom:{}}
case n.ImpressionMetrics:return{id:{id:"",impressionIndex:-1},fields:{},custom:{}}
default:return{}}}},2024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2450:(e,t)=>{function n(e){return null==e}function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.flatMapOptional=t.mapOptional=t.unsafeUnwrapOptional=t.unwrapOptional=t.isSome=t.isNothing=t.unsafeUninitialized=void 0,t.unsafeUninitialized=function(){},t.isNothing=n,t.isSome=r,t.unwrapOptional=function(e){if(n(e))throw new ReferenceError
return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return r(e)?t(e):e},t.flatMapOptional=function(e,t){return r(e)?t(e):e}},2879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shallowCloneOf=void 0,t.shallowCloneOf=function(e){const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e)}},6151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0,t.ExpiringValue=class{constructor(e,t){this._value=e,this._maxAge=t}isValid(){return Date.now()<this._maxAge}get value(){return this.isValid()?this._value:null}}},7312:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2879),t),o(n(6151),t),o(n(900),t),o(n(2366),t),o(n(4805),t),o(n(3087),t),o(n(1974),t)},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMetatype=void 0,t.makeMetatype=function(e){return{name:e}}},2366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0,t.isPromise=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}},4805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RewindableValue=void 0
const r=n(2879)
t.RewindableValue=class{constructor(e){this._values=[e]}get(){return this._values[this._values.length-1]}set(e){this._values[this._values.length-1]=e}save(){this._values.push(this._values[this._values.length-1])}restore(){if(1===this._values.length)throw new RangeError("Calls to restore must balance previous calls to save")
this._values.pop()}clone(){const e=(0,r.shallowCloneOf)(this)
return e._values=this._values.slice(),e}}},3087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.difference=t.symmetricDifference=t.intersection=t.union=t.isSuperset=void 0,t.isSuperset=function(e,t){for(const n of t)if(!e.has(n))return!1
return!0},t.union=function(e,t){const n=new Set(e)
for(const e of t)n.add(e)
return n},t.intersection=function(e,t){const n=new Set
for(const r of t)e.has(r)&&n.add(r)
return n},t.symmetricDifference=function(e,t){const n=new Set(e)
for(const e of t)n.has(e)?n.delete(e):n.add(e)
return n},t.difference=function(e,t){const n=new Set(e)
for(const e of t)n.delete(e)
return n}},1974:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.QueryHandling=void 0
const o=n(2450),i=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,s=/([^=?&]+)=?([^&]*)/g,a=["hash","query","pathname","host"]
var c
!function(e){e.FORM_ENCODED="form-encoded",e.RFC3986="rfc3986"}(c=t.QueryHandling||(t.QueryHandling={}))
class l{constructor(e,t){var n
if(this.query={},this.queryHandling=null==t?void 0:t.queryHandling,(0,o.isNothing)(e))return
let s=e
const c=i.exec(e)
if((0,o.isSome)(c)){let e=c[1]
null!=e&&(e=e.split(":")[0]),this.protocol=null!=e?e:void 0,s=null!==(n=c[3])&&void 0!==n?n:void 0}let u={remainder:s,result:void 0}
for(const e of a){if(void 0===u||void 0===u.remainder)break
switch(e){case"hash":u=r(u.remainder,"#","suffix"),this.hash=null==u?void 0:u.result
break
case"query":u=r(u.remainder,"?","suffix"),void 0!==(null==u?void 0:u.result)&&(this.query=l.queryFromString(u.result,this.queryHandling))
break
case"pathname":u=r(u.remainder,"/","suffix"),void 0!==(null==u?void 0:u.result)&&(this.pathname="/"+u.result)
break
case"host":{const e=r(u.remainder,"@","prefix"),t=null==e?void 0:e.result,n=null==e?void 0:e.remainder
if(void 0!==t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(void 0!==n){const e=n.split(":")
this.host=e[0],this.port=e[1]}break}default:throw new Error("Unhandled case!")}}}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}set(e,t){if(void 0===t)return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}append(e,t){let n,r=this.get(e)
if("query"===e)void 0===r&&(r={}),"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),n="string"==typeof r?{existingValue:r,...t}:{...r,...t}
else{void 0===r&&(r="")
let o=r
void 0===o&&(o="")
let i=o
if("pathname"===e){const e=o.length
0!==e&&"/"===o[e-1]||(i+="/")}i+=t,n=i}return this.set(e,n)}param(e,t){return null===e||(void 0===this.query&&(this.query={}),void 0===t?delete this.query[e]:this.query[e]=t),this}removeParam(e){return void 0===e||void 0===this.query||e in this.query&&delete this.query[e],this}path(e){return this.append("pathname",e)}pathExtension(){var e,t
if(void 0===this.pathname)return
const n=null!==(t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split("."))&&void 0!==t?t:[]
return n.filter(function(e){return""!==e}).length<2?void 0:n.pop()}pathComponents(){return void 0===this.pathname?[]:this.pathname.split("/").filter(e=>e.length>0)}build(){return this.toString()}toString(){let e=""
return void 0!==this.protocol&&(e+=this.protocol+"://"),void 0!==this.username&&(e+=encodeURIComponent(this.username),void 0!==this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),void 0!==this.host&&(e+=this.host,void 0!==this.port&&(e+=":"+this.port)),void 0!==this.pathname&&(e+=this.pathname),void 0!==this.query&&0!==Object.keys(this.query).length&&(e+="?"+l.toQueryString(this.query,this.queryHandling)),void 0!==this.hash&&(e+="#"+this.hash),e}static queryFromString(e,t=c.FORM_ENCODED){const n={}
let r=s.exec(e)
for(;null!==r&&r.length>=3;){let o=r[1],i=r[2]
t===c.FORM_ENCODED&&(o=o.replace(/\+/g," "),i=i.replace(/\+/g," "))
const a=decodeURIComponent(o),l=decodeURIComponent(i)
n[a]=l,r=s.exec(e)}return n}static toQueryString(e,t=c.RFC3986){let n="",r=!0
for(const o of Object.keys(e)){r||(n+="&"),r=!1,n+=l.encodeQueryComponent(o,t)
const i=e[o]
null!==i&&i.length>0&&(n+="="+l.encodeQueryComponent(i,t))}return n}static encodeQueryComponent(e,t){return t===c.FORM_ENCODED?encodeURIComponent(e).replace(/%20/g,"+"):encodeURIComponent(e)}static from(e){return new l(e)}static fromComponents(e,t,n,r,o,i){const s=new l(void 0,i)
return s.protocol=e,s.host=t,s.pathname=n,s.query=null!=r?r:{},s.hash=o,s}}t.URL=l},4592:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAugmentedData=void 0
const s=i(n(8156))
t.fetchAugmentedData=async function(e,t,n,r,o){const i=n(e,t,o)
if(null==i)return await Promise.resolve({originalData:t,additionalData:null})
const a=Array.from(i),c=[]
for(const t of a){const n=r(e,t)
if(s.isNull(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}},4876:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6297),t),o(n(4592),t),o(n(2299),t),o(n(2930),t),o(n(7582),t),o(n(2390),t),o(n(8097),t)},9846:function(e,t,n){function r(e,t,n){return h.isNull(e)?null:h.asDictionary(e.attributes,t,n)}function o(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.attributes,t,n)}function i(e,t,n="coercible"){if(h.isNull(e))return null
const r=h.asString(e.attributes,t,n)
return(0,f.isNothing)(r)?null:new Date(r)}function s(e){return!h.isNull(h.asDictionary(e,"attributes"))}function a(e){const t=h.asDictionary(e,"meta")
if((0,f.isNothing)(t))throw new p.MissingFieldError(e,"meta")
return t}function c(e,t){let n
return n=Array.isArray(e)?e:[e],Array.isArray(t)?n.push(...t):n.push(t),n}var l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n)
return u(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.concatObjectPaths=t.requiredMetaAttributeAsNumber=t.requiredMetaAttributeAsString=t.requiredMeta=t.requiredAttributeAsDictionary=t.requiredAttributeAsDate=t.requiredAttributeAsString=t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=t.attributeKeyAsCustomAttributeKey=t.isNotHydrated=t.hasAttributes=t.attributeAsNumber=t.attributeAsBooleanOrFalse=t.attributeAsBoolean=t.attributeAsDate=t.metaAsString=t.attributeAsString=t.attributeAsArrayOrEmpty=t.attributeAsInterface=t.attributeAsDictionary=void 0
const f=n(2450),h=d(n(8156)),p=d(n(8747))
t.attributeAsDictionary=r,t.attributeAsInterface=function(e,t,n){return r(e,t,n)},t.attributeAsArrayOrEmpty=function(e,t){return h.isNull(e)?[]:h.asArrayOrEmpty(e.attributes,t)},t.attributeAsString=o,t.metaAsString=function(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.meta,t,n)},t.attributeAsDate=i,t.attributeAsBoolean=function(e,t,n="coercible"){return h.isNull(e)?null:h.asBoolean(e.attributes,t,n)},t.attributeAsBooleanOrFalse=function(e,t){return!h.isNull(e)&&h.asBooleanOrFalse(e.attributes,t)},t.attributeAsNumber=function(e,t,n="coercible"){return h.isNull(e)?null:h.asNumber(e.attributes,t,n)},t.hasAttributes=s,t.isNotHydrated=function(e){return!s(e)},t.attributeKeyAsCustomAttributeKey=function(e){return w[e]},t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=function(e){return"customArtwork"===e||"customIconArtwork"===e}
const w={artwork:"customArtwork",iconArtwork:"customIconArtwork",screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:"customScreenshotsByTypeForAd",customVideoPreviewsByTypeForAd:"customVideoPreviewsByTypeForAd"}
t.requiredAttributeAsString=function(e,t){const n=o(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDate=function(e,t){const n=i(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDictionary=function(e,t){const n=r(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredMeta=a,t.requiredMetaAttributeAsString=function(e,t){const n=a(e),r=h.asString(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.requiredMetaAttributeAsNumber=function(e,t){const n=a(e),r=h.asNumber(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.concatObjectPaths=c},3389:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.BagWrapper=void 0
const s=n(5542),a=i(n(1222)),c=n(8156)
t.BagWrapper=class{constructor(e){this.bag=e.required(a.bag)}get language(){return this.bag.string("language")}get mediaCountryCode(){return this.bag.string("countryCode")}get mediaHost(){return this.bag.url("apps-media-api-host")}get mediaPreviewHost(){return this.bag.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.bag.string("notification-settings-media-api-host")}get mediaApiLanguage(){const e=this.bag.string("language-tag")
return(0,s.isSome)(e)?e:this.bag.string("language")}get edgeEndpoints(){const e=this.bag.array("apps-media-api-edge-end-points")
return void 0===e?[]:(0,c.asArrayOrEmpty)((0,c.asJSONValue)(e))}get mediaEdgeSearchHost(){return this.bag.string("apps-media-api-search-edge-host")}get redirectUrlWhitelistedQueryParams(){let e=(0,c.asArrayOrEmpty)((0,c.asJSONValue)(this.bag.array("processRedirectUrl/whitelistedQueryParams")))
return(0,c.isNullOrEmpty)(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e}}},1031:function(e,t,n){function r(e){return c.isDefinedNonNull(e.attributes)}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.metricsFromMediaApiObject=t.dataCollectionFromResultsListContainer=t.isDataCollectionPartiallyHydrated=t.isDataCollectionHydrated=t.isDataHydrated=t.dataCollectionFromDataContainer=t.dataFromDataContainer=t.requiredStringID=void 0
const a=n(2450),c=s(n(8156))
n(6265),t.requiredStringID=function(e){const t=c.asString(e,"id")
if((0,a.isNothing)(t))throw new Error(`Data.id '${e.id}' is not a string.`)
return t},t.dataFromDataContainer=function(e){const t=c.asArrayOrEmpty(e,"data")
return t.length,1!==t.length?null:t[0]},t.dataCollectionFromDataContainer=function(e){return c.asArrayOrEmpty(e,"data")},t.isDataHydrated=r,t.isDataCollectionHydrated=function(e){for(let t=e.length-1;t>=0;t-=1)if(!r(e[t]))return!1
return!0},t.isDataCollectionPartiallyHydrated=function(e){for(const t of e)if(r(t))return!0
return!1},t.dataCollectionFromResultsListContainer=function(e){return c.asArrayOrEmpty(e,"results.contents")},t.metricsFromMediaApiObject=function(e){return c.asDictionary(e,"meta.metrics")}},8747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MissingFieldError=void 0
class n extends Error{constructor(e,t){super(),this.dataId=e.id,this.dataType=e.type,this.attributePath=t}}t.MissingFieldError=n},6297:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9846),t),o(n(3389),t),o(n(1031),t),o(n(3734),t),o(n(3665),t),o(n(2299),t),o(n(8156),t),o(n(4029),t),o(n(8747),t)},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2299:function(e,t,n){function r(e){switch(host.platform){case"iOS":return"iPad"===host.deviceModelFamily?"ipad":"iphone"
case"macOS":return"mac"
case"tvOS":return"appletv"
case"watchOS":return"watch"
case"xrOS":return"realityDevice"
default:return null}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.defaultPlatformForClient=void 0
const a=n(2450),c=s(n(8156))
t.defaultPlatformForClient=r,t.Request=class{constructor(e,t){if(this.contentsResourceTypes=new Set,this.ids=new Set,this.seeds=new Set,this.relationshipIncludes=new Set,this.relationshipIncludesOnly=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.shouldOmitAutomaticRelationship=!1,this.objectGraph=e,this.platform=r(),!c.isNullOrEmpty(t))if("string"==typeof t)this.href=t
else if(Array.isArray(t)){const e=new Set
for(const n of t)e.add(n.type),this.ids.add(n.id)
1===e.size?this.resourceType=e.values().next().value:e.size>1&&(this.resourceType="contents",this.contentsResourceTypes=e)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)c.isDefinedNonNullNonEmpty(t)&&this.ids.add(t)
return this}withSeeds(e){for(const t of e)c.isDefinedNonNullNonEmpty(t)&&this.seeds.add(t)
return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingOnlyRelationships(e){for(const t of e)this.relationshipIncludesOnly.add(t)
return this}includingScopedRelationships(e,t){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){null==this.metaIncludes&&(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingAssociateKeys(e,t){null==this.associateIncludes&&(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t="marketing-items"
if(e){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get("editorial-items")
null==e&&(e=new Set),e.add(t),this.scopedRelationshipIncludes.set("editorial-items",e)}else this.relationshipIncludes.add(t)
{null==this.metaIncludes&&(this.metaIncludes=new Map)
let e=this.metaIncludes.get("marketing-items")
null==e&&(e=new Set),e.add("metrics"),this.metaIncludes.set("marketing-items",e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){null==this.scopedAttributeIncludes&&(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){null==this.scopedAvailableInIncludes&&(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return null==this.scopedSparseLimit&&(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}format(e){return this.responseFormat=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return(0,a.isSome)(e)&&(this.sparseLimit=e),this}withSparseCount(e){return(0,a.isSome)(e)&&(this.sparseCount=e),this}enablingFeature(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!c.isDefinedNonNull(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}}},6265:(e,t)=>{var n
Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseMetadata=void 0,(n=t.ResponseMetadata||(t.ResponseMetadata={})).requestedUrl="_jet-internal:metricsHelpers_requestedUrl",n.timingValues="_jet-internal:metricsHelpers_timingValues",n.pageInformation="_jet-internal:metricsHelpers_pageInformation",n.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"},8156:function(e,t,n){function r(e){return i(e)?null:Array.isArray(e)?e.join("."):e}function o(e,t,n){if(null==e)return n
if(s(t))return e
let r
if("string"==typeof t){if(r=w[t],s(r)){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),w[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function i(e){return null==e}function s(e){return i(e)||0===Object.keys(e).length}function a(e){return null!=e}function c(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return s
if("string"==typeof s)return s
{const e="object"==typeof s?null:String(s)
switch(n){case"strict":h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})
break
case"coercible":i(e)&&h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})}return e}}function l(e,t,n){const s=o(e,t,null)
return s instanceof Object&&!Array.isArray(s)?s:(i(s)||h.context("asDictionary",()=>{h.unexpectedType("defaultValue","object",s,r(t))}),a(n)?n:null)}var u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n)
return d(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.asJSONData=t.asJSONValue=t.asBoolean=t.asInterface=t.asDictionary=t.asNumber=t.asDate=t.asString=t.asBooleanOrFalse=t.asArrayOrEmpty=t.isArrayDefinedNonNullAndEmpty=t.isNumber=t.isDefinedNonNullNonEmpty=t.isDefinedNonNull=t.isNullOrEmpty=t.isNull=t.traverse=t.objectPathToString=void 0
const h=f(n(4172)),p=n(2450)
t.objectPathToString=r
const w={}
t.traverse=o,t.isNull=i,t.isNullOrEmpty=s,t.isDefinedNonNull=a,t.isDefinedNonNullNonEmpty=function(e){return a(e)&&0!==Object.keys(e).length},t.isNumber=function(e){if(i(e))return!1
let t
return t="string"==typeof e?parseInt(e):e,!Number.isNaN(t)},t.isArrayDefinedNonNullAndEmpty=function(e){return a(e)&&0===e.length},t.asArrayOrEmpty=function(e,t){const n=o(e,t,null)
return Array.isArray(n)?n:(i(n)||h.context("asArrayOrEmpty",()=>{h.unexpectedType("defaultValue","array",n,r(t))}),[])},t.asBooleanOrFalse=function(e,t){const n=o(e,t,null)
return"boolean"==typeof n?n:(i(n)||h.context("asBooleanOrFalse",()=>{h.unexpectedType("defaultValue","boolean",n,r(t))}),!1)},t.asString=c,t.asDate=function(e,t,n="coercible"){const r=c(e,t,n)
return(0,p.isNothing)(r)?null:new Date(r)},t.asNumber=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s)||"number"==typeof s)return s
{const e=Number(s)
switch(n){case"strict":h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(isNaN(e))return h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return e}},t.asDictionary=l,t.asInterface=function(e,t,n){return l(e,t,n)},t.asBoolean=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return null
if("boolean"==typeof s)return s
if("string"==typeof s){if("true"===s)return!0
if("false"===s)return!1}const a=Boolean(s)
switch(n){case"strict":h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(i(a))return h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return a},t.asJSONValue=function(e){if(null==e)return null
switch(typeof e){case"string":case"number":case"boolean":return e
case"object":return Array.isArray(e),e
default:return h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","JSONValue",typeof e)}),null}},t.asJSONData=function(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","object",typeof e)}),null)}},4029:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=n(8156),s=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,a=/([^=?&]+)=?([^&]*)/g,c=["hash","query","pathname","host"]
class l{constructor(e){if(this.query={},(0,i.isNullOrEmpty)(e))return
let t=e
const n=s.exec(e)
if(null!=n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let o={remainder:t,result:void 0}
for(const e of c){if(!o.remainder)break
switch(e){case"hash":o=r(o.remainder,"#","suffix"),this.hash=o.result
break
case"query":o=r(o.remainder,"?","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.query=l.queryFromString(o.result))
break
case"pathname":o=r(o.remainder,"/","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.pathname="/"+o.result)
break
case"host":if(o.remainder){const e=r(o.remainder,"@","prefix"),t=e.result,n=e.remainder
if((0,i.isDefinedNonNullNonEmpty)(t)){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if((0,i.isNullOrEmpty)(t))return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if("query"===e)"string"==typeof t&&(t=l.queryFromString(t)),r="string"==typeof n?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if("pathname"===e){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(null==this.query&&(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&null!=this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append("pathname",e)}pathExtension(){var e
if((0,o.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return(0,i.isNullOrEmpty)(this.pathname)?[]:this.pathname.split("/").filter(e=>e.length>0)}popPathComponent(){if((0,i.isNullOrEmpty)(this.pathname))return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return(0,i.isDefinedNonNullNonEmpty)(this.protocol)&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),(0,i.isDefinedNonNullNonEmpty)(this.host)&&(e+=this.host,this.port&&(e+=":"+this.port)),(0,i.isDefinedNonNullNonEmpty)(this.pathname)&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),null!=this.query&&Object.keys(this.query).length>0&&(e+="?"+l.toQueryString(this.query)),(0,i.isDefinedNonNullNonEmpty)(this.hash)&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=a.exec(e)
for(;null!=n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=a.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r];(0,i.isDefinedNonNullNonEmpty)(o)&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new l(e)}static fromComponents(e,t,n,r,o){const i=new l
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}t.URL=l},2930:function(e,t,n){async function r(e,t,n){const r=await e.network.fetch(t)
if(!r.ok)throw Error(`Bad Status code ${r.status} for ${t.url}`)
const o=Date.now(),i=n(r.body),s=Date.now(),a=function(e,t,n){return d.isNull(e)||0===e.length?null:{...e[0],parseStartTime:t,parseEndTime:n}}(r.metrics,o,s)
return d.isDefinedNonNull(a)&&(i[p.ResponseMetadata.timingValues]=a),i[p.ResponseMetadata.requestedUrl]=t.url.toString(),i}function o(e,t){return e.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return d.isDefinedNonNull(null===(n=t.query)||void 0===n?void 0:n[e])})}async function i(e,t,n,r,a={},c=!1,l){var h,m,y,A
const T=new f.URL(n),b=o(e,T)
for(const e of b)T.removeParam(e)
const S=T.toString()
let P=a.headers
null==P&&(P={}),P.Authorization="Bearer "+r
const C={url:S,excludeIdentifierHeadersForAccount:null!==(h=a.excludeIdentifierHeadersForAccount)&&void 0!==h&&h,alwaysIncludeAuthKitHeaders:null===(m=a.alwaysIncludeAuthKitHeaders)||void 0===m||m,alwaysIncludeMMeClientInfoAndDeviceHeaders:null===(y=a.alwaysIncludeMMeClientInfoAndDeviceHeaders)||void 0===y||y,headers:P,method:a.method,body:a.requestBodyString,timeout:a.timeout},I=await e.network.fetch(C)
try{if(401===I.status||403===I.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
return t.resetToken(),await t.refreshToken().then(async r=>await i(e,t,n,r,a,!0,l))}if(404===I.status)throw s()
if(!I.ok){const e=null!==(A=I.headers["x-apple-jingle-correlation-key"])&&void 0!==A?A:"N/A",t=new w(`Bad Status code ${I.status} (correlationKey: ${e}) for ${S}, original ${n}`)
throw t.statusCode=I.status,t}const r=t=>{const r=Date.now()
let o
if(d.isNull(t.body)||""===t.body){if(204!==t.status)throw s()
o={}}else o=JSON.parse(t.body)
const i=Date.now()
if(o[p.ResponseMetadata.pageInformation]=d.asJSONData(function(e,t){const n=e.storefrontIdentifier
let r=null
if(d.isDefinedNonNullNonEmpty(n)){const e=n.split("-")
d.isDefinedNonNullNonEmpty(e)&&(r=e[0])}return{serverInstance:t.headers[v],storeFrontHeader:n,language:e.bagLanguage,storeFront:r,environmentDataCenter:t.headers[g]}}(e,t)),t.metrics.length>0){const e={...t.metrics[0],parseStartTime:r,parseEndTime:i}
o[p.ResponseMetadata.timingValues]=e}else{const e={pageURL:t.url,parseStartTime:r,parseEndTime:i}
o[p.ResponseMetadata.timingValues]=e}if(o[p.ResponseMetadata.contentMaxAge]=function(e){const t=Object.keys(e.headers).find(e=>"cache-control"===e.toLowerCase())
if(d.isNull(t)||""===t)return null
const n=e.headers[t]
if(d.isNullOrEmpty(n))return null
const r=n.match(/max-age=(\d+)/)
return d.isNull(r)||r.length<2?null:d.asNumber(r[1])}(t),Array.isArray(o.data)&&d.isArrayDefinedNonNullAndEmpty(o.data)&&!d.asBooleanOrFalse(a.allowEmptyDataResponse))throw s()
return o[p.ResponseMetadata.requestedUrl]=n,o}
return(0,u.isSome)(l)?l.measureParsing(I,r):r(I)}catch(e){if(e instanceof w)throw e
throw new Error(`Error Fetching - filtered: ${S}, original: ${n}, ${e.name}, ${e.message}`)}}function s(){const e=new w("No content")
return e.statusCode=204,e}var a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n)
return c(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.redirectParametersInUrl=t.fetchData=t.fetchPlist=t.fetchJSON=t.fetch=t.ResponseMetadata=void 0
const u=n(2450),d=l(n(8156)),f=l(n(4029)),h=l(n(8097)),p=n(6265)
Object.defineProperty(t,"ResponseMetadata",{enumerable:!0,get:function(){return p.ResponseMetadata}}),t.fetch=r,t.fetchJSON=async function(e,t){return await r(e,t,e=>(0,u.isSome)(e)?JSON.parse(e):{})},t.fetchPlist=async function(e,t){return await r(e,t,n=>{if((0,u.isSome)(n))return e.plist.parse(n)
throw new Error(`Could not fetch Plist, response body was not defined for ${t.url}`)})},t.fetchData=async function(e,t,n,r){const o=h.buildURLFromRequest(e,n).toString(),s=(Date.now(),await t.refreshToken()),a=await i(e,t,o,s,r,!1,e.fetchTimingMetricsBuilder)
return Date.now(),n.canonicalUrl&&(a[p.ResponseMetadata.requestedUrl]=n.canonicalUrl),a},t.redirectParametersInUrl=o
class w extends Error{}t.NetworkError=w
const v="x-apple-application-instance",g="x-apple-application-site"},7582:function(e,t,n){function r(e,t){const n=d.attributeAsDictionary(e,"platformAttributes")
return u.traverse(n,t)}function o(e,t,n){const o=r(e,t)
return u.isNull(o)?null:u.asDictionary(o,n)}function i(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asString(i,n,o)}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredPlatformAttributeAsDictionary=t.requiredPlatformAttributeAsString=t.platformAttributeAsNumber=t.platformAttributeAsBooleanOrFalse=t.platformAttributeAsBoolean=t.platformAttributeAsString=t.platformAttributeAsArrayOrEmpty=t.platformAttributeAsDictionary=t.hasPlatformAttribute=void 0
const l=n(2450),u=c(n(8156)),d=c(n(9846)),f=c(n(8747))
t.hasPlatformAttribute=function(e,t){const n=r(e,t)
return u.isDefinedNonNullNonEmpty(n)},t.platformAttributeAsDictionary=o,t.platformAttributeAsArrayOrEmpty=function(e,t,n){const o=r(e,t)
return u.isNull(o)?[]:u.asArrayOrEmpty(o,n)},t.platformAttributeAsString=i,t.platformAttributeAsBoolean=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asBoolean(i,n,o)},t.platformAttributeAsBooleanOrFalse=function(e,t,n){const o=r(e,t)
return!u.isNull(o)&&u.asBooleanOrFalse(o,n)},t.platformAttributeAsNumber=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asNumber(i,n,o)},t.requiredPlatformAttributeAsString=function(e,t,n){const r=i(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r},t.requiredPlatformAttributeAsDictionary=function(e,t,n){const r=o(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r}},2390:function(e,t,n){function r(e,t){return l.asInterface(e.relationships,t)}function o(e,t){const n=l.asArrayOrEmpty(e.relationships,[t,"data"])
return 0===n.length?null:(n.length,n[0])}function i(e,t){return l.asArrayOrEmpty(e.relationships,[t,"data"])}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredRelationshipCollectionNonEmpty=t.requiredRelationshipData=t.relationshipViewsCollection=t.relationshipCollection=t.relationshipData=t.relationship=t.hasRelationship=void 0
const l=c(n(8156)),u=n(2450),d=c(n(8747))
t.hasRelationship=function(e,t,n=!0){const o=r(e,t)
return!((0,u.isNothing)(o)||n&&0===o.data.length)},t.relationship=r,t.relationshipData=o,t.relationshipCollection=i,t.relationshipViewsCollection=function(e,t){return l.asArrayOrEmpty(e.views,[t,"data"])},t.requiredRelationshipData=function(e,t){const n=o(e,t)
if((0,u.isNothing)(n))throw new d.MissingFieldError(e,["relationships",t,"data"])
return n},t.requiredRelationshipCollectionNonEmpty=function(e,t){const n=i(e,t)
if(0===n.length)throw new d.MissingFieldError(e,["relationships",t,"data"])
return n}},8097:function(e,t,n){function r(e){switch(e){case"apps":case"app-events":case"activities":case"arcade-apps":case"app-bundles":case"charts":case"contents":case"developers":case"eula":case"in-apps":case"multiple-system-operators":case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"chart-list":default:return"catalog"
case"games/recommendations":return"games/recommendations"
case"categories":case"editorial-items":case"editorial-item-groups":case"editorial-elements":case"groupings":case"multiplex":case"multirooms":case"rooms":case"today":case"collections":return"editorial"
case"ratings":return"ratings"
case"personalization-data":case"reviews":return"me"
case"upsellMarketingItem":case"landing":case"engagement-data":return"engagement"
case"landing:new-protocol":case"recommendations":case"personal-recommendations":return"recommendations"}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.buildURLFromRequest=void 0
const a=n(2450),c=s(n(8156)),l=s(n(4029)),u=s(n(9846))
t.buildURLFromRequest=function(e,t){var n,o
const i=c.isDefinedNonNullNonEmpty(t.href)?t.href:function(e,t){switch(t){case"games/search":return`/v1/games/${r(t)}/${e.mediaCountryCode}`
case"personalization-data":case"reviews":return`/v1/${r(t)}/`
default:return`/v1/${r(t)}/${e.mediaCountryCode}/`}}(e,t.resourceType),s=new l.URL(i)
if(c.isDefinedNonNullNonEmpty(t.resourceType))for(const e of function(e,t){switch(e){case"eula":return void 0===t?[e]:[e,t]
case"landing:new-protocol":case"recommendations":case"searchLanding:see-all":case"search-hints":case"games/recommendations":return[]
case"landing":return void 0===t?["search",e]:["search",e,t]
case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"game-highlights":return["apps"]
case"reviews":return["reviews","apps"]
case"multiplex":return["multiplex"]
case"upsellMarketingItem":return["upsell","marketing-items"]
case"trending-contents":return["search",e]
case"player-highlights":return["players"]
case"search-suggestions":case"games/search":case"games/search-suggestions":case"search-groups":return["search"]
case"chart-list":return["charts"]
default:return[e]}}(t.resourceType,t.targetResourceType))s.append("pathname",e)
if(t.ids.size>1||(0,a.isSome)(t.useIdsAsQueryParam))s.param("ids",Array.from(t.ids).join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
s.append("pathname",encodeURIComponent(e))}if(t.seeds.size>0&&s.param("seeds",Array.from(t.seeds).join(",")),void 0!==t.resourceType){const e=function(e){switch(e){case"user-reviews":return"reviews"
case"customers-also-bought-apps-with-download-intent":return"view/customers-also-bought-apps-with-download-intent"
case"collections":default:return null
case"searchLanding:see-all":return"view/see-all"
case"search-hints":return"search/suggestions"
case"game-highlights":case"player-highlights":return"view/highlights"
case"games/search":case"search-groups":return"groups"
case"games/search-suggestions":case"search-suggestions":return"suggestions"}}(t.resourceType)
c.isDefinedNonNullNonEmpty(e)&&s.append("pathname",e)}if(s.param("platform",null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&s.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t.push("customArtwork"),t}(e)),e.sort(),s.param("extend",e.join(","))}if(c.isDefinedNonNull(t.ageRestriction)&&s.param("restrict[ageRestriction]",t.ageRestriction.toString()),c.isDefinedNonNull(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())s.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludesOnly.size>0?s.param("includeOnly",Array.from(t.relationshipIncludesOnly).sort().join(",")):t.relationshipIncludes.size>0&&s.param("include",Array.from(t.relationshipIncludes).sort().join(",")),t.shouldOmitAutomaticRelationship&&s.param("omit[resource]","autos"),c.isDefinedNonNull(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())s.param(`include[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())s.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())s.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())s.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNullNonEmpty(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),s.param("fields",e.join(","))}if(c.isDefinedNonNull(t.limit)&&t.limit>0&&s.param("limit",`${t.limit}`),c.isDefinedNonNull(t.sparseLimit)&&s.param("sparseLimit",`${t.sparseLimit}`),c.isDefinedNonNull(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())s.param(`sparseLimit[${e}]`,String(n))
c.isDefinedNonNull(t.sparseCount)&&s.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
s.param(`limit[${e}]`,`${n}`)}c.isDefinedNonNullNonEmpty(t.additionalQuery)&&s.append("query",t.additionalQuery),c.isDefinedNonNullNonEmpty(t.searchTerm)&&(((0,a.isNothing)(t.resourceType)||"search-hints"!==t.resourceType)&&(s.append("pathname","search"),s.param("bubble[search]",t.searchTypes.join(","))),s.param("term",t.searchTerm)),c.isDefinedNonNullNonEmpty(t.enabledFeatures)&&s.param("with",t.enabledFeatures.join(",")),c.isDefinedNonNullNonEmpty(t.context)&&s.param("contexts",t.context),c.isDefinedNonNullNonEmpty(t.filterType)&&c.isDefinedNonNullNonEmpty(t.filterValue)&&s.param(`filter[${t.filterType}]`,t.filterValue)
const f=e.mediaApiLanguage
return c.isDefinedNonNull(f)&&c.isNull(t.additionalQuery.l)&&s.param("l",f),c.isDefinedNonNullNonEmpty(t.responseFormat)&&s.param("format[resources]",t.responseFormat),s.host=null!==(o=function(e,t,n){var r
const o=null!==(r=t.pathname)&&void 0!==r?r:""
let i=null
return i=n.isStorePreviewRequest?e.mediaPreviewHost:n.isMediaRealmRequest?e.mediaRealmHost:o.includes("search/landing")?-1!==e.edgeEndpoints.indexOf("landing")?e.mediaEdgeHost:e.mediaHost:e.edgeEndpoints.map(e=>o.includes(e)).reduce(d,!1)?o.includes("search")&&!o.includes("view/see-all")?e.mediaEdgeSearchHost:e.mediaEdgeHost:e.mediaHost,c.isNull(i)&&(i="api.apps.apple.com"),i}(e,s,t))&&void 0!==o?o:void 0,s.protocol="https",s}
const d=(e,t)=>e||t}},n={}
e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function t(e){return r(e)?void 0:Array.isArray(e)?e.join("."):e}function n(e,t,n){if(null==e)return n
if(!t)return e
let r
if(typeof t===$W){if(r=wz[t],!r){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),wz[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function r(e){return null==e}function o(e){return r(e)||0===Object.keys(e).length}function i(e){return typeof e!==gG&&null!==e}function s(e){return!(0,Am.isNothing)(e)&&(typeof e===$W||Array.isArray(e)?e.length>0:0!==Object.keys(e).length)}function a(e){if(r(e))return!1
let t
return t=typeof e===$W?parseInt(e):e,!Number.isNaN(t)}function c(e){return!(0,Am.isNothing)(e)&&typeof e===$W}function l(e,t){var n
return null!==(n=w(e,t,[]))&&void 0!==n?n:[]}function u(e,t){return d(e,!1,t)}function d(e,o,i){const s=n(e,i,null)
return typeof s===SN?s:(r(s)||ym.context("asBooleanWithDefault",()=>{ym.unexpectedType(Cq,SN,s,t(i))}),o)}function f(e,o,i=Rq){const s=n(e,o,void 0)
if(!r(s)){if(typeof s===$W)return s
{const e=typeof s===vH?void 0:String(s)
switch(i){case EL:ym.context(Hk,()=>{ym.unexpectedType(VU,$W,s,t(o))})
break
case Rq:r(e)&&ym.context(Hk,()=>{ym.unexpectedType(VU,$W,s,t(o))})}return e}}}function h(e,o,i=Rq){const s=n(e,o,void 0)
if(!r(s)){if(typeof s===qj)return s
{const e=Number(s)
switch(i){case EL:ym.context(qk,()=>{ym.unexpectedType(VU,qj,s,t(o))})
break
case Rq:if(isNaN(e))return void ym.context(qk,()=>{ym.unexpectedType(VU,qj,s,t(o))})}return e}}}function p(e,o,s){const a=n(e,o,void 0)
return a instanceof Object&&!Array.isArray(a)?a:(r(a)||ym.context("asDictionary",()=>{ym.unexpectedType(Cq,vH,a,t(o))}),i(s)?s:void 0)}function w(e,o,s){const a=n(e,o,void 0)
return Array.isArray(a)?a:(r(a)||ym.context("asArray",()=>{ym.unexpectedType(Cq,"array",a,t(o))}),i(s)?s:void 0)}function v(e,t,n){return p(e,t,n)}function g(e,o,i=Rq){const s=n(e,o,void 0)
if(r(s))return
if(typeof s===SN)return s
if(typeof s===$W){if(s===cW)return!0
if(s===IN)return!1}const a=Boolean(s)
switch(i){case EL:ym.context(Wk,()=>{ym.unexpectedType(VU,qj,s,t(o))})
break
case Rq:if(r(a))return void ym.context(Wk,()=>{ym.unexpectedType(VU,qj,s,t(o))})}return a}function m(e){if(null!=e)switch(typeof e){case $W:case qj:case SN:return e
case vH:return Array.isArray(e),e
default:return void ym.context("asJSONValue",()=>{ym.unexpectedType(Cq,"JSONValue",typeof e)})}}function y(e){if(null!=e)return e instanceof Object&&!Array.isArray(e)?e:void ym.context("asJSONData",()=>{ym.unexpectedType(Cq,vH,typeof e)})}function A(e){return(0,mm.isSome)(e)&&typeof e.$kind===$W}function T(e){return A(e)&&function(e){return(0,mm.isSome)(bz[e])}(e[hz])&&(0,mm.isSome)(e.actionClass)&&function(e){return(0,mm.isSome)(yz[e])}(e.actionClass)}function b(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
n===Qk?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}function S(e){if(null==e)return e
const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e),t}function P(e,t){return e instanceof t}function C(e){return!(!(0,Am.isSome)(e.protocol)||-1===iY.indexOf(e.protocol))}function I(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t+1}function k(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t?e.substring(t+1,n):e}function O(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1))
return n>=0&&r>n?e.substring(n,r):e}function E(e){return{success:!0,value:e,error:null,[cY]:!0}}function D(e){return{success:!1,value:null,error:e instanceof Error?e:new Error(String(e)),[cY]:!0}}async function R(e){return await M(e)}async function _(e){return await e}async function L(e){return await Promise.all(e.map(R))}async function M(e){try{const t="function"==typeof e?e():e
return E(await t)}catch(e){return D(e)}}function F(e){throw new Error(`This method should never be called with value: ${e}`)}function $(e,t,r){if(e)return ym.context(t,()=>{let o=e[ZY],i=null
return o?(i=n(o,t),i||(i=x(o,t,r))):(o={},e[ZY]=o,i=x(o,t,r)),i})}function x(e,t,n){const r=n()
return e[t]=r,r}function N(e){return v(function(e){return l(e,"meta.associations.editorial-cards.data")}(e)[0])}function B(e,t,n){if(!(0,Am.isNothing)(e))return p(e.attributes,t,n)}function U(e,t){return r(e)?[]:w(e.attributes,t)}function G(e,t){var n
return null!==(n=U(e,t))&&void 0!==n?n:[]}function j(e,t,n=Rq){if(!r(e))return f(e.attributes,t,n)}function V(e,t,n=Rq){if(!r(e))return g(e.attributes,t,n)}function H(e,t){return!r(e)&&u(e.attributes,t)}function q(e,t,n=Rq){if(!r(e))return h(e.attributes,t,n)}function W(e){return!r(p(e,AN))}function z(e){return!W(e)}function Y(e){return QY[e]}function J(e){return e===I$||e===DL}function K(e){if(e.client.isCompanionVisionApp)return zH
switch(e.client.deviceType){case ZW:return OW
case HW:return IW
case"tv":return HU
case iz:return iz
case oz:return oz
case zW:return zH
case bH:return bH
default:return null}}function Z(e){return e.client.isPhone?2:1}function Q(e){switch(e.client.deviceType){case ZW:return 4
case HW:return 5
case"tv":return 6
case iz:return 5
case oz:return 10
default:return null}}function X(e){switch(e.client.deviceType){case ZW:return 9
case HW:return 12
case"tv":case iz:return 15
case oz:return 3
case bH:return 15
default:return null}}function ee(e){switch(e.host.clientIdentifier){case IY:case kY:case DY:return[]
default:{const t=K(e)
return function(e,t){const n=new Set
if(n.add(OW),n.add(IW),n.add(HU),n.add(iz),n.add(oz),e.bag.enableVisionPlatform&&n.add(zH),(0,Am.isSome)(t))for(const e of t)n.delete(e)
return Array.from(n)}(e,(0,Am.isSome)(t)?new Set([t]):void 0)}}}function te(e){switch(e.client.deviceType){case ZW:return 6
case HW:return 10
case iz:return 12
case zW:return 10
default:return 8}}function ne(e){let t=null
return e.host.clientIdentifier===rJ?t=eW:e.host.clientIdentifier===nJ&&(t=oz),t}function re(e,t){if(o(t))return null
const n=l(t,`meta.associations.${e}.data`)
return(0,Am.isNothing)(n)?null:[...n]}function oe(e,t){return n(B(e,"platformAttributes"),null!=t?t:void 0)}function ie(e,t){return s(oe(e,t))}function se(e,t,n){const o=oe(e,t)
if(!r(o))return p(o,n)}function ae(e,t,n){const o=oe(e,t)
return r(o)?[]:l(o,n)}function ce(e,t,n,r=Rq){const o=oe(e,t)
if(!(0,Am.isNothing)(o))return f(o,n,r)}function le(e,t,n,o=Rq){const i=oe(e,t)
if(!r(i))return g(i,n,o)}function ue(e,t,n){const o=oe(e,t)
return!r(o)&&u(o,n)}function de(e,t,n=!0){const r=fe(e,t)
return!!r&&!(!r.data||n&&0===r.data.length)}function fe(e,t){if(i(e))return v(e.relationships,t)}function he(e,t){return v(null==e?void 0:e.views,t)}function pe(e,t,n){const r=l(null==t?void 0:t.relationships,[n,RV])
if(0!==r.length)return r.length>1&&e.console.warn(`there was an array of relationships when only the first was asked for in relationship ${n}`),r[0]}function we(e,t,n=!1){return!de(e,t,!1)&&n?null:l(null==e?void 0:e.relationships,[t,RV])}function ve(e,t){return l(null==e?void 0:e.views,[t,RV])}function ge(e,t){var n,o,a
const c=t.href&&t.href.length>0?t.href:function(e,t,n,r){switch(n){case AL:case _W:case gN:return`/v1/${me(n)}/`
default:const o=(0,Am.isSome)(r)&&r.length>0?r:e.bag.mediaCountryCode,i=`/v1/${me(n)}/${o}`
return t?i:`${i}/`}}(e,t.isMixedMediaRequest,t.resourceType,t.countryCodeOverride),l=new oY(c)
if(s(t.resourceType))for(const e of function(e,t){switch(e){case xG:return void 0===t?[e]:[e,t]
case F_:return[]
case _B:return void 0===t?[gW,e]:[gW,e,t]
case P$:return[az]
case _W:return[_W,az]
case b$:return[b$]
case vV:return[sT,pH]
case Uk:return[gW,e]
case S$:return[az]
case C$:case p$:return[]
case gN:return[az]
default:return[e]}}(t.resourceType,t.targetResourceType))l.append(aH,e)
if(t.isMixedMediaRequest)for(const[e,n]of t.idsByResourceType.entries())l.param(`ids[${e}]`,Array.from(n).sort().join(","))
else if(t.ids.size>1||t.useIdsAsQueryParam)l.param("ids",Array.from(t.ids).sort().join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
l.append(aH,e)}if(void 0!==t.resourceType){const e=function(e){switch(e){case P$:return _W
case S$:return"view/customers-also-bought-apps-with-download-intent"
case RH:return sz
case C$:return Jk
case p$:return"search/suggestions"
default:return null}}(t.resourceType)
s(e)&&l.append(aH,e)}if(l.param(GH,null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&l.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e,t){const n=t.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return n.push(I$),t.includes(Tq)&&n.push(Tq),n.push(Mx),n}(0,e)),e.sort(),l.param(gk,e.join(","))}if(i(t.ageRestriction)&&e.bag.enableAgeRatingFilter&&l.param("restrict[ageRestriction]",t.ageRestriction.toString()),t.includeAppBinaryTraitsAttribute&&t.includingScopedAttributes(az,[ZT]),i(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())l.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludes.size>0&&l.param("include",Array.from(t.relationshipIncludes).sort().join(",")),i(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())l.param(`include[${e}]`,Array.from(n).sort().join(","))
if(i(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())l.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(i(a=t.viewsIncludes)&&a.size>0&&l.param("views",Array.from(t.viewsIncludes).sort().join(",")),i(t.kindIncludes))for(const[e,n]of t.kindIncludes.entries())l.param(`kinds[${e}]`,Array.from(n).sort().join(","))
if(i(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())l.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(i(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())l.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(s(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),l.param(N$,e.join(","))}if(i(t.limit)&&t.limit>0&&l.param("limit",`${t.limit}`),i(t.sparseLimit)&&l.param("sparseLimit",`${t.sparseLimit}`),i(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())l.param(`sparseLimit[${e}]`,String(n))
i(t.sparseCount)&&l.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
l.param(`limit[${e}]`,`${n}`)}s(t.additionalQuery)&&l.append(nV,t.additionalQuery),s(t.searchTerm)&&(((0,Am.isNothing)(t.resourceType)||t.resourceType!==p$)&&(l.append(aH,gW),l.param("bubble[search]",t.searchTypes.join(","))),l.param(jj,t.searchTerm)),s(t.enabledFeatures)&&l.param(fM,t.enabledFeatures.join(",")),s(t.context)&&l.param(Oj,t.context),s(t.filterType)&&s(t.filterValue)&&l.param(`filter[${t.filterType}]`,t.filterValue)
const u=e.bag.mediaApiLanguage
return i(u)&&r(t.additionalQuery.l)&&l.param("l",u),l.host=null!==(o=function(e,t,n){var o
const i=null!==(o=t.pathname)&&void 0!==o?o:""
let s=null
return s=n.isStorePreviewRequest?e.bag.mediaPreviewHost:n.isMediaRealmRequest?e.bag.mediaRealmHost:i.includes("search/landing")?-1!==e.bag.edgeEndpoints.indexOf(_B)?e.bag.mediaEdgeHost(e):e.bag.mediaHost:n.resourceType===gN&&(0,Am.isSome)(e.bag.appDistributionMediaAPIHost)?e.bag.appDistributionMediaAPIHost:n.isMixedMediaRequest&&e.bag.mediaAPICatalogMixedShouldUseEdge?e.bag.mediaEdgeHost(e):e.bag.edgeEndpoints.map(e=>i.includes(e)).reduce(lJ,!1)?i.includes(gW)&&!i.includes(Jk)?e.bag.mediaEdgeSearchHost:e.bag.mediaEdgeHost(e):e.bag.mediaHost,r(s)&&(s="api.apps.apple.com"),s}(e,l,t))&&void 0!==o?o:void 0,l.protocol=PL,l}function me(e){switch(e){case az:case tz:case"app-knowledge-items":case VH:case JW:case JN:case sz:case rH:case xG:case jq:case TF:case P$:case S$:return zk
case KB:case Wq:case YW:case SV:case ax:case SH:case b$:case fN:case xB:case UW:case RH:return PO
case RL:return RL
case AL:case _W:return"me"
case vV:case _B:return Yk
case F_:case hM:return oq
case wk:return Yk
case gN:return"listing"
default:return zk}}function ye(e){if((0,Am.isNothing)(e)||""===e)return null
const t=uJ.exec(e)
return(0,Am.isNothing)(t)||4!==t.length&&5!==t.length?null:{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,alpha:(0,Am.isSome)(t[4])?parseInt(t[4],16)/255:void 0,type:PH}}function Ae(e,t,n,r){return{red:e,green:t,blue:n,alpha:r,type:PH}}function Te(e){return.2126*e.red+.7152*e.green+.0722*e.blue}function be(e,t=84){if((0,Am.isNothing)(e))return!1
switch(e.type){case PH:return 100*Te(e)<t
case PB:return e.name===SE
default:return!1}}function Se(e){return{name:e,type:PB}}function Pe(e,t){return{lightColor:e,darkColor:t,type:O$}}function Ce(e,t){return!(0,Am.isNothing)(e)&&!(0,Am.isNothing)(t)&&(e.type===PH&&t.type===PH?e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha:e.type===PB&&t.type===PB?e.name===t.name:e.type===O$&&t.type===O$&&Ce(e.lightColor,t.lightColor)&&Ce(e.darkColor,t.darkColor))}function Ie(e,t){if((0,Am.isNothing)(e))return!1
const n=function(e){return typeof e===vH&&!(0,Am.isNothing)(e)&&(IH in e&&e.type===sO)}(e)?e:ke(e)
return function(e){if(typeof e!==vH||(0,Am.isNothing)(e))return!1
const t=e
return"colorHex"in t&&typeof t.colorHex===$W&&"maxSaturation"in t&&typeof t.maxSaturation===qj&&"maxBrightness"in t&&typeof t.maxBrightness===qj}(t)?n.saturation<=t.maxSaturation||n.brightness<=t.maxBrightness:n.hue>=t.minHue&&n.hue<=t.maxHue}function ke(e){const t=e.red,n=e.green,r=e.blue,o=Math.max(t,n,r),i=o-Math.min(t,n,r),s=100*o,a=0===o?0:i/o*100
let c=0
if(0!==i)switch(o){case t:c=60*((n-r)/i+(n<r?6:0))
break
case n:c=60*((r-t)/i+2)
break
case r:c=60*((t-n)/i+4)}return c=(c+360)%360,{type:sO,hue:c,saturation:a,brightness:s}}function Oe(e){if(!r(e)&&""!==e)return-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/"))}function Ee(e){if(r(e))return
const t=function(e){if(!r(e))return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e)
return r(t)?void 0:t.getTime()}function De(e){if(r(e))return
const t=new Date(e)
return t.setHours(0,0,0,0),t}function Re(e){if(!r(e))return _e(e)}function _e(e){const t=new Date(e.getTime())
return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function Le(e,t){if(!r(e)&&!r(t))return Math.ceil((t.getTime()-_e(e).getTime())/36e5)}function Me(e,t,n,r=!1){return!(0,mm.isNothing)(t)&&$(t,`dataHasDeviceFamily.${n}`,()=>!(!t||!n)&&-1!==xe(e,t,r).indexOf(n))}function Fe(e,t,n,r=!1){var o
return null!==(o=Me(e,t,n,r))&&void 0!==o&&o&&1===xe(e,t,r).length}function $e(e,t,n,r=!1){const o=new Set(xe(e,t,r))
return n.length===o.size&&n.every(e=>o.has(e))}function xe(e,t,n=!1){const r=G(t,Kj)
if(0===r.length&&n){const r=we(t,az)
if((0,mm.isSome)(r))for(const t of r){const r=xe(e,t,n)
if(s(r))return r}}return r}function Ne(e,t){var n
const r=e.optional(SJ.metatype)
return null===(n=null==r?void 0:r.currentTreatmentForExperiment(t))||void 0===n?void 0:n.identifier}function Be(e){return Ne(e,Cm.ProductPagePreloading)===PJ}function Ue(e){return e.bag.enableProductPageVariants}function Ge(e,t,r){if(void 0===r&&(r=function(e){const t=function(e){return Ne(e,Cm.ProductPageVariants)}(e)
return t}(e)),o(t.id))return
const i={adamID:t.id,productPageId:CJ,treatmentPageIdMap:{[CJ]:CJ},experimentIdMap:{},experimentLocaleMap:{}}
return o(n(t,cH,null))||(function(e,t,r){const i=n(r,"meta.cppData",null)
if(o(i))return
const a=f(i,kG)
s(a)&&(t.productPageId=a)}(0,i,t),function(e,t,r,i,a){const c=n(a,"meta.experimentData",null)
if(o(c))return
const l=n(c,r,null)
if(o(l))return
const u=f(l,JR),d=f(l,eC)
let h=null
const p=n(l,"trafficAllocation",null)
h=s(p)?function(e,t,n){if(void 0===n||o(n))return CJ
for(const[e,r]of Object.entries(t))if(s(r)&&-1!==r.indexOf(n))return e
return CJ}(0,p,i):function(e,t,n){const r=Ke(e,t,`customAttributes.${n}`)
if(o(r))return CJ
const i=Object.keys(r)[0]
return o(i)?CJ:i}(e,a,r),s(h)&&s(u)&&(t.treatmentPageIdMap[r]=h,t.experimentIdMap[r]=u,s(d)&&(t.experimentLocaleMap[r]=d))}(e,i,CJ,r,t)),i}function je(e,t,r,s,a){if(o(t))return
let c
if((0,Am.isSome)(r)&&r.productPageId!==CJ){const e=r.treatmentPageIdMap[CJ]
c=a?[`${r.productPageId}.${CJ}.${s}`,`${CJ}.${e}.${s}`,`${CJ}.${CJ}.${s}`]:[`${r.productPageId}.${CJ}.${s}`,`${CJ}.${CJ}.${s}`]}else{const e=null==r?void 0:r.treatmentPageIdMap[CJ]
c=[`${CJ}.${e}.${s}`,`${CJ}.${CJ}.${s}`]}for(const e of c){const r=n(t,e)
if(i(r))return r}}function Ve(e){if(!(0,Am.isNothing)(e)&&e.productPageId!==CJ)return e.productPageId}function He(e,t){return Ve(Ge(e,t))}function qe(e,t){const n=Ke(e,t,qE)
if(!(0,Am.isNothing)(n)&&!o(n))return Object.keys(n).filter(e=>e!==CJ)}function We(e){const t={}
Ye(e,$F)&&(t[tC]=e.productPageId)
const n=e.treatmentPageIdMap[CJ],r=e.experimentIdMap[CJ],o=e.experimentLocaleMap[CJ]
return Ye(e,hF)&&(t.pageVariantId=n,t.pageExperimentId=r,t.pageExperimentLocale=o),t}function ze(e){const t={}
Ye(e,$F)&&(t[tC]=e.productPageId)
const n=e.treatmentPageIdMap[CJ],r=e.experimentIdMap[CJ],o=e.experimentLocaleMap[CJ]
return Ye(e,hF)&&(t.variantId=n,t[JR]=r,t[eC]=o),t}function Ye(e,t){if(r(e))return!1
switch(t){case $F:return s(e.productPageId)&&e.productPageId!==CJ
case hF:return s(e.experimentIdMap)
default:F(t)}}function Je(e,t,n){for(const r of n){const n=He(e,r)
i(n)&&t.addingQuery(`ppid[apps:${r.id}]`,`${n}`)}}function Ke(e,t,n,r,o){if(r||(r=tt(e,t)),(0,Am.isNothing)(r))return
let i=se(t,r,n)
return i||(i=B(t,n,o)),i}function Ze(e,t,n,r){const i=null!=r?r:tt(e,t)
if((0,Am.isNothing)(i))return[]
let s=ae(t,i,n)
return o(s)&&(s=G(t,n)),s}function Qe(e,t,n,r,o=Rq){let i
const s=null!=r?r:tt(e,t)
return(0,Am.isSome)(s)&&(i=ce(t,s,n,o)),i||(i=j(t,n,o)),i}function Xe(e,t,n,o){if(o||(o=tt(e,t)),(0,Am.isNothing)(o))return!1
let i=le(t,o,n)
return r(i)&&(i=H(t,n)),i}function et(e,t,n,o=Rq){const i=tt(e,t)
if((0,Am.isNothing)(i))return
let s=function(e,t,n,o=Rq){const i=oe(e,t)
if(!r(i))return h(i,n,o)}(t,i,n,o)
return r(s)&&(s=q(t,n)),s}function tt(e,t,n){const o="bestAttributePlatformFromData",i=(0,Am.isSome)(n)?`${o}.${n}`:o
if(!(0,Am.isNothing)(t))return $(t,i,()=>{const o=$e(e,t,[OW,IW,ZN],!0),i=Fe(e,t,Vj),s=Fe(e,t,iz),a=Fe(e,t,oz),c=Fe(e,t,zH)
let l
if(i?l=WV:s?l=rq:o?l=AW:a?l=oz:c&&(l=ZH),!r(l))return l
const u=function(e,t){const n=nt(e)
if((0,Am.isNothing)(n))return[]
switch(n){case AW:return t===_Y||t===RY?[ZH,AW,WV,rq]:[AW,WV,rq,ZH]
case rq:return[rq,AW,WV,ZH]
case WV:return[WV,AW,rq,ZH]
case oz:return[AW,oz,rq,ZH]
case ZH:return[ZH,AW,WV,rq]
default:return[n]}}(e,n)
for(const e of u)if(ie(t,e))return e
return nt(e)})}function nt(e){var t
if(null===(t=e.activeIntent)||void 0===t?void 0:t.attributePlatform)return e.activeIntent.attributePlatform
switch(e.client.deviceType){case ZW:case HW:return AW
case"tv":return WV
case iz:return rq
case oz:return oz
case zW:return ZH
default:return}}function rt(e,t,n,r,o){const i=Y(r)
if((0,Am.isNothing)(i))return
const a=je(0,Ke(e,t,qE,o),n,i,J(i))
return s(a)?p(a):Ke(e,t,r,o)}function ot(e,t,n,r,o){const i=Y(r)
if((0,Am.isNothing)(i))return
const a=je(0,Ke(e,t,qE,o),n,i,J(i))
return s(a)?f(a):Qe(e,t,r)}function it(e){return(0,Am.isSome)(IJ)||(IJ={bundleIdFromData:t=>Qe(e,t,hW),isSystemAppFromData:e=>H(e,HG),isUnsupportedDeletableSystemAppFromData:e=>!1,adamIdFromSystemBundleId(e){}}),IJ}function st(e,t,n=Im.All){let o=!1
return n&Im.ThirtyTwoBit&&(o=o||function(e,t){return Xe(e,t,TA)||Xe(e,t,bA)}(e,t)),n&Im.UnsupportedSystemDeletableApps&&(o=o||function(e,t){return $(t,"shouldFilterDeletableSystemApp",()=>{const n=it(e)
if(!n.isSystemAppFromData(t))return!1
const r=n.bundleIdFromData(t),o=e.host.deviceModel,s=o.startsWith(CA),a=o.startsWith(IA)
let c
switch(c=!!fh(e,"12.3")||e.bag.isTVAppEnabled,r){case"com.apple.Bridge":case"com.apple.Passbook":return!s
case"com.apple.Photo-Booth":return!a
case"com.apple.tv":return!c
case"com.apple.videos":return c
case"com.apple.iCloudDriveApp":return!0
case"com.apple.facetime":case"com.apple.mobilephone":return!ct(e,"any-telephony")||!ct(e,"venice")
case"com.apple.Fitness":if(a||s){let t=!1
return i(e.user.isFitnessAppInstallationAllowed)&&(t=e.user.isFitnessAppInstallationAllowed),!t}return!0
case"com.apple.measure":return!ct(e,"arkit")
case"com.apple.Jellyfish":return!ct(e,"front-depth-camera")
case SA:case PA:return!0
case"com.apple.NanoHeartRhythm":return!e.client.isElectrocardiogramInstallationAllowed
case kA:return!ct(e,"magnetometer")
case"com.apple.NanoOxygenSaturation.watchkitapp":return!e.client.isScandiumInstallationAllowed
case OA:case"com.apple.NanoRadio":return!0
case EA:return!e.client.isCharonSupported
case DA:return!e.client.isMandrakeSupported
case"com.apple.GenerativePlaygroundApp":return!ct(e,"generative-model-systems")
case SO:const t=a&&e.clientCapabilities.isEnabled(hJ)
return!(s||t)}return!1})}(e,t)),n&Im.UnsupportedWatchAppOnWatchClient&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const n=Xe(e,t,XH),r=t.type===JW
return e.host.clientIdentifier===nJ&&!n&&!r})}(e,t)),n&Im.DisabledMerchandisableIAPs&&(o=o||function(e,t){return t.type===jq&&!s(p(t,MN))&&!s(p(t,ZL))&&!H(t,"isMerchandisedEnabled")}(0,t)),n&Im.LegacyApps&&(o=o||function(e,t){return $(t,"shouldFilterLegacyApps",()=>{switch(Qe(e,t,hW)){case"com.apple.mobileme.fmip1":case SA:return!0}return!1})}(e,t)),n&Im.LegacyProductionMacOSInstaller&&(o=o||function(e,t){return $(t,"isLegacyMacOSInstaller",()=>(Qe(e,t,hW),!1))}(e,t)),n&Im.UnsupportedPlatform&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatform",()=>!bh(e,t))}(e,t)),n&Im.UnsupportedPlatformForMacCharts&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatformForCharts",()=>{if(t.type!==az&&t.type!==JW)return!1
const n=kf(e,t),r=Mf(0,t,!0)
return!Bf(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&Im.UnsupportedPreorders&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!H(t,uW))return!1
if(t.type!==az)return!1
const n=kf(e,t),r=Mf(0,t,e.appleSilicon.isSupportEnabled)
return!jf(0,n,e.client.deviceType,r,!1)})}(e,t)),n&Im.MinimumOSRequirement&&(o=o||at(e,t)),n&Im.SADWatchApps&&(o=o||function(e,t){const n=H(t,HG),r=!Xe(e,t,WO)&&Xe(e,t,Tj)
return n&&r}(e,t)),n&Im.MinimumCompanionOSRequirement&&(o=o||function(e,t){return e.client.deviceType===oz&&(!Xe(e,t,Tj)&&!Xe(e,t,qO)&&!function(e,t){return!(!r(t)&&0!==t.length)||e.client.isPairedSystemVersionAtLeast(t)}(e,ce(t,tt(e,t),yq)))}(e,t)),n&Im.MacOSCompatibleIOSBinary&&(o=o||function(e,t){return e.client.deviceType===iz&&(Xe(e,t,x$,nt(e))&&!e.appleSilicon.isSupportEnabled)}(e,t)),n&Im.MacOSRosetta&&(o=o||function(e,t){const n=kf(e,t)
return!(e.client.deviceType!==iz||!n.includes(iz))&&!Gf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable)}(e,t)),n&Im.VisionOSCompatibility&&(o=o||function(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=ue(t,AW,zO)
return!(kf(e,t).indexOf(zW)>-1||n)}(e,t)),n&Im.SADMinimumOSRequirement&&(o=o||function(e,t){return!!it(e).isSystemAppFromData(t)&&at(e,t)}(e,t)),o}function at(e,t){return!(!e.client.isPhone||!Xe(e,t,Tj)||function(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.client.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(o,i,s)}(e,Qe(e,t,FN)))||!fh(e,$f(e,t,e.appleSilicon.isSupportEnabled))}function ct(e,t,n){return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp([t],!1)}function lt(e){if((0,Am.isNothing)(e))return
const t=e.toLocaleLowerCase()
return function(e){return kJ.includes(e)}(t)?t:void 0}function ut(e){return e.startsWith("id")?e.substring(2):e}function dt(e){return A(e)&&function(e){return(0,mm.isSome)(EJ[e])}(e.$kind)}function ft(e){return T(e)&&e[hz]===wA}function ht(e){var t
switch(e){case BL:return"arcadeAskToBuy"
case lV:return qy
case R$:return Vy
case UL:return"arcadeLaunchRepair"
case YH:return xL
case"topShelfATV":return"arcadeTopShelfATV"
case"topShelfATVClickThrough":return"arcadeTopShelfATVClickThrough"
case uV:return"arcadeTodayCard"
case GL:return"arcadeStoryCanvas"
case CN:return CN
case qU:return qU
case MO:return MO
default:return null!==(t=e)&&void 0!==t?t:qy}}function pt(e){return T(e)&&e[hz]===cA}function wt(e){return T(e)&&e[hz]===BO}function vt(e){return dt(e)&&e[hz]===RO}function gt(e){return function(e){return A(e)&&function(e){return(0,mm.isSome)(cK[e])}(e[hz])}(e)&&e[hz]===Gy}function mt(e,t){const n=l(t,RV)
return n.length>1&&e.console.warn("tried to extract data from container but more than one member present"),1!==n.length?null:n[0]}function yt(e){return l(e,RV)}function At(e){const t=jk,r=n(e,UD)
return e.label===t||i(r)}function Tt(e){return l(e,mI)}function bt(e){return p(e,ER)}function St(e,t){return t&&t.remainingContent?t.remainingContent.slice(0,t.maxPerPage):[]}function Pt(e,t,n){const r={...t}
if(t&&t.remainingContent){const e=Ct(0,t.remainingContent,t.maxPerPage,n)
r.remainingContent=e}return r}function Ct(e,t,n,r){return t.slice(n,null!=r?r:t.length)}function It(e,t=!1,n=!1,r=R3.Default){const o=function(e,t){let n
switch(e.host.clientIdentifier){case IY:case kY:case DY:n=!1
break
default:n=e.client.supportsHEIF}return t?n?Ax:aM:n?Ax:fD}(e,t)
return function(e,t,n=!1,r=R3.Default){return new zK(t,t===Ax?60:70,n)}(0,o,n,r)}function kt(e,t,n=0,r=0,o=null,i=null,s){const a=new dY(t,n,r,[It(e,!1,!1,R3.Default)])
return a.backgroundColor=o,a.textColor=i,a.checksum=s,a}function Ot(e){return`resource://${e}`}function Et(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}function Dt(e){var t
const n=new Date
n.setFullYear(n.getFullYear()+1)
const r=(n.getTime()-Date.UTC(2001,0,1))/1e3
null===(t=e.userDefaults)||void 0===t||t.setDouble(r,"lastBootstrapDate")}function Rt(e,t){var n
const r=null!==(n=t.excludingFields)&&void 0!==n?n:[]
return r.push("amsMetricsID"),new vZ(t.fields,t.includingFields,r,t.topic,t.shouldFlush)}function _t(e,t,n,r,o,i){const s={}
Object.assign(s,r),s[UV]=fj,s[Fx]=n,s[KD]=t
const a=["impressionsSnapshot",yG]
return a.push($S),o&&a.push(...o),xt(e,s),Rt(0,new vZ(s,a,[],$t(e,s),Ft(e,s,null,i)))}function Lt(e,t,n,r,o,i,s){const a={}
Object.assign(a,i),a[jj]=t,a[Fx]=n,a[Ij]=r,o&&(a[IB]=o),a[UV]=gW
const c=[bF]
return s&&c.push(...s),xt(e,a),Rt(0,new vZ(a,c,[],$t(e,a),Ft(e,a)))}function Mt(e,t,n,r,o){const i={}
Object.assign(i,t),i[UV]=uq,i[kB]="data-metrics",i[OB]=4
const s=[uq,yG,bF]
return s.push($S),n&&s.push(PF),r&&s.push(EB),o&&s.push("impressionsAppendix"),xt(e,i),Rt(0,new vZ(i,s,[OB],$t(e,i),Ft(e,i)))}function Ft(e,t,n=null,r){var o,i
const a=t[UV]
let c=!1
if(!s(a))return c
const l=null!=r&&r
switch(a){case fj:c=u(t,wZ.hasIAdData)||l
break
case XD:c=!0
break
case uq:c=u(t,wZ.hasIAdData),t[kB]!==ZD||(null===(o=null==n?void 0:n.adPageInfo)||void 0===o?void 0:o.placementType)!==Vq&&(null===(i=null==n?void 0:n.adPageInfo)||void 0===i?void 0:i.placementType)!==cq||(c=!0)
break
case fz:c=e.host.clientIdentifier===sJ&&(u(t,wZ.hasIAdData)||l)}return e.host.clientIdentifier,c}function $t(e,t){return t[jN]||e.bag.metricsTopic}function xt(e,t){e.bag.isMetricsAb2DataFallbackEnabled&&(0,mm.isSome)(e.experimentCache)&&(t.alt_ab2_data=JSON.stringify(e.experimentCache.createAb2Data()))}function Nt(e){var t
const n={}
if(!e)return n
Object.assign(n,e.baseFields),e.pageUrl?n[AG]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(n[AG]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(n,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(n,e.mercuryMetricsData),e.productVariantData&&Object.assign(n,We(e.productVariantData)),e.adPageInfo&&i(e.adPageInfo.pageFields[wZ.hasIAdData])&&(n[wZ.hasIAdData]=e.adPageInfo.pageFields[wZ.hasIAdData])
const r=null===(t=e.adPageInfo)||void 0===t?void 0:t.pageFields[pj]
return i(r)&&(n[pj]=r),Eh(n)}function Bt(e){return A(e)&&"TodayCard"===e[hz]}function Ut(e,t){return s(B(t,Cj))}function Gt(e,t,n,o,i=!0,s){if(!o.isAdvert)return void Vt(e,t,n,o)
n.searchAdOpportunity=function(e,t,n,o){const i=function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=B(t,Cj),a=j(t,"iad.impressionId"),c=j(t,"iad.privacy"),l=j(t,fF),u=new AZ(c)
u.title=e.adsLoc.string("IAD_PRIVACY_MARKER_BUTTON_TITLE")
const d=ih(e,t)?OU:dF,f=H(t,uW)?HH:rz,h=Yt(0,n),p=new zJ(i,t.id,l,d,"markerPress",f,h),w=Wt(i,n,a,o),v=zt(0,u,p)
return new TZ(i,s,w,a,v)}(e,t,n,o)
return new yZ(i.instanceId,i.eventPayloads,i)}(e,t,o.pageInformation,s)
const a=n.searchAdOpportunity.searchAd,c=ih(e,t)?OU:dF,l=Yt(0,o.pageInformation),u=j(t,fF),d=H(t,uW)?HH:rz,f=new zJ(a.instanceId,t.id,u,c,yS,d,l)
n.clickAction=zt(0,n.clickAction,f)
const h=new zJ(a.instanceId,t.id,u,c,AS,d,l)
n.buttonAction=zt(0,n.buttonAction,h),n.itemBackground=e.clientCapabilities.isEnabled("insetAdItemBackground")?jD:"ad",n.offerDisplayProperties&&i&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,AV,"ad")),H(t,"iad.format.userRating")||(n.rating=null,n.ratingCount=null),Vt(e,t,n,o)}function jt(e){const t=u(B(e,Cj),"passthroughAdInfo.deepLinkEligible"),n=u(e,"meta.passthroughAdInfo.deepLinkEligible")
return t||n}function Vt(e,t,n,o){const i=Xh(e,t,n,_h(e,t,n.icon,null),o,!0)
!function(e,t,n){var o,i,s,a,c,l,u,d,f,h,p,w
const v=null!==(i=null===(o=t.searchAdOpportunity)||void 0===o?void 0:o.searchAd)&&void 0!==i?i:t.searchAd
if(r(v))return
null===(s=t.clickAction)||void 0===s||s.actionMetrics.clearAll(),t.clickAction&&ra(e,t.clickAction,n,!0)
const g=n.pageInformation,m={actionType:"ad_transparency"};(null==g?void 0:g.adPageInfo)&&Object.assign(m,g.adPageInfo.clickFields),(null===(c=null===(a=null==n?void 0:n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType)===nW&&(0,Am.isSome)(null===(l=null==n?void 0:n.adsMetricsData)||void 0===l?void 0:l.iAdSlotId)&&(m[zx]=null===(u=null==n?void 0:n.adsMetricsData)||void 0===u?void 0:u.iAdSlotId),(0,Am.isSome)(null===(d=null==n?void 0:n.adsMetricsData)||void 0===d?void 0:d.iAdDuplicateLayoutType)&&(m[UF]=null===(f=null==n?void 0:n.adsMetricsData)||void 0===f?void 0:f.iAdDuplicateLayoutType)
const y=_t(e,t.adamId,lz,m)
null!==(w=null===(p=null===(h=null==g?void 0:g.adPageInfo)||void 0===h?void 0:h.shouldIncludeAdRotationFields)||void 0===p?void 0:p.call(h,e))&&void 0!==w&&w&&y.includingFields.push(EB),v.transparencyAction.actionMetrics.addMetricsData(y)}(e,n,i),Qh(e,n,i,i.pageInformation.adPageInfo)}function Ht(e){var t
return[TS,"U","I",(null!==(t=null==e?void 0:e.artwork)&&void 0!==t?t:[]).length].join("")}function qt(e,t){let n
const r=null==t?void 0:t.adPageInfo.placementType
if((0,mm.isSome)(r))try{n=e.ads.getIdentifierForMissedOpportunity(r)}catch{n=e.random.nextUUID(),Zt(e,`Error: getIdentifierForMissedOpportunity threw exception. Assigned ${n}`)}else n=e.random.nextUUID(),Zt(e,`Error: placementType was null or empty. Assigned ${n}`)
const o=Wt(n,t,e.random.nextUUID())
return new yZ(n,o)}function Wt(e,t,n,r){const o=null==t?void 0:t.baseFields.pageId,i=typeof o===$W?o:GW
return{placed:{adInstanceId:e,impressionId:null!=n?n:void 0,slot:null!=r?r:void 0,pageIdentifier:i},pageEnter:{pageIdentifier:i},pageExit:{pageIdentifier:i},onScreen:{adInstanceId:e},offScreen:{adInstanceId:e},visible:{adInstanceId:e},completed:{adInstanceId:e}}}function zt(e,t,n){const r=new bZ(n),o=new rZ([r,t])
return o.title=t.title,o}function Yt(e,t){const n=null==t?void 0:t.adPageInfo
if(r(n))return gG
const o=n.placementType
switch(o){case dH:return SS
case nW:return"searchAds"
case UW:case Vq:case cq:return SS
default:throw new Error(`This method should never be called with value: ${o}`)}}function Jt(e){return!!function(e){return e.host.clientIdentifier===tJ||e.host.clientIdentifier===sJ}(e)||e.host.platform===GW}function Kt(e,t){if(!Jt(e))return!1
switch(t){case dH:const n=en(t)
return(0,mm.isSome)(n)?e.bag.isSearchLandingAdsEnabled||e.bag.enabledAdPlacements.includes(n):e.bag.isSearchLandingAdsEnabled
case nW:return!0
case UW:const o=en(t)
return!r(o)&&e.bag.enabledAdPlacements.includes(o)&&(0,mm.isSome)(Qt(e))
case Vq:case cq:const i=en(t)
return!r(i)&&e.bag.enabledAdPlacements.includes(i)
default:return!1}}function Zt(e,t){e.console.log(`[Ads] ${t}`),e.client.buildType===WG&&e.isAvailable(jY)&&i(e.ads.debugLog)&&((0,mm.isNothing)(BZ)&&(0,mm.isSome)(e.ads.isNativeAdLoggingEnabled)&&(BZ=e.ads.isNativeAdLoggingEnabled()),BZ&&e.ads.debugLog(t))}function Qt(e){if(e.bag.todayAdMediumLockupScreenshotEnabled)return Kq
if(e.bag.todayAdCondensedEnabled){if(!e.client.isPhone)return
return $$}return function(e){return!!e.client.isPhone&&Ne(e,Cm.CondensedTodayAds)===mZ}(e)?$$:void 0}function Xt(e,t,n){var r,o,i,s,a
const c=e.bag.adPlacementTimeouts,l=.3
switch(t){case nW:return n?null:null!==(r=null==c?void 0:c["search-results-in-seconds"])&&void 0!==r?r:l
case dH:return n?null:null!==(o=e.bag.searchLandingAdFetchTimeout)&&void 0!==o?o:l
case UW:return n?null!==(i=null==c?void 0:c["today-in-seconds"])&&void 0!==i?i:l:null
case Vq:return n?null:null!==(s=null==c?void 0:c["product-page-ymal-in-seconds"])&&void 0!==s?s:l
case cq:return n?null:null!==(a=null==c?void 0:c["product-page-ymal-during-download-in-seconds"])&&void 0!==a?a:l
default:return l}}function en(e){switch(e){case nW:return UN
case dH:return GN
case UW:return UW
case Vq:return"product-page-ymal"
case cq:return"product-page-ymal-during-download"
default:return}}function tn(e){return e.bag.enableSRPNextSlot&&e.clientCapabilities.isEnabled(pJ)}function nn(e){return e.bag.enableSRPV5Impressions&&e.clientCapabilities.isEnabled(pJ)}function rn(e,t){return t===nW&&nn(e)}function on(e,t){return t===nW&&!nn(e)}function sn(e,t){var n
if(!tn(e))return
const r=f(t,GA)
if((0,mm.isNothing)(r))return
const o=null===(n=w(JSON.parse(r).intendedSlots))||void 0===n?void 0:n.filter(e=>typeof e===qj)
return(0,mm.isNothing)(o)?void 0:o}function an(e,t,n,r){if((0,mm.isNothing)(t))return
if(n)switch(t){case dH:return
case nW:if(!nn(e))return}if(t===nW){const t=sn(e,r)
if((0,mm.isSome)(t)&&t.length>0)return t.map(e=>({shelfIdentifier:UN,slot:e}))}const o=en(t)
return(0,mm.isNothing)(o)?void 0:e.bag.adPlacementEligibleSlotPositions[o]}function cn(e,t,n,r,o){var i
if((0,mm.isNothing)(n)||(0,mm.isNothing)(t))return!1
const s=null===(i=Gh(n))||void 0===i?void 0:i.id
if((0,mm.isNothing)(s))return!1
const a=ln(e,t,s,r,o),c=Uh(n)
return a.includes(c)}function ln(e,t,n,r,o){const i=an(e,t,r,o)
if((0,mm.isNothing)(i))return[]
const s=[]
for(const e of i)e.shelfIdentifier===n&&s.push(e.slot)
return s}function un(e,t,n,o,i){var s,a,c,l
if(!Jt(e)||r(i.adPageInfo))return
const u=ln(e,n,o,!1)
if(0===u.length)return
const d=[]
for(const e of t){if(e.contentType!==mW&&e.contentType!==EV)continue
const t=e.items;(0,mm.isSome)(t)&&t.length>0&&d.push(...t)}for(const t of u){const n=null===(s=i.adPageInfo)||void 0===s?void 0:s.missedOpportunityReason(o,t)
if((0,mm.isNothing)(n)||n===jA||n===VA)return
const r=d[t]
if((0,mm.isSome)(r.searchAdOpportunity))return
if(Bt(r)&&(0,mm.isSome)(null===(a=r.media)||void 0===a?void 0:a.searchAdOpportunity))return
r.searchAdOpportunity=qt(e,i),null===(c=r.searchAdOpportunity)||void 0===c||c.setMissedOpportunityReason(n),null===(l=r.searchAdOpportunity)||void 0===l||l.setTemplateType(zG)}}function dn(e,t,n,o=null){var i,s
return!Jt(e)||r(n)?null:new o2(e,t,o2.createInitialPageSlotInfos(e,t,null===(i=null==n?void 0:n.onDeviceAd)||void 0===i?void 0:i.positionInfo,o,void 0),n.iAdId,n.clientRequestId,void 0,null===(s=n.onDeviceAd)||void 0===s?void 0:s.positionInfo)}function fn(e,t){return j(t,UZ)}function hn(e,t,n){s(null==t?void 0:t.attributes)&&(t.attributes[UZ]=n)}function pn(e,t,n,r){var i,a,c,l,u
const d=e.bag.adsOverrideLanguage
if(o(d)||o(t))return!0
let f=null===(i=t.meta)||void 0===i?void 0:i.resource
if(o(f)&&s(n)&&(f=null===(u=null===(l=null===(c=null===(a=null==n?void 0:n.appMetadata)||void 0===a?void 0:a.data)||void 0===c?void 0:c[0])||void 0===l?void 0:l.meta)||void 0===u?void 0:u.resource),o(f))return!1
if(j(f,"name.locale")!==d)return!1
const h=Qe(e,t,Pq),p=Qe(e,f,"subtitle.locale")
if(s(h)&&p!==d)return!1
if(r===$Z){const n=j(t,HA)
if((0,mm.isSome)(n)&&n!==wW){let r
const o=n
r=n===SW?Sj:n
const i=Qe(e,t,r),a=Qe(e,f,o.concat(".locale"))
if(s(i)&&a!==d)return!1}}return!0}function wn(e,t,n){const r=n.reco_algoId
if(o(r)||o(e)||o(t[r]))return e
const i=e.map(e=>{var t
return{identifier:h(e.id),score:null!==(t=h(e,JF))&&void 0!==t?t:0}}),s=t[r],a=(0,$m.demoteByEngagements)(i,s),c=e.reduce((e,t)=>({...e,[t.id]:t}),{})
return a.map(e=>c[e.identifier.toString()])}function vn(e,t){if(!s(t))return{}
const n=p(t,"data.engagementEvents.impression"),r={}
for(const e in n)if(s(e)){const t=l(n,e)
r[e]=t.map(e=>({adamIdentifier:h(e[EH]),timestamp:h(e.eventTimeMillis)}))}return r}function gn(e){return e.bag.enableRecoOnDeviceReordering}function mn(e){return e===zZ.Apps.toString()?VZ:e===zZ.Games.toString()?HZ:jZ}function yn(e){const t=e.categories
if(s(t)){const e=t[0].genreId
if(e===zZ.Games.toString())return HZ
if(e===zZ.Apps.toString())return VZ}return jZ}function An(e,t,n=e.host.clientIdentifier,r=[]){t||(t=zZ.Apps)
const o=new cJ(e).forType(KB).includingAdditionalPlatforms(r).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAgeRestrictions().addingQuery(mq,`${t}`)
return n===nJ?o.addingContext(oz):n===rJ&&o.addingContext(eW),o}function Tn(e,t,n=!0){return ym.context("categoryListFromApiResponse",()=>{const r=l(t,"results.categories"),o=bn(e,p(r,"0"),n)
return o?new qZ(o.children):null})}function bn(e,t,n=!0){return ym.context("categoryFromApiResponse",()=>{if(!t)return null
const r=f(t,cz),o=f(t,mq),s=f(t,ZB),a=df(e,p(t,XW),{allowingTransparency:!0,useCase:R3.CategoryIcon}),c=l(t,QH).map(t=>bn(e,p(t),n)).filter(e=>i(e)),u=function(e,t){return t.sort((t,n)=>{try{return t.name.localeCompare(n.name,e.loc.safeIdentifier,{usage:jH})}catch(e){return 0}})}(e,c),d=f(t,Gq)
return d&&n&&u.unshift(new WZ(d,o,a,s,[])),new WZ(r,o,a,s,u)})}function Sn(e,t,n=!1,r=!1,o=!0){const i=n?"contentIconTrimmedMonochrome":"contentIconTrimmed",s="brandLogo",a=Ke(e,t,RW)
if(r)return p(a,s)
{let e=p(a,i)
return o&&(0,mm.isNothing)(e)&&(e=p(a,s)),e}}function Pn(e){const t=j(e.data,wB)
return t===Um.Horizontal?Um.Horizontal:t===Um.Condensed?Um.Condensed:Um.Vertical}function Cn(e,t){if(!t.isFirstRender)return s(t.remainingItems)?t.remainingItems:[]
const n=we(t.data,sz)
return s(n)?n:[]}function In(e,t){let n=null
switch(t.type){case YW:case Wq:case lG:n=pe(e,t,vq)||pe(e,t,Sq)||pe(e,t,sz)||pe(e,t,VW)
break
case az:case jq:case JW:n=t}return n}function kn(e,t){if(o(t))return null
const n=l(t.meta,"associations.editorial-cards.data")
return o(n)?null:n[0]}function On(e,t){return v({...B(t,Xj,{}),...B(kn(0,t),Xj,{})})}function En(e){return{showAppIcon:d(e.showAppIcon,!1),suppressLockup:d(e.suppressLockup,!1),useGeneratedBackground:d(e.useGeneratedBackground,!1),useMaterialBlur:d(e.useMaterialBlur,!0),useTextProtectionColor:d(e.useTextProtectionColor,!1)}}function Dn(e,t){if(!W(t))return null
let n
return n=t.type===YW?gh(e,t):t,W(n)?n:null}function Rn(e,t){const n=s(B(t,EW)),r=H(t,tG)
return!n&&!r}function _n(e,t){const n=t.type
return n!==xm.Collection&&n!==xm.Recommendations?null:j(t,Aq)}async function Ln(e,t,n){var r
const o=Date.now()
let i
e.clientCapabilities.isEnabled(mJ)||(i=await e.mediaToken.refreshToken())
const s=e.fetchTimingMetricsBuilder,a=null!=n?n:{},c=null===(r=e.personalizationMetricsIdentifiersCache)||void 0===r?void 0:r.getMetricsIdForType(Om.user);(0,Am.isSome)(c)&&((0,Am.isSome)(null==a?void 0:a.headers)?a.headers[JZ]=c:a.headers={[JZ]:c})
const l=await Fn(e,t,i,a,!1,s),u=Date.now()
t.canonicalUrl&&(l[Wm.requestedUrl]=t.canonicalUrl)
const d=u-o
if(d>500){const n=ge(e,t).toString()
e.console.warn("Fetch took too long ("+d.toString()+"ms) "+n)}return l}function Mn(e,t){return e.bag.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return i(null===(n=t.query)||void 0===n?void 0:n[e])})}async function Fn(e,t,n,a={},c=!1,l){var d,f
const p=ge(e,t).toString(),w=new oY(p),v=Mn(e,w)
for(const e of v)w.removeParam(e)
const g=w.toString()
let m=a.headers
m||(m={}),(0,Am.isSome)(n)&&(m.Authorization="Bearer "+n)
const A=await e.network.fetch({url:g,headers:m,method:a.method,body:a.requestBodyString,timeout:a.timeout})
try{if(401===A.status||403===A.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
if(e.clientCapabilities.isEnabled(mJ)){const e=new KZ(`Authentication failed AMS did not handle token refresh (${A.status}) for ${g}, original ${p}`)
throw e.statusCode=A.status,e}return e.mediaToken.resetToken(),await e.mediaToken.refreshToken().then(async n=>await Fn(e,t,n,a,!0,l))}if(404===A.status)throw $n()
if(!A.ok){const e=new KZ(`Bad Status code ${A.status} for ${g}, original ${p}`)
throw e.statusCode=A.status,e}const n=n=>{var c,l
const d=Date.now()
let f
if(r(n.body)||""===n.body){if(204!==n.status)throw $n()
f={}}else try{f=JSON.parse(n.body)}catch(t){let r=t.message
throw[Rj,WG].includes(e.client.buildType)&&(r=`${t.message}, body: ${n.body}`),new ZZ(r)}const w=Date.now()
if(f){if(f[Wm.pageInformation]=y(function(e,t){const n=e.client.storefrontIdentifier
let r=null
if((null==n?void 0:n.length)>0){const e=n.split("-")
s(e)&&(r=e[0])}return{serverInstance:t.headers[QZ],storeFrontHeader:n,language:e.bag.language,storeFront:r,environmentDataCenter:t.headers[XZ]}}(e,n)),n.metrics.length>0){const e={...n.metrics[0],parseStartTime:d,parseEndTime:w}
f[Wm.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:d,parseEndTime:w}
f[Wm.timingValues]=e}if(f[Wm.contentMaxAge]=function(e,t){const n=Object.keys(t.headers).find(e=>"cache-control"===e.toLowerCase())
if(r(n)||""===n)return null
const i=t.headers[n]
if(o(i))return null
const s=i.match(/max-age=(\d+)/)
return r(s)||s.length<2?null:h(s[1])}(0,n),Array.isArray(f.data)&&i(l=f.data)&&0===l.length&&!u(a.allowEmptyDataResponse))throw $n()
Array.isArray(f.data)&&t.originalOrdering.length>1&&(f.data=function(e,t,n,r=[]){const o={}
for(const e of n)o[e.id]=e
const i=[]
for(const e of t){const t=o[e.id]
if((0,Am.isSome)(t)){if(s(r)){t.meta={...e.meta}
for(const n of r)xn(0,n,t,e,o)}i.push(t)}}return i}(0,t.originalOrdering,null!==(c=f.data)&&void 0!==c?c:[],t.supplementaryMetadataAssociations)),f[Wm.requestedUrl]=p}return f}
return(0,Am.isSome)(l)?l.measureParsing(A,n):n(A)}catch(e){if(e instanceof KZ)throw e
const t=null!==(d=A.headers["x-apple-jingle-correlation-key"])&&void 0!==d?d:null===(f=A.metrics[0])||void 0===f?void 0:f.clientCorrelationKey
throw new Error(`Error Fetching - filtered: ${g}, original: ${p}, correlationKey: ${null!=t?t:"N/A"}, ${e.name}, ${e.message}`)}}function $n(){const e=new KZ("No content")
return e.statusCode=204,e}function xn(e,t,n,r,o){var i;(0,Am.isNothing)(n.meta)?n.meta={associations:{}}:(0,Am.isNothing)(n.meta.associations)&&(n.meta.associations={})
const a=re(t,r)
if(s(a)){const e=[]
for(const t of a){const n=o[t.id];(0,Am.isSome)(n)&&e.push(n)}(null!==(i=p(n.meta.associations))&&void 0!==i?i:{})[t]={data:e}}}function Nn(e){return T(e)&&e[hz]===lA}function Bn(e,t,n,r){const o=Uh(r.locationTracker),i={impressionIndex:o,id:o.toString(),idType:pW,name:t.displayName,impressionType:n,parentId:OI}
t.impressionMetrics=new qJ(i)}function Un(e){return(0,mm.isSome)(e)&&0!==e.length?`SearchResults.${e}.shelfId`:"SearchResults.shelfId"}function Gn(e,t,n,r,o,s){var a,c,l
const u=null!==(a=v(r,Wm.pageInformation,{}))&&void 0!==a?a:{},d=v(r,Wm.timingValues),h=f(r,Wm.requestedUrl)
let p
const w=u
if(w.pageType=t,w.pageId=n,o&&(w[SG]=o),t===_H){const t=mt(e,r)
if((0,Am.isSome)(t)){const n=j(t,cz),r=j(t,eq)
w[SG]=`${r}_${n}`,ih(e,t)&&(w[RB]=dW),p=Ge(e,t)}}else t===DD?w[SG]=`${t}_${n}`:t===OH?w[SG]=VE:t===wj&&n===wj&&(w[SG]=`${t}_${n}`)
const g=new cZ(null!==(c=Eh(w))&&void 0!==c?c:{});(0,Am.isSome)(d)&&(g.timingMetrics=d,(0,Am.isSome)(h)&&(g.pageUrl=h)),i(p)&&(g.productVariantData=p)
const m=null!=s?s:Xs(e,n,r)
return(0,Am.isSome)(m)&&(g.adPageInfo=m),g.recoMetricsData=null!==(l=bt(r))&&void 0!==l?l:void 0,g}function jn(e,t,n,r,o){var i
const s=new cZ({pageType:t,pageId:n,page:`${t}_${n}`,pageDetails:r})
if(o){const t=o2.placementTypeFromPlacementId(e,f(o,hj))
s.adPageInfo=new o2(e,t,o2.createInitialPageSlotInfos(e,t,null,null,null),null!==(i=f(o,pj))&&void 0!==i?i:void 0),s.adPageInfo.applyClickFieldsFromPageRequest(n,o)}return s}function Vn(e,t,n,o,i){if(r(n))return
t.pageMetrics.pageFields=Nt(n),t.pageMetrics.addManyInstructions(Xn(e,n,o)),t.pageMetrics.addData(Kn(e,n,o,i),[Ym.PageInvocationPoint.pageEnter]),t.pageMetrics.addData(function(e,t,n){const r=Kn(e,t,n)
return r.fields[UV]=jS,r}(e,n,o),[Ym.PageInvocationPoint.pageExit]),t.pageMetrics.pageRenderFields=Qn(e,n,o),t.pageRenderMetrics=Qn(e,n,o),function(e){const t=A(o=e)&&o[hz]===HV,n=function(e){return A(e)&&e[hz]===Uy}(e),r=function(e){return A(e)&&e[hz]===Wy}(e)
var o
return!t&&!n&&!r}(t)&&t.pageMetrics.addData(Zn(e,n,o),[Ym.PageInvocationPoint.backButton])
const s=e.fetchTimingMetricsBuilder;(0,Am.isSome)(s)&&s.decorate(t)}function Hn(e,t){return new cZ({pageType:Zq,pageId:t,page:`${Zq}_${t}`})}function qn(e,t,n,r){const o={pageId:Nx,pageType:OH}
r&&(o[fQ]=r)
const i=new cZ(o)
return i.pageUrl=n,i}function Wn(e,t,n,r,i,a,c,l,u){const d=Gn(e,OH,a,n)
return d.searchTermContext=r,d.pageUrl=i,u&&(d.guidedSearch=function(e,t,n){const r={}
if(s(t.guidedSearchTokens)&&(r.searchSelectedGuidedFacets=t.guidedSearchTokens),n&&n.finalTerm&&(r.searchGuidedFinalQuery=n.finalTerm),!o(r))return r}(0,t,u)),Jt(e)&&(0,Am.isSome)(c)&&(d.adPageInfo=new o2(e,nW,o2.createInitialPageSlotInfos(e,nW,null,null,n.meta),c.iAdId,c.appStoreClientRequestId,l)),d}function zn(e,t,n,r,o,s){let a="",c=""
switch(t){case zm.AppEvent:a=`${n}_${r}`,c=oU
break
case zm.ContingentOffer:case zm.OfferItem:a=`${n}`,c="OfferDetails"}const l={pageId:a,pageType:c}
i(o)&&(l[Ux]=o[VW],l[RU]=o[JB])
const u=new cZ(l)
return u.recoMetricsData=null!=s?s:void 0,u}function Yn(e,t){if(r(t)||r(t.pageMetrics))return
const n=t.pageMetrics.instructions
if(!r(n))for(const e of n)e.data.fields[UV]===fz&&e.data.includingFields.push(SF)
let o=null
if(vt(t)?o=t:gt(t)&&(o=t.lockup),o){const e=[]
if(Nn(o.buttonAction))e.push(o.buttonAction)
else if(T(i=o.buttonAction)&&i[hz]===dA&&Nn(o.buttonAction.buyAction))e.push(o.buttonAction.buyAction)
else if(function(e){return T(e)&&e[hz]===uA}(o.buttonAction)&&Nn(o.buttonAction.completionAction))e.push(o.buttonAction.completionAction)
else if(wt(o.buttonAction)){if(Nn(o.buttonAction.buyAction)&&e.push(o.buttonAction.buyAction),Nn(o.buttonAction.defaultAction)&&e.push(o.buttonAction.defaultAction),Nn(o.buttonAction.openAction)&&e.push(o.buttonAction.openAction),ft(o.buttonAction.subscribePageAction)&&o.buttonAction.subscribePageAction.page===PE&&(0,Am.isSome)(o.buttonAction.subscribePageAction.pageUrl)&&o.buttonAction.subscribePageAction.pageUrl.length>0){const e=oY.from(o.buttonAction.subscribePageAction.pageUrl)
e.param(Hz.includePostSubscribeAttribution,cW),o.buttonAction.subscribePageAction.pageUrl=e.build()}ft(o.buttonAction.subscribePageAction)&&function(e){return A(e)&&"MarketingItemRequestInfo"===e[hz]}(o.buttonAction.subscribePageAction.pageData)&&Nn(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)&&e.push(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const t of e)t.purchaseConfiguration&&(t.purchaseConfiguration.excludeAttribution=!1)}var i}function Jn(e){Object.keys(e).filter(e=>!wQ.has(e)).forEach(t=>delete e[t])}function Kn(e,t,n,r){var o,s,a,c,l,u
const d=er(t,n)
t.adPageInfo&&Object.assign(d,t.adPageInfo.pageFields),i(t.offerReleaseDate)&&(d[wR]=Ee(t.offerReleaseDate))
const f=t.searchTermContext
f&&(d[Hq]=f.term,f.suggestedTerm&&(d.searchSuggestedTerm=f.suggestedTerm),f.correctedTerm&&(d.searchCorrectedTerm=f.correctedTerm),f.originatingTerm&&(d[mR]=f.originatingTerm)),t.guidedSearch&&Object.assign(d,t.guidedSearch)
const h=function(e,t,n,r,o,i){const s={}
Object.assign(s,o),s[UV]=fz,r&&(s[xS]=r.clientCorrelationKey,s.requestStartTime=r.requestStartTime,s.responseStartTime=r.responseStartTime,s.responseEndTime=r.responseEndTime)
const a=[yG,bF]
return a.push("userContentRestriction"),n&&a.push("crossfireReferralCandidate"),xt(e,s),Rt(0,new vZ(s,a,[],$t(e,s),Ft(e,s,null,i)))}(e,0,null!==(o=t.isCrossfireReferralCandidate)&&void 0!==o&&o,t.timingMetrics,d,r),p=null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.adIsPresent)&&void 0!==a&&a,w=null!==(u=null===(l=null===(c=null==t?void 0:t.adPageInfo)||void 0===c?void 0:c.shouldIncludeAdRotationFields)||void 0===l?void 0:l.call(c,e))&&void 0!==u&&u
return p&&w&&h.includingFields.push(EB),h}function Zn(e,t,n){return function(e,t){const n={}
return Object.assign(n,t),n[Ij]=YU,_t(e,YU,lz,n)}(e,er(t,n))}function Qn(e,t,n){const r=er(t,n)
return t.searchTermContext&&(r[Hq]=t.searchTermContext.term),t.baseFields&&Object.assign(r,t.baseFields),function(e,t,n){const r={}
return Object.assign(r,n),r[UV]="pageRender",t&&(r[AG]||(r[AG]=t.pageURL),r[xS]=t.clientCorrelationKey,r.platformRequestStartTime=t.requestStartTime,r.platformResponseStartTime=t.responseStartTime,r.platformResponseEndTime=t.responseEndTime,r.platformResponseWasCached=t.responseWasCached,r.platformJsonParseStartTime=t.parseStartTime,r.platformJsonParseEndTime=t.parseEndTime),xt(e,r),r}(e,t.timingMetrics,r)}function Xn(e,t,n){var r,o,s,a
const c=er(t,n)
t.searchTermContext&&(c[Hq]=t.searchTermContext.term)
const l=S(c)
t.adPageInfo&&Object.assign(l,t.adPageInfo.impressionsFields),t.guidedSearch&&Object.assign(l,t.guidedSearch)
const u=i(t.adPageInfo),d=null!==(o=null===(r=t.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad(e))&&void 0!==o&&o,f=[{data:Mt(e,l,u&&d,null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields(e))&&void 0!==a&&a,!0),invocationPoints:[Ym.PageInvocationPoint.appExit,Ym.PageInvocationPoint.pageExit]}]
if(u){const n=function(e,t,n){var r,o,i,s,a,c
const l=null!==(i=null===(o=null===(r=null==n?void 0:n.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad)||void 0===o?void 0:o.call(r,e))&&void 0!==i&&i,u=null!==(c=null===(a=null===(s=null==n?void 0:n.adPageInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields)||void 0===a?void 0:a.call(s,e))&&void 0!==c&&c,d=[],f=Mt(e,t,l,u,!1).fields
if(f[kB]=ZD,(0,mm.isSome)(null==n?void 0:n.adPageInfo)){const t=n.adPageInfo.fastImpressionsEventVersion(e)
f[OB]=t,d.push(OB),5===t&&(f.viewableArea="excludingTabBar",delete f[hj])}const h=["fastImpressions",yG,bF]
return l&&h.push(PF),u&&h.push(EB),Rt(0,new vZ(f,h,d,$t(e,f),Ft(e,f,n)))}(e,l,t)
f.push({data:n,invocationPoints:[Ym.PageInvocationPoint.appExit,Ym.PageInvocationPoint.pageExit,Ym.PageInvocationPoint.timer]})}return f}function er(e,t){const n={}
return i(e.offerType)&&(n[Yx]=e.offerType),void 0!==t&&n&&t(n),n}function tr(){return new cZ({pageId:_B,pageType:jO})}function nr(e,t){const n=Xe(e,t,"usesExternalPurchase"),r=Xe(e,t,"usesExternalLinkPurchase")
return n||r}function rr(e,t){return e.bag.enableExternalPurchases&&e.bag.enabledExternalPurchasesPlacements.includes(t)}function or(e,t,n,r){const i=e.bag.externalPurchasesLearnMoreEditorialItemId
if(o(i)||!e.bag.enableExternalPurchases)return null
const s=new _J(vW)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,ra(e,s,{id:JU,targetType:EW,actionType:dz,pageInformation:n,locationTracker:r}),s}function ir(e){switch(e){case Vy:case xL:case YH:case R$:return!0
default:return!1}}function sr(e,t,n=!1){const r=j(t,"ageRating.name")
return(0,mm.isSome)(r)?r:n?j(t,LT):void 0}function ar(e,t,n=!1){const r=q(t,MT)
return(0,mm.isSome)(r)?r:n?q(t,"contentRatingsBySystem.appsApple.value"):void 0}function cr(e,t){const n=new Map([["br.100.official",$T],["br.100",xT],["br.210.official",NT],["br.210",BT],["br.300.official",UT],["br.300",GT],["br.314.official",jT],["br.314",VT],["br.416.official",HT],["br.416",qT],["br.618.official",WT],["br.618",zT]])
e.clientCapabilities.isEnabled(yJ)&&(n.set("br.106.official","br.6.official"),n.set("br.106","br.6"))
const r=e.locale.activeStorefront+"."+j(t,MT)+(H(t,"ageRating.isOfficial")?".official":"")
return n.get(r)}function lr(e,t){var n
if(t<=0)return!1
if(t>=1)return!0
const r=null===(n=e.metricsIdentifiersCache)||void 0===n?void 0:n.getMetricsIdForType(Om.user)
return!(0,mm.isNothing)(r)&&0!==r.length&&!(r.length<2)&&function(e){function t(e){const t=e.charCodeAt(0)
return t>=48&&t<=57?52+t-48:t>=65&&t<=90?26+t-65:t>=97&&t<=122?t-97:t}const n=e.slice(-2)
return(62*t(n[0])+t(n[1]))/3843}(r)<t}function ur(e,t){switch(fr(e,t)){case XL:case U$:case tM:case eM:case Tb:return!0
default:return!1}}function dr(e,t){return lr(e,e.bag.gameControllerRecommendedRolloutRate)&&fr(e,t)===Tb}function fr(e,t){const n=nt(e)
if((0,mm.isNothing)(n))return VG
if(!ie(t,n)){const r=Ke(e,t,wq)
if((0,mm.isNothing)(r)||o(r))return VG
const i=r[n]
return o(i)?VG:i}const r=Qe(e,t,hV)
return s(r)?r:VG}function hr(e,t){return nt(e),bb}function pr(e,t=null){return e===iz?function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER"
return e&&(t+=`&installMajorOSBundle=${e}`),t}(t):null}function wr(e){var t
return(0,mm.isNothing)(DQ)&&(DQ=new wZ({defaultTopic:e.bag.metricsTopic,buildType:e.client.buildType,jsVersion:null!==(t=e.packageProperties.asString(aD))&&void 0!==t?t:GW,buyDecorator:EQ,isLoggingEnabled:!0,bagProvider:(t,o)=>{const i=e.bag.metricsConfiguration
if(!r(o)){const e=n(i,[o,t])
if(!r(e))return e}return n(i,t)}})),DQ}function vr(e,t,n,a,c,l,u,d,h,p,w,v,g,m,A){const T=function(e,t){const n=new uZ(t),r=f(e.bag.metricsConfiguration,"metricsBase.language")
return n.set("languageId",r),n.toString()}(e,n)
return function(e,t,n,o,s,a,c){const l=new uZ(t)
return function(e,t,n,o,s,a,c){var l,u
const d=f(a,Bx)
t.set(Bx,d)
const h=e.clientCapabilities.isEnabled(hR)?e.bag.metricsPaymentTopic:void 0
t.set(jN,null!=h?h:e.bag.metricsTopic),EQ.useNativeValues(a)
const p=EQ.params
for(const e of Object.keys(p)){if(e===xF&&(0,Am.isSome)(t.get(xF)))continue
const n=f(p,e)
t.set(e,n)}if(!r(c))for(const e of Object.keys(c)){const n=f(c,e)
t.set(e,n),t.set(e,n,null)}if(!a)return t.set(Hq,null),void t.set(NF,null)
const w=f(a,bG);(0,Am.isSome)(w)&&w.length>0&&t.set(bG,w)
const v=f(a,oP);(0,Am.isSome)(v)&&v.length>0&&t.set(oP,v)
const g=(null===(l=t.get(XS,null))||void 0===l?void 0:l.length)>0,m=f(a,VW)
if(g?t.set(VW,e.host.clientIdentifier):(0,Am.isSome)(m)&&m.length>0&&t.set(VW,m),!o&&!vz.shared.shouldUseJSReferralData){const e=f(a,Wx),n=Oh(e)
e&&n&&(a[Ux]=n)
const r=f(a,"usageContext")
if((0,Am.isSome)(r)){switch(r){case dq:t.set(bG,"com.apple.AppStore.overlay")
break
case pR:t.set(bG,fR)}t.set(qx,w,null)}else{const e=f(a,qx)
t.set(qx,e,null)
const n=f(a,Wx)
t.set(Wx,n,null),f(a,"extRefAppType")===nP&&t.set(bG,fR)}}const y=t.get(xj),A=t.get(GV),T=(null!==(u=null==y?void 0:y.split("_"))&&void 0!==u?u:[]).includes(n)
if(A!==_H||T){const e=Rh(f(a,_U))
i(e)&&t.set(Hq,e)}t.set(GS,null,null)}(e,l,n,o,0,a,c),l.toString()}(e,function(e,t,n,a,c,l,u,d,h,p,w,v){const g=new uZ(t)
return function(e,t,n,s,a,c,l,u,d,h,p,w){var v,g,m
const A=Nt(s)
a&&t.set(DB,a),c&&t.set(Dq,c)
const T=f(y(A),xj)
t.set(xj,T)
const b=f(y(A),GV)
t.set(GV,b)
const S=f(y(A),LU);(0,Am.isSome)(S)&&S.length>0&&t.set(RQ.containerId,S,null)
const P=(null!==(v=null==T?void 0:T.split("_"))&&void 0!==v?v:[]).includes(n),C=b===_H,I=(null===(g=t.get(XS,null))||void 0===g?void 0:g.length)>0
if(!C||P||I){let e=f(y(s),"searchTermContext.resultsTerm")
o(e)&&(e=function(e){if((0,mm.isNothing)(e))return null
const t=new oY(e),n=t.query,r=null==n?void 0:n[Hq],o=t.pathname
return(0,mm.isNothing)(r)||(0,mm.isNothing)(o)?null:o.includes("/app")?r:null}(null==s?void 0:s.pageUrl)),r(e)||t.set(Hq,e)}if(C&&(0,Am.isSome)(s)&&(0,Am.isSome)(s.pageUrl)&&(null===(m=new oY(s.pageUrl).query)||void 0===m?void 0:m[uR])===eP&&(t.set(xF,dR),t.set(tP,"1",null)),function(e,t,n,r){const o=i(n)&&n.adamID===t,s=i(r)&&r.adamID===t&&!o
if(o&&i(n)){const t=We(n)
for(const n of Object.keys(t)){const r=f(t,n);(0,Am.isSome)(r)&&e.set(n,r)}}if(s&&i(r)){const t=ze(r)
for(const n of Object.keys(t)){const r=f(t,n);(0,Am.isSome)(r)&&e.set(n,r)}}}(t,n,null==s?void 0:s.productVariantData,null!=u?u:void 0),!r(l)&&l.length>0&&t.set(NF,l),t.set(Y$,d),!h)if(i(vz.shared.activeReferralData)){if(t.set(qx,vz.shared.activeReferralData.extRefApp2,null),t.set(Wx,vz.shared.activeReferralData.extRefUrl2,null),(0,Am.isSome)(vz.shared.activeReferralData.kind)){const e=vz.shared.activeReferralData.kind.name
e!==nP&&"appClip"!==e||t.set(bG,fR)}}else t.set(qx,p,null),t.set(Wx,w,null)}(0,g,n,a,c,l,u,d,h,p,w,v),function(e,t,n,r){var o
if((0,Am.isNothing)(r))return
const i=[],a=r.adPageInfo
if((0,Am.isSome)(a)){const e=(0,Am.isSome)(a.clickFields[eR]),n=a.adAdamId===t
if(e&&n){const e=function(e,t){if((0,Am.isNothing)(e))return!1
const n=e.baseFields[GV]
switch(t.placementType){case dH:return n===wj
case UW:return n===rP
case Vq:case cq:const r=e.baseFields[xj],o=t.adAdamId===r
return(n===_H||n===RF)&&!o
default:return n===OH}}(r,a)?"iAdSponsored":"iAdOriginated"
i.push({key:e,value:cW})}}if(s(i)){const t=i.map(e=>`${e.key}=${e.value}`).join(";"),r=null===(o=e.cryptography)||void 0===o?void 0:o.base64Encode(t);(0,Am.isSome)(r)&&n.set("extraInfo",r)}}(e,n,g,a),g.toString()}(e,T,t,a,u,d,h,v,g,c,m,A),t,c,0,p,w)}function gr(e,t,n){return ym.context("offerDataFromData",()=>{const r=Ze(e,t,bV,n)
if(0!==r.length)return r[0]})}function mr(e,t){const n=G(t,bV)
return 0===n.length?null:n[0]}function yr(e,t,n,o,a,c,l,u=kW,d,h,p){return ym.context(`offerActionFromOfferData: ${n.id}`,()=>{var w,v,g,m,y,A,T
let b=f(t,pV)
if(r(b))return void ym.unexpectedNull(gq,$W,WD)
if(n.type===JW&&(b.indexOf("rebuy")>=0?b=b.replace("rebuy=false",OP):(b.length>0&&(b+="&"),b+=OP)),s(l.inAppEventId)&&(b.length>0&&(b+="&"),b+=`mtInAppEventId=${l.inAppEventId}`),l.isAdvert){const e=null===(v=null===(w=l.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===v?void 0:v.placementId
i(e)&&(b.length>0&&(b+="&"),b+=`${RQ.placementId}=${e}`)
const t=null===(m=null===(g=l.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===m?void 0:m.containerId
i(t)&&(b.length>0&&(b+="&"),b+=`${RQ.containerId}=${t}`)
const n=null===(A=null===(y=l.pageInformation)||void 0===y?void 0:y.adPageInfo)||void 0===A?void 0:A.clickFields[rV]
i(n)&&(b.length>0&&(b+="&"),b+=`${RQ.templateType}=${n}`)}const S=n.id
if(r(S))return void ym.unexpectedNull(gq,$W,"item.offer.id")
const P=function(e,t,n,r,o,i,s,a,c,l){return ym.context("purchaseConfigurationFromProduct",()=>{var u
const d=j(t,cz)
let h=j(t,eq)
h||(h=kP)
const p=it(e).bundleIdFromData(t),w=kf(e,t),v=j(t,MS),g=Qe(e,t,"preflightPackageUrl"),m=ih(e,t),y=Mf(0,t,e.appleSilicon.isSupportEnabled),A=f(c,VW),T=f(c,JB),b=Mr(e,t)&&null!==(u=e.client.remoteDownloadIdentifiers)&&void 0!==u?u:[],S=function(e,t){return Xe(e,t,xq)}(e,t),P=ar(0,t,!0),C=new CQ(n,h,d,p,w,r,o,s,v,!1,g,m,y,!1,a.inAppEventId,A,T,void 0,Ff(e,t),l,b,S,P)
return C.pageInformation={...i},C.productVariantData=Ge(e,t),C.targetType=a.targetType,C.metricsKind=a.kind,C})}(e,n,b,o,l.excludeAttribution,l.pageInformation,c,l,d,h),C=Sr(e,t,S,P,a,u,null!==(T=l.isAdvert)&&void 0!==T&&T,p)
return function(e,t,n,r,o){var i,s,a,c,l
const u=n.pageInformation,d={...n,targetType:lz},f=Fh(e,d,null!==(i=t.title)&&void 0!==i?i:"")
let h=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:t.adamId;(0,Am.isSome)(n.targetId)&&(null===(c=n.targetId)||void 0===c?void 0:c.length)>0&&(h=n.targetId),ta(e,t,h,r,u,f,null!==(l=n.isAdvert)&&void 0!==l&&l,n.recoMetricsData,o,d)}(e,C,l,o,h),C})}function Ar(e,t){return r(t)||r(t.price)||0===t.price}function Tr(e,t){return ym.context("expectedReleaseDateFromData",()=>Oe(j(t,"offers.0.expectedReleaseDate")))}function br(e,t){const n=f(t,IH)
if(n===tx||n===HF||n===HH)return h(t,$N)}function Sr(e,t,n,r,o,i=kW,s=!1,a){return ym.context("offerActionFromOfferData",()=>{const c=f(t,IH),l=s&&i===kW&&(0,Am.isSome)(e.bag.adsOverrideLanguage)?e.adsLoc:e.loc
let u,d,h
switch(c){case"get":if(i===zV)u=e.loc.string(EP,"Get")
else{const e=qF
u=l.string(e)}break
case HH:u=i===zV?e.loc.string(DP,"Pre-Order"):l.string(qF)
break
default:u=c}const p=br(0,t)
p>0&&(d=p,h=f(t,zj))
const w=Oe(f(t,sG)),v=new cQ(u,n,r,a)
return v.price=d,v.priceFormatted=h,v.expectedReleaseDate=w,v.includeBetaApps=o,v})}function Pr(e,t,n,o,i,a=kW,c=null,l=!1){if((0,Am.isNothing)(t))return null
if(ch(0,n)){if(a===zV)return null
if(a===kW)return Jd(e,n,i,null)
const r=Qe(e,n,hW)
if(s(r)){const e=pr(iz,r)
if((0,Am.isSome)(e)){const n=new HJ(e)
return new WJ(t.adamId,n)}}}if(a===kW&&(n.type===JW||lh(e,n)||l))return Jd(e,n,i,null)
if(o&&"tv"!==e.client.deviceType&&!ih(e,n)){const o=function(e,t,n,o,i){if(r(t))return null
const s=Ir(e,n,t,!1,o)
return s.buyAction=t,s}(e,t,n,i)
if((0,Am.isSome)(o))return o}const u=Fe(e,n,zH),d=e.client.isCompanionVisionApp
if(!ih(e,n)&&(d||u&&e.client.deviceType!==zW))return function(e,t,n,r,o){const i=_r(e,t,n,r,o),s=new WJ(t.adamId,i)
return s.title=t.title,s}(e,t,n,Ar(0,t),ih(e,n))
if(Fe(e,n,Vj)&&"tv"!==e.client.deviceType)return function(e,t,n){const r=new $J(kW)
r.title=e.loc.string("Alert.Buy.TvOnly.Title"),r.message=e.loc.string("Alert.Buy.TvOnly.Message"),r.isCancelable=!0,r.buttonActions=n?[$r(e,t)]:[t],r.buttonTitles=[e.loc.string("Alert.Buy.TvOnly.ButtonTitle")]
const o=new WJ(t.adamId,r)
return o.title=t.title,o}(e,t,Xe(e,n,B$))
if(!Xe(e,n,WO)&&Xe(e,n,Tj)&&e.client.deviceType!==oz)return function(e,t){const n=new $J(kW)
n.title=e.loc.string("Alert.Buy.WatchOnly.Title"),n.message=e.loc.string("Alert.Buy.WatchOnly.Message"),n.isCancelable=!0,n.buttonActions=[t],n.buttonTitles=[e.loc.string("Alert.Buy.WatchOnly.ButtonTitle")]
const r=new WJ(t.adamId,n)
return r.title=t.title,r}(e,t)
const f=Qe(e,n,FN)
if(s(c)&&c===nJ&&(0,Am.isSome)(f)&&hh(e,f))return function(e,t,n){const r=new $J(kW)
r.title=e.loc.string("ProductPage.WatchOSUpdateRequired.Title").replace(Bj,n),r.message=e.loc.string("ProductPage.WatchOSUpdateRequired.Message").replace(Bj,n),r.buttonActions=[t],r.buttonTitles=[e.loc.string(gM)]
const o=new WJ(t.adamId,t)
return o.buyAction=r,o}(e,t,f)
if(function(e,t){return!!ih(e,t)}(e,n)){if(ih(e,n))return function(e,t,n,r,o,i,s){if(!ih(e,n))return t
switch(e.client.deviceType){case"tv":return function(e,t,n,r,o,i){var s,a,c,l
const u=Er(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=ir(o),p=new dQ(nz,o,e.bag.metricsTopic,n.id);(0,Am.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[Hq]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical]);(0,Am.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const v=new _J(vV)
if(v.pageData=p,i&&i.pageInformation&&(v.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),na(e,v,i),r){const t=Ir(e,n,f,!0,i)
t.buyAction=d
const r=Ir(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=null,t}{const o=new WJ(n.id,d),i=Er(e,t,v,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
case zW:return function(e,t,n,r,o,i){var s,a,c,l
const u=Dr(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=ir(o),p=new dQ(nz,o,e.bag.metricsTopic,n.id);(0,Am.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[Hq]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical]);(0,Am.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const v=new _J(vV)
if(v.pageData=p,i&&i.pageInformation&&(v.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),na(e,v,i),r&&(0,Am.isSome)(f)){const t=Ir(e,n,f,!0,i)
t.buyAction=d
const r=Ir(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=Or(e,v),t}{const o=new WJ(n.id,d),i=Dr(e,t,v,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
default:return function(e,t,n,r,o,i,s){var a,c,l,u
const d=ir(i),f=new dQ(nz,i,e.bag.metricsTopic,n.id);(0,Am.isSome)(null===(c=null===(a=s.pageInformation)||void 0===a?void 0:a.searchTermContext)||void 0===c?void 0:c.term)&&(f.metricsOverlay[Hq]=null===(l=s.pageInformation.searchTermContext)||void 0===l?void 0:l.term)
const h=null===(u=e.metricsIdentifiersCache)||void 0===u?void 0:u.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical]);(0,Am.isSome)(h)&&(f.metricsOverlay={...f.metricsOverlay,...h}),e.client.isCompanionVisionApp&&(0,Am.isNothing)(f.metricsOverlay[bG])&&(f.metricsOverlay[bG]=RY),d&&(f.purchaseSuccessAction=t,f.carrierLinkSuccessAction=t)
const p=new _J(vV)
if(p.pageData=f,s&&s.pageInformation&&(p.referrerUrl=s.pageInformation.pageUrl),s.actionDetails={buyParams:t.purchaseConfiguration.buyParams,...s.actionDetails},na(e,p,s),r&&Nn(t)){const r=Ir(e,n,t,!0,s)
r.buyAction=t
const o=Ir(e,n,t,!0,s)
return o.buyAction=t,r.subscribePageAction=o,t.buyCompletedAction=Or(e,p),r}const w=Fe(e,n,zH)
if(Mr(e,n)||w&&e.client.deviceType!==zW){const r=_r(e,t,n,!0,!0),o=_r(e,p,n,!0,!0),i=new WJ(n.id,r)
return i.subscribePageAction=new WJ(n.id,o),i}const v=new WJ(n.id,t)
return v.subscribePageAction=p,v}(e,t,n,r,0,i,s)}}(e,t,n,o,0,function(e,t,n){if(n)return ht(CN)
switch(t){case YH:return ht(YH)
case kW:case zV:return ht(R$)
default:return ht(lV)}}(0,a,o),i)
const s=function(e,t,n,o,i){return"tv"===e.client.deviceType?Er(e,t,null,n,o):{startAction:r(t)?null:t,underlyingOfferAction:null}}(e,t,n,o),c=s.startAction
if(o){const t=Ir(e,n,s.underlyingOfferAction,!1,i)
return t.buyAction=c,t}return c}return Rr(e,t,o,i)}function Cr(e,t,n,r,o,i,s=null){switch(r){case ht(YH):case ht(R$):const r=wf(e,t,{useCase:R3.LockupIconLarge}),a=ea(e,t,i)
return yr(e,gr(e,t),t,o,!1,_h(e,t,r,s),a,n)
default:return null}}function Ir(e,t,n,r,o){let i
if(r){const s=kr(e,t,n.purchaseConfiguration.appName,r,!0,o),a=kr(e,t,n.purchaseConfiguration.appName,r,!1,o)
i=new IQ(a,a,s,a)}else i=kr(e,t,n.purchaseConfiguration.appName,!1,!1,o)
return new WJ(t.id,i)}function kr(e,t,n,r,o,i){const s=new kQ(t.id,r)
let a,c,l,u
if(a=e.loc.string("CANCEL_COMING_SOON_TITLE"),e.client.isAutomaticDownloadingEnabled()&&(r&&o||!r)?(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON_DOWNLOAD"),l=e.loc.string("COMING_SOON_BODY_DOWNLOAD").replace(WF,n)):(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON"),l=e.loc.string("COMING_SOON_BODY").replace(WF,n)),c=e.loc.string("CANCEL_COMING_SOON_CANCEL"),e.client.deviceType===iz||"tv"===e.client.deviceType){const e=new $J(kW)
e.title=a,e.message=l,e.buttonActions=[s],e.isCancelable=!0,e.cancelTitle=c,e.destructiveActionIndex=0,u=e}else if(e.client.deviceType===zW){const t=new $J(kW)
t.title=a,t.artwork=kt(e,"systemimage://bell.slash.fill",95,90),t.message=l,t.buttonActions=[s],t.isCancelable=!0,t.cancelTitle=c,u=t}else{const e=new SQ([s])
e.title=a,e.message=l,e.isCancelable=!0,e.cancelTitle=c,e.isCustom=!1,e.destructiveActionIndex=0,u=e}ra(e,s,{...i,actionType:"cancelPreorder"})
const d=new tZ(t.id,VW),f=new WJ(t.id,u)
return f.openAction=d,f}function Or(e,t){const n=kt(e,"systemimage://checkmark",95,90),r=kt(e,ZA,95,90)
let o,i
o=new $J(sU),o.title="",o.artwork=n,e.client.isAutomaticDownloadingEnabled()?(o.message=e.loc.string(LR),o.toastDuration=2.5):(o.message=e.loc.string(LB),o.toastDuration=1.5)
{const n=new $J(sU)
n.title="",n.artwork=r,n.message=e.loc.string(LB),n.toastDuration=1.5
const o=new OQ(MR,new rZ([t,n]))
o.rateLimit=e.bag.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=n,i=o}const s=!e.client.isAuthorizedForUserNotifications()
return e.bag.newEventsForODJAreEnabled&&s?new IQ(new Pz,new Pz,new Pz,new Pz):new IQ(i,o,o,o)}function Er(e,t,n,o,s,a){if(r(t))return{startAction:null,underlyingOfferAction:null}
const c=new uQ,l=Ar(0,t),u=t.purchaseConfiguration.appName
c.shouldCheckForAvailableDiskSpace=!s,c.remoteControllerRequirement=VG,c.shouldCheckForGameController=Xe(e,o,B$)
const d=ar(0,o,!0)
if(i(d)&&(c.checkRestrictionsForContentRating=d),l){const t=s?e.loc.string("OfferAlert.TV.Title.PredorderFree"):e.loc.string("OfferAlert.TV.Title.Free")
c.title=t.replace(PG,u)}else{const n=s?e.loc.string("OfferAlert.TV.Title.PreorderPaid"):e.loc.string("OfferAlert.TV.Title.Paid")
c.title=n.replace(PG,u).replace(Zx,t.priceFormatted)}const f=S(t)
f.title=s?e.loc.string("OfferButton.Title.Preorder"):l?e.loc.string(qF):e.loc.string("OfferButton.Title.Buy")
const h=(0,Am.isNothing)(n)?f:n
c.completionAction=h,c.shouldIncludeActiveAccountInFooterMessage=!0
const p=[]
Xe(e,o,uD)&&p.push(e.loc.string("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases")),p.length>0&&(c.footerMessage=p.join(e.loc.string("TV_OFFER_ALERT_FOOTER_LINE_BREAK"))),c.impressionMetrics=f.impressionMetrics
const w=S(c)
w.shouldPromptForConfirmation=!1,w.title=void 0,w.footerMessage=void 0
const v=new WJ(t.adamId,w)
return ih(e,o)||(v.buyAction=c),v.openAction=t,{startAction:v,underlyingOfferAction:f}}function Dr(e,t,n,o,i,s){if(r(t))return{startAction:null,underlyingOfferAction:null}
const a=new uQ,c=Ar(0,t)
a.remoteControllerRequirement=fr(e,o),a.spatialControllerRequirement=hr(e)
const l=S(t)
l.title=i?e.loc.string("OFFER_BUTTON_TITLE_PREORDER"):c?e.loc.string("OFFER_BUTTON_TITLE_GET"):e.loc.string("OFFER_BUTTON_TITLE_BUY")
const u=(0,Am.isNothing)(n)?l:n
a.completionAction=u,a.impressionMetrics=l.impressionMetrics
const d=S(a)
d.shouldPromptForConfirmation=!1,d.title=void 0,d.footerMessage=void 0
const f=new WJ(t.adamId,d)
return f.buyAction=a,f.cancelAction=l,f.openAction=l,{startAction:f,underlyingOfferAction:l}}function Rr(e,t,n,o){if(r(t))return null
if(!e.bag.enableTwoPhaseOfferConfirmation||n)return t
const i=new Pz
i.impressionMetrics=t.impressionMetrics
const s=S(o)
r(s)||(s.actionType=vR,s.targetType=lz,ra(e,i,s))
const a=new lQ(t,i)
return a.confirmationAccessibilityAction=function(e,t){if(r(t))return null
const n=new $J(kW)
r(t.priceFormatted)?(n.title=e.loc.string(YB),n.message="Are you sure you want to get "+t.purchaseConfiguration.appName):(n.title="Buy App",n.message=`Are you sure you want to buy ${t.purchaseConfiguration.appName} for ${t.priceFormatted}`),n.isCancelable=!0,n.buttonActions=[t]
const o=new WJ(t.adamId,t)
return o.buyAction=n,o}(e,t),a}function _r(e,t,n,r,o){const i=new $J(kW)
return i.isCancelable=!0,i.buttonActions=[t],i.imageName="vision.pro",Mr(e,n)?r?(i.title=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Title"),i.message=o?e.loc.string("Alert.Buy.VisionOnly.Message.Arcade"):e.loc.string("Alert.Buy.VisionOnly.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.ButtonTitle")]),i}function Lr(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=kf(e,t).includes(zW)||function(e){return ue(e,AW,zO)}(t)
return!!n}function Mr(e,t){return!!Lr(e,t)&&Fr(e)}function Fr(e){return!((0,Am.isNothing)(e.client.remoteDownloadIdentifiers)||0===e.client.remoteDownloadIdentifiers.length)}function $r(e,t){const n=new $J(kW)
return n.title=e.loc.string("Alert.Buy.TvGameControllerRequired.Title"),n.message=e.loc.string("Alert.Buy.TvGameControllerRequired.Message"),n.buttonTitles=[e.loc.string("Alert.Buy.TvGameControllerRequired.ButtonTitle")],n.isCancelable=!0,n.buttonActions=[t],n}function xr(e,t,n,o,s,a,c,l,u,d,h=kW,p=!1,w=!1,v,g,m=!1){if(!r(t))return ym.context("displayPropertiesFromOfferAction",()=>{var r,a
let v=c
!m&&st(e,o,Im.Offers)&&(v=GG),m||rf(e,o)||(v=GG),m||!e.client.isCompanionVisionApp||Mr(e,o)||(v=GG)
const y=null!==(r=af(e,o))&&void 0!==r?r:g
let A
y&&(A=y.id)
let T=new VJ(n,t.adamId,t.bundleId,v,A,l)
T.isPreorder=s
const b=w&&h===kW&&(0,Am.isSome)(e.bag.adsOverrideLanguage),P=b?e.adsLoc:e.loc
if(T.useAdsLocale=b,s)if(ih(e,o))T.offerLabelStyle=CN,T.subtitles[sG]=vh(e,o,e.loc.string(Kx)),T.titleSymbolNames[RP]=Qx,T.titleSymbolNames[FR]="bell.fill",T.subtitles[sG]===e.loc.string(Bb)&&(T.subtitles[sG]=e.loc.string(Kx))
else{T.offerLabelStyle=HH,T.titleSymbolNames[rz]=Qx
const t=vh(e,o,"");(0,Am.isSome)(t)&&(T.subtitles[sG]=t)}const C=o.type===JW,I=Ar(0,t),k=I&&C&&!bh(e,o,!1)
let O
if(T.isFree=!k&&I,h===kW&&(o.type===JW||ch(0,o)||lh(e,o)||p))O=e.loc.string("OfferButton.Title.View")
else{if(h===zV&&(o.type===JW||ch(0,o)||lh(e,o)))return
O=h===_P?e.loc.string("OfferButton.Title.Select"):I?h===zV?s?e.loc.string(DP):e.loc.string(EP):t.title:h===zV?s?e.loc.string("OfferButton.FlowPreview.PreorderWithPrice").replace(Zx,t.priceFormatted):e.loc.string("OfferButton.FlowPreview.BuyWithPrice").replace(Zx,t.priceFormatted):t.priceFormatted}if(T.titles[rz]=O,T.priceFormatted=t.priceFormatted,e.bag.enableTwoPhaseOfferConfirmation&&h!==zV&&(T.titles[$R]=I?e.loc.string("OfferButton.Title.ConfirmGet"):e.loc.string("OfferButton.Title.ConfirmBuy")),ih(e,o))if(h===zV){const t=e.loc.string("OfferButton.FlowPreview.Arcade.Standard")
T.titles[rz]=t,T.titles[Xx]=t,T.titles[qH]=e.loc.string("OfferButton.FlowPreview.Arcade.Open"),T.titles[zF]=t,s&&(T.titles[LP]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderSubscribed"),T.titles[xR]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderNotSubscribed"))}else{const e=P.string("OfferButton.Arcade.Title.Standard")
T.titles[rz]=e,T.titles[Xx]=e,T.titles[qH]=P.string("OfferButton.Arcade.Title.Open"),T.titles[zF]=e,s&&(T.titles[LP]=P.string("OfferButton.Arcade.Title.PreorderSubscribed"),T.titles[xR]=P.string("OfferButton.Arcade.Title.PreorderNotSubscribed"),T.titles[RP]=P.string("OfferButton.Arcade.Title.PreorderedSubscribed"),T.titles[FR]=P.string("OfferButton.Arcade.Title.PreorderedNotSubscribed"))}if(u&&h!==zV){const t=f(u,SP),n=f(u,zj)
if(i(n)&&i(t)){let r=null,o=null
switch(t){case PP:d?(r=e.loc.string(NR),o=e.loc.string(NR)):(r=e.loc.string(NR),o=e.loc.string(YF))
break
case CP:const t=e.loc.string("OfferButton.IntroPrice.PaidUpfront.Trial").replace(Zx,n)
d?(r=t,o=t):(r=t,o=e.loc.string(YF))
break
case IP:r=e.loc.string(YF),o=e.loc.string(YF)}T.titles[BR]=r,T.titles[UR]=o,T.subtitles[BR]=e.loc.string(MP),T.subtitles[UR]=e.loc.string(MP)
const i=10
let s=!1
for(const e of Object.keys(T.titles))if(T.titles[e].length>i){s=!0
break}s&&(T=T.newOfferDisplayPropertiesChangingAppearance(!1,null,ES))}}const E=Xe(e,o,uD),D=nr(e,o),R=rr(e,KW),_=D&&R
if(T.hasInAppPurchases=E,T.hasExternalPurchases=_,E||_){const t=_?$P:FP,n=P.string(t)
T.subtitles[rz]=n,e.bag.enableTwoPhaseOfferConfirmation&&h!==zV&&(T.subtitles[$R]=n)}T.isDeletableSystemApp=it(e).isSystemAppFromData(o)&&!lh(e,o)
const L=ar(0,o,!0)
T.contentRating=L,T.appCapabilities=t.purchaseConfiguration.appCapabilities
const M=null!==(a=we(o,az))&&void 0!==a?a:[],F=[]
if((0,Am.isSome)(M))for(const t of M)bh(e,t)&&F.push(t.id)
return o.type===JW&&h!==zV&&(T.offerToken={offerAction:t,offerDisplayProperties:S(T),freeBundleId:k?t.adamId:void 0,supportedBundleChildrenIds:F.length>0?F:void 0}),T})}function Nr(e,t,n,o,i){return r(t)?null:ym.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const r=new VJ(n,t.adamId,t.bundleId,i),s=Ar(0,t)
r.isFree=s
let a=null
a=s?t.title:t.priceFormatted,r.titles[rz]=a,r.priceFormatted=t.priceFormatted
const c=o.hasInAppPurchases,l=o.hasExternalPurchases
if(r.hasInAppPurchases=c,r.hasExternalPurchases=l,l){const t=e.loc.string($P)
r.subtitles[rz]=t}else if(c){const t=e.loc.string(FP)
r.subtitles[rz]=t}return r.contentRating=o.contentRating,r.ignoresContentRestrictions=o.ignoresContentRestrictions,r.appCapabilities=t.purchaseConfiguration.appCapabilities,r})}function Br(e){return A(e)&&function(e){return(0,mm.isSome)(BQ[e])}(e[hz])}function Ur(e,t,n){return[...null!=e?e:[],{name:t,value:String(n)}]}function Gr(e,t){switch(j(t,PS)){case CS:return bY
case IS:return SY
case"RealityDevice":return e.bag.enableDeviceDrivenDiscoveryContent?_Y:null
default:return null}}function jr(e,t=!1){return{timeToLive:qr(e),nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:t}}function Vr(e,t){r(t)||r(e)||(r(t.nextPreferredContentRefreshDate)||e.getTime()<t.nextPreferredContentRefreshDate.getTime())&&e.getTime()>(new Date).getTime()&&(t.nextPreferredContentRefreshDate=e)}function Hr(e,t){if(!function(e){return e.bag.enableAutomaticPageRefresh}(e))return null
if(r(t))return null
let n,o=!1
if(i(t.timeToLive)&&i(t.nextPreferredContentRefreshDate)){const e=Wr(t.timeToLive)
e.getTime()<t.nextPreferredContentRefreshDate.getTime()&&e.getTime()>(new Date).getTime()?n=e:(n=t.nextPreferredContentRefreshDate,o=!0)}else if(i(t.timeToLive))n=Wr(t.timeToLive)
else{if(!i(t.nextPreferredContentRefreshDate))return null
n=t.nextPreferredContentRefreshDate,o=!0}if(n.getTime()<=(new Date).getTime())return null
const s=o&&t.refreshWhileVisibleForNextPreferredContentRefreshDate
return new HQ("timeToLive",0,null,n,s)}function qr(e){return e[Wm.contentMaxAge]}function Wr(e){const t=new Date
return t.setSeconds(t.getSeconds()+e),t}function zr(e,t){return t?[y0,O0]:[]}function Yr(e,t){return no(wX,t)}function Jr(e,t){return no(BX,t)}function Kr(e){return GX}function Zr(e){return VX}function Qr(e){return WX}function Xr(e){return ZX}function eo(e){return e0}function to(e,t){return e.client.isCompanionVisionApp?c0:no(a0,t)}function no(e,t){const n={...e}
return(0,mm.isSome)(t)&&(n.crops=t),n}function ro(e,t,n){const r=Ro(t,n.coercedCollectionTodayCardDisplayStyle),o=n.isHorizontalShelfContext?function(e,t){const n=[]
return n.push(to(e,[RA])),t.horizontalCardContentType===IU&&n.push(Kr()),n.push(Jr(0,["sr"]),Yr(0,["sr"])),n}(e,n):function(e,t,n){const r=new Set([Jm.List,Jm.NumberedList])
if(e.client.isPad&&n.isHeroCard&&!r.has(t))return zr(0,n.isHeroCard)
switch(t){case Jm.AppEventCard:return[Qr(),Xr(),eo(),to(e),...zr(0,n.isHeroCard),uX]
case Jm.AppOfTheDay:case Jm.GameOfTheDay:return[Qr(),Xr(),eo(),to(e),...zr(0,n.isHeroCard),iX]
case Jm.List:case Jm.NumberedList:return[kX,MX]
case Jm.ShortImage:return n.isSearchContext?[Yr(),Qr(),Xr(),eo(),to(e),...zr(0,n.isHeroCard),Kr(),Zr(),Jr()]:[Qr(),Xr(),eo(),to(e),...zr(0,n.isHeroCard),Kr(),Zr(),Yr(),Jr()]
case Jm.FullBleedImage:return[Qr(),Xr(),KQ,no(eX,undefined),eo(),to(e),...zr(0,n.isHeroCard),Kr(),Zr(),Jr(),Yr()]
case Jm.SingleApp:case Jm.Video:default:return[Qr(),Xr(),eo(),to(e),...zr(0,n.isHeroCard),Kr(),Zr(),Jr(),Yr()]}}(e,r,n)
let i,s=!1
const a=N(t)
if(W(a)&&(i=o.find(e=>(0,mm.isSome)(B(a,e.objectPath))),s=(0,mm.isSome)(i)),(0,mm.isNothing)(i)&&(i=o.find(e=>(0,mm.isSome)(B(t,e.objectPath)))),!i)return
const c=B(s?a:t,i.objectPath)
if(i.type===QV){const t=i.crops.map(t=>{let r=t
return n.isSearchContext&&(0,mm.isSome)(n.prevailingCropCodes)?r=n.prevailingCropCodes.defaultCrop:(0,mm.isSome)(n.prevailingCropCodes)&&(0,mm.isSome)(n.prevailingCropCodes[i.objectPath])&&(r=n.prevailingCropCodes[i.objectPath]),df(e,c,{withJoeColorPlaceholder:!0,cropCode:r,useCase:R3.TodayCardMedia,overrideHeight:i.sourceHeight,overrideWidth:i.sourceWidth})}),r=Ah(c)
return{artworks:t,videos:[],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:r}}{const t=p(c,Dj),r=h(t,rG),o=h(t,nj)>=r
let s=i.sourceHeight,a=i.sourceWidth
o&&([s,a]=[a,s])
const l=df(e,t,{withJoeColorPlaceholder:!0,cropCode:i.crops[0],useCase:R3.TodayCardMedia,overrideHeight:s,overrideWidth:a})
if((0,mm.isNothing)(l))return
let u={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0};(0,mm.isSome)(n.videoPlaybackControls)&&(u=n.videoPlaybackControls)
let d={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0};(0,mm.isSome)(n.videoPlaybackControls)&&(d=n.videoAutoplayPlaybackControls)
const w=f(c,Xq)
if((0,mm.isNothing)(w))return
const v=new wY(w,l,{playbackControls:u,autoPlayPlaybackControls:d,canPlayFullScreen:n.enableFullScreenVideo}),g=Ah(t)
return{artworks:[],videos:[v],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:g}}}function oo(e){return T(e)&&e[hz]===UO}function io(e,t=XU,n,r,o,i,s,a=lz){const c=oY.fromComponents(Cz,null,`/${_z.arcadeSeeAllGames}`,{sort:t}),l=new _J(XG,c.build())
return l.title=null!=o?o:e.loc.string(ex),ra(e,l,{id:null!=i?i:nT,idType:s,targetType:a,actionType:dz,actionContext:dW,pageInformation:n,locationTracker:r}),l}function so(e,t,n,r,o){var s,a,c,l
const u=new dQ(nz,t,e.bag.metricsTopic,n)
u.purchaseSuccessAction=r,u.carrierLinkSuccessAction=r
const d=new _J(vV);(0,mm.isSome)(null===(a=null===(s=null==o?void 0:o.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(u.metricsOverlay[Hq]=null===(c=o.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const f=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Om.user,Om.client])
return(0,mm.isSome)(f)&&(u.metricsOverlay={...u.metricsOverlay,...f}),d.pageData=u,i(o)&&na(e,d,o),d}function ao(e,t,n,r){{const e=new R0(nz)
return i(r)&&(e.popToRoot=r),new rZ([e])}}function co({objectGraph:e,metricsPageInformation:t,metricsLocationTracker:n,target:r={playNow:{}}}){const o=new _0(r)
return ra(e,o,{targetType:EW,id:kj,actionType:dz,pageInformation:t,locationTracker:n}),o}function lo(e,t,n,r){let o
o=kt(e,"resource://GameCenterEyebrow",16,16)
const i=e.featureFlags.isEnabled(SK),s=e.featureFlags.isEnabled(PK),a=e.featureFlags.isGSEUIEnabled(BK)
if(a){const r={eyebrowColor:Se(qN),includeSeparator:!i,prefersShelfHeader:s}
return{eyebrow:e.loc.string(rT),eyebrowArtwork:o,eyebrowArtworkType:Mm.Icon,title:t,subtitle:n,configuration:r}}{const c={eyebrowColor:a?Se(dM):void 0,includeSeparator:!i,prefersShelfHeader:s}
return(0,mm.isSome)(r)&&r?{title:t,titleArtwork:o,titleArtworkType:Mm.Icon,subtitle:n,configuration:c}:{eyebrow:e.loc.uppercased(e.loc.string(rT)),eyebrowArtwork:o,eyebrowArtworkType:Mm.Icon,title:t,subtitle:n,configuration:c}}}function uo(e,t=!1){let n=new cJ(e).forType(VH).includingAgeRestrictions()
return t&&(n=n.addingQuery(fM,dE)),n}function fo(e,t){return uo(e).withSparseLimit(t).asPartialResponseLimitedToFields([XW]).usingCustomAttributes(Ue(e))}function ho(e,t,n){return function(e,t,n){o(t)&&(t=ht(lV))
const r=new cJ(e).forType(vV).addingQuery("serviceType",nz).addingQuery("placement",t).includingMetaKeys(pH,[gV]).includingRelationships([sz]).includingAttributes([oT,fE]).includingAgeRestrictions()
return i(n)&&r.addingQuery(iT,n),r}(e,t,n)}function po(e,t){let n
const s=fe(t,sT)||fe(t,pH)
if(o(s)||o(null==s?void 0:s.data))return
const a=null==s?void 0:s.data.map(e=>e.type===pH?e:null).filter(e=>i(e))
if((0,mm.isNothing)(a)||0===a.length)return
const c=e.bag.marketingItemSelectionTimeout
if(1===a.length||0===c)n=a[0]
else try{n=e.arcade.getMarketingItemWithTimeout(a,c)}catch{n=a[0]}return r(n)?void 0:{marketingItemData:n}}function wo(e,t){if(!t)return
let n
const r=l(t,ZO)
return r.length>0&&(n=r[0]),i(n)?{marketingItemData:n}:void 0}function vo(e,t,n,r,o){const i=On(0,r)
if((0,mm.isSome)(i.suppressLockup)&&i.suppressLockup)return
let s
const a=(0,mm.isSome)(o)&&1===o.length,c=(0,mm.isSome)(o)&&o.length>1
return a?s=new VQ(o[0]):c&&(s=new E0(o)),s}function go(e,t,n,r,o,i,s){if(!H(o,cL))return
let a=po(e,o);(0,Am.isNothing)(a)&&(0,mm.isSome)(i)&&(a=wo(0,i.arcadeUpsellEditorialResponse))
const c=function(e,t,n,r,o,i,s){if(!function(e){const t=e.host.platform
return t===tH||t===KH}(e))return null
mo(e,t,n,r)
const a=Go(),c=Wd(e,i,s,ht(uV),a,EV)
return new D0(c)}(e,o,t,n,0,a,s)
if(c){t.overlay=c,t.impressionMetrics.fields[uP]=!0
const r=mo(e,o,t,n)
t.style!==r&&(t.style=r)}}function mo(e,t,n,r){const o=!r.enableListCardToMultiAppFallback,i=ro(e,t,r),s=Bo(null==i?void 0:i.joeColors)
return o?n.style:s}function yo(e,t,n){if((0,mm.isNothing)(t))return
const r=Nt(n.pageInformation)
if((0,mm.isNothing)(r))return
r.id=kh(n.id)
const o=Ph(n);(0,mm.isSome)(o)&&(r[jF]=o),r[IH]=Xq,r.typeDetails="iTunesStoreContent",r[JG]=Fh(e,n,""),n.actionDetails&&(r[Nj]=n.actionDetails),t.templateMediaEvent=function(e,t){const n={}
return Object.assign(n,t),n[UV]=QD,xt(e,n),Rt(0,new vZ(n,[],[],$t(e,n),Ft(e,n)))}(e,r)
const i=S(r)
i[IB]=t.videoUrl,t.templateClickEvent=function(e,t,n,r){const o={}
Object.assign(o,r),o[UV]=fj,o[Fx]=n,o[KD]=null
const i=[yG]
return xt(e,o),Rt(0,new vZ(o,i,[],$t(e,o),Ft(e,o)))}(e,0,lz,i)}function Ao(e,t){return u(t,L0)}function To(e,t,n,r,o){return ym.context("createTodayBaseCard",()=>{const i=new gZ,s=Ro(t,null==n?void 0:n.coercedCollectionTodayCardDisplayStyle),a=bo(e,t,s,n)
i.heading=a
const c=function(e,t,n){var r
let o
if((null==n?void 0:n.useOTDTextStyle)&&(o=null!==(r=j(t,"ofTheDayLabel"))&&void 0!==r?r:j(t,Gq),(0,Am.isSome)(o)&&(o=o.replace(/\n/g,Q$))),(0,Am.isNothing)(o)&&(o=sh(e,t,cz,!0)),(0,Am.isNothing)(o)){const e=So(0,t)
o=(0,Am.isSome)(e)?j(e,cz):void 0}return o}(e,t,n)
i.title=null!=c?c:void 0
const l=Qe(e,t,[Tx,cz])
i.shortTitle=l
const u=function(e,t){return df(e,B(t,ib),{contentMode:Pm.scaleAspectFit,allowingTransparency:!0,useCase:R3.TodayCardBrandedTitle})}(e,t)
i.titleArtwork=u
const d=function(e,t){var n
const r=On(0,t)
if(H(t,yD)||r.suppressNoteShort)return
let o=sh(e,t,qV,!0)
if((0,Am.isNothing)(o)&&!r.suppressNoteTagline){const r=So(0,t);(0,Am.isSome)(r)&&(o=null!==(n=sh(e,r,TV))&&void 0!==n?n:Ld(e,r))}return o}(e,t)
i.inlineDescription=d
const f=Eo(e,t,n,r,c)
return f.adSlotOverride=r.parsedCardCount,i.clickAction=function(e,t,n,r,o,i,s){var a
const c=i,l={cardType:n,franchise:j(t,Gq)},u=Ao(0,t)
return u&&(l[fP]=u),c[Nj]=l,(0,Am.isSome)(s)&&s(c),Qd(e,t,c,null!==(a=null==r?void 0:r.clientIdentifierOverride)&&void 0!==a?a:e.host.clientIdentifier,Zs(o.currentTodayItem),r)}(e,t,s,n,r,f,o),Zh(e,i,f,a,s,Ao(0,t)),i.editorialDisplayOptions=function(e,t,n){var r
const o=On(0,t),i=e.client.isPad&&(null==n?void 0:n.isHeroCard)
return{suppressTagline:V(t,yD),suppressLockup:g(o.suppressLockup),showBadgeInSmallCards:null!==(r=null==n?void 0:n.alwaysShowBadgeInSmallCards)&&void 0!==r?r:g(o.showBadgeInSmallCards),useMaterialBlur:(null==n?void 0:n.alwaysUseMaterialBlur)||i||g(o.useMaterialBlur)}}(e,t,n),i})}function bo(e,t,n,o){var i,s
let a
if(null==o?void 0:o.useOTDTextStyle)a=o.isHorizontalShelfContext?j(t,Gq):void 0
else if(function(e,t){let n=j(e,"ofTheDayIntent")
if((0,mm.isNothing)(n))switch(Ro(e,null==t?void 0:t.coercedCollectionTodayCardDisplayStyle)){case Jm.AppOfTheDay:n=Qm.AppOfTheDay
break
case Jm.GameOfTheDay:n=Qm.GameOfTheDay}return n===Qm.AppOfTheDay||n===Qm.GameOfTheDay}(t,o))a=null!==(i=j(t,W_))&&void 0!==i?i:j(t,Gq),r(a)&&n===Jm.AppOfTheDay?a="FEATURED APP":r(a)&&n===Jm.GameOfTheDay&&(a="FEATURED GAME")
else if(n===Jm.AppEventCard){const n=So(0,t);(0,Am.isSome)(n)&&(a=null!==(s=ah(e,t,KU,!0))&&void 0!==s?s:j(n,Dq))}else a=j(t,Gq)
return a}function So(e,t){const n=we(t,vq)
if(1===(null==n?void 0:n.length))return n[0]
const r=Lo(0,t)
return 1===r.length?r[0]:null}function Po(e,t,n,r,o){return ym.context("addArtworkMediaToBaseCard",()=>{if(H(t,fL))return!1
const i=ro(e,t,r)
return!(0,Am.isNothing)(i)&&((0,Am.isSome)(o)&&yo(e,null==i?void 0:i.videos[0],{pageInformation:o.pageInformation,locationTracker:o.locationTracker,id:t.id}),n.media=new $Q(i.artworks,i.videos,i.artworkLayoutsWithMetrics,xo(0,t,r)),n.style=Bo(i.joeColors,Jj),(0,Am.isSome)(n.clickAction)&&pt(n.clickAction)&&(n.overlay=new GQ(n.clickAction),n.style=lW),!0)})}function Co(e,t,n,r,o){return ym.context("createTodaySingleAppCard",()=>{const s=To(e,t,n,r)
Oo(e,t,n,r)
const a=Po(e,t,s,n,r),c=Lo(0,t),l=_o(e,c,n,r.pageInformation,r.locationTracker,EV,void 0,aa(0,t)),u=vo(0,0,0,t,l)
var d
return i(u)&&Br(d=u)&&d[hz]===rA&&(u.style=lW),s.overlay=u,a||1!==c.length||Io(e,t,s,c,n,r)?(go(e,s,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),s):(Do(r),null)})}function Io(e,t,n,r,o,i){if(1!==r.length)return!1
o.useJoeColorIconPlaceholder=!0,n.style=MW
const s=Go(0,n.style),a=_o(e,r,o,i.pageInformation,i.locationTracker,jo(n.style),s,aa(0,t))
if(1!==a.length)return!1
const c=a[0]
return n.media=new F0(c.icon),!0}function ko(e,t,n,a,c){return ym.catchingContext("todayCardFromData",()=>{var l
const d=Ro(t,n.coercedCollectionTodayCardDisplayStyle),f=Gr(e,t);(0,mm.isSome)(f)&&(function(e,t,n,r){var o
if(n===RY||n===_Y)return!0
const i=Lo(0,t),s=Ro(t,r.coercedCollectionTodayCardDisplayStyle)
if(!new Set([Jm.AppEventCard,Jm.Grid,Jm.InAppPurchase,Jm.List,Jm.NumberedList,Jm.River,Jm.ShortImage,Jm.SingleApp]).has(s))return!1
if(i.length>=6&&s===Jm.Grid)return!1
const a=Fo(0,s)
return!(!H(t,fL)&&$o(e,B(t,a),null===(o=r.prevailingCropCodes)||void 0===o?void 0:o.defaultCrop)||function(e,t){if(1===t.length){const e=t[0]
if(e.type===jq)return e}return null}(0,i))}(e,t,f,n)?n.clientIdentifierOverride=f:n.clientIdentifierOverride=void 0),n.crossLinkSubtitle=Ho(e,t)
let h=null
switch(d){case Jm.AppOfTheDay:case Jm.GameOfTheDay:h=function(e,t,n,r,i){return ym.context("createTodayBrandedCard",()=>{const s=To(e,t,n,r)
Oo(e,t,n,r)
const a=ro(e,t,n)
if(!((0,Am.isSome)(a)&&(0,Am.isSome)(a.joeColors.bgColor)&&(a.artworks.length>0||a.videos.length>0)))return Do(r),Co(e,t,n,r)
s.style=Bo(null==a?void 0:a.joeColors,Jj)
const c=Go(0,s.style),l=Lo(0,t),u=_o(e,l,n,r.pageInformation,r.locationTracker,jo(s.style),c,aa(0,t),!0)
if(o(u)||1!==u.length)return Do(r),null
n.isHorizontalShelfContext||(s.overlay=vo(0,0,0,t,u))
const d=u[0]
return s.media=new M0(d.icon,a.artworks,a.videos,a.artworkLayoutsWithMetrics,xo(0,t,n)),s.media.impressionMetrics=d.impressionMetrics,go(e,s,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Do(r),s})}(e,t,n,a,c)
break
case Jm.Video:h=function(e,t,n,r,o){return ym.context("createTodayVideoCard",()=>{const i=To(e,t,n,r)
Po(e,t,i,n,r),Oo(e,t,n,r)
const s=Go(0,i.style),a=Lo(0,t),c=_o(e,a,n,r.pageInformation,r.locationTracker,EV,s,aa(0,t)),l=vo(0,0,0,t,c)
return i.overlay=l,go(e,i,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),i})}(e,t,n,a,c)
break
case Jm.FullBleedImage:h=function(e,t,n,r,o){return ym.context("createTodayFullBleedImageCard",()=>{const i=To(e,t,n,r)
if(Oo(e,t,n,r),!Po(e,t,i,n,r))return Do(r),null
const s=Lo(0,t),a=Go(0,i.style),c=_o(e,s,n,r.pageInformation,r.locationTracker,jo(i.style),a,aa(0,t)),l=vo(0,0,0,t,c)
return i.overlay=l,go(e,i,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),i})}(e,t,n,a,c)
break
case Jm.InAppPurchase:h=function(e,t,n,r,i){return ym.context("createTodayInAppPurchaseCard",()=>{const s=To(e,t,n,r)
Oo(e,t,n,r)
const a=function(e,t){if(1===t.length){const e=t[0]
if(e.type===jq)return e}return null}(0,Lo(0,t))
if(o(a))return Do(r),null
const c=Bd(e,a,{offerStyle:AV,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker},artworkUseCase:R3.LockupIconSmall})
return o(c)?(Do(r),null):(c.theme=_q,s.media=new $0(c),s.media.impressionMetrics=c.impressionMetrics,s.media.impressionMetrics.fields[AF]=s.impressionMetrics.fields.id,s.style=lW,go(e,s,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Do(r),s)})}(e,t,n,a,c)
break
case Jm.AppEventCard:h=function(e,t,n,r,o){return ym.context("createTodayAppEventCard",()=>{var i,s,a,c,l
if(!li(e))return null
const d=function(e,t){let n
const r=we(t,vq)
if(r.length>0)n=r[0]
else{const e=we(t,Sq)
if(0===e.length)return null
n=e[0]}return n}(0,t)
if((0,Am.isNothing)(d))return null
const f=To(e,t,n,r,t=>{t.inAppEventId=d.id
const n=pe(e,d,VW);(0,mm.isSome)(n)&&(t.relatedSubjectIds=[n.id])});(0,mm.isSome)(f.editorialDisplayOptions)&&(f.editorialDisplayOptions.useMaterialBlur=!0),Oo(e,t,n,r)
const h=ro(e,t,n)
if((0,Am.isNothing)(h))return Do(r),null
const p=null!==(s=null===(i=h.joeColors)||void 0===i?void 0:i.textColor4)&&void 0!==s?s:dJ,w=be(null!==(c=null===(a=h.joeColors)||void 0===a?void 0:a.bgColor)&&void 0!==c?c:dJ)?MW:iW,v={pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:z$}
f.style=null!==(l=No(h.joeColors,iU))&&void 0!==l?l:be(p)?MW:iW
const g=Go(0,f.style),m=j(t,Gq),y=Ai(e,d,null,!1,!1,jo(f.style),g,!0,v,!0,!0,m,!1,u(n.allowUnpublishedAppEventPreviews))
if((0,Am.isNothing)(y)||y instanceof Date)return Vr(y,r.refreshController),Do(r),null
const A=y
return f.media=new jQ(A.formattedDates,A.startDate,p,h.artworks,h.videos,h.artworkLayoutsWithMetrics,w),(0,mm.isSome)(A.lockup)&&(f.overlay=new VQ(A.lockup)),go(e,f,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),f})}(e,t,n,a,c)
break
case Jm.List:case Jm.NumberedList:h=function(e,t,n,r,o){return ym.context("createTodayListCard",()=>{var i,s,a
const c=To(e,t,n,r)
Oo(e,t,n,r),n.useJoeColorIconPlaceholder=!0
let l=Lo(0,t)
const u=_o(e,l,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0)
if(0===u.length)return Do(r),null
if(n.canDisplayArcadeOfferButton=!1,u.length<function(e){return"tv"===e.client.deviceType?3:4}(e)&&n.enableListCardToMultiAppFallback)Mo(e,t,u,c)
else{if(Ro(t,n.coercedCollectionTodayCardDisplayStyle)===Jm.NumberedList){let e=1
for(const t of u)t.ordinal=`${e}`,e++}const r=ro(e,t,n),o=No(null==r?void 0:r.joeColors,Jj),l=!0
null==r||r.videos.forEach(e=>{e.canPlayFullScreen=!1,e.playbackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},e.autoPlayPlaybackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}}),c.style=l?void 0:lW,c.media=new x0(u,null!==(i=null==r?void 0:r.artworks)&&void 0!==i?i:[],null!==(s=null==r?void 0:r.videos)&&void 0!==s?s:[],null!==(a=null==r?void 0:r.artworkLayoutsWithMetrics)&&void 0!==a?a:[],void 0,l?o!==lW:o===MW)}return go(e,c,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),c})}(e,t,n,a,c)
break
case Jm.River:case Jm.Grid:h=function(e,t,n,r,o){return ym.context("createTodayRiverCard",()=>{const i=To(e,t,n,r)
n.useJoeColorIconPlaceholder=!0,Oo(e,t,n,r)
const s=function(e,t,n,r,o){const i=Lo(0,t).filter(t=>{const n=nh(e,t)
return!eh(e,t)||!n})
return _o(e,i,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0,!1)}(e,t,n,r)
return 0===s.length?(Do(r),null):(n.canDisplayArcadeOfferButton=!1,s.length<function(e){return"tv"===e.client.deviceType?2:4}(e)?Mo(e,t,s,i):(i.style=MW,function(e){for(const t of e)be(t.icon.backgroundColor,90)||(t.icon.backgroundColor=Ae(.8,.8,.8))}(s),i.media=new N0(s)),go(e,i,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),i)})}(e,t,n,a,c)
break
case Jm.SingleApp:h=Co(e,t,n,a,c)
break
case Jm.ShortImage:h=function(e,t,n,r,o){return ym.context("createTodayShortImageCard",()=>{const i=To(e,t,n,r)
Oo(e,t,n,r)
const s=Po(e,t,i,n,r)
let a=!1
const c=Lo(0,t),l=Go(0,i.style),u=_o(e,c,n,r.pageInformation,r.locationTracker,jo(i.style),l,aa(0,t)),d=vo(0,0,0,t,u)
return i.overlay=d,s||1!==c.length||(a=Io(e,t,i,c,n,r)),s||a?(go(e,i,n,Ro(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Do(r),i):(Do(r),null)})}(e,t,n,a,c)
break
default:h=null}return r(h)?(e.console.log(`Unknown style: ${d}`),h):(function(e,t,n,r){const o=Ro(r,n.coercedCollectionTodayCardDisplayStyle),s=Vo(e,r,n.heroDisplayContext,o,n.prevailingCropCodes)
let a=[],c=[]
var l
i(s)&&(a=[s]),i(t.media)&&(A(l=t.media)&&l[hz]===tA||function(e){return A(e)&&e[hz]===Qy}(t.media))&&(c=t.media.videos),new NQ(a,c)}(e,h,n,t),function(e){(0,mm.isSome)(e.clickAction)&&pt(e.clickAction)&&(e.overlay=new GQ(e.clickAction),e.style=lW)}(h),function(e,t){(0,mm.isNothing)(e.media)||(e.media.otdTextStyle=t.useOTDTextStyle)}(h,n),function(e,t){const n=t.media
if(!function(e){return A(e)&&function(e){return Object.values(LQ).includes(e)}(e[hz])}(r=n)||!function(e){return Object.values(_Q).includes(e)}(r[hz]))return
var r
const o=s(n.videos)
t.supportsMediaMirroring=o}(0,h),(0,mm.isNothing)(h.media)?(e.console.log(`Missing required media: ${d}`),h=null):(null===(l=null==h?void 0:h.media)||void 0===l?void 0:l.kind)&&(h.automationMetadata=Ur(h.automationMetadata,"todayCardMediaKind",h.media.kind)),h)},t=>(e.console.log(t),null))}function Oo(e,t,n,r,i){const a=s(i)?i:function(e,t,n){let r=sh(e,t,cz)
if(o(r))switch(n){case Jm.AppOfTheDay:case Jm.GameOfTheDay:r=j(t,Gq)}return r}(e,t,Ro(t,n.coercedCollectionTodayCardDisplayStyle))
xh(e,Eo(e,t,n,r,a),null!=a?a:"")}function Eo(e,t,n,r,o){var i
return ep(e,t,null!=o?o:"",{...null==n?void 0:n.baseMetricsOptions,targetType:EV,pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdEligible:null!==(i=null==n?void 0:n.isAdEligible)&&void 0!==i&&i,optimizationId:f(t,qI),optimizationEntityId:f(t,WI),rowIndex:null==n?void 0:n.currentRowIndex,displayStyle:null==n?void 0:n.metricsDisplayStyle})}function Do(e){Bh(e.locationTracker)}function Ro(e,t){const n=j(e,CB)
return B0.has(n)&&(0,mm.isSome)(t)?t:n}function _o(e,t,n,r,i,a,c,l,u=!0){return o(t)?[]:Yd(e,t.filter(e=>!s(e.attributes)||e.type!==jq),{lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},offerEnvironment:a,offerStyle:c,clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:l,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:R3.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,useJoeColorIconPlaceholder:n.useJoeColorIconPlaceholder,skipDefaultClickAction:!u},filter:Im.TodayCard})}function Lo(e,t){return we(t,Sq)}function Mo(e,t,n,r){const o=sh(e,t,qV)
if(r.media=new xQ(n,o),r.style=MW,(0,mm.isSome)(r.clickAction)&&ft(r.clickAction)){const e=oY.from(r.clickAction.pageUrl)
e.param(Hz.showingFallbackMedia,cW),r.clickAction.pageUrl=e.build()}}function Fo(e,t){switch(t){case Jm.AppOfTheDay:case Jm.GameOfTheDay:return lL
case Jm.AppEventCard:return uL
case Jm.Video:case Jm.FullBleedImage:return sF
default:return dL}}function $o(e,t,n){if(o(t))return null
const r=df(e,t,{withJoeColorPlaceholder:!0,useCase:R3.TodayCardMedia})
return r.crop=n||"sr",r}function xo(e,t,n){const r=B(t,Fo(0,Ro(t,n.coercedCollectionTodayCardDisplayStyle)))
if(i(r))return f(r,"bgGradientKind")}function No(e,t=Jj){if((0,mm.isNothing)(e))return
if((0,mm.isSome)(null==e?void 0:e.textGradient)&&2===e.textGradient.length)return be(e.textGradient[0])?lW:MW
const n=e[t]
if((0,mm.isNothing)(n))return
const r=Te(n)
return r<=.1?MW:r>=.84?lW:iW}function Bo(e,t=Jj){var n
return null!==(n=No(e,t))&&void 0!==n?n:iW}function Uo(e,t){return i(t.heading)?t.heading.replace(/\n/g," "):t.collapsedHeading}function Go(e,t){return wV}function jo(e){return e===lW?iW:EV}function Vo(e,n,r,o,i){const s=function(e,t,n,r){return t===vW?Fo(0,n):"editorialArtwork.crossoverCard"}(0,r,o,Object.keys(B(n,RW)))
return $o(e,B(n,s),function(e,t,n,r){return ty.Article,ty.Article,null==r?void 0:r.defaultCrop}(0,0,t(s),i))}function Ho(e,t){let n=ah(e,t,qV)
if(s(n)||(n=sh(e,t,cz)),!s(n)){const e=j(t,Aq)
e!==Jm.AppOfTheDay&&e!==Jm.GameOfTheDay||(n=j(t,Gq))}return n}function qo(e,t,n){const r=j(t,n)
if(o(r))return null
const s=new oY(r)
let a=null
switch(e.host.clientIdentifier){case rJ:a=eW
break
case nJ:a=oz}a&&s.param(Qz,a)
const c=Ve(Ge(e,t))
return i(c)&&s.param(Hz.productVariantID,c),s.toString()}function Wo(e,t,n){if(o(t))return null
const r=new XK(t)
return r.title=null!=n?n:e.loc.string("ShareSheet.CopyLink.Title"),r.artwork=kt(e,"systemimage://link"),new gQ("com.apple.AppStore.copyLinkActivity",r)}function zo(e,t,n){return ym.context("shareSheetDataForProductFromProductData",()=>{if(r(t))return null
const o=qo(e,t,BW),s=j(t,cz),a=j(t,eq),c=t.id,l=e.client.storefrontIdentifier
if(!(o&&s&&a&&c))return null
const u=qo(e,t,"shortUrl")
let d=null,f=null
const h=Qe(e,t,Pq)||a
let p
const w=Fe(e,t,iz)
Me(e,t,iz),p=w?JO:tH,i(t)&&j(t,BW)&&(d=wf(e,t,{useCase:R3.LockupIconSmall},n),f=function(e,t){return ym.context("notesMetadataFromProductData",()=>{var n
if(r(t))return null
const o=j(t,cz)
if((0,mm.isNothing)(o)||0===o.length)return null
const i=qo(e,t,BW),s=j(t,eq),a=j(t,"genreNames.0"),c=null===(n=Hf(e,t))||void 0===n?void 0:n.fileSizeByDevice
let l
switch(t.type){case az:l=VW
break
case JW:l=bO
break
case jq:l=qG
break
default:l=null}return new vQ(o,i,s,a,c,l)})}(e,t))
const v=new bQ(c,l,s,p,d,[],[],!1,h,null,null,f)
return new yQ(v,o,u)})}function Yo(e,t,n,o,s){return ym.context(`shareActionFromData: ${t.type}`,()=>{var a
const c=t.id
switch(e.client.deviceType){case iz:{const r=zo(e,t)
if(r){const t=new nQ(r,[])
return ra(e,t,{targetType:lz,id:c,actionType:QB,pageInformation:n,locationTracker:o}),t}break}case ZW:case HW:case zW:{const l=zo(e,t,s),u=[]
if((null===(a=null==l?void 0:l.url)||void 0===a?void 0:a.length)>0){const t=Wo(e,l.url)
i&&u.push(t)}const d=function(e,t){if(!e.bag.isContentGiftingEnabled)return null
if(r(t))return null
const n=gr(e,t)
return r(n)||V(t,uW)?null:h(n,$N)>0?t.id:null}(e,t)
if(d){const t=new _J(fV)
t.presentationContext=XB,t.title=e.loc.string("SHARE_GIFT_APP"),t.artwork=kt(e,"systemimage://app.gift"),t.pageUrl=`gift/${d}`,ra(e,t,{targetType:lz,id:c,actionType:LN,actionContext:LA,pageInformation:n,locationTracker:o})
const r=new gQ("com.apple.AppStore.giftActivity",t)
u.push(r)}if(l){const t=new nQ(l,u,vA)
return t.title=e.loc.string("SHARE_APP"),t.artwork=kt(e,KO),ra(e,t,{targetType:lz,id:c,actionType:QB,actionContext:LA,pageInformation:n,locationTracker:o}),t}if(u.length>0){const t=u.map(e=>e.action),r=new SQ(t)
return r.isCancelable=!0,r.isCustom=!0,ra(e,r,{targetType:lz,id:c,actionType:"actionSheet",pageInformation:n,locationTracker:o}),r}break}}return null})}function Jo(e,t,n){if((0,mm.isNothing)(t))return null
const r=t.match(/P(\d+)([A-Z]+)/)
if(!r||3!==r.length)return null
let o=h(r[1]),i=r[2]
return o&&i?("D"===i&&o>0&&o%7==0&&(i="W",o/=7),new H0(o,null!=n?n:1,i)):null}function Ko(e,t){var n,r
const o=l(t,HD)[0]
if(!o)return null
const i=f(o,KG),s=h(o,ZG),a=f(t,KG),c=h(t,ZG)
if(!i||!a)return null
const u=f(o,SP),d=Jo(0,i,s),p=Jo(0,a,c),w=null===(n=f(o,zj))||void 0===n?void 0:n.replace(/ /g,"\xa0"),v=null===(r=f(t,zj))||void 0===r?void 0:r.replace(/ /g,"\xa0")
let g=Zo(e,p.type,p.periodDuration,v)
switch(g=g.replace(/\//g,"\u2060/\u2060"),u){case PP:const t=Qo(e,d.type,d.periodDuration*d.periodCount)
if(t&&g)return e.loc.string("InAppOfferPage.Description.FreeTrialTemplate").replace(RR,t).replace(_R,g)
break
case CP:const n=Qo(e,d.type,d.periodDuration*d.periodCount)
if(n&&g)return e.loc.string("InAppOfferPage.Description.PaidUpFrontTemplate").replace(RR,n).replace("@@trialPrice@@",w).replace(_R,g)
break
case IP:const r=Zo(e,d.type,d.periodDuration,w),o=Qo(e,d.type,d.periodDuration*d.periodCount)
if(o&&g)return e.loc.string("InAppOfferPage.Description.PaidTrialTemplate").replace("@@trialPriceDuration@@",r).replace(RR,o).replace(_R,g)
break
default:return null}return null}function Zo(e,t,n,r){let o
switch(t){case"D":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Days.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Days",n)
break
case"W":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Weeks.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Weeks",n)
break
case"M":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Months.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Months",n)
break
case"Y":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Years.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Years",n)}return o.replace("@@price@@",r)}function Qo(e,t,n){switch(t){case"D":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Days.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Days",n)
case"W":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Weeks.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Weeks",n)
case"M":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Months.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Months",n)
case"Y":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Years.one").replace(QG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Years",n)}return null}function Xo(e,t){var n,r,i
const s=pe(e,t,ZU)
if((0,Am.isNothing)(s))return
const a=gr(e,s),c=p(s,MN)
if(o(a)||o(c))return
const l=null===(n=ei(e,f(a,KG),h(a,ZG),f(a,zj)))||void 0===n?void 0:n.replace("/","/\u2060"),u=null===(r=ei(e,f(c,KG),h(c,ZG),f(c,zj)))||void 0===r?void 0:r.replace("/","/\u2060")
if(o(l)||o(u))return null
const d=j(t,cz),w={"@@discountedPrice@@/@@recurringSubscriptionPeriod@@":u,"@@regularPrice@@/@@recurringSubscriptionPeriod@@":l,"@@discountedPricePerRecurringSubscriptionPeriod@@":u,"@@regularPricePerRecurringSubscriptionPeriod@@":l}
let v=null!=d?d:""
Object.keys(w).forEach(e=>{v=v.replace(e,w[e])})
const g=v.replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,""),m=new V0(v,hH,QA),y=null!==(i=j(t,Sj))&&void 0!==i?i:"",A=e.loc.string("ContingentOffer.Description.Format"),T={"@@BranchName@@":j(s,cz),"@@RegularPrice@@":l,"@@DiscountedPrice@@":u}
let b=A
return Object.keys(T).forEach(e=>{b=b.replace(e,T[e])}),{title:m,rawTitle:g,description:[b,y].join(" ")}}function ei(e,t,n,r){const o=Jo(0,t,n)
if(!(0,Am.isNothing)(o)&&!(0,Am.isNothing)(r))return Zo(e,o.type,o.periodDuration,r)}function ti(e,t,n,r,o){let i
switch(t){case JU:i=dz
break
case YU:i=YU
break
case cM:i=Wj}const s={targetType:lz,actionType:i,targetId:t,idType:void 0,location:Fh(e,{pageInformation:n,locationTracker:r,targetType:lz,id:t},null!=o?o:t)}
return _t(e,t,lz,s)}function ni(e,t,n,r){const o=Jo(0,t,n)
return(0,Am.isNothing)(o)||(0,Am.isNothing)(r)?null:Zo(e,null==o?void 0:o.type,null==o?void 0:o.periodDuration,r)}function ri(e,t,n,r,o){let i
switch(t){case JU:i=dz
break
case YU:i=YU
break
case cM:i=Wj}const s={targetType:lz,actionType:i,targetId:t,idType:void 0,location:Fh(e,{pageInformation:n,locationTracker:r,targetType:lz,id:t},null!=o?o:t)}
return _t(e,t,lz,s)}function oi(e){switch(e.type){case tz:return zm.AppEvent
case fH:return zm.ContingentOffer
case $H:return zm.OfferItem
default:return null}}function ii(e){switch(e.type){case tz:return z$
case fH:case $H:return oE
default:return null}}function si(e){switch(e.type){case tz:return KA
case fH:case $H:return"contingentPriceOffer"
default:return null}}function ai(e,t,n,s,a,c,l,u,d,w,g,m,y,A){const T=oi(t),b={...d,targetType:ii(t)}
switch(T){case zm.AppEvent:return Ai(e,t,n,s,a,c,l,u,b,w,g,m,y,A)
case zm.ContingentOffer:return function(e,t,n,s,a,c,l,u){var d,f,h,w
if(t.type!==fH)return null
const g=hi(e,t,V$)
if(r(g))return null
const m=be(g.backgroundColor)?MW:iW,y=j(t,KU),A=j(t,Pq),T=j(t,Gq),b=e.loc.string("ContingentOffer.AdditionalInfoButton.Title")
if((0,Am.isNothing)(y)||(0,Am.isNothing)(T))return null
const S=pe(e,t,ZU)
if((0,Am.isNothing)(S)||o(p(S,MN)))return null
const P=Xo(e,t)
if((0,Am.isNothing)(P)||(0,Am.isNothing)(null==P?void 0:P.title))return null
const C=pe(e,t,J$),I=H(C,VN),k=wi(e,t,C,"",s,a,!1,c,l,null,u,!0)
if((0,Am.isNothing)(k))return null
const O=pe(e,t,aE)
let E;(0,Am.isSome)(O)&&(0,Am.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(d=hi(e,O,XW))&&void 0!==d?d:fi(e,O,XW)),(0,Am.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(f=function(e,t){var n,r
const o=v(t,"meta.associations.trunks")
if((0,Am.isNothing)(o))return
const i=o.data[0]
if(null!==(r=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n[cE])&&void 0!==r&&r){const t=Ke(e,i,lE)
if((0,Am.isNothing)(t))return
return df(e,t,{useCase:R3.LockupIconSmall,style:aU})}}(e,t))&&void 0!==f?f:E)
const D=function(e,t,n){const r=K$+j(n,cz)+Z$,o=j(n,Sj)+Q$,i=K$+e.loc.string("ContingentOffer.Terms.Title")+Z$,s=j(t,HN)
return new V0([r,o,i,s].join(Q$),hH)}(e,t,S),R=new j0(g,m,I,b,P.title,null!=A?A:void 0,null!==(h=P.description)&&void 0!==h?h:void 0,T,y,D,null!=E?E:void 0,k)
return R.title=null!==(w=P.rawTitle)&&void 0!==w?w:void 0,i(C)&&(R.clickAction=gi(e,t,C,R,c,l)),R}(e,t,0,c,l,b,g,y)
case zm.OfferItem:return function(e,t,n,s,a,c,l,u){var d,w,v,g,m,y
if(t.type!==$H)return null
const A=j(t,Dq)
if("resubscription"!==A&&A!==X$)return null
const T=iW,b=pe(e,t,QU)
if((0,Am.isNothing)(b))return null
const S=p(b,ZL),P=gr(e,b)
if((0,Am.isNothing)(S))return null
const C=null!==(d=null!=n?n:pe(e,t,VW))&&void 0!==d?d:pe(e,b,VW),I=H(C,VN),k=j(t,lM)
if((0,Am.isNothing)(k)||!function(e){if((0,Am.isNothing)(e)||o(e))return!1
const t=new Date(e)
if(r(t))return!1
const n=new Date
return!(t.getTime()<=n.getTime())}(k))return null
const O=new Date(k)
let E=function(e,t){if((0,Am.isNothing)(t))return null
const n=De(t),o=new Date,i=function(e,t){if(!r(e)&&!r(t))return Math.floor((t.getTime()-e.getTime())/864e5)}(o,n)
if((0,Am.isNothing)(i))return null
const s=function(e,t){var n,r
return(null===(n=De(e))||void 0===n?void 0:n.getTime())===(null===(r=De(t))||void 0===r?void 0:r.getTime())}(o,t)
if(i>90)return e.loc.string(eT)
if(i>5){const n=o.getFullYear()!==t.getFullYear()?e.loc.string("OfferItems.FormattedDate.NextYear.DateFormat"):e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.DateFormat"),r=e.loc.uppercased(e.loc.formatDate(n,t))
return(0,Am.isNothing)(r)?null:e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.Title").replace(tT,r)}return i>1?e.loc.string("OfferItems.FormattedDate.FiveDaysOrLess.Title").replace(QG,e.loc.formattedCount(i)):1!==i||s?e.loc.string("OfferItems.FormattedDate.Today.Title"):e.loc.string("OfferItems.FormattedDate.Tomorrow.Title")}(e,O);(0,Am.isNothing)(E)&&(E=e.loc.string(eT))
let D=wf(e,b,{useCase:R3.LockupIconLarge,withJoeColorPlaceholder:!0,overrideTextColorKey:iU})
o(D)&&(D=kt(e,uE,200,200,{type:PH,red:0,green:0,blue:0,alpha:1}),D.style=qG)
const R=Jo(0,f(S,KG),h(S,ZG)),_=(0,Am.isSome)(R)?Qo(e,R.type,R.periodDuration*R.periodCount):void 0,L=null===(w=ni(e,f(P,KG),h(P,ZG),f(P,zj)))||void 0===w?void 0:w.replace("/","/\u2060"),M=null===(v=ni(e,f(S,KG),h(S,ZG),f(S,zj)))||void 0===v?void 0:v.replace("/","/\u2060"),F=e.loc.string(XA),$={"@@redemptionDate@@":e.loc.formatDate(F,O),"@@skuName@@":null!==(g=j(b,cz))&&void 0!==g?g:"@@skuName@@","@@discountedPrice@@":null!=M?M:"@@discountedPrice@@","@@regularPricePerDuration@@":null!=L?L:"@@regularPricePerDuration@@","@@discountDuration@@":null!=_?_:"@@discountDuration@@","@@payUpfrontPrice@@":null!==(m=f(S,zj))&&void 0!==m?m:"@@payUpfrontPrice@@"},x=j(t,KU)
if((0,Am.isNothing)(x))return null
const N=yi(j(t,FW),$),B=new V0(N,hH,QA),U=yi(j(t,Pq),$),G=yi(null!==(y=j(t,uM))&&void 0!==y?y:"",$)
let V
if(i(C)&&(V=wi(e,t,C,"",s,a,!1,c,l,null,u,!0)),(0,Am.isNothing)(V))return null
const q=new q0(null,null,T,I,B,E,U,G,x,O,D,V)
return q.title=N,i(C)&&(q.clickAction=gi(e,t,C,q,c,l)),q}(e,t,n,c,l,b,g,y)
default:return null}}function ci(e,t,n,o,a,c,l,u){const d=oi(t),f={...a,targetType:ii(t)}
switch(d){case zm.AppEvent:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=fi(e,t,YG),p=pi(e,t,rU,!0,!0),w=S(o),v=null!==(d=null==p?void 0:p.preview)&&void 0!==d?d:h
let g=MW,m=!0,y=!1
i(v)&&(m=be(v.backgroundColor),y=be(v.backgroundColor,10),g=m?MW:iW)
const A=zn(0,zm.AppEvent,t.id,n.id,l,null!==(f=a.recoMetricsData)&&void 0!==f?f:null),T={...a,pageInformation:A,locationTracker:{rootPosition:0,locationStack:[]},targetType:oU},b={...T,id:n.id,inAppEventId:t.id,relatedSubjectIds:[n.id]}
w.notificationConfig=vi(e,t,o,b,!1)
const P=function(e,t,n,r){var o,s
const a=j(t,BW)
if((0,mm.isNothing)(a)||0===a.length)return
const c=null!==(o=n.moduleArtwork)&&void 0!==o?o:null===(s=n.moduleVideo)||void 0===s?void 0:s.preview
let l=e.loc.string(YA)
l===YA&&(l=n.subtitle)
const u=function(e,t,n,r,o,i){return ym.context("shareSheetDataForAppEvent",()=>{const e=new AQ(t,n,i)
return new yQ(e,r,void 0)})}(0,n.title,l,a,0,c)
if(!i(u))return
const d=function(e,t,n){var r
const o=[]
if((null==n?void 0:n.length)>0){const t=Wo(e,n)
i&&o.push(t)}if(t.startDate.getTime()<=Date.now())return o
if(e.host.clientIdentifier===sJ)return o
const s=new $J(kW)
s.title=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_TITLE"),s.message=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_DETAIL"),s.isCancelable=!0,s.buttonTitles=[e.loc.string(_A)],s.buttonActions=[new HJ("prefs:root=Privacy&path=CALENDARS",!0)]
let a=!1
if(i(t.endDate)){const e=De(t.startDate),n=De(t.endDate),r=t.endDate.getTime()-t.startDate.getTime(),o=216e5
n.getTime()>e.getTime()&&r>o&&(a=!0)
const i=8634e4
e.getTime()===n.getTime()&&r>=i&&(a=!0)}const c=new TQ(t.startDate,t.endDate,a,t.title,null===(r=t.lockup)||void 0===r?void 0:r.title,t.detail,n,s,YO)
c.title=e.loc.string("SHARE_SHEET_ADD_TO_CALENDAR"),c.artwork=kt(e,"systemimage://calendar.circle")
const l=new gQ("com.apple.AppStore.createCalendarEventActivity",c)
return o.unshift(l),o}(e,n,a),f=new nQ(u,d)
return ra(e,f,{...r,targetType:KW,actionType:QB,idType:yW}),f}(e,t,o,b),C=m?MW:iW,I=wi(e,t,n,w.title,C,wV,!1,T,c,l,!1,!1)
if(r(I))return null
w.lockup=I
const k=new tQ(w,h,p,P,g,y)
return Vn(e,k,A,e=>{s(l)&&vz.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),k}(e,t,n,o,a,l,u),f=new _J("appEventDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case zm.ContingentOffer:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=hi(e,t,YG),p=S(o)
let w=MW,v=!0
i(h)&&(v=be(h.backgroundColor),w=v?MW:iW)
const g=zn(0,zm.ContingentOffer,t.id,n.id,l,null!==(d=a.recoMetricsData)&&void 0!==d?d:null),m={...a,pageInformation:g,locationTracker:{rootPosition:0,locationStack:[]}},y=v?MW:iW,A=wi(e,t,n,null!==(f=p.title)&&void 0!==f?f:void 0,y,wV,!1,m,c,l,!1,!1)
if(r(A))return null
p.offerLockup=A,p.trunkAppIcon=o.trunkAppIcon
const T=new sQ(p,null!=h?h:void 0,w)
return T.backButtonActionMetrics.addMetricsData(ti(e,YU,g,m.locationTracker)),T.learnMoreActionMetrics.addMetricsData(ti(e,JU,g,m.locationTracker,o.learnMoreTitle)),T.closeButtonActionMetrics.addMetricsData(ti(e,cM,g,m.locationTracker)),Vn(e,T,g,e=>{s(l)&&vz.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),T}(e,t,n,o,a,l,u),f=new _J("contingentOfferDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case zm.OfferItem:return function(e,t,n,o,i,a,c,l){const u=function(e,t,n,o,i,a,c,l){var u,d
let f=hi(e,t,YG)
f=void 0
const h=MW,p=S(o),w=zn(0,zm.OfferItem,t.id,n.id,c,null!==(u=i.recoMetricsData)&&void 0!==u?u:null),v={...i,pageInformation:w,locationTracker:{rootPosition:0,locationStack:[]}},g=MW,m=wi(e,t,n,null!==(d=p.title)&&void 0!==d?d:void 0,g,wV,!1,v,a,c,!1,!1)
if(r(m))return null
p.offerLockup=m
const y=e.loc.string("Winback.AdditionalInfoButton.Title"),A=pe(e,t,QU),T=j(t,lM)
let b;(0,Am.isSome)(T)&&(0,Am.isSome)(A)&&(b=function(e,t,n,r){if((0,Am.isNothing)(n))return
const o=j(n,cz),i=(0,Am.isSome)(o)?K$+o+Z$:void 0,s=j(n,Sj),a=(0,Am.isSome)(s)?s+Q$:void 0,c=K$+e.loc.string("Promotion.Terms.Title")+Z$
let l
const u=e.loc.string(XA)
if((0,Am.isSome)(o)&&(0,Am.isSome)(r)){const n={"@@redemptionDate@@":e.loc.formatDate(u,r),"@@skuName@@":o}
l=yi(j(t,HN),n)}const d=[i,a,c,l].filter(Am.isSome).join(Q$)
return new V0(d,hH)}(e,t,A,new Date(T)))
const P=new aQ(p,void 0,void 0,h,!1,y,b)
return P.backButtonActionMetrics.addMetricsData(ri(e,YU,w,v.locationTracker)),P.learnMoreActionMetrics.addMetricsData(ri(e,JU,w,v.locationTracker,y)),P.closeButtonActionMetrics.addMetricsData(ri(e,cM,w,v.locationTracker)),Vn(e,P,w,e=>{s(c)&&vz.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),P}(e,t,n,o,i,c,l),d=new _J("offerItemDetail")
return d.title=o.title,d.pageData=u,d.animationBehavior=a,i&&i.pageInformation&&(d.referrerUrl=i.pageInformation.pageUrl),d}(e,t,n,o,f,c,l,u)
default:return null}}function li(e){return e.bag.enableAppEvents&&!0}function ui(e){return e.bag.enableContingentOffers&&!0}function di(e){return e.bag.enableOfferItems&&!0}function fi(e,t,n){const r=B(t,n)
if(!(0,mm.isNothing)(r))return df(e,r,{useCase:R3.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function hi(e,t,n){const r=tt(e,t)
if((0,mm.isNothing)(r))return
const o=se(t,r,n)
return(0,mm.isNothing)(o)?void 0:df(e,o,{useCase:R3.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function pi(e,t,n,o,i){const s=fi(e,t,`${n}.previewFrame`)
if(r(s))return
const a=j(t,`${n}.video`)
if(r(a))return
const c=new wY(a,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:o,playbackControls:i?{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}:{},autoPlayPlaybackControls:i?{muteUnmute:!0}:{}})
return c.canPlayFullScreen=o,c.allowsAutoPlay=!0,c.looping=!0,c}function wi(e,t,n,i,s,a,c,l,u,d,f,h){var p,w,v,g
if((0,mm.isNothing)(t)||(0,mm.isNothing)(n))return null
const m=oi(t),y={...l,id:t.id,relatedSubjectIds:[n.id],idType:yW},A={...l,id:n.id,relatedSubjectIds:[n.id],targetType:KW,idType:yW,kind:null,softwareType:null,title:null!==(p=j(n,cz))&&void 0!==p?p:"",excludeAttribution:o(d)}
if(m===zm.AppEvent&&(y[Y$]=t.id,A[Y$]=t.id),(g=l)&&Object.prototype.hasOwnProperty.call(g,"id")&&(y.id=l.id,y.idType=l.idType),h){const n=m===zm.ContingentOffer?null===(w=Xo(e,t))||void 0===w?void 0:w.rawTitle:j(t,cz)
xh(e,y,null!=n?n:"")}const T=j(t,sM),b={metricsOptions:A,artworkUseCase:R3.LockupIconSmall,externalDeepLinkUrl:null!=T?T:void 0,crossLinkSubtitle:c?i:void 0,offerEnvironment:s,offerStyle:a,skipDefaultClickAction:!u,includeBetaApps:!0,referrerData:null!=d?d:void 0,shouldHideArcadeHeader:e.featureFlags.isEnabled(bK)&&f,parentAppData:n,useJoeColorIconPlaceholder:!0,overrideArtworkTextColorKey:iU},S=Nd(e,m===zm.AppEvent?n:t,b)
return h&&Bh(l.locationTracker),r(S)?null:(c&&(S.crossLinkTitle=null!==(v=e.loc.uppercased(S.title))&&void 0!==v?v:void 0),S)}function vi(e,t,n,r,o){if(n.startDate.getTime()<=Date.now())return null
if((0,mm.isNothing)(n.lockup))return null
const i=e.loc.string("APP_EVENTS_NOTIFICATION_TITLE").replace("{appTitle}",n.lockup.title),s=e.loc.string("APP_EVENTS_NOTIFICATION_DETAIL").replace("{eventTitle}",n.title),a=n.startDate,c=n.lockup.icon,l=n.lockup.icon.template.replace("{w}",`${c.width}`).replace("{h}",`${c.height}`).replace("{c}","wd").replace("{f}",aM)
let u,d
if(o&&(u=new $J(sU),u.title=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_TITLE"),u.message=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_DETAIL"),u.artwork=kt(e,ZA)),e.bag.newEventsForODJAreEnabled){const o=new Pz,i=Nt(r.pageInformation)
i[Ij]="notifyActivateNotificationsDisabled",i[JG]=Fh(e,{...r,id:t.id},""),i[jN]=""
const s=_t(e,n.lockup.adamId,KW,i)
o.actionMetrics.addMetricsData(s),d=o}else{const t=new $J(kW)
t.title=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_TITLE"),t.message=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_DETAIL"),t.isCancelable=!0,t.buttonTitles=[e.loc.string(_A)],t.buttonActions=[new HJ("prefs:root=NOTIFICATIONS_ID&path=com.apple.AppStore",!0)],d=t}const f=new $J(kW)
f.title=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_TITLE"),f.message=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_DETAIL"),f.isCancelable=!0
const h=(new oY).set(DV,Rz).param(Hz.appId,n.lockup.adamId).param(Hz.bundleId,n.lockup.bundleId).param(Hz.appEventId,n.appEventId)
h.host=Uz
const p=j(t,sM);(0,mm.isSome)(p)&&(null==p?void 0:p.length)>0&&h.param(Hz.appEventDeepLink,encodeURIComponent(p))
const w=Nt(r.pageInformation)
w[Ij]="notifyActivate",w[JG]=Fh(e,{...r,id:t.id},"")
const v=_t(e,n.lockup.adamId,KW,w),g=S(w)
g[Ij]="notifyDeactivate"
const m=_t(e,n.lockup.adamId,KW,g)
return new W0(t.id,i,s,l,a,u,d,f,h.build(),v,m)}function gi(e,t,n,r,o,i){const s=ci(e,t,n,r,o,_q,i,null)
if((0,mm.isNothing)(s))return
const a={id:t.id,actionDetails:{action:"Open",contentType:ii(t)},relatedSubjectIds:[n.id],...o}
return oi(t)===zm.AppEvent&&(a[Y$]=t.id),ra(e,s,a),s}function mi(e,t,n=null,o,s,a,c,l,u,d){var f
const h=[]
let p
for(const w of t){const t=ai(e,w,n,o,!0,iW,_q,s,a,c,l,null,u,d)
if(r(t))continue
if(t instanceof Date){((0,mm.isNothing)(p)||t.getTime()<p.getTime())&&(p=t)
continue}const v=t,g={...a,id:w.id,kind:si(w),targetType:ii(w),title:null!==(f=v.title)&&void 0!==f?f:"",softwareType:null},m=null!=n?n:pe(e,w,VW)
i(m)&&(g.relatedSubjectIds=[m.id]),Jh(e,v,g),Vh(g.locationTracker),h.push(v)}return{appPromotions:h,nextAppEventPromotionStartDate:p}}function yi(e,t){let n=null!=e?e:""
return Object.keys(t).forEach(e=>{n=n.replace(e,t[e])}),n}function Ai(e,t,n,r,a,c,l,u,d,f,h,p,w,v){var g,m,y
if(t.type!==tz)return null
const A=j(t,"promotionStartDate")
if((0,mm.isNothing)(A)||0===A.length)return null
const T=new Date(A)
if((0,mm.isNothing)(T))return null
const b=new Date
if(T.getTime()>b.getTime()&&!v)return T
const S=fi(e,t,V$),P=pi(e,t,"lockupVideo",!1,!1)
if((0,mm.isNothing)(S)&&o(P))return null
const C=null!==(g=null==P?void 0:P.preview)&&void 0!==g?g:S,I=be(null==C?void 0:C.backgroundColor)?MW:iW,k=be(null==C?void 0:C.backgroundColor,10),O=j(t,cz)
let E=j(t,Dq)
s(p)&&(E=p)
const D=j(t,H$)
if((0,mm.isNothing)(O)||0===O.length||(0,mm.isNothing)(E)||0===E.length||(0,mm.isNothing)(D)||0===D.length)return null
const R=new Date(D)
if((0,mm.isNothing)(R))return null
const _=null!==(m=j(t,Sj))&&void 0!==m?m:"",L=null!=n?n:pe(e,t,VW)
let M=null
if((0,mm.isSome)(L)&&(M=wi(e,t,L,O,c,l,u,d,h,null,w,!0)),(0,mm.isNothing)(M))return e.console.warn(`Parent app for event ${t.id} is missing, returning null.`),null
const F=j(t,"requirement"),$=j(t,Pq),x=j(t,q$)
let N
if((0,mm.isSome)(x)&&x.length>0&&(N=new Date(x)),void 0!==N&&N.getTime()<=b.getTime()&&!f)return null
const B=Ti(null!==(y=j(t,W$))&&void 0!==y?y:void 0,R,N),U=bi(e,B,R,N),G=new z0(t.id,null!=S?S:void 0,null!=P?P:void 0,O,null!=$?$:void 0,_,R,N,B,E,null!=F?F:void 0,M,r,U,I,k)
if(i(L)){const n={...d,id:L.id,inAppEventId:t.id,relatedSubjectIds:[L.id]}
G.notificationConfig=vi(e,t,G,n,!0)}return a&&i(L)&&(G.clickAction=gi(e,t,L,G,d,h)),G}function Ti(e,t,n){let r=null!=e?e:ry.live
return r===ry.live&&i(n)&&n.getTime()-t.getTime()>216e5&&(r=ry.happening),r}function bi(e,t,n,r){const o=[],i=De(n)
if((0,mm.isNothing)(i))return[]
const s=e.loc.string("AppEvents.FormattedDate.SevenDaysOrMore.DateFormat"),a=e.loc.uppercased(e.loc.formatDate(s,n)),c=new Y0(!1,void 0,null!=a?a:void 0,void 0,void 0)
o.push(c)
const l=new Date(i)
l.setDate(l.getDate()-6)
const u=e.loc.string("AppEvents.FormattedDate.SixDaysOrLess.DateFormat"),d=e.loc.formatDate(u,n),f=e.loc.uppercased(d),h=new Y0(!1,l,null!=f?f:void 0,void 0,void 0)
o.push(h)
const p=new Date(i)
p.setDate(p.getDate()-1)
const w=e.loc.string("AppEvents.FormattedDate.Tomorrow"),v=e.loc.formatDateInSentence(w,JA,n),g=e.loc.uppercased(v),m=new Y0(!1,p,null!=g?g:void 0,void 0,void 0)
if(o.push(m),n.getHours()>1||1===n.getHours()&&n.getMinutes()>0){let t
t=n.getHours()>=19?e.loc.string("AppEvents.FormattedDate.Tonight"):e.loc.string("AppEvents.FormattedDate.Today")
const r=e.loc.formatDateInSentence(t,JA,n),s=e.loc.uppercased(r),a=new Y0(!1,null!=i?i:void 0,null!=s?s:void 0,void 0,void 0)
o.push(a)}const y=new Date(n)
let A
switch(y.setHours(y.getHours()-1),t){case ry.available:A="AppEvents.FormattedDate.AvailableIn.MinutesCountdown"
break
case ry.happening:case ry.live:default:A="AppEvents.FormattedDate.StartsIn.MinutesCountdown"}const T=new Y0(!1,y,void 0,n,A)
let b,S
switch(o.push(T),t){case ry.available:b=e.loc.string("AppEvents.FormattedDate.NowAvailable"),S=!1
break
case ry.happening:b=e.loc.string("AppEvents.FormattedDate.HappeningNow"),S=!1
break
case ry.live:default:b=e.loc.string("AppEvents.FormattedDate.Live"),S=!0}const P=new Y0(S,n,b,void 0,void 0)
if(o.push(P),(0,mm.isSome)(r)){const t=new Y0(!1,r,e.loc.string("AppEvents.FormattedDate.EventEnded"),void 0,void 0)
o.push(t)}return o}function Si(e){e.includingScopedRelationships(fH,[aE,J$,ZU]),e.includingViews([iE,RE]),e.includingScopedAttributes(fH,[cz,Pq,HN]),e.includingMetaKeys(bT,[ST]),e.includingMetaKeys(PT,[cE]),e.includingAssociateKeys(fH,[CT])}function Pi(e){e.includingScopedRelationships(fH,[aE,J$,ZU]),e.includingScopedAttributes(fH,[cz,Pq,HN]),e.includingMetaKeys(bT,[ST]),e.includingMetaKeys(PT,[cE]),e.includingAssociateKeys(fH,[CT])}function Ci(e){e.enablingFeature(CH),e.includingScopedAttributes(CH,[RW]),e.addingQuery("associate[tags]",az),e.includingScopedRelationships(ax,[sz,_E])}function Ii(e){e.includingScopedRelationships($H,[QU]),e.includingScopedAttributes($H,[FW,Pq,HN,lM]),e.includingMetaKeys(IT,[kT]),e.includingKindsKeys($H,[X$])}function ki(e){const{id:t,platform:n,...r}=e
return{...r,id:ut(t),platform:lt(n),$kind:J0}}function Oi(e){return 0===e.length}function Ei(e){return!Oi(e)}function Di(e){if(!(0,mm.isSome)(K0)){K0=new Set
for(const t of e.bag.suppressedAccessibilityAppIds)K0.add(t)}}function Ri(e){return e.featureFlags.isEnabled(AK)&&e.bag.enableAppAccessibilityLabels}function _i(e,t){return Di(e),(0,mm.isSome)(K0)&&Ei(t)&&K0.has(t)}function Li(e,t){return Di(e),!!t.startsWith(NA)||(0,mm.isSome)(K0)&&Ei(t)&&K0.has(t)}function Mi(e){const t=[RW,TW,tq,yq]
return t.push(XH),e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}function Fi(e,t){return t.includingAdditionalPlatforms(ee(e)).includingRelationships(function(e){let t=[]
switch(e.client.deviceType){case iz:t=t.concat(X0),e.appleSilicon.isSupportEnabled&&t.push(cB)
break
case oz:t.push(t1)
break
case zW:t=t.concat(Q0)
break
case bH:t=t.concat(e1)
break
default:t=t.concat(Z0)}return t}(e)).includingAttributes(Mi(e)).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e)),t}function $i(e){return{storefront:e.locale.activeStorefront,language:e.locale.activeLanguage}}function xi(e,t){return e.locale.normalize(t)}function Ni(e){if(!(0,Am.isSome)(n1)){n1=new Set
for(const t of e.bag.suppressedPrivacyAppIds)n1.add(t)}}function Bi(e,t){return Ni(e),!(0,Am.isNothing)(n1)&&!o(t)&&n1.has(t)}function Ui(e,t){return Ni(e),!(0,Am.isNothing)(n1)&&!o(t)&&(!(!n1.has("com.apple.InstallAssistant.*")||!t.startsWith(NA))||n1.has(t))}function Gi(e,t){const n=t.host
if(r(n))return!1
const o=[e.bag.mediaHost,e.bag.mediaEdgeHost(e),e.bag.mediaEdgeSearchHost]
for(const e of o)if(!r(e)&&-1!==n.indexOf(e))return!0
return!1}function ji(e,t,n){if(!(0,Am.isNothing)(t))return ge(e,new cJ(e,t).addingQueryValues(n)).toString()}function Vi(e){let t=e.query.id
const n=e.pathname
if(r(t)&&(null==n?void 0:n.length)>0){const e=o1.exec(n)
e&&e.length>1&&(t=e[1])}if(!a(t)){const n=e.pathComponents()
s(n)&&(t=n[n.length-1])}return t}function Hi(e,t,n=!1){var r,o
let s=Vi(t)
if(!a(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
s in i1&&(s=i1[s])
let c=az,l=r1,u=[]
u=[mj,_W,JW,bM,lx,cx]
const d=null===(r=t.pathname)||void 0===r?void 0:r.split("/"),f=(0,Am.isSome)(d)&&d.includes(_z.productBundle)
f&&(c=JW,l=[NV,mV,yq,ME,hV],u=[az,_W,lx]),u.push(bN),e.bag.enablePrivacyNutritionLabels&&!Bi(e,s)&&l.push(ux),Ri(e)&&!_i(e,s)&&l.push(dx),e.appleSilicon.isSupportEnabled&&l.push(bq),e.bag.enableUpdatedAgeRatings&&l.push(bW),vf(e)&&l.push(Tq),e.bag.enableLicenses&&l.push(NE),e.bag.medicalDeviceComplianceStatementRegion&&l.push(fx)
const h=g(t.query[Hz.isArcade]);((0,Am.isNothing)(h)||h)&&(l.push(eU,tU,TW),u.push(Eq)),e.bag.enableSellerInfo&&l.push(dU),e.bag.enableSellerICPAnnotation&&l.push(BE),e.bag.gameCenterExtendSupportedFeatures&&l.push(hx),Ca(e)&&u.push(UE)
const p=new cJ(e).withIdOfType(s,c).includingAdditionalPlatforms(ee(e)).includingAgeRestrictions().includingRelationships(u).includingAttributes(l).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e)).includingViews([GE,bM])
p.addingRelationshipLimit(_W,te(e)),(null===(o=t.query[Hz.productVariantID])||void 0===o?void 0:o.length)>0&&p.addingQuery(Hz.productVariantID,t.query[Hz.productVariantID])
const w=t.query[Yz]
return i(w)&&p.addingQuery(Yz,w),li(e)&&!f&&(ui(e)||p.includingScopedRelationships(az,[tz]),p.includingScopedAttributes(tz,eQ),p.includingScopedAvailableIn(tz,[jE])),ui(e)&&Si(p),di(e)&&Ii(p),Kt(e,Vq)&&p.enablingFeature(CM),n&&p.enablingFeature(SM),ui(e)||p.includingRelationships([IM]),p.attributingTo(t.build())}function qi(e,t,n,r,o,i){const s=r1
e.bag.enablePrivacyNutritionLabels&&!Bi(e,t)&&s.push(ux),Ri(e)&&!_i(e,t)&&s.push(dx),e.appleSilicon.isSupportEnabled&&s.push(bq),e.bag.enableUpdatedAgeRatings&&s.push(bW),vf(e)&&s.push(Tq),e.bag.enableLicenses&&s.push(NE),e.bag.medicalDeviceComplianceStatementRegion&&s.push(fx),e.bag.gameCenterExtendSupportedFeatures&&s.push(hx)
const a=new cJ(e).withIdOfType(t,az).includingAdditionalPlatforms(ee(e)).includingAttributes(s).includingRelationships([Eq,mj,bN,_W,JW,lx,cx]).addingRelationshipLimit(_W,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingViews([bM]).usingCustomAttributes(Ue(e))
return n&&a.addingQuery("availability",PM),(0,Am.isSome)(r)&&a.addingQuery(Hz.productVariantID,r),i&&a.enablingFeature(SM),li(e)&&!o&&(ui(e)||a.includingScopedRelationships(az,[tz]),a.includingScopedAttributes(tz,eQ),a.includingScopedAvailableIn(tz,[jE])),ui(e)&&Si(a),di(e)&&Ii(a),ui(e)||a.includingRelationships([IM]),Ca(e)&&a.includingRelationships([UE]),Kt(e,Vq)&&a.enablingFeature(CM),a}function Wi(e,t){if(!e.client.isPhone||!e.featureFlags.isEnabled(NK))return!1
if((0,mm.isNothing)(t))return!0
switch(t){case BV:return e.bag.isAppsGroupingTagsEnabled
case fq:return e.bag.isAppsProductPageTagsEnabled
case w$:return e.bag.isAppsSlpTagsEnabled
default:return!1}}function zi(e){return q1.has(e)}function Yi(e){return U1.has(e)}function Ji(e){return V1.has(e)}function Ki(e){return j1.has(e)}function Zi(e,t,n){const r=q(t,xV)
let o=null
const i=j(t,"gamesFilter")
switch(i){case nz:case aF:case"all":o=i
break
default:r!==E1&&r!==_1||(o=nz)}let a=null,c=j(t,Xi(0,r)),l=null,d=null,h=j(t,TV)
const p={}
let w=!1
const v=we(t,dG)[0]
if(r===O1&&s(v))if(a=e.loc.uppercased(j(t,Xi(0,r))),h=null,v.type===RH){c=sh(e,v,cz)
const t=Sn(e,v,!1)
if((0,mm.isSome)(t)){l=df(e,t,{useCase:R3.LockupIconSmall,style:eB})
const n={type:PB,name:qN}
p.eyebrowColor=n}d={forYou:!0}}else w=!0,c=j(v,Xi(0,r)),l=wf(e,v,{useCase:R3.LockupIconSmall})
const g={featuredContentId:r,id:f(t,"id"),presentationHints:{},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,featuredContentData:t,title:c,subtitle:h,eyebrow:a,titleArtwork:l,shelfHeaderConfiguration:p,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
return{shelfToken:g,metricsOptions:{id:g.id,kind:null,softwareType:u(null==n?void 0:n.isArcadePage)?dW:null,targetType:rW,title:w?g.eyebrow:g.title,badges:d,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:sH,fcKind:r,recoMetricsData:is(e,t)}}}function Qi(e){return e&&e.isDeferring&&e.isFirstRender}function Xi(e,t){switch(t){case F1:case E1:case D1:return FW
default:return cz}}function es(e){let t=(new oY).set(DV,Cz).append(aH,_z.grouping).append(aH,_z.shelf).append(aH,encodeURIComponent(JSON.stringify(e))).param(Hz.groupingFeaturedContentId,`${e.featuredContentId}`)
return(0,mm.isSome)(e.nativeGroupingShelfId)&&(t=t.param(Hz.nativeGroupingShelfId,`${e.nativeGroupingShelfId}`)),t.build()}function ts(e,t,n){if(o(n))return null
r(n.shelfStyle)&&(n.shelfStyle=t.contentType)
const i=t.contentType!==gB&&s(t.items)
return n.hasExistingContent=n.hasExistingContent||i&&n.isFirstRender,(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?es(n):null}function ns(e,t){e.remainingItems=e.remainingItems.filter(e=>!t.has(e.id))}function rs(e,t,n){var r
const o=s(t.remainingItems),i=!o&&(null===(r=t.recommendationsHref)||void 0===r?void 0:r.length)>0
if(o){const n=function(e,t){var n
const r=(null===(n=t.relationshipToFetch)||void 0===n?void 0:n.length)>0
let o=t.remainingItems
return r&&(o=t.remainingItems.map(n=>pe(e,n,t.relationshipToFetch))),o}(e,t),r=new cJ(e,n,!0)
return Je(e,r,n),os(e,r),r}if(i){const n=new cJ(e,t.recommendationsHref).includingAgeRestrictions()
return os(e,n),li(e)&&(n.enablingFeature(Uq),n.includingMetaKeys(PU,[kx,XM]),n.includingScopedAttributes(tz,eQ),n.includingScopedRelationships(tz,[VW])),ui(e)&&(n.enablingFeature(eF),Pi(n)),di(e)&&(n.enablingFeature(CU),Ii(n)),Wi(e,BV)&&Ci(n),n}return null}function os(e,t){t.includingAdditionalPlatforms(ee(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
let n=[RW,TW,yq]
t.includesResourceType(tz)&&li(e)&&(t.enablingFeature(Uq),t.includingMetaKeys(PU,[kx,XM]),t.includingScopedAttributes(tz,eQ),t.includingScopedRelationships(tz,[VW])),t.includesResourceType(fH)&&ui(e)&&(t.enablingFeature(eF),Pi(t),n=[]),t.includesResourceType($H)&&di(e)&&(t.enablingFeature(CU),Ii(t),n=[]),(t.includesResourceType(az)||t.includesResourceType(tz))&&(n=n.concat(NV,mV,gH)),e.bag.enableUpdatedAgeRatings&&n.push(bW),Wi(e,BV)&&Ci(t),t.includingAttributes(n)}function is(e,t){const n=q(t,xV)
switch(n){case S1:case p1:case w1:case v1:case L1:case s1:case y1:case A1:case T1:case a1:case x1:case N1:return bt(fe(t,QH))
case k1:case c1:{const e=fe(t,QH),n=G(t,bB)
return s(e)?bt(e):s(n)?bt(t):null}case h1:case b1:case B1:return null
default:if(function(e){return Yi(e)||zi(e)||W1.has(e)||e===M1}(n)){let e=fe(t,sz)
if(r(e))return null
const n=e.data
return n&&0!==n.length||(e=fe(t,QH)),bt(e)}return e.console.warn("Unknown featured content ID:",n),null}}function ss(e,t,n){const r=df(e,t,n)
return r&&(r.crop="sr"),r}function as(e,t,n,r,o){const i=B(t,XW)
if(i instanceof Array){const t=function(e,t,n,r){const o=n/r
let i,s,a=0,c=0,l=0
for(const e of t){const t=h(e,rG),r=h(e,nj),u=f(i,BW)
if((0,mm.isNothing)(t)||(0,mm.isNothing)(r)||(0,mm.isNothing)(u))continue
const d=t/r;(d===o||Math.abs(o-d)<=Math.abs(o-l))&&(!i||t<=n&&t>a||a>n&&t<a&&t>a)&&(i=e,a=t,c=r,l=d,s=u)}if((0,mm.isSome)(s))return kt(e,s,a,c,null,null,f(i,YE))}(e,i,n,r)
return t.crop="bb",t}return null!=i?ss(e,i,o):null}function cs(e,t,n,r,o,i){const s=l(t.meta,_b),a=[]
if((0,mm.isSome)(s))for(const t of s){const n=Nd(e,t,{artworkUseCase:R3.LockupIconSmall,metricsOptions:i,useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:Th}),r=null==n?void 0:n.icon;(0,mm.isSome)(r)&&a.push(r)}return a}function ls(e,t,n,a,c,l,u,d){var h,p,w
const v=(null===(h=f(t,BW))||void 0===h?void 0:h.length)>0,g=(null===(p=j(t,Qb))||void 0===p?void 0:p.length)>0,m=de(t,vq,!1),y=de(t,sz,!1)||m
let A=j(t,Dq)===QM
if(g||v)return function(e,t,n,o,s){const a=i(f(t,BW))?t:B(t,EW)
if(r(a)||Qi(n))return c=t,s?s():null==n||n.remainingItems.push(c),null
var c
const l=f(a,ox),u=f(a,BW),d=f(a,Gq),h=ws(j(t,$D))||d
let p=null
if(l===vM)p=new HJ(u),p.title=h
else{const t=e.required(R9).fetchFlowPage(u),n=new _J(t)
n.pageUrl=u,n.title=h,p=n}return p.presentationStyle=[FO],ra(e,p,{...o,id:""}),{action:p,caption:null,title:h,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,l,d)
if(y){let h,p,v
if(a&&!m){v=Cs(e,"groupingCommon",we(t,sz),!0,c,!1,1)
const n=v.personalizedData
if(0===n.length)return null
h=n[0]}else h=pe(e,t,m?vq:sz)
if(j(h,Dq)===QM&&(p=h,h=pe(e,h,vq),A=!0),r(h))return null
if(r(h.attributes)||Qi(n))return s(n)&&(n.isDeferring=!0),function(e){d?d():null==n||n.remainingItems.push(e)}(h),null
let g=sh(e,h,TV)||Ld(e,h)
const y=j(h,CB),T=ea(e,t,l)
T.targetType=l.targetType
let b=null
y!==Jm.AppEventCard&&(b=Jd(e,h,T,null==n?void 0:n.clientIdentifierOverride))
const S=H(h,tG)
let P,C=null,I=null,k=null
const O=j(h,"itunesNotes.short"),E=(null===(w=h.id)||void 0===w?void 0:w.length)>0,D={...l,id:E?h.id:t.id,idType:E?yW:pG}
switch(h.type){case SH:C=B(h,XW),A&&(h=null!=p?p:t)
break
case YW:{const t=pe(e,h,Sq)
if(s(t)){const r={...D,inAppEventId:t.id},s=pe(e,t,VW)
i(s)&&(r.relatedSubjectIds=[s.id])
const a=Ai(e,t,null,!1,!0,MW,lW,!1,r,!1,!0,null,n.isArcadePage,!1)
if(y===Jm.AppEventCard){if(a instanceof Date)return Vr(a,u.refreshController),null
if((0,mm.isNothing)(a))return null
P=a,S||(b=P.clickAction),o(g)&&(g=sh(e,t,qV))}}I=j(h,Gq),I&&(I=I.replace(/\n/g," "))
const a=pe(e,h,sz),c=f(h,iH)
o(g)&&(c?g=c:a&&(g=sh(e,a,qV))),o(g)&&i(P)&&(g=P.subtitle)
let d=j(h,AD);((0,mm.isNothing)(d)||0===d.length)&&(d=g)
const p={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
if(r(P)&&aa(0,h),p.clientIdentifierOverride=Gr(e,h),i(P))k=P.lockup
else{const t=null,r=null
{xh(e,D,null==n?void 0:n.title)
const o=_o(e,we(h,Sq),p,l.pageInformation,l.locationTracker,t,r,aa(0,h))
1===o.length&&(k=o[0]),Bh(D.locationTracker)}}}default:{const t=[az,VH,JW,jq]
if(r(k)&&t.indexOf(h.type)>-1){xh(e,D,null==n?void 0:n.title)
const t={metricsOptions:{pageInformation:l.pageInformation,locationTracker:l.locationTracker,recoMetricsData:bt(h)},clientIdentifierOverride:null==n?void 0:n.clientIdentifierOverride,artworkUseCase:uf(0,null==n?void 0:n.shelfStyle),canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:e.featureFlags.isEnabled(bK)&&n.isArcadePage}
k=Nd(e,h,t),Bh(D.locationTracker)}C=Ke(e,h,RW)||B(h,RW),o(g)&&i(k)&&(g=k.subtitle)
break}}if(i(b)&&(b.presentationStyle=[FO],!A)){const n=ws(j(t,$D)),r=sh(e,h,cz)
b.title=n||r||b.title||g||I}return{action:b,caption:I,title:null==b?void 0:b.title,subtitle:g,artwork:C,shortEditorialDescription:O,content:h,lockup:k,appEvent:P,onDevicePersonalizationDataProcessingType:null==v?void 0:v.processingType}}return null}function us(e,t,n,r){const o=j(t,cz),i=ji(e,f(t,uj)),s=e.required(R9).fetchFlowPage(i),a=new _J(s)
return a.pageUrl=i,{action:a,caption:vS,title:o,subtitle:vS,artwork:null,shortEditorialDescription:o}}function ds(e,t){const n={}
for(const t of e)n[t.id]=t
const r=[sz,BV],o=[]
for(const e of t){let t=!0
for(const o of r){const r=we(e,o)
if(i(r)){const i=[]
for(const e of r){const t=n[e.id]
s(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function fs(e,t,n){t.seeAllAction=null,t.isHorizontal=!1,t.shouldFilterApps&&(t.filteredItemsMinimumCount=0,t.filteringExcludedItems=n.includedAdAdamIds)}function hs(e,t){switch(t){case Bq:return mH
case DH:return yB
case PW:return IU
case AH:return xD
default:return null}}function ps(e,t){let n=j(t,EH)
return n||(n=j(t,"contentId")),n||(n=j(t,"id")),n}function ws(e){if(r(e))return null
const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"")
return t.match(/^\s*$/)?null:t}function vs(e,t,n){e.featureFlags.isEnabled(SK)?t.titleAction=n:t.accessoryAction=n}function gs(e,t,n){e.featureFlags.isEnabled(SK)?(0,mm.isSome)(t.header)?vs(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}async function ms(e,t,n){const r=n===pz?"OnDeviceRecommendationsShelfController":UP
return await new Promise((n,i)=>{if(o(e.user.dsid)){const e=`${r}: User is currently not signed in.`
return ym.unexpectedType(Cq,e,null),void i(new Error(e))}if(o(t)){const e=`${r}: Missing valid useCase for ODP: ${t}`
return ym.unexpectedType(Cq,e,null),void i(new Error(e))}e.onDeviceRecommendationsManager.performRequest({type:GP,dsId:e.user.dsid,useCase:t}).then(a=>{const c=l(a[jP]),u=y(a[gV])
if(o(c)){const e=`${r}: ODP returned no candidate ids for useCase: ${t}`
return ym.unexpectedType(Cq,e,null),void i(new J1(e))}if(o(u)){const e=`${r}: ODP returned no metrics for useCase: ${t}`
return ym.unexpectedType(Cq,e,null),void i(new Error(e))}const d=[]
for(const e of c)s(e)&&d.push({id:e,type:az})
const f=new cJ(e,d).withFilter("apps:recommendable",cW).addingQuery(Hz.onDevicePersonalizationUseCase,t)
os(e,f),Ln(e,f).then(e=>{n({candidates:c,recoMetrics:u,dataContainer:e})}).catch(e=>{const t=`${r}: Failed to fetch Media API data for candidates: ${c}`
ym.unexpectedType(Cq,t,null),i(new Error(t))})}).catch(e=>{const n=`${r}: Failed to perform ODP for useCase: ${t}, ${e}`
ym.unexpectedType(Cq,n,null),i(new Error(n))})})}function ys(e){const t=new Set,n=[]
return e.forEach((e,r)=>{t.has(e.appId)||(n.push(e.appId),t.add(e.appId))}),n}function As(e,t){var n
const r=Number(null!==(n=t[xP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.onDeviceScore
t.modifiedScore=r*n+(1-r)*e}return e.sort((e,t)=>t.modifiedScore-e.modifiedScore),e}function Ts(e,t){const n=e.filter(e=>i(e.pinnedPosition))
e=e.filter(e=>r(e.pinnedPosition))
const o=new Map
e.reverse(),e.forEach((e,t)=>{e.appId in o?o[e.appId].push(e):o[e.appId]=[e]})
const s=[],a=Math.max(...Object.values(o).map(e=>e.length))
for(let e=0;e<a;e++){const e=[]
t.forEach(t=>{t in o&&o[t].length>0&&(s.push(o[t].pop()),0!==o[t].length&&e.push(t))}),t=e}const c=new Array(n.length+s.length)
n.sort((e,t)=>e.pinnedPosition-t.pinnedPosition)
for(const e of n)e.pinnedPosition<c.length?c[e.pinnedPosition]=e:s.push(e)
s.reverse()
for(const[e,t]of c.entries())r(t)&&s.length&&(c[e]=s.pop())
return c}function bs(e){const t=new Map
return s(e)&&e.split(",").forEach(e=>{const n=e.split("=")
2===n.length&&t.set(n[0],Number(n[1]))}),t}function Ss(e,t,n,s,a,c,l,u){var d
let p={sortedDataItems:[],processingType:0}
if(null!==(d=null==n?void 0:n.metricsData[GR])&&void 0!==d&&d){const e=function(e,t,n,r,o){const s=[]
for(const e of t){const t=new Z1(e),a=h(e,JF)
let c=f(e,wG)
if(((0,mm.isNothing)(c)||0===c.length)&&(null==o?void 0:o.length)>0&&(c=o),(0,mm.isNothing)(c)||0===c.length)r&&(t.isUnpersonalizedMatch=!0,s.push(t))
else{if(i(n)){const e=n[c]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=c,t.score=null!=a?a:0,s.push(t)}}return s}(0,t,null==n?void 0:n.personalizationData,s,l),r=As(e,null==n?void 0:n.metricsData),o=e.every((e,t)=>e===r[t])
p={sortedDataItems:r,processingType:o?X1.contentsNotChanged:X1.contentsSorted},i(c)&&p.sortedDataItems.length>=c&&(p.sortedDataItems=p.sortedDataItems.slice(0,c))}else{const d=function(e,t,n,r,s){const a=[]
for(const c of t){const t=new Z1(c),l=f(c,BP)
let u=f(c,wG),d=f(c,jR)
if(((0,mm.isNothing)(u)||0===u.length)&&(null==s?void 0:s.length)>0&&(u=s,d=e.random.nextUUID()),o(l)||o(u)||o(d)){r&&(t.isUnpersonalizedMatch=!0,a.push(t))
continue}const h=l.split(",")
if(h.includes(Q1)&&(t.isWildcardMatch=!0),i(n)){const e=n[u]
if(i(e))for(const n of h)if(e.userSegments.includes(n)){t.isExactMatch=!0
break}}t.appId=u,t.groupId=d,a.push(t)}return a}(e,t,null==n?void 0:n.personalizationData,s,l),h=ys(d),w=function(e,t){var n
const r=new Set,i=[],s=t.filter(e=>e.isExactMatch).map(e=>e.groupId),a=new Set(s)
t.forEach((e,t)=>{if(o(e.groupId))i.push(e)
else if(!r.has(e.groupId))if(e.isUnpersonalizedMatch)i.push(e)
else{if(e.isExactMatch)return r.add(e.groupId),void i.push(e)
if(!a.has(e.groupId)){if(e.isWildcardMatch)return r.add(e.groupId),void i.push(e)
e.isFallbackMatch=!0,i.push(e)}}})
const c=[],l=i.slice().reverse()
for(const e of l)e.isFallbackMatch&&r.has(e.groupId)||(c.push(e),(null===(n=e.groupId)||void 0===n?void 0:n.length)>0&&r.add(e.groupId))
return c.reverse(),c}(0,d)
p=function(e,t,n,o,i,s){let a
const c=t.filter(e=>e.isExactMatch||e.isWildcardMatch||e.isUnpersonalizedMatch||r(e.groupId))
return r(i)?a=Ps(c,o,s):c.length>=i||!n?(a=Ps(c,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)):(a=Ps(t,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)),a}(0,w,a,h,c,u)}const w=p.sortedDataItems.map(e=>e.rawData)
return{personalizedData:w,processingType:(t.length!==w.length?X1.contentsFiltered:X1.contentsNotChanged)+p.processingType}}function Ps(e,t,n){const r=e.filter(e=>e.isExactMatch)
let o=e.filter(e=>!e.isExactMatch)
i(n)&&n&&(o=Ts(o,t))
const s=r.concat(o),a=e.every((e,t)=>e===s[t])
return{sortedDataItems:s,processingType:a?X1.contentsNotChanged:X1.contentsSorted}}function Cs(e,t,n,r,a,c=!1,l,u,d){return Is(e)?t===Jb?function(e,t,n,r,o){var a,c
let l=t,u=!1
const d=[]
e.featureFlags.isEnabled(FK)||(l=t.filter((e,t)=>!s(e.type)||e.type===tz||(d.push(t),!1)),u=l.length!==t.length)
const p=null==r?void 0:r.metricsData,w=null!==(a=p.use_segment_scores)&&void 0!==a&&a,v=null!==(c=p[GR])&&void 0!==c&&c
let m
if(m=w||v?function(e,t,n,r){var o
let s=[],a=[]
null!==(o=null==n?void 0:n.metricsData[GR])&&void 0!==o&&o?(s=function(e,t,n){const r=[]
for(const[e,o]of t.entries()){const t=new K1(o),s=g(o,NP),a=f(o,wG),c=h(o,JF)
if(i(n)){const e=n[a]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=a,t.score=null!=c?c:0,s&&(t.pinnedPosition=e),r.push(t)}return r}(0,t,null==n?void 0:n.personalizationData),a=As(s,null==n?void 0:n.metricsData)):(s=function(e,t){const n=[]
for(const[e,r]of t.entries()){const t=new K1(r),o=f(r,wG),i=f(r,jR),s=h(r,JF),a=f(r,"meta.personalizationData.segScores"),c=g(r,NP),l=bs(a)
t.appId=o,t.groupId=i,t.score=null!=s?s:0,t.segScores=l,c&&(t.pinnedPosition=e),n.push(t)}return n}(0,t),a=function(e,t){const n=function(e,t){var n
for(const r of e){const e=r.appId,o=r.segScores,s=r.score
if(i(t)){const a=t[e]
if(i(a)){let e=0,t=0
for(const n of a.userSegments)o.has(n)&&(t+=o.get(n),e+=1)
if(e){const n=t/e
r.modifiedScore=s*n}}else{const e=null!==(n=o.get("0"))&&void 0!==n?n:0
r.modifiedScore=s*e}}else r.modifiedScore=s}return e}(e,null==t?void 0:t.personalizationData),r=function(e,t){var n
const r=Number(null!==(n=t[xP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.modifiedScore
t.modifiedScore=r*n+(1-r)*e}return e}(n,null==t?void 0:t.metricsData)
return r.sort((e,t)=>t.modifiedScore-e.modifiedScore),r}(s,n),i(r)&&r&&(a=Ts(a,ys(a))))
const c=a.map(e=>e.rawData),l=a.every((e,t)=>e===s[t])?X1.contentsNotChanged:X1.contentsSorted
return{personalizedData:c,processingType:(t.length!==c.length?X1.contentsFiltered:X1.contentsNotChanged)+l}}(0,l,r,o):Ss(e,l,r,n,null,null,null,o),u){const e=m.personalizedData
d.forEach(n=>{const r=t[n]
n<e.length?e.splice(n,0,r):e.push(r)}),m={personalizedData:e,processingType:m.processingType}}return m}(e,n,r,a,d):Ss(e,n,a,r,c,l,u,d):function(e,t,n){let r=[]
const s=new Set
for(const e of t){const t=f(e,BP),n=f(e,wG),i=f(e,jR)
o(t)||o(n)||o(i)?r.push(e):s.has(i)||t.split(",").includes(Q1)&&(r.push(e),s.add(i))}return i(n)&&r.length>n&&(r=r.slice(0,n)),{personalizedData:r,processingType:null}}(0,n,l)}function Is(e){return e.user.isOnDevicePersonalizationEnabled&&e.bag.enableOnDevicePersonalization}function ks(e,t){return Is(e)?e.host.platform===tH?e.user.onDevicePersonalizationDataContainerForAppIds(Array.from(t)):{personalizationData:{},metricsData:null}:null}function Os(e){return Is(e)&&e.host.platform===tH?e.user.onDevicePersonalizationDataContainerForAppIds([]).metricsData:null}function Es(e,t,n,r){return qd(e,t,{offerEnvironment:"ad",offerStyle:wV,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdvert:!0,adSlotOverride:r.parsedCardCount,disableFastImpressionsForAds:!0},clientIdentifierOverride:n.clientIdentifierOverride,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:R3.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton},{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{}},null,!1)}function Ds(e){for(const t of e)switch(t.type){case oy.EditorialItem:case oy.EditorialItemGroup:return W(t.data)}return!1}function Rs(e,t){if(!Is(e))return null
const n=new Set
for(const e of t){if(r(e.contents))continue
const t=e=>f(e,wG)
for(const r of e.contents)if(r.type===SV){const e=l(r.meta,gL)
for(const r of e){const e=t(r)
s(e)&&n.add(e.toString())}}else{const e=t(r)
s(e)&&n.add(e.toString())}}return ks(e,n)}function _s(e,t,n,r,o,i){var s
const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
return a.useOTDTextStyle=null!==(s=g(t,"meta.personalizationData.isOfTheDay"))&&void 0!==s&&s,a.replaceIfAdPresent=g(t,zI),a.isAdEligible=n,a.currentRowIndex=r,a.metricsDisplayStyle=o,a.isHeroCard=i,a}function Ls(e,t){if(e.client.isPhone)return t.currentRowIndex}function Ms(e,t,n){switch(t){case _m.Grid:n%2==1&&e.currentRowIndex++
break
case _m.Hero:0!==n&&(n-1)%2!=1||e.currentRowIndex++
break
case _m.Standard:e.currentRowIndex++}}function Fs(e,t,n,r){if(e.client.isPad)t.currentRowMetricsDisplayStyle=Km.MediumCard
else switch(n){case _m.Grid:t.currentRowMetricsDisplayStyle=Km.SmallCard
break
case _m.Hero:t.currentRowMetricsDisplayStyle=0===r?Km.MediumCard:Km.SmallCard
break
case _m.Standard:t.currentRowMetricsDisplayStyle=Km.MediumCard}}function $s(e,t){var n
if(t.type===YW)return _m.Standard
let r
const o=N(t)
return W(o)&&(r=j(o,"editorialItemGroupDisplayStyle")),(0,mm.isNothing)(r)&&(r=null!==(n=j(t,Aq))&&void 0!==n?n:_m.Standard),function(e,t){return!(0,mm.isNothing)(t)&&(t!==_m.Grid||e.client.isPhone)}(e,r)?r:_m.Standard}function xs(e){return e.adLocation===e.parsedCardCount||!(0,mm.isNothing)(e.eligibleAdLocations)&&e.eligibleAdLocations.includes(e.parsedCardCount)}function Ns(e,t,n){var r
const o=Us(e,t,n,()=>{var r,o,i
const s=[]
null===(r=n.pageInformation.adPageInfo)||void 0===r||r.updateContainerId(e,null===(o=n.pageInformation.adPageInfo)||void 0===o?void 0:o.containerIdForSlotIndex(null!==(i=n.parsedCardCount)&&void 0!==i?i:0))
const a=$s(e,t.data)
Fs(e,n,a,0)
const c=_s(0,t.data,xs(n),Ls(e,n),n.currentRowMetricsDisplayStyle,!1)
c.baseMetricsOptions={recoMetricsData:Zs(t)}
const l=Gs(e,n,c,t.data)
return(0,mm.isNothing)(l)||(s.push(l),Vh(n.locationTracker),n.parsedCardCount++,Ms(n,a,0)),s})
if(o.contentsMetadata={type:mL,debugSectionTypeIndicatorColor:t.type===oy.EditorialItemGroup?Se(dD):Se(dM),groupDisplayStyle:_m.Standard},!t.isFirstItemInModule){const e=Ks(0,t);(0,mm.isSome)(e)&&(o.background=e.shelfBackground,(0,mm.isSome)(null===(r=o.header)||void 0===r?void 0:r.configuration)&&(o.header.configuration.eyebrowColor=e.eyebrowColor,o.header.configuration.titleColor=e.titleColor,o.header.configuration.subtitleColor=e.subtitleColor))}return o}function Bs(e,t,n){var r
let o=!0
const i=Us(e,t,n,()=>{var r,i,s,a,c,u,d
const f=[],h=gn(e)&&null!==(r=(0,bm.asNumber)(t.data,"meta.personalizationData.displayEICount"))&&void 0!==r?r:100
let p=l(t.data.meta,gL);(0,mm.isSome)(n.recoImpressionData)&&(p=wn(p,n.recoImpressionData,null!==(i=n.pageInformation.recoMetricsData)&&void 0!==i?i:{}))
const w=$s(e,t.data)
let v=0
for(const[r,i]of p.entries()){null===(s=n.pageInformation.adPageInfo)||void 0===s||s.updateContainerId(e,null===(a=n.pageInformation.adPageInfo)||void 0===a?void 0:a.containerIdForSlotIndex(null!==(c=n.parsedCardCount)&&void 0!==c?c:0)),Fs(e,n,w,v)
const l=_s(0,i,xs(n),Ls(e,n),n.currentRowMetricsDisplayStyle,w===_m.Hero&&0===r),d=Gs(e,n,l,i)
if((0,mm.isSome)(d)&&(f.push(d),Vh(n.locationTracker),n.parsedCardCount++,Ms(n,w,v),v++),l.isHeroCard&&(0,mm.isNothing)(d)&&([Rj,WG].includes(e.client.buildType)&&ym.unexpectedType(Cq,`Hero story group ${null===(u=t.data)||void 0===u?void 0:u.id} must contain a valid hero card at index ${r}. Unable to parse card ${i.id}.`,null),o=!1),r<p.length-1&&n.adPlacementBehavior===Lm.insertIntoShelf){const t=Vs(e,n,_s(0,n.adData,xs(n),Ls(e,n),void 0,!1));(0,mm.isSome)(t)&&(n.parsedCardCount++,Ms(n,_m.Standard,0),Vh(n.locationTracker),f.push(t))}if(f.length===h)break}if(o){const n=3
f.length!==n&&([Rj,WG].includes(e.client.buildType)&&ym.unexpectedType(Cq,`Hero story group ${null===(d=t.data)||void 0===d?void 0:d.id} must contain exactly ${n} items but only found ${f.length} items.`,null),o=!1)}return f})
let s=$s(e,t.data)
if(s!==_m.Hero||o||(s=_m.Standard),i.contentsMetadata={type:mL,debugSectionTypeIndicatorColor:Se(dD),groupDisplayStyle:s},!t.isFirstItemInModule){const e=Ks(0,t);(0,mm.isSome)(e)?(i.background=e.shelfBackground,(0,mm.isSome)(null===(r=i.header)||void 0===r?void 0:r.configuration)&&(i.header.configuration.eyebrowColor=e.eyebrowColor,i.header.configuration.titleColor=e.titleColor,i.header.configuration.subtitleColor=e.subtitleColor)):s===_m.Hero&&Array.isArray(i.items)&&(i.background=function(e){const t=e.map(e=>e.media.bestBackgroundColor()).filter(e=>(0,mm.isSome)(e))
let n=null
if(t.length>0&&t.length<=4&&t.length===e.length)switch(t.length){case 1:n={type:y$,colors:{colorCount:"oneColor",color:t[0]}}
break
case 2:n={type:y$,colors:{colorCount:"twoColor",top:t[0],bottom:t[1]}}
break
case 3:n={type:y$,colors:{colorCount:"threeColor",top:t[0],bottomLeading:t[1],bottomTrailing:t[2]}}
break
case 4:n={type:y$,colors:{colorCount:"fourColor",topLeading:t[0],topTrailing:t[1],bottomLeading:t[2],bottomTrailing:t[3]}}}else n={type:wH,color:Se("secondarySystemBackground")}
return n}(i.items))}return i}function Us(e,t,n,r){const i=t.type===oy.EditorialItemGroup,s=new pK(EV)
if(s.id=t.data.id,s.isHorizontal=!1,s.header=function(e,t,n){var r
if(null!==(r=g(t.data,"meta.personalizationData.suppressHeader"))&&void 0!==r&&r)return
const o={eyebrow:Hs(0,t),eyebrowArtwork:zs(e,t,Xm.Eyebrow),eyebrowArtworkType:Ys(e,t,Xm.Eyebrow),title:qs(0,t),titleArtwork:zs(e,t,Xm.Title),titleArtworkType:Ys(e,t,Xm.Title),subtitle:Ws(0,t),configuration:{eyebrowImageColor:void 0,titleImageColor:void 0,includeSeparator:!1}}
return(0,mm.isSome)(o.eyebrow)||(0,mm.isSome)(o.title)||(0,mm.isSome)(o.subtitle)?o:void 0}(e,t),i){const r={id:s.id,kind:VR,softwareType:null,targetType:rW,title:qs(0,t,!0),pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:yW,recoMetricsData:Zs(t)}
t.type===oy.EditorialItemGroup&&(r[pP]=f(t.data,qI),r[hP]=f(t.data,WI)),Jh(e,s,r),xh(e,r,r.title)}return s.items=r(),s.isHidden=o(s.items),i&&(Bh(n.locationTracker),Vh(n.locationTracker)),s}function Gs(e,t,n,r){var o
let a
if(t.adPlacementBehavior===Lm.replaceOrganic&&i(n.replaceIfAdPresent)&&g(n.replaceIfAdPresent)){const o=Vs(e,t,n)
a=s(o)?o:ko(e,r,n,t)}else t.adPlacementBehavior===Lm.dropAd&&i(n.replaceIfAdPresent)&&!g(n.replaceIfAdPresent)?(a=ko(e,r,n,t),s(t.adData)&&(null===(o=t.pageInformation.adPageInfo)||void 0===o||o.setMissedOpportunity(e,jA,"0",t.parsedCardCount))):a=ko(e,r,n,t)
return a}function js(e,t){let n=null
if(!Kt(e,UW)||(0,mm.isNothing)(t.adData)||t.adPlacementBehavior!==Lm.insertIntoShelf)return n
if(t.adLocation!==t.parsedCardCount)return n
n=new pK(EV),n.id=t.adData.id,n.isHorizontal=!1,n.contentsMetadata={type:mL,debugSectionTypeIndicatorColor:Se(dM),groupDisplayStyle:_m.Standard}
const r=[],o=Vs(e,t,_s(0,t.adData,xs(t),Ls(e,t),void 0,!1))
return(0,mm.isSome)(o)&&(t.parsedCardCount++,Ms(t,_m.Standard,0),Vh(t.locationTracker),r.push(o)),n.items=r,s(n.items)?n:null}function Vs(e,t,n){var o,s,a
if(!Kt(e,UW))return null
if(t.adLocation!==t.parsedCardCount&&t.adPlacementBehavior!==Lm.replaceOrganic)return null
null===(o=t.pageInformation.adPageInfo)||void 0===o||o.updateContainerId(e,null===(s=t.pageInformation.adPageInfo)||void 0===s?void 0:s.containerIdForSlotIndex(null!==(a=t.parsedCardCount)&&void 0!==a?a:0))
const c=function(e,t,n,o){return ym.context("createTodayAdCard",()=>{var s,a,c,l,u,d,h
if(r(t))return null
const p=To(e,t,n,o)
Oo(e,t,n,o,f(t.attributes.name))
const w=ep(e,t,f(t.attributes.name),{targetType:EV,pageInformation:o.pageInformation,locationTracker:o.locationTracker,isAdvert:!0,rowIndex:n.currentRowIndex,displayStyle:n.metricsDisplayStyle}),v=Ge(e,t)
w.productVariantData=v,w.adSlotOverride=o.parsedCardCount,w.kind=Z_
const g=w
let m
null===(s=w.pageInformation)||void 0===s||s.adPageInfo.apply(e,t),i(n)&&(m=n.clientIdentifierOverride)
const y=(0,mm.isSome)(null)
switch(p.style=MW,Qt(e)){case $$:null===(c=null===(a=w.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c||c.setTemplateType(e,zG)
break
case Kq:y&&(null===(u=null===(l=w.pageInformation)||void 0===l?void 0:l.adPageInfo)||void 0===u||u.setTemplateType(e,[TS,"U","I",1,"_2x1"].join("")))}let A=Es(e,t,n,o)
if(r(A))return null===(d=o.pageInformation.adPageInfo)||void 0===d||d.recordLockupFromDataFailed(e,"0",o.parsedCardCount),Do(o),Zh(e,p,w,null,null,!1,!1),null
switch(null===(h=A.searchAdOpportunity)||void 0===h||h.setTemplateType(zG),Qt(e)){case $$:const i=new e2(A,A.icon)
p.media=new t2(i),p.media.impressionMetrics=A.impressionMetrics
break
case Kq:p.media=function(e,t,n,o,i,s,a){return e.media=function(e,t,n,r,o){var i,s
const a=t.screenshots[0],c=Ht(a)
null===(i=r.adPageInfo)||void 0===i||i.setTemplateType(e,c),null===(s=t.searchAdOpportunity)||void 0===s||s.setTemplateType(c)
const l=wf(e,o,{useCase:R3.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:yx})
let u=l.backgroundColor,d=l.textColor
const f={type:PH,red:1,green:1,blue:1}
Ce(f,u)?(u=d,d=void 0):Ce(f,d)&&(d=void 0)
const h=new n2(t,[a],n,d,u,8)
return new r2(h)}(t,n,t.bag.todayAdMediumLockupScreenshotAnimationEnabled,a.pageInformation,o),r(n=Es(t,o,i,s))?null:(n.searchAdOpportunity=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity,n.searchAd=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAd,e.media.mediumAdLockupWithScreenshotsBackground.lockup=n,e.media.impressionMetrics=n.impressionMetrics,e.media)}(p,e,A,t,n,o,w)
break
default:return null}Do(o)
const T=jt(t)
return p.clickAction=Jd(e,t,g,m,void 0,T),function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=ih(e,t)?OU:dF,a=Yt(0,o.pageInformation),c=j(t,fF),l=H(t,uW)?HH:rz,u=new zJ(i,t.id,c,s,yS,l,a)
n.clickAction=zt(0,n.clickAction,u)}(e,t,p,w),Zh(e,p,w,null,null,!1,!1),p})}(e,t.adData,n,t)
return(0,mm.isSome)(c)?c:null}function Hs(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderBadge)return
let r
const o=N(t.data)
if(W(o)&&(r=j(o,pL)),(0,mm.isSome)(r))return r
switch(t.data.type){case YW:r=j(t.data,pL)
break
case SV:r=j(t.data,[nH,KU])}return r}function qs(e,t,n=!1){const r=On(0,t.data)
if((t.isFirstItemInModule||r.suppressHeaderName)&&!n)return
let o
const i=N(t.data)
if(W(i)&&(o=j(i,hL)),(0,mm.isSome)(o))return o
switch(t.data.type){case YW:o=j(t.data,hL)
break
case SV:o=j(t.data,[nH,cz])}return o}function Ws(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderTagline)return
let r
const o=N(t.data)
if(W(o)&&(r=j(o,wL)),(0,mm.isSome)(r))return r
switch(t.data.type){case YW:r=j(t.data,wL)
break
case SV:r=j(t.data,[nH,TV])}return r}function zs(e,t,n){var r
const o=On(0,t.data),i=pe(e,t.data,m$),s=null!==(r=o.headerArtworkBehavior)&&void 0!==r?r:Zm.NoArtwork
switch(n){case Xm.Eyebrow:return s===Zm.CategoryArtworkWithBadge?Js(e,i):void 0
case Xm.Title:switch(s){case Zm.CategoryArtworkWithTitle:return Js(e,i)
case Zm.ContentArtworkWithTitle:return wf(e,i,{useCase:R3.LockupIconSmall})
default:return}default:return}}function Ys(e,t,n){const r=pe(e,t.data,m$),o=j(t.data,[Xj,"headerArtworkBehavior"])
switch(n){case Xm.Eyebrow:return o===Zm.CategoryArtworkWithBadge&&(0,mm.isSome)(Js(e,r))?Mm.Category:void 0
case Xm.Title:switch(o){case Zm.CategoryArtworkWithTitle:return(0,mm.isSome)(Js(e,r))?Mm.Category:void 0
case Zm.ContentArtworkWithTitle:return(0,mm.isSome)(Js(e,r))?Mm.Icon:void 0
default:return}default:return null}}function Js(e,t){const n=Sn(e,t,!1,!1,!1)
if(!(0,mm.isNothing)(n))return df(e,n,{useCase:R3.CategoryIcon,allowingTransparency:!0,cropCode:"sr"})}function Ks(e,t){const n=B(t.data,YI,null),r=null==n?void 0:n[IH]
if((0,mm.isNothing)(r))return null
let o=null
if(r===ey.LinearGradient){const e=v(n).stops.map(e=>ye(e.color)),t={type:"gradient",colors:e,start:Fm.Top,end:Fm.Bottom},r=be(e[0]),i={type:PH,red:60/255,green:60/255,blue:67/255,alpha:.6},s={type:PH,red:235/255,green:235/255,blue:245/255,alpha:.6}
o={shelfBackground:t,eyebrowColor:r?s:i,titleColor:Se(r?lW:SE),subtitleColor:r?s:i}}else o=null
return o}function Zs(e){var t,n
return(0,mm.isNothing)(e)?{}:null!==(n=Mh(null!==(t=p(e.moduleMetadata,ER))&&void 0!==t?t:{},e.moduleMetadata.onDevicePersonalizationProcessingType,null))&&void 0!==n?n:{}}function Qs(e,t){let n
if((0,mm.isSome)(t))n=t
else{const t=Gh(e),o=(r=e).locationStack.length<2?null:r.locationStack[1].position
n=(0,mm.isSome)(t)&&(0,mm.isSome)(o)&&(t.locationType===EV||t.name===Hx)?o:Uh(e)}var r
return n}function Xs(e,t,n,r=null,o=null){var i
const s=f(n,iZ)
if((0,mm.isNothing)(s))return null
const a=JSON.parse(s),c=o2.placementTypeFromPlacementId(e,f(a,hj)),l=new o2(e,c,o2.createInitialPageSlotInfos(e,c,r,o,void 0),null!==(i=f(a,pj))&&void 0!==i?i:void 0,void 0,void 0,r)
return l.applyClickFieldsFromPageRequest(null!=t?t:void 0,a),l}function ea(e,t,n,i){return ym.context("clickOptionsForLockup",()=>{var s,a,c
const l=t.id.slice()
let u=t.id
void 0!==n.anonymizationOptions&&n.anonymizationOptions.anonymizationString.length>0&&(u=n.anonymizationOptions.anonymizationString)
const d={...n,...i,id:u,contextualAdamId:l,softwareType:Ch(e,t)}
if(o(d.targetType)&&(d.targetType=KW),r(d.kind)&&(d.kind=Ih(e,t)),V(t,uW)&&(d.offerType=HH),n.isAdvert||n.isAdEligible){const t=null!==(s=d.adsMetricsData)&&void 0!==s?s:{},r=null===(c=null===(a=n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,o=o2.containerIdFromType(e,r)
if(r===nW&&(0,Am.isSome)(o)){const e=Qs(n.locationTracker,n.adSlotOverride)
t[zx]=`${o}_${e}`}d.adsMetricsData=t}return d})}function ta(e,t,n,r,o,a,c,l,u,d){var f,h,p,w,v,g,m,y,A,T,b,S
const P={}
if(o){const e=o
c&&(null!==(p=null===(h=null===(f=e.adPageInfo)||void 0===f?void 0:f.adAdamId)||void 0===h?void 0:h.length)&&void 0!==p?p:0)>0&&(0,Am.isSome)(e.adPageInfo)&&e.adPageInfo.adAdamId===t.adamId&&Object.assign(P,e.adPageInfo.clickFields),s(e.searchTermContext)&&(P[Hq]=e.searchTermContext.term)}(0,Am.isSome)(l)&&Object.assign(P,l),P[Nj]={buyParams:t.purchaseConfiguration.buyParams},void 0!==a&&(P[JG]=a),P[oZ]=t.adamId,t.actionMetrics.custom[oZ]=t.adamId,r&&(P[Yx]=HH,i(t.expectedReleaseDate)&&(P[wR]=Ee(t.expectedReleaseDate))),(null===(v=null===(w=null==d?void 0:d.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===v?void 0:v.placementType)===nW&&(0,Am.isSome)(null===(g=null==d?void 0:d.adsMetricsData)||void 0===g?void 0:g.iAdSlotId)&&(P[zx]=null===(m=null==d?void 0:d.adsMetricsData)||void 0===m?void 0:m.iAdSlotId),(0,Am.isSome)(null===(y=null==d?void 0:d.adsMetricsData)||void 0===y?void 0:y.iAdDuplicateLayoutType)&&(P[UF]=null===(A=null==d?void 0:d.adsMetricsData)||void 0===A?void 0:A.iAdDuplicateLayoutType)
const C=_t(e,n,lz,P,void 0,u)
P[oZ]=t.adamId,t.actionMetrics.custom[oZ]=t.adamId,C.includingFields.push("appState"),t.purchaseConfiguration.isArcadeApp&&C.includingFields.push(iP)
const I=null!==(S=null===(b=null===(T=null==o?void 0:o.adPageInfo)||void 0===T?void 0:T.shouldIncludeAdRotationFields)||void 0===b?void 0:b.call(T,e))&&void 0!==S&&S
c&&I&&C.includingFields.push(EB),c&&e.client.isPad&&C.includingFields.push(PF),t.actionMetrics.addMetricsData(C)}function na(e,t,n){var r
ra(e,t,{...n,actionType:vR,subscriptionSKU:null!==(r=e.bag.arcadeProductId)&&void 0!==r?r:void 0,actionContext:dW,targetType:lz})}function ra(e,t,n,r=!1,o){var s,a,c,l,u,d,f,h,p,w,v,g,m,y,A
let b=n.actionType
b||(b=dz)
const S={actionType:b}
let P
P=T(A=t)&&A[hz]===aA?t.actions:[t],P.forEach(e=>{if(ft(e)){const t=e
S[IB]=t.pageUrl}else if(pt(e)){const t=e
S[IB]=t.url}}),n.actionDetails&&(S[Nj]=n.actionDetails),n.actionContext&&(S[sP]=n.actionContext),i(n.offerType)&&(S[Yx]=n.offerType),i(n.offerReleaseDate)&&(S[wR]=Ee(n.offerReleaseDate))
const C=null!==(c=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:null==t?void 0:t.title)&&void 0!==c?c:""
let I
S[JG]=Fh(e,n,C),n.pageInformation&&n.pageInformation.searchTermContext&&(S[Hq]=n.pageInformation.searchTermContext.term),i(n.softwareType)&&(S[RB]=n.softwareType),(n.isAdvert||n.isAdEligible)&&r&&(null===(l=n.pageInformation)||void 0===l?void 0:l.adPageInfo)&&(Object.assign(S,n.pageInformation.adPageInfo.clickFields),e.client.isPad&&(I=[PF])),n.mercuryMetricsData&&Object.assign(S,n.mercuryMetricsData),(0,Am.isSome)(n.subjectIds)&&(S.subjectIds=n.subjectIds),(null===(d=null===(u=null==n?void 0:n.pageInformation)||void 0===u?void 0:u.adPageInfo)||void 0===d?void 0:d.placementType)===nW&&(0,Am.isSome)(null===(f=n.adsMetricsData)||void 0===f?void 0:f.iAdSlotId)&&(S[zx]=null===(h=n.adsMetricsData)||void 0===h?void 0:h.iAdSlotId),(0,Am.isSome)(null===(p=n.adsMetricsData)||void 0===p?void 0:p.iAdDuplicateLayoutType)&&(S[UF]=null===(w=n.adsMetricsData)||void 0===w?void 0:w.iAdDuplicateLayoutType)
const k=_t(e,n.id,null!=o?o:Sh(0,n),S,I)
n.actionContext===dW&&(n.actionType===tx||n.actionType===vR)&&(k.includingFields.push(iP),k.fields[oZ]=n.contextualAdamId,(0,Am.isSome)(t.adamId)&&(t.actionMetrics.custom[oZ]=t.adamId))
const O=null!==(y=null===(m=null===(g=null===(v=n.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===g?void 0:g.shouldIncludeAdRotationFields)||void 0===m?void 0:m.call(g,e))&&void 0!==y&&y
n.isAdvert&&O&&k.includingFields.push(EB),t.actionMetrics.addMetricsData(k)}function oa(e,t,n,r){const o={}
i(n)&&(o[IB]=n),r.targetType||(r.targetType=lz),o[JG]=$h(0,r,t.title),o[Ij]=dz,o[ox]="button_See All"
const s=_t(e,gR,lz,o)
t.actionMetrics.addMetricsData(s)}function ia(e,t,n){const r={}
r[Ij]="filter"
const o=_t(e,`filter_${n}`,lz,r)
o.includingFields.push(aP),t.actionMetrics.addMetricsData(o)}function sa(e,t,n,r,o){var i,a,c,l
const u=function(e){switch(e){case MU:return MU
case kU:return kU
case yR:return"recentQuery"
case Nx:return Gx
case AR:return"searchInsteadFor"
case TR:return lP
case bR:return bR
default:return DF}}(t.origin);(0,Am.isNothing)(o)&&(o=new cZ({page:OH,pageType:OH,pageId:OH,pageDetails:VE}))
const d={pageInformation:o,locationTracker:r,targetType:n},f={...Nt(o),actionType:u,actionUrl:kh(t.url),location:$h(0,d,t.term),searchTerm:t.term},h={targetId:t.term},p={};(null===(i=t.prefixTerm)||void 0===i?void 0:i.length)&&(p[Jx]=t.prefixTerm),(null===(a=t.entity)||void 0===a?void 0:a.length)&&(p[GF]=t.entity),s(p)&&(h[Nj]=p),(null===(c=t.originatingTerm)||void 0===c?void 0:c.length)&&(f[mR]=t.originatingTerm,h[mR]=t.originatingTerm)
const w=_t(e,t.term,n,f,[cP])
t.actionMetrics.addMetricsData(w)
const v=Lt(e,t.term,n,u,null!==(l=t.url)&&void 0!==l?l:null,h,[cP])
t.actionMetrics.addMetricsData(v)}function aa(e,t){return i(t)?j(t,"customUrl"):null}function ca(e,t,n,r,o,i,a){if(!s(o)&&e.client.deviceType!==iz)return t
let c
{const e=new tZ(n,VW)
c=new nZ(r,o,e)}const l=S(a)
if(l.actionType=qH,l.actionDetails={actionUrl:o},ra(e,c,l,!0,lz),wt(t))return t.openAction=c,t.includeBetaApps=i,t
{const e=new WJ(n,t)
return e.openAction=c,e.includeBetaApps=i,e}}function la(e,t,n,o,a,c,l,u,d,f){return ym.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return
const h=ua(e,t)
if(!s(h))return
const p=[]
let w,v
const g=H(h,uW)
if(n){const t=ih(e,h),n=Od(0,h.type,t),s=function(e,t,n,o,i,s,a){if(!r(t)&&t.type===az)return yr(e,gr(e,t),t,n,!1,_h(e,t,wf(e,t,void 0,s),s),a,zV)}(e,h,g,0,0,o,l)
v=xr(e,s,n,h,g,0,void 0,void 0,void 0,void 0,zV)
const a=function(e,t,n,o,i,s,a,c){if(r(n))return null
let l=Pr(e,n,t,o,s,zV,i)
return(0,mm.isSome)(c)&&c.length>0&&(0,mm.isSome)(l)&&(l=ca(e,l,n.adamId,null,c,!1,s)),l}(e,h,s,g,o,l,0,u)
i(a)&&i(v)&&(w=p.length,a.artwork=kt(e,"systemimage://arrow.down.circle"),p.push(a))}const m=function(e,t,n){const r=Yo(e,t,n.pageInformation,n.locationTracker)
return i(r)?(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SHARE"),r.artwork=kt(e,KO),r):r}(e,h,c)
i(m)&&p.push(m)
const y=ga(e,h)
if(!g&&!y){if(i(a)&&ft(a)&&(vt(a.pageData)||gt(a.pageData))){const t=function(e,t,n){const r=function(e,t,n){return ym.context("seeRatingsAndReviewsActionFromData",()=>{const t=S(n)
if(vt(n.pageData)||gt(n.pageData)){let r
r=new dK(zq)
const o=dd(e)?r:new fK(new hK(pz,_W)),i=S(n.pageData)
i.fullProductFetchedAction=o,t.pageData=i}return t})}(e,t.id,n)
return i(r)&&(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),r.artwork=kt(e,"systemimage://star"),r.animationBehavior=hq),r}(e,h,a)
i(t)&&p.push(t)}if(!Fe(e,t,Vj)){const t=function(e,t,n,r){const o=La(e,t,n,r)
return i(o)&&(o.title=e.loc.string("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),o.artwork=kt(e,wb)),o}(e,h,d,f)
i(t)&&p.push(t)}}return new YK(p,v,w)})}function ua(e,t){return ym.context(`productDataFromData: ${t.type}`,()=>{switch(t.type){case az:case JW:return t
case YW:{const n=we(t,Sq)
if(s(n)&&1===n.length){const t=n[0]
return ua(e,t)}break}case ax:{const n=we(t,sz)
if(s(n)&&1===n.length){const t=n[0]
return ua(e,t)}break}default:return null}return null})}function da(e,t,n,r){const o=e.bag.voteUrl,i=f(t,"id",Rq),s=new oY(o).param(vb,i),a=new ZK(s.build()),c=new $J(sU)
return r?(a.title=e.loc.string("ACTION_REVIEW_HELPFUL"),c.title=e.loc.string("TOAST_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_HELPFUL_DESCRIPTION"),a.artwork=kt(e,gb),c.artwork=kt(e,gb)):(a.title=e.loc.string("ACTION_REVIEW_NOT_HELPFUL"),c.title=e.loc.string("TOAST_NOT_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_NOT_HELPFUL_DESCRIPTION"),a.artwork=kt(e,mb),c.artwork=kt(e,mb)),a.method=rj,a.isStoreRequest=!0,a.disableCache=!0,a.headers={"Content-Type":eZ.contentType},a.body=(new eZ).param("vote",r?"1":"0").param(yb,n).build(),a.successAction=c,a}function fa(e,t,n){return ym.context("reportConcernActionFromApiRow",()=>{var r
const i=f(t,"id",Rq),s=e.bag.reportConcernUrl
if((0,mm.isNothing)(s))return
const a=new YJ(s)
a.method=rj,a.isStoreRequest=!0,a.disableCache=!0,a.needsAuthentication=!0,a.headers={"Content-Type":eZ.contentType},a.body=(new eZ).param(vb,i).param(yb,n).build()
const c=new KJ("selectedReason",Ab,cD),l=new KJ("explanation",Ab,WH)
a.parameters=[c,l]
{const t=new $J(sU)
t.title=e.loc.string(hb),t.message=e.loc.string(pb),t.artwork=kt(e,UM),a.successAction=t}const u=new $J(kW)
u.title=e.loc.string(iD),u.message=e.loc.string(sD),u.isCancelable=!0,a.failureAction=u
let d=e.bag.reportConcernReasons
o(d)&&(d=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}])
const h=d.map(e=>{const t=f(e,"reasonId"),n=f(e,cz),r=f(e,"upperCaseName")
if((0,mm.isSome)(t)&&(0,mm.isSome)(n)&&(0,mm.isSome)(r))return new JK(t,n,r)}).filter(mm.isSome),p=new QK(h)
return p.title=e.loc.string(fb),p.explanation=null!==(r=e.bag.reportConcernExplanation)&&void 0!==r?r:"Tell us a little more (Optional)",p.artwork=kt(e,UM),p.sendAction=a,p})}function ha(e,t,n,r,o,i){return ym.context(BC,()=>{if(!i)return Ra(e,t.id,o,n,void 0)})}function pa(e,t){const n=f(t,t_)
if(n){const t=new HJ(n,!1)
return t.title=e.loc.string(lC),t.artwork=kt(e,uE),t}}function wa(e){var t
if((0,mm.isSome)(e)){const n=null!==(t=e.presentationHints)&&void 0!==t?t:{}
e.presentationHints={...n,isSeeAllContext:!0}}}function va(e,t,n){return`${Cz}:/${_z.reviews}/${_z.shelf}/${t}/${n}`}function ga(e,t){return!(!i(t)||ma(e,t)||!H(t,HG)&&!H(t,"reviewsRestricted"))}function ma(e,t){return!(o(t)||!e.bag.enableSystemAppReviews)&&it(e).isSystemAppFromData(t)}function ya(e){return e.featureFlags.isEnabled(UK)&&(0,mm.isSome)(e.bag.saveUserReviewURL)}function Aa(e,t){const n=oY.from(e),r=f(n.query,iC)
return t&&(null==r?void 0:r.length)>0&&(n.query[iC]=p2[r]||r),n}function Ta(e,t,n,r=!1,o,a,c){return ym.context("createProductReviewsList",()=>{const l=[]
if(s(a)){if((0,mm.isSome)(c)){const t={id:`${c.getSequenceId()}`,kind:null,softwareType:null,targetType:jV,title:e.loc.string(oN),pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,idType:pW}
xh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:jV,id:`${c.getSequenceId()}`,idType:pW},e.loc.string(oN)),Jh(e,a,t),Bh(c.locationTracker),Vh(c.locationTracker)}l.push(a)}if(s(o),i(n)&&n.length>0){const o=!1,i=!o,s=o?n.slice(0,1):n,a=!1,u=ba(e,e.client.guid,t,s,r&&i,a&&i,i,c);(0,mm.isSome)(c)&&xh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:ZR,id:`${c.getSequenceId()}`,idType:pW},null),u.forEach((t,n)=>{const r=new ZJ
if(r.sourceType=rC,r.review=t,l.push(r),(0,mm.isSome)(c)){const t={id:r.id,idType:yW,kind:null,softwareType:null,title:null,pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:"helpfulReview"}
Jh(e,r,t),Vh(c.locationTracker)}}),(0,mm.isSome)(c)&&(Bh(c.locationTracker),Vh(c.locationTracker))}return l})}function ba(e,t,n,r,i=!1,s=!1,a=!0,c){return ym.context("createReviewItems",()=>{const l=function(t,n){return n?1e3*((new Date).getTime()-t.getTime())<3600?e.loc.string("TimeAgo.Edited.JustNow"):e.loc.string("TimeAgo.Edited.Time").replace("{time}",e.loc.timeAgoWithContext(t,"standalone")):e.loc.timeAgoWithContext(t,"standalone")}
return r.map(r=>{const u=new QJ
u.id=f(r,"id",Rq),u.title=j(r,FW)
const d=j(r,UD)
d&&(u.date=new Date(d),u.dateText=l(u.date,H(r,"isEdited"))),u.contents=j(r,"review"),u.rating=q(r,sV),u.reviewerName=j(r,"userName"),u.dateAuthorText=e.loc.string("ProductPage.Section.Reviews.DateAuthor").replace("{date}",u.dateText).replace("{author}",u.reviewerName)
let h=null
const p=j(r,"developerResponse.id")
if((null==p?void 0:p.length)>0){const e=new XJ
e.id=p,e.contents=j(r,"developerResponse.body")
const t=j(r,"developerResponse.modified")
t&&(e.date=new Date(t),e.dateText=l(e.date,!1)),u.response=e,h=u.response.contents}if(a&&(f(n,EH),u.flowPreviewActionsConfiguration=function(e,t,n,r,i){if(o(t)||e.client.deviceType!==ZW&&e.client.deviceType!==HW&&e.client.deviceType!==iz)return
const s=[da(e,t,n,!0),da(e,t,n,!1)],a=fa(e,t,n)
return(0,mm.isSome)(a)&&s.push(a),(0,mm.isSome)(i)&&(null==i?void 0:i.length)>0&&s.push(function(e,t){const n=new XK(t)
return n.title=e.loc.string("ACTION_REVIEW_COPY"),n.artwork=kt(e,"systemimage://doc.on.doc"),n}(e,i)),new YK(s)}(e,r,t,0,h)),s){const n=[da(e,r,t,!0),da(e,r,t,!1)],o=fa(e,r,t);(0,mm.isSome)(o)&&n.push(o),u.voteActions=n}return i&&(u.moreAction=function(e,t,n,r,o){return r?ym.context("singleReviewActionFromReviewData",()=>{const t=Ma(e,0,n,[r],null,null,null,o),i=new mK
i.adamId=f(n,EH),i.targetReviewId=f(r,"id",Rq),i.shelves=[t]
const s=new _J(_W)
return s.pageData=i,s.title=ja(e),s}):null}(e,0,n,r,c)),u})})}function Sa(e,t,n,r){return r?ym.context("ratingsFromApiResponses",()=>{const t=new eK
t.productId=f(r,EH,Rq),t.ratingAverage=h(r,"ratingAverage"),t.totalNumberOfRatings=h(r,cC),t.totalNumberOfReviews=h(r,"totalNumberOfReviews"),t.context=n
const o=l(r,"ratingCountList").slice().reverse(),i=o.reduce((e,t)=>e+t,0)
if(t.ratingCounts=i>0?o.map(e=>e/i*t.totalNumberOfRatings):o,!(t.ratingAverage>0&&t.ratingCounts)){const n=u(r,QR)
t.status=n?e.loc.string("RATINGS_STATUS_DEVELOPER_RESET"):e.loc.string("RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return t}):null}function Pa(e,t,n){if(!Ca(e))return null
const r=fe(t,UE)
if((0,mm.isNothing)(r))return null
const i=r.data
if(o(i))return null
const s=i[0],a=f(s,"id",Rq),c=Ia(e,s,!0),u=Ia(e,s,!1),d=e.loc.string("ProductPage.ReviewSummary.Subtitle"),h=e.bag.reviewSummaryReportConcernData
if((0,mm.isNothing)(u)||(0,mm.isNothing)(c))return null
const p=j(t,cz),w=Qe(e,s,WH),v=kt(e,"systemimage://text.line.2.summary"),m=new tK(c,u,d,v,QW,t$,function(e,t,n,r,o,i,s){const a=[],c=function(e,t,n,r){return ym.context("reviewSummaryReportConcernActionFromApiRow",()=>{if(!g(t,lb))return null
const r=function(e,t){const n=new cJ(e)
n.includeAppBinaryTraitsAttribute=!1,n.resourceType=ub
const r=ge(e,n),o=new YJ(r.toString())
o.method=rj,o.disableCache=!0,o.needsMediaToken=!0,o.headers={"Content-Type":GM},o.bodyDictionary={report:{contentId:t,contentKind:"review-summaries",concerns:null}}
const i=new $J(sU)
i.title=e.loc.string(hb),i.message=e.loc.string(pb),i.artwork=kt(e,UM),o.successAction=i
const s=new $J(kW)
return s.title=e.loc.string(iD),s.message=e.loc.string(sD),s.isCancelable=!0,o.failureAction=s,o}(e,n),o=l(t,ub).map(t=>{let n,r,o=f(t,Dq)
switch((0,mm.isNothing)(o)&&(e.console.warn(`Unexpected Report a Concern kind: ${o}`),o=db),o){case"OFFENSIVE":case"OFFENSIVE_OR_HARMFUL":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.UppercaseName")
break
case"MISREPRESENTING_THE_APP":case"MISREPRESENT":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.UppercaseName")
break
default:n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.UppercaseName")}return new JK(o,n,r)})
if(0===o.length)return null
const i=e.loc.string(fb),s=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Explanation"),a=new KK(o,i,s,r)
return a.artwork=kt(e,UM),a})}(e,t,o);(0,mm.isSome)(c)&&a.push(c)
const u=xa(e);(0,mm.isSome)(u)&&a.push(u)
const d=function(e,t,n,r,o){if(![Rj,WG].includes(e.client.buildType))return null
const i=new HJ(`tap-to-radar://new/problem?componentid=999915&title=Review Summary Feedback: ${n}&description=App ID: ${t}\nApp name: ${n}\nReview summary ID: ${r}\nReview summary: ${o}\n\nFeedback: `,!0)
return i.title=e.loc.string("Action.ProvideFeedback"),i.artwork=kt(e,"systemimage://ant.circle"),i}(e,n,r,o,i)
return(0,mm.isSome)(d)&&a.push(d),new YK(a)}(e,h,t.id,p,a,w,e.client.guid)),y={id:`${n.getSequenceId()}`,kind:null,softwareType:null,targetType:jV,title:e.loc.string(oN),pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,idType:pW}
return xh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:jV,id:`${n.getSequenceId()}`,idType:pW},m.title),Jh(e,m,y),Bh(n.locationTracker),Vh(n.locationTracker),m}function Ca(e){return e.bag.enableReviewSummarization}function Ia(e,t,n){const r=Qe(e,t,WH)
if((0,mm.isNothing)(r))return null
const o=`^[${e.loc.string(oN)}](jetFont: 'reviewSummaryTitle')`,i=`^[${r}](jetFont: 'reviewSummaryText')`
return n?e.loc.string("ProductPage.ReviewSummary.Body").replace("{styledTitle}",o).replace("{reviewSummary}",i):i}function ka(e){if(!e)return null
const t=new nK
return Da(e,t),t}function Oa(e){if(!e)return null
const t=new rK
return Da(e,t),t}function Ea(e){if(!e)return null
const t=new oK
return Da(e,t),t}function Da(e,t){t.ratingAverage=e.ratingAverage,t.ratingCounts=e.ratingCounts,t.totalNumberOfRatings=e.totalNumberOfRatings,t.totalNumberOfReviews=e.totalNumberOfReviews,t.status=e.status,t.reviews=e.reviews,t.actions=e.actions,t.nextPage=e.nextPage}function Ra(e,t,n,r=null,o=null){const i=new iK
switch(e.client.deviceType){case"tv":i.title=e.loc.string("TV_SELECT_TO_RATE")
break
case iz:i.title=e.loc.string("CLICK_TO_RATE")
break
default:i.title=e.loc.string("TAP_TO_RATE")}return i.rating=o,i.rateAction=function(e,t,n,r=null){const o=new $J(sU)
o.title=e.loc.string("TOAST_TAP_TO_RATE_TITLE"),o.message=e.loc.string("TOAST_TAP_TO_RATE_DESCRIPTION"),o.artwork=kt(e,"resource://ToastStar.png",95,90)
const i=new JJ(function(e,t,n){return Aa(ya(e)?e.bag.saveUserReviewURL:e.bag.userRateURL,n).param("id",t).build()}(e,t,n))
i.useModernRatingsAPI=ya(e),i.adamId=t,i.method=rj,ya(e)&&(i.headers={"Content-Type":GM}),i.isStoreRequest=!0,i.disableCache=!0,i.successAction=o
const s=new KJ(sV,sC,cD),a=new KJ(ya(e)?aD:"versionToReview",sC,cD)
return i.parameters=[s,a],i}(e,t,n,r),i}function _a(e,t,n,r,o=!1,i,s){return ym.context("createWriteReviewAction",()=>{const a=o?e.loc.string("EDIT_REVIEW"):e.loc.string("WRITE_A_REVIEW"),c=function(e,t,n){return Aa(e.bag.writeReviewURL,n).param("id",t).build()}(e,t,n)
let l,u
if((0,mm.isSome)(r)){const t=It(e,!0,!1,R3.LockupIconSmall),n=r.template.replace("{c}",`${r.crop}-${t.quality}`).replace("{f}",t.format)
l=new dY(n,r.width,r.height,r.variants),l.backgroundColor=r.backgroundColor,l.textColor=r.textColor,l.checksum=r.checksum,l.style=r.style,l.crop=r.crop,l.contentMode=r.contentMode,l.imageScale=r.imageScale}switch(e.client.deviceType){case iz:{const e=new sK(t,c)
e.title=a,e.appIcon=l,e.itemDescription=i,e.appName=s,u=e
break}default:{const n=new sK(t,c)
n.title=a,n.appName=s,n.itemDescription=i,n.appIcon=l,n.artwork=kt(e,wb),u=n
break}}return u})}function La(e,t,n,r,o){return ym.context("writeReviewActionFromData",()=>{const s=t.id
if((null==s?void 0:s.length)>0){const a=t.type===JW,c=q(t,sV),l=i(c)&&c>0
return _a(e,s,a,o,l,n,r)}})}function Ma(e,t,n,r,o=!1,i=!1,s=!0,a){return ym.context("reviewsShelfForReviewsData",()=>{{const t=new pK(L$)
return null==a||a.addImpressionsToShelf(e,t,XR),t.items=Ta(e,n,r,o,null,null,a),t}})}function Fa(e,t,n,o){return ym.context("personalizedReviewsContainerShelf",()=>{const s=mt(e,o),a=q(s,sV)
return function(e,t,n,o,s,a,c,l,d,h,p=!1,w=!0,v=null,g=!1){return ym.context("reviewsContainerShelfForReviewsData",()=>{const w=function(e,t,n,o,s,a,c,l,d,h=null,p=!1){return ym.context("reviewsContainerForReviewsData",()=>{const w=new wK,v=f(n,EH),g=u(n,"isBundle")
w.adamId=v,w.ratings=Sa(e,0,uM,n)
{const t=Pa(e,s,d)
i(t)&&(w.reviewSummary=t)}if(p||(w.tapToRate=Ra(e,v,g,a,h)),i(o)&&o.length>0){const r=!1,i=!r,s=r?o.slice(0,1):o
w.reviews=ba(e,t,n,s,i,!1,i,d)}if(r(w.reviews)||0===w.reviews.length){const t=w.ratings.ratingAverage>0&&w.ratings.ratingCounts,r=u(n,QR)
t||r||(w.ratings.status=e.loc.string(e_))}if(r(l)||(w.editorsChoice=l),!p){const t=i(h)&&h>0
w.writeReviewAction=_a(e,v,g,c,t,Ld(e,s),a)}const m=f(n,t_)
if(m){const t=new HJ(m,!1)
t.title=e.loc.string(lC),w.supportAction=t}let y=!1
for(const t of o)if(ma(e,t)){y=!0
break}return w.alwaysAllowReviews=y,w})}(e,t,n,o,a,s,c,l,d,v,g),m=new pK(oC)
return m.title=ja(e),m.items=[w],null==d||d.addImpressionsToShelf(e,m,XR),p&&i(w.reviews)&&w.reviews.length>0&&(m.seeAllAction=Ga(e,0,n,o,h,0,c,!1,!1)),m})}(e,t,n.ratingsData,n.reviewItems,n.appName,s,n.appIcon,n.editorsChoice,n.shelfMetrics,n.nextPageHref,n.includeSeeAllAction,!1,a)})}function $a(e,t,n,r,o,i=null){const a=function(e,t,n,r=null){let o=`${Cz}:/${_z.reviews}/${t}/${n}`
return s(r)&&(o=`${o}/?${Hz.token}=${encodeURIComponent(JSON.stringify(r))}`),o}(0,t,n,i)
return new vK(n,r,o,a)}function xa(e){const t=e.bag.reviewSummarizationLearnMoreEditorialItemId
if(o(t))return null
const n=e.loc.string(aB),r=new _J(vW)
return r.title=n,r.pageUrl=`https://apps.apple.com/story/id${t}`,r.artwork=kt(e,uE),r}function Na(e,t,n,o,i,s=null,a=null,c,l=null,u,d,h=!1,p=!1,w=w2,v=null){const g=new mK
return g.shelves=[],ym.context("reviewsPageForReviewsData",()=>{const t=r(a)?f(n,EH):a
i&&r(n)
const c=Ba(e,0,t,n,o,s,h,p,w,v,d)
return c.reviewsShelf.presentationHints={...c.reviewsShelf.presentationHints,isSortable:i&&c.reviewsShelf.presentationHints.isSortable},g.adamId=t,g.shelves.push(c.reviewsShelf),g.nextPage=c.paginationToken,g.initialSortOptionIdentifier=c.initialSortId,g.sortActionSheetTitle=c.sortActionSheetTitle,g.sortOptions=c.sorts,g.alwaysAllowReviews=ma(e,u),g})}function Ba(e,t,n,r,i,a=null,c=!1,l=!1,u=w2,d=null,f){const h=(null==a?void 0:a.length)>0&&s(i)&&i.length%2>0,p=h?i.slice(0,i.length-1):i,w=h?i.slice(i.length-1):[],v=Ma(e,0,r,p,c,l,!0,f)
var g
v.id=o(g=u)?v2:`${v2}.${g}`
const m={reviewsShelf:v}
return v.presentationHints={isSortable:i.length>0||(null==a?void 0:a.length)>0,isSeeAllContext:!0},m.initialSortId=u,m.sortActionSheetTitle=e.loc.string("REVIEWS_SORT_BY"),m.sorts=[$a(0,n,KR,e.loc.string(uC),e.loc.string(uC),d),$a(0,n,"favorable",e.loc.string(dC),e.loc.string(dC),d),$a(0,n,"critical",e.loc.string(fC),e.loc.string(fC),d),$a(0,n,hC,e.loc.string(pC),e.loc.string(pC),d)],(null==a?void 0:a.length)>0&&(m.paginationToken=function(e,t,n,r,o){return{url:va(0,t,r),remainingContent:o,nextHref:n,profile:KW,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(0,n,a,u,w)),m}function Ua(e,t,n,r,o,i,a,c,l){return ym.context("reviewsPageForReviewsMediaContainer",()=>{let t
return t=s(o.data)?r.concat(o.data):r,Na(e,0,null,t,i,o.next,n,0,null,null,l,!1,!1,a,c)})}function Ga(e,t,n,r,o,i,s,a,c,l,u){return n?ym.context(wC,()=>{const t=Na(e,0,n,r,!0,o,void 0,0,s,l,u,a,c)
t.title=null
const i=new _J(_W)
return i.pageData=t,i.title=e.loc.string(nq),i}):null}function ja(e){switch(e.client.deviceType){case"tv":return e.loc.string("TV_PRODUCT_SECTION_RATINGS")
case oz:return null
default:return e.loc.string("PRODUCT_SECTION_REVIEWS")}}function Va(e,t){return t.map(t=>t.createProductPageSection(e))}function Ha(e,t,n,r,o,i,s){const a=function(e,t,n){switch(t){case $j:return n?dm:um
case s$:return pm
case tH:return n?am:_y
case KH:return n?lm:cm
case a$:return n?hm:fm
case bH:return n?vm:wm
default:return _y}}(0,n,r)
let c=[]
c=t?o&&a.purchasedOrderingCompact?a.purchasedOrderingCompact.slice():a.purchasedOrdering.slice():i&&a.downloadingOrdering?o&&a.downloadingOrderingCompact?a.downloadingOrderingCompact.slice():a.downloadingOrdering.slice():o&&a.notPurchasedOrderingCompact?a.notPurchasedOrderingCompact.slice():a.notPurchasedOrdering.slice()
const l=t?a.purchasedSpotlightIndex:a.notPurchasedSpotlightIndex
if(s&&s.spotlightSection){const e=function(e,t){for(let n=0;n<t.length;n++){const r=t[n]
if(e.sectionType===r.sectionType&&e.shelfId===r.shelfId&&JSON.stringify(e.shelfBasedMappedIds)===JSON.stringify(r.shelfBasedMappedIds))return n}return-1}(s.spotlightSection,c);-1!==e&&(c.splice(e,1),c.splice(l,0,s.spotlightSection))}return c}function qa(e){return new m2(pz,e?VV:kV)}function Wa(e){var t
return(0,mm.isSome)(e)&&(null===(t=e.id)||void 0===t?void 0:t.indexOf(k4))>-1}function za(e,t,n){if(!e.featureFlags.isEnabled(xK))return null
const r=new I4(t)
Vn(e,r,jn(e,"ProductMediaGallery",n,""))
const o=new _J("productMediaGallery")
return o.pageData=r,o}function Ya(e,t){var n
return r(t)?1:i(null===(n=t.video)||void 0===n?void 0:n.preview)&&t.video.preview.height>0?t.video.preview.width/t.video.preview.height:i(t.screenshot)&&t.screenshot.height>0?t.screenshot.width/t.screenshot.height:1}function Ja(e,t,n,r){return ym.context("createProductPageFromShelfBasedProductPage",()=>{var o,a,c,l
const u=new aK
return u.adamId=t.lockup.adamId,u.bundleId=t.lockup.bundleId,u.icon=t.lockup.icon,u.isEditorsChoice=t.lockup.isEditorsChoice,u.ordinal=t.lockup.ordinal,u.title=t.lockup.title,u.subtitle=t.lockup.subtitle,u.developerTagline=t.lockup.developerTagline,u.editorialTagline=t.lockup.editorialTagline,u.editorialDescription=t.lockup.editorialDescription,u.shortEditorialDescription=t.lockup.shortEditorialDescription,u.rating=t.lockup.rating,u.ratingCount=t.lockup.ratingCount,u.ageRating=t.lockup.ageRating,u.buttonAction=t.lockup.buttonAction,u.offerDisplayProperties=t.lockup.offerDisplayProperties,u.titleOfferDisplayProperties=t.titleOfferDisplayProperties,u.clickAction=t.lockup.clickAction,u.children=t.lockup.children,u.contextMenuData=t.lockup.contextMenuData,u.shelfBackground=t.lockup.shelfBackground,u.searchAd=t.lockup.searchAd,u.searchAdOpportunity=t.lockup.searchAdOpportunity,u.crossLinkTitle=t.lockup.crossLinkTitle,u.crossLinkSubtitle=t.lockup.crossLinkSubtitle,u.tertiaryTitle=t.lockup.tertiaryTitle,u.tertiaryTitleAction=t.lockup.tertiaryTitleAction,u.tertiaryTitleArtwork=t.lockup.tertiaryTitleArtwork,u.flowPreviewActionsConfiguration=t.lockup.flowPreviewActionsConfiguration,u.productDescription=t.lockup.productDescription,u.itemBackground=t.lockup.itemBackground,u.developerAction=t.developerAction,u.ageRatingAction=t.ageRatingAction,u.logoArtwork=t.logoArtwork,u.navigationBarIconArtwork=t.navigationBarIconArtwork,u.uberArtwork=null===(o=t.uber)||void 0===o?void 0:o.artwork,u.uberArtworkForCompactDisplay=null===(a=t.uber)||void 0===a?void 0:a.compactArtwork,u.uberVideo=null===(c=t.uber)||void 0===c?void 0:c.video,u.uberStyle=null===(l=t.uber)||void 0===l?void 0:l.style,u.media=function(e){const t=[]
for(const n of Object.values(e.shelfMapping))if(Wa(n)){const e=n.contentsMetadata,r=n.items
t.push(new gY(r,e.platform,e.allPlatforms,e.platformDescription,e.allPlatformsDescription,e.allPlatformsDescriptionPlacement))}return t}(t),i(t.shelfMapping[Yq])&&(u.badges=pd(e,t.shelfMapping[Yq])),u.shareAction=t.shareAction,u.pageMetrics=t.pageMetrics,u.pageRenderMetrics=t.pageRenderMetrics,u.isComplete=!t.isIncomplete,u.hasDarkUserInterfaceStyle=t.hasDarkUserInterfaceStyle,u.mediaSectionTitle=e.loc.string(nC),u.expandedOfferDetails=t.expandedOfferDetails,u.regularPriceFormatted=t.regularPriceFormatted,u.theme=t.theme,u.externalVersionIdentifier=t.externalVersionIdentifier,u.updateBuyParams=t.updateBuyParams,u.appPlatforms=t.appPlatforms,u.descriptionHeader=t.descriptionHeader,u.description=t.description,u.banner=t.banner,u.secondaryBanner=t.secondaryBanner,u.fullProductFetchedAction=t.fullProductFetchedAction,u.appPromotionDetailPageFlowAction=t.appPromotionDetailPageFlowAction,u.pageRefreshPolicy=t.pageRefreshPolicy,u.purchasedOrdering=Va(e,Ha(0,!0,e.host.platform,n,!1,!1,r)),u.notPurchasedOrdering=Va(e,Ha(0,!1,e.host.platform,n,!1,!1,r)),u.shelfMapping=function(e,t){const n={}
for(const r of O4){let o
o=r===_W?Ka(e,t):t.shelfMapping[r],s(o)&&(n[r]=o)}return n}(e,t),u.alwaysAllowReviews=t.alwaysAllowReviews,u})}function Ka(e,t){const n=t.shelfMapping[zq],r=t.shelfMapping[PV],i=t.shelfMapping[Iq],a=t.shelfMapping[EG],c=t.shelfMapping[DG]
if(o(n)&&o(r)&&o(i)&&o(a)&&o(c))return null
let l=null,u=[],d=null,f=null,h=null,p=null,w=null
if(s(null==r?void 0:r.items))for(const e of r.items){const t=e
switch(t.sourceType){case Iq:l=t.review
break
case rC:u.push(t.review)}}else u=null
if(s(null==i?void 0:i.items)&&(l=i.items[0]),s(null==a?void 0:a.items)&&(f=a.items[0].action),s(null==c?void 0:c.items)){const e=c.items[0].action
h=e.writeReviewAction,p=e.supportAction}s(null==n?void 0:n.items)&&(d=n.items[0],w=null==n?void 0:n.seeAllAction)
const v=new wK
v.adamId=t.lockup.adamId,v.ratings=d,v.tapToRate=f,v.editorsChoice=l,v.reviews=u,v.supportAction=p,v.writeReviewAction=h,v.alwaysAllowReviews=t.alwaysAllowReviews
const g=new pK(oC)
return g.title=ja(e),g.items=[v],g.seeAllAction=w,g}async function Za(e,t,n){ym.beginContext(e)
let r=await M(t())
if(!r.success&&(0,mm.isSome)(n)&&(r=await M(n(r.error))),ym.endContext(),r.success)return r.value
throw r.error}function Qa(e,t,n,r,i){if(!li(e))return null
if(o(t))return null
const s={pageInformation:n,locationTracker:r},a=mi(e,t,null,!1,!1,s,!0,!0,!1,i.allowUnpublishedAppEventPreviews);(0,mm.isSome)(a.nextAppEventPromotionStartDate)&&(0,mm.isSome)(null==i?void 0:i.refreshController)&&Vr(a.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const c=a.appPromotions
if(0===c.length)return null
const l=Xa(0,c,void 0)
return l.isHorizontal=!1,Jh(e,l,{...s,id:"",kind:null,softwareType:null,targetType:rW,title:""}),l}function Xa(e,t,n){const r=new pK(sE)
return r.isHorizontal=!0,r.title=n,r.items=t,r}function ec(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n){const n=r.replace(/\//g,"\\/")
if(new RegExp(n).test(t)){const n=new _J(xN,t)
return n.pageData=new F4(e.bag.metricsTopic),n}}const r=e.bag.webViewRegexStrings
for(const e of r){const n=e.replace(/\//g,"\\/")
if(new RegExp(n).test(t))return new _J(G$,t)}return new _J(fV,t)}function tc(e){switch(e){case WB:return WB
case TO:return TO
default:return GW}}function nc(e){return`${e.shelfIdentifier}.${e.slot}`}function rc(e,t){if(r(e))return null
const n=nc(t),o=e.tasks[n]
return r(o)?null:(delete e.tasks[n],o)}function oc(e,t,n){var r
const o=(null==n?void 0:n.meta)||null,i=null===(r=null==o?void 0:o.adDisplayStyle)||void 0===r?void 0:r.slot
return(0,mm.isSome)(i)?ic(e,t,{shelfIdentifier:U4,slot:i}):ic(e,t,B4)}function ic(e,t,n){const o=null==t?void 0:t.mediaResponse
if((0,mm.isNothing)(o)||(0,mm.isSome)(null==t?void 0:t.failureReason))return null
const i={tasks:{}}
return function(e,t){if(r(e))return
const n=nc(t.positionInfo)
e.tasks[n]=t}(i,{data:mt(e,o),positionInfo:n}),i}function sc(e,t,n){e.bag.isOnDemandShelfFetchingEnabled&&(0,Am.isSome)(t)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=lc(e,t,n.remainingItems.length))}function ac(e,t,n,r,i){(0,Am.isSome)(t)&&(0,Am.isSome)(t.url)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=lc(e,t,null!=r?r:n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,i))}function cc(e,t,n,r){n.showingPlaceholders=lc(e,t,n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,r)}function lc(e,t,n,r=!1,i=!1,a=null){if(s(t.items))return!1
if(!function(e,t){switch(t){case mW:case Kq:case hU:case sj:case Ex:case eS:case SU:case zN:case oB:case sE:case qB:case mH:case mS:case eN:return!0
default:return!1}}(0,t.contentType)||r)return!1
const c=function(e,t,n){return t>0?t:(0,Am.isSome)(n)&&!zi(n)?0:e.client.isPad?15:6}(e,n,a),l=new Array(c)
for(let e=0;e<c;e+=1)l[e]=new x4
if(o(l))return!1
const u=function(e,t){if((0,Am.isSome)(t.rowsPerColumn))return t.rowsPerColumn
switch(t.contentType){case mW:return 3
case Kq:return 2
case hU:return 1
case Ex:return null
default:return 1}}(0,t)
return(0,Am.isSome)(u)&&(t.rowsPerColumn=u),t.placeholderContentType=t.contentType,t.contentType=gB,t.items=l,s(i)&&(t.presentationHints={...t.presentationHints,isAppleArcadeContext:i}),t.isHidden=!1,!0}function uc(e){return e.contentType===gB}function dc(e){const t=[RW,TW,XH,tq]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}function fc(e){const{platform:t,id:n,...r}=e
return{...r,platform:lt(t),id:ut(n),$kind:j4}}async function hc(e,t,n){var r
const o=Object.keys(n),i=o.map(async e=>await n[e]),s=await async function(e){const t=await Promise.all(e.map(async e=>{try{const t=await e
return function(e){return null!==e&&typeof e===vH&&cY in e}(t)?t:E(t)}catch(e){return D(e instanceof Error?e:new Error(String(e)))}})),n=[]
if(t.forEach(e=>{e.success||n.push(e.error)}),n.length>0)throw 1===n.length?n[0]:new lY(n)
return t}([t,...i]),a=s[0],c=a.value
if(!a.success||(0,mm.isNothing)(c))throw null!==(r=a.error)&&void 0!==r?r:new Error("Unknown primaryPageData error")
const l={},u=s.slice(1)
for(const[t,n]of u.entries()){const r=o[t]
n.success?l[r]=n.value:(l[r]=null,e.console.log(`Builder - failed to fetch additionalPageRequirement ${r}, reason: ${n.error}`))}return{primaryPageData:c,additionalData:l}}async function pc(e,t,n,o,i){const s=n(e,t,i)
if(!s)return await Promise.resolve({originalData:t})
const a=Array.from(s),c=[]
for(const t of a){const n=o(e,t)
if(r(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}function wc(e,t,n){if(o(t))return
const r=function(e){return f(e,"meta.metrics.clusterId")}(n)
o(r)||function(e,t,n){const r=gc(t)
e.storage.storeString(r,n)}(e,t,r)}function vc(e,t){return o(t)?null:function(e,t){const n=gc(t)
return e.storage.retrieveString(n)}(e,t)}function gc(e){return e+"-cohort-id"}function mc(e,t,n=[],r){const o={exclusions:null==r?void 0:r.exclusions},i=n.slice()
return(null==r?void 0:r.optionalQuery)&&i.push(...r.optionalQuery.map(e=>`${e}?`)),{routes(n){var s,a
return[{rules:[...null!==(s=null==r?void 0:r.prependRules)&&void 0!==s?s:[],{...o,path:t,query:[`${Hz.language}?`,...i]},{...o,path:`/{${_z.storeFront}}${t}`,query:[`${Hz.language}?`,...i],regex:[/^https?:\/\/[^/]+\/[a-z]{2}(\/.*)?$/i]},...null!==(a=null==r?void 0:r.extraRules)&&void 0!==a?a:[]],handler(t,r){const{[_z.storeFront]:o,[Hz.language]:i,...s}=r
return e({...s,...xi(n,{storefront:o,language:i})})}}]},makeCanonicalUrl(e,o){const i=function(e,t,n){const r=new ay.URL("https://apps.apple.com"),{storefront:o,language:i}=function(e,t){return e.locale.deriveLocaleForUrl(t)}(e,n)
return r.path(o),r.path(t.substr(1)),(0,mm.isSome)(i)&&r.param("l",i),r}(e,t,o),s=i.pathComponents()
for(const[e,t]of s.entries())if(t.startsWith("{")&&t.endsWith("}")){const n=t.substring(1,t.length-1)
s[e]=o[n]}i.set(aH,"/"+s.join("/"))
const a=n.slice()
a.sort((e,t)=>e.localeCompare(t))
for(const e of a){if(!(e in o))throw new Error(`expected queryParmeters to contain: ${e}`)
const t=o[e]
i.param(e,t)}if(null==r?void 0:r.optionalQuery){const e=r.optionalQuery.slice()
e.sort((e,t)=>e.localeCompare(t)),e.forEach(e=>{const t=o[e]
t&&i.param(e,t)})}return i.toString()}}}function yc(e,t,n=[],r){const{makeCanonicalUrl:o}=mc(e,t,n,r),i=["tv",OW,IW,iz,zW,oz].map(o=>mc(t=>e({...t,platform:o}),`/${o}${t.replace(/^\/\{platform\}/,"")}`,n,r).routes)
return{routes:e=>i.map(t=>t(e)).reduce((e,t)=>[...e,...t]),makeCanonicalUrl:o}}function Ac(e,t,n){const r=new pK(n||G4)
r.isHorizontal=!1,r.items=pS
const o=new gK([r])
return o.isIncomplete=!0,o.title=t,o}function Tc(e,t){if(!(0,Am.isNothing)(t))switch(t){case X4:return Q4
case Q4:return X4
default:return}}async function bc(e,t,n,r=null){const o=function(e,t,n,r=null,o=e.host.clientIdentifier){const i=[XH,tq,yq]
e.bag.enableUpdatedAgeRatings&&i.push(bW),e.appleSilicon.isSupportEnabled&&i.push(bq)
const a=new cJ(e).forType(JN).addingQuery(mq,t).includingAttributes(i).addingQuery(KN,az).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
return s(n)&&a.addingQuery(Hz.charts,n),o===nJ?a.addingContext(oz):o===rJ&&a.addingContext(eW),e.appleSilicon.isSupportEnabled&&a.includingAdditionalPlatforms([OW,IW]),(0,Am.isSome)(r)&&a.addingQuery(Hz.ages,r),a}(e,t,n,r)
return o.withLimit(200),o.enablingFeature("newChartsElements"),await Ln(e,o)}async function Sc(e,t,n){let r
return r=e.host.clientIdentifier===rJ||function(e){return s(e)&&(-1!==e.indexOf(e5)||-1!==e.indexOf(t5))}(t)?Promise.resolve({}):Ln(e,An(e,n)).catch(()=>{}),await r}function Pc(e,t){var n
const r=null===(n=oY.from(t).query)||void 0===n?void 0:n[sW],o=e.loc.string(xA)
return(0,Am.isNothing)(r)?o:Cc(r)?e.loc.string(MA):Ic(r)?e.loc.string(FA):kc(r)?e.loc.string($A):o}function Cc(e){switch(e){case n5:case r5:return!0
default:return!1}}function Ic(e){switch(e){case o5:case i5:return!0
default:return!1}}function kc(e){return e===s5}function Oc(e,t){var n
let r=e.loc.string(Gb)
return(0,mm.isSome)(t.title)?r=`${t.title}, ${r}`:(0,mm.isSome)(null===(n=t.header)||void 0===n?void 0:n.title)&&(r=`${t.header.title}, ${r}`),{label:r,roleDescription:e.loc.string(jb)}}function Ec(e,t,n){const r=s(n)?[...n]:[]
return r.push(`${Hz.groupingFeaturedContentId}=${e}`),s(t)&&r.push(`${Hz.nativeGroupingShelfId}=${t}`),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:r}}function Dc(e,t){const n=[]
for(const r of e)n.push(Ec(r,null,t))
return n}function Rc(e,t){if([tH,KH,$j].includes(e.host.platform)&&ft(t)){const e={app:"com.apple.gamecenter.from.browse",kind:{name:kH}}
return t.referrerData=e,new rZ([new l5(e),t])}return t}function _c(e,t,n,r){const o={...n,shouldFilter:!H(t,_x),chartUrl:j(t,bj),chartIdentifier:j(t,sW),roomRelationshipData:pe(e,t,"room")}
return Yi(o.featuredContentId)?(o.seeAllUrl=function(e,t,n){const r=j(t,bj),o=new oY(r),i=j(t,sW)
s(i)&&o.param(Hz.chart,i)
const a=function(e,t,n){var r
const o=(null!==(r=null==n?void 0:n.editorialCharts.length)&&void 0!==r?r:0)>1,i=null==n?void 0:n.editorialCharts.map(e=>e.type.toString()).join(",")
if((0,Am.isSome)(i)&&i.includes(t)&&o)return i
const s=Tc(0,t)
return void 0===s?t:[t,s].join(",")}(0,i,n)
return s(a)&&o.param(Hz.charts,a),o.toString()}(0,t,r.chartSet),o.showOrdinals=!0,o.shouldFilter=!1):s(o.roomRelationshipData)&&(o.seeAllUrl=ji(e,o.roomRelationshipData.href)),o.shelfStyle=function(e,t,n,r){const o=n.featuredContentId
if(o===$1||o===g1||o===E1||function(e){return H1.has(e)}(o)){let e=j(t,Aq)
return e||(e=o===d1||o===f1?PW:o===E1||o===$1?DH:Bq),`${e}Lockup`}if(o===I1)return uF
if(o===P1)return oB
if(o===l1||o===u1||o===C1||o===m1)return zN
if(Yi(o))return mW
if(o===R1)return SU
switch(r.shelves.length%3){case 0:return mW
case 1:return Kq
default:return hU}}(0,t,o,r),o.clientIdentifierOverride=Gr(e,t),o}function Lc(e,t,n,a){const c=(l=t.featuredContentId,G1.has(l)?Im.ChartsMac:Im.All)
var l
let u,d,h=[]
if(s(n.shelfContents)){const o=function(e,t,n,o){var s
const a=rc(t,n)
if(r(a))return null
const c=a.data,l=Mc(e,c,o)
return i(l)?o.includedAdAdamIds=[c.id]:null===(s=o.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,n.shelfIdentifier,n.slot),l}(e,null==a?void 0:a.adStitcher,B4,t)
o&&dt(o)&&(h.push(o),Vh(t.metricsLocationTracker),t.ordinalIndex++,n.shelfContents=n.shelfContents.filter(e=>e.id!==o.adamId))}for(const o of n.shelfContents){if(o.type===tz)return null
if(t.featuredContentId===$1&&o.type===YW){u=o
continue}if(r(o.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}if(st(e,o,c))continue
const n=Mc(e,o,t)
n&&(dt(n)&&(n.id=lf(t.id,Uh(t.metricsLocationTracker),n.adamId)),h.push(n),Vh(t.metricsLocationTracker),t.ordinalIndex++)}!Yi(t.featuredContentId)||Ki(t.featuredContentId)||Ji(t.featuredContentId)||(h=function(e,t){if(!e)return[]
const n=e.length,r=n%3
return n>=3?e.slice(0,n-r):e}(h)),delete t.maxItemCount,d=Ji(t.featuredContentId)?lo(e,t.title):{eyebrow:t.eyebrow,eyebrowArtwork:t.eyebrowArtwork,title:t.title,titleArtwork:t.titleArtwork,subtitle:t.subtitle,configuration:t.shelfHeaderConfiguration}
const w=new pK(t.shelfStyle)
let v
if(w.isHorizontal=!0,w.items=h,w.shouldFilterApps=t.shouldFilter,Ji(t.featuredContentId)&&(w.footerTitle=e.loc.string(Dx),w.footerAction=co({objectGraph:e,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker}),w.footerStyle={$kind:qq,bundleID:TB,width:16,height:16},w.items.forEach((t,n)=>{(0,Am.isSome)(t)&&dt(t)&&(t.clickAction=Rc(e,t.clickAction))})),t.featuredContentId===$1?function(e,t,n,r,o,i,a){if((0,Am.isNothing)(i)&&(i=pe(e,t.featuredContentData,_E)),r.configuration.includeTrailingArtwork=!0,!W(i)){const e=j(t.featuredContentData,cz)
return r.eyebrow=e,r.title="",n.footerTitle="",t.isDeferring=!0,void t.remainingItems.push(i)}const c=j(t.featuredContentData,cz)
r.eyebrow=c
const l=B(i,nH),u=f(l,cz)
r.title=u,Gh(t.metricsLocationTracker).name=u,s(t.originalPlaceholderShelfImpressionMetrics)&&(t.originalPlaceholderShelfImpressionMetrics.fields.name=u)
const d=B(i,RW)
if((0,Am.isNothing)(d))return void(n.isHidden=!0)
const h=p(d,"storyBackgroundStatic16x9"),w={useCase:R3.CategoryBreakoutShelf,withJoeColorPlaceholder:!0},v=ss(e,h,w),g=be(v.backgroundColor)?MW:iW
n.background={type:XW,artwork:v,style:g},o.forEach((t,n)=>{(0,Am.isSome)(t)&&dt(t)&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,wV,g),t.subtitleTextFilter=vT,e.clientCapabilities.isNotEnabled(hS)&&(t.redownloadButtonTint=Se(lW)))})
const m=p(d,GD)
if((0,Am.isNothing)(m))return void(n.isHidden=!0)
const y={contentMode:Pm.scaleAspectFit,useCase:R3.GroupingBrick},A=ss(e,m,y)
r.trailingArtwork=A
const T=f(i.attributes,BW),b=f(i.attributes,rx),S={id:i.id,idType:yW,targetType:lz,actionType:dz,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
if((0,Am.isSome)(T)){n.footerTitle=b
const t=e.required(R9).fetchFlowPage(T),r=new _J(t)
r.title=b,r.pageUrl=T,ra(e,r,S),n.footerAction=r}else{const r={targetType:lz,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(i)},o=ls(e,i,t,!1,null,r,a);(0,Am.isSome)(o.action)&&(o.action.actionMetrics.clearAll(),o.action.title=null!=b?b:f(l,"callToAction"),ra(e,o.action,S),n.footerAction=o.action,n.footerTitle=o.action.title)}}(e,t,w,d,h,u,a):e.clientCapabilities.isNotEnabled(hS)&&w.items.forEach((e,t)=>{(0,Am.isSome)(e)&&dt(e)&&(e.redownloadButtonTint=Se(dM))}),w&&o(w.items)&&t.isFirstRender&&cc(e,w,t,t.featuredContentId),Yi(t.featuredContentId))v=new _J(tj)
else if(v=new _J(fz),!uc(w)){const e=function(e,t){if(!t)return null
switch(t){case QN:case uF:return t
default:return null}}(0,t.shelfStyle)
v.pageData=Ac(0,t.title,e)}v.pageUrl=t.seeAllUrl,Yi(t.featuredContentId)&&(0,Am.isSome)(v.pageUrl)&&(v.pageData=new N4("",Pc(e,v.pageUrl))),v.title=e.loc.string(nq),v.referrerUrl=t.metricsPageInformation.pageUrl,oa(e,v,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})
const g=function(e,t,n){return n.featuredContentId!==$1&&!Ki(n.featuredContentId)&&!Ji(n.featuredContentId)&&n.featuredContentId!==R1}(0,w.items,t),m=i(v.pageUrl)||i(v.pageData)
if(g&&m&&vs(e,d,v),t.shelfStyle===oB||t.shelfStyle===zN){const e=j(t.featuredContentData,"suppressTagline")!==cW
r(w.presentationHints)?w.presentationHints={showSupplementaryText:e}:w.presentationHints={...w.presentationHints,showSupplementaryText:e}}return t.shelfStyle,w.header=d,w.url=ts(0,w,t),w}function Mc(e,t,n){if(o(t))return null
let a
n.showOrdinals&&(a=e.loc.decimal(n.ordinalIndex))
let c,l=null
!i(n.shelfBackground)||n.shelfBackground.type!==wH&&n.shelfBackground.type!==qM||(l=lW),s(n)&&(c=n.clientIdentifierOverride)
const u={ordinal:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),isAdvert:Ut(0,t)},clientIdentifierOverride:c,artworkUseCase:uf(0,n.shelfStyle),offerStyle:l,canDisplayArcadeOfferButton:ph(0,n.shelfStyle),isContainedInPreorderExclusiveShelf:n.featuredContentId===R1,shouldHideArcadeHeader:e.featureFlags.isEnabled(bK)&&n.isArcadePage}
let d
switch(n.shelfStyle){case zN:d=function(e,t,n,r){return ym.context("trailersLockupFromData",()=>{const o=new BJ
return function(e,t,n,r,o){t&&ym.context("copyDataIntoTrailersLockup",()=>{Dd(e,t,n,o),n.trailers=Af(e,t,r,o.metricsOptions,n.adamId)})}(e,t,o,r,n),o})}(e,t,u,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
break
case oB:d=Ud(e,t,u)
break
case SU:d=Gd(e,t,u)
break
case QN:case uF:d=Bd(e,t,u)
break
case"smallImageLockup":case Mj:case Ix:d=Vd(e,t,u,Nm.EditorialLockupLarge)
break
default:d=Nd(e,t,u)}return r(d)||!d.isValid()?null:d}function Fc(e){return Ne(e,Cm.Arcade)||f5}function $c(e){switch(Fc(e)){case h5:return"smallWithSubtitle"
case p5:return"smallWithRatingStars"
default:return"compact"}}function xc(e){return Ne(e,Cm.ArcadeDownloadPackOnboarding)||cy.LayoutB}function Nc(e,t,n=!1){const r=qc(e,t),o=e.client.isPhone
let i=o?Wb:LD
n&&(i="topShelf")
const a=p(r,i)
let c=null,l=null
return s(a)&&(c=df(e,a,{withJoeColorPlaceholder:!0,useCase:R3.ArcadeLargeBreakout}),s(c)&&(c.crop=o?"oa":n?"ta":"ob",l=c.backgroundColor)),{artwork:c,artworkData:a,backgroundColor:l}}function Bc(e,t,n=!1,r=!1){const o=function(e,t){switch(t.type){case YW:return B(t,TW)
case pH:return B(t,fE)
default:return se(t,tt(e,t),fE)}}(e,t),i=e.client.isPhone||r,a=i?"breakoutVideo9x16":"breakoutVideo16x9",c=p(o,i?"sizzleVideo9x16":"sizzleVideo16x9")||p(o,a)
let l=null,u=null,d=null
if(s(c)){d=p(c,Dj)
const t=df(e,d,{withJoeColorPlaceholder:!0,useCase:R3.ArcadeLargeBreakout})
s(t)&&(t.crop="sr",u=t.backgroundColor)
const r=f(c,Xq)
s(t)&&(null==r?void 0:r.length)>0&&(l=new wY(r,t,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:n},autoPlayPlaybackControls:{}}))}return{video:l,artworkData:d,backgroundColor:u}}function Uc(e,t,n=!0,r,o){const i=Bc(e,t),s=Nc(e,t),a=i.backgroundColor||s.backgroundColor
return jc(e,t,0,o),(t.type===pH?u(Hc(0,t),"displayMaterial"):H(t,hT))&&n?pT:Gc(0,a)}function Gc(e,t){return t?be(t,50)?MW:iW:MW}function jc(e,t,n,r){if(e.client.isPhone||r)return CW
const o=t.type===pH?f(Hc(0,t),"textPosition"):j(t,AE)
if((0,mm.isNothing)(o)||0===o.length)return QW
switch(o.toLowerCase()){case TE:return QW
case CW:return CW
case bE:return MV
default:return QW}}function Vc(e,t,n,r=!1){switch(t){case QW:case MV:return QW
case CW:return r||n.type===pH?CW:function(e,t){var n
switch((null!==(n=j(t,AE))&&void 0!==n?n:"").toLowerCase()){case TE:return QW
case CW:return CW
case bE:return MV
default:return QW}}(0,n)
default:return QW}}function Hc(e,t){return t.type!==pH?null:B(t,"display.templateParameters")}function qc(e,t){switch(t.type){case YW:return B(t,RW)
case pH:return B(t,oT)
default:return se(t,tt(e,t),RW)}}function Wc(e,t){return t.type===pH?f(mr(0,t),"callToActionLabel"):j(t,rx)}function zc(e,t){const n=s(B(t,EW)),r=H(t,tG)
return!n&&!r}function Yc(e,t){const n=B(t,EW),o=s(n),i=(j(t,Dq),H(t,tG)),a=pe(e,t,vq)
if(!o&&!i&&!W(a))return null
let c=null
if(c=o?f(n,BW):j(i?t:a,BW),r(c))return null
let l=null
if(o&&f(n,ox)===vM)l=new HJ(c)
else if(e.isAvailable(R9)){const t=e.required(R9).fetchFlowPage(c),n=new _J(t)
n.pageUrl=c,t===fq&&(n.pageData=hd(e,a)),l=n}return l&&(l.title=Wc(0,t)),l}function Jc(e,t,n=!1){if(o(t))return null
let r=null
const i=Se(lW),s=Se(SE),a=ye(f(t,Jj)),c=l(t,wT).map(e=>ye(e)),u=Gc(0,a)
if(2===c.length){r=new H5("horizontalGradient")
const e=c[0],t=c[1]
r.gradientStartColor=Pe(e,e),r.gradientEndColor=Pe(t,t),r.filter=vT,n||(r.accessoryColor=r.gradientEndColor)}else r=new H5(wH),r.color=u===MW?i:s,n||(r.accessoryColor=r.color),r.isFallbackStyle=!0
return r}function Kc(e,t,n,r=lW){if(o(t)||o(t.attributes))return null
const s=Bc(e,t,!0),a=Nc(e,t),c=s.backgroundColor||a.backgroundColor,l=jc(e,t,0,!0),u=Uc(e,t,!1,0,!0)!==pT&&!0,d=Xc(e,t,0,!1,u,wM)
let h=null
"tv"!==e.client.deviceType&&(h=d.description,d.description=null)
const p=function(e,t){const n=Hc(0,t),r=f(n,"ctaButtonBackgroundColor"),o=f(n,"ctaButtonTextColor")
return i(r)&&i(o)?{type:nx,fillColor:ye(r),textColor:ye(o)}:{type:jL,fillColor:null,textColor:null}}(0,t),w=new VJ(nz,e.bag.arcadeAppAdamId,null,r,null,nz,p,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId),v=new t6(d,w,{backgroundColor:c,wantsMaterialDetailBackground:!1,wantsBlur:u,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:l},null,h,a.artwork,s.video),g=ep(e,t,v.details.title,{...n,targetType:ej})
return g.displaysArcadeUpsell=!0,Jh(e,v,g),xh(e,g,v.details.title),v.offerButtonAction=el(e,t,ht(qU),n),Bh(n.locationTracker),v}function Zc(e,t){return Wc(0,t)}function Qc(e,t){return j(t,Pq)}function Xc(e,t,n,r,o,i){let s=null
switch(i){case wM:s={type:wM}
break
case WH:const e=j(t,KU)
s=(null==e?void 0:e.length)>0?{type:WH,title:e}:{type:wW}
break
default:s={type:wW}}let a=Uc(e,t,r,0,!0)
const c=jc(e,t,0,!0)
return o&&(a=MW),new n6(function(e,t){return j(t,FW)}(0,t),Qc(0,t),s,null,a,Vc(0,c,t,!0))}function el(e,t,n,r){const o={marketingItemData:t},i=n===ht(qU)&&e.bag.arcadeDownloadPackPostSubscribeTrigger&&lr(e,e.bag.arcadeDownloadPackRolloutRate)
return tl(e,o,Zc(0,t),r,i)}function tl(e,t,n,r,o){const s=t.marketingItemData
if(!i(s))return null
const a=mr(0,s),c=f(a,Dq)===EW,u=f(a,BW)
if(c&&u){const t=function(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n)if(new RegExp(r).test(t)){const n=new _J(xN,t)
return n.pageData=new F4(e.bag.metricsTopic),n}const r=e.bag.financeUIRegexStrings
for(const e of r)if(new RegExp(e).test(t))return new _J(fV,t)
const o=e.bag.webViewRegexStrings
for(const e of o)if(new RegExp(e).test(t))return new _J(G$,t)
return new HJ(t,!1)}(e,u),o={id:e.bag.arcadeAppAdamId,actionType:tx,actionContext:dW,contextualAdamId:e.bag.arcadeAppAdamId,offerType:mE,targetType:lz,mercuryMetricsData:Lh(0,s),...r}
return t.title=n,ra(e,t,o),t}{const t=function(e,t,n,r){const o=mr(0,t),s=f(o,Yj),a=f(o,pV)
if(!i(s)||!i(a))return null
const c=l(o,"serviceTypes").length>1&&e.bag.aristotleParentAppAdamId?e.bag.aristotleParentAppAdamId:e.bag.arcadeAppAdamId,u=new r6(s,c,{buyParams:a,productIdentifier:s,pageInformation:r.pageInformation},null,null),d={id:c,actionType:tx,targetType:lz,subscriptionSKU:s,actionContext:dW,contextualAdamId:c,actionDetails:{buyParams:a},offerType:mE,mercuryMetricsData:Lh(0,t),...r}
return u.title=n,ra(e,u,d),u}(e,s,n,r)
if(o){const e=new _J(lU),r=WB
e.pageData=r,e.presentationContext=$V
const o=new IQ(void 0,void 0,e,void 0),i=new rZ([t,o])
return i.title=n,i}return t}}function nl(e,t,n){switch(n){case mH:return a6.has(t)
case yB:return i6.has(t)
case IU:return s6.has(t)
default:return!1}}function rl(e,t,n,o,s,a){const c=new qQ(o.metricsPageInformation,o.metricsLocationTracker)
null==a&&((a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}).isHorizontalShelfContext=!0),e.client.deviceType!==oz&&(a.coercedCollectionTodayCardDisplayStyle=Jm.Grid)
const l=Ro(t,a.coercedCollectionTodayCardDisplayStyle)
if(a.prevailingCropCodes=function(e,t,n){switch(t){case mH:return null
case yB:return{defaultCrop:"el"}
case IU:return n===Jm.Video?{defaultCrop:"sr"}:{defaultCrop:"ek"}
default:return null}}(0,n,l),a.horizontalCardContentType=n,!i(t.attributes))return s&&s(t),null
const u=ko(e,t,a,c,o.augmentingData)
if(r(u))return null
{u.collapsedHeading=Uo(0,u),u.inlineDescription=sl(e,u,t),u.inlineDescription===u.collapsedHeading&&(u.inlineDescription=null)
const n=u.media
n&&n.kind===dV&&(u.title=null)}if(n===IU){const e=u.heroMedia
if(!i(e)||0===e.artworks.length&&0===e.videos.length)return null}return nl(0,u.media.kind,n)&&i(o.filterOutMediaCardKinds)&&o.filterOutMediaCardKinds.has(u.media.kind)?null:(function(e,t,n){if("tv"!==e.client.deviceType||!H(n,cL))return
const r=new HJ("com.apple.Arcade://")
t.clickAction=r}(e,u,t),u)}function ol(e,t,n,r,s,a,c){if(!i(n))return null
const l=new pK(n)
return r&&(l.title=r),l.subtitle=s,l.isHorizontal=!0,l.items=n===vG?[al(e,t,a.metricsPageInformation,a.metricsLocationTracker,()=>!0,c)]:function(e,t,n,r,i,s){const a=[]
for(const s of t){const t=rl(e,s,n,r,i,void 0)
o(t)||(a.push(t),Vh(r.metricsLocationTracker))}return a}(e,t,n,a,c),l}function il(e,t,n,r,s,a){const c=new pK(eN)
n&&(c.title=n),c.subtitle=r,c.isHorizontal=!0
const l=[],u={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
u.metricsDisplayStyle=Km.SmallCard,u.alwaysShowBadgeInSmallCards=!0,u.alwaysUseMaterialBlur=!0
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=ko(e,n,u,s)
o(t)||(l.push(t),Vh(s.locationTracker))}return c.items=l,c}function sl(e,t,n){{let o=ah(e,n,cz)
return i(o)&&(o=o.replace(/\n/g," ")),t.media.kind===dV&&Br(r=t.overlay)&&r[hz]===Zy&&i(t.overlay.lockup)?t.overlay.lockup.title:o}var r}function al(e,t,n,o,s,a){return ym.context("todayCardsFromPlatformData",()=>{if(!t)return null
const c={useOTDTextStyle:!1,enableFullScreenVideo:!1,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
c.coercedCollectionTodayCardDisplayStyle=Jm.Grid,c.prevailingCropCodes={defaultCrop:"fo"},c.isHorizontalShelfContext=!0
const l=new qQ(n,o),u=[]
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=ko(e,n,c,l)
if(!r(t)&&s(t)){t.collapsedHeading=Uo(0,t),t.inlineDescription=sl(e,t,n),t.inlineDescription===t.collapsedHeading&&(t.inlineDescription=null)
const r=t.media
r&&r.kind===dV&&(t.title=null),u.push(t)}}return u.length?new o6(u):null})}function cl(e,t){const n=new Set,r=mt(e,t),o=we(r,hB)
for(const t of o){const o=ul(e,t,r)
if(s(o))for(const e of o)n.add(e)}return n}function ll(e,t){let n
return t===oL&&(n=ho(e,ht(GL))),t===iL&&(n=fo(e,10)),r(n)?null:Ln(e,n).catch(()=>null)}function ul(e,t,n){if(j(t,MI)!==sL)return null
const o=j(t,FI),i=r(po(e,n)),s=[]
return o===$I&&(s.push(iL),i&&s.push(oL)),s}function dl(e,t,n,a,c){return ym.catchingContext(`module: ${a.module}`,()=>{var c
const l=[]
switch(a.module){case"Header":a.titleForNextShelf=j(t,lj)
break
case"TextBlock":{const e=function(e,t,n){const r=j(t,lj)
if(!r)return null
const o=new V0(r,hH,vW)
wl(0,o,n)
const i=new pK(OV)
return i.items=[o],i}(0,t,a);(0,mm.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"CollectionLockup":{const n=function(e,t,n){const r=H(t,"showOrdinals"),o="OrdinalDesc"===j(t,"collectionLockupDisplayType")?RS:"ascending",i=j(t,"collectionLockupSize")
let s
if(n.subStyle=i,i)switch(i){case VI:s=hU
break
case jI:s=Kq
break
default:s=mW}const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:uf(0,s),canDisplayArcadeOfferButton:ph(0,s)},c=we(t,sz)
if((0,mm.isNothing)(c))return null
let l=[]
if(l=Yd(e,c,{includeOrdinals:r,ordinalDirection:o,lockupOptions:a}),!l||0===l.length)return null
const u=new pK(s)
return u.items=l,u}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case xI:{const n=function(e,t,n){const r=j(t,"inlineImageDisplayType"),o=df(e,B(t,XW),{useCase:R3.ArticleImage,allowingTransparency:r===pN&&!0,withJoeColorPlaceholder:!1})
if(!o)return null
const i=new z5(o,!1,hH)
i.caption=j(t,lj),n.subStyle=r,r&&("BoundingBox"===r?(i.isFullWidth=!1,i.hasRoundedCorners=!0):(i.isFullWidth=!0,i.hasRoundedCorners=!1)),wl(0,i,n)
const s=new pK(aL)
return s.items=[i],s}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case NI:{const n=function(e,t,n){const r=pl(e,t)
if(!r)return null
let o=null
const a=we(t,tz)
if(s(a)&&(o=Qa(e,a,n.metricsPageInformation,n.metricsLocationTracker,n),i(o)))return o
const c=j(t,"appLockupSize")
let l
n.subStyle=c
let u=!1
if(c)switch(c){case GI:l=mW,u=!0
break
case jI:l=Kq,u=!0
break
default:l=WE}const d=aa(0,t)
if(u){const t=new pK(l)
let i
if(i=Nd(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:d,artworkUseCase:uf(0,l)}),(0,mm.isNothing)(i))return null
t.items=[i],o=t}else o=function(e,t,n){const r=new pK(WE),o="tv"!==e.client.deviceType,i=pl(e,t),s=aa(0,t),a=Nd(e,i,{offerStyle:AV,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:R3.LockupIconSmall}),c=new K5(PW,a)
c.description=Ld(e,i)
let l=null
switch(j(t,"appLockupVideo")){case"AppTrailer":{const t=bf(e,i)
t&&t.length>0&&(l=t[0])
break}}return l&&(yo(e,l,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId}),c.video=l),o&&(r.background={type:wH,color:l6}),r.items=[c],r}(e,t,n)
return o}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TipBlock":{const n=function(e,t,n){const r=df(e,B(t,XW),{useCase:R3.ArticleImage})
if(!r)return null
const o=j(t,lj),i=j(t,"tipNumber"),s=new z5(r,!1,hH)
s.isFullWidth=!1,s.hasRoundedCorners=!0,s.caption=o,s.ordinal=i,wl(0,s,n)
const a=new pK(aL)
return a.items=[s],a}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"PullQuote":{const n=function(e,t,n){const r=j(t,UI),o=j(t,"quoteAttribution"),i=df(e,B(t,XW),{useCase:R3.ArticleImage}),s=j(t,"pullQuoteDisplayType")===pN,a=new Y5(r,o,i,s)
wl(0,a,n)
const c=new pK(UI)
return c.items=[a],c}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"HorizontalRule":{const e=function(e,t,n){const r=j(t,"lineStyle"),i=j(t,Aq)===pN
let s=Se("defaultLine")
const a=B(t,"customColor"),c=ye(f(a,"lightMode")),l=ye(f(a,"darkMode"))
o(c)||o(l)||(s=Pe(c,l))
const u=new J5(r,s,i),d=new pK("horizontalRule")
return d.items=[u],d}(0,t);(0,mm.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case BI:{const n=function(e,t,n){const r=df(e,B(t,"video.previewFrame"),{useCase:R3.ArticleImage})
if(!r)return null
const o=j(t,"video.video")
if(!o)return null
const i=j(t,"inlineVideoDisplayType")===pN,s=new wY(o,r,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
yo(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const a=new C4(s,i,hH)
a.caption=j(t,lj),wl(0,a,n)
const c=new pK(h$)
return c.items=[a],c}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppMedia":{const n=function(e,t,n){const o=pl(e,t)
if(!o)return null
const s=j(t,"appMediaOption"),a=j(t,"appMediaPlatform")
switch(n.subStyle=s,s){case zy:{let t=null
if(t=new pK(jW),r(a)){const n=Sf(e,o,R3.ArticleScreenshots)
n&&n.length>0&&(t.items=[n[0]])}else{const n=function(e,t){switch(t){case CS:return oz
case tH:return e.client.isPad?HW:ZW
case $j:return"tv"
case IS:return eW
case"visionOS":return zW
default:return null}}(e,a)
if(n){const r=Sf(e,o,R3.ArticleScreenshots,[n])
r&&r.length&&(t.items=[r[0]])}}return i(t)&&0===t.items.length?null:t}case"AppTrailers":const t=new pK(h$),s=bf(e,o)
if(s&&s.length>0){const r=s[0]
yo(e,r,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const o=new C4(r,!1,FH,null,null,!0)
return t.items=[o],t}return null
default:return null}}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"LinkBlock":{const r=function(e,t,n,r){const o=j(t,BW)
if(!o)return null
const i=new oY(o),s=j(t,"urlTitle")
let a=j(t,lj)
a||(a=i.host)
const c=[HI,FG,"music.apple.com","books.apple.com","podcasts.apple.com","watch-app.cdn-apple.com","tv.apple.com"]
let l=!1
for(const e of c)i.host.endsWith(e)&&(l=!0)
{const t=e.required(R9).fetchFlowPage(o)
!(0,mm.isSome)(t)||t!==vW&&t!==xN||(i.protocol=kz)}e.bag.disabledRichLinkPresentationEditorialItemIds.includes(r.id)&&(l=!1)
const u=new HJ(i.build())
ra(e,u,{targetType:EW,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const d=new Q5(s,a,u,l)
wl(0,d,n)
const f=new pK(rL)
return f.items=[d],f}(e,t,a,n);(0,mm.isSome)(r)&&(l.push(r),a.hasFocusableElements=!0)
break}case"TextList":{const e=function(e,t,n){const r=G(t,lj)
if(!r.length)return null
const o=j(t,"textListDisplayType")
n.subStyle=o
let i,s=!1
s="Bulleted"===o,i=s?"<ul>":"<ol>"
for(const e of r){const t=JSON.stringify(e)
i=`${i}<li>${JSON.parse(t)}</li>`}i=s?`${i}</ul>`:`${i}</ol>`
const a=new V0(i,hH,vW)
wl(0,a,n)
const c=new pK(OV)
return c.items=[a],c}(0,t,a);(0,mm.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"IAPLockup":{const n=function(e,t,n){const r=pl(e,t)
if(!r)return null
const o=Bd(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:R3.LockupIconSmall})
if(!o)return null
const i=new Z5(o),s=new pK("inAppPurchaseShowcase")
return s.background={type:wH,color:c6},s.items=[i],s}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case sL:{const o=function(e,t,n,o){const a=j(t,FI)
o.subStyle=a
let c=null
switch(a){case"OSUpgrade":c=function(e,t,n){const r=e.client.deviceType
if(r!==iz)return null
const o=pr(r)
if((0,mm.isNothing)(o))return null
const i=new HJ(o)
ra(e,i,{targetType:EW,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const s=e.loc.string("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),a=new X5(s,i)
wl(0,a,n)
const c=new pK("clientControlButton")
return c.items=[a],c}(e,0,o)
break
case $I:c=function(e,t,n,o){let a=po(e,n)
if(!a&&o.additionalData&&(a=wo(0,o.additionalData.get(oL))),!i(a))return null
const c={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},l=ao(0,o.metricsPageInformation,o.metricsLocationTracker,!1)
let u
l.title=e.loc.string(EU,DU)
const d=Wc(0,a.marketingItemData)
s(d)?(u=el(e,a.marketingItemData,ht(GL),c),i(u)&&(u.title=d)):(u=ao(0,o.metricsPageInformation,o.metricsLocationTracker,!1),u.title=e.loc.string(EU,DU))
const f=new e6(u,l),h=Qc(0,a.marketingItemData)
f.unsubscribedDescription=h
const p=new VJ(nz,e.bag.arcadeAppAdamId,null,AV,null,MW,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
p.titles[mG]=e.loc.string(EU,DU),f.offerDisplayProperties=p,Jh(e,f,{...c,targetType:NM,title:d,id:t.id,kind:NM,softwareType:null,displaysArcadeUpsell:!0})
{if(r(o.additionalData))return null
const t=o.additionalData.get(iL)
if(s(t)){const n={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},r=Tt(t)
f.iconArtworks=hf(e,r,n,{useCase:R3.LockupIconMedium})}}const w=new pK(NM)
return w.items=[f],w.background={type:wH,color:u6},w}(e,t,n,o)}return c}(e,t,n,a);(0,mm.isSome)(o)&&(l.push(o),a.hasFocusableElements=!0)
break}case"StoryList":{const n=function(e,t,n,r){const o=we(t,sz)
if(!o)return null
const i=j(t,cz),s=j(t,TV)
let a=null
if(e.featureFlags.isEnabled(MK))a=il(e,o,i,s,new qQ(n.metricsPageInformation,n.metricsLocationTracker))
else{const t=!0,r=t?mH:vG
a=ol(e,o,r,i,s,n,null),t&&Array.isArray(a.items)&&(a.items=a.items.filter(e=>!Bt(e)||nl(0,e.media.kind,r)))}return a}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppEventLockup":{const n=function(e,t,n){const r=pl(e,t)
return r?Qa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n):null}(e,t,a);(0,mm.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"OfferItemLockup":{const n=function(e,t,n){const r=pe(e,t,sz)
if(o(r))return null
const i=j(t,lj),s=new V0(i,hH,vW),a=new pK(OV)
return a.items=[s],[a,Qa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n)]}(e,t,a);(0,mm.isSome)(n)&&(l.push(...n),a.hasFocusableElements=!0)
break}default:e.console.log(`Unknown module: ${a.module}`)}for(const e of l){const t=null!==(c=e.presentationHints)&&void 0!==c?c:{}
e.presentationHints={...t,isArticleContext:!0}}return l})}function fl(e,t){const n=we(t,Sq)
if(1!==n.length)return null
const r=n[0]
if(!r)return null
switch(r.type){case az:case JW:return r
default:return null}}function hl(e){return e.client.deviceType===iz?lW:_q}function pl(e,t,n){return pe(e,t,sz)||null}function wl(e,t,n,o){if(!t)return
let i=n.module
n.subStyle&&(i=i+"_"+n.subStyle),r(o)&&(o={id:`${n.index}`,impressionIndex:n.index,idType:pW,impressionType:i,kind:"iosModule"}),t.impressionMetrics=new qJ(Eh(o))}function vl(e,t,n){const r=new h6
r.overlayType=gl(e,t),r.displayOptions={horizontalPlacement:Tl(e,t),textAlignment:bl(e,t),isOverDarkContent:Al(e,t)}
const a=gh(e,t),c=j(t,Gq)
if(Xe(e,t,aj)?r.badgeText=e.loc.uppercased(vh(e,a,c)):r.badgeText=c,r.titleText=ah(e,t,cz)||Qe(e,a,cz),r.overlayType===nF||r.overlayType===RD?r.descriptionText=ah(e,t,TV):r.descriptionText=ah(e,t,qV)||Qe(e,a,TV),r.callToActionText=j(t,rx),r.buttonTitle=yl(e,t),r.overlayType!==KW&&r.overlayType!==nF||(r.lockup=function(e,t,n){let r=pe(e,t,vq)
const i=we(t,Sq)
if(o(r)&&s(i)&&(r=i[0]),o(r))return null
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t)},artworkUseCase:n.lockupArtworkUseCase,offerStyle:wV,offerEnvironment:MW,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,shouldHideArcadeHeader:e.featureFlags.isEnabled(bK),isContainedInPreorderExclusiveShelf:n.isContainedInPreorderExclusiveShelf},c=Nd(e,r,a),l=gh(e,t),u=ah(e,t,qV)||Qe(e,l,TV)
return(null==u?void 0:u.length)>0&&(c.subtitle=u),c}(e,t,n)),(null==c?void 0:c.length)>0&&i(r.lockup)&&(r.lockup.heading=c),r.collectionIcons=function(e,t){const n=we(t,Sq)
if(o(n))return null
const r=[]
for(const t of n){const n=wf(e,t,{useCase:R3.LockupIconSmall,withJoeColorPlaceholder:!0})
s(n)&&r.push(n)}return s(r)?r:null}(e,t),s(r.lockup))r.clickAction=r.lockup.clickAction,r.impressionMetrics=r.lockup.impressionMetrics
else{const o={targetType:KW,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t)},i=ml(e,t),s=Yc(e,t)
s.title=i,ra(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),targetType:KW,id:t.id}),r.clickAction=s,Jh(e,r,ep(e,t,i,o))}return r}function gl(e,t){const n=H(t,hT),r=j(t,Dq),a=we(t,Sq),c=ah(e,t,TV),l=function(e){return lr(e,e.bag.hero3RolloutRate)}(e)&&(null==c?void 0:c.length)>0
let u=pe(e,t,vq)
return o(u)&&s(a)&&(u=a[0]),i(u)&&"App"===r?l?nF:KW:s(a)&&"Collection"===r?l?RD:_D:n?rF:WH}function ml(e,t){const n=gl(e,t),r=pe(e,t,vq)
switch(n){case KW:case nF:return j(r,cz)
case rF:case WH:case _D:case RD:return ah(e,t,cz)||Qe(e,r,cz)
default:return null}}function yl(e,t){if("tv"!==e.client.deviceType)return null
switch(gl(e,t)){case KW:return e.loc.string(qb)
case rF:case WH:let t=e.loc.string(TD)
return t===TD&&(t=e.loc.string(qb)),t
case _D:return e.loc.string("HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_COLLECTION")
default:return null}}function Al(e,t){const n=Bc(e,t),r=Nc(e,t),o=n.backgroundColor||r.backgroundColor
return!o||be(o,50)}function Tl(e,t){if(e.client.isPhone)return CW
const n=j(t,AE)
if(!s(n))return QW
switch(n.toLowerCase()){case TE:return QW
case CW:return CW
case bE:return MV
default:return QW}}function bl(e,t){return Tl(e,t),QW}function Sl(e,t,n){ym.catchingContext("parseGrouping",()=>{for(const r of t.data){const o=q(r,xV)
if(Yi(o)){const e=f(r,"id")
n.chartSet=Pl(e,t.editorialChartSets)}else n.chartSet=null
const s=Zi(e,r,n),a=s.shelfToken,c=s.metricsOptions
let l
for(const t of L6)if(t.supports(e,r,o)){l=ym.catchingContext("parseGroupingShelf",()=>t.createShelf(e,r,n,a,c))
break}i(l)&&(n.shelves.push(l),un(e,n.shelves,dH,c.id,n.metricsPageInformation))}})}function Pl(e,t){for(const n of t){if(n.id===e)return n
for(const t of n.editorialCharts)if(t.id===e)return n}return null}function Cl(e,t){const n=[],r=[]
return function t(o){const s=q(o,xV)
ym.catchingContext(`flattenGroupingTree.addMediaApiDataToGroupingData: ${s}`,()=>{const a=pe(e,o,Hj)
if(i(a))t(a)
else if(function(e){return z1.has(e)}(s)){const e=we(o,QH)
for(const n of e)t(n)}else if(s===b1){const e=q(c=o,xV)!==b1?null:{id:f(c,"id"),name:j(c,cz),editorialCharts:we(c,QH).map(e=>function(e){return Yi(q(e,xV))?{id:f(e,"id"),href:j(e,bj),name:j(e,cz),type:j(e,sW)}:null}(e)).filter(e=>(0,mm.isSome)(e))};(0,mm.isSome)(e)&&r.push(e)
const n=we(o,QH)
for(const e of n)t(e)}else n.push(o)
var c})}(t),{data:n,editorialChartSets:r,originalGroupingData:t}}function Il(e,t,n){var r,o,i,s,a,c
if(e.user&&e.user.isManagedAppleID)return null
{const t=[],n=e.loc.string("FOOTER_REDEEM",eE),l=ec(e,e.bag.redeemUrl),u=new D6(n,l)
if(u.id=RN,t.push(u),e.bag.isMonetaryGiftingEnabled){const n=e.loc.string("FOOTER_SEND_GIFT",BA),r=ec(e,LN),o=new D6(n,r)
o.id=LN,t.push(o)}const d=e.bag.accountTopUpURL
if((0,mm.isSome)(d)){const n=null!==(r=e.bag.accountTopUpTitle)&&void 0!==r?r:e.loc.string("FOOTER_ADD_MONEY"),o=ec(e,d),i=new D6(n,o)
i.id="topUp",t.push(i)}let f
{f=new pK("titledButtonStack")
const n=new R6(t)
n.compactLineBreaks=n.buttons.map((e,t)=>t),f.items=[n]
const r=e.loc.string(Gb),l=e.loc.string(jb)
f.accessibilityMetadata={label:null!==(s=null!==(o=f.title)&&void 0!==o?o:null===(i=f.header)||void 0===i?void 0:i.title)&&void 0!==s?s:r,roleDescription:l.replace("%d",`${null!==(c=null===(a=n.buttons)||void 0===a?void 0:a.length)&&void 0!==c?c:0}`)}}return f}}function kl(e,t,n=!0){const r=new HJ(t),o=e.loc.string(ID),i=new m5(o)
i.clickAction=r,i.presentationStyle=[zM,YM],n&&i.presentationStyle.push(JM)
const s=new pK("footnote")
if(s.items=[i],e.bag.emailSupportLinkURL){const t=new HJ(e.bag.emailSupportLinkURL),r=new m5("Email Support")
r.clickAction=t,r.presentationStyle=[zM,YM],n&&r.presentationStyle.push(JM),s.items.push(r)}return s}function Ol(e,t,n,r){const o=new pK("unifiedMessage")
return o.id=t,o.items=[new _6(t,n,r)],o.isHidden=!0,o}function El(e,t,n,r,o,a,c){var u
const d=l(t,Jq),f=[]
for(const t of d){const l=y(t)
if(s(l)){const t=Dl(e,l,n,r,o,a,c)
i(t)&&f.push(t)}}if(0===f.length){const t=function(e,t,n,r,o){const i=HR,s=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),a=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),c=kt(e,QF),l=Rl(e,t,i,n,r,o)
return new M6(i,s,a,c,n,[],[],l)}(e,n,r,a,c)
f.push(t)}for(const t of f)Jh(e,t,{id:null,kind:null,softwareType:null,title:null!==(u=t.title)&&void 0!==u?u:"",pageInformation:a,locationTracker:c,targetType:YR}),Vh(c)
return f}function Dl(e,t,n,r,a,c,u){const d=f(t,rN),h=f(t,ZF),p=f(t,SW)
if((0,Am.isNothing)(d)||o(d)||(0,Am.isNothing)(h)||o(h)||(0,Am.isNothing)(p)||o(p))return null
const w=Fl(e,t,function(e,t){switch(t){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash"
case"DATA_USED_TO_TRACK_YOU":return"systemimage://person.fill.viewfinder"
case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle"
case"DATA_LINKED_TO_YOU":return KP
default:return null}}(0,d)),v=a?_l(e,t,r):[],g=function(e,t,n){const r=l(t,"purposes"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Ml(e,r,n)
i(t)&&o.push(t)}}return o}(e,t,r),m=Rl(e,n,d,r,c,u)
return new M6(d,h,p,w,r,g,v,m)}function Rl(e,t,n,r,o,i){let s=null
return r!==YH&&r!==tN||(s=Gl(e,t,$l(e)&&r===YH?tN:iV,o,i,n)),s}function _l(e,t,n){const r=l(t,"dataCategories"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Ll(e,r,n===YH?YH:iV)
i(t)&&o.push(t)}}return o}function Ll(e,t,n){const i=f(t,rN),s=f(t,"dataCategory")
if((0,Am.isNothing)(i)||o(i)||(0,Am.isNothing)(s)||o(s))return null
const a=Fl(e,t,function(e,t){switch(t){case"FINANCIAL_INFO":return"systemimage://creditcard.fill"
case"CONTACT_INFO":return"systemimage://info.circle.fill"
case"OTHER":return"systemimage://ellipsis.circle.fill"
case"SENSITIVE_INFO":return"systemimage://eye.fill"
case JP:return"systemimage://chart.bar.fill"
case"CONTACTS":return KP
case"PURCHASES":return"systemimage://bag.fill"
case"LOCATION":return"systemimage://location.fill"
case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill"
case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill"
case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill"
case"BROWSING_HISTORY":return"systemimage://clock.fill"
case"DIAGNOSTICS":return"systemimage://gearshape.fill"
case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill"
case"BODY":return"systemimage://figure"
case"SURROUNDING":return"systemimage://arkit"
default:return null}}(0,i))
if(r(a))return null
let c=[]
n===iV&&(c=l(t,"dataTypes"))
const u=new F6(i,s,a,n,c)
return i===JP&&(u.prefersSmallArtwork=!0),u}function Ml(e,t,n){const r=f(t,rN),i=f(t,"purpose"),s=_l(e,t,n)
return(0,Am.isNothing)(r)||o(r)||(0,Am.isNothing)(i)||o(i)||0===s.length?null:new $6(r,i,s)}function Fl(e,t,n){let o
if((0,Am.isSome)(n)&&(null==n?void 0:n.length)>0&&(o=kt(e,n)),r(o)){const n=p(t,XW)
i(n)&&(o=df(e,n,{useCase:R3.Default,allowingTransparency:!0}))}return o}function $l(e){return e.client.deviceType===oz}function xl(e,t,n,a,c,l){return ym.context("createPrivacyHeaderFromData",()=>{const u=function(e,t,n,r,a,c){let l,u=hH
const d=pe(e,t,Eq),h=s(d)&&YZ.indexOf(d.id)>-1
l=n&&!h?e.loc.string("PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_HEADER_TEMPLATE")
const p=Ul(e,t,r,iV,a,c),w=1===p.length&&p[0].identifier===HR||0===p.length
w&&(l=e.loc.string("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"))
const v=j(t,eq)
i(v)?l=l.replace(nN,K$+v+Z$):(l=w?e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE"):n?e.loc.string("PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),u=FH)
const g=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK")
l=l.replace("{privacyPolicyLink}",g)
const m=function(e,t,n,r){let i
{const n=Qe(e,t,YN)
if((0,Am.isNothing)(n)||o(n))return null
i=new HJ(n,!1)}return i.title=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),ra(e,i,{targetType:EW,id:qP,pageInformation:n,locationTracker:r}),i}(e,t,a,c),y={}
if(i(m)&&(y[g]=m),n){const n=function(e,t,n,r){const i=f(B(t,px),"managePrivacyChoicesUrl")
if((0,Am.isNothing)(i)||o(i))return null
const s=new HJ(i,!1)
return ra(e,s,{targetType:EW,id:"managePrivacyChoices",pageInformation:n,locationTracker:r}),s}(e,t,a,c)
if(i(n)){const t=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK")
l+=HP,l+=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",t),n.title=t,y[t]=n}}const A=new f2(l,u)
return new h2(A,y)}(e,t,n,a,c,l),d=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(WP),a=e.loc.string("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",s),c=Bl(e,o,i)
if(r(c))return null
c.title=s
const l={}
l[s]=c
const u=new f2(a,FH)
return new h2(u,l)}(e,0,n,c,l)
let h,p
n&&(h=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(qR),a=Nl(e,o,i)
let c
const l={}
r(a)?c=e.loc.string(WR):(c=e.loc.string(VP).replace(yV,s),a.title=s,l[s]=a)
const u=new f2(c,FH)
return new h2(u,l)}(e,0,n,c,l),s(h)&&(p=Nl(e,c,l)))
const w=[]
if(i(d)){const e=new x6(d,void 0)
w.push(e)}if(i(h)){const e=new x6(h,p)
w.push(e)}return new N6(u,n,[],[],w,void 0)})}function Nl(e,t,n){const r=e.bag.appPrivacyLearnMoreEditorialItemId
if((0,Am.isNothing)(r)||0===r.length)return null
const o=new _J(vW)
return o.title=e.loc.string(qR),o.pageUrl=`https://apps.apple.com/story/id${r}`,ra(e,o,{targetType:lz,id:"privacyLearnMore",pageInformation:t,locationTracker:n}),o}function Bl(e,t,n){const r=e.bag.appPrivacyDefinitionsEditorialItemId
if((0,Am.isNothing)(r)||0===r.length)return null
const o=new _J(vW)
return o.title=e.loc.string(WP),o.pageUrl=`https://apps.apple.com/story/id${r}`,ra(e,o,{targetType:lz,id:zP,pageInformation:t,locationTracker:n}),o}function Ul(e,t,n,r,o,i){var a
let c=[]
const l=B(t,n?px:ux)
return s(l)&&(c=null!==(a=El(e,l,t,r,e.client.deviceType!==oz||r===tN,o,i))&&void 0!==a?a:[],1===c.length&&0===c[0].categories.length&&(c[0].style=YH)),c}function Gl(e,t,n,o,a,c){if(r(t.id))return null
const l=e.featureFlags.isEnabled(VK)||e.featureFlags.isEnabled(jK)?fz:zR,u=new _J(l)
u.title=e.loc.string(YP),u.pageData=function(e,t,n,r,o){const i=[]
if(e.client.deviceType!==oz||n!==iV){const n=new pK(tW),s=xl(e,t,!0,!1,r,o)
n.items=[s],n.presentationHints={isFirstShelf:!0},i.push(n)}const s=new gK(i)
if(e.client.deviceType!==oz||n===iV){s.isIncomplete=!0
for(const e of i)e.presentationHints={...e.presentationHints,isSeeAllContext:!0}}return s.title=e.loc.string(KF),s}(e,t,n,o,a)
const d=t.type===JW?_z.productBundle:_z.product
let f
s(c)&&(f={privacyTypeId:c})
const h=oY.fromComponents(Cz,null,`/${_z.privacyDetail}/${d}/${t.id}`,f)
u.pageUrl=h.build()
const p={targetType:lz,id:"seeDetails",pageInformation:o,locationTracker:a}
return i(c)&&(p.targetType=YR,p.id=c),ra(e,u,p),u}function jl(e,t,n){if(!s(t))return
let r=null
r=(0,Am.isNothing)(n)?"sr":n
const i=df(e,t,{cropCode:r,useCase:R3.ProductPageBadge,allowingTransparency:!0})
return o(i)?void 0:i}function Vl(e,t,n,r){let o=0
for(const i of t){const t=n[i.key]
if(t){let n
if(dd(e))n=new dK(t.shelfId,null,null,void 0,t.index,!0)
else if((0,Am.isSome)(t.section)){const e=new fK(t.section,!0)
e.index=t.index,n=e}i.clickAction=n}let s
switch(i.key){case TG:case Iq:case sV:case iN:case FU:case sN:case FV:case n_:s=aN
break
default:s=dz}i.clickAction&&ra(e,i.clickAction,{targetType:KU,id:i.key,idType:pW,actionType:s,actionDetails:{position:o},pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o+=1}}function Hl(e,t,n){return new D4(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,{type:"canPerformAppAction",appAction:e,appCapabilities:t})}function ql(e,t,n,r,o,i,s){return ym.context("createHeaderShelf",()=>{const a=new pK(CC)
a.presentationHints={isSeeAllContext:r}
const c=e.loc.string("ProductPage.Accessibility.Shelf.Title")
if(!r){a.title=c
const o=Yl(t,n,r)
if((0,mm.isSome)(o)&&Ei(o)){const r=Jl(e,t,n,lz,i,s)
a.seeAllAction=r}}const l=function(e,t,n,r,o,i){const s=Yl(t,n,r),a=function(e,t,n){const r=e.bag.accessibilityLearnMoreEditorialItemId
if((0,mm.isNothing)(r))return null
const o=new _J(vW)
return o.title=e.loc.string(aB),o.pageUrl=`https://apps.apple.com/story/id${r}`,e.clientCapabilities.isEnabled(h_)&&ra(e,o,{id:JU,targetType:lz,pageInformation:t,locationTracker:n}),o}(e,o,i),c=(0,bm.attributeAsString)(t,eq),l=(0,mm.isSome)(c)&&Ei(c)
let u
u=function(e,t,n,r){if(e)return(0,mm.isSome)(n)&&r?"AccessibilityDetails.Header":r?OC:(0,mm.isSome)(n)?"AccessibilityDetails.Header.NoDeveloperName":EC
{const e=(0,mm.isSome)(t)
return e&&Ei(t)?(0,mm.isSome)(n)?"ProductPage.Accessibility.Header.SupportedFeatures":"ProductPage.Accessibility.Header.SupportedFeatures.NoLearnMoreLink":e?(0,mm.isSome)(n)?"ProductPage.Accessibility.Header.NoSupportedFeatures":DC:(0,mm.isSome)(n)?"ProductPage.Accessibility.Header.NoReportedFeatures":RC}}(r,s,a,l)
let d=e.loc.string(u),f=FH
const h={}
if((0,mm.isSome)(a)){const t=e.loc.string(aB)
d=d.replace(yV,t),h[t]=a}l&&(d=d.replace(nN,`<b>${c}</b>`),f=hH)
const p=new f2(d,f)
return new h2(p,h)}(e,t,n,r,i,s),u=new G6(l,[])
return(0,mm.isSome)(o)&&!r&&(o.addImpressionsToShelf(e,a,"accessibilityOverview"),Vh(o.locationTracker)),a.items=[u],a})}function Wl(e,t,n,r,o=null,i,s){return ym.context("createFeaturesShelf",()=>{const a=function(e,t,n,r){const o=Yl(t,n,r)
return(0,mm.isNothing)(o)?[]:o.reduce((t,n)=>{const r=f(n,rN),o=f(n,FW),i=f(n,SW)
if((0,mm.isNothing)(r)||0===r.length||(0,mm.isNothing)(o)||0===o.length)return t
const s=function(e){switch(e){case"VOICEOVER":return"voiceover"
case kC:return"voice.control"
case"LARGER_TEXT":return"textformat.size"
case"SUFFICIENT_CONTRAST":return"circle.lefthalf.filled.inverse"
case"DARK_INTERFACE":return"appearance.darkmode"
case"DIFFERENTIATE_WITHOUT_COLOR_ALONE":return"xmark.triangle.circle.square.fill"
case"REDUCED_MOTION":return"circle.dotted.and.circle"
case"CAPTIONS":return"captions.bubble.fill"
case"AUDIO_DESCRIPTIONS":return"quote.bubble.fill"
default:return null}}(r)
if((0,mm.isNothing)(s))return t
const a=kt(e,`systemimage://${s}`)
return a.imageScale=function(e){return e===kC?Bq:null}(r),t.push(new V6(o,null!=i?i:null,a)),t},[])}(e,t,n,r)
if(Oi(a))return null
const c=new pK(Lq)
c.presentationHints={isSeeAllContext:r}
const l=e.loc.string("ProductPage.Accessibility.Card.SupportedFeaturesTitle"),u=new j6(l,kt(e,"systemimage://accessibility"),a)
return r||((0,mm.isSome)(o)&&(o.addImpressionsToShelf(e,c,"supportedFeaturesCard",void 0,void 0,null,l),Vh(o.locationTracker)),u.clickAction=Jl(e,t,n,AH,i,s)),c.items=[u],c})}function zl(e,t,n,r,o){return ym.context("createDeveloperLinkShelf",()=>{const i=function(e,t,n,r,o){const i=function(e,t,n,r,o){const i=function(e,t){const n=t?fU:dx
return(0,bm.attributeAsString)(e,`${n}.developerUrl`)}(t,n)
if((0,mm.isNothing)(i)||Oi(i))return null
const s=new HJ(i,!1)
return s.title=e.loc.string("Accessibility.DeveloperUrlLinkActionTitle"),e.clientCapabilities.isEnabled(h_)&&ra(e,s,{id:"AccessibilitySite",targetType:EW,pageInformation:r,locationTracker:o}),s}(e,t,n,r,o)
if((0,mm.isNothing)(i))return null
const s=e.loc.string("Accessibility.DeveloperUrlLinkTitle"),a=e.loc.string("Accessibility.DeveloperUrlText").replace("{accessibilitySite}",s),c={}
c[s]=i
const l=new f2(a,FH)
return new h2(l,c)}(e,t,n,r,o)
if((0,mm.isNothing)(i))return null
const s=new pK(CC)
return s.items=[new G6(i,[])],s.presentationHints={isSeeAllContext:n},s})}function Yl(e,t,n){return U(e,`${n?fU:dx}.${t}.supportedCategories`)}function Jl(e,t,n,r,o,i){const s=e.featureFlags.isEnabled(jK)?fz:fU,a=new _J(s)
a.title=e.loc.string(YP),a.pageData=function(e,t,n,r,o){const i=[],s=ql(e,t,n,!0,null,r,o)
i.push(s)
const a=zl(e,t,!0,r,o);(0,mm.isSome)(a)&&i.push(a)
const c=new gK(i)
return c.title=e.loc.string(p_),c.isIncomplete=!0,c.presentationOptions=[Qj,c$,IC],c}(e,t,n,o,i)
const c=t.type===JW?_z.productBundle:_z.product,l=bm.URL.fromComponents(Cz,null,`/${_z.accessibilityDetails}/${c}/${t.id}`,{deviceFamily:n})
return a.pageUrl=l.build(),e.clientCapabilities.isEnabled(h_)&&ra(e,a,{id:"AccessibilityDetails",targetType:r,pageInformation:o,locationTracker:i}),a}function Kl(e,t,n,r,o,i){if(r)return null
const s=xd(e,t)
if((0,mm.isNothing)(s))return null
const a=new H6(s),c=o?"":e.loc.string("InfoList.Category.Title")
return new q6(c,[a],void 0)}function Zl(e,t,n,a,c,l){const u=B(t,ME)
let d=[],f=function(e,t){let n
if(rf(e,t)){const r=Mf(0,t,e.appleSilicon.isSupportEnabled),o=!1,i=kf(e,t),s=Gf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),a=function(e,t,n,r,o,i=!0){return!!xf(0,n,r,o).some(e=>Nf(t,e))}(0,i,e.client.deviceType,r,o,s),c=e.loc.deviceDisplayName(e)
a&&c&&(n=e.loc.string("InfoList.Requirements.Summary").replace("{deviceName}",c))}return n}(e,t)
const h=Xe(e,t,QT,nt(e))
if(s(u)){const t=function(e){const t=[OW,IW,ZN,iz,zH,Vj,oz],n=function(e,t,n){let r=null
switch(t){case ZW:r=OW
break
case HW:r=IW
break
case iz:r=iz
break
case"tv":r=Vj
break
case oz:r=oz
break
case zW:r=zH}return i(n)&&n===ZN&&(r=ZN),r}(0,e.client.deviceType,e.host.deviceModel)
if(i(n)){const e=t.indexOf(n)
e>0&&(t.splice(e,1),t.unshift(n))}return t}(e)
for(const n of t){const t=p(u,n)
if(s(t)){const r=Ql(0,t,e.appleSilicon.isSupportEnabled&&n===iz&&h&&!e.appleSilicon.isRosettaAvailable)
i(r)&&d.push(r)}}!i(f)&&d.length>0&&(f=d[0].text)}else{const n=function(e,t){const n=Qe(e,t,"requirementsString")
return r(n)?null:new H6(n)}(e,t)
i(n)&&(d=[n])}if(o(d))return null
const w=c?"":e.loc.string("Requirements"),v=new q6(w,d,f)
return 0===v.items_V3.length&&(v.items_V3=Fu(0,v)),v}function Ql(e,t,n){var r
const o=null!==(r=f(t,JC))&&void 0!==r?r:void 0
let i=f(t,"requirementString")
const a=l(t,"devices")
if(n){const e=f(t,"rosettaUnavailableRequirementString")
s(e)&&(i=e)}if((0,mm.isNothing)(i))return null
const c=[]
for(const e of a)c.push("\u2022\t\u2068"+e+"\u2069")
const u=c.length>0?c.join("\n"):void 0
return new H6(i,{heading:o,listText:u})}function Xl(e,t){const n=B(t,"contentRatingsBySystem.appsKorea")
if((0,mm.isNothing)(n))return null
const r=h(n,GU)
if((0,mm.isNothing)(r))return null
const o=l(n,nI)[0]
if((0,mm.isNothing)(o))return null
const i=Xf(0,r),s=[]
return(0,mm.isSome)(i)&&s.push(kt(e,`resource://${i}`)),new H6(o,{headingArtworks:s})}function eu(e,t,n,o,s,a){var c
return null!==(c=function(e,t,n,r,o,i){const s=sr(0,t)
if((0,mm.isNothing)(s))return null
const a=e.loc.string(KC),c=tu(e,a)
let u,d
u=e.loc.string(P_),d=s
const p=new q6(u,[],d,c),w=cr(e,t)
if((0,mm.isSome)(w)){const t=kt(e,Ot(w),30,30)
p.items_V3.push({$kind:XW,artwork:t})}else p.items_V3.push({$kind:"textEncapsulation",text:s})
let v=""
const g=se(t,tt(e,t),ZC),m=h(g,QC),y=h(g,XC);(0,mm.isSome)(m)&&(0,mm.isSome)(y)&&(v+=e.loc.string("InfoList.AgeRating.AgeRange").replace(eI,e.loc.decimal(m)).replace(tI,e.loc.decimal(y)))
const A=function(e,t){return j(t,"ageRating.description")}(0,t);(0,mm.isSome)(A)&&(v.length>0&&(v+="\n"),v+=A)
const T={};(0,mm.isSome)(c)&&(T[a]=c,v.length>0&&(v+="\n"),v+=a)
const b=new h2(new f2(v,t$),T)
p.items_V3.push({$kind:ZV,linkableText:b})
const S=function(e,t){const n=G(t,FT)
let r=""
for(const e of n){const t=f(e,"level"),n=l(e,"contentDescriptors")
if(0!==n.length){r.length>0&&(r+="\n\n"),r+=`**${t}**`
for(const e of n){const t=f(e,SW);(0,mm.isSome)(t)&&(r+="\n",r+=t)}}}if(0===r.length)return
const o=new h2(new f2(r,t$))
return{$kind:ZV,linkableText:o}}(0,t);(0,mm.isSome)(S)&&(p.items_V3.push({$kind:UU}),p.items_V3.push(S))
const P=function(e,t){return j(t,"ageRating.ageGuidanceUrl")}(0,t)
if((0,mm.isSome)(P)){const t=new HJ(P)
t.title=e.loc.string("InfoList.AgeRating.DeveloperInfo"),p.items_V3.push({$kind:UU}),p.items_V3.push({$kind:lz,action:t})}return p}(e,t))&&void 0!==c?c:function(e,t,n,o,s,a){const c=B(t,"contentRatingsBySystem.appsApple")
if(r(c))return null
const u=f(c,cz)
if(r(u))return null
if(99===h(c,GU))return null
const d=l(c,nI)
let p
const w=se(t,tt(e,t),ZC),v=h(w,QC),g=h(w,XC)
p=i(v)&&i(g)?e.loc.string("InfoList.AgeRating.Summary").replace("{ageRating}",u).replace(eI,e.loc.decimal(v)).replace(tI,e.loc.decimal(g)):u
const m=[]
let y,A="";(0,mm.isSome)(p)&&(A+=p)
for(const e of d)A+="\n",A+=e
m.push(new H6(A))
{const n=Xl(e,t);(0,mm.isSome)(n)&&m.push(n)
const r=nu(e,t);(0,mm.isSome)(r)&&m.push(r)}(m.length>1||m[0].text!==p)&&(y=p)
const T=s?"":e.loc.string(P_),b=e.loc.string(KC),S=tu(e,b)
return new q6(T,m,y,S)}(e,t,0,0,s)}function tu(e,t){let n
if((0,mm.isSome)(e.bag.ageRatingLearnMoreEditorialItemId)&&e.bag.ageRatingLearnMoreEditorialItemId.length>0){const r=new _J(vW)
r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.ageRatingLearnMoreEditorialItemId}`
const o=ki({...$i(e),id:e.bag.ageRatingLearnMoreEditorialItemId})
r.destination=o,n=r}return n}function nu(e,t){if(e.bag.requireAgeVerification&&function(e,t,n){const r=q(t,"contentRatingsBySystem.appsApple.rank")
if((0,mm.isNothing)(r))return!1
let o
switch(n){case iI:o=3
break
case rI:o=4
break
case"adultOnly":o=5
break
default:o=1}return r>=o}(0,t,rI)&&function(e,t){var n
const r=null!==(n=we(t,SB))&&void 0!==n?n:[]
for(const e of r)if(f(e,"id")===zZ.Games.toString())return!0
return!1}(0,t)){let n
if(t.type===JW){const r=fe(t,az)
if(i(r))for(const t of r.data)if(i(j(t,oI))){n=e.loc.string("AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles")
break}}else i(j(t,oI))&&(n=e.loc.string("AgeVerification.ProductPage.Rating.UnsuitableForJuveniles"))
return(0,mm.isNothing)(n)?null:new H6(n)}return null}function ru(e,t,n,r,o,i){const s=lr(e,e.bag.gameControllerRecommendedRolloutRate),a=dr(e,t)
if(s&&a){const n=o?"":e.loc.string("ProductPage.Info.GameController.Title")
let r
r=a?"ProductPage.Info.GameController.Recommended":"ProductPage.Info.GameController.Required"
const i=e.loc.string(r),s=j(t,eq),c=a?"ProductPage.Info.GameController.Recommended.Summary.v2":"ProductPage.Info.GameController.Required.Summary.v2",l=e.loc.string(c).replace(nN,s),u=[new H6(l)]
let d
const f=e.bag.gameControllerLearnMoreEditorialItemId
if((0,mm.isSome)(f)&&f.length>0){const t=new _J(vW),n=a?"ProductPage.Info.GameController.Recommended.LearnMore":"ProductPage.Info.GameController.Required.LearnMore"
t.title=e.loc.string(n),t.pageUrl=`https://apps.apple.com/story/id${f}`,d=t}return new q6(n,u,i,d)}return null}function ou(e,t,n,r,o,i){const s=Qe(e,t,"copyright")
if((0,mm.isNothing)(s))return null
const a=new H6(s),c=o?"":e.loc.string("InfoList.Copyright")
return new q6(c,[a])}function iu(e,t,n,r,i,s){var a
if(!function(e,t){var n
const r=Ff(e,t),o=new Set(["uses-non-webkit-browser-engine","is-custom-browser-engine-app"])
return null!==(n=null==r?void 0:r.some(e=>o.has(e)))&&void 0!==n&&n}(e,t))return null
const c=null!==(a=function(e,t,n){const r=e.bag.externalBrowserLearnMoreEditorialItemId
if(o(r))return null
const i=new _J(vW)
return i.title=e.loc.string(aB),i.pageUrl=`https://apps.apple.com/story/id${r}`,ra(e,i,{id:JU,targetType:EW,actionType:dz,pageInformation:t,locationTracker:n}),i}(e,s.metricsPageInformation,s.locationTracker))&&void 0!==a?a:void 0
let l=c
const u=i?"":e.loc.string("Annotations.ExternalBrowser.Title"),d=e.loc.string("Annotations.ExternalBrowser.Value.Summary"),f=e.loc.string("Annotations.ExternalBrowser.Value.Expanded"),h=[new H6(f)]
return new q6(u,h,d,l)}function su(e,t,n,r,o,i){const s=nr(e,t),a=rr(e,YC)
if(!s||!a)return null
const c=o?"":e.loc.string("Annotations.ExternalPurchases.Title"),l=e.loc.string("YES")
let u
if((0,Am.isSome)(e.bag.externalPurchasesProductPageAnnotationVariant)){const t=`Annotations.ExternalPurchases.Expanded.Variant${e.bag.externalPurchasesProductPageAnnotationVariant}`
u=e.loc.string(t)}else u=e.loc.string("Annotations.ExternalPurchases.Expanded")
const d=new H6(u),f=e.loc.string("Annotations.ExternalPurchases.Expanded.LearnMore")
let h=or(e,f,i.metricsPageInformation,i.locationTracker)
return new q6(c,[d],l,null!=h?h:void 0)}function au(e,t,n,r,o,i){const s=(0,bm.attributeAsDictionary)(t,"licenses.gameLicenseVietnam"),a=[uu(e.loc.string("InfoList.GameLicense.Disclaimer"))],c=(0,bm.asString)(s,"licenseId")
if(!(0,mm.isSome)(c)||!Ei(c))return null
a.push(cu(),lu(e.loc.string("InfoList.GameLicense.Id.Title")),uu(c))
const l=(0,bm.asString)(s,"licenseUrl");(0,mm.isSome)(l)&&Ei(l)&&a.push(cu(),lu(e.loc.string("InfoList.GameLicense.Url.Title")),function(e){const t={}
return t[e]=new HJ(e,!1),{$kind:ZV,linkableText:new h2(new f2(e),t)}}(l))
const u=o?"":e.loc.string("InfoList.GameLicense.Title"),d=new q6(u,[],c)
return d.items_V3=a,d}function cu(){return{$kind:UU}}function lu(e){return{$kind:ZV,linkableText:new h2(new f2(`**${e}**`))}}function uu(e){return{$kind:ZV,linkableText:new h2(new f2(e))}}function du(e,t,n,r,o,i){return null}function fu(e,t,n,r,s,a){var c
const l=Ze(e,t,"languageList")
if(o(l))return null
const u=l.length
if(u<1)return null
let d,f
switch(u){case 0:break
case 1:f=l[0]
break
case 2:f=e.loc.string("InfoList.Two.Languages.Summary").replace("{first}",l[0]).replace("{second}",l[1])
break
default:const t=u-1
d=e.loc.string("InfoList.More.Languages.Summary").replace("{language}",l[0]).replace(c_,e.loc.formattedCount(t)),f=null!==(c=function(e,t){if(null==e||null==t)return null
if(0===e.length)return""
let n=e.length,r=""
return e.forEach((e,o)=>{(0,mm.isNothing)(e)?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(l,e.loc.string("Conjunction.Separator")))&&void 0!==c?c:void 0}if(!i(f))return null
const h=new H6(f),p=s?"":e.loc.string("Supported.Languages")
return new q6(p,[h],d)}function hu(e,t,n,r,o,i){if(!H(t,"usesLocationBackgroundMode"))return null
const s=o?"":e.loc.string("InfoList.Location.Title"),a=e.loc.string("InfoList.Location.Description"),c=new H6(a)
return new q6(s,[c])}function pu(e,t,n,r,o,i){const s=(0,bm.attributeAsDictionary)(t,fx)
if((0,mm.isNothing)(s)||(0,mm.isNothing)(e.bag.medicalDeviceComplianceStatementRegion)||Oi(e.bag.medicalDeviceComplianceStatementRegion))return null
const a=[],c=j(t,eq)
if((0,mm.isSome)(c)&&Ei(c)){const t=`InfoList.MedicalDevice.Compliance.Statement.${e.bag.medicalDeviceComplianceStatementRegion}`,n=e.loc.string(t).replace(nN,`**${c}**`)
a.push(gu(n))}const l=e.loc.string("InfoList.MedicalDevice.Disclaimer")
wu(a),a.push(gu(l))
const u=(0,bm.asString)(s,"manufacturerSRN");(0,mm.isSome)(u)&&Ei(u)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.ManufacturerSRN.Title")),gu(u)))
const d=(0,bm.asString)(s,"fdaNumber");(0,mm.isSome)(d)&&Ei(d)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.FDANumber.Title")),gu(d)))
const f=(0,bm.asDictionary)(s,"sellerContactInfo"),h=(0,bm.asString)(f,"address");(0,mm.isSome)(h)&&Ei(h)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.Address.Title")),gu(h)))
const p=(0,bm.asString)(f,"phoneNumber");(0,mm.isSome)(p)&&Ei(p)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.PhoneNumber.Title")),gu(p)))
const w=(0,bm.asString)(f,"email");(0,mm.isSome)(w)&&Ei(w)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.Email.Title")),gu(w)))
const v=(0,bm.asString)(s,"useStatement");(0,mm.isSome)(v)&&Ei(v)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.UseStatement.Title")),gu(v)))
const g=(0,bm.asString)(s,"safetyInfo");(0,mm.isSome)(g)&&Ei(g)&&(wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.SafetyInfo.Title")),gu(g)))
const m=(0,bm.asString)(s,"instructionsForUseUrl")
if((0,mm.isSome)(m)&&Ei(m)){wu(a),a.push(vu(e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Title")))
{const t=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.Hyperlink"),n=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.FullText").replace("{externalLink}",t),r=new f2(n),o={}
o[t]=new HJ(m,!1)
const i=new h2(r,o)
a.push({$kind:ZV,linkableText:i})}}if(0===a.length)return null
const y=o?"":e.loc.string("InfoList.MedicalDevice.Title"),A=new q6(y,[],"Yes")
return A.items_V3=a,A}function wu(e){e.length>0&&e.push({$kind:UU})}function vu(e){return{$kind:ZV,linkableText:new h2(new f2(`**${e}**`))}}function gu(e){return{$kind:ZV,linkableText:new h2(new f2(e))}}function mu(e){var t
return{platform:null===(t=e.activeIntent)||void 0===t?void 0:t.previewPlatform}}function yu(e,t){var n
return(null===(n=e.activeIntent)||void 0===n?void 0:n.previewPlatform)?t.addingQuery("previewPlatform",e.activeIntent.platform).addingQuery(GH,bH):t}function Au(e,t){const n={...t,id:`id${t.id}`}
return t.platform?Y6(e,n):K6(e,n)}function Tu(e,t,n,r,o){return ym.context("capabilitiesFromData",()=>[bu(e,t,r,o),Su(e,t),Ou(e,t),Pu(e,t),Cu(e,t),Iu(e,t,n),null,ku(e,t)].filter(e=>(0,mm.isSome)(e)))}function bu(e,t,n,r){if(!(0,mm.isSome)(t)||!Xe(e,t,yU))return null
if(e.bag.gameCenterExtendSupportedFeatures){const o=function(e){var t
if(!(0,Am.isNothing)(e))return null!==(t=$(e,"supportedGameCenterFeaturesFromData",()=>{const t=[],n=l(e,"attributes.supportedGameCenterFeatures")
return n.includes(NW)&&t.push(NW),n.includes(xH)&&t.push(xH),n.includes(Nq)&&t.push(Nq),n.includes(tB)&&t.push(tB),t}))&&void 0!==t?t:void 0}(t),i=null==o?void 0:o.includes(Nq),s=null==o?void 0:o.includes(NW)
let a
a=i&&s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ALL_FEATURES"):i?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_LEADERBOARDS"):s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_ACHIEVEMENTS"):e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_NO_FEATURES")
const c=e.loc.string(Sb),u=kt(e,Pb,46,45)
{let o
o=(0,mm.isSome)(t)&&e.clientCapabilities.isEnabled("gameProductIdOpenGamesUIAction")?co({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r,target:{gamePage:{productID:t.id}}}):co({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r})
const i=e.loc.string("ProductPage.Capability.GameCenter.ActionTitle")
a=`${a}\n${i}`
const s=new f2(a),l={}
l[i]=o
const d=new h2(s,l),f=kt(e,"systemimage://arrow.up.forward.square.fill",16,16)
return new W6(kH,c,d,f,void 0,u)}}{const t=e.loc.string(Sb),n=new f2(e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION")),r=new h2(n),o=kt(e,Pb,46,45)
return new W6(kH,t,r,void 0,void 0,o)}}function Su(e,t){if(!Xe(e,t,"isSiriSupported"))return null
const n=e.loc.string("CAPABILITY_SIRI_TITLE"),r=new f2(e.loc.string("CAPABILITY_SIRI_EXPLANATION")),o=new h2(r),i=kt(e,"resource://ProductCapabilitySiri",46,45)
return new W6(lD,n,o,void 0,void 0,i)}function Pu(e,t){if(!Xe(e,t,"supportsPassbook"))return null
const n=e.loc.string("CAPABILITY_WALLET_TITLE"),r=new f2(e.loc.string("CAPABILITY_WALLET_EXPLANATION")),o=new h2(r),i=kt(e,"resource://ProductCapabilityWallet",46,45)
return new W6("wallet",n,o,void 0,void 0,i)}function Cu(e,t){if(!ur(e,t))return null
const n=e.loc.string("CAPABILITY_MFI_CONTROLLERS_TITLE")
let r
const o=e.bag.gameControllerLearnMoreEditorialItemId
if(lr(e,e.bag.gameControllerRecommendedRolloutRate)&&(0,mm.isSome)(o)&&(null==o?void 0:o.length)>0){const t=ki({...$i(e),...mu(e),id:o})
r=new _J(vW),r.title=e.loc.string("ProductPage.Capability.GameController.ActionTitle"),r.pageUrl=Au(e,t)}let i=r?e.loc.string("ProductPage.Capability.GameController.Explanation.v2.WithNewlineActionTemplate"):e.loc.string("ProductPage.Capability.GameController.Explanation.v2")
const s={};(null==r?void 0:r.title)&&(i=i.replace(yV,r.title),s[r.title]=r)
const a=new f2(i),c=new h2(a,s),l=kt(e,"resource://ProductCapabilityController",46,45)
return new W6("controllers",n,c,void 0,void 0,l)}function Iu(e,t,n){const r=j(t,"familyShareEnabledDate")
if(!r||H(t,HG))return null
const o=new Date(r),i=new Date
if(!o||o>i)return null
const s=Xe(e,t,uD),a=s&&Xe(e,t,"hasFamilyShareableInAppPurchases")
let c
const l=e.bag.familySubscriptionsLearnMoreEditorialItemId
if((0,mm.isSome)(l)&&(null==l?void 0:l.length)>0&&a){const t=ki({...$i(e),...mu(e),id:l})
c=new _J(vW),c.title=e.loc.string("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),c.pageUrl=Au(e,t)}const u=e.loc.string("CAPABILITY_FAMILY_SHARING_TITLE")
let d
if(a?d=c?"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION":s||n||(d=c?"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION"),!d)return null
let f=e.loc.string(d)
const h={};(null==c?void 0:c.title)&&(f=f.replace(yV,c.title),h[c.title]=c)
const p=new f2(f),w=new h2(p,h),v=kt(e,"resource://ProductCapabilityFamilySharing",46,45)
return new W6(oM,u,w,void 0,c,v)}function ku(e,t){if(!Xe(e,t,"hasSafariExtension"))return null
const n=e.loc.string("CAPABILITY_SAFARI_EXTENSION_TITLE"),r=new f2(e.loc.string("CAPABILITY_SAFARI_EXTENSION_EXPLANATION")),o=new h2(r),i=kt(e,"resource://ProductCapabilitySafariExtension",129,129)
return new W6(Cb,n,o,void 0,void 0,i)}function Ou(e,t){if(!Xe(e,t,hE))return null
const n=e.loc.string("CAPABILITY_SHAREPLAY_TITLE"),r=new f2(e.loc.string("CAPABILITY_SHAREPLAY_EXPLANATION")),o=new h2(r),i=kt(e,"systemimage://shareplay"),s=Se(dD)
return new W6("sharePlay",n,o,void 0,void 0,i,s)}function Eu(e,t,n,r,o,i){if(r)return null
const s=Qe(e,t,"seller"),a=Ke(e,t,dU),c=Ke(e,t,BE),l=e.bag.enableSellerICPAnnotation&&!0
if((0,mm.isNothing)(s))return null
const u=Qe(e,t,"sellerLabel")||e.loc.string(sI)
let d,h=[]
const p=f(a,cz),w=(0,mm.isSome)(p)&&(null==p?void 0:p.length)>0?p:s,v=o?"":u
let m=null
if((0,mm.isSome)(a)){const[t,n]=function(e,t){const n=[],r={name:"ProductPage.SellerInfo.Name.Title",dunsNumber:"ProductPage.SellerInfo.DunsNumber.Title",address:"ProductPage.SellerInfo.Address.Title",brn:"ProductPage.SellerInfo.BusinessRegistrationNumber.Title",phoneNumber:"ProductPage.SellerInfo.PhoneNumber.Title",email:"ProductPage.SellerInfo.Email.Title",usci:"ProductPage.SellerInfo.UnifiedSocialCreditIdentifier.Title"},o=f(t,cz),i=(0,mm.isSome)(o)&&(null==o?void 0:o.length)>0?o:e.loc.string(sI),s=(0,mm.isSome)(f(t,aI))
if(s){const r=g(t,aI),o=r?"ProductPage.SellerInfo.VerifiedSeller.Subtitle":"ProductPage.SellerInfo.UnverifiedSeller.Subtitle"
if(n.push(new H6(e.loc.string(o).replace("{seller}",i))),!r)return[n,i]}let a=null
1!==Object.keys(t).length||Object.keys(t).includes(cz)||(a=e.loc.string("ProductPage.SellerInfo.SeeDetails.Title"))
for(const[o,i]of Object.entries(r)){if(o===cz&&s)continue
const r=Du(e,o,e.loc.string(i),t);(0,mm.isSome)(r)&&n.push(r)}return[n,a]}(e,a)
m=n,h=h.concat(t)}if(l&&(0,mm.isSome)(c)){const t=Du(e,"filingNumber",e.loc.string("ProductPage.Info.ICPNumber.Title"),c)
if(0===h.length){const e=new H6(w)
h.push(e)}(0,mm.isSome)(t)&&h.push(t)}if(h.length>0)(0,mm.isNothing)(m)&&(m=h.length>1?w:void 0),d=new q6(v,h,m,void 0)
else{const e=new H6(s)
d=new q6(v,[e])}return(0,mm.isSome)(d),d}function Du(e,t,n,r){let o=f(r,t)
return(0,mm.isSome)(o)?("brn"===t&&(o=o+"\n"+e.loc.string("ProductPage.SellerInfo.BusinessRegistrationNumber.Subtitle")),new H6(o,{heading:n})):null}function Ru(e,t,n,o,s,a){const c=Hf(e,t)
if(n||r(c)||r(c.fileSizeByDevice))return null
const l=e.loc.fileSize(c.fileSizeByDevice),u=s?"":e.loc.string("File.Size")
let d,f=c.fileSizeByDevice
if(i(c.maxEssentialInstallSizeInBytes)){const t=c.fileSizeByDevice+c.maxEssentialInstallSizeInBytes,n=e.loc.string(C_).replace(I_,e.loc.fileSize(t)),r=new H6(n)
d=new q6(u,[r],void 0)}else if(i(c.maxInstallSizeInBytes)){const t=[],n=new H6(l,{heading:e.loc.string("Initial.App.Size")})
t.push(n)
const r=e.loc.string(C_).replace(I_,e.loc.fileSize(c.maxInstallSizeInBytes)),o=new H6(r,{heading:e.loc.string("Additional.Content.After.App.Install")})
t.push(o),f+=c.maxInstallSizeInBytes
const i=e.loc.string(C_).replace(I_,e.loc.fileSize(f))
d=new q6(u,t,i)}else{const e=new H6(l)
d=new q6(u,[e],void 0)}return d}function _u(e,t,n,r,o,i){return null}function Lu(e,t,n,r,o,i){const s=ve(t,bM)
if((0,mm.isNothing)(s)||Oi(s))return null
const a=[],c=[]
for(const t of s){const n=j(t,cz)
if((0,mm.isNothing)(n))continue
const r=gr(e,t)
if((0,mm.isNothing)(r))continue
const o=f(r,zj)
if((0,mm.isNothing)(o))continue
const i=f(r,KG),s=h(r,ZG)
let l=e.loc.string("InfoList.IAP.Duration")
if((0,mm.isSome)(i)){l=l.replace("{name}",n)
const t=Jo(0,i,s)
let r
switch(null==t?void 0:t.type){case"D":r="days"
break
case"W":r="weeks"
break
case"M":r="months"
break
case"Y":r="years"
break
default:l=`${n}`}if((0,mm.isSome)(r)&&(0,mm.isSome)(t)){const n=e.loc.formatDuration(t.periodDuration,r);(0,mm.isSome)(n)&&(l=l.replace("{duration}",n))}}else l=`${n}`
a.push([l,o]),c.push({$kind:zC,leadingText:l,trailingText:o})}const l=e.loc.string("ProductPage.Info.InAppPurchases.LearnMore"),u=function(e,t){const n=e.bag.inAppPurchasesLearnMoreEditorialItemId
if((0,mm.isNothing)(n)||Oi(n))return null
const r=new _J(vW)
return r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.inAppPurchasesLearnMoreEditorialItemId}`,r}(e,l)
if((0,mm.isSome)(u)){c.push({$kind:UU,size:Bq})
const e={}
e[l]=u,c.push({$kind:ZV,linkableText:new h2(new f2(l),e)})}const d=o?"":e.loc.string("InfoList.InAppPurchases"),p=[new H6(void 0,{textPairs:a})],w=new q6(d,p,e.loc.string("YES"))
return w.items_V3=c,w}function Mu(e,t,n,r,o,i,s,a){const c=[]
for(const l of t){const t=l(e,n,r,o,i,s);(0,mm.isSome)(t)&&(0===t.items_V3.length&&(t.items_V3=Fu(0,t)),t.expandAction=void 0,c.push(t),a&&a(l,t,c.length-1))}return c}function Fu(e,t){const n=[]
for(const e of t.items){if(n.length>0&&n.push({$kind:UU}),(0,mm.isSome)(e.headingArtworks))for(const t of e.headingArtworks)n.push({$kind:XW,artwork:t})
let t=""
if((0,mm.isSome)(e.heading)&&(t+=`**${e.heading}**`),(0,mm.isSome)(e.text)&&(t.length>0&&(t+="\n"),t+=e.text),(0,mm.isSome)(e.listText)&&(t.length>0&&(t+="\n"),t+=e.listText),t.length>0&&n.push({$kind:ZV,linkableText:new h2(new f2(t,t$))}),(0,mm.isSome)(e.textPairs))for(const t of e.textPairs)n.push({$kind:zC,leadingText:t[0],trailingText:t[1]})}return(0,mm.isSome)(t.linkAction)&&n.push({$kind:lz,action:t.linkAction}),n}function $u(e,t){const n=Ke(e,t,BE),r=e.bag.enableSellerICPAnnotation&&(0,mm.isSome)(n),o=Ke(e,t,dU),i=e.bag.enableSellerInfo&&(0,mm.isSome)(o)
return r||i}function xu(e,t,n,r){const o=new pK($C)
o.isHorizontal=!0
let i=null
i=n?t.slice(0,8):t
const a=[]
for(let t=0;t<i.length;t++){const n=i[t]
if(n.action=new _0({player:{playerID:n.playerId}}),s(r)){const o="friendPlayer",i={pageInformation:r.destinationPageInformation,locationTracker:r.sourceLocationTracker,id:"",idType:pW,anonymizationOptions:{anonymizationString:`FRIEND${t+1}`}}
if(Jh(e,n,{...i,kind:o,title:"",softwareType:null}),e.bag.productPageFriendsPlayingClickEventsEnabled){const t={...i,kind:o,targetType:KW,actionType:dz,softwareType:null}
ra(e,n.action,t)}}a.push(n),s(r)&&Vh(r.sourceLocationTracker)}if(o.items=a,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=kH,n&&t.length>8){const n=new pK("smallGameCenterPlayer")
n.title=e.loc.stringWithCount("ProductPage.FriendsPlaying.SeeAllTitle",t.length),n.items=t.map(e=>(e.action=new h3(e.playerId),e)),n.rowsPerColumn=1
const i=new gK([n])
i.title=null==r?void 0:r.title
const s=new _J(fz)
s.title=e.loc.string(nq),s.pageData=i,o.seeAllAction=s}return s(r)&&(Jh(e,o,{id:"",kind:null,softwareType:null,targetType:rW,title:r.title,pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker,idType:pW,badges:{gameCenter:!0}}),o.footerTitle=e.loc.string(Dx),o.footerAction=co({objectGraph:e,target:{friends:{}},metricsPageInformation:null==r?void 0:r.sourcePageInformation,metricsLocationTracker:null==r?void 0:r.sourceLocationTracker}),o.footerStyle={$kind:qq,bundleID:TB,width:16,height:16}),o}async function Nu(e,t,n,i){return await Za("inAppPurchasesShelf",async()=>{var a
if(!function(e,t){return t!==KH&&!e.client.isCompanionVisionApp}(e,e.host.platform))return null
if(o(t))return null
let c
if(c=ui(e)?he(t,RE):fe(t,IM),(0,mm.isNothing)(c)||0===c.data.length)return null
if(0===c.data.filter(function(e){return H(e,mF)===i.isForSubscriptions}).length)return null
const l={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:rW,id:`${n.getSequenceId()}`,idType:pW},u=QN,d=new pK(u),f=V(t,uW)?GG:_q,h=Qe(e,t,hW),p=null===(a=i.options)||void 0===a?void 0:a.spotlightInAppProductIdentifier
!function(e,t,n){const o=VW
for(const e of n.data){let n=fe(e,o)
n||(n={data:[t]}),r(e.relationships)&&(e.relationships={}),e.relationships[o]=n}}(0,t,c)
const w=[],v=function(e,t,n,r,o,i){const s=Yd(e,t,{lockupOptions:{metricsOptions:r,offerStyle:n,skipDefaultClickAction:!0,artworkUseCase:R3.LockupIconSmall},contentUnavailable:function(e,t){return w.push(t),!1}})
return o&&up(0,o,s),s}(e,c.data,f,l,p).filter(function(e){return e.productIdentifier===p&&(i.options.spotlightSection=new m2(pz,i.isForSubscriptions?VV:kV)),e.isSubscription===i.isForSubscriptions})
if(0===v.length&&0===w.length)return null
if(d.items=await async function(e,t,n,r){if((0,mm.isNothing)(n))return t
const o=[],i=[]
for(const e of t){const t=e.productIdentifier
o.push(t),e.isVisibleByDefault&&i.push(t)}const s=await M(e.clientOrdering.orderedVisibleIAPs(n,o,i,r))
return s.success?function(e,t){const n={}
for(const t of e)n[t.productIdentifier]=t
const r=[]
for(const e of t){const t=n[e]
if(t){const e=S(t)
r.push(e)}}return r}(t,s.value):t}(e,v,h,p),s(w)){const e=new E9(t.id,w,d.title,!1,void 0,u,f,null)
e.appBundleId=h,e.iapShelfContext=i,i.isForSubscriptions?e.inAppShelfId=VV:e.inAppShelfId=kV,d.url=sp(0,e,n)}let g
return i.isForSubscriptions?(d.title=e.loc.string("ProductPage.Section.Subscriptions.Title","Subscriptions"),g="subscription"):(d.title=e.loc.string("ProductPage.Section.InAppPurchases.Title"),g="iAP"),xh(e,l,d.title),Bh(n.locationTracker),Vh(n.locationTracker),d.isHorizontal=!0,n.addImpressionsToShelf(e,d,g),d})}function Bu(e,t,n,r,s,a){return ym.context(oV,()=>o(t)?null:function(e,t,n,r,o){return ym.context("standardLinksShelf",()=>{const s=new pK("productPageLink"),{metricsPageInformation:a,locationTracker:c}=n,l=[]
if(e.client.deviceType!==iz){const n=Qe(e,t,TM)
if(n){const t=new HJ(n,!1),r=e.loc.string("DEVELOPER_WEBSITE")
l.push(new i3(r,t,s3))}}const u=Qe(e,t,YN)
if(u){const t=new HJ(u,!1),n=e.loc.string(l$)
l.push(new i3(n,t,a3))}if(V(t,xC)){const n=function(e,t){const n=t.id,r=t.type
return i(t)&&i(n)&&i(r)?`${Cz}:/${_z.eula}?resourceType=${r}&resourceId=${n}`:null}(0,t)
if(n){const t=new _J(fz)
t.pageUrl=n
const r=e.loc.string(lN)
l.push(new i3(r,t,c3))}}const d=f(Ke(e,t,dU),g_)
if((null==d?void 0:d.length)>0){const t=new HJ(d,!1),n=e.loc.string(u$)
l.push(new i3(n,t,d3))}const h=e.bag.productPageReportProblemSADSubscriptionArray,p=t.id,w=h.includes(p),v=it(e).isSystemAppFromData(t),g=t.type===JW,m=r&&!v,y=e.bag.productPageReportProblemSecondPartyAppArray.includes(p)
if(!g&&!y&&!o&&e.bag.reportProblemEnabled&&(w||m)){const n=function(e,t){const n=t.id,r=e.bag.productPageReportProblemURL
return i(n)&&i(r)?r.replace("{productId}",n):null}(e,t)
if((null==n?void 0:n.length)>0){const t=new HJ(n,!1),r=e.loc.string(Ub),o=new i3(r,t,u3,w?null:p)
l.push(o)}}return l&&l.length>0&&(s.items=l),n.addImpressionsToShelf(e,s,bB),s})}(e,t,n,r,a))}function Uu(e,t,n,i){const s=xd(e,t)
if(o(s))return null
const a=e.loc.string("BADGE_CATEGORY_HEADING"),c=new w3(XW,FV,{},rz,a,s,null,s,a,_q)
if(new _J(fz).title=j(t,eq),n&&"tv"!==e.client.deviceType){const n=Sn(e,t,!0)
if(r(n))return null
c.artwork=jl(e,n,"bb")}return c}function Gu(e,t,n,r){const o=Ke(e,t,r_)
if(o){const t=Kf(0,e.host.clientIdentifier)
if(t){const n=p(o,t)
if(n){const t=h(n,EF),r=f(n,vC),o=f(n,mq),i=f(n,sW),s=e.loc.string("BADGE_CHART_POSITION_HEADING"),a=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",t.toString()),c=new w3(n$,n$,{position:e.loc.decimal(t)},rz,s,r,null,a,r,lH),l=Jf(e,o,i)
if((0,Am.isSome)(l)){const t=new _J(tj)
t.pageUrl=l,t.pageData=new N4("",Pc(e,l)),c.clickAction=t}return c}}}return null}function ju(e,t,n,r){var o
return null!==(o=function(e,t,n,r){const o=sr(0,t)
if((0,mm.isNothing)(o))return null
let i
i=n?function(e,t){const n=G(t,FT)
for(const e of n)if("IAC"===f(e,Dq))return!0
return!1}(0,t)?e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon.InAppControls"):e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon"):e.loc.string("ProductPage.Badge.AgeRating.Caption")
const s=e.loc.string("ProductPage.Badge.AgeRating.Heading"),a=e.loc.string("ProductPage.Badge.AgeRating.AX.Caption"),c=cr(e,t),l=(0,mm.isSome)(c)?XW:TG,u=new w3(l,TG,{contentRating:o},rz,s,i,void 0,o,a,lH)
return(0,mm.isSome)(c)&&(u.isMonochrome=!1,u.artwork=kt(e,Ot(c),26,26)),u}(e,t,n))&&void 0!==o?o:function(e,t,n,r){const o=j(t,LT)
if((0,mm.isNothing)(o))return null
const i={contentRating:o},s=q(t,"contentRatingsBySystem.appsBrazil.rank"),a=Xf(0,null!=s?s:void 0)
let c
a&&(i.contentRatingResource=a),c=n?e.loc.string(gC):e.loc.string(mC)
const l=e.loc.string("BADGE_AGE_RATING_HEADING"),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE")
return new w3(TG,TG,i,rz,l,c,void 0,o,u,lH)}(e,t,n)}function Vu(e,t,n,r){return function(e,t,n,r){if(dr(e,t)){let t,n
t=e.loc.string(r$),n=e.loc.string("ProductPage.Badge.GameController.Recommended")
const r=new w3(qu(e),sN,{},rz,t,n,void 0,void 0,n,lH)
return r.artwork=Wu(e),r.clickAction=dd(e)?new dK(oW):new fK(new hK(pz,oW)),r}return null}(e,t)}function Hu(e,t,n,r){return function(e,t,n,r){if(!ur(e,t)||function(e,t){switch(fr(e,t)){case U$:case tM:case eM:return!0
default:return!1}}(e,t)||dr(e,t)||function(e,t){return"REQUIRED"===hr(e)}(e))return null
{let t,n
t=e.loc.string(r$),n=e.loc.string($U)
const r=new w3(qu(e),sN,{},rz,t,n,void 0,void 0,n,lH)
return r.artwork=Wu(e),r.clickAction=dd(e)?new dK(oW):new fK(new hK(pz,oW)),r}}(e,t)}function qu(e){return e.clientCapabilities.isEnabled("artworkControllerBadge")?XW:sN}function Wu(e){const t=kt(e,$B)
return t.imageScale=Bq,t}function zu(e,t,n,o){const s=pe(e,t,Eq),a=e.loc.string("BADGE_DEVELOPER_HEADING"),c=j(t,eq),l=new w3(XW,Eq,{},rz,a,c,null,c,a,_q)
if(n&&"tv"!==e.client.deviceType){const t=Sn(e,s,!0)
r(t)?l.artwork=kt(e,o$,26,26):l.artwork=jl(e,t)}const u=Yf(0,s)
if(i(u)){const n=new _J(fz)
n.title=j(t,eq),n.pageUrl=u,s&&(n.destination=function({id:e,...t}){return{...t,id:ut(e),$kind:v3}}({...$i(e),id:s.id})),ra(e,n,{targetType:Yq,id:s.id,actionType:dz,pageInformation:o.pageInformation,locationTracker:o.locationTracker}),l.clickAction=n}return l}function Yu(e,t,n,r){const o=Ke(e,t,dj)
if(o){const r=f(o,vF)
if(r&&r===gF){let r,o
r=G(t,JD)[0]===kj?e.loc.string("EDITORIAL_BADGE_GAMES"):e.loc.string("EDITORIAL_BADGE_APPS"),o=n?e.loc.string("EDITORS_CHOICE_RIBBON_HEADING"):e.loc.string("EDITORS_CHOICE_SINGLE_LINE")
const i=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),s=new w3(Iq,Iq,{},rz,o,r,null,i,r)
return dd(e)?s.clickAction=new dK(Iq):s.clickAction=new fK(new hK(pz,_W)),s}}return null}function Ju(e,t,r,o){const i=Ze(e,t,"supportedLocales"),s=function(e,t){var r
if(t.length<=0)return
const o=null===(r=f(n(t,"0.tag")))||void 0===r?void 0:r.split("-")[0].toUpperCase(),i=f(n(t,"0.name"))
return(0,Am.isSome)(o)&&(0,Am.isSome)(i)?{tag:o,name:i}:void 0}(0,i)
if(!s)return null
const a={paragraphText:s.tag}
let c
const l=i.length-1
c=l>0?e.loc.stringWithCount("ProductPage.Badge.Language.Caption",l).replace("{number_other_languages}",e.loc.formattedCount(l)):s.name
const u=e.loc.string("BADGE_LANGUAGE_HEADING")
return new w3(OV,iN,a,rz,u,c,void 0,void 0,c,lH)}function Ku(e,t,n,r){const o=(0,bm.attributeAsDictionary)(t,fx)
if(!(0,mm.isSome)(o))return null
const i=e.loc.string("ProductPage.Badge.MedicalDevice.Heading"),s=e.loc.string("ProductPage.Badge.MedicalDevice.Label"),a=new w3(XW,n_,{},rz,i,s,void 0,s,i,_q)
return n&&(a.artwork=kt(e,"systemimage://waveform.path.ecg.rectangle")),a}function Zu(e,t,n,r){const o=et(e,t,eU),s=et(e,t,tU)
if(!i(o)||!i(s))return null
if(o<=0||s<=0||o>s)return null
const a=e.loc.string(yC),c=Xu(e,o,s,!1),l=Xu(e,o,s,!0),u=e.loc.string(yC),d={paragraphText:Qu(e,o,s)}
return new w3(OV,lq,d,rz,a,c,void 0,l,u,lH)}function Qu(e,t,n){return t===n?t<=32?e.loc.formattedCount(t):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(i_,e.loc.formattedCount(32)):n<=32?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(i_,e.loc.formattedCount(t)).replace(AC,e.loc.formattedCount(n)):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(i_,e.loc.formattedCount(t)).replace(AC,e.loc.formattedCount(32))}function Xu(e,t,n,r){return 1===t&&1===n?e.loc.string("BADGE_PLAYERS_CAPTION_SINGLE"):1===t||r?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER"):e.loc.string("BADGE_PLAYERS_CAPTION_REQUIRED")}function ed(e,t,n,r){const o=B(t,LG)
let i=null
const s=ga(e,t)
if(!s&&o&&o.value&&o.ratingCount){const t=h(o,a_),n=Math.round(10*t)/10,r=e.loc.decimal(n,1),s=h(o,cC),a=e.loc.formattedCount(s)
let c
c=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.ShortTemplate",s).replace(c_,a)
const l=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.LongTemplate",s).replace(c_,a).replace("{rating}",r),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",r)
i=new w3(sV,sV,{rating:n,ratingFormatted:r},rz,c,c,l,u,c)}else{if(n)return null
const t=e.loc.string(TC)
if(s&&t!==TC)i=new w3(sV,sV,{},rz,null,t,null,t)
else if(!s){const t=e.loc.string("BADGE_NOT_ENOUGH_RATINGS_CAPTION")
i=new w3(sV,sV,{},rz,null,t,null,t)}}if(i){let t
return t=new dK(zq),i.clickAction=dd(e)?t:new fK(new hK(pz,_W)),i}return null}function td(e,t,n,r){if((0,mm.isSome)(B(t,bW)))return null
const o=q(t,"contentRatingsBySystem.appsAustralia.rank"),i=j(t,"contentRatingsBySystem.appsAustralia.name")
if((0,mm.isSome)(o)&&(0,mm.isSome)(i))return nd(e,n,"AU",o,i,!1)
const s=q(t,"contentRatingsBySystem.appsFrance.rank"),a=j(t,"contentRatingsBySystem.appsFrance.name")
if((0,mm.isSome)(s)&&(0,mm.isSome)(a))return nd(e,n,"FR",s,a,!1)
const c=q(t,"contentRatingsBySystem.appsKorea.rank"),l=j(t,"contentRatingsBySystem.appsKorea.name")
return(0,mm.isSome)(c)&&(0,mm.isSome)(l)?nd(e,n,"KR",c,l,!0):null}function nd(e,t,n,r,o,i){const s=null===(c=Zf(0,r))||void 0===c?void 0:c[0],a=Xf(0,r)
var c
if((0,mm.isNothing)(a)||(0,mm.isNothing)(s))return null
const l=XW,u=bC,d={contentRating:s},f=rz,h=e.loc.string(`ProductPage.Badge.AgeRating.${n}.Heading`)
let p,w
p=t?e.loc.string(gC):e.loc.string(mC),w=o
const v=e.loc.string(`ProductPage.Badge.AgeRating.${n}.AX.Caption`),g=new w3(l,u,d,f,h,p,void 0,w,v,lH)
return g.isMonochrome=!i,g.artwork=kt(e,`resource://${a}`,26,26),g}function rd(e,t,n,r){return t?ym.context("badgesFromLookupResponse",()=>{let o,i=!1
return H(t,uW)?o=g3:n?(o=y3,-1===o.indexOf(Yu)&&o.splice(1,0,Yu),i=!0):o=m3,function(e,t,n,r,o,i){const s=[]
for(const o of t){const t=o(e,n,r,i)
t&&s.push(t)}if(o&&s.some(e=>e.key===n$)){const e=s.findIndex(e=>e.key===FV)
e>=0&&s.splice(e,1)}return s}(e,o,t,n,i,r)}):[]}function od(e,t,n,r,o){const i=`${Cz}:/${_z.product}/${_z.shelf}/`+ap(n,r,o),s=new oY(i)
return s.param(Hz.shelfRefreshType,eY),s.param(Hz.id,t),s.build()}function id(e){return e.featureFlags.isEnabled(LK)}function sd(e,t){return t?t.map(t=>ad(e,t,HC)):[]}function ad(e,t,n){return ym.context("titledParagraphFromVersionHistoryEntry",()=>{let r=f(t,qC);(0,mm.isSome)(r)&&(r=r.trim())
const o=new A3(r,n),i=f(t,b_),s=e.loc.string("VERSION_STRING_TEMPLATE")
o.primarySubtitle=n===HC?i:s.replace("{version}",i)
const a=f(t,"releaseTimestamp")
if(a){const t=new Date(a)
o.secondarySubtitle=e.loc.relativeDate(t)}return o})}async function cd(e,t,n,a,c,l=!1){return await Za("createProductPageFromResponse",async()=>{var d
const p=mt(e,t)
if(o(p))return null
p.type
const w=null==a?void 0:a[O9],v=mt(e,w),g=s(v)?c:null,m=s(v)?null:c,y=function(e,t,n){var r
const o=mt(e,t),s=o.type===JW
i(n)&&(n.iAdClickFields&&(t[iZ]=JSON.stringify(n.iAdClickFields)),n.iAdLineItem&&(t[sZ]=n.iAdLineItem))
const a=Gn(e,s?RF:_H,o.id,t),c=new oY(a.pageUrl)
return null!==(r=null==n?void 0:n.webBrowser)&&void 0!==r&&r&&(c.param(uR,eP),c.removeParam(XF),c.removeParam(PC),a.pageUrl=c.build()),new C9(a,{rootPosition:0,locationStack:[]})}(e,t,n),b=ld(e,p,y,n,v,m,g,l)
y.metricsPageInformation.baseFields[NF]=_h(e,p,b.lockup.icon,null==n?void 0:n.clientIdentifierOverride),(Kt(e,Vq)||Kt(e,cq))&&(y.metricsPageInformation.adPageInfo=new o2(e,Vq,o2.createInitialPageSlotInfos(e,Vq,null,null,null)))
const P=kf(e,p),C=null!==(d=null==n?void 0:n.webBrowser)&&void 0!==d&&d
C||Vn(e,b,y.metricsPageInformation,t=>{const n=Mf(0,p,e.appleSilicon.isSupportEnabled),r=Gf(e,p,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),o=Bf(e,p,P,e.client.deviceType,n,!1,r),i=jf(0,P,e.client.deviceType,n,!1),a=P&&(o||i),c=function(e,t,n,r){if(!rf(e,t))return!1
if(st(e,t,Im.ThirtyTwoBit|Im.UnsupportedSystemDeletableApps|Im.MinimumOSRequirement|Im.UnsupportedPlatform|Im.MacOSRosetta))return!1
const o=xf(0,n,Mf(0,t,r),!1),i=kf(e,t)
return o.some(e=>Nf(i,e))}(e,p,e.client.deviceType,e.appleSilicon.isSupportEnabled)
t[l_]=a&&c?"runnable":a?"purchasable":wW,s(m)&&vz.shared.addReferralContextToMetricsFieldsIfNecessary(t)},C)
const I=jr(t,!0)
return await async function(e,t,n,a,c,l,d){var p,w
const v=kf(e,n),g=n.type===JW,m=V(n,uW),y=!(1===v.length&&v[0]===iz),b=ga(e,n),P=!!y&&!m&&!b,C=s(c)?c.clientIdentifierOverride:null,I=H(n,HG),k=t.lockup.offerDisplayProperties,O=!i(k)||k.isFree
let E
if(g){const t=fe(n,az)
E=function(e,t,n,r){return n?ym.context("bundleChildrenShelf",()=>{const o=mW,i=new pK(o)
i.isHorizontal=!0
const s=n.data.length
if(!s)return null
i.title=e.loc.stringWithCount("ProductPage.AppsInBundleShelf.Title",s)
const a=cp(e,n,r,R3.LockupIconSmall,o,null,Im.Bundles,null,e.featureFlags.isEnabled($K))
if(a.remainingItems.length){const e=new E9(t.id,a.remainingItems,i.title,!1,void 0,mW,_q,null)
e.isBundleShelf=!0,i.url=sp(0,e,r)}return xh(e,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:rW,id:`${r.getSequenceId()}`,idType:pW},i.title),i.items=a.items,Bh(r.locationTracker),r.addImpressionsToShelf(e,i,Gj),Vh(r.locationTracker),i.rowsPerColumn=s<2?1:2,i}):null}(e,n,t,a)}E&&(t.shelfMapping[Gj]=E)
const D=fe(n,JW),R=function(e,t,n,r){return n?ym.context("bundleParentsShelf",()=>{const o=n.data.length
if(!o)return null
const i=mW,a=new pK(i)
a.isHorizontal=!0,a.title=e.loc.string("ProductPage.Section.IncludedInBundles.Title")
const c=cp(e,n,r,R3.LockupIconSmall,i)
if(0===c.remainingItems.length&&0===c.items.length)return null
if(a.items=c.items,s(c.remainingItems)){const e=new E9(t.id,c.remainingItems,a.title,!1,void 0,i,_q,void 0)
e.isBundleShelf=!0,a.url=sp(0,e,r)}return a.rowsPerColumn=o<2?1:2,r.addImpressionsToShelf(e,a,"bundleParent"),a}):null}(e,n,D,a)
R&&(t.shelfMapping[yj]=R)
const _={productTitle:t.title,shouldShowRatingsAndReviews:P,isFirstPartyHideableApp:I,isBundle:g,isPreorder:m},L=function(e,t,n,r,i){return ym.context("createReviewsShelves",()=>{const a={}
if(o(t))return a
const c=function(e,t){if(dd(e))return!0
if(o(t))return!1
let n
return n=it(e).isSystemAppFromData(t),!n||e.bag.enableSystemAppReviews}(e,t),l=kf(e,t),d=fe(t,_W),p=yt(d),w=B(t,LG)
w.ratingAverage=h(w,a_),w.adamId=t.id,w.isBundle=r.isBundle,w.supportUrl=Qe(e,t,AM)
const v=wf(e,t,{useCase:R3.LockupIconMedium}),g=1===l.length&&"tv"===l[0],m=ja(e),y=u(w,QR),T=function(e,t,n,r){return ym.context("createProductRatings",()=>{const n=Sa(e,e.client.guid,YH,t)
return n.ratingAverage>0&&n.ratingCounts||r||(n.status=e.loc.string(e_)),n})}(e,w,p.length,y),b=function(e,t,n,r,o,i){return ym.context(BC,()=>{const r=ha(e,t,n,0,o,i)
if(r){const e=new l2
return e.actionType=Yy,e.action=r,e.id="ProductReviewAction.TapToRate",e}return null})}(e,t,r.productTitle,0,r.isBundle,g),P=function(e,t,n,r,o,i,s){return ym.context("createWriteAReview",()=>{if(r)return null
const a=new u2
a.writeReviewAction=La(e,t,i,s,o),a.supportAction=pa(e,n)
const c=new l2
return c.actionType="writeAReview",c.action=a,c})}(e,t,w,g,v,i,r.productTitle),C=ym.context(aC,()=>null),I=function(e,t,n){return ym.context("createReviewSummaryProductReview",()=>{const r=Pa(e,t,n)
if((0,mm.isNothing)(r))return null
const o=new ZJ
return o.review=r,o.sourceType=jV,o})}(e,t,n),k=Pa(e,t,n),O=Ta(e,w,p,!0,C,I,n),E=Ta(e,w,p,!0,null,null,n)
if(function(e,t,n,r,o,i,s,a){ym.context("createProductReviewActions",()=>{const c=new d2
return c.tapToRate=ha(e,t,n,0,o,i),c.writeReviewAction=La(e,t,a,n,s),c.supportAction=pa(e,r),c})}(e,t,r.productTitle,w,r.isBundle,g,v,i),g||0===p.length||Ga(e,e.client.guid,w,p,d.next,r.productTitle,v,!1,!1,t,n),r.shouldShowRatingsAndReviews){const o=new pK(zq)
o.title=m,o.items=[T],a.ratingsShelf=o,n.addImpressionsToShelf(e,o,"ratingsOverview",null,null,null,e.loc.string("ProductPage.Section.Reviews.Title"))
const i=[]
if(s(b)&&c&&i.push(b),s(P)&&c&&i.push(P),s(i)){const e=new pK(y_)
e.items=i,a.allReviewActionsShelf=e}if(s(k)){const e=new pK(jV)
e.items=[k],a.reviewSummaryShelf=e}let l=null
s(b)&&c&&(l=new pK(y_),l.items=[b],a.tapToRateActionsShelf=l)
let u=null
s(P)&&c&&(u=new pK(y_),u.items=[P],a.writeAReviewActionsShelf=u)
const h=e.loc.string(A_),v=e.loc.string(oN),y=(0,mm.isSome)(E)&&E.length>0
let R,_,L
if((0,mm.isSome)(O)&&O.length>0&&(R=new pK(L$),R.items=O,R.isHorizontal=!0,y?(R.title=h,R.contentsMetadata={type:"productReviewsSection",hasReviewSummary:(0,mm.isSome)(I),reviewSummaryTitle:v},n.addImpressionsToShelf(e,R,ZR,null,null,null,e.loc.string(A_))):R.title=v,a.allProductReviewsShelf=R),y&&(_=new pK(L$),_.items=E,_.isHorizontal=!0,_.title=h,n.addImpressionsToShelf(e,_,ZR,null,null,null,e.loc.string(A_)),a.userProductReviewsShelf=_),"tv"===e.client.deviceType){const t=new pK(T_)
t.title=m
const n=[]
s(b)&&A(D=b.action)&&"TapToRate"===D[hz]&&c&&n.push(b.action),s(T.status)?e.featureFlags.isEnabled(xK)?n.push(new c2(T.status)):n.push(Ea(T)):(n.push(ka(T)),n.push(Oa(T))),t.items=n,a.purchasedRatingsAndReviewsComponentShelf=t}if("tv"===e.client.deviceType){const t=new pK(T_)
t.title=m
const n=[]
s(T.status)?e.featureFlags.isEnabled(xK)?n.push(new c2(T.status)):n.push(Ea(T)):(n.push(ka(T)),n.push(Oa(T))),t.items=n,a.notPurchasedRatingsAndReviewsComponentShelf=t}s(C)&&(L=new pK(L$),L.items=[C],r.shouldShowRatingsAndReviews?C.review.showsBadge||(L.title=e.loc.string(MC)):L.title=m,a.editorsChoiceProductReviewsShelf=L),!g&&p.length>0&&(a.ratingsShelf.seeAllAction=function(e,t,n,r,o,i=null,s,a,c){return r?ym.context(wC,()=>{var t
const l=new mK
let u,d,h
if((0,mm.isSome)(null==c?void 0:c.allReviewActionsShelf)){u=S(c.allReviewActionsShelf)
const e=null!==(t=u.presentationHints)&&void 0!==t?t:{}
u.presentationHints={...e,displayIfReviewable:!0},wa(u)}if((0,mm.isSome)(null==c?void 0:c.ratingsShelf)){d=S(c.ratingsShelf)
const e=d.items[0]
if((0,mm.isSome)(e)&&1===d.items.length){const t=S(e)
t.context=uM,d.items=[t]}d.seeAllAction=null,d.title=null,wa(d)}(0,mm.isSome)(null==c?void 0:c.reviewSummaryShelf)&&(h=S(c.reviewSummaryShelf),wa(h))
const p=Ba(e,0,n,r,o,i,s,a,KR,{ratingsShelf:d,reviewSummaryShelf:h,reviewActionsShelf:u})
l.title=null,l.adamId=f(r,EH),l.nextPage=p.paginationToken,l.initialSortOptionIdentifier=p.initialSortId,l.sortActionSheetTitle=p.sortActionSheetTitle,l.sortOptions=p.sorts,(0,mm.isSome)(d)&&l.shelves.push(d),(0,mm.isSome)(h)&&l.shelves.push(h),(0,mm.isSome)(u)&&l.shelves.push(u),l.shelves.push(p.reviewsShelf)
const w=xa(e);(0,mm.isSome)(w)&&(l.trailingNavBarAction=w)
const v=new _J(_W)
return v.pageData=l,v.title=e.loc.string(nq),v}):null}(e,e.client.guid,t.id,w,p,d.next,!1,!1,a))}var D
return a})}(e,n,a,_,t.lockup.subtitle)
s(L)&&(t.shelfMapping[_G]=L.purchasedRatingsAndReviewsComponentShelf,t.shelfMapping[RG]=L.notPurchasedRatingsAndReviewsComponentShelf,t.shelfMapping[zq]=L.ratingsShelf,t.shelfMapping[xU]=L.allReviewActionsShelf,t.shelfMapping[PV]=L.allProductReviewsShelf,t.shelfMapping[vj]=L.userProductReviewsShelf,t.shelfMapping[Iq]=function(e,t){const n=function(e,t){return ym.context(aC,()=>{const n=f(Ke(e,t,nH),rz)
if(n){const r=new a2(n),o=Ke(e,t,dj)
if(o){const e=f(o,vF)
r.showsBadge=e===gF}return r.showsBadge||(r.title=e.loc.string(f$)),r}return null})}(e,t)
if((0,Am.isNothing)(n))return null
const r=new pK(Iq)
return r.items=[n],n.showsBadge?r.background={type:Iq}:r.title=e.loc.string(MC),r}(e,n),t.shelfMapping[EG]=L.tapToRateActionsShelf,t.shelfMapping[DG]=L.writeAReviewActionsShelf,t.shelfMapping[cN]=L.productReviewsHeader)
{const n=function(e){if(o(e.bag.ratingsAndReviewsLearnMoreEditorialId))return null
const t=new pK(ZV),n=function(e){const t=e.loc.string(UC),n={},r=function(e){const t=e.bag.ratingsAndReviewsLearnMoreEditorialId
if(o(t))return null
const n=new _J(vW)
return n.title=e.loc.string(UC),n.pageUrl=`https://apps.apple.com/story/id${t}`,n}(e)
if((0,mm.isNothing)(r))return null
n[t]=r
let i=e.loc.string("ProductPage.RatingsAndReviews.Footer")
i=i.replace(yV,t)
const s=new f2(i,FH)
return new h2(s,n)}(e)
return(0,mm.isNothing)(n)?null:(t.items=[n],t)}(e);(0,mm.isSome)(n)&&(t.shelfMapping[TH]=n)}const $=function(e,t,n){const r=Pa(e,t,n)
if((0,mm.isNothing)(r))return null
const o=new pK(jV)
return o.items=[r],o}(e,n,a);(0,mm.isSome)($)&&(t.shelfMapping[jV]=$)
const x=function(e,t,n,r){return ym.context(oV,()=>function(e,t,n,r,o,i){return ym.context("standardMostRecentVersionShelf",()=>{if(!n&&!r&&!o){const n=Ze(e,t,nG)
if(n.length>1&&sd(e,n).length>0){const r=new pK(VC)
r.title=e.loc.string(GC)
const o=ad(e,n[0],jC)
if(r.items=[o],i.addImpressionsToShelf(e,r,nG),r)return e.client.deviceType!==oz&&(r.seeAllAction=function(e,t,n,r){return ym.context("versionHistorySeeAllAction",()=>{const o=function(e,t,n){return ym.context("versionHistoryPageAction",()=>{const r=sd(e,t)
let o
if(r.length>0){const t=new pK(VC)
t.items=r
const i=new gK([t])
i.title=e.loc.string("VERSION_HISTORY_PAGE_TITLE","Version History"),e.client.deviceType!==oz&&(i.presentationOptions=[Qj])
const s=jn(e,"VersionHistory",n,"")
Vn(e,i,s)
const a=e.featureFlags.isEnabled(jK)?fz:nG,c=new _J(a)
c.title=e.loc.string("ACTION_VERSION_HISTORY_SEE_ALL"),c.pageData=i,o=c}return o})}(e,t,n)
return oa(e,o,null,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o})}(e,n,t.id,i)),r}}return null})}(e,t,r.isFirstPartyHideableApp,r.isBundle,r.isPreorder,n))}(e,n,a,{isFirstPartyHideableApp:I,isBundle:g,isPreorder:m})
x&&(t.shelfMapping[UH]=x),t.shelfMapping[Aj]=function(e,t,n){return ym.context("textCardShelfFromResponse",()=>(o(t),null))}(0,n)
const N=Qe(e,n,hW)
if(e.bag.enablePrivacyNutritionLabels&&!Bi(e,n.id)&&!Ui(e,N)){const s=function(e,t,n,r){return ym.context("privacyShelf",()=>{if(o(t))return null
const i=new pK(tW)
i.title=e.loc.string(KF)
const s=xl(e,t,!1,!1,n,r)
return i.items=[s],e.client.deviceType!==oz&&"tv"!==e.client.deviceType&&(i.seeAllAction=Gl(e,t,iV,n,r,null)),i})}(e,n,a.metricsPageInformation,a.locationTracker),c=function(e,t,n){return ym.context(oV,()=>{if(o(t))return null
const r=B(t,ux)
if((0,Am.isNothing)(r)||o(r))return null
const i=new pK(ZF),s=e.loc.string(KF)
xh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:YR,id:`${n.getSequenceId()}`,idType:pW},s)
const a=El(e,r,t,YH,!0,n.metricsPageInformation,n.locationTracker)
return(0,Am.isNothing)(a)||0===a.length?null:(i.items=a,a.length<=2&&(i.presentationHints={isLowDensity:!0}),i.title=s,n.addImpressionsToShelf(e,i,"appPrivacy"),Bh(n.locationTracker),Vh(n.locationTracker),i.title=null,i)})}(e,n,a)
if(i(s)&&i(c)){t.shelfMapping[tW]=s,i(c)&&(t.shelfMapping[Jq]=c)
const l=function(e,t,n,s){return ym.context(oV,()=>{if(o(t))return null
const a=Ul(e,t,!1,iV,n,s)
if((1===a.length&&a[0].identifier===HR||0===a.length)&&"tv"!==e.client.deviceType)return null
const c=new pK(Fq),l=function(e,t,n,o){return ym.context("privacyFooterFromData",()=>{const t=function(e,t,n,o){let i
const s=e.loc.string(qR),a={},c=Nl(e,n,o)
r(c)?i=e.loc.string(WR):(i=e.loc.string(VP),i=i.replace(yV,s),r(c)?i=e.loc.string(WR):a[s]=c)
const l=new f2(i,FH)
return new h2(l,a)}(e,0,n,o),s=function(e,t,n,r){if("tv"!==e.client.deviceType)return[]
const o=[],s=Nl(e,n,r)
i(s)&&o.push(s)
const a=Bl(e,n,r)
return i(a)&&o.push(a),o}(e,0,n,o)
return new B6(t,s,[].length)})}(e,0,n,s)
return c.items=[l],c})}(e,n,a.metricsPageInformation,a.locationTracker)
i(l)&&(t.shelfMapping[Fq]=l)}}const U=new U6,G=new U6,q=new U6,W=new U6,z=new U6,Y=new U6,J=ih(e,n),K=function(e,t,n,o,i,s,a,c){return ym.context(oV,()=>{let l
switch(e.client.deviceType){case oz:l=function(e,t,n,o){return ym.context(S_,()=>{let i
const s=$u(e,t)?t3:e3,a=Mu(e,s,t,n,!1,!1,o,void 0)
return a.length>0&&(i=new pK(Pj),i.items=a,r(o)||o.addImpressionsToShelf(e,i,DW)),i})}(e,t,n,o)
break
case"tv":l=function(e,t,n,o,i,s,a){return ym.context("tvInformationShelf",()=>{let c
const l=Mu(e,n3,t,n,!1,!1,o,a),u=function(e,t,n,r){return ym.context("productCapabilitiesAsAnnotations",()=>{const o=[],i=Tu(e,t,n,r.metricsPageInformation,r.locationTracker)
for(const e of i){const t=e.title,n=e.caption.styledText.rawText
if((null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0){const e=new H6(n),r=new q6(t,[e])
0===r.items_V3.length&&(r.items_V3=Fu(0,r)),o.push(r)}}return o})}(e,t,s,o).concat(Mu(e,r3,t,n,!1,!1,o,a)),d=rr(e,YC),f=Mu(e,d?[su]:[Lu],t,n,!1,!0,o,a),h=[]
if(l.length>0){const t=new Q6(e.loc.string(w_),l,i)
h.push(t)}if(u.length>0){const t=new Q6(e.loc.string(v_),u,i)
h.push(t)}if(f.length>0){const t=d?e.loc.string("ProductPage.Section.ExternalPurchases.Title"):e.loc.string("ProductPage.Section.TopInAppPurchases.Title"),n=new Q6(t,f,!0)
h.push(n)}return h.length>0&&(dd(e)?(c=new pK("annotationGroup"),c.items=h,c.background={type:m_},r(o)||o.addImpressionsToShelf(e,c,DW)):(c=new pK("informationContainer"),c.items=[new X6(h)],r(o)||o.addImpressionsToShelf(e,c,DW))),c})}(e,t,n,o,c,a,i)
break
default:l=function(e,t,n,o,i,s){return ym.context(S_,()=>{let a
const c=$u(e,t)?t3:e3,l=Mu(e,c,t,n,i,!1,o,s)
return l.length>0&&(a=new pK(Pj),a.title=e.loc.string(w_),a.items=l,r(o)||o.addImpressionsToShelf(e,a,DW)),a})}(e,t,n,o,s,i)}return l})}(e,n,I,a,(n,r,o)=>{var s,a,c
if(n===eu&&(U.setShelfId(DW,o),U.annotation=r,t.ageRatingAction=new dK(DW,null,null,void 0,o,!0),t.ageRatingAction.title=e.loc.string("ProductPage.Banner.AskForException.Review.ViewAgeRatingLink")),n===Zl&&i(t.banner)){i(t.banner.fullProductAction)&&(t.banner.action=t.banner.fullProductAction)
const n=t.banner.action
i(n)&&(dd(e)?T(c=n)&&c[hz]===pA&&(null===(s=n.shelfId)||void 0===s?void 0:s.length)>0&&n.shelfId===DW&&n.indexId===IG&&(n.index=o):function(e){return T(e)&&e[hz]===fA}(n)&&(null===(a=n.section.shelfId)||void 0===a?void 0:a.length)>0&&n.section.shelfId===DW&&n.indexId===IG&&(n.index=o))}n===fu&&(G.setShelfId(DW,o),G.annotation=r),n===Ru&&(q.setShelfId(DW,o),q.annotation=r),n===Kl&&(W.setShelfId(DW,o),W.annotation=r),n===du&&(z.setShelfId(DW,o),z.annotation=r),n===pu&&(Y.setShelfId(DW,o),Y.annotation=r)},J,O,!1)
K&&(t.shelfMapping[DW]=K)
const Z=function(e,t,n,r){var o
if(!li(e))return null
let i=ve(t,iE)
if(((0,mm.isNothing)(i)||0===i.length)&&(i=we(t,tz)),(0,mm.isNothing)(i)||0===i.length)return null
const s=he(t,iE),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:null!==(o=bt(s))&&void 0!==o?o:void 0},c=i.some(e=>e.type!==tz),l=c?"ProductPage.Section.AppEventsAndOffers.Title":"ProductPage.Section.AppEvents.Title",u=e.loc.string(l),d=c?"EventsAndOffers":"Events"
xh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:a.recoMetricsData,targetType:rW,id:d,idType:wW},u)
const f=mi(e,i,t,!c,!1,a,!1,!1,!1,!1);(0,mm.isSome)(f.nextAppEventPromotionStartDate)&&Vr(f.nextAppEventPromotionStartDate,r)
const h=f.appPromotions
if(0===h.length)return Bh(a.locationTracker),null
const p=Xa(0,h,u)
return n.addImpressionsToShelf(e,p,rW,d,wW,a.recoMetricsData),Bh(a.locationTracker),Vh(a.locationTracker),p}(e,n,a,l)
if(i(Z)&&(t.shelfMapping[Uq]=Z),J){const r=function(e,t,n){if(o(t))return null
const r=f(Ke(e,t,nH),rz)
if(r){const t=e.loc.string("APP_STORE_EDITORS_ATTRIBUTION"),o=new f3(r,t),i=new pK(BH)
return i.items=[o],n.addImpressionsToShelf(e,i,BH),i.background={type:wH,color:Se(d$)},i}return null}(e,n,a)
r&&(t.shelfMapping[BH]=r)}t.shelfMapping[cV]=Bu(e,n,a,!1,0,J),t.shelfMapping[eH]=Bu(e,n,a,!0,0,J),t.shelfMapping[PN]=function(e,t,n){return ym.context(oV,()=>{if("tv"!==e.client.deviceType)return null
if(o(t))return null
const r=new pK(OV)
r.isHorizontal=!1
const i=function(e,t){if(t)return ym.context("externalProductLinksAsParagraphsFromData",()=>{const n=[],r=Qe(e,t,TM)
if(r){const t=e.loc.string("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",r),o=new V0(t)
e.featureFlags.isEnabled(xK)&&(o.style=eB),o.alignment=CW,n.push(o)}return n})}(e,t)
return i&&i.length>0&&(r.items=i),dd(e)&&(r.background={type:m_}),n.addImpressionsToShelf(e,r,bB),r})}(e,n,a)
const Q=function(e,t,n,r){return ym.context("capabilitiesShelf",()=>{if(o(t))return null
const i=tt(e,t)
if(o(ce(t,i,hW)))return null
const s=Tu(e,t,n,r.metricsPageInformation,r.locationTracker)
if(o(s))return null
const a=new pK("productCapability")
return a.title=e.loc.string(v_),a.items=s,a.mergeWhenFetched=!0,a.batchGroup=kH,r.addImpressionsToShelf(e,a,"supports"),a})}(e,n,O,a)
Q&&(t.shelfMapping[oW]=Q)
const X=null!==(p=null==c?void 0:c.webBrowser)&&void 0!==p&&p
if(!X){const r=fe(n,lx)
if(s(r)){const i=function(e,t,n,r){return ym.context("smallStoryShelf",()=>{var i
if(o(n))return null
const a={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:rW,id:`${r.getSequenceId()}`,idType:pW},c=e.loc.string(FC)
xh(e,a,c)
const l=[],u=function(e){return l.push(e),!1}
let d
if(id(e)){const t=new qQ(a.pageInformation,a.locationTracker)
d=il(e,n,c,null,t,u)}else{const t={metricsLocationTracker:a.locationTracker,metricsPageInformation:a.pageInformation,filterOutMediaCardKinds:new Set([zB])}
d=ol(e,n,mH,c,null,t,u),Array.isArray(d.items)&&(d.items=d.items.filter(e=>!Bt(e)||nl(0,e.media.kind,mH)))}if(d.isHorizontal=!0,!(null===(i=d.items)||void 0===i?void 0:i.length)&&0===l.length)return null
if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=km.OnShelfWillAppear),s(l)){Bh(r.locationTracker),r.addImpressionsToShelf(e,d,aq),Vh(r.locationTracker)
const n=new E9(t.id,l,d.title,!1,void 0,d.contentType,null,null,null,null,null,py.SmallStory)
sc(e,d,n),d.url=sp(0,n,r)}else Bh(r.locationTracker),r.addImpressionsToShelf(e,d,aq),Vh(r.locationTracker)
return d})}(e,n,r.data,a)
i&&(t.shelfMapping[aq]=i)}}const ee={isPreorder:m},te=new U6,ne=function(e,t,n,r){return ym.context("friendsPlayingShelf",()=>{if(o(t))return null
const i=t.id
if(o(i))return null
if(!Xe(e,t,yU))return null
if(r.isPreorder)return null
const s=e.loc.string("ProductPage.Section.FriendsPlaying.Title","Playing This Game"),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:rW,id:`${n.getSequenceId()}`,idType:pW}
xh(e,a,s)
const c=new pK($C)
c.header=lo(e,s),c.isHidden=!0,c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new E9(t.id,[],c.title,!1,void 0,null,null,null)
c.url=`${Cz}:/${_z.product}/${_z.shelf}/?${Hz.isGameCenterPlayerShelf}=true&${Hz.id}=${i}&${Hz.token}=${ap(l,n,n.metricsPageInformation)}`,c.batchGroup=kH,n.addImpressionsToShelf(e,c,fW),Bh(n.locationTracker),Vh(n.locationTracker)
const u=new _J(fz)
return oa(e,u,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),c})}(e,n,a,ee)
ne&&(t.shelfMapping[fW]=ne,te.setShelfId(fW))
const re=function(e,t,n,r){return ym.context("achievementsShelf",()=>{if(o(t))return null
if(r.isPreorder)return null
if(!Xe(e,t,yU))return null
const i=tt(e,t),s=ce(t,i,hW)
if(o(s))return null
const a=e.loc.string("ProductPage.Section.Achievements.Title",aV),c=new pK(_C)
c.header=lo(e,a),c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new E9(t.id,[],c.title,!1,void 0,null,null,null)
return l.sourceLocationTracker=n.locationTracker,l.destinationPageInformation=n.metricsPageInformation,c.url=`${Cz}:/${_z.product}/${_z.shelf}/?${Hz.isGameCenterAchievementsShelf}=true&${Hz.bundleId}=${s}&${Hz.token}=${ap(l,n,n.metricsPageInformation)}`,c.batchGroup=kH,Vh(n.locationTracker),c.footerTitle=e.loc.string(Dx),c.footerAction=co({objectGraph:e,target:{achievements:{bundleID:null!=s?s:""}},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker}),c.footerStyle={$kind:qq,bundleID:TB,width:16,height:16},c})}(e,n,a,{isPreorder:m})
if(re&&(t.shelfMapping[NW]=re),!d&&!X){const r=function(e,t,n){return ym.context("moreByDeveloperShelf",()=>{if(o(t))return null
const r=Yf(0,pe(e,t,Eq)),i=j(t,eq)
let a,c
if(a=fe(t,bN),!a||0===a.data.length)return null
c=a.data
const l=e.loc.string("ProductPage.Section.MoreByDeveloper.TitleTemplate").replace("{developer}",i)
let u
switch(xh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:rW,id:`${n.getSequenceId()}`,idType:pW},l),e.client.deviceType){case iz:case"tv":u=Kq
break
default:u=mW}const d=new pK(u)
d.title=l
const f=null,h=e.client.isCompanionVisionApp?Im.VisionOSCompatibility:void 0
let p
if((0,mm.isSome)(a)?p=cp(e,a,n,uf(0,u),u,f,h):(0,mm.isSome)(c)&&(p=lp(e,c,n,uf(0,u),u,f,h)),!p)return null
d.items=p.items,d.isHorizontal=!0,c.length<2?d.rowsPerColumn=1:d.rowsPerColumn=2
{const t=new _J(fz)
t.pageUrl=r,t.title=e.loc.string(nq),oa(e,t,t.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),d.seeAllAction=t}if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=km.OnShelfWillAppear),s(p.remainingItems)){Bh(n.locationTracker),n.addImpressionsToShelf(e,d,Eq),Vh(n.locationTracker)
const o=new E9(t.id,p.remainingItems,d.title,!1,void 0,u,f,null,null,null,null,py.MoreByDeveloper)
o.developerUrl=r,sc(e,d,o),d.url=sp(0,o,n)}else Bh(n.locationTracker),n.addImpressionsToShelf(e,d,Eq),Vh(n.locationTracker)
return d})}(e,n,a);(0,mm.isSome)(r)&&(t.shelfMapping[Mq]=r)}if(!d&&!X){const r=function(e,t,n){return ym.context("similarItemsShelf",()=>{var r
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const i=fe(t,mj)
if(o(i))return null
const a=ih(e,t),c=a?e.loc.string("Arcade.ProductPage.MoreFromAppleArcade"):e.loc.string("ProductPage.Section.SimilarItems.Title"),l=Qq,u=OG
let d,f
switch(xh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:l,id:C9.similarItemsShelfId,idType:u},c),e.client.deviceType){case"tv":d=Kq,f=!1
break
case iz:d=Kq,f=!0
break
default:d=mW,f=!0}const h=new pK(d)
h.title=c
const p=bt(i),w=cp(e,i,n,uf(0,d),d,null,null,p)
if(!w)return null
h.items=w.items
const v=Kt(e,Vq),g=jn(e,"SimilarItems",t.id,""),m=new E9(t.id,i.data,h.title,f,void 0,d,null,null,null,null,null,py.SimilarItems)
{const e=od(0,t.id,m,n,g)
h.refreshUrl=e}if(h.isHorizontal=!0,i.data.length<2?h.rowsPerColumn=1:h.rowsPerColumn=a?2:3,e.bag.isOnDemandShelfFetchingEnabled&&(h.fetchStrategy=km.OnShelfWillAppear),s(w.remainingItems)||v){Bh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),Vh(n.locationTracker)
const o=new E9(t.id,null!==(r=w.remainingItems)&&void 0!==r?r:[],h.title,f,void 0,d,null,null,h.refreshUrl,p,a,py.SimilarItems)
if(sc(e,h,o),h.url=sp(0,o,n,g),v){const e=new oY(h.url)
e.param(Hz.isShelfWithAd,cW),e.param(Hz.shelfWithAdPlacementType,Vq),e.param(Hz.id,t.id),h.url=e.build()}}else Bh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),Vh(n.locationTracker)
return h})}(e,n,a);(0,mm.isSome)(r)&&(t.shelfMapping[Qq]=r)}const oe={isForSubscriptions:!0,options:c},ie=await M(Nu(e,n,a,oe))
ie.success&&(0,mm.isSome)(ie.value)&&(t.shelfMapping[VV]=ie.value)
const se={isForSubscriptions:!1,options:c},ae=await M(Nu(e,n,a,se))
ae.success&&(0,mm.isSome)(ae.value)&&(t.shelfMapping[kV]=ae.value)
const le=function(e,t,n,r){return ym.context("productMediaShelves",()=>{if(o(t))return null
const i=(e.client.deviceType,null),a=(e.client.deviceType,null),c=Ge(e,t),l=Pf(e,t,R3.ProductPageScreenshots,i,c,n),u=Tf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},a)
let d=null
if(u)for(const e of l)if(e.mediaPlatform.isEqualTo(u.mediaPlatform)){d=e
break}let f=null
if(d){const e=d.mediaPlatform.appPlatform
if(e===ZW||e===eW)for(const e of d.items){const t=e.screenshot
if(f=t.width/t.height,f<1)break}}const h=[],p=[]
if(d&&u&&u.videos)for(const n of u.videos){const o=new vY
o.video=n
const i=n.preview.width/n.preview.height,s=(0,mm.isNothing)(f)||Math.abs(i-f)<.01,a=d.mediaPlatform.isEqualTo(u.mediaPlatform)
s&&a?h.push(o):p.push(n)
const c={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,id:t.id,isAdvert:!!r.metricsPageInformation.adPageInfo&&r.metricsPageInformation.adPageInfo.adIsPresent}
yo(e,n,c)}d&&(d.items=h.concat(d.items))
let w=[],v={}
for(let n=0;n<l.length;n++){const o=l[n],i=`${k4}_${o.mediaPlatform.appPlatform}_${o.mediaPlatform.supplementaryAppPlatforms.join("_")}`
w.push(new m2(pz,i))
const a=new pK(NC,null,o.items)
a.isHorizontal=!0
let c=!1,u=Ya(0,o.items[0])
for(const e of o.items)if(s(e.screenshot)&&e.screenshot.isPortrait()||s(e.video)&&e.video.preview.isPortrait()){u=Ya(0,e),c=!0
break}a.contentsMetadata={type:"productMedia",platform:o.mediaPlatform,allPlatforms:o.allPlatforms,platformDescription:o.platformDescription,allPlatformsDescription:o.allPlatformsDescription,allPlatformsDescriptionPlacement:o.allPlatformsDescriptionPlacement,hasPortraitMedia:c,expandProductMediaAction:null,viewProductMediaGalleryAction:za(e,o,t.id),aspectRatio:u},r.addImpressionsToShelf(e,a,jW),0===n&&"tv"!==e.client.deviceType&&(a.title=e.loc.string(nC)),v[i]=a}return p.length>0&&(v[$q]=function(e,t,n){return ym.context("videoShelf",()=>{if(!t||0===t.length)return null
let r
return dd(e)?(r=new pK(NC),r.title=e.loc.string(WC),r.items=t.map(e=>{const t=new vY
return t.video=e,t})):(r=new pK(h$),r.title=e.loc.string(WC),r.items=t.map(e=>new C4(e,!0,FH,null,null,!0))),r.isHorizontal=!0,n.addImpressionsToShelf(e,r,$q),r})}(e,p,r)),{sectionMappings:w,shelfMapping:v,allProductMedia:l}})}(e,n,C,a)
t.shelfMapping={...t.shelfMapping,...le.shelfMapping}
const ue=function(e){if((0,mm.isNothing)(e))return null
switch(e){case ZW:return OW
case HW:return IW
case iz:return iz
case"tv":return Vj
case zW:return zH
case oz:return oz
case eW:return null
default:F(e)}}(null===(w=null==le?void 0:le.allProductMedia[0])||void 0===w?void 0:w.mediaPlatform.appPlatform),de=(t.title,function(e,t,n,r){return ym.context("createActionLinks",()=>(o(t),null))}(0,n))
if(de&&(t.shelfMapping[_$]=de),(0,mm.isSome)(ue)&&function(e,t,n){var r
const o=(0,bm.attributeAsDictionary)(t,`accessibility.${n}`),i=null!==(r=Qe(e,t,hW))&&void 0!==r?r:""
return Ri(e)&&!_i(e,t.id)&&!Li(e,i)&&(0,mm.isSome)(o)}(e,n,ue)){const r=ql(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker)
t.shelfMapping[Oq]=r
const o=Wl(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker);(0,mm.isSome)(o)&&(t.shelfMapping[Lq]=o)
const i=zl(e,n,!1,a.metricsPageInformation,a.locationTracker);(0,mm.isSome)(i)&&(t.shelfMapping[kq]=i)}{const e=J?NU:BU,n=Ol(0,e)
t.shelfMapping[e]=n}!function(e,t,n){if(t&&t.spotlightSection){const e=t.spotlightInAppProductIdentifier
if(e&&t.spotlightSection){const r=n.shelfMapping[t.spotlightSection.shelfId]
if(!r)return
if(r.presentationHints={isInProductPageSpotlight:!0},up(0,e,r.items),r.url){const t=new oY(r.url)
t&&(r.url=t.param(Hz.offerName,e).build())}}}}(0,c,t)
const ge={},me=bC,ye=iN,Ae=FU,Te=FV,be=n_,Pe=fW,Ce=o_
ge[TG]=U,ge[me]=U,ge[ye]=G,ge[Ae]=q,ge[Te]=W,ge[be]=Y,ge[Pe]=te,ge[Ce]=z,t.badges&&Vl(e,t.badges,ge,a),null!=t.shelfMapping[Yq]&&Vl(e,pd(e,t.shelfMapping[Yq]),ge,a),ud(e,t,le.sectionMappings,J,c)}(e,b,p,y,n,I,l),b.pageRefreshPolicy=Hr(e,I),b.isIncomplete=!1,b.alwaysAllowReviews=ma(e,p),b.canonicalURL=j(p,BW),l&&(b.shareAction=null,b.titleOfferDisplayProperties=null,b.expandedOfferDetails=null,b.lockup.offerDisplayProperties=null,b.banner=null),C&&(b.shareAction=null),b})}function ld(e,t,n,a,c,l,d,h=!1){return ym.context("createProductPageSidePack",()=>{var h,p,w
let v
i(a)&&(v=a.clientIdentifierOverride)
const g=t.id,m=j(t,cz),y=H(t,HG),T=ga(e,t),b=ih(e,t),S={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,id:g,isAdvert:!!n.metricsPageInformation.adPageInfo&&n.metricsPageInformation.adPageInfo.adIsPresent},P=new uK,C=new DJ,I=V(t,uW)
I&&i(n)&&i(n.metricsPageInformation)&&(n.metricsPageInformation.offerType=HH,n.metricsPageInformation.offerReleaseDate=Tr(0,t)),C.adamId=g,C.bundleId=Qe(e,t,hW),P.uber=function(e,t,n){mf(e,t,n)
const r=ih(e,t),s=function(e,t){return t&&!0}(0,r)?WW:Ib,a=new L4(s)
if(a.artwork=qf(e,t,{supportsArcade:r}),a.compactArtwork=qf(e,t,{supportsArcade:r,prefersCompactVariant:!0}),a.video=Wf(e,t,R3.Uber),i(a.video)&&(a.video.playbackId=function(e){return`ProductPage.${e.id}.productUberVideoPlaybackId`}(t)),r&&o(a.video)&&o(a.artwork)){const r=(e.client.deviceType,null),o=Ge(e,t),i=Pf(e,t,R3.ProductPageScreenshots,r,o,n)
if(i.length>0&&i[0].items.length>0){const e=i[0].items[0]
a.video=e.video,a.artwork=e.screenshot}}return o(a.compactArtwork)&&(a.compactArtwork=a.artwork),a.isValidUber(!1,!1)?a:null}(e,t,v)
const k=P.uber&&P.uber.style===WW
C.icon=wf(e,t,{useCase:R3.ProductPageIcon,withJoeColorPlaceholder:void 0},v),P.title=m,P.isIncomplete=!0,C.title=m,C.subtitle=Ld(e,t),C.developerTagline=Qe(e,t,Pq),P.regularPriceFormatted=j(t,"regularPriceFormatted"),P.logoArtwork=function(e,t){let n,r
if("tv"!==e.client.deviceType)return
n=ib,r="bb"
const o=Ke(e,t,n)
return i(o)&&i("bb")?df(e,o,{cropCode:"bb",useCase:R3.Default,withJoeColorPlaceholder:!0}):void 0}(e,t),P.navigationBarIconArtwork=null,T||(C.rating=q(t,wF)),C.children=Rd(e,t,{metricsOptions:S,artworkUseCase:R3.LockupIconSmall})
const O=function(e,t,n,r,o,a,c){var l
const d=gr(e,t),f=Qe(e,t,hW),h=V(t,uW),p=yr(e,d,t,h,!1,_h(e,t,n,null==a?void 0:a.clientIdentifierOverride),o,YH,c,null==a?void 0:a.webBrowser)
if(null!==(l=null==a?void 0:a.webBrowser)&&void 0!==l&&l&&(null==a?void 0:a.webBrowserFlowType)!==wy.PurchaseAndOpen)return{buttonAction:new M4(t.id),offerAction:p}
let w
if(s(p)){i(a)&&(p.lineItem=a.iAdLineItem)
const n=s(a)?a.clientIdentifierOverride:null
if(w=Pr(e,p,t,h,o,YH,n),i(a)&&s(w)){const n=nt(e),r=ot(e,t,Ge(e,t),Mx,n),i=s(r)&&!u(a.isCppDeepLinkDisabled),c=s(a.externalDeepLinkUrl)
let l;(i||c)&&(l=i?r:a.externalDeepLinkUrl,w=ca(e,w,p.adamId,f,l,!1,o))}}return{buttonAction:w,offerAction:p}}(e,t,C.icon,0,S,a,l)
if(C.buttonAction=O.buttonAction,I){let n
P.theme=jL
let r=null
if(b)n="",r=e.loc.uppercased(vh(e,t,e.loc.string(u_)))
else if(n=e.loc.string(u_),i(O.offerAction.expectedReleaseDate)){const n=i$,o=e.loc.formatDate(n,O.offerAction.expectedReleaseDate),i=e.loc.string("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(s_,o)
r=vh(e,t,i)}P.expandedOfferDetails=new E4(n,r)}let E,D
k&&b&&(P.theme=lW),k&&b?(E=lW,D=xL):(E=AV,D=YH)
const R=PD,_=AV,L=b?OU:VW,M=null!==(h=null==a?void 0:a.webBrowser)&&void 0!==h&&h
let F
switch(null==a?void 0:a.webBrowserFlowType){case wy.SelectionOnly:F=!0
break
case wy.PurchaseAndOpen:F=!1
break
default:F=!0}const $=M&&F?_P:YH
let x
C.offerDisplayProperties=xr(e,O.offerAction,L,t,I,0,E,D,null,null,$,!1,!1),P.titleOfferDisplayProperties=xr(e,O.offerAction,L,t,I,0,_,R,null,null,$),M&&(C.offerDisplayProperties.ignoresContentRestrictions=!0,P.titleOfferDisplayProperties.ignoresContentRestrictions=!0)
const N=pe(e,t,Eq),B=Yf(0,N)
i(B)&&(x=new _J(fz),x.title=j(t,eq),x.pageUrl=B,ra(e,x,{targetType:lz,id:N.id,actionType:dz,pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker})),P.developerAction=x,P.shareAction=Yo(e,t,n.metricsPageInformation,n.locationTracker,v),C.tertiaryTitle=Md(e,t),C.tertiaryTitleAction=Fd(e,t),C.tertiaryTitleArtwork=null
const U={appPlatforms:kf(e,t),clientIdentifierOverride:v,offerButtonShouldBeDisabled:!1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker,webBrowser:null!==(p=null==a?void 0:a.webBrowser)&&void 0!==p&&p,webBrowserFlowType:null==a?void 0:a.webBrowserFlowType},G=function(e,t,n){let r=null,i=null,a=null,c=null,l=null,u=!1,d=null
const f=Xe(e,t,TA),h=Xe(e,t,bA)
if((f||h)&&(r=e.loc.string("ProductPage.Banner.UpdateRequired.iOS"),n.offerButtonShouldBeDisabled=!0),(0,Am.isNothing)(r)&&st(e,t,Im.SADWatchApps)&&(r=e.loc.string("OFFER_WATCH_ONLY_BANNER"),n.offerButtonShouldBeDisabled=!0),(0,Am.isNothing)(r)&&!rf(e,t)){if(r=e.loc.string(ZP),dd(e)){const t=new dK(DW)
t.title=e.loc.string(CG),t.indexId=IG,a=t}else{const t=new hK(pz,DW),n=new fK(t)
n.title=e.loc.string(CG),n.indexId=IG,a=n}r=e.loc.string(MB).replace(FB,a.title),n.offerButtonShouldBeDisabled=!0}if((0,Am.isNothing)(r)&&st(e,t,Im.UnsupportedSystemDeletableApps|Im.LegacyApps)&&(r=e.loc.string(QP),n.offerButtonShouldBeDisabled=!0),st(e,t,Im.MinimumOSRequirement)){const n=$f(e,t,e.appleSilicon.isSupportEnabled)
switch(e.client.deviceType){case iz:r=e.loc.string("UNSUPPORTED_MACOS_VERSION").replace(Bj,n)
break
case ZW:case HW:r=e.loc.string("UNSUPPORTED_IOS_VERSION").replace(Bj,n)
break
case"tv":r=e.loc.string("UNSUPPORTED_TVOS_VERSION").replace(Bj,n)
break
case oz:const o=Qe(e,t,FN)
r=e.loc.string(XP).replace(Bj,o)
break
case zW:r=e.loc.string("UNSUPPORTED_VISIONOS_VERSION").replace(Bj,n)
break
default:r=e.loc.string(QP)}if(e.client.isPhone&&Xe(e,t,Tj)){const n=Qe(e,t,FN)
r=e.loc.string(XP).replace(Bj,n)}}if(st(e,t,Im.UnsupportedPlatform))if(n.offerButtonShouldBeDisabled=!0,r=e.loc.string(ZP),dd(e)){const t=new dK(DW)
t.title=e.loc.string(CG),t.indexId=IG,a=t,r=e.loc.string(MB).replace(FB,t.title)}else{const t=new hK(pz,DW),n=new fK(t)
n.title=e.loc.string(CG),n.indexId=IG,a=n,r=e.loc.string(MB).replace(FB,n.title)}if(st(e,t,Im.MacOSRosetta)){if(dd(e)){const t=new dK(DW)
t.title=e.loc.string(CG),t.indexId=IG,a=t}else{const t=new hK(pz,DW),n=new fK(t)
n.title=e.loc.string(CG),n.indexId=IG,a=n}r=e.loc.string(MB).replace(FB,a.title)}const p=H(t,uW)
lh(e,t)&&(r=p?e.loc.string("ProductPage.WatchOS.PreOrderRequiresiPhone"):e.loc.string("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),n.offerButtonShouldBeDisabled=!0)
const w=Qe(e,t,FN)
if((0,Am.isNothing)(r)&&n.clientIdentifierOverride===nJ&&hh(e,w)&&(r=e.loc.string("ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace(Bj,w)),Fe(e,t,zH)&&!e.client.isCompanionVisionApp){const t=e.loc.string("BANNER_VISION_ONLY_APP_LEARN_MORE_LINK")
i=function(e,t,n,r){const i=e.bag.visionOnlyAppLearnMoreEditorialItemId
if(o(i))return null
const s=new _J(vW)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,ra(e,s,{id:JU,targetType:EW,actionType:dz,pageInformation:n,locationTracker:r}),s}(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){return t&&n?e.loc.string("BANNER_VISION_ONLY_APP_WITH_LINK").replace(yV,t):e.loc.string("BANNER_VISION_ONLY_APP_NO_LINK")}(e,t,i),a=null,c=kt(e,"systemimage://visionpro"),l=Se(qN),u=!0}Lr(e,t)&&!Fr(e)?(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.VisionDeviceRequired")):e.client.isCompanionVisionApp&&!Lr(e,t)&&(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.RemoteDownloadUnavailable"))
const v=nr(e,t),g=rr(e,"product-page-banner")
if(((0,Am.isNothing)(r)||!n.offerButtonShouldBeDisabled)&&v&&g){const t=e.loc.string("ProductPage.ExternalPurchasesBanner.LearnMore")
i=or(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){if(t&&n){if((0,Am.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const n=`ProductPage.ExternalPurchasesBanner.WithLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(n).replace(yV,t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.WithLink").replace(yV,t)}if((0,Am.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const t=`ProductPage.ExternalPurchasesBanner.NoLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.NoLink")}(e,t,i),a=null,e.bag.externalPurchasesIncludeProductPageBannerIcon?"secondaryInfoCircle"===e.bag.externalPurchasesProductPageBannerIconVariant?(c=kt(e,"systemimage://info.circle"),l=Se(qN)):(c=kt(e,QF),l=Se("systemRed")):(c=null,l=null),u=!0}if(((0,Am.isNothing)(r)||!n.offerButtonShouldBeDisabled)&&(0,Am.isSome)(n.webBrowser)&&n.webBrowser&&n.webBrowserFlowType===wy.PurchaseAndOpen&&(r=e.loc.string("ProductPage.Banner.DefaultBrowser.Message"),c=kt(e,"systemimage://gear"),l=Se(qN),d=XF),(null==r?void 0:r.length)>0)return new D4(r,null,i,a,c,l,u,d)
if(!n.offerButtonShouldBeDisabled){const n=Ff(e,t)
if(s(n))return function(e,t){const n=e.loc.string("ProductPage.Banner.ExternalBrowser.Message")
let r=n,o=n,i=n,s=n,a=n
return[Rj].includes(e.client.buildType)&&(r+="\n(Internal: unknown)",o+="\n(Internal: buyOrGet)",i+="\n(Internal: redownload)",s+="\n(Internal: update)",a+="\n(Internal: open)"),new R4(Hl(e$,t,r),Hl(e$,t,o),Hl(e$,t,i),Hl(VF,t,s),Hl("launch",t,a))}(e,n)}return null}(e,t,U)
A(w=G)&&"Banner"===w[hz]?P.banner=G:function(e){return A(e)&&"AppStateBanner"===e[hz]}(G)&&(P.appStateBanner=G)
const W=C.offerDisplayProperties
U.offerButtonShouldBeDisabled&&s(W)&&(C.offerDisplayProperties=W.newOfferDisplayPropertiesChangingAppearance(!1,GG))
const z=!st(e,t,Im.MinimumOSRequirement)
if(!y&&!U.offerButtonShouldBeDisabled&&z){const n=function(e,t){return ym.context("updateOfferDataFromData",()=>{const n=Ze(e,t,bV)
if(0===n.length)return null
for(const e of n)if(f(e,IH)===VF)return e
return null})}(e,t)
P.updateBuyParams=f(n,pV),P.externalVersionIdentifier=et(e,t,d_)}if(b&&(C.editorialTagline=e.loc.string("APPLE_ARCADE")),P.lockup=C,P.appPlatforms=kf(e,t),i(c)){const n=ai(e,c,t,!1,!1,MW,lW,!0,S,!0,!1,null,!1,!1)
if(i(c)&&function(e){return A(e)&&function(e){return(0,mm.isSome)(U0[e])}(e.$kind)}(n)){const r=n
P.appPromotionDetailPageFlowAction=ci(e,c,t,r,S,hq,!1,d)}}!function(e,t,n,i,s,a){if(t.shelfMapping[LW]=new pK(f_,"productTopLockup"),"tv"!==e.client.deviceType){const s={developerAction:t.developerAction}
t.shelfMapping[SW]=function(e,t,n,i){return ym.context("descriptionShelf",()=>{if(o(t))return null
const s=new pK("productDescription"),a=function(e,t){return t?ym.context("productDescriptionLinksFromData",()=>{const n=[],r=Qe(e,t,TM)
if(r){const t=new HJ(r,!1),o=e.loc.string("PRODUCT_DEVELOPER_WEBSITE")
n.push(new i3(o,t,s3))}const o=Qe(e,t,AM)
if(o){const t=new HJ(o,!1),r=e.loc.string("DEVELOPER_SUPPORT")
n.push(new i3(r,t,l3))}return n}):null}(e,t),c=function(e,t,n,r){const o=ve(t,GE),i=[]
for(const t of o){const o=(0,bm.attributeAsString)(t,cz)
if((0,mm.isSome)(o)){let s=null
switch(t.type){case SB:s=(0,bm.attributeAsString)(t,BW)
break
case CH:const n=f(t,uj)
n&&(s=ji(e,n))}if((0,mm.isNothing)(s))continue
const a=e.required(R9).fetchFlowPage(s),c=new _J(a)
c.pageUrl=s,c.title=o
const l=new S6(o,c),u={targetType:tV,pageInformation:n,locationTracker:r,recoMetricsData:null}
Jh(e,l,tp(e,t,o,u))
const d=ea(e,t,u)
d.targetType=u.targetType,ra(e,c,d),l.automationMetadata=Ur(l.automationMetadata,LC,t.type),i.push(l),Vh(u.locationTracker)}}return i}(e,t,n.metricsPageInformation,n.locationTracker),l=function(e,t,n=null){return ym.context("descriptionFromData",()=>{r(n)&&(n=Ge(e,t))
let o=function(e,t,n){return ot(e,t,n,OT)}(e,t,n)
o||(o="")
let i=Qe(e,t,Sj)
i||(i="")
let s=""
o.length>0&&i.length>0&&(s="\n\n")
const a=o+s+i
if(a.length>0){const e=new V0(a)
return e.isCollapsed=!0,e}return null})}(e,t)
if((0,mm.isNothing)(l))return null
const u=new o3(l,a,c,i.developerAction)
return s.items=[u],n.addImpressionsToShelf(e,s,SW),s})}(e,n,i,s)}{const r={useInlineUberStyle:t.uber&&t.uber.style===WW}
t.shelfMapping[Yq]=function(e,t,n,r){if(dd(e)){const r=new pK("productBadge"),o=rd(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation})
return r.items=o,r.isHorizontal=!0,n.addImpressionsToShelf(e,r,Yq),r}{const o=new pK(Yq),i=rd(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation}),s=!r.useInlineUberStyle,a=!1,c=r.useInlineUberStyle,l=new p3(i,s,a,c,"justified")
return o.items=[l],o.isHorizontal=!0,n.addImpressionsToShelf(e,o,Yq),o}}(e,n,i,r)}ud(e,t,[],ih(e,n),s)}(e,P,t,n,a),P.uber&&(P.presentationOptions.push(dB),P.presentationOptions.push(jM)),P.alwaysAllowReviews=ma(e,t)
const Y=null==a?void 0:a.iAdDismissAdActionMetrics
if((0,mm.isSome)(Y)){const e=new zJ(f(Y.instanceId),f(Y.adamId),f(Y.bundleId),f(Y.advertType),f(Y.invocation),f(Y.purchaseType),f(Y.reportingDestination)),t=new bZ(e)
P.pageDisappearedAction=t
const n=new zJ(f(Y.instanceId),f(Y.adamId),f(Y.bundleId),f(Y.advertType),AS,f(Y.purchaseType),f(Y.reportingDestination))
P.lockup.buttonAction=zt(0,P.lockup.buttonAction,n)}return P})}function ud(e,t,n,r,o){const i=function(e,t,r){return e.map(e=>e.shelfId===jW&&r?n:e.shelfId===jW?n[0]?[n[0]]:[]:[e]).reduce((e,t)=>e.concat(t)).map(e=>e.createShelfIdList()).reduce((e,t)=>e.concat(t))},a=Ha(0,!0,e.host.platform,r,!1,!1,o),c=Ha(0,!1,e.host.platform,r,!1,!1,o),l=Ha(0,!0,e.host.platform,r,!0,!1,o),u=Ha(0,!1,e.host.platform,r,!0,!1,o),d=Ha(0,!1,e.host.platform,r,!1,!0,o),f=Ha(0,!1,e.host.platform,r,!0,!0,o)
t.shelfOrderings.purchasedOrdering=i(a,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia=i(a,0,!0),t.shelfOrderings[_4]=i(c,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia=i(c,0,!0),t.shelfOrderings.purchasedOrdering_Compact=i(l,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia_Compact=i(l,0,!0),t.shelfOrderings.notPurchasedOrdering_Compact=i(u,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia_Compact=i(u,0,!0),t.shelfOrderings.downloadingOrdering=i(d,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia=i(d,0,!0),t.shelfOrderings.downloadingOrdering_Compact=i(f,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia_Compact=i(f,0,!0),t.defaultShelfOrdering=_4
for(const e of Object.keys(t.shelfMapping))s(t.shelfMapping[e])&&(t.shelfMapping[e].id=e)}function dd(e){return e.featureFlags.isEnabled(EK)||!0}async function fd(e,t,n={},r={},o=null,i=!1,s=!1){const a=ih(e,mt(e,t)),c=await cd(e,t,n,r,o,s)
return dd(e)&&!i?c:Ja(e,c,a,n)}function hd(e,t,n={}){if(!e.client.isSidepackingEnabled)return null
const o=ih(e,t),i=function(e,t,n){return ym.context("createProductPageSidePackFromResponse",()=>{if(!e.client.isSidepackingEnabled)return null
const o=function(e,t,n){const r=j(t,BW),o=j(t,cz),i=j(t,eq)
let s=null
n&&(s=n.iAdClickFields)
const a=jn(e,_H,t.id,`${i}_${o}`,s)
return a.pageUrl=r,new C9(a,{rootPosition:0,locationStack:[]})}(e,t,n),i=ld(e,t,o,n)
return function(e,t,n){r(n)||(t.pageMetrics.addData(Zn(e,n,void 0),[Ym.PageInvocationPoint.backButton]),r(t.pageMetrics.pageFields)&&(t.pageMetrics.pageFields={}))}(e,i,o.metricsPageInformation),i})}(e,t,n)
return dd(e)?i:Ja(e,i,o,n)}function pd(e,t){if(o(null==t?void 0:t.items))return[]
if(dd(e))return t.items
{const e=t.items
return e.length>0?e[0].badges:[]}}function wd(e,t,n){const r=kn(0,t),o=vd(e,t,r,n,T3[n],!1),i=vd(e,t,r,n,b3[n],!0)
return o.rtlArtwork=i.rtlArtwork,o.rtlArtworkData=i.rtlArtworkData,o.rtlVideo=i.rtlVideo,o.rtlBackgroundColor=i.rtlBackgroundColor,o.rtlTextColorOverride=i.rtlTextColorOverride,o}function vd(e,t,n,r,o,a){let c={}
for(const l of o){if(i(n)&&(c=md(e,n,r,l,a)||gd(e,n,r,l,a),s(c)))break
if(c=md(e,t,r,l,a)||gd(e,t,r,l,a),s(c))break}return(0,Am.isNothing)(c)&&(c={}),c}function gd(e,t,n,o,i){let a=null,c=null,l=null
const u=`editorialArtwork.${o}`,d=tt(e,t)
if(r(d))return null
if(c=B(t,u)||se(t,d,u),!s(c))return null
const f=function(e,t,n){switch(e){case fy.Hero:switch(t){case dy.HeroStatic16x9:if(!n)return{cropCode:"gd"}
break
case dy.HeroStaticRTL16x9:if(n)return{cropCode:"gg"}
break
case dy.StoryCenteredStatic16x9:return{cropCode:n?"gh":"ge"}
case dy.UniversalAStatic16x9:return{cropCode:n?"gj":"gi"}}break
case fy.LargeBreakout:switch(t){case dy.StoryCenteredStatic16x9:return{cropCode:n?"gk":"gf"}
case dy.UniversalAStatic16x9:return{cropCode:n?"gl":"gm",cropAspectRatio:{horizontal:3350,vertical:1032},contentMode:Pm.right}}break
case fy.StoryCard:case fy.StoryDetail:case fy.StoryDetailLandscape:case fy.Search:if(t===dy.UniversalAStatic16x9)return{cropCode:"gn"}
break
case fy.Brick:if(t===dy.SearchCategoryBrick)return{cropCode:JT}}return{cropCode:"sr"}}(n,o,i)
if(a=df(e,c,{withJoeColorPlaceholder:!0,useCase:yd(n),cropCode:f.cropCode}),(0,Am.isSome)(a)&&(0,Am.isSome)(f.cropAspectRatio)&&(a.cropAspectRatio=f.cropAspectRatio),(0,Am.isSome)(a)&&(0,Am.isSome)(f.contentMode)&&(a.contentMode=f.contentMode),r(a))return null
l=a.backgroundColor
const h=Td(0,c,a)
return i?{rtlArtwork:a,rtlArtworkData:c,rtlBackgroundColor:l,rtlTextColorOverride:h}:{artwork:a,artworkData:c,backgroundColor:l,textColorOverride:h}}function md(e,t,n,r,i){let a=null,c=null,l=null,u=null
const d=`editorialVideo.${r}`,h=tt(e,t)
if((0,Am.isNothing)(h))return null
if(l=B(t,d)||se(t,h,d),o(l))return null
const w=p(l,Dj)
s(w)&&(c=df(e,w,{withJoeColorPlaceholder:!0,useCase:yd(n),cropCode:"sr"})),s(c)&&(c.crop="sr",u=c.backgroundColor)
const v=f(l,Xq)
if(s(c)&&(0,Am.isSome)(v)&&v.length>0&&(a=new wY(v,c,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:bd(0,n),autoPlayPlaybackControls:{}}),a.editorialMediaFlavor=r,a.editorialMediaPlacement=n),(0,Am.isNothing)(w)||(0,Am.isNothing)(c))return null
const g=Td(0,w,c)
return i?{rtlVideo:a,rtlArtwork:c,rtlArtworkData:w,rtlBackgroundColor:u,rtlTextColorOverride:g}:{video:a,artwork:c,artworkData:w,backgroundColor:u,textColorOverride:g}}function yd(e){switch(e){case fy.Hero:return R3.GroupingHero
case fy.LargeBreakout:return R3.ArcadeLargeBreakout
case fy.StoryCard:return R3.TodayCardMedia
case fy.StoryDetail:case fy.StoryDetailLandscape:return R3.ArticleImage
case fy.Search:return R3.SearchEditorialResult
default:return R3.Default}}function Ad(e,t,n=!1){if((0,Am.isNothing)(t))return null
const r=n?t.rtlTextColorOverride:t.textColorOverride,o=n?t.rtlBackgroundColor:t.backgroundColor
return(0,Am.isSome)(r)?Ce(r,fJ):(0,Am.isSome)(o)?be(o):null}function Td(e,t,n){const r=null==n?void 0:n.textColor
if((0,Am.isNothing)(r))return null
const o=u(t,"useCustomTextColor"),i=Ce(r,dJ)||Ce(r,fJ)
return o&&i?r:null}function bd(e,t){switch(t){case fy.Hero:case fy.StoryDetail:case fy.StoryDetailLandscape:return{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}
default:return{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}}}function Sd(e,t,n){switch(n){case mU:case gU:case sB:case iB:return wd(e,t,fy.EditorialLockup)
case"BrickSmall":case"BrickMedium":case"BrickLarge":return wd(e,t,fy.Brick)
case BM:case"StorySmall":return wd(e,t,fy.StoryCard)
case Zj:return wd(e,t,fy.Hero)
case rD:return wd(e,t,fy.LargeBreakout)
default:return{}}}function Pd(e,t,n){const r=function(e,t,n){const r=function(e,t){let n=null
switch(t.type){case YW:case Wq:case lG:n=we(t,uG,!0)||we(t,Sq,!0)||we(t,sz,!0)
break
case CH:n=w(t.meta,_b)
break
default:n=null}return n}(0,t)
return o(r)?null:Yd(e,r,n)}(e,t,{lockupOptions:n})
if(!o(r))return null==r?void 0:r.map(e=>e.icon)}function Cd(e,t,n){const r=In(e,t)
return o(r)?null:Nd(e,r,n)}function Id(e,t,n,o,i,s,a){const c=t[e]
if(r(c))return null
const l=c(n,o,i,s,a)
if(r(l))return null
for(const e of l)e.automationMetadata=Ur(e.automationMetadata,LC,e.moduleType)
return l}function kd(e,t,n,r,o){if((0,mm.isNothing)(t)||0===t.length||r.has(t))return null
const i=new S3(hN)
return i.moduleType=tL,(0,mm.isSome)(t)&&(i.labelText=t,Kh(e,i,np(o,tL,i.labelText,ez))),r.add(t),[i]}function Od(e,t,n){return t===jq?n?nz:BG:n?OU:VW}function Ed(e,t,n,r,s){var a,c,u,d,f,h,w,v,g,m,y
if(o(t))return
if(n.showMetadataInformationInLockup=e.bag.isLLMSearchTagsEnabled||e.client.isPad,!e.client.isPhone)return
const A=p(t,cH),T=null!==(c=null===(a=null==A?void 0:A.displayStyle)||void 0===a?void 0:a.metadataRibbon)&&void 0!==c?c:null===(u=null==r?void 0:r.displayStyle)||void 0===u?void 0:u.metadataRibbon
let b=[]
b=e.bag.isLLMSearchTagsEnabled?null!==(w=null!==(f=null===(d=null==A?void 0:A.displayStyle)||void 0===d?void 0:d.llmRibbon)&&void 0!==f?f:null===(h=null==A?void 0:A.displayStyle)||void 0===h?void 0:h.metadataRibbon)&&void 0!==w?w:null===(v=null==r?void 0:r.displayStyle)||void 0===v?void 0:v.metadataRibbon:null!==(m=null===(g=null==A?void 0:A.displayStyle)||void 0===g?void 0:g.metadataRibbon)&&void 0!==m?m:null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.metadataRibbon
const S=function(e,t,n,r,i,s=P3){if((0,mm.isNothing)(r)||0===r.length)return[]
const a=[],c=new Set
for(const l of r)if(!o(l))for(const r of l){const o=Id(r,s,e,t,n,c,i.metricsOptions)
if(o){a.push(...o)
break}}return a}(e,t,n,T,s),P=function(e,t,n,r,s,a=P3){if(o(r))return[]
const c=l(t.meta,"associations.tags.data"),u=[]
let d=0,f=0
const h=new Set
for(const l of r){const r=Array.isArray(l)?l:[l]
if(!o(r))for(const o of r){const r=o===$x
let l,w=t,v=""
if(o===tL){const n=p(t,cH);(0,mm.isSome)(null==n?void 0:n.rankedSecondaryGenreShortDisplayNames)&&(v=null==n?void 0:n.rankedSecondaryGenreShortDisplayNames[f]),(0,mm.isSome)(v)?(l=kd(e,v,0,h,s.metricsOptions),f+=1):l=[]}else w=r?c[d]:t,l=Id(o,a,e,w,n,h,s.metricsOptions),d=r?d+1:d
if(i(l)){u.push(...l)
for(const e of l)(0,mm.isSome)(e.impressionMetrics)&&Vh(s.metricsOptions.locationTracker)
break}}}return u}(e,t,n,b,s)
n.metadataRibbonItems=S,n.searchTagRibbonItems=P,n.shouldEvenlyDistributeRibbonItems=!e.bag.isLLMSearchTagsEnabled}function Dd(e,t,n,r,o,i){t&&ym.context("copyDataIntoLockup",()=>{var s,a,c,u,d,h
const p=H(t,uW)
if(r.isContainedInPreorderExclusiveShelf&&!p)return
const w=null!==(s=null==r?void 0:r.attributePlatformOverride)&&void 0!==s?s:nt(e),v=Ge(e,t)
n.productVariantID=Ve(v),r.metricsOptions.productVariantData=v,n.adamId=t.id
const g=Qe(e,t,hW,null==r?void 0:r.attributePlatformOverride)
n.bundleId=g,n.decorations=[]
let m=null
r&&r.clientIdentifierOverride&&(m=r.clientIdentifierOverride),n.icon=wf(e,t,{useCase:r.artworkUseCase,withJoeColorPlaceholder:r.useJoeColorIconPlaceholder,joeColorPlaceholderSelectionLogic:r.joeColorPlaceholderSelectionLogic,overrideTextColorKey:r.overrideArtworkTextColorKey},m,v,r.attributePlatformOverride),r&&r.titleObjectPath?n.title=Qe(e,t,r.titleObjectPath,null==r?void 0:r.attributePlatformOverride):n.title=j(t,cz),n.useAdsLocale=r.metricsOptions.isAdvert&&(0,Am.isSome)(e.bag.adsOverrideLanguage)
const y=ih(e,t,null==r?void 0:r.attributePlatformOverride)
y&&!r.shouldHideArcadeHeader&&(n.heading=r.metricsOptions.isAdvert?e.adsLoc.string(VD):e.loc.string(VD)),r.shouldShowFriendsPlayingShowcase&&n.decorations.push("showcaseFriendsPlaying")
const A=!y&&!p&&(null===(a=r.isMultilineTertiaryTitleAllowed)||void 0===a||a)
if(r.isSubtitleHidden||function(e,t,n){return ym.context("isBadgeMultilineFromData",()=>{if(!n)return!1
if(!Mf(0,t,!1))return!1
if($d(e,t))return!1
const r=kf(e,t)
return Nf(r,HW)||Nf(r,ZW)})}(e,t,A)||(n.subtitle=Ld(e,t,r)),n.tertiaryTitle=Md(e,t,A,r.hideCompatibilityBadge),n.tertiaryTitleAction=Fd(e,t),n.tertiaryTitleArtwork=null,n.developerTagline=Qe(e,t,Pq,null==r?void 0:r.attributePlatformOverride),n.editorialTagline=sh(e,t,TV,!1,null==r?void 0:r.attributePlatformOverride),n.editorialDescription=sh(e,t,rz,!1,null==r?void 0:r.attributePlatformOverride),n.shortEditorialDescription=sh(e,t,qV,!1,null==r?void 0:r.attributePlatformOverride),n.ageRating=sr(0,t,!0),n.productDescription=Qe(e,t,Sj,null==r?void 0:r.attributePlatformOverride),null!==(c=null==r?void 0:r.shouldShowSupportedPlatformLabel)&&void 0!==c&&c&&function(e,t,n,r){const o=kf(e,t),i=[OW,IW,cb,M$,"tv",VL],s=o.map(e=>uh(e)).filter(e=>e!==kN)
switch(n.tertiaryTitleIcons=i.filter(e=>s.includes(e)),n.tertiaryTitleIcons.length){case 1:const t=Qf(e,o[0])
n.tertiaryTitle=e.loc.string("Bundles.ProductPage.OnlyAvailable.Message").replace("@@platform@@",t),n.tertiaryIconPlacement=QW
break
case 2:const r=Qf(e,o[0]),i=Qf(e,o[1])
n.tertiaryTitle=e.loc.string("Bundles.ProductPage.AvailableOnTwo.Message").replace("@@platform1@@",r).replace("@@platform2@@",i),n.tertiaryIconPlacement=QW
break
case 6:n.tertiaryTitleIcons=[],n.tertiaryTitle=e.loc.string("Bundles.ProductPage.AvailableOnAll.Message")
break
default:n.tertiaryTitle=e.loc.string("Bundles.ProductPage.AvailableOnMore.Message"),n.tertiaryIconPlacement=MV}}(e,t,n),!ga(e,t)&&(q(t,pF)>0||!r||!r.hideZeroRatings)){n.rating=q(t,wF)
const o=q(t,pF),i=r.metricsOptions.isAdvert?e.bag.adsOverrideLanguage:null
n.ratingCount=e.loc.formattedCountForPreferredLocale(e,o,i)}const T=ea(e,t,r.metricsOptions,r.metricsClickOptions)
xh(e,T,n.title)
const b=gr(e,t,null==r?void 0:r.attributePlatformOverride),P=null!==(u=null==r?void 0:r.includeBetaApps)&&void 0!==u&&u,C=_h(e,t,n.icon,m),I=S(T),k=yr(e,b,t,p,P,C,I,kW,null==r?void 0:r.referrerData),O=l(b,HD)
let E=Pr(e,k,t,p,I,kW,m,r.shouldNavigateToProductPage)
const D=ot(e,t,v,Mx,w),R=Ut(0,t),_=!R||jt(t),L=_&&(null==D?void 0:D.length)>0,M=(null===(d=null==r?void 0:r.externalDeepLinkUrl)||void 0===d?void 0:d.length)>0
let F;(L||M)&&(F=L?D:r.externalDeepLinkUrl),(0,Am.isSome)(F)&&(E=ca(e,E,k.adamId,g,F,P,I),(null===(h=r.crossLinkSubtitle)||void 0===h?void 0:h.length)>0&&(n.crossLinkTitle=e.loc.uppercased(j(t,cz)),n.crossLinkSubtitle=r.crossLinkSubtitle)),n.buttonAction=E,n.includeBetaApps=P,n.developerName=j(t,eq),(0,Am.isNothing)(n.developerName)&&(n.developerName=j(t,kS)),n.children=Rd(e,t,r),(0,Am.isSome)(i)&&i(),Bh(r.metricsOptions.locationTracker)
const $=zo(e,t,m)
if($){const t=new Pz,r=S(T)
r.actionType=QB,r.targetType=KW,ra(e,t,r)
const o=new OJ
o.shareAction=t,o.shareSheetData=$,n.contextMenuData=o}const x=null!=o?o:af(e,t)
let N=!1
x&&(N=!(br(0,gr(e,x))>0))
const B=Od(0,t.type,y)
n.offerDisplayProperties=r?xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,r.offerStyle,r.offerEnvironment,O[0],N,kW,r.shouldNavigateToProductPage,r.metricsOptions.isAdvert,0,r.parentAppData,r.isBuyDisallowed):xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,null,null,O[0],N,kW),r&&r.skipDefaultClickAction||(n.clickAction=Xd(e,t,T,{clientIdentifierOverride:m,productVariantData:v,isCppDeepLinkEligible:_})),r&&r.ordinal&&(n.ordinal=r.ordinal)
const U=Ke(e,t,dj,null==r?void 0:r.attributePlatformOverride)
if(U){const e=f(U,vF),t=e&&e===gF
n.isEditorsChoice=t}R||(n.flowPreviewActionsConfiguration=la(e,t,!1,m,n.clickAction,r.metricsOptions,T,r.externalDeepLinkUrl,n.subtitle,n.title))
const G=Xh(e,t,n,C,r.metricsOptions,r.canDisplayArcadeOfferButton)
Jh(e,n,G)})}function Rd(e,t,n){const r=fe(t,az)
return r?zd(e,r,{lockupOptions:{...n,shouldCreateScreenshotsLockup:null==n?void 0:n.shouldIncludeScreenshotsForChildren},filter:Im.None}):null}function _d(e,t,n,r,s,a){var c
if(!t)return
if(s.isNetworkConstrained)return
const l=null!==(c=s.metricsOptions.isAdvert)&&void 0!==c&&c
ym.context("copyMediaIntoMixedMediaLockup",()=>{n.screenshots=Sf(e,t,R3.LockupScreenshots,null,s.clientIdentifierOverride,null,l,a)
const c=n.screenshots[0]
n.trailers=[]
const u=Af(e,t,r,s.metricsOptions,n.adamId,l,a)
i(u)&&(o(c)||u.mediaPlatform.isEqualTo(c.mediaPlatform))&&n.trailers.push(u)})}function Ld(e,t,n=null){if(!(0,Am.isNothing)(t))return ym.context("subtitleFromData",()=>{let r
return n&&n.subtitleObjectPath&&(r=Qe(e,t,n.subtitleObjectPath,null==n?void 0:n.attributePlatformOverride)),o(r)&&(r=Qe(e,t,Pq,null==n?void 0:n.attributePlatformOverride)),r||xd(e,t,n)})}function Md(e,t,n=!1,r){return ym.context("badgeFromData",()=>{if(r)return null
const o=Mf(0,t,!1)
if(o){let r=""
const i=kf(e,t)
if(Nf(i,HW)?r="Platform.DesignedForPad":Nf(i,ZW)&&(r="Platform.DesignedForPhone"),(null==r?void 0:r.length)>0)return o&&($d(e,t)||(r+=".NotVerified",n&&(r+=".Expanded"))),e.loc.string(r)}return null})}function Fd(e,t){return ym.context("badgeActionFromData",()=>{if(!Mf(0,t,!1))return null
if($d(e,t))return null
const n=kf(e,t)
if(!Nf(n,HW)&&!Nf(n,ZW))return null
const r=new _J(vW)
return r.pageUrl=`https://apps.apple.com/story/id${e.bag.appleSiliconMacUnverifiedBadgeEditorialItemId}`,r})}function $d(e,t){return!e.appleSilicon.isSupportEnabled||Xe(e,t,YD,AW)}function xd(e,t,n=null){return ym.context("categoryFromData",()=>{const r=Qe(e,t,KV,null==n?void 0:n.attributePlatformOverride)
if((0,Am.isSome)(r)&&(null==r?void 0:r.length)>0)return r
const o=we(t,SB)
if((0,Am.isSome)(o)&&(null==o?void 0:o.length)>0){let e=o[0]
const t=zZ.Games.toString()
if(e.id===t)for(const n of o){const r=j(n,AF)
if(n.id!==t&&r===t){e=n
break}}return j(e,cz)}{const e=G(t,JD)
return e.length>0?e[0]:void 0}})}function Nd(e,t,n){return ym.context("lockupFromData",()=>{var r,i,s,a,c,l,u,d
if(!t)return ym.unexpectedNull(gq,RV),null
const h=Ut(0,t)
n.metricsOptions.isAdvert=h
const p=cn(e,null===(i=null===(r=n.metricsOptions.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===i?void 0:i.placementType,n.metricsOptions.locationTracker,!0)
if(n.metricsOptions.isAdEligible=p,(h||p)&&(null===(a=null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a||a.apply(e,t)),h&&(null===(l=null===(c=n.metricsOptions.pageInformation)||void 0===c?void 0:c.adPageInfo)||void 0===l||l.setTemplateType(e,zG)),!W(t))return null
switch(t.type){case jq:return n.offerEnvironment=ES,Bd(e,t,n)
case tz:const r=pe(e,t,VW)
if(o(r))return null
const i=new DJ
return Dd(e,r,i,n),i
case fH:case $H:return function(e,t,n){return ym.context("appPromotionOfferLockupFromData",()=>{var r,o,i
const s=null!==(r=af(e,t))&&void 0!==r?r:n.parentAppData,a=of(e,t)
if(H(s,VN)){const r=Bd(e,t,n)
if((0,Am.isNothing)(r))return null
r.offerDisplayProperties.titles[rz]=e.loc.string(DS),r.offerDisplayProperties.isStreamlinedBuy=!0,r.offerDisplayProperties.hasDiscount=!1
const o=B(a,XW),i=hi(e,s,XW),c=df(e,o,{useCase:n.artworkUseCase,withJoeColorPlaceholder:n.useJoeColorIconPlaceholder,style:qG,overrideTextColorKey:n.overrideArtworkTextColorKey})
return r.icon=null!=c?c:i,r}{const r=new DJ
Dd(e,s,r,n)
const c=ea(e,t,n.metricsOptions,n.metricsClickOptions)
xh(e,c,r.title)
const l=Qe(e,s,hW),u=j(a,Yj),d=j(s,OS),h=new FJ(u,s.id,l,r.buttonAction,d)
if(h.appTitle=null!==(o=j(s,cz))&&void 0!==o?o:"",h.productTitle=null!==(i=j(a,cz))&&void 0!==i?i:"",t.type===$H){const e=f(sf(a),zD);(0,Am.isSome)(e)&&e.length>0&&(h.additionalBuyParams="adHocOfferId="+e)}else h.additionalBuyParams="contingentItemId="+t.id
return r.buttonAction=h,Bh(n.metricsOptions.locationTracker),r}})}(e,t,n)
default:const s=new DJ
return Dd(e,t,s,n),(0,Am.isSome)(null===(u=n.metricsOptions.pageInformation)||void 0===u?void 0:u.adPageInfo)&&((h||p)&&Gt(e,t,s,n.metricsOptions,!0),h&&(null===(d=s.searchAdOpportunity)||void 0===d||d.setTemplateType(zG))),s}})}function Bd(e,t,n){return ym.context("inAppPurchaseLockupFromData",()=>function(e,t,n){return t?ym.context("makeInAppPurchaseLockup",()=>{var r
const o=null!==(r=af(e,t))&&void 0!==r?r:n.parentAppData
if((0,Am.isNothing)(o))return null
const i=H(o,VN),a=of(e,t)
if((0,Am.isNothing)(a))return null
t=a
const c=new RJ
Dd(e,t,c,n,o),c.productIdentifier=j(t,Yj),c.parent=Nd(e,o,n),c.description=j(t,Sj),c.isVisibleByDefault=H(t,"isMerchandisedVisibleByDefault"),c.isSubscription=H(t,mF)
const u=gr(e,t),d=l(u,HD)
c.offerDisplayProperties&&(c.offerDisplayProperties.hasDiscount=d.length>0,c.offerDisplayProperties.subscriptionFamilyId=j(t,"subscriptionFamilyId"))
const h=new _J(qD)
h.presentationContext=$V
const p=function(e,t,n){const r=(new eZ).param(Hz.id,n).param(qz,t).build()
return`${Cz}:/${_z.product}/${_z.install}/?${r}`}(0,c.adamId,o.id)
h.pageUrl=p
const w=new MJ
w.parentLockup=S(c.parent),w.lockup=S(c),w.preInstallOfferDescription=Ko(e,u),h.pageData=w
const v=j(t,Yj),g=Qe(e,o,hW),m=j(o,OS),y=s(sf(t)),A=Xh(e,t,c,qG,n.metricsOptions,n.canDisplayArcadeOfferButton)
if(xh(e,A,c.title),i&&y){const r=new FJ(v,o.id,g,c.parent.buttonAction)
c.parent&&(r.appTitle=c.parent.title),r.productTitle=c.title,r.streamlineBuyAction=function(e,t,n,r,o){var i
const a={...o.metricsOptions,id:n.id,targetId:n.id,idType:yW,actionDetails:{parentAdamId:n.id}},c=_h(e,t,r.icon,o.clientIdentifierOverride),l=S(a),u=sf(t),d=gr(e,t),h=gr(e,n),p=new uZ(f(h,pV))
let w=null!==(i=f(u,pV))&&void 0!==i?i:f(d,pV)
w+=`&appAdamId=${f(n,"id")}`,w+=`&appExtVrsId=${p.get(yF,"")}`,w+=`&bid=${Qe(e,n,hW)}`,w+="&bvrs=1.0",w+=`&offerName=${Qe(e,t,Yj)}`
const v=f(u,zD)
return s(v)&&(w+=`&adHocOfferId=${v}`),d[pV]=w,yr(e,d,t,!1,!1,c,l,kW,null==o?void 0:o.referrerData,!1,n.id)}(e,t,o,c,n),c.buttonAction=r,c.subtitle=j(o,cz)}else if(m){const t=new FJ(v,o.id,g,h,m)
c.parent&&(t.appTitle=c.parent.title),t.productTitle=c.title
const r={...n.metricsOptions,id:c.adamId,idType:yW,actionDetails:{parentAdamId:o.id}}
ra(e,t,r),c.buttonAction=t}else{const t=new $J(kW)
t.title=e.loc.string("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),t.message="",t.isCancelable=!0,c.buttonAction=t}if(Bh(n.metricsOptions.locationTracker),!n||!n.skipDefaultClickAction){const n=Kd(e,t,A)
c.clickAction=n,c.productAction=n}return function(e,t,n){t&&(t.impressionMetrics||Jh(e,t,n),t.parent&&t.parent.adamId&&(0,mm.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields.parentAdamId=kh(t.parent.adamId)))}(e,c,A),c},WD):null}(e,t,n))}function Ud(e,t,n){return ym.context("screenshotsLockupFromData",()=>{const r=new xJ
return function(e,t,n,r){t&&ym.context("copyDataIntoScreenshotsLockup",()=>{Dd(e,t,n,r),n.screenshots=Sf(e,t,R3.LockupScreenshots,null,r.clientIdentifierOverride)})}(e,t,r,n),r})}function Gd(e,t,n){return ym.context("posterLockupFromData",()=>{const o=new NJ
return function(e,t,n,o){t&&ym.context("copyDataIntoPosterLockup",()=>{Dd(e,t,n,o),n.epicHeading=function(e,t){const n=Ke(e,t,"editorialArtwork.epicHeading")
if(i(n)&&i("bb"))return df(e,n,{cropCode:"bb",useCase:R3.Default})}(e,t),n.posterArtwork=function(e,t){const n=Ke(e,t,"editorialArtwork.postCard")
if(i(n))return df(e,n,{cropCode:"sr",useCase:R3.Default,withJoeColorPlaceholder:!0})}(e,t),n.posterVideo=function(e,t,n){const o=Ke(e,t,[TW,sb]),i=df(e,Ke(e,t,[TW,sb,Dj]),{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if((0,Am.isSome)(o),(0,Am.isSome)(i)){const e=f(o,Xq)
if(r(e))return
return new wY(e,i,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},autoPlayPlaybackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}})}}(e,t,R3.GroupingHero),n.offerDisplayProperties&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,lW,hG)),n.posterVideo?n.isDark=be(n.posterVideo.preview.backgroundColor):n.posterArtwork?n.isDark=be(n.posterArtwork.backgroundColor):n.isDark=!1
const s=Xe(e,t,_j)
if(Xe(e,t,uW)){const r=s?e.loc.string("Offer.Label.ComingSoon"):null
let o
o=e.loc.uppercased(vh(e,t,r)),(0,Am.isSome)(o)&&(n.footerText=o)}})}(e,t,o,n),o})}function jd(e,t,n,r,o=null,i){return ym.context("mixedMediaLockupFromData",()=>{var s,a,c
const l=new UJ
if(Dd(e,t,l,n,null,()=>{Ed(e,t,l,o,n),_d(e,t,l,r,n,i),Hd(e,t,l,o)}),(0,Am.isSome)(null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)){const r=cn(e,null===(c=null===(a=n.metricsOptions.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,n.metricsOptions.locationTracker,!0,o)
n.metricsOptions.isAdEligible=r,r&&Gt(e,t,l,n.metricsOptions,!0)}return l})}function Vd(e,t,n,r){const o=t.type===YW?pe(e,t,vq):t,i=Nd(e,o,n),s=tt(e,o),a=Sd(e,o,r),c=Sd(e,t,r),l=null==a?void 0:a.artwork,u=null==c?void 0:c.artwork
let d,f
if((0,Am.isSome)(u),(0,Am.isSome)(l)&&(f=Ad(0,a),d=l),(0,Am.isSome)(d)&&(0,Am.isSome)(i)){const e=new GJ(d,i,null,null,f)
return e.caption=ce(o,s,cj),(0,Am.isSome)(e.caption),e.title=ce(o,s,iH)||j(o,KV),e.impressionMetrics=i.impressionMetrics,e}return null}function Hd(e,t,n,r){var o
if(!e.client.isPhone)return
const s=f(t.meta,"imageLockupFromData")
i(s)?n.screenshotsDisplayStyle=s:i(null===(o=null==r?void 0:r.displayStyle)||void 0===o?void 0:o.screenshots)&&(n.screenshotsDisplayStyle=r.displayStyle.screenshots)}function qd(e,t,n,r,o,i=!0,s){return ym.context("mixedMediaAdLockupFromData",()=>{const a=new UJ
return H(t,"iad.format.images")?(_d(e,t,a,r,n),function(e,t,n,r){var o
if(!function(e,t){const n=function(e,t,n){const r=Ge(e,t)
if(!(0,Am.isNothing)(r))return Ye(r,n)}(e,t,hF)
return!n}(e,t))return
const i=G(t,"iad.assetOverride")
if(i.length){const e=function(e,t,n){const r=new Set(n),o=[],i=[],s=function(e,t){if(0===r.size)return!1
for(const o of n)if(o===t||-1!==e.indexOf(o))return r.delete(o),!0
return!1}
if(n.length&&(t.screenshots.length||t.trailers.length)){if(t.trailers.length)for(const e of t.trailers[0].videos)s(e.videoUrl,e.preview.checksum)&&o.push(e)
if(t.screenshots.length)for(const e of t.screenshots[0].artwork)s(e.template,e.checksum)&&i.push(e)}return!(0!==r.size||!o.length&&!i.length||(t.trailers.length&&(t.trailers[0].videos=o),t.screenshots.length&&(t.screenshots[0]=new mY(i,t.screenshots[0].mediaPlatform)),0))}(0,n,i)
if(r.pageInformation.adPageInfo&&r.pageInformation.adPageInfo.adIsPresent){r.pageInformation.adPageInfo.setSpecifiedCreativeUsed(e)
const t=null!==(o=r.adsMetricsData)&&void 0!==o?o:{}
t[bS]=e,r.adsMetricsData=t}}}(e,t,a,n.metricsOptions),Dd(e,t,a,n,null,()=>{Hd(e,t,a,o),Ed(e,t,a,o,n)})):(Dd(e,t,a,n,null,()=>{Ed(e,t,a,o,n)}),a.screenshots=[]),Gt(e,t,a,n.metricsOptions,i,s),a})}function Wd(e,t,n,r,i,s){return ym.context("arcadeLockupFromData",()=>{const a=t.marketingItemData,c=new jJ
c.title=e.loc.string("ARCADE_LOCKUP_TITLE","Apple Arcade")
const l=t.marketingItemData
n={...n,mercuryMetricsData:Lh(0,l)}
let u,d=Qc(0,a);(null==d?void 0:d.length)>0&&(d=d.replace(/\n/g," "),c.nonsubscribedSubtitle=d,c.subscribedSubtitle=d)
const f=Zc(0,a)
u=el(e,t.marketingItemData,r,n),u.title=f,c.unsubscribedButtonAction=u
const h=ao(0,n.pageInformation,n.locationTracker)
h.title=e.loc.string(EU,DU),c.subscribedButtonAction=h
const p=ep(e,t.marketingItemData,c.title,n)
p.displaysArcadeUpsell=!0,o(p.targetType)&&(p.targetType=KW),Jh(e,c,p)
const w=new VJ(nz,e.bag.arcadeAppAdamId,null,i,null,s,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
return w.titles[mG]=e.loc.string(EU,DU),c.offerDisplayProperties=w,c})}function zd(e,t,n){return r(t)?[]:Yd(e,t.data,n)}function Yd(e,t,n){return ym.context("lockupsFromData",()=>{var o
if(!t)return[]
const s=[]
let a=!1
for(let c=0;c<t.length&&!a;c++){const l=t[c]
if(!W(l)){n.contentUnavailable&&(a=n.contentUnavailable(c,l))
continue}const u=n.lockupOptions
let d=Im.All
if(n.includeOrdinals){const r=n.ordinalDirection===RS?t.length-c:c+1
u.ordinal=e.loc.decimal(r).toString()}if(i(n.filter)&&(d=n.filter),st(e,l,d)&&!n.shouldShowOnUnsupportedPlatform)continue
const f=null!==(o=n.lockupOptions.shouldCreateScreenshotsLockup)&&void 0!==o&&o?Ud(e,l,u):Nd(e,l,u)
!r(f)&&f.isValid()&&(n.shelfTokenId&&(f.id=lf(n.shelfTokenId,Uh(n.lockupOptions.metricsOptions.locationTracker),f.adamId)),s.push(f),Vh(n.lockupOptions.metricsOptions.locationTracker))}return s})}function Jd(e,t,n,r,s=null,a){return ym.context(`actionFromData: ${t.type}`,()=>{switch(t.type){case az:case JW:return Xd(e,t,n,{clientIdentifierOverride:r,externalDeepLinkUrl:s,isCppDeepLinkEligible:a})
case jq:return Kd(e,t,n)
case YW:return Qd(e,t,n,r)
case CH:case Wq:return function(e,t,n){return t?ym.context("editorialPageActionFromData",()=>{const r=new _J(fz)
{const n=t.href
if(o(n))return ym.unexpectedNull(gq,$W,uj),null
r.pageUrl=ji(e,n)}return r.title=ah(e,t,cz),o(r.title)&&(r.title=j(t,cz)),ra(e,r,n),r}):null}(e,t,n)
case TF:return function(e,t,n){return t?ym.context("msoActionFromPlatformData",()=>{const r=j(t,BW)
if(!r)return ym.unexpectedNull(gq,$W,BW),null
const o=new _J(AB)
return o.pageUrl=r,o.title=j(t,cz),ra(e,o,n),o}):null}(e,t,n)
case SH:return function(e,t,n){return t?ym.context("groupingActionFromData",()=>{if(!t.href)return ym.unexpectedNull(gq,$W,uj),null
const r=new _J(fz)
return r.pageUrl=ge(e,function(e,t){const n=[RW,TW,XH,tq,yq,gH]
e.appleSilicon.isSupportEnabled&&n.push(bq),e.bag.enableUpdatedAgeRatings&&n.push(bW),vf(e)&&n.push(Tq)
const r=new cJ(e,t).includingAttributes(n).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported()
li(e)&&(r.enablingFeature(Uq),r.includingScopedAttributes(tz,eQ),r.includingScopedRelationships(tz,[VW]),r.includingScopedRelationships(ET,[tz]))
const o=ne(e)
return i(o)&&r.addingQuery(Oj,o),r}(e,t.href)).toString(),r.title=nf(0,t),ra(e,r,n),r}):null}(e,t,n)
default:return function(e,t,n){return t?ym.context("genericActionFromData",()=>{const r=f(t,IH),o=j(t,BW)
if(!o)return ym.unexpectedNull(gq,$W,BW),null
const i=new _J(fz)
return i.pageUrl=o,i.title=r===SH?nf(0,t):j(t,cz),ra(e,i,n),i}):null}(e,t,n)}})}function Kd(e,t,n){return ym.context("iAPActionFromData",()=>{var r
const o=af(e,t)
if(!o)return null
const s=new _J(fq),a=oY.from(j(o,BW)),c=Ve(null!==(r=n.productVariantData)&&void 0!==r?r:Ge(e,o))
i(c)&&a.param(Hz.productVariantID,c)
const l=a.toString(),u=j(t,Yj),d=H(t,mF)
return s.pageUrl=function(e,t,n,r){const o=(new eZ).param(Wz,t).param(Hz.offerName,n).param(zz,r.toString()).build()
return`${Cz}:/${_z.product}/${_z.lookup}/?${o}`}(0,l,u,d),s.title=j(t,cz),ra(e,s,n),s})}function Zd(e,t){return o(t)?C3:ym.context(_S,()=>{if(function(e){const t=f(e,ox)
return t&&t===vM}(B(t,EW)))return I3
const e=j(t,LS),n="List"===e||"NumberedList"===e
if(H(t,tG)||n)return k3
const r=we(t,vq),o=we(t,Sq),i=s(r)&&1===r.length,a=s(o)&&1===o.length
return a&&o[0].type===tz||i&&r[0].type===tz?E3:a?O3:C3})}function Qd(e,t,n,a,c,l){return o(t)?null:ym.context(_S,()=>{var u
let d,h,p
switch(Zd(0,t)){case I3:return function(e,t,n){return ym.context("editorialItemExternalLinkActionFromData",()=>{const r=f(B(t,EW),BW),o=new HJ(r),i=sh(e,t,qV)
if(i)o.title=i
else{const e=new oY(r)
o.title=e.host}return ra(e,o,n),o})}(e,t,n)
case k3:d=vW
const p=oY.from(j(t,BW))
i(c)&&p.param(Hz.recoMetrics,JSON.stringify(c)),(0,Am.isSome)(l)&&!l.isHorizontalShelfContext&&p.param(Hz.todayCardConfig,JSON.stringify(l))
const w=null===(u=N(t))||void 0===u?void 0:u.id;(0,Am.isSome)(w)&&p.param(Hz.editorialCardId,w),h=p.build()
break
case O3:const v=we(t,Sq)[0]
return Jd(e,v,n,a)
case E3:const g=we(t,vq),m=s(g)&&1===g.length?g[0]:we(t,Sq)[0],y=pe(e,m,VW)
if(o(y))return null
const A=Ai(e,m,y,!1,!1,MW,_q,!1,n,!1,!0,null,!1,!1)
return r(A)||A instanceof Date?null:gi(e,m,y,A,n,!0)
case D3:d=fz,h=ji(e,t.href)
break
default:d=GW,h=f(B(t,EW),BW)}if((0,Am.isNothing)(h))return null
const w=new _J(d)
w.pageUrl=h,(0,Am.isSome)(p)&&(w.presentation=p)
let v=sh(e,t,cz)
return r(v)&&(v=f(t,Gq)),w.title=v,ra(e,w,n),w})}function Xd(e,t,n,r){var o,s,a,c
if(!t)return null
const l=null!==(o=r.clientIdentifierOverride)&&void 0!==o?o:null,u=null!==(s=r.externalDeepLinkUrl)&&void 0!==s?s:null,d=!(null!==(a=r.isCppDeepLinkEligible)&&void 0!==a&&a),h=null!==(c=r.productVariantData)&&void 0!==c?c:Ge(e,t)
return ym.context("productActionFromData",()=>{var r,o,s,a
let c=j(t,BW)
if(!c)return ym.unexpectedNull(gq,$W,BW),null
let p={}
const w=new oY(c)
if(n.isAdvert){const i=f(t,MS);(0,Am.isSome)(i)&&i.length>0&&w.param(sZ,i)
const s={...null===(o=null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===o?void 0:o.clickFields}
Object.assign(s,n.adsMetricsData),w.param(iZ,JSON.stringify(s)),p={iAdClickFields:y(s),iAdLineItem:i}
const a=fn(0,t)
if((0,Am.isSome)(a)){const r=ih(e,t)?OU:dF,o=Yt(0,n.pageInformation),i=j(t,fF),s=H(t,uW)?HH:rz,c=new zJ(a,t.id,i,r,"productPageDismissed",s,o)
w.param(aZ,JSON.stringify(c)),p.iAdDismissAdActionMetrics=y(c)}}const v=Ve(h)
i(v)&&w.param(Hz.productVariantID,v),p.externalDeepLinkUrl=u,i(u)&&w.param(i2,u),mu(e).platform,ef(e,t)
{p.isCppDeepLinkDisabled=d,w.param(s2,d.toString())
const e=null===(a=null===(s=n.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term;(0,Am.isSome)(e)&&w.param(Hq,e),p.clientIdentifierOverride=l,(null==l?void 0:l.length)>0&&w.param(FS,l)}c=w.toString()
const g=new _J(fq)
g.pageUrl=c,g.pageData=hd(e,t,p),g.title=j(t,cz),n&&n.pageInformation&&(g.referrerUrl=n.pageInformation.pageUrl)
const m=H(t,uW)
ra(e,g,m?{...n,offerType:HH,offerReleaseDate:Tr(0,t)}:n,!0)
const A=f(t,"id")
return(0,Am.isSome)(A)&&(g.destination=t.type===JW?function(e){const{id:t,platform:n,lic:r,...o}=e
return{$kind:"BundlePageIntent",id:ut(t),platform:lt(n),lic:r,...o}}({...$i(e),id:A}):function(e){const{id:t,platform:n,ppid:r,lic:o,...i}=e
return{...i,$kind:"ProductPageIntent",id:ut(t),platform:lt(n),ppid:r,lic:o}}({...$i(e),platform:tf(e,t),id:A})),g})}function ef(e,t){try{return function(e,t){const n=(0,Am.unwrapOptional)(mt(e,t)),r=new Set(xe(e,n,!0))
if(r.has(OW))return OW
if(r.has(IW))return IW
if(r.has(iz))return iz
if(r.has(zH))return zW
if(r.has(Vj))return"tv"
if(r.has(oz))return oz
throw new Error("Could not infer platform from device families")}(e,{data:[t]})}catch(t){return void e.console.error(`Error inferring preview platform from data: ${t}`)}}function tf(e,t){return mu(e).platform||ef(e,t)}function nf(e,t){const n=G(t,JD)
return s(n)?n[0]:j(t,cz)}function rf(e,t){if(!t)return!1
if(e.client.isCompanionVisionApp)return!0
const n=function(e,t,n){return Qe(e,t,Mf(0,t,n)?bq:tq)}(e,t,e.appleSilicon.isSupportEnabled)
if(o(n))return!0
const r=n.split(" ")
return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(r,!1)}function of(e,t){if(!t)return null
switch(t.type){case fH:return pe(e,t,ZU)
case $H:return pe(e,t,QU)}return t}function sf(e){if(!e)return null
const t=p(e,MN)
if(s(t))return t
const n=p(e,ZL)
return s(n)?n:null}function af(e,t){if(!t)return null
switch(t.type){case fH:return pe(e,t,J$)
case $H:const n=pe(e,t,QU)
return pe(e,n,VW)}return pe(e,t,VW)}function cf(e,t){t.bag.arcadeDownloadPacksMetricsEventsEnabled||(e.clickAction.actionMetrics.clearAll(),e.buttonAction.actionMetrics.clearAll(),wt(e.buttonAction)&&e.buttonAction.defaultAction.actionMetrics.clearAll()),t.bag.arcadeDownloadPacksImpressionEventsEnabled||(e.impressionMetrics=null)}function lf(e,t,n){if(!(0,Am.isNothing)(n)&&!(0,Am.isNothing)(e))return`${e}_${t}_${n}`}function uf(e,t){switch(t){case QN:case WE:case mW:return R3.LockupIconSmall
case Kq:return R3.LockupIconMedium
case hU:return R3.LockupIconLarge
default:return R3.Default}}function df(e,t,n){return ym.context("artworkFromApiArtwork",()=>{var o,s,a
const c=!!i(n.allowingTransparency)&&n.allowingTransparency,l=!!i(n.withJoeColorPlaceholder)&&n.withJoeColorPlaceholder,d=f(t,BW)
if(r(d))return
const p=u(t,"hasP3"),w=[It(e,c,p,n.useCase)]
u(t,"supportsLayeredImage")
let v=null
if(c)v=Se(Ej)
else if(l){const e=yh(t),i=ye(null!==(s=null===(o=n.joeColorPlaceholderSelectionLogic)||void 0===o?void 0:o.call(n,e))&&void 0!==s?s:f(t,Jj))
r(i)||(v=i)}r(v)&&(v=Se(zE))
const g=null!==(a=n.overrideTextColorKey)&&void 0!==a?a:kM,m=ye(f(t,g)),y=n.overrideWidth||h(t,rG),A=n.overrideHeight||h(t,nj)
if((0,Am.isNothing)(y)||(0,Am.isNothing)(A))return
const T=new dY(d,y,A,w)
return T.backgroundColor=v,T.checksum=f(t,YE),i(m)&&(T.textColor=m),i(n.style)&&(T.style=n.style),i(n.cropCode)&&(T.crop=n.cropCode),i(n.contentMode)&&(T.contentMode=n.contentMode),T})}function ff(e,t,n,r){return ym.context(YT,()=>{const o=wf(e,t,r),i=j(t,cz)
if((0,Am.isNothing)(o))return
const s=new fY(o),a=ep(e,t,null!=i?i:t.id,n)
return Jh(e,s,a),s})}function hf(e,t,n,r){return ym.context(YT,()=>{const i=[]
o(n.targetType)&&(n.targetType=XW)
for(const o of t){const t=ff(e,o,n,r)
t&&(i.push(t),Vh(n.locationTracker))}return i})}function pf(e,t,n,r){const o=Ke(e,t,"editorialArtwork.searchCategoryBrick")
if((0,Am.isNothing)(o))return
let i=r
n===hy.seeAllPage&&(i=Sm.Density1)
let s=[],a=[]
switch(i){case Sm.Density1:const e=n===hy.categoryBreakout?"1191":"2350"
o[rG]=e,o[nj]=OM,s=[JT,"SCB.ApSCBL03"],a=[Pm.right,Pm.left]
break
case Sm.Density2:o[rG]="2482",o[nj]=OM,s=["SCB.ApSCBS01","SCB.ApSCBS02"],a=[Pm.left,Pm.right]
break
case Sm.Density3:o[rG]=OM,o[nj]=OM,s=["cc"],a=[Pm.scaleAspectFit]}return s.map((t,n)=>df(e,o,{cropCode:t,contentMode:a[n],useCase:R3.Default,withJoeColorPlaceholder:!0})).filter(Am.isSome)}function wf(e,t,n,o,s,a){return ym.context("iconFromData",()=>{if(!t)return void ym.unexpectedNull(gq,RV)
const c=null!=a?a:mf(e,t,o),l=gf(e,t),u=o||e.host.clientIdentifier,d=function(e,t,n,r,o,i){if(r!==nJ&&!Xe(e,t,Tj))return null
if(o){const r=se(t,i,KT)
if((0,Am.isSome)(r))return df(e,r,{...n,style:EM,cropCode:"bb",withJoeColorPlaceholder:!0})}const s=se(t,i,JE)
if((0,Am.isSome)(s)){const t=o?EM:wx,r=o?"ic":void 0
return df(e,s,{...n,style:t,cropCode:r,withJoeColorPlaceholder:!0})}return null}(e,t,n,u,l,c)
if((0,Am.isSome)(d))return d
const f=function(e,t,n,r,o){const s=nh(e,t),a=eh(e,t)&&(r===rJ||s),c=se(t,o,KE)
return a&&i(c)?df(e,c,{...n,style:XN}):null}(e,t,n,u,c)
if((0,Am.isSome)(f))return f
const h=function(e,t,n){if(t.type!==jq)return null
const r=B(t,XW)
return(0,Am.isSome)(r)?df(e,r,{...n,style:qG}):null}(e,t,n)
if((0,Am.isSome)(h))return h
const p=function(e,t,n,r){if(t.type!==JW)return null
const o=Ke(e,t,"editorialArtwork.appBundleStatic1x1")
if((0,Am.isSome)(o))return df(e,o,{...n,style:vx,cropCode:"bb"})
const i=B(t,XW)
if((0,Am.isSome)(i)){const t=r?DM:aU
return df(e,i,{...n,style:t,allowingTransparency:!0})}return null}(e,t,n,l)
if((0,Am.isSome)(p))return p
r(s)&&(s=Ge(e,t))
const w=rt(e,t,s,XW,c),v=function(e,t,n,r,o){if(o===WV||r===iJ)return df(e,t,{...n,style:RM})}(e,w,n,u,c)
if((0,Am.isSome)(v))return v
const g=function(e,t,n,r,o){if(o===ZH||r===_Y)return df(e,t,{...n,style:wx})}(e,w,n,u,c)
return(0,Am.isSome)(g)?g:function(e,t,n,r,o,i,s){const a=s===rq,c=a&&!0,l=vx
if(o){const n=rt(e,t,i,Tq,s)
if((0,Am.isSome)(n))return df(e,n,{...r,style:l,cropCode:"bb",allowingTransparency:c})}let u,d
return o?(u=l,d=a?"ib":"ia"):(u=a?eB:aU,d="bb"),df(e,n,{...r,style:u,cropCode:d,allowingTransparency:c})}(e,t,w,n,l,s,c)})}function vf(e){return lr(e,e.bag.iconArtworkRolloutRate)&&e.bag.enableIconArtwork&&!0}function gf(e,t){const n=t.type===JW,r=kf(e,t),o=e.bag.enableIPadOnlyFallbackIcons&&-1!==r.indexOf(HW)&&-1===r.indexOf(ZW)
return vf(e)&&!o&&(!n||!1)}function mf(e,t,n){switch(n){case nJ:case rJ:return AW
case iJ:return WV
case _Y:return ZH
default:return tt(e,t,n)}}function yf(e,t,n,r){const o=uh(t),i=dh(0,n),s=function(e,t){switch(t){case MM:return 13/X3.width
case LM:return 11/e9.width
case _M:return 5.5/t9.width
case gx:return g9/n9.width
case mx:return g9/r9.width
default:return}}(0,n),a=function(e,t){switch(t){case MM:return 30/X3.width
case gx:return v9/n9.width
case mx:return v9/r9.width
default:return dh(0,t)}}(0,n)
return new hY(t,n,o,r,i,s,a)}function Af(e,t,n,r,o,i=!1,s){const a=Tf(e,t,n,void 0,void 0,i,s)
if(!a)return
const c=a.videos,l=[]
if(c&&c.length>0)for(const t of c)yo(e,t,{...r,id:o}),l.push(t)
let u
return l.length>0&&(u=new pY,u.videos=l,u.mediaPlatform=a.mediaPlatform),u}function Tf(e,t,n,r,o,s=!1,a){return ym.context("platformVideoPreviewFromData",()=>{if((0,Am.isNothing)(o)&&(o=Ge(e,t)),(0,Am.isNothing)(o))return
const c=function(e,t,n,r,o){return rt(e,t,n,r?nD:mV,void 0)}(e,t,o,s),u={}
if(!c)return
let d=If(e,t,e.host.clientIdentifier,e.client.deviceType)
if(i(r)){const e=[]
for(const t of d)r.includes(t)&&e.push(t)
d=e}if(0!==d.length)for(const t of d){const r=Vf(e,t,e.client.screenSize)
for(const t of Object.keys(c)){const r=l(c,t),o=[]
for(const i of r){const r=p(i,Dj)
if(!r){ym.unexpectedNull(gq,vH,`videoPreviewsByType.${t}.previewFrame`)
continue}const s=f(i,Xq)
if(!s){ym.unexpectedNull(gq,$W,`videoPreviewsByType.${t}.video`)
continue}const c=f(r,BW)
let l;(0,Am.isSome)(c)&&(l=kt(e,c,h(r,rG),h(r,nj),null,null,f(r,YE)),(0,Am.isSome)(a)&&(l.crop=a),o.push(new wY(s,l,n)))}u[t]=o}for(const e of r)if(u[e]){const n=yf(0,t,e)
if((0,Am.isSome)(n))return new L3(u[e],n)}}})}function bf(e,t){return ym.context("videoPreviewsFromApiPlatformData",()=>{const n=Tf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
return n?n.videos:[]})}function Sf(e,t,n,r=[],o,i,s=!1,a){return ym.context("screenshotsFromData",()=>{const c=[]
if((0,Am.isNothing)(i)&&(i=Ge(e,t)),(0,Am.isNothing)(i))return[]
let l=r
if(!l||0===l.length){const n=o||e.host.clientIdentifier
let r=e.client.deviceType
n===nJ&&(r=oz),o!==_Y&&o!==RY||(r=zW),l=If(e,t,n,r)}for(const r of l){const o=[]
let l
if(r===eW?(l=rh(e,t,AW),th(e,t,AW)&&o.push("faceTime")):l="tv"===r?oh(e,t,i,s,WV):r===zW?oh(e,t,i,s,ZH):r===iz?oh(e,t,i,s,rq):oh(e,t,i,s),!l)continue
const u=Cf(e,l,r,n,o,a)
u&&c.push(u)}return c})}function Pf(e,t,n,r=[],o,i){return function(e,t,n){const r=[]
if(n&&n.length>0){const o=n.map(e=>e.mediaPlatform)
for(const i of n){const n=[]
for(const e of i.artwork){const t=new vY
t.screenshot=e,n.push(t)}const s=i.mediaPlatform,a=new gY(n,s,o,_f(e,s),Ef(e,t,o),Df(e,t,o))
r.push(a)}}return r}(e,t,Sf(e,t,n,r,i,o))}function Cf(e,t,n,o,i,a){const c=function(e,t){return t===eW?e.client.deviceType===HW?HW:ZW:t}(e,n),u=Vf(e,c,e.client.screenSize)
let d,f
for(let e=0;e<u.length&&!s(d);e++)d=l(t,u[e]),f=u[e]
if(s(d)&&!r(f)){const t=d.map(function(t){return df(e,t,{useCase:o,cropCode:a})}).filter(Am.isSome),r=yf(0,n,f,i)
return new mY(t,r)}}function If(e,t,n,r){return $(t,`sortedAppPlatformsFromData.${n}.${r}`,()=>{var o
const i=kf(e,t),s=[]
let a=[]
const c=function(e,t){-1===a.indexOf(e)&&-1===s.indexOf(e)&&-1!==i.indexOf(e)&&(a.push(e),t&&s.push(t))}
switch((null===(o=e.activeIntent)||void 0===o?void 0:o.appPlatform)&&c(e.activeIntent.appPlatform),n!==_Y&&n!==RY||c(zW),n){case nJ:c(oz)
break
case rJ:c(eW)}switch(r){case ZW:c(ZW)
break
case HW:c(HW)
break
case"tv":c("tv")
break
case oz:c(oz)
break
case iz:c(iz)
break
case zW:c(zW)}return n!==_Y&&n!==RY||(c(HW),c(ZW)),e.appleSilicon.isSupportEnabled?(c(HW),c(ZW)):(c(ZW),c(HW)),c(iz),c(zW),c("tv"),c(oz),c(eW),a=a.filter(function(e){return-1===s.indexOf(e)}),a})}function kf(e,t){return t?$(t,"supportedAppPlatformsFromData",()=>Of(e,t,!0)):[]}function Of(e,t,n){if(!t)return[]
const r=eh(e,t,AW),o=nh(e,t),i=function(e,t){return Xe(e,t,XH)}(e,t)
let s=G(t,Kj)
if(t.type===JW&&n){const e=G(t,"unionDeviceFamilies")
e.length>0&&(s=e)}const a=[]
let c=!1
for(const e of s)switch(e){case OW:o||a.push(ZW)
break
case IW:o||a.push(HW)
break
case Vj:a.push("tv")
break
case oz:a.push(oz),c=!0
break
case zH:a.push(zW)}return r&&a.push(eW),!c&&i&&a.push(oz),Me(e,t,iz)&&a.push(iz),a}function Ef(e,t,n){if(Rf(e,t,n)){const t=n[0].appPlatform.toUpperCase()
return e.loc.string(`ONLY_FOR_${t}_APP`)}let r=n.reduce((e,t)=>e.concat(Lf(t)),[])
try{return e.loc.tryString(`PLATFORMS_${r.join("_")}`)}catch(t){return r=["PHONE","PAD","MAC","VISION","TV","WATCH","MESSAGES","FACETIME"].filter(e=>r.includes(e)),e.loc.string(`PLATFORMS_${r.join("_")}`)}}function Df(e,t,n){return Rf(e,t,n)?"top":"bottom"}function Rf(e,t,n){if(1===n.length){const r=n[0],o=Mf(0,t,e.appleSilicon.isSupportEnabled),i=!1,s=Nf(xf(0,e.client.deviceType,o,i),r.appPlatform),a=0===r.supplementaryAppPlatforms.length,c=r.appPlatform!==e.client.deviceType
if(a&&c&&!s)return!0}return!1}function _f(e,t){const n=Lf(t)
return e.loc.string(`PLATFORMS_${n.join("_")}`)}function Lf(e){const t=e.appPlatform.toUpperCase(),n=e.supplementaryAppPlatforms.map(e=>e.toUpperCase())
return[t].concat(n)}function Mf(e,t,n){let r=H(t,x$)
return n&&r}function Ff(e,t){let n
return e.isAvailable(jY)&&[Rj,WG].includes(e.client.buildType)&&(0,Am.isSome)(e.ads.fetchAppBinaryTraitsOverride)&&(n=e.ads.fetchAppBinaryTraitsOverride()),(0,Am.isNothing)(n)&&(n=ae(t,AW,ZT)),n}function $f(e,t,n){if(Mf(0,t,n)){const n=Qe(e,t,"minimumMacOSVersion")
if(s(n))return n}return ce(t,tt(e,t),yq)}function xf(e,t,n,r){switch(t){case ZW:return[ZW,eW]
case HW:return[ZW,HW,eW]
case"tv":return["tv"]
case oz:return[oz]
case iz:return n?[iz,ZW,HW]:[iz]
case zW:return r?[zW,ZW,HW]:[zW]
default:return[]}}function Nf(e,t){return-1!==e.indexOf(t)}function Bf(e,t,n,r,o,i,s=!0){const a=function(e,t,n,r,o){let i
switch(n){case ZW:return i=it(e),(0,Am.isSome)(t)&&i.isSystemAppFromData(t)?[ZW,oz,eW]:[ZW,oz,eW,"tv",zW]
case HW:return i=it(e),(0,Am.isSome)(t)&&i.isSystemAppFromData(t)?[ZW,HW,eW]:[ZW,HW,eW,"tv",zW]
case"tv":return["tv"]
case oz:return[oz]
case iz:return r?[iz,ZW,HW]:[iz]
case zW:return o?[zW,ZW,HW]:[zW]
default:return[]}}(e,t,r,o,i)
return!!a.some(e=>Nf(n,e))}function Uf(e,t){var n,o
const i=new _3
if(e.client.deviceType!==iz)return i
if(t.type!==JW)return i.runsOnIntel=null===(n=function(e,t,n,o,i=Rq){if(o||(o=tt(e,t)),(0,Am.isNothing)(o))return
let s=le(t,o,n,i)
return r(s)&&(s=V(t,n,i)),s}(e,t,"runsOnIntel",nt(e)))||void 0===n||n,i.runsOnAppleSilicon=Xe(e,t,"runsOnAppleSilicon",nt(e)),i.requiresRosetta=Xe(e,t,QT,nt(e)),i
const s=null!==(o=we(t,az))&&void 0!==o?o:[]
if(0===s.length)return i
for(const t of s){if(r(t.attributes))continue
const n=Uf(e,t)
i.runsOnIntel=i.runsOnIntel&&n.runsOnIntel,i.runsOnAppleSilicon=i.runsOnAppleSilicon&&n.runsOnAppleSilicon,i.requiresRosetta=i.requiresRosetta||n.requiresRosetta}return i}function Gf(e,t,n,r){const o=Uf(e,t)
return n?o.runsOnAppleSilicon&&(!o.requiresRosetta||o.requiresRosetta&&r):o.runsOnIntel}function jf(e,t,n,r,o){const i=function(e,t,n,r){switch(t){case ZW:return[ZW,oz,eW]
case HW:return[ZW,HW,eW]
case"tv":return["tv"]
case oz:return[oz]
case iz:return n?[iz,ZW,HW]:[iz]
case zW:return r?[zW,ZW,HW]:[zW]
default:return[]}}(0,n,r,o)
return i.some(e=>Nf(t,e))}function Vf(e,t,n){switch(t){case iz:return[iz]
case oz:return n.isEqualTo(o9)||n.isEqualTo(p9)?[gx,mx,_M,LM,MM]:[mx,gx,_M,LM,MM]
case"tv":return["appleTV"]
case zW:return["appleVisionPro"]
case HW:{const t=[]
return(n.isEqualTo(q3)||n.isEqualTo(W3)||n.isEqualTo(J3)||n.isEqualTo(K3))&&e.client.screenCornerRadius>0?(t.push(oG),t.push(iG),t.push(pU),t.push(wU),t.push(IW)):n.isEqualTo(H3)?(t.push(pU),t.push(oG),t.push(iG),t.push(wU),t.push(IW)):n.isEqualTo(j3)||n.isEqualTo(V3)||n.isEqualTo(z3)||n.isEqualTo(Y3)||n.isEqualTo(Z3)||n.isEqualTo(Q3)?(t.push(iG),t.push(oG),t.push(pU),t.push(wU),t.push(IW)):n.isEqualTo(G3)?(t.push(wU),t.push(IW),t.push(iG),t.push(pU),t.push(oG)):n.isEqualTo(i9)?(t.push(iG),t.push(pU),t.push(oG),t.push(wU),t.push(IW)):n.isEqualTo(U3)?(t.push(IW),t.push(wU),t.push(iG),t.push(pU),t.push(oG)):(t.push(oG),t.push(iG),t.push(IW),t.push(wU),t.push(pU)),t}case ZW:{let e
e=n.isEqualTo(M3)||n.isEqualTo(c9)?ZE:n.isEqualTo(F3)||n.isEqualTo(s9)||n.isEqualTo(a9)?FM:n.isEqualTo(B3)?OW:n.isEqualTo(N3)?XT:n.isEqualTo(x3)?eb:n.isEqualTo($3)?tb:n.isEqualTo(l9)||n.isEqualTo(d9)?QE:n.isEqualTo(u9)||n.isEqualTo(f9)||n.isEqualTo(h9)?XE:FM
const t=w9.indexOf(e),r=w9.slice(0,t)
r.reverse()
const o=w9.slice(t+1)
return[e].concat(r,o)}default:return[]}}function Hf(e,t){if(r(t))return
const n=Ke(e,t,FE),o=Ke(e,t,$E),i=Mf(0,t,!0)
if(Fe(e,t,iz)&&!i){const i=e.bag.enableProductPageInstallSize?function(e,t){const n=se(t,rq,xE)
if((0,Am.isNothing)(n))return
const r=n[JO]
return(0,Am.isNothing)(r)?void 0:h(r)}(0,t):function(e,t){const n=gr(e,t)
if(r(n))return
const o=l(n,"assets")
if(o.length)for(const e of o)if(f(e,"flavor")===vP)return h(e,FU)}(e,t)
if(s(o)){const e=h(o,nb)
return new yY(i,void 0,void 0,e)}if(s(n)){const e=h(n,rb),t=h(n,ob)
return new yY(i,e,t,void 0)}return new yY(i,void 0,void 0,void 0)}{const r=B(t,LE)
if(r){let t=[]
e.client.thinnedApplicationVariantIdentifier&&(t=e.client.thinnedApplicationVariantIdentifier.split(" ")),t=t.concat([e.host.deviceModel,"universal"])
for(const e of t){const t=h(r[e])
if(t){if(s(o)){const e=h(o,nb)
return new yY(t,void 0,void 0,e)}if(s(n)){const e=h(n,rb),r=h(n,ob)
return new yY(t,e,r,void 0)}return new yY(t,void 0,void 0,void 0)}}}}}function qf(e,t,n){let r,s=null,a=null,c=null,l=null
switch(e.client.deviceType){case iz:n.supportsArcade?(s=eD,c="sr"):(s="editorialArtwork.centeredFullscreenBackground",c="ep")
break
case"tv":n.presentedInTopShelf?(s=tD,c="sr"):(s=eD,c="ta",a="editorialArtwork.fullscreenBackground",l="sr")
break
case zW:s="editorialArtwork.productUberStatic16x9",c="sr"
break
default:n.supportsArcade?n.prefersCompactVariant||e.client.isPhone?(s="editorialArtwork.splashTall",c="oc"):(s=eD,c="oh"):(s=$M,c="sr")}if(r=Ke(e,t,s),(0,Am.isSome)(a)&&o(r)&&(r=Ke(e,t,a),(0,Am.isSome)(l)&&(c=l)),i(r)&&i(c))return df(e,r,{cropCode:c,useCase:R3.Uber,withJoeColorPlaceholder:!0,overrideHeight:void 0,overrideWidth:void 0})}function Wf(e,t,n,o,i){let a,c,l=[]
if(s(o))l=o
else switch(e.client.deviceType){case iz:case"tv":l=[nB]
break
case HW:l=[xM]
break
case zW:l=["productUberMotion16x9"]
break
default:l=[rB]}for(const n of l)if(a=Ke(e,t,[TW,n]),c=Ke(e,t,[TW,n,Dj]),s(a))break
const u=null!=i?i:df(e,c,{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if((0,Am.isSome)(a),(0,Am.isSome)(u)){const e=f(a,Xq)
if(r(e))return
let t,n
return t={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},n={muteUnmute:!0},new wY(e,u,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:t,autoPlayPlaybackControls:n})}}function zf(e,t,n){let r
switch(e.client.deviceType){case iz:case"tv":case ZW:case zW:r=[nB,xM,rB]
break
default:r=[xM,nB,rB]}return Wf(e,t,R3.Uber,r,n)}function Yf(e,t){if(i(t))return`${Cz}:/${_z.developer}/${_z.href}?${Hz.href}=${t.href}`}function Jf(e,t,n){return ge(e,new cJ(e).forType(JN).addingQuery(KN,az).addingQuery(sW,n).addingQuery(mq,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}function Kf(e,t){switch(t){case tJ:case sJ:return"appStore"
case nJ:return oz
case rJ:return eW
case iJ:return HU
default:return}}function Zf(e,t){switch(t){case 6:return["L",xT]
case 7:return["10",BT]
case 8:return["12",GT]
case 9:return["14",VT]
case 10:return["16",qT]
case 11:return["18",zT]
case 12:return["AL",$T]
case 13:return["A10",NT]
case 14:return["A12",UT]
case 15:return["A14",jT]
case 16:return["A16",HT]
case 17:return["A18",WT]
case 20:return["All","kr.all"]
case 21:return["12","kr.12"]
case 22:return["15","kr.15"]
case 31:return["15+","AgeRating-AU-15"]
case 32:return["R 18+","AgeRating-AU-18"]
case 47:return["18+","AgeRating-FR-18"]
default:return}}function Qf(e,t){switch(t){case ZW:return e.loc.string("AppPlatform.Phone")
case HW:return e.loc.string("AppPlatform.Pad")
case zW:return e.loc.string("AppPlatform.Vision")
case"tv":return e.loc.string("AppPlatform.TV")
case oz:return e.loc.string("AppPlatform.Watch")
case eW:return e.loc.string("AppPlatform.Messages")
case iz:return e.loc.string("AppPlatform.Mac")
default:return""}}function Xf(e,t){var n
return null===(n=Zf(0,t))||void 0===n?void 0:n[1]}function eh(e,t,n){return Xe(e,t,"hasMessagesExtension",n)}function th(e,t,n){return Xe(e,t,yM,n)}function nh(e,t){return Xe(e,t,"isHiddenFromSpringboard")}function rh(e,t,n){return Ke(e,t,mM,n)}function oh(e,t,n,r,o){return rt(e,t,n,r?nU:NV,o)}function ih(e,t,n){return Xe(e,t,_j,n)}function sh(e,t,n,r=!1,o){var i,s
if((0,Am.isNothing)(t))return
let a
if(r){const r=N(t)
W(r)&&(a=Qe(e,r,[nH,n],o))}return a=null!==(s=null!==(i=null!=a?a:Qe(e,t,[vU,n],o))&&void 0!==i?i:Qe(e,t,[nH,n],o))&&void 0!==s?s:Qe(e,t,["itunesNotes",n],o),a}function ah(e,t,n,r=!1){var o
let i
if(r){const r=N(t)
W(r)&&(i=Qe(e,r,[nH,n]))}return i=null!==(o=null!=i?i:Qe(e,t,[vU,n]))&&void 0!==o?o:Qe(e,t,[nH,n]),i}function ch(e,t){return $(t,"isMacOSInstaller",()=>!1)}function lh(e,t){const n=it(e)
return!(!function(e,t,n){if(n&&it(e).isSystemAppFromData(t)){const e=j(t,ab)
if(s(e))switch(e){case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0
default:return!1}}return!1}(e,t,e.client.isTinkerWatch)&&(!e.client.isTinkerWatch||(n.isSystemAppFromData(t)?Xe(e,t,WO)||Xe(e,t,Tj):Xe(e,t,qO)||Xe(e,t,Tj))))}function uh(e){switch(e){case ZW:return OW
case HW:return IW
case"tv":return"tv"
case oz:return M$
case iz:return cb
case eW:return kN
case zW:return VL
default:F(e)}}function dh(e,t){switch(t){case oG:return 18/q3.width
case iG:return 18/j3.width
case ZE:return 41.5/M3.width
case FM:return 39/F3.width
case QE:return 55/l9.width
case XE:return 55/u9.width
case LM:return 34/e9.width
case _M:return 55/t9.width
case gx:return 108/n9.width
case mx:return 108/r9.width
default:return}}function fh(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.host.isOSAtLeast(o,i,s)}function hh(e,t){return!r(t)&&0!==t.length&&e.client.isActivePairedWatchSystemVersionBelow(t)}function ph(e,t){switch(t){case mW:case Kq:case zN:case oB:case ix:case ej:case NM:return!0
default:return!1}}function wh(e,t){switch(t){case"LockupSmall":case"LockupLarge":case rD:case Zj:case gU:case iB:case mU:case sB:case BM:return!0
default:return!1}}function vh(e,t,n){const r=gr(e,t)
if(f(r,IH)===HH){const n=f(r,sG),o=Qe(e,t,gH)
if(s(o)){if(s(n)){const t=Oe(n),r={"@@expectedDateMY@@":e.loc.string("PreOrder.Date.MonthYear"),"@@expectedDateMDY@@":e.loc.string("PreOrder.Date.MonthDayYear")}
for(const[n,i]of Object.entries(r))if(o.includes(n)){let r=e.loc.formatDateWithContext(i,t,"middleOfSentence")
return o.replace(n,r)}}return o}}return null!=n?n:void 0}function gh(e,t){const n=pe(e,t,vq)
return s(n)?n:Xe(e,t,tG)?pe(e,t,Sq):void 0}function mh(e){var t
return null!==(t=function(e,t,n){if((0,Am.isNothing)(e)||0===t.length&&0===n.length)return null
const r=e
if((0,Am.isNothing)(r))return null
const o=ke(r)
for(const e of t)if(Ie(o,e))return ye(e.colorHex)
for(const e of n)if(Ie(o,e))return ye(e.colorHex)
return null}(e,A9,T9))&&void 0!==t?t:ye(m9)}function yh(e){var t,n,r,o,i
const s=[]
for(const t of l(e,wT))(0,Am.isSome)(t)&&c(t)&&s.push(t)
return{bgColor:null!==(t=f(e,Jj))&&void 0!==t?t:void 0,textColor1:null!==(n=f(e,kM))&&void 0!==n?n:void 0,textColor2:null!==(r=f(e,yx))&&void 0!==r?r:void 0,textColor3:null!==(o=f(e,oD))&&void 0!==o?o:void 0,textColor4:null!==(i=f(e,iU))&&void 0!==i?i:void 0,textGradient:(0,bm.isDefinedNonNullNonEmpty)(s)?s:void 0}}function Ah(e){var t,n,r,o,i,s
const a=yh(e),c=[]
for(const e of null!==(t=a.textGradient)&&void 0!==t?t:[]){const t=ye(e);(0,Am.isSome)(t)&&c.push(t)}return{bgColor:null!==(n=ye(a.bgColor))&&void 0!==n?n:void 0,textColor1:null!==(r=ye(a.textColor1))&&void 0!==r?r:void 0,textColor2:null!==(o=ye(a.textColor2))&&void 0!==o?o:void 0,textColor3:null!==(i=ye(a.textColor3))&&void 0!==i?i:void 0,textColor4:null!==(s=ye(a.textColor4))&&void 0!==s?s:void 0,textGradient:(0,bm.isDefinedNonNullNonEmpty)(c)?c:void 0}}function Th(e){const t=[Jj,kM,yx,oD,iU]
for(const n of t){const t=e[n]
if(c(t)&&!Ie(ye(t),y9))return t}return null}function bh(e,t,n=!0){return ym.context("isSupportedOnCurrentPlatform",()=>{if(t.type!==az&&t.type!==JW)return!0
const r=Of(e,t,n),o=Mf(0,t,e.appleSilicon.isSupportEnabled)
return Bf(e,t,r,e.client.deviceType,o,!1)})}function Sh(e,t){let n=t.targetType
return n||(n=KW),n}function Ph(e){let t=e.idType
return t===wW?t=null:t||(t=yW),t}function Ch(e,t){return ih(e,t)?dW:null}function Ih(e,t,n){const r=f(t,IH),o=Me(e,t,iz,!0),i=Fe(e,t,iz,!0),s=function(e,t,n,r=!1){const o=new Set(xe(e,t,r))
for(const e of n)if(o.has(e))return!0
return!1}(e,t,[OW,IW,ZN,Vj,oz],!0),a=$e(e,t,[OW,IW,ZN,Vj,oz],!0),c=Me(e,t,zH,!0),l=Fe(e,t,zH,!0)
if(i||o&&n===rq)switch(r){case az:return vP
case JW:return"macSoftwareBundle"}if((l||c&&n===ZH)&&r===az)return"visionSoftware"
if(a||s||s&&n===AW||s&&n===oz||s&&n===WV)switch(r){case az:return gP
case JW:return"mobileSoftwareBundle"}switch(r){case jq:return"softwareAddOn"
case SH:return BV
case ax:case YW:return uV
case rH:return mP
default:return null}}function kh(e){return null==e?"":e}function Oh(e){if(!e)return null
let t=null
const n=new oY(e).query
if((0,mm.isSome)(n))for(const e of Object.keys(n))if("referrer"===e){n[e]===lD&&(t="com.apple.siri")
break}return t}function Eh(e){var t
return(0,mm.isNothing)(e)?{}:null!==(t=v(Dh(y(e))))&&void 0!==t?t:{}}function Dh(e){if(r(e))return null
if(e instanceof Array){const t=[]
for(const n of e){const e=Dh(n)
i(e)&&t.push(e)}return t}if(e instanceof Object){const t={}
return Object.keys(e).forEach((n,r,o)=>{const s=Dh(e[n])
i(s)&&(t[n]=s)}),t}return e}function Rh(e){if(!e)return null
const t=new oY(e),n=t.query,o=null==n?void 0:n[jj],i=t.pathname
return r(o)||r(i)?null:i.endsWith("/search")?o:null}function _h(e,t,n,r){if(!t||!n)return GW
if(t.type===JW)return bO
const o=n.style
if((0,mm.isNothing)(o))return GW
switch(o){case aU:case vx:return AW
case DM:case eB:return iz
case RM:return"tv"
case wx:case EM:return mf(e,t,null!=r?r:void 0)===ZH?zW:oz
case XN:return eW
case qG:return qG
default:return F(o),GW}}function Lh(e,t){if(!i(t))return null
const n={},r=p(t,ER)
if(!s(r))return null
const o=f(r,AP);(0,mm.isSome)(o)&&(null==o?void 0:o.length)>0&&(n[AP]=o)
const a=f(r,TP);(0,mm.isSome)(a)&&(null==a?void 0:a.length)>0&&(n[TP]=a)
const c=f(r,bP)
return(0,mm.isSome)(c)&&(null==c?void 0:c.length)>0&&(n[bP]=c),n.marketing={marketingItemId:t.id},n}function Mh(e,t,n){let o
return i(e)&&(o=S(e)),i(t)&&(r(o)&&(o={}),o.odpModuleUpdate=t.toString()),s(n)&&(r(o)&&(o={}),o.userSegment=n),o}function Fh(e,t,n){const r=Wh(t.locationTracker)
return[Hh(0,t,n),...r]}function $h(e,t,n){const r=Wh(t.locationTracker)
return[qh(0,t,n),...r]}function xh(e,t,n){const r=new b9
r.location=Hh(0,t,n),t.locationTracker.locationStack.unshift(r)}function Nh(e,t,n){const r=new b9
r.location=qh(0,t,n),t.locationTracker.locationStack.unshift(r)}function Bh(e){0!==e.locationStack.length?e.locationStack.shift():ym.unexpectedType(gq,"non-empty location stack","empty location stack")}function Uh(e){const t=zh(e)
return t?t.position:e.rootPosition}function Gh(e){const t=zh(e)
return t?t.location:null}function jh(e,t){const n=zh(e)
n?n.position=t:e.rootPosition=t}function Vh(e){const t=zh(e)
t?t.position++:e.rootPosition++}function Hh(e,t,n){var r
const o=qh(0,t,n)
if(!t.id&&t.locationTracker)o.idType=pW,o.id=Uh(t.locationTracker).toString()
else{const e=Ph(t);(0,Am.isSome)(e)&&(o.idType=e)
let n=t.id;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(n=t.anonymizationOptions.anonymizationString),o.id=(0,Am.isNothing)(n)?"":n}return t.fcKind&&(o.fcKind=t.fcKind),t.displayStyle&&(o.displayStyle=t.displayStyle),t.inAppEventId&&(o.inAppEventId=t.inAppEventId),t.relatedSubjectIds&&(o.relatedSubjectIds=t.relatedSubjectIds),t.canonicalId&&(o.canonicalId=t.canonicalId),t.optimizationEntityId&&(o.optimizationEntityId=t.optimizationEntityId),t.optimizationId&&(o.optimizationId=t.optimizationId),(0,Am.isSome)(t.rowIndex)&&(o.rowIndex=t.rowIndex),t.productVariantData&&Object.assign(o,ze(t.productVariantData)),o}function qh(e,t,n){var r,o
let i=n;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(i=t.anonymizationOptions.anonymizationString)
const s={locationPosition:Uh(t.locationTracker),locationType:Sh(0,t),name:(0,Am.isNothing)(i)?"":i}
return(0,Am.isSome)(t.badges)&&(s.badges=null!==(o=y(t.badges))&&void 0!==o?o:void 0),t.recoMetricsData&&Object.assign(s,t.recoMetricsData),s}function Wh(e){return e.locationStack.map(e=>e.location)}function zh(e){return 0===e.locationStack.length?null:e.locationStack[0]}function Yh(e,t){var n,r,a,c,l,u,d,f
let h=t.id,p=t.title
if(s(t.anonymizationOptions)){const e=null!==(r=null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&void 0!==r?r:"ANONYMOUS"
h=e,p=e}else h&&t.createUniqueImpressionId&&(h=function(e,t){return`${t}${P9}${e.random.nextUUID()}`}(e,h))
const w={id:kh(h),name:kh(p),impressionType:Sh(0,t)},v=Ph(t);(0,mm.isSome)(v)&&(w[jF]=v),t&&t.kind&&(w[Dq]=t.kind),t&&t.softwareType&&(w[RB]=t.softwareType),t&&t.recoMetricsData&&Object.assign(w,t.recoMetricsData),t&&t.mercuryMetricsData&&Object.assign(w,t.mercuryMetricsData),t&&t.lockupDisplayStyle&&(w[NF]=t.lockupDisplayStyle)
const g=null!==(a=t.shouldOmitImpressionIndex)&&void 0!==a&&a
if(t&&t.locationTracker&&!g){const e=Uh(t.locationTracker)
w[tS]=e,""===w.id&&(w.id=e.toString(),w[jF]=pW)}if(t&&t.modelSource&&(w.modelSource=t.modelSource),i(t.offerType)&&(w[Yx]=t.offerType),t&&i(t.displaysArcadeUpsell)&&(w[uP]=t.displaysArcadeUpsell),t&&i(t.isPreorder)&&(w[uW]=t.isPreorder),i(t.adamId)&&o(t.anonymizationOptions)&&(w[EH]=t.adamId),t&&i(t.badges)&&(w.badges=t.badges),t&&i(t.inAppEventId)&&(w[Y$]=t.inAppEventId),t&&i(t.relatedSubjectIds)&&(w.relatedSubjectIds=t.relatedSubjectIds),(null===(c=null==t?void 0:t.hintsEntity)||void 0===c?void 0:c.length)&&(w[GF]=t.hintsEntity),t&&i(t.autoAdvanceInterval)&&(w.autoAdvanceInterval=t.autoAdvanceInterval),i(null==t?void 0:t.fcKind)&&(w.fcKind=t.fcKind),i(null==t?void 0:t.canonicalId)&&(w[pB]=t.canonicalId),i(null==t?void 0:t.displayStyle)&&(w[Aq]=t.displayStyle),i(t.productVariantData)&&Object.assign(w,ze(t.productVariantData)),(0,mm.isSome)(t.contentRating)&&(w[TG]=t.contentRating),(0,mm.isSome)(t.bundleId)&&(w[hW]=t.bundleId),w.impressionType!==$x){if((0,mm.isSome)(t.adsMetricsData)){const e=Eh(t.adsMetricsData)
Object.assign(w,e)}if(null!==(l=t.isAdvert)&&void 0!==l&&l||null!==(u=t.isAdEligible)&&void 0!==u&&u){const e=null===(f=null===(d=t.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f?void 0:f.sharedImpressionsArrayFields
if((0,mm.isSome)(e)){const t=Eh(e)
Object.assign(w,t)}}}return""===w.id&&e.console.log(`impressionId missing. Tracking broken for ${w.name} of ${w.impressionType}`),w}function Jh(e,t,n){t&&(t.impressionMetrics=new qJ(Yh(e,n)))}function Kh(e,t,n){var r
t&&(Jh(e,t,n),(n.isAdvert||n.isAdEligible)&&(null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)&&t.impressionMetrics&&(t.impressionMetrics=new S9(t.impressionMetrics,!0)))}function Zh(e,t,n,r,o,i,s=!0){var a,c,l,u,d,f
if(!t)return
const h=Yh(e,n)
if(s?(h[dP]=kh(r),h[CF]=kh(o)):(r&&(h[dP]=r),o&&(h[CF]=o)),i&&(h[fP]=i),(null!==(c=null===(a=null==n?void 0:n.optimizationEntityId)||void 0===a?void 0:a.length)&&void 0!==c?c:0)>0&&(h[hP]=n.optimizationEntityId),(null!==(u=null===(l=null==n?void 0:n.optimizationId)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0&&(h[pP]=n.optimizationId),(0,mm.isSome)(null==n?void 0:n.rowIndex)&&(h.rowIndex=n.rowIndex),t.impressionMetrics=new qJ(h),(n.isAdvert||n.isAdEligible)&&(null===(d=n.pageInformation)||void 0===d?void 0:d.adPageInfo)){const r=Eh(n.pageInformation.adPageInfo.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
Object.assign(t.impressionMetrics.fields,r),t.impressionMetrics=new S9(t.impressionMetrics,!0),n.isAdvert&&(null===(f=t.impressionMetrics)||void 0===f||delete f.fields[CF])}}function Qh(e,t,n,r){if(!t||!r)return
Jh(e,t,n)
const o=Eh(r.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
if((0,mm.isSome)(t.impressionMetrics)){Object.assign(t.impressionMetrics.fields,o)
const e=u(n.disableFastImpressionsForAds)
t.impressionMetrics=new S9(t.impressionMetrics,!e)}(0,mm.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields[AF]=Hx)}function Xh(e,t,n,r,a,c,l){var u
const d=ep(e,t,n.title,a)
d.lockupDisplayStyle=r,d.contentRating=null===(u=n.offerDisplayProperties)||void 0===u?void 0:u.contentRating,d.bundleId=n.bundleId,o(d.targetType)&&(d.targetType=KW),c&&ih(e,t)&&(d.displaysArcadeUpsell=!0)
const f=a.id
return s(sf(t))&&i(f)&&f.length>0&&(d.id=f),d}function ep(e,t,n,r,o){return ym.context(SR,()=>{var i,s,a
const c=Ih(e,t),l=Ch(e,t),u={...r,kind:c,softwareType:l,title:n,id:t.id}
if(Xe(e,t,uW,o)&&(u.offerType=HH),r.isAdvert||r.isAdEligible){const n=null!==(i=u.adsMetricsData)&&void 0!==i?i:{}
n[wP]=!0
const o=null===(a=null===(s=r.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a?void 0:a.placementType,c=o2.containerIdFromType(e,o)
if((0,mm.isSome)(c)){n[LU]=c
const e=Qs(r.locationTracker,r.adSlotOverride)
n[zx]=`${c}_${e}`}const l=B(t,Cj)
if((0,mm.isSome)(l)){const e=kh(l[jx])
n[xx]=e
const t=kh(l[lR])
n[IF]=t}u.adsMetricsData=n}return u})}function tp(e,t,n,r){return ym.context(SR,()=>{const o=Ih(e,t),i=Ch(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:yW,displayStyle:VM}})}function np(e,t,n,r){return ym.context("impressionOptionsForMetadataRibbonItem",()=>({...e,id:t,kind:null,softwareType:null,title:n,idType:r,targetType:$x}))}function rp(e,t,n){var r,o,i,s
const a=Yh(e,(r=t.term,o=n,i=t.entity,s=t.source,ym.context("impressionOptionsForSearchHint",()=>({...o,id:"",kind:null,softwareType:null,title:r,hintsEntity:i,modelSource:s}))))
t.impressionMetrics=new qJ(a)}function op(e){const t=l(e,uq)
for(const e of t){const t=f(e,"id");(0,mm.isNothing)(t)||(e.id=ip(t))}}function ip(e){return e.includes(P9)?e.split(P9)[0]:e}function sp(e,t,n,r){return o(t.remainingItems)?null:`${Cz}:/${_z.product}/${_z.shelf}/`+ap(t,n,r)}function ap(e,t,n){return e.sourceSequenceId=t.getSequenceId(),e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function cp(e,t,n,r,o,i,s,a,c){return lp(e,t.data,n,r,o,i,s,a,c)}function lp(e,t,n,i,s,a,c,l,u){if(o(t))return null
const d=[],f={shouldShowSupportedPlatformLabel:null!=u&&u}
return{items:Yd(e,t,{shouldShowOnUnsupportedPlatform:null!=u&&u,lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:l},artworkUseCase:i,canDisplayArcadeOfferButton:ph(0,s),...r(a)?{}:{offerStyle:a},...f},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(d.push(t),!1),filter:c}),remainingItems:d}}function up(e,t,n){if(!n)return
let r=-1,o=null
n.forEach((e,n)=>{const i=e,s=i,a=i&&i.adamId===t,c=s&&s.productIdentifier===t;(a||c)&&(r=n,o=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,AV,"ad",{type:jL})))}),-1!==r&&(n.splice(r,1),n.splice(0,0,o))}function dp(e){if(-1===D9.indexOf(e.media.kind))return!1
const t=e.clickAction
if(!t)return!0
const n=t.pageUrl
if(!n)return!0
const r=new oY(n),o=fp()
for(const e of o)if(new sY(e).matches(r))return!1
return!0}function fp(){return[{protocol:Iz,path:`/{countryCode}/${_z.product}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPPT}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,path:`/{countryCode}/${_z.productBundle}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:`/{countryCode}/${_z.product}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,path:`/{countryCode}/${_z.productBundle}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:`/${_z.product}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,path:`/${_z.productBundle}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:`/${_z.product}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,path:`/${_z.product}/{id}`,query:[`${Hz.v0}?`,`${Hz.metrics}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,path:`/${_z.productBundle}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,query:[Hz.bundleIdentifier,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]},{protocol:Iz,query:[Hz.action,Hz.ids,`${Hz.isPurchasesApp}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:Iz,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.offerItemId}?`]},{protocol:Iz,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,hostName:`${Mz}`,path:`/${_z.siri}/{id}`,query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Iz,path:`/${_z.store}/${_z.viewSoftware}`,query:[Hz.id,`${Hz.v0}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Cz,path:`/${_z.product}/{id}`,query:[Hz.invalidateWidgetsOnFailure,`${Hz.metrics}?`,`${Hz.offerItemId}?`,`${Hz.appEventId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`,`${Hz.webBrowserFlowType}?`]}]}function hp(e,t,n){const r=n[JV],o=E9.fromJSON(e,r)
let i
if(o.isBundleShelf)i=JW
else switch(o.contentType){case mH:case vG:case eN:i=YW
break
case QN:i=jq
break
default:i=az}const s=[RW,TW,yq]
return e.appleSilicon.isSupportEnabled&&s.push(bq),e.bag.enableUpdatedAgeRatings&&s.push(bW),vf(e)&&s.push(Tq),new cJ(e).withIdsOfType(o.remainingItems.map(e=>e.id),i).includingAdditionalPlatforms(ee(e)).includingAttributes(i===jq?[]:s)}async function pp(e,t,n,s,a=!1){const c=n[JV],l=E9.fromJSON(e,c)
l.isFirstRender=!1
const u=bt(t)
l.recoMetricsData=null!=u?u:l.recoMetricsData,n[Hz.shelfRefreshType]===eY&&C9.resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,l)
const d=function(e,t,n,s){return ym.context("shelfFromLookupResponse",()=>{switch(n.onDemandShelfType){case py.SimilarItems:return function(e,t,n,i){return ym.context("similarItemsSecondaryShelf",()=>{var s,a,c
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const l=new C9(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),u=Qq,d=OG,f={pageInformation:l.metricsPageInformation,locationTracker:l.locationTracker,targetType:u,id:C9.similarItemsShelfId,idType:d,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
xh(0,f,n.title)
const h=new pK(n.contentType)
if(Kt(e,Vq)||Kt(e,cq)){const o=null===(s=Gh(l.locationTracker))||void 0===s?void 0:s.id;(0,mm.isSome)(o)&&(null===(a=n.sourcePageInformation.adPageInfo)||void 0===a||a.recordAdResponseEventsIfNeeded(e,null==i?void 0:i.failureReason,o,0))
const u=function(e,t){var n
const r=null===(n=null==t?void 0:t.onDeviceAd)||void 0===n?void 0:n.positionInfo
if((0,mm.isNothing)(r)||(0,mm.isNothing)(t))return null
let o
switch(t.placementType){case Vq:o=mj
break
case cq:o=nE}return(0,mm.isNothing)(o)?null:ic(e,t,{shelfIdentifier:o,slot:r.slot-1})}(e,i)
null===(c=l.metricsPageInformation.adPageInfo)||void 0===c||c.updateForAdResponse(e,i)
const d=function(e,t){if(r(e))return[]
const n=[]
return Object.entries(e.tasks).forEach(([r,o])=>{r.startsWith(t)&&(n.push(o),delete e.tasks[r])}),n}(u,o)
d.forEach(e=>{(t=t.filter(t=>t.id!==e.data.id)).splice(e.positionInfo.slot,0,e.data)})}const p=lp(e,t,l,uf(0,n.contentType),n.contentType,n.offerStyle,null,n.recoMetricsData)
if(o(p))return null
h.title=n.title,h.items=p.items,h.isHorizontal=!0
const w=new E9(n.productId,t,n.title,n.shouldInferSeeAllFromFetchesItems,void 0,n.contentType,null,null,null,null,null,py.SimilarItems),v=od(0,n.productId,w,l,n.destinationPageInformation)
return h.refreshUrl=v,t.length<2?h.rowsPerColumn=1:n.supportsArcade?h.rowsPerColumn=2:h.rowsPerColumn=3,l.addImpressionsFieldsToSimilarItemsShelf(e,h,u,d),un(e,[h],Vq,f.id,f.pageInformation),Bh(l.locationTracker),Vh(l.locationTracker),h})}(e,t.data,n,s)
case py.MoreByDeveloper:return function(e,t,n){return ym.context("moreByDeveloperSecondaryShelf",()=>{if(o(t))return null
const r=new C9(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId)
xh(0,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:rW,id:`${r.getSequenceId()}`,idType:pW,excludeAttribution:!0,recoMetricsData:n.recoMetricsData},n.title)
const i=new pK(n.contentType)
i.title=n.title
const s=e.client.isCompanionVisionApp?Im.VisionOSCompatibility:void 0,a=lp(e,t,r,uf(0,n.contentType),n.contentType,n.offerStyle,s)
if(o(a))return null
if(i.items=a.items,i.isHorizontal=!0,t.length<2?i.rowsPerColumn=1:i.rowsPerColumn=2,(0,mm.isSome)(n.developerUrl)){const t=new _J(fz)
t.pageUrl=n.developerUrl,t.title=e.loc.string(nq),oa(e,t,t.pageUrl,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),i.seeAllAction=t}return r.addImpressionsToShelf(e,i,Eq),Bh(r.locationTracker),Vh(r.locationTracker),i})}(e,t.data,n)
case py.SmallStory:return function(e,t,n){return ym.context("smallStorySecondaryShelf",()=>{if(o(t))return null
const r=new C9(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),i={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:rW,id:`${r.getSequenceId()}`,idType:pW,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
let s
if(xh(0,i,n.title),id(e)){const r=new qQ(i.pageInformation,i.locationTracker)
s=il(e,null!=t?t:[],n.title,null,r)}else{const r={metricsLocationTracker:i.locationTracker,metricsPageInformation:i.pageInformation,filterOutMediaCardKinds:wp(e.host.platform)}
s=ol(e,t,mH,n.title,null,r),Array.isArray(null==s?void 0:s.items)&&(s.items=s.items.filter(e=>!Bt(e)||nl(0,e.media.kind,mH)))}return s.isHorizontal=!0,r.addImpressionsToShelf(e,s,aq),Bh(r.locationTracker),Vh(r.locationTracker),s})}(e,t.data,n)}const a=new pK(n.contentType),c=bt(t),l={pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,excludeAttribution:!0,recoMetricsData:null!=c?c:n.recoMetricsData}
let u
if(n.contentType===vG){const n=al(e,t.data,l.pageInformation,l.locationTracker,dp)
i(n)&&(u=[n])}else{const r={metricsOptions:l,offerStyle:n.offerStyle,artworkUseCase:uf(0,n.contentType),canDisplayArcadeOfferButton:ph(0,n.contentType)}
n.contentType===QN&&(r.skipDefaultClickAction=!0)
const o={lockupOptions:r}
n.isBundleShelf&&(o.filter=Im.None)
const i=zd(e,t,o),s={[nJ]:wx,[rJ]:XN}[e.host.clientIdentifier]
s&&i.sort((e,t)=>{const n=e.icon.style===s,r=t.icon.style===s
return n&&r?0:n&&!r?-1:1})
const a=n.spotlightInAppProductIdentifier
a&&up(0,a,i),u=i}return a.items=u,a.mergeWhenFetched=!0,a})}(e,t,l,s)
if(a&&function(e,t,n,o){if(r(n))return
let i=[]
const s=Nt(n),a=Kn(e,n,o)
i.push(a)
const c=Xn(e,n,o).map(e=>e.data)
i=i.concat(c),Jn(s),i.forEach(e=>Jn(e.fields)),t.pageChangeMetrics={pageFields:s,updatedEvents:i}}(e,d,l.sourcePageInformation),d.refreshUrl=l.refreshUrl,n[Hz.shelfRefreshType]===eY&&C9.addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,d,l),l.shouldInferSeeAllFromFetchesItems){const t=new _J(fz)
t.title=e.loc.string(nq)
const n=new pK(d.contentType)
n.items=function(e,t,n,r=!1){var o,s
if(!t)return null
let a=0
const c=[]
for(const e of t){if(r&&i(null!==(o=e.searchAd)&&void 0!==o?o:null===(s=e.searchAdOpportunity)||void 0===s?void 0:s.searchAd)){a+=1
continue}const t=S(e)
if(n&&t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,n)),a>0){const e=S(t.impressionMetrics.fields),n=h(e.impressionIndex);(0,Am.isSome)(n)&&(e.impressionIndex=n-a,t.impressionMetrics=new qJ(e,t.impressionMetrics.id,t.impressionMetrics.custom))}c.push(t)}return c}(0,d.items,_q,!0)
const r=new gK([n])
Vn(e,r,l.destinationPageInformation),r.title=l.title,t.pageData=r,oa(e,t,null,{pageInformation:l.sourcePageInformation,locationTracker:l.sourceLocationTracker}),d.seeAllAction=t}return o(d.items)&&!l.hasExistingContent&&(d.isHidden=!0),d}function wp(e){const t=new Set([zB])
return e===KH&&(t.add(dV),t.add(NO),t.add(BG),t.add(HL)),t}async function vp(e,t){return typeof campaignAttribution!==gG?await campaignAttribution.processRedirectURL(t):await e.network.fetch({url:e.bag.redirectUrlEndpoint,method:rj,headers:{"Content-Type":BF},body:`url=${encodeURIComponent(t)}`}).then(e=>e.ok)}async function gp(e,t){const n=e.required(R9)
0!==Mn(e,new oY(t.url)).length&&vp(e,t.url),t.url=function(e,t){const n=new oY(t.url)
if(kE in n.query){const r=f(t.referrerData,VW)===EY,o=e.host.clientIdentifier===OY
return r||o||delete n.query[kE],n.toString()}return t.url}(e,t)
const r=new iy.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r)
return await n.fetchAction(o,t.url,t.referrerData).then(n=>{if(!n)throw new Error(`Promise resolved to null action for: ${t.url}`)
if(t.isIncomingURL){const e=[n]
if(oo(n))for(const t of n.actions)e.push(t)
for(const t of e){const e=t.pageData
e&&typeof e===vH&&uU in e&&Yn(0,e)}}if(n.actionClass===WL){const e=n
e.page===fV||e.page===vW||e.page===PE||e.page===vV||e.page===xN||e.page===G$||e.page===pq||e.page===sx||e.page===CE?e.presentationContext=_q:e.page===IE?e.presentationContext=XB:e.page===lU?e.presentationContext=$V:t.isIncomingURL?e.presentationContext=BN:(e.presentationContext="replace",e.animationBehavior=hq)}if(t.isIncomingURL&&(e.deepLinks.hasResilientDeepLinks()||e.deepLinks.removeDeepLink(t.url)),r.decorate(n),t.isIncomingURL){const t=e.bag.deepLinkTabIdentifier
if(t&&(t!==gW||e.clientCapabilities.isEnabled(bJ)))if(ft(n)){const e=new R0(t)
e.popToRoot=!0,e.actions=[n],n=e}else if(oo(n)){const e=new R0(t)
e.popToRoot=!0,e.actions=n.actions,n=e}}return n}).catch(n=>{let r=[]
n instanceof lY?r=n.reasons.filter(e=>e instanceof KZ):n instanceof KZ&&r.push(n)
for(const n of r)if(204===n.statusCode){const n=new $J(kW)
n.title=e.loc.string("APP_NOT_AVAILABLE_TITLE"),n.message=e.loc.string("APP_NOT_AVAILABLE_MESSAGE"),n.isCancelable=!0
{const r=new R0(UW)
if(r.title=e.loc.string(gM),g(new oY(t.url).query[yT])){const e=new Q9
r.actions=[n,e]}else r.actions=[n]
return r}}throw Error(n.message)})}function mp(e,t,n){switch(t){case QO:return function(e,t){const n=ec(e,e.bag.accountUrl)
return n.title=e.loc.string("VIEW_ACCOUNT_INFO",j$),ra(e,n,{...t,id:pq,actionType:dz},!1,zU),n}(e,n)
case XO:return function(e,t){const n=e.bag.signup
if((0,Am.isNothing)(n))return null
const r=ec(e,n)
return e.featureFlags.isEnabled(TK)?r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID_REBRAND"):r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID"),ra(e,r,{...t,id:pq,actionType:dz},!1,zU),r}(e,n)
case NN:return function(e,t){if((0,Am.isNothing)(e.bag.purchaseHistoryUrl))return null
const n=ec(e,e.bag.purchaseHistoryUrl)
return n.title=e.loc.string("ACCOUNT_PURCHASE_HISTORY"),n.presentationContext=BN,ra(e,n,{...t,id:NN,actionType:dz},!1,zU),n}(e,n)
case RN:return function(e,t){if(e.user&&e.user.isManagedAppleID)return null
const n=ec(e,e.bag.redeemUrl)
return n.title=e.loc.string("ACCOUNT_REDEEM",eE),ra(e,n,{...t,id:"redeemGiftCardOrCode",actionType:dz},!1,zU),n}(e,n)
case nM:return function(e,t){if(!e.bag.isMonetaryGiftingEnabled)return null
const n=ec(e,LN)
return n.title=e.loc.string("ACCOUNT_SEND_GIFT",BA),ra(e,n,{...t,id:"sendGiftCardByEmail",actionType:dz},!1,zU),n}(e,n)
case rM:return function(e,t){var n
const r=e.bag.accountTopUpURL
if((0,Am.isNothing)(r)||o(r))return null
const i=ec(e,r)
return i.title=null!==(n=e.bag.accountTopUpTitle)&&void 0!==n?n:e.loc.string("ACCOUNT_TOP_UP"),ra(e,i,{...t,id:"addFundsToAppleId",actionType:dz},!1,zU),i}(e,n)
case oM:return function(e,t){const n=new o8(dW,UA)
return n.title=e.loc.string("ACCOUNT_SETUP_FAMILY_SHARING"),ra(e,n,{...t,id:"setUpFamilySharing",actionType:dz},!1,zU),n}(e,n)
case iM:return function(e,t){const n=ec(e,e.bag.manageSubscriptionsV2Url)
return n.title=e.loc.string("ACCOUNT_SUBSCRIPTIONS"),n.presentationContext=BN,ra(e,n,{...t,id:iM,actionType:dz},!1,zU),n}(e,n)
default:return null}}function yp(e){const t=new iy.FetchTimingMetricsBuilder,n=e.addingFetchTimingMetricsBuilder(t),r={pageInformation:jn(e,j$,pq,""),locationTracker:{rootPosition:0,locationStack:[]},targetType:EW},o=t.measureModelConstruction(()=>{const t=new r8
return t.links[QO]=mp(e,QO,r),t.links[XO]=mp(e,XO,r),t.links[RN]=mp(e,RN,r),t.links[nM]=mp(e,nM,r),t.links[rM]=mp(e,rM,r),t.links[oM]=mp(e,oM,r),t.links[iM]=mp(e,iM,r),t.links[NN]=mp(e,NN,r),t})
return Vn(n,o,r.pageInformation),o}function Ap(e,t,n){if((0,mm.isSome)(e)){let r
r=new _0({player:{playerID:e.id}})
const o="GameCenterProfile",i=Op(o),s=_t(n,o,Fj,i)
return r.actionMetrics.addMetricsData(s),{$kind:kH,id:"game-center-row",artwork:e.artwork,title:n.loc.string("AccountHub.Row.GameCenter.Title"),label:e.displayName,badge:t>0?t.toString():null,action:r}}return null}function Tp(e){const t=new _J(jO),n=new a8(e.loc.string(ok),[])
return Vn(e,n,tr()),t.pageData=n,{$kind:aW,id:"apps-and-purchases-row",title:e.loc.string("AccountHub.Row.AppsAndPurchases.Title"),action:t,metricsFields:Op("AppsAndPurchaseHistory")}}function bp(e){return{$kind:aW,id:"notifications-row",title:e.loc.string("AccountHub.Row.Notifications.Title"),action:new _J(IE),metricsFields:Op("Notifications")}}function Sp(e){const t=new _J(pq,"x-as3-internal:///account/personalizationTransparency?enabled=true")
return t.presentationContext=BN,t.presentation=uz,{$kind:aW,id:"personalized-recommendations-row",title:e.loc.string("AccountHub.Row.PersonalizedRecommendations.Title"),action:t,metricsFields:Op("PersonalizedRecommendations")}}function Pp(){const e=new _J(rM)
return e.presentation=qW,e.presentationContext=XB,{$kind:"addFundsButton",id:"add-funds-card",action:e}}function Cp(){const e=new _J("redeemCode")
return e.presentation=qW,e.presentationContext=XB,{$kind:"redeemCodeButton",id:"redeem-code-card",action:e}}function Ip(){const e=new _J(nM)
return e.presentation=qW,e.presentationContext=XB,{$kind:"sendGiftButton",id:"send-gift-card",action:e}}function kp(e,t){return(0,mm.isSome)(e)&&""!==e?t.loc.string("AccountHub.ProfileFooter.Title").replace("@@value@@",e):null}function Op(e){return{targetId:e,targetType:Fj,actionType:dz}}function Ep(e,t){let n
const r=[]
return e.forEach(e=>{e.isCurrentSignedInUser?n={$kind:uk,id:e.id,title:t.loc.string("AppsAndPurchases.FamilyMember.LocalUser.Title")}:r.push({$kind:uk,id:e.id,title:t.loc.string("AppsAndPurchases.FamilyMember.Title").replace("@@name@@",e.firstName)})}),(0,mm.isSome)(n)&&r.unshift(n),r}function Dp(e){const t=new _J(NN),n="PurchaseHistory",r=_t(e,n,Fj,{targetId:n,targetType:Fj,actionType:dz})
return t.actionMetrics.addMetricsData(r),{$kind:NN,id:"purchase-history-row",action:t}}async function Rp(e,t){return await e.required(R9).fetchPage(e,t,f8)}async function _p(e){let t
try{t=await Ln(e,function(e){return new cJ(e).forType(AL)}(e))}catch{t=void 0}return function(e,t){const r=[],o=new p8,i=new V0(e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_IN"),FH,sx)
o.addContentItem(new v8(i))
const a=e.bag.personalizedRecommendationsToggleEnabled
if(!a){const t={}
t[e.loc.string(TL)]=Fp(e)
const n=new f2(e.loc.string("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",e.loc.string(TL)))
o.footer=new h2(n,t)}if(r.push(o),a){const t=new p8
t.addContentItem(new g8(e.loc.string(dk),!1))
const n=new f2(e.loc.string(fk))
t.footer=new h2(n),r.push(t)}{const t=new p8(e.loc.string("PERSONALIZATION_SECTION_USAGE_HEADER")),n=new f2(e.loc.string("PERSONALIZATION_SECTION_USAGE_FOOTER"))
t.footer=new h2(n),t.addContentItem(new m8(e.loc.string("PERSONALIZATION_SECTION_USAGE_CLEAR_DATA"),function(e){const t=new A8
t.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_TITLE")
const n=new SQ([t])
return n.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_HEADER"),n.isCancelable=!0,n.destructiveActionIndex=0,n}(e))),r.push(t)}const c=new p8(e.loc.string("PERSONALIZATION_INTERACTIONS")),l=new f2(e.loc.string("PERSONALIZATION_INTERACTIONS_FOOTER"))
c.footer=new h2(l)
const u=e.bag.purchaseHistoryUrl;(0,mm.isSome)(u)?c.addContentItem(new m8(e.loc.string(hk),Mp(e,fV,u,!0),VB)):c.addContentItem(new m8(e.loc.string(hk),Mp(e,yA,null,!0),VB)),c.addContentItem(new m8(e.loc.string("PERSONALIZATION_SUBSCRIPTIONS"),Mp(e,null,e.bag.manageSubscriptionsV2Url,!1),VB)),c.addContentItem(new m8(e.loc.string("PERSONALIZATION_PREORDERS"),Mp(e,null,e.bag.managePreordersUrl,!0),VB)),c.addContentItem(new m8(e.loc.string("PERSONALIZATION_RATINGS"),Mp(e,null,e.bag.ratingsReviewsUrl,!0),VB)),r.push(c)
const d=new p8(e.loc.string("PERSONALIZATION_ADDITIONAL_INFO")),h=[e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),p=new V0(h,FH,sx)
d.addContentItem(new v8(p)),r.push(d)
const w=n(t,"results.derived-user-info")
if(s(w)){const t=new p8(e.loc.string("ACCOUNT_INFO")),n=["gender","birthyear"]
for(const e of n){const n=f(w,`${e}.label`),r=f(w,`${e}.value`);(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0&&t.addContentItem(new y8(n,r))}const o=e.featureFlags.isEnabled(TK)?"PERSONALIZATION_ACCOUNT_INFO_FOOTER_REBRAND":"PERSONALIZATION_ACCOUNT_INFO_FOOTER",i=new f2(e.loc.string(o))
t.footer=new h2(i),r.push(t)}return new f8(e.loc.string(pk),r)}(e,t)}function Lp(e){const t=[],n=e.bag.personalizedRecommendationsToggleEnabled,r=new p8,o=n?e.loc.string("PersonalizedRecommendations.OptedOut.Description"):e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_OUT"),i=new V0(o)
if(r.addContentItem(new v8(i)),t.push(r),n){const n=new p8
n.addContentItem(new g8(e.loc.string(dk),!1))
const r=new f2(e.loc.string(fk))
n.footer=new h2(r),t.push(n)}else{const n=new p8
n.addContentItem(new m8(e.loc.string(TL),Fp(e),VB)),t.push(n)}return new f8(e.loc.string(pk),t)}function Mp(e,t,n,r){let o
if((0,mm.isSome)(t))o=new _J(t,n)
else{if((0,mm.isNothing)(n))return null
o=ec(e,n)}return r&&(o.presentationContext=BN),o}function Fp(e){return Mp(e,void 0,e.bag.accountUrl,!1)}async function $p(e,t){const n=new cJ(e).forType(wk).addingQuery(__,"events-reminders").addingQuery("service",$L).addingQuery(aW,"explicit")
n.isMediaRealmRequest=!0
const r=function(e,t){const n={"events-reminders":{"com.apple.AppStore":{contents:[{id:e,type:tz,notify:t}]}}}
return{method:"PATCH",headers:{"Content-Type":GM},requestBodyString:JSON.stringify(n)}}(t.appEventId,t.shouldSchedule)
return await new Promise((t,o)=>{Ln(e,n,r).then(e=>{t(!0)}).catch(e=>{o(e)})})}function xp(e){h7||(h7=!0,n7=new j8(e.loc.string("PAGE_FACETS_SORTS_RELEASE_DATE"),W8,XU),r7=new j8(e.loc.string("PAGE_FACETS_SORTS_LAST_UPDATED"),z8,"lastUpdated"),o7=new j8(e.loc.string("PAGE_FACETS_SORTS_NAME"),Y8,cz),i7=new j8(e.loc.string("PAGE_FACETS_SORTS_CATEGORY"),J8,FV),s7=new j8(e.loc.string("PAGE_FACETS_DEFAULT_ALL"),null),a7=new j8(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),c7=new j8(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),l7=new j8(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),u7=new j8(e.loc.string(aT),cW,void 0,"gamecontroller"),d7=new j8(e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER"),cW,void 0,"person.2"),f7=new j8(e.loc.string(cT),cW),t7[Hz.sort]={releaseDate:[n7],lastUpdated:[r7],name:[o7],category:[i7]},t7[Hz.ageRating]={"4plus":[a7],"9plus":[c7],"12plus":[l7]},t7[Hz.controllerSupport]={true:[u7],false:[]},t7[Hz.multiplayerSupport]={true:[d7],false:[]},t7[Hz.comingSoon]={true:[f7],false:[]})}function Np(e,t={}){xp(e)
const n={"filter[ageRating]":[s7]}
n[K8]=[n7],n[Z8]=[f7]
const r=[Hz.sort,Hz.ageRating,Hz.controllerSupport,Hz.multiplayerSupport,Hz.comingSoon]
for(const e of r){const r=t[e]
if(o(r))continue
const a=t7[e][r],c=p7[e]
i(a)&&s(c)&&(n[`${c}`]=a)}return n}function Bp(e,t){const n=new Pz
return ia(e,n,t),n}function Up(e){const t=[RW,TW,XH,tq,mV,NV]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}function Gp(e,t,n){return ym.context("createShelves",()=>{const r=[]
if(0===t.length)return r
let o=!1
for(const s of t)if(o=o||!W(s.data[0]),o)n.remainingGroups.push(s)
else{const t={index:n.lastShelfIndex,title:Vp(e,s),contentType:(i=n.isCompactMode,i?mW:zN),shouldFilter:!1,remainingContent:s.data,groupKind:s.kind,isCompactMode:n.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker},o=jp(e,t)
r.push(o),n.lastShelfIndex++}var i
return r})}function jp(e,t){const n=[],r=new pK(t.contentType)
r.title=t.title,r.presentationHints={showSupplementaryText:!1},r.isHorizontal=t.groupKind===eG||t.groupKind===FV
const i={id:`${t.index}`,kind:null,softwareType:null,targetType:rW,title:r.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:pW}
for(Jh(e,r,i),xh(0,i,r.title);s(t.remainingContent)&&W(t.remainingContent[0]);){const r=t.remainingContent.shift(),o={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(r)},artworkUseCase:R3.LockupIconSmall,canDisplayArcadeOfferButton:ph(0,t.contentType),shouldHideArcadeHeader:e.featureFlags.isEnabled(bK),isContainedInPreorderExclusiveShelf:t.groupKind===eG},i=jd(e,r,o,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},null,null)
Hp(e,i,r)&&(i.editorialTagline=null,i.developerTagline=null,n.push(i),Vh(t.metricsLocationTracker))}return r.mergeWhenFetched=t.hasExistingContent,t.hasExistingContent=t.hasExistingContent||n.length>0,r.items=n,s(t.remainingContent)?r.url=function(e){return o(e.remainingContent)?null:`${Cz}:/${_z.arcadeSeeAllGames}/${_z.shelf}/?${Hz.token}=${encodeURIComponent(JSON.stringify(e))}`}(t):"tv"!==e.client.deviceType&&t.isCompactMode&&r.items.length<3&&(r.rowsPerColumn=r.items.length),Bh(t.metricsLocationTracker),r}function Vp(e,t){let n,r,o=null,i=null
if((!t.name||0===t.name.length)&&t.kind!==eG)return""
switch(t.kind){case"releaseDateByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE"),n=e.loc.formatDateInSentence(r,gT,i)
break
case"lastUpdatedByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),n=e.loc.formatDateInSentence(r,gT,i)
break
case eG:n=e.loc.string("Arcade.SeeAllGames.ComingSoonShelf.Title")
break
default:n=t.name}return n}function Hp(e,t,n){if(o(t.trailers)){const r=zf(e,n)
if(s(r)){const e=new pY
r.playbackControls={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},r.autoPlayPlaybackControls={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0},r.canPlayFullScreen=!0,e.videos=[r],t.trailers=[e]}}return o(t.trailers)&&function(e){const t=e.screenshots[0]
if(o(t))return
const n=t.artwork[0],r=new wY(w7,n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,autoPlayPlaybackControls:{},playbackControls:{}}),i=new pY
i.videos=[r],e.trailers=[i]}(t),s(t.trailers)}async function qp(e,t){const n=e.required(R9),r=oY.from(t.url)
return r.param(Hz.requestDescriptor,JSON.stringify(t)),await n.fetchPage(e,r.build(),G8)}async function Wp(e,t){const n=e.required(R9)
return await n.fetchMoreOfPage(e,t).then(function(e){return e})}function zp(e,t){const n=Np(e,t),r={}
for(const e of Object.keys(n))r[e]=n[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue,systemImageName:e.systemImageName}))
const o={url:`${Cz}:/${_z.arcadeSeeAllGames}`,isCompactMode:!1,selectedFacetOptions:r},i=t[Hz.requestDescriptor]
if(s(i)){const e=v(JSON.parse(i))
o.isCompactMode=e.isCompactMode,Object.assign(o.selectedFacetOptions,e.selectedFacetOptions)}return o}async function Yp(e,t){const n=oY.from(t)
return await e.required(R9).fetchPage(e,n.build(),y7)}function Jp(e){let t=0,n=0
for(const r of e.shelves)(0,mm.isSome)(r.batchGroup)&&r.batchGroup.length>0||(r.batchGroup=`shelfBatchGroup_${t}`,n++,5===n&&(n=0,t++))}async function Kp(e,t){const n=oY.from(t.url)
return n.param(Hz.isArcade,"true"),n.param(Hz.isSubscribed,`${t.isSubscribed}`),n.param(Hz.isTrialAvailable,`${t.isTrialAvailable}`),n.param(Hz.isTrialEnrolled,`${t.isTrialEnrolled}`),await e.required(R9).fetchPage(e,n.build(),b7)}function Zp(e,t){const n=new R0(nz)
n.popToRoot=!0
const r=new rZ([n])
return r.title=t,r}async function Qp(e,t){return await e.required(R9).fetchPage(e,t,k7)}async function Xp(e,t){const n=new Promise((n,r)=>{const o=t
s(o)||r(new Error("fetchUpsellGrid called with malformed contentDictionary"))
const i=we(o,sz),a={pageInformation:new cZ({}),locationTracker:{rootPosition:0,locationStack:[]}},c=hf(e,i,a,{useCase:R3.LockupIconMedium}),l=c.shift()
n(new F7(l,c))})
return await n}async function ew(e,t){const n=v(t,JV)
let r=n.buyParams
const o=v(t,bk),i=v(t,Sk);(0,mm.isSome)(i)&&(o.adPageInfo={adAdamId:i._adAdamId,...i}),r=vr(e,f(t,EH),r,o,u(t,Pk),u(t,Ck),f(t,Ik),f(t,kk),f(t,SL),p(t,gV),p(t,Ok),v(t,Ek),f(t,Dk),f(t,"token.extRefApp2"),f(t,"token.extRefUrl2"))
const s=new uZ(r),a={product:f(t,fq)||n.productIdentifier,adamId:f(t,EH),buyParams:s.toEncodedMap()}
return await Promise.resolve(a)}async function tw(e,t){const n=t.offerAction,o=t.offerDisplayProperties
if(!n||!o)return await Promise.reject(new Error("Invalid offerToken for personalized offer fetch."))
const i=[n.adamId];(0,mm.isSome)(t.supportedBundleChildrenIds)&&i.push(...t.supportedBundleChildrenIds)
const s={"Content-Type":BF},a={url:e.bag.buyButtonMetadataURL,method:rj,headers:s,body:"ids="+i.join(","),signingStyle:GH},c=e.network.fetch(a)
return await c.then(i=>{if(!i.ok)throw Error(`Bad Status code ${i.status} for ${a.url}`)
const s=JSON.parse(i.body)
if((0,mm.isSome)(t.freeBundleId)&&(0,mm.isSome)(t.supportedBundleChildrenIds)){let r=!0
for(const e of t.supportedBundleChildrenIds)if(!nw(p(s,e))){r=!1
break}if(r)return function(e,t,n){const r=Nr(e,t,VW,n,GG)
return r.titles[rz]=e.loc.string(_k),new U7(DN,t,r)}(e,n,o)}const c=p(s,n.adamId)
let u=null,d=null
const h=function(e,t){return ym.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const e=l(t,bV)
if(0===e.length)return null
for(const t of e){const e=f(t,IH)
if(e)return e}return wW})}(0,c)
if(r(h))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata")
if(h!==wW){let t=AV
u=function(e,t,n,o){return ym.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const o=l(t,bV)
if(0===o.length)return null
let i,s=null
for(const e of o)switch(i=f(e,IH),i){case HF:case DN:s=e
break
default:s=null}if(!s)return null
let a=f(s,pV)
if(i===HF&&r(a))return ym.unexpectedNull(gq,$W,WD),null
a||(a="")
const c=n.purchaseConfiguration,u=new CQ(a,c.vendor,c.appName,c.bundleId,c.appPlatforms,c.isPreorder,c.excludeAttribution,c.metricsPlatformDisplayStyle,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.appCapabilities,c.isDefaultBrowser,c.remoteDownloadIdentifiers,c.hasMacIPAPackage,c.contentRating)
u.pageInformation=c.pageInformation
const d=Sr(e,s,n.adamId,u,!1)
return function(e,t,n,r){const o=n.purchaseConfiguration.pageInformation
let i
if((0,Am.isSome)(n.actionMetrics))for(const e of n.actionMetrics.data)if(i=l(m(e.fields),JG),i)break
ta(e,t,t.adamId,false,o,i,!1)}(e,d,n),d})}(e,c,n)
let i=null
switch(h){case DN:t=GG,i=e.loc.string(_k)
break
case HF:(r(u.price)||0===u.price)&&(i=e.loc.string(qF))}d=Nr(e,u,VW,o,t),i&&(d.titles[rz]=i)}const w=Rr(e,u,!1)
return new U7(h,w,d)})}function nw(e){if((0,mm.isNothing)(e))return!1
const t=w(e,bV)
if((0,mm.isNothing)(t)||0===t.length)return!1
for(const e of t)if(f(e,IH)===PM)return!0
return!1}async function rw(e,t){var n
let r=f(t,"token.buyParams")
const s=f(t,"overrideBuyParams")
i(s)&&(r=function(e,t){const n=new uZ(e),r=new uZ(t),i=n.get(RQ.placementId,null);(null==i?void 0:i.length)>0&&o(r.get(RQ.placementId,null))&&r.set(RQ.placementId,i,null)
const s=n.get(RQ.containerId,null);(null==s?void 0:s.length)>0&&o(r.get(RQ.containerId,null))&&r.set(RQ.containerId,s,null)
const a=n.get(RQ.templateType,null)
return(null==a?void 0:a.length)>0&&o(r.get(RQ.templateType,null))&&r.set(RQ.templateType,a,null),r.toString()}(r,s))
const a=v(t,bk),c=v(t,Sk);(0,mm.isSome)(c)&&(a.adPageInfo={adAdamId:c._adAdamId,...c}),r=vr(e,f(t,EH),r,a,u(t,Pk),u(t,Ck),f(t,Ik),f(t,kk),f(t,SL),p(t,gV),p(t,Ok),v(t,Ek),f(t,Dk),f(t,"metrics.extRefApp2"),f(t,"metrics.extRefUrl2"))
const d=l(t,"token.appPlatforms"),w=d&&d.length&&d.length>0&&d.indexOf("tv")>=0,m=d&&d.length&&d.length>0&&d.indexOf(zW)>=0,y=u(t,"token.isHalva")||u(t,"token.isMacOSCompatibleIOSApp"),A=u(t,"token.supportsVisionOSCompatibleIOSBinary"),T=xf(0,e.client.deviceType,y,A).some(e=>-1!==d.indexOf(e)),b=y&&!1,S=(d.indexOf(zW),A&&!1),P=f(t,"instalationType"),C=P===VF,I=P===PM,k=u(t,"token.isPreorder"),O=!(k||(w||m)&&!T),E=f(t,SL)===oz&&e.client.deviceType!==oz,D=f(t,"token.preflightPackageUrl"),R={...p(t,"token.additionalHeaders",{}),...p(t,"additionalHeaders",{})}
let _={}
const L=null===(n=e.paymentMetricsIdentifiersCache)||void 0===n?void 0:n.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical])
return(0,mm.isSome)(L)&&(_={...L}),{adamId:f(t,EH),buyParams:r,vendor:f(t,"token.vendor"),appName:f(t,"token.appName"),bundleId:f(t,"token.bundleId"),appPlatforms:d,additionalHeaders:R,isUpdate:C,isRedownload:I,isPreorder:k,createsJobs:O,preflightPackageUrl:D,isArcadeApp:g(t,"token.isArcadeApp"),forceWatchInstall:E,isMacOSCompatibleIOSApp:b,isVisionOSCompatibleIOSApp:S,presentingSceneIdentifier:f(t,"presentingSceneIdentifier"),appCapabilities:l(t,"token.appCapabilities"),isDefaultBrowser:g(t,"token.isDefaultBrowser"),requiresExceptionRequest:g(t,"requiresExceptionRequest"),forceAskToBuyReason:f(t,"forceAskToBuyReason"),contentRating:h(t,"token.contentRating"),metricsOverlay:_,remoteDownloadIdentifiers:l(t,"token.remoteDownloadIdentifiers"),hasMacIPAPackage:g(t,"token.hasMacIPAPackage")}}async function ow(e,t){const n=new cJ(e).withIdsOfType(t,az).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>{const n=yt(t),r={}
for(const t of n)r[t.id]=wf(e,t,{useCase:R3.LockupIconLarge})
return r})}async function iw(e,t){const n=new SZ(t.targetingData,e.random.nextUUID()),r=aw(e,t)
if((0,Am.isNothing)(r))return null
const o=Ln(e,r,function(e,t){const n={}
return(0,Am.isSome)(t)&&t.validAdRequest()&&(n["X-Apple-App-Store-Client-Request-Id"]=t.appStoreClientRequestId,n["X-Apple-iAd-Request-Data"]=t.requestData,n["X-Apple-iAd-Env-Name"]=t.routingInfo),{headers:n}}(0,n))
if(e.bag.mediaAPISearchFocusEnabled){const n={term:t.term.trim(),entity:t.searchEntity}
e.onDeviceSearchHistoryManager.saveRecentSearchWithLimit(n,30)}const s=async function(e,t,n,r){var o
if(!t.validAdRequest())return Zt(e,"ODML fetch skipped - Malformed request"),{adverts:[],odmlSuccess:!1}
const i=await r,s=function(e,t){const n=t.results[H_]
if((0,mm.isNothing)(n))return[]
const r=yt(n),o=[]
for(const t of r){const n=f(t,"id"),r=B(t,NB)
if((0,mm.isNothing)(n)||0===n.length||(0,mm.isNothing)(r))continue
let i,s
e.bag.enableCPPInSearchAds&&(i=Ve(Ge(e,t)),s=qe(e,t)),o.push({instanceId:e.random.nextUUID(),adamId:n,assetInformation:{},adData:r,cppIds:s,serverCppId:i,selectedCppId:i,appBinaryTraits:Ff(e,t)})}return o}(e,i),a=function(e,t,n){const r=yt(t.results.search),o=[]
for(const e of r){const t=f(e,"id");(0,mm.isNothing)(t)||0===t.length||o.push({adamId:t,assetInformation:{}})}return o}(0,i)
if(!e.isAvailable(jY))return Zt(e,"ODML fetch skipped - Unsupported client"),{adverts:s,odmlSuccess:!1}
try{if(e.clientCapabilities.isEnabled(wJ)&&e.bag.enableSRPOnDeviceAdsRanker){const t=function(e,t){const n=[],r=t.results[H_]
if((0,mm.isNothing)(r))return[]
const o=yt(r)
for(const t of o){const r=f(t,"id"),o=B(t,NB)
if((0,mm.isNothing)(r)||0===r.length||(0,mm.isNothing)(o))continue
const i=f(t.meta,"extraAdInfo"),s={instanceId:e.random.nextUUID(),adamId:r,assetInformation:{},appBinaryTraits:Ff(e,t),position:-1,adData:o,commonAdInfo:(0,mm.isSome)(i)?JSON.parse(i):[]}
n.push(s)}const i=yt(t.results.search)
for(const[t,r]of i.entries()){const o=f(r,"id")
if((0,mm.isNothing)(o)||0===o.length)continue
const i={instanceId:e.random.nextUUID(),adamId:o,assetInformation:{},appBinaryTraits:Ff(e,r),position:t,adData:void 0,commonAdInfo:void 0}
n.push(i)}return n}(e,i),r=function(e,t){const n=f(t.meta,GA)
return(0,mm.isNothing)(n)?{}:JSON.parse(n)}(0,i)
return await e.ads.processAndRankAds(t,r,n,e.bag.sponsoredSearchODMLTimeout)}{const t=await e.ads.processAdvertsForSponsoredSearch(s,a,n,e.bag.sponsoredSearchODMLTimeout,e.client.isPhone||e.client.isPad)
return t.odmlSuccess?Zt(e,"ODML processing completed"):Zt(e,"ODML processing failed"),{adverts:null!==(o=t.adverts)&&void 0!==o?o:s,odmlSuccess:t.odmlSuccess,installedStates:t.installedStates,appliedPolicy:t.appliedPolicy,appStates:t.appStates}}}catch(t){return Zt(e,`ODML fetch failed - ${t}`),{adverts:s,odmlSuccess:!1}}}(e,n,t.term,o),a=async function(e){if(function(e){switch(e){case HW:case iz:return!0
default:return!1}}(e.client.deviceType)){const t=An(e,null,null,ee(e))
if(t)return await Ln(e,t).catch(()=>null)}return null}(e)
return await Promise.all([o,s,a]).then(([o,s,a])=>{var c,l,u,d
if(function(e){var t
const n=bt(e),r=O_
i(n)&&i(e.meta)&&i(null===(t=e.meta)||void 0===t?void 0:t.metrics)&&(e.meta.metrics[fQ]=f(n,r),delete e.meta.metrics[r])}(o),null===(u=null===(l=null===(c=o.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.naturalLanguage){const t=e.storage.retrieveString($_),n=_e(new Date).getTime().toString()
e.storage.storeString($_,n),null===(d=e.amsEngagement)||void 0===d||d.enqueueData({eventType:"lastNLSQueryDateChange",app:$L,oldState:t,newState:n})}return{catalogResponse:o,categoriesFilterData:a,searchResultsAdsRequestData:n,searchResultsAdData:s,requestMetadata:{requestDescriptor:t,searchRequestUrl:ge(e,r).toString()}}})}async function sw(e,t){const n=function(e,t){const n=e.bag.isLLMSearchTagsEnabled||u(e.bag.supportedMixedMediaRequestUsecases[gW]),r=new cJ(e,t,n,[CH]).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(YW,[N_]).includingAttributes(cw(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
return Je(e,r,t),r.includingRelationships(X7),li(e)&&(r.includingAssociateKeys(az,[tz]),r.includingScopedAttributes(tz,eQ),r.includingScopedRelationships(YW,[vq])),r}(e,t)
return await Ln(e,n)}function aw(e,t){var n
const r=null===(n=t.term)||void 0===n?void 0:n.trim()
if(o(r))return null
const i=t.origin,a=t.source,c=t.searchEntity,l=t.facets,d=t.selectedFacetOptions,f=t.spellCheckEnabled,h=t.excludedTerms,p=e.host.clientIdentifier,w=new cJ(e).withSearchTerm(r).includingAdditionalPlatforms(ee(e)).includingAttributes(cw(e)).includingScopedAttributes(YW,[N_]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
if(yu(e,w),w.includingRelationships(X7),li(e)&&(w.includingAssociateKeys(az,[tz]),w.includingScopedAttributes(tz,eQ),w.includingScopedRelationships(YW,[vq])),u(e.client.isTinkerWatch)&&w.withFilter(Oj,"tinker"),w.enablingFeature(D$),w.enablingFeature(TI),s(t.guidedSearchTokens)&&w.addingQuery("selectedFacets",t.guidedSearchTokens.join(",")),s(t.guidedSearchOptimizationTerm)&&w.addingQuery("finalTerm",t.guidedSearchOptimizationTerm),e.bag.isLLMSearchTagsEnabled&&w.includingAssociateKeys("results:apps",[CH]),e.featureFlags.isEnabled($K)&&w.includingScopedAttributes(az,[NV]),c===jG?w.searchingOverTypes([YW]):c===Eq?w.searchingOverTypes([rH]):c===oz||c===nz?w.searchingOverTypes([az]).withFilter(Oj,c):w.searchingOverTypes([az,rH,SH,YW,JW,jq]),e.appleSilicon.isSupportEnabled&&!e.appleSilicon.isRosettaAvailable&&w.addingQuery("restrict","!requiresRosetta"),l)for(const e of Object.keys(l))w.addingQuery(e,l[e])
if(d)for(const e of Object.keys(d)){const t=H8.requestValuesForSelectedFacetOptions(d[e])
if(s(t)){w.addingQuery(e,t.value)
for(const e of Object.keys(t.additionalKeyValuePairs))w.addingQuery(e,t.additionalKeyValuePairs[e])}}const v=e.bag.isNaturalLanguageSearchEnabled||e.bag.isNaturalLanguageSearchResultsEnabled,g=v?"source":"src"
if(i===Nx){const e=v&&(null==a?void 0:a.length)?"hint:".concat(a):Gx
w.addingQuery(g,e)}else i===yR?w.addingQuery(g,hC):i===MU?w.addingQuery(g,MU):i===AR?w.addingQuery(g,"searchInstead"):i===TR?w.addingQuery(g,lP):i===B_&&w.addingQuery(g,tV)
switch(p){case nJ:w.addingContext(oz)
break
case rJ:w.addingContext(eW)
break
case oJ:w.addingContext(nz)}return w.addingQuery("limit[ads-result]",e.bag.mediaAdvertRequestLimit.toString()),s(e.bag.adsOverrideLanguage)&&w.enablingFeature(qA),f&&w.enablingFeature("spellCheck"),v&&w.enablingFeature(gI),w.enablingFeature("searchResultCpps"),h&&w.addingQuery("excludeTerms",h.join(",")),w}function cw(e){const t=[NV,mM,mV,tq,dj,yM,yq,nU,nD,U_,dN,TW]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),e.host.isOSAtLeast(15,5,0)&&t.push(hV),t}function lw(e,t){return ym.context("developerPageFromResponse",()=>{const n=t.data.length?t.data[0]:null
if(!n)return null
const r=Gn(e,"Artist",n.id,t),i=function(e,t,n,r){switch(e.client.deviceType){case iz:return function(e,t,n,r){var i
e.appleSilicon.isSupportEnabled?(pw(t,VH,[oj,cB]),pw(t,oj,[cB])):pw(t,VH,[oj])
const a=mW,c=R3.LockupIconSmall
let u=0
const d=[]
for(const f of dee){const h=fe(t,f),p=l(h,RV),w=p.length
if(0===w)continue
if(f===_V&&0===w)continue
const v=fw(e,f,t)
xh(0,{pageInformation:n,locationTracker:r,idType:pW,id:`${u}`,targetType:rW},v)
const g={lockupOptions:{metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:c},filter:Im.DeveloperPage},m=p.filter(e=>o(e.attributes)),y=(null===(i=h.next)||void 0===i?void 0:i.length)>0||w>=8,A=hw(e,v,t.id,p,f,a,g,n,r,h.href,y),T=A.items.length+m.length
T<3&&(A.rowsPerColumn=T)
const b={id:null,kind:null,softwareType:null,targetType:rW,title:A.title,pageInformation:n,locationTracker:r,idType:null}
if(Bh(r),Jh(e,A,b),Vh(r),m.length){const e=new wee
e.title=v,e.developerId=t.id,e.contentType=mW,e.remainingData=m,e.lockupListOptions=g,e.relationship=f,e.roomUrl=h.href,e.shouldShowSeeAll=y,e.hasExistingContent=s(A.items),A.url=`${Cz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}A.items.length>0&&(d.push(A),u++)}return d}(e,t,n,r)
case oz:return function(e,t,n,r,i,a,c){const l=we(n,r),u={lockupOptions:{metricsOptions:{pageInformation:a,locationTracker:c},artworkUseCase:R3.LockupIconSmall},filter:Im.DeveloperPage}
xh(0,{pageInformation:a,locationTracker:c,idType:pW,id:"0",targetType:rW},i)
const d=hw(e,i,n.id,l,r,t,u,a,c,null,!1),f=l.filter(e=>o(e.attributes)),h={id:null,kind:null,softwareType:null,targetType:rW,title:i,pageInformation:a,locationTracker:c,idType:null}
if(Bh(c),Jh(e,d,h),Vh(c),f.length){const e=new wee
e.title=i,e.developerId=n.id,e.contentType=t,e.remainingData=f,e.lockupListOptions=u,e.hasExistingContent=s(d.items),d.url=`${Cz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}return[d]}(e,mW,t,t1,e.loc.string(hD),n,r)
case zW:return dw(e,t,hee,n,r)
case bH:return dw(e,t,pee,n,r)
default:return dw(e,t,fee,n,r)}}(e,n,r,{rootPosition:0,locationStack:[]})
1===i.length&&(i[0].isHorizontal=!1)
const a=sh(e,n,rz)
if(a){const e=new V0(a,hH),t=new pK(OV)
t.items=[e],i.unshift(t)}const c=new gK(i)
c.title=j(n,cz),e.client.deviceType!==oz&&(c.presentationOptions=[Qj]),c.canonicalURL=j(n,BW),Vn(e,c,r)
const u=B(n,$M)
if(u){const t=df(e,u,{cropCode:"sr",useCase:R3.Uber})
c.uber=t
{const e=new pK("uber"),n=new L4(Ib)
n.artwork=t,e.items=[n],n.title=c.title,i.unshift(e),c.presentationOptions.push(jM),c.presentationOptions.push(dB)}}return c})}function uw(e,t,n){switch(t){case _V:return e.loc.string(pD)
case lB:return e.loc.string("DEVELOPER_SYSTEM_APPS")
case AU:return e.loc.string("DEVELOPER_IMESSAGE")
case aG:return e.loc.string(hD)
case cG:return e.loc.string("DEVELOPER_TV")
case JW:return e.loc.string(wD)
case uB:return e.loc.string("DEVELOPER_VISION")
case ij:const t=H(n,kb),r=H(n,Ob)
return t&&r?e.loc.string(Eb):r?e.loc.string(Db):e.loc.string(Rb)
case VH:return e.loc.string(vD)
default:return null}}function dw(e,t,n,r,i){var a,c
let u,d
switch(pw(t,VH,[ij,cG]),e.client.deviceType){case"tv":case bH:u=Kq,d=R3.LockupIconMedium
break
default:u=mW,d=R3.LockupIconSmall}let f=0
const h=[]
for(const p of n){const n=fe(t,p),w=l(n,RV),v=w.length
if(0===v)continue
if(p===_V&&0===v)continue
let g,m
g=p===AU?rJ:p===aG?nJ:p===cG?iJ:tJ,m=uw(e,p,t),xh(0,{pageInformation:r,locationTracker:i,idType:pW,id:`${f}`,targetType:rW},m)
const y={lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},clientIdentifierOverride:g,artworkUseCase:d},filter:Im.DeveloperPage},A=w.filter(e=>o(e.attributes)),T=((null===(a=n.next)||void 0===a?void 0:a.length)>0||v>=8)&&!0,b=hw(e,m,t.id,w,p,u,y,r,i,n.href,T),S=b.items.length+A.length
S<3&&(b.rowsPerColumn=S)
const P={id:null,kind:null,softwareType:null,targetType:rW,title:b.title,pageInformation:r,locationTracker:i,idType:null}
if(Bh(i),Jh(e,b,P),Vh(i),A.length){const e=new wee
e.title=m,e.developerId=t.id,e.contentType=u,e.remainingData=A,e.lockupListOptions=y,e.relationship=p,e.roomUrl=n.href,e.shouldShowSeeAll=T,e.hasExistingContent=s(b.items),b.url=`${Cz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}(b.items.length>0||(null===(c=b.url)||void 0===c?void 0:c.length)>0)&&(h.push(b),f++)}return h}function fw(e,t,n){switch(t){case _V:return e.loc.string(pD)
case JW:return e.loc.string(wD)
case oj:if(e.appleSilicon.isSupportEnabled)return e.loc.string("DEVELOPER_MAC_APPS")
{const t=H(n,kb),r=H(n,Ob)
return t&&r?e.loc.string(Eb):r?e.loc.string(Db):e.loc.string(Rb)}case cB:return e.loc.string("DEVELOPER_PHONE_PAD_APPS")
case VH:return e.loc.string(vD)
default:return null}}function hw(e,t,n,o,s,a,c,l,u,d,f){const h=new pK(a)
if(h.title=t,a===oB?(h.items=function(e,t,n){return ym.context("screenshotsLockupsFromData",()=>{if(!t)return[]
const o=[]
for(let s=0;s<t.length;s++){const a=t[s]
if(r(a.attributes)){n.contentUnavailable&&n.contentUnavailable(s,a)
continue}const c=n.lockupOptions
let l=Im.All
if(i(n.filter)&&(l=n.filter),st(e,a,l))continue
const u=Ud(e,a,c)
u.isValid()&&(o.push(u),Vh(n.lockupOptions.metricsOptions.locationTracker))}return o})}(e,o,c),h.isHorizontal=!1,h.presentationHints={showSupplementaryText:!1}):(h.items=Yd(e,o,c),h.isHorizontal=e.client.deviceType!==oz),f){const r=new uee
r.title=t,r.url=d,r.developerId=n,r.relationshipId=s,r.clientIdentifierOverride=c.lockupOptions.clientIdentifierOverride
const o=new _J(fz)
o.pageUrl=i(p=r)?`${Cz}:/${_z.developer}/${_z.room}/`+encodeURIComponent(JSON.stringify(p)):null,o.title=e.loc.string(nq),o.pageData=Ac(0,t),oa(e,o,o.pageUrl,{pageInformation:l,locationTracker:u}),h.seeAllAction=o}var p
return h}function pw(e,t,n){const o=fe(e,t)
if(r(o))return
const i=yt(o)
if(r(i))return
const s=i.map(e=>e.id)
for(const t of n){const n=fe(e,t)
if(r(n))continue
const o=yt(n)
r(n)||(e.relationships[t].data=o.filter(e=>!s.includes(e.id)))}}function ww(e,t,n,r){const o=function(e,t,n,r){const o=vw(0,n.collectionDisplayStyle)
return{...n.metricsImpressionOptions,...r,id:t.id,targetType:o}}(0,t,n,r)
return Jd(e,t,o,n.clientIdentifierOverride)}function vw(e,t){switch(t){case Nm.Hero:return UG
case Nm.TextOnly:return VM
case Nm.TextWithArtwork:return"textWithArtwork"
case Nm.BrickSmall:return"brickSmall"
case Nm.BrickMedium:return"brickMedium"
case Nm.BrickLarge:return"brickLarge"
case Nm.EditorialLockupMedium:case Nm.EditorialLockupMediumVariant:return"editorialLockupMedium"
case Nm.EditorialLockupLarge:case Nm.EditorialLockupLargeVariant:return"editorialLockupLarge"
case Nm.LockupSmall:return TU
case Nm.LockupLarge:return"lockupLarge"
case Nm.StorySmall:return"storySmall"
case Nm.StoryMedium:return"storyMedium"
case Nm.BreakoutLarge:return fB
default:return KW}}function gw(e,t,n){let r=null,s=null,a=[]
const c=kn(0,t)
switch(t.type){case YW:case Wq:case lG:a=["enrichedEditorialNotes.badge",cj,Gq],r=Sw(e,t,a,!1),s=Sw(e,c,a,!1)
break
case az:case jq:case JW:a=[cj],r=Sw(e,t,a,!0),s=Sw(e,c,a,!0)}const l=i(s)?s:r
return o(l)?null:l}function mw(e,t,n){let r=null,s=[]
switch(n){case sB:case iB:switch(t.type){case YW:case Wq:case lG:s=[mD,oH],r=Tw(t,s)
break
case az:case jq:case JW:s=[iH],r=Sw(e,t,s,!0)}break
default:switch(t.type){case YW:case Wq:case lG:s=[mD,oH],r=Sw(e,t,s,!1)
break
case CH:case az:case jq:case JW:s=[cz],r=Sw(e,t,s,!1)}}const a=Sw(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function yw(e,t,n=!1){let r=null,s=[]
switch(t.type){case YW:n?s=[Mb,iH]:H(t,yD)||(s=["enrichedEditorialNotes.short",AD]),r=Sw(e,t,s,!1)
break
case Wq:case lG:s=[Mb,iH],r=Sw(e,t,s,!1)
break
case az:case jq:case JW:s=[iH],r=Sw(e,t,s,!0)}const a=Sw(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Aw(e,t){let n=null,r=[]
switch(t.type){case YW:case Wq:case lG:r=[Fb,Px],n=Sw(e,t,r,!1)
break
case az:case jq:case JW:r=[Fb,Px],n=Sw(e,t,r,!0)}const o=Sw(e,kn(0,t),r,!1)
let i=null
return i=(null==o?void 0:o.length)>0?o:s(n)?n:e.loc.string(TD),i}function Tw(e,t){return o(e)?null:j(e,t)}function bw(e,t,n){return o(e)?null:ce(e,t,n)}function Sw(e,t,n,r){if(o(t))return null
const i=tt(e,t)
for(const e of n){const n=r?bw(t,i,e):Tw(t,e)
if(s(n))return n}return null}function Pw(e,t,n){const r={}
Nh(0,n.metricsOptions,bD)
const a=Pd(e,t,n)
Bh(n.metricsOptions.locationTracker)
const c=Cd(e,t,n)
return s(a)&&(a.length>1||o(c))?r.collectionIcons=a:i(c)&&(r.lockup=c,r.collectionIcons=[c.icon]),r}function Cw(e,t,n,r){const o=[],s=new pK(r)
s.isHorizontal=j(t.data,wB)===fG
const a=Cn(0,t)
for(const r of a){const i={...t.metricsImpressionOptions,targetType:vw(0,n),recoMetricsData:bt(r)}
if(r.attributes&&!jw(t)){{const n=Iw(e,r,t.collectionDisplayStyle,i,i,t.clientIdentifierOverride),s=j(r,Dq)===QM,a=gh(e,r)
if(n.clickAction=ww(e,s&&a?a:r,t),!n.isValid())continue
o.push(n)}Vh(t.metricsImpressionOptions.locationTracker)}else t.remainingItems.push(r),t.isDeferring=!0}return i(t.presentationHints)&&(s.presentationHints=t.presentationHints),delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=o,s.rowsPerColumn=q(t.data,mB),s.url=Vw(0,0,t),ac(e,s,t),s}function Iw(e,t,n,r,i,a){const c=new A5,l=On(0,t)
if(!u(l.hideEditorialMedia)){const r=Sd(e,t,n);(0,Am.isSome)(null==r?void 0:r.artwork)&&(c.artworks=[r.artwork],c.isMediaDark=Ad(0,r)),(0,Am.isSome)(null==r?void 0:r.rtlArtwork)&&(c.rtlArtwork=null==r?void 0:r.rtlArtwork,c.isRTLMediaDark=Ad(0,r,!0))}const d={metricsOptions:i,clientIdentifierOverride:a,artworkUseCase:R3.Default,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:aa(0,t)}
if(Nh(0,d.metricsOptions,bD),c.collectionIcons=Pd(e,t,d),Bh(d.metricsOptions.locationTracker),o(c.collectionIcons)){const n=wf(e,t,{useCase:R3.Default})
s(n)&&(c.collectionIcons=[n])}c.caption=gw(e,t),c.title=mw(e,t,n),c.subtitle=yw(e,t),c.accessibilityLabel=c.title,c.editorialDisplayOptions=En(l)
const f=s(c.artworks)?sH:"collection_id",h={...r,id:t.id,idType:f}
return Jh(e,c,ep(e,t,c.title,h)),c.artworkSafeArea=T5.defaultTileArtworkSafeArea,c.textSafeArea=T5.defaultTileTextSafeArea,c}function kw(e,t,n,r){const o=new h6
o.overlayType=gl(e,t),o.displayOptions={horizontalPlacement:QW,textAlignment:QW,isOverDarkContent:Al(e,t)},o.badgeText=gw(e,t,Nm.Hero),o.titleText=mw(e,t,Nm.Hero),r.suppressTagline||(o.descriptionText=yw(e,t,!0)),o.callToActionText=Aw(e,t),o.buttonTitle=yl(e,t)
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:TU,recoMetricsData:bt(t)},metricsClickOptions:{id:t.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,actionDetails:{franchise:o.badgeText}},artworkUseCase:R3.LockupIconSmall,offerEnvironment:MW,canDisplayArcadeOfferButton:wh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:aa(0,t)},c=Cd(e,t,a),l=Pw(e,t,a)
o.lockup=l.lockup,o.collectionIcons=l.collectionIcons
const u=j(t,Gq)
s(u)&&i(c)&&(c.heading=u)
const d=(0,Am.isSome)(r.suppressLockup)&&r.suppressLockup
if(s(o.lockup)&&!d)o.clickAction=o.lockup.clickAction,o.impressionMetrics=o.lockup.impressionMetrics
else{const r={targetType:UG,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t)},i={...r,id:t.id,actionDetails:{franchise:o.badgeText}}
o.clickAction=Qd(e,t,i,n.clientIdentifierOverride),Jh(e,o,ep(e,t,o.titleText,r))}return o}function Ow(e,t,n,r,o){if(!n){const e=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor
t.backgroundColor=e
const n=o?null==r?void 0:r.rtlArtworkData:null==r?void 0:r.artworkData
t.titleEffect=Jc(0,n)
const i=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork
t.artwork=i
const s=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video
t.video=s}t.isMediaDark=Ad(0,r,o)}function Ew(e){return{isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}}function Dw(e,t,n,a,c){if(o(t))return null
let l
n.showOrdinals&&(l=e.loc.decimal(n.ordinalIndex))
let u,d=null
!i(n.shelfBackground)||n.shelfBackground.type!==wH&&n.shelfBackground.type!==qM||(d=lW),s(n)&&(u=n.clientIdentifierOverride)
const f={ordinal:l,metricsOptions:{...{...n.metricsImpressionOptions,id:t.id,idType:yW},recoMetricsData:bt(t),isAdvert:Ut(0,t),targetType:vw(0,c)},clientIdentifierOverride:u,artworkUseCase:R3.Default,offerStyle:d,canDisplayArcadeOfferButton:wh(0,c),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(Gm.ShowOnlyPreorder)}
let h
switch(c){case sB:case mU:case iB:case gU:f.offerEnvironment=iW,h=Vd(e,t,f,c)
break
case"Poster":h=Gd(e,t,f)
break
default:h=Nd(e,t,f)}return r(h)||!h.isValid()?null:(h.id=lf(n.id,a,h.adamId),h)}function Rw(e,t){return Fw(e,t,Nm.EditorialLockupHierarchicalPortrait,Mj,!0,Um.Vertical)}function _w(e,t){return Fw(e,t,Nm.EditorialLockupLarge,Ix)}function Lw(e,t,n=!0,r){return e.featureFlags.isEnabled(DK)&&(t.showOrdinals=!0),Fw(e,t,Nm.LockupSmall,mW,n,r)}function Mw(e,t,n=!0){return Fw(e,t,Nm.LockupLarge,hU,n)}function Fw(e,t,n,o,i=!0,s){const a=[],c=new pK(o),l=null!=s?s:Pn(t)
c.isHorizontal=l===Um.Horizontal
const u=Cn(0,t),d=void 0
for(const[o,i]of u.entries()){if(i.type===tz)return null
if(r(i.attributes)||jw(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}if(st(e,i,Im.All))continue
if((null==t?void 0:t.filterOverrides.includes(Gm.ShowOnlyPreorder))&&!H(i,uW))continue
let o=null
if(o=Dw(e,i,t,a.length,n),o&&(a.push(o),Vh(t.metricsImpressionOptions.locationTracker),t.ordinalIndex++,a.length===d))break}if(n!==Nm.EditorialLockupMediumVariant&&n!==Nm.EditorialLockupLargeVariant||(r(c.presentationHints)?c.presentationHints={showSupplementaryText:!0}:c.presentationHints={...c.presentationHints,showSupplementaryText:!0}),delete t.maxItemCount,c.eyebrow=t.eyebrow,c.eyebrowArtwork=t.eyebrowArtwork,c.title=t.title,c.subtitle=t.subtitle,c.items=a,c.rowsPerColumn=q(t.data,mB),c.shouldFilterApps=!t.filterOverrides.includes(Gm.ShowInstalled),c.url=Vw(0,0,t),i){let n=d;(0,mm.isSome)(d),ac(e,c,t,n)}return c}function $w(e,t,n,r,o,a,c){var l,d,f
const h=On(0,t),p=new I5
if(p.title=mw(e,t,o),h.suppressShort||(p.description=yw(e,t)),!u(h.hideEditorialMedia)){const r=wd(e,t,n)
if(p.artwork=null==r?void 0:r.artwork,p.video=null==r?void 0:r.video,p.isMediaDark=null!==(l=Ad(0,r))&&void 0!==l?l:void 0,n===fy.StoryDetail){const n=wd(e,t,fy.StoryDetailLandscape)
p.landscapeArtwork=null==n?void 0:n.artwork,p.landscapeVideo=null==n?void 0:n.video,p.isLandscapeMediaDark=null!==(d=Ad(0,n))&&void 0!==d?d:void 0}}const w=Pw(e,t,{metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,recoMetricsData:bt(t)},artworkUseCase:R3.LockupIconSmall,offerEnvironment:h.useMaterialBlur?iW:hG,canDisplayArcadeOfferButton:wh(0,o),isContainedInPreorderExclusiveShelf:null!==(f=null==c?void 0:c.filterOverrides.includes(Gm.ShowOnlyPreorder))&&void 0!==f&&f,externalDeepLinkUrl:aa(0,t),useJoeColorIconPlaceholder:!1}),v=a&&u(h.suppressLockup)
v||(p.lockup=w.lockup)
const g=In(e,t)
if(H(g,uW),ih(e,g),s(g)&&!v&&st(e,g,Im.All)&&n!==fy.StoryDetail)return null
let m
if(m=gw(e,t),p.badge={type:WH,title:m},p.collectionIcons=w.collectionIcons,i(c)){const n={id:t.id,pageInformation:c.metricsPageInformation,locationTracker:c.metricsLocationTracker,actionDetails:{franchise:p.badge.title},idType:pG}
p.clickAction=ww(e,t,c,n)}p.editorialDisplayOptions=En(h)
const y={...r,id:t.id,idType:pG}
return Jh(e,p,ep(e,t,p.title,y)),p}function xw(e,t,n,o){const i=[],s=new pK(o),a=Pn(t)
s.isHorizontal=a===fG
const c=Cn(0,t)
for(const o of c){const s={...t.metricsImpressionOptions,targetType:vw(0,n),recoMetricsData:bt(o)}
if(!W(o)||jw(t)){t.remainingItems.push(o),t.isDeferring=!0
continue}let a=null
a=$w(e,o,fy.StoryCard,s,t.collectionDisplayStyle,!0,t),r(a)||(i.push(a),Vh(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=i,s.rowsPerColumn=q(t.data,mB),s.url=Vw(0,0,t),ac(e,s,t),s}function Nw(e,t,n){const r=_n(0,t)
o(r)||(n.displayStyle=r)}function Bw(e,t,n,r,o,i,s,a=!1,c=null){const l={id:f(n,"id"),type:n.type,collectionDisplayStyle:null!=c?c:_n(0,n),filterOverrides:G(n,"filterOverrides"),pageId:t,data:n,presentationHints:{},clientIdentifierOverride:void 0,isFirstRender:!0,shouldFilter:!0,gamesFilter:Gw(n),hasExistingContent:!1,title:null,subtitle:void 0,eyebrow:void 0,titleArtwork:void 0,remainingItems:[],metricsImpressionOptions:null,metricsPageInformation:i,metricsLocationTracker:s,recoMetricsData:is(e,n),isDeferring:!1,showOrdinals:!1,ordinalIndex:1,isSearchLandingPage:!1,isArcadePage:r,shelfIndex:o,isSeeAll:a}
return Uw(e,n,l),l}function Uw(e,t,n){let r=j(t,oH),o=j(t,iH),i=j(t,cj),a=null,c=!1
const l=pe(e,t,dG)
s(l)&&(i=e.loc.uppercased(j(t,oH)),r=j(l,oH),a=wf(e,l,{useCase:R3.LockupIconSmall}),o=null,c=!0)
const u=function(e,t,n,r,o){const i=t.type,s=_n(0,t),a={id:f(t,"id"),kind:null,softwareType:null,targetType:rW,title:n,pageInformation:r,locationTracker:o,idType:$b,shelfType:i,recoMetricsData:bt(t),canonicalId:f(t.meta,pB)}
switch(i){case xm.Collection:Nw(0,t,a),s===Nm.Hero&&function(e,t){t.title=eV
const n=Ew(e)
t.autoAdvanceInterval=n.autoScrollInterval}(e,a)
break
case xm.Recommendations:Nw(0,t,a)}return a}(e,t,c?i:r,n.metricsPageInformation,n.metricsLocationTracker)
n.title=r,n.subtitle=o,n.eyebrow=i,n.titleArtwork=a,n.metricsImpressionOptions=u}function Gw(e){let t
switch(j(e,"clientFilter")){case jm.ArcadeGames:t=nz
break
case jm.AllGames:t="all"}return t}function jw(e){return e&&e.isDeferring&&e.isFirstRender}function Vw(e,t,n){return o(n)?null:(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?function(e){return(new oY).set(DV,Cz).append(aH,_z.editorialPage).append(aH,_z.shelf).param(Hz.token,encodeURIComponent(JSON.stringify(e))).build()}(n):null}function Hw(e,t,n){if(o(n)||o(t))return null
if(function(e){if(e.isSeeAll)return!1
switch(e.collectionDisplayStyle){case Nm.BreakoutLarge:case Nm.Poster:return!1}return!e.filterOverrides.includes(Gm.ShowOnlyPreorder)||!1}(n)){const r=new _J(fz)
if(!uc(t)){const o=`shelf_${n.id}`
r.pageData=function(e,t,n,r,o){const i=Ww(e,void 0,(_n(0,t.data),Bw(e,t.pageId,t.data,t.isArcadePage,t.shelfIndex,t.metricsPageInformation,{rootPosition:0,locationStack:[]},!0,null)))
if((0,mm.isNothing)(i))return null
let s
i.title=null,i.eyebrow=null,i.isHorizontal=!1,i.id=r,s=new O6(null,t.title,null)
const a=new pK(WM)
a.id=SD,a.items=[s]
const c=new gK([a,i])
return c.isIncomplete=!(null!=o&&o),(0,mm.isNothing)(c.pageMetrics.pageFields)&&(c.pageMetrics.pageFields={}),c}(e,n,t.contentType,o,(0,mm.isSome)(n.recommendationsHref))}const o={}
n.type===xm.Recommendations&&(o[Hz.editorialPageId]=n.pageId),r.pageUrl=ji(e,n.data.href,o),r.title=e.loc.string(nq),r.referrerUrl=n.metricsPageInformation.pageUrl
const i=function(e){const t=[]
for(const n of e.locationStack)t.push({...n})
return{rootPosition:e.rootPosition,locationStack:t}}(n.metricsLocationTracker)
return jh(i,0),oa(e,r,n.seeAllUrl,{pageInformation:n.metricsPageInformation,locationTracker:i}),r}return null}function qw(e,t,n,r,o){n||(t.backgroundColor=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor,t.artwork=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork,t.video=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video),t.isMediaDark=Ad(0,r,o)}function Ww(e,t,n){let a=null
switch(n.isFirstRender&&xh(0,n.metricsImpressionOptions,n.title),n.type){case xm.ArcadeSeeAllGames:a=function(e,t){const n=new g5,o=new pK(gD)
o.items=[n]
const i={targetType:xb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(ex),id:t.id,kind:CD,softwareType:dW}
Jh(e,n,i),xh(0,i,i.title),n.buttonAction=io(e,XU,t.metricsPageInformation,t.metricsLocationTracker)
const a={targetType:lz,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:n.buttonAction.title,id:"SeeAllGames",kind:lz,softwareType:dW}
Jh(e,n.buttonAction,a),Bh(i.locationTracker)
const c=e.bag.termsAndConditionsURL
if(!r(c)&&"tv"!==e.client.deviceType){const t=e.loc.string(ID),r=new HJ(c),o=new m5(t)
o.clickAction=r,o.presentationStyle=[zM,YM,JM],n.footnote=o}o.background={type:wH,color:Se(zE)}
const l=Cn(0,t)
if(s(l)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
n.icons=hf(e,l,r,{useCase:R3.LockupIconMedium})}else n.icons=[]
return o}(e,n)
break
case xm.Collection:a=function(e,t){let n=j(t.data,Aq)
if(o(n))return null
let a=null
switch(n){case Nm.Hero:a=function(e,t){if(0!==t.shelfIndex)return null
const n=new pK(eV),r=new j5
r.autoScrollConfiguration=Ew(e)
const o=Cn(0,t)
for(const n of o){const o=Dn(e,n)
if(Rn(0,n)&&!W(o)||jw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i={...t.metricsImpressionOptions,idType:sH,targetType:UG,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(n)},s=wd(e,n,fy.Hero),a=Pw(e,n,{metricsOptions:i,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:R3.Default,offerEnvironment:hG,canDisplayArcadeOfferButton:!0}),c=new V5,l=fl(0,n),d=mw(e,n,Nm.Hero),f=ep(e,n,d,i)
f.isPreorder=Xe(e,l,uW),Jh(e,c,f),xh(0,f,d)
const h=On(0,n),p=u(h.hideEditorialMedia)
c.overlay=kw(e,n,t,h),c.collectionIcons=a.collectionIcons,c.editorialDisplayOptions=En(h),Ow(0,c,p,s,!1),c.isValid()&&r.items.push(c)
const w=S(c)
Ow(0,w,p,s,!0),w.isValid()&&r.rtlItems.push(w),Bh(f.locationTracker),Vh(f.locationTracker)}return delete t.maxItemCount,n.isHorizontal=!1,n.eyebrow=t.eyebrow,n.eyebrowArtwork=t.eyebrowArtwork,n.title=t.title,n.subtitle=t.subtitle,n.items=[r],n.url=Vw(0,0,t),n}(e,t)
break
case Nm.TextOnly:a=function(e,t){var n
const o=[],i=new pK(aW)
i.isHorizontal=j(t.data,wB)===Um.Horizontal
const s=Cn(0,t)
for(const n of s){if(r(n.attributes)||jw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=ww(e,n,t)
i.title=mw(e,n,t.collectionDisplayStyle)
const s={...t.metricsImpressionOptions,id:n.id,idType:pG,targetType:VM}
Jh(e,i,ep(e,n,i.title,s)),o.push(i),Vh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,mB))&&void 0!==n?n:1,i.url=Vw(0,0,t),ac(e,i,t),i}(e,t)
break
case Nm.TextWithArtwork:a=function(e,t){var n
const o=[],i=new pK(aW)
i.isHorizontal=j(t.data,wB)===Um.Horizontal
const a=Cn(0,t)
for(const n of a){if(r(n.attributes)||jw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=ww(e,n,t)
let a
i.title=mw(e,n,t.collectionDisplayStyle),a=B(n,XW),s(a)&&(i.artwork=df(e,a,{allowingTransparency:!0,useCase:R3.CategoryIcon})),o.push(i),Vh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,mB))&&void 0!==n?n:1,i.url=Vw(0,0,t),ac(e,i,t),i}(e,t)
break
case Nm.BrickSmall:a=function(e,t){return Cw(e,t,Nm.BrickSmall,"smallBrick")}(e,t)
break
case Nm.BrickMedium:a=function(e,t){return Cw(e,t,Nm.BrickMedium,sj)}(e,t)
break
case Nm.BrickLarge:a=function(e,t){return Cw(e,t,Nm.BrickLarge,"largeBrick")}(e,t)
break
case Nm.EditorialLockupHierarchicalPortrait:a=Rw(e,t)
break
case Nm.EditorialLockupHierarchicalRows:a=function(e,t){return Fw(e,t,Nm.EditorialLockupHierarchicalRows,Mj,!0,Um.Vertical)}(e,t)
break
case Nm.EditorialLockupMedium:a=function(e,t){return Fw(e,t,Nm.EditorialLockupMedium,Mj)}(e,t)
break
case Nm.EditorialLockupMediumVariant:a=function(e,t){return Fw(e,t,Nm.EditorialLockupMediumVariant,Mj)}(e,t)
break
case Nm.EditorialLockupLarge:a=_w(e,t)
break
case Nm.EditorialLockupLargeVariant:a=function(e,t){return Fw(e,t,Nm.EditorialLockupLargeVariant,Ix)}(e,t)
break
case Nm.LockupMedium:a=function(e,t){return t.metricsImpressionOptions.shouldOmitImpressionIndex=!0,Fw(e,t,Nm.LockupMedium,Kq)}(e,t)
break
case Nm.Poster:a=function(e,t){const n=Fw(e,t,Nm.Poster,SU)
return(0,mm.isSome)(n)&&(n.horizontalScrollTargetBehavior=my.CenterAligned),n}(e,t)
break
case Nm.StorySmall:a=function(e,t){return xw(e,t,Nm.StorySmall,mH)}(e,t)
break
case Nm.StoryMedium:a=function(e,t){return xw(e,t,Nm.StoryMedium,yB)}(e,t)
break
case Nm.LockupSmall:a=Lw(e,t)
break
case Nm.LockupLarge:a=Mw(e,t)
break
case Nm.BreakoutLarge:a=function(e,t){const n=[],r=new pK(bx)
r.isHorizontal=j(t.data,wB)===fG
const s=Cn(0,t)
for(const r of s){const s=Dn(e,r)
if(Rn(0,r)&&!W(s)||jw(t)){t.isDeferring=!0,t.remainingItems.push(r)
continue}const a={targetType:fB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(r)},c=On(0,r),l=u(c.hideEditorialMedia)?null:Sd(e,r,t.collectionDisplayStyle),d=Pw(e,r,{metricsOptions:a,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:R3.Default,offerEnvironment:hG,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:aa(0,r)})
if(o(l)&&o(d.collectionIcons))continue
const f=gw(e,r,t.collectionDisplayStyle),h=i(f)?{type:WH,title:f}:{type:wW,title:null},p=new n6(mw(e,r,t.collectionDisplayStyle),yw(e,r,!0),h,null),w=new v6(p,{position:QW,wantsBlur:!0},null,null==l?void 0:l.artwork,null==l?void 0:l.video,d.collectionIcons,null==l?void 0:l.backgroundColor)
w.rtlArtwork=null==l?void 0:l.rtlArtwork,w.rtlVideo=null==l?void 0:l.rtlVideo,w.rtlBackgroundColor=null==l?void 0:l.rtlBackgroundColor
const v={...a,id:r.id,idType:sH}
Jh(e,w,ep(e,r,w.details.title,v))
const g=ww(e,r,t)
i(g)&&(g.title=Aw(e,r)),w.details.callToActionButtonAction=g,w.clickAction=g,w.editorialDisplayOptions=En(c),w.lockup=d.lockup,w.isMediaDark=Ad(0,l),w.isRTLMediaDark=Ad(0,l,!0),n.push(w)}return delete t.maxItemCount,r.eyebrow=t.eyebrow,r.eyebrowArtwork=t.eyebrowArtwork,r.title=t.title,r.subtitle=t.subtitle,r.items=n,r.rowsPerColumn=q(t.data,mB),r.url=Vw(0,0,t),ac(e,r,t),r}(e,t)}return s(a)&&(a.seeAllAction=Hw(e,a,t),a.id=`shelf_${t.id}`),a}(e,n)
break
case xm.Chart:a=function(e,t){let n
if(t.showOrdinals=!0,n=Lw(e,t,!1,Um.Horizontal),!(0,mm.isNothing)(n))return n.url=Vw(0,0,t),ac(e,n,t),function(e,t,n){e.featureFlags.isEnabled(SK)?(0,mm.isSome)(t.header)?function(e,t,n){e.featureFlags.isEnabled(SK)?t.titleAction=n:t.accessoryAction=n}(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}(e,n,function(e,t){const n=j(t.data,mq),r=j(t.data,sW),o=new _J(fz)
return o.pageUrl=Jf(e,n,r),o.title=e.loc.string(nq),o.referrerUrl=t.metricsPageInformation.pageUrl,oa(e,o,o.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),o}(e,t)),n}(e,n)
break
case xm.Tag:case xm.Engagement:case xm.Text:case xm.Image:case xm.VideoClip:a=null
break
case xm.Header:a=function(e,t,n){var r,o,i
const a=s(B(n.data,nH))?n.data:t
if(!a)return null
if(s(B(a,RW))){const t=new j5,r=new V5,o=On(0,a),i=kw(e,a,n,o)
i.overlayType=WH,i.callToActionText=null,r.clickAction=null,i.collectionIcons=null,i.lockup=null,i.callToActionText=null,r.overlay=i
const s={artworkUseCase:R3.LockupIconSmall,offerStyle:wV,offerEnvironment:MW,canDisplayArcadeOfferButton:wh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(Gm.ShowOnlyPreorder),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(a)},externalDeepLinkUrl:aa(0,a)}
Nh(0,s.metricsOptions,bD)
const c=Pd(e,a,s)
Bh(s.metricsOptions.locationTracker),r.collectionIcons=c
const l=wd(e,a,fy.Hero),d=u(o.hideEditorialMedia)
qw(0,r,d,l,!1),r.editorialDisplayOptions=En(o),t.items=[r]
const f=S(r)
qw(0,f,d,l,!0),t.rtlItems=[f]
const h=new pK(eV)
return h.items=[t],h}{const t=(0,bm.attributeAsString)(a,cz)
if(s(t)&&Wi(e,null)){const s=new pK(Sx)
s.id=Sx
const c=null!==(r=(0,bm.attributeAsString)(a,cj))&&void 0!==r?r:null,l={artworkUseCase:R3.LockupIconSmall,offerStyle:wV,offerEnvironment:MW,canDisplayArcadeOfferButton:wh(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(Gm.ShowOnlyPreorder),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(a)},externalDeepLinkUrl:aa(0,a),useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:Th}
let u,d=null!==(o=Pd(e,n.data,l))&&void 0!==o?o:void 0
if((0,Am.isSome)(d)&&(null==d?void 0:d.length)>=3){d=d.slice(0,3)
const r=d[0].backgroundColor;(0,Am.isSome)(r)&&(null==r?void 0:r.type)===PH&&(u=mh(r))
const o=be(u),l=On(0,n.data),f=new E6(c,t,null,void 0,void 0,d,!1,null!=u?u:void 0,function(e,t){if(2===t)return KM
switch(e){case Lj:return Cx
case kD:return"Fan"
case Nb:return ZM
default:return Cx}}(null!==(i=l.fallbackDisplayStyleHint)&&void 0!==i?i:Lj,null==d?void 0:d.length),o?MW:iW),h=function(e,t,n,r){return ym.context(SR,()=>{const o=Ih(e,t),i=Ch(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:sH,targetType:"tagHeader"}})}(e,a,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(a)})
return function(e,t,n){if(!t)return
const r=new qJ(Yh(e,n))
delete r.fields.impressionIndex,t.impressionMetrics=r}(e,f,h),s.items=[f],s}return null}return null}}(e,t,n)
break
case xm.Recommendations:a=function(e,t){let n=null
switch(j(t.data,Aq)){case Nm.LockupSmall:n=Lw(e,t,!1)
break
case Nm.LockupLarge:n=Mw(e,t,!1)
break
case Nm.EditorialLockupHierarchicalPortrait:n=Rw(e,t)
break
case Nm.EditorialLockupLarge:n=_w(e,t)
break
default:n=t.isFirstRender?function(){const e=new pK(gB)
return e.isHidden=!0,e}():null}return(0,mm.isNothing)(n)?null:(n.id=`shelf_${t.id}`,function(e,t){const n=s(we(t.data,sz))||s(t.remainingItems),r=H(t.data,"isPersonalizationAvailable"),o=t.data.href
if(!r||n||!s(o))return
const i=ge(e,new cJ(e,t.data.href).addingQuery(Hz.editorialPageId,t.pageId).includingRelationships([sz]))
t.recommendationsHref=i.toString()}(e,t),n.url=Vw(0,0,t),ac(e,n,t),n.seeAllAction=Hw(e,n,t),n)}(e,n)
break
case xm.GameCenter:a=null
break
case xm.Upsell:a=function(e,t){const n=po(e,t.data)
if(o(n))return null
const r=n.marketingItemData
if(o(r)||o(r.attributes))return null
const i=Kc(e,r,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:Lh(0,r)})
Vh(t.metricsLocationTracker)
const s=new pK(ej)
return s.items=[i],s}(e,n)
break
case xm.Marker:a=function(e,t){const n=j(t.data,Dq)
if(o(n))return null
let r=null
switch(n){case Bm.QuickLinks:r=function(e,t){if(e.user&&e.user.isManagedAppleID)return null
{const n=[]
if((0,Am.isSome)(e.bag.aboutAppStoreUrl)){const t=new HJ(e.bag.aboutAppStoreUrl)
t.title=e.loc.string("QuickLinks.AboutTheAppStore.Title"),n.push(t)}if((0,Am.isSome)(e.bag.aboutInAppPurchasesEditorialItemId)){const t=new _J(vW)
t.title=e.loc.string("QuickLinks.AboutInAppPurchases.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutInAppPurchasesEditorialItemId}`,n.push(t)}if((0,Am.isSome)(e.bag.reportProblemUrl)){const t=new HJ(e.bag.reportProblemUrl)
t.title=e.loc.string(Ub,"Report a Problem"),n.push(t)}if((0,Am.isSome)(e.bag.requestARefundUrl)){const t=new HJ(e.bag.requestARefundUrl)
t.title=e.loc.string("QuickLinks.RequestARefund.Title"),n.push(t)}if((0,Am.isSome)(e.bag.changePaymentMethodUrl)){const t=new HJ(e.bag.changePaymentMethodUrl)
t.title=e.loc.string("QuickLinks.ChangePaymentMethod.Title"),n.push(t)}if((0,Am.isSome)(e.bag.aboutFrenchAppStoreEditorialItemId)){const t=new _J(vW)
t.title=e.loc.string("QuickLinks.AboutFrenchAppStore.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutFrenchAppStoreEditorialItemId}`,n.push(t)}const r=new pK(aW)
return r.title=e.loc.string("QuickLinks.Title"),r.items=n,r.isHorizontal=!0,r.rowsPerColumn=1,t.metricsImpressionOptions.title=r.title,r}}(e,t)
break
case Bm.GameCenterFriendsArePlaying:r=null}return r}(e,n)}return o(null==a?void 0:a.items)&&o(null==a?void 0:a.url)&&(a=null),n.isFirstRender&&Bh(n.metricsImpressionOptions.locationTracker),Jh(e,a,n.metricsImpressionOptions),n.isFirstRender&&Vh(n.metricsImpressionOptions.locationTracker),(0,Am.isSome)(a)&&function(e,t,n){if((0,mm.isNothing)(t.url)||(0,mm.isNothing)(t.impressionMetrics)||!n.showingPlaceholders)return
const o=t.url
try{const e=oY.from(o).query[Hz.token],n=JSON.parse(decodeURIComponent(e))
n.originalPlaceholderShelfImpressionMetrics=t.impressionMetrics,function(e,t,n){const o=oY.from(t.url),i=oY.from(Vw(0,0,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,t,n)}catch{t.url=o}}(0,a,n),a}function zw(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},r=po(e,t.data)
return(0,mm.isNothing)(r)||0===Object.keys(r).length?null:Wd(e,r,n,ht(qU),AV,PD)}function Yw(e,t){const n=[RW,TW,Xj],r=[...n,aj,gH,vU,Tx],o=[...n,vU],i=[...n,yq,NV,mV,gH,XH,yq,wq]
e.appleSilicon.isSupportEnabled&&i.push(bq),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([bW])
const s=[...i]
t.includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).enablingFeatures(["personalization","supportsCustomTextColor"]).includingRelationshipsForUpsell(!0).includingScopedAttributes(YW,r).includingScopedAttributes(Wq,o).includingScopedAttributes(az,s)}function Jw(e){const{platform:t,...n}=e
return{...n,$kind:Aee,platform:lt(t)}}function Kw(e,t,n){var r
const o=function(e,t){switch(t){case Dee:return"badge_hardware"
case Ree:return"badge_trial_eligible"
default:return null}}(0,t),i={offerHints:o},s=new dQ(nz,ht(lV),e.bag.metricsTopic,null,i)
s.metricsOverlay={...s.metricsOverlay,...n}
const a=null===(r=e.metricsIdentifiersCache)||void 0===r?void 0:r.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical])
if((0,mm.isSome)(a)&&(s.metricsOverlay={...s.metricsOverlay,...a}),e.bag.arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled&&lr(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new _J(lU),t=WB
e.pageData=t,e.presentationContext=$V,s.purchaseSuccessAction=e}const c=new _J(vV)
return c.pageData=s,c}async function Zw(e,t){const n=t.eventString,r=t.featuresDictionary
if(!i(r))return await Promise.reject("Received non-defined engagement features.")
const o=function(e,t,n,r){switch(t){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t,n){const r=[]
for(const e of _ee)if(e in t){const t=new Oee(e,!1)
r.push(t)}for(const o of _ee){if(n.includes(o)&&!e.bag.unrestrictedServerSideTabBadging)continue
const s=t[o]
if(i(s)){const t=Kw(e,o,s)
r.push(t)
break}}if(r.length>0)return new kee(new rZ(r))
{const e=new Pz
return new kee(e)}}(e,n,r)
case"didBecomeArcadeTrialEligible":if(!e.bag.enableArcadeTrialEligibleBadging)return e.console.log(`Bag prohibits badging for identifier ${Ree}`),new kee(new Pz)
if(r.includes(Ree))return e.console.log(`Badging identifier ${Ree} was previously invalidated.`),new kee(new Pz)
const t=new Oee(Ree,!0),o=new Eee(nz,e.loc.decimal(1)),s=new rZ([t,o])
return new kee(s)
case"didSubscribeToArcade":return function(e){const t=[]
for(const e of _ee){const n=new Oee(e,!1)
t.push(n)}const n=new rZ(t)
return new kee(n)}()
case"didBecomeSubscribed":if(!i(n[Ree]))return new kee(new Pz)
const a=new Oee(Ree,!1)
return new kee(a)
case"didBecomeNonSubscribed":return new kee(new Pz)
default:return null}}(e,n,r,i(t.previouslyDisabledFeatures)?t.previouslyDisabledFeatures:[])
return i(o)?await Promise.resolve(o):await Promise.reject("Did not receive a valid engagement event.")}async function Qw(e,t){var n
const r=function(e,t,n,r){if(!_ee.includes(t))return null
let o=null
if(n&&e.bag.unrestrictedServerSideTabBadging){const t=e.loc.decimal(1)
o=new Eee(nz,t)}else if(n&&!r.includes(t)){const t=e.loc.decimal(1)
o=new Eee(nz,t)}else n||(o=new Eee(nz,null))
return new kee(o)}(e,t.identifier,t.isEnabled,null!==(n=t.previouslyDisabledFeatures)&&void 0!==n?n:[])
return i(r)?await Promise.resolve(r):await Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${t.identifier}, featuresDictionary: ${JSON.stringify(t.featuresDictionary)}, previouslyDisabledFeatures: ${t.previouslyDisabledFeatures}`))}async function Xw(e,t){return await e.required(R9).fetchPage(e,t,MJ)}async function ev(e,t){const n=new cJ(e).withIdOfType(t,TF),r=Ln(e,n)
return await r.then(t=>function(e,t){return ym.context("msoProviderDataFromData",()=>{const n=mt(e,t),r=j(n,cz),o=j(n,BW),i=function(e,t){return ym.context("msoProviderArtworkFromData",()=>{const n=B(t,"editorialArtwork.storeFlowcase")
if(n)return df(e,n,{useCase:R3.LockupIconLarge})
const r=B(t,XW)
return df(e,r,{useCase:R3.LockupIconLarge})})}(e,n)
i&&(i.crop="sr")
const s=function(e,t){const n=B(t,$M)
if(n)return df(e,n,{useCase:R3.Uber})}(e,n)
return new Gee(r,o,i,s)})}(e,t))}async function tv(e,t){if(r(t.providerAdamId)||r(t.subscribedChannelIds))return await e.required(R9).fetchPage(e,t.url,gK)
{const n=nv(e,t.providerAdamId),r=Ln(e,n)
return await r.then(n=>{const r=function(e,t){return ym.context("msoAppsFromResponse",()=>{const n=mt(e,t),r=we(n,CL),o={}
for(const t of r)o[pe(e,t,VW).id]=G(t,"channelNames")
const i=we(n,az).map(e=>e.id)
return new jee(o,i)})}(e,n),o=function(e,t){const n=e.appsToAlwaysShow
for(const r of Object.keys(e.apps)){const o=e.apps[r]
for(const e of o)if(-1!==t.indexOf(e)){n.push(r)
break}}return n}(r,t.subscribedChannelIds)
return rv(e,n,o)})}}function nv(e,t){return new cJ(e).withIdOfType(t,TF).includingRelationships([az,CL]).addingQuery("limit[channel-apps]","100")}function rv(e,t,n){return ym.context("msoRoomPageWithResponse",()=>{const r=mt(e,t),o=Gn(e,Zq,r.id,t),i=we(r,az),a=we(r,CL)
for(const t of a){const n=pe(e,t,VW)
s(n)&&i.push(n)}const c=new q4
c.ids=i.map(e=>e.id),c.shouldFilter=!1,c.metricsPageInformation=o
const l=function(e,t,n,r,o=[]){return ym.context("msoRoomPageWithContext",()=>{const i=[],s=[]
for(const e of t)-1!==n.indexOf(e.id)?i.push(e):s.push(e)
const a={rootPosition:0,locationStack:[]},c={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:a},artworkUseCase:R3.LockupIconMedium}},l=[],u={pageInformation:r.metricsPageInformation,locationTracker:a,targetType:rW,idType:pW,id:"0"}
if(i.length>0){const t=e.loc.string("MSO_INCLUDED_IN_SUBSCRIPTION"),n=new q4
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=Kq,u.id="0",xh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(i[e]),!1}
const o=new pK(Kq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Yd(e,i,c),o.url=ov(n),Bh(a),o.items.length>0&&(Vh(a),l.push(o))}if(i.length>0&&s.length>0){const t=e.loc.string("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),n=new q4
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=Kq,u.id="1",xh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(s[e]),!1}
const o=new pK(Kq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Yd(e,s,c),o.url=ov(n),Bh(a),o.items.length>0&&(Vh(a),l.push(o))}if(0===l.length){const n=new q4
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=mW,u.id="0",xh(0,u,null),c.contentUnavailable=function(e,r){return n.remainingContent.push(t[e]),!1}
const o=new pK(Kq)
o.shouldFilterApps=r.shouldFilter,o.items=Yd(e,t,c),o.url=ov(n),Bh(a),Vh(a),l.push(o)}for(const e of l)e.isHorizontal=l.length>1
const d=o.concat(l)
return new gK(d)})}(e,i,n,c)
return l.title=j(r,cz),l.isIncomplete=!1,Vn(e,l,o),l})}function ov(e){return e.remainingContent.length?`${Cz}:/${_z.mso}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e)):null}async function iv(e,t){const n={url:`${e.bag.getCancellablePreorderItemsSrv}?&includeAllLockups=false&includeNonBookCancellablePreorderItems=true${t.isArcade?"&preorderItemType=ArcadeApp":""}`,signingStyle:GH}
return await e.network.fetch(n).then(async n=>{const r=JSON.parse(n.body)
if(0!==r.status)return await Promise.resolve("noAuthorization")
const o=r.cancellablePreorderItems.filter(e=>e.preorderAdamId.toString()===t.adamId)
if((0,mm.isNothing)(o)||0===o.length)return await Promise.reject("Expected AdamID was missing. This AdamId might have not been preordered before, or the isArcade flag may be incorrect.")
if(o.length>1)return await Promise.reject(`Multiple matches for adamId ${t.adamId}, when only one is expected.`)
const i=o[0].preorderId,s={url:e.bag.cancelPreorderItemSrv,method:rj,signingStyle:GH}
return s.body=`preorderId=${i}`,await e.network.fetch(s).then(async e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${s.url}`)
return 0!==JSON.parse(e.body).status?await Promise.resolve("unableToCancel"):await Promise.resolve("canceled")}).catch(async e=>await Promise.reject(e))}).catch(async e=>await Promise.reject(e))}async function sv(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error($k))
0!==Mn(e,new oY(t.url)).length&&vp(e,t.url)
const n=ete.generateProductPageOptions(e,void 0,new oY(t.url)),r=e.required(R9).fetchPage(e,t.url,uK)
if(!r){const r=new cJ(e,t.url),o=await Ln(e,r)
return await cd(e,o,n,void 0,t.referrerData)}return await r.then(n=>(e.host.clientIdentifier===sJ?n&&uU in n&&Yn(0,n):i(t.referrerData)&&n&&uU in n&&Yn(0,n),n))}async function av(e,t,n){const a=Xt(e,t,!1),c=new cJ(e)
switch(t){case UW:c.usingCustomAttributes(Ue(e)),Qt(e)===Kq&&c.includingAttributes([nU])
break
case Vq:case cq:c.usingCustomAttributes(Ue(e))}const l=e.bag.adsOverrideLanguage
s(l)&&c.enablingFeature(qA).addingQuery("l",l)
const u=ge(e,c).query
try{const c=await e.ads.fetchOnDeviceAdPlacement(t,a,u,n)
return await async function(e,t,n){var a,c,l,u,d,f
o(t.clientRequestId)&&(t.clientRequestId=e.random.nextUUID(),Zt(e,`clientRequestId was nil. Assigned ${t.clientRequestId}`))
const h={clientRequestId:t.clientRequestId,iAdId:t.iAdId,placementType:null!==(c=null===(a=null==t?void 0:t.ad)||void 0===a?void 0:a.placementType)&&void 0!==c?c:n}
if(t.failureReason)return h.failureReason=t.failureReason,h
h.onDeviceAd=t.ad
let p=null===(l=t.ad)||void 0===l?void 0:l.appMetadata
const w=mt(e,p)
if(o(null===(u=null==w?void 0:w.attributes)||void 0===u?void 0:u.name)||o(null===(d=null==w?void 0:w.attributes)||void 0===d?void 0:d.platformAttributes)||o(gr(e,w)))try{const n=function(e,t){const n=new cJ(e).withIdOfType(t.adamId,az).usingCustomAttributes(Ue(e)).includingAttributes([nU])
s(t.cppIds)&&n.addingQuery(Hz.productVariantID,t.cppIds[0])
const r=e.bag.adsOverrideLanguage
return s(r)&&n.addingQuery("l",r),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([bW]),n}(e,t.ad)
p=await Ln(e,n)}catch(t){Zt(e,`fetchAds request failed - ${t}`),h.failureReason=WA}if(s(null===(f=mt(e,p))||void 0===f?void 0:f.attributes)){h.mediaResponse=function(e,t,n){const i=mt(e,t)
if(o(i)||r(i.attributes))return Zt(e,"decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null
const a=n.ad,c=`${a.adamId}|${a.metadata}`,l={clientRequestId:n.clientRequestId,impressionId:a.impressionId,metadata:a.metadata,privacy:a.privacy,lineItem:c},u=mt(e,a.appMetadata)
switch(s(i.meta)&&s(u)&&s(u.meta)&&(i.meta.passthroughAdInfo=u.meta.passthroughAdInfo,(0,mm.isSome)(null==a?void 0:a.alignedRegionDetails)&&(i.meta.alignedRegionDetails=null==a?void 0:a.alignedRegionDetails[0])),a.placementType){case UW:const t=Qt(e)===Kq
l.format={images:t,text:"",userRating:!1}
break
case dH:l.format={images:!0,text:"",userRating:!1}}return i.attributes[Cj]=l,hn(0,i,a.instanceId),t}(e,p,t),pn(e,mt(e,p),h.onDeviceAd)||(Zt(e,"fetchAds request failed - localization not available"),h.failureReason=zA)
const a=function(e,t,n){return n===UW?function(e,t){var n,r
const o=Ge(e,mt(e,t.mediaResponse))
return(null===(r=null===(n=t.onDeviceAd)||void 0===n?void 0:n.cppIds)||void 0===r?void 0:r.includes(o.productPageId))?null:tE}(e,t):null}(e,h,n)
i(a)&&(Zt(e,`fetchAds request failed - ${a}`),h.failureReason=a)}return h}(e,c,t)}catch{return null}}function cv(e,t,n,r){var o,i,s
const a=fe(t,sz),c=(0,Am.isNothing)(a)?void 0:null!==(o=bt(a))&&void 0!==o?o:void 0
let l=sH
return r.pageType===Ay.ChartsAndCategories&&(l=ez),{id:n.id,kind:null,softwareType:null,targetType:rW,title:null!==(i=n.title)&&void 0!==i?i:"",pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:l,fcKind:void 0,canonicalId:null!==(s=f(t.meta,pB))&&void 0!==s?s:void 0,recoMetricsData:c}}function lv(e,t,n,r){var o,i
return{...r.metricsOptions,...ep(e,n,null!==(o=t.title)&&void 0!==o?o:"",r.metricsOptions),recoMetricsData:null!==(i=bt(n))&&void 0!==i?i:void 0,targetType:dv(t.density),idType:yW}}function uv(e,t,n,r){var o
return{pageInformation:r.metricsOptions.pageInformation,locationTracker:r.metricsOptions.locationTracker,recoMetricsData:null!==(o=bt(n))&&void 0!==o?o:void 0,targetType:dv(t),id:n.id}}function dv(e){if((0,Am.isNothing)(e))return LV
switch(e){case Sm.Density1:return LV
case Sm.Density2:return XN
default:return LV}}function fv(e,t,n,r=yy.Default){var o,i,s
const a=null!==(o=j(t,FW))&&void 0!==o?o:void 0
let c=null!==(i=function(e,t,n){return B(e,t,void 0)}(t,Aq))&&void 0!==i?i:void 0;(0,mm.isNothing)(c)&&r===yy.CategoriesAndCharts&&(c={layoutDensity:Sm.Density1,layout:void 0,layoutSize:void 0})
const l=v(B(t,"itemDisplayStyle")),u=H(t,FD),d=null!==(s=q(t,iF))&&void 0!==s?s:void 0,f=u?t.href:void 0
return new gte(t.id,a,c,d,u,f,l,n)}function hv(e,t,n,r){return{metricsOptions:cv(0,t,n,r)}}function pv(e,t){var n,r
const o=j(t,FW),i=f(t,"meta.autoSelectedTabId"),a=f(t,"meta.sourceShelfCanonicalId"),c=Gn(e,wj,a,t),u=Os(e)
c.recoMetricsData=Mh(c.recoMetricsData,null,u)
const d={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:c,adStitcher:null,pageType:Ay.ChartsAndCategories},h=l(t,RV),p={},w=[],v=[],g={rootPosition:0,locationStack:[]}
for(const t of h){const o=fv(0,t,Ty.CategoriesAndCharts,yy.CategoriesAndCharts),i=hv(0,t,o,{...d,metricsLocationTracker:{rootPosition:0,locationStack:[]}})
xh(0,i.metricsOptions,o.title)
const s=wv(e,t,!0,o,0,i)
if(Bh(i.metricsOptions.locationTracker),(0,mm.isNothing)(s))continue
p[s.id]=s,w.push(s.id)
const a=new mte,c=new yte(t.id,o.title)
ra(e,c,{id:o.title,canonicalId:null!==(n=f(t.meta,pB))&&void 0!==n?n:void 0,actionType:dz,targetType:lz,pageInformation:d.metricsPageInformation,locationTracker:g}),a.action=c,a.id=s.id,a.title=`${null!==(r=s.title)&&void 0!==r?r:""}`,v.push(a),Vh(g)}if(!s(w))return new Ate
const m=new Tte
m.id=e.random.nextUUID()
const y=new pK("pageTabs")
y.items=[m],p[m.id]=y
const A=new Ate
A.shelfMapping=p
const T={}
for(const e of w)v.length>1?T[e]=[m.id,e]:T[e]=[e]
for(const e of Object.values(p))e.title=void 0
return A.title=o,A.pageTabs=m,A.columnCount=2,A.shelfOrderings=T,A.defaultShelfOrdering=w.includes(i)?i:w[0],m.tabs=v,m.selectedTabId=A.defaultShelfOrdering,Vn(e,A,d.metricsPageInformation),A}function wv(e,t,n,r,i,c){var l,u,d,h,p,w,v,g,m,y,A
const T=[],b=we(t,sz),S=new pK(q_)
if(S.isHorizontal=!1,S.id=t.id,S.title=r.title,S.presentationHints={isWidthConstrained:!0},a(null===(l=r.displayStyle)||void 0===l?void 0:l.layoutSize)&&(S.contentsMetadata={type:"searchLandingChartsAndCategoriesSection",numberOfColumns:r.displayStyle.layoutSize}),r.hasSeeAll){const t=new _J(q_)
t.pageUrl=r.seeAllLink,t.title=e.loc.string(nq)
const n={...c.metricsOptions,targetType:lz}
oa(e,t,t.pageUrl,n),S.seeAllAction=t}Jh(e,S,c.metricsOptions)
const P=n?hy.seeAllPage:hy.other
for(const t of b){let n,i
if(t.type===CH)n=j(t,cz)
else{const e=B(t,nH)
s(e)&&(n=f(e,cz),i=f(e,KU))}const a=pf(e,t,P,null===(u=null==r?void 0:r.displayStyle)||void 0===u?void 0:u.layoutDensity),l=j(t,Dq),b=B(t,EW),S=f(b,BW),C=we(t,vq)
let I=!0,k=null,O=!1
if(t.type===CH){const r=ji(e,f(t,uj)),o=e.required(R9).fetchFlowPage(r),i=new _J(o)
i.pageUrl=r,i.title=n,k=i}else if((0,mm.isSome)(S))switch(l){case"CategoryChart":const t=new _J(tj)
t.pageUrl=S,t.title=n,t.pageData=new N4("",Pc(e,S)),O=!e.clientCapabilities.isEnabled(TJ),k=t
break
case"External":if(I=!1,f(b,ox)===vM)k=new HJ(S),k.title=null!=n?n:""
else{const t=e.required(R9).fetchFlowPage(S),r=new _J(t)
r.pageUrl=S,r.title=null!=n?n:"",k=r}}else{if(!s(C))continue
{const t=C[0],r=ji(e,t.href)
if(l===QM&&(n=j(t,cz)),!((0,mm.isSome)(r)&&(null==r?void 0:r.length)>0))continue
{const e=new _J(fz)
e.pageUrl=r,e.title=n,k=e}}}if(ra(e,k,uv(0,null===(d=null==r?void 0:r.displayStyle)||void 0===d?void 0:d.layoutDensity,t,c)),I&&o(n))continue
const E=(A={itemType:t.type===CH?"Tag":l},Object.entries(A).map(([e,t])=>({name:e,value:String(t)})))
let D=new bte(n,a,null,null,i,k,null===(h=null==r?void 0:r.displayStyle)||void 0===h?void 0:h.layoutDensity,vv(e,null===(p=null==r?void 0:r.displayStyle)||void 0===p?void 0:p.layoutDensity,O),gv(null===(w=null==r?void 0:r.displayStyle)||void 0===w?void 0:w.layoutDensity,O),E),R=lv(e,D,t,c)
R3.GroupingBrick
const _=cs(e,t,0,0,0,R)
if((0,mm.isSome)(_)&&_.length>0){const o=_[0].backgroundColor;(0,mm.isSome)(o)&&(null==o?void 0:o.type)===PH&&(D=new bte(n,null,_,null!==(v=mh(o))&&void 0!==v?v:void 0,i,k,null===(g=null==r?void 0:r.displayStyle)||void 0===g?void 0:g.layoutDensity,vv(e,null===(m=null==r?void 0:r.displayStyle)||void 0===m?void 0:m.layoutDensity,O),gv(null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.layoutDensity,O),E),R=lv(e,D,t,c))}Jh(e,D,R),T.push(D),Vh(c.metricsOptions.locationTracker)}return o(T)?null:(S.items=T,S)}function vv(e,t,n){switch(t){case Sm.Density1:const t=e.clientCapabilities.isEnabled(TJ)?T5.defaultThreeLineTileArtworkSafeArea:T5.defaultTileArtworkSafeArea
return n?void 0:t
case Sm.Density2:return T5.defaultPillArtworkSafeArea
case Sm.Density3:default:return}}function gv(e,t){switch(e){case Sm.Density1:return t?void 0:T5.defaultTileTextSafeArea
case Sm.Density2:return T5.defaultPillTextSafeArea
default:return}}async function mv(e,t){const n=new cJ(t,e.url).forType(C$).includingAgeRestrictions().includingScopedRelationships(Bk,[sz]).enablingFeatures([cH,AN]).addingQuery(Hz.name,GN)
Wi(t,w$)&&Ci(n),t.bag.enableUpdatedAgeRatings&&n.includingAttributes([bW])
const r=Ln(t,n)
return await r.then(e=>pv(t,e))}function yv(e){switch(e){case Eq:return $O
case jG:return EN
case oz:return M$
case nz:return"joystickcontroller.fill"
default:return}}function Av(e,t,n,r,i){if(o(r))return null
const s=B_,a=n.term,c=r.displayLabel,l=t===SI?new y6(c,r.finalTerm,null,s):new Cte(c,s)
!function(e,t,n,r,o){const i=D$,s=kI,a={targetId:n},c=_t(e,n,s,{actionType:i,location:$h(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},n),searchTerm:r},[D$])
t.actionMetrics.addMetricsData(c)
const l=Lt(e,r,s,i,null,a,[D$])
t.actionMetrics.addMetricsData(l)}(e,l,c,a,i)
const u=new Ite(c,r.isSelected,void 0,c,l)
return Bn(0,u,kI,i),u}function Tv(e,t,n){const r=S(t),i=S(t.attributes)
return i[NB]=n.adData,r.attributes=i,function(e,t,n){var r
const i=Ve(Ge(e,t))
if(n.selectedCppId===i||o(null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.cppData))return
const s=S(t.meta)
s.cppData[kG]=n.selectedCppId,t.meta=s}(e,r,n),hn(0,r,n.instanceId),r}function bv(e,t,n){const r=S(t)
if((0,mm.isNothing)(t.attributes))return r
const o=S(t.attributes)
return o[NB]=n.adData,o[cI]=n.failureReason,o[k_]=n.adsClientDecisions,r.attributes=o,hn(0,r,n.instanceId),r}function Sv(e){return ym.context("actionFromSearchResultsLink",()=>{var t
const n=new HJ(e.url,!1)
return n.title=null===(t=e.label)||void 0===t?void 0:t.replace(" ","\xa0"),n.artwork=new dY("systemimage://arrow.up.forward",0,0,[]),n})}function Pv(e,t,n){const r=t||{},o=[]
e.client.deviceType!==iz&&o.push(new Dte(BB,[new Rte(e.loc.string(lI),null,r[BB]),new Rte(e.loc.string(uI),OW,r[BB])])),o.push(new Dte($N,[new Rte(e.loc.string(E_,MG),null,r[$N]),new Rte(e.loc.string(dI,MG),YO,r[$N])]))
const s=Tn(e,n,!1)
if(s){const t=s.categories
if(t.length){const n=t.filter(e=>i(e.genreId)).map(e=>new Rte(e.name,e.genreId,r[mq]))
n.unshift(new Rte(e.loc.string(D_,MG),null,r[mq])),o.push(new Dte(mq,n))}}const a=e.bag.searchSortOptions,c=[]
c.push(new Rte(e.loc.string(R_),null,r[jH]))
for(const t of a)c.push(new Rte(e.loc.string(fI+t),t,r[jH]))
c.length>1&&o.push(new Dte(jH,c))
const l=e.bag.ageBands.map(e=>new Rte(f(e,cz),f(e,HE),r[ZB]))
return l.length>0&&e.client.deviceType!==iz&&o.push(new Dte(ZB,l)),o}function Cv(e,t){let n=null,r=null,o=null
const s=new V8(BB,BB,e.loc.string("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),cU,[new j8(e.loc.string(lI),null),new j8(e.loc.string(uI),OW)],null,null,kv(e,BB)),a=new V8(hI,hI,e.loc.string("SEARCH_FACET_TYPE_TITLE_PRICE"),cU,[new j8(e.loc.string(E_,MG),null),new j8(e.loc.string(dI,MG),YO)],null,null,kv(e,$N)),c=Tn(e,t,!1)
if(c){const t=c.categories
if(t.length){const r=t.filter(e=>i(e.genreId))
n=new V8(pI,pI,e.loc.string("SEARCH_FACET_TYPE_TITLE_CATEGORY"),cU,[new j8(e.loc.string(D_,MG),null)],null,null,kv(e,mq))
for(const e of r)n.options.push(new j8(e.name,e.genreId))}}const l=e.bag.searchSortOptions
r=new V8(jH,jH,e.loc.string("SEARCH_FACET_TYPE_TITLE_SORT"),cU,[new j8(e.loc.string(R_),null)],null,null,kv(e,jH))
for(const t of l)r.options.push(new j8(e.loc.string(fI+t),t))
const u=e.bag.ageBands.map(e=>new j8(f(e,cz),f(e,HE)))
u.length>0&&e.client.deviceType!==iz&&(o=new V8(wI,wI,e.loc.string("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),cU,u,null,null,kv(e,ZB)))
const d=new H8([],!1,null)
{const e=[s,a]
i(n)&&e.push(n),e.push(r),i(o)&&e.push(o)
for(const t of e)t.showsSelectedOptions=!0
d.facetGroups.push(new q8(e))}return d}function Iv(e){return{targetPlatform:[new j8(e.loc.string("SEARCH_FACET_IPAD_ONLY"),null)],"filter[price]":[new j8(e.loc.string(E_,MG),null)],sort:[new j8(e.loc.string(R_),null)],"filter[genre]":[new j8(e.loc.string(D_,MG),null)]}}function kv(e,t){const n=new Pz
return ia(e,n,t),n}function Ov(e,t){const n=e.bag.searchResultsLearnMoreEditorialId
if((0,mm.isNothing)(n)||0===(null==n?void 0:n.length))return
const r={kind:uV,softwareType:null,title:e.loc.string(bI),id:n,targetType:EW,pageInformation:t.pageInformation,locationTracker:t.locationTracker},o=e.loc.string("SEARCH_TRANSPARENCY_TEXT"),i=new _J(vW)
i.title=o,i.pageUrl=`https://apps.apple.com/story/id${n}`,ra(e,i,r)
const s={}
s[`${e.loc.string(bI)}`]=i
const a=new f2(o,FH)
return new h2(a,s)}function Ev(e){return A(e)&&function(e){return(0,mm.isSome)(_te[e])}(e[hz])}function Dv(e,t){if(!H(t,N_))return
const n=j(t,W_)
if(s(n))return n
const r=j(t,Gq)
return s(r)?r.replace(/\n/g," "):void 0}function Rv(e){return Ev(e)&&e[hz]===jy}function _v(e,t,n,a,c,l,d,f){return ym.context("searchResultFromData",()=>{var h,p
let w
const v=t.type,g={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:AH,createUniqueImpressionId:!0},hideZeroRatings:!0,artworkUseCase:R3.SearchIcon,isNetworkConstrained:null!=l?l:void 0,canDisplayArcadeOfferButton:ph(0,ix),clientIdentifierOverride:null!==(h=xv(0,d))&&void 0!==h?h:void 0,isMultilineTertiaryTitleAllowed:!1},m=function(e,t,n){var r,o
if(!function(e){return e.client.deviceType===ZW}(e))return hq
const s=t.meta,a=null===(r=null==s?void 0:s.displayStyle)||void 0===r?void 0:r.condensed
if(i(a))return Mv(e,a)
const c=null===(o=null==n?void 0:n.displayStyle)||void 0===o?void 0:o.condensed
return i(c)?Mv(e,c):Fv(e)}(e,t,f)
switch(v){case xB:case fN:case rH:case YW:case SH:const l=ko(e,t,{useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0},new qQ(c.pageInformation,c.locationTracker))
if(l&&l.media&&l.media.kind===BG){const e=l.media.lockup
e.theme=MW,w=new Nte(e)}else if(function(e,t,n){if((u(n,"experiments.showGridCard")?$te:xte)!==xte)return!1
switch(t.type){case SH:return s(G(t,z_))
case xB:case fN:return!0
case YW:switch(Ro(t)){case Jm.List:case Jm.NumberedList:case Jm.Grid:case Jm.River:return!0
default:return!1}default:return!1}}(0,t,n)){const n=function(e,t,n){const r=function(e,t){if(t.type===rH)return e.loc.string(PI)
const n=Dv(0,t)
return s(n)?n:e.loc.string("Search.EditorialSearchResultType.Heading.Collection")}(e,t),i=function(e,t){return t.type===rH?j(t,cz):sh(e,t,cz)}(e,t),a=ep(e,t,i,{targetType:AH,pageInformation:n.pageInformation,locationTracker:n.locationTracker})
xh(0,a,i)
const c=Jd(e,t,{actionType:dz,targetType:lz,pageInformation:n.pageInformation,locationTracker:n.locationTracker,id:gR,idType:pW},e.host.clientIdentifier)
c.title=e.loc.string(nq)
const l={lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:KW},skipDefaultClickAction:!1,artworkUseCase:R3.SearchIcon,hideCompatibilityBadge:!1},filter:Im.UnsupportedPlatform}
let u=we(t,Sq)
o(u)&&(u=we(t,x_))
const d=Yd(e,u,l)
Bh(n.locationTracker)
const f=new Fte(r,i,d,c,void 0)
if(Jh(e,f,a),!o(d))return f}(e,t,c)
n&&(w=n)}else{const n=function(e,t,n,o){return ym.context("editorialSearchResultFromData",()=>{var a
let c
const l=null!==(a=j(t,cz))&&void 0!==a?a:void 0
switch(t.type){case SH:{const n=new Gte(l),r=G(t,z_)
if(s(r))n.collectionAdamIds=r
else{const r=df(e,B(t,XW),{useCase:R3.SearchEditorialResult,allowingTransparency:!0})
n.iconArtwork=r}n.type=FV,c=n
break}case xB:case fN:{const n=new Gte(l)
n.artwork=df(e,B(t,XW),{useCase:R3.SearchEditorialResult,cropCode:"sr"}),n.collectionAdamIds=G(t,z_),n.type=LH,c=n
break}case YW:{if(e.bag.searchFilterEditorialItemIds.has(t.id))return
const a=new qQ(n.pageInformation,n.locationTracker),l=function(e,t,n,o){var a,c
const l={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0}
l.prevailingCropCodes=o&&e.client.isPhone?{defaultCrop:"DMGE.AppST01"}:{defaultCrop:"fo"}
const u=ko(e,t,l,n)
if(!u)return
const d=new Gte(u.title)
d.type=jG,d.clickAction=null!==(a=u.clickAction)&&void 0!==a?a:void 0
let f=[]
if(u.media)switch(u.media.kind){case dV:const n=u.media
switch(d.artwork=n.artworks[0],r(d.artwork)&&(d.iconArtwork=n.icon),j(t,CB)){case Jm.AppOfTheDay:case Jm.GameOfTheDay:const n=pe(e,t,Sq)
n&&(d.title=j(n,cz)||d.title)}break
case NO:case HL:f=u.media.lockups
break
case XW:const o=u.media
d.artwork=o.artworks[0]
break
case sq:case F$:f=u.media.lockups
break
case Xq:const s=u.media
if(d.artwork=s.videos[0].preview,d.video=s.videos[0],Br(c=u.overlay)&&c[hz]===oA){const e=u.overlay
d.title=e.title,d.subtitle=e.description}else d.subtitle=s.description
break
case qB:const a=u.media
if(d.artwork=a.artworks[0],d.appEventFormattedDates=a.formattedDates,d.subtitle=u.inlineDescription,d.tintColor=a.tintColor,d.type="appEventStory",i(u.style))switch(u.style){case iW:case lW:d.mediaOverlayStyle=iW
break
case MW:d.mediaOverlayStyle=MW
break
default:F(u.style)}}if(u.overlay)switch(u.overlay.kind){case KW:const e=u.overlay
d.artwork||(f=[e.lockup])
break
case Jy:f=u.overlay.lockups
break
case OV:const t=u.overlay
d.subtitle=t.paragraph.text}if(i(f)){d.collectionAdamIds=[],d.collectionAppIcons=[]
for(const e of f)d.collectionAdamIds.push(e.adamId),d.collectionAppIcons.push(e.icon)
1===f.length&&(d.lockup=f[0])}const h=On(0,t)
d.editorialDisplayOptions=En(h)
const p=Dv(0,t);(0,Am.isSome)(p)&&(null==p?void 0:p.length)>0&&p!==d.title&&(d.tagline=p)
const w=u.heroMedia
return s(w)&&(s(w.artworks[0])?(d.artwork=w.artworks[0],d.artwork.crop="em"):s(w.videos[0])&&(d.video=w.videos[0])),d.video&&(d.video.canPlayFullScreen=!1,d.video.playbackControls={}),d.collectionAdamIds||d.artwork||d.iconArtwork?d:void 0}(e,t,a,o===WU)
c=l
break}case rH:{const n=new Gte(l)
if(n.artwork=df(e,B(t,$M),{useCase:R3.SearchEditorialResult,cropCode:"sr"}),n.type=Eq,(0,Am.isSome)(n.artwork))c=n
else{let r=we(t,x_)
r=null==r?void 0:r.filter(t=>!st(e,t,Im.DeveloperPage))
const o=[],s=[]
null==r||r.forEach(t=>{o.push(t.id)
const n=wf(e,t,{useCase:R3.SearchEditorialResult})
i(n)&&s.push(n)}),n.collectionAdamIds=o,n.collectionAppIcons=s,c=n}break}}if(r(c))return
if(Rv(c)&&null!=c.collectionAdamIds&&c.collectionAdamIds.length){const e=c.collectionAdamIds.length
c.artworkGridType=e<=5?"extraLarge":e<=8?PW:e<=16?II:Bq}const u=ep(e,t,c.title,n)
return c.clickAction=Jd(e,t,u,null),Jh(e,c,u),c})}(e,t,g.metricsOptions,m)
n&&(n.title&&(n.title=n.title.replace(/\n/g," ")),Rv(n)&&n.subtitle&&(n.subtitle=n.subtitle.replace(/\n/g," ")),w=n)}break
case jq:if(o(af(e,t)))return null
const d=Bd(e,t,g)
d.theme=MW,$v(e,d,f),w=new Nte(d)
break
default:if(null===(p=t.attributes)||void 0===p||delete p[Cj],v===JW){g.shouldIncludeScreenshotsForChildren=e.featureFlags.isEnabled($K)
const n=Nd(e,t,g)
n.showMetadataInformationInLockup=!0,$v(e,n,f),w=new Bte(n)}else{const n=jd(e,t,g,{canPlayFullScreen:!1,playbackControls:{}},f)
$v(e,n,f)
const o=function(e,t,n,o,s,a){return ym.context("appEventSearchResultFromData",()=>{if(!Nv(e,t))return null
const{dataItems:c,personalizationData:l}=Bv(e,t,s)
let d,f
for(const n of c){const r=Uv(e,n,t,a,o.offerEnvironment,o.offerStyle)
if(i(r)){d=r,f=null!=t?t:pe(e,n,VW)
break}}if(r(d))return null
const h=u(t.meta,J_),p=new jte
p.lockup=n,p.appEvent=d,p.alwaysShowAppEvent=h,p.clickAction=n.clickAction
const w=Mh(null,null==l?void 0:l.processingType,null),v={...a,id:d.appEventId,kind:KA,targetType:z$,title:d.title,softwareType:null,recoMetricsData:w}
return i(f)&&(v.relatedSubjectIds=[f.id]),Jh(e,p,v),p})}(e,t,n,g,a,c)
i(o)?(w=o,w.condensedBehavior=hq):w=new Ute(n)}}return i(w)&&r(w.condensedBehavior)&&(w.condensedBehavior=m),w})}function Lv(e,t,n,r,o,s){if(!Nv(e,t))return!1
const{dataItems:a}=Bv(e,t,null!=s?s:null)
let c
for(const n of a)if(c=Uv(e,n,t,o,void 0,void 0),(0,Am.isSome)(c))break
const l=!(!i(n)||!i(n[t.id]))&&n[t.id],u=!(!i(r)||!i(r[t.id]))&&["downloadable"].includes(r[t.id])
return(l||u)&&(0,Am.isSome)(c)}function Mv(e,t){switch(t){case WU:return WU
case hq:return hq
case"when-installed":return CI
default:return Fv(e)}}function Fv(e){return e.client.deviceType===ZW?CI:hq}function $v(e,t,n){if(!n)return
const o=function(e,t,n,o){var i
if(r(t)||!e.client.isPhone)return null
const a=null===(i=null==t?void 0:t.displayStyle)||void 0===i?void 0:i.metadataPrecedenceOrder
if(!s(a))return null
const c=a.indexOf(n),l=a.indexOf(o)
return-1===c&&-1===l?null:-1!==c&&(-1===l||c<l)}(e,n,dj,LG)
i(o)&&(t.isEditorsChoice=t.isEditorsChoice&&o)}function xv(e,t){return t===oz?nJ:null}function Nv(e,t){if(!li(e)||r(t.meta))return!1
const n=l(t.meta,Y_).length>0
return![xB,fN,rH,YW,SH,jq,JW].includes(t.type)&&n}function Bv(e,t,n){const r=u(t.meta,J_),o=l(t.meta,Y_)
if(r)return{dataItems:[o[0]]}
const i=Cs(e,gW,o,!1,n,!1,void 0,t.id),s=i.personalizedData
return s.length<=0?{dataItems:[]}:{dataItems:s,personalizationData:i}}function Uv(e,t,n,o,i,s){const a=Ai(e,t,n,!1,!0,i,s,!1,{...o,targetType:z$},!1,!0,null,!1,!1)
return r(a)||a instanceof Date?null:a}function Gv(e,t,n,s,a,c,l,d,f){var h,p,w,v,g,m,y,A,T,b,S,P,C,I,k,O,E
const D=new Vte,R=function(e){if(e.client.isPhone&&!e.clientCapabilities.isNotEnabled(gJ))switch(Ne(e,Cm.SearchResultsAdBackground)){case Hte:return"ad"
case qte:return"clearAdWithSeparator"
case Wte:return jD
default:return}}(e);(0,mm.isSome)(R)&&(D.itemBackground=R)
const _=null!==(h=s.requestDescriptor.isNetworkConstrained)&&void 0!==h&&h,L={canPlayFullScreen:!1,playbackControls:{}}
tn(e)||xh(0,{id:Hx,kind:gP,softwareType:null,targetType:null,title:Hx,pageInformation:a.pageInformation,locationTracker:a.locationTracker,idType:pW},Hx)
const M=t[n],F=Array.isArray(M)?M:[M],$=t[n-1],x=t[n+1]
let N
Zt(e,`Adverts received from ad server: ${F.filter(mm.isSome).map(e=>`[${e.id}]`).join(", ")}`)
let B=!0
for(const s of F){if((0,mm.isNothing)(null==s?void 0:s.attributes))continue
if(st(e,s)){Zt(e,`[${s.id}] filtered by shouldFilter() - app probably not supported on current os or device`)
continue}const h=jv(s.id,$,x,c),C=(0,mm.isSome)(h),I=Jv(0,t,C)
if(s.attributes[Cj]=Yv(s,I),o(s.attributes[Cj])){Zt(e,`[${s.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`)
continue}const k={metricsOptions:{pageInformation:a.pageInformation,locationTracker:a.locationTracker,targetType:AH,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:R3.SearchIcon,isNetworkConstrained:_,canDisplayArcadeOfferButton:ph(0,ix)},O=u(Ke(e,s,Cj),"format.images")
let E=!1
const R=o(N),M=zv(qd(e,s,k,L,d,!0,n)),F=E?ON:null===(p=null==d?void 0:d.displayStyle)||void 0===p?void 0:p.screenshots,U=Hv(e,M,s.id,I,O,N,F,h,c,l,a,f)
if(r(U)){Zt(e,`[${s.id}] will not be displayed because we could not create an ad style compatible with ${Qv(N)}`)
continue}if(!pn(e,s,null,U.style)){Zt(e,`[${s.id}] filtered because localization is not available`)
continue}if(R?(Zt(e,`[${s.id}] first ad dictates ad display style of: ${Qv(U)}`),N=U):Zt(e,`[${s.id}] will be displayed because it is compatible with the display style of: ${Qv(U)}, which is the same height as display style: ${Qv(N)}`),e.client.isPad&&0!==n&&U.style===$Z){Zt(e,`[${s.id}] is being dropped because it has style TEXT in an unsupported position.`),null===(v=null===(w=a.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===v||v.setMissedOpportunity(e,"TXT_NOAD","0",n)
continue}if(null===(g=a.pageInformation)||void 0===g||g.adPageInfo.apply(e,s),null===(y=null===(m=a.pageInformation)||void 0===m?void 0:m.adPageInfo)||void 0===y||y.setTemplateType(e,U.style),nn(e)){const e=null!==(A=k.metricsOptions.adsMetricsData)&&void 0!==A?A:{}
let t
e[rV]=U.style,Array.isArray(x)||(null==x?void 0:x.id)!==s.id?Array.isArray($)||(null==$?void 0:$.id)!==s.id||(t="Trailing"):t="Leading",(0,mm.isSome)(t)&&(e[UF]=t),k.metricsOptions.adsMetricsData=e}let G=qd(e,s,k,L,d,"ad"===D.itemBackground||D.itemBackground===jD,n)
if(G=Kv(e,G,U,C,$,B),null===(T=G.searchAdOpportunity)||void 0===T||T.setTemplateType(U.style),U.style===$Z){const t=j(s,HA)
if(t!==wW){let n
n=Qe(e,s,t===SW?Sj:null!=t?t:void 0)
const r=null!==(b=G.searchAd)&&void 0!==b?b:null===(S=G.searchAdOpportunity)||void 0===S?void 0:S.searchAd
i(r)&&i(n)&&(r.advertisingText=n)}D.displaysScreenshots=!1}if((0,mm.isSome)(G)){const n=Vv(t,G.adamId);(0,mm.isSome)(n)&&!E&&(null===(P=G.searchAdOpportunity)||void 0===P||P.setDuplicatePosition(n)),D.lockups.push(G),tn(e)||Vh(a.locationTracker),B=!1}}if(tn(e)||Bh(a.locationTracker),(0,mm.isSome)(D.lockups)&&D.lockups.length>0){const t=F[0]
null===(C=a.pageInformation)||void 0===C||C.adPageInfo.apply(e,t),Vh(a.locationTracker)}return(0,mm.isSome)(N)?null===(k=null===(I=a.pageInformation)||void 0===I?void 0:I.adPageInfo)||void 0===k||k.setTemplateType(e,N.style):null===(E=null===(O=a.pageInformation)||void 0===O?void 0:O.adPageInfo)||void 0===E||E.setTemplateType(e,null),D.condensedBehavior=hq,{result:D,displayStyle:null==N?void 0:N.style}}function jv(e,t,n,r){return[t,n].find(t=>{var n
if((0,mm.isNothing)(t)||Array.isArray(t))return!1
const o=t.id===e,i=null!==(n=null==r?void 0:r[t.id])&&void 0!==n&&n
return o&&!i})}function Vv(e,t){const n=e.findIndex(e=>!Array.isArray(e)&&e.id===t)
return-1===n?null:n}function Hv(e,t,n,r,i,s,a,c,l,u,d,f){const h=qv(e,t,n,i,s,a)
if((0,mm.isNothing)(h))return null
const p={platform:t.mediaPlatformUsedForDisplayStyle,style:h}
return Zt(e,`[${n}] tentatively resolved to: ${Qv(p)}`),r===Yte.DUPE_AD&&(0,mm.isSome)(c)?function(e,t,n,r,i,s,a,c,l,u,d,f){const h=f.style
if(function(e,t){var n,r,o,i
switch(e){case PZ:t.portraitScreenshots.length<=5&&t.portraitScreenshots.splice(0,4)
break
case CZ:t.portraitScreenshots.splice(0,3)
break
case IZ:t.portraitScreenshots.splice(0,2)
break
case kZ:t.portraitScreenshots.splice(0,1)
break
case OZ:null===(n=t.videos)||void 0===n||n.splice(0,1),t.portraitScreenshots.length<=4&&t.portraitScreenshots.splice(0,3)
break
case EZ:null===(r=t.videos)||void 0===r||r.splice(0,1),t.portraitScreenshots.splice(0,2)
break
case DZ:null===(o=t.videos)||void 0===o||o.splice(0,1),t.portraitScreenshots.splice(0,1)
break
case LZ:t.landscapeScreenshots.splice(0,1)
break
case RZ:case _Z:null===(i=t.videos)||void 0===i||i.splice(0,1)}}(h,t),xZ.includes(h))return Zt(e,`[${n}] tentative style is unrestricted. No dupe logic applied.`),f
const p=o(i),w=qv(e,t,n,r,null,s),v=function(e,t,n){switch(t){case OZ:case PZ:return!0
case EZ:case CZ:return 3===Zv(e,n)
case LZ:case _Z:return!0
case DZ:case IZ:return 2===Zv(e)
default:return!1}}(e,w,s),g=Lv(e,a,c,l,u,d)
return(v||g)&&p?(Zt(e,`[${n}] Organic Dupe would be full creative as ${w} so choosing tentative style for ad`),f):v&&!p?(Zt(e,`[${n}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${h}`),f):Wv($Z,i)?(Zt(e,`[${n}] tentative style would not yield full creative for organic result so returning TEXT`),{style:$Z}):(Zt(e,`[${n}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}(e,t,n,i,s,a,c,l,u,d,f,p):(null==s?void 0:s.style)===$Z?(Zt(e,`[${n}] tentative style would be filtered since the first ad has style: ${Qv(s)}, so returning TEXT`),{style:$Z}):p}function qv(e,t,n,r,o,i){if(!r)return Zt(e,`[${n}] is not allowed to display media because of iAd configuration.`),$Z
const s=null==o?void 0:o.mediaPlatform
if((0,mm.isSome)(t.mediaPlatformUsedForDisplayStyle)&&(0,mm.isSome)(s)&&!t.mediaPlatformUsedForDisplayStyle.isEqualTo(s))return Zt(e,`[${n}] filtered because media is derived from: ${t.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${s.mediaType}`),null
for(const n of zte){const r=n.canDisplay(t),s=Wv(n.representativeDisplayStyle,o)
if(r&&s)return n.displayStyle(e,t,i)}return Zt(e,`[${n}] filtered because we could not create a compatible style for the first style of: ${Qv(o)}`),null}function Wv(e,t){if((0,mm.isNothing)(t))return!0
let n=[]
for(const t of NZ)if(t.includes(e)){n=t
break}return n.includes(t.style)}function zv(e){var t
let n
const r=null===(t=e.trailers)||void 0===t?void 0:t[0]
let o
s(r)&&(r.videos.sort((e,t)=>Jte(e.preview,t.preview)),o=r.videos,n=r.mediaPlatform)
const i=e.screenshots[0],a=[],c=[]
return s(i)&&(i.artwork.forEach(e=>{e.isPortrait()?a.push(e):c.push(e)}),n=i.mediaPlatform),{portraitScreenshots:a,landscapeScreenshots:c,alignedRegionArtwork:e.alignedRegionArtwork,alignedRegionVideo:e.alignedRegionVideo,videos:o,mediaPlatformUsedForDisplayStyle:n}}function Yv(e,t){let n
const r=f(B(e,NB),t)
return(0,mm.isSome)(r)&&r.length>0&&(n=JSON.parse(r)),n}function Jv(e,t,n){return n?Yte.DUPE_AD:t.some(e=>{if(Array.isArray(e))return!1
const t=fn(0,e)
return(0,mm.isNothing)(t)})?Yte.NORMAL:Yte.NO_ORGANIC_RESULTS}function Kv(e,t,n,r,o,i){var a,c,l,u,d,f,h,p,w,v
const g=null===(c=null===(a=t.impressionMetrics)||void 0===a?void 0:a.fields)||void 0===c?void 0:c.pageCustomId,m=(0,mm.isSome)(g)&&g.length>0
let y,A=!1
if(r&&(A=e.bag.enableSRPNextSlot?(0,mm.isSome)(o)&&!Array.isArray(o)&&t.adamId===o.id:!i&&!m),s(t.trailers)){const e=t.trailers.shift()
null==e||e.videos.sort((e,t)=>Jte(e.preview,t.preview)),(0,mm.isSome)(e)&&t.trailers.unshift(e)}let T=[],b=[]
if(s(t.screenshots)){const e=t.screenshots.shift()
null==e||e.artwork.forEach(e=>{e.isPortrait()?null==T||T.push(e):null==b||b.push(e)}),y=null==e?void 0:e.mediaPlatform}if((0,mm.isNothing)(y))return t
switch(n.style){case PZ:if(t.trailers=null,b=null,t.screenshotsDisplayStyle=ON,A)if(T.length>5&&T.length<8){const e=T.splice(0,4),t=4-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,4)
else T.splice(4)
break
case CZ:t.trailers=null,b=null,A?T.splice(0,3):T.splice(3)
break
case IZ:t.trailers=null,b=null,A?T.splice(0,2):T.splice(2)
break
case kZ:t.trailers=null,b=null,A?T.splice(0,1):T.splice(1)
break
case LZ:t.trailers=null,T=null,A?b.splice(0,1):b.splice(1)
break
case OZ:if(b=null,t.screenshotsDisplayStyle=ON,A)if(null===(l=t.trailers)||void 0===l||l[0].videos.splice(0,1),T.length>4&&T.length<7){const e=T.splice(0,3),t=3-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,3)
else null===(u=t.trailers)||void 0===u||u[0].videos.splice(1),T.splice(3)
break
case EZ:b=null,A?(null===(d=t.trailers)||void 0===d||d[0].videos.splice(0,1),T.splice(0,2)):(null===(f=t.trailers)||void 0===f||f[0].videos.splice(1),T.splice(2))
break
case DZ:b=null,A?(null===(h=t.trailers)||void 0===h||h[0].videos.splice(0,1),T.splice(0,1)):(null===(p=t.trailers)||void 0===p||p[0].videos.splice(1),T.splice(1))
break
case _Z:case RZ:A?null===(w=t.trailers)||void 0===w||w[0].videos.splice(0,1):null===(v=t.trailers)||void 0===v||v[0].videos.splice(1),b=null,T=null
break
case $Z:case FZ:case MZ:t.trailers=null,b=null,T=null}if(s(t.trailers)){const e=t.trailers.shift()
t.trailers=[e].filter(mm.isSome)}const S=(null!=b?b:[]).concat(null!=T?T:[])
if(s(S)){const e=new mY(S,y)
t.screenshots=[e]}else t.screenshots=[]
return t}function Zv(e,t=null){if(e.client.isPhone){const e=3
return(0,mm.isNothing)(t)?e:t===ON?4:3}return 2}function Qv(e){if((0,mm.isNothing)(e))return""
let t=""
return(0,mm.isSome)(e.mediaPlatform)&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function Xv(e,t,n,r,o){var i,s
if(!(Ev(s=n)&&s[hz]===My||function(e){return Ev(e)&&e[hz]===Ly}(n)))return
const a=n.lockup,c=t.lockups[0]
if(c.adamId!==a.adamId)return
const l=new Set
if((0,mm.isSome)(c.screenshots)&&c.screenshots.length>0)for(const e of c.screenshots[0].artwork)l.add(e.template)
if((0,mm.isSome)(c.trailers)&&c.trailers.length>0)for(const e of c.trailers[0].videos)l.add(e.preview.template)
if((0,mm.isSome)(a.screenshots)&&a.screenshots.length>0){const e=a.screenshots[0].artwork.filter(e=>!l.has(e.template))
a.screenshots[0]=new mY(e,a.screenshots[0].mediaPlatform)}if((0,mm.isSome)(a.trailers)&&a.trailers.length>0){const e=a.trailers[0].videos.filter(e=>!l.has(e.preview.template))
a.trailers[0]=new pY(e,a.trailers[0].mediaPlatform)}if((null===(i=null==r?void 0:r.displayStyle)||void 0===i?void 0:i.screenshots)===ON)switch(o){case OZ:case PZ:(e=>{const t=a.screenshots[0].artwork
if(t.length>=4)return
let n=4-t.length
const r=c.screenshots[0].artwork.slice().reverse()
for(const e of r){if(n<=0)return
a.screenshots[0].artwork.unshift(e),n-=1}})()}}function eg(e,t,n,r,o,i,s,a,c){var l,u,d
let f
if((null===(l=null==r?void 0:r.lockups[0])||void 0===l?void 0:l.adamId)===t.id&&(0,mm.isSome)(n))if(Array.isArray(n)){const e=r.lockups[0]
f=n.find(t=>t.id===(null==e?void 0:e.adamId))}else f=n;(0,mm.isNothing)(f)&&(0,mm.isSome)(o)&&o.id===t.id&&(f=o),(0,mm.isNothing)(f)||Lv(e,t,i,s,a,c)||function(e,t){var n
let r
r=(0,mm.isSome)(null==t?void 0:t.meta)?S(t.meta):{},(0,mm.isNothing)(e)?null===(n=r.cppData)||void 0===n||delete n[kG]:((0,mm.isNothing)(r.cppData)&&(r.cppData={}),r.cppData[kG]=e),t.meta=r}(null===(d=null===(u=null==f?void 0:f.meta)||void 0===u?void 0:u.cppData)||void 0===d?void 0:d[kG],t)}function tg(e,t){var n,r,o
const i=null===(n=t.userDefaults)||void 0===n?void 0:n.integer("GuidedSearchOverrides.position")
return a(i)&&i>1?i:null===(o=null===(r=null==e?void 0:e.displayStyle)||void 0===r?void 0:r.guidedSearch)||void 0===o?void 0:o.position}async function ng(e,t,n,r,o,s,a,c,l){var u,d,f,h,p,w,v,g,m,y,A,T,b,S,P,C,I,k
const O=[],E=[],D=n||null,R=o.filter(e=>e.type===az).map(e=>e.id),_=ks(e,new Set(R)),L=o
let M=[0]
if((0,Am.isSome)(s))if(tn(e)){const t=null!==(u=sn(e,n))&&void 0!==u?u:[0]
M=t.filter((e,n)=>0===e||o.length>=e-1||t[n-1]===e-1)
for(const[t,n]of M.entries()){const o=s[t],i=B(o,k_)
if((0,Am.isSome)(i)&&(null===(f=null===(d=r.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f||f.setAdsClientDecisions(i,"0",n)),(0,Am.isSome)(o)){const t=j(o,cI);(0,Am.isSome)(t)?null===(p=null===(h=r.pageInformation)||void 0===h?void 0:h.adPageInfo)||void 0===p||p.recordAdResponseEventsIfNeeded(e,t,"0",n):L.splice(n,0,o)}else null===(v=null===(w=r.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===v||v.setMissedOpportunity(e,Vx,"0",n)}}else{L.splice(0,0,s),nn(e)&&0===s.length&&(null===(m=null===(g=r.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===m||m.setMissedOpportunity(e,Vx,"0",0))
const t=B(null==s?void 0:s[0],k_);(0,Am.isSome)(t)&&(null===(A=null===(y=r.pageInformation)||void 0===y?void 0:y.adPageInfo)||void 0===A||A.setAdsClientDecisions(t,"0",0))}const F=tg(n,e)
let $,x,N
for(const[s,u]of L.entries()){if(s===F){const o=rg(e,t.requestDescriptor,a,r)
if(o.length>0){const t=null!==(S=null===(b=null===(T=null==n?void 0:n.displayStyle)||void 0===T?void 0:T.guidedSearch)||void 0===b?void 0:b.title)&&void 0!==S?S:e.loc.string("Search.Guided.Title.ExploreMore"),i=new Mte(t,o)
Jh(e,i,{...r,id:TI,kind:BV,targetType:oE,title:t,softwareType:null}),O.push(i),Vh(r.locationTracker)}}if(Array.isArray(u)||(0,Am.isSome)(fn(0,u))){const n=Gv(e,L,s,t,r,null!=c?c:null,null!=l?l:null,D,_),o=n.result
$=o,x=n.displayStyle,N=u,(0,Am.isSome)(null===(P=null==o?void 0:o.lockups)||void 0===P?void 0:P[0])&&(o.searchAdOpportunity=o.lockups[0].searchAdOpportunity,O.push(o))
continue}if(!i(u.attributes)){E.push(...o.slice(s))
break}if(st(e,u,Im.Search))continue
let d
const f=L[s+1]
Array.isArray(f)||!(0,Am.isSome)(B(f,NB))||st(e,f)||(d=f),((0,Am.isSome)(null==$?void 0:$.lockups)&&$.lockups.length>0||(0,Am.isSome)(d))&&eg(e,u,N,$,d,c,l,r,_)
const h=_v(e,u,n,_,r,t.requestDescriptor.isNetworkConstrained,t.requestDescriptor.searchEntity,D)
!(0,Am.isNothing)(h)&&((0,Am.isSome)(null==$?void 0:$.lockups)&&$.lockups.length>0&&Xv(0,$,h,D,x),Jt(e)&&M.includes(s)&&(0,Am.isSome)(null===(C=r.pageInformation)||void 0===C?void 0:C.adPageInfo)&&(h.searchAdOpportunity=qt(e,r.pageInformation),null===(I=h.searchAdOpportunity)||void 0===I||I.setMissedOpportunityReason(Vx),null===(k=h.searchAdOpportunity)||void 0===k||k.setTemplateType(zG)),O.push(h),Vh(r.locationTracker),$=void 0,x=void 0,N=void 0)}return await async function(e,t){return await ym.context("applyClientFilteringToIAPs",async()=>{const n={}
for(const e of t)if(e.resultType===BG){const t=e.lockup
t.parent&&t.productIdentifier&&t.parent.bundleId?n[t.productIdentifier]=t.parent.bundleId:ym.unexpectedNull(gq,$W,`required fields for ${t.adamId}`)}return 0===Object.keys(n).length?await Promise.resolve(t):await e.clientOrdering.visibilityForIAPs(n).then(e=>t.filter(t=>{if(t.resultType!==BG)return!0
const n=t.lockup
return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}))})}(e,O).then(e=>({builtSearchResults:e,deferredSearchResults:E}))}function rg(e,t,n,r){if((0,Am.isNothing)(n)||0===n.length)return[]
Nh(0,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:G_},"")
const o=[]
for(const i of n){const n=Av(e,SI,t,i,r)
n&&(o.push(n),Vh(r.locationTracker))}return Bh(r.locationTracker),o}function og(e,t,n,r){const o=new y6(t,t,null,r)
return o.spellCheckEnabled=!1,o.excludedTerms=[n],o.originatingTerm=n,o}function ig(e,t){return t&&t.results?t.results.slice(0,t.maxPerPage):[]}function sg(e,t){let n=[]
if(t&&t.results&&(n=t.results.slice(t.maxPerPage,t.results.length)),o(n))return null
const r={...t}
return r.results=n,r}function ag(e){switch(e){case by.iOS:return AW
case by.visionOS:return"visionos"
default:return"SearchTopResults"}}function cg(e,t){const n=new oQ
return i(t)&&(n.facets=Pv(e,t),n.pageFacets=Cv(e),n.selectedFacetOptions=Iv(e)),n.results=[],n}function lg(e,t){const n=new Qte([])
return i(t)&&(n.facets=Pv(e,t),n.pageFacets=Cv(e),n.selectedFacetOptions=Iv(e)),n}async function ug(e,t){return await ym.context("searchResultsFromResponse",async()=>{var n
const r=null!==(n=e.fetchTimingMetricsBuilder)&&void 0!==n?n:new iy.FetchTimingMetricsBuilder,a=await r.measureModelConstructionAsync(async()=>{var n,r,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b,S,P,C,I,k,O,E
const D=t.catalogResponse,R=t.requestMetadata,_=R.searchRequestUrl,L=t.searchResultsAdsRequestData,M=D.results.guidedSearch,$=function(e,t,n){var r,o,i,s,a,c,l
return{term:t.term,suggestedTerm:null===(o=null===(r=n.results)||void 0===r?void 0:r.spellCheck)||void 0===o?void 0:o.suggestedTerm,correctedTerm:null===(s=null===(i=n.results)||void 0===i?void 0:i.spellCheck)||void 0===s?void 0:s.correctedTerm,resultsTerm:null!==(l=null===(c=null===(a=n.results)||void 0===a?void 0:a.spellCheck)||void 0===c?void 0:c.correctedTerm)&&void 0!==l?l:t.term,originatingTerm:t.originatingTerm}}(0,R.requestDescriptor,D),x=(O=t.searchResultsAdData,(0,mm.isSome)(O)&&"odmlSuccess"in O&&O.odmlSuccess),N={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:Wn(e,R.requestDescriptor,D,$,_,ag(),L,x,M),createUniqueImpressionId:!0},B=e.featureFlags.isEnabled(OK)||!0,U=B?new Qte:new oQ,G=tg(D.meta,e);(0,mm.isNothing)(G)&&function(e,t,n,r,i){const a=n.requestDescriptor
Nh(0,{pageInformation:i.pageInformation,locationTracker:i.locationTracker,targetType:G_},"")
const c=[]
if(s(r))for(const t of r){const n=Av(e,WN,a,t,i)
n&&(c.push(n),Vh(i.locationTracker))}if(o(c)&&n.requestDescriptor.searchEntity){const t=function(e,t,n){var r
const o=t.searchEntity
if(!o)return null
const i=new Ote(null,B_)
let s
switch(function(e,t,n,r,o){const i=Gx,s=GF,a={targetId:r},c=_t(e,r,s,{actionType:i,location:$h(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},r),searchTerm:n})
t.actionMetrics.addMetricsData(c)
const l=Lt(e,n,s,i,null,a)
t.actionMetrics.addMetricsData(l)}(e,i,t.term,o,n),o){case nz:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE")
break
case Eq:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS")
break
case jG:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_STORIES")
break
case oz:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_APPLEWATCH")
break
default:F(o)}const a=new Ite(s,!0,null!==(r=yv(o))&&void 0!==r?r:xO,s,i)
return Bn(0,a,GF,n),a}(e,n.requestDescriptor,i)
c.push(t),Vh(i.locationTracker)}const l=function(e,t,n){var r
if(o(n))return null
const i=t.term,s=null!==(r=t.guidedSearchTokens)&&void 0!==r?r:[],a=[]
for(const e of n){const t=e.displayLabel,n=Array.from(s)
if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t)
const r=new kte(i,n,e.finalTerm)
a.push(r)}return a}(0,n.requestDescriptor,r)
Bh(i.locationTracker),s(c)&&(t.guidedSearchTokens=c,t.guidedSearchQueries=l,function(e,t,n){const r=Uh(n.locationTracker)
t.guidedSearchTokensParentImpressionMetrics=new qJ({impressionIndex:r,impressionType:G_,idType:OG,id:OI,name:"Search Revisions"})}(0,t,i),Vh(i.locationTracker))}(e,U,R,null==M?void 0:M.facets,N)
const j={id:UN,kind:null,softwareType:null,targetType:HV,title:jU,pageInformation:N.pageInformation,locationTracker:N.locationTracker,idType:OG}
let V
B&&(V=new pK(UB),V.id=Un(),V.isHorizontal=!1,Jh(e,V,j),xh(0,j,jU))
let H=function(e,t){return function(e,t,n){if((0,mm.isNothing)(n))return t
const r=[],o=t.reduce((e,t)=>({...e,[t.id]:t}),{})
if("adverts"in n){if((0,mm.isNothing)(n.adverts)||0===n.adverts.length)return t
for(const t of n.adverts){const n=o[t.adamId]
if((0,mm.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,mm.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=Tv(e,n,t)
r.push(i)}}else if("ads"in n){if((0,mm.isNothing)(n.ads)||0===n.ads.length)return t
for(const t of n.ads){const n=o[t.adamId]
if((0,mm.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,mm.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=bv(0,n,t)
r.push(i)}}return r}(e,yt(t.catalogResponse.results[H_]),t.searchResultsAdData)}(e,t)
const q=t.searchResultsAdData
if((0,mm.isSome)(q)&&"appliedPolicy"in q&&(0,mm.isSome)(q.appliedPolicy)&&(H=[],"ageRestricted"===q.appliedPolicy)){const t=null!==(n=an(e,nW,!0,D.meta))&&void 0!==n?n:[]
for(const n of t)null===(a=null===(r=N.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===a||a.setMissedOpportunity(e,zS,"0",n.slot)}const W=null!==(d=null===(u=null===(l=null===(c=D.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.searchSafety)&&void 0!==d&&d,z=(null===(w=null===(p=null===(h=null===(f=D.meta)||void 0===f?void 0:f.results)||void 0===h?void 0:h.search)||void 0===p?void 0:p.reason)||void 0===w?void 0:w.kind)===V_?"NLS_NORESULTS":"NLS_NOAD"
if(W){H=[]
const t=null!==(v=an(e,nW,!0,D.meta))&&void 0!==v?v:[]
for(const n of t)null===(m=null===(g=N.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===m||m.setMissedOpportunity(e,z,"0",n.slot)}const Y=await ng(e,R,D.meta,N,function(e,t){return yt(t.catalogResponse.results.search)}(0,t),H,null==M?void 0:M.facets,function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.installedStates)&&void 0!==n?n:{}}(t),function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.appStates)&&void 0!==n?n:{}}(t))
if(W&&0!==Y.builtSearchResults.length){const e=Y.builtSearchResults[0].lockup.searchAdOpportunity
null==e||e.setMissedOpportunityReason(z),null==e||e.setTemplateType(zG)}if(B&&V){const t=U
V.items=Y.builtSearchResults,t.resultsParentImpressionMetrics=V.impressionMetrics,t.shelves.push(V)
const n=function(e,t){return ym.context("createSearchResultsContextCard",()=>{if((0,mm.isNothing)(e)||![tH,KH].includes(t.host.platform))return
const n=(r=e.text,o=e.links,ym.context("linkableTextFromServerLinks",()=>{var e
if(!r)return
const t=null==o?void 0:o.map(Sv),n=null==t?void 0:t.reduce((e,t)=>{var n
return(null===(n=t.title)||void 0===n?void 0:n.length)&&(e[t.title]=t),e},{})
let i=r
1===(null==t?void 0:t.length)&&(null===(e=t[0].title)||void 0===e?void 0:e.length)?i+=" "+t[0].title:t&&t.length>1&&(i.length>0&&(i+="\n"),i+=t.map(e=>e.title).filter(e=>null==e?void 0:e.length).join("\n"))
const s=new f2(i)
return new h2(s,n)}))
var r,o
return n?new Ete(n):void 0})}(D.results.queryContext,e),r=null===(T=null===(A=null===(y=D.meta)||void 0===y?void 0:y.results)||void 0===A?void 0:A.search)||void 0===T?void 0:T.reason
if((null==r?void 0:r.kind)===V_)t.unavailableReason={title:e.loc.stringWithFallback("Search.Results.Empty.Title","No results"),message:r.text,action:(E=r.links,ym.context("actionFromSearchResultsLinks",()=>{const e=null==E?void 0:E.find(e=>e.url.length>0)
return e?Sv(e):void 0})),contextCard:n}
else if(n){const e=new pK("searchResultsContextCard")
e.items=[n]
const r=null!==(C=null===(P=null===(S=null===(b=D.meta)||void 0===b?void 0:b.displayStyle)||void 0===S?void 0:S.queryContext)||void 0===P?void 0:P.position)&&void 0!==C?C:0
if(r>0){const n=V.items.splice(r),o={...V,id:"searchResults2",items:n}
t.shelves.push(e),t.shelves.push(o)}else t.shelves.unshift(e)}W&&0===Y.builtSearchResults.length&&(null===(k=(I=e.onDeviceSearchHistoryManager).removeRecentSearchTerm)||void 0===k||k.call(I,$.term))}else{const e=U
e.results=Y.builtSearchResults,function(e,t,n){const r=Uh(n.locationTracker)
t.resultsParentImpressionMetrics=new qJ({impressionIndex:r,impressionType:HV,idType:OG,id:UN,name:jU})}(0,e,N)}Y.deferredSearchResults.length>0&&(U.nextPage=function(e,t,n,r,i){return o(t)?null:{results:t,maxPerPage:30,requestMetadata:n,metricsOptions:i,responseMetadata:null!=r?r:{},contentOffsetWithinResultsShelf:Uh(i.locationTracker)}}(0,Y.deferredSearchResults,R,D.meta,N)),B&&Bh(j.locationTracker),U.message=function(e,t,n){const r=i(t.correctedTerm),o=i(t.suggestedTerm)
return Nh(0,{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:EW},"spellCorrection"),r?function(e,t,n){const r=t.term,o=og(0,r,t.resultsTerm,AR)
sa(e,o,lz,n.locationTracker)
const i=`<i>${t.correctedTerm}</i>`,s=e.loc.string("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(j_,i),a=new h2(new f2(s,hH),{}),c=e.loc.string("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(j_,r),l={}
l[`${c}`]=o
const u=new h2(new f2(c),l)
return new Kte(a,u,o)}(e,t,n):o?function(e,t,n){const r=t.suggestedTerm,o=og(0,r,t.resultsTerm,TR)
sa(e,o,lz,n.locationTracker)
const i=`<i>${r}</i>`,s=e.loc.string("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(j_,i),a={}
a[`${r}`]=o,a[`${r}?`]=o
const c=new h2(new f2(s,hH),a)
return new Kte(c,null,o)}(e,t,n):(Bh(n.locationTracker),null)}(e,$,N),!o(R.requestDescriptor.searchEntity)||(U.facets=Pv(e,R.requestDescriptor.facets,t.categoriesFilterData),U.pageFacets=Cv(e,t.categoriesFilterData),U.selectedFacetOptions=s(t.requestMetadata.requestDescriptor.selectedFacetOptions)?t.requestMetadata.requestDescriptor.selectedFacetOptions:Iv(e)),U.searchTermContext=$,U.isAutoPlayEnabled="tv"!==e.client.deviceType,U.isCondensedSearchLockupsEnabled=e.client.isPhone
const J=Ov(e,N)
return J&&e.clientCapabilities.isEnabled(vJ)?U.transparencyLink=new ene(J,Un()):U.transparencyLink=J,Vn(e,U,N.pageInformation),U.searchClearAction=dg(e,Ej,N.pageInformation,N.locationTracker,$.term),U.searchCancelAction=dg(e,IV,N.pageInformation,N.locationTracker,$.term),U})
return a})}function dg(e,t,n,r,o){const s=new Pz
let a,c
switch(t){case IV:a=Wj,c=IV
break
case Ej:a="delete",c=Ej}return function(e,t,n,r,o){const s={searchTerm:o,actionType:n.actionType}
n.actionDetails&&(s[Nj]=n.actionDetails),n.actionContext&&(s[sP]=n.actionContext),o&&(s[Hq]=o),i(n.softwareType)&&(s[RB]=n.softwareType),n.mercuryMetricsData&&Object.assign(s,n.mercuryMetricsData)
const a=_t(e,n.id,null!=r?r:Sh(0,n),s)
t.actionMetrics.addMetricsData(a)}(e,s,{targetType:lz,id:c,idType:void 0,actionType:a,pageInformation:n,locationTracker:r},lz,o),s}async function fg(e,t){return function(e,t,n){return ym.context("searchHintsFromApiResponse",()=>{var r,o,i,s
const a={targetType:Fj,pageInformation:qn(0,0,n.hintsRequestUrl,n.dataSetId),locationTracker:{rootPosition:0,locationStack:[]}}
let c=null;(null===(r=n.userTypedTerm)||void 0===r?void 0:r.length)&&(c=new y6(n.userTypedTerm,n.userTypedTerm,null,bR),c.spellCheckEnabled=!0,c.prefixTerm=t,rp(e,c,a),sa(e,c,a.targetType,a.locationTracker,a.pageInformation),Vh(a.locationTracker))
const l=null!==(i=null===(o=n.rawHints)||void 0===o?void 0:o.map(n=>function(e,t,n,r){var o,i,s,a,c
const l=null!==(o=function(e){switch(e.entity){case az:return e.context
case rH:return Eq
case YW:return jG
default:return null}}(t))&&void 0!==o?o:void 0,u=new y6(null!==(i=t.displayTerm)&&void 0!==i?i:"",null!==(s=t.searchTerm)&&void 0!==s?s:"",null,Nx,l,t.source)
return u.artwork=function(e,t){return kt(e,`systemimage://${t}`)}(e,null!==(a=yv(l))&&void 0!==a?a:xO),u.spellCheckEnabled=!0,u.prefixTerm=n,rp(e,u,r),sa(e,u,r.targetType,r.locationTracker,null!==(c=r.pageInformation)&&void 0!==c?c:void 0),Vh(r.locationTracker),u}(e,n,t,a)))&&void 0!==i?i:[]
null!=c&&l.unshift(c)
const u=new Zte(l,null!==(s=n.ghostHintsTerm)&&void 0!==s?s:null),d=Lt(e,t,"key",OR,n.hintsRequestUrl,{...Nt(a.pageInformation)})
return u.pageMetrics.pageFields=Nt(a.pageInformation),u.pageMetrics.addData(d,[Ym.PageInvocationPoint.pageEnter]),u.searchClearAction=dg(e,Ej,a.pageInformation,a.locationTracker,t),u.searchCancelAction=dg(e,IV,a.pageInformation,a.locationTracker,t),u})}(e,t,await async function(e,t){const n=function(e,t){const n=new cJ(e).includingAppBinaryTraitsAttribute(!1).forType(p$).withLimit(10).withSearchTerm(t).addingQuery(__,vI)
e.host.clientIdentifier===rJ&&n.addingQuery(Oj,eW)
const r=[]
return e.appleSilicon.isSupportEnabled&&r.push(L_),li(e)&&r.push(Uq),e.bag.isNaturalLanguageSearchEnabled&&r.push(gI),r.length>0&&n.enablingFeatures(r),n}(e,t)
return await Ln(e,n).then(t=>{var r
return{hintsRequestUrl:ge(e,n).toString(),userTypedTerm:f(t,"userTyped"),rawHints:l(t,"results.suggestions"),ghostHintsTerm:f(t,"ghosting"),dataSetId:f(null===(r=t.meta)||void 0===r?void 0:r.metrics,hQ)}})}(e,t))}function hg(e,t,n,r,i){const s=function(e,t,n,r,i){if(o(i))return[]
const s=[]
for(const[a,c]of i.entries()){const i=pg(e,c,a,t,n,r)
o(i)||(s.push(i),Vh(n))}return s}(e,n,r,t.itemDisplayStyle,i),a=new cne
a.title=e.loc.string("Action.ClearSearches"),function(e,t){const n=_t(e,"Clear Searches",lz,{actionType:"confirm"})
t.actionMetrics.addMetricsData(n)}(e,a)
const c=new SQ([a])
c.title=e.loc.string("Sheet.ClearSearches.Title"),c.message=e.loc.string("Sheet.ClearSearches.Message"),c.destructiveActionIndex=0,c.isCancelable=!0
const l=new rZ([c])
l.title=e.loc.string("Action.Clear")
const u=(f=t.shelfDisplayStyle).layout===sne?LI:2===f.layoutSize?"twoColumnList":EI,d=new pK(u)
var f
return d.id=nL,d.presentationHints={isWidthConstrained:!0},d.header={title:t.title,accessoryAction:l},d.contentType===LI&&(d.isHorizontal=!0,d.rowsPerColumn=t.shelfDisplayStyle.layoutSize),d.contentsMetadata={type:"searchFocusTwoColumnList",numberOfColumns:s.length>1?t.shelfDisplayStyle.layoutSize:1},d.items=s,d.isHidden=o(s),d.refreshUrl=function(e){return`${Cz}:/${_z.searchLandingPage}/${_z.shelf}/?${Hz.isOnDeviceSearchHistoryShelf}=true&${Hz.token}=${function(e){return encodeURIComponent(JSON.stringify(e))}(e)}`}(t),d}function pg(e,t,n,r,o,i){const s=t.term,a=t.entity,c=yg(e,function(e,t,n){if((0,Am.isNothing)(n))return t
let r
return n===Eq?r="Search.ResultsTitle.InDevelopers":n===jG?r="Search.ResultsTitle.InStories":n===oz?r="Search.ResultsTitle.InWatch":n===nz&&(r="Search.ResultsTitle.InArcade"),(0,Am.isNothing)(r)?t:e.loc.string(r).replace("@@search_term@@",t)}(e,s,a),s,a,o,yR,void 0,r,i)
return(0,Am.isNothing)(c)?null:(c.id=t.id,Jh(e,c,{targetType:EW,pageInformation:r,locationTracker:o,kind:EW,softwareType:null,title:t.term,hintsEntity:t.entity,id:`${n}`,idType:pW}),c)}function wg(e,t,n){var r
const i=t.data
if(o(i))return
let s=0
const a=e.bag.mediaAPISearchFocusEnabled&&(0,Am.isSome)(n.pageType)
for(const c of i){if(o(c))continue
if(a){const e=p(c,cH),t=vg(null==e?void 0:e.category)
if((0,Am.isSome)(t)&&t!==n.pageType)continue}const i=bg(e,n,s,t.meta||null);(0,Am.isSome)(i)&&(n.shelves.push(i),Vh(n.metricsLocationTracker))
const l=j(c,"contentKind"),u=fv(0,c,l),d=Sg(0,c,u,n,l)
xh(0,d.metricsOptions,null!==(r=u.title)&&void 0!==r?r:"")
const f=gg(e,c,n,d,u,l)
Bh(n.metricsLocationTracker),o(f)||(Jh(e,f,d.metricsOptions),un(e,[f],dH,d.metricsOptions.id,n.metricsPageInformation),n.shelves.push(f),s+=1,Vh(n.metricsLocationTracker))}}function vg(e){switch(e){case GN:return Ay.Landing
case"search-focus":return Ay.Focus
default:return}}function gg(e,t,n,c,l,u){switch(u){case Ty.Suggestion:return n.pageType===Ay.Focus?function(e,t,n,r,i){var s,a,c
const l=we(t,sz)
if((0,Am.isNothing)(l))return null
const u=[],d=new pK(EI)
d.isHorizontal=!1,d.title=r.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,i]of l.entries()){const l=j(i,Hq)
if((0,Am.isNothing)(l)||0===l.length)continue
const d=null!==(s=j(i,X_))&&void 0!==s?s:l,f=yg(e,null!=d?d:"",null!=l?l:"",void 0,n.metricsLocationTracker,kU,void 0,n.metricsPageInformation,null!==(a=r.searchLandingItemDisplayStyle)&&void 0!==a?a:void 0);(0,Am.isNothing)(f)||o(f)||(Jh(e,f,{targetType:EW,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,kind:EW,softwareType:null,title:null!==(c=f.title)&&void 0!==c?c:"",id:`${t}`,idType:pW}),u.push(f),Vh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,d)}(e,t,n,l):function(e,t,n,i,s){var c
const l=we(t,sz),u=[],d=new pK(aW)
d.isHorizontal=!1,d.title=i.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,o]of l.entries()){const s={targetType:EW,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},a=mg(e,o,n,i)
r(a)||r(a.action)||(Jh(e,a.action,{...s,kind:EW,softwareType:null,title:a.action.title,id:`${t}`,idType:pW}),u.push(a),Vh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,a(null===(c=i.displayStyle)||void 0===c?void 0:c.layoutSize)?d.contentsMetadata={type:Rx,numberOfColumns:i.displayStyle.layoutSize}:(e.client.isPhone||e.client.isPad)&&(d.contentsMetadata={type:Rx,numberOfColumns:u.length>=6?2:1}),d)}(e,t,n,l)
case Ty.CategoriesAndCharts:return wv(e,t,!1,l,0,c)
case Ty.Apps:return function(e,t,n,o,a){var c,l,u,d,f
const h=Im.All,p=[]
let w=!1,v=function(e){const t=fe(e,sz)
return null==t?void 0:t.data}(t)
const g=new pK(a.shelfStyle)
if(g.isHorizontal=!1,g.title=o.title,g.shouldFilterApps=!1,g.filteringExcludedItems=a.filteringExcludedItems,s(v)){const t=function(e,t,n){var o,s,a,c,l,u,d,f,h,p
const w=rc(t.adStitcher,n.adPositionInfo)
if(r(w))return null
const v=w.data
try{const r=Tg(e,v,t,n)
return i(r)?n.filteringExcludedItems=[v.id]:null===(o=t.metricsPageInformation.adPageInfo)||void 0===o||o.recordLockupFromDataFailed(e,null!==(a=null===(s=n.adPositionInfo)||void 0===s?void 0:s.shelfIdentifier)&&void 0!==a?a:uN,null!==(l=null===(c=n.adPositionInfo)||void 0===c?void 0:c.slot)&&void 0!==l?l:0),r}catch(r){return Zt(e,`Failed to create SLP ad lockup: ${r}`),null===(u=t.metricsPageInformation.adPageInfo)||void 0===u||u.recordLockupFromDataFailed(e,null!==(f=null===(d=n.adPositionInfo)||void 0===d?void 0:d.shelfIdentifier)&&void 0!==f?f:uN,null!==(p=null===(h=n.adPositionInfo)||void 0===h?void 0:h.slot)&&void 0!==p?p:0),null}}(e,n,a)
t&&dt(t)&&(w=!0,p.push(t),Vh(n.metricsLocationTracker),v=v.filter(e=>e.id!==t.adamId))}const m=(0,Am.isSome)(o.displayCount)
s(v)&&(v=wn(v,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(u=null===(l=a.metricsOptions)||void 0===l?void 0:l.recoMetricsData)&&void 0!==u?u:{}))
for(const t of v){if(t.type===tz)return null
if(r(t.attributes))continue
if(st(e,t,h))continue
const o=Tg(e,t,n,a)
o&&(p.push(o),Vh(n.metricsLocationTracker))}if(m){const e=o.displayCount
g.items=p.slice(0,e)}else g.items=p
if(m){const r=new pK(a.shelfStyle)
r.items=w?p.splice(1,p.length-1):p
const i=new gK([r])
i.title=g.title
const s=new _J(fz)
s.pageUrl=o.seeAllLink,s.title=e.loc.string(nq),s.pageData=i,g.seeAllAction=s,oa(e,s,s.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),Vn(e,i,Hn(0,t.id))}return(null===(d=o.displayStyle)||void 0===d?void 0:d.layout)===ane&&(g.isHorizontal=!0,g.rowsPerColumn=null===(f=o.displayStyle)||void 0===f?void 0:f.layoutSize),g}(e,t,n,l,c)
case Ty.EditorialCollection:return null
default:return function(e,t,n,r,o){return"search-recommendations-marker"!==t.type?null:j(t,Lx)===AI?function(e,t,n){return hg(e,new lne(n.title,n.displayCount,n.displayStyle,n.searchLandingItemDisplayStyle),t.metricsPageInformation,t.metricsLocationTracker,t.searchHistory)}(e,n,o):null}(e,t,n,0,l)}}function mg(e,t,n,r){var o,i
const s=j(t,Hq)
if((0,Am.isNothing)(s)||0===s.length)return null
const a=null!==(o=j(t,X_))&&void 0!==o?o:s,c=new y6(a,s,null,kU,void 0,void 0)
return c.artwork=Ag(null!==(i=r.searchLandingItemDisplayStyle)&&void 0!==i?i:void 0,e),sa(e,c,lz,n.metricsLocationTracker),(0,Am.isSome)(c)?new m6(c):null}function yg(e,t,n,r,i,s,a,c,l){if(o(n))return null
const u=new y6(t,n,null,s,null!=r?r:void 0,a,[])
return u.artwork=Ag(l,e),sa(e,u,lz,i,c),u}function Ag(e,t){var n
return(null==e?void 0:e.iconKind)===Py.Symbol&&(null===(n=null==e?void 0:e.iconKind)||void 0===n?void 0:n.length)?kt(t,`systemimage://${e.iconSymbol}`):t.client.isPhone?kt(t,Ox):void 0}function Tg(e,t,n,s){if(o(t))return null
if(s.shelfStyle!==mW)return null
let a=null
!i(s.shelfBackground)||s.shelfBackground.type!==wH&&s.shelfBackground.type!==qM||(a=lW)
const c=Nd(e,t,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),isAdvert:Ut(0,t)},artworkUseCase:uf(0,s.shelfStyle),offerStyle:a,canDisplayArcadeOfferButton:ph(0,s.shelfStyle),isContainedInPreorderExclusiveShelf:!1,shouldHideArcadeHeader:!1})
return r(c)||!c.isValid()?null:c}function bg(e,t,n,o){var i,s,a
const c=rc(t.adStitcher,{shelfIdentifier:U4,slot:n})
if(r(c))return null
const l=c.data
try{switch(null===(i=null==o?void 0:o.adDisplayStyle)||void 0===i?void 0:i.format){case DH:return function(e,t,n){var r,o
const i=new pK(K_)
i.isHorizontal=!1
const s=MW,a=lW,c=ep(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:AH,recoMetricsData:bt(t),isAdvert:Ut(0,t)})
c.kind=Z_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:uf(0,K_),canDisplayArcadeOfferButton:ph(0,K_)},u={canPlayFullScreen:!1,playbackControls:{}}
let d=qd(e,t,l,u,null,!1)
const h=d.screenshots[0],p=Ht(h)
n.metricsPageInformation.adPageInfo.setTemplateType(e,p)
const w=wf(e,t,{useCase:R3.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:yx})
d=qd(e,t,l,u,null,!1),null===(r=d.searchAdOpportunity)||void 0===r||r.setTemplateType(p)
const v=w.backgroundColor,g=w.textColor,m=new n2(d,[h],!0,g,v,null!==(o=e.bag.todayAdMediumLockupScreenshotsRiverSpeed)&&void 0!==o?o:8)
return Qh(e,m,c,c.pageInformation.adPageInfo),m.clickAction=Jd(e,t,c,null),i.items=[m],i}(e,l,t)
case"condensed":return function(e,t,n){var r,o
const i=new pK(Q_)
i.isHorizontal=!1
const s=MW,a=lW,c=ep(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:AH,recoMetricsData:bt(t),isAdvert:Ut(0,t)})
c.kind=Z_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:uf(0,Q_),canDisplayArcadeOfferButton:ph(0,Q_)}
null===(r=n.metricsPageInformation.adPageInfo)||void 0===r||r.setTemplateType(e,zG)
const u=qd(e,t,l,{canPlayFullScreen:!1,playbackControls:{}},null,!1)
null===(o=u.searchAdOpportunity)||void 0===o||o.setTemplateType(zG)
const d=new e2(u,u.icon)
return Qh(e,d,c,c.pageInformation.adPageInfo),i.items=[d],i}(e,l,t)
default:return null===(s=t.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,U4,n),null}}catch(r){return Zt(e,`Failed to create SLP ad shelf: ${r}`),null===(a=t.metricsPageInformation.adPageInfo)||void 0===a||a.recordLockupFromDataFailed(e,U4,n),null}}function Sg(e,t,n,r,o=null){const i=hv(0,t,n,r)
return o===Ty.Apps?{...i,shelfStyle:mW,adPositionInfo:B4}:i}function Pg(e,t){const n=new cJ(e).forType(F_).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e)).includingScopedRelationships("search-recommendations",[sz]).addingQuery(cz,GN)
Wi(e,w$)&&Ci(n),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([bW])
const r=vc(e,e.user.dsid)
return(null==r?void 0:r.length)>0&&n.addingQuery(M_,r),n.addingQuery(cH,"adDisplayStyle"),n}function Cg(e,t,n,r){var i
if(o(t.data))return null
const s=Gn(e,wj,wj,t),a=Os(e)
s.recoMetricsData=Mh(s.recoMetricsData,null,a),s.adPageInfo=dn(e,dH,n),null===(i=s.adPageInfo)||void 0===i||i.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,uN,0)
const c={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:s,adStitcher:oc(e,n,t),pageType:Ay.Landing,recoImpressionData:vn(0,r)}
wg(e,t,c)
const l=Ig(e)
l&&c.shelves.unshift(l)
const u=new one(c.shelves)
return u.pageRefreshPolicy=new HQ(yI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null),Vn(e,u,c.metricsPageInformation),u}function Ig(e){var t
if(!e.bag.isNaturalLanguageSearchEnabled&&!e.bag.isNaturalLanguageSearchResultsEnabled)return
const n=Ol(0,"searchFocusHeader",{signal:{lastNLSQueryDate:e.storage.retrieveString($_),treatmentId:null!==(t=Ne(e,Cm.SearchLandingPage))&&void 0!==t?t:null}},"pullOnly")
return n.refreshUrl=`${Cz}:/${_z.searchLandingPage}/${_z.shelf}/?${Hz.isSearchFocusHeaderShelf}=true`,n}function kg(e,t,n){wg(e,t,n)
const r=new ine(n.shelves)
return o(r.shelves)?null:(Vn(e,r,n.metricsPageInformation),r)}async function Og(e,t){const n=new iy.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await iw(r,t)
return(0,mm.isNothing)(o)?lg(e,t.facets):await async function(e,t){return await ug(e,t)}(r,o)}async function Eg(e,t){return await async function(e,t){return await ym.context("paginatedSearchResultsPageWithToken",async()=>{const n=ig(0,t),r=sg(0,t)
if(0===n.length)return await Promise.resolve(lg(e))
const o=t.metricsOptions.pageInformation
if((0,mm.isSome)(o)&&(0,mm.isSome)(null==o?void 0:o.adPageInfo)){const n=y(o.adPageInfo);(0,mm.isSome)(n)&&(o.adPageInfo=o2.from(e,n),t.metricsOptions.pageInformation=o)}return await sw(e,n).then(async n=>{const o=yt(n),s={id:UN,kind:null,softwareType:null,targetType:HV,title:jU,pageInformation:t.metricsOptions.pageInformation,locationTracker:t.metricsOptions.locationTracker,idType:OG},a=new pK(UB)
return a.id=Un(),a.isHorizontal=!1,Jh(e,a,s),xh(0,s,jU),jh(s.locationTracker,t.contentOffsetWithinResultsShelf),await ng(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(n=>{const o=Ov(e,s),c=function(e,t,n,r,o=0){let i=function(e){const t=e.bag.searchResultsLearnMoreEditorialId
!(0,mm.isNothing)(t)&&(null==t||t.length)}(e)
const s=n.builtSearchResults.length,a=n.deferredSearchResults.length>0,c=o+s
if(void 0===i||void 0===t||o>=i||a&&c<i||0===c&&!a)return r.items=n.builtSearchResults,[r]
i-=o,r.items=n.builtSearchResults.slice(0,i)
const l=new pK("searchResultsLearnMoreNotice")
l.isHorizontal=!1
const u=new tne(t)
l.items=[u]
const d=[r,l],f=n.builtSearchResults.slice(i)
if(f.length>0){const e=new pK(UB)
e.impressionMetrics=r.impressionMetrics,e.isHorizontal=!1,e.items=f,d.push(e)}return d}(e,o,n,a,t.contentOffsetWithinResultsShelf),l=new Qte(c)
return i(r)&&(r.contentOffsetWithinResultsShelf=Uh(s.locationTracker),l.nextPage=r),l.isCondensedSearchLockupsEnabled=e.client.isPhone,l.resultsParentImpressionMetrics=a.impressionMetrics,Bh(t.metricsOptions.locationTracker),l.searchClearAction=dg(e,Ej,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l.searchCancelAction=dg(e,IV,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l})})})}(e,t)}function Dg(e){return ee(e)}function Rg(e){const t=[RW,TW,vU,yq,hL,pL,wL,Xj,tq,Tx]
return e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}function _g(e,t,n){var r,o
t.includingAgeRestrictions().includingAdditionalPlatforms(Dg(e)).includingAttributes(Rg(e)).includingScopedAttributes(SV,[Xj]).includingScopedRelationships(YW,[vq,m$]).includingScopedRelationships(SV,[m$]).enablingFeature("editorialItemGroups").usingCustomAttributes(Ue(e)).includingRelationshipsForUpsell(!0),n&&(t.includingAssociateKeys(SV,[oq,YV]),t.includingAssociateKeys(YW,[YV])),li(e)&&(t.enablingFeature(Uq),t.addingQuery(cH,kx),t.includingScopedRelationships(tz,[VW]),t.includingScopedAttributes(tz,eQ)),di(e)&&(t.enablingFeature(CU),n&&t.includingKindsKeys($H,[X$])),gn(e)&&t.enablingFeature("eiGroupEISelectionOnDevice"),Kt(e,UW)&&t.enablingFeature("adSupport"),t.enablingFeature("heroStyles")
const i=null!==(o=null===(r=e.userDefaults)||void 0===r?void 0:r.bool(wS))&&void 0!==o&&o
e.bag.enableDeviceDrivenDiscoveryContent&&i&&t.resourceType===UW&&t.addingQuery("pairedDevices","visionPro")}async function Lg(e,t){const n=e.required(R9),i=t.url===mT,a=-1!==t.url.indexOf(_z.todayCardPreview)
if(i)return await n.fetchPage(e,t.url,mne)
if(a){const r=oY.from(t.url)
return r.param(Hz.fetchData,cW),await n.fetchPage(e,r.build(),mne)}{const n=function(e){return yu(e,new cJ(e).forType(UW).withSparseCount(1).withSparseLimit(2))}(e)
_g(e,n,!0)
const i=(0,mm.isSome)(t.experimentIdHeader)?{"X-Apple-User-Experiment-Ids":t.experimentIdHeader}:void 0
return await async function(e,t,n,i){var a
const c=new Cy.FetchTimingMetricsBuilder,u=e.addingFetchTimingMetricsBuilder(c),d=Ln(u,t,{headers:null!=n?n:void 0})
d.then(t=>{Kt(e,UW)&&function(e,t){const n=Xt(e,t,!0)
r(n)||(e.ads.setTimeoutForCurrentOnDeviceAdFetch(t,n),function(e,t,n){e.timeoutManager.setTimeout(t,n)}(e,n,ote))}(e,UW),wc(e,e.user.dsid,t)})
const h=_(d),p=function(e,t){const n={}
if(s(t)){const r=new cJ(e).withIdsOfType(t,YW).includingAdditionalPlatforms(Dg(e)).includingAttributes(Rg(e))
n[Iy.OnboardingCards]=R(Ln(e,r,{}))}Kt(e,UW)&&(n[Iy.Ads]=R(av(e,UW))),function(e){const t=Is(e),n=lr(e,e.bag.todayTabArcadePersonalizationRate)
return t&&n}(e)&&(n[Iy.ODP]=R(async function(e,t){return await async function(e,t,n,r){const o=[t,e.timeoutManager.makePromise(r,null)]
return await Promise.race(o).then(e=>e)}(e,async function(e){try{const t=await async function(e,t){if(o(t.user.dsid)){const e=`${ite}: User is currently not signed in.`
throw ym.unexpectedType(Cq,e,null),new Error(e)}try{const n=l((await t.onDeviceRecommendationsManager.performRequest({type:"fetchUseCases",tab:e,dsId:t.user.dsid})).useCases)
if(o(n)){const t=`${ite}: ODP returned no use cases for tab: ${e}`
throw ym.unexpectedType(Cq,t,null),new Error(t)}return n}catch(t){const n=`${ite}: Failed to fetch ODP use cases for tab: ${e}, with error: ${t}`
throw ym.unexpectedType(Cq,n,null),new Error(n)}}(UW,e),n=t.map(async t=>await async function(e,t){try{const n=await async function(e,t){if(o(t.user.dsid))throw new Error(`${ite}: User is currently not signed in.`)
try{return await t.onDeviceRecommendationsManager.performRequest({type:GP,dsId:t.user.dsid,useCase:e})}catch(t){const n=`${ite}: Failed to perform ODP Today recommendation for useCase: ${e}, with error: ${t}`
throw ym.unexpectedType(Cq,n,null),new Error(n)}}(t,e),i=await async function(e,t){const n=l(t[jP])
if(o(n)){const t=`${ite}: ODP returned no candidates for useCase: ${e}`
throw ym.unexpectedType(Cq,t,null),new Error(t)}const i=y(t[gV]),a=n.map(e=>function(e){const t=f(e.id),n=f(e.type)
if(r(t))return
let o,i=[]
switch(n){case VR:i=l(e.candidates).map(e=>f(e.id)).filter(e=>(0,mm.isSome)(e)),o=SV
break
case uV:o=YW
break
default:return}let a=[]
if(a.push({id:t,type:o}),s(i)){const e=i.map(e=>({id:e,type:YW}))
a=a.concat(e)}return new cte(t,o,i,a)}(e)).filter(mm.isSome)
if(r(i)||o(a)){const t=`${ite}: ODP candidates could not be parsed for useCase: ${e}`
throw ym.unexpectedType(Cq,t,null),new Error(t)}return{candidates:a,metrics:i}}(t,n),a=i.metrics,c=i.candidates
if(0===c.length)return
const u=c[0],d=await async function(e,t,n,r){const o=new cJ(r,t.data,!0).addingQuery(Hz.onDevicePersonalizationUseCase,e).addingQuery(Hz.filterRecommendable,cW)
os(r,o)
try{const i=await Ln(r,o)
return new ate(e,[t],n,i)}catch(e){const n=`${ite}: Failed to fetch Media API data for: ${t.data}, with error: ${e}`
throw ym.unexpectedType(Cq,n,null),new Error(n)}}(t,u,a,e)
return d}catch(n){return void e.console.log(`${ite}: Failed to perform ODP Today recommendation for useCase: ${t}, with error: ${n}`)}}(e,t)),i=(await L(n)).map(e=>e.success?e.value:void 0).filter(mm.isSome)
return new ste(i)}catch(t){return void e.console.log(`${ite}: Failed to perform ODP for Today recommendations: ${t}`)}}(e),0,ote)}(e)))
const i=e.amsEngagement
if(i&&gn(e)){const e={timeout:1e3,eventType:GZ,tab:UW}
n[Iy.AMDData]=R(i.performRequest(e))}return n}(e,null!==(a=null==i?void 0:i.onboardingCardIds)&&void 0!==a?a:[]),w=await hc(e,h,p)
return c.measureModelConstruction(()=>{var t,n
const r=yt(w.additionalData[Iy.OnboardingCards]),i=w.additionalData[Iy.Ads],s=w.additionalData[Iy.ODP],a=w.additionalData[Iy.AMDData],c=function(e,t,n,r,i){var s
const a=[]
let c=o(r)
const u=Rs(e,t)
let d=0
for(const i of t){if(o(i.contents))continue
const t=Cs(e,UW,null!==(s=i.contents)&&void 0!==s?s:[],!0,u)
i.contents=t.personalizedData,i.onDevicePersonalizationProcessingType=t.processingType
let h=!0
const p={label:i.label,title:i.title,meta:i.meta,date:i.date,onDevicePersonalizationProcessingType:i.onDevicePersonalizationProcessingType,isTodayForAppsModule:At(i)}
if(!c){for(const e of r)a.push({type:oy.EditorialItem,data:e,isDataHydrated:W(e),isFirstItemInModule:h,moduleMetadata:{...p},containedAdSlots:[d]})
h=!1,c=!0,d+=1}for(let t of i.contents){const r=f(t,"meta.personalizationData.onDeviceUseCase")
switch(t.type){case YW:if((0,mm.isSome)(r)){const e=null==n?void 0:n.storyData(r);(0,mm.isSome)(e)&&(t=e)}a.push({type:oy.EditorialItem,data:t,isDataHydrated:W(t),isFirstItemInModule:h,moduleMetadata:{...p},containedAdSlots:[d]}),h=!1,d+=1
break
case SV:const s=l(t,vL)
if(o(s))continue
let c
if((0,mm.isSome)(r)&&(c=null==n?void 0:n.storyGroupData(r)),(0,mm.isSome)(c))t=c
else{const n=Cs(e,UW,s,!0,u)
t[cH].associations[oq][RV]=n.personalizedData,i.onDevicePersonalizationProcessingType=n.processingType}a.push({type:oy.EditorialItemGroup,data:t,isDataHydrated:W(t),isFirstItemInModule:h,moduleMetadata:{...p},containedAdSlots:Array.from({length:s.length},(e,t)=>t+d)}),h=!1,d+=s.length}}}return a}(e,null!==(n=null===(t=w.primaryPageData.results)||void 0===t?void 0:t.data)&&void 0!==n?n:[],s,r)
return Mg(u,c,w.primaryPageData,i,a)})}(e,n,i,t)}}function Mg(e,t,n,r,i){return ym.context(CV,()=>{if(o(t))return null
const a=function(e,t,n,r,o){var i,a,c,u
const d=Gn(e,rP,UW,n,null,null!==(i=dn(e,UW,r,t))&&void 0!==i?i:Xs(e,UW,n,null===(a=null==r?void 0:r.onDeviceAd)||void 0===a?void 0:a.positionInfo,t)),f=Os(e)
d.recoMetricsData=Mh(d.recoMetricsData,null,f)
const h=new WQ(t,d,{rootPosition:0,locationStack:[]},jr(n),vn(0,o))
if(Kt(e,UW)){const n=an(e,UW,!0);(0,mm.isSome)(n)&&(h.eligibleAdLocations=n.map(e=>e.slot))
for(const t of null!=n?n:[])null===(c=d.adPageInfo)||void 0===c||c.recordAdResponseEventsIfNeeded(e,null==r?void 0:r.failureReason,t.shelfIdentifier,t.slot)
if(h.adPlacementBehavior=function(e){let t=Lm.insertIntoShelf
for(const n of e){let e=t
switch(n.type){case oy.EditorialItem:e=Ng(n.data)
break
case oy.EditorialItemGroup:const t=l(n.data,vL)
if(s(t))for(const n of t)if(e=Ng(n),e!==Lm.insertIntoShelf)break}if(e!==Lm.insertIntoShelf){t=e
break}}return t}(t),(0,mm.isNothing)(null==r?void 0:r.failureReason)){h.adData=mt(e,null==r?void 0:r.mediaResponse)
const t=null===(u=null==r?void 0:r.onDeviceAd)||void 0===u?void 0:u.positionInfo
if(s(t)){const e=t.slot-1
h.adLocation=e}}}return h}(e,t,n,r,i),c=Fg(e,a)
return c.shelves.splice(0,0,Ol(0,"todayPageHeader")),c})}function Fg(e,t){var n
const r=[],o=function(e,t){switch(e.client.buildType){case Rj:case WG:const e=new oY
e.protocol=Iz,e.host=FG,e.pathname=`/${_z.todayCardPreview}`
const n=[]
for(const e of t)switch(e.type){case oy.EditorialItem:n.push(e.data.id)
break
case oy.EditorialItemGroup:const t=l(e.data.meta,gL)
n.push(`${e.data.id}:[${t.map(e=>e.id).join(",")}]`)}return e.param(Hz.ids,n.join(",")),e.param(Hz.isTodayFeedPreview,cW),decodeURIComponent(e.build())
default:return null}}(e,t.remainingContent)
let a=Ds(t.remainingContent)
const c=null===(n=t.remainingContent[0])||void 0===n?void 0:n.isFirstItemInModule
for(;a;){const n=t.remainingContent.shift()
if((0,mm.isNothing)(n)){a=!1
break}const o=js(e,t);(0,mm.isSome)(o)&&r.push(o),t.currentTodayItem=n
let i=null
switch(n.type){case oy.EditorialItem:i=Ns(e,n,t)
break
case oy.EditorialItemGroup:i=Bs(e,n,t)}t.currentTodayItem=void 0,(0,mm.isSome)(i)&&r.push(i)
const s=js(e,t);(0,mm.isSome)(s)&&r.push(s),a=Ds(t.remainingContent)}c&&un(e,r,UW,UW,t.pageInformation)
const u=new mne(r),d=e.bag.tabsStandard.find(e=>e.id===UW),h=f(d,FW),p=f(d,"image-identifier"),w=(0,mm.isNothing)(p)||"doc.text.image"===p,v=null!=h?h:e.loc.string("PAGE_TITLE_TODAY")
return u.title=v,u.tabTitle=v,u.titleDetail=w?function(e){const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat")
return e.loc.formatDate(n,t)}(e):void 0,u.shortTitleDetail=w?function(e){const t=new Date
return e.loc.formatDate("MMM d",t)}(e):void 0,u.longTitle=w?function(e){if(!e.client.isPad)return
const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat.IPad")
return e.loc.formatDate(n,t)}(e):void 0,u.feedPreviewUrl=o,s(t.remainingContent)?(t.pageHasDisplayedContent=t.pageHasDisplayedContent||r.some(e=>{s(e.items)}),u.nextPage=t):function(e,t,n){const r=[],o=Il(e)
i(o)&&r.push(o)
const s=e.bag.termsAndConditionsURL
if(i(s)){const t=kl(e,s)
r.push(t)}return r}(e,t.pageInformation,t.locationTracker).forEach(e=>{u.shelves.push(e)}),Vn(e,u,t.pageInformation),u}async function $g(e,t){const n=t.pageHasDisplayedContent?6:12
let r=!0,o=0,i=[]
for(;r;){const e=t.remainingContent[o]
switch(e.type){case oy.EditorialItem:i.push(e.data)
break
case oy.EditorialItemGroup:i.push(e.data)
const t=l(e.data,vL)
i=[...i,...t]}o++,r=i.length<n&&o<t.remainingContent.length}const s=new Set(i.map(e=>e.id)),a=new cJ(e,i,!0,[oq,YV])
_g(e,a,!1)
const c=await Ln(e,a,{allowEmptyDataResponse:!0}),u={}
for(const e of c.data)u[e.id]=e
for(const e of t.remainingContent)xg(e,u)
return t.remainingContent=t.remainingContent.filter(e=>e.isDataHydrated||!s.has(e.data.id)),t}function xg(e,t){var n,r,o
switch(e.type){case oy.EditorialItem:s(t[e.data.id])&&(e.data={...e.data,...t[e.data.id]}),e.isDataHydrated=W(e.data)
break
case oy.EditorialItemGroup:s(t[e.data.id])&&(e.data={...e.data,attributes:null===(n=t[e.data.id])||void 0===n?void 0:n.attributes,relationships:null===(r=t[e.data.id])||void 0===r?void 0:r.relationships,meta:{...e.data.meta,...null===(o=t[e.data.id])||void 0===o?void 0:o.meta}}),e.isDataHydrated=W(e.data)}}function Ng(e){const t=g(e,zI)
return i(t)&&t?Lm.replaceOrganic:i(t)&&!t?Lm.dropAd:Lm.insertIntoShelf}function Bg(e,t){if(i(t.adPageInfo)){const n=y(t.adPageInfo)
s(n)&&(t.adPageInfo=o2.from(e,n))}}function Ug(e,t,n,r,o){return ym.context(_T,()=>Nd(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:R3.LockupIconSmall}))}function Gg(e,t,n,o,i,s){return ym.context("topChartsPageFromApiResponse",()=>{var a
const c=function(e){return l(e,"results.apps").filter(e=>!r(e.data))}(t),u=c.map(r=>function(e,t,n,r,o){return ym.context("segmentFromData",()=>{const{shortName:i,longName:s}=function(e,t,n){const r=f(t,sW)
let o=f(t,"shortName"),i=f(t,cz)
if(n!==HZ)return{shortName:(0,Am.unsafeUnwrapOptional)(o),longName:(0,Am.unsafeUnwrapOptional)(i)}
const s=e.client.isPad
switch(r){case X4:s?(o=e.loc.string("TopCharts.iPadGames.Free.ShortName"),i=e.loc.string("TopCharts.iPadGames.Free.LongName")):(o=e.loc.string("TopCharts.Games.Free.ShortName"),i=e.loc.string("TopCharts.Games.Free.LongName"))
break
case Q4:s?(o=e.loc.string("TopCharts.iPadGames.Paid.ShortName"),i=e.loc.string("TopCharts.iPadGames.Paid.LongName")):(o=e.loc.string("TopCharts.Games.Paid.ShortName"),i=e.loc.string("TopCharts.Games.Paid.LongName"))}return{shortName:(0,Am.unsafeUnwrapOptional)(o),longName:(0,Am.unsafeUnwrapOptional)(i)}}(e,t,o),a=f(t,sW),c=Gn(e,iA,r,n,`${a} ${s}`),l={rootPosition:0,locationStack:[]},u=[]
let d=0
const h=[]
for(const n of t.data){const t=Ug(e,d,n,c,l)
if(t){if(st(e,n,Im.Charts))continue
u.push(t),Vh(l),d++}else h.push(n)}const p=[],w=new pK(mW)
w.items=u,e.featureFlags.isEnabled(kK),w.title=s,p.push(w)
const v=new Sne(i,s,a,p),g=function(e,t,n,r,o){return{remainingContent:t,maxPerPage:20,highestOrdinal:0,url:void 0,metricsPageInformation:r,metricsLocationTracker:o}}(0,h,0,c,l)
return g.metricsPageInformation=c,g.metricsLocationTracker=l,g.highestOrdinal=d,v.nextPage=g,Vn(e,v,c),v})}(e,r,t,n,s)).sort((e,t)=>e.chart.localeCompare(t.chart)),d=f(c,"0.chart"),h=[]
if((0,Am.isSome)(o))for(const t of o.categories)if((0,Am.isSome)(t.genreId)){const n=1===c.length&&(0,Am.isSome)(d)&&kc(d)?d:void 0
h.push(jg(e,t,n))}const p=f(c,"0.href"),w=new oY(p),v=null!==(a=w.query[mq])&&void 0!==a?a:n,g=Vg(v,w.query[ZB],h),m=function(e,t){return t.every(e=>Cc(e.chart))?e.loc.string(MA):t.every(e=>Ic(e.chart))?e.loc.string(FA):t.every(e=>kc(e.chart))?e.loc.string($A):e.loc.string(xA)}(e,u),y=new N4(v,m,null==g?void 0:g.ageBandId,u,null==g?void 0:g.name,h),A=u.findIndex(e=>e.chart===i)
A>=0&&(y.initialSegmentIndex=A)
const T=e.fetchTimingMetricsBuilder
return(0,Am.isSome)(T)&&T.decorate(y),y})}function jg(e,t,n){const r=function(e,t,n=null,r=null){let o=new cJ(e).forType(JN).addingQuery(KN,az).addingQuery(mq,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)
return n&&(o=o.addingQuery(ZB,n)),(0,Am.isSome)(r)&&(o=o.addingQuery(sW,r)),e.appleSilicon.isSupportEnabled&&(o=o.includingAdditionalPlatforms([OW,IW])),o}(e,t.genreId,t.ageBandId,n),o=t.children.map(t=>jg(e,t,n))
return new Pne(t,ge(e,r).toString(),o)}function Vg(e,t,n){for(const r of n){if(t&&r.ageBandId===t||!t&&!r.ageBandId&&r.genreId===e)return r
const n=Vg(e,t,r.children)
if(n)return n}return null}async function Hg(e,t){const n=Wg().map(e=>new sY(e)),i=new oY(t),s=n.find(e=>e.matches(i)).extractParameters(i),a=i.query[Hz.genre]||s[Hz.genre],c=i.query[Hz.chart]||s[Hz.chart],l=i.query[Hz.charts],u=i.query[Hz.ages]
return await async function(e,t,n,i,s){if(o(n)){const e=Tc(0,i)
n=void 0!==e?`${i},${e}`:i}else n.includes(i)||(n+=`,${i}`)
const a=new iy.FetchTimingMetricsBuilder,c=e.addingFetchTimingMetricsBuilder(a),l=bc(c,t,n,s)
let u
return u=Sc(e,n,t),await Promise.all([l,u]).then(([n,o])=>a.measureModelConstruction(()=>{const s=Tn(e,o),a=r(s)?mn(t):yn(s)
return Gg(c,n,t,s,i,a)}))}(e,a,l,c,u)}async function qg(e,t){const n=St(0,t)
if(0===n.length)return await Promise.resolve(new Sne(null,null,null,[]))
let r=new cJ(e,n).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([OW,IW])),e.bag.enableUpdatedAgeRatings&&r.includingAttributes([bW]),await Ln(e,r).then(n=>{const r=Pt(0,t)
return zg(e,n,t,r)})}function Wg(e){return[{path:`/{apiVersion}/catalog/{countryCode}/${_z.charts}`,query:[`${Hz.genre}`,`${Hz.isPPT}?`,`${Hz.charts}?`]},{path:`/{countryCode}/${_z.charts}/{platform}/{chartType}/{genre}`,query:[`${Hz.chart}`]},{path:`/{countryCode}/${_z.charts}/{platform}/{chart}/{genre}`,query:[`${Hz.charts}?`]},{path:`/{countryCode}/${_z.charts}/{platform}`},{path:`/{countryCode}/{platform}/${_z.charts}`},{path:`/{countryCode}/{platform}/${_z.charts}/{genre}`}]}function zg(e,t,n,r){return ym.context("topChartSegmentFromLookupResponse",()=>{const o=[]
let i=n.highestOrdinal
const s=yt(t)
for(const t of s)st(e,t,Im.Charts)||(o.push(Yg(e,i,t,n.metricsPageInformation,n.metricsLocationTracker)),Vh(n.metricsLocationTracker),i++)
const a=[]
if(o.length>0){const e=new pK(mW)
e.items=o,a.push(e),r.highestOrdinal=i}const c=new Sne(null,null,null,a)
return c.nextPage=r,c})}function Yg(e,t,n,r,o){return ym.context(_T,()=>Nd(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:R3.LockupIconSmall}))}function Jg(e,t){const n=Rs(e,[t])
if(i(t.contents)){const r=Cs(e,"todayWidget",t.contents,!0,n)
t.contents=r.personalizedData}return t}function Kg(e,t,n,r,o,i){const s=[]
let a=0,c=0,l=0
if((0,mm.isNothing)(t.contents))return[]
for(const i of t.contents){if(z(i)){a++
continue}const t=we(i,Sq),u=im(e,i,n,r),d=(0,mm.isNothing)(u)&&(0,mm.isSome)(t)?Xg(e,t):[],f=om(i),h=[null==u?void 0:u.backgroundColor,(0,mm.isSome)(d)&&1===d.length?d[0].backgroundColor:void 0,ye("1C68E2")].find(e=>(0,mm.isSome)(e))
if(((0,mm.isNothing)(d)||0===d.length)&&(0,mm.isNothing)(u)){c++
continue}const p=Zg(e,i,r)
let w,v,g
if((0,mm.isSome)(t)&&t.length>0&&t[0].type===tz){const e=j(t[0],H$)
if((0,mm.isNothing)(e)||0===e.length){l++
continue}g=j(t[0],W$),w=new Date(e)
const n=j(t[0],q$)
v=(0,mm.isSome)(n)?new Date(n):void 0}const m=Ro(i)
s.push(new Dne(i.id,p,f,null!=h?h:void 0,be(h),null!=d?d:[],Qg(e,i,n,p,o),m===qL,u,g,w,v))}return(0,mm.isSome)(i)&&t.contents.length===a+c+l&&i(`All ${t.contents.length} cards in this ${r?"primary":"secondary"} module were filtered due to being unhydrated (${a}), missing artwork (${c}) or missing metadata (${l})`),s}function Zg(e,t,n){var r
let o=j(t,Gq)
if(!n){const n=Ro(t)
switch(n){case Jm.AppOfTheDay:case Jm.GameOfTheDay:o=null!==(r=bo(e,t,n,null))&&void 0!==r?r:void 0}}return null==o?void 0:o.replace(/\n/g," ")}function Qg(e,t,n,r,o){var i,a
let c
switch(n){case jB:c=0
break
case ek:c=1
break
case yL:c=2
break
default:c=-1}const l={widgetId:o,size:c,targetId:t.id,name:r},u=encodeURIComponent(JSON.stringify(l))
switch(Zd(0,t)){case E3:const n=we(t,vq),r=s(n)&&1===n.length?n[0]:null===(i=we(t,Sq))||void 0===i?void 0:i[0]
if((0,mm.isNothing)(r))break
const o=pe(e,r,VW)
if((0,mm.isNothing)(o))break
return`${Cz}:/${_z.product}/${Hz.id}${o.id}?${Hz.appEventId}=${r.id}${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${u}`
case O3:const c=null===(a=we(t,Sq))||void 0===a?void 0:a[0]
if((0,mm.isNothing)(c))break
return`${Cz}:/${_z.product}/${Hz.id}${c.id}?${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${u}`
case I3:return f(B(t,EW),BW)}return`${Cz}:/${_z.story}/${Hz.id}${t.id}?${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${u}`}function Xg(e,t){const n=[]
for(const r of t){if(r.type===jq)return
if(gf(e,r)){const t=em(e,r)
if((0,mm.isSome)(t)){const o=rm(e,r,t)
if((0,mm.isSome)(o)){const t=df(e,o,{cropCode:"bb",useCase:R3.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0});(0,mm.isSome)(t)&&n.push(t)
continue}}}const t=rm(e,r,tm(e,r)),o=nm(e,r),i=df(e,t,{cropCode:null!=o?o:void 0,useCase:R3.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0});(0,mm.isSome)(i)&&n.push(i)}return n}function em(e,t){switch(Gr(e,t)){case bY:return KT
case SY:return
default:return Tq}}function tm(e,t){switch(Gr(e,t)){case bY:return JE
case SY:return KE
default:return XW}}function nm(e,t){const n=Gr(e,t),r=vf(e)
let o
switch(n){case bY:o=r?"ic":"bb"
break
case SY:o="bb"
break
default:o=r?"ia":"bb"}return o}function rm(e,t,n){return rt(e,t,Ge(e,t),n)}function om(e){var t
const n=B(e,nH)
let r,o=null
s(n)&&(o=f(n,cz))
const i=we(e,Sq)
switch((0,mm.isSome)(i)&&i.length>0&&(r=j(i[0],cz)),j(e,Aq)){case Jm.AppOfTheDay:case Jm.GameOfTheDay:return null!==(t=null!=r?r:o)&&void 0!==t?t:""
default:return null!=o?o:""}}function im(e,t,n,r,o){var i
let s
Ro(t)===qL&&(s=function(e,t,n,r){var o
let i,s
const a=["editorialVideo.storyCardMotion16x9.previewFrame","editorialVideo.storyCenteredMotion16x9.previewFrame","editorialVideo.storeFrontVideo4x3.previewFrame"]
for(const e of a)if(s=B(t,e),(0,mm.isSome)(s))break
return s&&(i=null!==(o=df(e,s,{withJoeColorPlaceholder:!0,useCase:R3.WidgetEditorial}))&&void 0!==o?o:void 0,(0,mm.isSome)(i)&&!r&&(i.crop="sr")),i}(e,t,0,r))
const a=[{artworkKeyPath:ZI,crop:"sr"},{artworkKeyPath:g$,crop:"sr"}]
switch(Ro(t)){case Jm.AppOfTheDay:case Jm.GameOfTheDay:const e=n===jB?tk:"nr"
a.push({artworkKeyPath:lL,crop:r?e:"fn"})
break
case Jm.Video:case Jm.FullBleedImage:const t=n===jB?nk:rk
a.push({artworkKeyPath:sF,crop:r?t:"fn"})
break
case Jm.AppEventCard:const o=n===jB?tk:"nr"
a.push({artworkKeyPath:uL,crop:r?o:"fn"})
break
default:const i=n===jB?nk:rk
a.push({artworkKeyPath:dL,crop:r?i:"fn"})}let c
for(const n of a)if(c=null!==(i=df(e,B(t,n.artworkKeyPath),{cropCode:n.crop,useCase:R3.WidgetEditorial,withJoeColorPlaceholder:!0}))&&void 0!==i?i:void 0,(0,mm.isSome)(c))break
return null!=c?c:s}async function sm(e,t){let n,o
switch(t.family){case 1:n=ek
break
case 2:n=yL
break
default:n=jB}return typeof t.originalResponseHash!==gG&&null!==t.originalResponseHash&&""!==t.originalResponseHash&&typeof t.originalResponseDate!==gG&&null!==t.originalResponseDate&&""!==t.originalResponseDate&&(o={hash:t.originalResponseHash,creationDate:t.originalResponseDate}),await async function(e,t,n,o,a){return await new Promise((n,c)=>{if(!function(e,t,n,r){return!r||lr(e,e.bag.todayWidgetLivePreviewRolloutRate)}(e,0,0,o))return void c("No live preview will be shown due to losing the todayWidgetLivePreviewRolloutRate lottery.")
const l=new _ne,u=e=>c(e)
Ln(e,l.make(e)).then(o=>{const c=h(o,Wm.contentMaxAge),l=function(e,t){var n
if((0,mm.isNothing)(null===(n=null==e?void 0:e.results)||void 0===n?void 0:n.data)||0===e.results.data.length)return void t("Unable to create primary module; no results or data.")
const r=e.results.data[0].contents
if((0,mm.isNothing)(r)||0===r.length)t("Unable to create primary module; no contents.")
else{if(r.length!==r.filter(e=>z(e)).length)return{label:"",title:"",meta:{},contents:r}
t("Unable to create primary module; none of the cards are hydrated.")}}(o,u)
if((0,mm.isNothing)(l))return
const d=function(e){var t
const n={label:"",title:"",meta:{},contents:[]}
if((0,mm.isNothing)(null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.data)||0===e.results.data.length)return n
const r=e.results.data.slice(1)
return 0===r.length?n:{label:"",title:"",meta:{},contents:r.map(e=>e.contents).reduce((e,t)=>(null!=e?e:[]).concat(null!=t?t:[]))}}(o),f=function(t,n,r,o,i){var a,c,l
const u=(l=JSON.stringify((null!==(a=null==t?void 0:t.contents)&&void 0!==a?a:[]).concat(null!==(c=null==n?void 0:n.contents)&&void 0!==c?c:[]).map(e=>e.id))+((0,mm.isSome)(r)?r.toString():""),e.cryptography.hash("sha256",l))
return(0,mm.isSome)(i)&&s(i.hash)&&s(i.creationDate)&&i.hash===u?i:{hash:u,creationDate:(new Date).toUTCString()}}(l,d,c,0,a),p=function(e,t,n){(0,mm.isNothing)(n)&&e.console.error("No TTL value was found--deferring to JS client for refresh time.")
const r=new Date(t.creationDate)
return r.setSeconds(r.getSeconds()+(null!=n?n:0)),e.console.info(`Media API provided TTL: ${n} so timeline refresh date will be ${r}`),r}(e,f,c),w=Jg(e,l),v=Jg(e,d),g=function(e,t,n,o,s,a,c,l,u){if(r(t))return void u("Unable to create a TodayWidgetContainer; primaryModule is null.")
const d=Kg(e,t,o,!0,l,u)
if(0===d.length)return
const f=Kg(e,n,o,!1,l,void 0),h=function(e,t,n,r,o,s){const a=Re(t)
if((0,mm.isNothing)(a))return[]
const c=Le(a,n),l={}
for(let e=0;e<r.length;e++){const t=e%r.length*2
l[r[e].storyId]=s===yL?o.slice(t,t+2):[]}const u=function(e,t,n){return function(e,r){const o=[],i=[]
return e.forEach(e=>(e=>{if(void 0===e.eventStartDate||null===e.eventStartDate)return!1
const r=Re(e.eventStartDate)
return!(0,mm.isNothing)(r)&&t<r&&r<=n})(e)?o.push(e):i.push(e)),[o,i]}(e)}(r,a,n),d=u[0]
let f=u[1]
const h=[...Array(c)].map(()=>[]),p=[...Array(c)].map((e,t)=>new Date(a.getTime()+60*t*60*1e3)),w=new Map
r.concat(o).forEach(t=>{if(i(t.eventStartDate)){const n=Ti(t.eventBadgeKind,t.eventStartDate,t.eventEndDate)
w.set(t.storyId,bi(e,n,t.eventStartDate,t.eventEndDate))}}),d.forEach(e=>{const t=Le(a,e.eventStartDate)
var n
if(!(0,mm.isNothing)(t))for(let o=((t-1)%(n=r.length)+n)%n;o<h.length&&!((0,mm.isSome)(e.eventEndDate)&&e.eventEndDate<=p[o]);o+=r.length)for(let t=0;t<r.length&&!(h.length<=o+t);t++)if(0===h[o+t].length){h[o+t].push(S(e))
for(const n of l[e.storyId])h[o+t].push(S(n))
break}})
for(let e=0;e<h.length;e++){if(h[e].length>0)continue
const t=p[e]
if(f=f.filter(e=>void 0===e.eventEndDate||null===e.eventEndDate||e.eventEndDate>t),0===f.length)break
const n=f.shift()
if(!(0,mm.isNothing)(n)){f.push(n),h[e].push(S(n))
for(const t of l[n.storyId])h[e].push(S(t))}}return h.map((e,t)=>{const n=p[t],r=e.map(e=>{const n=w.get(e.storyId),r=function(e,t){if((0,mm.isNothing)(t)||0===t.length)return
const n=t.filter(t=>(0,mm.isNothing)(t.displayFromDate)||t.displayFromDate<=e)
return 0!==n.length?n.pop():void 0}(p[t],n)
return(0,mm.isSome)(r)?(e.heading=r.displayText,e.eventStartDate=r.countdownToDate):e.eventStartDate=void 0,e})
return new Ene(r,n)})}(e,new Date(a.creationDate),c,d,f,o)
return new One(h,c,a.creationDate,a.hash)}(e,w,v,t,0,f,p,XI,u);(0,mm.isNothing)(g)||n(g)}).catch(e=>{c(e)})})}(e,n,t.isSnapshot,t.isPreview,o)}var am,cm,lm,um,dm,fm,hm,pm,wm,vm,gm,mm,ym,Am,Tm,bm,Sm,Pm,Cm,Im,km,Om,Em,Dm,Rm,_m,Lm,Mm,Fm,$m,xm,Nm,Bm,Um,Gm,jm,Vm,Hm,qm,Wm,zm,Ym,Jm,Km,Zm,Qm,Xm,ey,ty,ny,ry,oy,iy,sy,ay,cy,ly,uy,dy,fy,hy,py,wy,vy,gy,my,yy,Ay,Ty,by,Sy,Py,Cy,Iy,ky,Oy,Ey,Dy,Ry,_y={}
e.r(_y),e.d(_y,{downloadingOrdering:()=>C2,downloadingOrderingCompact:()=>I2,notPurchasedOrdering:()=>S2,notPurchasedOrderingCompact:()=>P2,notPurchasedSpotlightIndex:()=>A2,purchasedOrdering:()=>T2,purchasedOrderingCompact:()=>b2,purchasedSpotlightIndex:()=>y2}),am={},e.r(am),e.d(am,{downloadingOrdering:()=>L2,downloadingOrderingCompact:()=>M2,notPurchasedOrdering:()=>R2,notPurchasedOrderingCompact:()=>_2,notPurchasedSpotlightIndex:()=>O2,purchasedOrdering:()=>E2,purchasedOrderingCompact:()=>D2,purchasedSpotlightIndex:()=>k2}),cm={},e.r(cm),e.d(cm,{notPurchasedOrdering:()=>N2,notPurchasedSpotlightIndex:()=>$2,purchasedOrdering:()=>x2,purchasedSpotlightIndex:()=>F2}),lm={},e.r(lm),e.d(lm,{notPurchasedOrdering:()=>j2,notPurchasedSpotlightIndex:()=>U2,purchasedOrdering:()=>G2,purchasedSpotlightIndex:()=>B2}),um={},e.r(um),e.d(um,{notPurchasedOrdering:()=>W2,notPurchasedSpotlightIndex:()=>H2,purchasedOrdering:()=>q2,purchasedSpotlightIndex:()=>V2}),dm={},e.r(dm),e.d(dm,{notPurchasedOrdering:()=>K2,notPurchasedSpotlightIndex:()=>Y2,purchasedOrdering:()=>J2,purchasedSpotlightIndex:()=>z2}),fm={},e.r(fm),e.d(fm,{notPurchasedOrdering:()=>e4,notPurchasedSpotlightIndex:()=>Q2,purchasedOrdering:()=>X2,purchasedSpotlightIndex:()=>Z2}),hm={},e.r(hm),e.d(hm,{notPurchasedOrdering:()=>o4,notPurchasedSpotlightIndex:()=>n4,purchasedOrdering:()=>r4,purchasedSpotlightIndex:()=>t4}),pm={},e.r(pm),e.d(pm,{notPurchasedOrdering:()=>c4,notPurchasedSpotlightIndex:()=>s4,purchasedOrdering:()=>a4,purchasedSpotlightIndex:()=>i4}),wm={},e.r(wm),e.d(wm,{downloadingOrdering:()=>w4,downloadingOrderingCompact:()=>v4,notPurchasedOrdering:()=>h4,notPurchasedOrderingCompact:()=>p4,notPurchasedSpotlightIndex:()=>u4,purchasedOrdering:()=>d4,purchasedOrderingCompact:()=>f4,purchasedSpotlightIndex:()=>l4}),vm={},e.r(vm),e.d(vm,{downloadingOrdering:()=>S4,downloadingOrderingCompact:()=>P4,notPurchasedOrdering:()=>T4,notPurchasedOrderingCompact:()=>b4,notPurchasedSpotlightIndex:()=>m4,purchasedOrdering:()=>y4,purchasedOrderingCompact:()=>A4,purchasedSpotlightIndex:()=>g4})
const Ly="AppEventSearchResult",My="AppSearchResult",Fy="com.apple.MobileSMS",$y="com.apple.TVAppStore",xy="com.apple.Arcade",Ny="com.apple.AppStore.ProductPageExtension",By="com.apple.appstorecomponentsd",Uy="ContingentOfferDetailPage",Gy="ShelfBasedProductPage",jy="EditorialSearchResult",Vy="arcadeGroupingLockup",Hy="Lockup",qy="arcadeGeneric",Wy="OfferItemDetailPage",zy="Screenshots",Yy="tapToRate",Jy="lockupList",Ky="TodayCardLockupOverlay",Zy="TodayCardMarketingLockupOverlay",Qy="TodayCardMediaArtwork",Xy="TodayCardMediaBrandedSingleApp",eA="TodayCardMediaList",tA="TodayCardMediaVideo",nA="TodayCardMediaRiver",rA="TodayCardParagraphOverlay",oA="TodayCardThreeLineOverlay",iA="TopChartsPage",sA="ArcadeAction",aA="CompoundAction",cA="ExternalUrlAction",lA="OfferAction",uA="OfferAlertAction",dA="OfferConfirmationAction",fA="ProductPageScrollAction",hA="SearchAdAction",pA="ShelfBasedPageScrollAction",wA="flowAction",vA="expanded",gA="continuation",mA="signup",yA="purchases",AA="donate",TA="is32bitOnly",bA="requires32bit",SA="is.workflow.my.app",PA="com.apple.mobileme.fmf1",CA="iPhone",IA="iPad",kA="com.apple.NanoCompass.watchkitapp",OA="com.apple.DeepBreathing",EA="com.apple.Depth",DA="com.apple.Mandrake",RA="SCS.ApDPCS01",_A="ACTION_SETTINGS",LA="shareSheet",MA="PAGE_TITLE_TRENDING_CHARTS",FA="PAGE_TITLE_EMERGING_CHARTS",$A="TopCharts.Selling",xA="TopCharts.Downloaded",NA="com.apple.InstallAssistant.",BA="Send Gift",UA="initiate",GA="additionalAdsInfo",jA="EDITORIALTAKEOVER",VA="SLPLOAD",HA="iad.format.text",qA="adsLocaleMetadata",WA="mapiFetchFail",zA="localizationNotAvailable",YA="SHARE_APP_EVENT_SUBTITLE",JA="j:mm",KA="inAppEvent",ZA="systemimage://bell.fill",QA="appPromotionTitle",XA="OfferItems.FormattedDate.RedemptionDate.DateFormat",eT="OfferItems.Available.Now",tT="@@date@@",nT="arcade-see-all-games-button",rT="GAME_CENTER",oT="marketingArtwork",iT="seed",sT="upsell",aT="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",cT="PAGE_FACETS_FILTERS_COMING_SOON",lT="PAGE_FACETS_SORT_BY_TITLE",uT="PAGE_FACETS_INCLUDE_TITLE",dT="000000",fT="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",hT="displayBreakoutMaterial",pT="material",wT="textGradient",vT="plusLight",gT="MMMM d, y",mT="x-as3-internal:/today/test",yT="invalidateWidgetsOnFailure",AT="PageData",TT="ProductBuilder",bT="contingent-items:branch",ST="contingentItemOffer",PT="contingent-items:association.trunks",CT="trunks",IT="offer-items:salables",kT="discountOffer",OT="promotionalText",ET="editorial-item-shelves",DT="viewEditorialItem",RT="preview",_T="lockupFromApiChartItem",LT="contentRatingsBySystem.appsApple.name",MT="ageRating.value",FT="ageRating.contentLevels",$T="br.l.official",xT="br.l",NT="br.10.official",BT="br.10",UT="br.12.official",GT="br.12",jT="br.14.official",VT="br.14",HT="br.16.official",qT="br.16",WT="br.18.official",zT="br.18",YT="impressionableAppIconFromData",JT="SCB.ApSCBL01",KT="circularIconArtwork",ZT="appBinaryTraits",QT="requiresRosetta",XT="iphone5",eb="iphone6",tb="iphone6+",nb="maxEssentialInstallSizeInBytes",rb="maxDownloadSizeInBytes",ob="maxInstallSizeInBytes",ib="editorialArtwork.contentLogoTrimmed",sb="posterCardVideo16x9",ab="watchBundleId",cb="macbook",lb="enabled",ub="concerns",db="SOMETHING_ELSE",fb="ACTION_REVIEW_REPORT",hb="TOAST_CONCERN_REPORTED_TITLE",pb="TOAST_CONCERN_REPORTED_DESCRIPTION",wb="systemimage://square.and.pencil",vb="userReviewId",gb="systemimage://hand.thumbsup",mb="systemimage://hand.thumbsdown",yb="guid",Ab="formBody",Tb="CONTROLLER_RECOMMENDED",bb="NOT_SUPPORTED",Sb="CAPABILITY_GAME_CENTER_TITLE",Pb="resource://ProductCapabilityGameCenter",Cb="safariExtensions",Ib="above",kb="hasApps",Ob="hasGames",Eb="DEVELOPER_APPS_AND_GAMES",Db="DEVELOPER_GAMES",Rb="DEVELOPER_APPS",_b="associations.apps.data",Lb="prefersHiddenPageTitle",Mb="enrichedEditorialNotes.tagline",Fb="enrichedEditorialNotes.callToAction",$b="shelf_id",xb="arcadeSeeAllGamesFooter",Nb="three",Bb="ARCADE_PREORDER_COMING_SOON",Ub="REPORT_A_PROBLEM",Gb="Shelves.Accessibility.Label",jb="Shelves.Accessibility.RoleDescription",Vb="featuredCategories",Hb="editorialCard",qb="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_GAME",Wb="breakoutTall",zb="renderGroupingPage",Yb="noPersonalizationAvailable",Jb="groupingAppEvent",Kb="suppressText",Zb="layoutStyle.layoutSize",Qb="link.url",Xb="GameCenter.ContinuePlayingShelf.Title",eS="videoCard",tS="impressionIndex",nS="Achievements Hero",rS="inprogress",oS="gameCenterFriendingViaPush",iS="legacy",sS="FRIEND_SUGGESTION",aS="smallContactCard",cS="INVITE",lS="FROM_CONTACTS",uS="inviteFriend",dS="removeFriendSuggestion",fS="friendSuggestion",hS="redownloadButtonTintUsingOfferTheme",pS="parentShelfItems",wS="displayDeviceDrivenContent",vS="null",gS="smallBreakout",mS="tagBrick",yS="advertPressed",AS="offerButtonPress",TS="MEDRIVER_",bS="iAdIsSpecifiedCreativeUsed",SS="promotedContent",PS="editorialContext",CS="Watch",IS="Messages",kS="developerName",OS="firstVersionSupportingInAppPurchaseApi",ES="widthConstrainedLockup",DS="OfferButton.Title.Subscribe",RS="descending",_S="editorialItemActionFromData",LS="displaySubStyle",MS="iad.lineItem",FS="clientIdentifierOverride",$S="contentRestrictionReasons",xS="clientCorrelationKey",NS="viewedInfo",BS="viewedInfoDetailed",US="cookie",GS="ownerDsid",jS="pageExit",VS="trampoline",HS="trampolineContext",qS="widgetContext",WS="iAdOdmlSuccess",zS="ODP_NOAD",YS="APPSTORE_SEARCH_LANDING_PAGE",JS="APPSTORE_TODAY_TAB",KS="APPSTORE_PRODUCT_PAGE",ZS="APPSTORE_PRODUCT_PAGE_DOWNLOAD",QS="iAdPageCustomId",XS="contingentItemId",eP="browserChoice",tP="browserChoiceScreenBuy",nP="clip",rP="Today",oP="subscriptionState",iP="buttonName",sP="actionContext",aP="selectedPageFacets",cP="searchGhostHint",lP="didYouMean",uP="displaysArcadeUpsell",dP="franchise",fP="isOnboardingCard",hP="optimizationEntityId",pP="optimizationId",wP="iAdEligible",vP="macSoftware",gP="iosSoftware",mP="artist",yP="pending",AP="channelPartner",TP="eligibilityType",bP="upsellScenario",SP="modeType",PP="FreeTrial",CP="PayUpFront",IP="PayAsYouGo",kP="test",OP="rebuy=true",EP="OfferButton.FlowPreview.Get",DP="OfferButton.FlowPreview.Preorder",RP="preorderedSubscribed",_P="productPageBrowserChoiceSelect",LP="preorderSubscribed",MP="INTRO_PRICE_OFFER_SUBTITLE",FP="Offer.InlineInAppPurchases",$P="OfferButton.ExternalPurchases.Subtitle",xP="weight_parameter",NP="meta.personalizationData.isPinned",BP="meta.personalizationData.segId",UP="OnDeviceRecommendationsPageController",GP="fetchRecommendations",jP="candidates",VP="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",HP="<br><br>",qP="privacyPolicy",WP="PRODUCT_PRIVACY_DEFINITIONS_LINK",zP="privacyDefinitions",YP="ACTION_SEE_DETAILS",JP="USAGE_DATA",KP="systemimage://person.circle",ZP="NOT_COMPATIBLE_BANNER",QP="UNSUPPORTED_CAPABILITIES",XP="UNSUPPORTED_WATCHOS_VERSION",eC="experimentLocale",tC="pageCustomId",nC="ProductPage.Section.ScreenshotsPreview.Title",rC="user",oC="reviewsContainer",iC="displayable-kind",sC="urlQuery",aC="editorsChoiceItem",cC="ratingCount",lC="APP_SUPPORT",uC="REVIEWS_MOST_HELPFUL",dC="REVIEWS_MOST_FAVORABLE",fC="REVIEWS_MOST_CRITICAL",hC="recent",pC="REVIEWS_MOST_RECENT",wC="reviewsPageActionFromReviewsData",vC="genreName",gC="BADGE_AGE_RATING_YEARS",mC="BADGE_AGE_RATING",yC="BADGE_PLAYERS_HEADING",AC="{maxPlayers}",TC="BADGE_NO_RATINGS_CAPTION",bC="storefrontContentRating",SC="{subtitle}",PC="webBrowserFlowType",CC="accessibilityParagraph",IC="prefersReadableContentAlignedTitle",kC="VOICE_CONTROL",OC="AccessibilityDetails.Header.NoLearnMoreLink",EC="AccessibilityDetails.Header.NoLearnMoreLink.NoDeveloperName",DC="ProductPage.Accessibility.Header.NoSupportedFeatures.NoLearnMoreLink",RC="ProductPage.Accessibility.Header.NoReportedFeatures.NoLearnMoreLink",_C="gameCenterPlayerGameAchievementSummary",LC="itemType",MC="ProductPage.Section.EditorsNotes.Title",FC="ProductPage.Section.FeaturedIn.Title",$C="largeGameCenterPlayer",xC="hasEula",NC="productMediaItem",BC="createTapToRateProductReviewAction",UC="ProductPage.RatingsAndReviews.Footer.LearnMore",GC="ProductPage.Section.MostRecentVersion.Title",jC="overview",VC="titledParagraph",HC="detail",qC="releaseNotes",WC="ProductPage.Section.Videos.Title",zC="textPair",YC="product-page-info-section",JC="deviceFamily",KC="InfoList.AgeRating.LearnMore",ZC="ageBand",QC="minAge",XC="maxAge",eI="{minAgeRating}",tI="{maxAgeRating}",nI="advisories",rI="seventeenPlus",oI="gracRegistrationNumber",iI="twelvePlus",sI="Seller",aI="isTrader",cI="adFailureReason",lI="Search.Facets.iPadAndIPhone",uI="Search.Facets.iPhoneOnly",dI="SEARCH_FACET_FREE",fI="SEARCH_FACET_",hI="filter[price]",pI="filter[genre]",wI="filter[ages]",vI="terms",gI="naturalLanguage",mI="results.contents",yI="timeSinceOnScreen",AI="recentSearches",TI="midScrollGuidedSearch",bI="SEARCH_TRANSPARENCY_LINK",SI="rewrite",PI="EDITORIAL_SEARCH_RESULT_TYPE_DEVELOPER_TITLE_CASE",CI="whenInstalled",II="mixed",kI="guidedLabel",OI="search-revisions",EI="singleColumnList",DI="@@chartPosition@@",RI="developerInfo",_I="divider",LI="scrollablePill",MI="displayType",FI="appMarkerType",$I="Acquisition",xI="InlineImage",NI="AppLockup",BI="InlineVideo",UI="quote",GI="Small",jI="Medium",VI="Large",HI="itunes.apple.com",qI="meta.personalizationData.optimizationId",WI="meta.personalizationData.optimizationEntityId",zI="meta.personalizationData.replaceIfAdPresent",YI="editorialBackground",JI="MC.ApSCFB01",KI="LCS.ApLCXW01",ZI="editorialArtwork.storyCardStatic16x9",QI="UAS.ApXWC01",XI="com.apple.AppStore.Widgets.Today",ek="systemMedium",tk="DCEC.AppWS01",nk="MCGC.AppWS01",rk="MCGC.AppWL01",ok="AppsAndPurchases.PageTitle",ik="appUpdates",sk="Updates",ak="ratingsAndReviews",ck="@@highlight@@",lk="AppsAndPurchases.FamilyAccount.AccountMismatch2.Link",uk="familyMember",dk="PersonalizedRecommendations.Toggle.Title",fk="PersonalizedRecommendations.Toggle.Footer",hk="PERSONALIZATION_PURCHASES",pk="RECOMMENDATIONS",wk="engagement-data",vk="ArcadeOnboarding",gk="extend",mk="ALL_ARCADE_GAMES",yk="arcadeSubscribePage",Ak="release",Tk="nonnull",bk="token.pageInformation",Sk="token.pageInformation.adPageInfo",Pk="token.excludeAttribution",Ck="isAppInstalled",Ik="token.targetType",kk="token.metricsKind",Ok="systemInformation",Ek="token.productVariantData",Dk="token.inAppEventId",Rk="Purchases",_k="OfferButton.Title.BundlePurchased",Lk="gameCenterProfile",Mk="OnDeviceRecommendationsPageController:handleShelf not implemented",Fk="ProductData",$k="Product page preloading is disabled",xk="lookup",Nk="app-bundle",Bk="search-recommendation-sections",Uk="trending-contents",Gk="TodayData",jk="TodayForApps",Vk="Arcade.DownloadPack.Suggestions.GetAllButtonTitle",Hk="asString",qk="asNumber",Wk="asBoolean",zk="catalog",Yk="engagement",Jk="view/see-all",Kk="its_qt",Zk="adId",Qk="prefix",Xk="username",eO="password",tO="port",nO="-caseInsensitive",rO="signatureResumption",oO="checkForLongUrl",iO="getPass",sO="hsb",aO="metrics-identifiers",cO="advp",lO="itsct",uO="itscg",dO="itcCt",fO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/accountSummary",hO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/redeemLandingPage",pO="IPHONE_BRAND_NAME",wO="IPAD_BRAND_NAME",vO="APPLE_TV_BRAND_NAME",gO="APPLE_WATCH_BRAND_NAME",mO="MAC_BRAND_NAME",yO="SearchResultsPageIntent",AO="ContingentOffer",TO="existing",bO="bundle",SO="com.apple.visionproapp",PO="editorial",CO="accountMismatch1",IO="accountMismatch2",kO="setupIncomplete",OO="InAppPurchaseLockup",EO="MixedMediaLockup",DO="PosterLockup",RO="ProductPage",_O="ScreenshotsLockup",LO="TrailersLockup",MO="arcadeTabNavBar",FO="textFollowsTintColor",$O="person.crop.square",xO="magnifyingglass",NO="list",BO="OfferStateAction",UO="TabChangeAction",GO="timer",jO="appsAndPurchases",VO="primaryTerm",HO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard",qO="isStandaloneWithCompanionForWatchOS",WO="isDeliveredInIOSAppForWatchOS",zO="isXROSCompatible",YO="free",JO="Mac",KO="systemimage://square.and.arrow.up",ZO="results.data",QO="accountDetails",XO="createAccount",eE="Redeem",tE="cppAssetsMissing",nE="customers-also-bought-apps-download",rE="past",oE="module",iE="events-and-offers",sE="appPromotion",aE="trunk-app",cE="useTrunkArtwork",lE="editorialArtwork.brandLogo",uE="systemimage://questionmark.circle",dE="comingSoonApps",fE="marketingVideo",hE="supportsSharePlay",pE="filter[ageRating]",wE="filter[supportsGameController]",vE="filter[isMultiplayer]",gE="controllerSupport",mE="subscribe",yE="Arcade.Welcome.Family.Button.ExploreArcade",AE="breakoutTextAlignment",TE="left",bE="right",SE="black",PE="arcadeSubscribe",CE="hiddenPurchases",IE="notificationSettings",kE="isViewOnly",OE="action.kind",EE="action.url",DE="Goto",RE="standalone-merchandised-in-apps",_E="see-all-contents",LE="fileSizeByDevice",ME="requirementsByDeviceFamily",FE="backgroundAssetsInfo",$E="backgroundAssetsInfoWithOptional",xE="installSizeByDeviceInBytes",NE="licenses",BE="internetContentProviderInfo",UE="review-summary",GE="categorizations",jE="future",VE="Apps",HE="ageBandId",qE="customAttributes",WE="appShowcase",zE="placeholderBackground",YE="checksum",JE="circularArtwork",KE="ovalArtwork",ZE="iphone_6_5",QE="iphone_d73",XE="iphone_d74",eD="editorialArtwork.splashFullScreen",tD="editorialArtwork.topShelf",nD="customVideoPreviewsByTypeForAd",rD="BreakoutLarge",oD="textColor3",iD="Alert.GenericError.Title",sD="Alert.GenericError.Message",aD="version",cD="decimalPad",lD="siri",uD="hasInAppPurchases",dD="systemGreen",fD="jpeg",hD="DEVELOPER_WATCH",pD="DEVELOPER_LATEST_RELEASE",wD="DEVELOPER_BUNDLES",vD="DEVELOPER_APPLE_ARCADE",gD="arcadeFooter",mD="enrichedEditorialNotes.name",yD="ignoreITunesShortNotes",AD="editorialNotes.short",TD="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_VIEW",bD="collectionIcons",SD="shelf_page_header",PD="navigationBar",CD="footer",ID="TermsAndConditions.Title",kD="two",OD="ribbonBar",ED="onDevicePersonalization",DD="Genre",RD="collectionModule",_D="collectionLockup",LD="breakoutFullScreen",MD="Browse Categories",FD="hasSeeAll",$D="designTag",xD="editorialStoryCard",ND="nonarcade",BD="isArcade",UD="date",GD="contentGraphicTrimmed",jD="insetAd",VD="Lockup.Heading.Arcade",HD="discounts",qD="inAppPurchaseInstall",WD="item.offer.buyParams",zD="offerId",YD="isVerifiedForAppleSiliconMac",JD="genreNames",KD="targetId",ZD="data-metrics-impressions-low-latency",QD="media",XD="exit",eR="hasiAdData",tR="APPSTORE_SEARCH_RESULT_PAGE",nR="overridePageContext",rR="userId",oR="dsId",iR="refAppType",sR="widget",aR="iAdImpressionIndex",cR="iAdRotationCount",lR="metadata",uR="context",dR="BrowserChoice",fR="com.apple.AppStore.clipOverlay",hR="paymentTopicFromBag",pR="overlayClip",wR="offerReleaseDate",vR="buyInitiate",gR="See All",mR="searchOriginatingTerm",yR="recents",AR="undoSpellCorrection",TR="applySpellCorrection",bR="userTypedHint",SR="impressionOptions",PR="impressionParentId",CR="searchGhostHintPrefix",IR="searchGhostHintTermPhase",kR="searchGhostHintTerm",OR="input",ER="meta.metrics",DR="dsid",RR="@@durationCount@@",_R="@@postTrialPriceDuration@@",LR="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",MR="arcade-preorder",FR="preorderedNotSubscribed",$R="confirmation",xR="preorderNotSubscribed",NR="OfferButton.IntroPrice.FreeTrial",BR="discountOwnedParent",UR="discountUnownedParent",GR="use_signals",jR="meta.personalizationData.grpId",VR="editorialItemGroup",HR="DATA_NOT_PROVIDED",qR="PRODUCT_PRIVACY_LEARN_MORE_LINK",WR="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",zR="privacyDetail",YR="privacyCard",JR="experimentId",KR="helpful",ZR="mostHelpfulReviews",QR="wasReset",XR="ratingsDetails",e_="RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS",t_="supportUrl",n_="medicalDevice",r_="chartPositions",o_="highMotion",i_="{minPlayers}",s_="{releaseDate}",a_="value",c_="{count}",l_="deviceCompatibility",u_="Offer.Expanded.Title.ComingSoon",d_="externalVersionId",f_="marker",h_="supportsClickEventsOnSwiftUIHostingCell",p_="AccessibilityDetails.Title",w_="ProductPage.Section.Information.Title",v_="ProductPage.Section.Supports.Title",g_="safetyAndComplianceUrl",m_="darkOverlay",y_="productReviewAction",A_="ProductPage.Section.Reviews.MostHelpfulReviews.Title",T_="productRatingsAndReviewsComponent",b_="versionDisplay",S_="standardInformationShelf",P_="InfoList.AgeRating.Title",C_="Install.Size.String",I_="{fileSize}",k_="adsClientDecisions",O_="dataSetId",E_="SEARCH_FACET_ANY_PRICE",D_="SEARCH_FACET_ANY_CATEGORY",R_="SEARCH_FACET_RELEVANCE",__="kinds",L_="macOSCompatibleIOSApps",M_="clusterId",F_="landing:new-protocol",$_="lastNLSQueryDate",x_="top-apps",N_="showLabelInSearch",B_="guidedToken",U_="secondaryGenreShortDisplayNames",G_="SearchRevisions",j_="{searchTerm}",V_="no-results",H_="ads-result",q_="searchChartsAndCategories",W_="alternateLabel",z_="contentIds",Y_="associations.app-events.data",J_="associations.app-events.attributes.forceAppEvent",K_="mediumAdLockupWithScreenshotsBackground",Z_="adItem",Q_="condensedAdLockupWithIconBackground",X_="displayTerm",eL="supportsGameController",tL="rankedSecondaryGenre",nL="onDeviceSearchHistory",rL="editorialLink",oL="upsellForNonacquisitionCanvas",iL="arcadeIcons",sL="AppMarker",aL="framedArtwork",cL="isAcquisition",lL="editorialArtwork.dayCard",uL="editorialArtwork.eventCard",dL="editorialArtwork.generalCard",fL="ignoreEditorialArt",hL="headerName",pL="headerBadge",wL="headerTagline",vL="meta.associations.recommendations.data",gL="associations.recommendations.data",mL="todaySection",yL="systemLarge",AL="personalization-data",TL="ACCOUNT_SETTINGS",bL="upsellRecovery",SL="token.metricsPlatformDisplayStyle",PL="https",CL="channel-apps",IL="done",kL="chin",OL="Arcade.DownloadPack.Suggestions.PrimaryButtonTitle",EL="strict",DL="customIconArtwork",RL="ratings",_L="suffix",LL="language",ML="AppEvent",FL="OfferItem",$L="com.apple.AppStore",xL="arcadeProductPage",NL="UpdatesLockup",BL="askToBuy",UL="launchRepair",GL="editorialItemCanvas",jL="blue",VL="visionpro",HL="river",qL="Video",WL="FlowAction",zL="pageChange",YL="originalUrl",JL="updates",KL="checkForPreorders",ZL="meta.discountOffer",QL="viewGenre",XL="CONTROLLER_OPTIONAL",eM="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",tM="SIRI_REMOTE_REQUIRED",nM="sendGift",rM="addFunds",oM="familySharing",iM="manageSubscriptions",sM="deepLink",aM="png",cM="close",lM="redemptionExpirationDate",uM="details",dM="systemBlue",fM="with",hM="personal-recommendations",pM="comingSoon",wM="wordmark",vM="external",gM="Action.OK",mM="messagesScreenshots",yM="supportsFunCamera",AM="supportURLForLanguage",TM="websiteUrl",bM="top-in-app-purchasables",SM="unlistedApps",PM="redownload",CM="cabAdSupport",IM="merchandised-in-apps",kM="textColor1",OM="670",EM="roundPrerendered",DM="roundedRectPrerenderedWithInset",RM="tvRect",_M="appleWatch_2021",LM="appleWatch_2018",MM="appleWatch",FM="iphone_5_8",$M="editorialArtwork.bannerUber",xM="splashVideo4x3",NM="arcadeShowcase",BM="StoryMedium",UM="systemimage://exclamationmark.circle",GM="application/json",jM="prefersNonStandardBackButton",VM="textOnly",HM="subscriptionHero",qM="interactive",WM="pageHeader",zM="hasChevron",YM="textLightensOnHighlight",JM="hasSeparator",KM="TwoUp",ZM="Asymmetrical",QM="CategoryGrouping",XM="cppData",eF="contingentItems",tF="prefersLargeTitleWhenRoot",nF="singleModule",rF="materialText",oF="arcadeDownloadPackCard",iF="displayCount",sF="editorialArtwork.mediaCard",aF="nonArcade",cF="locked",lF="friendingViaPush",uF="inAppPurchaseTiledLockup",dF="standardApp",fF="platformAttributes.ios.bundleId",hF="abExperiment",pF="userRating.ratingCount",wF="userRating.value",vF="editorialBadgeType",gF="editorialPriority",mF="isSubscription",yF="appExtVrsId",AF="parentId",TF="multiple-system-operators",bF="pageReferrer",SF="crossfireReferral",PF="advertDeviceWindow",CF="cardType",IF="iAdMetadata",kF="SearchFocus",OF="Focus",EF="position",DF="submit",RF="SoftwareBundle",_F="iAdAppStoreClientRequestId",LF="METADATA",MF="iAdMissedOpportunityReason",FF="iAdSlotInfo",$F="customProductPage",xF="prevPage",NF="platformDisplayStyle",BF="application/x-www-form-urlencoded",UF="iAdDuplicateLayoutType",GF="hintsEntity",jF="idType",VF="update",HF="complete",qF="OfferButton.Title.Get",WF="{appName}",zF="notSubscribed",YF="OfferButton.IntroPrice.Trial",JF="meta.personalizationData.score",KF="PRODUCT_PRIVACY_TITLE",ZF="privacyType",QF="systemimage://exclamationmark.triangle",XF="webBrowser",e$="install",t$="text/markdown",n$="chartPosition",r$="BADGE_MFI_HEADING",o$="systemimage://person.crop.square",i$="MMM d, yyyy",s$="watchOS",a$="xrOS",c$="prefersIndirectTouch",l$="PRIVACY_POLICY",u$="ProductPage.Section.SafetyAndCompliance.Title",d$="componentBackgroundStandout",f$="APP_STORE_EDITORS_NOTES",h$="framedVideo",p$="search-hints",w$="slp",v$="imageWithLabel",g$="editorialArtwork.storyCenteredStatic16x9",m$="header-contents",y$="materialGradient",A$="fractionalWidth",T$="de7bbd8e",b$="multiplex",S$="customers-also-bought-apps-with-download-intent",P$="user-reviews",C$="searchLanding:see-all",I$="customArtwork",k$="hash",O$="dynamic",E$="apps-media-api-edge-host",D$="guidedSearch",R$="groupingLockup",_$="actionLinks",L$="productReview",M$="applewatch",F$="multiApp",$$="singleLockup",x$="isIOSBinaryMacOSCompatible",N$="fields",B$="requiresGameController",U$="CONTROLLER_REQUIRED",G$="webView",j$="Account",V$="lockupArtwork",H$="startDate",q$="endDate",W$="badgeKind",z$="eventModule",Y$="inAppEventId",J$="branch-app",K$="<b>",Z$="</b>",Q$="<br>",X$="winback",ex="Arcade.SeeAllGames.Button.Title",tx="buy",nx="custom",rx="breakoutCallToActionLabel",ox="target",ix="mixedMediaLockup",sx="personalizationTransparency",ax="editorial-elements",cx="alternate-apps",lx="related-editorial-items",ux="privacy",dx="accessibility",fx="medicalDeviceInfo",hx="supportedGameCenterFeatures",px="privacyDetails",wx="round",vx="roundedRectPrerendered",gx="appleWatch_2022",mx="appleWatch_2024",yx="textColor2",Ax="heic",Tx="shortEditorialNotes",bx="largeHeroBreakout",Sx="mediaPageHeader",Px="editorialNotes.callToAction",Cx="ThreeUp",Ix="largeImageLockup",kx="personalizationData",Ox="systemimage://magnifyingglass",Ex="categoryBrick",Dx="Lockup.Footer.GamesApp",Rx="searchLandingTrendingSection",_x="doNotFilter",Lx="onDevicePersonalizationUseCase",Mx="customDeepLink",Fx="targetType",$x="tag",xx="iAdImpressionId",Nx="hints",Bx="pageContext",Ux="refApp",Gx="hint",jx="impressionId",Vx="NOAD",Hx="ad_container",qx="extRefApp2",Wx="extRefUrl2",zx="iAdSlotId",Yx="offerType",Jx="searchPrefix",Kx="ARCADE_PREORDER_LOCKUP_COMING_SOON",Zx="{price}",Qx="checkmark",Xx="trial",eN="miniTodayCard",tN="intermediateDetailPage",nN="{developerName}",rN="identifier",oN="ProductPage.ReviewSummary.Body.Title",iN="languages",sN="controller",aN="select",cN="productReviewsHeader",lN="LICENSE_AGREEMENT",uN="R8802",dN="genreShortDisplayName",fN="multirooms",hN="textLabel",pN="FullWidth",wN="work",vN="develop",gN="app-distribution",mN="ArcadeData",yN="SearchData",AN="attributes",TN="many",bN="developer-other-apps",SN="boolean",PN="textLinksShelf",CN="arcadeComingSoon",IN="false",kN="message",ON="four-screenshots",EN="appstore",DN="purchased",RN="redeem",_N="code",LN="gift",MN="meta.contingentItemOffer",FN="minimumWatchOSVersion",$N="price",xN="dynamicUI",NN="purchaseHistory",BN="push",UN="search-results",GN="search-landing",jN="topic",VN="supportsStreamlinedBuy",HN="additionalTerms",qN="secondaryText",WN="toggle",zN="appTrailerLockup",YN="privacyPolicyUrl",JN="charts",KN="types",ZN="ipod",QN="inAppPurchaseLockup",XN="pill",eB="unadorned",tB="multiplayer-activities",nB="splashVideo16x9",rB="splashVideo3x4",oB="screenshotsLockup",iB="EditorialLockupLargeVariant",sB="EditorialLockupMediumVariant",aB="Action.LearnMore",cB="mac-os-compatible-ios-apps",lB="system-apps",uB="xros-apps",dB="prefersOverlayedPageHeader",fB="largeBreakout",hB="canvas",pB="canonicalId",wB="layoutDirection",vB="AllGames",gB="placeholder",mB="rowCount",yB="mediumStoryCard",AB="mso",TB="com.apple.games",bB="links",SB="genres",PB="named",CB="cardDisplayStyle",IB="actionUrl",kB="impressionQueue",OB="eventVersion",EB="advertRotation",DB="impressionType",RB="softwareType",_B="landing",LB="PREORDER_NOTIFY_MESSAGE",MB="NOT_COMPATIBLE_BANNER_TEMPLATE",FB="{linkTitle}",$B="systemimage://gamecontroller.fill",xB="rooms",NB="iads",BB="targetPlatform",UB="searchResult",GB="play",jB="systemSmall",VB="navigation",HB="few",qB="appEvent",WB="new",zB="appIcon",YB="GET",JB="externalUrl",KB="categories",ZB="ages",QB="share",XB="presentModal",eU="minPlayers",tU="maxPlayers",nU="customScreenshotsByTypeForAd",rU="productVideo",oU="EventDetails",iU="textColor4",sU="toast",aU="roundedRect",cU="singleSelection",lU="arcadeDownloadPackCategories",uU="pageMetrics",dU="sellerInfo",fU="accessibilityDetails",hU="largeLockup",pU="ipadPro",wU="ipad_10_5",vU="enrichedEditorialNotes",gU="EditorialLockupLarge",mU="EditorialLockupMedium",yU="isGameCenterEnabled",AU="imessage-apps",TU="lockupSmall",bU="editorial-shelves-collection:contents",SU="posterLockup",PU="editorial-elements:contents",CU="offerItems",IU="largeStoryCard",kU="suggested",OU="arcadeApp",EU="ARCADE_ACTION_TITLE_EXPLORE",DU="EXPLORE",RU="extRefUrl",_U="refUrl",LU="iAdContainerId",MU="trending",FU="size",$U="BADGE_MFI_SUPPORTED",xU="allProductReviewActions",NU="arcadeProductPageInlineMessage",BU="productPageInlineMessage",UU="spacer",GU="rank",jU="Search Results",VU="coercedValue",HU="appletv",qU="arcadeTabHeader",WU="always",zU="menuItem",YU="back",JU="LearnMore",KU="badge",ZU="branch",QU="salables",XU="releaseDate",eG="comingSoonGrouping",tG="isCanvasAvailable",nG="versionHistory",rG="width",oG="ipadPro_2018",iG="ipad_11",sG="expectedReleaseDate",aG="watch-apps",cG="atv-apps",lG="editorial-shelves-header",uG="primary-contents",dG="badge-content",fG="Horizontal",hG="lightOverArtwork",pG="editorial_id",wG="meta.personalizationData.appId",vG="todayBrick",gG="undefined",mG="subscribed",yG="pageFields",AG="pageUrl",TG="contentRating",bG="hostApp",SG="pageDetails",PG="{title}",CG="NOT_COMPATIBLE_BANNER_LINK_TITLE",IG="compatibilityAnnotation",kG="ppid",OG="relationship",EG="tapToRateProductReviewAction",DG="writeAReviewProductReviewAction",RG="notPurchasedRatingsAndReviews",_G="purchasedRatingsAndReviews",LG="userRating",MG="Any",FG="apps.apple.com",$G="apps-and-games",xG="eula",NG="host",BG="inAppPurchase",UG="hero",GG="disabled",jG="story",VG="NO_BADGE",HG="isFirstPartyHideableApp",qG="iap",WG="internal",zG="APPLOCKUP",YG="productArtwork",JG="location",KG="recurringSubscriptionPeriod",ZG="numOfPeriods",QG="@@count@@",XG="arcadeSeeAllGames",ej="upsellBreakout",tj="topCharts",nj="height",rj="POST",oj="mac-apps",ij="ios-apps",sj="brick",aj="showExpectedReleaseDate",cj="editorialNotes.badge",lj="editorialCopy",uj="href",dj="editorialBadgeInfo",fj="click",hj="iAdPlacementId",pj="iAdId",wj="SearchLanding",vj="userProductReviews",gj="discover",mj="customers-also-bought-apps",yj="bundleParents",Aj="textCards",Tj="isStandaloneForWatchOS",bj="chartHref",Sj="description.standard",Pj="annotation",Cj="iad",Ij="actionType",kj="Games",Oj="contexts",Ej="clear",Dj="previewFrame",Rj="debug",_j="supportsArcade",Lj="one",Mj="mediumImageLockup",Fj="listItem",$j="tvOS",xj="pageId",Nj="actionDetails",Bj="{osVersion}",Uj="editorsChoiceProductReviews",Gj="bundleChildren",jj="term",Vj="tvos",Hj="tabs",qj="number",Wj="dismiss",zj="priceFormatted",Yj="offerName",Jj="bgColor",Kj="deviceFamilies",Zj="Hero",Qj="prefersLargeTitle",Xj="editorialClientParams",eV="heroCarousel",tV="facet",nV="query",rV="iAdTemplateType",oV="create",iV="detailPage",sV="rating",aV="Achievements",cV="notPurchasedLinks",lV="generic",uV="editorialItem",dV="brandedSingleApp",fV="finance",hV="remoteControllerRequirement",pV="buyParams",wV="transparent",vV="upsellMarketingItem",gV="metrics",mV="videoPreviewsByType",yV="{learnMoreLink}",AV="colored",TV="tagline",bV="offers",SV="editorial-item-groups",PV="allProductReviews",CV="renderPage",IV="cancel",kV="inAppPurchases",OV="paragraph",EV="todayCard",DV="protocol",RV="data",_V="latest-release-app",LV="tile",MV="trailing",FV="category",$V="presentModalFormSheet",xV="editorialElementKind",NV="screenshotsByType",BV="grouping",UV="eventType",GV="pageType",jV="reviewSummary",VV="subscriptions",HV="SearchResults",qV="short",WV="appletvos",zV="flowPreview",YV="editorial-cards",JV="token",KV="genreDisplayName",ZV="linkableText",QV="image",XV="other",eH="purchasedLinks",tH="iOS",nH="editorialNotes",rH="developers",oH="editorialNotes.name",iH="editorialNotes.tagline",sH="its_contentId",aH="pathname",cH="meta",lH="view",uH="No page routes specified",dH="searchLanding",fH="contingent-items",hH="text/x-apple-as3-nqml",pH="marketing-items",wH="color",vH="object",gH="expectedReleaseDateDisplayFormat",mH="smallStoryCard",yH="completed",AH="card",TH="productReviewsFooter",bH="web",SH="groupings",PH="rgb",CH="tags",IH="type",kH="gameCenter",OH="Search",EH="adamId",DH="medium",RH="collections",_H="Software",LH="collection",MH="fractionalHeight",FH="text/plain",$H="offer-items",xH="challenges",NH="achievement",BH="editorialQuote",UH="mostRecentVersion",GH="platform",jH="sort",VH="arcade-apps",HH="preorder",qH="open",WH="text",zH="realityDevice",YH="productPage",JH="preorderDisclaimer",KH="macOS",ZH="xros",QH="children",XH="isAppleWatchSupported",eq="artistName",tq="requiredCapabilities",nq="ACTION_SEE_ALL",rq="osx",oq="recommendations",iq="absolute",sq="grid",aq="featuredIn",cq="productPageYMALDuringDownload",lq="multiplayer",uq="impressions",dq="overlay",fq="product",hq="never",pq="account",wq="compatibilityControllerRequirement",vq="primary-content",gq="ignoredValue",mq="genre",yq="minimumOSVersion",Aq="displayStyle",Tq="iconArtwork",bq="macRequiredCapabilities",Sq="card-contents",Pq="subtitle",Cq="defaultValue",Iq="editorsChoice",kq="accessibilityDeveloperLink",Oq="accessibilityHeader",Eq="developer",Dq="kind",Rq="coercible",_q="infer",Lq="accessibilityFeatures",Mq="moreByDeveloper",Fq="privacyFooter",$q="videos",xq="hasMacIpaPackage",Nq="leaderboards",Bq="small",Uq="appEvents",Gq="label",jq="in-apps",Vq="productPageYMAL",Hq="searchTerm",qq="games",Wq="editorial-pages",zq="productRatings",Yq="informationRibbon",Jq="privacyTypes",Kq="mediumLockup",Zq="Room",Qq="similarItems",Xq="video",eW="messages",tW="privacyHeader",nW="searchResults",rW="swoosh",oW="capabilities",iW="light",sW="chart",aW="action",cW="true",lW="white",uW="isPreorder",dW="Arcade",fW="friendsPlaying",hW="bundleId",pW="sequential",wW="none",vW="article",gW="search",mW="smallLockup",yW="its_id",AW="ios",TW="editorialVideo",bW="ageRating",SW="description",PW="large",CW="center",IW="ipad",kW="default",OW="iphone",EW="link",DW="information",RW="editorialArtwork",_W="reviews",LW="topLockup",MW="dark",FW="title",$W="string",xW="header",NW="achievements",BW="url",UW="today",GW="unknown",jW="screenshots",VW="app",HW="pad",qW="sheetPresent",WW="inline",zW="vision",YW="editorial-items",JW="app-bundles",KW="lockup",ZW="phone",QW="leading",XW="artwork",ez="static",tz="app-events",nz="arcade",rz="standard",oz="watch",iz="mac",sz="contents",az="apps",cz="name",lz="button",uz="stackPush",dz="navigate",fz="page",hz="$kind",pz="shelf"
gm=e(8706),mm=e(5542),ym=e(4172),Am=e(2450)
const wz={}
class vz{static createSharedMetricsReferralContext(e){vz.shared||(vz.shared=new vz(e))}constructor(e){this.currentReferral=null,this.isMetricsReferralContextRequired=!0,this.isEventDetailClickEventOverrideNecessary=!e.host.isOSAtLeast(16,2,0)}get shouldUseJSReferralData(){return this.isMetricsReferralContextRequired&&i(this.currentReferral)}get activeReferralData(){return this.shouldUseJSReferralData?(0,mm.isNothing)(this.currentReferral)||!this.currentReferral.isActive?null:this.currentReferral.data:null}setReferralDataForProduct(e,t){var n,o,i
if(!this.isMetricsReferralContextRequired||r(t))return
const s=null!==(n=f(t,VW))&&void 0!==n?n:null,a=null!==(o=f(t,JB))&&void 0!==o?o:null,c=null!==(i=v(t,Dq))&&void 0!==i?i:null
this.currentReferral={id:`${e}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,kind:c,refUrl:null},isActive:!1,productPageExtensionInfo:null}}setReferralDataForProductPageExtensionIfNecessary(e){var t,o
if(!this.isMetricsReferralContextRequired)return
const i=f(e,xj),s=f(e,Ux)
if(!gz.isProductPageExtension(e)||!gz.isValidPageEvent(e)||r(i)||r(s))return
const a=null!==(t=f(e,RU))&&void 0!==t?t:null,c=f(e,iR)
let l
switch(c){case VS:l=y(n(e,HS))
break
case sR:l=y(n(e,qS))
break
default:l={}}const u=null!==(o=f(e,_U))&&void 0!==o?o:null
this.currentReferral={id:`${i}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,refUrl:u,kind:{name:c,context:l}},isActive:!1,productPageExtensionInfo:{productId:i}},this.addReferralContextToMetricsFieldsIfNecessary(e)}beginReferralContextForPageIfNecessary(e){this.isMetricsReferralContextRequired&&gz.isValidPageEvent(e)&&gz.isReferralForEvent(this.currentReferral,e)&&(0,mm.isSome)(this.currentReferral)&&(this.currentReferral.isActive=!0)}endReferralContextIfNecessaryForPageEvent(e){this.isMetricsReferralContextRequired&&gz.isValidPageEvent(e)&&gz.isReferralForEvent(this.currentReferral,e)&&(this.currentReferral=null)}addReferralContextToMetricsFieldsIfNecessary(e){var t
this.isMetricsReferralContextRequired&&(e[vz.referralContextEventField]=null===(t=this.currentReferral)||void 0===t?void 0:t.id)}removeReferralContextInfoFromMetricsEvent(e){this.isMetricsReferralContextRequired&&delete e[vz.referralContextEventField]}addReferralDataToEventIfNecessary(e){var t
if(!r(this.activeReferralData)&&gz.shouldAddReferralDataToEvent(e)&&(!gz.isEventDetailsClickEvent(e)||this.isEventDetailClickEventOverrideNecessary)&&(gz.isEventDetailsClickEvent(e)&&(e[GV]=oU),e[Ux]=this.activeReferralData.extRefApp2,e[RU]=this.activeReferralData.extRefUrl2,s(this.activeReferralData.refUrl)&&(e[_U]=this.activeReferralData.refUrl),(0,mm.isSome)(null===(t=this.activeReferralData)||void 0===t?void 0:t.kind)))switch(e[iR]=this.activeReferralData.kind.name,e[iR]){case VS:e[HS]=this.activeReferralData.kind.context
break
case sR:e[qS]=this.activeReferralData.kind.context}}}vz.referralContextEventField="referralContextId"
class gz{static isProductPageExtension(e){return f(e,VW)===gz.productPageExtensionAppId}static isValidPageEvent(e){const t=f(e,GV)
return!(0,mm.isNothing)(t)&&gz.validPageEventTypes.has(t)}static isReferralForEvent(e,t){var n
if(r(e))return!1
const o=t[vz.referralContextEventField],s=f(t,xj)
return i(o)?o===e.id:!(!gz.isProductPageExtension(t)||!i(s))&&s===(null===(n=null==e?void 0:e.productPageExtensionInfo)||void 0===n?void 0:n.productId)}static shouldAddReferralDataToEvent(e){return e.eventType!==fj||this.isEventDetailsClickEvent(e)}static isEventDetailsClickEvent(e){if(e.eventType!==fj)return!1
const t=e.location,n=null==t?void 0:t[0]
return i(n)&&n.locationType===oU}}gz.productPageExtensionAppId=Ny,gz.eventDetailsPageType=oU,gz.validPageEventTypes=new Set([_H,RF,gz.eventDetailsPageType]),Tm=e(900)
class mz{constructor(e){this.$kind="ActionMetrics",this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}const yz={AdInteractionAction:"AdInteractionAction",AdTransparencyAction:"AdTransparencyAction",AlertAction:"AlertAction",AppLaunchTrampolineAction:"AppLaunchTrampolineAction",ArcadeAction:sA,ArcadeLaunchAttributionAction:"ArcadeLaunchAttributionAction",ArcadePackOfferAction:"ArcadePackOfferAction",ArcadeSeeAllGamesPageSegmentChangeAction:"ArcadeSeeAllGamesPageSegmentChangeAction",ArcadeSubscriptionStateAction:"ArcadeSubscriptionStateAction",BlankAction:"BlankAction",CancelPreorderAction:"CancelPreorderAction",ClearAppUsageDataAction:"ClearAppUsageDataAction",ClearSearchHistoryAction:"ClearSearchHistoryAction",CompoundAction:aA,CopyTextAction:"CopyTextAction",CreateCalendarEventAction:"CreateCalendarEventAction",CrossfireReferralAction:"CrossfireReferralAction",EngagementToggleAction:"EngagementToggleAction",ExternalUrlAction:cA,FamilyCircleAction:"FamilyCircleAction",FlowAction:WL,FlowBackAction:"FlowBackAction",GameCenterAchievementsAction:"GameCenterAchievementsAction",GameCenterDashboardAction:"GameCenterDashboardAction",GameCenterDenylistPlayerAction:"GameCenterDenylistPlayerAction",GameCenterInvitePlayerAction:"GameCenterInvitePlayerAction",GameCenterPlayerProfileAction:"GameCenterPlayerProfileAction",GSKWrappedAction:"GSKWrappedAction",GuidedSearchTokenToggleAction:"GuidedSearchTokenToggleAction",HttpAction:"HttpAction",HttpTemplateAction:"HttpTemplateAction",InAppPurchaseAction:"InAppPurchaseAction",InvalidateAllWidgetsAction:"InvalidateAllWidgetsAction",LegacyGameCenterInvitePlayerAction:"LegacyGameCenterInvitePlayerAction",OfferAction:lA,OfferAlertAction:uA,OfferConfirmationAction:dA,OfferStateAction:BO,OpenAppAction:"OpenAppAction",OpenGamesUIAction:"OpenGamesUIAction",PageFacetsChangeAction:"PageFacetsChangeAction",PageTabChangeAction:"PageTabChangeAction",ProductPageScrollAction:fA,RateLimitedAction:"RateLimitedAction",ReportConcernAction:"ReportConcernAction",ReviewSummaryReportConcernAction:"ReviewSummaryReportConcernAction",ScrollingAlertAction:"ScrollingAlertAction",SearchAction:"SearchAction",SearchAdAction:hA,SearchEntityChangeAction:"SearchEntityChangeAction",SearchSegmentChangeAction:"SearchSegmentChangeAction",SelectAppAction:"SelectAppAction",ShareSheetAction:"ShareSheetAction",SheetAction:"SheetAction",ShelfBasedPageScrollAction:pA,ShowSettingsAction:"ShowSettingsAction",TabBadgeAction:"TabBadgeAction",TabChangeAction:UO,WriteReviewAction:"WriteReviewAction"},{FlowAction:Az,...Tz}=yz,bz={...Tz,flowAction:wA}
class Sz{constructor(){this.title=void 0,this.artwork=void 0,this.presentationStyle=[],this.actionMetrics=new mz}}class Pz extends Sz{constructor(){super(...arguments),this.$kind="BlankAction",this.actionClass="BlankAction"}}const Cz="x-as3-internal",Iz=PL,kz="itms-appss",Oz="itms-apps",Ez=$y,Dz=xy,Rz="appstore-ui",_z={shelf:pz,store:"WebObjects/MZStore.woa/wa",storeElements:"WebObjects/MZStoreElements.woa/wa",lookup:xk,docTypeLookup:"docTypeLookup",install:e$,grouping:"viewGrouping",viewArtist:"viewArtist",viewSoftware:"viewSoftware",today:UW,arcade:nz,arcadeUpsellPreview:"arcadeUpsellPreview",arcadeSeeAllGames:XG,arcadeSeeAllGamesLoadMore:"arcadeSeeAllGamesLoadMore",genre:mq,viewGenre:QL,recommendationsSeeAll:"recommendationsSeeAll",screenshots:jW,room:"viewRoom",multiRoom:"viewMultiRoom",charts:JN,product:VW,game:"game",siri:lD,productBundle:Nk,developer:Eq,artist:mP,ratings:RL,reviews:_W,viewReviews:"viewContentsUserReviews",personalizedReviews:"personalizedReviews",article:vW,story:jG,editorialItem:uV,viewEditorialItem:DT,todayCardPreview:"todayCardPreview",mso:AB,resetAndRedirect:"resetAndRedirect",account:pq,personalizationTransparency:sx,href:uj,eula:xG,tvEula:"tv-eula",privacyPolicy:qP,safetyCompliance:"safety-compliance",appsForYou:"apps-for-you",storeFront:"storeFront",tab:"tab",searchLandingPage:"searchLandingPage",searchTrendingApps:"searchTrendingApps",privacyDetail:zR,privacyDefinitions:zP,reportAProblem:"reportaproblem.apple.com/store",gameCenterProfile:Lk,onDeviceRecommendations:"onDeviceRecommendations",editorialPage:"editorialPage",accessibilityDetails:fU,test:kP,shelfTypes:"shelfTypes",groupingTest:BV,builtIn:"builtIn",shelfTextTest:"shelfText",shelfLockupsTest:"shelfLockups",shelfMiscTest:"shelfMisc",lockupTest:"lockupTest",articleTestArtwork:"articleArtworkTest",articleTestSingleAppIcon:"articleSingleAppIconTest",articleTestSingleAppIconHeroArt:"articleSingleAppIconHeroArtTest",articleTestBrandedApp:"articleBrandedAppTest",articleTestMultiAppTwo:"articleMultiAppTwoTest",articleTestMultiAppThree:"articleMultiAppThreeTest",articleTestGrid:"articleGridTest",articleTestInAppPurchase:"articleInAppPurchaseTest"},Lz="storepreview.apple.com",Mz=fq,Fz=yk,$z=XG,xz="familyCircle",Nz="spamBlockingExtensions",Bz=Cb,Uz="launchApp",Gz="sharePlayApps",jz="buddyOnboarding",Vz=new Set([Lz,"preview.apps.apple.com"]),Hz={id:"id",ids:"ids",productVariantID:kG,countryCode:"cc",language:"l",featuredContentId:"fcId",fetchData:"fetchData",isTodaySection:"isTodaySection",isTodayFeedPreview:"isTodayFeedPreview",genre:mq,bundleIdentifier:"bundleIdentifier",bundleId:hW,offerName:Yj,charts:JN,ages:ZB,chart:sW,types:KN,v0:"v0",action:aW,type:IH,context:uR,isArcade:BD,isSubscribed:"isSubscribed",isTrialAvailable:"isTrialAvailable",isTrialEnrolled:"isTrialEnrolled",groupingFeaturedContentId:"groupingFeaturedContentId",editorialPageShelfType:"editorialPageShelfType",nativeGroupingShelfId:"nativeGroupingShelfId",isArcadeSeeAllGamesShelf:"isArcadeSeeAllGamesShelf",isGameCenterActivityFeedShelf:"isGameCenterActivityFeedShelf",isGameCenterPlayerShelf:"isGameCenterPlayerShelf",isGameCenterPlayerRibbonItem:"isGameCenterPlayerRibbonItem",isGameCenterAchievementsShelf:"isGameCenterAchievementsShelf",isGameCenterContinuePlayingShelf:"isGameCenterContinuePlayingShelf",isGameCenterPopularWithYourFriendsShelf:"isGameCenterPopularWithYourFriendsShelf",isGameCenterSuggestedFriendsShelf:"isGameCenterSuggestedFriendsShelf",isGameCenterReengagementShelf:"isGameCenterReengagementShelf",isOnDeviceRecommendationsShelf:"isOnDeviceRecommendationsShelf",isOnDeviceSearchHistoryShelf:"isOnDeviceSearchHistoryShelf",isSearchFocusHeaderShelf:"isSearchFocusHeaderShelf",isArcadeDownloadPackShelfPlaceholder:"isArcadeDownloadPackShelfPlaceholder",onDeviceRecommendationsUseCase:"onDeviceRecommendationsUseCase",onDevicePersonalizationUseCase:Lx,isPurchasesApp:"isPurchasesApp",isViewOnly:kE,includeUnlistedApps:"includeUnlistedApps",enabled:lb,href:uj,recoMetrics:"recoMetrics",showingFallbackMedia:"showingFallbackMedia",path:"path",useReleaseId:"useReleaseId",clientIdentifierOverride:FS,subscribePageMessage:kN,editorialItem:uV,askToBuyId:"askToBuyId",appId:"appId",isPPT:"isPPT",sort:jH,grouping:BV,code:_N,includePostSubscribeAttribution:"includePostSubscribeAttribution",campaignToken:"ct",providerToken:"pt",qToken:Kk,advertisementId:Zk,token:JV,parseContext:"parseContext",privacyTypeId:"privacyTypeId",requestDescriptor:"requestDescriptor",ageRating:bW,controllerSupport:gE,multiplayerSupport:"multiplayerSupport",comingSoon:pM,binCompatGames:"binCompatGames",gamePreviews:"gamePreviews",offerHints:"offerHints",invalidateWidgetsOnFailure:yT,metrics:gV,appEventId:"eventid",offerItemId:"offerItemId",appEventDeepLink:sM,useCaseShort:"uc",collectionId:"collection-id",seedId:"seed-id",isShelfWithAd:"isShelfWithAd",shelfWithAdPlacementType:"shelfWithAdPlacementType",shelfRefreshType:"refreshType",isPreloading:"isPreloading",name:cz,shelfType:"shelfType",shelfId:"shelfId",onbaordingCardIds:"onboardingCardIds",preview:RT,todayCardConfig:"todayCardConfig",experimentId:JR,shortEditorialNotes:Tx,arcadeSubscriptionStatus:"subscriptionStatus",webBrowser:XF,webBrowserFlowType:PC,editorialPageId:"editorialPageId",editorialCardId:"filter[canvas:cardId]",filterRecommendable:"filter[recommendable]",deviceFamily:JC},qz="inAppPurchaseId",Wz="productUrl",zz=mF,Yz="minExternalVersionId",Jz=EH,Kz=jH,Zz="availableAdamIds",Qz=VW,Xz=_W,eY="productPageSimilarItems",tY=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,nY=/([^=?&]+)=?([^&]*)/g,rY=[k$,nV,aH,NG]
class oY{constructor(e){if(this.query={},!e)return
let t=e
const n=tY.exec(e)
if(n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:void 0}
for(const e of rY){if(!r.remainder)break
switch(e){case k$:r=b(r.remainder,"#",_L),this.hash=r.result
break
case nV:r=b(r.remainder,"?",_L),r.result&&(this.query=oY.queryFromString(r.result))
break
case aH:r=b(r.remainder,"/",_L),r.result&&(this.pathname="/"+r.result)
break
case NG:if(r.remainder){const e=b(r.remainder,"@",Qk),t=e.result,n=e.remainder
if(t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this
switch(e===nV&&typeof t===$W&&(t=oY.queryFromString(t)),e){case DV:this.protocol=t
break
case Xk:this.username=t
break
case eO:this.password=t
break
case tO:this.port=t
break
case aH:this.pathname=t
break
case nV:this.query=t
break
case k$:this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case DV:return this.protocol
case Xk:return this.username
case eO:return this.password
case tO:return this.port
case aH:return this.pathname
case nV:return this.query
case k$:return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if(e===nV)typeof t===$W&&(t=oY.queryFromString(t)),r=typeof n===$W?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if(e===aH){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(aH,e)}pathExtension(){var e
if((0,Am.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}popPathComponent(){if(!this.pathname)return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),this.query&&Object.keys(this.query).length&&(e+="?"+oY.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=nY.exec(e)
for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=nY.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new oY(e)}static fromComponents(e,t,n,r,o){const i=new oY
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}const iY=[Iz,Oz,kz,"itms-messages","itms-messagess","itms-watch","itms-watchs","macappstore","macappstores","com.apple.tvappstore",Ez,Dz]
class sY{constructor(e){var t
this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={}
return e.forEach((e,n)=>{I(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[]
if(!e)return t
for(const n of e){const e=n.split("=")
let r=e[0]
const o=-1!==r.indexOf("?")
r=r.replace("?","")
const i=-1!==r.indexOf(nO)
r=r.replace(nO,"")
let s=null
e.length>1&&(s=decodeURIComponent(e[1])),t.push({key:r,value:s,optional:o,caseInsensitive:i})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map(function(e){return new sY(e)}):this._exclusions=null}matches(e){var t,n
if(this._regex){if(!this._regex.length)return!1
let t=!1
for(const n of this._regex)if(n.test(e.toString())){t=!0
break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1
if(this._hostName&&e.host!==this._hostName)return!1
if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents()
if(t.length!==n.length)return!1
const r=t.length
for(let e=0;e<r;e++){const r=t[e]
if(!I(r)&&r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1
if(this._query)for(const r of this._query){let o
if(r.caseInsensitive)for(const[n,i]of Object.entries(null!==(t=e.query)&&void 0!==t?t:{}))r.key.toLocaleLowerCase()===n.toLocaleLowerCase()&&(o=i)
else o=null===(n=e.query)||void 0===n?void 0:n[r.key]
if(!o&&!r.optional)return!1
if(r.value&&r.value!==o)return!1}if(this._hash&&e.hash!==this._hash)return!1
if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?")
if(t.matches(e))return!1}return!0}extractParameters(e){var t,n
const r={}
if((0,Am.isSome)(this._pathComponents)&&(0,Am.isSome)(this._pathParameterMap)){const t=e.pathComponents()
for(const e of Object.keys(this._pathParameterMap)){const n=k(e),o=O(t[this._pathParameterMap[e]],e)
r[n]=decodeURIComponent(o)}}if(this._query)for(const o of this._query)r[o.key]=null!==(n=null===(t=e.query)||void 0===t?void 0:t[o.key])&&void 0!==n?n:void 0
return r}}class aY{constructor(){this._routeMappings=[]}associate(e,t){const n=[]
for(const t of e)n.push(new sY(t))
this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===$W?new oY(e):e
t=function(e){let t=typeof e===$W?new oY(e):e
if(!C(t))return t
const n=t.query,r=null==n?void 0:n[BW]
return(!t.host||0===t.host.length)&&null!=r&&(t=new oY(r),(null==n?void 0:n[DR])&&(t=t.append(nV,{dsid:n[DR]})),(null==n?void 0:n[rO])&&(t=t.append(nV,{signatureResumption:n[rO]}))),oY.fromComponents(Iz,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){var t,n,r,o
const i=typeof e===$W?new oY(e):e
if(!C(i))return i
const s=i.build()
let a,c=(0,Am.isNothing)(i.query)?void 0:S(i.query)
const l={},u=[{key:"MZSearch.woa",action:gW},{key:gW,action:gW},{key:"buyLandingPage",action:LN},{key:"buyCharityGiftWizard",action:AA},{key:"longUrlHandler",action:oO},{key:KL,action:KL}],d={"accessory-lookup":"accessoryLookup","finance-app":pq,viewEula:xG,software:az,primaryTerm:gW}
let f=!1
for(const e of Object.keys(l))if(i.host&&-1!==i.host.indexOf(e)){f=!0,a=l[e]
break}let h=!1
for(const e of u){const t=e.key
if(i.pathname&&-1!==i.pathComponents().indexOf(t)){h=!0,a=e.action,void 0!==(null==c?void 0:c[t])&&delete c[t]
break}}for(const e of Object.keys(d)){const r=void 0!==(null===(t=i.query)||void 0===t?void 0:t[e])&&null!==i.query[e],o=(null===(n=i.query)||void 0===n?void 0:n[aW])&&-1!==i.query[aW].indexOf(e)
if(r||o){a=d[e],void 0!==(null==c?void 0:c[e])&&delete c[e]
break}}if(a===pq&&-1!==s.indexOf(iO)&&(a="addToPassbook",void 0!==c&&delete c[iO]),a){const e=null,t=null,n={action:a}
if(a===RN&&(0,Am.isSome)(c)){const e=null!==(r=c[_N])&&void 0!==r?r:c.certId
e&&(n[_N]=e)}else a!==pq&&a!==KL&&a!==oO||!h&&!f||(n[YL]=i.toString())
const s=null===(o=i.query)||void 0===o?void 0:o[VO]
return a===gW&&(0,Am.isSome)(s)&&(0,Am.isSome)(c)&&(c[VO]=s),c={...c,...n},oY.fromComponents(i.protocol,t,e,c,i.hash)}return i}(t)
for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier}
return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}const cY=Symbol("PromiseResult")
class lY extends Error{constructor(e){super(function(e){return e.map(e=>e instanceof Error?e.message:JSON.stringify(e)).join("")}(e)),this.reasons=e,this.reasons=e}}class uY extends Error{constructor(e){super(e.message),this.reason=e,this.reason=e}}bm=e(4876)
class dY{constructor(e,t,n,r,o,i){this.$kind="Artwork",this.checksum=void 0,this.backgroundColor=null,this.textColor=null,this.style=null,this.crop="bb",this.cropAspectRatio=void 0,this.contentMode=null,this.imageScale=null,this.template=e,this.width=t,this.height=n,this.variants=r,this.backgroundColor=o,this.textColor=i}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return""!==this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class fY{constructor(e){this.$kind="ImpressionableArtwork",this.art=e}}!function(e){e.Density1="density_1",e.Density2="density_2",e.Density3="density_3"}(Sm||(Sm={})),function(e){e[e.scaleToFill=0]="scaleToFill",e[e.scaleAspectFit=1]="scaleAspectFit",e[e.scaleAspectFill=2]="scaleAspectFill",e[e.redraw=3]="redraw",e[e.center=4]="center",e[e.top=5]="top",e[e.bottom=6]="bottom",e[e.left=7]="left",e[e.right=8]="right",e[e.topLeft=9]="topLeft",e[e.topRight=10]="topRight",e[e.bottomLeft=11]="bottomLeft",e[e.bottomRight=12]="bottomRight"}(Pm||(Pm={}))
class hY{constructor(e,t,n,r,o,i,s){this.$kind="MediaPlatform",this.appPlatform=e,this.supplementaryAppPlatforms=r||[],this.deviceCornerRadiusFactor=o,this.mediaType=t,this.systemImageName=n,this.deviceBorderThickness=i,this.outerDeviceCornerRadiusFactor=s}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort()
const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",")
return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&e.systemImageName===this.systemImageName&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class pY{constructor(e,t){this.$kind="Trailers",e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0}}class wY{constructor(e,t,n){this.$kind="Video",this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class vY{constructor(){this.$kind="ProductMediaItem"}}class gY{constructor(e,t,n,r,o,i){this.$kind="ProductMedia",this.items=e,this.mediaPlatform=t,this.allPlatforms=n,this.platformDescription=r,this.allPlatformsDescription=o,this.allPlatformsDescriptionPlacement=i}}class mY{constructor(e,t){this.$kind="Screenshots",this.artwork=e,this.mediaPlatform=t}}class yY{constructor(e,t,n,r){this.fileSizeByDevice=e,this.maxDownloadSizeInBytes=t,this.maxInstallSizeInBytes=n,this.maxEssentialInstallSizeInBytes=r}}class AY{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new AY(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}const TY=$L,bY="com.apple.AppStore.BridgeStoreExtension",SY=Fy,PY=$y,CY=xy,IY="com.apple.TVAppStore.AppStoreTopShelfExtension",kY="com.apple.Arcade.ArcadeTopShelfExtension",OY=Ny,EY=By,DY="com.apple.AppStore.Widgets",RY=SO,_Y="VisionAppStore",LY=(0,Tm.makeMetatype)("app-store:storeMetrics"),MY=(0,Tm.makeMetatype)("app-store:amsEngagement"),FY=(0,Tm.makeMetatype)("app-store:device"),$Y=(0,Tm.makeMetatype)("app-store:user"),xY=(0,Tm.makeMetatype)("games:player"),NY=(0,Tm.makeMetatype)("app-store:metricsIdentifiers"),BY=(0,Tm.makeMetatype)("app-store:arcade"),UY=(0,Tm.makeMetatype)("app-store:gameCenter"),GY=(0,Tm.makeMetatype)("app-store:resilientDeepLinks"),jY=(0,Tm.makeMetatype)("app-store:ads"),VY=(0,Tm.makeMetatype)("app-store:onDeviceRecommendationsManager"),HY=(0,Tm.makeMetatype)("app-store:onDeviceSearchHistoryManager"),qY=(0,Tm.makeMetatype)("app-store:mediaTokenService"),WY=(0,Tm.makeMetatype)("app-store:adsLocalizer"),zY=(0,Tm.makeMetatype)("app-store:appDistribution"),YY=(0,Tm.makeMetatype)("app-store:timeoutManager"),JY=(0,Tm.makeMetatype)("app-store:treatmentStore"),KY=(0,Tm.makeMetatype)("app-store:userDefaults"),ZY="_jet-internal:derived-data",QY={artwork:I$,iconArtwork:DL,screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:nU,customVideoPreviewsByTypeForAd:nD,customDeepLink:Mx}
class XY{constructor(e){this.implementation=e}}class eJ{constructor(){this.clearCache=()=>{this.cache={}},this.cache={}}get(e,t){return t()}}const tJ=TY,nJ=bY,rJ=SY,oJ=CY,iJ=PY,sJ=OY
class aJ extends XY{get buildType(){return aJ.cache.get("buildType",()=>this.implementation.buildType)}get buildVersion(){return this.implementation.buildVersion}get deviceType(){return aJ.cache.get("deviceType",()=>this.implementation.deviceType)}get guid(){return this.implementation.guid}get isActivityAvailable(){return this.implementation.isActivityAvailable}get isElectrocardiogramInstallationAllowed(){return this.implementation.isElectrocardiogramInstallationAllowed}get isScandiumInstallationAllowed(){return this.implementation.isScandiumInstallationAllowed}get isSidepackingEnabled(){return this.implementation.isSidepackingEnabled}get isTinkerWatch(){return aJ.cache.get("isTinkerWatch",()=>this.implementation.isTinkerWatch)}get screenCornerRadius(){return aJ.cache.get("screenCornerRadius",()=>this.implementation.screenCornerRadius)}get screenSize(){return aJ.cache.get("screenSize",()=>AY.fromNativeSize(this.implementation.screenSize))}get storefrontIdentifier(){return this.implementation.storefrontIdentifier}get supportsHEIF(){return aJ.cache.get("supportsHEIF",()=>this.implementation.supportsHEIF)}get thinnedApplicationVariantIdentifier(){return aJ.cache.get("thinnedApplicationVariantIdentifier",()=>this.implementation.thinnedApplicationVariantIdentifier)}get isMandrakeSupported(){return this.implementation.isMandrakeSupported}get isCharonSupported(){return this.implementation.isCharonSupported}get maxAppContentRating(){return this.implementation.maxAppContentRating}get hostBundleId(){return aJ.cache.get("hostBundleId",()=>this.implementation.hostBundleId)}isPairedSystemVersionAtLeast(e){var t,n,r
return null!==(r=null===(n=(t=this.implementation).isPairedSystemVersionAtLeast)||void 0===n?void 0:n.call(t,e))&&void 0!==r&&r}deletableSystemAppCanBeInstalledOnWatchWithBundleID(e){return this.implementation.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}deviceHasCapabilities(e){return this.implementation.deviceHasCapabilities(e)}deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t){return(!this.isPad||!e.includes("healthkit"))&&this.implementation.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t)}hasEligibilityDomain(e){return this.implementation.hasEligibilityDomain(e)}contextForEligibilityDomain(e){return this.implementation.contextForEligibilityDomain(e)}isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n){return this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}canDevicePerformAppActionWithAppCapabilities(e,t){return this.implementation.canDevicePerformAppActionWithAppCapabilities(e,t)}isAutomaticDownloadingEnabled(){return this.implementation.isAutomaticDownloadingEnabled()}isAuthorizedForUserNotifications(){return this.implementation.isAuthorizedForUserNotifications()}isActivePairedWatchSystemVersionBelow(e){const t=e.split("."),n=h(t[0])||0,r=h(t[1])||0,o=h(t[2])||0
return!this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(n,r,o)}get isPhone(){return this.deviceType===ZW}get isPad(){return this.deviceType===HW}get isiOS(){return this.isPhone||this.isPad}get isMac(){return this.deviceType===iz}get isTV(){return"tv"===this.deviceType}get isWatch(){return this.deviceType===oz}get isVision(){return this.deviceType===zW}get isWeb(){return this.deviceType===bH}get isCompanionVisionApp(){return this.hostBundleId===SO}get remoteDownloadIdentifiers(){return this.implementation.remoteDownloadIdentifiers}}aJ.type=(0,Tm.makeMetatype)("app-store:client-wrapper"),aJ.cache=new eJ
class cJ{constructor(e,t,n,r){var i
this.contentsResourceTypes=new Set,this.ids=new Set,this.idsByResourceType=new Map,this.originalOrdering=[],this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.supplementaryMetadataAssociations=[],this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.countryCodeOverride=void 0,this.objectGraph=e,this.platform=K(e),this.isMixedMediaRequest=null!=n&&n,this.supplementaryMetadataAssociations=null!=r?r:[],this.includeAppBinaryTraitsAttribute=!0,(null===(i=e.activeIntent)||void 0===i?void 0:i.platform)&&(this.platform=e.activeIntent.platform),o(t)||(typeof t===$W?this.href=t:Array.isArray(t)&&this.withDataItems(t,r,n))}addDataToIDsByResourceType(e){const t=e.type,n=e.id
let r=this.idsByResourceType.get(t);(0,Am.isNothing)(r)&&(r=new Set),r.add(n),this.idsByResourceType.set(t,r)}forType(e){return this.resourceType=e,this}withDataItems(e,t,n){if(0===e.length)return this
this.isMixedMediaRequest=this.isMixedMediaRequest||null!=n&&n
for(const r of e)if(this.ids.add(r.id),this.addDataToIDsByResourceType(r),(0,Am.isSome)(n)&&n&&(0,Am.isSome)(t)&&t.length>0)for(const e of t){const t=re(e,r);(0,Am.isSome)(t)&&t.length>0&&t.forEach(e=>{this.addDataToIDsByResourceType(e)})}return 1===this.idsByResourceType.size?(this.resourceType=this.idsByResourceType.keys().next().value,this.isMixedMediaRequest=!1):this.idsByResourceType.size>1&&!this.isMixedMediaRequest&&(this.resourceType=sz,this.contentsResourceTypes=new Set(Array.from(this.idsByResourceType.keys()))),this.originalOrdering.push(...e),this}withIdOfType(e,t){return this.withDataItems([{id:e,type:t}])}withIdsOfType(e,t){return this.withDataItems(e.map(e=>({id:e,type:t})))}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingViews(e){this.viewsIncludes||(this.viewsIncludes=new Set)
for(const t of e)this.viewsIncludes.add(t)
return this}includingKindsKeys(e,t){this.kindIncludes||(this.kindIncludes=new Map)
let n=this.kindIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.kindIncludes.set(e,n),this}includingAssociateKeys(e,t){this.associateIncludes||(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t=pH
if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get(YW)
e||(e=new Set),e.add(t),this.scopedRelationshipIncludes.set(YW,e)}else this.relationshipIncludes.add(t)
{this.metaIncludes||(this.metaIncludes=new Map)
let e=this.metaIncludes.get(pH)
e||(e=new Set),e.add(gV),this.metaIncludes.set(pH,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAgeRestrictions(){const e=this.objectGraph.client.maxAppContentRating
return e<1e3&&(this.ageRestriction=e),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){this.scopedAvailableInIncludes||(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return this.scopedSparseLimit||(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return(0,Am.isSome)(t)?this.additionalQuery[e]=t:delete this.additionalQuery[e],this}addingQueryValues(e){return this.additionalQuery={...this.addingQuery,...e},this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return this.objectGraph.appleSilicon.isSupportEnabled&&(e||this.enablingFeature(L_),this.includingScopedAttributes(az,[YD])),this}includingAppBinaryTraitsAttribute(e=!0){return this.includeAppBinaryTraitsAttribute=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return(0,Am.isSome)(e)&&(this.sparseLimit=e),this}withSparseCount(e){return(0,Am.isSome)(e)&&(this.sparseCount=e),this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!i(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}withCountryCodeOverride(e){return this.countryCodeOverride=e,this}}const lJ=(e,t)=>e||t,uJ=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])?"),dJ=Ae(0,0,0),fJ=Ae(1,1,1),hJ="FBEF7E28-E3DF-4484-A7D7-2FE19E43D2B8",pJ="21FD31A2-0631-4100-9942-D368B43F00C5",wJ="9C29E652-9774-4219-9BEB-9414597AD175",vJ="73B2D138-968D-4E55-A376-2B920FFD0EC0",gJ="4198D0D5-B34F-4EA5-B3C6-99C90C7732B8",mJ="0012B4EB-DC11-4739-BE08-04682AC5884C",yJ="DFA20668-513E-45DD-9085-001C0AD62B64",AJ="38B9604C-2D97-46E7-9AA0-7995A6A7DE00",TJ="C36F09B5-8A6B-4643-B635-64B81F09D34B",bJ="9E736351-D8D1-47DF-8EBD-5EC9C8758A83";(Oy=Cm||(Cm={})).ArcadeDownloadPackOnboarding="Tf5Kjqz",Oy.Arcade="HnW1xce",Oy.CondensedTodayAds="tBc9hUt",Oy.ProductPagePreloading="m0henFo",Oy.ProductPageVariants="fNPb5Km",Oy.ProductPageYMALRowCount="isj11bm",Oy.SearchLandingPage="WqjkRLH",Oy.SearchResultsAdBackground="Zh4zkDd"
class SJ{constructor(){this.cachedTreatments={},this.cachedRawTreatments={}}async loadTreatments(e){const t=this.experimentAreasForPlatform(e)
if(t.length>0)try{this.cachedRawTreatments=await e.treatmentStore.treatmentsForAreas(t)
for(const[e,t]of Object.entries(this.cachedRawTreatments)){const n=t.identifier
this.cachedTreatments[e]={...t,identifier:n.split(":")[0]}}}catch(t){e.console.error("Failed to load treatments",t)}}currentTreatmentForExperiment(e){return this.cachedTreatments[e]}createAb2Data(){const e=[]
for(const[t,n]of Object.entries(this.cachedRawTreatments))e.push({areaId:t,bucket:-2,treatmentId:n.identifier})
return e}experimentAreasForPlatform(e){const t=[]
switch(e.client.deviceType){case ZW:case HW:t.push(Cm.ArcadeDownloadPackOnboarding,Cm.Arcade,Cm.CondensedTodayAds,Cm.ProductPagePreloading,Cm.ProductPageVariants,Cm.ProductPageYMALRowCount,Cm.SearchLandingPage,Cm.SearchResultsAdBackground)}return t}}SJ.metatype=(0,Tm.makeMetatype)("app-store:experimentCache")
const PJ="3NepyQj01",CJ=kW
let IJ=null
!function(e){e[e.None=0]="None",e[e.ThirtyTwoBit=2]="ThirtyTwoBit",e[e.UnsupportedSystemDeletableApps=4]="UnsupportedSystemDeletableApps",e[e.UnsupportedWatchAppOnWatchClient=8]="UnsupportedWatchAppOnWatchClient",e[e.DisabledMerchandisableIAPs=16]="DisabledMerchandisableIAPs",e[e.LegacyApps=32]="LegacyApps",e[e.LegacyProductionMacOSInstaller=64]="LegacyProductionMacOSInstaller",e[e.UnsupportedPlatform=128]="UnsupportedPlatform",e[e.UnsupportedPreorders=256]="UnsupportedPreorders",e[e.MinimumOSRequirement=512]="MinimumOSRequirement",e[e.SADWatchApps=1024]="SADWatchApps",e[e.MinimumCompanionOSRequirement=2048]="MinimumCompanionOSRequirement",e[e.MacOSCompatibleIOSBinary=4096]="MacOSCompatibleIOSBinary",e[e.MacOSRosetta=8192]="MacOSRosetta",e[e.UnsupportedPlatformForMacCharts=16384]="UnsupportedPlatformForMacCharts",e[e.VisionOSCompatibility=32768]="VisionOSCompatibility",e[e.SADMinimumOSRequirement=65536]="SADMinimumOSRequirement",e[e.DeveloperPage=76532]="DeveloperPage",e[e.Offers=77238]="Offers",e[e.TodayCard=76670]="TodayCard",e[e.Search=10750]="Search",e[e.Bundles=76286]="Bundles",e[e.Charts=68606]="Charts",e[e.ChartsMac=84862]="ChartsMac",e[e.All=80894]="All"}(Im||(Im={}))
const kJ=[OW,IW,iz,zW,oz,"tv"]
class OJ{constructor(){this.$kind="LockupContextMenuData"}}const EJ={Lockup:Hy,InAppPurchaseLockup:OO,MixedMediaLockup:EO,PosterLockup:DO,ProductPage:RO,ScreenshotsLockup:_O,TrailersLockup:LO,UpdatesLockup:NL}
class DJ{constructor(e){this.$kind=null!=e?e:Hy}isValid(){return!!this.title&&!(!this.icon||!this.icon.isValid())}}class RJ extends DJ{constructor(){super(OO)}}class _J extends Sz{constructor(e,t){super(),this.$kind="flowAction",this.actionClass="FlowAction",this.page=e,this.pageUrl=t,this.pageData=null,this.referrerData=void 0,this.presentationContext=_q,this.animationBehavior=_q,this.origin="inapp"}}class LJ{constructor(){this.$kind="PageMetrics",this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n={data:e,invocationPoints:t}
this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class MJ{constructor(){this.$kind="InAppPurchaseInstallPage",this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class FJ extends Sz{constructor(e,t,n,r,o){super(),this.$kind="InAppPurchaseAction",this.actionClass="InAppPurchaseAction",this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class $J extends Sz{constructor(e){super(),this.$kind="AlertAction",this.actionClass="AlertAction",this.style=e,this.title=void 0,this.message=null,this.isCancelable=!1,this.cancelTitle=null,this.cancelAction=null,this.buttonActions=[],this.buttonTitles=[],this.destructiveActionIndex=null,this.imageName=null}}class xJ extends DJ{constructor(){super(_O),this.screenshots=[],this.screenshotsDisplayStyle=ON}isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class NJ extends DJ{constructor(){super(DO)}isValid(){const e=this.posterArtwork,t=this.posterVideo
return!(!e&&!t)&&super.isValid()}}class BJ extends DJ{constructor(){super(LO)}isValid(){return!(!this.trailers||!this.trailers.isValid())&&!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid()}}class UJ extends DJ{constructor(){super(EO),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null,this.screenshotsDisplayStyle="control",this.metadataRibbonItems=[],this.showMetadataInformationInLockup=!1,this.alignedRegionArtwork=null,this.alignedRegionVideo=null}}class GJ{constructor(e,t,n,r,o=!1){this.$kind="ImageLockup",this.isDark=!1,this.artwork=e,this.lockup=t,this.caption=n,this.title=r,this.isDark=o}isValid(){return this.lockup.isValid()&&this.artwork.isValid()}}class jJ{constructor(){this.$kind="ArcadeLockup"}}class VJ{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b,S=!1,P=!1,C=!1){this.$kind="OfferDisplayProperties",this.offerType=e,this.adamId=t,this.bundleId=n,this.parentAdamId=o,this.style=null==r?_q:r,this.environment=null==i?iW:i,this.offerTint=null==s?{type:jL}:s,this.titles=null==a?{}:a,this.titleSymbolNames=null==c?{}:c,this.subtitles=null==l?{}:l,this.hasInAppPurchases=u,this.hasExternalPurchases=d,this.isDeletableSystemApp=f,this.isFree=h,this.isPreorder=p,this.offerLabelStyle=null==w?wW:w,this.hasDiscount=v,this.contentRating=g,this.subscriptionFamilyId=m,this.useAdsLocale=y,this.priceFormatted=A,this.isStreamlinedBuy=T,this.appCapabilities=b,this.ignoresContentRestrictions=S,this.isRedownloadDisallowed=P,this.isOpenBundleAllowed=C}newOfferDisplayPropertiesChangingAppearance(e,t,n,r){return new VJ(this.offerType,this.adamId,this.bundleId,null==t||!e&&this.style===GG?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.offerTint:r,this.titles,this.titleSymbolNames,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId,this.useAdsLocale,this.priceFormatted,this.isStreamlinedBuy,this.appCapabilities,this.ignoresContentRestrictions,this.isRedownloadDisallowed,this.isOpenBundleAllowed)}}class HJ extends Sz{constructor(e,t=!0,n=new mz){super(),this.$kind="ExternalUrlAction",this.actionClass="ExternalUrlAction",this.url=e,this.isSensitive=t,this.actionMetrics=n}}class qJ{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class WJ extends Sz{constructor(e,t){super(),this.$kind="OfferStateAction",this.actionClass="OfferStateAction",this.title=t.title,this.adamId=e,this.defaultAction=t,this.includeBetaApps=!1}}class zJ{constructor(e,t,n,r,o,i,s){this.$kind="AdvertActionMetrics",this.instanceId=e,this.adamId=t,this.bundleId=n,this.advertType=r,this.invocation=o,this.purchaseType=i,this.reportingDestination=s}}class YJ extends Sz{constructor(e){super(),this.$kind="HttpTemplateAction",this.actionClass="HttpTemplateAction",this.message=null,this.url=e,this.method=YB,this.headers={},this.body=null,this.bodyDictionary={},this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class JJ extends YJ{}class KJ{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class ZJ{constructor(){this.$kind="ProductReview",this.componentType=L$}}class QJ{constructor(){this.$kind="Review"}}class XJ{constructor(){this.$kind="Response"}}class eK{constructor(e){this.$kind=null!=e?e:"Ratings"}}class tK{constructor(e,t,n,r,o,i,s){this.$kind="ReviewSummary",this.body=e,this.bodyNoTitle=t,this.subtitle=n,this.subtitleArtwork=r,this.subtitleArtworkAlignment=o,this.bodyMediaType=i,this.flowPreviewActionsConfiguration=s}}class nK extends eK{constructor(){super("ProductStarRatings"),this.$kind="ProductStarRatings",this.componentType="starRatings"}}class rK extends eK{constructor(){super("ProductStarRatingsHistogram"),this.$kind="ProductStarRatingsHistogram",this.componentType="starRatingsHistogram"}}class oK extends eK{constructor(){super("ProductNoRatings"),this.$kind="ProductNoRatings",this.componentType="noRatings"}}class iK{constructor(){this.$kind="TapToRate",this.componentType=Yy}}class sK extends Sz{constructor(e,t){super(),this.$kind="WriteReviewAction",this.actionClass="WriteReviewAction",this.adamId=e,this.url=t}}class aK extends DJ{constructor(){super(RO),this.pageMetrics=new LJ,this.pageRenderMetrics={}}}const cK={DynamicGenericPage:"DynamicGenericPage",SearchChartsAndCategoriesPage:"SearchChartsAndCategoriesPage",SegmentedSearchResultsDynamicPage:"SegmentedSearchResultsDynamicPage",ShelfBasedProductPage:Gy}
class lK{constructor(){this.shelfOrderings={},this.shelfMapping={},this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class uK extends lK{constructor(){super(...arguments),this.$kind="ShelfBasedProductPage",this.appPlatforms=[]}}class dK extends Sz{constructor(e,t,n,r,o,i){super(),this.$kind="ShelfBasedPageScrollAction",this.actionClass="ShelfBasedPageScrollAction",this.shelfId=e,this.notPurchasedShelfId=t,this.purchasedShelfId=n,this.adamId=r,this.index=o,this.clicksOnScroll=i}}class fK extends Sz{constructor(e,t){super(),this.$kind="ProductPageScrollAction",this.actionClass="ProductPageScrollAction",this.section=e,this.clicksOnScroll=t}}class hK{constructor(e,t){this.$kind="ProductPageSection",this.type=e,this.shelfId=t}}!function(e){e.OnPageLoad="onPageLoad",e.OnShelfWillAppear="onShelfWillAppear"}(km||(km={}))
class pK{constructor(e,t=null,n=null){this.$kind="Shelf",this.impressionMetrics=null,this.contentType=e,this.marker=t,this.items=n||[],this.header=void 0,this.url=null,this.mergeWhenFetched=!1,this.fetchStrategy=km.OnPageLoad,this.batchGroup=null,this.seeAllAction=null,this.footerTitle=null,this.footerAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.footerStyle=null,this.title=void 0,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.rowsPerColumn=null,this.background={type:wW},this.contentsMetadata={type:wW},this.isPersonalized=!1,this.shouldFilterApps=!1}}class wK{constructor(){this.$kind="ReviewsContainer"}}class vK{constructor(e,t,n,r){this.$kind="ReviewsPageSortOption",this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class gK{constructor(e,t){this.shelves=e,this.title=void 0,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new LJ,this.$kind=null!=t?t:"GenericPage"}}class mK extends gK{constructor(){super([],"ReviewsPage")}}const yK="5BB5F361-F7CA-4BE5-90D4-92A973A38B03",AK="B77D6B43-8357-42AC-9455-0BC985A4CC20",TK="3A904FFE-6C7A-43F3-A014-CF750E1CBF5D",bK="ACEB64F5-C210-4A63-9E78-1FA652ACE3B8",SK="68BBAC6D-7741-47E0-99CE-5BA3B62E88A7",PK="DA1A9665-5984-4AB6-B886-100A648F430F",CK="3263D5D9-4A36-4C59-9B78-1EC9B7E78A1C",IK="3771A729-28D2-498B-8128-36F745619ED2",kK="CF3F5A4B-4F69-48AB-8FF9-CD6AA8D54A1C",OK="DADF37D0-D667-4249-BA19-7C4A08E08281",EK="33A25C07-53BB-4278-8C07-E6D00BE78609",DK="3E45DDEC-6028-42C5-BA4C-7644C8E9316B",RK="A77D5208-7747-467B-864F-76AC0E8E0DCE",_K="979360BA-DDB0-4698-BE4F-16072F3BFB9B",LK="564053BF-441A-44D5-B37C-2D6E112E4956",MK="9AC2B085-5CE6-45CC-87B5-61F6E1E64541",FK="C2F1E751-7AC6-4368-917B-52900BA17FE8",$K="5C63792A-E02C-4266-81BB-5B14330B1477",xK="61FC0A9A-814D-46FF-AFE2-5D1907893829",NK="7D0F61A1-4E25-40DF-A258-E028C4DCC5A1",BK=T$,UK="A134C61B-1BB0-45BE-B1C8-342ABE5DAACC",GK="D39EE947-520C-4FF8-A018-05810CDC25E2",jK="1C475143-72C8-4762-BC14-4D613F95AEF4",VK="8F3F6FBC-46F3-4856-9ACB-0B1F00F2843C",HK=T$,qK=T$,WK=T$
class zK{constructor(e,t,n){this.$kind="ArtworkVariant",this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class YK{constructor(e,t=null,n=null){this.$kind="FlowPreviewActionsConfiguration",this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class JK{constructor(e,t,n){this.$kind="ReportConcernReason",this.reasonId=e,this.name=t,this.uppercaseName=n}}class KK extends Sz{constructor(e,t,n,r){super(),this.$kind="ReviewSummaryReportConcernAction",this.actionClass="ReviewSummaryReportConcernAction",this.concerns=e,this.title=t,this.explanation=n,this.sendAction=r}}class ZK extends Sz{constructor(e){super(),this.$kind="HttpAction",this.actionClass="HttpAction",this.url=e,this.method=YB,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class QK extends Sz{constructor(e){super(),this.$kind="ReportConcernAction",this.actionClass="ReportConcernAction",this.reasons=e}}class XK extends Sz{constructor(e){super(),this.$kind="CopyTextAction",this.actionClass="CopyTextAction",this.text=e}}class eZ{static get contentType(){return BF}constructor(){this._params=""}param(e,t){if(e&&t){const n=this._params.length>0?"&":""
this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}class tZ extends Sz{constructor(e,t=VW){super(),this.$kind="OpenAppAction",this.actionClass="OpenAppAction",this.adamId=e,this.destination=t}}class nZ extends Sz{constructor(e,t,n){super(),this.$kind="AppLaunchTrampolineAction",this.actionClass="AppLaunchTrampolineAction",this.bundleId=e,this.payloadUrl=t,this.fallbackAction=n}}class rZ extends Sz{constructor(e){super(),this.$kind="CompoundAction",this.actionClass="CompoundAction"
const t=[]
for(const n of e)(0,mm.isSome)(n.actionMetrics)&&(this.actionMetrics.addManyMetricsData(n.actionMetrics.data),Object.assign(this.actionMetrics.custom,n.actionMetrics.custom),n.actionMetrics.clearAll()),t.push(n)
this.actions=t}}const oZ="jet_adamId",iZ="X-AppStore-iAdClickToken",sZ="X-AppStore-iAdLineItem",aZ="X-AppStore-iAdDismissAdActionMetrics"
class cZ{constructor(e={}){this.baseFields=e}}class lZ{constructor(e){this.$kind="LintedMetricsEvent",this.fields=e}}class uZ{constructor(e){if(this._values={},(0,Am.isSome)(e)&&e.length>0){const t=e.split("&")
for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=(0,Am.isNothing)(n)?"":decodeURIComponent(n)
this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length")
return(0,Am.isNothing)(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t)
return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n)
return(0,Am.isNothing)(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e=""
for(const t of Object.keys(this._values)){const n=this._values[t]
e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={}
for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n)
e[r]=o}return e}toRawMap(){return{...this._values}}}!function(e){e.client="clientId",e.user="userId",e.canonical="canonicalAccountIdentifierOverride"}(Om||(Om={})),function(e){e.client="APPSTORE_ENGAGEMENT_CLIENT",e.user="APPSTORE_ENGAGEMENT"}(Em||(Em={})),function(e){e.client="APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT",e.user="APPSTORE_PAYMENTS_ENGAGEMENT"}(Dm||(Dm={})),function(e){e.user="APPSTORE_PERSONALIZATION"}(Rm||(Rm={}))
const dZ={[Om.client]:{keyType:Om.client,bagNamespace:Dm.client,crossSyncDevice:!1},[Om.user]:{keyType:Om.user,bagNamespace:Dm.user,crossSyncDevice:!0}},fZ={[Om.client]:{keyType:Om.client,bagNamespace:Em.client,crossSyncDevice:!1},[Om.user]:{keyType:Om.user,bagNamespace:Em.user,crossSyncDevice:!0}},hZ={[Om.user]:{keyType:Om.user,bagNamespace:Rm.user,crossSyncDevice:!0}}
class pZ{constructor(e=fZ){this.cachedMetricsIds={},this.cachedMetricsFields={},this.shouldAddDsIdFallbackField=!1,this.userDsId=null,this.identifierContextMapping=e}async loadValues(e,t){e.bag.isMetricsUserIdFallbackEnabled&&!e.user.isUnderThirteen?(this.shouldAddDsIdFallbackField=!0,this.userDsId=e.user.dsid):(this.shouldAddDsIdFallbackField=!1,this.userDsId=null)
const n=[]
for(const r of t){const t=await this.loadValuesForIdType(e,r)
n.push(t)}for(const{idType:e,id:t,fields:r}of n)t&&(this.cachedMetricsIds[e]=t),r&&(this.cachedMetricsFields[e]=r)}async loadValuesForIdType(e,t){const n={idType:t},r=this.identifierContextMapping[t]
if(r){try{const o=await ym.context("MetricsIdentifiersCache:loadValues:metricsFields",async()=>await e.metricsIdentifiers.getMetricsFieldsForContexts([r]))
if((0,mm.isSome)(o)){n[N$]=o
const e=o[t];(0,mm.isSome)(e)&&typeof e===$W&&e.length>0&&(n.id=e)}}catch(n){e.console.error(`Unable to fetch metrics fields for idType ${t}`,n)}if((0,mm.isNothing)(n.id))try{const t=await ym.context("MetricsIdentifiersCache:loadValues:metricsIdentifier",async()=>await e.metricsIdentifiers.getIdentifierForContext(r));(0,mm.isSome)(t)&&(n.id=t)}catch(n){e.console.error(`Unable to fetch metrics identifier for idType ${t}`,n)}}return n}getMetricsIdForType(e){return this.cachedMetricsIds[e]}getMetricsFieldsForTypes(e){const t=e.map(e=>{var t
return null!==(t=this.cachedMetricsFields[e])&&void 0!==t?t:{}}),n=Object.assign({},...t)
return this.shouldAddDsIdFallbackField&&-1!==e.indexOf(Om.user)&&this.addDsIdFallbackFieldIfNecessary(n),n}addDsIdFallbackFieldIfNecessary(e){const t=e[Om.user];((0,mm.isNothing)(t)||typeof t!==$W||0===t.length||t.length===pZ.clientGeneratedUserIdLength)&&(0,mm.isSome)(this.userDsId)&&this.userDsId.length>0&&(e[oR]=this.userDsId)}setCanonicalAccountIdentifierOverride(e){e.length>=0&&(this.cachedMetricsFields[Om.canonical]={[Om.canonical]:e})}}pZ.defaultMetatype=(0,Tm.makeMetatype)("app-store:metricsIdentifiersCache"),pZ.paymentMetatype=(0,Tm.makeMetatype)("app-store:paymentMetricsIdentifiersCache"),pZ.personalizationMetatype=(0,Tm.makeMetatype)("app-store:personalizationMetricsIdentifiersCache"),pZ.clientGeneratedUserIdLength=24
class wZ{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=f(n,"fieldName")
if(r(t))continue
const o=h(e,t)
if(r(o))continue
let i=h(n,"magnitude")
r(i)&&(i=1048576)
let s=h(n,"significantDigits")
if(r(s)&&(s=2),i<=0||s<0){e[t]=Number.NaN
continue}const a=o/i
e[t]=Et(a,s)}}_urlScrubbingAdParameters(e){const t=new oY(e)
return t.removeParam(iZ),t.removeParam(sZ),t.removeParam(aZ),t.build()}_urlScrubbingExtRefUrl(e){const t=new oY(e)
return t.username="",t.password="",t.pathname=void 0,t.query=void 0,t.hash=void 0,t.build()}_derezFastImpressions(e){const t=f(e,kB),n=h(e,OB)
if(t===ZD){if(4===n){const t=l(e,uq)
e[uq]=t.map(e=>{if((0,Am.isNothing)(e))return e
const t=l(e,NS)
return 0===t.length||(e[NS]=t.map(e=>{if((0,Am.isNothing)(e))return e
const t=h(e,"d")
return e.s=0,(0,Am.isSome)(t)&&(e.d=Et(t,2)),e})),e})}if(5===n){const t=l(e,uq)
e[uq]=t.map(e=>{if((0,Am.isNothing)(e))return e
delete e[CF],f(e,DB)!==$x&&(o(f(e,IF))||o(f(e,xx)))&&delete e.id
const t=p(e,BS)
if((0,Am.isNothing)(t)||o(t))return e
const n=f(e,hj)
return Object.entries(t).forEach(([e,r])=>{const o=l(r)
t[e]=o.map(e=>{if((0,Am.isNothing)(e))return e
if(n===tR){const t=h(e,"s");(0,Am.isSome)(t)&&(e.s=Et(t,3))}else e.s=0
const t=h(e,"d")
return(0,Am.isSome)(t)&&(e.d=Et(t,2)),e})}),e[BS]=t,e})}}}_stripContentRatingImpressionFields(e){const t=l(e,uq)
e[uq]=t.map(e=>((0,Am.isSome)(e)&&(delete e[TG],delete e[hW]),e))}_decorateSearchResultImpressions(e){const t=f(e,GV),n=f(e,xj)
t===OH&&n!==Nx&&function(e){const t=l(e,uq)
let n
for(const e of t){const t=f(e,DB)
if((0,Am.isSome)(e)&&t===HV){n=e[jx]
break}}n&&(e[uq]=t.map(e=>{const t=f(e,DB),r=t===AH||t===z$
return(0,Am.isSome)(e)&&r&&(e[PR]=n),e}))}(e)}_decorateSearchFocusImpressions(e){const t=f(e,GV),n=f(e,xj)
t===kF&&n===OF&&function(e){var t
const n=l(e,uq)
let r
for(const e of n)if("R8804"===f(e,pB)){r=null!==(t=f(e,jx))&&void 0!==t?t:void 0
break}r&&(e[uq]=n.map(e=>{const t=f(e,pB),n=f(e,DB)
return o(t)&&n===EW&&null!=e&&null==f(e,PR)&&(e[PR]=r),e}))}(e)}_decorateGamesSearchHintClick(e){}_decorateAll(e,t,n){var o,i,s
const a=this._options.bagProvider,c=a("metricsBase",n)
r(c)||typeof c!==vH||Object.assign(t,c),t.clientBuildType=this._options.buildType,t.resourceRevNum=this._options.jsVersion,t.xpSendMethod="jet-js",this._options.buyDecorator.useApp(f(t,VW)),delete t[oZ]
const u=function*(e){if((0,Am.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}}(f(t,US))
for(const e of u)if("xp_ci"===e.key){this._options.buyDecorator.useClientId(e.value)
break}delete t[US]
const d=null!==(i=null===(o=e.metricsIdentifiersCache)||void 0===o?void 0:o.getMetricsFieldsForTypes([Om.client]))&&void 0!==i?i:{}
Object.assign(t,d),delete t.clientGeneratedId
const h=f(t,GV),p=f(t,xj)
if(!r(h)&&!r(p)){const e=f(a("compoundSeparator",n))||"_"
t[fz]=`${h}${e}${p}`}const w=l(a("deResFields",n))
this._reduceFieldAccuracy(t,w)
const v=[AG,IB,RU,_U,BW,"parentPageUrl"]
for(const e of v){const n=f(t,e);(0,Am.isSome)(n)&&n.length>0&&(t[e]=e===RU?this._urlScrubbingExtRefUrl(n):this._urlScrubbingAdParameters(n))}const g=f(t,nR)
if((0,Am.isSome)(g)&&(delete t[nR],t[Bx]=g),e.bag.isMetricsUserIdFallbackEnabled){const n=f(t,rR)
let r=null;((0,Am.isNothing)(n)||0===n.length||n.length===wZ.clientGeneratedUserIdLength)&&(r=null!==(s=e.user.dsid)&&void 0!==s?s:null),(0,Am.isSome)(r)&&r.length>0&&(t[oR]=r)}}_decorateClick(e){!function(e){const t=f(e,Jx),n=f(e,CR)
r(t)&&(0,mm.isSome)(n)&&(null==n?void 0:n.length)>0&&(e[Jx]=n),f(e,IR)===yP&&delete e[kR]}(e),this._decorateSearchResultImpressions(e),this._decorateSearchFocusImpressions(e),vz.shared.addReferralDataToEventIfNecessary(e),this._filterBuyParams(e),this._decorateGamesSearchHintClick(e)
const t=f(e,GV)
!(0,Am.isNothing)(t)&&t.toLowerCase().includes(gW)||delete e[uq],op(e)}_decorateImpressions(e,t){if(o(t[uq]))return!1
this._derezFastImpressions(t),this._decorateSearchResultImpressions(t),this._stripContentRatingImpressionFields(t)
const n=f(t,_U)
return(0,Am.isSome)(n)&&n.length>0&&(t[Hq]=Rh(n),delete t[_U]),op(t),delete t[kB],!0}_decorateMedia(e){const t=h(e,EF)
r(t)||(e[EF]=Math.round(t))}_filterBuyParams(e){const t=f(e,"actionDetails.buyParams")
if((0,Am.isSome)(t)&&t.length>0){const n=new uZ(t);[GS].forEach(e=>{n.set(e,null,null)}),(0,Am.isSome)(e[Nj])&&(e[Nj][pV]=n.toString())}}_decoratePage(e,t){const n=f(t,fz)
r(n)||(t.pageHistory=this._options.buyDecorator.getPageHistoryFor(n)),vz.shared.setReferralDataForProductPageExtensionIfNecessary(t),vz.shared.beginReferralContextForPageIfNecessary(t),vz.shared.addReferralDataToEventIfNecessary(t)
const o=f(t,_U)
if(!r(o)){const e=Oh(o),n=Rh(o);(0,Am.isSome)(e)&&e.length>0&&(t[Ux]=e),(0,Am.isSome)(n)&&n.length>0&&(t[Hq]=n)}}_decoratePageChange(e,t){this._decoratePage(e,t)}_decorateSearch(e){e[OB]=3,function(e){var t
const n=null!==(t=e[Nj])&&void 0!==t?t:{},o=n[Jx],i=f(e,CR)
r(o)&&(0,mm.isSome)(i)&&(null==i?void 0:i.length)>0&&(n[Jx]=i,e[Nj]=n),f(e,IR)===yP&&delete e[kR],e[Ij]===OR&&delete e[kR]}(e)}_decoratePageExit(e){vz.shared.endReferralContextIfNecessaryForPageEvent(e)}_filterExtraneous(e){!function(e){delete e[CR],delete e[IR],delete e.searchGhostHintTermLastDisplayed}(e),vz.shared.removeReferralContextInfoFromMetricsEvent(e)}makeEvent(e,t){if((0,Am.isNothing)(t))return new lZ({})
const n=f(t,UV)
if(this._options.isLoggingEnabled&&e.console.log(`Building event for topic: ${n}`),t[VW]===By)return new lZ({})
const r=f(t,jN)||this._options.defaultTopic
this._decorateAll(e,t,r),e.user.isUnderThirteen&&(delete t[oR],delete t[rR],delete t.canonicalAccountIdentifierOverride)
const o=t[RU]
switch(o&&""===o&&delete t[RU],n){case fj:this._decorateClick(t)
break
case XD:e.clientCapabilities.isNotEnabled(AJ)&&e.bag.disableDefaultTabReset&&Dt(e)
break
case uq:if(!this._decorateImpressions(e,t))return new lZ({})
break
case QD:this._decorateMedia(t)
break
case fz:this._decoratePage(e,t)
break
case zL:this._decoratePageChange(e,t)
break
case jS:this._decoratePageExit(t)
break
case gW:this._decorateSearch(t)
break
case"appLaunch":e.clientCapabilities.isNotEnabled(AJ)&&e.bag.disableDefaultTabReset&&Dt(e)}return this._filterExtraneous(t),e.bag.metricsIdMigrationEnabled&&function(e){delete e[DR],delete e.DSID}(t),new lZ(t)}}wZ.clientGeneratedUserIdLength=24,wZ.hasIAdData=eR
class vZ{constructor(e,t,n,r,o=!1){this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class gZ{constructor(){this.$kind="TodayCard",this.heading=void 0,this.title=void 0,this.shortTitle=void 0,this.titleArtwork=void 0,this.media=void 0,this.heroMedia=void 0,this.overlay=void 0,this.style=void 0,this.clickAction=void 0,this.backgroundColor=void 0,this.inlineDescription=void 0,this.collapsedHeading=void 0,this.editorialDisplayOptions=void 0,this.supportsMediaMirroring=void 0}}const mZ="5pdfhju01"
class yZ{constructor(e,t,n){this.$kind="SearchAdOpportunity",this.instanceId=e,this.eventPayloads=t,this.searchAd=n}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}setMissedOpportunityReason(e){this.eventPayloads.placed.missedOpportunityReason=e}}class AZ extends Sz{constructor(e){super(),this.$kind="AdTransparencyAction",this.actionClass="AdTransparencyAction",this.adTransparencyData=e}}class TZ{constructor(e,t,n,r,o){this.$kind="SearchAd",this.instanceId=e,this.iAd=t,this.eventPayloads=n,this.impressionId=r,this.transparencyAction=o}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}}class bZ extends Sz{constructor(e){super(),this.$kind="AdInteractionAction",this.actionClass="AdInteractionAction",this.adActionMetrics=e}}class SZ{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[pj],this.requestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=(0,mm.isSome)(this.requestData)&&this.requestData.length>0,t=(0,mm.isSome)(this.routingInfo)&&this.routingInfo.length>0
return e&&t}}const PZ="PI4",CZ="PI3",IZ="PI2",kZ="PI1",OZ="PV4",EZ="PV3",DZ="PV2",RZ="PV1",_Z="LV1",LZ="LI1",MZ="UV1_3x2",FZ="UI1_3x2",$Z="TEXT",xZ=[FZ],NZ=[[$Z],[_Z,LZ],[PZ,CZ,IZ,kZ,OZ,EZ,DZ,RZ],xZ]
let BZ=null
const UZ="jet_native_advert_instanceid"
!function(e){e.Grid="grid",e.Hero="hero",e.Standard="standard"}(_m||(_m={})),function(e){e.insertIntoShelf="insertIntoShelf",e.replaceOrganic="replaceOrganic",e.dropAd="dropAd"}(Lm||(Lm={})),function(e){e.Icon="icon",e.Category="category"}(Mm||(Mm={})),function(e){e.TopLeading="topLeading",e.Top="top",e.TopTrailing="topTrailing",e.Trailing="trailing",e.BottomTrailing="bottomTrailing",e.Bottom="bottom",e.BottomLeading="bottomLeading",e.Leading="leading"}(Fm||(Fm={})),$m=e(172)
const GZ="appStore.getEngagementEvents",jZ=0,VZ=1,HZ=2
class qZ{constructor(e){this.$kind="CategoryList",this.categories=e}}class WZ{constructor(e,t,n,r,o){this.$kind="Category",this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}const zZ={Apps:36,MacApps:39,Games:6014,Discover:39},YZ=["284417353","1464590764","314638464","284993479","1351056256"];(Ry=xm||(xm={})).ArcadeSeeAllGames="editorial-shelves-arcade-see-all-games",Ry.Collection="editorial-shelves-collection",Ry.Chart="editorial-shelves-chart",Ry.Tag="editorial-shelves-tag",Ry.Engagement="editorial-shelves-engagement",Ry.Text="editorial-shelves-text",Ry.Image="editorial-shelves-image",Ry.VideoClip="editorial-shelves-video-clip",Ry.Header="editorial-shelves-header",Ry.Recommendations="editorial-shelves-recommendation",Ry.GameCenter="editorial-shelves-game-center",Ry.Upsell="editorial-shelves-upsell",Ry.Marker="editorial-shelves-marker",(Dy=Nm||(Nm={})).Hero="Hero",Dy.TextOnly="TextOnly",Dy.TextWithArtwork="TextWithArtwork",Dy.BrickSmall="BrickSmall",Dy.BrickMedium="BrickMedium",Dy.BrickLarge="BrickLarge",Dy.Charts="Charts",Dy.EditorialLockupHierarchicalPortrait="EditorialLockupHierarchicalPortrait",Dy.EditorialLockupHierarchicalRows="EditorialLockupHierarchicalRows",Dy.EditorialLockupMedium="EditorialLockupMedium",Dy.EditorialLockupMediumVariant="EditorialLockupMediumVariant",Dy.EditorialLockupLarge="EditorialLockupLarge",Dy.EditorialLockupLargeVariant="EditorialLockupLargeVariant",Dy.LockupMedium="LockupMedium",Dy.Lockup4Up="Lockup4Up",Dy.Poster="Poster",Dy.StorySmall="StorySmall",Dy.StoryMedium="StoryMedium",Dy.LockupSmall="LockupSmall",Dy.LockupLarge="LockupLarge",Dy.BreakoutLarge="BreakoutLarge",function(e){e.QuickLinks="QuickLinks",e.GameCenterFriendsArePlaying="GameCenterFriendsArePlaying"}(Bm||(Bm={})),(Ey=Um||(Um={})).Vertical="Vertical",Ey.Horizontal="Horizontal",Ey.Condensed="Condensed",function(e){e.ShowInstalled="ShowInstalled",e.ShowAllPlatforms="ShowAllPlatforms",e.ShowOnlyPreorder="ShowOnlyPreorder"}(Gm||(Gm={})),function(e){e.AllGames="AllGames",e.ArcadeGames="ArcadeGames"}(jm||(jm={})),function(e){e.FriendsArePlaying="FriendsArePlaying",e.ContinuePlaying="ContinuePlaying"}(Vm||(Vm={})),function(e){e.ArcadeTabHeader="ArcadeTabHeader"}(Hm||(Hm={})),function(e){e.Arcade="Arcade"}(qm||(qm={})),function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(Wm||(Wm={}))
const JZ="X-Apple-AppStore-UserId-Secondary"
class KZ extends Error{}class ZZ extends Error{}const QZ="x-apple-application-instance",XZ="x-apple-application-site",eQ=[SW,YG,rU]
!function(e){e.AppEvent="appEvent",e.ContingentOffer="contingentOffer",e.OfferItem="offerItem"}(zm||(zm={}))
class tQ{constructor(e,t,n,r,o,i){this.$kind="AppEventDetailPage",this.appEvent=e,this.artwork=t,this.video=n,this.shareAction=r,this.mediaOverlayStyle=o,this.includeBorderInDarkMode=i,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class nQ extends Sz{constructor(e,t,n=vA){super(),this.$kind="ShareSheetAction",this.actionClass="ShareSheetAction",this.data=e,this.activities=t,this.shareSheetStyle=n}}Ym=e(447)
class rQ{constructor(){this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class oQ extends rQ{constructor(){super(...arguments),this.$kind="SearchResults"}}class iQ{constructor(e){this.promotionType=e}}class sQ extends iQ{constructor(e,t,n){super(zm.ContingentOffer),this.$kind=Uy,this.contingentOffer=e,this.artwork=t,this.mediaOverlayStyle=n,this.pageMetrics=new LJ,this.pageRenderMetrics={},this.learnMoreActionMetrics=new mz,this.backButtonActionMetrics=new mz,this.closeButtonActionMetrics=new mz}}class aQ extends iQ{constructor(e,t,n,r,o,i,s){super(zm.OfferItem),this.$kind=Wy,this.offerItem=e,this.artwork=t,this.learnMoreTitle=i,this.video=n,this.mediaOverlayStyle=r,this.pageMetrics=new LJ,this.additionalInfo=s,this.pageRenderMetrics={},this.learnMoreActionMetrics=new mz,this.backButtonActionMetrics=new mz,this.closeButtonActionMetrics=new mz}}class cQ extends Sz{constructor(e,t,n,r){super(),this.$kind="OfferAction",this.actionClass="OfferAction",this.title=e,this.adamId=t,this.parentAdamId=r,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem),this.includeBetaApps=!1}}class lQ extends Sz{constructor(e,t){super(),this.$kind="OfferConfirmationAction",this.actionClass="OfferConfirmationAction",this.buyAction=e,this.confirmationInitiationAction=t}}class uQ extends Sz{constructor(){super(),this.$kind="OfferAlertAction",this.actionClass="OfferAlertAction",this.title=void 0,this.message=null,this.footerMessage=void 0,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=VG,this.spatialControllerRequirement=null,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class dQ{constructor(e,t,n,r,o){this.$kind="MarketingItemRequestInfo",this.serviceType=e,this.placement=t,this.seed=r,this.clientOptions=o,this.metricsOverlay={topic:n}}}const fQ="data.search.dataSetId",hQ=O_,pQ=Ym.PageInvocationPoint
pQ[gW]=gW,pQ[GO]=GO,pQ[hq]=hq,pQ[zL]=zL
const wQ=new Set([_F,pj,FF,WS,wP,LU,xx,IF,EH,"iAd",hj,MF,eR,rV,UV,kB])
class vQ{constructor(e,t,n,r,o,i){this.$kind="ShareSheetNotesMetadata",this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class gQ{constructor(e,t){this.$kind="ShareSheetActivity",this.activityType=e,this.action=t}}class mQ{constructor(e,t,n,r){this.$kind="ShareSheetArticleMetadata",this.context=vW,this.id=e,this.text=t,this.subtitle=n,this.artwork=r}}class yQ{constructor(e,t,n){this.$kind="ShareSheetData",this.metadata=e,this.url=t,this.shortUrl=n}}class AQ{constructor(e,t,n){this.$kind="ShareSheetAppEventMetadata",this.context=qB,this.text=e,this.subtitle=t,this.artwork=n}}class TQ extends Sz{constructor(e,t,n,r,o,i,s,a,c){super(),this.$kind="CreateCalendarEventAction",this.actionClass="CreateCalendarEventAction",this.startDate=e,this.endDate=t,this.isAllDay=n,this.name=r,this.location=o,this.notes=i,this.url=s,this.notAuthorizedAction=a,this.availability=c}}class bQ{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="ShareSheetProductMetadata",this.context=fq,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class SQ extends Sz{constructor(e){super(),this.$kind="SheetAction",this.actionClass="SheetAction",this.actions=e,this.isCancelable=!1,this.cancelTitle=null,this.message=null,this.style=kW,this.isCustom=!1,this.destructiveActionIndex=null}}class PQ{constructor(e,t,n){this.$kind="ShareSheetGenericMetadata",this.context=lV,this.text=e,this.subtitle=t,this.artwork=n}}class CQ{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b){this.$kind="PurchaseConfiguration",this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=f,this.supportsVisionOSCompatibleIOSBinary=h,this.inAppEventId=p,this.extRefApp2=w,this.extRefUrl2=v,this.additionalHeaders=g,this.appCapabilities=m,this.isDefaultBrowser=y,this.remoteDownloadIdentifiers=A,this.hasMacIPAPackage=T,this.contentRating=b}}class IQ extends Sz{constructor(e,t,n,r){super(),this.$kind="ArcadeSubscriptionStateAction",this.actionClass="ArcadeSubscriptionStateAction",this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class kQ extends Sz{constructor(e,t){super(),this.$kind="CancelPreorderAction",this.actionClass="CancelPreorderAction",this.preorderAdamId=e,this.isArcade=t}}class OQ extends Sz{constructor(e,t){super(),this.$kind="RateLimitedAction",this.actionClass="RateLimitedAction",this.actionKey=e,this.primaryAction=t}}const EQ=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase()
return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||r(e)||(this._app=e)}useClientId(e){r(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0
for(const t of e){const e=f(t)
r(e)||this._pages.push(e)}}}useNativeValues(e){const t=f(e,"nativeApp")
this.useApp(t)
const n=f(e,"nativeClientId")
this.useClientId(n)
const r=l(e,"nativePageHistory")
this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice()
return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}}
let DQ=null
const RQ={containerId:"mtContainerId",placementId:"mtIadPlacementId",templateType:"mtIadTemplateType"},_Q={TodayCardMediaAppEvent:"TodayCardMediaAppEvent",TodayCardMediaArtwork:Qy,TodayCardMediaBrandedSingleApp:Xy,TodayCardMediaHero:"TodayCardMediaHero",TodayCardMediaList:eA,TodayCardMediaVideo:tA},LQ={TodayCardInAppPurchase:"TodayCardInAppPurchase",TodayCardMediaAppIcon:"TodayCardMediaAppIcon",TodayCardMediaGrid:"TodayCardMediaGrid",TodayCardMediaMediumLockupWithAlignedRegion:"TodayCardMediaMediumLockupWithAlignedRegion",TodayCardMediaMediumLockupWithScreenshots:"TodayCardMediaMediumLockupWithScreenshots",TodayCardMediaMultiApp:"TodayCardMediaMultiApp",TodayCardMediaRiver:nA,TodayCardMediaSingleLockup:"TodayCardMediaSingleLockup",..._Q}
class MQ{constructor(e){this.impressionMetrics=null,this.kind=e}bestBackgroundColor(){}get searchAdOpportunity(){}}class FQ extends MQ{constructor(e,t,n,r){super(e),this.artworks=t,this.videos=n,this.artworkLayoutsWithMetrics=r}bestBackgroundColor(){var e,t,n
return null!==(t=null===(e=this.videos[0])||void 0===e?void 0:e.preview.backgroundColor)&&void 0!==t?t:null===(n=this.artworks[0])||void 0===n?void 0:n.backgroundColor}}class $Q extends FQ{constructor(e,t,n,r){super(XW,e,t,n),this.$kind="TodayCardMediaArtwork",this.titleBackingGradient=r}}class xQ extends MQ{constructor(e,t){super(F$),this.$kind="TodayCardMediaMultiApp",this.lockups=e,this.additionalText=t}}class NQ extends FQ{constructor(e,t){super(UG,e,t,[]),this.$kind="TodayCardMediaHero"}isValid(){const e=this.artworks.every(e=>e.isValid())&&this.artworks.length>0,t=this.videos.length>0
return e||t}}const BQ={TodayCardActionOverlay:"TodayCardActionOverlay",TodayCardAppEventLockupOverlay:"TodayCardAppEventLockupOverlay",TodayCardArcadeLockupOverlay:"TodayCardArcadeLockupOverlay",TodayCardLockupListOverlay:"TodayCardLockupListOverlay",TodayCardLockupOverlay:Ky,TodayCardMarketingLockupOverlay:Zy,TodayCardParagraphOverlay:rA,TodayCardThreeLineOverlay:oA}
class UQ{constructor(e){this.kind=e}}class GQ extends UQ{constructor(e){super(aW),this.$kind="TodayCardActionOverlay",this.action=e}}class jQ extends FQ{constructor(e,t,n,r,o,i,s){super(qB,r,o,i),this.$kind="TodayCardMediaAppEvent",this.formattedDates=e,this.startDate=t,this.tintColor=n,this.blurStyle=s}}class VQ extends UQ{constructor(e){super(KW),this.$kind="TodayCardLockupOverlay",this.lockup=e,this.displaysIcon=!0}}class HQ{constructor(e,t,n,r,o=!1,i=!1){this.$kind="PageRefreshPolicy",this.strategy=e,this.updateDelayInterval=t,this.timeSinceOnScreenInterval=n,this.timeToLiveEndDate=r,this.refreshWhileVisible=o,this.refreshForDeviceDrivenContentChange=i}}class qQ{constructor(e,t,n){this.locationTracker={rootPosition:0,locationStack:[]},this.parsedCardCount=0,this.currentRowIndex=0,this.pageInformation=e,this.locationTracker=null!=t?t:{rootPosition:0,locationStack:[]},this.refreshController=n}}class WQ extends qQ{constructor(e,t,n,r,o){super(t,n,r),this.pageHasDisplayedContent=!1,this.remainingContent=e,this.adPlacementBehavior=Lm.insertIntoShelf,this.recoImpressionData=o}}!function(e){e.AppEventCard="AppEventCard",e.AppOfTheDay="AppOfTheDay",e.FullBleedImage="FullBleedImage",e.GameOfTheDay="GameOfTheDay",e.Grid="Grid",e.InAppPurchase="InAppPurchase",e.List="List",e.NumberedList="NumberedList",e.River="River",e.ShortImage="ShortImage",e.SingleApp="SingleApp",e.Video="Video"}(Jm||(Jm={})),function(e){e.SmallCard="smallCard",e.MediumCard="mediumCard"}(Km||(Km={})),function(e){e.NoArtwork="no-artwork",e.ContentArtworkWithTitle="content-artwork-with-title",e.CategoryArtworkWithTitle="category-artwork-with-title",e.CategoryArtworkWithBadge="category-artwork-with-badge"}(Zm||(Zm={})),function(e){e.AppOfTheDay="app-of-the-day",e.GameOfTheDay="game-of-the-day"}(Qm||(Qm={})),function(e){e.Eyebrow="eyebrow",e.Title="title"}(Xm||(Xm={})),function(e){e.LinearGradient="linear-gradient"}(ey||(ey={})),function(e){e.Inline="inline",e.Article="article"}(ty||(ty={}))
const zQ={top:0,left:0,bottom:0,right:0}
!function(e){e.Mini="mini",e.ExtraWide="extraWide",e.None="none"}(ny||(ny={}))
const YQ={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},JQ={collapsedContentMode:Pm.top,expandedContentMode:Pm.top,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},KQ={objectPath:"editorialVideo.categoryDetailMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:YQ,rtl:YQ,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},{ltr:JQ,rtl:JQ,collapsedSize:{type:MH,height:1}}],sourceWidth:800,sourceHeight:450,type:Xq,crops:["sr"]},ZQ={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},QQ={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},XQ={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},eX={objectPath:"editorialArtwork.categoryDetailStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:ZQ,rtl:ZQ,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},{maxWidth:704,ltr:QQ,rtl:QQ,collapsedSize:{type:MH,height:1.08}},{ltr:XQ,rtl:XQ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:QV},tX={collapsedContentMode:Pm.bottomLeft,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:zQ},nX={collapsedContentMode:Pm.bottomLeft,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},rX={collapsedContentMode:Pm.topLeft,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},oX={maxWidth:250,ltr:tX,rtl:tX,collapsedSize:{type:MH,height:1},priority:ny.Mini},iX={objectPath:lL,cardArtLayoutMetrics:[oX,{maxWidth:704,ltr:nX,rtl:nX,collapsedSize:{type:MH,height:1.062}},{ltr:rX,rtl:rX,collapsedSize:{type:A$,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:QV},sX={collapsedContentMode:Pm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Pm.bottomLeft,expandedLayoutInsets:zQ},aX={collapsedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedContentMode:Pm.bottomLeft,expandedLayoutInsets:zQ},cX={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},lX={maxWidth:250,ltr:sX,rtl:sX,collapsedSize:{type:MH,height:1},priority:ny.Mini},uX={objectPath:uL,cardArtLayoutMetrics:[lX,{maxWidth:704,ltr:aX,rtl:aX,collapsedSize:{type:MH,height:1.062}},{ltr:cX,rtl:cX,collapsedSize:{type:A$,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:QV},dX={collapsedContentMode:Pm.bottomLeft,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:zQ},fX={collapsedContentMode:Pm.bottomLeft,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},hX={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},pX={maxWidth:250,ltr:dX,rtl:dX,collapsedSize:{type:MH,height:1},priority:ny.Mini},wX={objectPath:dL,cardArtLayoutMetrics:[pX,{maxWidth:704,ltr:fX,rtl:fX,collapsedSize:{type:MH,height:1.062}},{ltr:hX,rtl:hX,collapsedSize:{type:A$,width:1}}],crops:[JI],sourceWidth:800,sourceHeight:490,type:QV},vX=Pm.topRight,gX={top:-108,left:495,bottom:0,right:0},mX=Pm.topLeft,yX={top:-108,left:-495,bottom:0,right:0},AX={type:iq,width:1124,height:482},TX={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:vX,expandedLayoutInsets:gX},bX={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:mX,expandedLayoutInsets:yX},SX={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:-165,left:524,bottom:0,right:0},expandedContentMode:vX,expandedLayoutInsets:gX},PX={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:-165,left:-524,bottom:0,right:0},expandedContentMode:mX,expandedLayoutInsets:yX},CX={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:vX,expandedLayoutInsets:gX},IX={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:mX,expandedLayoutInsets:yX},kX={objectPath:"editorialVideo.listCardMotion21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:TX,rtl:bX,collapsedSize:{type:iq,width:914,height:392},expandedSize:AX,priority:ny.Mini},{ltr:SX,rtl:PX,collapsedSize:{type:iq,width:1188,height:509},expandedSize:AX},{ltr:CX,rtl:IX,collapsedSize:{type:iq,width:1456,height:624},expandedSize:AX,priority:ny.ExtraWide}],crops:[],sourceWidth:1208,sourceHeight:518,type:Xq},OX={collapsedContentMode:Pm.bottomRight,collapsedLayoutInsets:zQ,expandedContentMode:Pm.topRight,expandedLayoutInsets:zQ},EX={collapsedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedContentMode:Pm.topLeft,expandedLayoutInsets:zQ},DX={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Pm.right,expandedLayoutInsets:zQ},RX={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Pm.left,expandedLayoutInsets:zQ},_X={collapsedContentMode:Pm.scaleAspectFill,collapsedLayoutInsets:zQ,expandedContentMode:Pm.bottomRight,expandedLayoutInsets:{top:50,left:495,bottom:0,right:0}},LX={collapsedContentMode:Pm.scaleAspectFill,collapsedLayoutInsets:zQ,expandedContentMode:Pm.bottomRight,expandedLayoutInsets:{top:50,left:-495,bottom:0,right:0}},MX={objectPath:"editorialArtwork.listCardStatic21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:OX,rtl:EX,sourceCropOverrideLTR:"LCS.ApLCS01",sourceCropOverrideRTL:"LCS.ApLCS02",sourceSizeOverride:new AY(550,264),priority:ny.Mini},{ltr:DX,rtl:RX,collapsedSize:{type:iq,width:672,height:279}},{ltr:_X,rtl:LX,expandedSize:{type:iq,width:1124,height:482},sourceCropOverrideLTR:KI,sourceCropOverrideRTL:KI,priority:ny.ExtraWide}],crops:["LCS.ApLCL01","LCS.ApLCL02"],sourceWidth:688,sourceHeight:286,type:QV},FX={collapsedContentMode:Pm.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Pm.bottomLeft,expandedLayoutInsets:zQ},$X={collapsedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedContentMode:Pm.bottomLeft,expandedLayoutInsets:zQ},xX={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottomLeft,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},NX={maxWidth:250,ltr:FX,rtl:FX,collapsedSize:{type:MH,height:1},priority:ny.Mini},BX={objectPath:sF,cardArtLayoutMetrics:[NX,{maxWidth:704,ltr:$X,rtl:$X,collapsedSize:{type:MH,height:1.062}},{ltr:xX,rtl:xX,collapsedSize:{type:A$,width:1}}],crops:[JI],sourceWidth:800,sourceHeight:490,type:QV},UX={collapsedContentMode:Pm.center,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},GX={objectPath:"editorialVideo.storeFrontVideo",cardArtLayoutMetrics:[{ltr:UX,rtl:UX,collapsedSize:{type:MH,height:1},expandedSize:{type:MH,height:1}}],crops:[],sourceWidth:875,sourceHeight:492,type:Xq},jX={collapsedContentMode:Pm.center,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},VX={objectPath:"editorialVideo.storeFrontVideo4x3",cardArtLayoutMetrics:[{ltr:jX,rtl:jX,collapsedSize:{type:MH,height:1},expandedSize:{type:MH,height:1}}],crops:[],sourceWidth:656,sourceHeight:492,type:Xq},HX={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},qX={collapsedContentMode:Pm.top,expandedContentMode:Pm.top,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},WX={objectPath:"editorialVideo.storyCardMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:HX,rtl:HX,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},{ltr:qX,rtl:qX,collapsedSize:{type:MH,height:1}}],sourceWidth:800,sourceHeight:450,type:Xq,crops:["sr"]},zX={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},YX={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},JX={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},KX={maxWidth:250,ltr:zX,rtl:zX,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},ZX={objectPath:ZI,cardArtLayoutMetrics:[KX,{maxWidth:704,ltr:YX,rtl:YX,collapsedSize:{type:MH,height:1.08}},{ltr:JX,rtl:JX}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:QV},QX={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},XX={collapsedContentMode:Pm.top,expandedContentMode:Pm.top,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},e0={objectPath:"editorialVideo.storyCenteredMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:QX,rtl:QX,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},{ltr:XX,rtl:XX,collapsedSize:{type:MH,height:1}}],sourceWidth:800,sourceHeight:450,type:Xq,crops:["sr"]},t0={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},n0={collapsedContentMode:Pm.bottom,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},r0={collapsedContentMode:Pm.scaleAspectFill,expandedContentMode:Pm.bottom,collapsedLayoutInsets:zQ,expandedLayoutInsets:zQ},o0={maxWidth:250,ltr:t0,rtl:t0,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},i0={maxWidth:704,ltr:n0,rtl:n0,collapsedSize:{type:MH,height:1.08}},s0={ltr:r0,rtl:r0},a0={objectPath:g$,cardArtLayoutMetrics:[o0,i0,s0],crops:["sr"],sourceWidth:800,sourceHeight:450,type:QV},c0={objectPath:g$,cardArtLayoutMetrics:[o0,i0,s0],crops:["nr"],sourceWidth:1280,sourceHeight:586,type:QV},l0={type:iq,width:1200,height:675},u0={top:-130,left:0,bottom:0,right:0},d0={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-16,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},f0={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:-116,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},h0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:-116,left:-70,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},p0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:-116,left:70,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},w0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},v0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},g0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},m0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:u0},y0={objectPath:"editorialVideo.universalAMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:d0,rtl:d0,collapsedSize:{type:iq,width:455,height:256},expandedSize:l0,priority:ny.Mini},{maxWidth:699,ltr:f0,rtl:f0,collapsedSize:{type:iq,width:1094,height:614},expandedSize:l0},{maxWidth:899,ltr:h0,rtl:p0,collapsedSize:{type:iq,width:1092,height:614},expandedSize:l0},{maxWidth:1090,ltr:w0,rtl:v0,collapsedSize:{type:iq,width:1392,height:783},expandedSize:l0},{ltr:g0,rtl:m0,collapsedSize:{type:iq,width:1600,height:900},expandedSize:l0}],crops:[QI],sourceWidth:1600,sourceHeight:900,type:Xq},A0={collapsedContentMode:Pm.top,collapsedLayoutInsets:{top:16,left:0,bottom:0,right:0},expandedContentMode:Pm.top,expandedLayoutInsets:zQ},T0={collapsedContentMode:Pm.scaleAspectFill,collapsedLayoutInsets:zQ,expandedContentMode:Pm.scaleAspectFill,expandedLayoutInsets:zQ},b0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:{top:0,left:-70,bottom:0,right:0},expandedContentMode:Pm.center,expandedLayoutInsets:zQ},S0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:{top:0,left:70,bottom:0,right:0},expandedContentMode:Pm.center,expandedLayoutInsets:zQ},P0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},C0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},I0={collapsedContentMode:Pm.topLeft,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},k0={collapsedContentMode:Pm.topRight,collapsedLayoutInsets:zQ,expandedContentMode:Pm.center,expandedLayoutInsets:zQ},O0={objectPath:"editorialArtwork.universalAStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:A0,rtl:A0,collapsedSize:{type:iq,width:455,height:256},priority:ny.Mini},{maxWidth:699,ltr:T0,rtl:T0},{maxWidth:899,ltr:b0,rtl:S0},{maxWidth:1090,ltr:P0,rtl:C0,collapsedSize:{type:iq,width:1400,height:527}},{ltr:I0,rtl:k0,collapsedSize:{type:iq,width:1600,height:604}}],crops:[QI],sourceWidth:1600,sourceHeight:604,type:QV}
class E0 extends UQ{constructor(e){super(Jy),this.$kind="TodayCardLockupListOverlay",this.lockups=e}}class D0 extends UQ{constructor(e){super("arcadeLockup"),this.$kind="TodayCardArcadeLockupOverlay",this.arcadeLockup=e}}class R0 extends Sz{constructor(e){super(),this.$kind="TabChangeAction",this.actionClass="TabChangeAction",this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class _0 extends Sz{constructor(e){super(),this.$kind="OpenGamesUIAction",this.actionClass="OpenGamesUIAction",this.target=e}}mm.Color.fromRGB(1,90/255,80/255)
const L0="isOnBoardingCard"
class M0 extends FQ{constructor(e,t,n,r,o){super(dV,t,n,r),this.$kind="TodayCardMediaBrandedSingleApp",this.icon=e,this.titleBackingGradient=o}bestBackgroundColor(){var e
return null!==(e=super.bestBackgroundColor())&&void 0!==e?e:this.icon.backgroundColor}}class F0 extends MQ{constructor(e){super(zB),this.$kind="TodayCardMediaAppIcon",this.icon=e}bestBackgroundColor(){return this.icon.backgroundColor}}class $0 extends MQ{constructor(e){super(BG),this.$kind="TodayCardInAppPurchase",this.lockup=e}bestBackgroundColor(){return this.lockup.icon.backgroundColor}}class x0 extends FQ{constructor(e,t,n,r,o,i){super(NO,t,n,r),this.$kind="TodayCardMediaList",this.lockups=e,this.marketingText=o,this.isMediaDark=i}}class N0 extends MQ{constructor(e){super(HL),this.$kind="TodayCardMediaRiver",this.lockups=e,this.lockupImpressionLimit=10}}const B0=new Set([Jm.Grid,Jm.List,Jm.NumberedList,Jm.River]),U0={AppEvent:ML,ContingentOffer:AO,OfferItem:FL}
class G0{constructor(e){this.promotionType=e}}class j0 extends G0{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(zm.ContingentOffer),this.$kind=AO,this.backgroundArtwork=e,this.isStreamlinedBuy=n,this.mediaOverlayStyle=t,this.titleFormatted=o,this.subtitle=i,this.additionalInfo=l,this.description=s,this.label=a,this.badge=c,this.offerLockup=d,this.trunkAppIcon=u,this.learnMoreTitle=r,this.clickAction=null}}class V0{constructor(e,t,n){this.$kind="Paragraph",this.text=e,this.mediaType=t||FH,this.style=n||rz,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class H0{constructor(e,t,n){this.periodDuration=e,this.periodCount=t,this.type=n}isEqualTo(e){return e.periodDuration===this.periodDuration&&e.periodCount===this.periodCount&&e.type===this.type}}class q0 extends G0{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(zm.OfferItem),this.$kind=FL,this.moduleArtwork=e,this.moduleVideo=t,this.isStreamlinedBuy=r,this.mediaOverlayStyle=n,this.titleFormatted=o,this.description=a,this.badge=c,this.offerLockup=d,this.subtitle=s,this.endDate=l,this.expiryDateFormatted=i,this.iapArtwork=u,this.clickAction=null}}class W0{constructor(e,t,n,r,o,i,s,a,c,l,u){this.$kind="AppEventNotificationConfig",this.appEventId=e,this.title=t,this.detail=n,this.artworkUrl=r,this.displayTime=o,this.scheduledAction=i,this.notAuthorizedAction=s,this.failureAction=a,this.destinationUrl=c,this.scheduleClickEvent=l,this.cancelScheduleClickEvent=u}}class z0 extends G0{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w){super(zm.AppEvent),this.$kind=ML,this.appEventId=e,this.moduleArtwork=t,this.moduleVideo=n,this.title=r,this.subtitle=o,this.detail=i,this.startDate=s,this.endDate=a,this.appEventBadgeKind=c,this.kind=l,this.requirements=u,this.lockup=d,this.hideLockupWhenNotInstalled=f,this.formattedDates=h,this.mediaOverlayStyle=p,this.includeBorderInDarkMode=w,this.clickAction=null}}!function(e){e.available="available",e.happening="happening",e.live="live"}(ry||(ry={}))
class Y0{constructor(e,t,n,r,o){this.$kind="AppEventFormattedDate",this.showLiveIndicator=e,this.displayFromDate=t,this.displayText=n,this.countdownToDate=r,this.countdownStringKey=o}}const J0="RoutableArticlePageIntent"
let K0=null
const Z0=[_V,lB,VH,JW,ij,AU,aG,cG],Q0=[_V,uB,VH,ij],X0=[_V,VH,JW,oj],e1=[_V,lB,VH,JW,ij,AU,aG,cG,uB,oj],t1=aG
let n1=null
const r1=[SW,LE,mM,yq,YN,OT,NV,yM,AM,nG,mV,TM,gH,ME,hV,FE,$E,hE,xE,"miniGamesDeepLink","gameDisplayName"],o1=/id([0-9]+)\/?$/i,i1={915249334:"1462947752"},s1=258,a1=261,c1=265,l1=304,u1=305,d1=311,f1=312,h1=414,p1=415,w1=416,v1=417,g1=418,m1=420,y1=421,A1=422,T1=423,b1=424,S1=425,P1=429,C1=430,I1=431,k1=437,O1=476,E1=495,D1=496,R1=497,_1=500,L1=501,M1=518,F1=548,$1=557,x1=584,N1=587,B1=566,U1=new Set([117,122,118,195,194,197,369,370,371,372,373,374,375,376,377,378,379,380,395,396,397,398,399,400,491,492,493,504,505,506,520,521,522,523,524,525,530,531,532,533,567,571]),G1=new Set([491,492,493]),j1=new Set([530,531,532,533]),V1=new Set([567,571]),H1=new Set([d1,f1,O1]),q1=new Set([...H1,M1]),W1=new Set([$1,g1,I1,P1,C1,m1,l1,u1,260,R1]),z1=new Set([413,h1,254,255,256,266,271,436])
class Y1{}class J1 extends Error{}class K1 extends Y1{constructor(e){super(),this.rawData=e,this.appId=null,this.groupId=null,this.score=0,this.segScores=new Map,this.modifiedScore=0,this.onDeviceScore=0}}class Z1 extends Y1{constructor(e){super(),this.rawData=e,this.isExactMatch=!1,this.isWildcardMatch=!1,this.isUnpersonalizedMatch=!1,this.isFallbackMatch=!1,this.appId=null,this.groupId=null,this.score=0,this.modifiedScore=0,this.onDeviceScore=0}}const Q1="-1",X1={contentsNotChanged:0,contentsFiltered:1,contentsSorted:2}
class e2{constructor(e,t){this.$kind="CondensedAdLockupWithIconBackground",this.lockup=e,this.backgroundArtwork=t}}class t2 extends MQ{constructor(e){super($$),this.$kind="TodayCardMediaSingleLockup",this.condensedAdLockupWithIconBackground=e}bestBackgroundColor(){var e
return null===(e=this.condensedAdLockupWithIconBackground)||void 0===e?void 0:e.backgroundArtwork.backgroundColor}get searchAdOpportunity(){return this.condensedAdLockupWithIconBackground.lockup.searchAdOpportunity}}class n2{constructor(e,t,n,r,o,i){this.$kind="MediumAdLockupWithScreenshotsBackground",this.lockup=e,this.screenshots=t,this.isAnimated=n,this.secondaryTextColor=r,this.backgroundColor=o,this.riverSpeed=i}}class r2 extends MQ{constructor(e){super("mediumLockupWithScreenshots"),this.$kind="TodayCardMediaMediumLockupWithScreenshots",this.mediumAdLockupWithScreenshotsBackground=e}get searchAdOpportunity(){return this.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity}}!function(e){e.EditorialItem="editorialItem",e.EditorialItemGroup="editorialItemGroup"}(oy||(oy={}))
class o2{constructor(e,t,n,r,o,s,a){this.missedOpportunityReasons={},this.placementType=t,this.placementId=(0,mm.isNothing)(t)?null:this.placementIdFromType(t),this.pageFields={},this.clickFields={},this.impressionsFields={},this.sharedImpressionsArrayFields={},this._adApplied=!1,this._adAdamId=void 0,this.positionInfo=a,this.slotInfo=n,this.setInitialAdData(e,r,o),i(s)&&(this.pageFields[WS]=s)}static from(e,t){var n,r,o,i
const s=new o2(e,f(t.placementType),l(t.slotInfo),null!==(n=f(t.iAdId))&&void 0!==n?n:void 0,null!==(r=f(t.appStoreClientRequestId))&&void 0!==r?r:void 0,null!==(o=g(t.wasOdmlSuccessful))&&void 0!==o?o:void 0,v(t.positionInfo))
return s._adApplied=u(t._adApplied),s._adAdamId=null!==(i=f(t._adAdamId))&&void 0!==i?i:void 0,Object.assign(s.pageFields,t.pageFields),Object.assign(s.clickFields,t.clickFields),Object.assign(s.impressionsFields,t.impressionsFields),Object.assign(s.sharedImpressionsArrayFields,t.sharedImpressionsArrayFields),s.updateContainerId(e,f(t.containerId)),s}static createInitialPageSlotInfos(e,t,n,r,o){var i
const s=an(e,t,!0,o),a=(0,mm.isNothing)(s)?[]:s.map(e=>e.slot),c=o2.containerIdFromType(e,t)
switch(t){case Vq:case cq:const t=null!==(i=null==n?void 0:n.slot)&&void 0!==i?i:0
return[{containerId:c,slots:[{slotId:`${c}_${t}`,slotIndex:t,hasAdData:!1}]}]
case nW:if(!nn(e))return null
0===a.length&&a.push(0)
const o=a.map(e=>({slotId:`${c}_${e}`,slotIndex:e,hasAdData:!1}))
return[{containerId:c,slots:o}]
case UW:const s={},l=(0,mm.isSome)(n)?n.slot-1:null
let u=!1
return a.forEach(e=>{var t
const n=u?e-1:e,o=null==r?void 0:r.find(e=>e.containedAdSlots.includes(n)),i=l===e,a=function(e,t,n){return(0,mm.isNothing)(n)?"0":n.type===oy.EditorialItemGroup?(!(n.containedAdSlots.length>1)||e===n.containedAdSlots[0]||n.containedAdSlots[n.containedAdSlots.length-1],"0"):"0"}(n,0,o),c=null!==(t=s[a])&&void 0!==t?t:{containerId:a,slots:[]}
s[a]=c
const d={slotId:`${a}_${e}`,slotIndex:e,hasAdData:!1}
c.slots.push(d),u=u||i}),Object.values(s)
default:return null}}get adIsPresent(){return this._adApplied}get adAdamId(){return this._adAdamId}updateForAdResponse(e,t){var n
r(t)||(this.placementType=t.placementType,this.placementId=this.placementIdFromType(this.placementType),this.positionInfo=null===(n=t.onDeviceAd)||void 0===n?void 0:n.positionInfo,this.setInitialAdData(e,t.iAdId,t.clientRequestId))}setInitialAdData(e,t,n){if((0,mm.isNothing)(n))return
const r=(0,mm.isNothing)(t)?"-1":t
switch(this.pageFields[wZ.hasIAdData]=!0,this.placementType){case UW:case Vq:case cq:case nW:if(on(e,this.placementType))break
this.impressionsFields[wZ.hasIAdData]=!0,this.clickFields[_F]=n,this.impressionsFields[_F]=n}if(rn(e,this.placementType)&&(this.pageFields[aR]=null,this.pageFields[cR]=null,this.pageFields[rV]=null,this.clickFields[aR]=null,this.clickFields[cR]=null,this.impressionsFields[xx]=null,this.impressionsFields[aR]=null,this.impressionsFields[cR]=null,this.impressionsFields[rV]=null),this.pageFields[_F]=n,this.pageFields[pj]=r,this.impressionsFields[pj]=r,this.clickFields[pj]=r,this.updateContainerId(e,null),this.updateSlotInfo(),(0,mm.isSome)(this.placementId)&&this.placementId.length>0)switch(this.pageFields[hj]=this.placementId,this.clickFields[hj]=this.placementId,this.impressionsFields[hj]=this.placementId,this.placementType){case UW:case Vq:case cq:case nW:if(on(e,this.placementType))break
this.sharedImpressionsArrayFields[hj]=this.placementId}}updateContainerId(e,t){this.placementType===UW?(this.containerId=null!=t?t:null,i(this.containerId)&&(this.clickFields[LU]=this.containerId,this.sharedImpressionsArrayFields[LU]=this.containerId)):(this.containerId=o2.containerIdFromType(e,this.placementType),i(this.containerId)&&(this.pageFields[LU]=this.containerId,this.clickFields[LU]=this.containerId))}containerIdForSlotIndex(e){if((0,mm.isNothing)(e)||(0,mm.isNothing)(this.slotInfo))return null
for(const t of this.slotInfo)for(const n of t.slots)if(n.slotIndex===e)return t.containerId
return this.containerId}apply(e,t){if((0,mm.isNothing)(t)||o(t))return
const n=t.id,r=B(t,Cj)
if(this._adAdamId=n,r){this.impressionsFields[wZ.hasIAdData]=!0,this.clickFields[wZ.hasIAdData]=!0
const o=kh(r[jx])
this.clickFields[xx]=o
const i=kh(r[lR])
this.clickFields[IF]=i,this.pageFields[EH]=n,this.pageFields.iAd={iAdFormat:Eh(v(m(r),"format")),iAdAlgoId:kh(r.algoId),iAdImpressionId:kh(r[jx]),iAdMetadata:kh(r[lR])}
const s=Ge(e,t)
this.updateIAdMetricsFieldsForProductVariantData(s,this.clickFields),this._adApplied=!0}this.updateSlotInfo()}applyClickFieldsFromPageRequest(e,t){this._adApplied=!0,this._adAdamId=e,Object.assign(this.clickFields,t),Object.keys(this.pageFields).forEach(e=>delete this.pageFields[e])}setSpecifiedCreativeUsed(e){this.clickFields[bS]=e}setTemplateType(e,t){this.placementType===nW&&nn(e)?this.sharedImpressionsArrayFields[rV]=t:(this.pageFields[rV]=t,this.impressionsFields[rV]=t),this.clickFields[rV]=t}recordLockupFromDataFailed(e,t,n){this.setMissedOpportunity(e,LF,t,n)}recordAdResponseEventsIfNeeded(e,t,n,r){if(!(0,mm.isNothing)(t)&&0!==t.length)switch(t){case WA:case tE:case"insufficientAssets":this.setMissedOpportunity(e,LF,n,r)
break
case"noAdAvailable":this.setMissedOpportunity(e,Vx,n,r)
break
case"timeout":this.setMissedOpportunity(e,"APSLA",n,r)
break
case zA:this.setMissedOpportunity(e,"NOLOC",n,r)
break
case"policyAdDrop":case"policyViolation":this.setMissedOpportunity(e,zS,n,r)}}setMissedOpportunity(e,t,n,r){var o,i,s
const a=null===(o=this.missedOpportunityReasons[n])||void 0===o?void 0:o[r]
if(!(0,mm.isSome)(a)){switch(null!==(i=(s=this.missedOpportunityReasons)[n])&&void 0!==i||(s[n]={}),this.missedOpportunityReasons[n][r]=t,this.clickFields[MF]=t,this.placementType){case UW:case Vq:case cq:break
default:if(rn(e,this.placementType))break
this.pageFields[MF]=t,this.impressionsFields[MF]=t}this.updateSlotInfo()}}missedOpportunityReason(e,t){var n
return null===(n=this.missedOpportunityReasons[e])||void 0===n?void 0:n[t]}setAdsClientDecisions(e,t,n){if(!(0,mm.isNothing)(this.slotInfo))for(const r of this.slotInfo)if(r.containerId===t)for(const t of r.slots)if(t.slotIndex===n)return void(t.adsClientDecisions=e)}placementIdFromType(e){switch(e){case dH:return YS
case nW:return tR
case UW:return JS
case Vq:return KS
case cq:return ZS
default:throw new Error(`This method should never be called with value: ${e}`)}}static placementTypeFromPlacementId(e,t){switch(t){case YS:return dH
case tR:return nW
case JS:return UW
case KS:return Vq
case ZS:return cq
default:return e.console.log(`Failed to get placementType from placementId ${t}. Defaulting to searchResults`),nW}}static containerIdFromType(e,t){switch(t){case Vq:return mj
case cq:return nE
case UW:return null
case nW:return nn(e)?"0":null
default:return null}}impressionsArrayFieldsForCurrentItem(e,t,n){if(this.placementType!==UW)return{}
const r=Qs(t,n)
return{iAdSlotId:`${this.containerIdForSlotIndex(r)}_${r}`}}get adjustedSlotIndex(){var e
const t=null===(e=this.positionInfo)||void 0===e?void 0:e.slot
return i(t)?t-1:null}updateSlotInfo(){var e,t
if(!(0,mm.isNothing)(this.slotInfo)){switch(this.placementType){case Vq:case cq:case nW:for(const t of this.slotInfo)for(const n of t.slots){if((0,mm.isSome)(t.containerId)){const r=null===(e=this.missedOpportunityReasons[t.containerId])||void 0===e?void 0:e[n.slotIndex];(0,mm.isSome)(r)&&(n.missedOpportunityReason=r)}n.hasAdData=this.adIsPresent&&(0,mm.isNothing)(n.missedOpportunityReason)}break
case UW:const n=this.adjustedSlotIndex
for(const e of this.slotInfo)for(const r of e.slots){const o=n===r.slotIndex,s=this.adIsPresent&&o
let a;(0,mm.isSome)(e.containerId)&&(a=null===(t=this.missedOpportunityReasons[e.containerId])||void 0===t?void 0:t[r.slotIndex],(0,mm.isSome)(a)&&(r.missedOpportunityReason=a)),!o&&i(n)&&(a=Vx),r.hasAdData=s,(0,mm.isSome)(a)&&(r.missedOpportunityReason=a)}}(0,mm.isSome)(this.slotInfo)&&this.slotInfo.length>0&&(this.pageFields[FF]=this.slotInfo,this.clickFields[FF]=this.slotInfo,this.impressionsFields[FF]=this.slotInfo)}}updateIAdMetricsFieldsForProductVariantData(e,t){(0,mm.isSome)(e)&&Ye(e,$F)?t[QS]=e.productPageId:delete t[QS]}updateIAdMetricsFieldsForAlignedRegion(e,t){}fastImpressionsEventVersion(e){switch(this.placementType){case Vq:case cq:case UW:return 5
case nW:return nn(e)?5:4
default:return 4}}shouldIncludeAdRotationFields(e){switch(this.placementType){case Vq:case cq:case UW:return!1
case dH:return!0
case nW:return!nn(e)
default:return!0}}shouldIncludeAdFieldsForPad(e){return!!e.client.isPad&&0===Object.keys(this.missedOpportunityReasons).length}}const i2="externalDeepLinkUrl",s2="isCppDeepLinkDisabled"
class a2{constructor(e){this.$kind="EditorsChoice",this.showsBadge=!1,this.title=void 0,this.notes=e,this.isCollapsed=!0}}class c2{constructor(e){this.componentType=kN,this.$kind="ProductRatingsAndReviewsMessage",this.messageText=e}}class l2{constructor(){this.$kind="ProductReviewAction"}}class u2{constructor(){this.$kind="ProductWriteAReview"}}class d2{constructor(){this.$kind="ProductReviewActions",this.componentType="productReviewActions"}}class f2{constructor(e,t=FH){this.$kind="StyledText",this.rawText=e,this.rawTextType=t}}class h2{constructor(e,t){this.$kind="LinkableText",this.styledText=e,this.linkedSubstrings=t}}const p2={11:"43",30:"44"},w2=KR,v2="ReviewsPage.ShelfId",g2=new Set([xW,LW,jW])
class m2{constructor(e,t,n){this.sectionType=e,this.shelfId=t,this.shelfBasedMappedIds=n}createProductPageSection(e){return g2.has(this.sectionType)?new hK(this.sectionType,void 0):new hK(this.sectionType,this.shelfId)}createShelfIdList(){return this.shelfBasedMappedIds||[this.shelfId]}}const y2=5,A2=5,T2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(pz,Uq),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,PV,xU,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],b2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(pz,Uq),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,jV,vj,Uj,TH,EG,DG]),new m2(pz,EG),new m2(pz,vj),new m2(pz,Uj),new m2(pz,DG),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],S2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(jW,jW),new m2(pz,SW),new m2(pz,Uq),new m2(pz,BH),new m2(pz,$q),new m2(pz,Iq),new m2(pz,_W,[zq,PV,TH]),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],P2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(jW,jW),new m2(pz,SW),new m2(pz,Uq),new m2(pz,BH),new m2(pz,$q),new m2(pz,Iq),new m2(pz,_W,[zq,jV,vj,Uj,TH]),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],C2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Qq),new m2(pz,Gj),new m2(pz,yj),new m2(pz,Uq),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,PV,xU,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq)],I2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,BU),new m2(pz,JH),new m2(pz,Qq),new m2(pz,Gj),new m2(pz,yj),new m2(pz,Uq),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,jV,vj,Uj,TH,EG,DG]),new m2(pz,EG),new m2(pz,vj),new m2(pz,Uj),new m2(pz,DG),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq)],k2=5,O2=5,E2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(pz,Uq),new m2(pz,UH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,PV,xU,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],D2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(pz,Uq),new m2(pz,UH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,jV,vj,Uj,TH,EG,DG]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],R2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,$q),new m2(pz,Iq),new m2(pz,_W,[zq,PV,TH]),new m2(pz,Uq),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],_2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,$q),new m2(pz,Iq),new m2(pz,_W,[zq,jV,vj,Uj,TH]),new m2(pz,Uq),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],L2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(pz,Qq),new m2(pz,Uq),new m2(pz,UH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,xU,PV,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq)],M2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,NU),new m2(pz,JH),new m2(pz,Qq),new m2(pz,Uq),new m2(pz,UH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,Iq),new m2(pz,_W,[zq,EG,jV,vj,Uj,TH,DG]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq)],F2=5,$2=5,x2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(pz,Uq),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,_W,[zq,xU,PV,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],N2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,JH),new m2(pz,Gj),new m2(pz,yj),new m2(jW,jW),new m2(pz,SW),new m2(pz,Uq),new m2(pz,BH),new m2(pz,$q),new m2(pz,_W,[zq,PV,TH]),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,VV),new m2(pz,kV),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Mq),new m2(pz,Qq)],B2=5,U2=5,G2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,JH),new m2(pz,Uq),new m2(pz,UH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,_W,[zq,PV,xU,TH]),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],j2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,Yq),new m2(pz,JH),new m2(jW,jW),new m2(pz,SW),new m2(pz,BH),new m2(pz,$q),new m2(pz,_W,[zq,PV,TH]),new m2(pz,Uq),new m2(pz,NW),new m2(pz,fW),new m2(pz,UH),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,aq),new m2(pz,Qq),new m2(pz,Mq)],V2=5,H2=5,q2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,$q),new m2(jW,jW),new m2(pz,Aj),new m2(pz,NW),new m2(pz,fW),new m2(pz,_G),new m2(pz,Mq),new m2(pz,Qq),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,PN)],W2=[new m2(xW,xW),new m2(LW,LW),new m2(jW,jW),new m2(pz,Aj),new m2(pz,$q),new m2(pz,RG),new m2(pz,NW),new m2(pz,fW),new m2(pz,Mq),new m2(pz,Qq),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,PN)],z2=5,Y2=5,J2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,$q),new m2(jW,jW),new m2(pz,Aj),new m2(pz,NW),new m2(pz,fW),new m2(pz,_G),new m2(pz,Qq),new m2(pz,Mq),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,PN)],K2=[new m2(xW,xW),new m2(LW,LW),new m2(jW,jW),new m2(pz,Aj),new m2(pz,$q),new m2(pz,RG),new m2(pz,NW),new m2(pz,fW),new m2(pz,Qq),new m2(pz,Mq),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,PN)],Z2=5,Q2=5,X2=[new m2(xW,xW),new m2(LW,LW),new m2(pz,JH),new m2(pz,$q),new m2(jW,jW),new m2(pz,Aj),new m2(pz,cN),new m2(pz,_G),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,Mq),new m2(pz,Qq)],e4=[new m2(xW,xW),new m2(LW,LW),new m2(pz,JH),new m2(jW,jW),new m2(pz,Aj),new m2(pz,$q),new m2(pz,cN),new m2(pz,RG),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,Mq),new m2(pz,Qq)],t4=5,n4=5,r4=[new m2(xW,xW),new m2(LW,LW),new m2(pz,JH),new m2(pz,NW),new m2(pz,fW),new m2(pz,$q),new m2(jW,jW),new m2(pz,Aj),new m2(pz,cN),new m2(pz,_G),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,eH),new m2(pz,oW),new m2(pz,Qq),new m2(pz,Mq)],o4=[new m2(xW,xW),new m2(LW,LW),new m2(pz,JH),new m2(jW,jW),new m2(pz,Aj),new m2(pz,$q),new m2(pz,cN),new m2(pz,RG),new m2(pz,NW),new m2(pz,fW),new m2(pz,tW),new m2(pz,Jq),new m2(pz,Fq),new m2(pz,Oq),new m2(pz,Lq),new m2(pz,kq),new m2(pz,DW),new m2(pz,cV),new m2(pz,oW),new m2(pz,Qq),new m2(pz,Mq)],i4=3,s4=3,a4=[new m2(xW,xW),new m2(LW,LW),new m2(pz,UH),new m2(jW,jW),new m2(pz,SW),new m2(pz,tW),new m2(pz,Jq),new m2(pz,_$)],c4=[new m2(xW,xW),new m2(LW,LW),new m2(jW,jW),new m2(pz,SW),new m2(pz,UH),new m2(pz,tW),new m2(pz,Jq),new m2(pz,_$)],l4=y2,u4=A2,d4=[...T2],f4=[...b2],h4=[...S2],p4=[...P2],w4=[...C2],v4=[...I2],g4=k2,m4=O2,y4=[...E2],A4=[...D2],T4=[...R2],b4=[..._2],S4=[...L2],P4=[...M2]
class C4{constructor(e,t,n=FH,r=null,o=null,i=null){this.$kind="FramedVideo",this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===SN?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class I4{constructor(e){this.$kind="ProductMediaGalleryPage",this.productMedia=e,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}const k4="product_media",O4=new Set([kq,Lq,Oq,NW,_$,Uq,Gj,yj,oW,SW,BH,aq,fW,kV,DW,Yq,cV,eH,Mq,UH,JH,Fq,tW,Jq,_W,Qq,VV,Aj,PN,$q])
class E4{constructor(e,t){this.$kind="ProductPageExpandedOfferDetails",this.title=e,this.subtitle=t}}class D4{constructor(e,t,n,r,o,i,s,a,c){this.$kind="Banner",this.message=e,this.focusedMessage=t,this.action=n,this.fullProductAction=r,this.leadingArtwork=o,this.leadingArtworkTintColor=i,this.includeBackgroundBorder=s,this.kind=a,this.hideCriteria=c}}class R4{constructor(e,t,n,r,o){this.$kind="AppStateBanner",this.unknownBanner=e,this.buyBanner=t,this.downloadBanner=n,this.updateBanner=r,this.openBanner=o}}const _4="notPurchasedOrdering"
class L4{constructor(e){this.$kind="Uber",this.style=e}isValidUber(e,t){function n(e){return null!=e&&0!==Object.keys(e).length}return n(this.artwork)||n(this.compactArtwork)||n(this.video)||n(this.compactVideo)||(e||t)&&n(this.iconArtwork)}}class M4 extends Sz{constructor(e){super(),this.$kind="SelectAppAction",this.actionClass="SelectAppAction",this.adamId=e}}class F4{constructor(e,t){this.$kind="DynamicUIRequestInfo",this.clientOptions=t,this.metricsOverlay={topic:e}}}class $4{constructor(){this.$kind="ArcadeDownloadPackCard"}}class x4{constructor(){this.$kind="Placeholder"}}class N4{constructor(e,t,n,r,o,i,s){this.genreId=e,this.title=t,this.ageBandId=n,this.segments=null!=r?r:[],this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0,this.$kind=null!=s?s:iA}}const B4={shelfIdentifier:"first",slot:0},U4="SLPPage",G4=Kq,j4="RoomPageIntent"
iy=e(8836)
class V4{constructor(e){this.builderClass=e}async handleShelf(e,t,n,r){throw new Error(`${this.builderClass} does not implement handleShelf`)}async handlePagination(e,t,n,r,o){throw new Error(`${this.builderClass} does not implement handlePagination`)}shelfRoute(e){return[{protocol:Cz,path:`${this.shelfPath}{data}`}]}paginationRoute(e){return[{protocol:Cz,path:`${this.paginationPath}`}]}shelfUrl(e){return`${Cz}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${_z.shelf}/`}get paginationUrl(){return`${Cz}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${_z.lookup}/`}static createFlowAction(e,t,n){const r=new _J(t)
return r.pageUrl=n.build(),r.pageData=e,r}}!function(e){e.Page="page",e.Shelf="shelf",e.Pagination="pagination"}(sy||(sy={}))
class H4 extends V4{defaultAttributes(e){return[]}defaultTab(e){return null}prepareRequest(e,t,n,r,o){t.includingAdditionalPlatforms(this.defaultPlatforms(e)),t.includingAttributes(this.defaultAttributes(e)),t.usingCustomAttributes(Ue(e))}defaultAction(e,t,n,r){return H4.createFlowAction(t,this.pageType(),r)}async handlePage(e,t,n,r,o){return await Za(`${this.builderClass}.handlePage`,async()=>{var r
let i
const s=t.build()
if(Gi(e,t)?i=new cJ(e,s):((0,mm.isSome)(o)&&(n[Hz.includeUnlistedApps]="1"),i=this.generatePageRequest(e,t,n)),!i)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,i,sy.Page,t,n),i.attributingTo(s)
const a=null!==(r=e.fetchTimingMetricsBuilder)&&void 0!==r?r:new iy.FetchTimingMetricsBuilder,c=void 0===e.fetchTimingMetricsBuilder?e.addingFetchTimingMetricsBuilder(a):e
let l
l=_(Ln(c,i)),l.then(t=>{wc(e,e.user.dsid,t)})
const u=this.generateAdditionalPageRequirements(e,t,n),d=await hc(e,l,u)
let f={originalData:d.primaryPageData}
this.supportsDataAugmenting()&&(f=await this.augmentData(c,t,n,d.primaryPageData))
const h=await a.measureModelConstructionAsync(async()=>await this.renderPage(c,f.originalData,n,d.additionalData,f.additionalData,o)),p=this.defaultTab(h),w=this.defaultAction(e,h,n,t),v=n[Hz.isPPT]
if(t.removeParam(Hz.isPPT),(0,mm.isNothing)(p)||v)return w
{const e=new R0(p)
return e.actions=[w],e}},async e=>await this.handlePageError(e,t,n))}async handlePageError(e,t,n){throw e}async handleShelf(e,t,n,r){return await Za(`${this.builderClass}.handleShelf`,async()=>{let r
const o=t.build()
if(r=Gi(e,t)?new cJ(e,o):this.generateShelfRequest(e,t,n),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,sy.Shelf,t,n),r.attributingTo(t.build())
const i=await Ln(e,r),s=await this.renderShelf(e,i,n)
return this.shelfRequiresAdditionalModification(s,n)?await this.performAdditionalShelfModifications(e,s,n):s},async e=>await this.handleShelfError(e,n))}async performAdditionalShelfModifications(e,t,n){return t}shelfRequiresAdditionalModification(e,t){return!1}async handleShelfError(e,t){throw e}async handlePagination(e,t,n,r,o){return await Za(`${this.builderClass}.handlePagination`,async()=>{let r
const i=t.build()
if(r=Gi(e,t)?new cJ(e,i):this.generatePaginationRequest(e,t,n,o),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,sy.Pagination,t,n),r.attributingTo(t.build())
const s=await Ln(e,r)
return await this.renderPaginatedPage(e,s,o)},async e=>await this.handlePaginationError(e,n,o))}async handlePaginationError(e,t,n){throw e}generateAdditionalPageRequirements(e,t,n){return{}}generateShelfRequest(e,t,n){throw new Error(`generateShelfRequest is not supported on: ${this.builderClass}`)}generatePaginationRequest(e,t,n,r){throw new Error(`generatePaginationRequest is not supported on: ${this.builderClass}`)}supportsDataAugmenting(){return!1}async augmentData(e,t,n,r){const o={url:t,parameters:n}
return await pc(e,r,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,o)}additionalDataKeysNeededForData(e,t,n){return null}fetchAdditionalDataForKey(e,t){return null}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async renderPaginatedPage(e,t,n){throw new Error(`renderPaginatedPage is not supported on: ${this.builderClass}`)}}ay=e(1974)
class q4{constructor(){this.profile=KW,this.maxPerPage=20}}class W4 extends H4{defaultAttributes(e){return dc(e)}defaultPlatforms(e){return ee(e)}pageType(){return fz}generatePaginationRequest(e,t,n,r){return new cJ(e,r.remainingContent)}async renderPaginatedPage(e,t,n){const r=n
return await this.pageWithContent(e,t,r)}async pageWithContent(e,t,n,r=!0){return await Za("pageWithContent",async()=>function(e,t,n,r=!0){var o
const i=n.preferredShelfContentType||G4,s=new pK(i),a={id:null,kind:null,softwareType:null,targetType:rW,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:sH,recoMetricsData:null!==(o=bt(t))&&void 0!==o?o:{}}
Jh(e,s,a),xh(0,a,n.title),s.isHorizontal=!1,s.shouldFilterApps=n.shouldFilter
const c=yt(t)
r&&(n.remainingContent=[]),s.items=Yd(e,c,{contentUnavailable:(e,t)=>(r&&(n.remainingContent=Ct(0,c,e)),!0),lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:uf(0,i)},shelfTokenId:n.id})
const l=new gK([s])
return n.remainingContent.length&&(l.nextPage=n),l}(e,t,n,r))}}class z4 extends W4{requestWithFilter(e,t,n){return new cJ(e).forType(az).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(t,n)}async renderPage(e,t,n,r){return await Za(CV,async()=>{const r=new q4
r.url=this.paginationUrl,r.metricsPageInformation=this.pageInformation(e,t,n),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const o=await this.pageWithContent(e,t,r)
return Vn(e,o,r.metricsPageInformation),o})}}const{routes:Y4,makeCanonicalUrl:J4}=mc(fc,"/room/{id}"),{routes:K4,makeCanonicalUrl:Z4}=yc(fc,"/{platform}/room/{id}"),Q4="top-paid",X4="top-free",e5="top-free-safari-extensions",t5="top-paid-safari-extensions",n5="top-trending-free",r5="top-trending-paid",o5="top-emerging-free",i5="top-emerging-paid",s5="top-selling"
class a5{constructor(e,t,n,r){this.$kind="GameCenterGameplayHistory",this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class c5{constructor(e,t){this.$kind="GameCenterGameplayHistoryRecord",this.playerId=e,this.timestamp=t}}class l5 extends Sz{constructor(e){super(),this.$kind="CrossfireReferralAction",this.actionClass="CrossfireReferralAction",this.referrerData=e}}class u5{supports(e,t,n,r){return this._supports(e,t,n,r)}_supports(e,t,n,r){const o=this.supportedFeaturedContentIds.has(n)
let s
return s=!i(r)||this.supportedNativeGroupingShelfIds.has(r),o&&s}createShelf(e,t,n,o,a){var c,l,u
const d=t,f=this.initialShelfDataFromGroupingMediaApiData(e,d),h=this.shelfTokenFromBaseTokenAndMediaApiData(e,d,o,n),p=this.shelfMetricsOptionsFromBaseMetricsOptions(e,h,a),w=s(p)
w&&this.shouldImpressShelf()&&xh(0,p,h.title),s(f.shelfContents)&&(f.shelfContents=wn(f.shelfContents,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(l=null==a?void 0:a.recoMetricsData)&&void 0!==l?l:{}))
const v=this._createShelf(e,h,f,n)
if(w&&this.shouldImpressShelf()&&(Bh(p.locationTracker),i(v)&&(Jh(e,v,p),(null===(u=v.url)||void 0===u?void 0:u.length)>0&&s(v.impressionMetrics)&&h.showingPlaceholders))){const e=v.url
try{const t=oY.from(e).pathComponents().pop(),n=JSON.parse(decodeURIComponent(t))
n.originalPlaceholderShelfImpressionMetrics=v.impressionMetrics,function(e,t,n){const o=oY.from(t.url),i=oY.from(ts(0,t,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,v,n)}catch{v.url=e}}return this.finalizeInitialShelfForDisplay(e,v,h,f,n),w&&this.shouldPrepareLocationTrackerForNextPosition()&&Vh(n.metricsLocationTracker),v}constructor(e){this.supportedFeaturedContentIds=new Set([]),this.supportedNativeGroupingShelfIds=new Set([]),this.builderClass=e}incompleteShelfFetchStrategy(e){return km.OnShelfWillAppear}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return n}shouldImpressShelf(){return!0}shouldPrepareLocationTrackerForNextPosition(){return!0}finalizeInitialShelfForDisplay(e,t,n,r,i){var a,c
if(o(t))return
n.isSearchLandingPage&&fs(0,t,n),(null===(a=t.url)||void 0===a?void 0:a.length)>0&&s(i.additionalShelfParameters)&&(t.url=oY.from(t.url).append(nV,i.additionalShelfParameters).build()),t.fetchStrategy=this.incompleteShelfFetchStrategy(e)
const l=(0,mm.isSome)(t)&&(null===(c=t.url)||void 0===c?void 0:c.length)>0
o(t.items)&&!l&&(t.isHidden=!0),t.accessibilityMetadata=Oc(e,t)}finalizeSecondaryShelfForDisplay(e,t,n,i){if(!o(t)){if(n.remainingItems.length){const t=n.remainingItems.map(e=>e.id)
e.console.warn("Could not load items for: "+t.join(","))}var a,c
if(t&&(t.mergeWhenFetched=((c=n).shelfStyle,!(c.showingPlaceholders||c.shelfStyle===oF||c.shelfStyle===OD&&(0,mm.isSome)(c.initialHydratedItems)&&c.initialHydratedItems.length>0)),t.networkTimingMetrics=i.responseTimingValues,t.nextPreferredContentRefreshDate=null==(a={timeToLive:null,nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:!1})?void 0:a.nextPreferredContentRefreshDate),s(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])
!n.hasExistingContent&&o(t.items)&&(t.isHidden=!0),n.isSearchLandingPage&&fs(0,t,n),t.accessibilityMetadata=Oc(e,t)}}async handleShelf(e,t,n,r){const o=n[JV],i=JSON.parse(o)
i.isFirstRender=!1
try{const r=await this.secondaryShelfDataForShelfUrl(e,t,i,n),o=this._createShelf(e,i,r,null)
return this.finalizeSecondaryShelfForDisplay(e,o,i,r),o}catch(e){if(i&&!i.hasExistingContent){const e=new pK(i.shelfStyle)
return e.isHidden=!0,e}throw e}}shelfRoute(e){return s(this.supportedNativeGroupingShelfIds)?function(e,t){const n=[]
for(const t of e)n.push(Ec(-1,t,void 0))
return n}(this.supportedNativeGroupingShelfIds):Dc(this.supportedFeaturedContentIds)}static async secondaryGroupingShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const r=function(e,t,n){var r
const o=(null===(r=t.relationshipToFetch)||void 0===r?void 0:r.length)>0
let i=yt(n)
if(o){const r={}
for(const e of n.data)r[e.id]=e
i=[]
for(const n of t.remainingItems){const o=pe(e,n,t.relationshipToFetch)
s(o)&&(n.relationships[t.relationshipToFetch].data=[r[o.id]]),i.push(n)}}return i}(e,n,t)
return{shelfContents:r,responseTimingValues:t[Wm.timingValues]}})}static async secondaryGroupingShelfMediaApiData(e,t,n,r){const o=t.build()
let i
return i=Gi(e,t)?new cJ(e,o):rs(e,n),i?(i.includingAdditionalPlatforms(function(e){return ee(e)}(e)),i.includingAttributes(function(e){const t=[RW,XH,tq,dG]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}(e)),i.usingCustomAttributes(Ue(e)),i.attributingTo(t.build()),await Ln(e,i).then(e=>(ns(n,i.ids),e))):await Promise.reject(new Error(`Could not construct media API request for: ${t}`))}}class d5 extends u5{constructor(){super("GroupingGameCenterPopularWithYourFriendsController"),this.batchGroupKey=kH,this.supportedFeaturedContentIds=new Set([E1])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterPopularWithYourFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.gameCenter.fetchGamesPopularWithFriends(this.gameCategoryFilter(n.gamesFilter),30)
return await o.then(async t=>{const n=t.map(e=>this.gameplayHistoryFromData(e)).sort((e,t)=>t.records.length-e.records.length).filter(t=>this.isCompatibleGameCenterPlatform(e,t.platformId)).map(e=>e.adamId)
if(0===n.length){const e={shelfContents:[]}
return await Promise.resolve(e)}const r=new cJ(e).withIdsOfType(n.slice(0,100),az).includingAgeRestrictions()
return os(e,r),await Ln(e,r,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Wm.timingValues]}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return km.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingPopularWithFriendsShelfForGrouping(e,n,t):this.popularWithFriendsShelfForGrouping(e,n,t)}pendingPopularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelfForGrouping(e,t,n),o=oY.from(es(n))
return r.url=o.param(Hz.isGameCenterPopularWithYourFriendsShelf,cW).build(),r}popularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelf(e,t.shelfContents,n)
return r.mergeWhenFetched=!0,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header.title=n.title,r.header.subtitle=n.subtitle,r}popularWithFriendsShelf(e,t,n){const r=n.shelfStyle||Kq,o=new pK(r)
o.isHorizontal=!0
const s=[]
for(let o=0;o<t.length;o++){const a=t[o],c={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(a),anonymizationOptions:{anonymizationString:`"GAME"${o+1}`}},artworkUseCase:uf(0,r),canDisplayArcadeOfferButton:ph(0,r),shouldHideArcadeHeader:e.featureFlags.isEnabled(bK)&&n.isArcadePage,shouldShowFriendsPlayingShowcase:!0},l=Xe(e,a,yU)
if(H(a,uW)||!l)continue
const u=Nd(e,a,c)
u.clickAction=Rc(e,u.clickAction),i(u)&&(s.push(u),Vh(c.metricsOptions.locationTracker))}let a
switch(e.client.deviceType){case ZW:a=2
break
case HW:case iz:case"tv":a=6
break
default:a=0}if(o.header=lo(e),s.length<a)return o.isHidden=!0,o
if(o.items=s.slice(0,12),o.isHidden=!1,o.batchGroup=kH,s.length>12){const t=new pK(Kq)
t.items=s,t.rowsPerColumn=1
const r=new gK([t])
r.title=n.title
const i=new _J(fz)
i.title=e.loc.string(nq),i.pageData=r,oa(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),gs(e,o,i)}return o.footerTitle=e.loc.string(Dx),o.footerAction=co({objectGraph:e,metricsLocationTracker:n.metricsLocationTracker,metricsPageInformation:n.metricsPageInformation}),o.footerStyle={$kind:qq,bundleID:TB,width:16,height:16},o}isCompatibleGameCenterPlatform(e,t){return 1===t}gameplayHistoryFromData(e){const t=f(e,EH),n=h(e,"platformId"),r=u(e,BD),o=this.gameplayHistoryRecordFromData(l(e,"records"))
return new a5(t,n,r,o)}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=f(e,"playerId"),n=h(e,"timestamp")
return new c5(t,n)})}gameCategoryFilter(e){return e===aF?ND:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:sH}}}const f5="7iDLtqb00",h5="7iDLtqb01",p5="7iDLtqb02"
!function(e){e.Control="Tf5Kjqz00",e.LayoutA="Tf5Kjqz01",e.LayoutB="Tf5Kjqz02"}(cy||(cy={}))
class w5 extends u5{constructor(){super("ArcadeDownloadPackShelfController"),this.shelfId="arcadeDownloadPackShelf",this.supportedFeaturedContentIds=new Set([B1])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isArcadeDownloadPackShelfPlaceholder]}]}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return _c(e,t,n,r)}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],categoriesContents:[],apps:[],title:""}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Am.isNothing)(o)||0===o.apps.length)return{shelfContents:[],categoriesContents:[],apps:[],title:""}
const i=o.apps,s=this.shelfTitle(e,tc(o.subscriptionStatus))
if((0,Am.isSome)(t.query[Hz.isArcadeDownloadPackShelfPlaceholder]))return{shelfContents:[],categoriesContents:[],apps:i,title:s}
const a=i.map(e=>e.adamId),c=i.map(e=>e.categoryId),l=az,u=YW,d=new cJ(e).addingQuery(`ids[${l}]`,Array.from(a).join(",")).addingQuery(`ids[${u}]`,Array.from(c).join(",")).includingAdditionalPlatforms(ee(e)).includingAttributes(Mi(e))
return await Ln(e,d).then(async e=>({shelfContents:e.data.filter(e=>e.type===l),categoriesContents:e.data.filter(e=>e.type===u),apps:i,title:s,responseTimingValues:e[Wm.timingValues]}))}_createShelf(e,t,n,r){if(t.isFirstRender){const n=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Am.isNothing)(n)||0===n.apps.length){const n=this.emptyShelfWithRefreshUrl(e)
return n.refreshUrl=this.shelfRefreshURL(t),Vh(r.metricsLocationTracker),n}{const o=this.placeholderShelf(e,t,n.apps,this.shelfTitle(e,tc(n.subscriptionStatus)))
return Vh(r.metricsLocationTracker),o}}if(n.apps.length>0&&((0,Am.isNothing)(n.shelfContents)||0===n.shelfContents.length))return this.placeholderShelf(e,t,n.apps,n.title)
{const r=this.shelfMetrics(n.title,t)
xh(0,r,n.title)
const o=this.downloadPackShelf(e,t,n)
return o.refreshUrl=this.shelfRefreshURL(t),Bh(t.metricsLocationTracker),Jh(e,o,r),o}}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return null}emptyShelfWithRefreshUrl(e){const t=new pK(this.useCustomDownloadPackCardShelf(e)?oF:mW)
return t.id=this.shelfId,t.isHidden=!0,t}placeholderShelf(e,t,n,r){const o=this.useCustomDownloadPackCardShelf(e)?this.downloadPackCardPlaceholderShelf(e,t,n.length):this.smallLockupsPlaceholderShelf(e,t,n)
return o.url=oY.from(es(t)).build(),o.title=r,o}downloadPackCardPlaceholderShelf(e,t,n){const r=new pK(oF)
r.id=this.shelfId
const o=new $4
return o.numberOfPlaceholders=n,r.items=[o],t.shelfStyle=r.contentType,r}smallLockupsPlaceholderShelf(e,t,n){const r=new pK(mW)
return r.id=this.shelfId,r.items=[],r.isHorizontal=!0,r.rowsPerColumn=2,r.items=Array(n.length).fill(new x4),r.placeholderContentType=r.contentType,r.contentType=gB,t.showingPlaceholders=!0,t.remainingItems=n.map(e=>({id:e.adamId,type:az})),r}downloadPackShelf(e,t,n){const r=this.categoriesMapFromResponse(e,n.categoriesContents,n.apps),o=this.useCustomDownloadPackCardShelf(e),i=o?oF:mW,s=this.lockupsFromResponse(e,t,r,o,Fc(e)===h5,o,uf(0,i),(0,Am.isSome)(n.shelfContents)?n.shelfContents:[],n.apps),a=new pK(i)
if(a.id=this.shelfId,a.title=n.title,o){const t=new $4
t.lockups=s,t.lockupStyle=$c(e),a.items=[t]}else a.items=s,a.isHorizontal=!0,a.rowsPerColumn=2
return a.isHidden=0===s.length,a}useCustomDownloadPackCardShelf(e){return e.client.isPhone}shelfRefreshURL(e){return oY.from(es(e)).param(Hz.isArcadeDownloadPackShelfPlaceholder,cW).build()}lockupsFromResponse(e,t,n,r,o,i,s,a,c){return ym.context("lockupsFromResponse",()=>{const l=new Map
for(const e of a)l.set(e.id,e)
const u=t.metricsLocationTracker,d=t.metricsPageInformation,f=[]
for(const t of c){const a=l.get(t.adamId)
if((0,Am.isNothing)(a))continue
const c=Nd(e,a,{offerStyle:i?wV:void 0,offerEnvironment:i?MW:void 0,metricsOptions:{pageInformation:d,locationTracker:u,badges:{categoryId:t.categoryId}},metricsClickOptions:{id:a.id,pageInformation:d,locationTracker:u,badges:{categoryId:t.categoryId}},artworkUseCase:s,shouldHideArcadeHeader:!0,isSubtitleHidden:!o});(0,Am.isNothing)(c)||(cf(c,e),Vh(u),r?(c.heading=n.get(c.adamId),c.heading===c.subtitle&&(c.subtitle=c.editorialTagline)):o||(c.subtitle=n.get(c.adamId)),f.push(c))}return f})}categoriesMapFromResponse(e,t,n){const r=new Map
for(const o of n){const n=t.find(e=>e.id===o.categoryId)
if(!n)continue
const i=ah(e,n,cz);(0,Am.isSome)(i)&&r.set(o.adamId,i.trim())}return r}shelfTitle(e,t){return e.loc.string(t===WB?"Arcade.DownloadPack.ShelfTitle.NewUser":"Arcade.DownloadPack.ShelfTitle")}shelfMetrics(e,t){return{id:t.id,kind:null,softwareType:dW,targetType:rW,title:e,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sH,fcKind:t.featuredContentId}}}class v5 extends u5{constructor(){super("GroupingAppEventShelfController"),this.supportedFeaturedContentIds=new Set([519,M1])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
if(!((null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0)){const t=[],r=[],o=[]
for(const e of n.remainingItems)switch(e.type){case fH:r.push(e)
break
case $H:o.push(e)
break
case tz:t.push(e)}const i=new cJ(e,t)
Je(e,i,t)
const s=new cJ(e,r)
Je(e,s,r)
const a=new cJ(e,o)
Je(e,a,o)
const c=await Promise.all([this.fetchRemainingItems(e,i),this.fetchRemainingItems(e,s),this.fetchRemainingItems(e,a)]),l={...c[0],...c[1],...c[2]},u=[]
for(const e of n.remainingItems){const t=l[e.id];(0,mm.isSome)(t)&&u.push(t)}return ns(n,new Set([...a.ids,...s.ids,...i.ids])),{shelfContents:u}}try{const o=await u5.secondaryGroupingShelfMediaApiData(e,t,n,r),s=mt(e,o),a=this.initialShelfDataFromGroupingMediaApiData(e,s)
a.responseTimingValues=o[Wm.timingValues]
const c=j(s,Xi(0,n.featuredContentId))
return i(c)&&(null==c?void 0:c.length)>0&&(a.shelfTitle=c),a}catch{return{shelfContents:[]}}}async fetchRemainingItems(e,t){const n={}
if(t.ids.size>0){os(e,t)
try{await Ln(e,t).then(e=>{(e=>{for(const t of e.data)n[t.id]=t})(e)})}catch(n){e.console.error("Error fetching remaining items",t.ids)}}return n}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=n.featuredContentId===M1
let i=null
const a=this.initialShelfDataFromGroupingMediaApiData(e,t)
o&&s(a.shelfContents)&&(i=this.personalizedDataResultFromDataItems(e,a.shelfContents))
const c={...n,shouldPersonalizeData:o,personalizedDataResult:i},l=s(a.shelfContents),u=!H(t,Yb)
return!l&&u?(c.recommendationsHref=t.href,c.isValidRecommendationsShelf=!0):c.isValidRecommendationsShelf=l,c}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(s(t.personalizedDataResult)){const e=Mh(n.recoMetricsData,t.personalizedDataResult.processingType,null)
r.recoMetricsData=e}return r}_createShelf(e,t,n,i){var a
if(!li(e))return null
if(!t.isValidRecommendationsShelf)return null
const c={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:t.metricsPageInformation.recoMetricsData}
let l=n.shelfContents
s(t.personalizedDataResult)&&t.isFirstRender&&(l=t.personalizedDataResult.personalizedData)
const u=[]
for(const e of l)r(e.attributes)||Qi(t)?(t.isDeferring=!0,t.remainingItems.push(e)):u.push(e)
const d=mi(e,u,null,!1,!1,c,!1,!0,t.isArcadePage,!1)
Vr(d.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const f=d.appPromotions,h=new pK(sE)
return h.isHorizontal=!0,h.title=null!==(a=n.shelfTitle)&&void 0!==a?a:t.title,h.items=f,o(h.items)&&t.isFirstRender&&cc(e,h,t,t.featuredContentId),h.url=ts(0,h,t),o(h.items)&&o(h.url)?t.isFirstRender?null:v5.makeHiddenShelf(t):h}personalizedDataResultFromDataItems(e,t){const n=new Set
for(const e of t){const t=f(e,wG);(null==t?void 0:t.length)>0&&n.add(t)}const r=ks(e,n)
return Cs(e,Jb,t,!1,r,null,null,null,!0)}static makeHiddenShelf(e){const t=new pK(e.shelfStyle)
return t.isHidden=!0,t}}class g5{constructor(){this.$kind="ArcadeFooter"}}class m5{constructor(e){this.$kind="Footnote",this.text=e,this.presentationStyle=[],this.clickAction=null}}class y5 extends u5{constructor(){super("GroupingArcadeFooterShelfController"),this.supportedFeaturedContentIds=new Set([-1]),this.supportedNativeGroupingShelfIds=new Set([1])}shouldImpressShelf(){return!1}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Tt(t),responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=fo(e,this.numberOfIconsForArcadeAppGrid(e.client.deviceType))
return await Ln(e,o).then(t=>{const n=this.initialShelfDataFromGroupingMediaApiData(e,t)
return n.responseTimingValues=t[Wm.timingValues],n})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldIncludeShelfUrl:n.isFirstRender}
return o.showingPlaceholders=n.isFirstRender,o}_createShelf(e,t,n,o){const i=new g5,a=new pK(gD)
a.items=[i]
const c={targetType:xb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(ex),id:t.id,kind:CD,softwareType:dW}
Jh(e,i,c),xh(0,c,c.title),i.buttonAction=io(e,XU,t.metricsPageInformation,t.metricsLocationTracker)
const l={targetType:lz,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:i.buttonAction.title,id:nT,kind:lz,softwareType:dW}
Jh(e,i.buttonAction,l),Bh(c.locationTracker)
const u=e.bag.termsAndConditionsURL
if(!r(u)&&"tv"!==e.client.deviceType){const t=e.loc.string(ID),n=new HJ(u),r=new m5(t)
r.clickAction=n,r.presentationStyle=[zM,YM,JM],i.footnote=r}if(a.background={type:wH,color:Se(zE)},s(n.shelfContents)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
i.icons=hf(e,n.shelfContents,r,{useCase:R3.LockupIconMedium})}else i.icons=[]
return t.shouldIncludeShelfUrl&&(a.url=es(t)),a}numberOfIconsForArcadeAppGrid(e){return e===ZW?9:20}}class A5{constructor(){this.$kind="Brick",this.artworks=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=wW,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null,this.editorialDisplayOptions={},this.artworkSafeArea=null,this.textSafeArea=null}isValid(){var e,t,n,r
const o=null!==(t=null===(e=this.artworks)||void 0===e?void 0:e.every((e,t)=>(0,mm.isSome)(e)&&e.isValid()))&&void 0!==t&&t,i=(null!==(r=null===(n=this.collectionIcons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0,s=(0,mm.isSome)(this.backgroundColor)
return(0,mm.isSome)(this.clickAction)&&(o||i||s)}}!function(e){e.TopRight="topRight",e.TopLeft="topLeft",e.MiddleLeft="middleLeft"}(ly||(ly={})),function(e){e.SquareByWidth="squareByWidth",e.SquareByHeight="squareByHeight",e.FreeForm="freeForm"}(uy||(uy={}))
class T5{constructor(e,t,n,r,o){this.width=e,this.height=t,this.asRatioOfSize=null!=n&&n,this.location=r,this.constraint=o}}T5.defaultTileArtworkSafeArea={width:.3,height:.4,asRatioOfSize:!0,constraint:uy.SquareByWidth,location:{relativeLocation:ly.TopRight}},T5.defaultThreeLineTileArtworkSafeArea={...T5.defaultTileArtworkSafeArea,width:.3},T5.defaultPillArtworkSafeArea={width:.28,height:1,asRatioOfSize:!0,constraint:uy.FreeForm,location:{relativeLocation:ly.MiddleLeft}},T5.defaultTileTextSafeArea={width:.15,height:0,asRatioOfSize:!0},T5.defaultPillTextSafeArea={width:.28,height:0,asRatioOfSize:!0}
class b5 extends u5{constructor(){super("GroupingBrickShelfController"),this.supportedFeaturedContentIds=new Set([y1,A1,T1,a1])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,QH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(e=>({shelfContents:ds(e.shelfContents,we(n.featuredContentData,QH))}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,Kb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Gr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,Aq)===Bq
let d
if(l){d=new pK(Ex)
const n=h(t.featuredContentData.attributes,Zb)
d.rowsPerColumn=null!=n?n:Z(e),Gh(t.metricsLocationTracker).name=MD}else d=new pK(sj)
d.isHorizontal=!0
for(const n of r.shelfContents){const r=b5.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s)
r?(a.push(r),Vh(t.metricsLocationTracker)):c.push(n)}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[QH].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,iF)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const p=u(t.featuredContentData.attributes,FD)
if(l&&p){const n=new pK(Ex)
n.items=this.sortCategories(e,a),n.presentationHints={isSeeAllContext:!0}
const r=new gK([n])
r.title=t.title
const o=new _J(fz)
o.title=e.loc.string(nq),o.pageData=r,d.seeAllAction=o,oa(e,o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}const w=d&&o(d.items)&&t.isFirstRender
if(w&&cc(e,d,t,t.featuredContentId),!w&&b5.shouldDisplayChooseYourFavoritesBrick(e,t,l,s)){const n=b5.createChooseYourFavoritesBrick(e,t.metricsPageInformation,t.metricsLocationTracker)
d.items.splice(0,0,n)}return t.presentationHints=d.presentationHints,d.url=ts(0,d,t),d}static shouldDisplayChooseYourFavoritesBrick(e,t,n,r){return t.isArcadePage&&n&&e.featureFlags.isEnabled(RK)&&(0,mm.isSome)(null==r?void 0:r.additionalShelfParameters)&&((null==r?void 0:r.additionalShelfParameters.isSubscribed)===cW||(null==r?void 0:r.additionalShelfParameters.isTrialEnrolled)===cW)}static createBrick(e,t,n,r,o,s,a){const c={targetType:n?LV:sj,pageInformation:r,locationTracker:o,recoMetricsData:bt(t)},l=ls(e,t,s,!1,null,c,a)
if(!l)return null
const u=new A5,d={useCase:R3.GroupingBrick}
if(n){const t=pf(e,l.content,hy.categoryBreakout,Sm.Density1)
u.artworks=t}else if(l.artwork&&(null==s?void 0:s.featuredContentId)!==a1){let t=p(l.artwork,HM)
t||(t=p(l.artwork,"originalFlowcaseBrick"))
const n=ss(e,t,d)
u.artworks=[n]}else{const n=as(e,t,1060,520,d)
u.artworks=[n]}u.accessibilityLabel=l.title,u.shortEditorialDescription=l.title,u.clickAction=l.action,435===q(t,xV)&&(u.personalizationStyle=AB)
const f=pe(e,t,sz)
if(i(f)){const n=ea(e,f,c)
u.flowPreviewActionsConfiguration=la(e,t,!0,null==s?void 0:s.clientIdentifierOverride,u.clickAction,c,n)}return Jh(e,u,ep(e,t,l.title,c)),u.artworkSafeArea=T5.defaultTileArtworkSafeArea,u.textSafeArea=T5.defaultTileTextSafeArea,u.isValid()?u:null}static createChooseYourFavoritesBrick(e,t,n){const r=new A5,o=new dY("",1060,520,[],ye("efac78"))
r.artworks=[o]
const i=e.loc.string("ARCADE_CHOOSE_YOUR_FAVORITES_BRICK_TITLE")
r.accessibilityLabel=i,r.shortEditorialDescription=i
const s=new _J(lU)
var a
return s.presentationContext=$V,s.pageData=GW,r.clickAction=s,Jh(e,r,(a={targetType:sj,pageInformation:t,locationTracker:n,recoMetricsData:null},ym.context("impressionOptionsForArcadeChooseYourFavoritesBrick",()=>({...a,id:"",kind:null,softwareType:null,title:"choose_your_games_brick"})))),r.artworkSafeArea=T5.defaultTileArtworkSafeArea,r.textSafeArea=T5.defaultTileTextSafeArea,r}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,Aq)===Bq&&(r.title=MD),r}sortCategories(e,t){return t.sort((t,n)=>{try{return t.shortEditorialDescription.localeCompare(n.shortEditorialDescription,e.loc.safeIdentifier,{usage:jH})}catch(e){return 0}})}}class S5 extends u5{constructor(){super("GroupingCategoryShelfController"),this.supportedFeaturedContentIds=new Set([S1])}initialShelfDataFromGroupingMediaApiData(e,t){const n=pe(e,t,QH)
return n?{shelfContents:we(n,QH)}:{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(t=>{const r=pe(e,n.featuredContentData,QH)
return r?{shelfContents:ds(t.shelfContents,we(r,QH))}:{shelfContents:[]}})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,i){var a
if(o(n.shelfContents))return null
const c=[]
let l=!1
for(const o of n.shelfContents){const n=pe(e,o,BV)
if(r(n))continue
const a=ps(0,n)
if(r(o.attributes)||r(n.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const d={targetType:Fj,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(o)},f=Jd(e,n,{...d,id:a},t.clientIdentifierOverride)
Jh(e,f,{...d,kind:EW,softwareType:u(null==i?void 0:i.isArcadePage)?dW:null,title:f.title,id:a})
const h=B(n,XW)
h.width>h.height&&(l=!0),s(h)&&(f.artwork=df(e,h,{allowingTransparency:!0,useCase:R3.CategoryIcon})),c.push(f),Vh(t.metricsLocationTracker)}const d=this.shelfForCategoryActions(e,c,t)
if(d.title=t.title,d.subtitle=t.subtitle,d.url=ts(0,d,t),l){const e=null!==(a=d.presentationHints)&&void 0!==a?a:{}
d.presentationHints={...e,itemsHaveRectangularArtwork:!0}}return d}shelfForCategoryActions(e,t,n){const r=new pK(aW)
let o
switch(e.client.deviceType){case"tv":r.isHorizontal=!0,o=8
break
case iz:r.isHorizontal=!1,o=null
break
case bH:r.isHorizontal=!0,r.rowsPerColumn=3,o=24
break
default:r.isHorizontal=!1,o=6}if((0,mm.isSome)(o)&&t.length>o){r.items=t.slice(0,o)
const i=new _J(fz)
i.title=e.loc.string(nq),oa(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),r.seeAllAction=i
const s=new pK(aW)
s.isHorizontal=!1,this.sortCategories(e,t),s.items=t
const a=new gK([s])
a.title=e.loc.string("PAGE_TITLE_CATEGORIES"),i.pageData=a}else r.items=t
return r}sortCategories(e,t){t.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:jH})}catch(e){return 0}})}}class P5{constructor(){this.$kind="EditorialCard",this.adamId=void 0,this.caption=null,this.title=void 0,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.decorations=[],this.flowPreviewActionsConfiguration=null,this.appEventFormattedDates=null,this.mediaOverlayStyle=null}isValid(){return!!(this.clickAction&&this.artwork&&this.artwork.isValid()&&this.caption&&this.title)}}class C5 extends u5{constructor(){super("GroupingEditorialCardShelfController"),this.supportedFeaturedContentIds=new Set([p1,w1,L1,v1,s1])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,QH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){const i=new pK(Hb)
i.isHorizontal=!0
const s=this.personalizationDataContainerForEditorialCardItemsDataArray(e,n.shelfContents),a=[]
for(const i of n.shelfContents){const n=C5.makeEditorialCard(e,i,s,r,t)
!o(n)&&n.isValid()&&(a.push(n),Vh(t.metricsLocationTracker))}return delete t.maxItemCount,i.items=a,i.url=ts(0,i,t),i}static makeEditorialCard(e,t,n,o,s){var a,c,l
const u={targetType:UG,pageInformation:null==s?void 0:s.metricsPageInformation,locationTracker:null==s?void 0:s.metricsLocationTracker,recoMetricsData:bt(t),id:t.id,idType:pG},d=q(t,xV),h=ls(e,t,s,d===L1,n,u,o,()=>{null==s||s.remainingItems.push(t)})
if(!h)return null;(null===(c=null===(a=h.content)||void 0===a?void 0:a.id)||void 0===c?void 0:c.length)>0&&(u.id=h.content.id,u.idType=yW,u.adamId=h.content.id)
const w=new P5
let v=j(t,"designBadge")
v||(v=h.caption),w.caption=v
let g=j(t,FW)
g||(g=h.title),w.title=g
let m=ws(j(t,$D))
m||(m=h.subtitle),w.subtitle=m
const y={useCase:R3.GroupingHero,withJoeColorPlaceholder:!0}
if(h.artwork&&(null==s?void 0:s.featuredContentId)!==s1){let t=p(h.artwork,HM)
r(t)&&i(h.appEvent)&&(t=p(h.artwork,"eventCard")),w.artwork=ss(e,t,y)}else w.artwork=as(e,t,416,204,y)
if(w.clickAction=h.action,i(h.appEvent)&&(w.appEventFormattedDates=h.appEvent.formattedDates),w.lockup=h.lockup,i(w.artwork)&&i(w.artwork.backgroundColor)){const e=be(w.artwork.backgroundColor)
if(w.mediaOverlayStyle=e?MW:iW,i(w.lockup)&&i(w.lockup.offerDisplayProperties)){const t=e?MW:iW
w.lockup.offerDisplayProperties=w.lockup.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,wV,t)}}w.adamId=f(h.content,"id")
const A=pe(e,t,sz)
if(i(A)){const n=ea(e,A,u)
n.targetType=u.targetType,w.flowPreviewActionsConfiguration=la(e,t,!1,null==s?void 0:s.clientIdentifierOverride,w.clickAction,u,n)}const T=ep(e,null!==(l=h.content)&&void 0!==l?l:t,h.title,u)
if(i(h.onDevicePersonalizationDataProcessingType)){const e=Mh(T.recoMetricsData,h.onDevicePersonalizationDataProcessingType,null)
T.recoMetricsData=e}return i(h.appEvent)&&(T.inAppEventId=h.appEvent.appEventId,i(h.appEvent.lockup)&&(T.relatedSubjectIds=[h.appEvent.lockup.adamId])),i(s)&&Jh(e,w,T),w}personalizationDataContainerForEditorialCardItemsDataArray(e,t){var n,r
if(!Is(e))return null
const o=new Set
for(const e of t){const t=q(e,xV)===L1,i=(null===(n=f(e,BW))||void 0===n?void 0:n.length)>0,s=(null===(r=j(e,Qb))||void 0===r?void 0:r.length)>0,a=de(e,sz,!1)
if(t&&!i&&!s&&a){const t=we(e,sz)
for(const e of t){const t=f(e,wG);(null==t?void 0:t.length)>0&&o.add(t)}}}return ks(e,o)}}class I5{constructor(e,t,n,r,o,i,s){this.$kind="EditorialStoryCard",this.title=e,this.artwork=t,this.video=n,this.heading=r,this.badge=o,this.description=i,this.clickAction=s,this.shelfBackground=null,this.collectionIcons=null,this.editorialDisplayOptions={}}}class k5 extends u5{constructor(){super("GroupingEditorialStoryCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}shelfRoute(e){return Dc(this.supportedFeaturedContentIds,["shelfContentType=editorialStoryCard"])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&hs(0,j(t,Aq))===xD}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,QH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,Aq)
return o.shelfStyle=hs(0,i),o}_createShelf(e,t,n,r){const i=[]
for(const r of n.shelfContents){if(!W(r)||Qi(t)){t.remainingItems.push(r),t.isDeferring=!0
continue}const n=k5.makeStoryCard(e,r,t)
o(n)||(i.push(n),Vh(t.metricsLocationTracker))}const s=new pK(t.shelfStyle)
return s.title=t.title,s.items=i,s.isHorizontal=!0,s.background={type:qM},s.url=ts(0,s,t),s.isHorizontal=!0,s}static makeStoryCard(e,t,n){let s=B(t,"editorialArtwork.subscriptionHero")
o(s)&&(s=B(t,sF))
const a=df(e,s,{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:R3.TodaySmallStoryCard})
if(r(a))return null
const c=j(t,oH),l=j(t,Gq),u=j(t,AD),d=new I5(c,a,null,l,{type:WH,title:l},u),f=To(e,t,null,new qQ(null==n?void 0:n.metricsPageInformation,null==n?void 0:n.metricsLocationTracker))
i(f)&&(d.clickAction=f.clickAction)
const h=be(a.backgroundColor)?MW:iW
return d.shelfBackground={type:XW,artwork:a,style:h},d}}class O5 extends Sz{constructor(){super(...arguments),this.$kind="GameCenterDashboardAction",this.actionClass="GameCenterDashboardAction"}}class E5 extends u5{constructor(){super("GroupingGameCenterActivityFeedController"),this.batchGroupKey=kH,this.supportedFeaturedContentIds=new Set([F1])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterActivityFeedShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],activities:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=this.gameCategoryFilter(n.gamesFilter)
return await e.gameCenter.fetchActivityFeedCards(o,20).then(e=>({shelfContents:[],activities:e}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return km.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingActivityFeedShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.activityFeedShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingActivityFeedShelfForGrouping(e,t,n){if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
const r=this.activityFeedShelfForGrouping(e,{shelfContents:[],activities:[]},t,n),o=oY.from(es(t))
return r.url=o.param(Hz.isGameCenterActivityFeedShelf,cW).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}activityFeedShelfForGrouping(e,t,n,r){if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
const o=this.activityFeedShelf(e,t.activities,n,r),i=e.loc.string("Arcade.ActivityFeed.RecentActivity")
return o.header=lo(e,i),gs(e,o,o.seeAllAction),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o}activityFeedShelf(e,t,n,r=!1){const o=new pK("gameCenterActivityFeedCard")
let i
return o.isHorizontal=!0,o.mergeWhenFetched=!0,o.batchGroup=this.batchGroupKey,o.items=t,o.isHidden=0===o.items.length,t.forEach((t,o)=>{const i={id:"friendActivity",idType:ez,targetType:"chiclet",kind:null,softwareType:r?dW:null,title:"",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}
Jh(e,t,i)
const s=new mz,a=new mz,c=new mz,l=new mz,u=new mz;[{targetId:"playerName",metrics:s},{targetId:"profileImage",metrics:a},{targetId:"leaderboardAchievement",metrics:c},{targetId:NH,metrics:l},{targetId:t.adamID||"gameIcon",metrics:u}].forEach(t=>function(e,t,n,r,o){const i={actionType:dz,id:r,idType:ez,location:$h(0,o,n)},s=_t(e,r,EW,i)
t.addMetricsData(s)}(e,t.metrics,n.title,t.targetId,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),t.profileActionMetrics=s,t.profileAvatarActionMetrics=a,t.leaderboardActionMetrics=c,t.achievementActionMetrics=l,t.appActionMetrics=u,Vh(n.metricsLocationTracker)}),e.featureFlags.isGSEUIEnabled(BK)||(i=new O5,i.title=e.loc.string("Arcade.ActivityFeed.AllActivity",e.loc.string(nq)),oa(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),o.seeAllAction=i,o}gameCategoryFilter(e){return e===aF?ND:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,title:"Friend Activity",badges:{gameCenter:!0},idType:$b}}}class D5{constructor(){this.$kind="VideoCard",this.flowPreviewActionsConfiguration=null}}class R5 extends u5{constructor(){super("GroupingGameCenterContinuePlayingShelfController"),this.batchGroupKey="gameCenterContinuePlaying",this.supportedFeaturedContentIds=new Set([_1])}_supports(e,t,n,r){return super._supports(e,t,n,r)&&this.supportsVideoCardShelf(e,e.host.platform)}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterContinuePlayingShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=Date.now(),i=this.maximumNumberOfRecentGamesToRequest(),s=e.gameCenter.fetchRecentlyPlayedGamesWithinSeconds(this.gameCategoryFilter(n.gamesFilter),i,e.bag.recentlyPlayedGamesWindowInSeconds)
return await s.then(async t=>{const n=Date.now()
let r
if(e.console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-o).toString(10)+" milliseconds."),0===t.length){const e={shelfContents:[]}
return await Promise.resolve(e)}{const n=new cJ(e).withIdsOfType(t.slice(0,this.maximumNumberOfRecentGamesToShow()),az).includingAgeRestrictions()
os(e,n),r=Ln(e,n,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Wm.timingValues]}))}return await r})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return km.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingContinuePlayingForGrouping(e,t):this.continuePlayingShelfForGrouping(e,n.shelfContents,t)}pendingContinuePlayingForGrouping(e,t){const n=this.continuePlayingShelfForGrouping(e,[],t)
if(!n)return null
const r=oY.from(es(t))
return n.url=r.param(Hz.isGameCenterContinuePlayingShelf,cW).build(),n.batchGroup=this.batchGroupKey,n}continuePlayingShelfForGrouping(e,t,n){return ym.context("continuePlayingShelfForGrouping",()=>{const r=this.videoCardContinuePlayingShelf(e,t,n)
return r.mergeWhenFetched=!1,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header=lo(e,e.loc.string(Xb),n.subtitle),r})}supportsVideoCardShelf(e,t){switch(t){case tH:case $j:case KH:return!0
default:return!1}}videoCardContinuePlayingShelf(e,t,n){return ym.context("videoCardContinuePlayingShelf",()=>{const r=new pK(eS)
r.isHorizontal=!0,r.batchGroup=this.batchGroupKey
const o=[]
for(const r of t){if(st(e,r))continue
const t=this.editorialSplashVideoCardForContinuePlaying(e,r,n)
t&&o.push(t)}return r.items=o,r})}editorialSplashVideoCardForContinuePlaying(e,t,n){return ym.context("editorialSplashVideoCardForContinuePlaying",()=>{var r
const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:KW},i=e.featureFlags.isEnabled(bK)&&u(n.isArcadePage),s=ih(e,t),a={metricsOptions:o,artworkUseCase:R3.LockupIconSmall,offerEnvironment:MW,offerStyle:lW,canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:i,isSubtitleHidden:s&&!i},c=this.editorialSplashVideoWithTopShelfStill(e,t)
if(!c||!c.preview)return null
const l=Nd(e,t,a)
if(!l)return null
l.clickAction=Rc(e,l.clickAction)
const d=this.clickActionForVideoCard(e,t,e.host.platform,o,n.clientIdentifierOverride)
if(!d)return null
const f=new D5
f.video=c,f.lockup=l,f.overlayStyle=MW,f.clickAction=d
const h=ea(e,t,o)
f.flowPreviewActionsConfiguration=la(e,t,!0,n.clientIdentifierOverride,f.clickAction,o,h)
const p=ep(e,t,l.title,o)
return Jh(e,f,p),null===(r=f.impressionMetrics)||void 0===r||delete r.fields[tS],f})}editorialSplashVideoWithTopShelfStill(e,t){return ym.context("editorialSplashVideoWithTopShelfStill",()=>{let n
const r=Ke(e,t,tD)
return i(r)&&(n=df(e,r,{withJoeColorPlaceholder:!0,useCase:R3.VideoCardStill,cropCode:"sr"})),zf(e,t,n)})}clickActionForVideoCard(e,t,n,r,o){let i=Jd(e,t,ea(e,t,r),o)
if(i=Rc(e,i),n===$j){const n=new tZ(t.id,VW)
ra(e,n,{actionType:qH,id:t.id,contextualAdamId:t.id,anonymizationOptions:r.anonymizationOptions,pageInformation:r.pageInformation,locationTracker:r.locationTracker})
const o=new WJ(t.id,i)
return o.openAction=n,o.cancelAction=i,o}return i}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}gameCategoryFilter(e){return e===aF?ND:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:sH,title:e.loc.string(Xb)}}}class _5 extends Sz{constructor(e){super(),this.$kind="GameCenterAchievementsAction",this.actionClass="GameCenterAchievementsAction",this.bundleId=e}}class L5{constructor(e,t,n,r,o,i,s,a,c){this.$kind="GameCenterReengagement",this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class M5{constructor(e){this.$kind="GameCenterAchievementStatus",this.type=e}}class F5{constructor(e,t,n,r){this.$kind="GameCenterAchievement",this.id=e,this.title=t,this.subtitle=n,this.status=r}}class $5 extends u5{constructor(){super("GroupingGameCenterReengagementShelfController"),this.batchGroupKey=kH,this.supportedFeaturedContentIds=new Set([494])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterReengagementShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],achievementData:null,achievementSummaryData:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchRengagementDataForLocalPlayer().then(async t=>{const n=f(t,EH),r=y(t[NH]),i=y(t.achievementSummary)
if(o(n)){const e={shelfContents:[],responseTimingValues:null,achievementData:null,achievementSummaryData:null}
return await Promise.resolve(e)}const s=new cJ(e).withIdOfType(n,az).includingAgeRestrictions()
return os(e,s),await Ln(e,s,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[Wm.timingValues],achievementData:r,achievementSummaryData:i}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingGameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage):this.gameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage)}pendingGameCenterReengagementShelf(e,t,n,r){const o=this.gameCenterReengagementShelf(e,t,n,r)
if(!o)return null
const i=oY.from(es(n))
return o.url=i.param(Hz.isGameCenterReengagementShelf,cW).build(),o.batchGroup=this.batchGroupKey,o}gameCenterReengagementShelf(e,t,n,r=!1){return ym.context("gameCenterReengagementShelf",()=>{if(!s(t.shelfContents))return null
const o=new pK("gameCenterReengagement")
o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=this.batchGroupKey
const i={id:n.id,kind:null,softwareType:r?dW:null,targetType:NW,title:nS,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:sH,fcKind:n.featuredContentId,badges:{gameCenter:!0}},a=Wf(e,t.shelfContents[0],R3.Uber)
let c=Se("componentBackground"),l=null
s(a)&&(l=a.preview,c=l.backgroundColor)
const u={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},offerStyle:lW,artworkUseCase:uf(0,mW),isSubtitleHidden:!0}}
xh(0,i,i.title)
const d=Yd(e,t.shelfContents,u)[0]
d.clickAction=Rc(e,d.clickAction),Bh(n.metricsLocationTracker)
let f=null
s(d)&&(f=new _5(d.bundleId),f.title=nS,ra(e,f,i))
const h=e.loc.string("GameCenter.Reengagement.Badge.GameCenter"),p=this.achievementFromData(e,t.achievementData),w=this.achievementCountsFromData(e,t.achievementSummaryData),v=this.shelfMetadataForAchievement(e,p,w),g=new L5("gamecenter.fill",h,v.title,v.subtitle,p,d,c,l,f)
return o.items=[g],Jh(e,g,i),o})}achievementStatusFromData(e,t){const n=f(t,IH),r=new M5(n)
return r.percent=h(t,"percent"),r.date=f(t,UD),r.artwork=new dY(f(t,"artwork.template"),h(t,"artwork.width"),h(t,"artwork.height"),[]),r}achievementFromData(e,t){const n=f(t,"id"),r=f(t,FW),o=f(t,Pq),i=this.achievementStatusFromData(e,p(t,"status"))
return new F5(n,r,o,i)}achievementCountsFromData(e,t){return{completed:h(t,"completedAchievements"),total:h(t,"totalAchievements")}}shelfMetadataForAchievement(e,t,n){if(!i(t))return{title:"",subtitle:null}
if(0===n.completed)return{title:e.loc.string("GameCenter.Reengagement.Achievement.First.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.First.Subtitle")}
switch(t.status.type){case cF:case"hidden":case rS:return{title:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Subtitle")}
case yH:const t=e.loc.stringWithCount("GameCenter.AchievementSummary.TotalToCompleteCount",n.total),r=e.loc.stringWithCount("GameCenter.AchievementSummary.NumberCompletedCount",n.completed),o=e.loc.string("GameCenter.AchievementSummary.CompletedCount.Subtitle").replace("@@completedCount@@",r).replace("@@totalCount@@",t)
return{title:e.loc.string("GameCenter.Reengagement.Achievement.CompletedCount.Title"),subtitle:o}
default:return{title:"",subtitle:null}}}}class x5 extends Sz{constructor(e){super(),this.$kind="GameCenterInvitePlayerAction",this.actionClass="GameCenterInvitePlayerAction",this.invitationType=e}}class N5 extends Sz{constructor(e){super(),this.$kind="GameCenterDenylistPlayerAction",this.actionClass="GameCenterDenylistPlayerAction",this.contactId=e}}class B5{constructor(e,t,n,r,o,i,s,a){this.$kind="SmallContactCard",this.id=e,this.title=t,this.subtitle=n,this.buttonText=r,this.contactId=o,this.buttonAction=i,this.removeButtonAction=s,this.shouldShowMessagesBadge=a}}class U5 extends Sz{constructor(e){super(),this.$kind="LegacyGameCenterInvitePlayerAction",this.actionClass="LegacyGameCenterInvitePlayerAction",this.contactId=e}}class G5 extends u5{constructor(){super("GroupingGameCenterSuggestedFriendsController"),this.batchGroupKey=kH,this.supportedFeaturedContentIds=new Set([D1])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Cz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterSuggestedFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{$kind:lF,shelfContents:[],suggestedFriends:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchSuggestedFriends(10).then(t=>e.clientCapabilities.isEnabled(oS)?{$kind:lF,shelfContents:[],suggestedFriends:t}:{$kind:iS,shelfContents:[],suggestedFriends:t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return km.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingSuggestedFriendsShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.suggestedFriendsShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingSuggestedFriendsShelfForGrouping(e,t,n){if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
const r=this.suggestedFriendsShelfForGrouping(e,{$kind:e.clientCapabilities.isEnabled(oS)?lF:iS,shelfContents:[],suggestedFriends:[]},t,n),o=oY.from(es(t))
return r.url=o.param(Hz.isGameCenterSuggestedFriendsShelf,cW).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}suggestedFriendsShelfForGrouping(e,t,n,r){if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
let o
return o=t.$kind===lF?this.suggestedFriendsShelf(e,t.suggestedFriends,n,r):this.legacySuggestedFriendsShelf(e,t.suggestedFriends,n,r),o.header=lo(e,n.title,n.subtitle),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o.footerTitle=e.loc.string(Dx),o.footerAction=co({objectGraph:e,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker}),o.footerStyle={$kind:qq,bundleID:TB,width:16,height:16},o}suggestedFriendsShelf(e,t,n,r=!1){const o=sS
if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
const i=new pK(aS)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=kH
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i],l=e.loc.string(cS),u=e.loc.string(lS),d={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
let f,h
c.supportsFriendingViaPush&&c.contactAssociationID?(f={contact:{contactID:c.contactID,contactAssociationID:c.contactAssociationID}},h=!1):(f={messages:{contactID:c.contactID}},h=!0)
const p=new x5(f)
ra(e,p,{...d,actionType:uS})
const w=new N5(c.contactID)
ra(e,w,{...d,actionType:dS})
const v={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:fS,softwareType:r?dW:null,anonymizationOptions:{anonymizationString:a}},g=new B5(c.contactID,c.fullName,u,l,c.contactID,p,w,h)
Jh(e,g,v),s.push(g),Vh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}legacySuggestedFriendsShelf(e,t,n,r=!1){const o=sS
if(e.client.deviceType!==ZW&&e.client.deviceType!==HW)return null
const i=new pK(aS)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=kH
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i]
c.buttonText=e.loc.string(cS),c.subtitle=e.loc.string(lS)
const l={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
c.buttonAction=new U5(c.contactId),ra(e,c.buttonAction,{...l,actionType:uS}),c.removeButtonAction=new N5(c.contactId),ra(e,c.removeButtonAction,{...l,actionType:dS}),Jh(e,c,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:fS,softwareType:r?dW:null,anonymizationOptions:{anonymizationString:a}}),s.push(c),Vh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:sH}}}class j5{constructor(){this.$kind="HeroCarousel",this.items=[],this.rtlItems=[]}}class V5{constructor(){this.$kind="HeroCarouselItem"}isValid(){const e=(0,mm.isSome)(this.collectionIcons)&&this.collectionIcons.length>0,t=(0,mm.isSome)(this.artwork)&&this.artwork.isValid(),n=(0,mm.isSome)(this.video),r=t||n||e,o=(0,mm.isSome)(this.overlay)&&this.overlay.isValid()
return r&&o}}class H5{constructor(e){this.$kind="TitleEffect",this.isFallbackStyle=!1,this.type=e}}class q5{constructor(e,t,n){this.$kind="ArticlePage",this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class W5{constructor(e,t,n,r){this.$kind="RoundedButton",this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class z5{constructor(e,t,n=FH,r=null,o=null,i=null){this.$kind="FramedArtwork",this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===SN?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class Y5{constructor(e,t,n,r){this.$kind="Quote",this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class J5{constructor(e,t,n){this.$kind="HorizontalRule",this.style=e,this.color=t,this.isFullWidth=n}}class K5{constructor(e,t){this.$kind="AppShowcase",this.type=e,this.lockup=t}}class Z5{constructor(e){this.$kind="InAppPurchaseShowcase",this.lockup=e}}class Q5{constructor(e,t,n,r=!0){this.$kind="EditorialLink",this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class X5{constructor(e,t){this.$kind="ClientControlButton",this.title=e,this.buttonAction=t}}class e6{constructor(e,t){this.$kind="ArcadeShowcase",this.unsubscribedAction=e,this.subscribedAction=t}}class t6{constructor(e,t,n,r,o,i,s){this.$kind="UpsellBreakout",this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s}}class n6{constructor(e,t,n,r,o,i){this.$kind="BreakoutDetails",this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class r6 extends Sz{constructor(e,t,n,r,o){super(),this.$kind="ArcadeAction",this.actionClass="ArcadeAction",this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n,this.paymentMetricsOverlay=o}}class o6{constructor(e){this.$kind="InlineTodayCards",this.cards=e}}new Set([XW,zB,sq,F$,Xq])
const i6=new Set([dV,XW,zB,sq,F$,Xq]),s6=new Set([dV,XW,zB,sq,F$,Xq]),a6=new Set([dV,XW,sq,Xq]),c6=(new Set([dV,XW,HL,zB,Xq]),Se(d$)),l6=Se(d$),u6=Se(d$)
class d6{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1,this.allowUnpublishedAppEventPreviews=!1}}const f6=[NI,xI,BI,sL]
class h6{constructor(){this.$kind="HeroCarouselItemOverlay"}isValid(){const e=void 0!==this.callToActionText&&null!==this.callToActionText&&void 0!==this.clickAction&&null!==this.clickAction,t=void 0!==this.titleText&&null!==this.titleText,n=void 0!==this.lockup&&null!==this.lockup,r=void 0!==this.collectionIcons&&null!==this.collectionIcons
return t&&(n||r||e)}}class p6 extends u5{constructor(){super("GroupingHeroCarouselShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,Aq)===UG}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,i){if(0!==i.shelves.length)return null
const a=new pK(eV),c=t.featuredContentData,l={targetType:rW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(c)},u=new j5
u.autoScrollConfiguration={isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}
const d=ep(e,c,eV,l)
d.autoAdvanceInterval=u.autoScrollConfiguration.autoScrollInterval,Jh(e,a,d),xh(0,d,eV)
for(const i of n.shelfContents){if(r(i.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}const n=gh(e,i)
if(zc(0,i)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(i),t.relationshipToFetch=vq
continue}const s={targetType:fB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(i)},a=Bc(e,i),c=Nc(e,i)
if(o(a.video)&&o(c.artwork))continue
const l=new V5,d=fl(0,i),f=ml(e,i),h=ep(e,i,f,s)
h.isPreorder=Xe(e,d,uW),Jh(e,l,h),xh(0,h,f)
const p=a.artworkData||c.artworkData,w=a.backgroundColor||c.backgroundColor,v={metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,canDisplayArcadeOfferButton:ph(0,t.shelfStyle),lockupArtworkUseCase:uf(0,t.shelfStyle),isContainedInPreorderExclusiveShelf:t.featuredContentId===R1}
l.overlay=vl(e,i,v),l.backgroundColor=w,l.titleEffect=Jc(0,p),l.artwork=c.artwork,l.video=a.video
const g=Yc(e,i),m={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(i),targetType:fB,id:i.id}
g&&(ra(e,g,m),l.clickAction=g),u.items.push(l),Bh(h.locationTracker),Vh(h.locationTracker)}return s(u.items)&&(a.items=[u],i.pageTitleEffect=u.items[0].titleEffect),a.url=ts(0,a,t),Bh(d.locationTracker),Vh(d.locationTracker),a}}class w6 extends u5{constructor(){super("GroupingHorizontalCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&hs(0,j(t,Aq))!==xD}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,Aq)
return o.shelfStyle=hs(0,i),o}_createShelf(e,t,n,r){var o
const i=function(e){return t.remainingItems.push(e),!1}
let s
if(e.featureFlags.isEnabled(_K)){const r=new qQ(t.metricsPageInformation,t.metricsLocationTracker)
s=il(e,null!==(o=n.shelfContents)&&void 0!==o?o:[],t.title,t.subtitle,r)}else{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation}
let o
if(t.shelfStyle===mH)o=t.shelfStyle
else switch(e.client.deviceType){case iz:case"tv":case bH:o=t.shelfStyle
break
case oz:o=EV
break
default:o=vG}s=ol(e,n.shelfContents,o,t.title,t.subtitle,r,i),s.contentType===mH&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!Bt(e)||nl(0,e.media.kind,mH)))}return s.url=ts(0,s,t),s.isHorizontal=!0,s}}class v6{constructor(e,t,n,r,o,i,s){this.$kind="LargeHeroBreakout",this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.collectionIcons=i,this.backgroundColor=s,this.editorialDisplayOptions={}}}class g6 extends u5{constructor(e=null){super(e||"GroupingLargeBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,Aq)===PW}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}isInHeroPosition(){return!1}_createShelf(e,t,n,i){const a=s(i)&&o(i.pageTitleEffect)&&0===i.shelves.length,c=s(n.shelfContents)?[n.shelfContents[0]]:[],l=[]
for(const n of c){if(r(n.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const s={targetType:this.isInHeroPosition()?"heroBreakout":fB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(n)},c=Bc(e,n),u=Nc(e,n),d=c.artworkData||u.artworkData,f=g6.createLargeBreakout(e,n,t,this.isInHeroPosition(),a,s)
o(f)||(l.push(f),a&&(i.pageTitleEffect=Jc(0,d)))}const u=new pK(bx)
return u.isHorizontal=!1,u.items=l,u.url=ts(0,u,t),0===i.shelves.length&&(u.presentationHints={isFirstShelf:!0}),u}static createLargeBreakout(e,t,n,r,i,s){const a=gh(e,t)
if(zc(0,t)&&!W(a))return n.isDeferring=!0,n.remainingItems.push(t),n.relationshipToFetch=vq,null
const c=Bc(e,t),l=Nc(e,t)
if(o(c.video)&&o(l.artwork))return null
const u=c.backgroundColor||l.backgroundColor,d=r?null:j(t,"breakoutBadge")
let f
const h=j(t,Gq)
f=Xe(e,t,aj)?e.loc.uppercased(vh(e,a,h)):h
let p={type:wW};(null==f?void 0:f.length)>0&&(p={type:WH,title:f})
const w=ah(e,t,cz)||Qe(e,a,cz),v=ah(e,t,qV)||Qe(e,a,TV),g=Uc(e,t,!0,0,!1),m=jc(e,t,0,!1),y=new n6(w,v,p,null,g,Vc(0,m,t)),A=new v6(y,{position:m||QW},d,l.artwork,c.video,null,u),T=ep(e,t,A.details.title,s),b=Xe(e,fl(0,t),uW)
T.isPreorder=b,Jh(e,A,T),xh(0,T,A.details.title)
const S=Yc(e,t),P={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:bt(t),targetType:lz,id:t.id}
return ra(e,S,P),A.details.callToActionButtonAction=S,A.clickAction=S,Bh(s.locationTracker),A.flowPreviewActionsConfiguration=la(e,t,!0,n.clientIdentifierOverride,S,s,P),A}}class m6 extends Sz{constructor(e){super(),this.$kind="SearchAdAction",this.actionClass="SearchAdAction",this.action=e}}class y6 extends Sz{constructor(e,t,n,r,o,i,s,a){super(),this.$kind="SearchAction",this.actionClass="SearchAction",this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.source=i,this.presentationStyle=null!=s?s:[FO],this.referrerData=a}}class A6 extends u5{constructor(){super("GroupingLinkShelfController"),this.supportedFeaturedContentIds=new Set([k1,c1])}initialShelfDataFromGroupingMediaApiData(e,t){let n=we(t,QH)
return o(n)&&(n=G(t,bB)),{shelfContents:n}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldHideShelf:H(t,"hide"),areContentLinks:s(we(t,QH))}
return o.clientIdentifierOverride=Gr(e,t),o}_createShelf(e,t,n,i){if(t.shouldHideShelf)return null
const s=[]
for(let a=0;a<n.shelfContents.length;a++){const c=n.shelfContents[a],l={targetType:EW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
t.areContentLinks&&(l.recoMetricsData=bt(c))
let d=null
if(t.isSearchLandingPage){const n=this.trendingSearchLinkFromData(e,c,t.metricsLocationTracker)
if(r(n)||r(n.action))continue
Jh(e,null==n?void 0:n.action,{...l,kind:EW,softwareType:u(null==i?void 0:i.isArcadePage)?dW:null,title:n.action.title,id:`${a}`,idType:pW}),d=n}else{const n=ls(e,c,t,!1,null,l,null)
if(o(n)||o(n.action.title))continue
d=n.action
const r=ps(0,c)
r&&Jh(e,d,{...l,kind:EW,softwareType:u(null==i?void 0:i.isArcadePage)?dW:null,title:d.title,id:r})}o(d)||(s.push(d),Vh(t.metricsLocationTracker))}if(o(s))return null
if(t.isSearchLandingPage&&e.client.isPhone&&s.length>=6)for(const t of s)T(a=t)&&a[hz]===hA&&(t.action.artwork=kt(e,Ox))
var a
const c=new pK(aW)
return c.isHorizontal=!1,c.items=s,c.title=t.title,c.subtitle=t.subtitle,c.presentationHints={isWidthConstrained:!0},c.url=ts(0,c,t),t.isSearchLandingPage&&(e.client.isPhone||e.client.isPad)&&(c.contentsMetadata={type:Rx,numberOfColumns:s.length>=6?2:1}),c}trendingSearchLinkFromData(e,t,n){const r=f(t,Gq)
if((0,mm.isNothing)(r)||0===r.length)return null
const o=new y6(r,r,null,kU)
return sa(e,o,lz,n),Vh(n),new m6(o)}}class T6 extends u5{constructor(e=null){super(e||"GroupingLockupShelfController"),this.supportedFeaturedContentIds=new Set([...U1,...W1])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,sz)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,QH)),{shelfContents:r}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return _c(e,t,n,r)}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(r.displayStyle=t.shelfStyle,t.featuredContentId===$1){const n=f(B(pe(e,t.featuredContentData,_E),nH),cz)
r.title=n,r.idType=sH,r.badges={forYou:!0},r.targetType="swooshBreakout"}return r}_createShelf(e,t,n,r){if(t.featuredContentId===$1){const t=!s(n.shelfContents),r=e.client.isPad
if(t||r)return null}return Lc(e,t,n,r)}}class b6 extends u5{constructor(){super("GroupingPersonalizedLockupShelfController"),this.supportedFeaturedContentIds=H1}shelfRoute(e){return Dc(this.supportedFeaturedContentIds,[`${Hz.isOnDeviceRecommendationsShelf}?`,`${Hz.onDeviceRecommendationsUseCase}?`])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,sz)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,QH)),{shelfContents:r||[],containsODPShelfContents:!1,recoMetrics:bt(n),candidates:null,isHiddenShelf:!1,responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
const i=r[Hz.onDeviceRecommendationsUseCase]
return(null==i?void 0:i.length)>0?await ms(e,i,pz).then(e=>({shelfContents:yt(e.dataContainer),containsODPShelfContents:!0,recoMetrics:e.recoMetrics,candidates:e.candidates,isHiddenShelf:!1})).catch(async o=>o instanceof J1?await b6.fetchODPFallbackContent(e,t,n,r).catch(e=>b6.makeHiddenShelfData(n)):b6.makeHiddenShelfData(n)):(null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0?await u5.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const n=mt(e,t),r=this.initialShelfDataFromGroupingMediaApiData(e,n)
return r.responseTimingValues=t[Wm.timingValues],r.shelfTitle=j(n,cz),r}):await u5.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>{const t={shelfContents:yt(e)||[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!1,responseTimingValues:e[Wm.timingValues]}
return t.shelfTitle=n.title,t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=_c(e,t,n,r)
return this.addPersonalizationValuesToShelfToken(e,o,t,r),o}_createShelf(e,t,n,r){var s,a
if(!t.isValidRecommendationsShelf)return null
let c=null
if((0,mm.isNothing)(t.title)&&(t.title=n.shelfTitle),n.containsODPShelfContents){c=this.personalizedShelf(e,n,t,r)
const o=(new oY).set(DV,Cz).path(`${_z.onDeviceRecommendations}`).param(Hz.onDeviceRecommendationsUseCase,t.onDeviceRecommendationsUseCase).param(Hz.token,JSON.stringify(t)).build(),i=new _J(fz,o)
i.title=e.loc.string(nq),i.pageData=this.odpSeeAllPage(e,n.shelfTitle,G4),gs(e,c,i),c.mergeWhenFetched=!1}else n.isHiddenShelf?c=b6.makeHiddenShelf(t):i(t.recommendationsHref)?(c=this.personalizedShelf(e,n,t,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t)):(c=Lc(e,t,n,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t))
const l=(0,mm.isSome)(c.header),u=l&&o(null===(s=c.header)||void 0===s?void 0:s.title),d=!l&&o(c.title),f=(null===(a=n.shelfTitle)||void 0===a?void 0:a.length)>0
return u&&f?c.header.title=n.shelfTitle:d&&f&&(c.title=n.shelfTitle),c}personalizedShelf(e,t,n,r){const o=Gh(n.metricsLocationTracker)
o&&o.fcKind===n.featuredContentId&&Bh(n.metricsLocationTracker)
const i={id:n.id,kind:null,softwareType:u(null==r?void 0:r.isArcadePage)?dW:null,targetType:rW,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:sH,fcKind:n.featuredContentId,recoMetricsData:t.recoMetrics,displayStyle:n.shelfStyle}
xh(0,i,n.title)
const s=Lc(e,n,t,r)
return Bh(n.metricsLocationTracker),Jh(e,s,i),s}addPersonalizationValuesToShelfToken(e,t,n,r){const o=t.featuredContentId===O1
if(!r.hasAuthenticatedUser&&!t.isSearchLandingPage&&!o)return void e.console.log(`Skipping recommendations shelf with fcID ${t.featuredContentId}: No user logged-in`)
const i=j(n,Lx)
if((null==i?void 0:i.length)>0)return t.onDeviceRecommendationsUseCase=i,t.recommendationsHref=n.href,void(t.isValidRecommendationsShelf=!0)
const a=s(we(n,sz)),c=!H(n,Yb)
!a&&c?(t.recommendationsHref=n.href,t.isValidRecommendationsShelf=!0):t.isValidRecommendationsShelf=a}addOnDeviceQueryParamsIfNecessary(e,t,n){var r
if(o(t))return null
if((null===(r=n.onDeviceRecommendationsUseCase)||void 0===r?void 0:r.length)>0){const e=new oY(t)
return e.param(Hz.isOnDeviceRecommendationsShelf,cW),e.param(Hz.onDeviceRecommendationsUseCase,n.onDeviceRecommendationsUseCase),e.build()}return t}odpSeeAllPage(e,t,n){const r=new pK(n||G4)
r.isHorizontal=!1,r.items=pS
const o=new gK([r])
return o.isIncomplete=!0,o.title=t,o}static async fetchODPFallbackContent(e,t,n,r){return await new Promise((r,o)=>{const i=rs(e,n)
if(!i){const e=`OnDeviceRecommendationsShelfController: Could not construct media API request for: ${t}`
return ym.unexpectedType(Cq,e,null),void o(new Error(e))}os(e,i),i.attributingTo(t.build()),Ln(e,i).then(t=>{const n=fe(mt(e,t),sz),o=bt(n),i={shelfContents:yt(n),containsODPShelfContents:!1,recoMetrics:o,candidates:null,responseTimingValues:t[Wm.timingValues]}
r(i)}).catch(e=>{const n=`OnDeviceRecommendationsShelfController: Failed to fetch fallback shelf contents: ${t}`
ym.unexpectedType(Cq,n,null),o(e)})})}static makeHiddenShelfData(e){return{shelfContents:[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!0}}static makeHiddenShelf(e){const t=new pK(e.shelfStyle)
return t.isHidden=!0,t}}class S6{constructor(e,t){this.$kind="RibbonBarItem",this.title=e,this.clickAction=t,this.artwork=null,this.accessibilityLabel=null}}class P6 extends u5{constructor(){super("GroupingRibbonBarShelfController"),this.supportedFeaturedContentIds=new Set([556])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,o){var i
const s=[],a=new pK(OD)
a.isHorizontal=!0
const c=lr(e,e.bag.arcadeCategoryBarSAGUpliftDisplayRate)
if(t.isArcadePage&&t.isFirstRender&&c){const n=P6.createSeeAllGamesRibbonItem(e,t.metricsPageInformation,t.metricsLocationTracker)
s.push(n),Vh(t.metricsLocationTracker)}let l=null!==(i=n.shelfContents)&&void 0!==i?i:[];(0,mm.isSome)(t.initialHydratedItems)&&t.initialHydratedItems.length>0&&(l=t.initialHydratedItems.concat(l))
const u=[]
let d=!1
for(const n of l){if(r(n.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(n),P6.shouldPriorizeItemWithData(e,n)&&(d=!0)
continue}let i=!1;(0,mm.isSome)(t.featuredContentData)&&(i=(0,bm.attributeAsString)(t.featuredContentData,Aq)===VM)
const a=P6.createRibbonItem(e,n,t.metricsPageInformation,t.metricsLocationTracker,i,t,o);(0,mm.isSome)(a)&&(P6.shouldPriorizeItemWithData(e,n)?s.unshift(a):s.push(a),u.push(n)),Vh(t.metricsLocationTracker)}return a.items=s,d&&u.length>0&&(t.initialHydratedItems=u),a.url=ts(0,a,t),a}static createRibbonItem(e,t,n,r,o,i,s){var a,c,l
const u={targetType:tV,pageInformation:n,locationTracker:r,recoMetricsData:bt(t)}
let d
if(t.type===CH){if(!Wi(e,BV))return null
d=us(e,t)}else d=ls(e,t,i,!1,null,u,s)
const f=ea(e,t,u)
f.targetType=u.targetType
const h=Jd(e,t,f,null==i?void 0:i.clientIdentifierOverride),p=null!==(a=null==d?void 0:d.action)&&void 0!==a?a:h,w=null!==(c=ah(e,t,cz))&&void 0!==c?c:(0,bm.attributeAsString)(t,cz),v=null!==(l=null==d?void 0:d.title)&&void 0!==l?l:w,g=new S6(v,p),m=Sn(e,t)
let y
if(o)y=null
else if((0,mm.isSome)(m))y=df(e,m,{useCase:R3.RibbonBarFacet})
else{let t
t=i.isArcadePage?"resource://arcade-ribbon-bar-fallback-icon":"resource://appstore-ribbon-bar-fallback-icon",y=kt(e,t,36,36)}return g.artwork=y,g.accessibilityLabel=v,Jh(e,g,ep(e,t,v,u)),g}static createSeeAllGamesRibbonItem(e,t,n){const r=e.loc.string("Arcade.CategoryBar.AllGames.Title"),o=io(e,XU,t,n,r,vB,wW,tV),i=new S6(r,o),s=kt(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACACAYAAADHy7H2AAABdWlDQ1BrQ0dDb2xvclNwYWNlRGlzcGxheVAzAAAokXWQvUvDUBTFT6tS0DqIDh0cMolD1NIKdnFoKxRFMFQFq1OafgltfCQpUnETVyn4H1jBWXCwiFRwcXAQRAcR3Zw6KbhoeN6XVNoi3sfl/Ticc7lcwBtQGSv2AijplpFMxKS11Lrke4OHnlOqZrKooiwK/v276/PR9d5PiFlNu3YQ2U9cl84ul3aeAlN//V3Vn8maGv3f1EGNGRbgkYmVbYsJ3iUeMWgp4qrgvMvHgtMunzuelWSc+JZY0gpqhrhJLKc79HwHl4plrbWD2N6f1VeXxRzqUcxhEyYYilBRgQQF4X/8044/ji1yV2BQLo8CLMpESRETssTz0KFhEjJxCEHqkLhz634PrfvJbW3vFZhtcM4v2tpCAzidoZPV29p4BBgaAG7qTDVUR+qh9uZywPsJMJgChu8os2HmwiF3e38M6Hvh/GMM8B0CdpXzryPO7RqFn4Er/QcXKWq8UwZBywAAAARjSUNQDA0AAW4D4+8AAAB4ZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAASAAAAAEAAABIAAAAAQACoAIABAAAAAEAAACCoAMABAAAAAEAAACAAAAAACBAcQEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIGaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yMTk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIxNjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KIUPY5gAAGmtJREFUeAHtXXuMJMV5r+qZ2Qe7h299bA7O3B0GGwOXBwEsbMXCC1H+QJjHgpbHEcyBEiLl4cgJxLKElIkUS4DtQCCSpZOSEAx3hjW+YwmclAfa4MQScfBL2Tg5ED5uyfFYw0Lu9nZvHl35/b7qmu3Z65numZ3dndnpupvt7np+31e/+qq6uuorpVKXSiCVQCqBVAKpBFIJpBJIJZBKIJVAKoF6EtD1ApcbZpRa0fxJHwpAMe3hVprfleS1ZRVlRkayqr8/ozbPa7Wh36gTW3118KBRw8NG7djR2sqamrJ0D73mqdmztRqY8QQKc8M+yirpfN5fSWgYA/zdOJarKnfoNQNabLkrwe/MjFbnnqvV9LRXkfGm+bLOT5ZaweuygWCuvLKXhOgDB060gqDl5mHyylNTY6SpoMfHy8vNL5ze5PPIe2pF8g6X08i9GRvrUacf0/qR5cm/aSCIUA5N9uhHJxcc4ebma7aoTHabMmYLNPZpaDcbAJE+hGfg13RZLn939Y0xnucVlPGPI/9ZlPUO7t9Qpb7XUfnHXDyza6QvTJ/zb+YqgD9woAAmRLuhAvpVdmG70t6ZyujTkecQaBnwld/jad0yXgNayyjjBCB+FGX8HH5vqkJxWo8/e9jxIoCYmfH1ZHMaoimCTR7dgJr0dV755o6xYVUo3YiKvgJEfgJyolAAANWjPKuxhdimSnJsLrm6jgY6GuVSHc/jbhbiP4xq+gGENqH37vtHpjK7dgEMj1bAuiSnRI8EgdN45pbRzyDX6wDyS5D4LFw/jDIHlNYefja/leCVOVt+i7gj2N/B7xXw+qLKZZ/Uj40LKAgINIYCwhpyDZNs7rorp3fvJjHK3Dx6p9LmbuXp86XSSajvs5oYTrXMSqIvZcRLSxwydCIH0lABymThw58UpMrl4xDQ8ypT/rJ+fOLV5WgGJ1gzduWwyvU+AAauA68bAQBwB5aMKYOeEoq2/LaQz4qwOCYBZ/ixZWVQak5D7Qjrvoj4Z/B/WD+x/yFcVRi4fE7imHlixwGhUz1m57V/CUK+IML3/XmQeYI1LjVkQDDIRNVL/ga1whsE0xvRws8n+yMWo8KFuxP6uWcXbiPhr0iDCRApi7JOUdlMRpXK00iyC9rhhWbA4Pg1t157AYh/Gt3eeQAZKxxdklQ8LsIjKygkS0un47eaboYt5WWRLysbKyOXOa+ShhLlP2SIH3lmmTkIfQCNERSZx1Qx+9vUCA7ACE/kyEAiZzgI4xsAnNl53UMqm/0CxF6EBkAfrUogrQe13YP7HpCHrgPjAotgkEgcoOO0fad9to8MQqDghF2rPCM9gYSfe+YVz4xHvyDfIF4GVwhDyu1FIHk6BhB8gJa7FTL/trn1+k9xrMBuAmGJHMdABL0Zu3obyj2gvAxB8AESUy2TPvLJH8smDSw3+JFGchPQKtfwPdPjORwuz6xOGw+PEkF4DvyQP8uB5pMye3GlvAENM6vK/hy6iM/72eJfw08JGKQL51O8o1ATOSCsH5nPm1tHb0eCR1E4+6HjATEWo4lyWoVI5Mq2nKKocd9Mqb7yp/XfTBwNd21JKDE7R19QWe9yAOs9xOcbAytbGkSS9Csex/JKFcOBbAYNdFCVS3ejm/g6/LTK53WS12kyFesCNTNvdl6FkbH5kiTQAQgokvYRi5DG/gEioIiyxi/PoZ3tUAven0hg4SA1VV1n7ro4xwgCeguC9/FIbWLFzsB2cVb27FuoHU5Aa6HT0F80O2/4OPyMOnIkll+ykggIiGcz0z03Ievz8eMoPFEBLGS1HWsrACdVbRndFwcPNxLI0kXw3bue2/2ynaQx5nehCRiTKjnIsl7CNQ0jJPqkm8hlPoLX6RtIDQf28qofQ1osEKANMuwSmA9e1H5d3g6UKUCwmBuIyX2tgwUR0oqL6HC3o9FcJiQtLHAME+lkgAhWzW2jv4gIv4IfB4bCq80uMlm7eLI+MYhExWhzBTW5JWwytp5jIyAjafnm86ObIMxz2bTg7LDfltK+fy1Q2UkUMd5C/24uFmLPss08kvDhYSuTkvokQM8xgaiEyLjt6ekFWuw8lfPPFBKPHI3FcDwQBgZsnEIZo2ezOQBCe4ogmiq+dPky8DbqYxJl06Xx6tIzO6Kza2NfO4eBhmvYdaOu/K1CrfsGUof0eCDMzVk0efoM5DOIH/vPWITVKXO1g0gr1CWclqlgJaPoyRrqkh+P6Hy9XUDfSZxaylGnmm9LPZiXxlQ/3FPjnPqqy0k8EAYGbPZKnYYsOXKmqqybKcLbz0mXZjaaO6/h9LfCnEg071uutl2BNsMSL5gUk/vO+MO6KXNGIqPVJpKMLt2+TNehP1oY4QRvv22BoD0KkGqns0RTBVnTr+Yx60h37FhVCL3YakLv3IP4tkXvTnPkCxqQF3Nqhfg/y5/EbyUMN/FAGBwMpGH6pJ/l9GhnQYH8BjzoHIa5diRtRwthWSiVt5qOb0pIgVlKbbuU6ljt/WSrO6gh+fKbiN54ICxmY+cN7IBk0bez7sCvtnxE0p23vjuwCESmjIl59x0gMkGbe9bjtZr0RoBQnbJLnoCIjuwfpHoaWAOSAiEW0J2sEWKZq0RIgVARRfRN56qDaH5q+aZAqCEZ+25Ud6BdI2VneqdAqFtv3aIPkrw+1hVUGrheJJBqhPVSk8vkIwXCMgW4XpKnQFgvNblMPlIgLFOA6yV5CoT1UpPL5CMFwjIFuF6Sp0BYLzW5TD5SICxTgOsleQqE9VKTy+Sju4DQPZ8OGoZFdwGhgU8Hss4P4uwW7HQXEBpuJ0zQwQtTGuA3BUIDwlrPUZMDwV8XLQOWG7z4DmKSVe747eAVSl7yxbfxQKgs+4YtBDqsjxVJxotTorfJH9fVl1WxYDe4vhpBWT5vuZqcxN4QE2zkcYCIiN++XpZf2q9I6OKB4JZ9e3oOwuFSf2ydIBwSlrDW0cKAhdE/1Z+z9pQqy/SrCUR0jBMF7tz42ylcLjJh+Q3Wmpu5xYD6d/FAOLrZCsMo2ggoQEpMExZv/RLaKVTDKtnMAi2ewAba0Ek8CADGxgKZwFobIdF5jnx5sl1PLM5JZdFgxkn8hlmLB4Lb+6j020jIVsJ9AXUzDRfQJvdYlS6V+q6zjqZmZ2ttXrH7HgxM2DFNJ+3jIIta9nlmxWCGljrDxp08OalbZ/FAGJgJMtBv4IatJD5Nm9R+QAbpB8286NfpJxZRxsejgRCMiXxP2VFEwD3TdYTjzm+Y+AHZ7wMM/ys019rwG2IovlJ7zrWbQgc3TQNVh4OWFYOvUAlrfSstBDt+YKUT28T/S8iZPZuW16KrOBg7QDA/oqUVOETtEGdHbtgA62UxxH0dw/ppofzcVthH2L27tGiASv8gkF8WBUS3qDaTmd3Harjf8V2A+HtC3uIO75OphS1n8SzkXkI/+xbQwrTRoDk59Zr5hAiELRvAWOvv673P0kor9HhgI7oOdbEaQVrO7CwrHq68Hy3r/3DD7fEwPkG/tnacBOD4gHz+u96z/0cQmFZnnVXTMil3Q7PrgLmg95DuOZ3xepCmRF5Dwm47pjkIgCOd/apYQgdRfpYeYgoogU3qWCAwM1g8PyF2B/dMvIiCngPiOKBKsOteUq/lH2qtHrRsvE+bB4WQsbG+0Nb3aNoqLShzP/rZBcgYecB0RnTs9vC13cIJmNfjtv/n1HkX/b0QNpKMvERAEMG99JKYnINhx7vxO4TZBNpLoBptx4ZCmggCDxZYqdof0Xue+SdnJhDPdR20QVmMiO15+hXg/R4YsuxHAlgdsR1N3cSrHCjCtwiF9Vt9GrTBDOrmXtFstMuc0Ix/IiCQN752iRnbb00cwSBqDGJBgd6HQIgTOgXPe6GNaVbRuXJJQ0AHbDNnswOqWN6LLuGPA1rswDcBYQQDoyHtX6lS8avI61T0MZQX8hdArDG/jgZcjRgLg3FwQwOot+vH9/04eDNKPLPYsLZzBp/NTaPnm4x5XGcyF0F9oiJgRl7DAB/JWn0wOD5YUbCJCGMYtNquzdf1E8+IoU1p4Qn6SqSvODKFjMmPglX2P4KQv4IfbRlyjEGgIIwVsurT0MAk/uG0AvQIOdRBBlr6FYwM7szt3fevYj0/P1l2tJP+OOcEGBevKjxQsbS1qNXO0buN9u+EMM6B9WDbfTC2AJaCopDwv6WOZBtmbMdIwUjJ1gnen43C24F/v+aYhjGtrcjE2iBMKsvgM4UK49y/hLt7UfTleMR5FEHBlldGY3T88L+lzvKLLDnwreSM+X5W9mF471XHyvfpCZgYXi0z/Y6KxVdKsE3DjtnSZyGDSxF+Pn4fAXE018uBC8HBltpqh/GJwakx+igynsH1Z3j+iSrr7+on9/2UhQld4+NFCGtZNYPEWo2N8U1C3jbMbVd/VJUzn0URF+J3NkJ/AddTUQrMC0Ej2YEbvFrmSD/VPFU/p/rfRBn/A2h+X/WbSdqYZknNgoBpF+HFpwadPcXlEE5xOflgDDnxZMg7RRVP6VWZEx5U17LKqiItA42Yy5RUrjyvtl00t/QtgK9MPF+qMp1clbj5BwEWvlG48yrCOSGMpgf7wWuupbyykIH+sppTBTUwcDxS1jipRs0NF924JkxX0vuWVA6EkAGROcXvEkNDpShBJSWomXgCyHfxVvPWIDVPWbVAC9SjQwDBsQin35dZAfXKqRUmA0HMjkr4zEzRnaFRK34S/5YAYWlBUjGc3+apZLOzK1KGfD3cglPkpnCGBL4boJBlqf+lPCR9DroNT9EA15EV5pen5o2M+PySuFb8JpVLGi+VQCqBVAKpBFIJpBJYHxJYkYFcOlhcAXBwaV0wWFz6utyK0loChPT1sbVHD8dVbNu9Pq7phFJ/L05lObGgtk1gQkk+NFXkl04oVUSR+KZpjVA1xcyDwjf2XYYp5k+h5PPwSzLFzLL57i9Xvo/jxj3DuzIv4OLRT1wQKXKKuYAp5t6VnmLeecPZmLe6DMQ0MsXs+JAvVHwIXBXPITm4cF4Zp/2mmDmzxnl30QgHf3gPiNyFejwHVdnAR6eKXAI+cRHn/Gs9O3/5umM/wbgPMfbjz/uQ2ve0b+7T33rmu4zNrqvZ6VdWDPPAH2NuueaX8SX6Xjxejt+m6I9OFQAzWcg5vsJXBrOOnV8oetWthPNP1UcnUMT1INOQxB5V6LkPPB5zdVOVPMEDM2/IVT5D3zZ6Po6gfVy182doo76m9+7/EhlsBgwEAQTEmsJn6Ou4puErWPTRiwoIfYaWcInDeKvkKp+hQWIOdYDP0OVXcLzEHfqJiX9b8c/Q7nxlc/M1l+CI3OchlGHj++GjUByw3HWV5FJphaEK4cKUTB9W7OwFGHaSkGbAIOluvfYBlcndo0ol7uvA52xZCsmyHJ/uyuir4Ryf0IE8cE9jraL+EACKownNGFZjPS8DSpxfCcJc3Lp0Jf48LJqA5yv/5vVnYGXSU/iwPIyVSh+gIAqB+fDHe/5W27lyQ3RAbZZKOC85cwuO9f2LgCCutUzkCBpGxGmwv6eyAgIu2uWaBpQhfVGb8Esc4FO/MVxsewq+gP8dzu6+UO9+uchP5+QhiSMzsU7GAoOD7I+w3sP/GhavfhRL1fgNnF/A1qLiSUk9R5rIm48zEKnGfx8rjH5DxjU447peQoY5zWFuuu4cCPirqljkfknml0hezGO1nAjftvl+0PpznctywcyfBzxgHIdP8glcMsampno52IIwP4M8P4fv7XaZFrHY3o78FaTFaPNFIXV8fEGAXY/uodesXDycg53JADhchqcS7Kevl+kKh9mteb3Qgsexcukq1Vu+SkqcTFZuLBAANlljINlpM4pxAU8Osy0kUe+TjJAVikWgYo8T1i8q9UmMbX4VHkYdOsSVzZGOIKFalQPRtQboRaNkk/W0kVmuimewWi6L67zOZqG4/WtYMNcquG6uHiGxQFB3XZyVg6a56kepi4OegN1EfNp6Ja9WGLUWV/na171PS7GVjb0RRLjT1U0Pl93x0FN2LaL52ln9OdpwxSY/n+rrEnPL1TyrEzu/Aw0nD9F/4iuzsMEOsLZs2oYstqIfsjm5kqPzbR9f2nPQ2H/Bv0rbY36HXsOCX1u5JxE6Pe1kciEGxQxuf73nmLDdA/Z5+iW812zHC8VWCTq4IZYHx7TL6uTr3HBQ5cUzEci181SzneRIP2gmDhTBrIIRdTTvFQMa5uOdxGSFVmu/4gS43YjxDWZ44bCqqSbwg4TRwggC5VLZMJrZjMy4KpkDxQAc4YhtfY/XbTYKc5osqiWpQ0O1eCd/5PCMQPt1Dq/ConTZJYAA7OJQd7oYIxmMUksYDLNugzsSWG2ERPBeqjsRCJYXowfVcB9XG2OH8MlrKaXVVOwmmKEACDZt5/wlcLG5hxfwAIc7Q2MZvK/l4oHwapDUNwPInHmybdneqFau7eQvUggI0qpXzRe5kzvybGh6C4PCn+Z8A9tYZzlb3cHOCj2QlPh4IFT6zOCDEiAgZdkCk5azpvFYuQEBGZXrsRMsH4sgybWakRFum2M8gN6yGxG7nb0sv+GPgDHUxgPBZeB1pEAc9e7KV6t4CI8wusO7fDV26Tvr6pvE9Zs4YmdJIKW2UQmkQIiV2LrQhLFcdhcQ4juFisAwOJDYbnBRCVinN90FhG6p1SbA2l1AaEJA3ZIkBUK31HQMnykQYgTULcEpELqlpmP4TIEQI6BuCU6B0C01HcNnCoQYAXVLcAqEbqnpGD5TIMQIqFuCUyB0S03H8JkCIUZA3RKcAqFGTWMtVld9mUiBUAMIzruBD5YuSUdeUyDEVlsHr1CK5W0xQgqERVlE3nXomkXLi04O4uRA8GU/A5eBdrK2xEYXY/ctRFZ73vrSrK8cm8f9csmFGZnlmnrW47WasHgguLOhPb1g1/lj6VbnDaQC8OJsJy3WTlRwqmO1NPJ2gChmdjSOD1bJF39WZ7SGT8H6ZcuJsccfJyAnHgib3ZHAPu0hYPNrh42nq8b+eh6G9GFVBK6yTF+e5A/QYipb5nl8sGwSWQzvkDtyjHrlRdO4h3V/mq+ShPN213ggLO4c5hmC3BnMTbF1M3WZt9VVKlW/7w65UDMz0Xs4jzxrN/362p6Z2Hnaj3XDA09xsTzI+suYDj0eCG7vo2/eRM7OSkonAYG0Cp8wlPAW7pW0epq7j3KzZ1uRaWNPve0kTi3l4AubkXy/gObKOlPqxjGP2i6KXednd/24p6jr3JwVWE/msCqZd6AuN9uxQlTktvTj8Naenq6DkQEO+dCPHMAYoI7TeqpOaHsG2YE8BsOG2/pgds+bFkKtfYQ6g+Qkm2Dt7melH9v3LiB1MOg3NTdAtr2zLYRvADQ2hfOE9MtC86GsVf9RDLguwy//ByzGua4wKmZb+qFafFiTI20/VUXvDSFySwvsI4jtpMAAFeT6z7TGAcT14L7c9i+SFqz8S+tih1SP+RcRTF8fLb5EOncsjt478RPw+GNEsqYA8NABjvv50A2SWPMCjYdZmmt0gyGG4scINrJVK8Xckyjkv6FyqHrqqppQGat+K/VvK46nt2YCyydP6Uf3vy+2IisCiiaN5oUlxJhv4OBP3pbr97DR+ayyLzlegMYegkGtN2A752mWL6aScd51HC2JgEBkmV27+nB9Txn/gSDTUyAcWiyzAIwraRXD5QWBHQJed7WXGQDN/6mKOUt3z9FYALvDyfTeZ/4WBjsnoWo3gkm+k7NHtBBbRX7qFmWp4V+2fpyoh27B6Af14xOvCq1btsTyy/wTAYERFU5YF9t9FI5RD0M4tEwGIWPixQTawYHCXSVh6I8l2nq4OLX8wuHuninj4kMM+EfjWbCb5G1EPz+L1vFbAPEx0QY0RJnAVeYTcrnbYatxGjaYPsw8UTwFbodlji53XZqvo9VdGe7uw2ncvQtbGs/lG4onlcxnmQEVK3dZlcsNQht8U+/dZw2M5kcySc92CBftiqt5lSPoYa6NEWDd8yGooT+UwaPv44BqAQRbDF9VZG42EBdjyzytna519+TBysVeOf6kOVk6N60b3oDqwl2YROQfJpeBS3DPkdIAgJqRCjR6FwTzgjMfjLDEzvGLE2AvAE3fhtlh2J8uc2x0HKW6lkaS2aBCsnQ8ktZqHuxz2H/pPcljGscvnwOeOafBf4s8s8wc6mBApF72vwnNR9Cz0YrhdKZO4kLEJ4kOCtB/OtVpbrn2DhBxN34XSD9MGPgyk8FWR0HZCmrxpAyKCQAjAyNUgsnChz/IDL9ymbOHBzCv8mWNE9/NH1zZG/u6WIN9J1AxVedl7kc1wNakNyTVTlZxLC/oKaFYxy8hwcpqnVvUPwRcBuXhPGiUyDPLOXg35hAKfVjv2fcgC3WG03mf1DUMBGZszbqO+FQ7ENSw6indCGKuADGfQCgNONEoZ08wSGMSCqd1zomZwBPVaOaROWwR493ZmB8CDBP6if3/wAJlbBNxUm0jxISBZG69/tcg/FGUdQnyOAtXWJqDBtKoFYKQbiV4Zb7CL76XwPAPfu/g9wqUx4so9ym95zuv45nmgxvSBExD1zTJ0ocemsRxwJOVDxuwbLpFZbLbQPAWkASbwGoDiuAbBs5LDqtIKbv5P2LGycNA1UfL17Mo6x0MCN9Qpb7XORZwGTfTHbi0S69ije3SA0WdFy1Hgfer7MJ2tMozURmnIz4MV0FFa8M3DrbcVjq8tcAMsIeZXaPeRcUfUYXitB5/9rArhADgtLl7/XX+Sa9NA8EV4MzVtfocZpd/o1c0Go0pVYKvAFC4frzRbCLjC/hhl3ol8o4sMIGnAOD0Y7rZrs8VsWwguIzcOUpq8zz0QD/eJbb6cirZML7t0+3Y4RS6S9L8dWrK0s2pU34bGJixLXBu2Ec5paQj5WYJELD9zl1ZVThoZyhZ7tBrBrTY9/VW8koiye8MjhzmEcu0DOtkvGm+rPN28N4sLy5dy4DgMgxfUfMrmj/LQgGtA1iY+CbuV5rfduK1CfGkSVIJpBJIJZBKIJVAKoFUAqkEUgmkEuhoCfw/vJfHMO4YqncAAAAASUVORK5CYII=",36,36)
var a
return i.artwork=s,i.accessibilityLabel=r,Jh(e,i,(a={targetType:tV,pageInformation:t,locationTracker:n,recoMetricsData:null},ym.context("impressionOptionsForArcadeSeeAllGamesRibbonItem",()=>({...a,id:vB,idType:wW,kind:null,softwareType:null,title:"All Games"})))),i}static createTagsRibbonShelf(e,t){const n=ve(t,GE),r=new pK("ribbonFlow"),o=[]
for(const t of n){const n=(0,bm.attributeAsString)(t,cz)
let r=null
switch(t.type){case SB:r=(0,bm.attributeAsString)(t,BW)
break
case CH:r=ji(e,f(t,uj))}if((0,mm.isNothing)(r))continue
const i=e.required(R9).fetchFlowPage(r),s=new _J(i)
if(s.pageUrl=r,(0,mm.isSome)(n)){const e=new S6(n,s)
o.push(e)}}return r.items=o,r.isHorizontal=!0,r}static shouldPriorizeItemWithData(e,t){var n,r
return null!==(r=null===(n=e.userDefaults)||void 0===n?void 0:n.bool(wS))&&void 0!==r&&r&&e.bag.ribbonBarVisionEditorialItemIds.includes(t.id)&&e.bag.enableDeviceDrivenDiscoveryContent}}class C6{constructor(e,t,n){this.$kind="SmallBreakout",this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class I6 extends u5{constructor(){super("GroupingSmallBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,Aq)===Bq}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,o){const i=[]
for(const o of n.shelfContents){if(r(o.attributes)||Qi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}const n=gh(e,o)
if(zc(0,o)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(o),t.relationshipToFetch=vq
continue}const s={targetType:gS,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(o)}
let a
const c=j(o,Gq)
a=Xe(e,o,aj)?e.loc.uppercased(vh(e,n,c)):c
let l={type:wW};(null==a?void 0:a.length)>0&&(l={type:WH,title:a})
const u=ah(e,o,cz)||Qe(e,n,cz),d=ah(e,o,qV)||Qe(e,n,TV),h=wf(e,n,{useCase:R3.ArcadeSmallBreakout,withJoeColorPlaceholder:!0}),p=ye(f(se(n,tt(e,o),XW),iU))||(null==h?void 0:h.backgroundColor),w=new n6(u,d,l,null,Gc(0,p),null),v=new C6(w,h,p),g=ep(e,o,v.details.title,s),m=Xe(e,fl(0,o),uW)
g.isPreorder=m,Jh(e,v,g),xh(0,g,v.details.title)
const y=Yc(e,o),A={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:bt(o),targetType:lz,id:o.id}
ra(e,y,A),v.details.callToActionButtonAction=y,v.clickAction=y,Bh(s.locationTracker),v.flowPreviewActionsConfiguration=la(e,o,!0,null==t?void 0:t.clientIdentifierOverride,y,s,A),i.push(v)}const s=new pK(gS)
return s.isHorizontal=!1,s.items=i,s.url=ts(0,s,t),0===o.shelves.length&&(s.presentationHints={isFirstShelf:!0}),s}}class k6 extends u5{constructor(){super("GroupingTagBrickShelfController"),this.supportedFeaturedContentIds=new Set([x1,N1])}initialShelfDataFromGroupingMediaApiData(e,t){var n
return(0,mm.isSome)(t)?{shelfContents:null!==(n=we(t,sz))&&void 0!==n?n:null}:{shelfContents:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>({shelfContents:e.data}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,Kb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Gr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,Aq)===Bq,d=new pK(mS),p=h(t.featuredContentData.attributes,Zb)
if(d.rowsPerColumn=null!=p?p:Z(e),d.isHorizontal=!0,(0,mm.isSome)(r.shelfContents))for(const n of r.shelfContents){const r=k6.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s);(0,mm.isSome)(null==r?void 0:r.shortEditorialDescription)?((0,mm.isSome)(r)&&a.push(r),Vh(t.metricsLocationTracker)):(t.remainingItems.push(n),c.push(n))}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.contents.data"))&&(0,mm.isSome)(t.featuredContentData.relationships)&&(t.featuredContentData.relationships[sz].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,iF)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const w=u(t.featuredContentData.attributes,FD)
if(l&&w){const n=new pK(Ex)
n.items=a,n.presentationHints={isSeeAllContext:!0}
const r=new gK([n])
r.title=t.title
const o=new _J(fz)
o.title=e.loc.string(nq),o.pageData=r,d.seeAllAction=o,oa(e,o,"",{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}return d&&o(d.items)&&t.isFirstRender&&cc(e,d,t,t.featuredContentId),t.presentationHints=d.presentationHints,d.url=ts(0,d,t),d}static createBrick(e,t,n,r,o,s,a){var c,l
const u=null!==(c=bt(t))&&void 0!==c?c:void 0,d={targetType:n?LV:sj,pageInformation:r,locationTracker:o,recoMetricsData:u},f=us(e,t)
if(!f){const e=new A5
return e.shortEditorialDescription=j(t,cz),e}const h=new A5,p=(R3.GroupingBrick,cs(e,t,0,0,0,d))
if(p.length>0){const e=p[0].backgroundColor
h.collectionIcons=p,(0,mm.isSome)(e)&&(null==e?void 0:e.type)===PH&&(h.backgroundColor=null!==(l=mh(e))&&void 0!==l?l:void 0)}h.accessibilityLabel=f.title,h.shortEditorialDescription=f.shortEditorialDescription,h.clickAction=f.action,435===q(t,xV)&&(h.personalizationStyle=AB)
const w=pe(e,t,sz)
if(i(w)){const n=ea(e,w,d),r=null==s?void 0:s.clientIdentifierOverride
h.flowPreviewActionsConfiguration=la(e,t,!0,r,h.clickAction,d,n)}return Jh(e,h,ep(e,t,f.title,d)),h.artworkSafeArea=T5.defaultTileArtworkSafeArea,h.textSafeArea=T5.defaultTileTextSafeArea,h.isValid()?h:null}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,Aq)===Bq&&(r.title=MD),r}}class O6{constructor(e,t,n,r){this.impressionMetrics=null,this.badge=e,this.title=t,this.subtitle=n,this.$kind=null!=r?r:"PageHeader"}}class E6 extends O6{constructor(e,t,n,r,o,i,s,a,c,l){super(e,t,n,"MediaPageHeader"),this.artwork=r,this.video=o,this.collectionIcons=i,this.useGeneratedBackgroundGradient=s,this.backgroundColor=a,this.style=c,this.backgroundStyle=l}}class D6{constructor(e,t){this.$kind="TitledButton",this.title=e,this.action=t}}class R6{constructor(e){this.$kind="TitledButtonStack",this.buttons=e}}class _6{constructor(e,t,n){this.$kind="UnifiedMessage",this.placement=e,this.context=t,this.deliveryMethod=null!=n?n:"pushAndPull"}}const L6=[new v5,new y5,new b5,new P6,new S5,new C5,new k5,new R5,new d5,new $5,new G5,new E5,new p6,new w6,new g6,new A6,new T6,new b6,new I6,new w5,new class extends u5{constructor(){super("GroupingMediaPageHeaderShelfController"),this.supportedFeaturedContentIds=new Set([585])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,sz)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await u5.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){var o
if(!Wi(e,BV))return null
const i=n.shelfContents[0]
let s
if((0,mm.isSome)(i)){s=null!==(o=null==r?void 0:r.pageTitle)&&void 0!==o?o:null
const t=df(e,p(qc(e,i),"categoryDetailStatic16x9"),{withJoeColorPlaceholder:!0,useCase:R3.Default,cropCode:"CDS.ApTCHM01"})
if((0,mm.isSome)(s)&&(0,mm.isSome)(t)){const e=be(t.backgroundColor),n=new E6(null,s,null,t,null,null,!1,null,null,e?MW:iW),r=new pK(Sx)
return r.items=[n],r}return null}return null}},new k6]
class M6{constructor(e,t,n,r,o,i,s,a){this.$kind="PrivacyType",this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class F6{constructor(e,t,n,r,o=[]){this.$kind="PrivacyCategory",this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}class $6{constructor(e,t,n){this.$kind="PrivacyPurpose",this.identifier=e,this.title=t,this.categories=n}}class x6{constructor(e,t){this.$kind="PrivacyHeaderSupplementaryItem",this.bodyText=e,this.action=t}}class N6{constructor(e,t,n,r,o,i){this.$kind="PrivacyHeader",this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class B6{constructor(e,t,n){this.$kind="PrivacyFooter",this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class U6{setShelfId(e,t){this.shelfId=e,this.index=t,O4.has(e)&&(this.section=new hK(pz,e))}}class G6{constructor(e,t){this.$kind="AccessibilityParagraph",this.text=e,this.actions=t}}class j6{constructor(e,t,n){this.$kind="AccessibilityFeatures",this.title=e,this.artwork=t,this.features=n}}class V6{constructor(e,t,n){this.$kind="AccessibilityFeature",this.title=e,this.description=t,this.artwork=n}}class H6{constructor(e,t={}){this.$kind="AnnotationItem",this.text=e,this.heading=t.heading,this.headingArtworks=t.headingArtworks,this.listText=t.listText,this.textPairs=t.textPairs}}class q6{constructor(e,t,n,r){this.$kind="Annotation",this.title=e,this.summary=n,this.items=t,this.items_V3=[],this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class W6{constructor(e,t,n,r,o,i,s){this.$kind="ProductCapability",this.type=e,this.title=t,this.caption=n,this.captionTrailingArtwork=r,this.linkAction=o,this.artwork=i,this.artworkTintColor=s}}const{routes:z6,makeCanonicalUrl:Y6}=yc(ki,"/{platform}/story/{id}"),{routes:J6,makeCanonicalUrl:K6}=mc(ki,"/story/{id}")
class Z6 extends Sz{constructor(e){super(),this.$kind="FlowBackAction",this.actionClass="FlowBackAction",this.dismissal=e}}class Q6{constructor(e,t,n){this.$kind="AnnotationGroup",this.title=e,this.annotations=t,this.forceExpanded=n}}class X6{constructor(e){this.$kind="InformationContainer",this.annotationGroups=e}}const e3=[Eu,Ru,Kl,ru,_u,Zl,iu,hu,fu,du,eu,Lu,su,au,pu,ou],t3=[Ru,Kl,ru,_u,Zl,iu,hu,fu,du,eu,Lu,su,Eu,au,pu,ou],n3=[Eu,Kl,function(e,t,n,r,o,i){const s=Ze(e,t,nG)
if(0===s.length)return null
const a=s[0]
let c=null
const l=f(a,XU)
if(l){const t=e.loc.string("ProductPage.VersionAnnotation.Value.DateFormat")
c=e.loc.formatDate(t,new Date(l))}const u=f(a,b_)
if(0===s.length)return null
let d
if(u&&c)d=e.loc.string("ProductPage.VersionAnnotation.Value").replace("@@version@@",u).replace(tT,c)
else{if(!u)return null
d=u}const h=new H6(d),p=o?"":e.loc.string("ProductPage.VersionAnnotation.Title"),w=new q6(p,[h])
return w&&!r?w:null},Ru,au,ou],r3=[Zl,fu,eu,function(e,t,n,r,o,i){const s=[],a=Xl(e,t);(0,mm.isSome)(a)&&s.push(a)
const c=nu(e,t)
if((0,mm.isSome)(c)&&s.push(c),0===s.length)return null
const l=e.loc.string("InfoList.AgeRating.Title.KR"),u=new q6(l,s)
return u.shouldAlwaysPresentExpanded=!0,u}]
class o3{constructor(e,t,n,r){this.$kind="ProductDescription",this.paragraph=e,this.developerAction=r,this.tags=n,this.developerLinks=t}}class i3{constructor(e,t,n,r){this.$kind="ProductPageLink",this.text=e,this.clickAction=t,this.systemImageName=n,this.adamIdForPurchaseHistoryFilter=r}}const s3="safari",a3="hand.raised.fill",c3="doc.plaintext",l3="questionmark.circle",u3="exclamationmark.triangle",d3="checkmark.seal"
class f3{constructor(e,t){this.$kind="EditorialQuote",this.text=e,this.attribution=t}}class h3 extends Sz{constructor(e){super(),this.$kind="GameCenterPlayerProfileAction",this.actionClass="GameCenterPlayerProfileAction",this.playerId=e}}class p3{constructor(e,t,n,r,o){this.$kind="InformationRibbon",this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class w3{constructor(e,t,n,r,o,i,s,a,c,l=_q){this.$kind="Badge",this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r,this.isMonochrome=!0}}const v3="DeveloperPageIntent",g3=[ju,td,Uu,Ku,Zu,zu,function(e,t,n,r){var o
return null!==(o=Vu(e,t))&&void 0!==o?o:Hu(e,t)},Ju],m3=[ed,Yu,Gu,ju,td],y3=[ed,ju,td,Vu,function(e,t,n,r){if(!Xe(e,t,yU))return null
const o=e.loc.string("BADGE_FRIENDS_HEADING","Friends"),i=rz,s=fW,a=fW,c={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:t.id}
return new w3(s,a,c,i,o,"",void 0,"",o,_q)},Gu,Uu,Ku,Zu,zu,Hu,Ju,function(e,t,n,o){if(it(e).isSystemAppFromData(t))return null
const i=Hf(e,t)
if(r(i)||r(i.fileSizeByDevice))return null
const s=function(e,t){let n
if((0,Am.isNothing)(t.fileSizeByDevice))return
if(n=(0,Am.isSome)(t.maxEssentialInstallSizeInBytes)?t.fileSizeByDevice+t.maxEssentialInstallSizeInBytes:(0,Am.isSome)(t.maxInstallSizeInBytes)?t.fileSizeByDevice+t.maxInstallSizeInBytes:t.fileSizeByDevice,n<=0||Number.isNaN(n))return
const r=e.loc.fileSize(n).trim().split(/\s+/)
return 2===r.length?{size:r[0],unit:r[1]}:void 0}(e,i)
if(!s)return null
const a={paragraphText:s.size},c=s.unit,l=e.loc.string("BADGE_SIZE_HEADING")
return new w3(OV,FU,a,rz,l,c,void 0,void 0,c,lH)}]
class A3{constructor(e,t,n){this.$kind="TitledParagraph",this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}!function(e){e.StoryCenteredMotion16x9="storyCenteredMotion16x9",e.StoryCenteredStatic16x9="storyCenteredStatic16x9",e.StoryDetailMotion3x4="storyDetailMotion3x4",e.StoryDetailStatic3x4="storyDetailStatic3x4",e.HeroMotion16x9="heroMotion16x9",e.HeroStatic16x9="heroStatic16x9",e.HeroMotionRTL16x9="heroMotionRTL16x9",e.HeroStaticRTL16x9="heroStaticRTL16x9",e.LargeBreakoutMotion16x9="largeBreakoutMotion16x9",e.LargeBreakoutStatic16x9="largeBreakoutStatic16x9",e.LargeBreakoutRTLMotion16x9="largeBreakoutRTLMotion16x9",e.LargeBreakoutRTLStatic16x9="largeBreakoutRTLStatic16x9",e.StoryCardMotion3x4="storyCardMotion3x4",e.StoryCardStatic3x4="storyCardStatic3x4",e.StorySearchStatic16x9="storySearchStatic16x9",e.SubscriptionHero="subscriptionHero",e.UniversalAMotion16x9="universalAMotion16x9",e.UniversalAStatic16x9="universalAStatic16x9",e.BrickStatic16x9="brickStatic16x9",e.BrickStaticRTL16x9="brickStaticRTL16x9",e.SearchCategoryBrick="searchCategoryBrick"}(dy||(dy={})),function(e){e.Hero="hero",e.LargeBreakout="largeBreakout",e.StoryCard="storyCard",e.StoryDetail="storyDetail",e.StoryDetailLandscape="storyDetailLandscape",e.Search="search",e.Brick="brick",e.EditorialLockup="editorialLockup",e.EditorialPage="editorialPage"}(fy||(fy={}))
const T3={hero:[dy.HeroMotion16x9,dy.HeroStatic16x9,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],largeBreakout:[dy.LargeBreakoutMotion16x9,dy.LargeBreakoutStatic16x9,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyCard:[dy.StoryCardMotion3x4,dy.StoryCardStatic3x4,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyDetail:[dy.StoryDetailMotion3x4,dy.StoryDetailStatic3x4,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyDetailLandscape:[dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9,dy.StoryDetailMotion3x4,dy.StoryDetailStatic3x4],search:[dy.StorySearchStatic16x9,dy.StoryCenteredStatic16x9,dy.UniversalAStatic16x9],brick:[dy.BrickStatic16x9,dy.HeroStatic16x9,dy.StoryCenteredStatic16x9,dy.UniversalAStatic16x9,dy.SearchCategoryBrick],editorialLockup:[dy.SubscriptionHero],editorialPage:[dy.StoryCardStatic3x4,dy.HeroStatic16x9,dy.StoryCenteredStatic16x9,dy.SubscriptionHero]},b3={hero:[dy.HeroMotionRTL16x9,dy.HeroStaticRTL16x9,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],largeBreakout:[dy.LargeBreakoutRTLMotion16x9,dy.LargeBreakoutRTLStatic16x9,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyCard:[dy.StoryCardMotion3x4,dy.StoryCardStatic3x4,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyDetail:[dy.StoryDetailMotion3x4,dy.StoryDetailStatic3x4,dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9],storyDetailLandscape:[dy.StoryCenteredMotion16x9,dy.StoryCenteredStatic16x9,dy.UniversalAMotion16x9,dy.UniversalAStatic16x9,dy.StoryDetailMotion3x4,dy.StoryDetailStatic3x4],search:[dy.StorySearchStatic16x9,dy.StoryCenteredStatic16x9,dy.UniversalAStatic16x9],brick:[dy.BrickStaticRTL16x9,dy.HeroStatic16x9,dy.StoryCenteredStatic16x9,dy.UniversalAStatic16x9,dy.SearchCategoryBrick],editorialLockup:[dy.SubscriptionHero],editorialPage:[dy.StoryCardStatic3x4,dy.HeroStatic16x9,dy.StoryCenteredStatic16x9,dy.SubscriptionHero]}
class S3{constructor(e){this.$kind="MetadataRibbonItem",this.viewType=e,this.moduleType=null,this.labelText=null,this.borderedText=null,this.highlightedText=null,this.starRating=null,this.secondaryViewPlacement=QW,this.artwork=null,this.maxCharacterCount=null,this.truncationLegibilityCharacterCountThreshold=null,this.allowsTruncation=null}}const P3={chartPositions:function(e,t,n,r,i){var s,a
const c=function(e,t){const n=Ke(e,t,r_)
if(o(n))return null
const r=Kf(0,e.host.clientIdentifier)
return o(r)?null:p(n,r)}(e,t)
if(o(c))return null
const l=h(c,EF)
if((0,Am.isNothing)(l)||l>50)return null
const u=null!==(s=f(c,"genreShortName"))&&void 0!==s?s:f(c,vC)
if(null!=u){if(r.has(u))return null
r.add(u)}let d
d=e.bag.isLLMSearchTagsEnabled?new S3("highlightedText"):new S3("borderedTextLabel"),d.moduleType=r_
const w=(0,Am.isSome)(null===(a=n.searchAdOpportunity)||void 0===a?void 0:a.searchAd)||(0,Am.isSome)(n.searchAd)?e.bag.adsOverrideLanguage:null,v=(0,Am.isSome)(w)?e.adsLoc:e.loc
{const t=v.string("MetadataRibbon.ChartPosition").replace(DI,e.loc.formattedCountForPreferredLocale(e,l,w))
e.bag.isLLMSearchTagsEnabled?(d.highlightedText=t,d.labelText=v.string("MetadataRibbon.ChartPositionAndCategory.Tags").replace(DI,e.loc.formattedCountForPreferredLocale(e,l,w)).replace("@@category@@",u)):(d.labelText=u,d.borderedText=t)}return d.secondaryViewPlacement=QW,Kh(e,d,np(i,n$,d.labelText,ez)),[d]},genreDisplayName:function(e,t,n,r,i){const s=Sn(e,t,!0),a=(0,mm.isSome)(s),c=xd(e,t)
if(o(c))return null
if(null!=c){if(r.has(c))return null
r.add(c)}const l=new S3(a?v$:hN)
if(l.moduleType=KV,l.labelText=c,a){const t=df(e,s,{useCase:R3.CategoryIcon})
t.crop="sr",l.artwork=t}return Kh(e,l,np(i,KV,l.labelText,ez)),[l]},genreShortDisplayName:function(e,t,n,r,o){const i=Sn(e,t,!0),s=(0,mm.isSome)(i),a=j(t,dN)
if(null!=a){if(r.has(a))return null
r.add(a)}if((0,mm.isNothing)(a)||0===a.length)return null
const c=new S3(s?v$:hN)
return c.moduleType=dN,c.labelText=a,s&&(c.artwork=df(e,i,{useCase:R3.CategoryIcon,cropCode:"sr"})),Kh(e,c,np(o,KV,c.labelText,ez)),[c]},secondaryGenreShortDisplayNames:function(e,t,n,r,i){const s=G(t,U_)
return o(s)?null:s.map(t=>{const n=new S3(hN)
n.moduleType=dN,n.labelText=t
const r=np(i,KV,n.labelText,ez)
return Kh(e,n,r),Vh(i.locationTracker),n}).filter(e=>null!=e.labelText&&!r.has(e.labelText))},developerInfo:function(e,t,n,r,o){var i
let s=n.developerName
if((0,mm.isNothing)(s)&&(s=null!==(i=j(t,eq))&&void 0!==i?i:j(t,kS)),null!=s){if(r.has(s))return null
r.add(s)}if((0,mm.isSome)(s)&&s.length>0){const t=new S3(v$)
t.moduleType=RI,t.labelText=s,t.artwork=kt(e,o$)
const n=6
return t.maxCharacterCount=16,t.truncationLegibilityCharacterCountThreshold=Math.min(n,s.length),t.allowsTruncation=s.length>=n,Kh(e,t,np(o,RI,t.labelText,ez)),[t]}return null},editorialBadgeInfo:function(e,t,n,r,o){var i
if(n.isEditorsChoice){const t=new S3(Iq)
return t.moduleType=dj,t.useAdsLocale=((0,Am.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd)||(0,Am.isSome)(n.searchAd))&&(0,Am.isSome)(e.bag.adsOverrideLanguage),Kh(e,t,np(o,dj,"Editors Choice",ez)),[t]}return null},userRating:function(e,t,n,r,o){const s=Xe(e,t,uW)
if(i(n.ratingCount)&&i(n.rating)&&!s){const t=new S3("starRating")
return t.moduleType=LG,t.starRating=n.rating,t.labelText=n.ratingCount,Kh(e,t,np(o,LG,"User Rating",ez)),[t]}return null},supportsGameController:function(e,t,n,r,o){var i
let s=!1
switch(Qe(e,t,hV)){case U$:case XL:s=!0}if(Xe(e,t,eL)&&(s=!0),!s)return null
const a=new S3(v$)
a.moduleType=eL
const c=((0,Am.isSome)(n.searchAd)||(0,Am.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd))&&(0,Am.isSome)(e.bag.adsOverrideLanguage)
return a.labelText=c?e.adsLoc.string($U):e.loc.string($U),a.artwork=kt(e,$B),Kh(e,a,np(o,eL,"Supports Game Controller",ez)),[a]},tag:function(e,t,n,r,o){const i=t,s=new S3(hN)
return s.moduleType=$x,s.labelText=j(i,cz),(0,mm.isNothing)(s.labelText)||0===s.labelText.length||r.has(s.labelText)?null:(Kh(e,s,np(o,i.id,s.labelText,"tag_id")),r.add(s.labelText),[s])},divider:function(e,t,n,r,o){const i=new S3(_I)
return i.moduleType=_I,i.labelText="|",[i]}},C3=0,I3=1,k3=2,O3=3,E3=4,D3=5,R3={Default:0,LockupIconSmall:1,LockupIconMedium:2,LockupIconLarge:3,LockupScreenshots:4,ArcadeSmallBreakout:5,ArcadeLargeBreakout:6,ArcadeContextualUpsell:7,SearchIcon:8,SearchEditorialResult:9,ProductPageIcon:10,ProductPageScreenshots:11,ProductPageBadge:12,ArticleImage:13,ArticleScreenshots:14,TodayCardMedia:15,TodaySmallStoryCard:16,TodayCardBrandedTitle:17,GroupingBrick:18,GroupingHero:19,CategoryIcon:20,Uber:21,TVTopShelf:22,VideoCardStill:23,ArcadeWelcomeSheet:24,WidgetLockupIcon:25,WidgetEditorial:26,ImageLockup:27,CategoryBreakoutShelf:28,RibbonBarFacet:29,MediaPageHeader:30}
class _3{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}!function(e){e[e.seeAllPage=0]="seeAllPage",e[e.categoryBreakout=1]="categoryBreakout",e[e.other=2]="other"}(hy||(hy={}))
class L3{constructor(e,t){this.videos=e,this.mediaPlatform=t}}const M3=new AY(414,896),F3=new AY(375,812),$3=new AY(414,736),x3=new AY(375,667),N3=new AY(320,568),B3=new AY(320,480),U3=(new AY(768,1024),new AY(810,1080)),G3=new AY(834,1112),j3=new AY(834,1194),V3=new AY(1194,834),H3=new AY(1024,1366),q3=new AY(1024,1366),W3=new AY(1366,1024),z3=new AY(744,1133),Y3=new AY(1133,744),J3=new AY(1032,1376),K3=new AY(1376,1032),Z3=new AY(834,1210),Q3=new AY(1210,834),X3=new AY(312,390),e9=new AY(368,448),t9=new AY(396,484),n9=new AY(410,502),r9=new AY(416,496),o9=new AY(410,502),i9=new AY(820,1180),s9=new AY(360,780),a9=new AY(390,844),c9=new AY(428,926),l9=new AY(393,852),u9=new AY(430,932),d9=new AY(402,874),f9=new AY(440,956),h9=new AY(420,912),p9=new AY(422,514),w9=[XE,ZE,QE,FM,tb,eb,XT,OW],v9=112.5,g9=4.5,m9="#9BA9BD",y9={colorHex:m9,maxSaturation:4,maxBrightness:9},A9=[y9],T9=[{colorHex:"#F7816F",minHue:0,maxHue:16},{colorHex:"#FF9034",minHue:17,maxHue:33},{colorHex:"#E3B059",minHue:34,maxHue:59},{colorHex:"#74BD66",minHue:60,maxHue:129},{colorHex:"#72C792",minHue:130,maxHue:169},{colorHex:"#61BFE2",minHue:170,maxHue:209},{colorHex:"#6EA3E9",minHue:210,maxHue:239},{colorHex:"#7D69FA",minHue:240,maxHue:259},{colorHex:"#B363F7",minHue:260,maxHue:289},{colorHex:"#EE7CBD",minHue:290,maxHue:360}]
class b9{constructor(){this.position=0}}class S9 extends qJ{constructor(e,t){super(e.fields,e.id,e.custom||{}),void 0!==this.custom&&(this.custom.isFast=t),this.isFast=t}}const P9="::"
class C9{constructor(e,t,n=0){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t,this.sequenceId=n}addImpressionsToShelf(e,t,n,r,o,i,s){Jh(e,t,{id:null!=r?r:`${this.sequenceId}`,idType:null!=o?o:pW,kind:null,softwareType:null,targetType:n,title:null!=s?s:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,recoMetricsData:i}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n,r){t&&(Jh(e,t,{id:C9.similarItemsShelfId,kind:null,softwareType:null,targetType:n,title:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:r}),this.sequenceId++)}static resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,t){const n=t.sourceLocationTracker
jh(n,0),Gh(n).id=C9.similarItemsDuringDownloadShelfId}static addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,t,n){t&&Jh(e,t,{id:C9.similarItemsDuringDownloadShelfId,kind:null,softwareType:null,targetType:Qq,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:OG})}}C9.similarItemsShelfId=mj,C9.similarItemsDuringDownloadShelfId=nE
const I9="write-review",k9=_W,O9="appPromotionRequirementKey"
Pe(ye("F0F0F8"),ye("303031")),function(e){e.MoreByDeveloper="moreByDeveloper",e.SimilarItems="similarItems",e.SmallStory="smallStory"}(py||(py={})),function(e){e.SelectionOnly="selectionOnly",e.PurchaseAndOpen="purchaseAndOpen"}(wy||(wy={}))
class E9{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.isFirstRender=!0,this.isBundleShelf=!1,this.showingPlaceholders=!1,this.productId=e,this.onDemandShelfType=d,this.remainingItems=t,this.title=n,this.shouldInferSeeAllFromFetchesItems=r,this.capabilities=o,this.contentType=i,this.offerStyle=s,this.spotlightInAppProductIdentifier=a,this.refreshUrl=c,this.recoMetricsData=l,this.supportsArcade=u}static fromJSON(e,t){if((0,Am.isNothing)(t))throw new Error("tokenJson is required")
const n=JSON.parse(t,(t,n)=>typeof n===vH&&"adPageInfo"===t&&s(n)&&(0,Am.isSome)(e)?o2.from(e,n):n)
return n}}const D9=[dV,sq,XW,Xq],R9=(0,Tm.makeMetatype)("app-store:page-router")
class _9{constructor(){this.registeredBuilders=new Set,this.pageRouter=new aY,this.shelfRouter=new aY,this.paginationRouter=new aY}registerPageBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.pageRouter.associate(t.pageRoute(e),t),this.shelfRouter.associate(t.shelfRoute(e),t),this.paginationRouter.associate(t.paginationRoute(e),t)}registerShelfBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.shelfRouter.associate(t.shelfRoute(e),t)}registerPaginationBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.paginationRouter.associate(t.paginationRoute(e),t)}fetchFlowPage(e){const t=this.pageRouter.routedObjectForUrl(e)
if(!t.object)return"unknown"
const n=t.object
return n.builderClass===TT&&t.parameters[Hz.action]!==k9&&t.parameters[Hz.action]!==I9?fq:n.pageType()}async fetchPage(e,t,n){return await this.fetchAction(e,t,null).then(async r=>await new Promise((o,i)=>{if(!r)throw new Error(`Promise resolved to null action for: ${t}`)
if(r.actionClass!==WL){if(r.actionClass===UO){const e=r
if(1===e.actions.length&&e.actions[0].actionClass===WL){const t=e.actions[0].pageData
return P(t,n)?void o(t):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(t)}`))}}i(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const s=r.pageData
if(!P(s,n)){const a=r.pageUrl
return a&&a!==t?void this.fetchPage(e,a,n).then(e=>{o(e)}).catch(e=>{i(e)}):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(s)}`))}o(s)}}))}async fetchAction(e,t,n,r=new Set){var o
const i=this.pageRouter.routedObjectForUrl(t)
if(!i.object)return await this.redirectAndRefetchActionIfPossible(e,i.normalizedUrl,r)
const s=i.object
return await s.handlePage(e,i.normalizedUrl,null!==(o=i.parameters)&&void 0!==o?o:{},i.matchedRuleIdentifier,n)}async fetchMoreOfPage(e,t){const n=t.url
if(!n)throw new Error("Page token missing required `url` property")
const r=this.paginationRouter.routedObjectForUrl(n)
if(!r.object)throw new Error(`fetchMoreOfPage: Unhandled pagination url: ${n}`)
const o=r.object
return await o.handlePagination(e,r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t)}async fetchShelves(e,t){const n=Object.keys(t),r=n.map(e=>t[e]),o=await L(r.map(async t=>{if((0,mm.isNothing)(t))throw new Error("fetchShelves: Null shelf url")
const n=this.shelfRouter.routedObjectForUrl(t)
if((0,mm.isNothing)(n.object))throw new Error(`fetchShelves: Unhandled shelf url: ${t}`)
const r=n.object
return await r.handleShelf(e,n.normalizedUrl,n.parameters,n.matchedRuleIdentifier)})),i={shelves:{},errors:{}}
for(const[e,t]of o.entries()){const r=n[e];(0,mm.isNothing)(r)||(t.success?i.shelves[r]=t.value:i.errors[r]=t.error)}if(Object.keys(i.shelves).length>0)return i
{const e=Object.keys(i.errors).map(e=>i.errors[e].message)
throw 0===e.length?new Error(`Could not load any shelves: ${JSON.stringify(t)}`):new Error(e.join("\n"))}}async redirectAndRefetchActionIfPossible(e,t,n=new Set){const r=t.toString()
if(n.has(r))throw new Error(`redirectAndRefetchActionIfPossible: Redirect cycle detected for URL: ${r}`)
n.add(r)
const o=await M(e.network.fetch({url:r,method:YB}))
if(!o.success)throw new Error(`redirectAndRefetchActionIfPossible: Failed to fetch page at url: ${t}`)
const i=o.value
if(this.hasGotoURLInResponse(e,i))return new Pz
if(200===i.status&&i.redirected&&i.url)return await this.fetchAction(e,i.url,null,n)
throw new Error(`redirectAndRefetchActionIfPossible: Unhandled page url: ${t}`)}hasGotoURLInResponse(e,t){if(o(t.body))return!1
try{const n=m(e.plist.parse(t.body)),r=f(n,OE),o=f(n,EE)
return!(r!==DE||!(0,mm.isSome)(o))}catch{return!1}}fetchBuilder(e){const t=this.pageRouter.routedObjectForUrl(e)||this.shelfRouter.routedObjectForUrl(e)||this.paginationRouter.routedObjectForUrl(e)
return t?t.object:null}}vy=e(9100)
const L9={bag:(gy=e(1222)).bag,dispatcher:(0,Tm.makeMetatype)("dispatcher"),host:gy.host,localizer:gy.localizer,network:gy.net,plist:gy.plist,platform:gy.platform,router:(0,Tm.makeMetatype)("router"),client:(0,Tm.makeMetatype)("client"),debugSettings:(0,Tm.makeMetatype)("debugSettings"),nativeIntentDispatcher:(0,Tm.makeMetatype)("nativeIntentDispatcher"),personNameComponentsFormatter:(0,Tm.makeMetatype)("personNameComponentsFormatter")},M9=(0,Tm.makeMetatype)("app-store:active-intent")
class F9{constructor(e){this.implementation=e,this.inferredPreviewPlatform=void 0}setInferredPreviewPlatform(e){this.inferredPreviewPlatform=e}get previewPlatform(){var e
return null!==(e=this.inferredPreviewPlatform)&&void 0!==e?e:this.implementation.previewPlatform}get platform(){if((0,Am.isSome)(this.previewPlatform))switch(this.previewPlatform){case IW:case OW:case iz:case oz:return this.previewPlatform
case"tv":return HU
case zW:return zH
default:F(this.previewPlatform)}}get attributePlatform(){if((0,Am.isSome)(this.previewPlatform))switch(this.previewPlatform){case OW:case IW:return AW
case iz:return rq
case"tv":return WV
case zW:return ZH
case oz:return oz
default:F(this.previewPlatform)}}get appPlatform(){if((0,Am.isSome)(this.previewPlatform))switch(this.previewPlatform){case IW:return HW
case OW:return ZW
case iz:return iz
case"tv":return"tv"
case zW:return zW
case oz:return oz
default:F(this.previewPlatform)}}}const $9=(0,Tm.makeMetatype)("app-store:locale")
class x9{constructor(e){this.objectGraph=e}get activeStorefront(){return this.objectGraph.bag.mediaCountryCode}get activeLanguage(){return this.objectGraph.bag.language}setActiveLocale(e){}normalize(e){return{storefront:this.activeStorefront,language:this.activeLanguage}}deriveLocaleForUrl(e){return e}}const N9=(0,Tm.makeMetatype)("app-store:seo")
class B9 extends XY{get isSupportEnabled(){return B9.cache.get("isSupportEnabled",()=>i(this.implementation)&&this.implementation.isSupportEnabled)}get isRosettaAvailable(){return B9.cache.get("isRosettaAvailable",()=>i(this.implementation)&&this.implementation.isRosettaAvailable)}}B9.type=(0,Tm.makeMetatype)("app-store:as-wrapper"),B9.cache=new eJ
class U9 extends XY{constructor(){super(...arguments),this.cache={}}registerBagKeys(e){this.implementation.registerBagKeys(e)}string(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.string(e))&&void 0!==t?t:void 0})}double(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.double(e))&&void 0!==t?t:void 0})}integer(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.integer(e))&&void 0!==t?t:void 0})}boolean(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.boolean(e))&&void 0!==t?t:void 0})}array(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.array(e))&&void 0!==t?t:void 0})}dictionary(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.dictionary(e))&&void 0!==t?t:void 0})}url(e,t=!1){return this.fromCache(e,t,()=>{var t
return null!==(t=this.implementation.url(e))&&void 0!==t?t:void 0})}fromCache(e,t=!1,n){if(t)return n()
{const t=this.cache[e]
if((0,mm.isSome)(t))return t.value
{const t=n()
return this.cache[e]={value:t},t}}}}class G9 extends XY{constructor(e){super(new U9(e)),this.underlyingBag=e}get todayAdMediumLockupScreenshotEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-enabled"))&&void 0!==e&&e}get todayAdMediumLockupScreenshotAnimationEnabled(){var e
return null===(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-animation-enabled"))||void 0===e||e}get trendingSearchesURL(){return this.implementation.url("trending-searches")}get userRateURL(){return this.implementation.url("p2-application-user-rate-content")}get saveUserReviewURL(){return this.implementation.url("save-user-review")}get writeReviewURL(){return this.implementation.url("p2-application-user-write-review")}get passbookMainURL(){return this.implementation.url("passbook")}get metricsConfiguration(){return y(this.implementation.dictionary(gV))}get metricsPaymentNamespaceEnabled(){if(o(this.metricsPaymentTopic))return!1
const e=y(this.implementation.dictionary(aO)),t=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT"),n=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT")
return(0,mm.isSome)(t)&&0!==t.length&&(0,mm.isSome)(n)&&0!==n.length}get metricsPaymentTopic(){var e
return null!==(e=f(this.metricsConfiguration,"topics.APPSTORE_PAYMENTS_ENGAGEMENT_TOPIC"))&&void 0!==e?e:null}get personalizationUserIdEnabled(){const e=p(y(this.implementation.dictionary(aO)),"APPSTORE_PERSONALIZATION")
return(0,mm.isSome)(e)&&0!==Object.keys(e).length}get language(){return this.implementation.string(LL)}get mediaApiLanguage(){return this.implementation.string("language-tag")||this.implementation.string(LL)}get termsAndConditionsURL(){return this.implementation.url("p2-service-terms-url")}get isMonetaryGiftingEnabled(){return this.implementation.boolean("isBuyingScheduledGiftCertificateEnabled")}get accountTopUpURL(){return this.implementation.url("AddFundsUrl")}get accountTopUpTitle(){return this.implementation.string("account-top-up-title")}get isContentGiftingEnabled(){return this.implementation.boolean("isScheduledGiftingEnabled")}get buyButtonMetadataURL(){return this.implementation.url("personalized-buy-buttons/software")}get isTVAppEnabled(){return this.implementation.boolean("uvSearch/nowplaying-enabled")}get emailSupportLinkURL(){return this.implementation.url("supportLinkUrl")}get voteUrl(){return this.implementation.url("voteUrl")}get enableReviewSummarization(){return this.implementation.boolean("enable-review-summarization")}get reviewSummaryReportConcernData(){return y(this.implementation.dictionary("review-summarization-report-concern"))}get reportConcernUrl(){return this.implementation.url("reportConcernUrl")}get reportConcernExplanation(){return this.implementation.string("reportConcernExplanation")}get reportConcernReasons(){return l(m(this.implementation.array("reportConcernReasons")))}get reportProblemEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-report-problem-enabled"))&&void 0!==e&&e}get productPageReportProblemURL(){return this.implementation.string("product-page-report-problem-url")}get productPageReportProblemSADSubscriptionArray(){return l(m(this.implementation.array("product-page-report-problem-sad-subscriptions")))}get productPageReportProblemSecondPartyAppArray(){const e=l(m(this.implementation.array("product-page-report-problem-second-party-apps")))
return o(e)?["1473505534","1416238567","640199958","1529498570","915061776","1130498044","1070072560"]:e}get createAccountUrl(){var e
return null!==(e=this.implementation.url("createAccountUrl"))&&void 0!==e?e:HO}get mediaCountryCode(){return this.implementation.string("countryCode")}get mediaHost(){return this.implementation.url("apps-media-api-host")}mediaEdgeHost(e){return e.host.clientIdentifier===EY?this.implementation.url(E$):this.implementation.string(E$)}get mediaAPICatalogMixedShouldUseEdge(){var e
return null!==(e=this.implementation.boolean("apps-media-api-catalog-mixed-should-use-edge"))&&void 0!==e&&e}get mediaEdgeSearchHost(){return this.implementation.string("apps-media-api-search-edge-host")}get mediaPreviewHost(){return this.implementation.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.implementation.string("notification-settings-media-api-host")}get edgeEndpoints(){return l(m(this.implementation.array("apps-media-api-edge-end-points")))}get mediaAdvertRequestLimit(){var e
return null!==(e=this.implementation.double("apps-media-api-search-ads-limit"))&&void 0!==e?e:4}get searchSortOptions(){return l(m(this.implementation.array("searchSortOptions")))}get ageBands(){return l(m(this.implementation.array("ageBands")))}get redirectUrlWhitelistedQueryParams(){let e=l(m(this.implementation.array("processRedirectUrl/whitelistedQueryParams")))
return o(e)&&(e=["affC",Zk,cO,"at","ct",lO,uO,"itscc",dO,Kk,"ls","partnerId","pt","qtkid","uo"]),e}get redirectUrlEndpoint(){var e
return null!==(e=this.implementation.string("processRedirectUrl/endpoint"))&&void 0!==e?e:"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"}get aristotleParentAppAdamId(){var e
return null!==(e=this.implementation.string("aristotle-app-id"))&&void 0!==e?e:"383941000"}get arcadeAppAdamId(){return this.implementation.string("app-store-app-id")}get arcadeProductFamilyId(){var e
return null!==(e=this.implementation.string("arcade-iap-family-id"))&&void 0!==e?e:this.implementation.string("ocelot-iap-family-id")}get arcadeProductId(){var e
return null!==(e=this.implementation.string("arcade-iap-offer-name"))&&void 0!==e?e:this.implementation.string("ocelot-iap-offer-name")}get arcadeCategoryBarSAGUpliftDisplayRate(){var e
return null!==(e=this.implementation.double("arcade-category-bar-see-all-games-display-rate"))&&void 0!==e?e:0}get isArcadeEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-enabled"))&&void 0!==e&&e}get isAppsGroupingTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-groupings-tags-enabled"))&&void 0!==e&&e}get isAppsProductPageTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-product-page-tags-enabled"))&&void 0!==e&&e}get isAppsSlpTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-slp-tags-enabled"))&&void 0!==e&&e}get searchResultsLearnMoreEditorialId(){return this.implementation.string("transparencyLawEditorialItemId")}get systemApps(){return l(m(this.implementation.array("hideableSystemApps")))}get nonDeletableSystemApps(){const e=m(this.implementation.array("nonDeletableSystemApps"))
return s(e)?l(e):[{id:1635387927,"bundle-id":EA},{id:1635862301,"bundle-id":DA},{id:1584216343,"bundle-id":"com.apple.findmy.finddevices"},{id:1584215960,"bundle-id":"com.apple.NanoWorldClock"},{id:1584215812,"bundle-id":"com.apple.HeartRate"},{id:1584215851,"bundle-id":"com.apple.SessionTrackerApp"},{id:1146562108,"bundle-id":"com.apple.NanoPhone"},{id:1146560473,"bundle-id":Fy},{id:1584215428,"bundle-id":"com.apple.NanoPhotos"},{id:1459455352,"bundle-id":OA},{id:1067456176,"bundle-id":kA}]}get tabsStandard(){return l(m(this.implementation.array("tabs/standard")))}get watchAppsGroupingURL(){var e
return null!==(e=this.implementation.url("watchAppsGrouping"))&&void 0!==e?e:"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"}get requireAgeVerification(){return this.implementation.boolean("requireAgeVerification")}get ageRatingLearnMoreEditorialItemId(){return this.implementation.string("ageRatingLearnMoreEditorialItemId")}get appleSiliconMacUnverifiedBadgeEditorialItemId(){return this.implementation.string("appleSiliconMacUnverifiedBadgeEditorialItemId")}get safariExtensionsGroupingURL(){return this.implementation.url("safariExtensionsGrouping")}get familySubscriptionsLearnMoreEditorialItemId(){return this.implementation.string("familySubscriptionsLearnMoreEditorialItemId")}get familyPurchasesLearnMoreURL(){return this.implementation.url("family-accounts-mismatched-learn-more-url")}get dynamicUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/dynamic-url-patterns")))}get financeUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/url-patterns")))}get webViewRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/v2-url-patterns")))}get arcadePreOrderUpsellLimitSeconds(){var e
return null!==(e=this.implementation.double("arcadePreOrderUpsellLimitSeconds"))&&void 0!==e?e:86400}get recentlyPlayedGamesWindowInSeconds(){var e
return null!==(e=this.implementation.double("recentlyPlayedGamesWindowInSeconds"))&&void 0!==e?e:7776e3}get gamesFriendsPlayedWindowInSeconds(){var e
return null!==(e=this.implementation.integer("games-friends-played-window-in-seconds"))&&void 0!==e?e:15778800}get enableComingSoonToggle(){return this.implementation.boolean("enableComingSoonToggle")}get enableAppAccessibilityLabels(){var e
return null!==(e=this.implementation.boolean("enable-app-accessibility-labels"))&&void 0!==e&&e}get enablePrivacyNutritionLabels(){var e
return null!==(e=this.implementation.boolean("enable-privacy-nutrition-labels"))&&void 0!==e&&e}get enableSellerInfo(){var e
return null!==(e=this.implementation.boolean("enable-seller-info"))&&void 0!==e&&e}get enableSellerICPAnnotation(){var e
return null!==(e=this.implementation.boolean("enable-seller-icp"))&&void 0!==e&&e}get enableFeaturedCategoriesOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-featured-categories-on-groupings"))&&void 0!==e&&e}get enableCategoryBricksOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-category-bricks-on-groupings"))&&void 0!==e&&e}get friendRequestTTLDays(){var e
return null!==(e=this.implementation.integer("friend-request-ttl-days"))&&void 0!==e?e:25}get sponsoredSearchODMLTimeout(){var e
return null!==(e=this.implementation.double("sponsored-search-odml-timeout"))&&void 0!==e?e:3}get isSearchLandingAdsEnabled(){var e
return null!==(e=this.implementation.boolean("isSearchLandingAdsEnabled"))&&void 0!==e&&e}get isLLMSearchTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-tags-enabled"))&&void 0!==e&&e}get searchLandingAdFetchTimeout(){var e
return null!==(e=this.implementation.double("search-landing-ad-fetch-timeout"))&&void 0!==e?e:.175}get searchLandingPageOffscreenRefreshInterval(){var e
return null!==(e=this.implementation.double("search-landing-offscreen-refresh-interval-in-seconds"))&&void 0!==e?e:60}get searchLandingPageRefreshUpdateDelayInterval(){var e
return null!==(e=this.implementation.double("search-landing-page-update-delay-interval-in-seconds"))&&void 0!==e?e:.3}get appPrivacyLearnMoreEditorialItemId(){return this.implementation.string("appPrivacyLearnMoreEditorialItemId")}get ratingsAndReviewsLearnMoreEditorialId(){return this.implementation.string("ratings-and-reviews-learn-more-editorial-item-id")}get reviewSummarizationLearnMoreEditorialItemId(){return this.implementation.string("review-summarization-learn-more-editorial-item-id")}get suppressedPrivacyAppIds(){return l(m(this.implementation.array("suppressedPrivacyLabels")))}get suppressedAccessibilityAppIds(){return l(m(this.implementation.array("suppressed-accessibility-labels")))}get appPrivacyDefinitionsEditorialItemId(){return this.implementation.string("appPrivacyDefinitionsEditorialItemId")}get webNavigationCategoryTabsEditorialItemId(){return this.implementation.string("web-navigation-category-tabs-editorial-item-id")}get todayWidgetLivePreviewRolloutRate(){var e
return null!==(e=this.implementation.double("todayWidgetLivePreviewRolloutRate"))&&void 0!==e?e:1}get hero3RolloutRate(){var e
return null!==(e=this.implementation.double("arcade-hero-shelf-tagline-style-rollout-rate"))&&void 0!==e?e:1}get arcadeTrialEnrolledStateRate(){var e
return null!==(e=this.implementation.double("arcade-trial-enrolled-state-rate"))&&void 0!==e?e:0}get marketingItemSelectionTimeout(){var e
return null!==(e=this.implementation.double("marketing-item-selection-timeout"))&&void 0!==e?e:1}get enableAppEvents(){var e
return null!==(e=this.implementation.boolean("enableAppEvents"))&&void 0!==e&&e}get enableProductPageVariants(){var e
return null!==(e=this.implementation.boolean("enableProductPageVariants"))&&void 0!==e&&e}get enableArcadeTrialEligibleBadging(){return this.implementation.boolean("enable-arcade-trial-eligible-badging")}get heroCarouselAutoScrollDuration(){var e
return null!==(e=this.implementation.double("heroCarouselAutoScrollDuration"))&&void 0!==e?e:7}get enableAdditionalLoggingForPPV(){var e
return null!==(e=this.implementation.boolean("enableAdditionalLoggingForPPV"))&&void 0!==e&&e}get enableOnDevicePersonalization(){const e=this.implementation.boolean("enable-on-device-personalization")
return!!r(e)||e}get enableAutomaticPageRefresh(){var e
return null===(e=this.implementation.boolean("enable-automatic-page-refresh"))||void 0===e||e}get enableSystemAppReviews(){var e
return null!==(e=this.implementation.boolean("enable-system-app-reviews"))&&void 0!==e&&e}get enableCPPInSearchAds(){return this.implementation.boolean("enableCPPsInSearchAds")||!1}get cancelPreorderItemSrv(){return this.implementation.url("cancelPreorderItemSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancel"}get getCancellablePreorderItemsSrv(){return this.implementation.url("getCancellablePreorderItemsSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancellable"}get enabledAdPlacements(){return l(m(this.implementation.array("enabled-ad-placements")))}get adPlacementTimeouts(){return p(y(this.implementation.dictionary("ad-placement-timeouts")))}get inAppPurchasesLearnMoreEditorialItemId(){return this.implementation.string("in-app-purchases-learn-more-editorial-item-id")}get enableExternalPurchases(){var e
return null!==(e=this.implementation.boolean("enable-external-purchase"))&&void 0!==e&&e}get enabledExternalPurchasesPlacements(){return l(m(this.implementation.array("enabled-external-purchase-placements")))}get externalPurchasesLearnMoreEditorialItemId(){return this.implementation.string("external-purchase-learn-more-editorial-item-id")}get externalBrowserLearnMoreEditorialItemId(){return this.implementation.string("external-browser-learn-more-editorial-item-id")}get sharePlayAppsEditorialItemId(){return this.implementation.string("share-play-apps-editorial-item-id")}get externalPurchasesIncludeProductPageBannerIcon(){var e
return null!==(e=this.implementation.boolean("external-purchase-product-page-banner-include-icon"))&&void 0!==e&&e}get externalPurchasesProductPageAnnotationVariant(){return this.implementation.string("external-purchase-product-page-annotation-variant")}get newEventsForODJAreEnabled(){var e
return null!==(e=this.implementation.boolean("new-events-for-odj-are-enabled"))&&void 0!==e&&e}get defaultChart(){return y(this.implementation.dictionary("default-chart"))}get accountUrl(){var e
return null!==(e=this.implementation.url("accountUrl"))&&void 0!==e?e:fO}get redeemUrl(){var e
return null!==(e=this.implementation.url("redeemUrl"))&&void 0!==e?e:hO}get manageSubscriptionsUrl(){var e
return null!==(e=this.implementation.url("manageSubscriptionsUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink"}get manageSubscriptionsV2Url(){var e
return null!==(e=this.implementation.url("manageSubscriptionsV2Url"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/"}get medicalDeviceComplianceStatementRegion(){return this.implementation.string("medical-devices-compliance-statement-region")}get adsOverrideLanguage(){return this.implementation.string("ads-override-language")}get gameControllerRecommendedRolloutRate(){var e
return null!==(e=this.implementation.double("game-controller-recommended-rollout-rate"))&&void 0!==e?e:0}get gameControllerLearnMoreEditorialItemId(){return this.implementation.string("game-controller-learn-more-editorial-item-id")}get spatialControlsLearnMoreEditorialItemId(){return this.implementation.string("spatial-controllers-learn-more-editorial-item-id")}get mediaAPISearchFocusEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-focus-suggestions-enabled"))&&void 0!==e&&e}get supportsSearchLandingPageV2(){var e
return null!==(e=this.implementation.boolean("supports-apps-slp-v2"))&&void 0!==e&&e}get searchLandingPageV2RolloutRate(){var e
return null!==(e=this.implementation.double("apps-slp-v2-rollout-rate"))&&void 0!==e?e:0}get todayTabArcadePersonalizationRate(){var e
return null!==(e=this.implementation.double("today-tab-arcade-personalization-rate"))&&void 0!==e?e:0}get gameCenterExtendSupportedFeatures(){var e
return null!==(e=this.implementation.boolean("game-center-extend-supported-features"))&&void 0!==e&&e}get adPlacementEligibleSlotPositions(){const e=y(this.implementation.dictionary("ad-placement-eligible-slot-positions"))
return s(e)?e:{today:[{shelfIdentifier:"0",slot:0},{shelfIdentifier:"0",slot:1}],"product-page-ymal":[{shelfIdentifier:mj,slot:0}]}}get managePreordersUrl(){var e
return null!==(e=this.implementation.url("preordersUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/preorders"}get modifyAccount(){var e
return null!==(e=this.implementation.url("modifyAccount"))&&void 0!==e?e:fO}get purchaseHistoryUrl(){return this.implementation.url("purchaseHistoryUrl")}get ratingsReviewsUrl(){var e
return null!==(e=this.implementation.url("ratingsReviewsUrl"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/ratings-reviews"}get signup(){var e
return null!==(e=this.implementation.url(mA))&&void 0!==e?e:HO}get redeemCodeLanding(){var e
return null!==(e=this.implementation.url("redeemCodeLanding"))&&void 0!==e?e:hO}get reportProblemUrl(){return this.implementation.string("reportProblemUrl")}get unrestrictedServerSideTabBadging(){var e
return null!==(e=this.implementation.boolean("unrestricted-server-side-tab-badging"))&&void 0!==e&&e}get todayAdCondensedEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-condensed-enabled"))&&void 0!==e&&e}get safariExtensionsEditorialPageId(){return this.implementation.url("safari-extensions-editorial-page-id")}get buddyOnboardingEditorialItemId(){return this.implementation.string("buddy-onboarding-editorial-item-id")}get productPageFriendsPlayingClickEventsEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-friends-playing-click-events-enabled"))&&void 0!==e&&e}get highMotionLearnMoreEditorialItemId(){return this.implementation.string("high-motion-learn-more-editorial-item-id")}get todayAdMediumLockupScreenshotsRiverSpeed(){return this.implementation.double("today-ad-medium-lockup-screenshots-river-speed")}get arcadeDownloadPackCategoriesCollectionId(){return this.implementation.string("arcade-download-packs-onboarding-collection-id")}get arcadeDownloadPackShelfTTLInSeconds(){var e
return null!==(e=this.implementation.integer("arcade-starter-pack-ttl-in-seconds"))&&void 0!==e?e:0}get enableOfferItems(){var e
return null!==(e=this.implementation.boolean("enable-winback-offers"))&&void 0!==e&&e}get appDistributionMediaAPIHost(){return this.implementation.string("app-distribution-media-api-host")}get appDistributionLanguageTag(){return this.implementation.string("app-distribution-language-tag")}get arcadeDownloadPackPostSubscribeTrigger(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-post-subscribe-trigger"))||void 0===e||e}get enableContingentOffers(){var e
return null!==(e=this.implementation.boolean("enable-contingent-offers"))&&void 0!==e&&e}get arcadeDownloadPackRolloutRate(){var e
return null!==(e=this.implementation.double("arcade-download-packs-rollout-rate"))&&void 0!==e?e:0}get enableVisionPlatform(){var e
return null!==(e=this.implementation.boolean("enable-vision-platform"))&&void 0!==e&&e}get supportedMixedMediaRequestUsecases(){var e
return null!==(e=p(y(this.implementation.dictionary("supported-mixed-media-request-usecases"))))&&void 0!==e?e:{}}get arcadeDownloadPacksMetricsEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-metrics-events-enabled"))||void 0===e||e}get arcadeDownloadPacksImpressionEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-impression-events-enabled"))||void 0===e||e}get visionOnlyAppLearnMoreEditorialItemId(){return this.implementation.string("vision-only-app-learn-more-editorial-item-id")}get arcadeDownloadPacksCIPDeeplinkIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-cip-deeplink-trigger"))&&void 0!==e&&e}get arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-hw-tabbadge-trigger"))&&void 0!==e&&e}get aboutAppStoreUrl(){return this.implementation.string("about-app-store-url")}get aboutInAppPurchasesEditorialItemId(){return this.implementation.string("about-in-app-purchases-editorial-item-id")}get requestARefundUrl(){return this.implementation.string("request-a-refund-url")}get personalizedRecommendationsToggleEnabled(){var e
return null!==(e=this.implementation.boolean("enable-personalized-recommendations-toggle"))&&void 0!==e&&e}get metricsIdMigrationEnabled(){var e
return null===(e=this.implementation.boolean("metrics-id-migration-enabled"))||void 0===e||e}get isNaturalLanguageSearchEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-enabled"))&&void 0!==e&&e}get isNaturalLanguageSearchResultsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-results-enabled"))&&void 0!==e&&e}get changePaymentMethodUrl(){return this.implementation.string("change-payment-method-url")}get aboutFrenchAppStoreEditorialItemId(){return this.implementation.string("about-app-store-editorial-item-id")}get isOnDemandShelfFetchingEnabled(){var e
return null===(e=this.implementation.boolean("on-demand-product-shelf-fetching-enabled"))||void 0===e||e}get isMetricsUserIdFallbackEnabled(){var e
return null!==(e=this.implementation.boolean("metrics-user-id-fallback-enabled"))&&void 0!==e&&e}get isMetricsAb2DataFallbackEnabled(){var e
return null===(e=this.implementation.boolean("metrics-ab2data-fallback-enabled"))||void 0===e||e}get disableDefaultTabReset(){var e
return null!==(e=this.implementation.boolean("disable-default-tab-reset"))&&void 0!==e&&e}get enableRecoOnDeviceReordering(){var e
return null!==(e=this.implementation.boolean("enable-on-device-reco-reordering"))&&void 0!==e&&e}get ribbonBarVisionEditorialItemIds(){return l(m(this.implementation.array("ribbon-bar-vision-editorial-item-ids")))}get searchFilterEditorialItemIds(){const e=l(m(this.implementation.array("search-filter-editorial-item-ids")))
return new Set(e)}get accessibilityLearnMoreEditorialItemId(){return this.implementation.string("accessibility-learn-more-editorial-item-id")}get enableDeviceDrivenDiscoveryContent(){var e
return null!==(e=this.implementation.boolean("enable-device-driven-discovery-content"))&&void 0!==e&&e}get enableProductPageInstallSize(){var e
return null!==(e=this.implementation.boolean("enable-product-page-install-size"))&&void 0!==e&&e}get enableIconArtwork(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork"))&&void 0!==e&&e}get iconArtworkRolloutRate(){var e
return null!==(e=this.implementation.double("icon-artwork-rollout-rate"))&&void 0!==e?e:0}get enableUpdatedAgeRatings(){var e
return null!==(e=this.implementation.boolean("enable-app-store-age-ratings"))&&void 0!==e&&e}get enableAgeRatingFilter(){var e
return null!==(e=this.implementation.boolean("enable-age-rating-filter"))&&void 0!==e&&e}get enableTwoPhaseOfferConfirmation(){var e
return null!==(e=this.implementation.boolean("enable-two-phase-offer-confirmation"))&&void 0!==e&&e}get externalPurchasesProductPageBannerTextVariant(){return this.implementation.string("external-purchase-product-page-banner-text-variant")}get externalPurchasesProductPageBannerIconVariant(){return this.implementation.string("external-purchase-product-page-banner-icon-variant")}get deepLinkTabIdentifier(){return this.implementation.string("deep-link-tab-identifier")}get maxGamesForFetchingEvents(){var e
return null!==(e=this.implementation.integer("max-games-for-fetching-events"))&&void 0!==e?e:30}get mockHomeFeedURL(){return this.implementation.string("mock-home-feed-url")}get metricsTopic(){var e
{const t="xp_ase_appstore_ue"
return null!==(e=this.implementation.string("metrics_topic"))&&void 0!==e?e:t}}get playTogetherGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("play-together-arcade-game-recommendations"))&&void 0!==e?e:"1803255513"}get playTogetherGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("play-together-non-arcade-game-recommendations"))&&void 0!==e?e:"1804480915"}get multiplayerActivityGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-arcade-game-recommendations"))&&void 0!==e?e:"1821553042"}get multiplayerActivityGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-non-arcade-game-recommendations"))&&void 0!==e?e:"1821553152"}get showArcadeSubscriberAccessBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-subscriber-access-badge"))&&void 0!==e&&e}get gamesCrossUseConsentLearnMoreURL(){return this.implementation.string("games-crossuse-consent-learn-more-url")}get gamesPlayNowHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesPlayNowHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get gamesEditorialHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesEditorialHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get completedChallengesInActiveShelfTimeThreshold(){var e
return null!==(e=this.implementation.integer("completed-challenges-in-active-shelf-time-threshold"))&&void 0!==e?e:86400}get requestReviewEnabled(){var e
return null===(e=this.implementation.boolean("request-review-enabled"))||void 0===e||e}get requestReviewMinAppLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-app-launch-count"))&&void 0!==e?e:15}get requestReviewMinGameLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-game-launch-count"))&&void 0!==e?e:5}get enableLicenses(){var e
return null!==(e=this.implementation.boolean("enable-licenses"))&&void 0!==e&&e}get chartDetailPageItemCount(){var e
return null!==(e=this.implementation.integer("chart-detail-page-item-count"))&&void 0!==e?e:25}get enableSRPNextSlot(){var e
return null!==(e=this.implementation.boolean("enable-srp-next-slot"))&&void 0!==e&&e}get enableSRPV5Impressions(){var e
return null!==(e=this.implementation.boolean("enable-srp-v5-impressions"))&&void 0!==e&&e}get enableSRPOnDeviceAdsRanker(){var e
return null!==(e=this.implementation.boolean("enable-srp-on-device-ads-ranker"))&&void 0!==e&&e}get editorialShelvesCollectionContentsLimit(){var e
return null!==(e=this.implementation.integer("editorial-shelves-collection-contents-limit"))&&void 0!==e?e:75}get metricsAllowedListURLParams(){let e=l(m(this.implementation.array("metrics-allowed-list-url-params")))
return o(e)&&(e=[lO,uO,dO,"ct","pt",cO,"mttn3pid","mttnagencyid","mttncc","mttnpid","mttnsiteid","mttnsub1","mttnsub2","mttnsubad","mttnsubkw","mttnsubplmnt","id",jj,"salableAdamId","ign-itscg","ign-itsct","utm_campaign",M_]),e}get enableIPadOnlyFallbackIcons(){var e
return null!==(e=this.implementation.boolean("enable-ipad-only-fallback-icons"))&&void 0!==e&&e}get disablePaginatedGameLibraryShelf(){var e
return null!==(e=this.implementation.boolean("disable-paginated-game-library-shelf"))&&void 0!==e&&e}get gameLibraryNumberOfItemsFromBelowToFetchNextPage(){var e
return null!==(e=this.implementation.integer("game-library-number-of-items-from-below-to-fetch-next-page"))&&void 0!==e?e:48}get disabledRichLinkPresentationEditorialItemIds(){var e
return l(m(null!==(e=this.implementation.array("disabled-rich-link-presentation-editorial-item-ids"))&&void 0!==e?e:["1842906680"]))}get enableIconArtworkWithInset(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork-with-inset"))&&void 0!==e&&e}get enableCardZoomTransition(){var e
return null===(e=this.implementation.boolean("enable-card-zoom-transition"))||void 0===e||e}}G9.type=(0,Tm.makeMetatype)("app-store:bag-wrapper")
class j9 extends XY{constructor(e,t){super(e),this.cache={},this.packageProperties=t}isEnabled(e){return this.fromCache(e,()=>{var t,n
return!(!(0,mm.isSome)(this.implementation)||!this.implementation.isEnabled(e))||!!(0,mm.isSome)(null===(t=this.packageProperties)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.packageProperties)||void 0===n?void 0:n.clientFeatures[e])})}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,mm.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}}j9.type=(0,Tm.makeMetatype)("app-store:client-capabilities-wrapper")
class V9 extends XY{async orderedVisibleIAPs(e,t,n,r){return await new Promise((o,i)=>{const s=t.filter(e=>null!=e),a=n.filter(e=>null!=e)
this.implementation.orderedVisibleIAPs(e,s,a,r,(e,t)=>{t?i(t):o(e)})})}async visibilityForIAPs(e){return await new Promise((t,n)=>{this.implementation.visibilityForIAPs(e,(e,n)=>{t(n?{}:e)})})}}V9.type=(0,Tm.makeMetatype)("app-store:client-ordering-wrapper")
class H9 extends XY{info(...e){return this.implementation.info(...e)}error(...e){return this.implementation.error(...e)}log(...e){return this.implementation.log(...e)}warn(...e){return this.implementation.warn(...e)}}H9.type=(0,Tm.makeMetatype)("app-store:console-wrapper")
class q9 extends XY{constructor(){super(...arguments),this.cache={}}isEnabled(e){return this.fromCache(e,()=>{if(this.implementation.isEnabled(e))return!0
const t=this.legacyFeatureFlagFromModernFeatureFlag(e)
return!!(0,mm.isSome)(t)&&this.implementation.isEnabled(t)})}isGSEUIEnabled(e){return Boolean(this.implementation.isGSEUIEnabled(e))}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,mm.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}legacyFeatureFlagFromModernFeatureFlag(e){switch(e){case yK:return"open_in_story_share_sheet"
case AK:return"product_accessibility_support_2025A"
case TK:return"AppleAccount.AABranding"
case"FA3FF1EE-3B29-4131-8A33-31C764E6B6DC":return"aligned_region_artwork_2025A"
case bK:return"hide_arcade_header_on_arcade_tab"
case SK:return"shelf_header"
case PK:return"game_center_shelf_header"
case CK:return"arcade_see_all_games_menu_uplift"
case IK:return"see_all_games_segmented_nav_2024A"
case kK:return"shelves_2_0_top_charts"
case"D4105739-EE9B-4C2E-AEE6-5F5744B016B1":return"shelves_2_0_arcade"
case"FF4FF053-4635-431B-A32C-19921296CD83":return"shelves_2_0_generic"
case OK:return"shelves_2_0_search"
case EK:return null
case"75A39BC1-112E-473B-8CB8-83D5D155982F":return"shelves_2_0_privacy_detail_page_2025C"
case DK:return"force_display_lockup_ordinals"
case RK:return"arcade_choose_your_favorites_brick_Future"
case _K:return"mini_today_cards_grouping"
case LK:return"mini_today_cards_product"
case MK:return"mini_today_cards_article"
case FK:return"contingent_offers_personalization"
case $K:return"voyager_bundles_2025A"
case xK:return"tv_product_page_2024E"
case NK:return"app_genome_2025A"
case BK:return HK
case"0027F7B8-F19A-4C57-8F1C-17DF011F98DA":return"spatial_controllers_2025A"
case"6707A833-E8E1-4C9E-9B83-19564F590B5D":return qK
case"336CC1B2-6AD8-45EC-AF22-B23023110241":return WK
case"BE3D1F90-21C1-4161-B2B9-88FA3B6CE4AF":return"5pqn2upm"
case"9EB5A10B-BE28-449D-AFE9-706A5ACF043B":return"ma1h52"
case"A50E8778-88AD-45BC-993A-B5BF157633DF":return"now_playing_feature_entry_points"
case"46669451-9170-4764-8534-348007111CDB":return"arcade_dashboard"
case UK:case GK:case jK:case VK:case"A6079E94-2752-4D7B-9185-B1C2DB737D0F":return null
default:F(e)}}}q9.type=(0,Tm.makeMetatype)("app-store:feature-flags-wrapper")
class W9 extends XY{get clientIdentifier(){return W9.cache.get("clientIdentifier",()=>this.implementation.clientIdentifier)}get clientVersion(){return W9.cache.get("clientVersion",()=>this.implementation.clientVersion)}get deviceLocalizedModel(){return this.implementation.deviceLocalizedModel}get deviceModel(){return W9.cache.get("deviceModel",()=>this.implementation.deviceModel)}get deviceModelFamily(){return W9.cache.get("deviceModelFamily",()=>this.implementation.deviceModelFamily)}get devicePhysicalModel(){return W9.cache.get("devicePhysicalModel",()=>this.implementation.devicePhysicalModel)}get deviceMarketingFamilyName(){return W9.cache.get("deviceMarketingFamilyName",()=>this.implementation.deviceMarketingFamilyName)}get osBuild(){return W9.cache.get("osBuild",()=>this.implementation.osBuild)}get platform(){return this.implementation.platform}isOSAtLeast(e,t,n){return this.implementation.isOSAtLeast(e,t,n)}get isiOS(){return this.platform===tH}get isMac(){return this.platform===KH}get isTV(){return this.platform===$j}get isWatch(){return this.platform===s$}get isWeb(){return this.platform===bH}get isWindows(){return"Windows"===this.platform}get isVision(){return this.platform===a$}}W9.type=(0,Tm.makeMetatype)("app-store:host-wrapper"),W9.cache=new eJ
class z9{constructor(){this.locData={},this.language="en"}updateLocalizationData(e,t){this.locData=e,this.language=t}localize(e,t){let n=this.locData[e]
return void 0!==n&&typeof n===$W||(n=e),t&&(n=this.replaceTokens(n,t)),n=this.replaceMarkupTokens(n,t),n}localizeWithCount(e,t,n,r){let o,i,s=null
return 0===n&&(o=`${t}.zero`,this.isLocalized(e,o)&&(s=o)),(0,mm.isNothing)(s)&&(s=t,i=this.pluralCategory(e,n),i!==XV&&(o=`${t}.${i}`,this.isLocalized(e,o)&&(s=o))),r||(r={}),void 0===r.count&&(r.count=this.formatNumber(n.toString())),void 0===r.number&&(r.number=this.formatNumber(n.toString())),this.localize(null!=s?s:t,r)}replaceTokens(e,t){return Object.entries(t).forEach(([t,n])=>{const r="@@"+t+"@@"
e=this.replaceSubstring(e,r,n)}),e}replaceMarkupTokens(e,t){if(e.indexOf("##")<=-1)return e
let n
return t?(n={...z9.MARKUP_PARAMS},Object.entries(t).forEach(([e,t])=>{n[e]=t})):n=z9.MARKUP_PARAMS,Object.entries(n).forEach(([t,n])=>{const r="##"+t+"##"
e=e.replace(new RegExp(r,"gi"),n)}),e=e.replace(/##([^##]+)##/gi,"<$1>")}replaceSubstring(e,t,n){return e.split(t).join(n)}formatNumber(e){let t=this.locData._decimalSeparator
void 0!==t&&typeof t===$W||(t=".")
let n=this.locData._thousandsSeparator
void 0!==n&&typeof n===$W||(n=".")
const r=parseFloat(e).toString().split("."),o=r[0].split("")
for(let e=o.length-3;e>0;e-=3)o.splice(e,0,n)
return r[0]=o.join(""),r.join(t)}isLocalized(e,t){const n=this.locData[t]
return void 0!==n&&typeof n===$W&&(-1===t.indexOf(".")||n!==t&&(0!==n.indexOf("**")||n.lastIndexOf("**")!==n.length-2)||(e.console.error("Unlocalized key in keys dictionary",t),!1))}pluralCategory(e,t){const n=z9.pluralCategoryFnByLanguage[this.language]
return void 0!==n?n(t):(e.console.warn("Missing plural category function for: "+this.language),XV)}}z9.MARKUP_PARAMS={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},z9.pluralCategoryDefault=function(e){return XV},z9.pluralCategoryOne=function(e){return 1===e?Lj:XV},z9.pluralCategoryArabic=function(e){const t=e>>0
if(t!==e)return XV
if(0===t)return"zero"
if(1===t)return Lj
if(2===t)return kD
const n=t%100
return n>=11?TN:n>=3?HB:XV},z9.pluralCategoryFrench=function(e){return e<2&&e>=0?Lj:XV},z9.pluralCategoryHebrew=function(e){const t=e>>0
return t!==e?XV:1===t?Lj:2===t?kD:0==t%10&&t>10?TN:XV},z9.pluralCategoryPolish=function(e){const t=e>>0
if(t!==e)return XV
if(1===t)return Lj
const n=t%10
if(n<=4&&n>=2){const e=t%100
if(e>14||e<12)return HB}return TN},z9.pluralCategoryRomanian=function(e){const t=e>>0
if(t!==e)return HB
if(0===t)return HB
if(1===t)return Lj
const n=e%100
return n<=19&&n>=1?HB:XV},z9.pluralCategoryRussian=function(e){const t=e>>0
if(t!==e)return XV
const n=t%10
if(n>=5||0===n)return TN
const r=t%100
return r<=14&&r>=11?TN:1===n?Lj:HB},z9.pluralCategoryFnByLanguage={zh:z9.pluralCategoryDefault,id:z9.pluralCategoryDefault,ja:z9.pluralCategoryDefault,ko:z9.pluralCategoryDefault,ms:z9.pluralCategoryDefault,th:z9.pluralCategoryDefault,vi:z9.pluralCategoryDefault,en:z9.pluralCategoryOne,ca:z9.pluralCategoryOne,da:z9.pluralCategoryOne,nl:z9.pluralCategoryOne,de:z9.pluralCategoryOne,el:z9.pluralCategoryOne,fi:z9.pluralCategoryOne,hu:z9.pluralCategoryOne,it:z9.pluralCategoryOne,nb:z9.pluralCategoryOne,no:z9.pluralCategoryOne,pt:z9.pluralCategoryOne,es:z9.pluralCategoryOne,sv:z9.pluralCategoryOne,tr:z9.pluralCategoryOne,ar:z9.pluralCategoryArabic,fr:z9.pluralCategoryFrench,iw:z9.pluralCategoryHebrew,pl:z9.pluralCategoryPolish,ro:z9.pluralCategoryRomanian,ru:z9.pluralCategoryRussian}
class Y9 extends XY{constructor(e,t){super(e),this.locFile=null,this.ampLoc=new z9,this.LOC_STRING_CACHE={},this.objectGraph=t}get identifier(){return this.implementation.identifier}get safeIdentifier(){return this.implementation.identifier.split("_")[0]}string(e,t){return this.implementation.string(e)}tryString(e){const t=this.implementation.string(e)
if(t===e||t===`**${e}**`)throw ym.context("tryString",()=>{ym.unexpectedType(VU,"Localization key",e,null)}),new Error(`No value exists for localization key '${e}'`)
return t}stringWithFallback(e,t){const n=this.implementation.string(e)
return n===`**AppStore.${e}**`?t:n}stringForPreferredLocale(e,t,n,r){if(o(n))return this.string(t,r)
const i=`${t}_${n}`
let s=this.LOC_STRING_CACHE[i]
if(!s)if(s=this.implementation.stringForPreferredLocale(t,n),s&&s!==t)this.LOC_STRING_CACHE[i]=s
else{const e=this.ampLoc.localize(t)
s=e!==t?e:r||t}return s}stringWithCount(e,t,n){let r=this.implementation.stringWithCount(e,t)
if(!r||r===e){const o=this.ampLoc.localizeWithCount(this.objectGraph,e,t,n)
o&&(r=o)}return r}stringWithCounts(e,t,n){return this.implementation.stringWithCounts(e,t)}uppercased(e){return e?e.toLocaleUpperCase(this.safeIdentifier):null}decimal(e,t){let n=this.implementation.decimal(e,t)
return n||(n=typeof e===qj?`* ${e.toString()} *`:this.nullString()),n}fileSize(e){let t=this.implementation.fileSize(e)
return t||(t=this.nullString()),t}formattedCount(e){let t=this.implementation.formattedCount(e)
return t||(t=this.nullString()),t}formattedCountForPreferredLocale(e,t,n){if(o(n))return this.formattedCount(t)
let r=this.implementation.formattedCountForPreferredLocale(t,n)
return r||(r=this.nullString()),r}timeAgoWithContext(e,t){let n=this.implementation.timeAgoWithContext(e,t)
return n||(n=this.nullString()),n}formatDate(e,t){let n=this.implementation.formatDate(e,t)
return n||(n=this.nullString()),n}formatDateWithContext(e,t,n){let r=this.implementation.formatDateWithContext(e,t,n)
return r||(r=this.nullString()),r}formatDateInSentence(e,t,n){let r=this.implementation.formatDateInSentence(e,t,n)
return r||(r=this.nullString()),r}relativeDate(e){let t=this.implementation.relativeDate(e)
return t||(t=this.nullString()),t}formatDuration(e,t){let n=this.implementation.formatDuration(e,t)
return n||(n=this.nullString()),n}applyLocalizations(e,t,n){this.isLocFileLoaded(e)||(this.locFile=e,this.ampLoc.updateLocalizationData(t,n.slice(0,2)))}isLocFileLoaded(e){return this.locFile===e}normalizedLocale(e,t,n){if("yue-hant"===(t=t.toLowerCase())){const t=e.packageProperties.asString("macauStorefrontIdentifier")
return typeof n===$W&&typeof t===$W&&-1!==n.indexOf(t)?"zh-ma":"zh-hk"}return t}nullString(){return"* null *"}load(e){if(void 0===e.bag.language||null===e.bag.language)throw new Error("Bag language is not available. Unable to load localizations.")
const t=this.normalizedLocale(e,e.bag.language,e.client.storefrontIdentifier),n=`local/${t}`
if(!this.isLocFileLoaded(n)){const r=e.packageProperties.asDictionary(`localizations.${t}`)
if(null!=r)this.applyLocalizations(n,r,t)
else{const r=e.packageProperties.asDictionary("localizations.en-us")
null!=r&&this.applyLocalizations(n,r,t)}}}deviceDisplayName(e){if(e.host.deviceLocalizedModel)return e.host.deviceLocalizedModel
switch(e.client.deviceType){case ZW:const e=this.string(pO)
return e===pO?CA:e
case HW:const t=this.string(wO)
return t===wO?IA:t
case"tv":const n=this.string(vO)
return n===vO?"Apple\xa0TV":n
case oz:const r=this.string(gO)
return r===gO?"Apple\xa0Watch":r
case iz:const o=this.string(mO)
return o===mO?JO:o
default:return null}}}Y9.type=(0,Tm.makeMetatype)("app-store:loc-wrapper")
class J9 extends XY{value(e){return n(this.implementation,e)}enabled(e){var t,n
const r=this.value(e)
return typeof r!==gG?Boolean(r):!!(0,Am.isSome)(null===(t=this.implementation)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.implementation)||void 0===n?void 0:n.clientFeatures[e])}isEnabled(e){return this.enabled(e)}isNotEnabled(e){return!this.enabled(e)}asDictionary(e){return p(this.implementation,e)}asString(e){return f(this.implementation,e)}asNumber(e){return h(this.implementation,e)}asArray(e){return l(this.implementation,e)}}J9.type=(0,Tm.makeMetatype)("app-store:package-properties-wrapper")
class K9 extends XY{retrieveString(e){const t=this.implementation.retrieveString(e)
return(null==t?void 0:t.length)>0&&"<null>"!==t?t:null}storeString(e,t){this.implementation.storeString(t,e)}}K9.type=(0,Tm.makeMetatype)("app-store:storage-wrapper")
class Z9 extends vy.ObjectGraph{configureDefaults(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b,S,P,C,I,k,O,E,D,R,_,L,M,F){let $=this.addingCryptography(t).addingHost(n).addingNetwork(r).addingPlatform(o).addingPlist(i).addingRandom(s).addingServices(a).addingCookieProvider(c).addingBag(e).addingConsole(l).addingStoreMetrics(u).addingAMSEngagement(d).addingLoc(f).addingAdsLoc(h).addingDevice(p).addingClient(w).addingPackageProperties(v).addingUser(g).addingPlayer(m).addingMetricsIdentifiers(y).addingClientOrdering(A).addingArcade(T).addingGameCenter(b).addingDeepLinks(S).addingAppleSilicon(P).addingStorage(C).addingAds(I).addingOnDeviceRecommendationsManager(k).addingOnDeviceSearchHistoryManager(O).addingFeatureFlags(E).addingClientCapabilities(D,v).addingMediaToken(R).addingAppDistribution(_).addingTimeoutManager(L).addingAdsLoc(h).addingTreatmentStore(M).addingUserDefaults(F)
return $.loc.load($),$=$.addingLocale(new x9($)),$}get bag(){return this.required(G9.type)}addingBag(e){return this.addingBagWrapper(new G9(e)).adding(gy.bag,e)}addingBagWrapper(e){return this.adding(G9.type,e)}get console(){return this.required(H9.type)}addingConsole(e){return this.addingConsoleWrapper(new H9(e))}addingConsoleWrapper(e){return this.adding(H9.type,e)}get cryptography(){return this.required(gy.cryptography)}addingCryptography(e){return this.adding(gy.cryptography,e)}get host(){return this.required(W9.type)}addingHost(e){return this.addingHostWrapper(new W9(e))}addingHostWrapper(e){return this.adding(W9.type,e)}get locale(){return this.required($9)}addingLocale(e){return this.adding($9,e)}get network(){return this.required(gy.net)}addingNetwork(e){return this.adding(gy.net,e)}get platform(){return this.required(gy.platform)}addingPlatform(e){return this.adding(gy.platform,e)}get plist(){return this.required(gy.plist)}addingPlist(e){return this.adding(gy.plist,e)}get random(){return this.required(gy.random)}addingRandom(e){return this.adding(gy.random,e)}get services(){return this.required(gy.services)}addingServices(e){return this.adding(gy.services,e)}get cookieProvider(){return this.required(gy.cookieProvider)}addingCookieProvider(e){return this.adding(gy.cookieProvider,e)}get fetchTimingMetricsBuilder(){return this.optional(iy.fetchTimingMetricsBuilderType)}addingFetchTimingMetricsBuilder(e){return this.adding(iy.fetchTimingMetricsBuilderType,e)}get storeMetrics(){return this.required(LY)}addingStoreMetrics(e){return this.adding(LY,e)}get amsEngagement(){return this.optional(MY)}addingAMSEngagement(e){return this.adding(MY,e)}get loc(){return this.required(Y9.type)}addingLoc(e){return this.addingLocWrapper(new Y9(e,this))}addingLocWrapper(e){return this.adding(Y9.type,e)}get adsLoc(){return this.required(WY)}addingAdsLoc(e){return this.adding(WY,e)}get device(){return this.required(FY)}addingDevice(e){return this.adding(FY,e)}get client(){return this.required(aJ.type)}addingClient(e){return this.addingClientWrapper(new aJ(e))}addingClientWrapper(e){return this.adding(aJ.type,e)}get packageProperties(){return this.required(J9.type)}addingPackageProperties(e){return this.addingPackagePropertiesWrapper(new J9(e))}addingPackagePropertiesWrapper(e){return this.adding(J9.type,e)}get clientCapabilities(){return this.required(j9.type)}addingClientCapabilities(e,t){return this.addingClientCapabilitiesWrapper(new j9(e,t))}addingClientCapabilitiesWrapper(e){return this.adding(j9.type,e)}get user(){return this.required($Y)}addingUser(e){return this.adding($Y,e)}get player(){}addingPlayer(e){return this.adding(xY,e)}get metricsIdentifiers(){return this.required(NY)}addingMetricsIdentifiers(e){return this.adding(NY,e)}get clientOrdering(){return this.required(V9.type)}addingClientOrdering(e){return this.addingClientOrderingWrapper(new V9(e))}addingClientOrderingWrapper(e){return this.adding(V9.type,e)}get arcade(){return this.required(BY)}addingArcade(e){return this.adding(BY,e)}get gameCenter(){return this.required(UY)}addingGameCenter(e){return this.adding(UY,e)}get deepLinks(){return this.required(GY)}addingDeepLinks(e){return this.adding(GY,e)}get appleSilicon(){return this.required(B9.type)}addingAppleSilicon(e){return this.addingAppleSiliconWrapper(new B9(e))}addingAppleSiliconWrapper(e){return this.adding(B9.type,e)}get storage(){return this.required(K9.type)}addingStorage(e){return this.addingStorageWrapper(new K9(e))}addingStorageWrapper(e){return this.adding(K9.type,e)}get ads(){return this.required(jY)}addingAds(e){return this.adding(jY,e)}get onDeviceRecommendationsManager(){return this.required(VY)}addingOnDeviceRecommendationsManager(e){return this.adding(VY,e)}get onDeviceSearchHistoryManager(){return this.required(HY)}addingOnDeviceSearchHistoryManager(e){return this.adding(HY,e)}get featureFlags(){return this.required(q9.type)}addingFeatureFlags(e){return this.addingFeatureFlagsWrapper(new q9(e))}addingFeatureFlagsWrapper(e){return this.adding(q9.type,e)}get mediaToken(){return this.required(qY)}addingMediaToken(e){return this.adding(qY,e)}get appDistribution(){return this.required(zY)}addingAppDistribution(e){return this.adding(zY,e)}get timeoutManager(){return this.required(YY)}addingTimeoutManager(e){return this.adding(YY,e)}get treatmentStore(){return this.required(JY)}addingTreatmentStore(e){return this.adding(JY,e)}get experimentCache(){return this.optional(SJ.metatype)}get metricsIdentifiersCache(){return this.optional(pZ.defaultMetatype)}get paymentMetricsIdentifiersCache(){return this.optional(pZ.paymentMetatype)}get personalizationMetricsIdentifiersCache(){return this.optional(pZ.personalizationMetatype)}get userDefaults(){if(this.client.isiOS)return this.required(KY)}addingUserDefaults(e){return this.adding(KY,e)}isAvailable(e){return i(this.optional(e))}get activeIntent(){return this.optional(M9)}addingActiveIntent(e){return this.adding(M9,new F9(e))}get seo(){return this.optional(N9)}addingSEO(e){return this.adding(N9,e)}get dispatcher(){return this.required(L9.dispatcher)}get nativeIntentDispatcher(){return this.required(L9.nativeIntentDispatcher)}get debugSettings(){return this.required(L9.debugSettings)}get router(){return this.required(L9.router)}get localizer(){return this.required(L9.localizer)}get personNameComponentsFormatter(){return this.required(L9.personNameComponentsFormatter)}}class Q9 extends Sz{constructor(){super(...arguments),this.$kind="InvalidateAllWidgetsAction",this.actionClass="InvalidateAllWidgetsAction"}}class X9{constructor(){this.$intentKind="GenericPageIntent"}async perform(e,t){const n=t.required(R9)
return await n.fetchPage(t,e.url,gK)}}class e8{constructor(){this.$intentKind="GenericPageMoreIntent"}async perform(e,t){const n=t.required(R9)
return await n.fetchMoreOfPage(t,e.pageToken)}}class t8{constructor(){this.$intentKind="ShelvesIntent"}async perform(e,t){const n=t.required(R9)
return await n.fetchShelves(t,e.requests)}}class n8{constructor(){this.$intentKind="ActionIntent"}async perform(e,t){return await gp(t,e)}}class r8{constructor(){this.$kind="AccountLinks",this.links={},this.pageMetrics=new LJ,this.pageRenderMetrics=null}}class o8 extends Sz{constructor(e,t,n){super(),this.$kind="FamilyCircleAction",this.actionClass="FamilyCircleAction",this.clientName=e,this.eventType=t,this.additionalParameters=n}}class i8{constructor(){this.$intentKind="AccountLinksIntent"}async perform(e,t){return yp(t)}}class s8 extends V4{constructor(e,t){super("AccountController"),t.exportingService("AccountData",{fetchAccountLinks:async t=>yp(e)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class a8{constructor(e,t){this.title=e,this.sections=t,this.pageMetrics=new LJ}}class c8{constructor(){this.$intentKind="AccountPageConstructionIntent"}async perform(e,t){const n=function(e,t,n){if(!e)return null
let r
return r=(0,mm.isSome)(t)&&t>0?t.toString():null,{$kind:aW,id:"updates-row",title:n.loc.string("AccountHub.Row.Updates.Title"),badge:r,action:new _J(ik),metricsFields:Op(sk)}}(e.hasUpdatesContent,e.pendingManualUpdatesCount,t),r=[Ap(e.localPlayer,e.friendRequestCount,t)].filter(e=>(0,mm.isSome)(e)),o=[{$kind:VV,id:"subscriptions-row",action:new _J(VV)},Tp(t),n,bp(t),{$kind:ak,id:"ratings-and-reviews-row",action:new _J(ak)},Sp(t)].filter(e=>(0,mm.isSome)(e)),i=[Pp(),Cp(),Ip()],s=[(a=[n],{$kind:"section",id:"signed-out-account-data-section",items:a})]
var a
return{dismissAction:new Z6("sheetDismiss"),accountSettingsAction:new _J("accountSettings"),appProfileSectionItems:r,profileFooterTitle:kp(e.creditsString,t),accountDataSectionItems:o,accountActionsSectionItems:i,footerSectionItems:[{$kind:"familySettings",id:"family-settings-row"}],signedOutItems:s}}}class l8{constructor(){this.$intentKind="AppsAndPurchasesPageFoundationIntent"}async perform(e,t){const n=[],r=function(e,t,n){let r,o
switch(e){case CO:r=n.loc.string("AppsAndPurchases.FamilyAccount.AccountMismatch1.Message"),o=n.loc.string("AppsAndPurchases.FamilyAccount.AccountMismatch1.Link")
break
case IO:(0,mm.isSome)(t)&&(r=n.loc.string("AppsAndPurchases.FamilyAccount.AccountMismatch2.Message").replace(ck,n.loc.string(lk)),o=n.loc.string(lk))
break
case kO:r=n.loc.string("AppsAndPurchases.FamilyAccount.SetupIncomplete.Message"),o=n.loc.string("AppsAndPurchases.FamilyAccount.SetupIncomplete.Link")
break
default:r=null,o=null}const i="prefs:root=CASTLE&path=FAMILY",s={}
let a
switch(e){case CO:case IO:a=(0,mm.isSome)(n.bag.familyPurchasesLearnMoreURL)?new HJ(n.bag.familyPurchasesLearnMoreURL,!1):new HJ(i,!0)
break
case kO:a=new HJ(i,!0)
break
default:r=null,o=null}if((0,mm.isSome)(a)&&(0,mm.isSome)(o)&&(s[o]=a),(0,mm.isSome)(r)&&(0,mm.isSome)(o)){const e=r.replace(ck,o),t=new f2(e)
return{$kind:ZV,id:"family-purchases-error-banner",content:new h2(t,s)}}return null}(e.familyPurchasesError,e.iCloudMemberAppleID,t);(0,mm.isSome)(r)&&n.push({id:"family-purchases-error-section",rows:[r]}),n.push({id:"family-members-section",rows:Ep(e.familyMembers,t)}),n.push({id:"purchase-history-section",rows:[Dp(t)]})
const o=new a8(t.loc.string(ok),n)
return Vn(t,o,tr()),o}}class u8 extends V4{constructor(){super("DynamicUIBuilder")}pageType(){return xN}async handlePage(e,t,n,r,o){const i=new _J(xN)
i.pageUrl=t.toString(),i.referrerUrl=t.build()
const s=new F4(e.bag.metricsTopic)
if(e.bag.arcadeDownloadPacksCIPDeeplinkIntegrationEnabled&&lr(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new _J(lU),t=WB
e.pageData=t,e.presentationContext=$V,s.carrierLinkSuccessAction=e}return i.pageData=s,i}pageRoute(e){const t=e.bag.dynamicUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class d8 extends V4{constructor(){super("FinancePageBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const i=new _J(fV)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.financeUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class f8{constructor(e,t){this.$kind="GenericAccountPage",this.title=e,this.sections=t||[],this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class h8{constructor(e,t){this.$kind="PersonalizationTransparencyPage",this.personalizationEnabledPage=e,this.personalizationDisabledPage=t}}class p8{constructor(e,t){this.$kind="AccountSection",this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class w8{constructor(e){this.type=e}}class v8 extends w8{constructor(e){super(WH),this.$kind="AccountSectionText",this.text=e}}class g8 extends w8{constructor(e,t){super("personalizedRecommendationsToggle"),this.$kind="AccountSectionPersonalizedRecommendationsToggle",this.title=e,this.defaultValue=t}}class m8 extends w8{constructor(e,t,n){super(EW),this.$kind="AccountSectionLink",this.title=e,this.action=t,this.displayType=n||aW}}class y8 extends w8{constructor(e,t){super("infoListItem"),this.$kind="AccountSectionInfoListItem",this.title=e,this.value=t}}class A8 extends Sz{constructor(){super(...arguments),this.$kind="ClearAppUsageDataAction",this.actionClass="ClearAppUsageDataAction"}}class T8{constructor(){this.$intentKind="GenericAccountPageIntent"}async perform(e,t){return await Rp(t,e.url)}}class b8{constructor(){this.$intentKind="PersonalizationTransparencyPageIntent"}async perform(e,t){return await async function(e){const t=e.required(R9),n=`${Cz}:///${_z.account}/${_z.personalizationTransparency}`
return await t.fetchPage(e,n,h8)}(t)}}class S8 extends V4{constructor(e,t){super("PersonalizationTransparencyBuilder"),t.exportingService(AT,{fetchGenericAccount:async t=>await Rp(e,t.url)})}async handlePage(e,t,n,r,o){return await async function(e,t,n){let r,o
if(e.bag.personalizedRecommendationsToggleEnabled){o=sx
const t=await _p(e),n=Lp(e)
r=new h8(t,n)}else o=pq,r=g(n[Hz.enabled])?await _p(e):Lp(e)
return V4.createFlowAction(r,o,t)}(e,t,n)}pageRoute(e){return e.bag.personalizedRecommendationsToggleEnabled?[{protocol:Cz,path:`/${_z.account}/${_z.personalizationTransparency}`},{path:`${_z.personalizationTransparency}`}]:[{protocol:Cz,path:`/${_z.account}/${_z.personalizationTransparency}`,query:[Hz.enabled]},{path:`${_z.personalizationTransparency}`,query:[Hz.enabled]}]}pageType(){return pq}}class P8 extends V4{constructor(){super("ShowAccountPageBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){let i,s=[]
{i=JL
const e=new _J(pq)
e.presentationContext=$V,e.animationBehavior=hq,s=[e]}const a=new R0(i)
return a.actions=s,a}pageRoute(e){return[{hostName:"showAccountPage"},{hostName:"showPurchasesPage"}]}}class C8 extends V4{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){return new _J(fV,e.bag.manageSubscriptionsUrl)}pageRoute(e){return[{hostName:"showSubscriptionsPage"}]}}class I8 extends V4{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const i=new R0(JL)
if(e.client.deviceType!==iz){const t=new _J(pq)
t.presentationContext=$V,t.animationBehavior=hq
const n=[t]
if(e.featureFlags.isEnabled(GK)){const e=new _J(ik)
e.presentationContext=BN,e.presentation=uz,e.animationBehavior=hq,n.push(e)}i.actions=n}return i}pageRoute(e){return[{hostName:"showUpdatesPage"},{path:"updates"},{path:"{countryCode}/updates"},{query:[`${Hz.action}=updates`]}]}}class k8 extends V4{constructor(){super("StorefrontChangeController")}async handlePage(e,t,n,r,o){const i={url:t.toString(),signingStyle:GH}
return await e.network.fetch(i),null}pageRoute(e){return[{protocol:Iz,path:`/${_z.store}/${_z.resetAndRedirect}`}]}pageType(){return GW}}class O8 extends V4{constructor(){super("WebUIPageBuilder")}pageType(){return G$}async handlePage(e,t,n,r,o){const i=new _J(G$)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.webViewRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class E8{constructor(){this.$intentKind="UpdateAppEventNotificationIntent"}async perform(e,t){return await $p(t,e)}}class D8 extends V4{constructor(e,t){super("AppEventsController"),t.exportingService("AppEvents",{updateAppEventNotification:async t=>await $p(e,t)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class R8 extends V4{constructor(){super("AppClipSubscribeBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const s=f(n[Hz.appId])
if(!i(s))throw new Error(`No adamId supplied in appClipSubscribe url: ${t}`)
const a=new cJ(e).withIdOfType(s,az).includingAdditionalPlatforms(ee(e)),c=Nd(e,mt(e,await Ln(e,a)),{metricsOptions:{pageInformation:new cZ({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),l=(new oY).set(DV,Oz).set(NG,FG).path(_z.product).path(s).build(),u=new _J(fq)
u.pageUrl=l
const d=so(e,ht(lV),s,c.buttonAction),h=new R0(nz)
return h.actions=[u,d],h}pageRoute(e){return[{hostName:"appClipSubscribe",query:[Hz.appId,Hz.context]}]}}class _8{constructor(e,t,n,r,o){this.$kind="ArcadeDownloadPackCategory",this.id=e,this.title=t.trim(),this.artwork=n,this.gradientStartColor=r,this.gradientEndColor=o,this.selectActionMetrics=new mz,this.deselectActionMetrics=new mz}}class L8{constructor(e,t){this.$kind="ArcadeDownloadPackSuggestion",this.lockup=e,this.categoryId=t}}class M8 extends Sz{constructor(e){super(),this.$kind="ArcadePackOfferAction",this.actionClass="ArcadePackOfferAction",this.offerActions=e}}class F8{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackCategoriesPage",this.title=e,this.categories=t,this.maxNumberOfCategoriesToChoose=n,this.maxNumberOfCategoriesToChooseTemplate=r,this.numberOfChosenCategoriesTemplate=o,this.primaryAction=i,this.dismissAction=s,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class $8{constructor(e,t,n,r,o,i,s,a){this.$kind="ArcadeDownloadPackSuggestionsPage",this.title=e,this.suggestions=t,this.lockupStyle=n,this.getAllAction=r,this.getAllButtonStyle=o,this.primaryAction=i,this.primaryActionKind=s,this.primaryActionSecondaryTitle=a,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class x8{constructor(){this.$intentKind="ArcadeDownloadPackCategoriesPageIntent",this.maxNumberOfCategoriesToChoose=4}async perform(e,t){return await this.fetchDownloadPackPage(t,tc(e.subscriptionStatus))}async fetchDownloadPackPage(e,t){const n=new Pz
n.title=e.loc.string("Arcade.DownloadPack.CategorySelection.PrimaryButtonTitle")
const r=new Pz
r.title=e.loc.string("Arcade.DownloadPack.CategorySelection.SecondaryButtonTitle")
const o=await this.fetchCategories(e),i=new F8(e.loc.string(t===TO?"Arcade.DownloadPack.CategorySelection.Title.CurrentUser":"Arcade.DownloadPack.CategorySelection.Title"),o,this.maxNumberOfCategoriesToChoose,"Arcade.DownloadPack.CategorySelection.MaxCount","Arcade.DownloadPack.CategorySelection.Selected.Full",n,r),s=new cZ({pageId:"SelectCategories",pageType:vk}),a={rootPosition:0,locationStack:[]}
return e.bag.arcadeDownloadPacksMetricsEventsEnabled&&(n.actionMetrics.addMetricsData(_t(e,"Ok",lz,{actionType:dz})),r.actionMetrics.addMetricsData(_t(e,"Skip",lz,{actionType:Wj})),o.forEach(t=>{t.selectActionMetrics.addMetricsData(_t(e,t.id,tV,{actionType:aN})),t.deselectActionMetrics.addMetricsData(_t(e,t.id,tV,{actionType:"remove"}))}),Vn(e,i,s)),e.bag.arcadeDownloadPacksImpressionEventsEnabled&&o.forEach(t=>{const n={id:t.id,idType:yW,kind:lz,locationTracker:a,pageInformation:s,softwareType:dW,targetType:tV,title:t.title}
Jh(e,t,n),Vh(a)}),i}async fetchCategories(e){const t=e.bag.arcadeDownloadPackCategoriesCollectionId,n=new cJ(e).withIdOfType(t,RH).addingQuery(gk,YI).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>this.categoriesFromResponse(e,t))}categoriesFromResponse(e,t){return ym.context("categoriesFromResponse",()=>{const n=yt(t),r=[]
for(const t of n){const n=t.id,o=ah(e,t,cz),i=p(Ke(e,t,RW),GD)
if((0,mm.isNothing)(i))continue
const s=df(e,i,{useCase:R3.CategoryIcon}),a=Ze(e,t,"editorialBackground.stops").map(e=>ye(f(e,wH))).filter(e=>(0,mm.isSome)(e))
if(0===a.length){e.console.log(`Empty gradient for category: ${n}`)
continue}const c=a[0],l=1===a.length?a[0]:a[1],u=new _8(n,o,s,c,l)
r.push(u)}return r.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:jH})}catch(e){return 0}})})}}class N8{constructor(){this.$intentKind="ArcadeDownloadPackSuggestionsPageIntent",this.maxGamesCount=4}async perform(e,t){const n={rootPosition:0,locationStack:[]},r=new cZ({pageId:"DownloadStarterPack",pageType:vk})
return await this.fetchSuggestedGames(t,e.categories,this.maxGamesCount,r,n).then(o=>this.createSuggestionsPage(o,t,tc(e.subscriptionStatus),r,n))}async fetchSuggestedGames(e,t,n,r,o){const i=new cJ(e).forType(hM).addingQuery("include[personal-recommendations]",sz).addingQuery("associate[apps]",FV).addingQuery("limit[personal-recommendations:contents]",`${n}`).addingQuery("omit[resource:apps]","autos").addingQuery("sparseLimit[apps:association.category]","0").addingQuery("sparseLimit[personal-recommendations:contents]",`${n}`).addingQuery(aW,"arcade-onboarding").includingAdditionalPlatforms(ee(e)),s=this.fetchOptions(t,YW)
return await Ln(e,i,s).then(n=>this.suggestionFromResponse(e,t,n,r,o))}suggestionFromResponse(e,t,n,r,o){return ym.context("suggestionFromResponse",()=>{const i={}
for(const e of t)i[e.id]=e
const s=yt(fe(mt(e,n),sz)),a=[]
for(const t of s){const n=l(t.meta,"associations.category.data")[0].id,s=e.clientCapabilities.isNotEnabled("9822F75D-1F2B-4438-B0E7-B1B007E2FECD")||Fc(e)!==h5,c=Nd(e,t,{offerStyle:wV,offerEnvironment:MW,metricsOptions:{pageInformation:r,locationTracker:o,badges:{categoryId:n}},metricsClickOptions:{id:t.id,pageInformation:r,locationTracker:o,badges:{categoryId:n}},artworkUseCase:R3.LockupIconSmall,isSubtitleHidden:s});(0,mm.isNothing)(c)||(c.heading=i[n].title,c.heading===c.subtitle&&(c.subtitle=c.editorialTagline),Vh(o),cf(c,e),a.push(new L8(c,n)))}return a})}createSuggestionsPage(e,t,n,r,o){const i=e.map(e=>this.offerAction(e.lockup.buttonAction)).filter(e=>(0,mm.isSome)(e)),s=new M8(i)
s.title=function(e){switch(xc(e)){case cy.Control:return e.loc.string(Vk)
case cy.LayoutA:case cy.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.DownloadAllButtonTitle")
default:return e.loc.string(Vk)}}(t)
const a=i.map(e=>e.adamId),c=new Pz
c.title=function(e){switch(xc(e)){case cy.Control:return e.loc.string(OL)
case cy.LayoutA:case cy.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.NotNowButtonTitle")
default:return e.loc.string(OL)}}(t)
const l=new $8(t.loc.string(n===WB?"Arcade.DownloadPack.Suggestions.Title.NewUser":"Arcade.DownloadPack.Suggestions.Title"),e,$c(t),s,function(e){switch(xc(e)){case cy.Control:return kL
case cy.LayoutA:return"withinLockups"
case cy.LayoutB:default:return kL}}(t),c,function(e){switch(xc(e)){case cy.Control:case cy.LayoutA:return IL
case cy.LayoutB:return"getAll"
default:return IL}}(t),function(e){switch(xc(e)){case cy.Control:return null
case cy.LayoutA:case cy.LayoutB:return e.loc.string(OL)
default:return null}}(t))
return t.bag.arcadeDownloadPacksMetricsEventsEnabled&&(ra(t,s,{id:"GetAll",actionType:tx,subjectIds:a,actionDetails:{subjectIds:a},pageInformation:r,locationTracker:o,targetType:lz}),c.actionMetrics.addMetricsData(_t(t,"Done",lz,{actionType:dz})),Vn(t,l,r)),l}offerAction(e){return Nn(e)?e:wt(e)?Nn(e.defaultAction)?e.defaultAction:Nn(e.buyAction)?e.buyAction:null:null}fetchOptions(e,t){const n={selected:e.map(e=>({id:e.id,type:t}))}
return{method:rj,headers:{"Content-Type":GM},requestBodyString:JSON.stringify(n)}}}class B8 extends V4{constructor(e,t){super("ArcadeDownloadPackBuilder")}pageRoute(e){return lr(e,e.bag.arcadeDownloadPackRolloutRate)?[{hostName:"arcadeDownloadPack",query:[`${Hz.arcadeSubscriptionStatus}?`]}]:[]}async handlePage(e,t,n,r,o){const i=new _J(lU),s=f(n,Hz.arcadeSubscriptionStatus)
return i.pageData=tc(s),i}pageType(){return lU}}class U8 extends V4{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return vW}defaultTab(e){return nz}pageRoute(e){return[{path:"arcade/offers",query:[`${Hz.offerHints}?`]},{path:"/{countryCode}/arcade/offers",query:[`${Hz.offerHints}?`]}]}async handlePage(e,t,n,r,o){var i
const s=null!==(i=n[Hz.offerHints])&&void 0!==i?i:"deeplink_hardware_firstchance",a={offerHints:s},c=new dQ(nz,ht(lV),e.bag.metricsTopic,void 0,a)
c.offerHints=s
const l=new _J(vV)
return l.pageData=c,l.referrerUrl=t.build(),l}}class G8 extends gK{constructor(e){super(e,"ArcadeSeeAllGamesPage"),this.pageSegments=[]}}class j8{constructor(e,t,n,r){this.$kind="PageFacetOption",this.title=e,this.value=t,this.metricsValue=n,this.systemImageName=r}}j8.defaultValue="pageFacetsDefaultValue",j8.trueValue=new j8(cW,IN),j8.falseValue=new j8(IN,IN)
class V8{constructor(e,t,n,r,o=[],i=null,s=null,a=null,c=!1,l=!1,u=!1){this.$kind="PageFacetsFacet",this.id=e,this.parameterName=t,this.title=n,this.displayType=r,this.defaultOptions=i,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l,this.isHiddenFromMenu=u}}class H8{constructor(e,t,n){this.$kind="PageFacets",this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return(0,mm.isSome)(e)&&0!==Object.keys(e).length}}H8.requestValuesForSelectedFacetOptions=function(e){if(H8.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>H8.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={}
for(const e of r){const t=e.split("=")
2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null}
class q8{constructor(e=[],t=null){this.$kind="PageFacetsGroup",this.title=t,this.facets=e}}const W8="-releaseDateByDay&sort=name",z8="-lastUpdatedByDay&sort=name",Y8="alphabet&sort=name",J8="category&sort=-releaseDate",K8="groupBy",Z8=fM,Q8=dE,X8=eG,e7="filter[platform]",t7={}
let n7,r7,o7,i7,s7,a7,c7,l7,u7,d7,f7,h7=!1
const p7={}
p7[Hz.sort]=K8,p7[Hz.ageRating]=pE,p7[Hz.controllerSupport]=wE,p7[Hz.multiplayerSupport]=vE,p7[Hz.comingSoon]=Z8,p7[Hz.binCompatGames]=e7
const w7=mT
class v7{constructor(){this.$intentKind="ArcadeSeeAllGamesPageIntent"}async perform(e,t){return await qp(t,e.requestDescriptor)}}class g7{constructor(){this.$intentKind="ArcadeSeeAllGamesPageMoreIntent"}async perform(e,t){return await Wp(t,e.pageToken)}}class m7 extends H4{constructor(e,t){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,t.exportingService(mN,{fetchArcadeSeeAllGames:async t=>await qp(e,t),fetchMoreArcadeSeeAllGames:async t=>await Wp(e,t.pageToken)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[RW,TW,XH,tq,mV,NV,gH]
return e.bag.enableUpdatedAgeRatings&&t.push(bW),e.appleSilicon.isSupportEnabled&&t.push(bq),t}defaultTab(e){return nz}pageType(){return XG}pageRoute(e){return[{identifier:XG,path:`/${_z.arcadeSeeAllGames}`,query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]},{identifier:XG,hostName:`${$z}`,query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]},{path:"/{countryCode}/{platform}/arcade/see-all",query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]}]}paginationRoute(e){return[{identifier:XG,protocol:Cz,path:`/${_z.arcadeSeeAllGames}/${_z.arcadeSeeAllGamesLoadMore}`}]}shelfRoute(e){return[{protocol:Cz,path:`/${_z.arcadeSeeAllGames}/${_z.shelf}/`,query:[`${Hz.token}`]}]}generatePageRequest(e,t,n){return ym.context("generatePageRequest",()=>{const t=zp(e,n),r=uo(e).includingAdditionalPlatforms(ee(e)).includingRelationships([]).withSparseLimit(10).includingAttributes(Up(e)).usingCustomAttributes(Ue(e))
return function(e,t){let n=!1
for(const e of Object.keys(t)){if(e===Z8&&s(t[e])){const r=t[K8]
if(s(r))switch(r[0].value){case W8:case z8:t[e][0].value=X8
break
case Y8:t[e][0].value=Q8
break
case J8:t[e][0].value=Q8,n=!0}}e===e7&&o(t[e])&&(t[e]=t7[Hz.binCompatGames].false)}n&&e.withSparseCount(4)
for(const n of Object.keys(t)){const r=H8.requestValuesForSelectedFacetOptions(t[n])
if(s(r)){s(r.value)&&e.addingQuery(n,r.value)
for(const t of Object.keys(r.additionalKeyValuePairs))e.addingQuery(t,r.additionalKeyValuePairs[t])}}}(r,s(t.selectedFacetOptions)?t.selectedFacetOptions:Np(e)),r})}async renderPage(e,t,n,o){return await Za(CV,async()=>{const o=v(t),i=zp(e,n),a=Gn(e,Zq,XG,o),c=function(e,t,n){return{url:oY.fromComponents(Cz,null,`/${_z.arcadeSeeAllGames}/${_z.arcadeSeeAllGamesLoadMore}`).build(),metricsPageInformation:n,metricsLocationTracker:{rootPosition:0,locationStack:[]},remainingGroups:[],lastShelfIndex:0,isCompactMode:t.isCompactMode}}(0,i,a),u=new G8(Gp(e,l(o,"results.groups"),c))
u.title=e.loc.string(mk),u.pageFacets=function(e){xp(e),e.featureFlags.isEnabled(IK)
const t=e.loc.string("PAGE_FACETS_FILTERS_AGE_RATINGS"),n=new V8(Hz.ageRating,pE,t,cU,[s7,a7,c7,l7],[s7],"age",Bp(e,jH)),r=e.featureFlags.isEnabled(CK)||!1,o=new V8(Hz.sort,K8,e.loc.string(lT),cU,[n7,r7,o7,i7],r?[n7]:null,jH,Bp(e,jH)),i=e.loc.string(aT),s=new V8(Hz.controllerSupport,wE,i,WN,[u7],null,gE,Bp(e,jH)),a=e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),c=new V8(Hz.multiplayerSupport,vE,a,WN,[d7],null,lq,Bp(e,jH)),l=new V8(Hz.comingSoon,Z8,e.loc.string(cT),WN,[f7],[f7],pM,Bp(e,pM))
l.isHiddenFromMenu=r
const u=new H8([],!1,null)
switch(e.client.deviceType){case iz:u.facetGroups.push(new q8([n])),e.bag.enableComingSoonToggle&&u.facetGroups.push(new q8([l],e.loc.string(uT))),u.facetGroups.push(new q8([s,c],e.loc.string("PAGE_FACETS_SUPPORTS_TITLE"))),u.facetGroups.push(new q8([o]))
break
case"tv":u.facetGroups.push(new q8([n],e.loc.string("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")))
const t=[s,c]
e.bag.enableComingSoonToggle&&t.push(l),u.facetGroups.push(new q8(t,e.loc.string("PAGE_FACETS_FILTERS_TITLE"))),u.facetGroups.push(new q8([o],e.loc.string("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")))
break
default:o.displayOptionsInline=!0,u.facetGroups.push(new q8([o],e.loc.string(lT))),n.showsSelectedOptions=!0,u.facetGroups.push(new q8([s,c,n],e.loc.string("PAGE_FACETS_FILTER_BY_TITLE"))),e.bag.enableComingSoonToggle&&u.facetGroups.push(new q8([l],e.loc.string(uT)))}return u}(e),u.selectedFacetOptions=s(i.selectedFacetOptions)?i.selectedFacetOptions:Np(e),u.pageSegments=[],Vn(e,u,a)
const d=u.pageMetrics.instructions
if(!r(d))for(const e of d)e.data.includingFields.push(aP)
return c.remainingGroups.length>0&&(u.nextPage=c),u})}generatePaginationRequest(e,t,n,r){const o=v(r)
let i=[],s=20,a=!0
for(const e of o.remainingGroups)a=a&&(e.data.length<s||0===i.length),a&&(i=i.concat(e.data),s-=e.data.length)
return new cJ(e,i).includingAdditionalPlatforms(ee(e)).includingAttributes(Up(e)).usingCustomAttributes(Ue(e))}async renderPaginatedPage(e,t,n){const r=v(n),o=[]
let i=20
const a={}
for(const e of t.data)a[e.id]=e
let c=!0
for(const e of r.remainingGroups){if(c=c&&(e.data.length<i||0===o.length),c){for(let t=0;t<e.data.length;t++){const n=a[e.data[t].id]
s(n)&&(e.data[t]=n)}i-=e.data.length}o.push(e)}r.remainingGroups=[]
const l=Gp(e,o,r),u=new G8(l)
return u.title=e.loc.string(mk),r.remainingGroups.length>0&&(u.nextPage=r),u}generateShelfRequest(e,t,n){const r=v(JSON.parse(n[JV])).remainingContent.slice(0,20),o=new cJ(e,r).includingAdditionalPlatforms(ee(e)).includingAttributes(Up(e)).usingCustomAttributes(Ue(e))
return Je(e,o,r),o}async renderShelf(e,t,n){const r=v(JSON.parse(n[JV]))
return r.remainingContent=t.data.concat(r.remainingContent.slice(20,r.remainingContent.length)),r.isFirstRender=!1,jp(e,r)}}class y7{constructor(e,t,n,r){this.$kind="ArcadeSubscribePage",this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class A7{constructor(){this.$intentKind="ArcadeSubscribePageIntent"}async perform(e,t){return await Yp(t,e.url)}}class T7 extends H4{constructor(e,t){super("ArcadeSubscribeBuilder"),t.exportingService(mN,{fetchSubscribePage:async t=>await Yp(e,t.url)})}defaultPlatforms(e){return ee(e)}defaultTab(e){return nz}defaultAttributes(e){const t=[RW,XH,tq]
return e.appleSilicon.isSupportEnabled&&t.push(bq),t}pageType(){return PE}pageRoute(e){return[{hostName:"arcadeSubscribePageCustomContext",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{hostName:`${Fz}`,query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]}]}generatePageRequest(e,t,n){return ho(e,this.marketingItemContextFromParameters(n),f(n,Hz.appId)).attributingTo(t.build())}async renderPage(e,t,n,o){var a,c
const u=o[T7.contextualAppRequirementKey]
let d=null
s(u)&&(d=mt(e,u))
const h=l(t,ZO).map(e=>y(e)),p=e.arcade.getMarketingItemFromMarketingItems(h),w=p,v=Xc(e,w,0,!1,!1,wM),m=this.marketingItemContextFromParameters(n),A=e.client.isPhone,b=m===ht(UL),S=new VJ(nz,e.bag.arcadeAppAdamId,null,AV,null,b&&A?"arcadeLaunchRepairCompactSheet":yk,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
S.titles[mG]=e.loc.string(EU,DU)
const P=f(n,Hz.appId),C=function(e,t,n,r){var o
const s=Gn(e,"Upsell",n,r)
return i(r)&&(s.mercuryMetricsData=null!==(o=Lh(0,r))&&void 0!==o?o:void 0),s}(e,0,w.id,w)
C.offerType=mE,C.baseFields.upsellType=this.metricsUpsellType(m),C.baseFields.subscriptionSKU=e.bag.arcadeProductId
const I={pageInformation:C,locationTracker:{rootPosition:0,locationStack:[]}},k=tl(e,{marketingItemData:p},Zc(0,w),I,!1)
if(!T(c=k)||c[hz]!==sA)throw new Error("Only buy actions are supported on the upsell page")
const O=new y7(v,e.loc.string(fT),k,S)
let E
O.askToBuyMessage=f(n,Hz.subscribePageMessage),O.askToBuyId=f(n,Hz.askToBuyId),Vn(e,O,C)
let D=!1
if(s(d)){O.primaryIcon=ff(e,d,I,{useCase:R3.LockupIconLarge})
const t=V(d,uW),r=ea(e,d,I)
r.excludeAttribution=!g(n[Hz.includePostSubscribeAttribution]),E=Cr(e,d,kW,m,t,r),D=!0}if(!g(n[Hz.includePostSubscribeAttribution])){const e=O.pageMetrics.instructions
if(!r(e))for(const t of e)t.data.includingFields.push(SF)}let R=[]
const _=o[T7.contextualIconsRequirementKey]
if(s(_)&&(R=Tt(_)),i(p)&&(R=we(p,sz)),s(R)){const t=[]
for(const n of R)if(n.id===P){if(!D){O.primaryIcon=ff(e,n,I,{useCase:R3.LockupIconLarge})
const t=V(d,uW),r=ea(e,n,I)
E=Cr(e,n,kW,m,t,r)}}else t.push(ff(e,n,I,{useCase:R3.LockupIconMedium}))
O.icons=t}return i(E)&&(k.postSubscribeAction=E),b&&i(P)&&(O.openAppAction=new tZ(P)),s(O.icons)||i(O.primaryIcon)||(O.artwork=this.genericArtworkFromData(e,w)),b&&(O.singleIcon=O.primaryIcon,(null===(a=O.singleIcon)||void 0===a?void 0:a.art)&&(O.singleIcon.art.contentMode=Pm.scaleAspectFit)),O.subscribedOfferButtonAction=new R0(nz),O}genericArtworkFromData(e,t){if(!i(t))return
const n=e.client.isPhone,r=function(e,t,n){const r=function(e,t){return qc(e,t)}(e,t)
return p(r,n)}(e,t,n?Wb:LD)
if(!s(r))return
let o,a=h(r,nj)
return(0,mm.isSome)(a)&&n?(o="of",a=a-296-1602):(0,mm.isSome)(a)&&(o="og",a=a-344-772),df(e,r,{cropCode:o,allowingTransparency:!0,useCase:R3.ArcadeContextualUpsell,overrideHeight:a})}metricsUpsellType(e){return i(e)?e:ht(lV)}marketingItemContextFromParameters(e){let t=f(e,Hz.context)
const n=f(e,Hz.askToBuyId)
switch(o(t)&&s(n)&&(t=BL),t){case UL:return ht(UL)
case BL:return ht(BL)
default:return t}}}T7.contextualIconsRequirementKey="contextualIconsRequirement",T7.contextualAppRequirementKey="contextualPrimaryIconRequirement"
class b7 extends gK{constructor(e){super(e,"ArcadePage")}}const S7="amdImpressionData"
class P7 extends H4{constructor(e=null){super(e||"AbstractGroupingPageController")}generateAdditionalPageRequirements(e,t,n){var r
const o=super.generateAdditionalPageRequirements(e,t,n),i=e.amsEngagement
if(!i||!gn(e))return o
const s=[qq,az,nz],a=null===(r=e.bag.tabsStandard.find(e=>e.url===t.toString()))||void 0===r?void 0:r.id
if(!s.includes(a))return o
const c={timeout:1e3,eventType:GZ,tab:a}
return o[S7]=R(i.performRequest(c)),o}async renderPage(e,t,n,r,o,s){return await Za(zb,async()=>{const a=function(e,t){const n=mt(e,t)
return n&&de(n,Hj)?Cl(e,n):null}(e,t),c=function(e,t,n){const r=mt(e,t)
if((0,Am.isNothing)(r))return null
const o=Gn(e,DD,r.id,t),s=Os(e)
return o.recoMetricsData=Mh(o.recoMetricsData,null,s),{shelves:[],metricsPageInformation:o,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:j(r,"id"),pageGenreId:null,hasAuthenticatedUser:i(e.user.dsid),refreshController:jr(t),recoImpressionData:vn(0,null==n?void 0:n[S7])}}(e,t,r)
return(0,Am.isNothing)(a)||(0,Am.isNothing)(c)?null:this.renderGroupingPage(e,a,c,n,r,o,s)})}}class C7{constructor(){this.$intentKind="ArcadePageIntent"}async perform(e,t){return await Kp(t,e)}}class I7 extends P7{constructor(e,t){super("ArcadePageBuilder"),t.exportingService(mN,{fetchPage:async t=>await Kp(e,t)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[RW,XH,tq,dG]
return e.bag.enableUpdatedAgeRatings&&t.push(bW),e.appleSilicon.isSupportEnabled&&t.push(bq),t}pageType(){return nz}pageRoute(e){return[{protocol:Iz,path:`/${_z.store}/${_z.grouping}`,query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`,Hz.id]},{hostName:Lz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.grouping}`,query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`,Hz.id,`${Hz.useReleaseId}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]},{protocol:Iz,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]},{protocol:Iz,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]}]}generatePageRequest(e,t,n){const r=n[Hz.id],o=g(n[Hz.isSubscribed]),s=g(n[Hz.isTrialEnrolled])
if(!a(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
const c=[RW,TW,XH,tq,gH,aj]
e.appleSilicon.isSupportEnabled&&c.push(bq),e.bag.enableUpdatedAgeRatings&&c.push(bW),vf(e)&&c.push(Tq)
let l=new cJ(e).includingAgeRestrictions().includingAttributes(c).includingMacOSCompatibleIOSAppsWhenSupported()
li(e)&&(l.enablingFeature(Uq),l.includingScopedAttributes(tz,eQ),l.includingScopedRelationships(tz,[VW])),ui(e)&&(l.enablingFeature(eF),Pi(l)),di(e)&&(l.enablingFeature(CU),Ii(l))
const u=ne(e)
if(i(u)&&l.addingQuery(Oj,u),o){const t=!0,n=lr(e,e.bag.arcadeTrialEnrolledStateRate)
t&&s&&n?l.addingQuery(Hj,"trial-enrolled"):l.addingQuery(Hj,"subscriber")}else l.addingQuery(Hj,"nonsubscriber"),l.includingRelationshipsForUpsell(!1)
l.withIdOfType(r,SH)
const d=t.query[Hz.useReleaseId]
return Vz.has(t.host)&&(null==d?void 0:d.length)>0&&(l=l.addingQuery(Ak,d),l.isStorePreviewRequest=!0),l.enablingFeature(ED),l.enablingFeature(Vb),l.withSparseCount(Q(e)),l.includingScopedSparseLimit(PU,X(e)),l.attributingTo(t.build())}renderGroupingPage(e,t,n,r,i,a,c){return ym.context(CV,()=>{const i=g(r[Hz.isSubscribed]),c=g(r[Hz.isTrialAvailable]),l=g(r[Hz.isTrialEnrolled]),u={}
u[Hz.isArcade]="true",u[Hz.isSubscribed]=`${i}`,u[Hz.isTrialAvailable]=`${c}`,u[Hz.isTrialEnrolled]=`${l}`,n.additionalShelfParameters=u,n.isArcadePage=!0,n.metricsPageInformation.isCrossfireReferralCandidate=!0
let d=null,f=null
if(!i){const r=po(e,t.originalGroupingData)
if(r)d=r.marketingItemData
else if(a){ym.unexpectedNull(Cq,Tk,"relationships.upsell")
const e=wo(0,a.get(bL))
e&&(d=e.marketingItemData)}if(s(d)&&s(d.attributes)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,mercuryMetricsData:Lh(0,d)}
f=Kc(e,d,t),s(n)&&o(n.pageTitleEffect)&&0===n.shelves.length&&(n.pageTitleEffect=function(e,t){const n=Bc(e,t,!0),r=Nc(e,t)
return Jc(0,n.artworkData||r.artworkData,!0)}(e,d)),Vh(n.metricsLocationTracker)}}const h=I7.insertUpsellBreakoutShelfIntoParseContextIfNecessary(f,i,n)
Sl(e,t,n)
const p=new b7(n.shelves)
Vn(e,p,n.metricsPageInformation),p.tabTitle=j(t.originalGroupingData,cz)
const w=j(t.originalGroupingData,cz)
e.host.clientIdentifier,h||(p.title=w)
const v=new H5(wH)
v.color=Se("primaryText"),v.isFallbackStyle=!0,e.clientCapabilities.isEnabled("arcadeStandardLargeTitle")?p.presentationOptions=[tF]:p.presentationOptions=[]
let m=!1
if(n.shelves.length>0){const e=n.shelves[0].contentType===bx,t=n.shelves[0].contentType===ej,r=n.shelves[0].contentType===eV
m=e||t||r}if(m&&(p.presentationOptions.push(dB),p.titleEffect=n.pageTitleEffect||v),!i&&s(f)){p.subscriptionOfferAction=I7.createSubscribeAction(e,f,{id:null,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:lz}),p.subscriptionOfferDisplayProperties=new VJ(nz,e.bag.arcadeAppAdamId,null,AV,null,nz,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r={marketingItemData:d}
p.subscriptionLockup=Wd(e,r,t,ht(qU),AV,PD)}const y={id:"arcade-see-all-games-footer",presentationHints:{},featuredContentId:-1,featuredContentData:null,nativeGroupingShelfId:1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
if(this.insertUnifiedMessageShelves(e,p),p.shelves.length>0){const t=I7.groupingArcadeFooterShelfController.createShelf(e,null,n,y,null)
p.shelves.push(t)}if(0===p.shelves.length)throw new Error(`Missing content for Arcade grouping ${JSON.stringify(r)}`)
return p.autoUpsellAction=so(e,ht(lV),null,null),Jp(p),p})}static insertUpsellBreakoutShelfIntoParseContextIfNecessary(e,t,n){return ym.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(o(e))return t||ym.unexpectedNull(gq,Tk,ej),!1
const r=new pK(ej)
return r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t,n){if(o(t))return null
{const r=so(e,ht(MO),null,null,n)
return r.title=t.offerButtonAction.title,r}}createTermsAndConditionsShelf(e){return!r(e.bag.termsAndConditionsURL)&&e.client.deviceType,null}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t,n){if(r(n))return null
const o=mt(e,t),i=g(n.parameters[Hz.isSubscribed]),s=po(e,o)
return!i&&r(s)?new Set([bL]):null}fetchAdditionalDataForKey(e,t){return ym.context("fetchAdditionalDataForKey",async()=>{let n
return t===bL&&(n=ho(e,ht(qU)),ym.unexpectedNull(gq,pH,"upsellRecovery.marketingItem")),r(n)?null:await Ln(e,n).catch(()=>null)})}insertUnifiedMessageShelves(e,t){t.shelves.length<=0||(t.shelves.splice(1,0,Ol(0,"arcadePageHeader")),t.shelves.splice(6,0,Ol(0,"arcadePageMid")),t.shelves.push(Ol(0,"arcadePageFooter")))}}I7.groupingArcadeFooterShelfController=new y5
class k7{constructor(e,t){this.$kind="ArcadeWelcomePage",this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class O7{constructor(e,t,n,r,o){this.$kind="ArcadeWelcomeContent",this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class E7{constructor(e,t,n){this.$kind="ArcadeWelcomeItem",this.headline=e,this.body=t,this.artwork=n}}const D7={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:dT,textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},R7={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:dT,textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"}
class _7{constructor(){this.$intentKind="ArcadeWelcomePageIntent"}async perform(e,t){return await Qp(t,e.url)}}class L7 extends V4{constructor(e,t){super("ArcadeWelcomeBuilder"),t.exportingService(mN,{fetchArcadeWelcomePage:async t=>await Qp(e,t.url)})}pageType(){return"arcadeWelcome"}async handlePage(e,t,n,r,o){const i=await this.generatePage(e,n,r)
return V4.createFlowAction(i,this.pageType(),t)}pageRoute(e){return[{hostName:"arcadeWelcomePage",query:[`${Hz.context}?`]}]}async generatePage(e,t,n){return function(e,t){return function(e,t){const n={rootPosition:0,locationStack:[]},r=function(e,t){if(ir(t)){const t=new Pz
return t.title=e.loc.string("ARCADE_WELCOME_TV_CONTINUE_BUTTON"),t}return Zp(0,e.loc.string("ARCADE_WELCOME_CONTINUE_BUTTON"))}(e,t)
ra(e,r,{id:"arcade-welcome-continue",actionType:dz,pageInformation:new cZ,locationTracker:n,targetType:lz})
const o=function(e,t){return ir(t)?Zp(0,e.loc.string(yE)):null}(e,t)
o&&ra(e,o,{id:"arcade-welcome-create-family",actionType:dz,pageInformation:new cZ,locationTracker:n,targetType:lz})
let i=D7,s="oe"
e.client.isPad&&(i=R7,s="og")
const a=new O7(e.loc.string("ARCADE_WELCOME_INDIVIDUAL_TITLE"),e.loc.string("Arcade.Welcome.Family.Description"),[new E7(null,null,df(e,i,{useCase:R3.ArcadeWelcomeSheet,cropCode:s}))],r,o)
if(ir(t)){a.nonDismissingContinueAction=Zp(0,e.loc.string(yE)),r.title=a.nonDismissingContinueAction.title
const t=new Pz
t.title=e.loc.string(fT),a.dismissingFamilyAction=t,o.title=a.dismissingFamilyAction.title}else a.nonDismissingContinueAction=Zp(0,e.loc.string(yE)),r.title=a.nonDismissingContinueAction.title
return new k7(a,a)}(e,t)}(e,t[Hz.context])}}class M7 extends V4{constructor(){super("FamilyCircleBuilder")}pageType(){return GW}defaultTab(e){return nz}async handlePage(e,t,n,r,o){var i
const s=new R0(nz),a=null!==(i=t.query[UV])&&void 0!==i?i:UA,c=new o8(dW,a,t.query)
return s.actions.push(c),s}pageRoute(e){return[{hostName:`${xz}`},{path:`${xz}`}]}}class F7{constructor(e,t){this.$kind="UpsellGridContent",this.primaryIcon=e,this.icons=t}}class $7{constructor(){this.$intentKind="ArcadeUpsellGridIntent"}async perform(e,t){return await Xp(t,e.contentDictionary)}}class x7 extends V4{constructor(e,t){super("MarketingItemUpsellBuilder"),t.exportingService(mN,{fetchUpsellGrid:async t=>await Xp(e,t.contentDictionary)})}pageType(){return vV}pageRoute(e){return[{hostName:`${Fz}`,query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`],exclusions:[{query:[`${Hz.askToBuyId}`]}]},{path:"arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`]}]}async handlePage(e,t,n,r,o){var i
const s=ht(f(n,Hz.context)),a=f(n,Hz.appId),c=new dQ(nz,s,e.bag.metricsTopic,a),l=new _J(vV),u=null===(i=e.metricsIdentifiersCache)||void 0===i?void 0:i.getMetricsFieldsForTypes([Om.user,Om.client,Om.canonical])
return(0,mm.isSome)(u)&&(c.metricsOverlay={...c.metricsOverlay,...u}),l.pageData=c,l}}class N7{constructor(){this.$intentKind="ArcadeSubscriptionDecorationIntent"}async perform(e,t){return await ew(t,e.json)}}class B7 extends V4{constructor(e,t){super("ArcadePurchaseDecorationController"),t.exportingService(Rk,{decorateArcadePurchase:async t=>await ew(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class U7{constructor(e,t,n){this.$kind="PersonalizedOfferContext",this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}class G7{constructor(){this.$intentKind="PersonalizedOfferContextIntent"}async perform(e,t){return await tw(t,e.offerToken)}}class j7 extends V4{constructor(e,t){super("CompleteCollectionController"),t.exportingService("CMCPersonalizationData",{fetchPersonalizedOfferContext:async t=>await tw(e,t.offerToken)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class V7{constructor(e,t){this.purchase=e,this.buyParams=t}}class H7{constructor(e,t){this.items=e,this.commonBuyParams=t}}class q7{constructor(){this.$intentKind="PurchaseDecorationIntent"}async perform(e,t){return await rw(t,e.json)}}class W7{constructor(){this.$intentKind="PurchasesDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await rw(t,r))
return n}}class z7{constructor(){this.$intentKind="BatchPurchaseDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await rw(t,r))
const r=n.map(e=>e.buyParams),[o,i]=function(e){const t=[]
for(const n of e)t.push(new uZ(n).toRawMap())
const n=function(e){if(0===e.length)return{}
const t={},n=e[0]
for(const r of Object.keys(n)){let o=!0
for(let t=1;t<e.length;t++)if(e[t][r]!==n[r]){o=!1
break}o&&(t[r]=n[r])}return t}(t)
for(const e of t)for(const t of Object.keys(n))delete e[t]
return[t,n]}(r),s=[]
for(let e=0;e<n.length;e++)s.push(new V7(n[e],o[e]))
return new H7(s,i)}}class Y7 extends V4{constructor(e,t){super("PurchaseDecorationController"),t.exportingService(Rk,{decoratePurchase:async t=>await rw(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class J7{constructor(){this.$intentKind="IconArtworkIntent"}async perform(e,t){return await ow(t,e.adamIds)}}class K7 extends V4{constructor(e,t){super("IconLookupController"),t.exportingService("ContentData",{fetchIconArtwork:async t=>await ow(e,t.adamIds)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class Z7 extends V4{constructor(){super("ContentLink")}pageType(){return fz}async handlePage(e,t,n,o,s){if(r(f(n,Hz.path)))throw new Error(`Unhandled search url: ${t}`)
const a=await M(e.network.fetch({url:t.build(),method:YB}))
if(!a.success)throw new Error(`Unhandled search url: ${t}`)
const c=a.value
if(this.hasGotoURLInResponse(e,c))return new Pz
if(i(c.url))return await e.required(R9).fetchAction(e,c.url,s)
throw new Error(`Unhandled search url: ${t}`)}pageRoute(e){return[{hostName:"search.itunes.apple.com",path:"WebObjects/MZContentLink.woa/wa/link",query:[Hz.path]}]}hasGotoURLInResponse(e,t){const n=t.body
if((0,mm.isNothing)(n)||0===n.length)return!1
try{const t=m(e.plist.parse(n)),r=f(t,OE),o=f(t,EE)
return!!(r===DE&&(0,mm.isSome)(o)&&o.length>0)}catch{return!1}}}class Q7 extends V4{constructor(){super("ExperimentLink")}pageType(){return GW}async handlePage(e,t,n,r,o){var i
const s={url:t.toString()},a=await M(e.network.fetch(s))
if(!a.success)throw a.error
const c=a.value
if(c.status>=200&&c.status<300){const e=new $J(kW)
return e.title="You have been enrolled in the AB test",e.message=`Test ${null===(i=t.query)||void 0===i?void 0:i.ab2} is now active on your device.`,e.buttonTitles=["OK"],e.buttonActions=[new R0(_q)],e}throw new Error(`unexpected response status: ${c.status} from ${c.url}`)}pageRoute(e){return[{protocol:Iz,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}const X7=[az,x_]
class eee extends V4{constructor(){super("FallbackActionBuilder")}async handlePage(e,t,n,i,s){return await async function(e,t,n,i){var s
const a=t.query[aW]
switch(a){case pq:const n=new _J(fV)
n.presentationContext=$V,n.animationBehavior=WU
const c=t.query[YL]
return c?n.pageUrl=c:t.query[gA]?n.pageUrl=oY.fromComponents(null,a,null,{continuation:t.query[gA]}).toString():n.pageUrl=a,await Promise.resolve(n)
case mA:const l=new _J(fV)
return l.presentationContext=$V,l.animationBehavior=WU,l.pageUrl=function(e){let t=e.bag.createAccountUrl
return(r(t)||typeof t!==$W)&&(t=HO),new oY(t)}(e).build(),await Promise.resolve(l)
case DN:let u,d=[]
{u=JL
const t=new _J(pq)
let n
t.presentationContext=$V,t.animationBehavior=hq,e.featureFlags.isEnabled(GK)?(n=new _J(jO),n.animationBehavior=hq):(n=new _J(yA),n.animationBehavior=hq),d=[t,n]}const f=new R0(u)
return f.actions=d,await Promise.resolve(f)
case KL:const h=t.query[YL]
if(h.length>0){const t={url:h,signingStyle:GH}
return e.network.fetch(t),await Promise.resolve(new Pz)}return await Promise.reject(new Error("Original url is missing when creating deep-link for checkForPreorders."))
case RN:const p=new _J(fV)
p.presentationContext=$V,p.animationBehavior=WU
const w=new oY(a)
return t.query[_N]&&t.query[_N].length>0&&w.param(Hz.code,t.query[_N]),p.pageUrl=w.build(),await Promise.resolve(p)
case LN:const v=new _J(fV)
return v.presentationContext=$V,v.animationBehavior=WU,v.pageUrl=a,await Promise.resolve(v)
case AA:const g=new _J(fV)
return g.presentationContext=$V,g.animationBehavior=WU,g.pageUrl="charity",await Promise.resolve(g)
case gW:let m=t.query[jj]
if(m||(m=null!==(s=t.query.q)&&void 0!==s?s:t.query[VO]),m&&m.length>0){const t=m
if(m=m.replace(/\+/g," ").trim(),t.endsWith("+")&&m.length>0&&(m+="+"),o(m))return await Promise.reject(new Error("Empty search term."))
const n=ge(e,aw(e,{term:m,origin:JB})).toString(),r=new y6(m,m,n,JB,null,null,null,i)
sa(e,r,lz,{rootPosition:0,locationStack:[]})
{const e=new _J(gW)
return e.pageData=r,await Promise.resolve(e)}}{const e=new R0(gW)
return await Promise.resolve(e)}}return await Promise.reject(new Error(`FlowAction was not able to be created for this action URL: ${t}`))}(e,t,0,s)}pageRoute(e){return[{query:[`${Hz.action}=account`]},{query:[`${Hz.action}=signup`]},{query:[`${Hz.action}=purchased`]},{query:[`${Hz.action}=checkForPreorders`]},{query:[`${Hz.action}=redeem`]},{query:[`${Hz.action}=gift`]},{query:[`${Hz.action}=donate`]},{query:[`${Hz.action}=search`]}]}pageType(){return GW}}class tee extends V4{constructor(){super("GameCenterProfileLinkController")}defaultTab(e){return nz}pageType(){return GW}async handlePage(e,t,n,r,o){let i=!1
if(e.host.clientIdentifier===oJ)i=!0
else for(const t of e.bag.tabsStandard)if("ocelot"===f(t,"id")){i=!0
break}const s=new R0(i?nz:qq),a=n[Hz.id]||"GameCenter.localPlayer"
return s.actions.push(new h3(a)),s}pageRoute(e){return[{identifier:Lk,path:`/${_z.gameCenterProfile}`,query:[`${Hz.id}?`]}]}}class nee extends V4{constructor(){super("HiddenPurchasesLinkController")}pageType(){return CE}async handlePage(e,t,n,r,o){const i=new _J(CE)
return i.presentationContext=XB,i}pageRoute(e){const t=[]
return t.push({hostName:"showHiddenPurchases"}),t}}class ree extends V4{constructor(){super("LibraryLink")}pageType(){return GW}async handlePage(e,t,n,r,o){var i
const s=`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${null===(i=t.query)||void 0===i?void 0:i.g}&mt=8`
return await e.required(R9).fetchAction(e,s,o)}pageRoute(e){return[{query:[`${Hz.action}=library-link`]}]}}class oee extends V4{constructor(){super("LongUrlBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const a=t.query[YL]
if((0,mm.isNothing)(a)||0===a.length)throw new Error("Original url is missing when creating deep-link for checkForLongUrl.")
const c=await M(e.network.fetch({url:a,method:YB,signingStyle:GH}))
if(!c.success)throw new Error(`Unable to fetch long url: ${a}`)
const l=c.value
let u
const d=l.headers["Content-Type"]
if(l.ok&&l.redirected&&i(l.url))u=l.url
else{if(l.ok&&a!==l.url)return e.console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${a}. Redirected url: ${l.url}`),new Pz
if(l.ok&&s(d)&&-1!==d.toLowerCase().indexOf("text/xml")){const t=m(e.plist.parse(l.body)),n=f(t,OE),r=f(t,EE)
n===DE&&r&&(u=r)}}if((null==u?void 0:u.length)>0)return await e.required(R9).fetchAction(e,u,o)
throw new Error(`Unable to map long url for: ${a}`)}pageRoute(e){return[{query:[`${Hz.action}=checkForLongUrl`]}]}}class iee extends V4{constructor(){super("MultiplexingBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const i=new cJ(e).withIdOfType(n.id,b$)
return await Ln(e,i).then(async t=>await this.actionFromMultiplexResponse(e,t))}pageRoute(e){return[{protocol:Iz,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[Hz.id]}]}async actionFromMultiplexResponse(e,t){const n=p(t,"results.target"),r=p(t,"results.target-link")
return n?await this.targetDataToAction(e,n):r?await this.targetLinkDataToAction(r):null}async targetDataToAction(e,t){const n=f(t,uj)
if(!n)return null
const r=ji(e,n)
return await e.required(R9).fetchAction(e,r,null)}async targetLinkDataToAction(e){const t=f(e,BW),n=new oY(t),r=this.addProtocolToURLIfNeeded(n).toString()
return await Promise.resolve(new HJ(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol=PL),e}}class see extends V4{constructor(){super("NotificationSettingsLinkController")}pageType(){return GW}async handlePage(e,t,n,r,o){return new _J(IE)}pageRoute(e){const t=[]
return t.push({path:"notifications/settings"}),t}}class aee extends V4{constructor(){super("TabSelectionBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const i=t.pathComponents(),s=i.length-1
let a,c
return a=s>=0?i[s]:t.query[aW],null!=a&&this.currentDeviceSupportsUrlAction(e,a)&&(c=new R0(a),c.popToRoot=t.query.popToRoot===cW),void 0===c&&(c=new R0(UW)),c}pageRoute(e){const t=[UW,"home",qq,az,gj,oV,wN,GB,vN,KB,nz,$G],n=[]
for(const e of t){const t=`${Hz.action}=${e}`,r=`${e}`
n.push({query:[t]}),n.push({path:r}),n.push({path:`{countryCode}/${r}`})}return n.push({path:"{countryCode}/ipad"}),n.push({path:"{countryCode}/iphone"}),aee.supportedIOSTabs.forEach(e=>{n.push({path:`{countryCode}/ipad/${e}`}),n.push({path:`{countryCode}/iphone/${e}`})}),n}currentDeviceSupportsUrlAction(e,t){return!!aee.supportedIOSTabs.includes(t)}}aee.supportedMacTabs=[gj,nz,oV,wN,GB,vN,KB,gW],aee.supportedIOSTabs=[UW,az,qq,nz,gW],aee.supportedTvTabs=[gj,az,qq,nz,gW],aee.supportedVisionOSTabs=[$G,nz,gW]
class cee extends V4{constructor(){super("PassbookBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){const i=this.assemblePassbookRoomURL(e,t).build()
return await e.required(R9).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${Hz.action}=passbook`]}]}assemblePassbookRoomURL(e,t){let n=e.bag.passbookMainURL
return null!=n&&typeof n===$W||(n="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new oY(n)}}class lee extends V4{constructor(){super("WatchCategoryBuilder")}pageType(){return GW}async handlePage(e,t,n,r,o){if(e.client.deviceType!==ZW)throw new Error(`Unsupported url for current platform: ${t}`)
const i=e.bag.watchAppsGroupingURL,s=await M(e.required(R9).fetchAction(e,i,o))
if(!s.success)throw s.error
const a=s.value,c=new R0(az)
return c.actions=[a],c}pageRoute(e){return[{query:[`${Hz.action}=watchCategory`]}]}}class uee extends q4{}const dee=[_V,VH,JW,oj,cB],fee=[_V,VH,lB,JW,ij,AU,aG,cG],hee=[_V,uB,VH,ij],pee=[_V,lB,JW,ij,oj,VH,uB,cG,aG,AU]
class wee{}class vee extends V4{constructor(){super("DeveloperBuilder")}async handlePage(e,t,n,r,o){const i=function(e,t){const n=Vi(t)
if(!a(n))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return Fi(e,new cJ(e).withIdOfType(t,rH))}(e,n)}(e,t)
return await Ln(e,i).then(t=>lw(e,t)).then(e=>V4.createFlowAction(e,fz,t))}pageRoute(e){return[{protocol:Iz,path:`/${_z.developer}/{id}`},{protocol:Iz,path:`/${_z.developer}/{developerName}/{id}`},{protocol:Iz,path:`/{countryCode}/${_z.developer}/{developerName}/{id}`},{protocol:Iz,path:`/{countryCode}/${_z.artist}/{developerName}/{id}`},{protocol:Iz,path:`/${_z.store}/${_z.viewArtist}`,query:[Hz.id,`${Hz.v0}?`]}]}async handleShelf(e,t,n,r){const i=n[JV],s=JSON.parse(i),a=new cJ(e,s.remainingData).includingAdditionalPlatforms(ee(e)).includingAttributes(Mi(e)).includingMacOSCompatibleIOSAppsWhenSupported()
return function(e,t,n){const r=hw(e,n.title,n.developerId,yt(t),n.relationship,n.contentType,n.lockupListOptions,n.lockupListOptions.lockupOptions.metricsOptions.pageInformation,n.lockupListOptions.lockupOptions.metricsOptions.locationTracker,n.roomUrl,(0,mm.isSome)(n.roomUrl))
return r.mergeWhenFetched=!0,!n.hasExistingContent&&o(r.items)&&(r.isHidden=!0),r}(e,await Ln(e,a),s)}shelfRoute(e){return[{protocol:Cz,path:`/${_z.developer}/${_z.shelf}/{token}`}]}pageType(){return fz}}class gee extends V4{constructor(){super("DeveloperHrefBuilder")}async handlePage(e,t,n,r,o){const i=n[Hz.href],s=function(e,t){return Fi(e,new cJ(e,t))}(e,i)
return await Ln(e,s).then(t=>lw(e,t)).then(e=>V4.createFlowAction(e,fz,t))}pageRoute(e){return[{protocol:Cz,path:`/${_z.developer}/${_z.href}`,query:[Hz.href]}]}pageType(){return fz}}class mee extends W4{constructor(){super("DeveloperRoomBuilder")}pageRoute(e){return[{protocol:Cz,path:`/${_z.developer}/${_z.room}/{token}`}]}paginationRoute(e){return[{protocol:Cz,path:`${this.paginationPath}`,query:[`${Hz.token}`]}]}generatePageRequest(e,t,n){const o=n[JV],i=JSON.parse(o)
if(r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new cJ(e,i.url).withSparseLimit(i.maxPerPage).includingAdditionalPlatforms(ee(e)).includingAttributes(Mi(e))}async renderPage(e,t,n,r){return await Za(CV,async()=>{const r=n[JV],o=JSON.parse(r),i=Gn(e,Zq,`${o.developerId}_${o.relationshipId}`,t)
o.metricsPageInformation=i,o.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=await this.pageWithContent(e,t,o)
return s.title=o.title,this.configurePaginationForPage(s,o,t.next),Vn(e,s,i),s})}generatePaginationRequest(e,t,n,r){var o
const i=r,a=St(0,i)
let c
return s(a)?c=new cJ(e,a):(null===(o=i.nextHref)||void 0===o?void 0:o.length)>0&&(c=new cJ(e,i.nextHref).withSparseLimit(i.maxPerPage)),c.includingAdditionalPlatforms(ee(e)).includingAttributes(Mi(e)),c}async renderPaginatedPage(e,t,n){const r=n,o=s(r.remainingContent),i=await this.pageWithContent(e,t,r,!o),a=Pt(0,r)
return this.configurePaginationForPage(i,a,o?r.nextHref:t.next),i}configurePaginationForPage(e,t,n){const r=(null==n?void 0:n.length)>0,o=s(t.remainingContent)
r||o?(t.nextHref=n,t.url=`${this.paginationUrl}?${Hz.token}=${JSON.stringify(t)}`,e.nextPage=t):e.nextPage=null}}!function(e){e.ViewAligned="viewAligned",e.CenterAligned="centerAligned"}(my||(my={}))
class yee extends H4{constructor(){super("EditorialPageController")}defaultPlatforms(e){return ee(e)}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o)
const s=r.pathname===`/${_z.editorialPage}/${_z.shelf}`
let a
t.includingScopedRelationships("editorial-shelves",[sz]).includingScopedRelationships(Wq,[uG]),s?t.includingAssociateKeys(az,[YV]).includingAssociateKeys(YW,[YV]):(t.includingRelationships([hB]).withSparseCount(5).withSparseLimit(12).includingAssociateKeys(bU,[YV]),t.includingAssociateKeys(CH,[az])),Yw(e,t),a=r.query[Hz.context]||ne(e),i(a)&&t.addingQuery(Oj,a)}generatePageRequest(e,t,n){var r
let i
i=t.host===Bz?e.bag.safariExtensionsEditorialPageId:t.query[Hz.id]||n[Hz.id]
const s=n[Hz.name]
if(o(i)&&o(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
const a=new cJ(e)
let c=!1
return(null===(r=t.pathname)||void 0===r?void 0:r.includes(CH))&&(a.forType(CH),c=!0),c||a.forType(Wq),(null==i?void 0:i.length)>0&&(c?a.withIdOfType(i,CH):a.withIdOfType(i,Wq)),(null==s?void 0:s.length)>0&&a.addingQuery(Hz.name,s),a.attributingTo(t.build())}pageRoute(e){return[{protocol:Cz,path:`${_z.editorialPage}`,query:[`${Hz.name}`,`${Hz.isArcade}?`]},{protocol:Cz,path:`${_z.editorialPage}`,query:[`${Hz.id}`,`${Hz.isArcade}?`]},{protocol:Iz,path:"/{countryCode}/editorial-page/id{id}"},{protocol:Iz,path:"/editorial-page/id{id}"},{protocol:Iz,path:"/{countryCode}/{platform}/editorial/{id}"},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/catalog/{countryCode}/tags/{id}",query:[`${Hz.deviceFamily}?`]}]}pageType(){return fz}async renderPage(e,t,n,a,c,l){return await Za("renderEditorialPage",async()=>await async function(e,t,n){var a,c
const l=mt(e,t)
if(!s(l))return null
const u=we(l,hB)
if(!s(u))return null
let d="Editorial"
f(l,IH)===CH&&(d="TagRoom")
const h=Gn(e,d,l.id,t),p={rootPosition:0,locationStack:[]},w=Os(e)
h.recoMetricsData=Mh(h.recoMetricsData,null,w)
const v=jr(t),{isArcadePage:g}=n,m=[]
let y=null,A=null
if(!i(l.attributes))return null
y={id:l.id,type:l.type,attributes:l.attributes,relationships:l.relationships,meta:l.meta}
let T=!1
for(const t of u){const n=m.length,o=Bw(e,y.id,t,g,n,h,p),i=Ww(e,y,o)
if(!r(i)){if(0===m.length){const e=i.presentationHints
i.presentationHints={...e,isFirstShelf:!0}}o.type===xm.Upsell&&(T=!0),i.contentType===ej&&(A=zw(e,o)),m.push(i)}}const b=g?new b7(m):new gK(m)
b.title=T?null:null!==(a=j(l,oH))&&void 0!==a?a:j(l,cz),b.canonicalURL=j(l,BW),b.shareAction=function(e,t){var n
const s=j(t,BW),a=j(t,oH)
if(r(s)||r(a))return null
const c=function(e,t,n,r,i,s){return ym.context("shareSheetDataForGenericPage",()=>{if(o(n))return null
const e=new PQ(t,r,null!=s?s:void 0)
return new yQ(e,n,null)})}(0,a,s,e.loc.string("SHARE_EDITORIAL_PAGE_SUBTITLE"),0,null===(n=wd(e,t,fy.EditorialPage))||void 0===n?void 0:n.artwork)
if((0,mm.isNothing)(c))return null
const l=function(e,t){const n=[]
if((null==t?void 0:t.length)>0){const r=Wo(e,t)
i&&n.push(r)}return n}(e,s)
return new nQ(c,l)}(e,l),b.pageRefreshPolicy=Hr(e,v),g&&i(A)&&(b.subscriptionLockup=A),g&&(h.isCrossfireReferralCandidate=!0),Vn(e,b,h)
const S=(null===(c=m[m.length-1])||void 0===c?void 0:c.contentType)===gD
if(e.client.deviceType!==oz&&"tv"!==e.client.deviceType&&!S){const t=e.bag.termsAndConditionsURL
if(!r(t)){const n=kl(e,t)
m.push(n)}}if(m.length>0){const e=m[0].contentType===bx,t=m[0].contentType===ej,n=m[0].contentType===eV,r=m[0].contentType===Sx;(e||t||n||r)&&b.presentationOptions.push(dB),r&&(b.presentationOptions.push(jM),b.presentationOptions.push(Lb))}return Jp(b),b}(e,t,{isArcadePage:g(n,Hz.isArcade)}))}shelfRoute(e){return[{protocol:Cz,path:`/${_z.editorialPage}/${_z.shelf}/`,query:[`${Hz.token}`]}]}generateShelfRequest(e,t,n){const r=n[Hz.token],o=JSON.parse(decodeURIComponent(r)),i=s(o.remainingItems),a=!i&&(0,Am.isSome)(o.recommendationsHref)&&o.recommendationsHref.length>0
if(i){const t=o.remainingItems,n=new cJ(e,t,!0,[YV])
return Je(e,n,t),n}if(a){const t=new cJ(e,o.recommendationsHref)
return li(e)&&(t.enablingFeature(Uq),t.includingMetaKeys(PU,[kx,XM]),t.includingScopedAttributes(tz,[SW,YG,rU]),t.includingScopedRelationships(tz,[VW])),di(e)&&(t.enablingFeature(CU),Ii(t)),t}return null}async renderShelf(e,t,n){var i
const a=n[Hz.token],c=JSON.parse(decodeURIComponent(a)),l=s(c.remainingItems),u=!l&&(null===(i=c.recommendationsHref)||void 0===i?void 0:i.length)>0
if(c.isFirstRender=!1,l)c.remainingItems=this.buildHydratedShelfItems(e,c.remainingItems,t)
else if(u){c.data={...c.data,...mt(e,t)}
const n=we(c.data,sz)
c.remainingItems=s(n)?n:[],Uw(e,c.data,c)}const d=Ww(e,void 0,c)
return o(d)&&!c.hasExistingContent?this.makeHiddenShelf():(function(e,t,n){if(!o(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])}(0,d,c),!c.hasExistingContent&&o(d.items)&&(d.isHidden=!0),d)}buildHydratedShelfItems(e,t,n){var r,o,i,s
const a=new Map,c=yt(n)
for(const t of c)a[this.dataMapKey(e,t.type,t.id)]=t
const l=[]
for(const n of t){const t=a[this.dataMapKey(e,n.type,n.id)]
if((0,Am.isSome)(t)){const c=kn(0,n)
if((0,Am.isSome)(c)){const n=a[this.dataMapKey(e,YV,c.id)]
if((0,Am.isSome)(n)){const e=null!==(r=t.meta)&&void 0!==r?r:{},a=null!==(o=y(e.associations))&&void 0!==o?o:{},c=null!==(i=y(a[YV]))&&void 0!==i?i:{},l=null!==(s=y(n))&&void 0!==s?s:{}
c.data=[l],a[YV]=c,e.associations=a,t.meta=e}}l.push(t)}}return l}dataMapKey(e,t,n){return`${t}_${n}`}makeHiddenShelf(){const e=new pK(gB)
return e.isHidden=!0,e}}const Aee="EditorialShelfCollectionPageIntent",{routes:Tee,makeCanonicalUrl:bee}=mc(Jw,"/collections/{id}"),{routes:See,makeCanonicalUrl:Pee}=yc(Jw,"/{platform}/collections/{id}")
class Cee extends H4{constructor(){super("EditorialShelfCollectionPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){return function(e){const t=[RW,TW,XH,tq,gH,aj,dG,wq]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq),t}(e)}pageType(){return fz}pageRoute(e){return[{protocol:Iz,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`},{protocol:Iz,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`},{protocol:Iz,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`}]}generatePageRequest(e,t,n){if(o(n[Hz.shelfId]))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new cJ(e).forType("editorial-shelves-collection").attributingTo(t.build())}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([sz]).includingScopedRelationships(Wq,[uG]).includingAssociateKeys(bU,[YV]),Yw(e,t)}async renderPage(e,t,n,r,o,i){return await Za("renderEditorialShelfCollectionPage",async()=>function(e,t){const n=mt(e,t)
if(!s(n))return null
const r=Gn(e,Zq,n.id,t),o=jr(t),i=(_n(0,n),Bw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=[],c=(0,Am.unwrapOptional)(Ww(e,void 0,i))
c.title=null,c.eyebrow=null,c.isHorizontal=!1
const l=j(n,oH)
if((0,Am.isSome)(l)){const e=new pK(WM)
let t
e.id=SD,t=new O6(null,l,j(n,iH)),e.items=[t],a.push(e)}a.push(c)
const u=new gK(a)
return u.pageRefreshPolicy=Hr(e,o),Vn(e,u,r),u}(e,t))}}class Iee extends H4{constructor(){super("EditorialShelfRecommendationPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[RW,TW,XH,tq,gH,aj,dG,wq]
return e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),t}pageType(){return fz}pageRoute(e){return[{protocol:Iz,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]},{protocol:Iz,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]},{protocol:Iz,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]}]}generatePageRequest(e,t,n){const r=n[Hz.shelfId],o=n[Hz.editorialPageId]
if((0,mm.isNothing)(r)||0===r.length||(0,mm.isNothing)(o)||0===o.length)throw new Error(`Unable to map ${t.build()} to a media api url`)
const i=new cJ(e,t.toString())
return i.addingQuery(Hz.editorialPageId,o),i}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([sz]),Yw(e,t)}async renderPage(e,t,n,r,o,i){return await Za("renderEditorialShelfRecommendationPage",async()=>{const n=mt(e,t)
if(!s(n))return null
const r=Gn(e,Zq,n.id,t),o=jr(t),i=(_n(0,n),Bw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=Ww(e,void 0,i)
let c
a.title=null,a.eyebrow=null,a.isHorizontal=!1,c=new O6(null,j(n,oH),j(n,iH))
const l=new pK(WM)
l.id=SD,l.items=[c]
const u=new gK([l,a])
return u.pageRefreshPolicy=Hr(e,o),Vn(e,u,r),u})}}class kee{constructor(e){this.$kind="AppStoreEngagementTask",this.action=e}}class Oee extends Sz{constructor(e,t){super(),this.$kind="EngagementToggleAction",this.actionClass="EngagementToggleAction",this.identifier=e,this.value=t}}class Eee extends Sz{constructor(e,t){super(),this.$kind="TabBadgeAction",this.actionClass="TabBadgeAction",this.navigationTab=e,this.text=t}}const Dee="com.apple.Arcade.ArcadeHardware1",Ree="com.apple.Arcade.TrialEligible1",_ee=[Dee,Ree]
class Lee{constructor(){this.$intentKind="EngagementEventIntent"}async perform(e,t){return await Zw(t,e)}}class Mee{constructor(){this.$intentKind="BadgingEventIntent"}async perform(e,t){return await Qw(t,e)}}class Fee extends V4{constructor(e,t){super("UserEngagementController"),t.exportingService("AppStoreEngagement",{fetchEngagementTask:async t=>await Zw(e,t),fetchBadgingTask:async t=>await Qw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class $ee extends P7{constructor(){super("GroupingPageBuilder")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[RW,XH,tq,dG]
return e.bag.enableUpdatedAgeRatings&&t.push(bW),e.appleSilicon.isSupportEnabled&&t.push(bq),t}prepareRequest(e,t,n,r,o){if(function(e,t){t.includingAdditionalPlatforms(ee(e)),t.includingAgeRestrictions(),t.usingCustomAttributes(Ue(e)),t.includingMacOSCompatibleIOSAppsWhenSupported(),li(e)&&(t.enablingFeature(Uq),t.includingMetaKeys(PU,[kx,XM]),t.includingScopedAttributes(tz,eQ),t.includingScopedRelationships(tz,[VW])),Wi(e,BV)&&Ci(t),ui(e)&&(t.enablingFeature(eF),Pi(t)),di(e)&&(t.enablingFeature(CU),Ii(t)),t.enablingFeature("categoryHeaders"),t.enablingFeature(ED),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([bW]),e.bag.enableFeaturedCategoriesOnGroupings&&t.enablingFeature(Vb),e.bag.enableCategoryBricksOnGroupings&&t.enablingFeature("categoryBricks")}(e,t),n===sy.Page){const n=r.query.id
let o,i
const s=r.pathComponents();-1!==s.indexOf(QL)?o=n:-1!==s.indexOf(mq)?o=Vi(r):i=n,a(i)?t=t.withIdOfType(i,SH):a(o)&&(t=t.addingQuery(mq,o)),t.withSparseCount(Q(e)),t.includingScopedSparseLimit(PU,X(e))}const s=r.query[Hz.context]||ne(e)
i(s)&&t.addingQuery(Oj,s)
const c=r.query[Hz.useReleaseId]
r.host===Lz&&(null==c?void 0:c.length)>0&&(t.isStorePreviewRequest=!0,t=t.addingQuery(Ak,c))}pageType(){return fz}pageRoute(e){return[{protocol:Iz,path:`/${_z.store}/${_z.grouping}`,query:[Hz.id,`${Hz.context}?`]},{hostName:Lz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.grouping}`,query:[Hz.id,`${Hz.useReleaseId}?`]},{protocol:Iz,path:`/{countryCode}/${_z.genre}/{genreName}/{id}`},{protocol:Iz,path:`/{countryCode}/${_z.genre}/{id}`},{protocol:Iz,path:`/{countryCode}/{platform}/${_z.grouping}/{id}`},{protocol:Iz,path:`/${_z.store}/${_z.viewGenre}`,query:[Hz.id]},{hostName:Lz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.viewGenre}`,query:[Hz.id,`${Hz.useReleaseId}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Iz,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Iz,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:Iz,hostName:`${Bz}`}]}generatePageRequest(e,t,n){var r
let o,s,c=t.query.id
if(t.host===Bz&&(null===(r=e.bag.safariExtensionsGroupingURL)||void 0===r?void 0:r.length)>0){const n=oY.from(e.bag.safariExtensionsGroupingURL)
i(n)&&(c=Vi(n),t.query.id=c)}const l=t.pathComponents()
if(-1!==l.indexOf(QL)?o=c:-1!==l.indexOf(mq)?o=Vi(t):s=c,!a(s)&&!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
const u=function(e){const t=[RW,TW,XH,tq,gH,aj,dG]
e.appleSilicon.isSupportEnabled&&t.push(bq),e.bag.enableUpdatedAgeRatings&&t.push(bW),vf(e)&&t.push(Tq)
const n=new cJ(e).forType(SH).includingAgeRestrictions().includingAttributes(t).includingRelationshipsForUpsell(!0)
return Wi(e,BV)&&Ci(n),n}(e)
return u.attributingTo(t.build())}renderGroupingPage(e,t,n,o,i,s,a){return ym.context(zb,()=>function(e,t,n){var o
n.pageGenreId=q(t.originalGroupingData,mq)||(r(o=j(t.originalGroupingData,"chartUrl"))?null:h(oY.from(o).query,mq))
const i=function(e,t,n){let r=null
switch(n){case zZ.Apps:r=e.host.clientIdentifier===tJ?e.loc.string("GROUPING_APPS"):e.loc.string("GROUPING_APP_STORE","App Store")
break
case zZ.Discover:r=e.loc.string("GROUPING_DISCOVER")
break
default:r=nf(0,t)}return r}(e,t.originalGroupingData,n.pageGenreId)
if(n.pageTitle=i,Sl(e,t,n),"tv"!==e.client.deviceType&&e.client.deviceType!==bH){const t=Il(e,n.metricsPageInformation,n.metricsLocationTracker)
t&&n.shelves.push(t)}if(e.client.deviceType!==oz&&"tv"!==e.client.deviceType){const t=e.bag.termsAndConditionsURL
if(!r(t)){const r=kl(e,t)
n.shelves.push(r)}}const s=new gK(n.shelves)
switch(e.client.deviceType){case"tv":s.title=i
break
case oz:s.title=i,s.presentationOptions=[tF]
break
case bH:s.title=i,s.presentationOptions=[tF]
const e=s.shelves[0].contentType;[eV,Hb,IU].includes(e)&&s.presentationOptions.push(dB)
break
default:s.title=i,s.presentationOptions=[tF]}return n.shelves[0].contentType===Sx&&(s.presentationOptions.push(jM),s.presentationOptions.push(Lb),s.presentationOptions.push(dB)),s.pageRefreshPolicy=Hr(e,null==n?void 0:n.refreshController),Vn(e,s,n.metricsPageInformation),function(e,t,n){if(!(t.shelves.length<=0))switch(n){case zZ.Apps:t.shelves.splice(0,0,Ol(0,"appsPageHeader")),t.shelves.splice(6,0,Ol(0,"appsPageMid")),t.shelves.push(Ol(0,"appsPageFooter"))
break
case zZ.Games:t.shelves.splice(0,0,Ol(0,"gamesPageHeader")),t.shelves.splice(6,0,Ol(0,"gamesPageMid")),t.shelves.push(Ol(0,"gamesPageFooter"))}}(0,s,n.pageGenreId),Jp(s),s}(e,t,n))}}class xee extends V4{constructor(){super(UP)}pageRoute(e){return[{protocol:Cz,path:`${_z.onDeviceRecommendations}`,query:[Hz.onDeviceRecommendationsUseCase,Hz.token]}]}async handlePage(e,t,n,r,o){const i=n[Hz.onDeviceRecommendationsUseCase]
return await ms(e,i,pz).then(r=>{const o=JSON.parse(n[Hz.token]),i=new q4
i.title=o.title
const s=this.makePage(e,r.dataContainer,r.recoMetrics,i),a=new _J(fz,t.build())
return a.pageData=s,a})}makePage(e,t,n,r){const o=Os(e)
r.url=this.paginationUrl,r.metricsPageInformation=Gn(e,Zq,"onDevicePersonalizationSeeAll",t),r.metricsPageInformation.recoMetricsData=Mh(n,null,o),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const i=new pK(G4),s={id:null,kind:null,softwareType:null,targetType:rW,title:r.title,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:sH,recoMetricsData:n}
Jh(e,i,s),xh(0,s,r.title),i.isHorizontal=!1,i.shouldFilterApps=r.shouldFilter
const a=yt(t)
r.remainingContent=[],i.items=Yd(e,a,{contentUnavailable:(e,t)=>(r.remainingContent=Ct(0,a,e),!0),lockupOptions:{metricsOptions:{pageInformation:s.pageInformation,locationTracker:s.locationTracker},clientIdentifierOverride:r.clientIdentifierOverride,artworkUseCase:uf(0,i.contentType)}})
const c=new gK([i])
return c.title=r.title,r.remainingContent.length&&(c.nextPage=r),Vn(e,c,r.metricsPageInformation),c}async handleShelf(e,t,n,r){throw new Error(Mk)}shelfRoute(e){return[]}pageType(){return fz}}class Nee{constructor(){this.$intentKind="InAppPurchaseInstallPageIntent"}async perform(e,t){return await Xw(t,e.url)}}class Bee extends V4{constructor(e,t){super("InAppPurchaseInstallController"),t.exportingService(Fk,{fetchInstallPage:async t=>await Xw(e,t.url)})}async handlePage(e,t,n,r,o){const i=n[Hz.id],s=n[qz],a=new cJ(e).withIdOfType(s,jq),c=await Ln(e,a,{}),l=function(e,t,n){const r={pageId:n||"",pageType:"IAPInstallPage",parentId:kh(t)}
return new cZ(r)}(0,i,s),u=mt(e,c)
let d
const f={metricsOptions:{pageInformation:l,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:R3.LockupIconSmall}
s&&u&&(d=Bd(e,u,f),d.theme=MW)
const h=pe(e,u,VW)
let p
i&&h&&(p=Nd(e,h,f))
const w=new MJ
w.isComplete=!0,w.lockup=d,w.parentLockup=p
const v=gr(e,u)
return w.preInstallOfferDescription=Ko(e,v),function(e,t,n){Vn(e,t,n)}(e,w,l),V4.createFlowAction(w,qD,t)}pageRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.install}`,query:[`${Hz.id}`,`${qz}?`]}]}pageType(){return qD}}class Uee extends V4{constructor(e,t){super("MetricsLinterController"),t.exportingService("Metrics",{async lintEvent(t){const n=wr(e).makeEvent(e,t.fields)
return await Promise.resolve(n)}})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class Gee{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class jee{constructor(e,t){this.$kind="MSOAppsResponse",this.apps=e,this.appsToAlwaysShow=t}}class Vee{constructor(){this.$intentKind="MSOProviderDataIntent"}async perform(e,t){return await ev(t,e.providerAdamId)}}class Hee{constructor(){this.$intentKind="MSOPageIntent"}async perform(e,t){return await tv(t,e)}}class qee extends V4{constructor(e,t){super("MSOBuilder"),t.exportingService("MSOData",{fetchProviderData:async t=>await ev(e,t.providerAdamId),fetchPage:async t=>await tv(e,t)})}async handlePage(e,t,n,r,o){const i=function(e){const t=e[Zz]
return t?t.split(","):[]}(n),s=function(e,t){return nv(e,Vi(t))}(e,t.removeParam(Zz)),a=rv(e,await Ln(e,s),i)
return V4.createFlowAction(a,AB,t)}pageRoute(e){return[{protocol:Iz,path:`/{countryCode}/${_z.mso}/{appName}/{id}`,query:[`${Zz}?`]},{protocol:Iz,path:`/${_z.mso}/{providerName}/{id}`,query:[`${Zz}?`]},{protocol:Iz,path:`/{countryCode}/${_z.mso}/{id}`,query:[`${Zz}?`]},{protocol:Iz,path:`/${_z.mso}/{id}`,query:[`${Zz}?`]},{protocol:Iz,path:`/${_z.mso}`,query:[Hz.id,`${Zz}?`]},{protocol:Iz,path:`{countryCode}/${_z.mso}`,query:[Hz.id,`${Zz}?`]}]}async handleShelf(e,t,n,r){const o=n[JV],i=JSON.parse(o),s=new cJ(e,i.remainingContent).includingAdditionalPlatforms(ee(e)).includingAttributes([RW,TW,yq])
return function(e,t,n){const r=yt(t),o=n
o.remainingContent=[]
const i={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},artworkUseCase:uf(0,n.preferredShelfContentType)},contentUnavailable:function(e,t){return o.remainingContent=Ct(0,o.remainingContent,e),o.remainingContent.push(r[e]),!1}},s=new pK(n.preferredShelfContentType)
return s.shouldFilterApps=n.shouldFilter,s.items=Yd(e,r,i),s.mergeWhenFetched=!0,s.url=ov(o),s}(e,await Ln(e,s),i)}shelfRoute(e){return[{protocol:Cz,path:`/${_z.mso}/${_z.shelf}/{token}`}]}pageType(){return AB}}class Wee{constructor(){this.$intentKind="CancelPreorderIntent"}async perform(e,t){return await iv(t,e)}}class zee extends V4{constructor(e,t){super("CancelPreorderController"),t.exportingService("Preorder",{cancelPreorder:async t=>await iv(e,t)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class Yee extends H4{constructor(e){super("AccessibilityDetailsBuilder"),this.objectGraph=e}defaultPlatforms(e){return[]}pageType(){return this.objectGraph.featureFlags.isEnabled(jK)?fz:fU}pageRoute(e){return[{protocol:Cz,path:`${_z.accessibilityDetails}/${_z.product}/{id}`,query:[`${Hz.deviceFamily}`]},{protocol:Cz,path:`${_z.accessibilityDetails}/${_z.productBundle}/{id}`,query:[`${Hz.deviceFamily}`]}]}generatePageRequest(e,t,n){const r=Vi(t)
if((0,Am.isNothing)(r)||Oi(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
const o=function(e){switch(e[Hz.deviceFamily]){case OW:return OW
case IW:return IW
case iz:return iz
case Vj:return HU
case zH:return zH
case oz:return oz
default:return null}}(n)
if((0,Am.isNothing)(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing required platform.`)
let i=az;(0,Am.isSome)(t.pathname)&&-1!==t.pathname.indexOf(_z.productBundle)&&(i=JW)
const s=new cJ(e).withIdOfType(r,i).includingAttributes([fU,eq])
return s.platform=o,s}async renderPage(e,t,n,r){return await Za(CV,async()=>{const r=mt(e,t)
if((0,Am.isNothing)(r))return null
const o=n[Hz.deviceFamily]
if((0,Am.isNothing)(o))return null
const i=Gn(e,"AppAccessibilityDetails",r.id,t),s={rootPosition:0,locationStack:[]},a=[]
{const t=ql(e,r,o,!0,null,i,s)
a.push(t)
const n=zl(e,r,!0,i,s);(0,Am.isSome)(n)&&a.push(n)
const c=Wl(e,r,o,!0,null,i,s);(0,Am.isSome)(c)&&a.push(c)}const c=new gK(a)
return c.title=e.loc.string(p_),c.presentationOptions=[Qj,c$,IC],Vn(e,c,i),c})}}class Jee extends H4{constructor(){super("EulaBuilder")}defaultPlatforms(e){return ee(e)}generatePageRequest(e,t,n){const o=t.query.resourceId,i=t.query.resourceType
if(r(o)||r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
const s=new cJ(e).withIdOfType(o,xG)
return s.targetResourceType=i,s}pageRoute(e){return[{protocol:Cz,path:`${_z.eula}`}]}pageType(){return fz}async renderPage(e,t,n,r){return await Za(CV,async()=>{const n=f(t,"results.eula.text").split(/\n{1,2}/),r=[]
for(const e of n){const t=new V0(e)
t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,r.push(t)}const o=new pK(OV)
o.isHorizontal=!1,o.items=r
const i=new gK([o])
return i.title=e.loc.string(lN),i})}}class Kee extends V4{constructor(){super("PersonalizedReviewsBuilder")}async handlePage(e,t,n,r,o){throw new Error("PersonalizedReviewsBuilder:handlePage not implemented")}pageRoute(e){return[]}async handleShelf(e,t,n,r){const o=n[JV],i=JSON.parse(o),s=new cJ(e).withIdOfType(i.adamId,_W)
try{const t=await Ln(e,s)
return Fa(e,e.client.guid,i,t)}catch{return Fa(e,e.client.guid,i)}}shelfRoute(e){return[{protocol:Cz,path:`/${_z.personalizedReviews}/${_z.shelf}/{token}`}]}pageType(){return GW}}class Zee extends H4{constructor(e){super("PrivacyDetailBuilder"),this.objectGraph=e}defaultPlatforms(e){return ee(e)}pageType(){return this.objectGraph.featureFlags.isEnabled(jK)?fz:zR}pageRoute(e){return[{protocol:Cz,path:`${_z.privacyDetail}/${_z.product}/{id}`,query:[`${Hz.privacyTypeId}?`]},{protocol:Cz,path:`${_z.privacyDetail}/${_z.productBundle}/{id}`,query:[`${Hz.privacyTypeId}?`]}]}generatePageRequest(e,t,n){const r=Vi(t)
if((0,Am.isNothing)(r)||0===r.length)throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
let o=az
const i=[px,eq,YN]
return-1!==t.pathname.indexOf(_z.productBundle)&&(o=JW),new cJ(e).withIdOfType(r,o).addingQuery(N$,i.join(","))}async renderPage(e,t,n,s){return await Za(CV,async()=>{const s=n[Hz.privacyTypeId]
return function(e,t,n){return ym.context("privacyDetailPageFromResponse",()=>{const s=mt(e,t)
if(o(s))return null
const a=Gn(e,"PrivacyDetails",s.id,t),c={rootPosition:0,locationStack:[]}
let l=[]
if(!$l(e)){const t=function(e,t,n,r){const o=new pK(tW)
o.isHorizontal=!1
const i=xl(e,t,!0,!0,n,r)
return o.items=[i],o.presentationHints={isFirstShelf:!0},o}(e,s,a,c)
i(t)&&l.push(t)}const u=function(e,t,n,s,a){const c=B(t,px)
if(o(c))return[]
const l=El(e,c,t,iV,!0,n,s)
if(0===l.length)return[]
const u=[]
for(const t of l)if(r(a)||t.identifier===a||e.client.deviceType!==oz){const e=new pK(ZF)
i(t.identifier)&&t.identifier===a?(t.wantsScrollFocus=!0,e.id="privacyTypeShelf_"+t.identifier):t.wantsScrollFocus=!1,e.items=[t],e.presentationHints={isSingleDensity:!0},u.push(e)
for(const e of t.purposes){const t=new pK("privacyCategory")
t.title=e.title,t.items=e.categories,u.push(t)}}return u}(e,s,a,c,n)
l=l.concat(u)
const d=new gK(l)
d.title=e.loc.string(KF)
for(const e of u)if((0,Am.isSome)(e.id)){d.loadCompletedAction=new dK(e.id)
break}for(const e of l)e.presentationHints={...e.presentationHints,isSeeAllContext:!0}
return Vn(e,d,a),d})}(e,t,s)})}}class Qee extends V4{constructor(){super("ProductInAppPurchaseBuilder")}async handlePage(e,t,n,r,o){const i=n[Wz],s=Hi(e,new oY(i)),a={},c=n[zz]===cW
a.spotlightSection=qa(c),a.spotlightInAppProductIdentifier=n[Hz.offerName]
const l=await Ln(e,s),u=await fd(e,l,a)
return V4.createFlowAction(u,fq,t)}pageRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.lookup}`,query:[Wz,Hz.offerName,zz]}]}pageType(){return fq}}class Xee{constructor(){this.$intentKind="ShelfBasedProductPageIntent"}async perform(e,t){return await sv(t,e)}}class ete extends H4{constructor(e,t){super(TT),t.exportingService(Fk,{fetchPage:async t=>await async function(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error($k))
if(0!==Mn(e,new oY(t.url)).length&&vp(e,t.url),t.preloading){const e=new oY(t.url)
e.param(Hz.isPreloading,cW),t.url=e.build()}const n=ete.generateProductPageOptions(e,void 0,new oY(t.url)),r=e.required(R9).fetchPage(e,t.url,aK)
if(!r){const r=new cJ(e,t.url),o=await Ln(e,r)
return await fd(e,o,n,{},null,t.preloading)}return await r.then(n=>(e.host.clientIdentifier===sJ?n&&uU in n&&Yn(0,n):i(t.referrerData)&&n&&uU in n&&Yn(0,n),n))}(e,t),fetchShelfBasedPage:async t=>await sv(e,t)})}defaultPlatforms(e){return ee(e)}pageType(){return fq}defaultTab(e){return ete.representsArcadeApp(e)?nz:super.defaultTab(e)}defaultAction(e,t,n,r){if(ft(t))return t
const o=super.defaultAction(e,t,n,r)
if(!vt(t)&&!gt(t))return o
const i=1===t.appPlatforms.length&&"tv"===t.appPlatforms[0]
if(n[Hz.action]!==I9||i){if(n[Hz.action]!==k9||i)return o
{const e=t.shelfMapping[_W]||t.shelfMapping[zq]
let n=null
return e&&e.seeAllAction&&(n=e.seeAllAction,n.animationBehavior=hq),o.animationBehavior=hq,new rZ([o,n])}}{const n=ete.representsBundle(t)
let r=null,i=null,s=null,a=null
vt(t)?(r=t.adamId,i=t.icon,s=t.title,a=t.subtitle):gt(t)&&(r=t.lockup.adamId,i=t.lockup.icon,s=t.lockup.title,a=t.lockup.subtitle)
const c=_a(e,r,n,i,!1,a,s)
return o.animationBehavior=hq,new rZ([o,c])}}static generateProductPageOptions(e,t,n){const r={clientIdentifierOverride:n.query[Hz.clientIdentifierOverride]},o=null==t?void 0:t[Hz.offerName]
if(o){const e=t[zz]===cW
r.spotlightSection=qa(e),r.spotlightInAppProductIdentifier=o}const s=n.query[iZ]
s&&(r.iAdClickFields=JSON.parse(s))
const a=n.query[sZ]
a&&(r.iAdLineItem=a)
const c=n.query[aZ];(0,mm.isSome)(c)&&(r.iAdDismissAdActionMetrics=JSON.parse(c))
const l=n.query[i2]
i(l)&&(r.externalDeepLinkUrl=l)
const u=n.query[s2]
i(u)&&(r.isCppDeepLinkDisabled=JSON.parse(u))
const d=null==t?void 0:t[Hz.webBrowser];(0,mm.isSome)(d)&&(r.webBrowser="1"===d)
const f=null==t?void 0:t[Hz.webBrowserFlowType]
return(0,mm.isSome)(f)&&(r.webBrowserFlowType=f),e.client.isCompanionVisionApp&&(r.clientIdentifierOverride=RY),r}pageRoute(e){return fp()}generatePageRequest(e,t,n){var o
const i=n[Hz.bundleIdentifier],s=n[Hz.ids],a=n[Hz.productVariantID],c="1"===n[Hz.includeUnlistedApps]||"1"===n[Hz.isViewOnly]
let l=null
if(i){const t=it(e).adamIdFromSystemBundleId(i)
l=(0,mm.isSome)(t)?qi(e,t,!1,void 0,!1,c):function(e,t,n,r){const o=r1
e.bag.enablePrivacyNutritionLabels&&!Ui(e,t)&&o.push(ux),Ri(e)&&!Li(e,t)&&o.push(dx),e.appleSilicon.isSupportEnabled&&o.push(bq),e.bag.enableUpdatedAgeRatings&&o.push(bW),vf(e)&&o.push(Tq),e.bag.enableLicenses&&o.push(NE),e.bag.medicalDeviceComplianceStatementRegion&&o.push(fx)
const i=new cJ(e).forType(az).withFilter(hW,t).includingAdditionalPlatforms(ee(e)).includingRelationships([Eq,mj,bN,_W,JW,lx,cx]).includingAttributes(o).addingRelationshipLimit(_W,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Am.isSome)(n)&&i.addingQuery(Hz.productVariantID,n),Kt(e,Vq)&&i.enablingFeature(CM),r&&i.enablingFeature(SM),ui(e)?i.includingViews([RE]):i.includingRelationships([IM]),i}(e,i,a,c)}else if(n[Hz.action]===xk&&s){const r=(null===(o=t.pathname)||void 0===o?void 0:o.length)>0&&-1!==t.pathname.indexOf(Nk)
l=qi(e,s,g(n,Hz.isPurchasesApp),a,r,c)}else l=Hi(e,t,c)
if(r(l))throw new Error(`Unable to map ${t.build()} to a media api url`)
return l}generateAdditionalPageRequirements(e,t,n){const r=super.generateAdditionalPageRequirements(e,t,n),o=function(e){for(const[t,n]of Object.entries(e))if(t.toLocaleLowerCase()===Hz.appEventId.toLocaleLowerCase())return n
return null}(n),i=n[Hz.offerItemId]
if((null==o?void 0:o.length)>0&&li(e)){const t=new cJ(e).withIdOfType(o,tz).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(tz,eQ).includingScopedAvailableIn(tz,[rE,jE])
r[O9]=R(Ln(e,t))}else if(s(i)&&di(e)){const t=new cJ(e).withIdOfType(i,$H).includingAdditionalPlatforms(ee(e))
Ii(t),r[O9]=R(Ln(e,t))}return r}async renderPage(e,t,n,r,o,i){return await Za(CV,async()=>{const o=Gn(e,_H,"",t),a=ete.generateProductPageOptions(e,n,new oY(o.pageUrl)),c=mt(e,t),l=ete.alternativeAppForPlatform(e,c,nt(e))
if((0,mm.isSome)(l))return l
const u="1"===n[Hz.isViewOnly]
s(i)&&vz.shared.setReferralDataForProduct(c.id,i)
const d=await fd(e,t,a,r,i,g(n[Hz.isPreloading]),u),f=e.fetchTimingMetricsBuilder
return(0,mm.isSome)(f)&&f.decorate(d),d})}shelfRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.shelf}/{token}`}]}generateShelfRequest(e,t,n){return hp(e,0,n)}async renderShelf(e,t,n){return await pp(e,t,n)}shelfRequiresAdditionalModification(e,t){return!0}async performAdditionalShelfModifications(e,t,n){const r=n[JV],o=E9.fromJSON(e,r)
return new Set([mH,vG,eN]).has(t.contentType)&&0===t.items.length&&!o.isFirstRender&&(t.isHidden=!0),t}async handleShelfError(e,t){const n=t[JV],r=E9.fromJSON(null,n)
if(r&&!r.hasExistingContent){const e=new pK(r.contentType)
return e.isHidden=!0,e}return await super.handleShelfError(e,t)}static alternativeAppForPlatform(e,t,n){if(!ie(t,n)){const r=we(t,cx)
if(s(r))for(const t of r){const r=Qe(e,t,BW)
if(ie(t,n)&&(null==r?void 0:r.length)>0)return new _J(GW,r)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&GV in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[GV]===RF}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&GV in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[RB]===dW}}class tte{constructor(e,t,n,r,o,i){this.$kind="GameCenterPlayerGameAchievementSummary",this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.completedText=r,this.action=o,this.achievements=i}}class nte extends V4{async handlePage(e,t,n,r,o){throw new Error(`handlePage is not supported on: ${this.builderClass}`)}async renderPage(e,t,n){throw new Error(`renderPage is not supported on: ${this.builderClass}`)}async handleShelf(e,t,n,r){const o=await M(this.renderShelf(e,t,n))
return o.success?o.value:await this.handleShelfError(o.error,n)}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async handleShelfError(e,t){throw e}}class rte extends nte{constructor(){super("ProductBuilderNative")}pageType(){return fq}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterPlayerShelf,Hz.token]},{protocol:Cz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterPlayerRibbonItem]},{protocol:Cz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterAchievementsShelf,Hz.token]}]}async renderShelf(e,t,n){if(t.query[Hz.isGameCenterPlayerShelf]){const r=t.query[Hz.id],o=await e.gameCenter.fetchFriendsThatPlayGame(r),i=n[Hz.token]
return xu(e,o,!0,E9.fromJSON(e,i))}if(t.query[Hz.isGameCenterPlayerRibbonItem]){const n=t.query[Hz.id],r=await e.gameCenter.fetchFriendsThatPlayGame(n)
return xu(e,r,!1)}if(t.query[Hz.isGameCenterAchievementsShelf]){const r=t.query[Hz.bundleId],o=await e.gameCenter.fetchAchievementSummaryForGame(r),i=n[Hz.token],s=E9.fromJSON(e,i)
let a=null
if(o.length>0){const t=co({objectGraph:e,target:{achievements:{bundleID:r}},metricsPageInformation:s.sourcePageInformation,metricsLocationTracker:s.sourceLocationTracker}),n=e.loc.string("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed"),i=o[0].achievements
let c=null
const l=i.filter(e=>e.status.type===yH)
if(l.length>0&&(c=l[0]),(0,mm.isNothing)(c)){const e=i.filter(e=>e.status.type===rS||e.status.type===cF)
e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(c=e[0])}(0,mm.isSome)(c)&&(a=new tte(o[0].bundleId,o[0].completedAchievements,o[0].totalAchievements,n,t,[c]))}const c=function(e,t,n){const r=new pK(_C)
if(r.isHorizontal=!0,t){const o={pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:NW,title:aV,id:"achievements_summary",idType:yW,softwareType:null,targetType:NW,badges:{gameCenter:!0}}
Jh(e,r,o),ra(e,t.action,o),r.items=[t]}return r.mergeWhenFetched=!0,r.batchGroup=kH,r.isHidden=0===r.items.length,r}(e,a,s)
return c}return await super.renderShelf(e,t,n)}}const ote="todayTabPersonalization",ite="OnDeviceRecommendationsTodayShelfController"
class ste{constructor(e){this.recommendations=e}storyData(e){var t
const n=this.recommendationForUseCase(e),r=null==n?void 0:n.candidate(YW)
if(!(0,mm.isNothing)(n)&&!(0,mm.isNothing)(r))return null===(t=null==n?void 0:n.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===r.id)}storyGroupData(e){var t,n
const r=this.recommendationForUseCase(e),o=null==r?void 0:r.candidate(SV)
if((0,mm.isNothing)(r)||(0,mm.isNothing)(o))return
const i=null===(t=null==r?void 0:r.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===(null==o?void 0:o.id)),s=null===(n=null==r?void 0:r.dataContainer)||void 0===n?void 0:n.data.filter(e=>o.candidateIDs.includes(e.id))
return(0,mm.isNothing)(i)||(0,mm.isNothing)(s)?void 0:(i[cH]={associations:{recommendations:{data:s}}},i)}recommendationForUseCase(e){return this.recommendations.find(t=>t.useCase===e)}}class ate{constructor(e,t,n,r){this.useCase=e,this.candidates=t,this.recoMetrics=n,this.dataContainer=r}candidate(e){return this.candidates.find(t=>t.type===e)}}class cte{constructor(e,t,n,r){this.id=e,this.type=t,this.candidateIDs=n,this.data=r}}class lte extends nte{constructor(){super("ProductPageShelfWithAdController")}pageType(){return fq}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.shelf}/{token}`,query:[Hz.isShelfWithAd,Hz.shelfWithAdPlacementType]}]}async renderShelf(e,t,n){const r=n[Hz.shelfWithAdPlacementType],o=t.query[Hz.id],i=av(e,r,o).catch(()=>null),s=hp(e,0,n)
s.attributingTo(t.build())
const a=Ln(e,s)
return await Promise.all([a,i]).then(async([t,r])=>await pp(e,t,n,r,!0))}}class ute extends nte{constructor(){super("ProductPageSimilarItemsShelfRefreshController")}pageType(){return fq}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Cz,path:`/${_z.product}/${_z.shelf}/{token}`,query:[`${Hz.shelfRefreshType}=${eY}`]}]}async renderShelf(e,t,n){const r=t.query[Hz.id]
let o=Promise.resolve(null),i=!1
i=Kt(e,cq),i&&(o=av(e,cq,r).catch(()=>null))
const s=function(e,t){const n=[RW,TW,yq]
return e.bag.enableUpdatedAgeRatings&&n.push(bW),vf(e)&&n.push(Tq),new cJ(e).withIdOfType(t,S$).enablingFeature(cH).includingAdditionalPlatforms(ee(e)).includingAttributes(n).enablingFeature(CM)}(e,r)
s.attributingTo(t.build())
const a=Ln(e,s).catch(async()=>{const r=hp(e,0,n)
return r.attributingTo(t.build()),await Ln(e,r)})
return await Promise.all([a,o]).then(async([t,r])=>await pp(e,t,n,r,i))}}class dte extends V4{constructor(){super("ReviewsAdapterBuilder")}async handlePage(e,t,n,r,o){const i=Hi(e,t),s=await Ln(e,i),a=await fd(e,s)
let c,l
if(dd(e)){const e=a
c=e.shelfMapping[zq],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}else{const e=a
c=e.shelfMapping[_W],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}const u=V4.createFlowAction(a,fq,t)
let d=null
return c&&c.seeAllAction&&!l&&(d=c.seeAllAction,d.animationBehavior=hq),d?(u.animationBehavior=hq,new rZ([u,d])):u}pageRoute(e){return[{protocol:Iz,path:`/{countryCode}/${_z.product}/{appName}/{id}`,hash:Xz},{protocol:Iz,path:`/${_z.store}/${_z.viewReviews}`,query:[Hz.id]}]}async handlePagination(e,t,n,r,o){const i=n[Jz],s=n[Kz],a=l(o.remainingContent),c=new cJ(e,o.nextHref).includingAdditionalPlatforms(ee(e)).addingQuery(jH,s),u=await Ln(e,c,{})
return Ua(e,e.client.guid,i,a,u,!1,s)}paginationRoute(e){return[{protocol:Cz,path:`/${_z.reviews}/${_z.shelf}/{adamId}/{sort}`}]}pageType(){return fq}}class fte extends V4{constructor(){super("SortedReviewsBuilder")}async handlePage(e,t,n,r,o){const a=n[Jz],c=n[Kz],l=new cJ(e).withIdOfType(a,P$).includingAdditionalPlatforms(ee(e)).addingQuery(jH,c),u=await Ln(e,l,{}),d=n[Hz.token]
let f=null
if(s(d))try{f=JSON.parse(d)}catch(e){}const h=Ua(e,e.client.guid,a,[],u,!0,c,f)
return i(null==f?void 0:f.reviewActionsShelf)&&h.shelves.unshift(f.reviewActionsShelf),i(null==f?void 0:f.reviewSummaryShelf)&&h.shelves.unshift(f.reviewSummaryShelf),i(null==f?void 0:f.ratingsShelf)&&h.shelves.unshift(f.ratingsShelf),V4.createFlowAction(h,_W,t)}pageRoute(e){return[{protocol:Cz,path:`/${_z.reviews}/{adamId}/{sort}`,query:[`${Hz.token}?`]}]}pageType(){return _W}}class hte extends z4{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t,n){return Hn(0,"accessory")}generatePageRequest(e,t,n){const r=[]
for(const e of Object.keys(t.query))e.startsWith("id")&&r.push(t.query[e])
return this.requestWithFilter(e,"deviceProtocol",r.join(","))}pageRoute(e){return[{query:[`${Hz.action}=accessoryLookup`]}]}}class pte extends V4{constructor(){super("CollectionDeepLinkingController")}pageType(){return fz}pageRoute(e){return[{protocol:Iz,path:"{countryCode}/{tab}/recommendations",query:[`${Hz.useCaseShort}`,`${Hz.collectionId}?`,`${Hz.seedId}?`]}]}async handlePage(e,t,n,r,o){const i=n[_z.tab],s=n[Hz.useCaseShort],a=n[Hz.collectionId],c=n[Hz.seedId]
let l=new cJ(e).forType(hM).addingQuery(cz,i).addingQuery("filter[recoUseCase]",s).includingRelationships([sz]).includingAdditionalPlatforms(ee(e))
l.enablingFeature(ED),(null==a?void 0:a.length)>0&&(l=l.addingQuery(LH,a)),(null==c?void 0:c.length)>0&&(l=l.addingQuery(iT,c))
const u=await M(Ln(e,l))
if(!u.success)throw new Error(`CollectionDeeplinkingController: Failed to fetch Media API data for useCase: ${s}`)
const d=u.value,f=j(mt(e,d),Lx),h=await((null==f?void 0:f.length)>0?this.makeODPPage(e,s,f,d):this.makeCollectionPage(e,s,d))
let p
const w=this.createTabChangeActionForRequest(i),v=new _J(fz,t.build())
return v.pageData=h,null!=w?(w.actions=[v],p=w):p=v,p}async makeODPPage(e,t,n,r){const o=new Promise((o,i)=>{ms(e,n,fz).then(n=>{const i=mt(e,r),s=new q4
s.title=j(i,FW),s.metricsPageInformation=Gn(e,Zq,t,r),s.metricsPageInformation.recoMetricsData=Mh(bt(r),null,n.recoMetrics),s.shouldFilter=!1,s.metricsLocationTracker={rootPosition:0,locationStack:[]}
const a=this.makePage(e,s,n.dataContainer)
o(a)}).catch(e=>{i(e)})})
return await o}async makeCollectionPage(e,t,n){const r=mt(e,n),o=fe(r,sz),i=new q4
return i.url=this.paginationUrl,i.title=j(r,FW),i.metricsPageInformation=Gn(e,Zq,t,n),i.metricsPageInformation.recoMetricsData=bt(n),i.shouldFilter=!1,i.metricsLocationTracker={rootPosition:0,locationStack:[]},await Promise.resolve(this.makePage(e,i,o))}makePage(e,t,n){return ym.context("makePage",()=>{const r=t.preferredShelfContentType||G4,o=new pK(r),i={id:null,kind:null,softwareType:null,targetType:rW,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sH,recoMetricsData:bt(n)}
Jh(e,o,i),xh(0,i,t.title),o.isHorizontal=!1,o.shouldFilterApps=t.shouldFilter
const s=yt(n)
t.remainingContent=[],o.items=Yd(e,s,{contentUnavailable:(e,n)=>(t.remainingContent=Ct(0,s,e),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:uf(0,r)}})
const a=new gK([o])
return a.title=t.title,t.remainingContent.length&&(a.nextPage=t),a})}createTabChangeActionForRequest(e){const t=e
return new Set([UW,az,qq,gW,JL,nz,gj,oV,wN,GB,vN,KB,pq,$G]).has(t)?new R0(t):null}async handleShelf(e,t,n,r){throw new Error(Mk)}shelfRoute(e){return[]}paginationRoute(e){return[{protocol:Cz,path:`${this.paginationPath}`}]}async handlePagination(e,t,n,r,o){return await Za(`${this.builderClass}.handlePagination`,async()=>{const n=o,r=new cJ(e,n.remainingContent)
if(!r)throw new Error(`Could not construct media API request for: ${t}`)
r.includingAdditionalPlatforms(ee(e))
const i=[RW,TW,XH,tq]
e.appleSilicon.isSupportEnabled&&i.push(bq),e.bag.enableUpdatedAgeRatings&&i.push(bW),vf(e)&&i.push(Tq),r.includingAttributes(i),r.usingCustomAttributes(Ue(e)),r.attributingTo(t.build())
const s=await Ln(e,r)
return this.makePage(e,n,s)})}}class wte extends W4{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t,n){const r=Vi(t),o=n[Hz.grouping]
if(!this.isValidId(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
if(!this.isValidId(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing grouping.`)
return new cJ(e).withIdOfType(r,ax).addingQuery(BV,o).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}async renderPage(e,t,n){return await Za(CV,async()=>{const r=mt(e,t),o=fe(r,sz),i=n[Hz.grouping],s=Gn(e,Zq,`${r.id}-${i}`,t),a=new q4
a.remainingContent=o.data,a.url=this.paginationUrl,a.shouldFilter=!H(r,_x),a.metricsPageInformation=s,a.metricsLocationTracker={rootPosition:0,locationStack:[]},a.title=j(r,cz)
const c=await this.pageWithContent(e,o,a)
return c.title=a.title,Vn(e,c,s),c})}pageRoute(e){return[{protocol:Iz,path:`/{countryCode}/${_z.appsForYou}/{title}/{id}`,query:[Hz.grouping]},{protocol:Iz,path:`/{countryCode}/${_z.appsForYou}/{id}`,query:[Hz.grouping]},{protocol:Iz,path:`/${_z.appsForYou}/{title}/{id}`,query:[Hz.grouping]},{protocol:Iz,path:`/${_z.appsForYou}/{id}`,query:[Hz.grouping]}]}isValidId(e){return!(r(e)||isNaN(e))}}class vte extends W4{constructor(){super("RoomBuilder")}generatePageRequest(e,t,n){let r=t.query[Hz.featuredContentId]
if(this.isValidRoomId(r)||(r=n.id),!this.isValidRoomId(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return new cJ(e).withIdOfType(t,xB).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,r)}prepareRequest(e,t,n,r,o){!function(e,t){t.includingAdditionalPlatforms(ee(e)).includingAttributes(dc(e)).usingCustomAttributes(Ue(e)).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,t)}async renderPage(e,t,n,r){return await Za(CV,async()=>{const n=mt(e,t),r=fe(n,sz),o=Gn(e,Zq,n.id,t),i=new q4
i.id=n.id,i.remainingContent=r.data,i.url=this.paginationUrl,i.shouldFilter=!H(n,_x),i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=j(n,xV)
var a
i.preferredShelfContentType=null==(a=Number(s))?null:a===I1?uF:null,i.clientIdentifierOverride=Gr(e,n),i.title=j(n,FW)
const c=await this.pageWithContent(e,r,i)
return c.title=i.title,Vn(e,c,o),c})}pageRoute(e){return[{protocol:Iz,path:`/${_z.store}/${_z.room}`,query:[Hz.featuredContentId]},{protocol:Iz,path:`/${_z.storeElements}/${_z.recommendationsSeeAll}`},{protocol:Iz,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:Iz,path:"/{countryCode}/collection/today-view-widgets",query:[Hz.featuredContentId]},{protocol:Iz,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return a(e)}}!function(e){e[e.Default=0]="Default",e[e.CategoriesAndCharts=1]="CategoriesAndCharts"}(yy||(yy={}))
class gte{constructor(e,t,n,r,o,i,s=null,a){this.id=e,this.title=t,this.searchLandingItemDisplayStyle=s,this.displayStyle=n,this.displayCount=r,this.hasSeeAll=o,this.seeAllLink=i,this.searchShelfKind=a}}!function(e){e[e.Landing=0]="Landing",e[e.Results=1]="Results",e[e.ChartsAndCategories=2]="ChartsAndCategories",e[e.Focus=3]="Focus"}(Ay||(Ay={})),function(e){e.Suggestion="Query",e.CategoriesAndCharts="EditorialLink",e.Apps="AppsLockup",e.EditorialCollection="EditorialCollection"}(Ty||(Ty={}))
class mte{constructor(){this.$kind="PageTab"}}class yte extends Sz{constructor(e,t,n){super(),this.$kind="PageTabChangeAction",this.actionClass="PageTabChangeAction",this.selectedTabId=e,this.title=t}}class Ate extends lK{constructor(){super(...arguments),this.$kind="SearchChartsAndCategoriesPage"}}class Tte{constructor(){this.$kind="PageTabs",this.id=random.nextUUID()}}class bte{constructor(e,t,n,r,o,i,s,a,c,l){this.$kind="SearchChartOrCategory",this.title=e,this.artwork=t,this.collectionIcons=n,this.backgroundColor=r,this.badge=o,this.action=i,this.density=s,this.artworkSafeArea=a,this.textSafeArea=c,this.automationMetadata=l}}class Ste{constructor(){this.$intentKind="SearchChartsAndCategoriesPageIntent"}async perform(e,t){return await mv(e,t)}}class Pte extends V4{constructor(e,t){super("SearchChartsAndCategoriesPageBuilder"),t.exportingService(yN,{fetchSearchChartsAndCategoriesPage:async t=>await mv(t,e)})}pageType(){return q_}pageRoute(e){return[{path:"/{apiVersion}/recommendations/{countryCode}/search-recommendations/{search-recommendations-id}"}]}async handlePage(e,t,n,r,o){return await Za(`${this.builderClass}.handlePage`,async()=>{const n=new cJ(e,t.toString()).forType(C$).includingAgeRestrictions().includingScopedRelationships(Bk,[sz]).enablingFeature(cH).enablingFeature(AN).addingQuery(Hz.name,GN)
Wi(e,w$)&&Ci(n)
const r=await this.fetchCategoriesAndChartsPage(e,n)
return V4.createFlowAction(r,this.pageType(),t)})}async fetchCategoriesAndChartsPage(e,t){const n=Ln(e,t)
return await n.then(t=>pv(e,t))}}class Cte extends Sz{constructor(e,t){super(),this.$kind="GuidedSearchTokenToggleAction",this.actionClass="GuidedSearchTokenToggleAction",this.targetToken=e,this.searchOrigin=t}}class Ite{constructor(e,t,n,r,o){this.$kind="GuidedSearchToken",this.value=e,this.isSelected=t,this.leadingIcon=n,this.displayName=r,this.clickAction=o}}class kte{constructor(e,t,n){this.$kind="GuidedSearchQuery",this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class Ote extends Sz{constructor(e,t){super(),this.$kind="SearchEntityChangeAction",this.actionClass="SearchEntityChangeAction",this.entity=e,this.searchOrigin=t}}class Ete{constructor(e){this.$kind="SearchResultsContextCard",this.message=e}}class Dte{constructor(e,t){this.$kind="SearchFacetSet",this.type=e,this.values=t}}class Rte{constructor(e,t,n=null){this.$kind="SearchFacetValue",this.name=e,this.value=t,this.isSelected=t===n}}const _te={AdvertsSearchResult:"AdvertsSearchResult",AppEventSearchResult:Ly,AppSearchResult:My,BundleSearchResult:"BundleSearchResult",EditorialSearchResult:jy,GuidedSearchResult:"GuidedSearchResult",InAppPurchaseSearchResult:"InAppPurchaseSearchResult",SearchLockupCollection:"SearchLockupCollection"}
class Lte{constructor(e){this.impressionMetrics=null,this.resultType=e,this.clickAction=void 0}}class Mte extends Lte{constructor(e,t){super(D$),this.$kind="GuidedSearchResult",this.title=e,this.tokens=t}}class Fte extends Lte{constructor(e,t,n,r,o){super("lockupCollection"),this.$kind="SearchLockupCollection",this.heading=e,this.headingArtwork=o,this.title=t,this.items=n,this.detailAction=r}}const $te=0,xte=1
class Nte extends Lte{constructor(e){super(BG),this.$kind="InAppPurchaseSearchResult",this.lockup=e}}class Bte extends Lte{constructor(e){super(bO),this.$kind="BundleSearchResult",this.lockup=e}}class Ute extends Lte{constructor(e){super("content"),this.$kind="AppSearchResult",this.lockup=e}}class Gte extends Lte{constructor(e){super(PO),this.$kind="EditorialSearchResult",this.title=e}}class jte extends Lte{constructor(){super(qB),this.$kind="AppEventSearchResult"}}class Vte extends Lte{constructor(){super("advert"),this.$kind="AdvertsSearchResult",this.lockups=[],this.displaysScreenshots=!0,this.itemBackground="ad"}}const Hte="E1Aan4l00",qte="E1Aan4l01",Wte="E1Aan4l02",zte=[new class{canDisplay(e){return(0,mm.isSome)(e.alignedRegionArtwork)||(0,mm.isSome)(e.alignedRegionVideo)}get representativeDisplayStyle(){return FZ}displayStyle(e,t,n){return(0,mm.isSome)(t.alignedRegionArtwork)?FZ:MZ}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isLandscape())&&void 0!==r&&r}get representativeDisplayStyle(){return _Z}displayStyle(e,t,n){return _Z}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isPortrait())&&void 0!==r&&r}get representativeDisplayStyle(){return OZ}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Zv(e,n)
return 4===o&&r>=4?OZ:3===o&&r>=3?EZ:r>=2?DZ:RZ}},new class{canDisplay(e){return e.landscapeScreenshots.length>0}get representativeDisplayStyle(){return LZ}displayStyle(e,t,n){return LZ}},new class{canDisplay(e){return e.portraitScreenshots.length>0}get representativeDisplayStyle(){return PZ}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Zv(e,n)
return 4===o&&r>=4?PZ:3===o&&r>=3?CZ:r>=2?IZ:kZ}},new class{canDisplay(e){return!0}get representativeDisplayStyle(){return $Z}displayStyle(e,t,n){return $Z}}],Yte={NO_ORGANIC_RESULTS:"NOORGANIC",NORMAL:"NORMAL",DUPE_AD:"DUP"},Jte=(e,t)=>{const n=e.isLandscape()
return n===t.isLandscape()?0:n?-1:1}
class Kte{constructor(e,t,n=null){this.$kind="SearchResultsMessage",this.primaryText=e,this.secondaryText=t,this.messageClickAction=n}}class Zte{constructor(e,t){this.$kind="SearchHintSet",this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}!function(e){e.visionOS="xros",e.iOS="ios"}(by||(by={}))
class Qte extends rQ{constructor(e=[]){super(),this.$kind="SearchResultsPage",this.shelves=[],this.shelves=e}}const Xte={3:3,default:5}
class ene{constructor(e,t,n=Xte){this.$kind="TransparencyLink",this.linkableText=e,this.targetShelfId=t,this.positionHint=n}}class tne{constructor(e){this.$kind="SearchResultsLearnMoreNotice",this.linkableText=e}}!function(e){e[e.EmptyResults=0]="EmptyResults",e[e.Picker=1]="Picker",e[e.NonNative=2]="NonNative"}(Sy||(Sy={}))
class nne{constructor(){this.$intentKind="SearchHintsIntent"}async perform(e,t){return await fg(t,e.term)}}class rne extends V4{constructor(e,t){super("SearchHintsBuilder"),t.exportingService(yN,{fetchHints:async t=>await fg(e,t.term)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class one extends gK{constructor(e){super(e,"SearchLandingPage")}}class ine extends gK{constructor(e){super(e,"SearchFocusPage")}}!function(e){e.Chiclet="chiclet",e.App="app",e.Symbol="symbol"}(Py||(Py={}))
const sne="word_cloud",ane="horizontal"
class cne extends Sz{constructor(){super(...arguments),this.$kind="ClearSearchHistoryAction",this.actionClass="ClearSearchHistoryAction"}}class lne{constructor(e,t,n,r){this.title=e,this.maxItems=t,this.shelfDisplayStyle=n,this.itemDisplayStyle=r}}class une extends V4{constructor(){super("SearchLandingPageBuilder")}pageRoute(e){return[{protocol:Cz,path:`${_z.searchLandingPage}`}]}shelfRoute(e){return[{protocol:Cz,path:`${_z.searchLandingPage}/${_z.shelf}`,query:[Hz.isOnDeviceSearchHistoryShelf]},{protocol:Cz,path:`${_z.searchLandingPage}/${_z.shelf}`,query:[Hz.isSearchFocusHeaderShelf]}]}pageType(){return fz}async handlePage(e,t,n,r,o){return await Za(`${this.builderClass}.handlePage`,async()=>{const n=await this.fetchPage(e)
return V4.createFlowAction(n,this.pageType(),t)})}async handleShelf(e,t,n,r){return await Za(`${this.builderClass}.handleShelf`,async()=>{var o,s,a
const c=g(null!==(o=n[Hz.isOnDeviceSearchHistoryShelf])&&void 0!==o?o:t.query[Hz.isOnDeviceSearchHistoryShelf]),l=c?function(e){if(!(0,Am.isNothing)(e))return JSON.parse(decodeURIComponent(e))}(null!==(s=n[Hz.token])&&void 0!==s?s:t.query[Hz.token]):void 0,u=g(null!==(a=n[Hz.isSearchFocusHeaderShelf])&&void 0!==a?a:t.query[Hz.isSearchFocusHeaderShelf])
return c&&i(l)?await this.handleSearchHistoryShelfAsync(e,l):u?Ig(e):await super.handleShelf(e,t,n,r)})}handleSearchHistoryShelf(e,t,n,r){e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems).then(n=>{const r=jn(e,kF,OF," ")
return xh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:nL,pageInformation:r},t.title),hg(e,t,r,{rootPosition:0,locationStack:[]},n)}).then(n,r)}async handleSearchHistoryShelfAsync(e,t){const n=await e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems),r=jn(e,kF,OF," ")
return xh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:nL,pageInformation:r},t.title),hg(e,t,r,{rootPosition:0,locationStack:[]},n)}async fetchPage(e){return await async function(e){const t=Kt(e,dH)?av(e,dH).catch(()=>null):null
return await async function(e,t){return function(e){return!e.bag.supportsSearchLandingPageV2||!lr(e,e.bag.searchLandingPageV2RolloutRate)}(e)?await async function(e,t){const n=new cJ(e).forType(_B).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
n.targetResourceType=SH
const r=vc(e,e.user.dsid);(null==r?void 0:r.length)>0&&n.addingQuery(M_,r)
const s=new iy.FetchTimingMetricsBuilder,a=e.addingFetchTimingMetricsBuilder(s),c=Ln(a,n)
return await Promise.all([c,t]).then(([e,t])=>s.measureModelConstruction(()=>function(e,t,n){var r
const s=l(t,mI)[0]
if(o(s))return null
if(!de(s,Hj))return null
const a=j(s,"id"),c=Gn(e,DD,s.id,t),u=Os(e)
c.recoMetricsData=Mh(c.recoMetricsData,null,u),c.adPageInfo=dn(e,dH,n),null===(r=c.adPageInfo)||void 0===r||r.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,uN,0)
const d={shelves:[],metricsPageInformation:c,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:a,pageGenreId:q(s,mq),hasAuthenticatedUser:i(e.user.dsid),isSearchLandingPage:!0,adStitcher:oc(e,n)}
Sl(e,Cl(e,s),d)
const f=new one(d.shelves),h=new HQ(yI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null)
return f.pageRefreshPolicy=h,Vn(e,f,d.metricsPageInformation),f}(a,e,t)))}(e,t):e.bag.mediaAPISearchFocusEnabled?await async function(e,t){const n=Pg(e).enablingFeature("search-focus-suggestions"),r=new iy.FetchTimingMetricsBuilder,i=e.addingFetchTimingMetricsBuilder(r),s=Ln(i,n),a=e.amsEngagement
let c=null
if(a&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:GZ,tab:gW}
c=a.performRequest(e)}return await Promise.all([s,t,c]).then(async([e,t,n])=>await r.measureModelConstructionAsync(async()=>await async function(e,t,n,r){const i=Cg(e,t,n,r)
return await async function(e,t){var n
if(o(t.data))return null
const r=Gn(e,kF,OF,t," "),i=Os(e)
r.recoMetricsData=Mh(r.recoMetricsData,null,i)
const s={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:r,pageType:Ay.Focus},a=function(e,t,n){const r=e.data
if(o(r))return null
for(const e of r){if(o(e))continue
const r=p(e,cH)
if(vg(null==r?void 0:r.category)===t.pageType&&n===j(e,Lx))return e}return null}(t,s,AI)
if((0,Am.isNothing)(a))return kg(e,t,s)
const c=null!==(n=q(a,iF))&&void 0!==n?n:0,l=e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(c)
return await l.then(n=>(s.searchHistory=n,kg(e,t,s)))}(e,t).then(e=>(i.searchFocusPage=e,i))}(i,e,t,n)))}(e,t):await async function(e,t){const n=Pg(e),r=new iy.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r),i=Ln(o,n),s=e.amsEngagement
let a
if(s&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:GZ,tab:gW}
a=s.performRequest(e)}return await Promise.all([i,t,a]).then(([e,t,n])=>r.measureModelConstruction(()=>Cg(o,e,t,n)))}(e,t)}(e,t).catch(async n=>{if((0,Am.isSome)(e.bag.trendingSearchesURL))return await async function(e,t){const n={url:e.bag.trendingSearchesURL},r=e.network.fetch(n).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${n.url}`)
return JSON.parse(e.body)})
return await Promise.all([r,t]).then(([t,n])=>{var r
const o=new one(function(e,t){return ym.context("trendingSearchesShelfForResponse",()=>{const n={rootPosition:0,locationStack:[]},r=l(t,"trendingSearches").map(t=>{const r=f(t,Gq),o=new y6(r,r,f(t,BW),MU)
return e.client.isPhone&&(o.artwork=kt(e,Ox)),sa(e,o,lz,n),Vh(n),o})
let o=0
switch(e.client.deviceType){case HW:o=10
break
case ZW:o=7}const i=new pK(aW)
return i.title=r.length>0?f(t,"header.label"):null,i.isHorizontal=!1,i.items=r.slice(0,o),[i]})}(e,t)),i=jn(e,wj,MU,"")
return i.adPageInfo=dn(e,dH,n),null===(r=i.adPageInfo)||void 0===r||r.setMissedOpportunity(e,VA,uN,0),Vn(e,o,i),o})}(e,t)
throw n})}(e)}}const{routes:dne,makeCanonicalUrl:fne}=yc(function(e){return function(e){const{platform:t,...n}=e
return{...n,platform:lt(t),$kind:yO}}({...e,origin:"userText"})},"/{platform}/search",[jj])
class hne{constructor(){this.$intentKind=yO,this.routes=dne}async perform(e,t){return await function(e,t,n){return n(e.addingActiveIntent({previewPlatform:t.platform}))}(t,e,async t=>{const n=await Og(t,e)
return(0,mm.isNothing)(n.canonicalURL)&&(n.canonicalURL=this.staticCanonicalUrlFor(e,t)),n})}actionFor(e,t){const n=new _J(gW)
return n.destination=e,n.pageUrl=fne(t,e),n}staticCanonicalUrlFor(e,t){return fne(t,e)}}class pne{constructor(){this.$intentKind="SearchResultsPageMoreIntent"}async perform(e,t){return await Eg(t,e.pageToken)}}class wne extends V4{constructor(e,t){super("SearchResultsBuilder"),t.exportingService(yN,{fetchResults:async t=>await async function(e,t){const n=new iy.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await iw(r,t)
return(0,mm.isNothing)(o)?cg(r,t.facets):await async function(e,t){return await ug(e,t)}(r,o)}(e,t),fetchMoreResults:async t=>await async function(e,t){return await async function(e,t){return await ym.context("paginatedSearchResultsWithToken",async()=>{const n=ig(0,t),r=sg(0,t)
return 0===n.length?await Promise.resolve(cg(e)):await sw(e,n).then(async n=>{const o=yt(n)
return await ng(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(e=>{const t=new oQ
return t.results=e.builtSearchResults,t.nextPage=r,t})})})}(e,t)}(e,t.pageToken),fetchSearchResultsPage:async t=>await Og(e,t),fetchMoreOfSearchResultsPage:async t=>await Eg(e,t.pageToken)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class vne{constructor(){this.$intentKind="ArticlePageIntent"}async perform(e,t){return await t.required(R9).fetchPage(t,e.url,q5)}}class gne extends V4{constructor(e,t){super("ArticleBuilder"),t.exportingService(Gk,{fetchArticle:async t=>await e.required(R9).fetchPage(e,t.url,q5)})}async handlePage(e,t,n,c,l){var u
const d=new iy.FetchTimingMetricsBuilder,h=e.addingFetchTimingMetricsBuilder(d),p=JSON.parse(null!==(u=f(t.query,Hz.recoMetrics))&&void 0!==u?u:"{}"),w=function(e,t,n){const r=t.pathComponents()
if(r.indexOf(jG)<0&&r.indexOf(uV)<0&&r.indexOf(DT)<0&&t.host!==Nz&&t.host!==Gz&&t.host!==jz)throw new Error(`Unable to map ${t.build()} to a media api url`)
let o
if(o=t.host===Nz?e.packageProperties.asString("spamBlockingExtensionsEditorialItemID"):t.host===Gz?e.bag.sharePlayAppsEditorialItemId:t.host===jz?e.bag.buddyOnboardingEditorialItemId:Vi(t),!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
if(!a(o))throw new Error(`Unable to map ${t} to a media api url`)
const i=function(e,t,n){const r=new cJ(e).withIdOfType(t.id,YW).includingAdditionalPlatforms(ee(e)).includingAttributes(function(e){const t=[NV,mV,tq,yq,RW,TW,Xj,Tx,vU]
return e.bag.enableUpdatedAgeRatings&&t.push(bW),e.appleSilicon.isSupportEnabled&&t.push(bq),vf(e)&&t.push(Tq),t}(e)).includingRelationships([hB]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,mm.isNothing)(n)&&r.includingAgeRestrictions(),li(e)&&(r.enablingFeature(Uq),r.includingScopedAttributes(tz,eQ),r.includingScopedRelationships(tz,[VW]),r.includingScopedRelationships(ET,[tz]),r.includingScopedAvailableIn(tz,[rE])),di(e)&&(r.enablingFeature(CU),r.includingScopedRelationships($H,[QU]),r.includingAssociateKeys(YW,[YV]),r.includingMetaKeys(IT,[kT]),r.includingScopedAttributes($H,[FW,Pq,HN,lM])),r}(e,ki({...$i(e),id:o}),n),c=t.query[Hz.editorialCardId]
s(c)&&i.withFilter("canvas:cardId",c)
const l=t.query[Hz.preview]
return Vz.has(t.host)&&(null==l?void 0:l.length)>0&&(i.addingQuery(RT,l),i.isStorePreviewRequest=!0),i.attributingTo(t.build())}(e,t,l),v=await Ln(h,w),g=await async function(e,t){return await pc(e,t,cl,ll)}(e,v),y=new d6
y.todayShelfRecoMetricsData=p,y.showingFallbackMediaInline=Boolean(n[Hz.showingFallbackMedia]),y.additionalData=g.additionalData
const T=f(t.query,Hz.todayCardConfig);(null==T?void 0:T.length)>0&&(y.todayCardConfig=JSON.parse(T)),y.allowUnpublishedAppEventPreviews=(0,mm.isSome)(n[Hz.preview]),y.isResilientDeepLink=e.deepLinks.hasResilientDeepLinks(),e.client.isCompanionVisionApp&&(y.clientIdentifierOverride=RY)
const b=d.measureModelConstruction(()=>function(e,t,n){return ym.context("articlePageWithResponse",()=>{var s
const a=mt(e,t)
n.metricsPageInformation=Gn(e,uV,a.id,t),n.metricsLocationTracker={rootPosition:0,locationStack:[]},n.pageId=a.id
const c=new qQ(n.metricsPageInformation,n.metricsLocationTracker,n.refreshController),l=function(e,t){if(!i(t))return null
if((0,mm.isSome)(t.todayCardConfig))return t.todayCardConfig
const n={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!1,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
switch(n.clientIdentifierOverride=t.clientIdentifierOverride,n.useOTDTextStyle=!1,n.allowUnpublishedAppEventPreviews=t.allowUnpublishedAppEventPreviews,n.currentRowIndex=void 0,e.client.deviceType){case iz:n.prevailingCropCodes={defaultCrop:"en"},n.coercedCollectionTodayCardDisplayStyle=Jm.Grid,n.heroDisplayContext=ty.Article
break
case"tv":n.prevailingCropCodes={defaultCrop:"ek","editorialArtwork.storyCenteredStatic16x9":"SCS.ApDHXL01"},n.coercedCollectionTodayCardDisplayStyle=Jm.Grid,n.heroDisplayContext=ty.Article
break
case bH:n.coercedCollectionTodayCardDisplayStyle=Jm.River,n.prevailingCropCodes={defaultCrop:"sr","editorialArtwork.dayCard":"grav.west"}}return n}(e,n)
let u=ko(e,a,l,c)
const d=null==u?void 0:u.media;(0,mm.isNothing)(u)&&(u=null)
const h=null!==(s=null==u?void 0:u.title)&&void 0!==s?s:void 0,p=j(a,Dq)
n.crossLinkSubtitle=Ho(e,a),n.clientIdentifierOverride=l.clientIdentifierOverride,xh(0,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:vW,id:n.pageId,idType:yW},h)
const w=function(e,t,n,r){return ym.context("renderArticle",()=>{var o
const s=[],a=null!==(o=we(t,hB))&&void 0!==o?o:[]
for(const n of a){r.module=j(n,MI),r.subStyle=null,s.length
const o=dl(e,n,t,r)
if(o.length>0)for(const e of o)e.title=r.titleForNextShelf,s.push(e),r.titleForNextShelf=null
r.index++,Vh(r.metricsLocationTracker)}if(r.showingFallbackMediaInline&&0===s.length){const e=function(e,t){if(A(n=t)&&n[hz]===eA||function(e){return A(e)&&e[hz]===nA}(t)){const e=new pK(mW)
return e.items=t.lockups,e}var n
return null}(0,n)
i(e)&&s.push(e)}return s})}(e,a,d,n),v=w[w.length-1],g=n.isResilientDeepLink||p===FL?null:function(e,t,n){const s=fl(0,t)
let a=null
const c=sh(e,t,cz),l=sh(e,t,qV)
if(c&&l&&(a=e.loc.string("ShareSheet.TitleSubtitle.Format","{title}: {subtitle}").replace(PG,c).replace(SC,l)),!a&&c&&(a=c),!a&&l&&(a=l),!a&&s){const n=j(s,cz),r=j(t,CB)
switch(r){case Jm.GameOfTheDay:a=e.loc.string("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(PG,n)
break
case Jm.AppOfTheDay:a=e.loc.string("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(PG,n)
break
default:e.console.log(`No title for article with unknown style: ${r}`)}}const u=j(t,BW)
let d
switch(j(t,CB)){case Jm.Grid:case Jm.List:case Jm.River:d=kt(e,"resource://ShareCollectionThumbnail",40,40)
break
default:d=null}const f=function(e,t,n,o,s,a){return r(a)?null:ym.context("shareSheetDataForArticle",()=>{let r=s;(0,mm.isNothing)(r)&&(0,mm.isSome)(a)&&(r=function(e,t){const n=Ro(t)
{const r=Vo(e,t,ty.Article,n)
if(i(r))return r}return $o(e,B(t,Fo(0,n)),void 0)}(e,a))
const o=e.loc.string("ShareSheet.Story.Subtitle"),c=new mQ(a.id,t,o,r)
return new yQ(c,n,null)})}(e,a,u,0,d,t)
if(!i(f))return null
const h=function(e,t,n,r){const s=[]
if((null==t?void 0:t.length)>0){const n=Wo(e,t)
i(n)&&s.push(n)}if((null==n?void 0:n.length)>0){const t=Wo(e,n,"Copy Card Preview Link")
i(t)&&s.push(t)}if((0,mm.isSome)(r)){let t
e.featureFlags.isGSEUIEnabled(BK)&&e.featureFlags.isEnabled(yK)&&(t=function(e,t){if(o(e))return
const n=new HJ(e)
return n.title=t,new gQ("com.apple.AppStore.openInGameCenterActivity",n)}(`games:///story/id${r}`,e.loc.string("ShareSheet.OpenInGameCenter.Title"))),i(t)&&s.push(t)}return s}(e,u,function(e,t,n){if((0,mm.isNothing)(t))return null
switch(e.client.buildType){case Rj:case WG:const e=new oY
return e.protocol=Iz,e.host=FG,e.pathname=`/${_z.todayCardPreview}`,e.param(Hz.ids,`${t}`),e.param(Hz.isTodayFeedPreview,cW),e.param(Hz.isTodaySection,n.useOTDTextStyle?cW:IN),decodeURIComponent(e.build())
default:return null}}(e,t.id,n),t.id)
return new nQ(f,h)}(e,a,l)
if(i(g)){ra(e,g,{targetType:lz,id:n.pageId,actionType:QB,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})
const t=function(e,t,n){if(t&&n){const e=t.items.length
if(e>0&&-1!==f6.indexOf(n)){const n=t.items[e-1]
switch(t.contentType){case aL:case h$:return n&&n.isFullWidth
default:return!0}}}return!1}(0,v,n.module),r=function(e,t,n,r){if(!i(t)||e.client.isCompanionVisionApp)return null
const o=new W5(QB,e.loc.string("SHARE_STORY"),!r,t),s=new pK("roundedButton")
return s.items=[o],s}(e,g,0,t)
r&&w.push(r)}const y=new q5(u,w,g)
if(y.editorialStoryCard=null,y.title=null==u?void 0:u.title,y.subtitle=null==u?void 0:u.inlineDescription,function(e,t,n,r){const o=fl(0,n)
if(o){const i=aa(0,n)
return void(t.footerLockup=function(e,t,n,r){return Nd(e,t,{offerStyle:hl(e),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:r,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:R3.Default,canDisplayArcadeOfferButton:ph(0,mW)})}(e,o,r,i))}const s=H(n,cL)
if(i(r.additionalData)&&s){const o=po(e,n)
t.arcadeFooterLockup=function(e,t,n){return Wd(e,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},ht(uV),_q,null)}(e,o,r)}}(e,y,a,n),y.shouldTerminateOnClose=n.isResilientDeepLink,Vn(e,y,n.metricsPageInformation,e=>{let t=h
var n
if(A(n=null==u?void 0:u.media)&&n[hz]===Xy&&function(e){return Br(e)&&e[hz]===Ky}(null==u?void 0:u.overlay)&&(t=(null==u?void 0:u.overlay).lockup.title),!t)return
let r=f(m(e[SG]),Rq)
r=r||f(m(e[xj])),e[SG]=r?`${r}_${t}`:`unknown_${t}`}),y.canonicalURL=j(a,BW),(0,mm.isSome)(a)){const e=j(a,BW);(0,mm.isSome)(e)&&(y.viewArticleAction=new HJ(e,!0))}return y})}(h,g.originalData,y)),S=V4.createFlowAction(b,vW,t)
{const e=new R0(UW)
return e.actions=[S],e}}pageRoute(e){return[{protocol:Iz,path:`/{countryCode}/${_z.editorialItem}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/{countryCode}/${_z.editorialItem}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/{countryCode}/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/{countryCode}/{platform}/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/{countryCode}/${_z.story}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/${_z.story}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:`/${_z.store}/${_z.viewEditorialItem}`,query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Iz,hostName:`${Nz}`},{protocol:Cz,path:`/${_z.story}/{id}`,query:[`${Hz.metrics}?`,`${Hz.invalidateWidgetsOnFailure}?`]},{protocol:Iz,hostName:`${Gz}`},{protocol:Iz,hostName:`${jz}`}]}pageType(){return vW}}Cy=e(1415)
class mne{constructor(e,t,n,r,o,i){this.$kind="TodayPage",this.shelves=e,this.title=n,this.titleDetail=o,this.shortTitleDetail=i,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new LJ,this.pageRenderMetrics={}}}!function(e){e.OnboardingCards="onboardingCards",e.Ads="ads",e.ODP="ODP",e.AMDData="amdData"}(Iy||(Iy={}))
class yne extends V4{constructor(){super("TodayCardPreviewBuilder")}pageType(){return UW}pageRoute(e){return[{protocol:Iz,path:`/${_z.todayCardPreview}`,query:[`${Hz.ids}?`,`${Hz.isTodaySection}?`,`${Hz.isTodayFeedPreview}?`,`${Hz.preview}?`,`${Hz.experimentId}?`,`${Hz.fetchData}?`]}]}async handlePage(e,t,n,r,i){return await Za(`${this.builderClass}.pageHandler`,async()=>{var r
const i=new _J(this.pageType())
if(i.pageUrl=t.build(),!g(n[Hz.fetchData]))return i
const a=null===(r=n[Hz.experimentId])||void 0===r?void 0:r.split(","),c=n[Hz.ids]
if(s(a)&&o(c)){const t={}
for(const e of a){const n=e.split(":")[0],r=e.split(":")[1]
t[n]=r}const n=s(t)?JSON.stringify(t):void 0,r=await Lg(e,{experimentIdHeader:n,url:"",onboardingCardIds:[]})
return i.pageData=r,i}{const n=Mg(e,this.createFlattenedTodayItemsFromUrl(t),yne.emptyTodayPageResponse,null,null)
return i.pageData=n,i}})}createFlattenedTodayItemsFromUrl(e){const t=[],n=f(e.query[Hz.ids]),r=(0,mm.isSome)(e.query[Hz.isTodayFeedPreview])&&g(e.query[Hz.isTodayFeedPreview]),o=(0,mm.isSome)(e.query[Hz.isTodaySection])&&g(e.query[Hz.isTodaySection])
if(!s(n))return t
const i=n.match(/([a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?:\[[^\]]+\]|[a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?)/g)
let a=r,c=0
for(const e of i){const n=e.split(":")[0],r=yne.storyGroupIdRegex.exec(e)
if((0,mm.isSome)(r)){const e=r[1].split(",").map(e=>this.createUnhydratedEditorialItemFromId(e,o))
t.push({type:oy.EditorialItemGroup,data:{id:n,type:SV,relationships:{},meta:{associations:{recommendations:{data:e}}}},isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...yne.previewModuleData},containedAdSlots:Array.from({length:e.length},(e,t)=>t+c)}),a=!1,c+=e.length}else t.push({type:oy.EditorialItem,data:this.createUnhydratedEditorialItemFromId(e,o),isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...yne.previewModuleData},containedAdSlots:[c]}),a=!1,c+=1}return t}createUnhydratedEditorialItemFromId(e,t){const n=e.split(":")[0],r=e.split(":")[1],o=(0,mm.isSome)(r)?{"editorial-cards":{data:[{id:`${n}-${r}`,type:YV}]}}:{}
return{id:n,type:YW,relationships:{},meta:{personalizationData:{isOfTheDay:t},associations:o}}}}yne.storyGroupIdRegex=/\[(.*)\]/,yne.previewModuleData={label:jk,title:"Today Preview",meta:{},isTodayForAppsModule:!1},yne.emptyTodayPageResponse={results:{data:[]}}
class Ane{constructor(){this.$intentKind="TodayPageIntent"}async perform(e,t){const n=e.isRunningPPTs?JSON.stringify({NyCxKBD:"client-perf"}):void 0
return await Lg(t,{url:e.url,onboardingCardIds:e.onboardingCardIds,experimentIdHeader:n})}}class Tne{constructor(){this.$intentKind="TodayPageMoreIntent"}async perform(e,t){const n=e.pageToken
return Bg(t,n.pageInformation),await $g(t,n),Fg(t,n)}}class bne extends V4{constructor(e,t){super("TodayPageBuilder"),t.exportingService(Gk,{fetchPage:async t=>await Lg(e,{url:t.url,onboardingCardIds:t.onboardingCardIds}),async fetchMoreOfPage(t){const n=t.pageToken
return Bg(e,n.pageInformation),await $g(e,n),Fg(e,n)}})}defaultTab(e){return UW}pageType(){return UW}pageRoute(e){return[]}async handlePage(e,t,n,r,o){throw new Error("handlePage not implemented for TodayBuilder")}}class Sne{constructor(e,t,n,r){this.$kind="TopChartSegment",this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new LJ,this.pageRenderMetrics={}}}class Pne extends WZ{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.$kind="TopChartCategory",this.shortName=this.name,this.longName=this.name,this.url=t}}class Cne{constructor(){this.$intentKind="TopChartsPageIntent"}async perform(e,t){return await Hg(t,e.url)}}class Ine{constructor(){this.$intentKind="TopChartsPageMoreIntent"}async perform(e,t){return await qg(t,e.pageToken)}}class kne extends V4{constructor(e,t){super("TopChartsBuilder"),t.exportingService("TopChartData",{fetchPage:async t=>await Hg(e,t.url),fetchMoreOfSegment:async t=>await qg(e,t.pageToken)})}pageRoute(e){return Wg()}async handlePage(e,t,n,i,a){const c=n[Hz.isPPT]
t.removeParam(Hz.isPPT)
let l=t.query[Hz.chart],u=n[Hz.genre]
o(u)&&(u=f(e.bag.defaultChart,"genre-id"),o(l)&&(l=f(e.bag.defaultChart,"chart-id")))
let d=n[Hz.charts]
if(o(d)){const e=Tc(0,l)
d=void 0!==e?`${l},${e}`:l}else d.includes(l)||(d+=`,${l}`)
const h=bc(e,u,d,n[Hz.ages])
let p
p=Sc(e,d,u)
const[w,v]=await Promise.all([h,p]),g=Tn(e,v)
let m,y
if(m=Gg(e,w,u,g,l,r(g)?mn(u):yn(g)),y=tj,c&&s(m.segments)){const t=m.segments[0],n=t.nextPage,r=St(0,n)
if(s(r)){const o=new cJ(e,r),i=await Ln(e,o),s=Pt(0,n)
s.remainingContent=[],s.maxPerPage=0
const a=zg(e,i,n,s),c=t.shelves.concat(a.shelves),l=new Sne(t.shortName,t.longName,t.chart,c)
l.pageMetrics=t.pageMetrics,l.nextPage=null,m.segments[0]=l}}return V4.createFlowAction(m,y,t)}pageType(){return tj}async handlePagination(e,t,n,r,o){return await Za(`${this.builderClass}.handlePagination`,async()=>function(e){var t,n
const r=new gK(e.shelves)
return r.title=null!==(t=e.longName)&&void 0!==t?t:e.shortName,r.pageMetrics=e.pageMetrics,r.pageRenderMetrics=e.pageRenderMetrics,s(null===(n=null==e?void 0:e.nextPage)||void 0===n?void 0:n.remainingContent)&&(r.nextPage=e.nextPage),r}(await qg(e,o)))}}class One{constructor(e,t,n,r){this.$kind="TodayWidgetContainerTemplate",this.collections=e,this.refreshDate=t,this.originalResponseDate=n,this.originalResponseHash=r}}class Ene{constructor(e,t){this.$kind="TodayWidgetCardCollectionTemplate",this.cards=e,this.displayDate=t}}class Dne{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="WidgetTodayCardTemplate",this.storyId=e,this.heading=t,this.title=n,this.backgroundColor=r,this.isDark=o,this.iconArtwork=i,this.url=s,this.eventBadgeKind=l,this.editorialArtwork=c,this.isVideoArtwork=a,this.eventStartDate=u,this.eventEndDate=d}}class Rne{make(e){const t=new cJ(e).forType(this.typeForUseCase()).withIdsOfType(this.ids(),this.typeForUseCase()).addingContext(this.context()).includingAttributes(this.attributesForUseCase()).asPartialResponseLimitedToFields(this.fieldsForRequest()).withSparseCount(this.sparseCountForUseCase()).withSparseLimit(this.sparseLimitForUseCase()).usingCustomAttributes(this.shouldUseCustomAttributes(e)),n=this.enablingFeature(e);(0,mm.isSome)(n)&&t.enablingFeature(n)
const r=this.addingQuery()
if((0,mm.isSome)(r))for(const e of r)t.addingQuery(e.key,e.value)
return t}}class _ne extends Rne{context(){return sR}typeForUseCase(){return UW}attributesForUseCase(){return[RW,TW,yq]}sparseCountForUseCase(){return null}sparseLimitForUseCase(){return null}addingQuery(){return null}ids(){return[]}fieldsForRequest(){return[W_,XW,W$,CB,JE,Aq,LS,RW,PS,nH,TW,q$,"id",tG,Dq,Gq,EW,yq,cz,KE,H$]}enablingFeature(e){return li(e)?Uq:void 0}shouldUseCustomAttributes(e){return Ue(e)}}class Lne{constructor(){this.$intentKind="WidgetIntent"}async perform(e,t){const n=e.widgetKind
if(n===XI)return await sm(t,e)
throw Error(`Invalid widgetKind of '${n}'`)}}class Mne extends V4{constructor(e,t){super("WidgetController"),t.exportingService("WidgetData",{fetchTodayWidget:async t=>await sm(e,t)})}async handlePage(e,t,n,r,o){throw new Error(uH)}pageRoute(e){return[]}pageType(){return GW}}class Fne{constructor(){this.$intentKind="MetricsFieldLintingIntent"}async perform(e,t){var n
const r=wr(t).makeEvent(t,null!==(n=y(e.fields))&&void 0!==n?n:{})
return await Promise.resolve(r)}}class $ne{constructor(){this.$intentKind="AppUpdateLockupsIntent"}async perform(e,t){const n=this.createUpdateLockups(t,e.appUpdateMetadata)
return await Promise.resolve(n)}createUpdateLockups(e,t){const n={lockupOptions:{metricsOptions:{pageInformation:jn(e,j$,sk,""),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:R3.LockupIconSmall}}
return this.updatesLockupsFromData(e,t,n)}updatesLockupsFromData(e,t,n){return ym.context("updatesLockupsFromData",()=>{const r=[]
return null==t||t.forEach((t,o)=>{var i
const s=t.updateMetadata
if((0,mm.isNothing)(s.attributes))return void(n.contentUnavailable&&n.contentUnavailable(o,s))
const a=n.lockupOptions
let c=Im.All
if((0,mm.isSome)(n.filter)&&(c=n.filter),st(e,s,c))return
const l=function(e){return e?{...e,isValid:e.isValid,$kind:NL}:null}(Nd(e,s,a))
if((0,mm.isNothing)(l)||!l.isValid())return
const u=se(s,tt(e,s),"latestVersionInfo"),d=f(u,b_),h=f(u,XU);(0,mm.isSome)(h)&&(l.releaseDate=new Date(h)),l.installDate=t.updateInstallDate
const p=t.isUpdateAvailable||t.isUpdating?l.releaseDate:l.installDate
let w;(0,mm.isSome)(p)?w=this.timeAgoStringForDate(e,p):(0,mm.isSome)(d)&&(w=e.loc.string("UPDATES_VERSION_FORMAT").replace("{updateVersion}",d)),(0,mm.isSome)(w)&&(l.subtitle=w)
const v=f(u,qC);(0,mm.isSome)(v)&&(l.whatsNew=new V0(v.trim())),l.version=d,l.size=null===(i=Hf(e,s))||void 0===i?void 0:i.fileSizeByDevice,l.externalVersionId=et(e,s,d_),r.push(l),Vh(n.lockupOptions.metricsOptions.locationTracker)}),r})}timeAgoStringForDate(e,t){const n=(new Date).getTime()-t.getTime(),r=Math.floor(n/864e5)
switch(r){case 0:return e.loc.string("LOCKUPS_TODAY")
case 1:return e.loc.string("LOCKUPS_YESTERDAY")
case 2:case 3:return e.loc.string("LOCKUPS_DAYS_AGO_FORMAT").replace("{daysAgo}",r.toString())
default:const n=i$
return e.loc.formatDate(n,t)}}}ky=e(5881)
class xne{constructor(){this.dispatcher=new ky.IntentDispatcher}register(e){this.dispatcher.register(e)}async dispatch(e,t){const n=await this.createIntentObjectGraphWithAsyncValues(t)
return await this.dispatcher.dispatch(e,n)}controller(e){return this.dispatcher.controller(e)}get registeredControllers(){return this.dispatcher.registeredControllers}async createIntentObjectGraphWithAsyncValues(e){const t=new SJ,n=new pZ,r=new pZ(hZ)
let o
if(e instanceof Z9){let i=e
i=i.addingBag(i.bag.underlyingBag),await t.loadTreatments(i),await n.loadValues(i,[Om.client,Om.user]),e.bag.personalizationUserIdEnabled&&await r.loadValues(e,[Om.user]),i.clientCapabilities.isEnabled(hR)&&i.bag.metricsPaymentNamespaceEnabled&&(o=new pZ(dZ),await o.loadValues(i,[Om.client,Om.user])),e=i}return e.adding(SJ.metatype,t).adding(pZ.defaultMetatype,n).adding(pZ.paymentMetatype,o||n).adding(pZ.personalizationMetatype,r)}}class Nne extends gm.LegacyRuntime{constructor(e,t){super(e,t,{})}exportingService(e,t){this.wrapServiceInValidation(t)
const n={...this.serviceWithName(e)||{},...t}
return super.exportingService(e,n)}exportingServiceName(e,t,n){const r={}
r[t]=n,this.exportingService(e,r)}wrapServiceInValidation(e){for(const t of Object.keys(e)){const n=e[t]
n instanceof Function&&(e[t]=function(...e){const t=n.apply(this,e)
return t instanceof Promise?t.then(e=>(ym.recordValidationIncidents(e),e)):(ym.recordValidationIncidents(t),t)})}}}(0,gm.exportBootstrap)(function(e){const[t,n]=function(e){const t=new _9,n=function(e,t,n){var r,o
const i=function(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b,S,P,C,I,k,O,E,D,R,_,L,M,F,$,x){return e.configureDefaults(n,r,o,i,s,a,c,l,u,d,f,h,p,w,v,g,m,y,A,T,b,S,P,C,I,k,O,E,D,R,_,L,M,F,$,x).adding(R9,t)}(new Z9("app-store"),e,bag,cryptography,host,net,platform,plist,random,services,cookieProvider,console,ask.storeMetrics,ask.amsEngagement,ask.loc,ask.adsLoc,ask.device,ask.client,ask.props,ask.user,ask.player,ask.metricsIdentifiers,ask.clientOrdering,ask.arcade,ask.gameCenter,ask.resilientDeepLinks,ask.appleSilicon,ask.storage,ask.ads,ask.onDeviceRecommendationsManager,ask.onDeviceSearchHistoryManager,null!==(r=ask.featureFlags)&&void 0!==r?r:{isEnabled:()=>!1,isGSEUIEnabled:()=>!1},null!==(o=ask.clientCapabilities)&&void 0!==o?o:{isEnabled:()=>!1},mediaToken,ask.appDistribution,ask.timeoutManager,ask.treatmentStore,ask.userDefaults)
return vz.createSharedMetricsReferralContext(i),i}(t),r=new xne,o=new Nne(r,n)
return function(e,t){const n=e.required(R9)
t.exportingService(AT,{fetchGeneric:async t=>await n.fetchPage(e,t.url,gK),fetchMoreOfGeneric:async t=>await n.fetchMoreOfPage(e,t.pageToken),fetchShelves:async t=>await n.fetchShelves(e,t.requests),fetchAction:async t=>await gp(e,t)})}(n,o),t.registerPageBuilder(n,new bne(n,o)),t.registerPageBuilder(n,new gne(n,o)),t.registerPageBuilder(n,new yne),t.registerPageBuilder(n,new kne(n,o)),t.registerShelfBuilder(n,new v5),t.registerShelfBuilder(n,new y5),t.registerShelfBuilder(n,new b5),t.registerShelfBuilder(n,new k6),t.registerShelfBuilder(n,new S5),t.registerShelfBuilder(n,new P6),t.registerShelfBuilder(n,new C5),t.registerShelfBuilder(n,new k5),t.registerShelfBuilder(n,new E5),t.registerShelfBuilder(n,new R5),t.registerShelfBuilder(n,new d5),t.registerShelfBuilder(n,new $5),t.registerShelfBuilder(n,new G5),t.registerShelfBuilder(n,new p6),t.registerShelfBuilder(n,new w6),t.registerShelfBuilder(n,new g6),t.registerShelfBuilder(n,new A6),t.registerShelfBuilder(n,new T6),t.registerShelfBuilder(n,new b6),t.registerShelfBuilder(n,new I6),t.registerPageBuilder(n,new xee),t.registerPageBuilder(n,new I7(n,o)),t.registerPageBuilder(n,new m7(n,o)),t.registerPageBuilder(n,new x7(n,o)),t.registerPageBuilder(n,new U8),t.registerPageBuilder(n,new T7(n,o)),t.registerPageBuilder(n,new L7(n,o)),t.registerPageBuilder(n,new M7),t.registerPageBuilder(n,new R8),t.registerPageBuilder(n,new B8(n,o)),t.registerShelfBuilder(n,new w5),t.registerPageBuilder(n,new yee),t.registerPageBuilder(n,new Cee),t.registerPageBuilder(n,new Iee),t.registerPageBuilder(n,new $ee),t.registerPageBuilder(n,new rte),t.registerPageBuilder(n,new lte),t.registerPageBuilder(n,new ute),t.registerPageBuilder(n,new ete(n,o)),t.registerPageBuilder(n,new Qee),t.registerPageBuilder(n,new dte),t.registerPageBuilder(n,new fte),t.registerPageBuilder(n,new Kee),t.registerPageBuilder(n,new Jee),t.registerPageBuilder(n,new Zee(n)),t.registerPageBuilder(n,new Yee(n)),t.registerPageBuilder(n,new une),t.registerPageBuilder(n,new Pte(n,o)),t.registerPageBuilder(n,new wne(n,o)),t.registerPageBuilder(n,new rne(n,o)),t.registerPageBuilder(n,new vee),t.registerPageBuilder(n,new gee),t.registerPageBuilder(n,new mee),t.registerPageBuilder(n,new s8(n,o)),t.registerPageBuilder(n,new S8(n,o)),t.registerPageBuilder(n,new u8),t.registerPageBuilder(n,new O8),t.registerPageBuilder(n,new d8),t.registerPageBuilder(n,new k8),t.registerPageBuilder(n,new P8),t.registerPageBuilder(n,new C8),t.registerPageBuilder(n,new I8),t.registerPageBuilder(n,new aee),t.registerPageBuilder(n,new cee),t.registerPageBuilder(n,new ree),t.registerPageBuilder(n,new nee),t.registerPageBuilder(n,new Z7),t.registerPageBuilder(n,new oee),t.registerPageBuilder(n,new lee),t.registerPageBuilder(n,new Q7),t.registerPageBuilder(n,new eee),t.registerPageBuilder(n,new iee),t.registerPageBuilder(n,new tee),t.registerPageBuilder(n,new see),t.registerPageBuilder(n,new qee(n,o)),t.registerPageBuilder(n,new Bee(n,o)),t.registerPageBuilder(n,new vte),t.registerPageBuilder(n,new wte),t.registerPageBuilder(n,new hte),t.registerPageBuilder(n,new pte),t.registerPageBuilder(n,new Fee(n,o)),t.registerPageBuilder(n,new Mne(n,o)),t.registerPageBuilder(n,new D8(n,o)),t.registerPageBuilder(n,new Uee(n,o)),t.registerPageBuilder(n,new j7(n,o)),t.registerPageBuilder(n,new Y7(n,o)),t.registerPageBuilder(n,new B7(n,o)),t.registerPageBuilder(n,new zee(n,o)),t.registerPageBuilder(n,new K7(n,o)),[r,o]}()
return t.register(new c8),t.register(new i8),t.register(new n8),t.register(new $ne),t.register(new l8),t.register(new C7),t.register(new v7),t.register(new g7),t.register(new A7),t.register(new N7),t.register(new $7),t.register(new _7),t.register(new x8),t.register(new N8),t.register(new vne),t.register(new Mee),t.register(new z7),t.register(new Wee),t.register(new Lee),t.register(new T8),t.register(new X9),t.register(new e8),t.register(new J7),t.register(new Nee),t.register(new Fne),t.register(new Hee),t.register(new Vee),t.register(new b8),t.register(new G7),t.register(new q7),t.register(new W7),t.register(new nne),t.register(new hne),t.register(new pne),t.register(new Ste),t.register(new Xee),t.register(new t8),t.register(new Ane),t.register(new Tne),t.register(new Cne),t.register(new Ine),t.register(new E8),t.register(new Lne),n})})()})()

//# sourceMappingURL=main.js.map