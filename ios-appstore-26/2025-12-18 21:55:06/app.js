(()=>{function e(r){var o,i=n[r]
return void 0!==i?i.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,e),o.exports)}var t={172:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7691),t)},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.demoteByEngagements=void 0,t.demoteByEngagements=function(e,t){return[...e]}},2305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3745:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2305),t),o(n(3756),t)},7691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3745),t),o(n(230),t)},9100:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4908),t)},6451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LazyProxyFactory=void 0,t.LazyProxyFactory=class{static makeProxy(e,t){const r=new n(t),o={get:(t,n,o)=>{if(void 0===r.createRealObjectIfNeeded(e))return
const i=r.realObject[n]
return"function"==typeof i?i.bind(r.realObject):i},set:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.set(r.realObject,n,o,r.realObject),has:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.has(r.realObject,n),deleteProperty:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.deleteProperty(r.realObject,n),ownKeys:t=>void 0===r.createRealObjectIfNeeded(e)?[]:Reflect.ownKeys(r.realObject),getOwnPropertyDescriptor:(t,n)=>{if(void 0!==r.createRealObjectIfNeeded(e))return Reflect.getOwnPropertyDescriptor(r.realObject,n)},defineProperty:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.defineProperty(r.realObject,n,o),preventExtensions:t=>void 0!==r.createRealObjectIfNeeded(e)&&(Reflect.preventExtensions(r),Reflect.preventExtensions(r.realObject)),isExtensible:t=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.isExtensible(r.realObject),getPrototypeOf:t=>void 0===r.createRealObjectIfNeeded(e)?null:Reflect.getPrototypeOf(r.realObject),setPrototypeOf:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.setPrototypeOf(r.realObject,n)}
return new Proxy(r,o)}}
class n{constructor(e){this.lazyProvider=e}createRealObjectIfNeeded(e){return void 0===this.realObject&&(this.realObject=this.lazyProvider.lazyDependencyFor(e)),this.realObject}}},4908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.ObjectGraph=void 0
const r=n(2450)
t.ObjectGraph=class{constructor(e){this._members={},this.name=e}adding(e,t){const n=this.clone()
return n._members[e.name]=t,n}removing(e){const t=this.clone()
return delete t._members[e.name],t}optional(e){return this._members[e.name]}required(e){const t=this._members[e.name]
if((0,r.isNothing)(t)){const t=Object.keys(this._members).sort().join(", ")
throw new Error(`No member with type ${e.name} found in ${this.name}. Candidates ${t}`)}return t}clone(){const e=new(0,this.constructor)(this.name)
for(const[t,n]of Object.entries(this._members))e._members[t]=n
return e}},t.inject=function(e,t){return t.required(e)}},9089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseActionProvider=void 0
const r=n(2450)
t.isBaseActionProvider=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.actionFor)}},129:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9089),t)},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntentDispatcher=void 0
const r=n(2450),o=n(4395),i=n(3907),s=n(1222)
t.IntentDispatcher=class{constructor(){this.dispatchableMap={}}register(e){if((0,r.isNothing)(e.$intentKind))throw new Error("Dispatcher cannot register a controller without an $intentKind")
if(e.$intentKind in this.dispatchableMap)throw new Error(`Dispatcher already has a controller registered for ${e.$intentKind}`)
this.dispatchableMap[e.$intentKind]=e}async dispatch(e,t){if("$static"===e.$kind){const t=Reflect.get(e,"$data")
if((0,r.isNothing)(t))throw new Error("StaticIntent<R> contains no data")
return t}const n=this.dispatchableMap[e.$kind]
if((0,r.isNothing)(n)||!(0,o.isIntentController)(n))throw new Error(`No controller registered to handle ${e.$kind}`)
const a=e.$pageIntentInstrumentation,c=t.optional(s.net)
if((0,r.isSome)(a)&&(0,r.isSome)(c)){const r=new i.ProxiedNetwork(c,a),o=t.adding(s.net,r)
return await n.perform(e,o)}return await n.perform(e,t)}controller(e){return this.dispatchableMap[e.$kind]}get registeredControllers(){return Object.values(this.dispatchableMap)}}},8346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4395),t),o(n(3421),t),o(n(8770),t),o(n(867),t)},4395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIntentController=void 0
const r=n(2450)
t.isIntentController=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.perform)}},867:(e,t)=>{function n(e){return{$kind:"$static",$data:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Continuous=t.makeSidepackedIntent=t.makeStaticContinuousIntentsOf=t.makeStaticIntent=void 0,t.makeStaticIntent=n,t.makeStaticContinuousIntentsOf=function(e){const t=new Array
for(const o of e)t.push(n(r.of(o)))
return t},t.makeSidepackedIntent=function(e,t){return{$kind:"$sidepacked",$initial:e,$intent:t}}
class r{static of(e){return new r(new o(e))}static contentsOf(e){return new r(e)}constructor(e){this.base=e,this.$wrappedField="base"}toJSON(){if(this.base instanceof o)return this.base.toJSON()
throw new TypeError("Continuous was not created with a single element")}async*[Symbol.asyncIterator](){yield*this.base}}t.Continuous=r
class o{constructor(e){this.element=e,this.$wrappedField="element"}toJSON(){return this.element}async*[Symbol.asyncIterator](){yield this.element}}},5881:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(8346),t),o(n(129),t)},5542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(5827),t),o(n(8037),t),o(n(1777),t),o(n(1415),t),o(n(7312),t)},1777:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1077),t),o(n(4172),t)},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueAsNumber=t.valueAsString=t.valueAsBoolean=void 0
const r=n(2450),o=n(4172)
t.valueAsBoolean=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("boolean"==typeof e)return e
if("string"==typeof e){if("true"===e)return!0
if("false"===e)return!1}const i=Boolean(e)
switch(t){case"strict":o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)})
break
case"coercible":if((0,r.isNothing)(i))return o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)}),null}return i},t.valueAsString=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("string"==typeof e)return e
const i="object"==typeof e?null:String(e)
switch(t){case"strict":o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})
break
case"coercible":(0,r.isNothing)(i)&&o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})}return i},t.valueAsNumber=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("number"==typeof e)return e
const i=Number(e)
switch(t){case"strict":o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)})
break
case"coercible":if(isNaN(i))return o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)}),null}return i}},1077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4409),t),o(n(2506),t),o(n(6418),t)},2506:(e,t,n)=>{function r(e){if(Array.isArray(e))return e
switch(typeof e){case"string":{const t=i[e]
if((0,o.isSome)(t))return t
{const t=Object.freeze(e.split("."))
return i[e]=t,t}}case"number":case"symbol":return[e]
default:throw new TypeError(`${e.toString()} is not a KeyPath`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.keyPathContains=t.keyPathEndsWith=t.keyPathStartsWith=t.keyPathsEqual=t.isKeyPathThis=t.thisKeyPath=t.keysOf=void 0
const o=n(2450),i={}
t.keysOf=r,t.thisKeyPath=Object.freeze([]),t.isKeyPathThis=function(e){return Array.isArray(e)&&0===e.length},t.keyPathsEqual=function(e,t){if(e===t)return!0
const n=r(e),o=r(t)
if(n.length!==o.length)return!1
for(let e=0,t=n.length;e<t;e+=1)if(n[e]!==o[e])return!1
return!0},t.keyPathStartsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[0]===t}},t.keyPathEndsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[n.length-1]===t}},t.keyPathContains=function(e,t){return e===t||r(e).includes(t)}},6853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectCursor=void 0
const r=n(2450),o=n(2879),i=n(2506),s=n(7454)
t.ObjectCursor=class{constructor(e){this.values=[e],this.keyPaths=[i.thisKeyPath],this.savedDepths=[]}get currentValue(){return this.values[this.values.length-1]}get currentKeyPath(){return this.keyPaths[this.keyPaths.length-1]}interject(e,t){this.values.push(e),this.keyPaths.push(t)}reuse(e,t=i.thisKeyPath){this.values.length=0,this.values.push(e),this.keyPaths.length=0,this.keyPaths.push(t),this.savedDepths.length=0}moveTo(e){const t=(0,s.traverse)(this.currentValue,e)
return this.values.push(t),this.keyPaths.push(e),t}moveBack(){const e=this.values.length
if(1===e)throw new Error("Cannot move back past the root of a cursor")
const t=this.savedDepths.length
if(t>0&&e<=this.savedDepths[t-1])throw new Error("Cannot move back past the most recent saved state")
this.values.pop(),this.keyPaths.pop()}saveState(){this.savedDepths.push(this.values.length)}restoreState(){const e=this.savedDepths.pop()
if((0,r.isNothing)(e))throw new Error("Calls to restoreState must balance previous calls to saveState")
this.values.length=e,this.keyPaths.length=e}clone(){const e=(0,o.shallowCloneOf)(this)
return e.values=this.values.slice(),e.keyPaths=this.keyPaths.slice(),e.savedDepths=this.savedDepths.slice(),e}}},4409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectReader=void 0
const r=n(2450),o=n(2879),i=n(6418),s=n(2506),a=n(6853),c=n(7454),l=new Map
class u{constructor(e){this._cursor=new a.ObjectCursor(e)}get currentKeyPath(){return this._cursor.currentKeyPath}has(e){return(0,s.keyPathEndsWith)(this._cursor.currentKeyPath,e)||(0,r.isSome)(this.get(e))}select(e,t=!1){return!t&&(0,s.keyPathsEqual)(this._cursor.currentKeyPath,e)||this._cursor.moveTo(e),this}deselect(){return this._cursor.moveBack(),this}saveSelection(){return this._cursor.saveState(),this}restoreSelection(){return this._cursor.restoreState(),this}get(e=s.thisKeyPath){return(0,s.isKeyPathThis)(e)?this._cursor.currentValue:(0,c.traverse)(this._cursor.currentValue,e)}asBoolean(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsBoolean)(this.get(e),t,String(e))}asNumber(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsNumber)(this.get(e),t,String(e))}asString(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsString)(this.get(e),t,String(e))}*[Symbol.iterator](){const e=this.get()
if((0,r.isNothing)(e))return
const t=u._clone(this)
if(Array.isArray(e)){let n=0
for(const r of e)t.saveSelection(),t._cursor.interject(r,n),yield t,t.restoreSelection(),n+=1}else yield t
u._recycle(t)}reduce(e,t){const n=this.get()
if((0,r.isNothing)(n))return e
if(!Array.isArray(n))return t(e,this)
try{let r=e
for(let e=0,o=n.length;e<o;e+=1)this.saveSelection(),this._cursor.interject(n[e],e),r=t(r,this),this.restoreSelection()
return r}catch(e){throw this.restoreSelection(),e}}map(e){return this.reduce(new Array,(t,n)=>(t.push(e(n)),t))}compactMap(e){return this.reduce(new Array,(t,n)=>{const o=e(n)
return(0,r.isSome)(o)&&t.push(o),t})}applyTo(e,...t){this.saveSelection()
try{const n=e(this,...t)
return this.restoreSelection(),n}catch(e){throw this.restoreSelection(),e}}callOn(e,t,...n){this.saveSelection()
try{const r=e.call(t,this,...n)
return this.restoreSelection(),r}catch(e){throw this.restoreSelection(),e}}clone(){const e=(0,o.shallowCloneOf)(this)
return e._cursor=this._cursor.clone(),e}static optimizeIterationUpToDepth(e){for(let t=0;t<e;t+=1)u._recycle(new u(void 0))}static _clone(e){const t=l.get(e.constructor)
if((0,r.isSome)(t)){const n=t.pop()
if((0,r.isSome)(n))return n.onReuseToIterate(e),n}return e.clone()}onReuseToIterate(e){const t=e._cursor
this._cursor.reuse(t.currentValue,t.currentKeyPath)}static _recycle(e){const t=e.constructor,n=l.get(t)
if((0,r.isSome)(n)){if(n.length>=5)return
e.onRecycleForIteration(),n.push(e)}else e.onRecycleForIteration(),l.set(t,[e])}onRecycleForIteration(){this._cursor.reuse(void 0)}}t.ObjectReader=u},7454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverse=void 0
const r=n(2450),o=n(2506)
t.traverse=function(e,t){if("object"!=typeof e)return e
if(!(0,r.isSome)(e))return e
const n=(0,o.keysOf)(t)
switch(n.length){case 0:return e
case 1:return e[n[0]]
default:let t=e
for(const e of n){const n=t[e]
if("object"!=typeof n)return n
if(!(0,r.isSome)(n))return n
t=n}return t}}},4172:(e,t,n)=>{function r(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function o(e,t,n,o){u({type:"badType",expected:t,actual:`${r(n)} (${n})`,objectPath:(0,d.isSome)(o)&&o.length>0?o:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}function i(e){return!(0,d.isNothing)(e)&&(Object.prototype.hasOwnProperty.call(e,"$incidents")||Object.isExtensible(e))}function s(e){f.nameStack.push(e)}function a(){return 0===f.nameStack.length?["<empty stack>"]:f.nameStack.slice(0)}function c(){f.nameStack.length,f.nameStack.pop()}function l(e,t,n){let r,i=null;(0,d.isSome)(n)&&n.length>0&&(i=e,f.suppressedIncidentPaths.push(n))
try{s(e),r=t()}catch(e){throw e.hasThrown||(o("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===i&&f.suppressedIncidentPaths.pop(),c()}return r}function u(e){f.suppressedIncidentPaths.includes(e.objectPath)||f.incidents.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unexpectedNull=t.catchingContext=t.context=t.recordValidationIncidents=t.endContext=t.getContextNames=t.beginContext=t.messageForRecoveryAction=t.isValidatable=t.unexpectedType=t.extendedTypeof=void 0
const d=n(2450)
t.extendedTypeof=r,t.unexpectedType=o,t.isValidatable=i,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format"
case"defaultValue":return"Default value used"
case"ignoredValue":return"Ignored value"
default:return"Unknown"}}
const f={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()}
t.beginContext=s,t.getContextNames=a,t.endContext=c,t.recordValidationIncidents=function(e){i(e)&&(e.$incidents=f.incidents),f.incidents=[],f.nameStack=[],f.suppressedIncidentPaths=[]},t.context=l,t.catchingContext=function(e,t,n){let r=null
try{r=l(e,t)}catch(e){r=null,(0,d.isSome)(n)&&(r=n(e))}return r},t.unexpectedNull=function(e,t,n){u({type:"nullValue",expected:t,actual:"null",objectPath:(0,d.isSome)(n)&&n.length>0?n:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}},3647:(e,t,n)=>{function r(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function o(e,t){return r("back","button",{...e,actionType:"back"},t)}function i(e,t,n){const r=f.MetricsEventType.page
return u({...e,eventType:r,...t},n,r)}function s(e,t,n,r,o,i){const s=f.MetricsEventType.search,a={...o,eventType:s,term:e,targetType:t,actionType:n}
return(0,h.isSome)(r)&&(a.actionUrl=r),u(a,i,s)}function a(e,t,n=4){const r=f.MetricsEventType.impressions
return u({...e,eventType:r,impressionQueue:"data-metrics",eventVersion:n},t,r)}function c(e,t){const n=f.MetricsEventType.media
return u({...e,eventType:n},t,n)}function l(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function u(e,t,n){return{fields:e,includingFields:t.defaultIncludeRequests[n],excludingFields:t.defaultExcludeRequests[n],topic:d(e,t.defaultTopic),shouldFlush:!!(0,h.isSome)(t.shouldFlush)&&t.shouldFlush(e)}}function d(e,t){const n=e.topic
return(0,h.isSome)(n)?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.createMetricsMediaClickData=t.createMetricsMediaData=t.createMetricsImpressionsData=t.createMetricsSearchData=t.createMetricsPageData=t.createMetricsBackClickData=t.createMetricsClickData=t.MediaClickEventBuilder=t.MediaEventBuilder=t.ImpressionsEventBuilder=t.SearchEventBuilder=t.PageEventBuilder=t.BackClickEventBuilder=t.ClickEventBuilder=t.EventBuilder=void 0
const f=n(447),h=n(2450)
class p{constructor(e){this.configuration=e,this.eventFields={}}withEventFields(e){return this.eventFields=e,this}withConfiguration(e){return this.configuration=e,this}withDefaultTopic(e){return this.configuration={...this.configuration,defaultTopic:e},this}withDefaultIncludeRequests(e){return this.configuration={...this.configuration,defaultIncludeRequests:e},this}withDefaultExcludeRequests(e){return this.configuration={...this.configuration,defaultExcludeRequests:e},this}withShouldFlush(e){return this.configuration={...this.configuration,shouldFlush:e},this}}t.EventBuilder=p,t.ClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return r(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.BackClickEventBuilder=class extends p{build(){return o(this.eventFields,this.configuration)}},t.PageEventBuilder=class extends p{constructor(e){super(e),this.timingMetrics={}}withTimingMetrics(e){return this.timingMetrics=e,this}build(){return i(this.eventFields,this.timingMetrics,this.configuration)}},t.SearchEventBuilder=class extends p{constructor(e){super(e.configuration),this.term=e.term,this.targetType=e.targetType,this.actionType=e.actionType,this.actionUrl=null}withTerm(e){return this.term=e,this}withTargetType(e){return this.targetType=e,this}withActionType(e){return this.actionType=e,this}withActionUrl(e){return this.actionUrl=e,this}build(){return s(this.term,this.targetType,this.actionType,this.actionUrl,this.eventFields,this.configuration)}},t.ImpressionsEventBuilder=class extends p{constructor(){super(...arguments),this.impressionsEventVersion=4}withImpressionsEventVersion(e){return this.impressionsEventVersion=e,this}build(){return a(this.eventFields,this.configuration,this.impressionsEventVersion)}},t.MediaEventBuilder=class extends p{build(){return c(this.eventFields,this.configuration)}},t.MediaClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return l(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.createMetricsClickData=r,t.createMetricsBackClickData=o,t.createMetricsPageData=i,t.createMetricsSearchData=s,t.createMetricsImpressionsData=a,t.createMetricsMediaData=c,t.createMetricsMediaClickData=l},4927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cookieValueForKey=t.cookiesOf=void 0
const r=n(2450)
t.cookiesOf=function*(e){if((0,r.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}},t.cookieValueForKey=function(e,t){for(const n of e)if(n.key===t)return n.value
return null}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLinter=void 0
const r=n(4409),o=n(447),i=n(2450),s=n(7771)
t.EventLinter=class{constructor(e){this.options=Object.freeze(e)}get defaultTopic(){return this.options.defaultTopic}applyDeResolutionRules(e,t){const n=new r.ObjectReader(e)
for(const r of t){const t=n.asNumber(r.fieldName)
if((0,i.isNothing)(t))continue
let o=r.magnitude;(0,i.isNothing)(o)&&(o=1048576)
let a=r.significantDigits
if((0,i.isNothing)(a)&&(a=2),o<=0||a<0){e[r.fieldName]=Number.NaN
continue}const c=t/o
e[r.fieldName]=s.reduceSignificantDigits(c,a)}}decorateCommonEventFields(e,t){const n=new r.ObjectReader(e),o=this.options.configuration,s=o.baseFields(t);(0,i.isSome)(s)&&Object.assign(e,s),e.clientBuildType=this.options.environment.buildType,e.resourceRevNum=this.options.environment.jsVersion,e.xpSendMethod="jet-js"
const a=n.asString("pageType"),c=n.asString("pageId")
if((0,i.isSome)(a)&&(0,i.isSome)(c)&&(0,i.isNothing)(e.page)){const n=o.compoundSeparator(t),r=(0,i.isSome)(n)?(0,i.unwrapOptional)(n):"_"
e.page=`${a}${r}${c}`}const l=o.deResolutionRules(t)
this.applyDeResolutionRules(e,l)}decorateMediaEventEvents(e){const t=new r.ObjectReader(e).asNumber("position");(0,i.isSome)(t)&&(e.position=Math.round(t))}lint(e,t={}){const n=new r.ObjectReader(e),s=n.asString("eventType")
this.options.isLoggingEnabled
const a=JSON.parse(JSON.stringify(e)),c=n.asString("topic"),l=(0,i.isSome)(c)?(0,i.unwrapOptional)(c):this.options.defaultTopic
this.decorateCommonEventFields(a,l),s===o.MetricsEventType.media&&this.decorateMediaEventEvents(a)
for(const e of this.options.rules)e.apply(a,t)
return{fields:a}}}},8836:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTimingMetricsBuilderType=t.FetchTimingMetricsBuilder=void 0
const r=n(2450),o=n(900),i=n(2366)
t.FetchTimingMetricsBuilder=class{constructor(){this.metrics=[]}measureParsing(e,t){const n=e.metrics.length>0?[...e.metrics]:[],r=Date.now(),o=t(e),i=Date.now()
return n.length>0&&(n[0].parseStartTime=r,n[0].parseEndTime=i),this.metrics.push(...n),o}measureModelConstruction(e){const t=Date.now(),n=e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}async measureModelConstructionAsync(e){const t=Date.now(),n=await e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}saveModelConstructionTimes(e,t){this.metrics.length>0?(this.metrics[0].modelConstructionStartTime=e,this.metrics[0].modelConstructionEndTime=t):this.metrics.push({modelConstructionStartTime:e,modelConstructionEndTime:t})}decorate(e){if((0,r.isNothing)(e))throw new Error("Cannot decorate null or undefined")
if("object"!=typeof e)throw new Error("View model to decorate must be an object")
if((0,i.isPromise)(e))throw new Error("Cannot decorate a Promise object")
this.metrics.length>0&&(e.$networkPerformance=this.metrics)}},t.fetchTimingMetricsBuilderType=(0,o.makeMetatype)("jet-engine:fetchTimingMetricsBuilder")},8267:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7581),t),o(n(7764),t),o(n(7771),t),o(n(4698),t)},7581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsLocationTracker=void 0
const r=n(4172),o=n(2450),i=n(4698)
class s{constructor(e=0,t=[]){this.rootPosition=e,this.locationStack=t.map(e=>new a(e))}get isEmpty(){return 0===this.locationStack.length}pushLocation(e){this.locationStack.push(new a(e))}popLocation(){var e
return 0===this.locationStack.length?(r.unexpectedType("ignoredValue","non-empty location stack","empty location stack"),null):null===(e=this.locationStack.pop())||void 0===e?void 0:e.location}get currentPosition(){const e=this.lastStackItem
return(0,o.isSome)(e)?e.position:this.rootPosition}setCurrentPosition(e){const t=this.lastStackItem;(0,o.isSome)(t)?t.position=e:this.rootPosition=e}nextPosition(){const e=this.lastStackItem;(0,o.isSome)(e)?e.position+=1:this.rootPosition+=1}get stackItemsToLocations(){return this.locationStack.map(e=>e.location)}get lastStackItem(){const e=this.locationStack.length
return 0===e?null:this.locationStack[e-1]}static locationsByAddingBasicLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildBasicLocation(e,t)),n}static locationsByAddingContentLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildContentLocation(e,t)),n}static pushBasicLocation(e,t){e.locationTracker.pushLocation(s.buildBasicLocation(e,t))}static pushContentLocation(e,t){e.locationTracker.pushLocation(s.buildContentLocation(e,t))}static popLocation(e){return e.locationTracker.popLocation()}static buildBasicLocation(e,t){let n=t;(0,o.isSome)(e.anonymizationOptions)&&(n=e.anonymizationOptions.anonymizationString)
const r={locationPosition:e.locationTracker.currentPosition,locationType:i.targetTypeForMetricsOptions(e),name:n}
return(0,o.isSome)(e.recoMetricsData)&&Object.assign(r,e.recoMetricsData),r}static buildContentLocation(e,t){const n=s.buildBasicLocation(e,t)
if((0,o.isNothing)(e.id))n.idType="sequential",n.id=e.locationTracker.currentPosition.toString()
else{n.idType=i.idTypeForMetricsOptions(e)
let t=e.id;(0,o.isSome)(e.anonymizationOptions)&&(t=e.anonymizationOptions.anonymizationString),n.id=t}return(0,o.isSome)(e.fcKind)&&(n.fcKind=e.fcKind),(0,o.isSome)(e.displayStyle)&&(n.displayStyle=e.displayStyle),n}}t.MetricsLocationTracker=s
class a{constructor(e,t=0){this.location=e,this.position=t}}},7764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSignificantDigits=void 0,t.reduceSignificantDigits=function(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}},4698:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchTermFromRefURL=t.extractSiriRefAppFromRefURL=t.idTypeForMetricsOptions=t.targetTypeForMetricsOptions=void 0
const r=n(2450),o=n(1974)
t.targetTypeForMetricsOptions=function(e){let t=e.targetType
return(0,r.isNothing)(t)&&(t="lockup"),t},t.idTypeForMetricsOptions=function(e){let t=e.idType
return(0,r.isNothing)(t)&&(t="its_id"),t},t.extractSiriRefAppFromRefURL=function(e){const t=new o.URL(e)
if((0,r.isNothing)(t.query))return null
let n=null
for(const e of Object.keys(t.query))if("referrer"===e){"siri"===t.query[e]&&(n="com.apple.siri")
break}return n},t.searchTermFromRefURL=function(e){const t=new o.URL(e),n=t.query
if((0,r.isNothing)(n))return null
const i=n.term,s=t.pathname
return(0,r.isNothing)(i)||(0,r.isNothing)(s)?null:s.endsWith("/search")?i:null}},1415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3647),t),o(n(4927),t),o(n(8535),t),o(n(8836),t),o(n(8267),t),o(n(6094),t)},6094:(e,t,n)=>{function r(e,t){const n=e.optional(a.fetchTimingMetricsBuilderType)
if((0,s.isSome)(n))return e
if(t)throw new Error("Could not find FetchTimingMetricsBuilder in the object graph")
return e.adding(a.fetchTimingMetricsBuilderType,new a.FetchTimingMetricsBuilder)}async function o(e,t,n){const r=(0,i.inject)(a.fetchTimingMetricsBuilderType,t),o=await r.measureModelConstructionAsync(async()=>{const r=n(e,t)
return await Promise.resolve(r)})
if((0,s.isNothing)(o))throw new Error("model builder function returned null or undefined")
return r.decorate(o),o}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndBuildModel=t.requestAndBuildModel=void 0
const i=n(9100),s=n(2450),a=n(8836)
t.requestAndBuildModel=async function(e,t,n,i){const s=r(t,!0),a=await n(e,s)
return await o(a,s,i)},t.parseAndBuildModel=async function(e,t,n,c){const l=r(t,!1),u=(0,i.inject)(a.fetchTimingMetricsBuilderType,l).measureParsing(e,()=>n(e,l))
if((0,s.isNothing)(u))throw new Error("parser function returned null or undefined")
return await o(u,l,c)}},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompoundAction=t.isCompoundAction=void 0,t.isCompoundAction=function(e){return"compoundAction"===(null==e?void 0:e.$kind)},t.makeCompoundAction=function(e,t){return{$kind:"compoundAction",subactions:t,actionMetrics:e}}},9120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyAction=t.isEmptyAction=void 0,t.isEmptyAction=function(e){return"emptyAction"===(null==e?void 0:e.$kind)},t.makeEmptyAction=function(e){return{$kind:"emptyAction",actionMetrics:e}}},9634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4789),t),o(n(573),t),o(n(9120),t),o(n(9634),t),o(n(5599),t),o(n(2170),t),o(n(6158),t),o(n(9400),t),o(n(4362),t)},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeArtworkURLTemplate=void 0
const r=n(4172),o=n(2450),i=n(1974),s=new RegExp("^({w}|[0-9]+(?:.[0-9]*)?)x({h}|[0-9]+(?:.[0-9]*)?)({c}|[a-z]{2}).({f}|[a-z]+)$")
t.makeArtworkURLTemplate=function(e){if(void 0===new i.URL(e).pathname)return r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid URL string",e)}),null
const t=e.substring(e.lastIndexOf("/")+1),n=s.exec(t)
return(0,o.isNothing)(n)||5!==n.length?(r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid artwork URL template ending with {w}x{h}{c}.{f} format",t)}),null):e}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areEqual=t.luminanceFrom=t.dynamicWith=t.named=t.rgbWith=t.htmlWith=t.Color=void 0
const r=n(2450)
t.Color={fromHex:e=>(0,r.isNothing)(e)?null:{$kind:"html",value:e},fromRGB:(e,t,n,r=1)=>({$kind:"rgb",red:e,green:t,blue:n,alpha:r}),named:e=>({$kind:"named",name:e}),dynamicWith:(e,t,n,r)=>({$kind:"dynamic",lightColor:e,lightHighContrastColor:t,darkColor:n,darkHighContrastColor:r}),luminanceFrom:e=>.2126*e.red+.7152*e.green+.0722*e.blue,areEqual(e,n){if((0,r.isNothing)(e))return(0,r.isNothing)(n)
if((0,r.isNothing)(n))return(0,r.isNothing)(e)
const o=e.$kind,i=n.$kind
if("named"===o&&"named"===i){const t=n
return e.name===t.name}if("rgb"===o&&"rgb"===i){const t=e,r=n
return t.red===r.red&&t.green===r.green&&t.blue===r.blue&&t.alpha===r.alpha}if("dynamic"===o&&"dynamic"===i){const r=e,o=n
return t.Color.areEqual(r.lightColor,o.lightColor)&&t.Color.areEqual(r.lightHighContrastColor,o.lightHighContrastColor)&&t.Color.areEqual(r.darkColor,o.darkColor)&&t.Color.areEqual(r.darkHighContrastColor,o.darkHighContrastColor)}return!1}}
const o=t.Color.fromHex
t.htmlWith=o
const i=t.Color.fromRGB
t.rgbWith=i
const s=t.Color.named
t.named=s
const a=t.Color.dynamicWith
t.dynamicWith=a
const c=t.Color.luminanceFrom
t.luminanceFrom=c
const l=t.Color.areEqual
t.areEqual=l},5827:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1235),t),o(n(998),t),o(n(7615),t),o(n(6301),t),o(n(8681),t),o(n(9184),t),o(n(7129),t),o(n(2359),t)},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.menuSeparatorID=void 0,t.menuSeparatorID="com.apple.JetEngine.separator"},9184:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6882:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportBootstrap=void 0
const r=n(6451)
t.exportBootstrap=function(e){"undefined"!=typeof $exportBootstrap&&$exportBootstrap(t=>(function(e){const t=e.$lazyDependencyNames,n=new Set(null!=t?t:[]),o=globalThis.$lazyGlobalNames,i=new Set(null!=o?o:[]),s=new Set([...n,...i]),a=new Map,c=globalThis.$lazyProvider
for(const e of s)a.set(e,r.LazyProxyFactory.makeProxy(e,c))
for(const t of n)e[t]=a.get(t)
for(const e of i)globalThis[e]=a.get(e)}(t),e(t)))},globalThis.has_lazy_support=!0},8706:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6882),t),o(n(4816),t)},4816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyRuntime=t.Runtime=void 0
const n="function"==typeof exportService
class r{constructor(e,t){this.dispatcher=e,this.objectGraph=t}async dispatch(e){return await this.dispatcher.dispatch(e,this.objectGraph)}}t.Runtime=r,t.LegacyRuntime=class extends r{constructor(e,t,n){super(e,t),this.services=n}serviceWithName(e){return this.services[e]}exportingService(e,t){return n&&function(e,t){exportService(e,t)}(e,t),this.services[e]=t,this}}},1219:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof preprocessor&&(globalThis.preprocessor={PRODUCTION_BUILD:!1,CARRY_BUILD:!1,DEBUG_BUILD:!1,INTERNAL_BUILD:!1}),"undefined"==typeof testContent&&(globalThis.testContent={INCLUDE_TEST_CONTENT:!1}),o(n(1219),t),o(n(8045),t),o(n(3922),t),o(n(9891),t),o(n(1121),t),o(n(9247),t),o(n(3907),t),o(n(6534),t),o(n(5817),t),o(n(3043),t),o(n(5037),t),o(n(5937),t),o(n(1222),t)},9247:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3907:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxiedNetwork=void 0,t.ProxiedNetwork=class{constructor(e,t){this.original=e,this.pageIntentInstrumentation=t}async fetch(e){return e.$pageIntentInstrumentation=this.pageIntentInstrumentation,await this.original.fetch(e)}}},6534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.services=t.random=t.plist=t.platform=t.net=t.localizer=t.host=t.cryptography=t.cookieProvider=t.bundle=t.bag=void 0
const r=n(900)
t.bag=(0,r.makeMetatype)("jet-engine:bag"),t.bundle=(0,r.makeMetatype)("jet-engine:bundle"),t.cookieProvider=(0,r.makeMetatype)("jet-engine:cookieProvider"),t.cryptography=(0,r.makeMetatype)("jet-engine:cryptography"),t.host=(0,r.makeMetatype)("jet-engine:host"),t.localizer=(0,r.makeMetatype)("jet-engine:localizer"),t.net=(0,r.makeMetatype)("jet-engine:net"),t.platform=(0,r.makeMetatype)("jet-engine:platform"),t.plist=(0,r.makeMetatype)("jet-engine:plist"),t.random=(0,r.makeMetatype)("jet-engine:random"),t.services=(0,r.makeMetatype)("jet-engine:services")},8037:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1721),t),o(n(9031),t),o(n(447),t),o(n(2024),t),o(n(2450),t)},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9031:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2490),t)},447:(e,t)=>{var n,r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.notInstrumented=t.NotInstrumentedMetricsType=t.MetricsEventType=t.PageInvocationPoint=t.EMPTY_LINTED_METRICS_EVENT=void 0,t.EMPTY_LINTED_METRICS_EVENT={fields:{},issues:[]},(o=t.PageInvocationPoint||(t.PageInvocationPoint={})).pageEnter="pageEnter",o.pageExit="pageExit",o.appExit="appExit",o.appEnter="appEnter",o.backButton="backButton",(r=t.MetricsEventType||(t.MetricsEventType={})).click="click",r.page="page",r.search="search",r.impressions="impressions",r.media="media",r.pageRender="pageRender",function(e){e[e.ActionMetrics=0]="ActionMetrics",e[e.FetchTimingMetrics=1]="FetchTimingMetrics",e[e.PageMetrics=2]="PageMetrics",e[e.ImpressionMetrics=3]="ImpressionMetrics"}(n=t.NotInstrumentedMetricsType||(t.NotInstrumentedMetricsType={})),t.notInstrumented=function(e){switch(e){case n.ActionMetrics:return{data:[],custom:{}}
case n.FetchTimingMetrics:return{}
case n.PageMetrics:return{instructions:[],custom:{}}
case n.ImpressionMetrics:return{id:{id:"",impressionIndex:-1},fields:{},custom:{}}
default:return{}}}},2024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2450:(e,t)=>{function n(e){return null==e}function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.flatMapOptional=t.mapOptional=t.unsafeUnwrapOptional=t.unwrapOptional=t.isSome=t.isNothing=t.unsafeUninitialized=void 0,t.unsafeUninitialized=function(){},t.isNothing=n,t.isSome=r,t.unwrapOptional=function(e){if(n(e))throw new ReferenceError
return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return r(e)?t(e):e},t.flatMapOptional=function(e,t){return r(e)?t(e):e}},2879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shallowCloneOf=void 0,t.shallowCloneOf=function(e){const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e)}},6151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0,t.ExpiringValue=class{constructor(e,t){this._value=e,this._maxAge=t}isValid(){return Date.now()<this._maxAge}get value(){return this.isValid()?this._value:null}}},7312:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2879),t),o(n(6151),t),o(n(900),t),o(n(2366),t),o(n(4805),t),o(n(3087),t),o(n(1974),t)},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMetatype=void 0,t.makeMetatype=function(e){return{name:e}}},2366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0,t.isPromise=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}},4805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RewindableValue=void 0
const r=n(2879)
t.RewindableValue=class{constructor(e){this._values=[e]}get(){return this._values[this._values.length-1]}set(e){this._values[this._values.length-1]=e}save(){this._values.push(this._values[this._values.length-1])}restore(){if(1===this._values.length)throw new RangeError("Calls to restore must balance previous calls to save")
this._values.pop()}clone(){const e=(0,r.shallowCloneOf)(this)
return e._values=this._values.slice(),e}}},3087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.difference=t.symmetricDifference=t.intersection=t.union=t.isSuperset=void 0,t.isSuperset=function(e,t){for(const n of t)if(!e.has(n))return!1
return!0},t.union=function(e,t){const n=new Set(e)
for(const e of t)n.add(e)
return n},t.intersection=function(e,t){const n=new Set
for(const r of t)e.has(r)&&n.add(r)
return n},t.symmetricDifference=function(e,t){const n=new Set(e)
for(const e of t)n.has(e)?n.delete(e):n.add(e)
return n},t.difference=function(e,t){const n=new Set(e)
for(const e of t)n.delete(e)
return n}},1974:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.QueryHandling=void 0
const o=n(2450),i=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,s=/([^=?&]+)=?([^&]*)/g,a=["hash","query","pathname","host"]
var c
!function(e){e.FORM_ENCODED="form-encoded",e.RFC3986="rfc3986"}(c=t.QueryHandling||(t.QueryHandling={}))
class l{constructor(e,t){var n
if(this.query={},this.queryHandling=null==t?void 0:t.queryHandling,(0,o.isNothing)(e))return
let s=e
const c=i.exec(e)
if((0,o.isSome)(c)){let e=c[1]
null!=e&&(e=e.split(":")[0]),this.protocol=null!=e?e:void 0,s=null!==(n=c[3])&&void 0!==n?n:void 0}let u={remainder:s,result:void 0}
for(const e of a){if(void 0===u||void 0===u.remainder)break
switch(e){case"hash":u=r(u.remainder,"#","suffix"),this.hash=null==u?void 0:u.result
break
case"query":u=r(u.remainder,"?","suffix"),void 0!==(null==u?void 0:u.result)&&(this.query=l.queryFromString(u.result,this.queryHandling))
break
case"pathname":u=r(u.remainder,"/","suffix"),void 0!==(null==u?void 0:u.result)&&(this.pathname="/"+u.result)
break
case"host":{const e=r(u.remainder,"@","prefix"),t=null==e?void 0:e.result,n=null==e?void 0:e.remainder
if(void 0!==t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(void 0!==n){const e=n.split(":")
this.host=e[0],this.port=e[1]}break}default:throw new Error("Unhandled case!")}}}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}set(e,t){if(void 0===t)return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}append(e,t){let n,r=this.get(e)
if("query"===e)void 0===r&&(r={}),"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),n="string"==typeof r?{existingValue:r,...t}:{...r,...t}
else{void 0===r&&(r="")
let o=r
void 0===o&&(o="")
let i=o
if("pathname"===e){const e=o.length
0!==e&&"/"===o[e-1]||(i+="/")}i+=t,n=i}return this.set(e,n)}param(e,t){return null===e||(void 0===this.query&&(this.query={}),void 0===t?delete this.query[e]:this.query[e]=t),this}removeParam(e){return void 0===e||void 0===this.query||e in this.query&&delete this.query[e],this}path(e){return this.append("pathname",e)}pathExtension(){var e,t
if(void 0===this.pathname)return
const n=null!==(t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split("."))&&void 0!==t?t:[]
return n.filter(function(e){return""!==e}).length<2?void 0:n.pop()}pathComponents(){return void 0===this.pathname?[]:this.pathname.split("/").filter(e=>e.length>0)}build(){return this.toString()}toString(){let e=""
return void 0!==this.protocol&&(e+=this.protocol+"://"),void 0!==this.username&&(e+=encodeURIComponent(this.username),void 0!==this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),void 0!==this.host&&(e+=this.host,void 0!==this.port&&(e+=":"+this.port)),void 0!==this.pathname&&(e+=this.pathname),void 0!==this.query&&0!==Object.keys(this.query).length&&(e+="?"+l.toQueryString(this.query,this.queryHandling)),void 0!==this.hash&&(e+="#"+this.hash),e}static queryFromString(e,t=c.FORM_ENCODED){const n={}
let r=s.exec(e)
for(;null!==r&&r.length>=3;){let o=r[1],i=r[2]
t===c.FORM_ENCODED&&(o=o.replace(/\+/g," "),i=i.replace(/\+/g," "))
const a=decodeURIComponent(o),l=decodeURIComponent(i)
n[a]=l,r=s.exec(e)}return n}static toQueryString(e,t=c.RFC3986){let n="",r=!0
for(const o of Object.keys(e)){r||(n+="&"),r=!1,n+=l.encodeQueryComponent(o,t)
const i=e[o]
null!==i&&i.length>0&&(n+="="+l.encodeQueryComponent(i,t))}return n}static encodeQueryComponent(e,t){return t===c.FORM_ENCODED?encodeURIComponent(e).replace(/%20/g,"+"):encodeURIComponent(e)}static from(e){return new l(e)}static fromComponents(e,t,n,r,o,i){const s=new l(void 0,i)
return s.protocol=e,s.host=t,s.pathname=n,s.query=null!=r?r:{},s.hash=o,s}}t.URL=l},4592:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAugmentedData=void 0
const s=i(n(8156))
t.fetchAugmentedData=async function(e,t,n,r,o){const i=n(e,t,o)
if(null==i)return await Promise.resolve({originalData:t,additionalData:null})
const a=Array.from(i),c=[]
for(const t of a){const n=r(e,t)
if(s.isNull(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}},4876:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6297),t),o(n(4592),t),o(n(2299),t),o(n(2930),t),o(n(7582),t),o(n(2390),t),o(n(8097),t)},9846:function(e,t,n){function r(e,t,n){return h.isNull(e)?null:h.asDictionary(e.attributes,t,n)}function o(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.attributes,t,n)}function i(e,t,n="coercible"){if(h.isNull(e))return null
const r=h.asString(e.attributes,t,n)
return(0,f.isNothing)(r)?null:new Date(r)}function s(e){return!h.isNull(h.asDictionary(e,"attributes"))}function a(e){const t=h.asDictionary(e,"meta")
if((0,f.isNothing)(t))throw new p.MissingFieldError(e,"meta")
return t}function c(e,t){let n
return n=Array.isArray(e)?e:[e],Array.isArray(t)?n.push(...t):n.push(t),n}var l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n)
return u(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.concatObjectPaths=t.requiredMetaAttributeAsNumber=t.requiredMetaAttributeAsString=t.requiredMeta=t.requiredAttributeAsDictionary=t.requiredAttributeAsDate=t.requiredAttributeAsString=t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=t.attributeKeyAsCustomAttributeKey=t.isNotHydrated=t.hasAttributes=t.attributeAsNumber=t.attributeAsBooleanOrFalse=t.attributeAsBoolean=t.attributeAsDate=t.metaAsString=t.attributeAsString=t.attributeAsArrayOrEmpty=t.attributeAsInterface=t.attributeAsDictionary=void 0
const f=n(2450),h=d(n(8156)),p=d(n(8747))
t.attributeAsDictionary=r,t.attributeAsInterface=function(e,t,n){return r(e,t,n)},t.attributeAsArrayOrEmpty=function(e,t){return h.isNull(e)?[]:h.asArrayOrEmpty(e.attributes,t)},t.attributeAsString=o,t.metaAsString=function(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.meta,t,n)},t.attributeAsDate=i,t.attributeAsBoolean=function(e,t,n="coercible"){return h.isNull(e)?null:h.asBoolean(e.attributes,t,n)},t.attributeAsBooleanOrFalse=function(e,t){return!h.isNull(e)&&h.asBooleanOrFalse(e.attributes,t)},t.attributeAsNumber=function(e,t,n="coercible"){return h.isNull(e)?null:h.asNumber(e.attributes,t,n)},t.hasAttributes=s,t.isNotHydrated=function(e){return!s(e)},t.attributeKeyAsCustomAttributeKey=function(e){return w[e]},t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=function(e){return"customArtwork"===e||"customIconArtwork"===e}
const w={artwork:"customArtwork",iconArtwork:"customIconArtwork",screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:"customScreenshotsByTypeForAd",customVideoPreviewsByTypeForAd:"customVideoPreviewsByTypeForAd"}
t.requiredAttributeAsString=function(e,t){const n=o(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDate=function(e,t){const n=i(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDictionary=function(e,t){const n=r(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredMeta=a,t.requiredMetaAttributeAsString=function(e,t){const n=a(e),r=h.asString(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.requiredMetaAttributeAsNumber=function(e,t){const n=a(e),r=h.asNumber(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.concatObjectPaths=c},3389:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.BagWrapper=void 0
const s=n(5542),a=i(n(1222)),c=n(8156)
t.BagWrapper=class{constructor(e){this.bag=e.required(a.bag)}get language(){return this.bag.string("language")}get mediaCountryCode(){return this.bag.string("countryCode")}get mediaHost(){return this.bag.url("apps-media-api-host")}get mediaPreviewHost(){return this.bag.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.bag.string("notification-settings-media-api-host")}get mediaApiLanguage(){const e=this.bag.string("language-tag")
return(0,s.isSome)(e)?e:this.bag.string("language")}get edgeEndpoints(){const e=this.bag.array("apps-media-api-edge-end-points")
return void 0===e?[]:(0,c.asArrayOrEmpty)((0,c.asJSONValue)(e))}get mediaEdgeSearchHost(){return this.bag.string("apps-media-api-search-edge-host")}get redirectUrlWhitelistedQueryParams(){let e=(0,c.asArrayOrEmpty)((0,c.asJSONValue)(this.bag.array("processRedirectUrl/whitelistedQueryParams")))
return(0,c.isNullOrEmpty)(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e}}},1031:function(e,t,n){function r(e){return c.isDefinedNonNull(e.attributes)}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.metricsFromMediaApiObject=t.dataCollectionFromResultsListContainer=t.isDataCollectionPartiallyHydrated=t.isDataCollectionHydrated=t.isDataHydrated=t.dataCollectionFromDataContainer=t.dataFromDataContainer=t.requiredStringID=void 0
const a=n(2450),c=s(n(8156))
n(2930),t.requiredStringID=function(e){const t=c.asString(e,"id")
if((0,a.isNothing)(t))throw new Error(`Data.id '${e.id}' is not a string.`)
return t},t.dataFromDataContainer=function(e){const t=c.asArrayOrEmpty(e,"data")
return t.length,1!==t.length?null:t[0]},t.dataCollectionFromDataContainer=function(e){return c.asArrayOrEmpty(e,"data")},t.isDataHydrated=r,t.isDataCollectionHydrated=function(e){for(let t=e.length-1;t>=0;t-=1)if(!r(e[t]))return!1
return!0},t.isDataCollectionPartiallyHydrated=function(e){for(const t of e)if(r(t))return!0
return!1},t.dataCollectionFromResultsListContainer=function(e){return c.asArrayOrEmpty(e,"results.contents")},t.metricsFromMediaApiObject=function(e){return c.asDictionary(e,"meta.metrics")}},8747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MissingFieldError=void 0
class n extends Error{constructor(e,t){super(),this.dataId=e.id,this.dataType=e.type,this.attributePath=t}}t.MissingFieldError=n},6297:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9846),t),o(n(3389),t),o(n(1031),t),o(n(3734),t),o(n(3665),t),o(n(2299),t),o(n(8156),t),o(n(4029),t),o(n(8747),t)},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2299:function(e,t,n){function r(e){switch(host.platform){case"iOS":return"iPad"===host.deviceModelFamily?"ipad":"iphone"
case"macOS":return"mac"
case"tvOS":return"appletv"
case"watchOS":return"watch"
case"xrOS":return"realityDevice"
default:return null}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.defaultPlatformForClient=void 0
const a=s(n(8156))
t.defaultPlatformForClient=r,t.Request=class{constructor(e,t){if(this.contentsResourceTypes=new Set,this.ids=new Set,this.seeds=new Set,this.relationshipIncludes=new Set,this.relationshipIncludesOnly=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.shouldOmitAutomaticRelationship=!1,this.objectGraph=e,this.platform=r(),!a.isNullOrEmpty(t))if("string"==typeof t)this.href=t
else if(Array.isArray(t)){const e=new Set
for(const n of t)e.add(n.type),this.ids.add(n.id)
1===e.size?this.resourceType=e.values().next().value:e.size>1&&(this.resourceType="contents",this.contentsResourceTypes=e)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.ids.add(t)
return this}withSeeds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.seeds.add(t)
return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingOnlyRelationships(e){for(const t of e)this.relationshipIncludesOnly.add(t)
return this}includingScopedRelationships(e,t){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){null==this.metaIncludes&&(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingAssociateKeys(e,t){null==this.associateIncludes&&(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t="marketing-items"
if(e){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get("editorial-items")
null==e&&(e=new Set),e.add(t),this.scopedRelationshipIncludes.set("editorial-items",e)}else this.relationshipIncludes.add(t)
{null==this.metaIncludes&&(this.metaIncludes=new Map)
let e=this.metaIncludes.get("marketing-items")
null==e&&(e=new Set),e.add("metrics"),this.metaIncludes.set("marketing-items",e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){null==this.scopedAttributeIncludes&&(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){null==this.scopedAvailableInIncludes&&(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return null==this.scopedSparseLimit&&(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}format(e){return this.responseFormat=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!a.isDefinedNonNull(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}}},8156:function(e,t,n){function r(e){return i(e)?null:Array.isArray(e)?e.join("."):e}function o(e,t,n){if(null==e)return n
if(s(t))return e
let r
if("string"==typeof t){if(r=w[t],s(r)){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),w[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function i(e){return null==e}function s(e){return i(e)||0===Object.keys(e).length}function a(e){return null!=e}function c(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return s
if("string"==typeof s)return s
{const e="object"==typeof s?null:String(s)
switch(n){case"strict":h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})
break
case"coercible":i(e)&&h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})}return e}}function l(e,t,n){const s=o(e,t,null)
return s instanceof Object&&!Array.isArray(s)?s:(i(s)||h.context("asDictionary",()=>{h.unexpectedType("defaultValue","object",s,r(t))}),a(n)?n:null)}var u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n)
return d(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.asJSONData=t.asJSONValue=t.asBoolean=t.asInterface=t.asDictionary=t.asNumber=t.asDate=t.asString=t.asBooleanOrFalse=t.asArrayOrEmpty=t.isArrayDefinedNonNullAndEmpty=t.isNumber=t.isDefinedNonNullNonEmpty=t.isDefinedNonNull=t.isNullOrEmpty=t.isNull=t.traverse=t.objectPathToString=void 0
const h=f(n(4172)),p=n(2450)
t.objectPathToString=r
const w={}
t.traverse=o,t.isNull=i,t.isNullOrEmpty=s,t.isDefinedNonNull=a,t.isDefinedNonNullNonEmpty=function(e){return a(e)&&0!==Object.keys(e).length},t.isNumber=function(e){if(i(e))return!1
let t
return t="string"==typeof e?parseInt(e):e,!Number.isNaN(t)},t.isArrayDefinedNonNullAndEmpty=function(e){return a(e)&&0===e.length},t.asArrayOrEmpty=function(e,t){const n=o(e,t,null)
return Array.isArray(n)?n:(i(n)||h.context("asArrayOrEmpty",()=>{h.unexpectedType("defaultValue","array",n,r(t))}),[])},t.asBooleanOrFalse=function(e,t){const n=o(e,t,null)
return"boolean"==typeof n?n:(i(n)||h.context("asBooleanOrFalse",()=>{h.unexpectedType("defaultValue","boolean",n,r(t))}),!1)},t.asString=c,t.asDate=function(e,t,n="coercible"){const r=c(e,t,n)
return(0,p.isNothing)(r)?null:new Date(r)},t.asNumber=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s)||"number"==typeof s)return s
{const e=Number(s)
switch(n){case"strict":h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(isNaN(e))return h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return e}},t.asDictionary=l,t.asInterface=function(e,t,n){return l(e,t,n)},t.asBoolean=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return null
if("boolean"==typeof s)return s
if("string"==typeof s){if("true"===s)return!0
if("false"===s)return!1}const a=Boolean(s)
switch(n){case"strict":h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(i(a))return h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return a},t.asJSONValue=function(e){if(null==e)return null
switch(typeof e){case"string":case"number":case"boolean":return e
case"object":return Array.isArray(e),e
default:return h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","JSONValue",typeof e)}),null}},t.asJSONData=function(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","object",typeof e)}),null)}},4029:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=n(8156),s=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,a=/([^=?&]+)=?([^&]*)/g,c=["hash","query","pathname","host"]
class l{constructor(e){if(this.query={},(0,i.isNullOrEmpty)(e))return
let t=e
const n=s.exec(e)
if(null!=n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let o={remainder:t,result:void 0}
for(const e of c){if(!o.remainder)break
switch(e){case"hash":o=r(o.remainder,"#","suffix"),this.hash=o.result
break
case"query":o=r(o.remainder,"?","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.query=l.queryFromString(o.result))
break
case"pathname":o=r(o.remainder,"/","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.pathname="/"+o.result)
break
case"host":if(o.remainder){const e=r(o.remainder,"@","prefix"),t=e.result,n=e.remainder
if((0,i.isDefinedNonNullNonEmpty)(t)){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if((0,i.isNullOrEmpty)(t))return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if("query"===e)"string"==typeof t&&(t=l.queryFromString(t)),r="string"==typeof n?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if("pathname"===e){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(null==this.query&&(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&null!=this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append("pathname",e)}pathExtension(){var e
if((0,o.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return(0,i.isNullOrEmpty)(this.pathname)?[]:this.pathname.split("/").filter(e=>e.length>0)}popPathComponent(){if((0,i.isNullOrEmpty)(this.pathname))return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return(0,i.isDefinedNonNullNonEmpty)(this.protocol)&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),(0,i.isDefinedNonNullNonEmpty)(this.host)&&(e+=this.host,this.port&&(e+=":"+this.port)),(0,i.isDefinedNonNullNonEmpty)(this.pathname)&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),null!=this.query&&Object.keys(this.query).length>0&&(e+="?"+l.toQueryString(this.query)),(0,i.isDefinedNonNullNonEmpty)(this.hash)&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=a.exec(e)
for(;null!=n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=a.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r];(0,i.isDefinedNonNullNonEmpty)(o)&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new l(e)}static fromComponents(e,t,n,r,o){const i=new l
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}t.URL=l},2930:function(e,t,n){async function r(e,t,n){const r=await e.network.fetch(t)
if(!r.ok)throw Error(`Bad Status code ${r.status} for ${t.url}`)
const o=Date.now(),i=n(r.body),s=Date.now(),c=function(e,t,n){return f.isNull(e)||0===e.length?null:{...e[0],parseStartTime:t,parseEndTime:n}}(r.metrics,o,s)
return f.isDefinedNonNull(c)&&(i[a.timingValues]=c),i[a.requestedUrl]=t.url.toString(),i}function o(e,t){return e.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return f.isDefinedNonNull(null===(n=t.query)||void 0===n?void 0:n[e])})}async function i(e,t,n,r,c={},l=!1,u){var p,m,y,A
const T=new h.URL(n),b=o(e,T)
for(const e of b)T.removeParam(e)
const S=T.toString()
let P=c.headers
null==P&&(P={}),P.Authorization="Bearer "+r
const I={url:S,excludeIdentifierHeadersForAccount:null!==(p=c.excludeIdentifierHeadersForAccount)&&void 0!==p&&p,alwaysIncludeAuthKitHeaders:null===(m=c.alwaysIncludeAuthKitHeaders)||void 0===m||m,alwaysIncludeMMeClientInfoAndDeviceHeaders:null===(y=c.alwaysIncludeMMeClientInfoAndDeviceHeaders)||void 0===y||y,headers:P,method:c.method,body:c.requestBodyString,timeout:c.timeout},C=await e.network.fetch(I)
try{if(401===C.status||403===C.status){if(l)throw Error("We refreshed the token but we still get 401 from the API")
return t.resetToken(),await t.refreshToken().then(async r=>await i(e,t,n,r,c,!0,u))}if(404===C.status)throw s()
if(!C.ok){const e=null!==(A=C.headers["x-apple-jingle-correlation-key"])&&void 0!==A?A:"N/A",t=new w(`Bad Status code ${C.status} (correlationKey: ${e}) for ${S}, original ${n}`)
throw t.statusCode=C.status,t}const r=t=>{const r=Date.now()
let o
if(f.isNull(t.body)||""===t.body){if(204!==t.status)throw s()
o={}}else o=JSON.parse(t.body)
const i=Date.now()
if(o[a.pageInformation]=f.asJSONData(function(e,t){const n=e.storefrontIdentifier
let r=null
if(f.isDefinedNonNullNonEmpty(n)){const e=n.split("-")
f.isDefinedNonNullNonEmpty(e)&&(r=e[0])}return{serverInstance:t.headers[g],storeFrontHeader:n,language:e.bagLanguage,storeFront:r,environmentDataCenter:t.headers[v]}}(e,t)),t.metrics.length>0){const e={...t.metrics[0],parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}else{const e={pageURL:t.url,parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}if(o[a.contentMaxAge]=function(e){const t=Object.keys(e.headers).find(e=>"cache-control"===e.toLowerCase())
if(f.isNull(t)||""===t)return null
const n=e.headers[t]
if(f.isNullOrEmpty(n))return null
const r=n.match(/max-age=(\d+)/)
return f.isNull(r)||r.length<2?null:f.asNumber(r[1])}(t),Array.isArray(o.data)&&f.isArrayDefinedNonNullAndEmpty(o.data)&&!f.asBooleanOrFalse(c.allowEmptyDataResponse))throw s()
return o[a.requestedUrl]=n,o}
return(0,d.isSome)(u)?u.measureParsing(C,r):r(C)}catch(e){if(e instanceof w)throw e
throw new Error(`Error Fetching - filtered: ${S}, original: ${n}, ${e.name}, ${e.message}`)}}function s(){const e=new w("No content")
return e.statusCode=204,e}var a,c=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n)
return l(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.redirectParametersInUrl=t.fetchData=t.fetchPlist=t.fetchJSON=t.fetch=t.ResponseMetadata=void 0
const d=n(2450),f=u(n(8156)),h=u(n(4029)),p=u(n(8097))
!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(a=t.ResponseMetadata||(t.ResponseMetadata={})),t.fetch=r,t.fetchJSON=async function(e,t){return await r(e,t,e=>(0,d.isSome)(e)?JSON.parse(e):{})},t.fetchPlist=async function(e,t){return await r(e,t,n=>{if((0,d.isSome)(n))return e.plist.parse(n)
throw new Error(`Could not fetch Plist, response body was not defined for ${t.url}`)})},t.fetchData=async function(e,t,n,r){const o=p.buildURLFromRequest(e,n).toString(),s=(Date.now(),await t.refreshToken()),c=await i(e,t,o,s,r,!1,e.fetchTimingMetricsBuilder)
return Date.now(),n.canonicalUrl&&(c[a.requestedUrl]=n.canonicalUrl),c},t.redirectParametersInUrl=o
class w extends Error{}t.NetworkError=w
const g="x-apple-application-instance",v="x-apple-application-site"},7582:function(e,t,n){function r(e,t){const n=d.attributeAsDictionary(e,"platformAttributes")
return u.traverse(n,t)}function o(e,t,n){const o=r(e,t)
return u.isNull(o)?null:u.asDictionary(o,n)}function i(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asString(i,n,o)}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredPlatformAttributeAsDictionary=t.requiredPlatformAttributeAsString=t.platformAttributeAsNumber=t.platformAttributeAsBooleanOrFalse=t.platformAttributeAsBoolean=t.platformAttributeAsString=t.platformAttributeAsArrayOrEmpty=t.platformAttributeAsDictionary=t.hasPlatformAttribute=void 0
const l=n(2450),u=c(n(8156)),d=c(n(9846)),f=c(n(8747))
t.hasPlatformAttribute=function(e,t){const n=r(e,t)
return u.isDefinedNonNullNonEmpty(n)},t.platformAttributeAsDictionary=o,t.platformAttributeAsArrayOrEmpty=function(e,t,n){const o=r(e,t)
return u.isNull(o)?[]:u.asArrayOrEmpty(o,n)},t.platformAttributeAsString=i,t.platformAttributeAsBoolean=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asBoolean(i,n,o)},t.platformAttributeAsBooleanOrFalse=function(e,t,n){const o=r(e,t)
return!u.isNull(o)&&u.asBooleanOrFalse(o,n)},t.platformAttributeAsNumber=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asNumber(i,n,o)},t.requiredPlatformAttributeAsString=function(e,t,n){const r=i(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r},t.requiredPlatformAttributeAsDictionary=function(e,t,n){const r=o(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r}},2390:function(e,t,n){function r(e,t){return l.asInterface(e.relationships,t)}function o(e,t){const n=l.asArrayOrEmpty(e.relationships,[t,"data"])
return 0===n.length?null:(n.length,n[0])}function i(e,t){return l.asArrayOrEmpty(e.relationships,[t,"data"])}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredRelationshipCollectionNonEmpty=t.requiredRelationshipData=t.relationshipViewsCollection=t.relationshipCollection=t.relationshipData=t.relationship=t.hasRelationship=void 0
const l=c(n(8156)),u=n(2450),d=c(n(8747))
t.hasRelationship=function(e,t,n=!0){const o=r(e,t)
return!((0,u.isNothing)(o)||n&&0===o.data.length)},t.relationship=r,t.relationshipData=o,t.relationshipCollection=i,t.relationshipViewsCollection=function(e,t){return l.asArrayOrEmpty(e.views,[t,"data"])},t.requiredRelationshipData=function(e,t){const n=o(e,t)
if((0,u.isNothing)(n))throw new d.MissingFieldError(e,["relationships",t,"data"])
return n},t.requiredRelationshipCollectionNonEmpty=function(e,t){const n=i(e,t)
if(0===n.length)throw new d.MissingFieldError(e,["relationships",t,"data"])
return n}},8097:function(e,t,n){function r(e){switch(e){case"apps":case"app-events":case"activities":case"arcade-apps":case"app-bundles":case"charts":case"contents":case"developers":case"eula":case"in-apps":case"multiple-system-operators":case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"chart-list":default:return"catalog"
case"games/recommendations":return"games/recommendations"
case"categories":case"editorial-items":case"editorial-item-groups":case"editorial-elements":case"groupings":case"multiplex":case"multirooms":case"rooms":case"today":case"collections":return"editorial"
case"ratings":return"ratings"
case"personalization-data":case"reviews":return"me"
case"upsellMarketingItem":case"landing":case"engagement-data":return"engagement"
case"landing:new-protocol":case"recommendations":case"personal-recommendations":return"recommendations"}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.buildURLFromRequest=void 0
const a=n(2450),c=s(n(8156)),l=s(n(4029)),u=s(n(9846))
t.buildURLFromRequest=function(e,t){var n,o
const i=c.isDefinedNonNullNonEmpty(t.href)?t.href:function(e,t){switch(t){case"games/search":return`/v1/games/${r(t)}/${e.mediaCountryCode}`
case"personalization-data":case"reviews":return`/v1/${r(t)}/`
default:return`/v1/${r(t)}/${e.mediaCountryCode}/`}}(e,t.resourceType),s=new l.URL(i)
if(c.isDefinedNonNullNonEmpty(t.resourceType))for(const e of function(e,t){switch(e){case"eula":return void 0===t?[e]:[e,t]
case"landing:new-protocol":case"recommendations":case"searchLanding:see-all":case"search-hints":case"games/recommendations":return[]
case"landing":return void 0===t?["search",e]:["search",e,t]
case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"game-highlights":return["apps"]
case"reviews":return["reviews","apps"]
case"multiplex":return["multiplex"]
case"upsellMarketingItem":return["upsell","marketing-items"]
case"trending-contents":return["search",e]
case"player-highlights":return["players"]
case"search-suggestions":case"games/search":case"games/search-suggestions":case"search-groups":return["search"]
case"chart-list":return["charts"]
default:return[e]}}(t.resourceType,t.targetResourceType))s.append("pathname",e)
if(t.ids.size>1||(0,a.isSome)(t.useIdsAsQueryParam))s.param("ids",Array.from(t.ids).join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
s.append("pathname",encodeURIComponent(e))}if(t.seeds.size>0&&s.param("seeds",Array.from(t.seeds).join(",")),void 0!==t.resourceType){const e=function(e){switch(e){case"user-reviews":return"reviews"
case"customers-also-bought-apps-with-download-intent":return"view/customers-also-bought-apps-with-download-intent"
case"collections":default:return null
case"searchLanding:see-all":return"view/see-all"
case"search-hints":return"search/suggestions"
case"game-highlights":case"player-highlights":return"view/highlights"
case"games/search":case"search-groups":return"groups"
case"games/search-suggestions":case"search-suggestions":return"suggestions"}}(t.resourceType)
c.isDefinedNonNullNonEmpty(e)&&s.append("pathname",e)}if(s.param("platform",null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&s.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t.push("customArtwork"),t}(e)),e.sort(),s.param("extend",e.join(","))}if(c.isDefinedNonNull(t.ageRestriction)&&s.param("restrict[ageRestriction]",t.ageRestriction.toString()),c.isDefinedNonNull(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())s.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludesOnly.size>0?s.param("includeOnly",Array.from(t.relationshipIncludesOnly).sort().join(",")):t.relationshipIncludes.size>0&&s.param("include",Array.from(t.relationshipIncludes).sort().join(",")),t.shouldOmitAutomaticRelationship&&s.param("omit[resource]","autos"),c.isDefinedNonNull(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())s.param(`include[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())s.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())s.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())s.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNullNonEmpty(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),s.param("fields",e.join(","))}if(c.isDefinedNonNull(t.limit)&&t.limit>0&&s.param("limit",`${t.limit}`),c.isDefinedNonNull(t.sparseLimit)&&s.param("sparseLimit",`${t.sparseLimit}`),c.isDefinedNonNull(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())s.param(`sparseLimit[${e}]`,String(n))
c.isDefinedNonNull(t.sparseCount)&&s.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
s.param(`limit[${e}]`,`${n}`)}c.isDefinedNonNullNonEmpty(t.additionalQuery)&&s.append("query",t.additionalQuery),c.isDefinedNonNullNonEmpty(t.searchTerm)&&(((0,a.isNothing)(t.resourceType)||"search-hints"!==t.resourceType)&&(s.append("pathname","search"),s.param("bubble[search]",t.searchTypes.join(","))),s.param("term",t.searchTerm)),c.isDefinedNonNullNonEmpty(t.enabledFeatures)&&s.param("with",t.enabledFeatures.join(",")),c.isDefinedNonNullNonEmpty(t.context)&&s.param("contexts",t.context),c.isDefinedNonNullNonEmpty(t.filterType)&&c.isDefinedNonNullNonEmpty(t.filterValue)&&s.param(`filter[${t.filterType}]`,t.filterValue)
const f=e.mediaApiLanguage
return c.isDefinedNonNull(f)&&c.isNull(t.additionalQuery.l)&&s.param("l",f),c.isDefinedNonNullNonEmpty(t.responseFormat)&&s.param("format[resources]",t.responseFormat),s.host=null!==(o=function(e,t,n){var r
const o=null!==(r=t.pathname)&&void 0!==r?r:""
let i=null
return i=n.isStorePreviewRequest?e.mediaPreviewHost:n.isMediaRealmRequest?e.mediaRealmHost:o.includes("search/landing")?-1!==e.edgeEndpoints.indexOf("landing")?e.mediaEdgeHost:e.mediaHost:e.edgeEndpoints.map(e=>o.includes(e)).reduce(d,!1)?o.includes("search")&&!o.includes("view/see-all")?e.mediaEdgeSearchHost:e.mediaEdgeHost:e.mediaHost,c.isNull(i)&&(i="api.apps.apple.com"),i}(e,s,t))&&void 0!==o?o:void 0,s.protocol="https",s}
const d=(e,t)=>e||t}},n={}
e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function t(e){return r(e)?null:Array.isArray(e)?e.join("."):e}function n(e,t,n){if(null==e)return n
if(!t)return e
let r
if(typeof t===Bq){if(r=mW[t],!r){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),mW[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function r(e){return null==e}function o(e){return r(e)||0===Object.keys(e).length}function i(e){return typeof e!==OU&&null!==e}function s(e){return!(0,Wv.isNothing)(e)&&(typeof e===Bq||Array.isArray(e)?e.length>0:0!==Object.keys(e).length)}function a(e){if(r(e))return!1
let t
return t=typeof e===Bq?parseInt(e):e,!Number.isNaN(t)}function c(e){return!(0,Wv.isNothing)(e)&&typeof e===Bq}function l(e,t){var n
return null!==(n=w(e,t,[]))&&void 0!==n?n:[]}function u(e,t){return d(e,!1,t)}function d(e,o,i){const s=n(e,i,null)
return typeof s===FF?s:(r(s)||qv.context("asBooleanWithDefault",()=>{qv.unexpectedType(_H,FF,s,t(i))}),o)}function f(e,o,i=FH){const s=n(e,o,null)
if(r(s))return s
if(typeof s===Bq)return s
{const e=typeof s===fV?null:String(s)
switch(i){case q_:qv.context(dk,()=>{qv.unexpectedType(KB,Bq,s,t(o))})
break
case FH:r(e)&&qv.context(dk,()=>{qv.unexpectedType(KB,Bq,s,t(o))})}return e}}function h(e,o,i=FH){const s=n(e,o,null)
if(r(s)||typeof s===ej)return s
{const e=Number(s)
switch(i){case q_:qv.context(fk,()=>{qv.unexpectedType(KB,ej,s,t(o))})
break
case FH:if(isNaN(e))return qv.context(fk,()=>{qv.unexpectedType(KB,ej,s,t(o))}),null}return e}}function p(e,o,s){const a=n(e,o,null)
return a instanceof Object&&!Array.isArray(a)?a:(r(a)||qv.context("asDictionary",()=>{qv.unexpectedType(_H,fV,a,t(o))}),i(s)?s:null)}function w(e,o,s){const a=n(e,o,null)
return Array.isArray(a)?a:(r(a)||qv.context("asArray",()=>{qv.unexpectedType(_H,"array",a,t(o))}),i(s)?s:null)}function g(e,t,n){return p(e,t,n)}function v(e,o,i=FH){const s=n(e,o,null)
if(r(s))return null
if(typeof s===FF)return s
if(typeof s===Bq){if(s===pq)return!0
if(s===UF)return!1}const a=Boolean(s)
switch(i){case q_:qv.context(hk,()=>{qv.unexpectedType(KB,ej,s,t(o))})
break
case FH:if(r(a))return qv.context(hk,()=>{qv.unexpectedType(KB,ej,s,t(o))}),null}return a}function m(e){if(null==e)return null
switch(typeof e){case Bq:case ej:case FF:return e
case fV:return Array.isArray(e),e
default:return qv.context(pk,()=>{qv.unexpectedType(_H,"JSONValue",typeof e)}),null}}function y(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(qv.context(pk,()=>{qv.unexpectedType(_H,fV,typeof e)}),null)}function A(e){return(0,Hv.isSome)(e)&&typeof e.$kind===Bq}function T(e){return A(e)&&function(e){return(0,Hv.isSome)(IW[e])}(e[gW])&&(0,Hv.isSome)(e.actionClass)&&function(e){return(0,Hv.isSome)(bW[e])}(e.actionClass)}function b(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
n===Ak?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}function S(e){if(null==e)return e
const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e),t}function P(e,t){return e instanceof t}function I(e){return!(!(0,Wv.isSome)(e.protocol)||-1===cz.indexOf(e.protocol))}function C(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t+1}function k(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t?e.substring(t+1,n):e}function O(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1))
return n>=0&&r>n?e.substring(n,r):e}function E(e){return{success:!0,value:e,error:null,[dz]:!0}}function R(e){return{success:!1,value:null,error:e instanceof Error?e:new Error(String(e)),[dz]:!0}}async function D(e){return await M(e)}async function _(e){return await e}async function L(e){return await Promise.all(e.map(D))}async function M(e){try{const t="function"==typeof e?e():e
return E(await t)}catch(e){return R(e)}}function x(e){throw new Error(`This method should never be called with value: ${e}`)}function $(e,t,r){return e?qv.context(t,()=>{let o=e[eY],i=null
return o?(i=n(o,t),i||(i=F(o,t,r))):(o={},e[eY]=o,i=F(o,t,r)),i}):null}function F(e,t,n){const r=n()
return e[t]=r,r}function N(e){return g(function(e){return l(e,"meta.associations.editorial-cards.data")}(e)[0])}function B(e,t,n){return(0,Wv.isNothing)(e)?null:p(e.attributes,t,n)}function U(e,t){return r(e)?[]:w(e.attributes,t)}function G(e,t){var n
return null!==(n=U(e,t))&&void 0!==n?n:[]}function j(e,t,n=FH){return r(e)?null:f(e.attributes,t,n)}function V(e,t,n=FH){return r(e)?null:v(e.attributes,t,n)}function H(e,t){return!r(e)&&u(e.attributes,t)}function q(e,t,n=FH){return r(e)?null:h(e.attributes,t,n)}function W(e){return!r(p(e,MF))}function z(e){return!W(e)}function Y(e){return tY[e]}function J(e){return e===Bx||e===W_}function K(e){if(e.client.isCompanionVisionApp)return XV
switch(e.client.deviceType){case nW:return _q
case Kq:return Dq
case"tv":return ZB
case lW:return lW
case cW:return cW
case Qq:return XV
case LV:return LV
default:return null}}function Z(e){return e.client.isPhone?2:1}function Q(e){switch(e.client.deviceType){case nW:return 4
case Kq:return 5
case"tv":return 6
case lW:return 5
case cW:return 10
default:return null}}function X(e){switch(e.client.deviceType){case nW:return 9
case Kq:return 12
case"tv":case lW:return 15
case cW:return 3
case LV:return 12
default:return null}}function ee(e){switch(e.host.clientIdentifier){case Ez:case Rz:case Lz:return[]
default:{const t=K(e)
return function(e,t){const n=new Set
if(n.add(_q),n.add(Dq),n.add(ZB),n.add(lW),n.add(cW),e.bag.enableVisionPlatform&&n.add(XV),(0,Wv.isSome)(t))for(const e of t)n.delete(e)
return Array.from(n)}(e,(0,Wv.isSome)(t)?new Set([t]):void 0)}}}function te(e){switch(e.client.deviceType){case nW:return 6
case Kq:return 10
case lW:return 12
case Qq:return 10
default:return 8}}function ne(e){let t=null
return e.host.clientIdentifier===sY?t=sq:e.host.clientIdentifier===iY&&(t=cW),t}function re(e,t){if(o(t))return null
const n=l(t,`meta.associations.${e}.data`)
return(0,Wv.isNothing)(n)?null:[...n]}function oe(e,t){return n(B(e,"platformAttributes"),null!=t?t:void 0)}function ie(e,t){return s(oe(e,t))}function se(e,t,n){const o=oe(e,t)
return r(o)?null:p(o,n)}function ae(e,t,n){const o=oe(e,t)
return r(o)?[]:l(o,n)}function ce(e,t,n,o=FH){const i=oe(e,t)
return r(i)?null:f(i,n,o)}function le(e,t,n,o=FH){const i=oe(e,t)
return r(i)?null:v(i,n,o)}function ue(e,t,n){const o=oe(e,t)
return!r(o)&&u(o,n)}function de(e,t,n=!0){const r=fe(e,t)
return!!r&&!(!r.data||n&&0===r.data.length)}function fe(e,t){return i(e)?g(e.relationships,t):null}function he(e,t){return g(e.views,t)}function pe(e,t,n){const r=l(t.relationships,[n,Gj])
return 0===r.length?null:(r.length>1&&e.console.warn(`there was an array of relationships when only the first was asked for in relationship ${n}`),r[0])}function we(e,t,n=!1){return!de(e,t,!1)&&n?null:l(e.relationships,[t,Gj])}function ge(e,t){return l(e.views,[t,Gj])}function ve(e,t){var n,o,a
const c=t.href&&t.href.length>0?t.href:function(e,t,n,r){switch(n){case $_:case Fq:case DF:return`/v1/${me(n)}/`
default:const o=(0,Wv.isSome)(r)&&r.length>0?r:e.bag.mediaCountryCode,i=`/v1/${me(n)}/${o}`
return t?i:`${i}/`}}(e,t.isMixedMediaRequest,t.resourceType,t.countryCodeOverride),l=new az(c)
if(s(t.resourceType))for(const e of function(e,t){switch(e){case YU:return void 0===t?[e]:[e,t]
case ZD:return[]
case bF:return void 0===t?[bq,e]:[bq,e,t]
case Fx:return[dW]
case Fq:return[Fq,dW]
case xx:return[xx]
case Ij:return[OA,SV]
case ak:return[bq,e]
case $x:return[dW]
case Nx:case Cx:return[]
case DF:return[dW]
default:return[e]}}(t.resourceType,t.targetResourceType))l.append(gV,e)
if(t.isMixedMediaRequest)for(const[e,n]of t.idsByResourceType.entries())l.param(`ids[${e}]`,Array.from(n).sort().join(","))
else if(t.ids.size>1||t.useIdsAsQueryParam)l.param("ids",Array.from(t.ids).sort().join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
l.append(gV,e)}if(void 0!==t.resourceType){const e=function(e){switch(e){case Fx:return Fq
case $x:return"view/customers-also-bought-apps-with-download-intent"
case NV:return uW
case Nx:return vk
case Cx:return"search/suggestions"
default:return null}}(t.resourceType)
s(e)&&l.append(gV,e)}if(l.param(YV,null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&l.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e,t){const n=t.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return n.push(Bx),t.includes(TH)&&n.push(TH),n.push(q$),n}(0,e)),e.sort(),l.param(BC,e.join(","))}if(i(t.ageRestriction)&&e.bag.enableAgeRatingFilter&&l.param("restrict[ageRestriction]",t.ageRestriction.toString()),t.includeAppBinaryTraitsAttribute&&t.includingScopedAttributes(dW,[IT]),i(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())l.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludes.size>0&&l.param("include",Array.from(t.relationshipIncludes).sort().join(",")),i(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())l.param(`include[${e}]`,Array.from(n).sort().join(","))
if(i(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())l.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(i(a=t.viewsIncludes)&&a.size>0&&l.param("views",Array.from(t.viewsIncludes).sort().join(",")),i(t.kindIncludes))for(const[e,n]of t.kindIncludes.entries())l.param(`kinds[${e}]`,Array.from(n).sort().join(","))
if(i(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())l.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(i(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())l.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(s(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),l.param(Zx,e.join(","))}if(i(t.limit)&&t.limit>0&&l.param("limit",`${t.limit}`),i(t.sparseLimit)&&l.param("sparseLimit",`${t.sparseLimit}`),i(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())l.param(`sparseLimit[${e}]`,String(n))
i(t.sparseCount)&&l.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
l.param(`limit[${e}]`,`${n}`)}s(t.additionalQuery)&&l.append(uj,t.additionalQuery),s(t.searchTerm)&&(((0,Wv.isNothing)(t.resourceType)||t.resourceType!==Cx)&&(l.append(gV,bq),l.param("bubble[search]",t.searchTypes.join(","))),l.param(ZG,t.searchTerm)),s(t.enabledFeatures)&&l.param(EL,t.enabledFeatures.join(",")),s(t.context)&&l.param(FG,t.context),s(t.filterType)&&s(t.filterValue)&&l.param(`filter[${t.filterType}]`,t.filterValue)
const u=e.bag.mediaApiLanguage
return i(u)&&r(t.additionalQuery.l)&&l.param("l",u),l.host=null!==(o=function(e,t,n){var o
const i=null!==(o=t.pathname)&&void 0!==o?o:""
let s=null
return s=n.isStorePreviewRequest?e.bag.mediaPreviewHost:n.isMediaRealmRequest?e.bag.mediaRealmHost:i.includes("search/landing")?-1!==e.bag.edgeEndpoints.indexOf(bF)?e.bag.mediaEdgeHost(e):e.bag.mediaHost:n.resourceType===DF&&(0,Wv.isSome)(e.bag.appDistributionMediaAPIHost)?e.bag.appDistributionMediaAPIHost:n.isMixedMediaRequest&&e.bag.mediaAPICatalogMixedShouldUseEdge?e.bag.mediaEdgeHost(e):e.bag.edgeEndpoints.map(e=>i.includes(e)).reduce(fY,!1)?i.includes(bq)&&!i.includes(vk)?e.bag.mediaEdgeSearchHost:e.bag.mediaEdgeHost(e):e.bag.mediaHost,r(s)&&(s="api.apps.apple.com"),s}(e,l,t))&&void 0!==o?o:void 0,l.protocol=U_,l}function me(e){switch(e){case dW:case iW:case KV:case Zq:case rN:case uW:case pV:case YU:case JH:case LM:case Fx:case $x:return wk
case nB:case XH:case Xq:case Dj:case A$:case MV:case xx:case IF:case qN:case zq:case NV:return Yk
case z_:return z_
case $_:case Fq:return"me"
case Ij:case bF:return gk
case ZD:case RL:return uH
case FC:return gk
case DF:return"listing"
default:return wk}}function ye(e){if((0,Wv.isNothing)(e)||""===e)return null
const t=hY.exec(e)
return null===t||4!==t.length&&5!==t.length?null:{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,alpha:(0,Wv.isSome)(t[4])?parseInt(t[4],16)/255:void 0,type:xV}}function Ae(e,t,n,r){return{red:e,green:t,blue:n,alpha:r,type:xV}}function Te(e){return.2126*e.red+.7152*e.green+.0722*e.blue}function be(e,t=84){if((0,Wv.isNothing)(e))return!1
switch(e.type){case xV:return 100*Te(e)<t
case _N:return e.name===qO
default:return!1}}function Se(e){return{name:e,type:_N}}function Pe(e,t){return{lightColor:e,darkColor:t,type:Gx}}function Ie(e,t){return!(0,Wv.isNothing)(e)&&!(0,Wv.isNothing)(t)&&(e.type===xV&&t.type===xV?e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha:e.type===_N&&t.type===_N?e.name===t.name:e.type===Gx&&t.type===Gx&&Ie(e.lightColor,t.lightColor)&&Ie(e.darkColor,t.darkColor))}function Ce(e,t){if((0,Wv.isNothing)(e))return!1
const n=function(e){return typeof e===fV&&null!==e&&(kV in e&&e.type===Ek)}(e)?e:ke(e)
return function(e){if(typeof e!==fV||null===e)return!1
const t=e
return"colorHex"in t&&typeof t.colorHex===Bq&&"maxSaturation"in t&&typeof t.maxSaturation===ej&&"maxBrightness"in t&&typeof t.maxBrightness===ej}(t)?n.saturation<=t.maxSaturation||n.brightness<=t.maxBrightness:n.hue>=t.minHue&&n.hue<=t.maxHue}function ke(e){const t=e.red,n=e.green,r=e.blue,o=Math.max(t,n,r),i=o-Math.min(t,n,r),s=100*o,a=0===o?0:i/o*100
let c=0
if(0!==i)switch(o){case t:c=60*((n-r)/i+(n<r?6:0))
break
case n:c=60*((r-t)/i+2)
break
case r:c=60*((t-n)/i+4)}return c=(c+360)%360,{type:Ek,hue:c,saturation:a,brightness:s}}function Oe(e){return r(e)||""===e?null:(-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/")))}function Ee(e){if(r(e))return null
const t=function(e){return r(e)?null:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e)
return r(t)?null:t.getTime()}function Re(e){if(r(e))return null
const t=new Date(e)
return t.setHours(0,0,0,0),t}function De(e){return r(e)?null:_e(e)}function _e(e){const t=new Date(e.getTime())
return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function Le(e,t){return r(e)||r(t)?null:Math.ceil((t.getTime()-_e(e).getTime())/36e5)}function Me(e,t,n,r=!1){return $(t,`dataHasDeviceFamily.${n}`,()=>!(!t||!n)&&-1!==Fe(e,t,r).indexOf(n))}function xe(e,t,n,r=!1){var o
return null!==(o=Me(e,t,n,r))&&void 0!==o&&o&&1===Fe(e,t,r).length}function $e(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
return n.length===o.size&&n.every(e=>o.has(e))}function Fe(e,t,n=!1){const r=G(t,ij)
if(0===r.length&&n){const r=we(t,dW)
if((0,Wv.isSome)(r))for(const t of r){const r=Fe(e,t,n)
if(s(r))return r}}return r}function Ne(e,t){var n
const r=e.optional(AY.metatype)
return null===(n=null==r?void 0:r.currentTreatmentForExperiment(t))||void 0===n?void 0:n.identifier}function Be(e){return Ne(e,Zv.ProductPagePreloading)===TY}function Ue(e){return e.bag.enableProductPageVariants}function Ge(e,t,r){if(void 0===r&&(r=function(e){const t=function(e){return Ne(e,Zv.ProductPageVariants)}(e)
return t}(e)),o(t.id))return
const i={adamID:t.id,productPageId:bY,treatmentPageIdMap:{[bY]:bY},experimentIdMap:{},experimentLocaleMap:{}}
return o(n(t,vV,null))||(function(e,t,r){const i=n(r,"meta.cppData",null)
if(o(i))return
const a=f(i,NU)
s(a)&&(t.productPageId=a)}(0,i,t),function(e,t,r,i,a){const c=n(a,"meta.experimentData",null)
if(o(c))return
const l=n(c,r,null)
if(o(l))return
const u=f(l,hD),d=f(l,OP)
let h=null
const p=n(l,"trafficAllocation",null)
h=s(p)?function(e,t,n){if(void 0===n||o(n))return bY
for(const[e,r]of Object.entries(t))if(s(r)&&-1!==r.indexOf(n))return e
return bY}(0,p,i):function(e,t,n){const r=Ke(e,t,`customAttributes.${n}`)
if(o(r))return bY
const i=Object.keys(r)[0]
return o(i)?bY:i}(e,a,r),s(h)&&s(u)&&(t.treatmentPageIdMap[r]=h,t.experimentIdMap[r]=u,s(d)&&(t.experimentLocaleMap[r]=d))}(e,i,bY,r,t)),i}function je(e,t,r,s,a){if(o(t))return null
let c
if(r.productPageId!==bY){const e=r.treatmentPageIdMap[bY]
c=a?[`${r.productPageId}.${bY}.${s}`,`${bY}.${e}.${s}`,`${bY}.${bY}.${s}`]:[`${r.productPageId}.${bY}.${s}`,`${bY}.${bY}.${s}`]}else{const e=r.treatmentPageIdMap[bY]
c=[`${bY}.${e}.${s}`,`${bY}.${bY}.${s}`]}for(const e of c){const r=n(t,e)
if(i(r))return r}return null}function Ve(e){return(0,Wv.isNothing)(e)||e.productPageId===bY?null:e.productPageId}function He(e,t){return Ve(Ge(e,t))}function qe(e,t){const n=Ke(e,t,cE)
return null===n||o(n)?null:Object.keys(n).filter(e=>e!==bY)}function We(e){const t={}
Ye(e,YM)&&(t[EP]=e.productPageId)
const n=e.treatmentPageIdMap[bY],r=e.experimentIdMap[bY],o=e.experimentLocaleMap[bY]
return Ye(e,kM)&&(t.pageVariantId=n,t.pageExperimentId=r,t.pageExperimentLocale=o),t}function ze(e){const t={}
Ye(e,YM)&&(t[EP]=e.productPageId)
const n=e.treatmentPageIdMap[bY],r=e.experimentIdMap[bY],o=e.experimentLocaleMap[bY]
return Ye(e,kM)&&(t.variantId=n,t[hD]=r,t[OP]=o),t}function Ye(e,t){if(r(e))return!1
switch(t){case YM:return s(e.productPageId)&&e.productPageId!==bY
case kM:return s(e.experimentIdMap)
default:x(t)}}function Je(e,t,n){for(const r of n){const n=He(e,r)
i(n)&&t.addingQuery(`ppid[apps:${r.id}]`,`${n}`)}}function Ke(e,t,n,r,o){if(r||(r=nt(e,t)),(0,Wv.isNothing)(r))return null
let i=se(t,r,n)
return i||(i=B(t,n,o)),i}function Ze(e,t,n,r){const i=null!=r?r:nt(e,t)
if((0,Wv.isNothing)(i))return[]
let s=ae(t,i,n)
return o(s)&&(s=G(t,n)),s}function Qe(e,t,n,r,o=FH){let i
const s=null!=r?r:nt(e,t)
return(0,Wv.isSome)(s)&&(i=ce(t,s,n,o)),i||(i=j(t,n,o)),i}function Xe(e,t,n,o,i=FH){if(o||(o=nt(e,t)),(0,Wv.isNothing)(o))return null
let s=le(t,o,n,i)
return r(s)&&(s=V(t,n,i)),s}function et(e,t,n,o){if(o||(o=nt(e,t)),(0,Wv.isNothing)(o))return!1
let i=le(t,o,n)
return r(i)&&(i=H(t,n)),i}function tt(e,t,n,o=FH){const i=nt(e,t)
if((0,Wv.isNothing)(i))return null
let s=function(e,t,n,o=FH){const i=oe(e,t)
return r(i)?null:h(i,n,o)}(t,i,n,o)
return r(s)&&(s=q(t,n)),s}function nt(e,t,n){const o="bestAttributePlatformFromData",i=(0,Wv.isSome)(n)?`${o}.${n}`:o
return $(t,i,()=>{const o=$e(e,t,[_q,Dq,iN],!0),i=xe(e,t,QG),s=xe(e,t,lW),a=xe(e,t,cW),c=xe(e,t,XV)
let l=null
if(i?l=nV:s?l=lH:o?l=kq:a?l=cW:c&&(l=nH),!r(l))return l
const u=function(e,t){const n=rt(e)
if(null===n)return[]
switch(n){case kq:return t===xz||t===Mz?[nH,kq,nV,lH]:[kq,nV,lH,nH]
case lH:return[lH,kq,nV,nH]
case nV:return[nV,kq,lH,nH]
case cW:return[kq,cW,lH,nH]
case nH:return[nH,kq,nV,lH]
default:return[n]}}(e,n)
for(const e of u)if(ie(t,e))return e
return rt(e)})}function rt(e){var t
if(null===(t=e.activeIntent)||void 0===t?void 0:t.attributePlatform)return e.activeIntent.attributePlatform
switch(e.client.deviceType){case nW:case Kq:return kq
case"tv":return nV
case lW:return lH
case cW:return cW
case Qq:return nH
default:return null}}function ot(e,t,n,r,o){const i=Y(r)
if((0,Wv.isNothing)(i))return null
const a=je(0,Ke(e,t,cE,o),n,i,J(i))
return s(a)?p(a):Ke(e,t,r,o)}function it(e,t,n,r,o){const i=Y(r)
if((0,Wv.isNothing)(i))return null
const a=je(0,Ke(e,t,cE,o),n,i,J(i))
return s(a)?f(a):Qe(e,t,r)}function st(e){return null!==SY||(SY={bundleIdFromData:t=>Qe(e,t,yq),isSystemAppFromData:e=>H(e,eG),isUnsupportedDeletableSystemAppFromData:e=>!1,adamIdFromSystemBundleId(e){}}),SY}function at(e,t,n=Qv.All){let o=!1
return n&Qv.ThirtyTwoBit&&(o=o||function(e,t){return et(e,t,zy)||et(e,t,Yy)}(e,t)),n&Qv.UnsupportedSystemDeletableApps&&(o=o||function(e,t){return $(t,"shouldFilterDeletableSystemApp",()=>{const n=st(e)
if(!n.isSystemAppFromData(t))return!1
const r=n.bundleIdFromData(t),o=e.host.deviceModel,s=o.startsWith(Zy),a=o.startsWith(Qy)
let c
switch(c=!!Qf(e,"12.3")||e.bag.isTVAppEnabled,r){case"com.apple.Bridge":case"com.apple.Passbook":return!s
case"com.apple.Photo-Booth":return!a
case"com.apple.tv":return!c
case"com.apple.videos":return c
case"com.apple.iCloudDriveApp":return!0
case"com.apple.facetime":case"com.apple.mobilephone":return!lt(e,"any-telephony")||!lt(e,"venice")
case"com.apple.Fitness":if(a||s){let t=!1
return i(e.user.isFitnessAppInstallationAllowed)&&(t=e.user.isFitnessAppInstallationAllowed),!t}return!0
case"com.apple.measure":return!lt(e,"arkit")
case"com.apple.Jellyfish":return!lt(e,"front-depth-camera")
case Jy:case Ky:return!0
case"com.apple.NanoHeartRhythm":return!e.client.isElectrocardiogramInstallationAllowed
case Xy:return!lt(e,"magnetometer")
case"com.apple.NanoOxygenSaturation.watchkitapp":return!e.client.isScandiumInstallationAllowed
case eA:case"com.apple.NanoRadio":return!0
case tA:return!e.client.isCharonSupported
case nA:return!e.client.isMandrakeSupported
case"com.apple.GenerativePlaygroundApp":return!lt(e,"generative-model-systems")
case zk:const t=a&&e.clientCapabilities.isEnabled(gY)
return!(s||t)}return!1})}(e,t)),n&Qv.UnsupportedWatchAppOnWatchClient&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const n=et(e,t,iH),r=t.type===Zq
return e.host.clientIdentifier===iY&&!n&&!r})}(e,t)),n&Qv.DisabledMerchandisableIAPs&&(o=o||function(e,t){return t.type===JH&&!s(p(t,qF))&&!s(p(t,fL))&&!H(t,"isMerchandisedEnabled")}(0,t)),n&Qv.LegacyApps&&(o=o||function(e,t){return $(t,"shouldFilterLegacyApps",()=>{switch(Qe(e,t,yq)){case"com.apple.mobileme.fmip1":case Jy:return!0}return!1})}(e,t)),n&Qv.LegacyProductionMacOSInstaller&&(o=o||function(e,t){return $(t,"isLegacyMacOSInstaller",()=>(Qe(e,t,yq),!1))}(e,t)),n&Qv.UnsupportedPlatform&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatform",()=>{if(t.type!==dW&&t.type!==Zq)return!1
const n=pf(e,t),r=Af(0,t,e.appleSilicon.isSupportEnabled)
return!If(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&Qv.UnsupportedPlatformForMacCharts&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatformForCharts",()=>{if(t.type!==dW&&t.type!==Zq)return!1
const n=pf(e,t),r=Af(0,t,!0)
return!If(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&Qv.UnsupportedPreorders&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!H(t,wq))return!1
if(t.type!==dW)return!1
const n=pf(e,t),r=Af(0,t,e.appleSilicon.isSupportEnabled)
return!Of(0,n,e.client.deviceType,r,!1)})}(e,t)),n&Qv.MinimumOSRequirement&&(o=o||ct(e,t)),n&Qv.SADWatchApps&&(o=o||function(e,t){const n=H(t,eG),r=!et(e,t,fO)&&et(e,t,DG)
return n&&r}(e,t)),n&Qv.MinimumCompanionOSRequirement&&(o=o||function(e,t){return e.client.deviceType===cW&&(!et(e,t,DG)&&!et(e,t,dO)&&!function(e,t){return!(!r(t)&&0!==t.length)||e.client.isPairedSystemVersionAtLeast(t)}(e,ce(t,nt(e,t),IH)))}(e,t)),n&Qv.MacOSCompatibleIOSBinary&&(o=o||function(e,t){return e.client.deviceType===lW&&(et(e,t,hL,rt(e))&&!e.appleSilicon.isSupportEnabled)}(e,t)),n&Qv.MacOSRosetta&&(o=o||function(e,t){const n=pf(e,t)
return!(e.client.deviceType!==lW||!n.includes(lW))&&!kf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable)}(e,t)),n&Qv.VisionOSCompatibility&&(o=o||function(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=ue(t,kq,hO)
return!(pf(e,t).indexOf(Qq)>-1||n)}(e,t)),n&Qv.SADMinimumOSRequirement&&(o=o||function(e,t){return!!st(e).isSystemAppFromData(t)&&ct(e,t)}(e,t)),o}function ct(e,t){return!(!e.client.isPhone||!et(e,t,DG)||function(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.client.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(o,i,s)}(e,Qe(e,t,WF)))||!Qf(e,bf(e,t,e.appleSilicon.isSupportEnabled))}function lt(e,t,n){return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp([t],!1)}function ut(e){if((0,Wv.isNothing)(e))return
const t=e.toLocaleLowerCase()
return function(e){return PY.includes(e)}(t)?t:void 0}function dt(e){return e.startsWith("id")?e.substring(2):e}function ft(e){return A(e)&&function(e){return(0,Hv.isSome)(CY[e])}(e.$kind)}function ht(e){return T(e)&&e[gW]===Gy}function pt(e){var t
switch(e){case eL:return"arcadeAskToBuy"
case mj:return vy
case Hx:return wy
case tL:return"arcadeLaunchRepair"
case eH:return Q_
case"topShelfATV":return"arcadeTopShelfATV"
case"topShelfATVClickThrough":return"arcadeTopShelfATVClickThrough"
case yj:return"arcadeTodayCard"
case nL:return"arcadeStoryCanvas"
case BF:return BF
case QB:return QB
case tO:return tO
default:return null!==(t=e)&&void 0!==t?t:vy}}function wt(e){return T(e)&&e[gW]===My}function gt(e){return T(e)&&e[gW]===sO}function vt(e){return ft(e)&&e[gW]===Qk}function mt(e){return function(e){return A(e)&&function(e){return(0,Hv.isSome)(iJ[e])}(e[gW])}(e)&&e[gW]===hy}function yt(e,t){const n=l(t,Gj)
return n.length>1&&e.console.warn("tried to extract data from container but more than one member present"),1!==n.length?null:n[0]}function At(e){return l(e,Gj)}function Tt(e){const t=lk,r=n(e,nR)
return e.label===t||i(r)}function bt(e){return l(e,zI)}function St(e){return p(e,zR)}function Pt(e,t){return t&&t.remainingContent?t.remainingContent.slice(0,t.maxPerPage):[]}function It(e,t,n){const r={...t}
if(t&&t.remainingContent){const e=Ct(0,t.remainingContent,t.maxPerPage,n)
r.remainingContent=e}return r}function Ct(e,t,n,r){return t.slice(n,null!=r?r:t.length)}function kt(e,t=!1,n=!1,r=y6.Default){const o=function(e,t){let n
switch(e.host.clientIdentifier){case Ez:case Rz:case Lz:n=!1
break
default:n=e.client.supportsHEIF}return t?n?D$:PL:n?D$:EE}(e,t)
return function(e,t,n=!1,r=y6.Default){return new GJ(t,t===D$?60:70,n)}(0,o,n,r)}function Ot(e,t,n=0,r=0,o=null,i=null,s=null){const a=new pz(t,n,r,[kt(e,!1,!1,y6.Default)])
return a.backgroundColor=o,a.textColor=i,a.checksum=s,a}function Et(e){return`resource://${e}`}function Rt(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}function Dt(e,t){var n
const r=null!==(n=t.excludingFields)&&void 0!==n?n:[]
return r.push("amsMetricsID"),new uK(t.fields,t.includingFields,r,t.topic,t.shouldFlush)}function _t(e,t,n,r,o,i){const s={}
Object.assign(s,r),s[Kj]=bG,s[W$]=n,s[pR]=t
const a=["impressionsSnapshot",RU]
return a.push(lS),o&&a.push(...o),Ft(e,s),Dt(0,new uK(s,a,[],$t(e,s),xt(e,s,null,i)))}function Lt(e,t,n,r,o,i,s){const a={}
Object.assign(a,i),a[ZG]=t,a[W$]=n,a[$G]=r,o&&(a[MN]=o),a[Kj]=bq
const c=[MM]
return s&&c.push(...s),Ft(e,a),Dt(0,new uK(a,c,[],$t(e,a),xt(e,a)))}function Mt(e,t,n,r,o){const i={}
Object.assign(i,t),i[Kj]=vH,i[xN]="data-metrics",i[$N]=4
const s=[vH,RU,MM]
return s.push(lS),n&&s.push($M),r&&s.push(FN),o&&s.push("impressionsAppendix"),Ft(e,i),Dt(0,new uK(i,s,[$N],$t(e,i),xt(e,i)))}function xt(e,t,n=null,r){var o,i
const a=t[Kj]
let c=!1
if(!s(a))return c
const l=null!=r&&r
switch(a){case bG:c=u(t,lK.hasIAdData)||l
break
case vR:c=!0
break
case vH:c=u(t,lK.hasIAdData),t[xN]!==wR||(null===(o=null==n?void 0:n.adPageInfo)||void 0===o?void 0:o.placementType)!==KH&&(null===(i=null==n?void 0:n.adPageInfo)||void 0===i?void 0:i.placementType)!==wH||(c=!0)
break
case wW:c=e.host.clientIdentifier===lY&&(u(t,lK.hasIAdData)||l)}return e.host.clientIdentifier,c}function $t(e,t){return t[c$]||e.bag.metricsTopic}function Ft(e,t){e.bag.isMetricsAb2DataFallbackEnabled&&(0,Hv.isSome)(e.experimentCache)&&(t.alt_ab2_data=JSON.stringify(e.experimentCache.createAb2Data()))}function Nt(e){var t
const n={}
if(!e)return n
Object.assign(n,e.baseFields),e.pageUrl?n[DU]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(n[DU]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(n,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(n,e.mercuryMetricsData),e.productVariantData&&Object.assign(n,We(e.productVariantData)),e.adPageInfo&&i(e.adPageInfo.pageFields[lK.hasIAdData])&&(n[lK.hasIAdData]=e.adPageInfo.pageFields[lK.hasIAdData])
const r=null===(t=e.adPageInfo)||void 0===t?void 0:t.pageFields[PG]
return i(r)&&(n[PG]=r),ph(n)}function Bt(e){return A(e)&&"TodayCard"===e[gW]}function Ut(e,t){return s(B(t,xG))}function Gt(e,t,n,o,i=!0,s){if(!o.isAdvert)return void Vt(e,t,n,o)
n.searchAdOpportunity=function(e,t,n,o){const i=function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=B(t,xG),a=j(t,"iad.impressionId"),c=j(t,"iad.privacy"),l=j(t,CM),u=new pK(c)
u.title=e.adsLoc.string("IAD_PRIVACY_MARKER_BUTTON_TITLE")
const d=qf(e,t)?xB:IM,f=H(t,wq)?ZV:aW,h=Yt(0,n),p=new HY(i,t.id,l,d,"markerPress",f,h),w=Wt(i,n,a,o),g=zt(0,u,p)
return new wK(i,s,w,a,g)}(e,t,n,o)
return new hK(i.instanceId,i.eventPayloads,i)}(e,t,o.pageInformation,s)
const a=n.searchAdOpportunity.searchAd,c=qf(e,t)?xB:IM,l=Yt(0,o.pageInformation),u=j(t,CM),d=H(t,wq)?ZV:aW,f=new HY(a.instanceId,t.id,u,c,Wb,d,l)
n.clickAction=zt(0,n.clickAction,f)
const h=new HY(a.instanceId,t.id,u,c,zb,d,l)
n.buttonAction=zt(0,n.buttonAction,h),n.itemBackground=e.clientCapabilities.isEnabled("insetAdItemBackground")?oR:"ad",n.offerDisplayProperties&&i&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Ej,"ad")),H(t,"iad.format.userRating")||(n.rating=null,n.ratingCount=null),Vt(e,t,n,o)}function jt(e){const t=u(B(e,xG),"passthroughAdInfo.deepLinkEligible"),n=u(e,"meta.passthroughAdInfo.deepLinkEligible")
return t||n}function Vt(e,t,n,o){const i=Nh(e,t,n,vh(e,t,n.icon,null),o,!0)
!function(e,t,n){var o,i,s,a,c,l,u,d,f,h,p,w
const g=null!==(i=null===(o=t.searchAdOpportunity)||void 0===o?void 0:o.searchAd)&&void 0!==i?i:t.searchAd
if(r(g))return
null===(s=t.clickAction)||void 0===s||s.actionMetrics.clearAll(),t.clickAction&&Qs(e,t.clickAction,n,!0)
const v=n.pageInformation,m={actionType:"ad_transparency"};(null==v?void 0:v.adPageInfo)&&Object.assign(m,v.adPageInfo.clickFields),(null===(c=null===(a=null==n?void 0:n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType)===lq&&(0,Wv.isSome)(null===(l=null==n?void 0:n.adsMetricsData)||void 0===l?void 0:l.iAdSlotId)&&(m[oF]=null===(u=null==n?void 0:n.adsMetricsData)||void 0===u?void 0:u.iAdSlotId),(0,Wv.isSome)(null===(d=null==n?void 0:n.adsMetricsData)||void 0===d?void 0:d.iAdDuplicateLayoutType)&&(m[QM]=null===(f=null==n?void 0:n.adsMetricsData)||void 0===f?void 0:f.iAdDuplicateLayoutType)
const y=_t(e,t.adamId,hW,m)
null!==(w=null===(p=null===(h=null==v?void 0:v.adPageInfo)||void 0===h?void 0:h.shouldIncludeAdRotationFields)||void 0===p?void 0:p.call(h,e))&&void 0!==w&&w&&y.includingFields.push(FN),g.transparencyAction.actionMetrics.addMetricsData(y)}(e,n,i),Fh(e,n,i,i.pageInformation.adPageInfo)}function Ht(e){var t
return[Yb,"U","I",(null!==(t=null==e?void 0:e.artwork)&&void 0!==t?t:[]).length].join("")}function qt(e,t){let n
const r=null==t?void 0:t.adPageInfo.placementType
if((0,Hv.isSome)(r))try{n=e.ads.getIdentifierForMissedOpportunity(r)}catch{n=e.random.nextUUID(),Zt(e,`Error: getIdentifierForMissedOpportunity threw exception. Assigned ${n}`)}else n=e.random.nextUUID(),Zt(e,`Error: placementType was null or empty. Assigned ${n}`)
const o=Wt(n,t,e.random.nextUUID())
return new hK(n,o)}function Wt(e,t,n,r){const o=null==t?void 0:t.baseFields.pageId,i=typeof o===Bq?o:qq
return{placed:{adInstanceId:e,impressionId:null!=n?n:void 0,slot:null!=r?r:void 0,pageIdentifier:i},pageEnter:{pageIdentifier:i},pageExit:{pageIdentifier:i},onScreen:{adInstanceId:e},offScreen:{adInstanceId:e},visible:{adInstanceId:e},completed:{adInstanceId:e}}}function zt(e,t,n){const r=new gK(n),o=new ZJ([r,t])
return o.title=t.title,o}function Yt(e,t){const n=null==t?void 0:t.adPageInfo
if(r(n))return OU
const o=n.placementType
switch(o){case AV:return Kb
case lq:return"searchAds"
case zq:case KH:case wH:return Kb
default:throw new Error(`This method should never be called with value: ${o}`)}}function Jt(e){return!!function(e){return e.host.clientIdentifier===oY||e.host.clientIdentifier===lY}(e)||e.host.platform===qq}function Kt(e,t){if(!Jt(e))return!1
switch(t){case AV:const n=en(t)
return(0,Hv.isSome)(n)?e.bag.isSearchLandingAdsEnabled||e.bag.enabledAdPlacements.includes(n):e.bag.isSearchLandingAdsEnabled
case lq:return!0
case zq:const o=en(t)
return!r(o)&&e.bag.enabledAdPlacements.includes(o)&&(0,Hv.isSome)(Qt(e))
case KH:case wH:const i=en(t)
return!r(i)&&e.bag.enabledAdPlacements.includes(i)
default:return!1}}function Zt(e,t){e.console.log(`[Ads] ${t}`),e.client.buildType===nG&&e.isAvailable(qz)&&i(e.ads.debugLog)&&((0,Hv.isNothing)(LK)&&(0,Hv.isSome)(e.ads.isNativeAdLoggingEnabled)&&(LK=e.ads.isNativeAdLoggingEnabled()),LK&&e.ads.debugLog(t))}function Qt(e){if(e.bag.todayAdMediumLockupScreenshotEnabled)return oq
if(e.bag.todayAdCondensedEnabled){if(!e.client.isPhone)return
return Jx}return function(e){return!!e.client.isPhone&&Ne(e,Zv.CondensedTodayAds)===fK}(e)?Jx:void 0}function Xt(e,t,n){var r,o,i,s,a
const c=e.bag.adPlacementTimeouts,l=.3
switch(t){case lq:return n?null:null!==(r=null==c?void 0:c["search-results-in-seconds"])&&void 0!==r?r:l
case AV:return n?null:null!==(o=e.bag.searchLandingAdFetchTimeout)&&void 0!==o?o:l
case zq:return n?null!==(i=null==c?void 0:c["today-in-seconds"])&&void 0!==i?i:l:null
case KH:return n?null:null!==(s=null==c?void 0:c["product-page-ymal-in-seconds"])&&void 0!==s?s:l
case wH:return n?null:null!==(a=null==c?void 0:c["product-page-ymal-during-download-in-seconds"])&&void 0!==a?a:l
default:return l}}function en(e){switch(e){case lq:return JF
case AV:return KF
case zq:return zq
case KH:return"product-page-ymal"
case wH:return"product-page-ymal-during-download"
default:return}}function tn(e){return e.bag.enableSRPNextSlot&&e.clientCapabilities.isEnabled(vY)}function nn(e){return e.bag.enableSRPV5Impressions&&e.clientCapabilities.isEnabled(vY)}function rn(e,t){return t===lq&&nn(e)}function on(e,t){return t===lq&&!nn(e)}function sn(e,t){var n
if(!tn(e))return
const r=f(t,lA)
if((0,Hv.isNothing)(r))return
const o=null===(n=w(JSON.parse(r).intendedSlots))||void 0===n?void 0:n.filter(e=>typeof e===ej)
return(0,Hv.isNothing)(o)?void 0:o}function an(e,t,n,r){if((0,Hv.isNothing)(t))return
if(n)switch(t){case AV:return
case lq:if(!nn(e))return}if(t===lq){const t=sn(e,r)
if((0,Hv.isSome)(t)&&t.length>0)return t.map(e=>({shelfIdentifier:JF,slot:e}))}const o=en(t)
return(0,Hv.isNothing)(o)?void 0:e.bag.adPlacementEligibleSlotPositions[o]}function cn(e,t,n,r,o){var i
if((0,Hv.isNothing)(n)||(0,Hv.isNothing)(t))return!1
const s=null===(i=Ch(n))||void 0===i?void 0:i.id
if((0,Hv.isNothing)(s))return!1
const a=ln(e,t,s,r,o),c=Ih(n)
return a.includes(c)}function ln(e,t,n,r,o){const i=an(e,t,r,o)
if((0,Hv.isNothing)(i))return[]
const s=[]
for(const e of i)e.shelfIdentifier===n&&s.push(e.slot)
return s}function un(e,t,n,o,i){var s,a,c,l
if(!Jt(e)||r(i.adPageInfo))return
const u=ln(e,n,o,!1)
if(0===u.length)return
const d=[]
for(const e of t){if(e.contentType!==Iq&&e.contentType!==Bj)continue
const t=e.items;(0,Hv.isSome)(t)&&t.length>0&&d.push(...t)}for(const t of u){const n=null===(s=i.adPageInfo)||void 0===s?void 0:s.missedOpportunityReason(o,t)
if((0,Hv.isNothing)(n)||n===uA||n===dA)return
const r=d[t]
if((0,Hv.isSome)(r.searchAdOpportunity))return
if(Bt(r)&&(0,Hv.isSome)(null===(a=r.media)||void 0===a?void 0:a.searchAdOpportunity))return
r.searchAdOpportunity=qt(e,i),null===(c=r.searchAdOpportunity)||void 0===c||c.setMissedOpportunityReason(n),null===(l=r.searchAdOpportunity)||void 0===l||l.setTemplateType(rG)}}function dn(e,t,n,o=null){var i,s
return!Jt(e)||r(n)?null:new Q0(e,t,Q0.createInitialPageSlotInfos(e,t,null===(i=null==n?void 0:n.onDeviceAd)||void 0===i?void 0:i.positionInfo,o,void 0),n.iAdId,n.clientRequestId,void 0,null===(s=n.onDeviceAd)||void 0===s?void 0:s.positionInfo)}function fn(e,t){return j(t,MK)}function hn(e,t,n){s(null==t?void 0:t.attributes)&&(t.attributes[MK]=n)}function pn(e,t,n,r){var i,a,c,l,u
const d=e.bag.adsOverrideLanguage
if(o(d)||o(t))return!0
let f=null===(i=t.meta)||void 0===i?void 0:i.resource
if(o(f)&&s(n)&&(f=null===(u=null===(l=null===(c=null===(a=null==n?void 0:n.appMetadata)||void 0===a?void 0:a.data)||void 0===c?void 0:c[0])||void 0===l?void 0:l.meta)||void 0===u?void 0:u.resource),o(f))return!1
if(j(f,"name.locale")!==d)return!1
const h=Qe(e,t,RH),p=Qe(e,f,"subtitle.locale")
if(s(h)&&p!==d)return!1
if(r===RK){const n=j(t,fA)
if((0,Hv.isSome)(n)&&n!==mq){let r
const o=n
r=n===Cq?LG:n
const i=Qe(e,t,r),a=Qe(e,f,o.concat(".locale"))
if(s(i)&&a!==d)return!1}}return!0}function wn(e,t,n){const r=n.reco_algoId
if(o(r)||o(e)||o(t[r]))return e
const i=e.map(e=>{var t
return{identifier:h(e.id),score:null!==(t=h(e,ax))&&void 0!==t?t:0}}),s=t[r],a=(0,cm.demoteByEngagements)(i,s),c=e.reduce((e,t)=>({...e,[t.id]:t}),{})
return a.map(e=>c[e.identifier.toString()])}function gn(e,t){if(!s(t))return{}
const n=p(t,"data.engagementEvents.impression"),r={}
for(const e in n)if(s(e)){const t=l(n,e)
r[e]=t.map(e=>({adamIdentifier:h(e[FV]),timestamp:h(e.eventTimeMillis)}))}return r}function vn(e){return e.bag.enableRecoOnDeviceReordering}function mn(e){return e===GK.Apps.toString()?FK:e===GK.Games.toString()?NK:$K}function yn(e){const t=e.categories
if(s(t)){const e=t[0].genreId
if(e===GK.Games.toString())return NK
if(e===GK.Apps.toString())return FK}return $K}function An(e,t,n=e.host.clientIdentifier,r=[]){t||(t=GK.Apps)
const o=new dY(e).forType(nB).includingAdditionalPlatforms(r).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAgeRestrictions().addingQuery(PH,`${t}`)
return n===iY?o.addingContext(cW):n===sY&&o.addingContext(sq),o}function Tn(e,t,n=!0){return qv.context("categoryListFromApiResponse",()=>{const r=l(t,"results.categories"),o=bn(e,p(r,"0"),n)
return o?new BK(o.children):null})}function bn(e,t,n=!0){return qv.context("categoryFromApiResponse",()=>{if(!t)return null
const r=f(t,fW),o=f(t,PH),s=f(t,rB),a=Zd(e,p(t,oW),{allowingTransparency:!0,useCase:y6.CategoryIcon}),c=l(t,oH).map(t=>bn(e,p(t),n)).filter(e=>i(e)),u=function(e,t){return t.sort((t,n)=>{try{return t.name.localeCompare(n.name,e.loc.safeIdentifier,{usage:JV})}catch(e){return 0}})}(e,c),d=f(t,YH)
return d&&n&&u.unshift(new UK(d,o,a,s,[])),new UK(r,o,a,s,u)})}function Sn(e,t,n=!1,r=!1,o=!0){const i=n?"contentIconTrimmedMonochrome":"contentIconTrimmed",s="brandLogo",a=Ke(e,t,$q)
if(r)return p(a,s)
{let e=p(a,i)
return o&&(0,Hv.isNothing)(e)&&(e=p(a,s)),e}}function Pn(e){const t=j(e.data,SN)
return t===fm.Horizontal?fm.Horizontal:t===fm.Condensed?fm.Condensed:fm.Vertical}function In(e,t){if(!t.isFirstRender)return s(t.remainingItems)?t.remainingItems:[]
const n=we(t.data,uW)
return s(n)?n:[]}function Cn(e,t){let n=null
switch(t.type){case Xq:case XH:case vU:n=pe(e,t,bH)||pe(e,t,OH)||pe(e,t,uW)||pe(e,t,Jq)
break
case dW:case JH:case Zq:n=t}return n}function kn(e,t){if(o(t))return null
const n=l(t.meta,"associations.editorial-cards.data")
return o(n)?null:n[0]}function On(e,t){return g({...B(t,aj,{}),...B(kn(0,t),aj,{})})}function En(e){return{showAppIcon:d(e.showAppIcon,!1),suppressLockup:d(e.suppressLockup,!1),useGeneratedBackground:d(e.useGeneratedBackground,!1),useMaterialBlur:d(e.useMaterialBlur,!0),useTextProtectionColor:d(e.useTextProtectionColor,!1)}}function Rn(e,t){if(!W(t))return null
let n
return n=t.type===Xq?rh(e,t):t,W(n)?n:null}function Dn(e,t){const n=s(B(t,Mq)),r=H(t,uU)
return!n&&!r}function _n(e,t){const n=t.type
return n!==lm.Collection&&n!==lm.Recommendations?null:j(t,CH)}async function Ln(e,t,n){var r
const o=Date.now(),i=await e.mediaToken.refreshToken(),s=e.fetchTimingMetricsBuilder,a=null!=n?n:{},c=null===(r=e.personalizationMetricsIdentifiersCache)||void 0===r?void 0:r.getMetricsIdForType(em.user);(0,Wv.isSome)(c)&&((0,Wv.isSome)(null==a?void 0:a.headers)?a.headers[VK]=c:a.headers={[VK]:c})
const l=await xn(e,t,i,a,!1,s),u=Date.now()
t.canonicalUrl&&(l[mm.requestedUrl]=t.canonicalUrl)
const d=u-o
if(d>500){const n=ve(e,t).toString()
e.console.warn("Fetch took too long ("+d.toString()+"ms) "+n)}return l}function Mn(e,t){return e.bag.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return i(null===(n=t.query)||void 0===n?void 0:n[e])})}async function xn(e,t,n,a={},c=!1,l){var d,f
const p=ve(e,t).toString(),w=new az(p),g=Mn(e,w)
for(const e of g)w.removeParam(e)
const v=w.toString()
let m=a.headers
m||(m={}),m.Authorization="Bearer "+n
const A=await e.network.fetch({url:v,headers:m,method:a.method,body:a.requestBodyString,timeout:a.timeout})
try{if(401===A.status||403===A.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
return e.mediaToken.resetToken(),await e.mediaToken.refreshToken().then(async n=>await xn(e,t,n,a,!0,l))}if(404===A.status)throw $n()
if(!A.ok){const e=new HK(`Bad Status code ${A.status} for ${v}, original ${p}`)
throw e.statusCode=A.status,e}const n=n=>{var c,l
const d=Date.now()
let f
if(r(n.body)||""===n.body){if(204!==n.status)throw $n()
f={}}else try{f=JSON.parse(n.body)}catch(t){let r=t.message
throw[GG,nG].includes(e.client.buildType)&&(r=`${t.message}, body: ${n.body}`),new qK(r)}const w=Date.now()
if(f){if(f[mm.pageInformation]=y(function(e,t){const n=e.client.storefrontIdentifier
let r=null
if((null==n?void 0:n.length)>0){const e=n.split("-")
s(e)&&(r=e[0])}return{serverInstance:t.headers[WK],storeFrontHeader:n,language:e.bag.language,storeFront:r,environmentDataCenter:t.headers[zK]}}(e,n)),n.metrics.length>0){const e={...n.metrics[0],parseStartTime:d,parseEndTime:w}
f[mm.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:d,parseEndTime:w}
f[mm.timingValues]=e}if(f[mm.contentMaxAge]=function(e,t){const n=Object.keys(t.headers).find(e=>"cache-control"===e.toLowerCase())
if(r(n)||""===n)return null
const i=t.headers[n]
if(o(i))return null
const s=i.match(/max-age=(\d+)/)
return r(s)||s.length<2?null:h(s[1])}(0,n),Array.isArray(f.data)&&i(l=f.data)&&0===l.length&&!u(a.allowEmptyDataResponse))throw $n()
Array.isArray(f.data)&&t.originalOrdering.length>1&&(f.data=function(e,t,n,r=[]){const o={}
for(const e of n)o[e.id]=e
const i=[]
for(const e of t){const t=o[e.id]
if((0,Wv.isSome)(t)){if(s(r)){t.meta={...e.meta}
for(const n of r)Fn(0,n,t,e,o)}i.push(t)}}return i}(0,t.originalOrdering,null!==(c=f.data)&&void 0!==c?c:[],t.supplementaryMetadataAssociations)),f[mm.requestedUrl]=p}return f}
return(0,Wv.isSome)(l)?l.measureParsing(A,n):n(A)}catch(e){if(e instanceof HK)throw e
const t=null!==(d=A.headers["x-apple-jingle-correlation-key"])&&void 0!==d?d:null===(f=A.metrics[0])||void 0===f?void 0:f.clientCorrelationKey
throw new Error(`Error Fetching - filtered: ${v}, original: ${p}, correlationKey: ${null!=t?t:"N/A"}, ${e.name}, ${e.message}`)}}function $n(){const e=new HK("No content")
return e.statusCode=204,e}function Fn(e,t,n,r,o){var i;(0,Wv.isNothing)(n.meta)?n.meta={associations:{}}:(0,Wv.isNothing)(n.meta.associations)&&(n.meta.associations={})
const a=re(t,r)
if(s(a)){const e=[]
for(const t of a){const n=o[t.id];(0,Wv.isSome)(n)&&e.push(n)}(null!==(i=p(n.meta.associations))&&void 0!==i?i:{})[t]={data:e}}}function Nn(e){return T(e)&&e[gW]===xy}function Bn(e,t,n,r){const o=Ih(r.locationTracker),i={impressionIndex:o,id:o.toString(),idType:Aq,name:t.displayName,impressionType:n,parentId:rC}
t.impressionMetrics=new jY(i)}function Un(e,t,n,r,o,s){var a,c,l
const u=null!==(a=g(r,mm.pageInformation,{}))&&void 0!==a?a:{},d=g(r,mm.timingValues),h=f(r,mm.requestedUrl)
let p
const w=u
if(w.pageType=t,w.pageId=n,o&&(w[MU]=o),t===_V){const t=yt(e,r)
if((0,Wv.isSome)(t)){const n=j(t,fW),r=j(t,sH)
w[MU]=`${r}_${n}`,qf(e,t)&&(w[BN]=vq),p=Ge(e,t)}}else t===WE?w[MU]=`${t}_${n}`:t===$V?w[MU]=xS:t===IG&&n===IG&&(w[MU]=`${t}_${n}`)
const v=new nK(null!==(c=ph(w))&&void 0!==c?c:{})
null!==d&&(v.timingMetrics=d,(0,Wv.isSome)(h)&&(v.pageUrl=h)),i(p)&&(v.productVariantData=p)
const m=null!=s?s:Ys(e,n,r)
return(0,Wv.isSome)(m)&&(v.adPageInfo=m),v.recoMetricsData=null!==(l=St(r))&&void 0!==l?l:void 0,v}function Gn(e,t,n,r,o){var i
const s=new nK({pageType:t,pageId:n,page:`${t}_${n}`,pageDetails:r})
if(o){const t=Q0.placementTypeFromPlacementId(e,f(o,SG))
s.adPageInfo=new Q0(e,t,Q0.createInitialPageSlotInfos(e,t,null,null,null),null!==(i=f(o,PG))&&void 0!==i?i:void 0),s.adPageInfo.applyClickFieldsFromPageRequest(n,o)}return s}function jn(e,t,n,o,i){if(r(n))return
t.pageMetrics.pageFields=Nt(n),t.pageMetrics.addManyInstructions(Qn(e,n,o)),t.pageMetrics.addData(Jn(e,n,o,i),[Am.PageInvocationPoint.pageEnter]),t.pageMetrics.addData(function(e,t,n){const r=Jn(e,t,n)
return r.fields[Kj]=wS,r}(e,n,o),[Am.PageInvocationPoint.pageExit]),t.pageMetrics.pageRenderFields=Zn(e,n,o),t.pageRenderMetrics=Zn(e,n,o),function(e){const t=A(o=e)&&o[gW]===eV,n=function(e){return A(e)&&e[gW]===fy}(e),r=function(e){return A(e)&&e[gW]===my}(e)
var o
return!t&&!n&&!r}(t)&&t.pageMetrics.addData(Kn(e,n,o),[Am.PageInvocationPoint.backButton])
const s=e.fetchTimingMetricsBuilder;(0,Wv.isSome)(s)&&s.decorate(t)}function Vn(e,t){return new nK({pageType:qH,pageId:t,page:`${qH}_${t}`})}function Hn(e,t,n,r){const o={pageId:J$,pageType:$V}
r&&(o[sZ]=r)
const i=new nK(o)
return i.pageUrl=n,i}function qn(e,t,n,r,i,a,c,l,u){const d=Un(e,$V,a,n)
return d.searchTermContext=r,d.pageUrl=i,u&&(d.guidedSearch=function(e,t,n){const r={}
if(s(t.guidedSearchTokens)&&(r.searchSelectedGuidedFacets=t.guidedSearchTokens),n&&n.finalTerm&&(r.searchGuidedFinalQuery=n.finalTerm),!o(r))return r}(0,t,u)),Jt(e)&&(0,Wv.isSome)(c)&&(d.adPageInfo=new Q0(e,lq,Q0.createInitialPageSlotInfos(e,lq,null,null,n.meta),c.iAdId,c.appStoreClientRequestId,l)),d}function Wn(e,t,n,r,o,s){let a="",c=""
switch(t){case ym.AppEvent:a=`${n}_${r}`,c=lB
break
case ym.ContingentOffer:case ym.OfferItem:a=`${n}`,c="OfferDetails"}const l={pageId:a,pageType:c}
i(o)&&(l[Z$]=o[Jq],l[NB]=o[tB])
const u=new nK(l)
return u.recoMetricsData=null!=s?s:void 0,u}function zn(e,t){if(r(t)||r(t.pageMetrics))return
const n=t.pageMetrics.instructions
if(!r(n))for(const e of n)e.data.fields[Kj]===wW&&e.data.includingFields.push(xM)
let o=null
if(vt(t)?o=t:mt(t)&&(o=t.lockup),o){const e=[]
if(Nn(o.buttonAction))e.push(o.buttonAction)
else if(T(i=o.buttonAction)&&i[gW]===Fy&&Nn(o.buttonAction.buyAction))e.push(o.buttonAction.buyAction)
else if(function(e){return T(e)&&e[gW]===$y}(o.buttonAction)&&Nn(o.buttonAction.completionAction))e.push(o.buttonAction.completionAction)
else if(gt(o.buttonAction)){if(Nn(o.buttonAction.buyAction)&&e.push(o.buttonAction.buyAction),Nn(o.buttonAction.defaultAction)&&e.push(o.buttonAction.defaultAction),Nn(o.buttonAction.openAction)&&e.push(o.buttonAction.openAction),ht(o.buttonAction.subscribePageAction)&&o.buttonAction.subscribePageAction.page===WO&&(0,Wv.isSome)(o.buttonAction.subscribePageAction.pageUrl)&&o.buttonAction.subscribePageAction.pageUrl.length>0){const e=az.from(o.buttonAction.subscribePageAction.pageUrl)
e.param(zW.includePostSubscribeAttribution,pq),o.buttonAction.subscribePageAction.pageUrl=e.build()}ht(o.buttonAction.subscribePageAction)&&function(e){return A(e)&&"MarketingItemRequestInfo"===e[gW]}(o.buttonAction.subscribePageAction.pageData)&&Nn(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)&&e.push(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const t of e)t.purchaseConfiguration&&(t.purchaseConfiguration.excludeAttribution=!1)}var i}function Yn(e){Object.keys(e).filter(e=>!lZ.has(e)).forEach(t=>delete e[t])}function Jn(e,t,n,r){var o,s,a,c,l,u
const d=Xn(t,n)
t.adPageInfo&&Object.assign(d,t.adPageInfo.pageFields),i(t.offerReleaseDate)&&(d[LR]=Ee(t.offerReleaseDate))
const f=t.searchTermContext
f&&(d[ZH]=f.term,f.suggestedTerm&&(d.searchSuggestedTerm=f.suggestedTerm),f.correctedTerm&&(d.searchCorrectedTerm=f.correctedTerm),f.originatingTerm&&(d[$R]=f.originatingTerm)),t.guidedSearch&&Object.assign(d,t.guidedSearch)
const h=function(e,t,n,r,o,i){const s={}
Object.assign(s,o),s[Kj]=wW,r&&(s[uS]=r.clientCorrelationKey,s.requestStartTime=r.requestStartTime,s.responseStartTime=r.responseStartTime,s.responseEndTime=r.responseEndTime)
const a=[RU,MM]
return a.push("userContentRestriction"),n&&a.push("crossfireReferralCandidate"),Ft(e,s),Dt(0,new uK(s,a,[],$t(e,s),xt(e,s,null,i)))}(e,0,null!==(o=t.isCrossfireReferralCandidate)&&void 0!==o&&o,t.timingMetrics,d,r),p=null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.adIsPresent)&&void 0!==a&&a,w=null!==(u=null===(l=null===(c=null==t?void 0:t.adPageInfo)||void 0===c?void 0:c.shouldIncludeAdRotationFields)||void 0===l?void 0:l.call(c,e))&&void 0!==u&&u
return p&&w&&h.includingFields.push(FN),h}function Kn(e,t,n){return function(e,t){const n={}
return Object.assign(n,t),n[$G]=rU,_t(e,rU,hW,n)}(e,Xn(t,n))}function Zn(e,t,n){const r=Xn(t,n)
return t.searchTermContext&&(r[ZH]=t.searchTermContext.term),t.baseFields&&Object.assign(r,t.baseFields),function(e,t,n){const r={}
return Object.assign(r,n),r[Kj]="pageRender",t&&(r[DU]||(r[DU]=t.pageURL),r[uS]=t.clientCorrelationKey,r.platformRequestStartTime=t.requestStartTime,r.platformResponseStartTime=t.responseStartTime,r.platformResponseEndTime=t.responseEndTime,r.platformResponseWasCached=t.responseWasCached,r.platformJsonParseStartTime=t.parseStartTime,r.platformJsonParseEndTime=t.parseEndTime),Ft(e,r),r}(e,t.timingMetrics,r)}function Qn(e,t,n){var r,o,s,a
const c=Xn(t,n)
t.searchTermContext&&(c[ZH]=t.searchTermContext.term)
const l=S(c)
t.adPageInfo&&Object.assign(l,t.adPageInfo.impressionsFields),t.guidedSearch&&Object.assign(l,t.guidedSearch)
const u=i(t.adPageInfo),d=null!==(o=null===(r=t.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad(e))&&void 0!==o&&o,f=[{data:Mt(e,l,u&&d,null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields(e))&&void 0!==a&&a,!0),invocationPoints:[Am.PageInvocationPoint.appExit,Am.PageInvocationPoint.pageExit]}]
if(u){const n=function(e,t,n){var r,o,s,a,c,l
const u=null!==(s=null===(o=null===(r=null==n?void 0:n.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad)||void 0===o?void 0:o.call(r,e))&&void 0!==s&&s,d=null!==(l=null===(c=null===(a=null==n?void 0:n.adPageInfo)||void 0===a?void 0:a.shouldIncludeAdRotationFields)||void 0===c?void 0:c.call(a,e))&&void 0!==l&&l,f=[],h=Mt(e,t,u,d,!1).fields
if(h[xN]=wR,null!==n&&i(n.adPageInfo)){const t=n.adPageInfo.fastImpressionsEventVersion(e)
h[$N]=t,f.push($N),5===t&&(h.viewableArea="excludingTabBar",delete h[SG])}const p=["fastImpressions",RU,MM]
return u&&p.push($M),d&&p.push(FN),Dt(0,new uK(h,p,f,$t(e,h),xt(e,h,n)))}(e,l,t)
f.push({data:n,invocationPoints:[Am.PageInvocationPoint.appExit,Am.PageInvocationPoint.pageExit,Am.PageInvocationPoint.timer]})}return f}function Xn(e,t){const n={}
return i(e.offerType)&&(n[iF]=e.offerType),void 0!==t&&n&&t(n),n}function er(e,t){const n=et(e,t,"usesExternalPurchase"),r=et(e,t,"usesExternalLinkPurchase")
return n||r}function tr(e,t){return e.bag.enableExternalPurchases&&e.bag.enabledExternalPurchasesPlacements.includes(t)}function nr(e,t,n,r){const i=e.bag.externalPurchasesLearnMoreEditorialItemId
if(o(i)||!e.bag.enableExternalPurchases)return null
const s=new EY(Tq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Qs(e,s,{id:oU,targetType:Mq,actionType:pW,pageInformation:n,locationTracker:r}),s}function rr(e){switch(e){case wy:case Q_:case eH:case Hx:return!0
default:return!1}}function or(e,t,n=!1){const r=j(t,"ageRating.name")
return(0,Hv.isSome)(r)?r:n?j(t,aT):void 0}function ir(e,t,n=!1){const r=q(t,cT)
return(0,Hv.isSome)(r)?r:n?q(t,"contentRatingsBySystem.appsApple.value"):void 0}function sr(e,t){const n=new Map([["br.100.official",uT],["br.100",dT],["br.210.official",fT],["br.210",hT],["br.300.official",pT],["br.300",wT],["br.314.official",gT],["br.314",vT],["br.416.official",mT],["br.416",yT],["br.618.official",AT],["br.618",TT]]),r=e.locale.activeStorefront+"."+j(t,cT)+(H(t,"ageRating.isOfficial")?".official":"")
return n.get(r)}function ar(e,t){var n
if(t<=0)return!1
if(t>=1)return!0
const r=null===(n=e.metricsIdentifiersCache)||void 0===n?void 0:n.getMetricsIdForType(em.user)
return!(0,Hv.isNothing)(r)&&0!==r.length&&!(r.length<2)&&function(e){function t(e){const t=e.charCodeAt(0)
return t>=48&&t<=57?52+t-48:t>=65&&t<=90?26+t-65:t>=97&&t<=122?t-97:t}const n=e.slice(-2)
return(62*t(n[0])+t(n[1]))/3843}(r)<t}function cr(e,t){switch(ur(e,t)){case gL:case Xx:case mL:case vL:case WT:return!0
default:return!1}}function lr(e,t){return ar(e,e.bag.gameControllerRecommendedRolloutRate)&&ur(e,t)===WT}function ur(e,t){const n=rt(e)
if(null===n)return XU
if(!ie(t,n)){const r=Ke(e,t,AH)
if(null===r||o(r))return XU
const i=r[n]
return o(i)?XU:i}const r=Qe(e,t,bj)
return s(r)?r:XU}function dr(e,t){return rt(e),zT}function fr(e,t=null){return e===lW?function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER"
return e&&(t+=`&installMajorOSBundle=${e}`),t}(t):null}function hr(e){var t
return null===PZ&&(PZ=new lK({defaultTopic:e.bag.metricsTopic,buildType:e.client.buildType,jsVersion:null!==(t=e.packageProperties.asString(PE))&&void 0!==t?t:qq,buyDecorator:SZ,isLoggingEnabled:!0,bagProvider:(t,o)=>{const i=e.bag.metricsConfiguration
if(!r(o)){const e=n(i,[o,t])
if(!r(e))return e}return n(i,t)}})),PZ}function pr(e,t,n,a,c,l,u,d,h,p,w,g,v,m,A){const T=function(e,t){const n=new oK(t),r=f(e.bag.metricsConfiguration,"metricsBase.language")
return n.set("languageId",r),n.toString()}(e,n)
return function(e,t,n,o,s,a,c){const l=new oK(t)
return function(e,t,n,o,s,a,c){var l,u
const d=f(a,K$)
t.set(K$,d)
const h=e.clientCapabilities.isEnabled(DR)?e.bag.metricsPaymentTopic:void 0
t.set(c$,null!=h?h:e.bag.metricsTopic),SZ.useNativeValues(a)
const p=SZ.params
for(const e of Object.keys(p)){if(e===JM&&(0,Wv.isSome)(t.get(JM)))continue
const n=f(p,e)
t.set(e,n)}if(!r(c))for(const e of Object.keys(c)){const n=f(c,e)
t.set(e,n),t.set(e,n,null)}if(!a)return t.set(ZH,null),void t.set(KM,null)
const w=f(a,LU);(0,Wv.isSome)(w)&&w.length>0&&t.set(LU,w)
const g=f(a,DS);(0,Wv.isSome)(g)&&g.length>0&&t.set(DS,g)
const v=(null===(l=t.get(CS,null))||void 0===l?void 0:l.length)>0,m=f(a,Jq)
if(v?t.set(Jq,e.host.clientIdentifier):(0,Wv.isSome)(m)&&m.length>0&&t.set(Jq,m),!o&&!yW.shared.shouldUseJSReferralData){const e=f(a,rF),n=hh(e)
e&&n&&(a[Z$]=n)
const r=f(a,"usageContext")
if((0,Wv.isSome)(r)){switch(r){case mH:t.set(LU,"com.apple.AppStore.overlay")
break
case _R:t.set(LU,RR)}t.set(nF,w,null)}else{const e=f(a,nF)
t.set(nF,e,null)
const n=f(a,rF)
t.set(rF,n,null),f(a,"extRefAppType")===ES&&t.set(LU,RR)}}const y=t.get(WG),A=t.get(Zj),T=(null!==(u=null==y?void 0:y.split("_"))&&void 0!==u?u:[]).includes(n)
if(A!==_V||T){const e=gh(f(a,BB))
i(e)&&t.set(ZH,e)}t.set(pS,null,null)}(e,l,n,o,0,a,c),l.toString()}(e,function(e,t,n,a,c,l,u,d,h,p,w,g){const v=new oK(t)
return function(e,t,n,s,a,c,l,u,d,h,p,w){var g,v,m
const A=Nt(s)
a&&t.set(NN,a),c&&t.set(DH,c)
const T=f(y(A),WG)
t.set(WG,T)
const b=f(y(A),Zj)
t.set(Zj,b)
const S=f(y(A),UB);(0,Wv.isSome)(S)&&S.length>0&&t.set(IZ.containerId,S,null)
const P=(null!==(g=null==T?void 0:T.split("_"))&&void 0!==g?g:[]).includes(n),I=b===_V,C=(null===(v=t.get(CS,null))||void 0===v?void 0:v.length)>0
if(!I||P||C){let e=f(y(s),"searchTermContext.resultsTerm")
o(e)&&(e=function(e){if((0,Hv.isNothing)(e))return null
const t=new az(e),n=t.query,r=null==n?void 0:n[ZH],o=t.pathname
return(0,Hv.isNothing)(r)||(0,Hv.isNothing)(o)?null:o.includes("/app")?r:null}(null==s?void 0:s.pageUrl)),r(e)||t.set(ZH,e)}if(I&&(0,Wv.isSome)(s)&&(0,Wv.isSome)(s.pageUrl)&&(null===(m=new az(s.pageUrl).query)||void 0===m?void 0:m[OR])===kS&&(t.set(JM,ER),t.set(OS,"1",null)),function(e,t,n,r){const o=i(n)&&n.adamID===t,s=i(r)&&r.adamID===t&&!o
if(o&&i(n)){const t=We(n)
for(const n of Object.keys(t)){const r=f(t,n);(0,Wv.isSome)(r)&&e.set(n,r)}}if(s&&i(r)){const t=ze(r)
for(const n of Object.keys(t)){const r=f(t,n);(0,Wv.isSome)(r)&&e.set(n,r)}}}(t,n,null==s?void 0:s.productVariantData,null!=u?u:void 0),!r(l)&&l.length>0&&t.set(KM,l),t.set(a$,d),!h)if(i(yW.shared.activeReferralData)){if(t.set(nF,yW.shared.activeReferralData.extRefApp2,null),t.set(rF,yW.shared.activeReferralData.extRefUrl2,null),(0,Wv.isSome)(yW.shared.activeReferralData.kind)){const e=yW.shared.activeReferralData.kind.name
e!==ES&&"appClip"!==e||t.set(LU,RR)}}else t.set(nF,p,null),t.set(rF,w,null)}(0,v,n,a,c,l,u,d,h,p,w,g),function(e,t,n,r){var o
if((0,Wv.isNothing)(r))return
const i=[],a=r.adPageInfo
if((0,Wv.isSome)(a)){const e=(0,Wv.isSome)(a.clickFields[mR]),n=a.adAdamId===t
if(e&&n){const e=function(e,t){if((0,Wv.isNothing)(e))return!1
const n=e.baseFields[Zj]
switch(t.placementType){case AV:return n===IG
case zq:return n===RS
case KH:case wH:const r=e.baseFields[WG],o=t.adAdamId===r
return(n===_V||n===VM)&&!o
default:return n===$V}}(r,a)?"iAdSponsored":"iAdOriginated"
i.push({key:e,value:pq})}}if(s(i)){const t=i.map(e=>`${e.key}=${e.value}`).join(";"),r=null===(o=e.cryptography)||void 0===o?void 0:o.base64Encode(t);(0,Wv.isSome)(r)&&n.set("extraInfo",r)}}(e,n,v,a),v.toString()}(e,T,t,a,u,d,h,g,v,c,m,A),t,c,0,p,w)}function wr(e,t,n){return qv.context("offerDataFromData",()=>{const r=Ze(e,t,fj,n)
return 0===r.length?null:r[0]})}function gr(e,t){const n=G(t,fj)
return 0===n.length?null:n[0]}function vr(e,t,n,o,a,c,l,u=Lq,d,h,p){return qv.context(`offerActionFromOfferData: ${n.id}`,()=>{var w,g,v,m,y,A,T
let b=f(t,Sj)
if(r(b))return qv.unexpectedNull(SH,Bq,uR),null
if(n.type===Zq&&(b.indexOf("rebuy")>=0?b=b.replace("rebuy=false",nP):(b.length>0&&(b+="&"),b+=nP)),s(l.inAppEventId)&&(b.length>0&&(b+="&"),b+=`mtInAppEventId=${l.inAppEventId}`),l.isAdvert){const e=null===(g=null===(w=l.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementId
i(e)&&(b.length>0&&(b+="&"),b+=`${IZ.placementId}=${e}`)
const t=null===(m=null===(v=l.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===m?void 0:m.containerId
i(t)&&(b.length>0&&(b+="&"),b+=`${IZ.containerId}=${t}`)
const n=null===(A=null===(y=l.pageInformation)||void 0===y?void 0:y.adPageInfo)||void 0===A?void 0:A.clickFields[dj]
i(n)&&(b.length>0&&(b+="&"),b+=`${IZ.templateType}=${n}`)}const S=n.id
if(r(S))return qv.unexpectedNull(SH,Bq,"item.offer.id"),null
const P=function(e,t,n,r,o,i,s,a,c,l){return qv.context("purchaseConfigurationFromProduct",()=>{const u=j(t,fW)
let d=j(t,sH)
d||(d=tP)
const h=st(e).bundleIdFromData(t),p=pf(e,t),w=j(t,aS),g=Qe(e,t,"preflightPackageUrl"),v=qf(e,t),m=Af(0,t,e.appleSilicon.isSupportEnabled),y=f(c,Jq),A=f(c,tB),T=_r(e,t)?e.client.remoteDownloadIdentifiers:[],b=function(e,t){return et(e,t,HH)}(e,t),S=ir(0,t,!0),P=new yZ(n,d,u,h,p,r,o,s,w,!1,g,v,m,!1,a.inAppEventId,y,A,void 0,Tf(e,t),l,T,b,S)
return P.pageInformation={...i},P.productVariantData=Ge(e,t),P.targetType=a.targetType,P.metricsKind=a.kind,P})}(e,n,b,o,l.excludeAttribution,l.pageInformation,c,l,d,h),I=Tr(e,t,S,P,a,u,null!==(T=l.isAdvert)&&void 0!==T&&T,p)
return function(e,t,n,r,o){var i,s,a,c,l
const u=n.pageInformation,d={...n,targetType:hW},f=Ah(e,d,null!==(i=t.title)&&void 0!==i?i:"")
let h=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:t.adamId;(0,Wv.isSome)(n.targetId)&&(null===(c=n.targetId)||void 0===c?void 0:c.length)>0&&(h=n.targetId),Ks(e,t,h,r,u,f,null!==(l=n.isAdvert)&&void 0!==l&&l,n.recoMetricsData,o,d)}(e,I,l,o,h),I})}function mr(e,t){return r(t)||r(t.price)||0===t.price}function yr(e,t){return qv.context("expectedReleaseDateFromData",()=>Oe(j(t,"offers.0.expectedReleaseDate")))}function Ar(e,t){const n=f(t,kV)
return n===w$||n===nx||n===ZV?h(t,zF):null}function Tr(e,t,n,r,o,i=Lq,s=!1,a){return qv.context("offerActionFromOfferData",()=>{const c=f(t,kV),l=s&&i===Lq&&(0,Wv.isSome)(e.bag.adsOverrideLanguage)?e.adsLoc:e.loc
let u
switch(c){case"get":if(i===rV)u=e.loc.string(rP,"Get")
else{const e=rx
u=l.string(e)}break
case ZV:u=i===rV?e.loc.string(oP,"Pre-Order"):l.string(rx)
break
default:u=c}let d=null,h=null
const p=Ar(0,t)
p>0&&(d=p,h=f(t,nj))
const w=Oe(f(t,pU)),g=new nZ(u,n,r,a)
return g.price=d,g.priceFormatted=h,g.expectedReleaseDate=w,g.includeBetaApps=o,g})}function br(e,t,n,o,i,a=Lq,c=null,l=!1){if((0,Wv.isNothing)(t))return null
if(Yf(0,n)){if(a===rV)return null
if(a===Lq)return Fd(e,n,i,null)
const r=Qe(e,n,yq)
if(s(r)){const e=fr(lW,r)
if((0,Wv.isSome)(e)){const n=new GY(e)
return new VY(t.adamId,n)}}}if(a===Lq&&(n.type===Zq||Jf(e,n)||l))return Fd(e,n,i,null)
if(o&&"tv"!==e.client.deviceType&&!qf(e,n)){const o=function(e,t,n,o,i){if(r(t))return null
const s=Pr(e,n,t,!1,o)
return s.buyAction=t,s}(e,t,n,i)
if(null!==o)return o}const u=xe(e,n,XV),d=e.client.isCompanionVisionApp
if(!qf(e,n)&&(d||u&&e.client.deviceType!==Qq))return function(e,t,n,r,o){const i=Rr(e,t,n,r,o),s=new VY(t.adamId,i)
return s.title=t.title,s}(e,t,n,mr(0,t),qf(e,n))
if(xe(e,n,QG)&&"tv"!==e.client.deviceType)return function(e,t,n){const r=new LY(Lq)
r.title=e.loc.string("Alert.Buy.TvOnly.Title"),r.message=e.loc.string("Alert.Buy.TvOnly.Message"),r.isCancelable=!0,r.buttonActions=n?[Mr(e,t)]:[t],r.buttonTitles=[e.loc.string("Alert.Buy.TvOnly.ButtonTitle")]
const o=new VY(t.adamId,r)
return o.title=t.title,o}(e,t,et(e,n,Qx))
if(!et(e,n,fO)&&et(e,n,DG)&&e.client.deviceType!==cW)return function(e,t){const n=new LY(Lq)
n.title=e.loc.string("Alert.Buy.WatchOnly.Title"),n.message=e.loc.string("Alert.Buy.WatchOnly.Message"),n.isCancelable=!0,n.buttonActions=[t],n.buttonTitles=[e.loc.string("Alert.Buy.WatchOnly.ButtonTitle")]
const r=new VY(t.adamId,n)
return r.title=t.title,r}(e,t)
const f=Qe(e,n,WF)
if(s(c)&&c===iY&&(0,Wv.isSome)(f)&&Xf(e,f))return function(e,t,n){const r=new LY(Lq)
r.title=e.loc.string("ProductPage.WatchOSUpdateRequired.Title").replace(YG,n),r.message=e.loc.string("ProductPage.WatchOSUpdateRequired.Message").replace(YG,n),r.buttonActions=[t],r.buttonTitles=[e.loc.string(ML)]
const o=new VY(t.adamId,t)
return o.buyAction=r,o}(e,t,f)
if(function(e,t){return!!qf(e,t)}(e,n)){if(qf(e,n))return function(e,t,n,r,o,i,s){if(!qf(e,n))return t
switch(e.client.deviceType){case"tv":return function(e,t,n,r,o,i){var s,a,c,l
const u=kr(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new iZ(sW,o,e.bag.metricsTopic,n.id);(0,Wv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[ZH]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([em.user,em.client,em.canonical]);(0,Wv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new EY(Ij)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Zs(e,g,i),r){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=null,t}{const o=new VY(n.id,d),i=kr(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
case Qq:return function(e,t,n,r,o,i){var s,a,c,l
const u=Or(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new iZ(sW,o,e.bag.metricsTopic,n.id);(0,Wv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[ZH]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([em.user,em.client,em.canonical]);(0,Wv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new EY(Ij)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Zs(e,g,i),r&&null!==f){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=Cr(e,g),t}{const o=new VY(n.id,d),i=Or(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
default:return function(e,t,n,r,o,i,s){var a,c,l,u
const d=rr(i),f=new iZ(sW,i,e.bag.metricsTopic,n.id);(0,Wv.isSome)(null===(c=null===(a=s.pageInformation)||void 0===a?void 0:a.searchTermContext)||void 0===c?void 0:c.term)&&(f.metricsOverlay[ZH]=null===(l=s.pageInformation.searchTermContext)||void 0===l?void 0:l.term)
const h=null===(u=e.metricsIdentifiersCache)||void 0===u?void 0:u.getMetricsFieldsForTypes([em.user,em.client,em.canonical]);(0,Wv.isSome)(h)&&(f.metricsOverlay={...f.metricsOverlay,...h}),e.client.isCompanionVisionApp&&(0,Wv.isNothing)(f.metricsOverlay[LU])&&(f.metricsOverlay[LU]=Mz),d&&(f.purchaseSuccessAction=t,f.carrierLinkSuccessAction=t)
const p=new EY(Ij)
if(p.pageData=f,s&&s.pageInformation&&(p.referrerUrl=s.pageInformation.pageUrl),s.actionDetails={buyParams:t.purchaseConfiguration.buyParams,...s.actionDetails},Zs(e,p,s),r&&Nn(t)){const r=Pr(e,n,t,!0,s)
r.buyAction=t
const o=Pr(e,n,t,!0,s)
return o.buyAction=t,r.subscribePageAction=o,t.buyCompletedAction=Cr(e,p),r}const w=xe(e,n,XV)
if(_r(e,n)||w&&e.client.deviceType!==Qq){const r=Rr(e,t,n,!0,!0),o=Rr(e,p,n,!0,!0),i=new VY(n.id,r)
return i.subscribePageAction=new VY(n.id,o),i}const g=new VY(n.id,t)
return g.subscribePageAction=p,g}(e,t,n,r,0,i,s)}}(e,t,n,o,0,function(e,t,n){if(n)return pt(BF)
switch(t){case eH:return pt(eH)
case Lq:case rV:return pt(Hx)
default:return pt(mj)}}(0,a,o),i)
const s=function(e,t,n,o,i){return"tv"===e.client.deviceType?kr(e,t,null,n,o):{startAction:r(t)?null:t,underlyingOfferAction:null}}(e,t,n,o),c=s.startAction
if(o){const t=Pr(e,n,s.underlyingOfferAction,!1,i)
return t.buyAction=c,t}return c}return Er(e,t,o,i)}function Sr(e,t,n,r,o,i,s=null){switch(r){case pt(eH):case pt(Hx):const r=tf(e,t,{useCase:y6.LockupIconLarge}),a=Js(e,t,i)
return vr(e,wr(e,t),t,o,!1,vh(e,t,r,s),a,n)
default:return null}}function Pr(e,t,n,r,o){let i
if(r){const s=Ir(e,t,n.purchaseConfiguration.appName,r,!0,o),a=Ir(e,t,n.purchaseConfiguration.appName,r,!1,o)
i=new AZ(a,a,s,a)}else i=Ir(e,t,n.purchaseConfiguration.appName,!1,!1,o)
return new VY(t.id,i)}function Ir(e,t,n,r,o,i){const s=new TZ(t.id,r)
let a,c,l,u
if(a=e.loc.string("CANCEL_COMING_SOON_TITLE"),e.client.isAutomaticDownloadingEnabled()&&(r&&o||!r)?(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON_DOWNLOAD"),l=e.loc.string("COMING_SOON_BODY_DOWNLOAD").replace(ox,n)):(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON"),l=e.loc.string("COMING_SOON_BODY").replace(ox,n)),c=e.loc.string("CANCEL_COMING_SOON_CANCEL"),e.client.deviceType===lW||"tv"===e.client.deviceType){const e=new LY(Lq)
e.title=a,e.message=l,e.buttonActions=[s],e.isCancelable=!0,e.cancelTitle=c,e.destructiveActionIndex=0,u=e}else if(e.client.deviceType===Qq){const t=new LY(Lq)
t.title=a,t.artwork=Ot(e,"systemimage://bell.slash.fill",95,90),t.message=l,t.buttonActions=[s],t.isCancelable=!0,t.cancelTitle=c,u=t}else{const e=new vZ([s])
e.title=a,e.message=l,e.isCancelable=!0,e.cancelTitle=c,e.isCustom=!1,e.destructiveActionIndex=0,u=e}Qs(e,s,{...i,actionType:"cancelPreorder"})
const d=new JJ(t.id,Jq),f=new VY(t.id,u)
return f.openAction=d,f}function Cr(e,t){const n=Ot(e,"systemimage://checkmark",95,90),r=Ot(e,yA,95,90)
let o,i
o=new LY(dB),o.title="",o.artwork=n,e.client.isAutomaticDownloadingEnabled()?(o.message=e.loc.string(ZR),o.toastDuration=2.5):(o.message=e.loc.string(UN),o.toastDuration=1.5)
{const n=new LY(dB)
n.title="",n.artwork=r,n.message=e.loc.string(UN),n.toastDuration=1.5
const o=new bZ(QR,new ZJ([t,n]))
o.rateLimit=e.bag.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=n,i=o}const s=!e.client.isAuthorizedForUserNotifications()
return e.bag.newEventsForODJAreEnabled&&s?new AZ(new kW,new kW,new kW,new kW):new AZ(i,o,o,o)}function kr(e,t,n,o,s,a){if(r(t))return{startAction:null,underlyingOfferAction:null}
const c=new oZ,l=mr(0,t),u=t.purchaseConfiguration.appName
c.shouldCheckForAvailableDiskSpace=!s,c.remoteControllerRequirement=XU,c.shouldCheckForGameController=et(e,o,Qx)
const d=ir(0,o,!0)
if(i(d)&&(c.checkRestrictionsForContentRating=d),l){const t=s?e.loc.string("OfferAlert.TV.Title.PredorderFree"):e.loc.string("OfferAlert.TV.Title.Free")
c.title=t.replace(xU,u)}else{const n=s?e.loc.string("OfferAlert.TV.Title.PreorderPaid"):e.loc.string("OfferAlert.TV.Title.Paid")
c.title=n.replace(xU,u).replace(cF,t.priceFormatted)}const f=S(t)
f.title=s?e.loc.string("OfferButton.Title.Preorder"):l?e.loc.string(rx):e.loc.string("OfferButton.Title.Buy")
const h=(0,Wv.isNothing)(n)?f:n
c.completionAction=h,c.shouldIncludeActiveAccountInFooterMessage=!0
const p=[]
et(e,o,kE)&&p.push(e.loc.string("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases")),p.length>0&&(c.footerMessage=p.join(e.loc.string("TV_OFFER_ALERT_FOOTER_LINE_BREAK"))),c.impressionMetrics=f.impressionMetrics
const w=S(c)
w.shouldPromptForConfirmation=!1,w.title=null,w.footerMessage=null
const g=new VY(t.adamId,w)
return qf(e,o)||(g.buyAction=c),g.openAction=t,{startAction:g,underlyingOfferAction:f}}function Or(e,t,n,o,i,s){if(r(t))return{startAction:null,underlyingOfferAction:null}
const a=new oZ,c=mr(0,t)
a.remoteControllerRequirement=ur(e,o),a.spatialControllerRequirement=dr(e)
const l=S(t)
l.title=i?e.loc.string("OFFER_BUTTON_TITLE_PREORDER"):c?e.loc.string("OFFER_BUTTON_TITLE_GET"):e.loc.string("OFFER_BUTTON_TITLE_BUY")
const u=(0,Wv.isNothing)(n)?l:n
a.completionAction=u,a.impressionMetrics=l.impressionMetrics
const d=S(a)
d.shouldPromptForConfirmation=!1,d.title=null,d.footerMessage=null
const f=new VY(t.adamId,d)
return f.buyAction=a,f.cancelAction=l,f.openAction=l,{startAction:f,underlyingOfferAction:l}}function Er(e,t,n,o){if(r(t))return null
if(!e.bag.enableTwoPhaseOfferConfirmation||n)return t
const i=new kW
i.impressionMetrics=t.impressionMetrics
const s=S(o)
r(s)||(s.actionType=MR,s.targetType=hW,Qs(e,i,s))
const a=new rZ(t,i)
return a.confirmationAccessibilityAction=function(e,t){if(r(t))return null
const n=new LY(Lq)
r(t.priceFormatted)?(n.title=e.loc.string(XN),n.message="Are you sure you want to get "+t.purchaseConfiguration.appName):(n.title="Buy App",n.message=`Are you sure you want to buy ${t.purchaseConfiguration.appName} for ${t.priceFormatted}`),n.isCancelable=!0,n.buttonActions=[t]
const o=new VY(t.adamId,t)
return o.buyAction=n,o}(e,t),a}function Rr(e,t,n,r,o){const i=new LY(Lq)
return i.isCancelable=!0,i.buttonActions=[t],i.imageName="vision.pro",_r(e,n)?r?(i.title=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Title"),i.message=o?e.loc.string("Alert.Buy.VisionOnly.Message.Arcade"):e.loc.string("Alert.Buy.VisionOnly.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.ButtonTitle")]),i}function Dr(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=pf(e,t).includes(Qq)||function(e){return ue(e,kq,hO)}(t)
return!!n}function _r(e,t){return!!Dr(e,t)&&Lr(e)}function Lr(e){return!((0,Wv.isNothing)(e.client.remoteDownloadIdentifiers)||0===e.client.remoteDownloadIdentifiers.length)}function Mr(e,t){const n=new LY(Lq)
return n.title=e.loc.string("Alert.Buy.TvGameControllerRequired.Title"),n.message=e.loc.string("Alert.Buy.TvGameControllerRequired.Message"),n.buttonTitles=[e.loc.string("Alert.Buy.TvGameControllerRequired.ButtonTitle")],n.isCancelable=!0,n.buttonActions=[t],n}function xr(e,t,n,o,s,a,c,l,u,d,h=Lq,p=!1,w=!1,g,v,m=!1){return r(t)?null:qv.context("displayPropertiesFromOfferAction",()=>{var r
let a=c
!m&&at(e,o,Qv.Offers)&&(a=XB),m||qd(e,o)||(a=XB),m||!e.client.isCompanionVisionApp||_r(e,o)||(a=XB)
const g=null!==(r=Yd(e,o))&&void 0!==r?r:v
let y
g&&(y=g.id)
let A=new UY(n,t.adamId,t.bundleId,a,y,l)
A.isPreorder=s
const T=w&&h===Lq&&(0,Wv.isSome)(e.bag.adsOverrideLanguage),b=T?e.adsLoc:e.loc
if(A.useAdsLocale=T,s)if(qf(e,o))A.offerLabelStyle=BF,A.subtitles[pU]=nh(e,o,e.loc.string(aF)),A.titleSymbolNames[iP]=lF,A.titleSymbolNames[XR]="bell.fill",A.subtitles[pU]===e.loc.string(fb)&&(A.subtitles[pU]=e.loc.string(aF))
else{A.offerLabelStyle=ZV,A.titleSymbolNames[aW]=lF
const t=nh(e,o,"");(0,Wv.isSome)(t)&&(A.subtitles[pU]=t)}const P=mr(0,t)
A.isFree=P
let I=null
if(h===Lq&&(o.type===Zq||Yf(0,o)||Jf(e,o)||p))I=e.loc.string("OfferButton.Title.View")
else{if(h===rV&&(o.type===Zq||Yf(0,o)||Jf(e,o)))return null
I=h===sP?e.loc.string("OfferButton.Title.Select"):P?h===rV?s?e.loc.string(oP):e.loc.string(rP):t.title:h===rV?s?e.loc.string("OfferButton.FlowPreview.PreorderWithPrice").replace(cF,t.priceFormatted):e.loc.string("OfferButton.FlowPreview.BuyWithPrice").replace(cF,t.priceFormatted):t.priceFormatted}if(A.titles[aW]=I,A.priceFormatted=t.priceFormatted,e.bag.enableTwoPhaseOfferConfirmation&&h!==rV&&(A.titles[eD]=P?e.loc.string("OfferButton.Title.ConfirmGet"):e.loc.string("OfferButton.Title.ConfirmBuy")),qf(e,o))if(h===rV){const t=e.loc.string("OfferButton.FlowPreview.Arcade.Standard")
A.titles[aW]=t,A.titles[uF]=t,A.titles[qV]=e.loc.string("OfferButton.FlowPreview.Arcade.Open"),A.titles[ix]=t,s&&(A.titles[aP]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderSubscribed"),A.titles[tD]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderNotSubscribed"))}else{const e=b.string("OfferButton.Arcade.Title.Standard")
A.titles[aW]=e,A.titles[uF]=e,A.titles[qV]=b.string("OfferButton.Arcade.Title.Open"),A.titles[ix]=e,s&&(A.titles[aP]=b.string("OfferButton.Arcade.Title.PreorderSubscribed"),A.titles[tD]=b.string("OfferButton.Arcade.Title.PreorderNotSubscribed"),A.titles[iP]=b.string("OfferButton.Arcade.Title.PreorderedSubscribed"),A.titles[XR]=b.string("OfferButton.Arcade.Title.PreorderedNotSubscribed"))}if(u&&h!==rV){const t=f(u,ZS),n=f(u,nj)
if(i(n)&&i(t)){let r=null,o=null
switch(t){case QS:d?(r=e.loc.string(nD),o=e.loc.string(nD)):(r=e.loc.string(nD),o=e.loc.string(sx))
break
case XS:const t=e.loc.string("OfferButton.IntroPrice.PaidUpfront.Trial").replace(cF,n)
d?(r=t,o=t):(r=t,o=e.loc.string(sx))
break
case eP:r=e.loc.string(sx),o=e.loc.string(sx)}A.titles[rD]=r,A.titles[oD]=o,A.subtitles[rD]=e.loc.string(cP),A.subtitles[oD]=e.loc.string(cP)
const i=10
let s=!1
for(const e of Object.keys(A.titles))if(A.titles[e].length>i){s=!0
break}s&&(A=A.newOfferDisplayPropertiesChangingAppearance(!1,null,nS))}}const C=et(e,o,kE),k=er(e,o),O=tr(e,tW),E=k&&O
if(A.hasInAppPurchases=C,A.hasExternalPurchases=E,C||E){const t=E?uP:lP,n=b.string(t)
A.subtitles[aW]=n,e.bag.enableTwoPhaseOfferConfirmation&&h!==rV&&(A.subtitles[eD]=n)}A.isDeletableSystemApp=st(e).isSystemAppFromData(o)&&!Jf(e,o)
const R=ir(0,o,!0)
return A.contentRating=null!=R?R:void 0,A.appCapabilities=t.purchaseConfiguration.appCapabilities,o.type===Zq&&h!==rV&&(A.offerToken={offerAction:t,offerDisplayProperties:S(A)}),A})}function $r(e){return A(e)&&function(e){return(0,Hv.isSome)(LZ[e])}(e[gW])}function Fr(e,t){switch(j(t,Zb)){case Qb:return Iz
case Xb:return Cz
case"RealityDevice":return e.bag.enableDeviceDrivenDiscoveryContent?xz:null
default:return null}}function Nr(e,t=!1){return{timeToLive:Gr(e),nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:t}}function Br(e,t){r(t)||r(e)||(r(t.nextPreferredContentRefreshDate)||e.getTime()<t.nextPreferredContentRefreshDate.getTime())&&e.getTime()>(new Date).getTime()&&(t.nextPreferredContentRefreshDate=e)}function Ur(e,t){if(!function(e){return e.bag.enableAutomaticPageRefresh}(e))return null
if(r(t))return null
let n,o=!1
if(i(t.timeToLive)&&i(t.nextPreferredContentRefreshDate)){const e=jr(t.timeToLive)
e.getTime()<t.nextPreferredContentRefreshDate.getTime()&&e.getTime()>(new Date).getTime()?n=e:(n=t.nextPreferredContentRefreshDate,o=!0)}else if(i(t.timeToLive))n=jr(t.timeToLive)
else{if(!i(t.nextPreferredContentRefreshDate))return null
n=t.nextPreferredContentRefreshDate,o=!0}if(n.getTime()<=(new Date).getTime())return null
const s=o&&t.refreshWhileVisibleForNextPreferredContentRefreshDate
return new NZ("timeToLive",0,null,n,s)}function Gr(e){return e[mm.contentMaxAge]}function jr(e){const t=new Date
return t.setSeconds(t.getSeconds()+e),t}function Vr(e,t){return t?[hX,bX]:[]}function Hr(e,t){return Qr(lQ,t)}function qr(e,t){return Qr(LQ,t)}function Wr(e){return xQ}function zr(e){return FQ}function Yr(e){return UQ}function Jr(e){return qQ}function Kr(e){return YQ}function Zr(e,t){return e.client.isCompanionVisionApp?nX:Qr(tX,t)}function Qr(e,t){const n={...e}
return(0,Hv.isSome)(t)&&(n.crops=t),n}function Xr(e,t,n){const r=Co(t,n.coercedCollectionTodayCardDisplayStyle),o=n.isHorizontalShelfContext?function(e,t){const n=[]
return n.push(Zr(e,[rA])),t.horizontalCardContentType===_B&&n.push(Wr()),n.push(qr(0,["sr"]),Hr(0,["sr"])),n}(e,n):function(e,t,n){const r=new Set([Tm.List,Tm.NumberedList])
if(e.client.isPad&&n.isHeroCard&&!r.has(t))return Vr(0,n.isHeroCard)
switch(t){case Tm.AppEventCard:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),oQ]
case Tm.AppOfTheDay:case Tm.GameOfTheDay:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),XZ]
case Tm.List:case Tm.NumberedList:return[TQ,OQ]
case Tm.ShortImage:return n.isSearchContext?[Hr(),Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr()]:[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),Hr(),qr()]
case Tm.FullBleedImage:return[Yr(),Jr(),HZ,Qr(YZ,undefined),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr(),Hr()]
case Tm.SingleApp:case Tm.Video:default:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr(),Hr()]}}(e,r,n)
let i,s=!1
const a=N(t)
if(W(a)&&(i=o.find(e=>(0,Hv.isSome)(B(a,e.objectPath))),s=(0,Hv.isSome)(i)),(0,Hv.isNothing)(i)&&(i=o.find(e=>(0,Hv.isSome)(B(t,e.objectPath)))),!i)return
const c=B(s?a:t,i.objectPath)
if(i.type===lV){const t=i.crops.map(t=>{let r=t
return n.isSearchContext&&(0,Hv.isSome)(n.prevailingCropCodes)?r=n.prevailingCropCodes.defaultCrop:(0,Hv.isSome)(n.prevailingCropCodes)&&(0,Hv.isSome)(n.prevailingCropCodes[i.objectPath])&&(r=n.prevailingCropCodes[i.objectPath]),Zd(e,c,{withJoeColorPlaceholder:!0,cropCode:r,useCase:y6.TodayCardMedia,overrideHeight:i.sourceHeight,overrideWidth:i.sourceWidth})}),r=sh(c)
return{artworks:t,videos:[],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:r}}{const t=p(c,UG),r=h(t,fG),o=h(t,BG)>=r
let s=i.sourceHeight,a=i.sourceWidth
o&&([s,a]=[a,s])
const l=Zd(e,t,{withJoeColorPlaceholder:!0,cropCode:i.crops[0],useCase:y6.TodayCardMedia,overrideHeight:s,overrideWidth:a})
if((0,Hv.isNothing)(l))return
let u={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0};(0,Hv.isSome)(n.videoPlaybackControls)&&(u=n.videoPlaybackControls)
let d={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0};(0,Hv.isSome)(n.videoPlaybackControls)&&(d=n.videoAutoplayPlaybackControls)
const w=f(c,rq)
if((0,Hv.isNothing)(w))return
const g=new mz(w,l,{playbackControls:u,autoPlayPlaybackControls:d,canPlayFullScreen:n.enableFullScreenVideo}),v=sh(t)
return{artworks:[],videos:[g],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:v}}}function eo(e,t=cU,n,r,o,i,s,a=hW){const c=az.fromComponents(OW,null,`/${xW.arcadeSeeAllGames}`,{sort:t}),l=new EY(cG,c.build())
return l.title=null!=o?o:e.loc.string(p$),Qs(e,l,{id:null!=i?i:PA,idType:s,targetType:a,actionType:pW,actionContext:vq,pageInformation:n,locationTracker:r}),l}function to(e,t,n,r,o){var s,a,c,l
const u=new iZ(sW,t,e.bag.metricsTopic,n)
u.purchaseSuccessAction=r,u.carrierLinkSuccessAction=r
const d=new EY(Ij);(0,Hv.isSome)(null===(a=null===(s=null==o?void 0:o.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(u.metricsOverlay[ZH]=null===(c=o.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const f=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([em.user,em.client])
return(0,Hv.isSome)(f)&&(u.metricsOverlay={...u.metricsOverlay,...f}),d.pageData=u,i(o)&&Zs(e,d,o),d}function no(e,t,n,r){{const e=new IX(sW)
return i(r)&&(e.popToRoot=r),new ZJ([e])}}function ro({objectGraph:e,metricsPageInformation:t,metricsLocationTracker:n,target:r={playNow:{}}}){const o=new CX(r)
return Qs(e,o,{targetType:Mq,id:lG,actionType:pW,pageInformation:t,locationTracker:n}),o}function oo(e,t,n,r){let o
o=Ot(e,"resource://GameCenterEyebrow",16,16)
const i=e.featureFlags.isEnabled(AJ),s=e.featureFlags.isEnabled(TJ),a=e.featureFlags.isGSEUIEnabled($J)
if(a){const r={eyebrowColor:Se(XF),includeSeparator:!i,prefersShelfHeader:s}
return{eyebrow:e.loc.string(IA),eyebrowArtwork:o,eyebrowArtworkType:sm.Icon,title:t,subtitle:n,configuration:r}}{const c={eyebrowColor:a?Se(OL):void 0,includeSeparator:!i,prefersShelfHeader:s}
return(0,Hv.isSome)(r)&&r?{title:t,titleArtwork:o,titleArtworkType:sm.Icon,subtitle:n,configuration:c}:{eyebrow:e.loc.uppercased(e.loc.string(IA)),eyebrowArtwork:o,eyebrowArtworkType:sm.Icon,title:t,subtitle:n,configuration:c}}}function io(e,t=!1){let n=new dY(e).forType(KV).includingAgeRestrictions()
return t&&(n=n.addingQuery(EL,LO)),n}function so(e,t){return io(e).withSparseLimit(t).asPartialResponseLimitedToFields([oW]).usingCustomAttributes(Ue(e))}function ao(e,t,n){return function(e,t,n){o(t)&&(t=pt(mj))
const r=new dY(e).forType(Ij).addingQuery("serviceType",sW).addingQuery("placement",t).includingMetaKeys(SV,[Cj]).includingRelationships([uW]).includingAttributes([CA,MO]).includingAgeRestrictions()
return i(n)&&r.addingQuery(kA,n),r}(e,t,n)}function co(e,t){let n=null
const s=fe(t,OA)||fe(t,SV)
if(o(s)||o(s.data))return null
const a=s.data.map(e=>e.type===SV?e:null).filter(e=>i(e))
if(o(a))return null
const c=e.bag.marketingItemSelectionTimeout
if(1===a.length||0===c)n=a[0]
else try{n=e.arcade.getMarketingItemWithTimeout(a,c)}catch{n=a[0]}return r(n)?null:{marketingItemData:n}}function lo(e,t){if(!t)return null
let n=null
const r=l(t,vO)
return r.length>0&&(n=r[0]),i(n)?{marketingItemData:n}:null}function uo(e,t,n,r,o){const i=On(0,r)
if((0,Hv.isSome)(i.suppressLockup)&&i.suppressLockup)return null
let s=null
const a=(0,Hv.isSome)(o)&&1===o.length,c=(0,Hv.isSome)(o)&&o.length>1
return a?s=new FZ(o[0]):c&&(s=new SX(o)),s}function fo(e,t,n,r,o,i,s){if(!H(o,P_))return
let a=co(e,o);(0,Wv.isNothing)(a)&&(0,Hv.isSome)(i)&&(a=lo(0,i.arcadeUpsellEditorialResponse))
const c=function(e,t,n,r,o,i,s){if(!function(e){const t=e.host.platform
return t===dV||t===jV}(e))return null
ho(e,t,n,r)
const a=$o(),c=Md(e,i,s,pt(yj),a,Bj)
return new PX(c)}(e,o,t,n,0,a,s)
if(c){t.overlay=c,t.impressionMetrics.fields[NS]=!0
const r=ho(e,o,t,n)
t.style!==r&&(t.style=r)}}function ho(e,t,n,r){const o=!r.enableListCardToMultiAppFallback,i=Xr(e,t,r),s=Mo(null==i?void 0:i.joeColors)
return o?n.style:s}function po(e,t,n){if((0,Hv.isNothing)(t))return
const r=Nt(n.pageInformation)
if(null===r)return
r.id=fh(n.id)
const o=lh(n);(0,Hv.isSome)(o)&&(r[ex]=o),r[kV]=rq,r.typeDetails="iTunesStoreContent",r[nU]=Ah(e,n,""),n.actionDetails&&(r[zG]=n.actionDetails),t.templateMediaEvent=function(e,t){const n={}
return Object.assign(n,t),n[Kj]=gR,Ft(e,n),Dt(0,new uK(n,[],[],$t(e,n),xt(e,n)))}(e,r)
const i=S(r)
i[MN]=t.videoUrl,t.templateClickEvent=function(e,t,n,r){const o={}
Object.assign(o,r),o[Kj]=bG,o[W$]=n,o[pR]=null
const i=[RU]
return Ft(e,o),Dt(0,new uK(o,i,[],$t(e,o),xt(e,o)))}(e,0,hW,i)}function wo(e,t){return u(t,kX)}function go(e,t,n,r,o){return qv.context("createTodayBaseCard",()=>{const i=new dK,s=Co(t,null==n?void 0:n.coercedCollectionTodayCardDisplayStyle),a=vo(e,t,s,n)
i.heading=a
const c=function(e,t,n){var r
let o=null
if((null==n?void 0:n.useOTDTextStyle)&&(o=null!==(r=j(t,"ofTheDayLabel"))&&void 0!==r?r:j(t,YH),(0,Wv.isSome)(o)&&(o=o.replace(/\n/g,f$))),(0,Wv.isNothing)(o)&&(o=Wf(e,t,fW,!0)),(0,Wv.isNothing)(o)){const e=mo(0,t)
o=(0,Wv.isSome)(e)?j(e,fW):null}return o}(e,t,n)
i.title=null!=c?c:void 0
const l=Qe(e,t,[_$,fW])
i.shortTitle=l
const u=function(e,t){return Zd(e,B(t,LT),{contentMode:Kv.scaleAspectFit,allowingTransparency:!0,useCase:y6.TodayCardBrandedTitle})}(e,t)
i.titleArtwork=u
const d=function(e,t){var n
const r=On(0,t)
if(H(t,xE)||r.suppressNoteShort)return null
let o=Wf(e,t,tV,!0)
if((0,Wv.isNothing)(o)&&!r.suppressNoteTagline){const r=mo(0,t);(0,Wv.isSome)(r)&&(o=null!==(n=Wf(e,r,Rj))&&void 0!==n?n:Td(e,r))}return o}(e,t)
i.inlineDescription=d
const f=Po(e,t,n,r,c)
return f.adSlotOverride=r.parsedCardCount,i.clickAction=function(e,t,n,r,o,i,s){var a
const c=i,l={cardType:n,franchise:j(t,YH)},u=wo(0,t)
return u&&(l[US]=u),c[zG]=l,(0,Wv.isSome)(s)&&s(c),Ud(e,t,c,null!==(a=null==r?void 0:r.clientIdentifierOverride)&&void 0!==a?a:e.host.clientIdentifier,Ws(o.currentTodayItem),r)}(e,t,s,n,r,f,o),$h(e,i,f,a,s,wo(0,t)),i.editorialDisplayOptions=function(e,t,n){var r
const o=On(0,t),i=e.client.isPad&&(null==n?void 0:n.isHeroCard)
return{suppressTagline:V(t,xE),suppressLockup:v(o.suppressLockup),showBadgeInSmallCards:null!==(r=n.alwaysShowBadgeInSmallCards)&&void 0!==r?r:v(o.showBadgeInSmallCards),useMaterialBlur:n.alwaysUseMaterialBlur||i||v(o.useMaterialBlur)}}(e,t,n),i})}function vo(e,t,n,o){var i,s
let a=null
if(null==o?void 0:o.useOTDTextStyle)a=o.isHorizontalShelfContext?j(t,YH):null
else if(function(e,t){let n=j(e,"ofTheDayIntent")
if((0,Hv.isNothing)(n))switch(Co(e,null==t?void 0:t.coercedCollectionTodayCardDisplayStyle)){case Tm.AppOfTheDay:n=Pm.AppOfTheDay
break
case Tm.GameOfTheDay:n=Pm.GameOfTheDay}return n===Pm.AppOfTheDay||n===Pm.GameOfTheDay}(t,o))a=null!==(i=j(t,c_))&&void 0!==i?i:j(t,YH),r(a)&&n===Tm.AppOfTheDay?a="FEATURED APP":r(a)&&n===Tm.GameOfTheDay&&(a="FEATURED GAME")
else if(n===Tm.AppEventCard){const n=mo(0,t);(0,Wv.isSome)(n)&&(a=null!==(s=zf(e,t,iU,!0))&&void 0!==s?s:j(n,DH))}else a=j(t,YH)
return a}function mo(e,t){const n=we(t,bH)
if(1===(null==n?void 0:n.length))return n[0]
const r=Oo(0,t)
return 1===r.length?r[0]:null}function yo(e,t,n,r,o){return qv.context("addArtworkMediaToBaseCard",()=>{var i
if(H(t,O_))return!1
const s=Xr(e,t,r)
return!(0,Wv.isNothing)(s)&&((0,Wv.isSome)(o)&&po(e,null==s?void 0:s.videos[0],{pageInformation:o.pageInformation,locationTracker:o.locationTracker,id:t.id}),n.media=new RZ(s.artworks,s.videos,s.artworkLayoutsWithMetrics,null!==(i=_o(0,t,r))&&void 0!==i?i:void 0),n.style=Mo(s.joeColors,oj),(0,Wv.isSome)(n.clickAction)&&wt(n.clickAction)&&(n.overlay=new xZ(n.clickAction),n.style=uq),!0)})}function Ao(e,t,n,r,o){return qv.context("createTodaySingleAppCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=yo(e,t,s,n,r),c=Oo(0,t),l=ko(e,c,n,r.pageInformation,r.locationTracker,Bj,null,na(0,t)),u=uo(0,0,0,t,l)
var d
return i(u)&&$r(d=u)&&d[gW]===Ey&&(u.style=uq),s.overlay=u,a||1!==c.length||To(e,t,s,c,n,r)?(fo(e,s,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),s):(Io(r),null)})}function To(e,t,n,r,o,i){if(1!==r.length)return!1
o.useJoeColorIconPlaceholder=!0,n.style=Gq
const s=$o(0,n.style),a=ko(e,r,o,i.pageInformation,i.locationTracker,Fo(n.style),s,na(0,t))
if(1!==a.length)return!1
const c=a[0]
return n.media=new EX(c.icon),!0}function bo(e,t,n,a,c){return qv.catchingContext("todayCardFromData",()=>{const l=Co(t,n.coercedCollectionTodayCardDisplayStyle),d=Fr(e,t);(0,Hv.isSome)(d)&&(function(e,t,n,r){var o
if(n===Mz||n===xz)return!0
const i=Oo(0,t),s=Co(t,r.coercedCollectionTodayCardDisplayStyle)
if(!new Set([Tm.AppEventCard,Tm.Grid,Tm.InAppPurchase,Tm.List,Tm.NumberedList,Tm.River,Tm.ShortImage,Tm.SingleApp]).has(s))return!1
if(i.length>=6&&s===Tm.Grid)return!1
const a=Ro(0,s)
return!(!H(t,O_)&&Do(e,B(t,a),null===(o=r.prevailingCropCodes)||void 0===o?void 0:o.defaultCrop)||function(e,t){if(1===t.length){const e=t[0]
if(e.type===JH)return e}return null}(0,i))}(e,t,d,n)?n.clientIdentifierOverride=d:n.clientIdentifierOverride=null),n.crossLinkSubtitle=Bo(e,t)
let f=null
switch(l){case Tm.AppOfTheDay:case Tm.GameOfTheDay:f=function(e,t,n,r,i){return qv.context("createTodayBrandedCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=Xr(e,t,n)
if(!((0,Wv.isSome)(a)&&(0,Wv.isSome)(a.joeColors.bgColor)&&(a.artworks.length>0||a.videos.length>0)))return Io(r),Ao(e,t,n,r)
s.style=Mo(null==a?void 0:a.joeColors,oj)
const c=$o(0,s.style),l=Oo(0,t),u=ko(e,l,n,r.pageInformation,r.locationTracker,Fo(s.style),c,na(0,t),!0)
if(o(u)||1!==u.length)return Io(r),null
n.isHorizontalShelfContext||(s.overlay=uo(0,0,0,t,u))
const d=u[0]
return s.media=new OX(d.icon,a.artworks,a.videos,a.artworkLayoutsWithMetrics,_o(0,t,n)),s.media.impressionMetrics=d.impressionMetrics,fo(e,s,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Io(r),s})}(e,t,n,a,c)
break
case Tm.Video:f=function(e,t,n,r,o){return qv.context("createTodayVideoCard",()=>{const i=go(e,t,n,r)
yo(e,t,i,n,r),So(e,t,n,r)
const s=$o(0,i.style),a=Oo(0,t),c=ko(e,a,n,r.pageInformation,r.locationTracker,Bj,s,na(0,t)),l=uo(0,0,0,t,c)
return i.overlay=l,fo(e,i,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),i})}(e,t,n,a,c)
break
case Tm.FullBleedImage:f=function(e,t,n,r,o){return qv.context("createTodayFullBleedImageCard",()=>{const i=go(e,t,n,r)
if(So(e,t,n,r),!yo(e,t,i,n,r))return Io(r),null
const s=Oo(0,t),a=$o(0,i.style),c=ko(e,s,n,r.pageInformation,r.locationTracker,Fo(i.style),a,na(0,t)),l=uo(0,0,0,t,c)
return i.overlay=l,fo(e,i,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),i})}(e,t,n,a,c)
break
case Tm.InAppPurchase:f=function(e,t,n,r,i){return qv.context("createTodayInAppPurchaseCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=function(e,t){if(1===t.length){const e=t[0]
if(e.type===JH)return e}return null}(0,Oo(0,t))
if(o(a))return Io(r),null
const c=kd(e,a,{offerStyle:Ej,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker},artworkUseCase:y6.LockupIconSmall})
return o(c)?(Io(r),null):(c.theme=BH,s.media=new RX(c),s.media.impressionMetrics=c.impressionMetrics,s.media.impressionMetrics.fields[_M]=s.impressionMetrics.fields.id,s.style=uq,fo(e,s,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Io(r),s)})}(e,t,n,a,c)
break
case Tm.AppEventCard:f=function(e,t,n,r,o){return qv.context("createTodayAppEventCard",()=>{var i,s,a,c,l
if(!oi(e))return null
const d=function(e,t){let n
const r=we(t,bH)
if(r.length>0)n=r[0]
else{const e=we(t,OH)
if(0===e.length)return null
n=e[0]}return n}(0,t)
if((0,Wv.isNothing)(d))return null
const f=go(e,t,n,r,t=>{t.inAppEventId=d.id
const n=pe(e,d,Jq);(0,Hv.isSome)(n)&&(t.relatedSubjectIds=[n.id])});(0,Hv.isSome)(f.editorialDisplayOptions)&&(f.editorialDisplayOptions.useMaterialBlur=!0),So(e,t,n,r)
const h=Xr(e,t,n)
if((0,Wv.isNothing)(h))return Io(r),null
const p=null!==(s=null===(i=h.joeColors)||void 0===i?void 0:i.textColor4)&&void 0!==s?s:pY,w=be(null!==(c=null===(a=h.joeColors)||void 0===a?void 0:a.bgColor)&&void 0!==c?c:pY)?Gq:hq,g={pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:s$}
f.style=null!==(l=Lo(h.joeColors,uB))&&void 0!==l?l:be(p)?Gq:hq
const v=$o(0,f.style),m=j(t,YH),y=wi(e,d,null,!1,!1,Fo(f.style),v,!0,g,!0,!0,m,!1,u(n.allowUnpublishedAppEventPreviews))
if((0,Wv.isNothing)(y)||y instanceof Date)return Br(y,r.refreshController),Io(r),null
const A=y
return f.media=new $Z(A.formattedDates,A.startDate,p,h.artworks,h.videos,h.artworkLayoutsWithMetrics,w),(0,Hv.isSome)(A.lockup)&&(f.overlay=new FZ(A.lockup)),fo(e,f,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),f})}(e,t,n,a,c)
break
case Tm.List:case Tm.NumberedList:f=function(e,t,n,r,o){return qv.context("createTodayListCard",()=>{var i,s,a
const c=go(e,t,n,r)
So(e,t,n,r),n.useJoeColorIconPlaceholder=!0
let l=Oo(0,t)
const u=ko(e,l,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0)
if(0===u.length)return Io(r),null
if(n.canDisplayArcadeOfferButton=!1,u.length<function(e){return"tv"===e.client.deviceType?3:4}(e)&&n.enableListCardToMultiAppFallback)Eo(e,t,u,c)
else{if(Co(t,n.coercedCollectionTodayCardDisplayStyle)===Tm.NumberedList){let e=1
for(const t of u)t.ordinal=`${e}`,e++}const r=Xr(e,t,n),o=Lo(null==r?void 0:r.joeColors,oj),l=!0
null==r||r.videos.forEach(e=>{e.canPlayFullScreen=!1,e.playbackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},e.autoPlayPlaybackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}}),c.style=l?void 0:uq,c.media=new DX(u,null!==(i=null==r?void 0:r.artworks)&&void 0!==i?i:[],null!==(s=null==r?void 0:r.videos)&&void 0!==s?s:[],null!==(a=null==r?void 0:r.artworkLayoutsWithMetrics)&&void 0!==a?a:[],void 0,l?o!==uq:o===Gq)}return fo(e,c,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),c})}(e,t,n,a,c)
break
case Tm.River:case Tm.Grid:f=function(e,t,n,r,o){return qv.context("createTodayRiverCard",()=>{const i=go(e,t,n,r)
n.useJoeColorIconPlaceholder=!0,So(e,t,n,r)
const s=function(e,t,n,r,o){const i=Oo(0,t).filter(t=>{const n=jf(e,t)
return!Uf(e,t)||!n})
return ko(e,i,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0,!1)}(e,t,n,r)
return 0===s.length?(Io(r),null):(n.canDisplayArcadeOfferButton=!1,s.length<function(e){return"tv"===e.client.deviceType?2:4}(e)?Eo(e,t,s,i):(i.style=Gq,function(e){for(const t of e)be(t.icon.backgroundColor,90)||(t.icon.backgroundColor=Ae(.8,.8,.8))}(s),i.media=new _X(s)),fo(e,i,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),i)})}(e,t,n,a,c)
break
case Tm.SingleApp:f=Ao(e,t,n,a,c)
break
case Tm.ShortImage:f=function(e,t,n,r,o){return qv.context("createTodayShortImageCard",()=>{const i=go(e,t,n,r)
So(e,t,n,r)
const s=yo(e,t,i,n,r)
let a=!1
const c=Oo(0,t),l=$o(0,i.style),u=ko(e,c,n,r.pageInformation,r.locationTracker,Fo(i.style),l,na(0,t)),d=uo(0,0,0,t,u)
return i.overlay=d,s||1!==c.length||(a=To(e,t,i,c,n,r)),s||a?(fo(e,i,n,Co(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Io(r),i):(Io(r),null)})}(e,t,n,a,c)
break
default:f=null}return r(f)?(e.console.log(`Unknown style: ${l}`),f):(function(e,t,n,r){const o=Co(r,n.coercedCollectionTodayCardDisplayStyle),s=No(e,r,n.heroDisplayContext,o,n.prevailingCropCodes)
let a=[],c=[]
var l
i(s)&&(a=[s]),i(t.media)&&(A(l=t.media)&&l[gW]===ky||function(e){return A(e)&&e[gW]===Py}(t.media))&&(c=t.media.videos),new _Z(a,c)}(e,f,n,t),function(e){(0,Hv.isSome)(e.clickAction)&&wt(e.clickAction)&&(e.overlay=new xZ(e.clickAction),e.style=uq)}(f),function(e,t){(0,Hv.isNothing)(e.media)||(e.media.otdTextStyle=t.useOTDTextStyle)}(f,n),function(e,t){const n=t.media
if(!function(e){return A(e)&&function(e){return Object.values(kZ).includes(e)}(e[gW])}(r=n)||!function(e){return Object.values(CZ).includes(e)}(r[gW]))return
var r
const o=s(n.videos)
t.supportsMediaMirroring=o}(0,f),(0,Hv.isNothing)(f.media)&&(e.console.log(`Missing required media: ${l}`),f=null),f)},t=>(e.console.log(t),null))}function So(e,t,n,r,i){const a=s(i)?i:function(e,t,n){let r=Wf(e,t,fW)
if(o(r))switch(n){case Tm.AppOfTheDay:case Tm.GameOfTheDay:r=j(t,YH)}return r}(e,t,Co(t,n.coercedCollectionTodayCardDisplayStyle))
bh(e,Po(e,t,n,r,a),null!=a?a:"")}function Po(e,t,n,r,o){var i
return Bh(e,t,null!=o?o:"",{...null==n?void 0:n.baseMetricsOptions,targetType:Bj,pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdEligible:null!==(i=null==n?void 0:n.isAdEligible)&&void 0!==i&&i,optimizationId:f(t,AC),optimizationEntityId:f(t,TC),rowIndex:null==n?void 0:n.currentRowIndex,displayStyle:null==n?void 0:n.metricsDisplayStyle})}function Io(e){Ph(e.locationTracker)}function Co(e,t){const n=j(e,LN)
return LX.has(n)&&(0,Hv.isSome)(t)?t:n}function ko(e,t,n,r,i,a,c,l,u=!0){return o(t)?[]:$d(e,t.filter(e=>!s(e.attributes)||e.type!==JH),{lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},offerEnvironment:a,offerStyle:c,clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:l,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:y6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,useJoeColorIconPlaceholder:n.useJoeColorIconPlaceholder,skipDefaultClickAction:!u},filter:Qv.TodayCard})}function Oo(e,t){return we(t,OH)}function Eo(e,t,n,r){const o=Wf(e,t,tV)
if(r.media=new DZ(n,o),r.style=Gq,(0,Hv.isSome)(r.clickAction)&&ht(r.clickAction)){const e=az.from(r.clickAction.pageUrl)
e.param(zW.showingFallbackMedia,pq),r.clickAction.pageUrl=e.build()}}function Ro(e,t){switch(t){case Tm.AppOfTheDay:case Tm.GameOfTheDay:return I_
case Tm.AppEventCard:return C_
case Tm.Video:case Tm.FullBleedImage:return AM
default:return k_}}function Do(e,t,n){if(o(t))return null
const r=Zd(e,t,{withJoeColorPlaceholder:!0,useCase:y6.TodayCardMedia})
return r.crop=n||"sr",r}function _o(e,t,n){const r=B(t,Ro(0,Co(t,n.coercedCollectionTodayCardDisplayStyle)))
return i(r)?f(r,"bgGradientKind"):null}function Lo(e,t=oj){if((0,Hv.isNothing)(e))return
if((0,Hv.isSome)(null==e?void 0:e.textGradient)&&2===e.textGradient.length)return be(e.textGradient[0])?uq:Gq
const n=e[t]
if((0,Hv.isNothing)(n))return
const r=Te(n)
return r<=.1?Gq:r>=.84?uq:hq}function Mo(e,t=oj){var n
return null!==(n=Lo(e,t))&&void 0!==n?n:hq}function xo(e,t){return i(t.heading)?t.heading.replace(/\n/g," "):t.collapsedHeading}function $o(e,t){return Pj}function Fo(e){return e===uq?hq:Bj}function No(e,n,r,o,i){const s=function(e,t,n,r){return t===Tq?Ro(0,n):"editorialArtwork.crossoverCard"}(0,r,o,Object.keys(B(n,$q)))
return Do(e,B(n,s),function(e,t,n,r){return km.Article,km.Article,null==r?void 0:r.defaultCrop}(0,0,t(s),i))}function Bo(e,t){let n=zf(e,t,tV)
if(s(n)||(n=Wf(e,t,fW)),!s(n)){const e=j(t,CH)
e!==Tm.AppOfTheDay&&e!==Tm.GameOfTheDay||(n=j(t,YH))}return n}function Uo(e,t,n){const r=j(t,n)
if(o(r))return null
const s=new az(r)
let a=null
switch(e.host.clientIdentifier){case sY:a=sq
break
case iY:a=cW}a&&s.param(tz,a)
const c=Ve(Ge(e,t))
return i(c)&&s.param(zW.productVariantID,c),s.toString()}function Go(e,t,n){if(o(t))return null
const r=new zJ(t)
return r.title=null!=n?n:e.loc.string("ShareSheet.CopyLink.Title"),r.artwork=Ot(e,"systemimage://link"),new dZ("com.apple.AppStore.copyLinkActivity",r)}function jo(e,t,n){return qv.context("shareSheetDataForProductFromProductData",()=>{if(r(t))return null
const o=Uo(e,t,Wq),s=j(t,fW),a=j(t,sH),c=t.id,l=e.client.storefrontIdentifier
if(!(o&&s&&a&&c))return null
const u=Uo(e,t,"shortUrl")
let d=null,f=null
const h=Qe(e,t,RH)||a
let p
const w=xe(e,t,lW)
Me(e,t,lW),p=w?wO:dV,i(t)&&j(t,Wq)&&(d=tf(e,t,{useCase:y6.LockupIconSmall},n),f=function(e,t){return qv.context("notesMetadataFromProductData",()=>{var n
if(r(t))return null
const o=j(t,fW)
if((0,Hv.isNothing)(o)||0===o.length)return null
const i=Uo(e,t,Wq),s=j(t,sH),a=j(t,"genreNames.0"),c=null===(n=Rf(e,t))||void 0===n?void 0:n.fileSizeByDevice
let l
switch(t.type){case dW:l=Jq
break
case Zq:l=Wk
break
case JH:l=tG
break
default:l=null}return new uZ(o,i,s,a,c,l)})}(e,t))
const g=new gZ(c,l,s,p,d,[],[],!1,h,null,null,f)
return new hZ(g,o,u)})}function Vo(e,t,n,o,s){return qv.context(`shareActionFromData: ${t.type}`,()=>{var a
const c=t.id
switch(e.client.deviceType){case lW:{const r=jo(e,t)
if(r){const t=new KK(r,[])
return Qs(e,t,{targetType:hW,id:c,actionType:oB,pageInformation:n,locationTracker:o}),t}break}case nW:case Kq:case Qq:{const l=jo(e,t,s),u=[]
if((null===(a=null==l?void 0:l.url)||void 0===a?void 0:a.length)>0){const t=Go(e,l.url)
i&&u.push(t)}const d=function(e,t){if(!e.bag.isContentGiftingEnabled)return null
if(r(t))return null
const n=wr(e,t)
return r(n)||V(t,wq)?null:h(n,zF)>0?t.id:null}(e,t)
if(d){const t=new EY(Tj)
t.presentationContext=pL,t.title=e.loc.string("SHARE_GIFT_APP"),t.artwork=Ot(e,"systemimage://app.gift"),t.pageUrl=`gift/${d}`,Qs(e,t,{targetType:hW,id:c,actionType:HF,actionContext:iA,pageInformation:n,locationTracker:o})
const r=new dZ("com.apple.AppStore.giftActivity",t)
u.push(r)}if(l){const t=new KK(l,u,jy)
return t.title=e.loc.string("SHARE_APP"),t.artwork=Ot(e,gO),Qs(e,t,{targetType:hW,id:c,actionType:oB,actionContext:iA,pageInformation:n,locationTracker:o}),t}if(u.length>0){const t=u.map(e=>e.action),r=new vZ(t)
return r.isCancelable=!0,r.isCustom=!0,Qs(e,r,{targetType:hW,id:c,actionType:"actionSheet",pageInformation:n,locationTracker:o}),r}break}}return null})}function Ho(e,t,n){if((0,Hv.isNothing)(t))return null
const r=t.match(/P(\d+)([A-Z]+)/)
if(!r||3!==r.length)return null
let o=h(r[1]),i=r[2]
return o&&i?("D"===i&&o>0&&o%7==0&&(i="W",o/=7),new NX(o,null!=n?n:1,i)):null}function qo(e,t){const n=l(t,cR)[0]
if(!n)return null
const r=f(n,iG),o=h(n,sG),i=f(t,iG),s=h(t,sG)
if(!r||!i)return null
const a=f(n,ZS),c=Ho(0,r,o),u=Ho(0,i,s),d=f(n,nj).replace(/ /g,"\xa0"),p=f(t,nj).replace(/ /g,"\xa0")
let w=Wo(e,u.type,u.periodDuration,p)
switch(w=w.replace(/\//g,"\u2060/\u2060"),a){case QS:const t=zo(e,c.type,c.periodDuration*c.periodCount)
if(t&&w)return e.loc.string("InAppOfferPage.Description.FreeTrialTemplate").replace(JR,t).replace(KR,w)
break
case XS:const n=zo(e,c.type,c.periodDuration*c.periodCount)
if(n&&w)return e.loc.string("InAppOfferPage.Description.PaidUpFrontTemplate").replace(JR,n).replace("@@trialPrice@@",d).replace(KR,w)
break
case eP:const r=Wo(e,c.type,c.periodDuration,d),o=zo(e,c.type,c.periodDuration*c.periodCount)
if(o&&w)return e.loc.string("InAppOfferPage.Description.PaidTrialTemplate").replace("@@trialPriceDuration@@",r).replace(JR,o).replace(KR,w)
break
default:return null}return null}function Wo(e,t,n,r){let o
switch(t){case"D":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Days.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Days",n)
break
case"W":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Weeks.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Weeks",n)
break
case"M":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Months.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Months",n)
break
case"Y":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Years.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Years",n)}return o.replace("@@price@@",r)}function zo(e,t,n){switch(t){case"D":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Days.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Days",n)
case"W":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Weeks.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Weeks",n)
case"M":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Months.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Months",n)
case"Y":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Years.one").replace(aG,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Years",n)}return null}function Yo(e,t){var n,r,i
const s=pe(e,t,sU)
if((0,Wv.isNothing)(s))return
const a=wr(e,s),c=p(s,qF)
if(o(a)||o(c))return
const l=null===(n=Jo(e,f(a,iG),h(a,sG),f(a,nj)))||void 0===n?void 0:n.replace("/","/\u2060"),u=null===(r=Jo(e,f(c,iG),h(c,sG),f(c,nj)))||void 0===r?void 0:r.replace("/","/\u2060")
if(o(l)||o(u))return null
const d=j(t,fW),w={"@@discountedPrice@@/@@recurringSubscriptionPeriod@@":u,"@@regularPrice@@/@@recurringSubscriptionPeriod@@":l,"@@discountedPricePerRecurringSubscriptionPeriod@@":u,"@@regularPricePerRecurringSubscriptionPeriod@@":l}
let g=null!=d?d:""
Object.keys(w).forEach(e=>{g=g.replace(e,w[e])})
const v=g.replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,""),m=new FX(g,bV,AA),y=null!==(i=j(t,LG))&&void 0!==i?i:"",A=e.loc.string("ContingentOffer.Description.Format"),T={"@@BranchName@@":j(s,fW),"@@RegularPrice@@":l,"@@DiscountedPrice@@":u}
let b=A
return Object.keys(T).forEach(e=>{b=b.replace(e,T[e])}),{title:m,rawTitle:v,description:[b,y].join(" ")}}function Jo(e,t,n,r){const o=Ho(0,t,n)
if(!(0,Wv.isNothing)(o)&&!(0,Wv.isNothing)(r))return Wo(e,o.type,o.periodDuration,r)}function Ko(e,t,n,r,o){let i
switch(t){case oU:i=pW
break
case rU:i=rU
break
case IL:i=tj}const s={targetType:hW,actionType:i,targetId:t,idType:void 0,location:Ah(e,{pageInformation:n,locationTracker:r,targetType:hW,id:t},null!=o?o:t)}
return _t(e,t,hW,s)}function Zo(e,t,n,r){const o=Ho(0,t,n)
return(0,Wv.isNothing)(o)||(0,Wv.isNothing)(r)?null:Wo(e,null==o?void 0:o.type,null==o?void 0:o.periodDuration,r)}function Qo(e,t,n,r,o){let i
switch(t){case oU:i=pW
break
case rU:i=rU
break
case IL:i=tj}const s={targetType:hW,actionType:i,targetId:t,idType:void 0,location:Ah(e,{pageInformation:n,locationTracker:r,targetType:hW,id:t},null!=o?o:t)}
return _t(e,t,hW,s)}function Xo(e){switch(e.type){case iW:return ym.AppEvent
case TV:return ym.ContingentOffer
case VV:return ym.OfferItem
default:return null}}function ei(e){switch(e.type){case iW:return s$
case TV:case VV:return CO
default:return null}}function ti(e){switch(e.type){case iW:return mA
case TV:return"contingentPriceOffer"
case VV:return"winbackPriceOffer"
default:return null}}function ni(e,t,n,s,a,c,l,u,d,w,v,m,y,A){const T=Xo(t),b={...d,targetType:ei(t)}
switch(T){case ym.AppEvent:return wi(e,t,n,s,a,c,l,u,b,w,v,m,y,A)
case ym.ContingentOffer:return function(e,t,n,s,a,c,l,u){var d,f,h,w
if(t.type!==TV)return null
const v=ci(e,t,n$)
if(r(v))return null
const m=be(v.backgroundColor)?Gq:hq,y=j(t,iU),A=j(t,RH),T=j(t,YH),b=e.loc.string("ContingentOffer.AdditionalInfoButton.Title")
if((0,Wv.isNothing)(y)||(0,Wv.isNothing)(T))return null
const S=pe(e,t,sU)
if((0,Wv.isNothing)(S)||o(p(S,qF)))return null
const P=Yo(e,t)
if((0,Wv.isNothing)(P)||(0,Wv.isNothing)(null==P?void 0:P.title))return null
const I=pe(e,t,l$),C=H(I,ZF),k=ui(e,t,I,"",s,a,!1,c,l,null,u,!0)
if((0,Wv.isNothing)(k))return null
const O=pe(e,t,EO)
let E;(0,Wv.isSome)(O)&&(0,Wv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(d=ci(e,O,oW))&&void 0!==d?d:ai(e,O,oW)),(0,Wv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(f=function(e,t){var n,r
const o=g(t,"meta.associations.trunks")
if((0,Wv.isNothing)(o))return null
const i=o.data[0]
if(null!==(r=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n[RO])&&void 0!==r&&r){const t=Ke(e,i,DO)
return(0,Wv.isNothing)(t)?null:Zd(e,t,{useCase:y6.LockupIconSmall,style:fB})}return null}(e,t))&&void 0!==f?f:E)
const R=function(e,t,n){const r=u$+j(n,fW)+d$,o=j(n,LG)+f$,i=u$+e.loc.string("ContingentOffer.Terms.Title")+d$,s=j(t,QF)
return new FX([r,o,i,s].join(f$),bV)}(e,t,S),D=new $X(v,m,C,b,P.title,null!=A?A:void 0,null!==(h=P.description)&&void 0!==h?h:void 0,T,y,R,null!=E?E:void 0,k)
return D.title=null!==(w=P.rawTitle)&&void 0!==w?w:void 0,i(I)&&(D.clickAction=fi(e,t,I,D,c,l)),D}(e,t,0,c,l,b,v,y)
case ym.OfferItem:return function(e,t,n,s,a,c,l,u){var d,w,g,v,m,y
if(t.type!==VV)return null
const A=j(t,DH)
if("resubscription"!==A&&A!==h$)return null
const T=hq,b=pe(e,t,aU)
if((0,Wv.isNothing)(b))return null
const S=p(b,fL),P=wr(e,b)
if((0,Wv.isNothing)(S))return null
const I=null!==(d=null!=n?n:pe(e,t,Jq))&&void 0!==d?d:pe(e,b,Jq),C=H(I,ZF),k=j(t,CL)
if((0,Wv.isNothing)(k)||!function(e){if((0,Wv.isNothing)(e)||o(e))return!1
const t=new Date(e)
if(r(t))return!1
const n=new Date
return!(t.getTime()<=n.getTime())}(k))return null
const O=new Date(k)
let E=function(e,t){if((0,Wv.isNothing)(t))return null
const n=Re(t),o=new Date,i=(a=n,r(s=o)||r(a)?null:Math.floor((a.getTime()-s.getTime())/864e5))
var s,a
if((0,Wv.isNothing)(i))return null
const c=function(e,t){var n,r
return(null===(n=Re(e))||void 0===n?void 0:n.getTime())===(null===(r=Re(t))||void 0===r?void 0:r.getTime())}(o,t)
if(i>90)return e.loc.string(bA)
if(i>5){const n=o.getFullYear()!==t.getFullYear()?e.loc.string("OfferItems.FormattedDate.NextYear.DateFormat"):e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.DateFormat"),r=e.loc.uppercased(e.loc.formatDate(n,t))
return(0,Wv.isNothing)(r)?null:e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.Title").replace(SA,r)}return i>1?e.loc.string("OfferItems.FormattedDate.FiveDaysOrLess.Title").replace(aG,e.loc.formattedCount(i)):1!==i||c?e.loc.string("OfferItems.FormattedDate.Today.Title"):e.loc.string("OfferItems.FormattedDate.Tomorrow.Title")}(e,O);(0,Wv.isNothing)(E)&&(E=e.loc.string(bA))
let R=tf(e,b,{useCase:y6.LockupIconLarge,withJoeColorPlaceholder:!0,overrideTextColorKey:uB})
o(R)&&(R=Ot(e,_O,200,200,{type:xV,red:0,green:0,blue:0,alpha:1}),R.style=tG)
const D=Ho(0,f(S,iG),h(S,sG)),_=(0,Wv.isSome)(D)?zo(e,D.type,D.periodDuration*D.periodCount):void 0,L=null===(w=Zo(e,f(P,iG),h(P,sG),f(P,nj)))||void 0===w?void 0:w.replace("/","/\u2060"),M=null===(g=Zo(e,f(S,iG),h(S,sG),f(S,nj)))||void 0===g?void 0:g.replace("/","/\u2060"),x=e.loc.string(TA),$={"@@redemptionDate@@":e.loc.formatDate(x,O),"@@skuName@@":null!==(v=j(b,fW))&&void 0!==v?v:"@@skuName@@","@@discountedPrice@@":null!=M?M:"@@discountedPrice@@","@@regularPricePerDuration@@":null!=L?L:"@@regularPricePerDuration@@","@@discountDuration@@":null!=_?_:"@@discountDuration@@","@@payUpfrontPrice@@":null!==(m=f(S,nj))&&void 0!==m?m:"@@payUpfrontPrice@@"},F=j(t,iU)
if((0,Wv.isNothing)(F))return null
const N=pi(j(t,Nq),$),B=new FX(N,bV,AA),U=pi(j(t,RH),$),G=pi(null!==(y=j(t,kL))&&void 0!==y?y:"",$)
let V
if(i(I)&&(V=ui(e,t,I,"",s,a,!1,c,l,null,u,!0)),(0,Wv.isNothing)(V))return null
const q=new BX(null,null,T,C,B,E,U,G,F,O,R,V)
return q.title=N,i(I)&&(q.clickAction=fi(e,t,I,q,c,l)),q}(e,t,n,c,l,b,v,y)
default:return null}}function ri(e,t,n,o,a,c,l,u){const d=Xo(t),f={...a,targetType:ei(t)}
switch(d){case ym.AppEvent:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=ai(e,t,oG),p=li(e,t,cB,!0,!0),w=S(o),g=null!==(d=null==p?void 0:p.preview)&&void 0!==d?d:h
let v=Gq,m=!0,y=!1
i(g)&&(m=be(g.backgroundColor),y=be(g.backgroundColor,10),v=m?Gq:hq)
const A=Wn(0,ym.AppEvent,t.id,n.id,l,null!==(f=a.recoMetricsData)&&void 0!==f?f:null),T={...a,pageInformation:A,locationTracker:{rootPosition:0,locationStack:[]},targetType:lB},b={...T,id:n.id,inAppEventId:t.id,relatedSubjectIds:[n.id]}
w.notificationConfig=di(e,t,o,b,!1)
const P=function(e,t,n,r){var o,s
const a=j(t,Wq)
if((0,Hv.isNothing)(a)||0===a.length)return null
const c=null!==(o=n.moduleArtwork)&&void 0!==o?o:null===(s=n.moduleVideo)||void 0===s?void 0:s.preview
let l=e.loc.string(gA)
l===gA&&(l=n.subtitle)
const u=function(e,t,n,r,o,i){return qv.context("shareSheetDataForAppEvent",()=>{const e=new pZ(t,n,i)
return new hZ(e,r,void 0)})}(0,n.title,l,a,0,c)
if(!i(u))return null
const d=function(e,t,n){var r
const o=[]
if((null==n?void 0:n.length)>0){const t=Go(e,n)
i&&o.push(t)}if(t.startDate.getTime()<=Date.now())return o
if(e.host.clientIdentifier===lY)return o
const s=new LY(Lq)
s.title=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_TITLE"),s.message=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_DETAIL"),s.isCancelable=!0,s.buttonTitles=[e.loc.string(oA)],s.buttonActions=[new GY("prefs:root=Privacy&path=CALENDARS",!0)]
let a=!1
if(i(t.endDate)){const e=Re(t.startDate),n=Re(t.endDate),r=t.endDate.getTime()-t.startDate.getTime(),o=216e5
n.getTime()>e.getTime()&&r>o&&(a=!0)
const i=8634e4
e.getTime()===n.getTime()&&r>=i&&(a=!0)}const c=new wZ(t.startDate,t.endDate,a,t.title,null===(r=t.lockup)||void 0===r?void 0:r.title,t.detail,n,s,pO)
c.title=e.loc.string("SHARE_SHEET_ADD_TO_CALENDAR"),c.artwork=Ot(e,"systemimage://calendar.circle")
const l=new dZ("com.apple.AppStore.createCalendarEventActivity",c)
return o.unshift(l),o}(e,n,a),f=new KK(u,d)
return Qs(e,f,{...r,targetType:tW,actionType:oB,idType:Sq}),f}(e,t,o,b),I=m?Gq:hq,C=ui(e,t,n,w.title,I,Pj,!1,T,c,l,!1,!1)
if(r(C))return null
w.lockup=C
const k=new JK(w,h,p,P,v,y)
return jn(e,k,A,e=>{s(l)&&yW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),k}(e,t,n,o,a,l,u),f=new EY("appEventDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case ym.ContingentOffer:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=ci(e,t,oG),p=S(o)
let w=Gq,g=!0
i(h)&&(g=be(h.backgroundColor),w=g?Gq:hq)
const v=Wn(0,ym.ContingentOffer,t.id,n.id,l,null!==(d=a.recoMetricsData)&&void 0!==d?d:null),m={...a,pageInformation:v,locationTracker:{rootPosition:0,locationStack:[]}},y=g?Gq:hq,A=ui(e,t,n,null!==(f=p.title)&&void 0!==f?f:void 0,y,Pj,!1,m,c,l,!1,!1)
if(r(A))return null
p.offerLockup=A,p.trunkAppIcon=o.trunkAppIcon
const T=new eZ(p,null!=h?h:void 0,w)
return T.backButtonActionMetrics.addMetricsData(Ko(e,rU,v,m.locationTracker)),T.learnMoreActionMetrics.addMetricsData(Ko(e,oU,v,m.locationTracker,o.learnMoreTitle)),T.closeButtonActionMetrics.addMetricsData(Ko(e,IL,v,m.locationTracker)),jn(e,T,v,e=>{s(l)&&yW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),T}(e,t,n,o,a,l,u),f=new EY("contingentOfferDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case ym.OfferItem:return function(e,t,n,o,i,a,c,l){const u=function(e,t,n,o,i,a,c,l){var u,d
let f=ci(e,t,oG)
f=null
const h=Gq,p=S(o),w=Wn(0,ym.OfferItem,t.id,n.id,c,null!==(u=i.recoMetricsData)&&void 0!==u?u:null),g={...i,pageInformation:w,locationTracker:{rootPosition:0,locationStack:[]}},v=Gq,m=ui(e,t,n,null!==(d=p.title)&&void 0!==d?d:void 0,v,Pj,!1,g,a,c,!1,!1)
if(r(m))return null
p.offerLockup=m
const y=e.loc.string("Winback.AdditionalInfoButton.Title"),A=pe(e,t,aU),T=j(t,CL)
let b;(0,Wv.isSome)(T)&&(0,Wv.isSome)(A)&&(b=function(e,t,n,r){if((0,Wv.isNothing)(n))return
const o=j(n,fW),i=(0,Wv.isSome)(o)?u$+o+d$:void 0,s=j(n,LG),a=(0,Wv.isSome)(s)?s+f$:void 0,c=u$+e.loc.string("Promotion.Terms.Title")+d$
let l
const u=e.loc.string(TA)
if((0,Wv.isSome)(o)&&(0,Wv.isSome)(r)){const n={"@@redemptionDate@@":e.loc.formatDate(u,r),"@@skuName@@":o}
l=pi(j(t,QF),n)}const d=[i,a,c,l].filter(Wv.isSome).join(f$)
return new FX(d,bV)}(e,t,A,new Date(T)))
const P=new tZ(p,void 0,void 0,h,!1,y,b)
return P.backButtonActionMetrics.addMetricsData(Qo(e,rU,w,g.locationTracker)),P.learnMoreActionMetrics.addMetricsData(Qo(e,oU,w,g.locationTracker,y)),P.closeButtonActionMetrics.addMetricsData(Qo(e,IL,w,g.locationTracker)),jn(e,P,w,e=>{s(c)&&yW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),P}(e,t,n,o,i,c,l),d=new EY("offerItemDetail")
return d.title=o.title,d.pageData=u,d.animationBehavior=a,i&&i.pageInformation&&(d.referrerUrl=i.pageInformation.pageUrl),d}(e,t,n,o,f,c,l,u)
default:return null}}function oi(e){return e.bag.enableAppEvents&&!0}function ii(e){return e.bag.enableContingentOffers&&!0}function si(e){return e.bag.enableOfferItems&&!0}function ai(e,t,n){const r=B(t,n)
return(0,Hv.isNothing)(r)?null:Zd(e,r,{useCase:y6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function ci(e,t,n){const r=nt(e,t)
if((0,Hv.isNothing)(r))return null
const o=se(t,r,n)
return(0,Hv.isNothing)(o)?null:Zd(e,o,{useCase:y6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function li(e,t,n,o,i){const s=ai(e,t,`${n}.previewFrame`)
if(r(s))return null
const a=j(t,`${n}.video`)
if(r(a))return null
const c=new mz(a,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:o,playbackControls:i?{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}:{},autoPlayPlaybackControls:i?{muteUnmute:!0}:{}})
return c.canPlayFullScreen=o,c.allowsAutoPlay=!0,c.looping=!0,c}function ui(e,t,n,i,s,a,c,l,u,d,f,h){var p,w,g,v
if((0,Hv.isNothing)(t)||(0,Hv.isNothing)(n))return null
const m=Xo(t),y={...l,id:t.id,relatedSubjectIds:[n.id],idType:Sq},A={...l,id:n.id,relatedSubjectIds:[n.id],targetType:tW,idType:Sq,kind:null,softwareType:null,title:null!==(p=j(n,fW))&&void 0!==p?p:"",excludeAttribution:o(d)}
if(m===ym.AppEvent&&(y[a$]=t.id,A[a$]=t.id),(v=l)&&Object.prototype.hasOwnProperty.call(v,"id")&&(y.id=l.id,y.idType=l.idType),h){const n=m===ym.ContingentOffer?null===(w=Yo(e,t))||void 0===w?void 0:w.rawTitle:j(t,fW)
bh(e,y,null!=n?n:"")}const T=j(t,SL),b={metricsOptions:A,artworkUseCase:y6.LockupIconSmall,externalDeepLinkUrl:null!=T?T:void 0,crossLinkSubtitle:c?i:void 0,offerEnvironment:s,offerStyle:a,skipDefaultClickAction:!u,includeBetaApps:!0,referrerData:null!=d?d:void 0,shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ)&&f,parentAppData:n,useJoeColorIconPlaceholder:!0,overrideArtworkTextColorKey:uB},S=Cd(e,m===ym.AppEvent?n:t,b)
return h&&Ph(l.locationTracker),r(S)?null:(c&&(S.crossLinkTitle=null!==(g=e.loc.uppercased(S.title))&&void 0!==g?g:void 0),S)}function di(e,t,n,r,o){if(n.startDate.getTime()<=Date.now())return null
if((0,Hv.isNothing)(n.lockup))return null
const i=e.loc.string("APP_EVENTS_NOTIFICATION_TITLE").replace("{appTitle}",n.lockup.title),s=e.loc.string("APP_EVENTS_NOTIFICATION_DETAIL").replace("{eventTitle}",n.title),a=n.startDate,c=n.lockup.icon,l=n.lockup.icon.template.replace("{w}",`${c.width}`).replace("{h}",`${c.height}`).replace("{c}","wd").replace("{f}",PL)
let u,d
if(o&&(u=new LY(dB),u.title=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_TITLE"),u.message=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_DETAIL"),u.artwork=Ot(e,yA)),e.bag.newEventsForODJAreEnabled){const o=new kW,i=Nt(r.pageInformation)
i[$G]="notifyActivateNotificationsDisabled",i[nU]=Ah(e,{...r,id:t.id},""),i[c$]=""
const s=_t(e,n.lockup.adamId,tW,i)
o.actionMetrics.addMetricsData(s),d=o}else{const t=new LY(Lq)
t.title=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_TITLE"),t.message=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_DETAIL"),t.isCancelable=!0,t.buttonTitles=[e.loc.string(oA)],t.buttonActions=[new GY("prefs:root=NOTIFICATIONS_ID&path=com.apple.AppStore",!0)],d=t}const f=new LY(Lq)
f.title=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_TITLE"),f.message=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_DETAIL"),f.isCancelable=!0
const h=(new az).set(Uj,MW).param(zW.appId,n.lockup.adamId).param(zW.bundleId,n.lockup.bundleId).param(zW.appEventId,n.appEventId)
h.host=VW
const p=j(t,SL);(0,Hv.isSome)(p)&&(null==p?void 0:p.length)>0&&h.param(zW.appEventDeepLink,encodeURIComponent(p))
const w=Nt(r.pageInformation)
w[$G]="notifyActivate",w[nU]=Ah(e,{...r,id:t.id},"")
const g=_t(e,n.lockup.adamId,tW,w),v=S(w)
v[$G]="notifyDeactivate"
const m=_t(e,n.lockup.adamId,tW,v)
return new UX(t.id,i,s,l,a,u,d,f,h.build(),g,m)}function fi(e,t,n,r,o,i){const s=ri(e,t,n,r,o,BH,i,null)
if((0,Hv.isNothing)(s))return
const a={id:t.id,actionDetails:{action:"Open",contentType:ei(t)},relatedSubjectIds:[n.id],...o}
return Xo(t)===ym.AppEvent&&(a[a$]=t.id),Qs(e,s,a),s}function hi(e,t,n=null,o,s,a,c,l,u,d){var f
const h=[]
let p
for(const w of t){const t=ni(e,w,n,o,!0,hq,BH,s,a,c,l,null,u,d)
if(r(t))continue
if(t instanceof Date){((0,Hv.isNothing)(p)||t.getTime()<p.getTime())&&(p=t)
continue}const g=t,v={...a,id:w.id,kind:ti(w),targetType:ei(w),title:null!==(f=g.title)&&void 0!==f?f:"",softwareType:null},m=null!=n?n:pe(e,w,Jq)
i(m)&&(v.relatedSubjectIds=[m.id]),Mh(e,g,v),Oh(v.locationTracker),h.push(g)}return{appPromotions:h,nextAppEventPromotionStartDate:p}}function pi(e,t){let n=null!=e?e:""
return Object.keys(t).forEach(e=>{n=n.replace(e,t[e])}),n}function wi(e,t,n,r,a,c,l,u,d,f,h,p,w,g){var v,m,y
if(t.type!==iW)return null
const A=j(t,"promotionStartDate")
if((0,Hv.isNothing)(A)||0===A.length)return null
const T=new Date(A)
if((0,Hv.isNothing)(T))return null
const b=new Date
if(T.getTime()>b.getTime()&&!g)return T
const S=ai(e,t,n$),P=li(e,t,"lockupVideo",!1,!1)
if((0,Hv.isNothing)(S)&&o(P))return null
const I=null!==(v=null==P?void 0:P.preview)&&void 0!==v?v:S,C=be(null==I?void 0:I.backgroundColor)?Gq:hq,k=be(null==I?void 0:I.backgroundColor,10),O=j(t,fW)
let E=j(t,DH)
s(p)&&(E=p)
const R=j(t,r$)
if((0,Hv.isNothing)(O)||0===O.length||(0,Hv.isNothing)(E)||0===E.length||(0,Hv.isNothing)(R)||0===R.length)return null
const D=new Date(R)
if((0,Hv.isNothing)(D))return null
const _=null!==(m=j(t,LG))&&void 0!==m?m:"",L=null!=n?n:pe(e,t,Jq)
let M=null
if((0,Hv.isSome)(L)&&(M=ui(e,t,L,O,c,l,u,d,h,null,w,!0)),(0,Hv.isNothing)(M))return e.console.warn(`Parent app for event ${t.id} is missing, returning null.`),null
const x=j(t,"requirement"),$=j(t,RH),F=j(t,o$)
let N
if((0,Hv.isSome)(F)&&F.length>0&&(N=new Date(F)),void 0!==N&&N.getTime()<=b.getTime()&&!f)return null
const B=gi(null!==(y=j(t,i$))&&void 0!==y?y:void 0,D,N),U=vi(e,B,D,N),G=new GX(t.id,null!=S?S:void 0,null!=P?P:void 0,O,null!=$?$:void 0,_,D,N,B,E,null!=x?x:void 0,M,r,U,C,k)
if(i(L)){const n={...d,id:L.id,inAppEventId:t.id,relatedSubjectIds:[L.id]}
G.notificationConfig=di(e,t,G,n,!0)}return a&&i(L)&&(G.clickAction=fi(e,t,L,G,d,h)),G}function gi(e,t,n){let r=null!=e?e:Em.live
return r===Em.live&&i(n)&&n.getTime()-t.getTime()>216e5&&(r=Em.happening),r}function vi(e,t,n,r){const o=[],i=Re(n)
if((0,Hv.isNothing)(i))return[]
const s=e.loc.string("AppEvents.FormattedDate.SevenDaysOrMore.DateFormat"),a=e.loc.uppercased(e.loc.formatDate(s,n)),c=new jX(!1,void 0,null!=a?a:void 0,void 0,void 0)
o.push(c)
const l=new Date(i)
l.setDate(l.getDate()-6)
const u=e.loc.string("AppEvents.FormattedDate.SixDaysOrLess.DateFormat"),d=e.loc.formatDate(u,n),f=e.loc.uppercased(d),h=new jX(!1,l,null!=f?f:void 0,void 0,void 0)
o.push(h)
const p=new Date(i)
p.setDate(p.getDate()-1)
const w=e.loc.string("AppEvents.FormattedDate.Tomorrow"),g=e.loc.formatDateInSentence(w,vA,n),v=e.loc.uppercased(g),m=new jX(!1,p,null!=v?v:void 0,void 0,void 0)
if(o.push(m),n.getHours()>1||1===n.getHours()&&n.getMinutes()>0){let t
t=n.getHours()>=19?e.loc.string("AppEvents.FormattedDate.Tonight"):e.loc.string("AppEvents.FormattedDate.Today")
const r=e.loc.formatDateInSentence(t,vA,n),s=e.loc.uppercased(r),a=new jX(!1,null!=i?i:void 0,null!=s?s:void 0,void 0,void 0)
o.push(a)}const y=new Date(n)
let A
switch(y.setHours(y.getHours()-1),t){case Em.available:A="AppEvents.FormattedDate.AvailableIn.MinutesCountdown"
break
case Em.happening:case Em.live:default:A="AppEvents.FormattedDate.StartsIn.MinutesCountdown"}const T=new jX(!1,y,void 0,n,A)
let b,S
switch(o.push(T),t){case Em.available:b=e.loc.string("AppEvents.FormattedDate.NowAvailable"),S=!1
break
case Em.happening:b=e.loc.string("AppEvents.FormattedDate.HappeningNow"),S=!1
break
case Em.live:default:b=e.loc.string("AppEvents.FormattedDate.Live"),S=!0}const P=new jX(S,n,b,void 0,void 0)
if(o.push(P),null!==r){const t=new jX(!1,r,e.loc.string("AppEvents.FormattedDate.EventEnded"),void 0,void 0)
o.push(t)}return o}function mi(e){e.includingScopedRelationships(TV,[EO,l$,sU]),e.includingViews([kO,QO]),e.includingScopedAttributes(TV,[fW,RH,QF]),e.includingMetaKeys(WA,[zA]),e.includingMetaKeys(YA,[RO]),e.includingAssociateKeys(TV,[JA])}function yi(e){e.includingScopedRelationships(TV,[EO,l$,sU]),e.includingScopedAttributes(TV,[fW,RH,QF]),e.includingMetaKeys(WA,[zA]),e.includingMetaKeys(YA,[RO]),e.includingAssociateKeys(TV,[JA])}function Ai(e){e.enablingFeature(IV),e.includingScopedAttributes(IV,[$q]),e.addingQuery("associate[tags]",dW),e.includingScopedRelationships(A$,[uW,XO])}function Ti(e){e.includingScopedRelationships(VV,[aU]),e.includingScopedAttributes(VV,[Nq,RH,QF,CL]),e.includingMetaKeys(KA,[ZA]),e.includingKindsKeys(VV,[h$])}function bi(e){const{id:t,platform:n,...r}=e
return{...r,id:dt(t),platform:ut(n),$kind:VX}}function Si(e){return 0===e.length}function Pi(e){return!Si(e)}function Ii(e){if(null===HX){HX=new Set
for(const t of e.bag.suppressedAccessibilityAppIds)HX.add(t)}}function Ci(e){return e.featureFlags.isEnabled(vJ)&&e.bag.enableAppAccessibilityLabels}function ki(e,t){return Ii(e),(0,Hv.isSome)(HX)&&Pi(t)&&HX.has(t)}function Oi(e,t){return Ii(e),!!t.startsWith(sA)||(0,Hv.isSome)(HX)&&Pi(t)&&HX.has(t)}function Ei(e){const t=[$q,Oq,aH,IH]
return t.push(iH),e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}function Ri(e,t){return t.includingAdditionalPlatforms(ee(e)).includingRelationships(function(e){let t=[]
switch(e.client.deviceType){case lW:t=t.concat(zX),e.appleSilicon.isSupportEnabled&&t.push(gN)
break
case cW:t.push(JX)
break
case Qq:t=t.concat(WX)
break
case LV:t=t.concat(YX)
break
default:t=t.concat(qX)}return t}(e)).includingAttributes(Ei(e)).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e)),t}function Di(e){return{storefront:e.locale.activeStorefront,language:e.locale.activeLanguage}}function _i(e,t){return e.locale.normalize(t)}function Li(e){if(null===KX){KX=new Set
for(const t of e.bag.suppressedPrivacyAppIds)KX.add(t)}}function Mi(e,t){return Li(e),!(0,Wv.isNothing)(KX)&&!o(t)&&KX.has(t)}function xi(e,t){return Li(e),!(0,Wv.isNothing)(KX)&&!o(t)&&(!(!KX.has("com.apple.InstallAssistant.*")||!t.startsWith(sA))||KX.has(t))}function $i(e,t){const n=t.host
if(r(n))return!1
const o=[e.bag.mediaHost,e.bag.mediaEdgeHost(e),e.bag.mediaEdgeSearchHost]
for(const e of o)if(!r(e)&&-1!==n.indexOf(e))return!0
return!1}function Fi(e,t,n){if(!(0,Wv.isNothing)(t))return ve(e,new dY(e,t).addingQueryValues(n)).toString()}function Ni(e){let t=e.query.id
const n=e.pathname
if(r(t)&&(null==n?void 0:n.length)>0){const e=QX.exec(n)
e&&e.length>1&&(t=e[1])}if(!a(t)){const n=e.pathComponents()
s(n)&&(t=n[n.length-1])}return t}function Bi(e,t,n=!1){var r,o
let s=Ni(t)
if(!a(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
s in XX&&(s=XX[s])
let c=dW,l=ZX,u=[]
u=[OG,Fq,Zq,BL,b$,T$]
const d=null===(r=t.pathname)||void 0===r?void 0:r.split("/"),f=(0,Wv.isSome)(d)&&d.includes(xW.productBundle)
f&&(c=Zq,l=[Yj,kj,IH,eE,bj],u=[dW,Fq,b$]),u.push($F),e.bag.enablePrivacyNutritionLabels&&!Mi(e,s)&&l.push(S$),Ci(e)&&!ki(e,s)&&l.push(P$),e.appleSilicon.isSupportEnabled&&l.push(kH),e.bag.enableUpdatedAgeRatings&&l.push(Eq),nf(e)&&l.push(TH),e.bag.enableLicenses&&l.push(tE)
const h=v(t.query[zW.isArcade]);(null===h||h)&&(l.push(iB,sB,Oq),u.push($H)),e.bag.enableSellerInfo&&l.push(gB),e.bag.enableSellerICPAnnotation&&l.push(nE),e.bag.gameCenterExtendSupportedFeatures&&l.push(I$),va(e)&&u.push(rE)
const p=new dY(e).withIdOfType(s,c).includingAdditionalPlatforms(ee(e)).includingAgeRestrictions().includingRelationships(u).includingAttributes(l).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e)).includingViews([oE,BL])
p.addingRelationshipLimit(Fq,te(e)),(null===(o=t.query[zW.productVariantID])||void 0===o?void 0:o.length)>0&&p.addingQuery(zW.productVariantID,t.query[zW.productVariantID])
const w=t.query[ZW]
return i(w)&&p.addingQuery(ZW,w),oi(e)&&!f&&(ii(e)||p.includingScopedRelationships(dW,[iW]),p.includingScopedAttributes(iW,YK),p.includingScopedAvailableIn(iW,[sE])),ii(e)&&mi(p),si(e)&&Ti(p),Kt(e,KH)&&p.enablingFeature(GL),n&&p.enablingFeature(UL),ii(e)||p.includingRelationships([jL]),p.attributingTo(t.build())}function Ui(e,t,n,r,o,i){const s=ZX
e.bag.enablePrivacyNutritionLabels&&!Mi(e,t)&&s.push(S$),Ci(e)&&!ki(e,t)&&s.push(P$),e.appleSilicon.isSupportEnabled&&s.push(kH),e.bag.enableUpdatedAgeRatings&&s.push(Eq),nf(e)&&s.push(TH),e.bag.enableLicenses&&s.push(tE),e.bag.gameCenterExtendSupportedFeatures&&s.push(I$)
const a=new dY(e).withIdOfType(t,dW).includingAdditionalPlatforms(ee(e)).includingAttributes(s).includingRelationships([$H,OG,$F,Fq,Zq,b$,T$]).addingRelationshipLimit(Fq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingViews([BL]).usingCustomAttributes(Ue(e))
return n&&a.addingQuery("availability",iE),(0,Wv.isSome)(r)&&a.addingQuery(zW.productVariantID,r),i&&a.enablingFeature(UL),oi(e)&&!o&&(ii(e)||a.includingScopedRelationships(dW,[iW]),a.includingScopedAttributes(iW,YK),a.includingScopedAvailableIn(iW,[sE])),ii(e)&&mi(a),si(e)&&Ti(a),ii(e)||a.includingRelationships([jL]),va(e)&&a.includingRelationships([rE]),Kt(e,KH)&&a.enablingFeature(GL),a}function Gi(e,t){if(!e.client.isPhone||!e.featureFlags.isEnabled(xJ))return!1
if((0,Hv.isNothing)(t))return!0
switch(t){case Jj:return e.bag.isAppsGroupingTagsEnabled
case yH:return e.bag.isAppsProductPageTagsEnabled
case kx:return e.bag.isAppsSlpTagsEnabled
default:return!1}}function ji(e){return B0.has(e)}function Vi(e){return M0.has(e)}function Hi(e){return F0.has(e)}function qi(e){return $0.has(e)}function Wi(e,t,n){const r=q(t,zj)
let o=null
const i=j(t,"gamesFilter")
switch(i){case sW:case TM:case"all":o=i
break
default:r!==S0&&r!==C0||(o=sW)}let a=null,c=j(t,Yi(0,r)),l=null,d=null,h=j(t,Rj)
const p={}
let w=!1
const g=we(t,yU)[0]
if(r===b0&&s(g))if(a=e.loc.uppercased(j(t,Yi(0,r))),h=null,g.type===NV){c=Wf(e,g,fW)
const t=Sn(e,g,!1)
if((0,Hv.isSome)(t)){l=Zd(e,t,{useCase:y6.LockupIconSmall,style:cN})
const n={type:_N,name:XF}
p.eyebrowColor=n}d={forYou:!0}}else w=!0,c=j(g,Yi(0,r)),l=tf(e,g,{useCase:y6.LockupIconSmall})
const v={featuredContentId:r,id:f(t,"id"),presentationHints:{},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,featuredContentData:t,title:c,subtitle:h,eyebrow:a,titleArtwork:l,shelfHeaderConfiguration:p,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
return{shelfToken:v,metricsOptions:{id:v.id,kind:null,softwareType:u(null==n?void 0:n.isArcadePage)?vq:null,targetType:dq,title:w?v.eyebrow:v.title,badges:d,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:wV,fcKind:r,recoMetricsData:es(e,t)}}}function zi(e){return e&&e.isDeferring&&e.isFirstRender}function Yi(e,t){switch(t){case E0:case S0:case P0:return Nq
default:return fW}}function Ji(e){let t=(new az).set(Uj,OW).append(gV,xW.grouping).append(gV,xW.shelf).append(gV,encodeURIComponent(JSON.stringify(e))).param(zW.groupingFeaturedContentId,`${e.featuredContentId}`)
return(0,Hv.isSome)(e.nativeGroupingShelfId)&&(t=t.param(zW.nativeGroupingShelfId,`${e.nativeGroupingShelfId}`)),t.build()}function Ki(e,t,n){if(o(n))return null
r(n.shelfStyle)&&(n.shelfStyle=t.contentType)
const i=t.contentType!==IN&&s(t.items)
return n.hasExistingContent=n.hasExistingContent||i&&n.isFirstRender,(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?Ji(n):null}function Zi(e,t){e.remainingItems=e.remainingItems.filter(e=>!t.has(e.id))}function Qi(e,t,n){var r
const o=s(t.remainingItems),i=!o&&(null===(r=t.recommendationsHref)||void 0===r?void 0:r.length)>0
if(o){const n=function(e,t){var n
const r=(null===(n=t.relationshipToFetch)||void 0===n?void 0:n.length)>0
let o=t.remainingItems
return r&&(o=t.remainingItems.map(n=>pe(e,n,t.relationshipToFetch))),o}(e,t),r=new dY(e,n,!0)
return Je(e,r,n),Xi(e,r),r}if(i){const n=new dY(e,t.recommendationsHref).includingAgeRestrictions()
return Xi(e,n),oi(e)&&(n.enablingFeature(zH),n.includingMetaKeys(RB,[N$,hM]),n.includingScopedAttributes(iW,YK),n.includingScopedRelationships(iW,[Jq])),ii(e)&&(n.enablingFeature(pM),yi(n)),si(e)&&(n.enablingFeature(DB),Ti(n)),Gi(e,Jj)&&Ai(n),n}return null}function Xi(e,t){t.includingAdditionalPlatforms(ee(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
let n=[$q,Oq,IH]
t.includesResourceType(iW)&&oi(e)&&(t.enablingFeature(zH),t.includingMetaKeys(RB,[N$,hM]),t.includingScopedAttributes(iW,YK),t.includingScopedRelationships(iW,[Jq])),t.includesResourceType(TV)&&ii(e)&&(t.enablingFeature(pM),yi(t),n=[]),t.includesResourceType(VV)&&si(e)&&(t.enablingFeature(DB),Ti(t),n=[]),(t.includesResourceType(dW)||t.includesResourceType(iW))&&(n=n.concat(Yj,kj,CV)),e.bag.enableUpdatedAgeRatings&&n.push(Eq),Gi(e,Jj)&&Ai(t),t.includingAttributes(n)}function es(e,t){const n=q(t,zj)
switch(n){case v0:case c0:case l0:case u0:case k0:case e0:case h0:case p0:case w0:case t0:case D0:case _0:return St(fe(t,oH))
case T0:case n0:{const e=fe(t,oH),n=G(t,RN)
return s(e)?St(e):s(n)?St(t):null}case a0:case g0:case L0:return null
default:if(function(e){return Vi(e)||ji(e)||U0.has(e)||e===O0}(n)){let e=fe(t,uW)
if(r(e))return null
const n=e.data
return n&&0!==n.length||(e=fe(t,oH)),St(e)}return e.console.warn("Unknown featured content ID:",n),null}}function ts(e,t,n){const r=Zd(e,t,n)
return r&&(r.crop="sr"),r}function ns(e,t,n,r,o){const i=B(t,oW)
if(i instanceof Array){const t=function(e,t,n,r){const o=n/r
let i=0,s=null
for(const e of t){const t=h(e,fG),r=t/h(e,BG);(r===o||Math.abs(o-r)<=Math.abs(o-i))&&(!s||t<=n&&t>s.width||s.width>n&&t<s.width&&t>s.width)&&(s=e,i=r)}return s?Ot(e,f(s,Wq),h(s,fG),h(s,BG),null,null,f(s,dE)):null}(e,i,n,r)
return t.crop="bb",t}return null!=i?ts(e,i,o):null}function rs(e,t,n,r,o,i){const s=l(t.meta,rb),a=[]
if((0,Hv.isSome)(s))for(const t of s){const n=Cd(e,t,{artworkUseCase:y6.LockupIconSmall,metricsOptions:i,useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:ah}),r=null==n?void 0:n.icon;(0,Hv.isSome)(r)&&a.push(r)}return a}function os(e,t,n,a,c,l,u,d){var h,p,w
const g=(null===(h=f(t,Wq))||void 0===h?void 0:h.length)>0,v=(null===(p=j(t,Ib))||void 0===p?void 0:p.length)>0,m=de(t,bH,!1),y=de(t,uW,!1)||m
let A=j(t,DH)===VE
if(v||g)return function(e,t,n,o,s){const a=i(f(t,Wq))?t:B(t,Mq)
if(r(a)||zi(n))return c=t,s?s():null==n||n.remainingItems.push(c),null
var c
const l=f(a,v$),u=f(a,Wq),d=f(a,YH),h=us(j(t,QE))||d
let p=null
if(l===LL)p=new GY(u),p.title=h
else{const t=e.required(y3).fetchFlowPage(u),n=new EY(t)
n.pageUrl=u,n.title=h,p=n}return p.presentationStyle=[nO],Qs(e,p,{...o,id:""}),{action:p,caption:null,title:h,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,l,d)
if(y){let h,p,g
if(a&&!m){g=As(e,"groupingCommon",we(t,uW),!0,c,!1,1)
const n=g.personalizedData
if(0===n.length)return null
h=n[0]}else h=pe(e,t,m?bH:uW)
if(j(h,DH)===VE&&(p=h,h=pe(e,h,bH),A=!0),r(h))return null
if(r(h.attributes)||zi(n))return s(n)&&(n.isDeferring=!0),function(e){d?d():null==n||n.remainingItems.push(e)}(h),null
let v=Wf(e,h,Rj)||Td(e,h)
const y=Js(e,t,l)
y.targetType=l.targetType
let T=Fd(e,h,y,null==n?void 0:n.clientIdentifierOverride)
const b=H(h,uU)
let S,P=null,I=null,C=null
const k=j(h,"itunesNotes.short"),O=(null===(w=h.id)||void 0===w?void 0:w.length)>0,E={...l,id:O?h.id:t.id,idType:O?Sq:SU}
switch(h.type){case MV:P=B(h,oW),A&&(h=null!=p?p:t)
break
case Xq:{const t=pe(e,h,OH)
if(s(t)){const r={...E,inAppEventId:t.id},s=pe(e,t,Jq)
i(s)&&(r.relatedSubjectIds=[s.id])
const a=wi(e,t,null,!1,!0,Gq,uq,!1,r,!1,!0,null,n.isArcadePage,!1)
if("AppEventCard"===j(h,LN)){if(a instanceof Date)return Br(a,u.refreshController),null
if((0,Hv.isNothing)(a))return null
S=a,b||(T=S.clickAction),o(v)&&(v=Wf(e,t,tV))}}I=j(h,YH),I&&(I=I.replace(/\n/g," "))
const a=pe(e,h,uW),c=f(h,iV)
o(v)&&(c?v=c:a&&(v=Wf(e,a,tV))),o(v)&&i(S)&&(v=S.subtitle)
let d=j(h,$E);((0,Hv.isNothing)(d)||0===d.length)&&(d=v)
const p={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
if(r(S)&&na(0,h),p.clientIdentifierOverride=Fr(e,h),i(S))C=S.lockup
else{const t=null,r=null
{bh(e,E,null==n?void 0:n.title)
const o=ko(e,we(h,OH),p,l.pageInformation,l.locationTracker,t,r,na(0,h))
1===o.length&&(C=o[0]),Ph(E.locationTracker)}}}default:{const t=[dW,KV,Zq,JH]
if(r(C)&&t.indexOf(h.type)>-1){bh(e,E,null==n?void 0:n.title)
const t={metricsOptions:{pageInformation:l.pageInformation,locationTracker:l.locationTracker,recoMetricsData:St(h)},clientIdentifierOverride:null==n?void 0:n.clientIdentifierOverride,artworkUseCase:Kd(0,null==n?void 0:n.shelfStyle),canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ)&&n.isArcadePage}
C=Cd(e,h,t),Ph(E.locationTracker)}P=Ke(e,h,$q)||B(h,$q),o(v)&&i(C)&&(v=C.subtitle)
break}}if(i(T)&&(T.presentationStyle=[nO],!A)){const n=us(j(t,QE)),r=Wf(e,h,fW)
T.title=n||r||T.title||v||I}return{action:T,caption:I,title:null==T?void 0:T.title,subtitle:v,artwork:P,shortEditorialDescription:k,content:h,lockup:C,appEvent:S,onDevicePersonalizationDataProcessingType:null==g?void 0:g.processingType}}return null}function is(e,t,n,r){const o=j(t,fW),i=Fi(e,f(t,AG)),s=e.required(y3).fetchFlowPage(i),a=new EY(s)
return a.pageUrl=i,{action:a,caption:Vb,title:o,subtitle:Vb,artwork:null,shortEditorialDescription:o}}function ss(e,t){const n={}
for(const t of e)n[t.id]=t
const r=[uW,Jj],o=[]
for(const e of t){let t=!0
for(const o of r){const r=we(e,o)
if(i(r)){const i=[]
for(const e of r){const t=n[e.id]
s(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function as(e,t,n){t.seeAllAction=null,t.isHorizontal=!1,t.shouldFilterApps&&(t.filteredItemsMinimumCount=0,t.filteringExcludedItems=n.includedAdAdamIds)}function cs(e,t){switch(t){case WH:return EV
case kU:return kN
case Pq:return _B
case DV:return XE
default:return null}}function ls(e,t){let n=j(t,FV)
return n||(n=j(t,"contentId")),n||(n=j(t,"id")),n}function us(e){if(r(e))return null
const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"")
return t.match(/^\s*$/)?null:t}function ds(e,t,n){e.featureFlags.isEnabled(AJ)?t.titleAction=n:t.accessoryAction=n}function fs(e,t,n){e.featureFlags.isEnabled(AJ)?(0,Hv.isSome)(t.header)?ds(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}async function hs(e,t,n){const r=n===vW?"OnDeviceRecommendationsShelfController":pP
return await new Promise((n,i)=>{if(o(e.user.dsid)){const e=`${r}: User is currently not signed in.`
return qv.unexpectedType(_H,e,null),void i(new Error(e))}if(o(t)){const e=`${r}: Missing valid useCase for ODP: ${t}`
return qv.unexpectedType(_H,e,null),void i(new Error(e))}e.onDeviceRecommendationsManager.performRequest({type:wP,dsId:e.user.dsid,useCase:t}).then(a=>{const c=l(a[gP]),u=y(a[Cj])
if(o(c)){const e=`${r}: ODP returned no candidate ids for useCase: ${t}`
return qv.unexpectedType(_H,e,null),void i(new V0(e))}if(o(u)){const e=`${r}: ODP returned no metrics for useCase: ${t}`
return qv.unexpectedType(_H,e,null),void i(new Error(e))}const d=[]
for(const e of c)s(e)&&d.push({id:e,type:dW})
const f=new dY(e,d).withFilter("apps:recommendable",pq).addingQuery(zW.onDevicePersonalizationUseCase,t)
Xi(e,f),Ln(e,f).then(e=>{n({candidates:c,recoMetrics:u,dataContainer:e})}).catch(e=>{const t=`${r}: Failed to fetch Media API data for candidates: ${c}`
qv.unexpectedType(_H,t,null),i(new Error(t))})}).catch(e=>{const n=`${r}: Failed to perform ODP for useCase: ${t}, ${e}`
qv.unexpectedType(_H,n,null),i(new Error(n))})})}function ps(e){const t=new Set,n=[]
return e.forEach((e,r)=>{t.has(e.appId)||(n.push(e.appId),t.add(e.appId))}),n}function ws(e,t){var n
const r=Number(null!==(n=t[dP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.onDeviceScore
t.modifiedScore=r*n+(1-r)*e}return e.sort((e,t)=>t.modifiedScore-e.modifiedScore),e}function gs(e,t){const n=e.filter(e=>i(e.pinnedPosition))
e=e.filter(e=>r(e.pinnedPosition))
const o=new Map
e.reverse(),e.forEach((e,t)=>{e.appId in o?o[e.appId].push(e):o[e.appId]=[e]})
const s=[],a=Math.max(...Object.values(o).map(e=>e.length))
for(let e=0;e<a;e++){const e=[]
t.forEach(t=>{t in o&&o[t].length>0&&(s.push(o[t].pop()),0!==o[t].length&&e.push(t))}),t=e}const c=new Array(n.length+s.length)
n.sort((e,t)=>e.pinnedPosition-t.pinnedPosition)
for(const e of n)e.pinnedPosition<c.length?c[e.pinnedPosition]=e:s.push(e)
s.reverse()
for(const[e,t]of c.entries())r(t)&&s.length&&(c[e]=s.pop())
return c}function vs(e){const t=new Map
return s(e)&&e.split(",").forEach(e=>{const n=e.split("=")
2===n.length&&t.set(n[0],Number(n[1]))}),t}function ms(e,t,n,s,a,c,l,u){var d
let p={sortedDataItems:[],processingType:0}
if(null!==(d=null==n?void 0:n.metricsData[iD])&&void 0!==d&&d){const e=function(e,t,n,r,o){const s=[]
for(const e of t){const t=new q0(e),a=h(e,ax)
let c=f(e,PU)
if(((0,Hv.isNothing)(c)||0===c.length)&&(null==o?void 0:o.length)>0&&(c=o),(0,Hv.isNothing)(c)||0===c.length)r&&(t.isUnpersonalizedMatch=!0,s.push(t))
else{if(i(n)){const e=n[c]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=c,t.score=null!=a?a:0,s.push(t)}}return s}(0,t,null==n?void 0:n.personalizationData,s,l),r=ws(e,null==n?void 0:n.metricsData),o=e.every((e,t)=>e===r[t])
p={sortedDataItems:r,processingType:o?z0.contentsNotChanged:z0.contentsSorted},i(c)&&p.sortedDataItems.length>=c&&(p.sortedDataItems=p.sortedDataItems.slice(0,c))}else{const d=function(e,t,n,r,s){const a=[]
for(const c of t){const t=new q0(c),l=f(c,hP)
let u=f(c,PU),d=f(c,sD)
if(((0,Hv.isNothing)(u)||0===u.length)&&(null==s?void 0:s.length)>0&&(u=s,d=e.random.nextUUID()),o(l)||o(u)||o(d)){r&&(t.isUnpersonalizedMatch=!0,a.push(t))
continue}const h=l.split(",")
if(h.includes(W0)&&(t.isWildcardMatch=!0),i(n)){const e=n[u]
if(i(e))for(const n of h)if(e.userSegments.includes(n)){t.isExactMatch=!0
break}}t.appId=u,t.groupId=d,a.push(t)}return a}(e,t,null==n?void 0:n.personalizationData,s,l),h=ps(d),w=function(e,t){var n
const r=new Set,i=[],s=t.filter(e=>e.isExactMatch).map(e=>e.groupId),a=new Set(s)
t.forEach((e,t)=>{if(o(e.groupId))i.push(e)
else if(!r.has(e.groupId))if(e.isUnpersonalizedMatch)i.push(e)
else{if(e.isExactMatch)return r.add(e.groupId),void i.push(e)
if(!a.has(e.groupId)){if(e.isWildcardMatch)return r.add(e.groupId),void i.push(e)
e.isFallbackMatch=!0,i.push(e)}}})
const c=[],l=i.slice().reverse()
for(const e of l)e.isFallbackMatch&&r.has(e.groupId)||(c.push(e),(null===(n=e.groupId)||void 0===n?void 0:n.length)>0&&r.add(e.groupId))
return c.reverse(),c}(0,d)
p=function(e,t,n,o,i,s){let a
const c=t.filter(e=>e.isExactMatch||e.isWildcardMatch||e.isUnpersonalizedMatch||r(e.groupId))
return r(i)?a=ys(c,o,s):c.length>=i||!n?(a=ys(c,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)):(a=ys(t,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)),a}(0,w,a,h,c,u)}const w=p.sortedDataItems.map(e=>e.rawData)
return{personalizedData:w,processingType:(t.length!==w.length?z0.contentsFiltered:z0.contentsNotChanged)+p.processingType}}function ys(e,t,n){const r=e.filter(e=>e.isExactMatch)
let o=e.filter(e=>!e.isExactMatch)
i(n)&&n&&(o=gs(o,t))
const s=r.concat(o),a=e.every((e,t)=>e===s[t])
return{sortedDataItems:s,processingType:a?z0.contentsNotChanged:z0.contentsSorted}}function As(e,t,n,r,a,c=!1,l,u,d){return Ts(e)?t===bb?function(e,t,n,r,o){var a,c
let l=t,u=!1
const d=[]
e.featureFlags.isEnabled(_J)||(l=t.filter((e,t)=>!s(e.type)||e.type===iW||(d.push(t),!1)),u=l.length!==t.length)
const p=null==r?void 0:r.metricsData,w=null!==(a=p.use_segment_scores)&&void 0!==a&&a,g=null!==(c=p[iD])&&void 0!==c&&c
let m
if(m=w||g?function(e,t,n,r){var o
let s=[],a=[]
null!==(o=null==n?void 0:n.metricsData[iD])&&void 0!==o&&o?(s=function(e,t,n){const r=[]
for(const[e,o]of t.entries()){const t=new H0(o),s=v(o,fP),a=f(o,PU),c=h(o,ax)
if(i(n)){const e=n[a]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=a,t.score=null!=c?c:0,s&&(t.pinnedPosition=e),r.push(t)}return r}(0,t,null==n?void 0:n.personalizationData),a=ws(s,null==n?void 0:n.metricsData)):(s=function(e,t){const n=[]
for(const[e,r]of t.entries()){const t=new H0(r),o=f(r,PU),i=f(r,sD),s=h(r,ax),a=f(r,"meta.personalizationData.segScores"),c=v(r,fP),l=vs(a)
t.appId=o,t.groupId=i,t.score=null!=s?s:0,t.segScores=l,c&&(t.pinnedPosition=e),n.push(t)}return n}(0,t),a=function(e,t){const n=function(e,t){var n
for(const r of e){const e=r.appId,o=r.segScores,s=r.score
if(i(t)){const a=t[e]
if(i(a)){let e=0,t=0
for(const n of a.userSegments)o.has(n)&&(t+=o.get(n),e+=1)
if(e){const n=t/e
r.modifiedScore=s*n}}else{const e=null!==(n=o.get("0"))&&void 0!==n?n:0
r.modifiedScore=s*e}}else r.modifiedScore=s}return e}(e,null==t?void 0:t.personalizationData),r=function(e,t){var n
const r=Number(null!==(n=t[dP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.modifiedScore
t.modifiedScore=r*n+(1-r)*e}return e}(n,null==t?void 0:t.metricsData)
return r.sort((e,t)=>t.modifiedScore-e.modifiedScore),r}(s,n),i(r)&&r&&(a=gs(a,ps(a))))
const c=a.map(e=>e.rawData),l=a.every((e,t)=>e===s[t])?z0.contentsNotChanged:z0.contentsSorted
return{personalizedData:c,processingType:(t.length!==c.length?z0.contentsFiltered:z0.contentsNotChanged)+l}}(0,l,r,o):ms(e,l,r,n,null,null,null,o),u){const e=m.personalizedData
d.forEach(n=>{const r=t[n]
n<e.length?e.splice(n,0,r):e.push(r)}),m={personalizedData:e,processingType:m.processingType}}return m}(e,n,r,a,d):ms(e,n,a,r,c,l,u,d):function(e,t,n){let r=[]
const s=new Set
for(const e of t){const t=f(e,hP),n=f(e,PU),i=f(e,sD)
o(t)||o(n)||o(i)?r.push(e):s.has(i)||t.split(",").includes(W0)&&(r.push(e),s.add(i))}return i(n)&&r.length>n&&(r=r.slice(0,n)),{personalizedData:r,processingType:null}}(0,n,l)}function Ts(e){return e.user.isOnDevicePersonalizationEnabled&&e.bag.enableOnDevicePersonalization}function bs(e,t){return Ts(e)?e.host.platform===dV?e.user.onDevicePersonalizationDataContainerForAppIds(Array.from(t)):{personalizationData:{},metricsData:null}:null}function Ss(e){return Ts(e)&&e.host.platform===dV?e.user.onDevicePersonalizationDataContainerForAppIds([]).metricsData:null}function Ps(e,t,n,r){return Ld(e,t,{offerEnvironment:"ad",offerStyle:Pj,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdvert:!0,adSlotOverride:r.parsedCardCount,disableFastImpressionsForAds:!0},clientIdentifierOverride:n.clientIdentifierOverride,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:y6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton},{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{}},null,!1)}function Is(e){for(const t of e)switch(t.type){case Rm.EditorialItem:case Rm.EditorialItemGroup:return W(t.data)}return!1}function Cs(e,t){if(!Ts(e))return null
const n=new Set
for(const e of t){if(r(e.contents))continue
const t=e=>f(e,PU)
for(const r of e.contents)if(r.type===Dj){const e=l(r.meta,L_)
for(const r of e){const e=t(r)
s(e)&&n.add(e.toString())}}else{const e=t(r)
s(e)&&n.add(e.toString())}}return bs(e,n)}function ks(e,t,n,r,o,i){var s
const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
return a.useOTDTextStyle=null!==(s=v(t,"meta.personalizationData.isOfTheDay"))&&void 0!==s&&s,a.replaceIfAdPresent=v(t,bC),a.isAdEligible=n,a.currentRowIndex=r,a.metricsDisplayStyle=o,a.isHeroCard=i,a}function Os(e,t){if(e.client.isPhone)return t.currentRowIndex}function Es(e,t,n){switch(t){case om.Grid:n%2==1&&e.currentRowIndex++
break
case om.Hero:0!==n&&(n-1)%2!=1||e.currentRowIndex++
break
case om.Standard:e.currentRowIndex++}}function Rs(e,t,n,r){if(e.client.isPad)t.currentRowMetricsDisplayStyle=bm.MediumCard
else switch(n){case om.Grid:t.currentRowMetricsDisplayStyle=bm.SmallCard
break
case om.Hero:t.currentRowMetricsDisplayStyle=0===r?bm.MediumCard:bm.SmallCard
break
case om.Standard:t.currentRowMetricsDisplayStyle=bm.MediumCard}}function Ds(e,t){var n
if(t.type===Xq)return om.Standard
let r
const o=N(t)
return W(o)&&(r=j(o,"editorialItemGroupDisplayStyle")),(0,Hv.isNothing)(r)&&(r=null!==(n=j(t,CH))&&void 0!==n?n:om.Standard),function(e,t){return!(0,Hv.isNothing)(t)&&(t!==om.Grid||e.client.isPhone)}(e,r)?r:om.Standard}function _s(e){return e.adLocation===e.parsedCardCount||!(0,Hv.isNothing)(e.eligibleAdLocations)&&e.eligibleAdLocations.includes(e.parsedCardCount)}function Ls(e,t,n){var r
const o=xs(e,t,n,()=>{var r,o,i
const s=[]
null===(r=n.pageInformation.adPageInfo)||void 0===r||r.updateContainerId(e,null===(o=n.pageInformation.adPageInfo)||void 0===o?void 0:o.containerIdForSlotIndex(null!==(i=n.parsedCardCount)&&void 0!==i?i:0))
const a=Ds(e,t.data)
Rs(e,n,a,0)
const c=ks(0,t.data,_s(n),Os(e,n),n.currentRowMetricsDisplayStyle,!1)
c.baseMetricsOptions={recoMetricsData:Ws(t)}
const l=$s(e,n,c,t.data)
return(0,Hv.isNothing)(l)||(s.push(l),Oh(n.locationTracker),n.parsedCardCount++,Es(n,a,0)),s})
if(o.contentsMetadata={type:M_,debugSectionTypeIndicatorColor:t.type===Rm.EditorialItemGroup?Se(OE):Se(OL),groupDisplayStyle:om.Standard},!t.isFirstItemInModule){const e=qs(0,t);(0,Hv.isSome)(e)&&(o.background=e.shelfBackground,(0,Hv.isSome)(null===(r=o.header)||void 0===r?void 0:r.configuration)&&(o.header.configuration.eyebrowColor=e.eyebrowColor,o.header.configuration.titleColor=e.titleColor,o.header.configuration.subtitleColor=e.subtitleColor))}return o}function Ms(e,t,n){var r
let o=!0
const i=xs(e,t,n,()=>{var r,i,s,a,c,u,d
const f=[],h=vn(e)&&null!==(r=(0,Yv.asNumber)(t.data,"meta.personalizationData.displayEICount"))&&void 0!==r?r:100
let p=l(t.data.meta,L_);(0,Hv.isSome)(n.recoImpressionData)&&(p=wn(p,n.recoImpressionData,null!==(i=n.pageInformation.recoMetricsData)&&void 0!==i?i:{}))
const w=Ds(e,t.data)
let g=0
for(const[r,i]of p.entries()){null===(s=n.pageInformation.adPageInfo)||void 0===s||s.updateContainerId(e,null===(a=n.pageInformation.adPageInfo)||void 0===a?void 0:a.containerIdForSlotIndex(null!==(c=n.parsedCardCount)&&void 0!==c?c:0)),Rs(e,n,w,g)
const l=ks(0,i,_s(n),Os(e,n),n.currentRowMetricsDisplayStyle,w===om.Hero&&0===r),d=$s(e,n,l,i)
if((0,Hv.isSome)(d)&&(f.push(d),Oh(n.locationTracker),n.parsedCardCount++,Es(n,w,g),g++),l.isHeroCard&&(0,Hv.isNothing)(d)&&([GG,nG].includes(e.client.buildType)&&qv.unexpectedType(_H,`Hero story group ${null===(u=t.data)||void 0===u?void 0:u.id} must contain a valid hero card at index ${r}. Unable to parse card ${i.id}.`,null),o=!1),r<p.length-1&&n.adPlacementBehavior===im.insertIntoShelf){const t=Ns(e,n,ks(0,n.adData,_s(n),Os(e,n),void 0,!1));(0,Hv.isSome)(t)&&(n.parsedCardCount++,Es(n,om.Standard,0),Oh(n.locationTracker),f.push(t))}if(f.length===h)break}if(o){const n=3
f.length!==n&&([GG,nG].includes(e.client.buildType)&&qv.unexpectedType(_H,`Hero story group ${null===(d=t.data)||void 0===d?void 0:d.id} must contain exactly ${n} items but only found ${f.length} items.`,null),o=!1)}return f})
let s=Ds(e,t.data)
if(s!==om.Hero||o||(s=om.Standard),i.contentsMetadata={type:M_,debugSectionTypeIndicatorColor:Se(OE),groupDisplayStyle:s},!t.isFirstItemInModule){const e=qs(0,t);(0,Hv.isSome)(e)?(i.background=e.shelfBackground,(0,Hv.isSome)(null===(r=i.header)||void 0===r?void 0:r.configuration)&&(i.header.configuration.eyebrowColor=e.eyebrowColor,i.header.configuration.titleColor=e.titleColor,i.header.configuration.subtitleColor=e.subtitleColor)):s===om.Hero&&Array.isArray(i.items)&&(i.background=function(e){const t=e.map(e=>e.media.bestBackgroundColor()).filter(e=>(0,Hv.isSome)(e))
let n=null
if(t.length>0&&t.length<=4&&t.length===e.length)switch(t.length){case 1:n={type:_x,colors:{colorCount:"oneColor",color:t[0]}}
break
case 2:n={type:_x,colors:{colorCount:"twoColor",top:t[0],bottom:t[1]}}
break
case 3:n={type:_x,colors:{colorCount:"threeColor",top:t[0],bottomLeading:t[1],bottomTrailing:t[2]}}
break
case 4:n={type:_x,colors:{colorCount:"fourColor",topLeading:t[0],topTrailing:t[1],bottomLeading:t[2],bottomTrailing:t[3]}}}else n={type:PV,color:Se("secondarySystemBackground")}
return n}(i.items))}return i}function xs(e,t,n,r){const i=t.type===Rm.EditorialItemGroup,s=new dJ(Bj)
if(s.id=t.data.id,s.isHorizontal=!1,s.header=function(e,t,n){var r
if(null!==(r=v(t.data,"meta.personalizationData.suppressHeader"))&&void 0!==r&&r)return null
const o={eyebrow:Bs(0,t),eyebrowArtwork:js(e,t,Im.Eyebrow),eyebrowArtworkType:Vs(e,t,Im.Eyebrow),title:Us(0,t),titleArtwork:js(e,t,Im.Title),titleArtworkType:Vs(e,t,Im.Title),subtitle:Gs(0,t),configuration:{eyebrowImageColor:null,titleImageColor:null,includeSeparator:!1}}
return(0,Hv.isSome)(o.eyebrow)||(0,Hv.isSome)(o.title)||(0,Hv.isSome)(o.subtitle)?o:null}(e,t),i){const r={id:s.id,kind:aD,softwareType:null,targetType:dq,title:Us(0,t,!0),pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:Sq,recoMetricsData:Ws(t)}
t.type===Rm.EditorialItemGroup&&(r[jS]=f(t.data,AC),r[GS]=f(t.data,TC)),Mh(e,s,r),bh(e,r,r.title)}return s.items=r(),s.isHidden=o(s.items),i&&(Ph(n.locationTracker),Oh(n.locationTracker)),s}function $s(e,t,n,r){var o
let a
if(t.adPlacementBehavior===im.replaceOrganic&&i(n.replaceIfAdPresent)&&v(n.replaceIfAdPresent)){const o=Ns(e,t,n)
a=s(o)?o:bo(e,r,n,t)}else t.adPlacementBehavior===im.dropAd&&i(n.replaceIfAdPresent)&&!v(n.replaceIfAdPresent)?(a=bo(e,r,n,t),s(t.adData)&&(null===(o=t.pageInformation.adPageInfo)||void 0===o||o.setMissedOpportunity(e,uA,"0",t.parsedCardCount))):a=bo(e,r,n,t)
return a}function Fs(e,t){let n=null
if(!Kt(e,zq)||(0,Hv.isNothing)(t.adData)||t.adPlacementBehavior!==im.insertIntoShelf)return n
if(t.adLocation!==t.parsedCardCount)return n
n=new dJ(Bj),n.id=t.adData.id,n.isHorizontal=!1,n.contentsMetadata={type:M_,debugSectionTypeIndicatorColor:Se(OL),groupDisplayStyle:om.Standard}
const r=[],o=Ns(e,t,ks(0,t.adData,_s(t),Os(e,t),void 0,!1))
return(0,Hv.isSome)(o)&&(t.parsedCardCount++,Es(t,om.Standard,0),Oh(t.locationTracker),r.push(o)),n.items=r,s(n.items)?n:null}function Ns(e,t,n){var o,s,a
if(!Kt(e,zq))return null
if(t.adLocation!==t.parsedCardCount&&t.adPlacementBehavior!==im.replaceOrganic)return null
null===(o=t.pageInformation.adPageInfo)||void 0===o||o.updateContainerId(e,null===(s=t.pageInformation.adPageInfo)||void 0===s?void 0:s.containerIdForSlotIndex(null!==(a=t.parsedCardCount)&&void 0!==a?a:0))
const c=function(e,t,n,o){return qv.context("createTodayAdCard",()=>{var s,a,c,l,u,d,h
if(r(t))return null
const p=go(e,t,n,o)
So(e,t,n,o,f(t.attributes.name))
const w=Bh(e,t,f(t.attributes.name),{targetType:Bj,pageInformation:o.pageInformation,locationTracker:o.locationTracker,isAdvert:!0,rowIndex:n.currentRowIndex,displayStyle:n.metricsDisplayStyle}),g=Ge(e,t)
w.productVariantData=g,w.adSlotOverride=o.parsedCardCount,w.kind=h_
const v=w
let m
null===(s=w.pageInformation)||void 0===s||s.adPageInfo.apply(e,t),i(n)&&(m=n.clientIdentifierOverride)
const y=(0,Hv.isSome)(null)
switch(p.style=Gq,Qt(e)){case Jx:null===(c=null===(a=w.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c||c.setTemplateType(e,rG)
break
case oq:y&&(null===(u=null===(l=w.pageInformation)||void 0===l?void 0:l.adPageInfo)||void 0===u||u.setTemplateType(e,[Yb,"U","I",1,"_2x1"].join("")))}let A=Ps(e,t,n,o)
if(r(A))return null===(d=o.pageInformation.adPageInfo)||void 0===d||d.recordLockupFromDataFailed(e,"0",o.parsedCardCount),Io(o),$h(e,p,w,null,null,!1,!1),null
switch(null===(h=A.searchAdOpportunity)||void 0===h||h.setTemplateType(rG),Qt(e)){case Jx:const i=new Y0(A,A.icon)
p.media=new J0(i),p.media.impressionMetrics=A.impressionMetrics
break
case oq:p.media=function(e,t,n,o,i,s,a){return e.media=function(e,t,n,r,o){var i,s
const a=t.screenshots[0],c=Ht(a)
null===(i=r.adPageInfo)||void 0===i||i.setTemplateType(e,c),null===(s=t.searchAdOpportunity)||void 0===s||s.setTemplateType(c)
const l=tf(e,o,{useCase:y6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:R$})
let u=l.backgroundColor,d=l.textColor
const f={type:xV,red:1,green:1,blue:1}
Ie(f,u)?(u=d,d=void 0):Ie(f,d)&&(d=void 0)
const h=new K0(t,[a],n,d,u,8)
return new Z0(h)}(t,n,t.bag.todayAdMediumLockupScreenshotAnimationEnabled,a.pageInformation,o),r(n=Ps(t,o,i,s))?null:(n.searchAdOpportunity=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity,n.searchAd=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAd,e.media.mediumAdLockupWithScreenshotsBackground.lockup=n,e.media.impressionMetrics=n.impressionMetrics,e.media)}(p,e,A,t,n,o,w)
break
default:return null}Io(o)
const T=jt(t)
return p.clickAction=Fd(e,t,v,m,void 0,T),function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=qf(e,t)?xB:IM,a=Yt(0,o.pageInformation),c=j(t,CM),l=H(t,wq)?ZV:aW,u=new HY(i,t.id,c,s,Wb,l,a)
n.clickAction=zt(0,n.clickAction,u)}(e,t,p,w),$h(e,p,w,null,null,!1,!1),p})}(e,t.adData,n,t)
return(0,Hv.isSome)(c)?c:null}function Bs(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderBadge)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,R_)),(0,Hv.isSome)(r))return r
switch(t.data.type){case Xq:r=j(t.data,R_)
break
case Dj:r=j(t.data,[hV,iU])}return r}function Us(e,t,n=!1){const r=On(0,t.data)
if((t.isFirstItemInModule||r.suppressHeaderName)&&!n)return null
let o
const i=N(t.data)
if(W(i)&&(o=j(i,E_)),(0,Hv.isSome)(o))return o
switch(t.data.type){case Xq:o=j(t.data,E_)
break
case Dj:o=j(t.data,[hV,fW])}return o}function Gs(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderTagline)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,D_)),(0,Hv.isSome)(r))return r
switch(t.data.type){case Xq:r=j(t.data,D_)
break
case Dj:r=j(t.data,[hV,Rj])}return r}function js(e,t,n){var r
const o=On(0,t.data),i=pe(e,t.data,Dx),s=null!==(r=o.headerArtworkBehavior)&&void 0!==r?r:Sm.NoArtwork
switch(n){case Im.Eyebrow:return s===Sm.CategoryArtworkWithBadge?Hs(e,i):null
case Im.Title:switch(s){case Sm.CategoryArtworkWithTitle:return Hs(e,i)
case Sm.ContentArtworkWithTitle:return tf(e,i,{useCase:y6.LockupIconSmall})
default:return null}default:return null}}function Vs(e,t,n){const r=pe(e,t.data,Dx),o=j(t.data,[aj,"headerArtworkBehavior"])
switch(n){case Im.Eyebrow:return o===Sm.CategoryArtworkWithBadge&&(0,Hv.isSome)(Hs(e,r))?sm.Category:null
case Im.Title:switch(o){case Sm.CategoryArtworkWithTitle:return(0,Hv.isSome)(Hs(e,r))?sm.Category:null
case Sm.ContentArtworkWithTitle:return(0,Hv.isSome)(Hs(e,r))?sm.Icon:null
default:return null}default:return null}}function Hs(e,t){const n=Sn(e,t,!1,!1,!1)
return(0,Hv.isNothing)(n)?null:Zd(e,n,{useCase:y6.CategoryIcon,allowingTransparency:!0,cropCode:"sr"})}function qs(e,t){const n=B(t.data,SC,null),r=null==n?void 0:n[kV]
if((0,Hv.isNothing)(r))return null
let o=null
if(r===Cm.LinearGradient){const e=g(n).stops.map(e=>ye(e.color)),t={type:"gradient",colors:e,start:am.Top,end:am.Bottom},r=be(e[0]),i={type:xV,red:60/255,green:60/255,blue:67/255,alpha:.6},s={type:xV,red:235/255,green:235/255,blue:245/255,alpha:.6}
o={shelfBackground:t,eyebrowColor:r?s:i,titleColor:Se(r?uq:qO),subtitleColor:r?s:i}}else o=null
return o}function Ws(e){var t,n
return(0,Hv.isNothing)(e)?{}:null!==(n=yh(null!==(t=p(e.moduleMetadata,zR))&&void 0!==t?t:{},e.moduleMetadata.onDevicePersonalizationProcessingType,null))&&void 0!==n?n:{}}function zs(e,t){let n
if((0,Hv.isSome)(t))n=t
else{const t=Ch(e),o=(r=e).locationStack.length<2?null:r.locationStack[1].position
n=(0,Hv.isSome)(t)&&(0,Hv.isSome)(o)&&(t.locationType===Bj||t.name===tF)?o:Ih(e)}var r
return n}function Ys(e,t,n,r=null,o=null){var i
const s=f(n,XJ)
if((0,Hv.isNothing)(s))return null
const a=JSON.parse(s),c=Q0.placementTypeFromPlacementId(e,f(a,SG)),l=new Q0(e,c,Q0.createInitialPageSlotInfos(e,c,r,o,void 0),null!==(i=f(a,PG))&&void 0!==i?i:void 0,void 0,void 0,r)
return l.applyClickFieldsFromPageRequest(null!=t?t:void 0,a),l}function Js(e,t,n,i){return qv.context("clickOptionsForLockup",()=>{var s,a,c
const l=t.id.slice()
let u=t.id
void 0!==n.anonymizationOptions&&n.anonymizationOptions.anonymizationString.length>0&&(u=n.anonymizationOptions.anonymizationString)
const d={...n,...i,id:u,contextualAdamId:l,softwareType:uh(e,t)}
if(o(d.targetType)&&(d.targetType=tW),r(d.kind)&&(d.kind=dh(e,t)),V(t,wq)&&(d.offerType=ZV),n.isAdvert||n.isAdEligible){const t=null!==(s=d.adsMetricsData)&&void 0!==s?s:{},r=null===(c=null===(a=n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,o=Q0.containerIdFromType(e,r)
if(r===lq&&(0,Wv.isSome)(o)){const e=zs(n.locationTracker,n.adSlotOverride)
t[oF]=`${o}_${e}`}d.adsMetricsData=t}return d})}function Ks(e,t,n,r,o,a,c,l,u,d){var f,h,p,w,g,v,m,y,A,T,b,S
const P={}
if(o){const e=o
c&&(null!==(p=null===(h=null===(f=e.adPageInfo)||void 0===f?void 0:f.adAdamId)||void 0===h?void 0:h.length)&&void 0!==p?p:0)>0&&(0,Wv.isSome)(e.adPageInfo)&&e.adPageInfo.adAdamId===t.adamId&&Object.assign(P,e.adPageInfo.clickFields),s(e.searchTermContext)&&(P[ZH]=e.searchTermContext.term)}(0,Wv.isSome)(l)&&Object.assign(P,l),P[zG]={buyParams:t.purchaseConfiguration.buyParams},void 0!==a&&(P[nU]=a),P[QJ]=t.adamId,t.actionMetrics.custom[QJ]=t.adamId,r&&(P[iF]=ZV,i(t.expectedReleaseDate)&&(P[LR]=Ee(t.expectedReleaseDate))),(null===(g=null===(w=null==d?void 0:d.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementType)===lq&&(0,Wv.isSome)(null===(v=null==d?void 0:d.adsMetricsData)||void 0===v?void 0:v.iAdSlotId)&&(P[oF]=null===(m=null==d?void 0:d.adsMetricsData)||void 0===m?void 0:m.iAdSlotId),(0,Wv.isSome)(null===(y=null==d?void 0:d.adsMetricsData)||void 0===y?void 0:y.iAdDuplicateLayoutType)&&(P[QM]=null===(A=null==d?void 0:d.adsMetricsData)||void 0===A?void 0:A.iAdDuplicateLayoutType)
const I=_t(e,n,hW,P,void 0,u)
P[QJ]=t.adamId,t.actionMetrics.custom[QJ]=t.adamId,I.includingFields.push("appState"),t.purchaseConfiguration.isArcadeApp&&I.includingFields.push(_S)
const C=null!==(S=null===(b=null===(T=null==o?void 0:o.adPageInfo)||void 0===T?void 0:T.shouldIncludeAdRotationFields)||void 0===b?void 0:b.call(T,e))&&void 0!==S&&S
c&&C&&I.includingFields.push(FN),c&&e.client.isPad&&I.includingFields.push($M),t.actionMetrics.addMetricsData(I)}function Zs(e,t,n){var r
Qs(e,t,{...n,actionType:MR,subscriptionSKU:null!==(r=e.bag.arcadeProductId)&&void 0!==r?r:void 0,actionContext:vq,targetType:hW})}function Qs(e,t,n,r=!1,o){var s,a,c,l,u,d,f,h,p,w,g,v,m,y,A
let b=n.actionType
b||(b=pW)
const S={actionType:b}
let P
P=T(A=t)&&A[gW]===Ly?t.actions:[t],P.forEach(e=>{if(ht(e)){const t=e
S[MN]=t.pageUrl}else if(wt(e)){const t=e
S[MN]=t.url}}),n.actionDetails&&(S[zG]=n.actionDetails),n.actionContext&&(S[LS]=n.actionContext),i(n.offerType)&&(S[iF]=n.offerType),i(n.offerReleaseDate)&&(S[LR]=Ee(n.offerReleaseDate))
const I=null!==(c=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:null==t?void 0:t.title)&&void 0!==c?c:""
let C
S[nU]=Ah(e,n,I),n.pageInformation&&n.pageInformation.searchTermContext&&(S[ZH]=n.pageInformation.searchTermContext.term),i(n.softwareType)&&(S[BN]=n.softwareType),(n.isAdvert||n.isAdEligible)&&r&&(null===(l=n.pageInformation)||void 0===l?void 0:l.adPageInfo)&&(Object.assign(S,n.pageInformation.adPageInfo.clickFields),e.client.isPad&&(C=[$M])),n.mercuryMetricsData&&Object.assign(S,n.mercuryMetricsData),(0,Wv.isSome)(n.subjectIds)&&(S.subjectIds=n.subjectIds),(null===(d=null===(u=null==n?void 0:n.pageInformation)||void 0===u?void 0:u.adPageInfo)||void 0===d?void 0:d.placementType)===lq&&(0,Wv.isSome)(null===(f=n.adsMetricsData)||void 0===f?void 0:f.iAdSlotId)&&(S[oF]=null===(h=n.adsMetricsData)||void 0===h?void 0:h.iAdSlotId),(0,Wv.isSome)(null===(p=n.adsMetricsData)||void 0===p?void 0:p.iAdDuplicateLayoutType)&&(S[QM]=null===(w=n.adsMetricsData)||void 0===w?void 0:w.iAdDuplicateLayoutType)
const k=_t(e,n.id,null!=o?o:ch(0,n),S,C)
n.actionContext===vq&&(n.actionType===w$||n.actionType===MR)&&(k.includingFields.push(_S),k.fields[QJ]=n.contextualAdamId,(0,Wv.isSome)(t.adamId)&&(t.actionMetrics.custom[QJ]=t.adamId))
const O=null!==(y=null===(m=null===(v=null===(g=n.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===v?void 0:v.shouldIncludeAdRotationFields)||void 0===m?void 0:m.call(v,e))&&void 0!==y&&y
n.isAdvert&&O&&k.includingFields.push(FN),t.actionMetrics.addMetricsData(k)}function Xs(e,t,n,r){const o={}
i(n)&&(o[MN]=n),r.targetType||(r.targetType=hW),o[nU]=Th(0,r,t.title),o[$G]=pW,o[v$]="button_See All"
const s=_t(e,xR,hW,o)
t.actionMetrics.addMetricsData(s)}function ea(e,t,n){const r={}
r[$G]="filter"
const o=_t(e,`filter_${n}`,hW,r)
o.includingFields.push(MS),t.actionMetrics.addMetricsData(o)}function ta(e,t,n,r,o){var i,a,c,l
const u=function(e){switch(e){case GB:return GB
case MB:return MB
case FR:return"recentQuery"
case J$:return Q$
case NR:return"searchInsteadFor"
case BR:return FS
case UR:return UR
default:return jM}}(t.origin);(0,Wv.isNothing)(o)&&(o=new nK({page:$V,pageType:$V,pageId:$V,pageDetails:xS}))
const d={pageInformation:o,locationTracker:r,targetType:n},f={...Nt(o),actionType:u,actionUrl:fh(t.url),location:Th(0,d,t.term),searchTerm:t.term},h={targetId:t.term},p={};(null===(i=t.prefixTerm)||void 0===i?void 0:i.length)&&(p[sF]=t.prefixTerm),(null===(a=t.entity)||void 0===a?void 0:a.length)&&(p[XM]=t.entity),s(p)&&(h[zG]=p),(null===(c=t.originatingTerm)||void 0===c?void 0:c.length)&&(f[$R]=t.originatingTerm,h[$R]=t.originatingTerm)
const w=_t(e,t.term,n,f,[$S])
t.actionMetrics.addMetricsData(w)
const g=Lt(e,t.term,n,u,null!==(l=t.url)&&void 0!==l?l:null,h,[$S])
t.actionMetrics.addMetricsData(g)}function na(e,t){return i(t)?j(t,"customUrl"):null}function ra(e,t,n,r,o,i,a){if(!s(o)&&e.client.deviceType!==lW)return t
let c
{const e=new JJ(n,Jq)
c=new KJ(r,o,e)}const l=S(a)
if(l.actionType=qV,l.actionDetails={actionUrl:o},Qs(e,c,l,!0,hW),gt(t))return t.openAction=c,t.includeBetaApps=i,t
{const e=new VY(n,t)
return e.openAction=c,e.includeBetaApps=i,e}}function oa(e,t,n,o,a,c,l,u,d,f){return qv.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const h=ia(e,t)
if(!s(h))return null
const p=[]
let w=null,g=null
const v=H(h,wq)
if(n){const t=qf(e,h),n=gd(0,h.type,t),s=function(e,t,n,o,i,s,a){return r(t)||t.type!==dW?null:vr(e,wr(e,t),t,n,!1,vh(e,t,tf(e,t,null,s),s),a,rV)}(e,h,v,0,0,o,l)
g=xr(e,s,n,h,v,0,null,null,null,null,rV)
const a=function(e,t,n,o,i,s,a,c){if(r(n))return null
let l=br(e,n,t,o,s,rV,i)
return(null==c?void 0:c.length)>0&&(l=ra(e,l,n.adamId,null,c,!1,s)),l}(e,h,s,v,o,l,0,u)
i(a)&&i(g)&&(w=p.length,a.artwork=Ot(e,"systemimage://arrow.down.circle"),p.push(a))}const m=function(e,t,n){const r=Vo(e,t,n.pageInformation,n.locationTracker)
return i(r)?(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SHARE"),r.artwork=Ot(e,gO),r):r}(e,h,c)
i(m)&&p.push(m)
const y=la(e,h)
if(!v&&!y){if(i(a)&&ht(a)&&(vt(a.pageData)||mt(a.pageData))){const t=function(e,t,n){const r=function(e,t,n){return qv.context("seeRatingsAndReviewsActionFromData",()=>{const t=S(n)
if(vt(n.pageData)||mt(n.pageData)){let r
r=new cJ(EH)
const o=Xu(e)?r:new lJ(new uJ(vW,Fq)),i=S(n.pageData)
i.fullProductFetchedAction=o,t.pageData=i}return t})}(e,t.id,n)
return i(r)&&(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),r.artwork=Ot(e,"systemimage://star"),r.animationBehavior=rH),r}(e,h,a)
i(t)&&p.push(t)}if(!xe(e,t,QG)){const t=function(e,t,n,r){const o=Ia(e,t,n,r)
return i(o)&&(o.title=e.loc.string("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),o.artwork=Ot(e,UT)),o}(e,h,d,f)
i(t)&&p.push(t)}}return new jJ(p,g,w)})}function ia(e,t){return qv.context(`productDataFromData: ${t.type}`,()=>{switch(t.type){case dW:case Zq:return t
case Xq:{const n=we(t,OH)
if(s(n)&&1===n.length){const t=n[0]
return ia(e,t)}break}case A$:{const n=we(t,uW)
if(s(n)&&1===n.length){const t=n[0]
return ia(e,t)}break}default:return null}return null})}function sa(e,t,n,r){const o=e.bag.voteUrl,i=f(t,"id",FH),s=new az(o).param(GT,i),a=new qJ(s.build()),c=new LY(dB)
return r?(a.title=e.loc.string("ACTION_REVIEW_HELPFUL"),c.title=e.loc.string("TOAST_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,jT),c.artwork=Ot(e,jT)):(a.title=e.loc.string("ACTION_REVIEW_NOT_HELPFUL"),c.title=e.loc.string("TOAST_NOT_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_NOT_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,VT),c.artwork=Ot(e,VT)),a.method=hG,a.isStoreRequest=!0,a.disableCache=!0,a.headers={"Content-Type":YJ.contentType},a.body=(new YJ).param("vote",r?"1":"0").param(HT,n).build(),a.successAction=c,a}function aa(e,t,n){return qv.context("reportConcernActionFromApiRow",()=>{const r=f(t,"id",FH),i=e.bag.reportConcernUrl,s=new qY(i)
s.method=hG,s.isStoreRequest=!0,s.disableCache=!0,s.needsAuthentication=!0,s.headers={"Content-Type":YJ.contentType},s.body=(new YJ).param(GT,r).param(HT,n).build()
const a=new zY("selectedReason",qT,IE),c=new zY("explanation",qT,QV)
s.parameters=[a,c]
{const t=new LY(dB)
t.title=e.loc.string(NT),t.message=e.loc.string(BT),t.artwork=Ot(e,tM),s.successAction=t}const l=new LY(Lq)
l.title=e.loc.string(bE),l.message=e.loc.string(SE),l.isCancelable=!0,s.failureAction=l
let u=e.bag.reportConcernReasons
o(u)&&(u=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}])
const d=u.map(e=>new VJ(f(e,"reasonId"),f(e,fW),f(e,"upperCaseName"))),h=new WJ(d)
return h.title=e.loc.string(FT),h.explanation=e.bag.reportConcernExplanation,o(h.explanation)&&(h.explanation="Tell us a little more (Optional)"),h.artwork=Ot(e,tM),h.sendAction=s,h})}function ca(e,t,n){return`${OW}:/${xW.reviews}/${xW.shelf}/${t}/${n}`}function la(e,t){return!(!i(t)||ua(e,t)||!H(t,eG)&&!H(t,"reviewsRestricted"))}function ua(e,t){return!(o(t)||!e.bag.enableSystemAppReviews)&&st(e).isSystemAppFromData(t)}function da(e){return e.featureFlags.isEnabled(FJ)&&(0,Hv.isSome)(e.bag.saveUserReviewURL)}function fa(e,t){const n=az.from(e),r=f(n.query,LP)
return t&&(null==r?void 0:r.length)>0&&(n.query[LP]=n1[r]||r),n}function ha(e,t,n,r=!1,o,a,c){return qv.context("createProductReviewsList",()=>{const l=[]
if(s(a)){if((0,Hv.isSome)(c)){const t={id:`${c.getSequenceId()}`,kind:null,softwareType:null,targetType:Qj,title:e.loc.string(wF),pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,idType:Aq}
bh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:Qj,id:`${c.getSequenceId()}`,idType:Aq},e.loc.string(wF)),Mh(e,a,t),Ph(c.locationTracker),Oh(c.locationTracker)}l.push(a)}if(s(o),i(n)&&n.length>0){const o=!1,i=!o,s=o?n.slice(0,1):n,a=!1,u=pa(e,e.client.guid,t,s,r&&i,a&&i,i,c);(0,Hv.isSome)(c)&&bh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:wD,id:`${c.getSequenceId()}`,idType:Aq},null),u.forEach((t,n)=>{const r=new YY
if(r.sourceType=DP,r.review=t,l.push(r),(0,Hv.isSome)(c)){const t={id:r.id,idType:Sq,kind:null,softwareType:null,title:null,pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:"helpfulReview"}
Mh(e,r,t),Oh(c.locationTracker)}}),(0,Hv.isSome)(c)&&(Ph(c.locationTracker),Oh(c.locationTracker))}return l})}function pa(e,t,n,r,i=!1,s=!1,a=!0,c){return qv.context("createReviewItems",()=>{const l=function(t,n){return n?1e3*((new Date).getTime()-t.getTime())<3600?e.loc.string("TimeAgo.Edited.JustNow"):e.loc.string("TimeAgo.Edited.Time").replace("{time}",e.loc.timeAgoWithContext(t,"standalone")):e.loc.timeAgoWithContext(t,"standalone")}
return r.map(r=>{var u
const d=new JY
d.id=f(r,"id",FH),d.title=j(r,Nq)
const h=j(r,nR)
h&&(d.date=new Date(h),d.dateText=l(d.date,H(r,"isEdited"))),d.contents=j(r,"review"),d.rating=q(r,wj),d.reviewerName=j(r,"userName"),d.dateAuthorText=e.loc.string("ProductPage.Section.Reviews.DateAuthor").replace("{date}",d.dateText).replace("{author}",d.reviewerName)
let p=null
const w=j(r,"developerResponse.id")
if((null==w?void 0:w.length)>0){const e=new KY
e.id=w,e.contents=j(r,"developerResponse.body")
const t=j(r,"developerResponse.modified")
t&&(e.date=new Date(t),e.dateText=l(e.date,!1)),d.response=e,p=d.response.contents}if(a&&(f(n,FV),d.flowPreviewActionsConfiguration=function(e,t,n,r,i){var s
if(o(t)||e.client.deviceType!==nW&&e.client.deviceType!==Kq&&e.client.deviceType!==lW)return null
const a=[sa(e,t,n,!0),sa(e,t,n,!1)]
return(null===(s=e.bag.reportConcernUrl)||void 0===s?void 0:s.length)>0&&a.push(aa(e,t,n)),(null==i?void 0:i.length)>0&&a.push(function(e,t){const n=new zJ(t)
return n.title=e.loc.string("ACTION_REVIEW_COPY"),n.artwork=Ot(e,"systemimage://doc.on.doc"),n}(e,i)),new jJ(a)}(e,r,t,0,p)),s){const n=[sa(e,r,t,!0),sa(e,r,t,!1)];(null===(u=e.bag.reportConcernUrl)||void 0===u?void 0:u.length)>0&&n.push(aa(e,r,t)),d.voteActions=n}return i&&(d.moreAction=function(e,t,n,r,o){return r?qv.context("singleReviewActionFromReviewData",()=>{const t=Ca(e,0,n,[r],null,null,null,o),i=new wJ
i.adamId=f(n,FV),i.targetReviewId=f(r,"id",FH),i.shelves=[t]
const s=new EY(Fq)
return s.pageData=i,s.title=Ma(e),s}):null}(e,0,n,r,c)),d})})}function wa(e,t,n,r){return r?qv.context("ratingsFromApiResponses",()=>{const t=new ZY
t.productId=f(r,FV,FH),t.ratingAverage=h(r,"ratingAverage"),t.totalNumberOfRatings=h(r,$P),t.totalNumberOfReviews=h(r,"totalNumberOfReviews"),t.context=n
const o=l(r,"ratingCountList").slice().reverse(),i=o.reduce((e,t)=>e+t,0)
if(t.ratingCounts=i>0?o.map(e=>e/i*t.totalNumberOfRatings):o,!(t.ratingAverage>0&&t.ratingCounts)){const n=u(r,gD)
t.status=n?e.loc.string("RATINGS_STATUS_DEVELOPER_RESET"):e.loc.string("RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return t}):null}function ga(e,t,n){if(!va(e))return null
const r=fe(t,rE)
if((0,Hv.isNothing)(r))return null
const i=r.data
if(o(i))return null
const s=i[0],a=f(s,"id",FH),c=ma(e,s,!0),u=ma(e,s,!1),d=e.loc.string("ProductPage.ReviewSummary.Subtitle"),h=e.bag.reviewSummaryReportConcernData
if((0,Hv.isNothing)(u)||(0,Hv.isNothing)(c))return null
const p=j(t,fW),w=Qe(e,s,QV),g=Ot(e,"systemimage://text.line.2.summary"),m=new QY(c,u,d,g,eW,hx,function(e,t,n,r,o,i,s){const a=[],c=function(e,t,n,r){return qv.context("reviewSummaryReportConcernActionFromApiRow",()=>{if(!v(t,xT))return null
const r=function(e,t){const n=new dY(e)
n.includeAppBinaryTraitsAttribute=!1,n.resourceType=$T
const r=ve(e,n),o=new qY(r.toString())
o.method=hG,o.disableCache=!0,o.needsMediaToken=!0,o.headers={"Content-Type":nM},o.bodyDictionary={report:{contentId:t,contentKind:"review-summaries",concerns:null}}
const i=new LY(dB)
i.title=e.loc.string(NT),i.message=e.loc.string(BT),i.artwork=Ot(e,tM),o.successAction=i
const s=new LY(Lq)
return s.title=e.loc.string(bE),s.message=e.loc.string(SE),s.isCancelable=!0,o.failureAction=s,o}(e,n),o=l(t,$T).map(t=>{let n,r
const o=f(t,DH)
switch(o){case"OFFENSIVE":case"OFFENSIVE_OR_HARMFUL":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.UppercaseName")
break
case"MISREPRESENTING_THE_APP":case"MISREPRESENT":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.UppercaseName")
break
case"SOMETHING_ELSE":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.UppercaseName")}return new VJ(o,n,r)})
if(0===o.length)return null
const i=e.loc.string(FT),s=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Explanation"),a=new HJ(o,i,s,r)
return a.artwork=Ot(e,tM),a})}(e,t,o);(0,Hv.isSome)(c)&&a.push(c)
const u=Ea(e);(0,Hv.isSome)(u)&&a.push(u)
const d=function(e,t,n,r,o){if(![GG,nG].includes(e.client.buildType))return null
const i=new GY(`tap-to-radar://new/problem?componentid=999915&title=Review Summary Feedback: ${n}&description=App ID: ${t}\nApp name: ${n}\nReview summary ID: ${r}\nReview summary: ${o}\n\nFeedback: `,!0)
return i.title=e.loc.string("Action.ProvideFeedback"),i.artwork=Ot(e,"systemimage://ant.circle"),i}(e,n,r,o,i)
return(0,Hv.isSome)(d)&&a.push(d),new jJ(a)}(e,h,t.id,p,a,w,e.client.guid)),y={id:`${n.getSequenceId()}`,kind:null,softwareType:null,targetType:Qj,title:e.loc.string(wF),pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,idType:Aq}
return bh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:Qj,id:`${n.getSequenceId()}`,idType:Aq},m.title),Mh(e,m,y),Ph(n.locationTracker),Oh(n.locationTracker),m}function va(e){return e.bag.enableReviewSummarization}function ma(e,t,n){const r=Qe(e,t,QV)
if((0,Hv.isNothing)(r))return null
const o=`^[${e.loc.string(wF)}](jetFont: 'reviewSummaryTitle')`,i=`^[${r}](jetFont: 'reviewSummaryText')`
return n?e.loc.string("ProductPage.ReviewSummary.Body").replace("{styledTitle}",o).replace("{reviewSummary}",i):i}function ya(e){if(!e)return null
const t=new XY
return ba(e,t),t}function Aa(e){if(!e)return null
const t=new eJ
return ba(e,t),t}function Ta(e){if(!e)return null
const t=new tJ
return ba(e,t),t}function ba(e,t){t.ratingAverage=e.ratingAverage,t.ratingCounts=e.ratingCounts,t.totalNumberOfRatings=e.totalNumberOfRatings,t.totalNumberOfReviews=e.totalNumberOfReviews,t.status=e.status,t.reviews=e.reviews,t.actions=e.actions,t.nextPage=e.nextPage}function Sa(e,t,n,r=null,o=null){const i=new nJ
switch(e.client.deviceType){case"tv":i.title=e.loc.string("TV_SELECT_TO_RATE")
break
case lW:i.title=e.loc.string("CLICK_TO_RATE")
break
default:i.title=e.loc.string("TAP_TO_RATE")}return i.rating=o,i.rateAction=function(e,t,n,r=null){const o=new LY(dB)
o.title=e.loc.string("TOAST_TAP_TO_RATE_TITLE"),o.message=e.loc.string("TOAST_TAP_TO_RATE_DESCRIPTION"),o.artwork=Ot(e,"resource://ToastStar.png",95,90)
const i=new WY(function(e,t,n){return fa(da(e)?e.bag.saveUserReviewURL:e.bag.userRateURL,n).param("id",t).build()}(e,t,n))
i.useModernRatingsAPI=da(e),i.adamId=t,i.method=hG,da(e)&&(i.headers={"Content-Type":nM}),i.isStoreRequest=!0,i.disableCache=!0,i.successAction=o
const s=new zY(wj,MP,IE),a=new zY(da(e)?PE:"versionToReview",MP,IE)
return i.parameters=[s,a],i}(e,t,n,r),i}function Pa(e,t,n,r,o=!1,i,s){return qv.context("createWriteReviewAction",()=>{const a=o?e.loc.string("EDIT_REVIEW"):e.loc.string("WRITE_A_REVIEW"),c=function(e,t,n){return fa(e.bag.writeReviewURL,n).param("id",t).build()}(e,t,n)
let l,u
if((0,Hv.isSome)(r)){const t=kt(e,!0,!1,y6.LockupIconSmall),n=r.template.replace("{c}",`${r.crop}-${t.quality}`).replace("{f}",t.format)
l=new pz(n,r.width,r.height,r.variants),l.backgroundColor=r.backgroundColor,l.textColor=r.textColor,l.checksum=r.checksum,l.style=r.style,l.crop=r.crop,l.contentMode=r.contentMode,l.imageScale=r.imageScale}switch(e.client.deviceType){case lW:{const e=new rJ(t,c)
e.title=a,e.appIcon=l,e.itemDescription=i,e.appName=s,u=e
break}default:{const n=new rJ(t,c)
n.title=a,n.appName=s,n.itemDescription=i,n.appIcon=l,n.artwork=Ot(e,UT),u=n
break}}return u})}function Ia(e,t,n,r,o){return qv.context("writeReviewActionFromData",()=>{const s=t.id
if((null==s?void 0:s.length)>0){const a=t.type===Zq,c=q(t,wj),l=i(c)&&c>0
return Pa(e,s,a,o,l,n,r)}return null})}function Ca(e,t,n,r,o=!1,i=!1,s=!0,a){return qv.context("reviewsShelfForReviewsData",()=>{{const t=new dJ(zx)
return null==a||a.addImpressionsToShelf(e,t,vD),t.items=ha(e,n,r,o,null,null,a),t}})}function ka(e,t,n,o){return qv.context("personalizedReviewsContainerShelf",()=>{const s=yt(e,o),a=q(s,wj)
return function(e,t,n,o,s,a,c,l,d,h,p=!1,w=!0,g=null,v=!1){return qv.context("reviewsContainerShelfForReviewsData",()=>{const w=function(e,t,n,o,s,a,c,l,d,h=null,p=!1){return qv.context("reviewsContainerForReviewsData",()=>{const w=new fJ,g=f(n,FV),v=u(n,"isBundle")
w.adamId=g,w.ratings=wa(e,0,kL,n)
{const t=ga(e,s,d)
i(t)&&(w.reviewSummary=t)}if(p||(w.tapToRate=Sa(e,g,v,a,h)),i(o)&&o.length>0){const r=!1,i=!r,s=r?o.slice(0,1):o
w.reviews=pa(e,t,n,s,i,!1,i,d)}if(r(w.reviews)||0===w.reviews.length){const t=w.ratings.ratingAverage>0&&w.ratings.ratingCounts,r=u(n,gD)
t||r||(w.ratings.status=e.loc.string(mD))}if(r(l)||(w.editorsChoice=l),!p){const t=i(h)&&h>0
w.writeReviewAction=Pa(e,g,v,c,t,Td(e,s),a)}const m=f(n,yD)
if(m){const t=new GY(m,!1)
t.title=e.loc.string(FP),w.supportAction=t}let y=!1
for(const t of o)if(ua(e,t)){y=!0
break}return w.alwaysAllowReviews=y,w})}(e,t,n,o,a,s,c,l,d,g,v),m=new dJ(_P)
return m.title=Ma(e),m.items=[w],null==d||d.addImpressionsToShelf(e,m,vD),p&&i(w.reviews)&&w.reviews.length>0&&(m.seeAllAction=La(e,0,n,o,h,s,c,!1,!1)),m})}(e,t,n.ratingsData,n.reviewItems,n.appName,s,n.appIcon,n.editorsChoice,n.shelfMetrics,n.nextPageHref,n.includeSeeAllAction,!1,a)})}function Oa(e,t,n,r,o,i=null){const a=function(e,t,n,r=null){let o=`${OW}:/${xW.reviews}/${t}/${n}`
return s(r)&&(o=`${o}/?${zW.token}=${encodeURIComponent(JSON.stringify(r))}`),o}(0,t,n,i)
return new hJ(n,r,o,a)}function Ea(e){const t=e.bag.reviewSummarizationLearnMoreEditorialItemId
if(o(t))return null
const n=e.loc.string(wN),r=new EY(Tq)
return r.title=n,r.pageUrl=`https://apps.apple.com/story/id${t}`,r.artwork=Ot(e,_O),r}function Ra(e,t,n,o,i,s=null,a=null,c,l=null,u,d,h=!1,p=!1,w=r1,g=null){const v=new wJ
return v.shelves=[],qv.context("reviewsPageForReviewsData",()=>{const t=r(a)?f(n,FV):a
i&&r(n)
const c=Da(e,0,t,n,o,s,h,p,w,g,d)
return c.reviewsShelf.presentationHints={...c.reviewsShelf.presentationHints,isSortable:i&&c.reviewsShelf.presentationHints.isSortable},v.adamId=t,v.shelves.push(c.reviewsShelf),v.nextPage=c.paginationToken,v.initialSortOptionIdentifier=c.initialSortId,v.sortActionSheetTitle=c.sortActionSheetTitle,v.sortOptions=c.sorts,v.alwaysAllowReviews=ua(e,u),v})}function Da(e,t,n,r,i,a=null,c=!1,l=!1,u=r1,d=null,f){const h=(null==a?void 0:a.length)>0&&s(i)&&i.length%2>0,p=h?i.slice(0,i.length-1):i,w=h?i.slice(i.length-1):[],g=Ca(e,0,r,p,c,l,!0,f)
var v
g.id=o(v=u)?o1:`${o1}.${v}`
const m={reviewsShelf:g}
return g.presentationHints={isSortable:i.length>0||(null==a?void 0:a.length)>0,isSeeAllContext:!0},m.initialSortId=u,m.sortActionSheetTitle=e.loc.string("REVIEWS_SORT_BY"),m.sorts=[Oa(0,n,pD,e.loc.string(NP),e.loc.string(NP),d),Oa(0,n,"favorable",e.loc.string(BP),e.loc.string(BP),d),Oa(0,n,"critical",e.loc.string(UP),e.loc.string(UP),d),Oa(0,n,GP,e.loc.string(jP),e.loc.string(jP),d)],(null==a?void 0:a.length)>0&&(m.paginationToken=function(e,t,n,r,o){return{url:ca(0,t,r),remainingContent:o,nextHref:n,profile:tW,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(0,n,a,u,w)),m}function _a(e,t,n,r,o,i,a,c,l){return qv.context("reviewsPageForReviewsMediaContainer",()=>{let t
return t=s(o.data)?r.concat(o.data):r,Ra(e,0,null,t,i,o.next,n,0,null,null,l,!1,!1,a,c)})}function La(e,t,n,r,o=null,i=null,s=null,a,c,l,u){return n?qv.context(VP,()=>{const t=Ra(e,0,n,r,!0,o,null,0,s,l,u,a,c)
t.title=null
const i=new EY(Fq)
return i.pageData=t,i.title=e.loc.string(cH),i}):null}function Ma(e){switch(e.client.deviceType){case"tv":return e.loc.string("TV_PRODUCT_SECTION_RATINGS")
case cW:return null
default:return e.loc.string("PRODUCT_SECTION_REVIEWS")}}function xa(e,t){return t.map(t=>t.createProductPageSection(e))}function $a(e,t,n,r,o,i,s){const a=function(e,t,n){switch(t){case qG:return n?Fv:$v
case mx:return Uv
case dV:return n?Lv:oy
case jV:return n?xv:Mv
case yx:return n?Bv:Nv
case LV:return n?jv:Gv
default:return oy}}(0,n,r)
let c=[]
c=t?o&&a.purchasedOrderingCompact?a.purchasedOrderingCompact.slice():a.purchasedOrdering.slice():i&&a.downloadingOrdering?o&&a.downloadingOrderingCompact?a.downloadingOrderingCompact.slice():a.downloadingOrdering.slice():o&&a.notPurchasedOrderingCompact?a.notPurchasedOrderingCompact.slice():a.notPurchasedOrdering.slice()
const l=t?a.purchasedSpotlightIndex:a.notPurchasedSpotlightIndex
if(s&&s.spotlightSection){const e=function(e,t){for(let n=0;n<t.length;n++){const r=t[n]
if(e.sectionType===r.sectionType&&e.shelfId===r.shelfId&&JSON.stringify(e.shelfBasedMappedIds)===JSON.stringify(r.shelfBasedMappedIds))return n}return-1}(s.spotlightSection,c);-1!==e&&(c.splice(e,1),c.splice(l,0,s.spotlightSection))}return c}function Fa(e){return new s1(vW,e?$j:xj)}function Na(e){var t
return(0,Hv.isSome)(e)&&(null===(t=e.id)||void 0===t?void 0:t.indexOf(w2))>-1}function Ba(e,t,n){if(!e.featureFlags.isEnabled(MJ))return null
const r=new p2(t)
jn(e,r,Gn(e,"ProductMediaGallery",n,""))
const o=new EY("productMediaGallery")
return o.pageData=r,o}function Ua(e,t){var n
return r(t)?1:i(null===(n=t.video)||void 0===n?void 0:n.preview)&&t.video.preview.height>0?t.video.preview.width/t.video.preview.height:i(t.screenshot)&&t.screenshot.height>0?t.screenshot.width/t.screenshot.height:1}function Ga(e,t,n,r){return qv.context("createProductPageFromShelfBasedProductPage",()=>{var o,a,c,l
const u=new oJ
return u.adamId=t.lockup.adamId,u.bundleId=t.lockup.bundleId,u.icon=t.lockup.icon,u.isEditorsChoice=t.lockup.isEditorsChoice,u.ordinal=t.lockup.ordinal,u.title=t.lockup.title,u.subtitle=t.lockup.subtitle,u.developerTagline=t.lockup.developerTagline,u.editorialTagline=t.lockup.editorialTagline,u.editorialDescription=t.lockup.editorialDescription,u.shortEditorialDescription=t.lockup.shortEditorialDescription,u.rating=t.lockup.rating,u.ratingCount=t.lockup.ratingCount,u.ageRating=t.lockup.ageRating,u.buttonAction=t.lockup.buttonAction,u.offerDisplayProperties=t.lockup.offerDisplayProperties,u.titleOfferDisplayProperties=t.titleOfferDisplayProperties,u.clickAction=t.lockup.clickAction,u.children=t.lockup.children,u.contextMenuData=t.lockup.contextMenuData,u.shelfBackground=t.lockup.shelfBackground,u.searchAd=t.lockup.searchAd,u.searchAdOpportunity=t.lockup.searchAdOpportunity,u.crossLinkTitle=t.lockup.crossLinkTitle,u.crossLinkSubtitle=t.lockup.crossLinkSubtitle,u.tertiaryTitle=t.lockup.tertiaryTitle,u.tertiaryTitleAction=t.lockup.tertiaryTitleAction,u.tertiaryTitleArtwork=t.lockup.tertiaryTitleArtwork,u.flowPreviewActionsConfiguration=t.lockup.flowPreviewActionsConfiguration,u.productDescription=t.lockup.productDescription,u.itemBackground=t.lockup.itemBackground,u.developerAction=t.developerAction,u.ageRatingAction=t.ageRatingAction,u.logoArtwork=t.logoArtwork,u.navigationBarIconArtwork=t.navigationBarIconArtwork,u.uberArtwork=null===(o=t.uber)||void 0===o?void 0:o.artwork,u.uberArtworkForCompactDisplay=null===(a=t.uber)||void 0===a?void 0:a.compactArtwork,u.uberVideo=null===(c=t.uber)||void 0===c?void 0:c.video,u.uberStyle=null===(l=t.uber)||void 0===l?void 0:l.style,u.media=function(e){const t=[]
for(const n of Object.values(e.shelfMapping))if(Na(n)){const e=n.contentsMetadata,r=n.items
t.push(new Az(r,e.platform,e.allPlatforms,e.platformDescription,e.allPlatformsDescription,e.allPlatformsDescriptionPlacement))}return t}(t),i(t.shelfMapping[tq])&&(u.badges=nd(e,t.shelfMapping[tq])),u.shareAction=t.shareAction,u.pageMetrics=t.pageMetrics,u.pageRenderMetrics=t.pageRenderMetrics,u.isComplete=!t.isIncomplete,u.hasDarkUserInterfaceStyle=t.hasDarkUserInterfaceStyle,u.mediaSectionTitle=e.loc.string(RP),u.expandedOfferDetails=t.expandedOfferDetails,u.regularPriceFormatted=t.regularPriceFormatted,u.theme=t.theme,u.externalVersionIdentifier=t.externalVersionIdentifier,u.updateBuyParams=t.updateBuyParams,u.appPlatforms=t.appPlatforms,u.descriptionHeader=t.descriptionHeader,u.description=t.description,u.banner=t.banner,u.secondaryBanner=t.secondaryBanner,u.fullProductFetchedAction=t.fullProductFetchedAction,u.appPromotionDetailPageFlowAction=t.appPromotionDetailPageFlowAction,u.pageRefreshPolicy=t.pageRefreshPolicy,u.purchasedOrdering=xa(e,$a(0,!0,e.host.platform,n,!1,!1,r)),u.notPurchasedOrdering=xa(e,$a(0,!1,e.host.platform,n,!1,!1,r)),u.shelfMapping=function(e,t){const n={}
for(const r of g2){let o
o=r===Fq?ja(e,t):t.shelfMapping[r],s(o)&&(n[r]=o)}return n}(e,t),u.alwaysAllowReviews=t.alwaysAllowReviews,u})}function ja(e,t){const n=t.shelfMapping[EH],r=t.shelfMapping[UU],i=t.shelfMapping[LH],a=t.shelfMapping[GU],c=t.shelfMapping[jU]
if(o(n)&&o(r)&&o(i)&&o(a)&&o(c))return null
let l=null,u=[],d=null,f=null,h=null,p=null,w=null
if(s(null==r?void 0:r.items))for(const e of r.items){const t=e
switch(t.sourceType){case LH:l=t.review
break
case DP:u.push(t.review)}}else u=null
if(s(null==i?void 0:i.items)&&(l=i.items[0]),s(null==a?void 0:a.items)&&(f=a.items[0].action),s(null==c?void 0:c.items)){const e=c.items[0].action
h=e.writeReviewAction,p=e.supportAction}s(null==n?void 0:n.items)&&(d=n.items[0],w=null==n?void 0:n.seeAllAction)
const g=new fJ
g.adamId=t.lockup.adamId,g.ratings=d,g.tapToRate=f,g.editorsChoice=l,g.reviews=u,g.supportAction=p,g.writeReviewAction=h,g.alwaysAllowReviews=t.alwaysAllowReviews
const v=new dJ(_P)
return v.title=Ma(e),v.items=[g],v.seeAllAction=w,v}async function Va(e,t,n){qv.beginContext(e)
let r=await M(t())
if(!r.success&&(0,Hv.isSome)(n)&&(r=await M(n(r.error))),qv.endContext(),r.success)return r.value
throw r.error}function Ha(e,t,n,r,i){if(!oi(e))return null
if(o(t))return null
const s={pageInformation:n,locationTracker:r},a=hi(e,t,null,!1,!1,s,!0,!0,!1,i.allowUnpublishedAppEventPreviews);(0,Hv.isSome)(a.nextAppEventPromotionStartDate)&&(0,Hv.isSome)(null==i?void 0:i.refreshController)&&Br(a.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const c=a.appPromotions
if(0===c.length)return null
const l=qa(0,c,void 0)
return l.isHorizontal=!1,Mh(e,l,{...s,id:"",kind:null,softwareType:null,targetType:dq,title:""}),l}function qa(e,t,n){const r=new dJ(OO)
return r.isHorizontal=!0,r.title=n,r.items=t,r}function Wa(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n){const n=r.replace(/\//g,"\\/")
if(new RegExp(n).test(t)){const n=new EY(YF,t)
return n.pageData=new S2(e.bag.metricsTopic),n}}const r=e.bag.webViewRegexStrings
for(const e of r){const n=e.replace(/\//g,"\\/")
if(new RegExp(n).test(t))return new EY(e$,t)}return new EY(Tj,t)}function za(e){switch(e){case ZN:return ZN
case qk:return qk
default:return qq}}function Ya(e){return`${e.shelfIdentifier}.${e.slot}`}function Ja(e,t){if(r(e))return null
const n=Ya(t),o=e.tasks[n]
return r(o)?null:(delete e.tasks[n],o)}function Ka(e,t,n){var r
const o=(null==n?void 0:n.meta)||null,i=null===(r=null==o?void 0:o.adDisplayStyle)||void 0===r?void 0:r.slot
return(0,Hv.isSome)(i)?Za(e,t,{shelfIdentifier:k2,slot:i}):Za(e,t,C2)}function Za(e,t,n){const o=null==t?void 0:t.mediaResponse
if((0,Hv.isNothing)(o)||(0,Hv.isSome)(null==t?void 0:t.failureReason))return null
const i={tasks:{}}
return function(e,t){if(r(e))return
const n=Ya(t.positionInfo)
e.tasks[n]=t}(i,{data:yt(e,o),positionInfo:n}),i}function Qa(e,t,n){e.bag.isOnDemandShelfFetchingEnabled&&(0,Wv.isSome)(t)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=tc(e,t,n.remainingItems.length))}function Xa(e,t,n,r,i){(0,Wv.isSome)(t)&&(0,Wv.isSome)(t.url)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=tc(e,t,null!=r?r:n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,i))}function ec(e,t,n,r){n.showingPlaceholders=tc(e,t,n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,r)}function tc(e,t,n,r=!1,i=!1,a=null){if(s(t.items))return!1
if(!function(e,t){switch(t){case Iq:case oq:case mB:case gG:case U$:case kb:case EB:case tN:case fN:case OO:case KN:case EV:case qb:case dF:return!0
default:return!1}}(0,t.contentType)||r)return!1
const c=function(e,t,n){return t>0?t:(0,Wv.isSome)(n)&&!ji(n)?0:e.client.isPad?15:6}(e,n,a),l=new Array(c)
for(let e=0;e<c;e+=1)l[e]=new I2
if(o(l))return!1
const u=function(e,t){if((0,Wv.isSome)(t.rowsPerColumn))return t.rowsPerColumn
switch(t.contentType){case Iq:return 3
case oq:return 2
case mB:return 1
case U$:return null
default:return 1}}(0,t)
return(0,Wv.isSome)(u)&&(t.rowsPerColumn=u),t.placeholderContentType=t.contentType,t.contentType=IN,t.items=l,s(i)&&(t.presentationHints={...t.presentationHints,isAppleArcadeContext:i}),t.isHidden=!1,!0}function nc(e){return e.contentType===IN}function rc(e){const t=[$q,Oq,iH,aH]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}function oc(e){const{platform:t,id:n,...r}=e
return{...r,platform:ut(t),id:dt(n),$kind:E2}}async function ic(e,t,n){var r
const o=Object.keys(n),i=o.map(async e=>await n[e]),s=await async function(e){const t=await Promise.all(e.map(async e=>{try{const t=await e
return function(e){return null!==e&&typeof e===fV&&dz in e}(t)?t:E(t)}catch(e){return R(e instanceof Error?e:new Error(String(e)))}})),n=[]
if(t.forEach(e=>{e.success||n.push(e.error)}),n.length>0)throw 1===n.length?n[0]:new fz(n)
return t}([t,...i]),a=s[0],c=a.value
if(!a.success||(0,Hv.isNothing)(c))throw null!==(r=a.error)&&void 0!==r?r:new Error("Unknown primaryPageData error")
const l={},u=s.slice(1)
for(const[t,n]of u.entries()){const r=o[t]
n.success?l[r]=n.value:(l[r]=null,e.console.log(`Builder - failed to fetch additionalPageRequirement ${r}, reason: ${n.error}`))}return{primaryPageData:c,additionalData:l}}async function sc(e,t,n,o,i){const s=n(e,t,i)
if(!s)return await Promise.resolve({originalData:t})
const a=Array.from(s),c=[]
for(const t of a){const n=o(e,t)
if(r(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}function ac(e,t,n){if(o(t))return
const r=function(e){return f(e,"meta.metrics.clusterId")}(n)
o(r)||function(e,t,n){const r=lc(t)
e.storage.storeString(r,n)}(e,t,r)}function cc(e,t){return o(t)?null:function(e,t){const n=lc(t)
return e.storage.retrieveString(n)}(e,t)}function lc(e){return e+"-cohort-id"}function uc(e,t,n=[],r){const o={exclusions:null==r?void 0:r.exclusions},i=n.slice()
return(null==r?void 0:r.optionalQuery)&&i.push(...r.optionalQuery.map(e=>`${e}?`)),{routes(n){var s,a
return[{rules:[...null!==(s=null==r?void 0:r.prependRules)&&void 0!==s?s:[],{...o,path:t,query:[`${zW.language}?`,...i]},{...o,path:`/{${xW.storeFront}}${t}`,query:[`${zW.language}?`,...i],regex:[/^https?:\/\/[^/]+\/[a-z]{2}(\/.*)?$/i]},...null!==(a=null==r?void 0:r.extraRules)&&void 0!==a?a:[]],handler(t,r){const{[xW.storeFront]:o,[zW.language]:i,...s}=r
return e({...s,..._i(n,{storefront:o,language:i})})}}]},makeCanonicalUrl(e,o){const i=function(e,t,n){const r=new Lm.URL("https://apps.apple.com"),{storefront:o,language:i}=function(e,t){return e.locale.deriveLocaleForUrl(t)}(e,n)
return r.path(o),r.path(t.substr(1)),(0,Hv.isSome)(i)&&r.param("l",i),r}(e,t,o),s=i.pathComponents()
for(const[e,t]of s.entries())if(t.startsWith("{")&&t.endsWith("}")){const n=t.substring(1,t.length-1)
s[e]=o[n]}i.set(gV,"/"+s.join("/"))
const a=n.slice()
a.sort((e,t)=>e.localeCompare(t))
for(const e of a){if(!(e in o))throw new Error(`expected queryParmeters to contain: ${e}`)
const t=o[e]
i.param(e,t)}if(null==r?void 0:r.optionalQuery){const e=r.optionalQuery.slice()
e.sort((e,t)=>e.localeCompare(t)),e.forEach(e=>{const t=o[e]
t&&i.param(e,t)})}return i.toString()}}}function dc(e,t,n=[],r){const{makeCanonicalUrl:o}=uc(e,t,n,r),i=["tv",_q,Dq,lW,Qq,cW].map(o=>uc(t=>e({...t,platform:o}),`/${o}${t.replace(/^\/\{platform\}/,"")}`,n,r).routes)
return{routes:e=>i.map(t=>t(e)).reduce((e,t)=>[...e,...t]),makeCanonicalUrl:o}}function fc(e,t,n){const r=new dJ(n||O2)
r.isHorizontal=!1,r.items=Gb
const o=new pJ([r])
return o.isIncomplete=!0,o.title=t,o}function hc(e,t){if(!(0,Wv.isNothing)(t))switch(t){case U2:return B2
case B2:return U2
default:return}}async function pc(e,t,n,r=null){const o=function(e,t,n,r=null,o=e.host.clientIdentifier){const i=[iH,aH,IH]
e.bag.enableUpdatedAgeRatings&&i.push(Eq),e.appleSilicon.isSupportEnabled&&i.push(kH)
const a=new dY(e).forType(rN).addingQuery(PH,t).includingAttributes(i).addingQuery(oN,dW).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
return s(n)&&a.addingQuery(zW.charts,n),o===iY?a.addingContext(cW):o===sY&&a.addingContext(sq),e.appleSilicon.isSupportEnabled&&a.includingAdditionalPlatforms([_q,Dq]),(0,Wv.isSome)(r)&&a.addingQuery(zW.ages,r),a}(e,t,n,r)
return o.withLimit(200),o.enablingFeature("newChartsElements"),await Ln(e,o)}async function wc(e,t,n){let r
return r=e.host.clientIdentifier===sY||function(e){return s(e)&&(-1!==e.indexOf(G2)||-1!==e.indexOf(j2))}(t)?Promise.resolve({}):Ln(e,An(e,n)).catch(()=>{}),await r}function gc(e,t){var n
let r=e.loc.string(pb)
return(0,Hv.isSome)(t.title)?r=`${t.title}, ${r}`:(0,Hv.isSome)(null===(n=t.header)||void 0===n?void 0:n.title)&&(r=`${t.header.title}, ${r}`),{label:r,roleDescription:e.loc.string(wb)}}function vc(e,t,n){const r=s(n)?[...n]:[]
return r.push(`${zW.groupingFeaturedContentId}=${e}`),s(t)&&r.push(`${zW.nativeGroupingShelfId}=${t}`),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:r}}function mc(e,t){const n=[]
for(const r of e)n.push(vc(r,null,t))
return n}function yc(e,t){if([dV,jV,qG].includes(e.host.platform)&&ht(t)){const e={app:"com.apple.gamecenter.from.browse",kind:{name:OV}}
return t.referrerData=e,new ZJ([new J2(e),t])}return t}function Ac(e,t,n,r){const o={...n,shouldFilter:!H(t,V$),chartUrl:j(t,_G),chartIdentifier:j(t,aq),roomRelationshipData:pe(e,t,"room")}
return Vi(o.featuredContentId)?(o.seeAllUrl=function(e,t,n){const r=j(t,_G),o=new az(r),i=j(t,aq)
s(i)&&o.param(zW.chart,i)
const a=function(e,t,n){var r
const o=(null!==(r=null==n?void 0:n.editorialCharts.length)&&void 0!==r?r:0)>1,i=null==n?void 0:n.editorialCharts.map(e=>e.type.toString()).join(",")
if((0,Wv.isSome)(i)&&i.includes(t)&&o)return i
const s=hc(0,t)
return void 0===s?t:[t,s].join(",")}(0,i,n)
return s(a)&&o.param(zW.charts,a),o.toString()}(0,t,r.chartSet),o.showOrdinals=!0,o.shouldFilter=!1):s(o.roomRelationshipData)&&(o.seeAllUrl=Fi(e,o.roomRelationshipData.href)),o.shelfStyle=function(e,t,n,r){const o=n.featuredContentId
if(o===R0||o===d0||o===S0||function(e){return N0.has(e)}(o)){let e=j(t,CH)
return e||(e=o===i0||o===s0?Pq:o===S0||o===R0?kU:WH),`${e}Lockup`}if(o===A0)return PM
if(o===m0)return fN
if(o===r0||o===o0||o===y0||o===f0)return tN
if(Vi(o))return Iq
if(o===I0)return EB
switch(r.shelves.length%3){case 0:return Iq
case 1:return oq
default:return mB}}(0,t,o,r),o.clientIdentifierOverride=Fr(e,t),o}function Tc(e,t,n,a){const c=(l=t.featuredContentId,x0.has(l)?Qv.ChartsMac:Qv.All)
var l
let u,d,h=[]
if(s(n.shelfContents)){const o=function(e,t,n,o){var s
const a=Ja(t,n)
if(r(a))return null
const c=a.data,l=bc(e,c,o)
return i(l)?o.includedAdAdamIds=[c.id]:null===(s=o.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,n.shelfIdentifier,n.slot),l}(e,null==a?void 0:a.adStitcher,C2,t)
o&&ft(o)&&(h.push(o),Oh(t.metricsLocationTracker),t.ordinalIndex++,n.shelfContents=n.shelfContents.filter(e=>e.id!==o.adamId))}for(const o of n.shelfContents){if(o.type===iW)return null
if(t.featuredContentId===R0&&o.type===Xq){u=o
continue}if(r(o.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}if(at(e,o,c))continue
const n=bc(e,o,t)
n&&(h.push(n),Oh(t.metricsLocationTracker),t.ordinalIndex++)}!Vi(t.featuredContentId)||qi(t.featuredContentId)||Hi(t.featuredContentId)||(h=function(e,t){if(!e)return null
const n=e.length,r=n%3
return n>=3?e.slice(0,n-r):e}(h)),delete t.maxItemCount,d=Hi(t.featuredContentId)?oo(e,t.title):{eyebrow:t.eyebrow,eyebrowArtwork:t.eyebrowArtwork,title:t.title,titleArtwork:t.titleArtwork,subtitle:t.subtitle,configuration:t.shelfHeaderConfiguration}
const w=new dJ(t.shelfStyle)
let g
if(w.isHorizontal=!0,w.items=h,w.shouldFilterApps=t.shouldFilter,Hi(t.featuredContentId)&&(w.footerTitle=e.loc.string(G$),w.footerAction=ro({objectGraph:e,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker}),w.footerStyle={$kind:QH,bundleID:EN,width:16,height:16},w.items.forEach((t,n)=>{(0,Wv.isSome)(t)&&ft(t)&&(t.clickAction=yc(e,t.clickAction))})),t.featuredContentId===R0?function(e,t,n,r,o,i,a){if((0,Wv.isNothing)(i)&&(i=pe(e,t.featuredContentData,XO)),r.configuration.includeTrailingArtwork=!0,!W(i)){const e=j(t.featuredContentData,fW)
return r.eyebrow=e,r.title="",n.footerTitle="",t.isDeferring=!0,void t.remainingItems.push(i)}const c=j(t.featuredContentData,fW)
r.eyebrow=c
const l=B(i,hV),u=f(l,fW)
r.title=u,Ch(t.metricsLocationTracker).name=u,s(t.originalPlaceholderShelfImpressionMetrics)&&(t.originalPlaceholderShelfImpressionMetrics.fields.name=u)
const d=B(i,$q)
if((0,Wv.isNothing)(d))return void(n.isHidden=!0)
const h=p(d,"storyBackgroundStatic16x9"),w={useCase:y6.CategoryBreakoutShelf,withJoeColorPlaceholder:!0},g=ts(e,h,w),v=be(g.backgroundColor)?Gq:hq
n.background={type:oW,artwork:g,style:v},o.forEach((t,n)=>{(0,Wv.isSome)(t)&&ft(t)&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Pj,v),t.subtitleTextFilter=BA,e.clientCapabilities.isNotEnabled(Ub)&&(t.redownloadButtonTint=Se(uq)))})
const m=p(d,rR)
if((0,Wv.isNothing)(m))return void(n.isHidden=!0)
const y={contentMode:Kv.scaleAspectFit,useCase:y6.GroupingBrick},A=ts(e,m,y)
r.trailingArtwork=A
const T=f(i.attributes,Wq),b=f(i.attributes,g$),S={id:i.id,idType:Sq,targetType:hW,actionType:pW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
if((0,Wv.isSome)(T)){n.footerTitle=b
const t=e.required(y3).fetchFlowPage(T),r=new EY(t)
r.title=b,r.pageUrl=T,Qs(e,r,S),n.footerAction=r}else{const r={targetType:hW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},o=os(e,i,t,!1,null,r,a);(0,Wv.isSome)(o.action)&&(o.action.actionMetrics.clearAll(),o.action.title=null!=b?b:f(l,"callToAction"),Qs(e,o.action,S),n.footerAction=o.action,n.footerTitle=o.action.title)}}(e,t,w,d,h,u,a):e.clientCapabilities.isNotEnabled(Ub)&&w.items.forEach((e,t)=>{(0,Wv.isSome)(e)&&ft(e)&&(e.redownloadButtonTint=Se(OL))}),w&&o(w.items)&&t.isFirstRender&&ec(e,w,t,t.featuredContentId),Vi(t.featuredContentId))g=new EY(dG)
else if(g=new EY(wW),!nc(w)){const e=function(e,t){if(!t)return null
switch(t){case sN:case PM:return t
default:return null}}(0,t.shelfStyle)
g.pageData=fc(0,t.title,e)}g.pageUrl=t.seeAllUrl,g.title=e.loc.string(cH),g.referrerUrl=t.metricsPageInformation.pageUrl,Xs(e,g,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})
const v=function(e,t,n){return n.featuredContentId!==R0&&!qi(n.featuredContentId)&&!Hi(n.featuredContentId)&&n.featuredContentId!==I0}(0,w.items,t),m=i(g.pageUrl)||i(g.pageData)
if(v&&m&&ds(e,d,g),t.shelfStyle===fN||t.shelfStyle===tN){const e=j(t.featuredContentData,"suppressTagline")!==pq
r(w.presentationHints)?w.presentationHints={showSupplementaryText:e}:w.presentationHints={...w.presentationHints,showSupplementaryText:e}}return t.shelfStyle,w.header=d,w.url=Ki(0,w,t),w}function bc(e,t,n){if(o(t))return null
let a
n.showOrdinals&&(a=e.loc.decimal(n.ordinalIndex))
let c,l=null
!i(n.shelfBackground)||n.shelfBackground.type!==PV&&n.shelfBackground.type!==sM||(l=uq),s(n)&&(c=n.clientIdentifierOverride)
const u={ordinal:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},clientIdentifierOverride:c,artworkUseCase:Kd(0,n.shelfStyle),offerStyle:l,canDisplayArcadeOfferButton:eh(0,n.shelfStyle),isContainedInPreorderExclusiveShelf:n.featuredContentId===I0,shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ)&&n.isArcadePage}
let d
switch(n.shelfStyle){case tN:d=function(e,t,n,r){return qv.context("trailersLockupFromData",()=>{const o=new $Y
return function(e,t,n,r,o){t&&qv.context("copyDataIntoTrailersLockup",()=>{md(e,t,n,o),n.trailers=af(e,t,r,o.metricsOptions,n.adamId)})}(e,t,o,r,n),o})}(e,t,u,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
break
case fN:d=Od(e,t,u)
break
case EB:d=Ed(e,t,u)
break
case sN:case PM:d=kd(e,t,u)
break
case"smallImageLockup":case bU:case F$:d=Dd(e,t,u,um.EditorialLockupLarge)
break
default:d=Cd(e,t,u)}return r(d)||!d.isValid()?null:d}function Sc(e,t,n=!1){const r=Rc(e,t),o=e.client.isPhone
let i=o?yb:JE
n&&(i="topShelf")
const a=p(r,i)
let c=null,l=null
return s(a)&&(c=Zd(e,a,{withJoeColorPlaceholder:!0,useCase:y6.ArcadeLargeBreakout}),s(c)&&(c.crop=o?"oa":n?"ta":"ob",l=c.backgroundColor)),{artwork:c,artworkData:a,backgroundColor:l}}function Pc(e,t,n=!1,r=!1){const o=function(e,t){switch(t.type){case Xq:return B(t,Oq)
case SV:return B(t,MO)
default:return se(t,nt(e,t),MO)}}(e,t),i=e.client.isPhone||r,a=i?"breakoutVideo9x16":"breakoutVideo16x9",c=p(o,i?"sizzleVideo9x16":"sizzleVideo16x9")||p(o,a)
let l=null,u=null,d=null
if(s(c)){d=p(c,UG)
const t=Zd(e,d,{withJoeColorPlaceholder:!0,useCase:y6.ArcadeLargeBreakout})
s(t)&&(t.crop="sr",u=t.backgroundColor)
const r=f(c,rq)
s(t)&&(null==r?void 0:r.length)>0&&(l=new mz(r,t,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:n},autoPlayPlaybackControls:{}}))}return{video:l,artworkData:d,backgroundColor:u}}function Ic(e,t,n=!0,r,o){const i=Pc(e,t),s=Sc(e,t),a=i.backgroundColor||s.backgroundColor
return kc(e,t,0,o),(t.type===SV?u(Ec(0,t),"displayMaterial"):H(t,$A))&&n?FA:Cc(0,a)}function Cc(e,t){return t?be(t,50)?Gq:hq:Gq}function kc(e,t,n,r){if(e.client.isPhone||r)return Rq
const o=t.type===SV?f(Ec(0,t),"textPosition"):j(t,jO)
if((0,Hv.isNothing)(o)||0===o.length)return eW
switch(o.toLowerCase()){case VO:return eW
case Rq:return Rq
case HO:return Fj
default:return eW}}function Oc(e,t,n,r=!1){switch(t){case eW:case Fj:return eW
case Rq:return r||n.type===SV?Rq:function(e,t){var n
switch((null!==(n=j(t,jO))&&void 0!==n?n:"").toLowerCase()){case VO:return eW
case Rq:return Rq
case HO:return Fj
default:return eW}}(0,n)
default:return eW}}function Ec(e,t){return t.type!==SV?null:B(t,"display.templateParameters")}function Rc(e,t){switch(t.type){case Xq:return B(t,$q)
case SV:return B(t,CA)
default:return se(t,nt(e,t),$q)}}function Dc(e,t){return t.type===SV?f(gr(0,t),"callToActionLabel"):j(t,g$)}function _c(e,t){const n=s(B(t,Mq)),r=H(t,uU)
return!n&&!r}function Lc(e,t){const n=B(t,Mq),o=s(n),i=(j(t,DH),H(t,uU)),a=pe(e,t,bH)
if(!o&&!i&&!W(a))return null
let c=null
if(c=o?f(n,Wq):j(i?t:a,Wq),r(c))return null
let l=null
if(o&&f(n,v$)===LL)l=new GY(c)
else if(e.isAvailable(y3)){const t=e.required(y3).fetchFlowPage(c),n=new EY(t)
n.pageUrl=c,t===yH&&(n.pageData=td(e,a)),l=n}return l&&(l.title=Dc(0,t)),l}function Mc(e,t,n=!1){if(o(t))return null
let r=null
const i=Se(uq),s=Se(qO),a=ye(f(t,oj)),c=l(t,NA).map(e=>ye(e)),u=Cc(0,a)
if(2===c.length){r=new k4("horizontalGradient")
const e=c[0],t=c[1]
r.gradientStartColor=Pe(e,e),r.gradientEndColor=Pe(t,t),r.filter=BA,n||(r.accessoryColor=r.gradientEndColor)}else r=new k4(PV),r.color=u===Gq?i:s,n||(r.accessoryColor=r.color),r.isFallbackStyle=!0
return r}function xc(e,t,n,r=uq){if(o(t)||o(t.attributes))return null
const s=Pc(e,t,!0),a=Sc(e,t),c=s.backgroundColor||a.backgroundColor,l=kc(e,t,0,!0),u=Ic(e,t,!1,0,!0)!==FA&&!0,d=Nc(e,t,0,!1,u,_L)
let h=null
"tv"!==e.client.deviceType&&(h=d.description,d.description=null)
const p=function(e,t){const n=Ec(0,t),r=f(n,"ctaButtonBackgroundColor"),o=f(n,"ctaButtonTextColor")
return i(r)&&i(o)?{type:UO,fillColor:ye(r),textColor:ye(o)}:{type:rL,fillColor:null,textColor:null}}(0,t),w=new UY(sW,e.bag.arcadeAppAdamId,null,r,null,sW,p,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId),g=new N4(d,w,{backgroundColor:c,wantsMaterialDetailBackground:!1,wantsBlur:u,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:l},null,h,a.artwork,s.video),v=Bh(e,t,g.details.title,{...n,targetType:uG})
return v.displaysArcadeUpsell=!0,Mh(e,g,v),bh(e,v,g.details.title),g.offerButtonAction=Bc(e,t,pt(QB),n),Ph(n.locationTracker),g}function $c(e,t){return Dc(0,t)}function Fc(e,t){return j(t,RH)}function Nc(e,t,n,r,o,i){let s=null
switch(i){case _L:s={type:_L}
break
case QV:const e=j(t,iU)
s=(null==e?void 0:e.length)>0?{type:QV,title:e}:{type:mq}
break
default:s={type:mq}}let a=Ic(e,t,r,0,!0)
const c=kc(e,t,0,!0)
return o&&(a=Gq),new B4(function(e,t){return j(t,Nq)}(0,t),Fc(0,t),s,null,a,Oc(0,c,t,!0))}function Bc(e,t,n,r){const o={marketingItemData:t},i=n===pt(QB)&&e.bag.arcadeDownloadPackPostSubscribeTrigger&&ar(e,e.bag.arcadeDownloadPackRolloutRate)
return Uc(e,o,$c(0,t),r,i)}function Uc(e,t,n,r,o){const s=t.marketingItemData
if(!i(s))return null
const a=gr(0,s),c=f(a,DH)===Mq,u=f(a,Wq)
if(c&&u){const t=function(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n)if(new RegExp(r).test(t)){const n=new EY(YF,t)
return n.pageData=new S2(e.bag.metricsTopic),n}const r=e.bag.financeUIRegexStrings
for(const e of r)if(new RegExp(e).test(t))return new EY(Tj,t)
const o=e.bag.webViewRegexStrings
for(const e of o)if(new RegExp(e).test(t))return new EY(e$,t)
return new GY(t,!1)}(e,u),o={id:e.bag.arcadeAppAdamId,actionType:w$,actionContext:vq,contextualAdamId:e.bag.arcadeAppAdamId,offerType:BO,targetType:hW,mercuryMetricsData:mh(0,s),...r}
return t.title=n,Qs(e,t,o),t}{const t=function(e,t,n,r){const o=gr(0,t),s=f(o,rj),a=f(o,Sj)
if(!i(s)||!i(a))return null
const c=l(o,"serviceTypes").length>1&&e.bag.aristotleParentAppAdamId?e.bag.aristotleParentAppAdamId:e.bag.arcadeAppAdamId,u=new U4(s,c,{buyParams:a,productIdentifier:s,pageInformation:r.pageInformation},null,null),d={id:c,actionType:w$,targetType:hW,subscriptionSKU:s,actionContext:vq,contextualAdamId:c,actionDetails:{buyParams:a},offerType:BO,mercuryMetricsData:mh(0,t),...r}
return u.title=n,Qs(e,u,d),u}(e,s,n,r)
if(o){const e=new EY(pB),r=ZN
e.pageData=r,e.presentationContext=Wj
const o=new AZ(void 0,void 0,e,void 0),i=new ZJ([t,o])
return i.title=n,i}return t}}function Gc(e,t,n){switch(n){case EV:return H4.has(t)
case kN:return j4.has(t)
case _B:return V4.has(t)
default:return!1}}function jc(e,t,n,o,s,a){const c=new BZ(o.metricsPageInformation,o.metricsLocationTracker)
null==a&&((a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}).isHorizontalShelfContext=!0),e.client.deviceType!==cW&&(a.coercedCollectionTodayCardDisplayStyle=Tm.Grid)
const l=Co(t,a.coercedCollectionTodayCardDisplayStyle)
if(a.prevailingCropCodes=function(e,t,n){switch(t){case EV:return null
case kN:return{defaultCrop:"el"}
case _B:return n===Tm.Video?{defaultCrop:"sr"}:{defaultCrop:"ek"}
default:return null}}(0,n,l),a.horizontalCardContentType=n,!i(t.attributes))return s&&s(t),null
const u=bo(e,t,a,c,o.augmentingData)
if(r(u))return null
{u.collapsedHeading=xo(0,u),u.inlineDescription=qc(e,u,t),u.inlineDescription===u.collapsedHeading&&(u.inlineDescription=null)
const n=u.media
n&&n.kind===Aj&&(u.title=null)}if(n===_B){const e=u.heroMedia
if(!i(e)||0===e.artworks.length&&0===e.videos.length)return null}return Gc(0,u.media.kind,n)&&i(o.filterOutMediaCardKinds)&&o.filterOutMediaCardKinds.has(u.media.kind)?null:(function(e,t,n){if("tv"!==e.client.deviceType||!H(n,P_))return
const r=new GY("com.apple.Arcade://")
t.clickAction=r}(e,u,t),u)}function Vc(e,t,n,r,s,a,c){if(!i(n))return null
const l=new dJ(n)
return r&&(l.title=r),l.subtitle=s,l.isHorizontal=!0,l.items=n===CU?[Wc(e,t,a.metricsPageInformation,a.metricsLocationTracker,()=>!0,c)]:function(e,t,n,r,i,s){const a=[]
for(const s of t){const t=jc(e,s,n,r,i,void 0)
o(t)||(a.push(t),Oh(r.metricsLocationTracker))}return a}(e,t,n,a,c),l}function Hc(e,t,n,r,s,a){const c=new dJ(dF)
n&&(c.title=n),c.subtitle=r,c.isHorizontal=!0
const l=[],u={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
u.metricsDisplayStyle=bm.SmallCard,u.alwaysShowBadgeInSmallCards=!0,u.alwaysUseMaterialBlur=!0
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=bo(e,n,u,s)
o(t)||(l.push(t),Oh(s.locationTracker))}return c.items=l,c}function qc(e,t,n){{let o=zf(e,n,fW)
return i(o)&&(o=o.replace(/\n/g," ")),t.media.kind===Aj&&$r(r=t.overlay)&&r[gW]===Sy&&i(t.overlay.lockup)?t.overlay.lockup.title:o}var r}function Wc(e,t,n,o,s,a){return qv.context("todayCardsFromPlatformData",()=>{if(!t)return null
const c={useOTDTextStyle:!1,enableFullScreenVideo:!1,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
c.coercedCollectionTodayCardDisplayStyle=Tm.Grid,c.prevailingCropCodes={defaultCrop:"fo"},c.isHorizontalShelfContext=!0
const l=new BZ(n,o),u=[]
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=bo(e,n,c,l)
if(!r(t)&&s(t)){t.collapsedHeading=xo(0,t),t.inlineDescription=qc(e,t,n),t.inlineDescription===t.collapsedHeading&&(t.inlineDescription=null)
const r=t.media
r&&r.kind===Aj&&(t.title=null),u.push(t)}}return u.length?new G4(u):null})}function zc(e,t){const n=new Set,r=yt(e,t),o=we(r,TN)
for(const t of o){const o=Jc(e,t,r)
if(s(o))for(const e of o)n.add(e)}return n}function Yc(e,t){let n
return t===A_&&(n=ao(e,pt(nL))),t===T_&&(n=so(e,10)),r(n)?null:Ln(e,n).catch(()=>null)}function Jc(e,t,n){if(j(t,lC)!==b_)return null
const o=j(t,uC),i=r(co(e,n)),s=[]
return o===dC&&(s.push(T_),i&&s.push(A_)),s}function Kc(e,t,n,a,c){return qv.catchingContext(`module: ${a.module}`,()=>{var c
const l=[]
switch(a.module){case"Header":a.titleForNextShelf=j(t,yG)
break
case"TextBlock":{const e=function(e,t,n){const r=j(t,yG)
if(!r)return null
const o=new FX(r,bV,Tq)
el(0,o,n)
const i=new dJ(Nj)
return i.items=[o],i}(0,t,a);(0,Hv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"CollectionLockup":{const n=function(e,t,n){const r=H(t,"showOrdinals"),o="OrdinalDesc"===j(t,"collectionLockupDisplayType")?oS:"ascending",i=j(t,"collectionLockupSize")
let s
if(n.subStyle=i,i)switch(i){case mC:s=mB
break
case vC:s=oq
break
default:s=Iq}const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Kd(0,s),canDisplayArcadeOfferButton:eh(0,s)},c=we(t,uW)
if((0,Hv.isNothing)(c))return null
let l=[]
if(l=$d(e,c,{includeOrdinals:r,ordinalDirection:o,lockupOptions:a}),!l||0===l.length)return null
const u=new dJ(s)
return u.items=l,u}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case fC:{const n=function(e,t,n){const r=j(t,"inlineImageDisplayType"),o=Zd(e,B(t,oW),{useCase:y6.ArticleImage,allowingTransparency:r===kF&&!0,withJoeColorPlaceholder:!1})
if(!o)return null
const i=new R4(o,!1,bV)
i.caption=j(t,yG),n.subStyle=r,r&&("BoundingBox"===r?(i.isFullWidth=!1,i.hasRoundedCorners=!0):(i.isFullWidth=!0,i.hasRoundedCorners=!1)),el(0,i,n)
const s=new dJ(S_)
return s.items=[i],s}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case hC:{const n=function(e,t,n){const r=Xc(e,t)
if(!r)return null
let o=null
const a=we(t,iW)
if(s(a)&&(o=Ha(e,a,n.metricsPageInformation,n.metricsLocationTracker,n),i(o)))return o
const c=j(t,"appLockupSize")
let l
n.subStyle=c
let u=!1
if(c)switch(c){case gC:l=Iq,u=!0
break
case vC:l=oq,u=!0
break
default:l=lE}const d=na(0,t)
if(u){const t=new dJ(l)
let i
if(i=Cd(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:d,artworkUseCase:Kd(0,l)}),(0,Hv.isNothing)(i))return null
t.items=[i],o=t}else o=function(e,t,n){const r=new dJ(lE),o="tv"!==e.client.deviceType,i=Xc(e,t),s=na(0,t),a=Cd(e,i,{offerStyle:Ej,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:y6.LockupIconSmall}),c=new L4(Pq,a)
c.description=Td(e,i)
let l=null
switch(j(t,"appLockupVideo")){case"AppTrailer":{const t=lf(e,i)
t&&t.length>0&&(l=t[0])
break}}return l&&(po(e,l,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId}),c.video=l),o&&(r.background={type:PV,color:W4}),r.items=[c],r}(e,t,n)
return o}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TipBlock":{const n=function(e,t,n){const r=Zd(e,B(t,oW),{useCase:y6.ArticleImage})
if(!r)return null
const o=j(t,yG),i=j(t,"tipNumber"),s=new R4(r,!1,bV)
s.isFullWidth=!1,s.hasRoundedCorners=!0,s.caption=o,s.ordinal=i,el(0,s,n)
const a=new dJ(S_)
return a.items=[s],a}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"PullQuote":{const n=function(e,t,n){const r=j(t,wC),o=j(t,"quoteAttribution"),i=Zd(e,B(t,oW),{useCase:y6.ArticleImage}),s=j(t,"pullQuoteDisplayType")===kF,a=new D4(r,o,i,s)
el(0,a,n)
const c=new dJ(wC)
return c.items=[a],c}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"HorizontalRule":{const e=function(e,t,n){const r=j(t,"lineStyle"),i=j(t,CH)===kF
let s=Se("defaultLine")
const a=B(t,"customColor"),c=ye(f(a,"lightMode")),l=ye(f(a,"darkMode"))
o(c)||o(l)||(s=Pe(c,l))
const u=new _4(r,s,i),d=new dJ("horizontalRule")
return d.items=[u],d}(0,t);(0,Hv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case pC:{const n=function(e,t,n){const r=Zd(e,B(t,"video.previewFrame"),{useCase:y6.ArticleImage})
if(!r)return null
const o=j(t,"video.video")
if(!o)return null
const i=j(t,"inlineVideoDisplayType")===kF,s=new mz(o,r,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
po(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const a=new h2(s,i,bV)
a.caption=j(t,yG),el(0,a,n)
const c=new dJ(Ix)
return c.items=[a],c}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppMedia":{const n=function(e,t,n){const o=Xc(e,t)
if(!o)return null
const s=j(t,"appMediaOption"),a=j(t,"appMediaPlatform")
switch(n.subStyle=s,s){case yy:{let t=null
if(t=new dJ(Yq),r(a)){const n=uf(e,o,y6.ArticleScreenshots)
n&&n.length>0&&(t.items=[n[0]])}else{const n=function(e,t){switch(t){case Qb:return cW
case dV:return e.client.isPad?Kq:nW
case qG:return"tv"
case Xb:return sq
case"visionOS":return Qq
default:return null}}(e,a)
if(n){const r=uf(e,o,y6.ArticleScreenshots,[n])
r&&r.length&&(t.items=[r[0]])}}return i(t)&&0===t.items.length?null:t}case"AppTrailers":const t=new dJ(Ix),s=lf(e,o)
if(s&&s.length>0){const r=s[0]
po(e,r,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const o=new h2(r,!1,GV,null,null,!0)
return t.items=[o],t}return null
default:return null}}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"LinkBlock":{const r=function(e,t,n,r){const o=j(t,Wq)
if(!o)return null
const i=new az(o),s=j(t,"urlTitle")
let a=j(t,yG)
a||(a=i.host)
const c=[yC,WU,"music.apple.com","books.apple.com","podcasts.apple.com","watch-app.cdn-apple.com","tv.apple.com"]
let l=!1
for(const e of c)i.host.endsWith(e)&&(l=!0)
const u=e.required(y3).fetchFlowPage(o)
!(0,Hv.isSome)(u)||u!==Tq&&u!==YF||(i.protocol=RW),e.bag.disabledRichLinkPresentationEditorialItemIds.includes(r.id)&&(l=!1)
const d=new GY(i.build())
Qs(e,d,{targetType:Mq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const f=new x4(s,a,d,l)
el(0,f,n)
const h=new dJ(y_)
return h.items=[f],h}(e,t,a,n);(0,Hv.isSome)(r)&&(l.push(r),a.hasFocusableElements=!0)
break}case"TextList":{const e=function(e,t,n){const r=G(t,yG)
if(!r.length)return null
const o=j(t,"textListDisplayType")
n.subStyle=o
let i,s=!1
s="Bulleted"===o,i=s?"<ul>":"<ol>"
for(const e of r){const t=JSON.stringify(e)
i=`${i}<li>${JSON.parse(t)}</li>`}i=s?`${i}</ul>`:`${i}</ol>`
const a=new FX(i,bV,Tq)
el(0,a,n)
const c=new dJ(Nj)
return c.items=[a],c}(0,t,a);(0,Hv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"IAPLockup":{const n=function(e,t,n){const r=Xc(e,t)
if(!r)return null
const o=kd(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:y6.LockupIconSmall})
if(!o)return null
const i=new M4(o),s=new dJ("inAppPurchaseShowcase")
return s.background={type:PV,color:q4},s.items=[i],s}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case b_:{const o=function(e,t,n,o){const a=j(t,uC)
o.subStyle=a
let c=null
switch(a){case"OSUpgrade":c=function(e,t,n){const r=e.client.deviceType
if(r!==lW)return null
const o=fr(r)
if(null===o)return null
const i=new GY(o)
Qs(e,i,{targetType:Mq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const s=e.loc.string("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),a=new $4(s,i)
el(0,a,n)
const c=new dJ("clientControlButton")
return c.items=[a],c}(e,0,o)
break
case dC:c=function(e,t,n,o){let a=co(e,n)
if(!a&&o.additionalData&&(a=lo(0,o.additionalData.get(A_))),!i(a))return null
const c={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},l=no(0,o.metricsPageInformation,o.metricsLocationTracker,!1)
let u
l.title=e.loc.string($B,FB)
const d=Dc(0,a.marketingItemData)
s(d)?(u=Bc(e,a.marketingItemData,pt(nL),c),i(u)&&(u.title=d)):(u=no(0,o.metricsPageInformation,o.metricsLocationTracker,!1),u.title=e.loc.string($B,FB))
const f=new F4(u,l),h=Fc(0,a.marketingItemData)
f.unsubscribedDescription=h
const p=new UY(sW,e.bag.arcadeAppAdamId,null,Ej,null,Gq,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
p.titles[EU]=e.loc.string($B,FB),f.offerDisplayProperties=p,Mh(e,f,{...c,targetType:XL,title:d,id:t.id,kind:XL,softwareType:null,displaysArcadeUpsell:!0})
{if(r(o.additionalData))return null
const t=o.additionalData.get(T_)
if(s(t)){const n={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},r=bt(t)
f.iconArtworks=Xd(e,r,n,{useCase:y6.LockupIconMedium})}}const w=new dJ(XL)
return w.items=[f],w.background={type:PV,color:z4},w}(e,t,n,o)}return c}(e,t,n,a);(0,Hv.isSome)(o)&&(l.push(o),a.hasFocusableElements=!0)
break}case"StoryList":{const n=function(e,t,n,r){const o=we(t,uW)
if(!o)return null
const i=j(t,fW),s=j(t,Rj)
let a=null
if(e.featureFlags.isEnabled(DJ))a=Hc(e,o,i,s,new BZ(n.metricsPageInformation,n.metricsLocationTracker))
else{const t=!0,r=t?EV:CU
a=Vc(e,o,r,i,s,n,null),t&&Array.isArray(a.items)&&(a.items=a.items.filter(e=>!Bt(e)||Gc(0,e.media.kind,r)))}return a}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppEventLockup":{const n=function(e,t,n){const r=Xc(e,t)
return r?Ha(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n):null}(e,t,a);(0,Hv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"OfferItemLockup":{const n=function(e,t,n){const r=pe(e,t,uW)
if(o(r))return null
const i=j(t,yG),s=new FX(i,bV,Tq),a=new dJ(Nj)
return a.items=[s],[a,Ha(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n)]}(e,t,a);(0,Hv.isSome)(n)&&(l.push(...n),a.hasFocusableElements=!0)
break}default:e.console.log(`Unknown module: ${a.module}`)}for(const e of l){const t=null!==(c=e.presentationHints)&&void 0!==c?c:{}
e.presentationHints={...t,isArticleContext:!0}}return l})}function Zc(e,t){const n=we(t,OH)
if(1!==n.length)return null
const r=n[0]
if(!r)return null
switch(r.type){case dW:case Zq:return r
default:return null}}function Qc(e){return e.client.deviceType===lW?uq:BH}function Xc(e,t,n){return pe(e,t,uW)||null}function el(e,t,n,o){if(!t)return
let i=n.module
n.subStyle&&(i=i+"_"+n.subStyle),r(o)&&(o={id:`${n.index}`,impressionIndex:n.index,idType:Aq,impressionType:i,kind:"iosModule"}),t.impressionMetrics=new jY(ph(o))}function tl(e,t,n){const r=new K4
r.overlayType=nl(e,t),r.displayOptions={horizontalPlacement:sl(e,t),textAlignment:al(e,t),isOverDarkContent:il(e,t)}
const a=rh(e,t),c=j(t,YH)
if(et(e,t,vG)?r.badgeText=e.loc.uppercased(nh(e,a,c)):r.badgeText=c,r.titleText=zf(e,t,fW)||Qe(e,a,fW),r.overlayType===gM||r.overlayType===zE?r.descriptionText=zf(e,t,Rj):r.descriptionText=zf(e,t,tV)||Qe(e,a,Rj),r.callToActionText=j(t,g$),r.buttonTitle=ol(e,t),r.overlayType!==tW&&r.overlayType!==gM||(r.lockup=function(e,t,n){let r=pe(e,t,bH)
const i=we(t,OH)
if(o(r)&&s(i)&&(r=i[0]),o(r))return null
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},artworkUseCase:n.lockupArtworkUseCase,offerStyle:Pj,offerEnvironment:Gq,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ),isContainedInPreorderExclusiveShelf:n.isContainedInPreorderExclusiveShelf},c=Cd(e,r,a),l=rh(e,t),u=zf(e,t,tV)||Qe(e,l,Rj)
return(null==u?void 0:u.length)>0&&(c.subtitle=u),c}(e,t,n)),(null==c?void 0:c.length)>0&&i(r.lockup)&&(r.lockup.heading=c),r.collectionIcons=function(e,t){const n=we(t,OH)
if(o(n))return null
const r=[]
for(const t of n){const n=tf(e,t,{useCase:y6.LockupIconSmall,withJoeColorPlaceholder:!0})
s(n)&&r.push(n)}return s(r)?r:null}(e,t),s(r.lockup))r.clickAction=r.lockup.clickAction,r.impressionMetrics=r.lockup.impressionMetrics
else{const o={targetType:tW,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i=rl(e,t),s=Lc(e,t)
s.title=i,Qs(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:tW,id:t.id}),r.clickAction=s,Mh(e,r,Bh(e,t,i,o))}return r}function nl(e,t){const n=H(t,$A),r=j(t,DH),a=we(t,OH),c=zf(e,t,Rj),l=function(e){return ar(e,e.bag.hero3RolloutRate)}(e)&&(null==c?void 0:c.length)>0
let u=pe(e,t,bH)
return o(u)&&s(a)&&(u=a[0]),i(u)&&"App"===r?l?gM:tW:s(a)&&"Collection"===r?l?zE:YE:n?vM:QV}function rl(e,t){const n=nl(e,t),r=pe(e,t,bH)
switch(n){case tW:case gM:return j(r,fW)
case vM:case QV:case YE:case zE:return zf(e,t,fW)||Qe(e,r,fW)
default:return null}}function ol(e,t){if("tv"!==e.client.deviceType)return null
switch(nl(e,t)){case tW:return e.loc.string(mb)
case vM:case QV:let t=e.loc.string(FE)
return t===FE&&(t=e.loc.string(mb)),t
case YE:return e.loc.string("HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_COLLECTION")
default:return null}}function il(e,t){const n=Pc(e,t),r=Sc(e,t),o=n.backgroundColor||r.backgroundColor
return!o||be(o,50)}function sl(e,t){if(e.client.isPhone)return Rq
const n=j(t,jO)
if(!s(n))return eW
switch(n.toLowerCase()){case VO:return eW
case Rq:return Rq
case HO:return Fj
default:return eW}}function al(e,t){return sl(e,t),eW}function cl(e,t,n){qv.catchingContext("parseGrouping",()=>{for(const r of t.data){const o=q(r,zj)
if(Vi(o)){const e=f(r,"id")
n.chartSet=ll(e,t.editorialChartSets)}else n.chartSet=null
const s=Wi(e,r,n),a=s.shelfToken,c=s.metricsOptions
let l
for(const t of g5)if(t.supports(e,r,o)){l=qv.catchingContext("parseGroupingShelf",()=>t.createShelf(e,r,n,a,c))
break}i(l)&&(n.shelves.push(l),un(e,n.shelves,AV,c.id,n.metricsPageInformation))}})}function ll(e,t){for(const n of t){if(n.id===e)return n
for(const t of n.editorialCharts)if(t.id===e)return n}return null}function ul(e,t){const n=[],r=[]
return function t(o){const s=q(o,zj)
qv.catchingContext(`flattenGroupingTree.addMediaApiDataToGroupingData: ${s}`,()=>{const a=pe(e,o,XG)
if(i(a))t(a)
else if(function(e){return G0.has(e)}(s)){const e=we(o,oH)
for(const n of e)t(n)}else if(s===g0){const e=q(c=o,zj)!==g0?null:{id:f(c,"id"),name:j(c,fW),editorialCharts:we(c,oH).map(e=>function(e){return Vi(q(e,zj))?{id:f(e,"id"),href:j(e,_G),name:j(e,fW),type:j(e,aq)}:null}(e)).filter(e=>(0,Hv.isSome)(e))};(0,Hv.isSome)(e)&&r.push(e)
const n=we(o,oH)
for(const e of n)t(e)}else n.push(o)
var c})}(t),{data:n,editorialChartSets:r,originalGroupingData:t}}function dl(e,t,n){var r,o,i,s,a,c
if(e.user&&e.user.isManagedAppleID)return null
{const t=[],n=e.loc.string("FOOTER_REDEEM",bO),l=Wa(e,e.bag.redeemUrl),u=new h5(n,l)
if(u.id=VF,t.push(u),e.bag.isMonetaryGiftingEnabled){const n=e.loc.string("FOOTER_SEND_GIFT",aA),r=Wa(e,HF),o=new h5(n,r)
o.id=HF,t.push(o)}const d=e.bag.accountTopUpURL
if((0,Hv.isSome)(d)){const n=null!==(r=e.bag.accountTopUpTitle)&&void 0!==r?r:e.loc.string("FOOTER_ADD_MONEY"),o=Wa(e,d),i=new h5(n,o)
i.id="topUp",t.push(i)}let f
{f=new dJ("titledButtonStack")
const n=new p5(t)
n.compactLineBreaks=n.buttons.map((e,t)=>t),f.items=[n]
const r=e.loc.string(pb),l=e.loc.string(wb)
f.accessibilityMetadata={label:null!==(s=null!==(o=f.title)&&void 0!==o?o:null===(i=f.header)||void 0===i?void 0:i.title)&&void 0!==s?s:r,roleDescription:l.replace("%d",`${null!==(c=null===(a=n.buttons)||void 0===a?void 0:a.length)&&void 0!==c?c:0}`)}}return f}}function fl(e,t,n=!0){const r=new GY(t),o=e.loc.string(GE),i=new t4(o)
i.clickAction=r,i.presentationStyle=[cM,lM],n&&i.presentationStyle.push(uM)
const s=new dJ("footnote")
if(s.items=[i],e.bag.emailSupportLinkURL){const t=new GY(e.bag.emailSupportLinkURL),r=new t4("Email Support")
r.clickAction=t,r.presentationStyle=[cM,lM],n&&r.presentationStyle.push(uM),s.items.push(r)}return s}function hl(e,t,n,r){const o=new dJ("unifiedMessage")
return o.id=t,o.items=[new w5(t,n,r)],o.isHidden=!0,o}function pl(e,t,n,r,o,a,c){var u
const d=l(t,nq),f=[]
for(const t of d){const l=y(t)
if(s(l)){const t=wl(e,l,n,r,o,a,c)
i(t)&&f.push(t)}}if(0===f.length){const t=function(e,t,n,r,o){const i=cD,s=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),a=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),c=Ot(e,ux),l=gl(e,t,i,n,r,o)
return new v5(i,s,a,c,n,[],[],l)}(e,n,r,a,c)
f.push(t)}for(const t of f)Mh(e,t,{id:null,kind:null,softwareType:null,title:null!==(u=t.title)&&void 0!==u?u:"",pageInformation:a,locationTracker:c,targetType:fD}),Oh(c)
return f}function wl(e,t,n,r,a,c,u){const d=f(t,pF),h=f(t,lx),p=f(t,Cq)
if((0,Wv.isNothing)(d)||o(d)||(0,Wv.isNothing)(h)||o(h)||(0,Wv.isNothing)(p)||o(p))return null
const w=Al(e,t,function(e,t){switch(t){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash"
case"DATA_USED_TO_TRACK_YOU":return"systemimage://person.fill.viewfinder"
case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle"
case"DATA_LINKED_TO_YOU":return PP
default:return null}}(0,d)),g=a?vl(e,t,r):[],v=function(e,t,n){const r=l(t,"purposes"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=yl(e,r,n)
i(t)&&o.push(t)}}return o}(e,t,r),m=gl(e,n,d,r,c,u)
return new v5(d,h,p,w,r,v,g,m)}function gl(e,t,n,r,o,i){let s=null
return r!==eH&&r!==fF||(s=Cl(e,t,Tl(e)&&r===eH?fF:pj,o,i,n)),s}function vl(e,t,n){const r=l(t,"dataCategories"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=ml(e,r,n===eH?eH:pj)
i(t)&&o.push(t)}}return o}function ml(e,t,n){const i=f(t,pF),s=f(t,"dataCategory")
if((0,Wv.isNothing)(i)||o(i)||(0,Wv.isNothing)(s)||o(s))return null
const a=Al(e,t,function(e,t){switch(t){case"FINANCIAL_INFO":return"systemimage://creditcard.fill"
case"CONTACT_INFO":return"systemimage://info.circle.fill"
case"OTHER":return"systemimage://ellipsis.circle.fill"
case"SENSITIVE_INFO":return"systemimage://eye.fill"
case SP:return"systemimage://chart.bar.fill"
case"CONTACTS":return PP
case"PURCHASES":return"systemimage://bag.fill"
case"LOCATION":return"systemimage://location.fill"
case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill"
case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill"
case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill"
case"BROWSING_HISTORY":return"systemimage://clock.fill"
case"DIAGNOSTICS":return"systemimage://gearshape.fill"
case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill"
case"BODY":return"systemimage://figure"
case"SURROUNDING":return"systemimage://arkit"
default:return null}}(0,i))
if(r(a))return null
let c=[]
n===pj&&(c=l(t,"dataTypes"))
const u=new m5(i,s,a,n,c)
return i===SP&&(u.prefersSmallArtwork=!0),u}function yl(e,t,n){const r=f(t,pF),i=f(t,"purpose"),s=vl(e,t,n)
return(0,Wv.isNothing)(r)||o(r)||(0,Wv.isNothing)(i)||o(i)||0===s.length?null:new y5(r,i,s)}function Al(e,t,n){let o=null
if((0,Wv.isSome)(n)&&(null==n?void 0:n.length)>0&&(o=Ot(e,n)),r(o)){const n=p(t,oW)
i(n)&&(o=Zd(e,n,{useCase:y6.Default,allowingTransparency:!0}))}return o}function Tl(e){return e.client.deviceType===cW}function bl(e,t,n,a,c,l){return qv.context("createPrivacyHeaderFromData",()=>{const u=function(e,t,n,r,a,c){let l,u=bV
const d=pe(e,t,$H),h=s(d)&&jK.indexOf(d.id)>-1
l=n&&!h?e.loc.string("PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_HEADER_TEMPLATE")
const p=Il(e,t,r,pj,a,c),w=1===p.length&&p[0].identifier===cD||0===p.length
w&&(l=e.loc.string("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"))
const g=j(t,sH)
i(g)?l=l.replace(hF,u$+g+d$):(l=w?e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE"):n?e.loc.string("PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),u=GV)
const v=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK")
l=l.replace("{privacyPolicyLink}",v)
const m=function(e,t,n,r){let i
{const n=Qe(e,t,nN)
if((0,Wv.isNothing)(n)||o(n))return null
i=new GY(n,!1)}return i.title=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),Qs(e,i,{targetType:Mq,id:yP,pageInformation:n,locationTracker:r}),i}(e,t,a,c),y={}
if(i(m)&&(y[v]=m),n){const n=function(e,t,n,r){const i=f(B(t,C$),"managePrivacyChoicesUrl")
if((0,Wv.isNothing)(i)||o(i))return null
const s=new GY(i,!1)
return Qs(e,s,{targetType:Mq,id:"managePrivacyChoices",pageInformation:n,locationTracker:r}),s}(e,t,a,c)
if(i(n)){const t=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK")
l+=mP,l+=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",t),n.title=t,y[t]=n}}const A=new b5(l,u)
return new S5(A,y)}(e,t,n,a,c,l),d=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(AP),a=e.loc.string("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",s),c=Pl(e,o,i)
if(r(c))return null
c.title=s
const l={}
l[s]=c
const u=new b5(a,GV)
return new S5(u,l)}(e,0,n,c,l)
let h,p
n&&(h=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(lD),a=Sl(e,o,i)
let c
const l={}
r(a)?c=e.loc.string(uD):(c=e.loc.string(vP).replace(Oj,s),a.title=s,l[s]=a)
const u=new b5(c,GV)
return new S5(u,l)}(e,0,n,c,l),s(h)&&(p=Sl(e,c,l)))
const w=[]
if(i(d)){const e=new A5(d,void 0)
w.push(e)}if(i(h)){const e=new A5(h,p)
w.push(e)}return new T5(u,n,[],[],w,void 0)})}function Sl(e,t,n){const r=e.bag.appPrivacyLearnMoreEditorialItemId
if((0,Wv.isNothing)(r)||0===r.length)return null
const o=new EY(Tq)
return o.title=e.loc.string(lD),o.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,o,{targetType:hW,id:"privacyLearnMore",pageInformation:t,locationTracker:n}),o}function Pl(e,t,n){const r=e.bag.appPrivacyDefinitionsEditorialItemId
if((0,Wv.isNothing)(r)||0===r.length)return null
const o=new EY(Tq)
return o.title=e.loc.string(AP),o.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,o,{targetType:hW,id:TP,pageInformation:t,locationTracker:n}),o}function Il(e,t,n,r,o,i){var a
let c=[]
const l=B(t,n?C$:S$)
return s(l)&&(c=null!==(a=pl(e,l,t,r,e.client.deviceType!==cW||r===fF,o,i))&&void 0!==a?a:[],1===c.length&&0===c[0].categories.length&&(c[0].style=eH)),c}function Cl(e,t,n,o,a,c){if(r(t.id))return null
const l=new EY(dD)
l.title=e.loc.string(bP),l.pageData=function(e,t,n,r,o){const i=[]
if(e.client.deviceType!==cW||n!==pj){const n=new dJ(cq),s=bl(e,t,!0,!1,r,o)
n.items=[s],n.presentationHints={isFirstShelf:!0},i.push(n)}const s=new pJ(i)
return e.client.deviceType===cW&&n!==pj||(s.isIncomplete=!0),s.title=e.loc.string(cx),s}(e,t,n,o,a)
const u=t.type===Zq?xW.productBundle:xW.product
let d
s(c)&&(d={privacyTypeId:c})
const f=az.fromComponents(OW,null,`/${xW.privacyDetail}/${u}/${t.id}`,d)
l.pageUrl=f.build()
const h={targetType:hW,id:"seeDetails",pageInformation:o,locationTracker:a}
return i(c)&&(h.targetType=fD,h.id=c),Qs(e,l,h),l}function kl(e,t,n){if(!s(t))return null
let r=null
r=(0,Wv.isNothing)(n)?"sr":n
const i=Zd(e,t,{cropCode:r,useCase:y6.ProductPageBadge,allowingTransparency:!0})
return o(i)?null:i}function Ol(e,t,n,r){let o=0
for(const i of t){const t=n[i.key]
if(t){let n
if(Xu(e))n=new cJ(t.shelfId,null,null,void 0,t.index,!0)
else if((0,Wv.isSome)(t.section)){const e=new lJ(t.section,!0)
e.index=t.index,n=e}i.clickAction=n}let s
switch(i.key){case _U:case LH:case wj:case gF:case GN:case vF:case qj:case AD:s=mF
break
default:s=pW}i.clickAction&&Qs(e,i.clickAction,{targetType:iU,id:i.key,idType:Aq,actionType:s,actionDetails:{position:o},pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o+=1}}function El(e,t,n){return new m2(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,{type:"canPerformAppAction",appAction:e,appCapabilities:t})}function Rl(e,t,n,r,o,i,s){return qv.context("createHeaderShelf",()=>{const a=new dJ(tI)
a.presentationHints={isSeeAllContext:r}
const c=e.loc.string("ProductPage.Accessibility.Shelf.Title")
if(!r){a.title=c
const o=Ll(t,n,r)
if((0,Hv.isSome)(o)&&Pi(o)){const r=Ml(e,t,n,hW,i,s)
a.seeAllAction=r}}const l=function(e,t,n,r,o,i){const s=Ll(t,n,r),a=function(e,t,n){const r=e.bag.accessibilityLearnMoreEditorialItemId
if((0,Hv.isNothing)(r))return null
const o=new EY(Tq)
return o.title=e.loc.string(wN),o.pageUrl=`https://apps.apple.com/story/id${r}`,e.clientCapabilities.isEnabled(RD)&&Qs(e,o,{id:oU,targetType:hW,pageInformation:t,locationTracker:n}),o}(e,o,i),c=(0,Yv.attributeAsString)(t,sH),l=(0,Hv.isSome)(c)&&Pi(c)
let u
u=function(e,t,n,r){if(e)return(0,Hv.isSome)(n)&&r?"AccessibilityDetails.Header":r?oI:(0,Hv.isSome)(n)?"AccessibilityDetails.Header.NoDeveloperName":iI
{const e=(0,Hv.isSome)(t)
return e&&Pi(t)?(0,Hv.isSome)(n)?"ProductPage.Accessibility.Header.SupportedFeatures":"ProductPage.Accessibility.Header.SupportedFeatures.NoLearnMoreLink":e?(0,Hv.isSome)(n)?"ProductPage.Accessibility.Header.NoSupportedFeatures":sI:(0,Hv.isSome)(n)?"ProductPage.Accessibility.Header.NoReportedFeatures":aI}}(r,s,a,l)
let d=e.loc.string(u),f=GV
const h={}
if((0,Hv.isSome)(a)){const t=e.loc.string(wN)
d=d.replace(Oj,t),h[t]=a}l&&(d=d.replace(hF,`<b>${c}</b>`),f=bV)
const p=new b5(d,f)
return new S5(p,h)}(e,t,n,r,i,s),u=new C5(l,[])
return(0,Hv.isSome)(o)&&!r&&(o.addImpressionsToShelf(e,a,"accessibilityOverview"),Oh(o.locationTracker)),a.items=[u],a})}function Dl(e,t,n,r,o=null,i,s){return qv.context("createFeaturesShelf",()=>{const a=function(e,t,n,r){const o=Ll(t,n,r)
return(0,Hv.isNothing)(o)?[]:o.reduce((t,n)=>{const r=f(n,pF),o=f(n,Nq),i=f(n,Cq)
if((0,Hv.isNothing)(r)||0===r.length||(0,Hv.isNothing)(o)||0===o.length)return t
const s=function(e){switch(e){case"VOICEOVER":return"voiceover"
case rI:return"voice.control"
case"LARGER_TEXT":return"textformat.size"
case"SUFFICIENT_CONTRAST":return"circle.lefthalf.filled.inverse"
case"DARK_INTERFACE":return"appearance.darkmode"
case"DIFFERENTIATE_WITHOUT_COLOR_ALONE":return"xmark.triangle.circle.square.fill"
case"REDUCED_MOTION":return"circle.dotted.and.circle"
case"CAPTIONS":return"captions.bubble.fill"
case"AUDIO_DESCRIPTIONS":return"quote.bubble.fill"
default:return null}}(r)
if((0,Hv.isNothing)(s))return t
const a=Ot(e,`systemimage://${s}`)
return a.imageScale=function(e){return e===rI?WH:null}(r),t.push(new O5(o,null!=i?i:null,a)),t},[])}(e,t,n,r)
if(Si(a))return null
const c=new dJ(UH)
c.presentationHints={isSeeAllContext:r}
const l=e.loc.string("ProductPage.Accessibility.Card.SupportedFeaturesTitle"),u=new k5(l,Ot(e,"systemimage://accessibility"),a)
return r||((0,Hv.isSome)(o)&&(o.addImpressionsToShelf(e,c,"supportedFeaturesCard",void 0,void 0,null,l),Oh(o.locationTracker)),u.clickAction=Ml(e,t,n,DV,i,s)),c.items=[u],c})}function _l(e,t,n,r,o){return qv.context("createDeveloperLinkShelf",()=>{const i=function(e,t,n,r,o){const i=function(e,t,n,r,o){const i=function(e,t){const n=t?vB:P$
return(0,Yv.attributeAsString)(e,`${n}.developerUrl`)}(t,n)
if((0,Hv.isNothing)(i)||Si(i))return null
const s=new GY(i,!1)
return s.title=e.loc.string("Accessibility.DeveloperUrlLinkActionTitle"),e.clientCapabilities.isEnabled(RD)&&Qs(e,s,{id:"AccessibilitySite",targetType:Mq,pageInformation:r,locationTracker:o}),s}(e,t,n,r,o)
if((0,Hv.isNothing)(i))return null
const s=e.loc.string("Accessibility.DeveloperUrlLinkTitle"),a=e.loc.string("Accessibility.DeveloperUrlText").replace("{accessibilitySite}",s),c={}
c[s]=i
const l=new b5(a,GV)
return new S5(l,c)}(e,t,n,r,o)
if((0,Hv.isNothing)(i))return null
const s=new dJ(tI)
return s.items=[new C5(i,[])],s.presentationHints={isSeeAllContext:n},s})}function Ll(e,t,n){return U(e,`${n?vB:P$}.${t}.supportedCategories`)}function Ml(e,t,n,r,o,i){const s=new EY(vB)
s.title=e.loc.string(bP),s.pageData=function(e,t,n,r,o){const i=[],s=Rl(e,t,n,!0,null,r,o)
i.push(s)
const a=_l(e,t,!0,r,o);(0,Hv.isSome)(a)&&i.push(a)
const c=new pJ(i)
return c.title=e.loc.string(DD),c.isIncomplete=!0,c.presentationOptions=[sj,Ax,nI],c}(e,t,n,o,i)
const a=t.type===Zq?xW.productBundle:xW.product,c=Yv.URL.fromComponents(OW,null,`/${xW.accessibilityDetails}/${a}/${t.id}`,{deviceFamily:n})
return s.pageUrl=c.build(),e.clientCapabilities.isEnabled(RD)&&Qs(e,s,{id:"AccessibilityDetails",targetType:r,pageInformation:o,locationTracker:i}),s}function xl(e,t,n,r,o,i){if(r)return null
const s=Id(e,t)
if((0,Hv.isNothing)(s))return null
const a=new E5(s),c=o?"":e.loc.string("InfoList.Category.Title")
return new R5(c,[a],void 0)}function $l(e,t,n,a,c,l){const u=B(t,eE)
let d=[],f=function(e,t){let n
if(qd(e,t)){const r=Af(0,t,e.appleSilicon.isSupportEnabled),o=!1,i=pf(e,t),s=kf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),a=function(e,t,n,r,o,i=!0){return!!Sf(0,n,r,o).some(e=>Pf(t,e))}(0,i,e.client.deviceType,r,o,s),c=e.loc.deviceDisplayName(e)
a&&c&&(n=e.loc.string("InfoList.Requirements.Summary").replace("{deviceName}",c))}return n}(e,t)
const h=et(e,t,CT,rt(e))
if(s(u)){const t=function(e){const t=[_q,Dq,iN,lW,XV,QG,cW],n=function(e,t,n){let r=null
switch(t){case nW:r=_q
break
case Kq:r=Dq
break
case lW:r=lW
break
case"tv":r=QG
break
case cW:r=cW
break
case Qq:r=XV}return i(n)&&n===iN&&(r=iN),r}(0,e.client.deviceType,e.host.deviceModel)
if(i(n)){const e=t.indexOf(n)
e>0&&(t.splice(e,1),t.unshift(n))}return t}(e)
for(const n of t){const t=p(u,n)
if(s(t)){const r=Fl(0,t,e.appleSilicon.isSupportEnabled&&n===lW&&h&&!e.appleSilicon.isRosettaAvailable)
i(r)&&d.push(r)}}!i(f)&&d.length>0&&(f=d[0].text)}else{const n=function(e,t){const n=Qe(e,t,"requirementsString")
return r(n)?null:new E5(n)}(e,t)
i(n)&&(d=[n])}if(o(d))return null
const w=c?"":e.loc.string("Requirements"),g=new R5(w,d,f)
return 0===g.items_V3.length&&(g.items_V3=Au(0,g)),g}function Fl(e,t,n){var r
const o=null!==(r=f(t,PI))&&void 0!==r?r:void 0
let i=f(t,"requirementString")
const a=l(t,"devices")
if(n){const e=f(t,"rosettaUnavailableRequirementString")
s(e)&&(i=e)}if((0,Hv.isNothing)(i))return null
const c=[]
for(const e of a)c.push("\u2022\t\u2068"+e+"\u2069")
const u=c.length>0?c.join("\n"):void 0
return new E5(i,{heading:o,listText:u})}function Nl(e,t){const n=B(t,"contentRatingsBySystem.appsKorea")
if((0,Hv.isNothing)(n))return null
const r=h(n,zB)
if((0,Hv.isNothing)(r))return null
const o=l(n,DI)[0]
if((0,Hv.isNothing)(o))return null
const i=Bf(0,r),s=[]
return(0,Hv.isSome)(i)&&s.push(Ot(e,`resource://${i}`)),new E5(o,{headingArtworks:s})}function Bl(e,t,n,o,s,a){var c
return null!==(c=function(e,t,n,r,o,i){const s=or(0,t)
if((0,Hv.isNothing)(s))return null
const a=e.loc.string(II),c=Ul(e,a)
let u,d
u=e.loc.string(GD),d=s
const p=new R5(u,[],d,c),w=sr(e,t)
if((0,Hv.isSome)(w)){const t=Ot(e,Et(w),30,30)
p.items_V3.push({$kind:oW,artwork:t})}else p.items_V3.push({$kind:"textEncapsulation",text:s})
let g=""
const v=se(t,nt(e,t),CI),m=h(v,kI),y=h(v,OI);(0,Hv.isSome)(m)&&(0,Hv.isSome)(y)&&(g+=e.loc.string("InfoList.AgeRating.AgeRange").replace(EI,e.loc.decimal(m)).replace(RI,e.loc.decimal(y)))
const A=function(e,t){return j(t,"ageRating.description")}(0,t);(0,Hv.isSome)(A)&&(g.length>0&&(g+="\n"),g+=A)
const T={};(0,Hv.isSome)(c)&&(T[a]=c,g.length>0&&(g+="\n"),g+=a)
const b=new S5(new b5(g,hx),T)
p.items_V3.push({$kind:Xj,linkableText:b})
const S=function(e,t){const n=G(t,lT)
let r=""
for(const e of n){const t=f(e,"level"),n=l(e,"contentDescriptors")
if(0!==n.length){r.length>0&&(r+="\n\n"),r+=`**${t}**`
for(const e of n){const t=f(e,Cq);(0,Hv.isSome)(t)&&(r+="\n",r+=t)}}}if(0===r.length)return
const o=new S5(new b5(r,hx))
return{$kind:Xj,linkableText:o}}(0,t);(0,Hv.isSome)(S)&&(p.items_V3.push({$kind:WB}),p.items_V3.push(S))
const P=function(e,t){return j(t,"ageRating.ageGuidanceUrl")}(0,t)
if((0,Hv.isSome)(P)){const t=new GY(P)
t.title=e.loc.string("InfoList.AgeRating.DeveloperInfo"),p.items_V3.push({$kind:WB}),p.items_V3.push({$kind:hW,action:t})}return p}(e,t))&&void 0!==c?c:function(e,t,n,o,s,a){const c=B(t,"contentRatingsBySystem.appsApple")
if(r(c))return null
const u=f(c,fW)
if(r(u))return null
if(99===h(c,zB))return null
const d=l(c,DI)
let p
const w=se(t,nt(e,t),CI),g=h(w,kI),v=h(w,OI)
p=i(g)&&i(v)?e.loc.string("InfoList.AgeRating.Summary").replace("{ageRating}",u).replace(EI,e.loc.decimal(g)).replace(RI,e.loc.decimal(v)):u
const m=[]
let y,A="";(0,Hv.isSome)(p)&&(A+=p)
for(const e of d)A+="\n",A+=e
m.push(new E5(A))
{const n=Nl(e,t);(0,Hv.isSome)(n)&&m.push(n)
const r=Gl(e,t);(0,Hv.isSome)(r)&&m.push(r)}(m.length>1||m[0].text!==p)&&(y=p)
const T=s?"":e.loc.string(GD),b=e.loc.string(II),S=Ul(e,b)
return new R5(T,m,y,S)}(e,t,0,0,s)}function Ul(e,t){let n
if((0,Hv.isSome)(e.bag.ageRatingLearnMoreEditorialItemId)&&e.bag.ageRatingLearnMoreEditorialItemId.length>0){const r=new EY(Tq)
r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.ageRatingLearnMoreEditorialItemId}`
const o=bi({...Di(e),id:e.bag.ageRatingLearnMoreEditorialItemId})
r.destination=o,n=r}return n}function Gl(e,t){if(e.bag.requireAgeVerification&&function(e,t,n){const r=q(t,"contentRatingsBySystem.appsApple.rank")
if((0,Hv.isNothing)(r))return!1
let o
switch(n){case MI:o=3
break
case _I:o=4
break
case"adultOnly":o=5
break
default:o=1}return r>=o}(0,t,_I)&&function(e,t){var n
const r=null!==(n=we(t,DN))&&void 0!==n?n:[]
for(const e of r)if(f(e,"id")===GK.Games.toString())return!0
return!1}(0,t)){let n
if(t.type===Zq){const r=fe(t,dW)
if(i(r))for(const t of r.data)if(i(j(t,LI))){n=e.loc.string("AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles")
break}}else i(j(t,LI))&&(n=e.loc.string("AgeVerification.ProductPage.Rating.UnsuitableForJuveniles"))
return(0,Hv.isNothing)(n)?null:new E5(n)}return null}function jl(e,t,n,r,o,i){const s=ar(e,e.bag.gameControllerRecommendedRolloutRate),a=lr(e,t)
if(s&&a){const n=o?"":e.loc.string("ProductPage.Info.GameController.Title")
let r
r=a?"ProductPage.Info.GameController.Recommended":"ProductPage.Info.GameController.Required"
const i=e.loc.string(r),s=j(t,sH),c=a?"ProductPage.Info.GameController.Recommended.Summary.v2":"ProductPage.Info.GameController.Required.Summary.v2",l=e.loc.string(c).replace(hF,s),u=[new E5(l)]
let d
const f=e.bag.gameControllerLearnMoreEditorialItemId
if((0,Hv.isSome)(f)&&f.length>0){const t=new EY(Tq),n=a?"ProductPage.Info.GameController.Recommended.LearnMore":"ProductPage.Info.GameController.Required.LearnMore"
t.title=e.loc.string(n),t.pageUrl=`https://apps.apple.com/story/id${f}`,d=t}return new R5(n,u,i,d)}return null}function Vl(e,t,n,r,o,i){const s=Qe(e,t,"copyright")
if((0,Hv.isNothing)(s))return null
const a=new E5(s),c=o?"":e.loc.string("InfoList.Copyright")
return new R5(c,[a])}function Hl(e,t,n,r,i,s){var a
if(!function(e,t){var n
const r=Tf(e,t),o=new Set(["uses-non-webkit-browser-engine","is-custom-browser-engine-app"])
return null!==(n=null==r?void 0:r.some(e=>o.has(e)))&&void 0!==n&&n}(e,t))return null
const c=null!==(a=function(e,t,n){const r=e.bag.externalBrowserLearnMoreEditorialItemId
if(o(r))return null
const i=new EY(Tq)
return i.title=e.loc.string(wN),i.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,i,{id:oU,targetType:Mq,actionType:pW,pageInformation:t,locationTracker:n}),i}(e,s.metricsPageInformation,s.locationTracker))&&void 0!==a?a:void 0
let l=c
const u=i?"":e.loc.string("Annotations.ExternalBrowser.Title"),d=e.loc.string("Annotations.ExternalBrowser.Value.Summary"),f=e.loc.string("Annotations.ExternalBrowser.Value.Expanded"),h=[new E5(f)]
return new R5(u,h,d,l)}function ql(e,t,n,r,o,i){const s=er(e,t),a=tr(e,SI)
if(!s||!a)return null
const c=o?"":e.loc.string("Annotations.ExternalPurchases.Title"),l=e.loc.string("YES")
let u
if((0,Wv.isSome)(e.bag.externalPurchasesProductPageAnnotationVariant)){const t=`Annotations.ExternalPurchases.Expanded.Variant${e.bag.externalPurchasesProductPageAnnotationVariant}`
u=e.loc.string(t)}else u=e.loc.string("Annotations.ExternalPurchases.Expanded")
const d=new E5(u),f=e.loc.string("Annotations.ExternalPurchases.Expanded.LearnMore")
let h=nr(e,f,i.metricsPageInformation,i.locationTracker)
return new R5(c,[d],l,null!=h?h:void 0)}function Wl(e,t,n,r,o,i){const s=(0,Yv.attributeAsDictionary)(t,"licenses.gameLicenseVietnam"),a=[Jl(e.loc.string("InfoList.GameLicense.Disclaimer"))],c=(0,Yv.asString)(s,"licenseId")
if(!(0,Hv.isSome)(c)||!Pi(c))return null
a.push(zl(),Yl(e.loc.string("InfoList.GameLicense.Id.Title")),Jl(c))
const l=(0,Yv.asString)(s,"licenseUrl");(0,Hv.isSome)(l)&&Pi(l)&&a.push(zl(),Yl(e.loc.string("InfoList.GameLicense.Url.Title")),function(e){const t={}
return t[e]=new GY(e,!1),{$kind:Xj,linkableText:new S5(new b5(e),t)}}(l))
const u=o?"":e.loc.string("InfoList.GameLicense.Title"),d=new R5(u,[],c)
return d.items_V3=a,d}function zl(){return{$kind:WB}}function Yl(e){return{$kind:Xj,linkableText:new S5(new b5(`**${e}**`))}}function Jl(e){return{$kind:Xj,linkableText:new S5(new b5(e))}}function Kl(e,t,n,r,o,i){return null}function Zl(e,t,n,r,s,a){var c
const l=Ze(e,t,"languageList")
if(o(l))return null
const u=l.length
if(u<1)return null
let d,f
switch(u){case 0:break
case 1:f=l[0]
break
case 2:f=e.loc.string("InfoList.Two.Languages.Summary").replace("{first}",l[0]).replace("{second}",l[1])
break
default:const t=u-1
d=e.loc.string("InfoList.More.Languages.Summary").replace("{language}",l[0]).replace(CD,e.loc.formattedCount(t)),f=null!==(c=function(e,t){if(null==e||null==t)return null
if(0===e.length)return""
let n=e.length,r=""
return e.forEach((e,o)=>{null===e?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(l,e.loc.string("Conjunction.Separator")))&&void 0!==c?c:void 0}if(!i(f))return null
const h=new E5(f),p=s?"":e.loc.string("Supported.Languages")
return new R5(p,[h],d)}function Ql(e,t,n,r,o,i){if(!H(t,"usesLocationBackgroundMode"))return null
const s=o?"":e.loc.string("InfoList.Location.Title"),a=e.loc.string("InfoList.Location.Description"),c=new E5(a)
return new R5(s,[c])}function Xl(e,t,n,r,o,i){const s=(0,Yv.attributeAsDictionary)(t,zP)
if((0,Hv.isNothing)(s)||(0,Hv.isNothing)(e.bag.medicalDeviceComplianceStatementRegion)||Si(e.bag.medicalDeviceComplianceStatementRegion))return null
const a=[],c=j(t,sH)
if((0,Hv.isSome)(c)&&Pi(c)){const t=`InfoList.MedicalDevice.Compliance.Statement.${e.bag.medicalDeviceComplianceStatementRegion}`,n=e.loc.string(t).replace(hF,`**${c}**`)
a.push(nu(n))}const l=e.loc.string("InfoList.MedicalDevice.Disclaimer")
eu(a),a.push(nu(l))
const u=(0,Yv.asString)(s,"manufacturerSRN");(0,Hv.isSome)(u)&&Pi(u)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.ManufacturerSRN.Title")),nu(u)))
const d=(0,Yv.asString)(s,"fdaNumber");(0,Hv.isSome)(d)&&Pi(d)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.FDANumber.Title")),nu(d)))
const f=(0,Yv.asDictionary)(s,"sellerContactInfo"),h=(0,Yv.asString)(f,"address");(0,Hv.isSome)(h)&&Pi(h)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.Address.Title")),nu(h)))
const p=(0,Yv.asString)(f,"phoneNumber");(0,Hv.isSome)(p)&&Pi(p)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.PhoneNumber.Title")),nu(p)))
const w=(0,Yv.asString)(f,"email");(0,Hv.isSome)(w)&&Pi(w)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.Email.Title")),nu(w)))
const g=(0,Yv.asString)(s,"useStatement");(0,Hv.isSome)(g)&&Pi(g)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.UseStatement.Title")),nu(g)))
const v=(0,Yv.asString)(s,"safetyInfo");(0,Hv.isSome)(v)&&Pi(v)&&(eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.SafetyInfo.Title")),nu(v)))
const m=(0,Yv.asString)(s,"instructionsForUseUrl")
if((0,Hv.isSome)(m)&&Pi(m)){eu(a),a.push(tu(e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Title")))
{const t=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.Hyperlink"),n=e.loc.string("InfoList.MedicalDevice.InstructionsUrl.Subtitle.FullText").replace("{externalLink}",t),r=new b5(n),o={}
o[t]=new GY(m,!1)
const i=new S5(r,o)
a.push({$kind:Xj,linkableText:i})}}if(0===a.length)return null
const y=o?"":e.loc.string("InfoList.MedicalDevice.Title"),A=new R5(y,[],"Yes")
return A.items_V3=a,A}function eu(e){e.length>0&&e.push({$kind:WB})}function tu(e){return{$kind:Xj,linkableText:new S5(new b5(`**${e}**`))}}function nu(e){return{$kind:Xj,linkableText:new S5(new b5(e))}}function ru(e){var t
return{platform:null===(t=e.activeIntent)||void 0===t?void 0:t.previewPlatform}}function ou(e,t){var n
return(null===(n=e.activeIntent)||void 0===n?void 0:n.previewPlatform)?t.addingQuery("previewPlatform",e.activeIntent.platform).addingQuery(YV,LV):t}function iu(e,t){const n={...t,id:`id${t.id}`}
return t.platform?L5(e,n):x5(e,n)}function su(e,t,n,r,o){return qv.context("capabilitiesFromData",()=>[au(e,t,r,o),cu(e,t),hu(e,t),lu(e,t),uu(e,t),du(e,t,n),null,fu(e,t)].filter(e=>e))}function au(e,t,n,r){if(!(0,Hv.isSome)(t)||!et(e,t,IB))return null
if(e.bag.gameCenterExtendSupportedFeatures){const o=function(e){var t
if(!(0,Wv.isNothing)(e))return null!==(t=$(e,"supportedGameCenterFeaturesFromData",()=>{const t=[],n=l(e,"attributes.supportedGameCenterFeatures")
return n.includes(Hq)&&t.push(Hq),n.includes(HV)&&t.push(HV),n.includes(NH)&&t.push(NH),n.includes(lN)&&t.push(lN),t}))&&void 0!==t?t:void 0}(t),i=null==o?void 0:o.includes(NH),s=null==o?void 0:o.includes(Hq)
let a
a=i&&s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ALL_FEATURES"):i?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_LEADERBOARDS"):s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_ACHIEVEMENTS"):e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_NO_FEATURES")
const c=e.loc.string(YT),u=Ot(e,JT,46,45)
{let o
o=(0,Hv.isSome)(t)&&e.clientCapabilities.isEnabled("gameProductIdOpenGamesUIAction")?ro({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r,target:{gamePage:{productID:t.id}}}):ro({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r})
const i=e.loc.string("ProductPage.Capability.GameCenter.ActionTitle")
a=`${a}\n${i}`
const s=new b5(a),l={}
l[i]=o
const d=new S5(s,l),f=Ot(e,"systemimage://arrow.up.forward.square.fill",16,16)
return new D5(OV,c,d,f,void 0,u)}}{const t=e.loc.string(YT),n=new b5(e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION")),r=new S5(n),o=Ot(e,JT,46,45)
return new D5(OV,t,r,void 0,null,o)}}function cu(e,t){if(!et(e,t,"isSiriSupported"))return null
const n=e.loc.string("CAPABILITY_SIRI_TITLE"),r=new b5(e.loc.string("CAPABILITY_SIRI_EXPLANATION")),o=new S5(r),i=Ot(e,"resource://ProductCapabilitySiri",46,45)
return new D5(CE,n,o,void 0,null,i)}function lu(e,t){if(!et(e,t,"supportsPassbook"))return null
const n=e.loc.string("CAPABILITY_WALLET_TITLE"),r=new b5(e.loc.string("CAPABILITY_WALLET_EXPLANATION")),o=new S5(r),i=Ot(e,"resource://ProductCapabilityWallet",46,45)
return new D5("wallet",n,o,void 0,null,i)}function uu(e,t){if(!cr(e,t))return null
const n=e.loc.string("CAPABILITY_MFI_CONTROLLERS_TITLE")
let r=null
const o=e.bag.gameControllerLearnMoreEditorialItemId
if(ar(e,e.bag.gameControllerRecommendedRolloutRate)&&(0,Hv.isSome)(o)&&(null==o?void 0:o.length)>0){const t=bi({...Di(e),...ru(e),id:o})
r=new EY(Tq),r.title=e.loc.string("ProductPage.Capability.GameController.ActionTitle"),r.pageUrl=iu(e,t)}let i=r?e.loc.string("ProductPage.Capability.GameController.Explanation.v2.WithNewlineActionTemplate"):e.loc.string("ProductPage.Capability.GameController.Explanation.v2")
const s={};(null==r?void 0:r.title)&&(i=i.replace(Oj,r.title),s[r.title]=r)
const a=new b5(i),c=new S5(a,s),l=Ot(e,"resource://ProductCapabilityController",46,45)
return new D5("controllers",n,c,void 0,null,l)}function du(e,t,n){const r=j(t,"familyShareEnabledDate")
if(!r||H(t,eG))return null
const o=new Date(r),i=new Date
if(!o||o>i)return null
const s=et(e,t,kE),a=s&&et(e,t,"hasFamilyShareableInAppPurchases")
let c=null
const l=e.bag.familySubscriptionsLearnMoreEditorialItemId
if((0,Hv.isSome)(l)&&(null==l?void 0:l.length)>0&&a){const t=bi({...Di(e),...ru(e),id:l})
c=new EY(Tq),c.title=e.loc.string("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),c.pageUrl=iu(e,t)}const u=e.loc.string("CAPABILITY_FAMILY_SHARING_TITLE")
let d
if(a?d=c?"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION":s||n||(d=c?"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION"),!d)return null
let f=e.loc.string(d)
const h={};(null==c?void 0:c.title)&&(f=f.replace(Oj,c.title),h[c.title]=c)
const p=new b5(f),w=new S5(p,h),g=Ot(e,"resource://ProductCapabilityFamilySharing",46,45)
return new D5(AL,u,w,void 0,c,g)}function fu(e,t){if(!et(e,t,"hasSafariExtension"))return null
const n=e.loc.string("CAPABILITY_SAFARI_EXTENSION_TITLE"),r=new b5(e.loc.string("CAPABILITY_SAFARI_EXTENSION_EXPLANATION")),o=new S5(r),i=Ot(e,"resource://ProductCapabilitySafariExtension",129,129)
return new D5(KT,n,o,void 0,null,i)}function hu(e,t){if(!et(e,t,xO))return null
const n=e.loc.string("CAPABILITY_SHAREPLAY_TITLE"),r=new b5(e.loc.string("CAPABILITY_SHAREPLAY_EXPLANATION")),o=new S5(r),i=Ot(e,"systemimage://shareplay"),s=Se(OE)
return new D5("sharePlay",n,o,void 0,null,i,s)}function pu(e,t,n,r,o,i){if(r)return null
const s=Qe(e,t,"seller"),a=Ke(e,t,gB),c=Ke(e,t,nE),l=e.bag.enableSellerICPAnnotation&&!0
if((0,Hv.isNothing)(s))return null
const u=Qe(e,t,"sellerLabel")||e.loc.string(xI)
let d,h=[]
const p=f(a,fW),w=(0,Hv.isSome)(p)&&(null==p?void 0:p.length)>0?p:s,g=o?"":u
let m=null
if((0,Hv.isSome)(a)){const[t,n]=function(e,t){const n=[],r={name:"ProductPage.SellerInfo.Name.Title",dunsNumber:"ProductPage.SellerInfo.DunsNumber.Title",address:"ProductPage.SellerInfo.Address.Title",brn:"ProductPage.SellerInfo.BusinessRegistrationNumber.Title",phoneNumber:"ProductPage.SellerInfo.PhoneNumber.Title",email:"ProductPage.SellerInfo.Email.Title",usci:"ProductPage.SellerInfo.UnifiedSocialCreditIdentifier.Title"},o=f(t,fW),i=(0,Hv.isSome)(o)&&(null==o?void 0:o.length)>0?o:e.loc.string(xI),s=(0,Hv.isSome)(f(t,$I))
if(s){const r=v(t,$I),o=r?"ProductPage.SellerInfo.VerifiedSeller.Subtitle":"ProductPage.SellerInfo.UnverifiedSeller.Subtitle"
if(n.push(new E5(e.loc.string(o).replace("{seller}",i))),!r)return[n,i]}let a=null
1!==Object.keys(t).length||Object.keys(t).includes(fW)||(a=e.loc.string("ProductPage.SellerInfo.SeeDetails.Title"))
for(const[o,i]of Object.entries(r)){if(o===fW&&s)continue
const r=wu(e,o,e.loc.string(i),t);(0,Hv.isSome)(r)&&n.push(r)}return[n,a]}(e,a)
m=n,h=h.concat(t)}if(l&&(0,Hv.isSome)(c)){const t=wu(e,"filingNumber",e.loc.string("ProductPage.Info.ICPNumber.Title"),c)
if(0===h.length){const e=new E5(w)
h.push(e)}(0,Hv.isSome)(t)&&h.push(t)}if(h.length>0)(0,Hv.isNothing)(m)&&(m=h.length>1?w:void 0),d=new R5(g,h,m,void 0)
else{const e=new E5(s)
d=new R5(g,[e])}return(0,Hv.isSome)(d),d}function wu(e,t,n,r){let o=f(r,t)
return(0,Hv.isSome)(o)?("brn"===t&&(o=o+"\n"+e.loc.string("ProductPage.SellerInfo.BusinessRegistrationNumber.Subtitle")),new E5(o,{heading:n})):null}function gu(e,t,n,o,s,a){const c=Rf(e,t)
if(n||r(c)||r(c.fileSizeByDevice))return null
const l=e.loc.fileSize(c.fileSizeByDevice),u=s?"":e.loc.string("File.Size")
let d,f=c.fileSizeByDevice
if(i(c.maxEssentialInstallSizeInBytes)){const t=c.fileSizeByDevice+c.maxEssentialInstallSizeInBytes,n=e.loc.string(jD).replace(VD,e.loc.fileSize(t)),r=new E5(n)
d=new R5(u,[r],void 0)}else if(i(c.maxInstallSizeInBytes)){const t=[],n=new E5(l,{heading:e.loc.string("Initial.App.Size")})
t.push(n)
const r=e.loc.string(jD).replace(VD,e.loc.fileSize(c.maxInstallSizeInBytes)),o=new E5(r,{heading:e.loc.string("Additional.Content.After.App.Install")})
t.push(o),f+=c.maxInstallSizeInBytes
const i=e.loc.string(jD).replace(VD,e.loc.fileSize(f))
d=new R5(u,t,i)}else{const e=new E5(l)
d=new R5(u,[e],void 0)}return d}function vu(e,t,n,r,o,i){return null}function mu(e,t,n,r,o,i){const s=ge(t,BL)
if((0,Hv.isNothing)(s)||Si(s))return null
const a=[],c=[]
for(const t of s){const n=j(t,fW)
if((0,Hv.isNothing)(n))continue
const r=wr(e,t)
if((0,Hv.isNothing)(r))continue
const o=f(r,nj)
if((0,Hv.isNothing)(o))continue
const i=f(r,iG),s=h(r,sG)
let l=e.loc.string("InfoList.IAP.Duration")
if((0,Hv.isSome)(i)){l=l.replace("{name}",n)
const t=Ho(0,i,s)
let r
switch(null==t?void 0:t.type){case"D":r="days"
break
case"W":r="weeks"
break
case"M":r="months"
break
case"Y":r="years"
break
default:l=`${n}`}if((0,Hv.isSome)(r)&&(0,Hv.isSome)(t)){const n=e.loc.formatDuration(t.periodDuration,r);(0,Hv.isSome)(n)&&(l=l.replace("{duration}",n))}}else l=`${n}`
a.push([l,o]),c.push({$kind:bI,leadingText:l,trailingText:o})}const l=e.loc.string("ProductPage.Info.InAppPurchases.LearnMore"),u=function(e,t){const n=e.bag.inAppPurchasesLearnMoreEditorialItemId
if((0,Hv.isNothing)(n)||Si(n))return null
const r=new EY(Tq)
return r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.inAppPurchasesLearnMoreEditorialItemId}`,r}(e,l)
if((0,Hv.isSome)(u)){c.push({$kind:WB,size:WH})
const e={}
e[l]=u,c.push({$kind:Xj,linkableText:new S5(new b5(l),e)})}const d=o?"":e.loc.string("InfoList.InAppPurchases"),p=[new E5(void 0,{textPairs:a})],w=new R5(d,p,e.loc.string("YES"))
return w.items_V3=c,w}function yu(e,t,n,r,o,i,s,a){const c=[]
for(const l of t){const t=l(e,n,r,o,i,s);(0,Hv.isSome)(t)&&(0===t.items_V3.length&&(t.items_V3=Au(0,t)),t.expandAction=void 0,c.push(t),a&&a(l,t,c.length-1))}return c}function Au(e,t){const n=[]
for(const e of t.items){if(n.length>0&&n.push({$kind:WB}),(0,Hv.isSome)(e.headingArtworks))for(const t of e.headingArtworks)n.push({$kind:oW,artwork:t})
let t=""
if((0,Hv.isSome)(e.heading)&&(t+=`**${e.heading}**`),(0,Hv.isSome)(e.text)&&(t.length>0&&(t+="\n"),t+=e.text),(0,Hv.isSome)(e.listText)&&(t.length>0&&(t+="\n"),t+=e.listText),t.length>0&&n.push({$kind:Xj,linkableText:new S5(new b5(t,hx))}),(0,Hv.isSome)(e.textPairs))for(const t of e.textPairs)n.push({$kind:bI,leadingText:t[0],trailingText:t[1]})}return(0,Hv.isSome)(t.linkAction)&&n.push({$kind:hW,action:t.linkAction}),n}function Tu(e,t){const n=Ke(e,t,nE),r=e.bag.enableSellerICPAnnotation&&(0,Hv.isSome)(n),o=Ke(e,t,gB),i=e.bag.enableSellerInfo&&(0,Hv.isSome)(o)
return r||i}function bu(e,t,n,r){const o=new dJ(dI)
o.isHorizontal=!0
let i=null
i=n?t.slice(0,8):t
const a=[]
for(let t=0;t<i.length;t++){const n=i[t]
if(n.action=new CX({player:{playerID:n.playerId}}),s(r)){const o="friendPlayer",i={pageInformation:r.destinationPageInformation,locationTracker:r.sourceLocationTracker,id:"",idType:Aq,anonymizationOptions:{anonymizationString:`FRIEND${t+1}`}}
if(Mh(e,n,{...i,kind:o,title:"",softwareType:null}),e.bag.productPageFriendsPlayingClickEventsEnabled){const t={...i,kind:o,targetType:tW,actionType:pW,softwareType:null}
Qs(e,n.action,t)}}a.push(n),s(r)&&Oh(r.sourceLocationTracker)}if(o.items=a,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=OV,n&&t.length>8){const n=new dJ("smallGameCenterPlayer")
n.title=e.loc.stringWithCount("ProductPage.FriendsPlaying.SeeAllTitle",t.length),n.items=t.map(e=>(e.action=new Z5(e.playerId),e)),n.rowsPerColumn=1
const i=new pJ([n])
i.title=null==r?void 0:r.title
const s=new EY(wW)
s.title=e.loc.string(cH),s.pageData=i,o.seeAllAction=s}return s(r)&&(Mh(e,o,{id:"",kind:null,softwareType:null,targetType:dq,title:r.title,pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker,idType:Aq,badges:{gameCenter:!0}}),o.footerTitle=e.loc.string(G$),o.footerAction=ro({objectGraph:e,target:{friends:{}},metricsPageInformation:null==r?void 0:r.sourcePageInformation,metricsLocationTracker:null==r?void 0:r.sourceLocationTracker}),o.footerStyle={$kind:QH,bundleID:EN,width:16,height:16}),o}async function Su(e,t,n,i){return await Va("inAppPurchasesShelf",async()=>{var a
if(!function(e,t){return t!==jV&&!e.client.isCompanionVisionApp}(e,e.host.platform))return null
if(o(t))return null
let c
if(c=ii(e)?he(t,QO):fe(t,jL),(0,Hv.isNothing)(c)||0===c.data.length)return null
if(0===c.data.filter(function(e){return H(e,RM)===i.isForSubscriptions}).length)return null
const l={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:dq,id:`${n.getSequenceId()}`,idType:Aq},u=sN,d=new dJ(u),f=V(t,wq)?XB:BH,h=Qe(e,t,yq),p=null===(a=i.options)||void 0===a?void 0:a.spotlightInAppProductIdentifier
!function(e,t,n){const o=Jq
for(const e of n.data){let n=fe(e,o)
n||(n={data:[t]}),r(e.relationships)&&(e.relationships={}),e.relationships[o]=n}}(0,t,c)
const w=[],g=function(e,t,n,r,o,i){const s=$d(e,t,{lockupOptions:{metricsOptions:r,offerStyle:n,skipDefaultClickAction:!0,artworkUseCase:y6.LockupIconSmall},contentUnavailable:function(e,t){return w.push(t),!1}})
return o&&Jh(0,o,s),s}(e,c.data,f,l,p).filter(function(e){return e.productIdentifier===p&&(i.options.spotlightSection=new s1(vW,i.isForSubscriptions?$j:xj)),e.isSubscription===i.isForSubscriptions})
if(0===g.length&&0===w.length)return null
if(d.items=await async function(e,t,n,r){if((0,Hv.isNothing)(n))return t
const o=[],i=[]
for(const e of t){const t=e.productIdentifier
o.push(t),e.isVisibleByDefault&&i.push(t)}const s=await M(e.clientOrdering.orderedVisibleIAPs(n,o,i,r))
return s.success?function(e,t){const n={}
for(const t of e)n[t.productIdentifier]=t
const r=[]
for(const e of t){const t=n[e]
if(t){const e=S(t)
r.push(e)}}return r}(t,s.value):t}(e,g,h,p),s(w)){const e=new v3(t.id,w,d.title,!1,void 0,u,f,null)
e.appBundleId=h,e.iapShelfContext=i,i.isForSubscriptions?e.inAppShelfId=$j:e.inAppShelfId=xj,d.url=qh(0,e,n)}let v
return i.isForSubscriptions?(d.title=e.loc.string("ProductPage.Section.Subscriptions.Title","Subscriptions"),v="subscription"):(d.title=e.loc.string("ProductPage.Section.InAppPurchases.Title"),v="iAP"),bh(e,l,d.title),Ph(n.locationTracker),Oh(n.locationTracker),d.isHorizontal=!0,n.addImpressionsToShelf(e,d,v),d})}function Pu(e,t,n,r,s,a){return qv.context(hj,()=>o(t)?null:function(e,t,n,r,o){return qv.context("standardLinksShelf",()=>{const s=new dJ("productPageLink"),{metricsPageInformation:a,locationTracker:c}=n,l=[]
if(e.client.deviceType!==lW){const n=Qe(e,t,NL)
if(n){const t=new GY(n,!1),r=e.loc.string("DEVELOPER_WEBSITE")
l.push(new V5(r,t,H5))}}const u=Qe(e,t,nN)
if(u){const t=new GY(u,!1),n=e.loc.string(Tx)
l.push(new V5(n,t,q5))}if(V(t,fI)){const n=function(e,t){const n=t.id,r=t.type
return i(t)&&i(n)&&i(r)?`${OW}:/${xW.eula}?resourceType=${r}&resourceId=${n}`:null}(0,t)
if(n){const t=new EY(wW)
t.pageUrl=n
const r=e.loc.string(TF)
l.push(new V5(r,t,W5))}}const d=f(Ke(e,t,gB),MD)
if((null==d?void 0:d.length)>0){const t=new GY(d,!1),n=e.loc.string(bx)
l.push(new V5(n,t,J5))}const h=e.bag.productPageReportProblemSADSubscriptionArray,p=t.id,w=h.includes(p),g=st(e).isSystemAppFromData(t),v=t.type===Zq,m=r&&!g,y=e.bag.productPageReportProblemSecondPartyAppArray.includes(p)
if(!v&&!y&&!o&&e.bag.reportProblemEnabled&&(w||m)){const n=function(e,t){const n=t.id,r=e.bag.productPageReportProblemURL
return i(n)&&i(r)?r.replace("{productId}",n):null}(e,t)
if((null==n?void 0:n.length)>0){const t=new GY(n,!1),r=e.loc.string(hb),o=new V5(r,t,Y5,w?null:p)
l.push(o)}}return l&&l.length>0&&(s.items=l),n.addImpressionsToShelf(e,s,RN),s})}(e,t,n,r,a))}function Iu(e,t,n,i){const s=Id(e,t)
if(o(s))return null
const a=e.loc.string("BADGE_CATEGORY_HEADING"),c=new X5(oW,qj,{},aW,a,s,null,s,a,BH)
if(new EY(wW).title=j(t,sH),n&&"tv"!==e.client.deviceType){const n=Sn(e,t,!0)
if(r(n))return null
c.artwork=kl(e,n,"bb")}return c}function Cu(e,t,n,r){const o=Ke(e,t,TD)
if(o){const t=$f(0,e.host.clientIdentifier)
if(t){const n=p(o,t)
if(n){const t=h(n,GM),r=f(n,HP),o=f(n,PH),i=f(n,aq),s=e.loc.string("BADGE_CHART_POSITION_HEADING"),a=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",t.toString()),c=new X5(px,px,{position:e.loc.decimal(t)},aW,s,r,null,a,r,mV),l=xf(e,o,i)
if((0,Wv.isSome)(l)){const e=new EY(dG)
e.pageUrl=l,c.clickAction=e}return c}}}return null}function ku(e,t,n,r){var o
return null!==(o=function(e,t,n,r){const o=or(0,t)
if((0,Hv.isNothing)(o))return null
let i
i=n?function(e,t){const n=G(t,lT)
for(const e of n)if("IAC"===f(e,DH))return!0
return!1}(0,t)?e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon.InAppControls"):e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon"):e.loc.string("ProductPage.Badge.AgeRating.Caption")
const s=e.loc.string("ProductPage.Badge.AgeRating.Heading"),a=e.loc.string("ProductPage.Badge.AgeRating.AX.Caption"),c=sr(e,t),l=(0,Hv.isSome)(c)?oW:_U,u=new X5(l,_U,{contentRating:o},aW,s,i,void 0,o,a,mV)
return(0,Hv.isSome)(c)&&(u.isMonochrome=!1,u.artwork=Ot(e,Et(c),26,26)),u}(e,t,n))&&void 0!==o?o:function(e,t,n,r){const o=j(t,aT)
if((0,Hv.isNothing)(o))return null
const i={contentRating:o},s=q(t,"contentRatingsBySystem.appsBrazil.rank"),a=Bf(0,null!=s?s:void 0)
let c
a&&(i.contentRatingResource=a),c=n?e.loc.string(qP):e.loc.string(WP)
const l=e.loc.string("BADGE_AGE_RATING_HEADING"),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE")
return new X5(_U,_U,i,aW,l,c,void 0,o,u,mV)}(e,t,n)}function Ou(e,t,n,r){return function(e,t,n,r){if(lr(e,t)){let t,n
t=e.loc.string(wx),n=e.loc.string("ProductPage.Badge.GameController.Recommended")
const r=new X5(Ru(e),vF,{},aW,t,n,void 0,void 0,n,mV)
return r.artwork=Du(e),r.clickAction=Xu(e)?new cJ(fq):new lJ(new uJ(vW,fq)),r}return null}(e,t)}function Eu(e,t,n,r){return function(e,t,n,r){if(!cr(e,t)||function(e,t){switch(ur(e,t)){case Xx:case mL:case vL:return!0
default:return!1}}(e,t)||lr(e,t)||function(e,t){return"REQUIRED"===dr(e)}(e))return null
{let t,n
t=e.loc.string(wx),n=e.loc.string(jB)
const r=new X5(Ru(e),vF,{},aW,t,n,void 0,void 0,n,mV)
return r.artwork=Du(e),r.clickAction=Xu(e)?new cJ(fq):new lJ(new uJ(vW,fq)),r}}(e,t)}function Ru(e){return e.clientCapabilities.isEnabled("artworkControllerBadge")?oW:vF}function Du(e){const t=Ot(e,HN)
return t.imageScale=WH,t}function _u(e,t,n,o){const s=pe(e,t,$H),a=e.loc.string("BADGE_DEVELOPER_HEADING"),c=j(t,sH),l=new X5(oW,$H,{},aW,a,c,null,c,a,BH)
if(n&&"tv"!==e.client.deviceType){const t=Sn(e,s,!0)
r(t)?l.artwork=Ot(e,gx,26,26):l.artwork=kl(e,t)}const u=Mf(0,s)
if(i(u)){const n=new EY(wW)
n.title=j(t,sH),n.pageUrl=u,s&&(n.destination=function({id:e,...t}){return{...t,id:dt(e),$kind:e6}}({...Di(e),id:s.id})),Qs(e,n,{targetType:tq,id:s.id,actionType:pW,pageInformation:o.pageInformation,locationTracker:o.locationTracker}),l.clickAction=n}return l}function Lu(e,t,n,r){const o=Ke(e,t,TG)
if(o){const r=f(o,OM)
if(r&&r===EM){let r,o
r=G(t,hR)[0]===lG?e.loc.string("EDITORIAL_BADGE_GAMES"):e.loc.string("EDITORIAL_BADGE_APPS"),o=n?e.loc.string("EDITORS_CHOICE_RIBBON_HEADING"):e.loc.string("EDITORS_CHOICE_SINGLE_LINE")
const i=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),s=new X5(LH,LH,{},aW,o,r,null,i,r)
return Xu(e)?s.clickAction=new cJ(LH):s.clickAction=new lJ(new uJ(vW,Fq)),s}}return null}function Mu(e,t,r,o){const i=Ze(e,t,"supportedLocales"),s=(a=i).length<=0?null:{tag:f(n(a,"0.tag")).split("-")[0].toUpperCase(),name:f(n(a,"0.name"))}
var a
if(!s)return null
const c={paragraphText:s.tag}
let l
const u=i.length-1
l=u>0?e.loc.stringWithCount("ProductPage.Badge.Language.Caption",u).replace("{number_other_languages}",e.loc.formattedCount(u)):s.name
const d=e.loc.string("BADGE_LANGUAGE_HEADING")
return new X5(Nj,gF,c,aW,d,l,null,null,l,mV)}function xu(e,t,n,r){const o=(0,Yv.attributeAsDictionary)(t,zP)
if(!(0,Hv.isSome)(o))return null
const i=e.loc.string("ProductPage.Badge.MedicalDevice.Heading"),s=e.loc.string("ProductPage.Badge.MedicalDevice.Label"),a=new X5(oW,AD,{},aW,i,s,null,s,i,BH)
return n&&(a.artwork=Ot(e,"systemimage://waveform.path.ecg.rectangle")),a}function $u(e,t,n,r){const o=tt(e,t,iB),s=tt(e,t,sB)
if(!i(o)||!i(s))return null
if(o<=0||s<=0||o>s)return null
const a=e.loc.string(YP),c=Nu(e,o,s,!1),l=Nu(e,o,s,!0),u=e.loc.string(YP),d={paragraphText:Fu(e,o,s)}
return new X5(Nj,gH,d,aW,a,c,null,l,u,mV)}function Fu(e,t,n){return t===n?t<=32?e.loc.formattedCount(t):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(SD,e.loc.formattedCount(32)):n<=32?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(SD,e.loc.formattedCount(t)).replace(JP,e.loc.formattedCount(n)):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(SD,e.loc.formattedCount(t)).replace(JP,e.loc.formattedCount(32))}function Nu(e,t,n,r){return 1===t&&1===n?e.loc.string("BADGE_PLAYERS_CAPTION_SINGLE"):1===t||r?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER"):e.loc.string("BADGE_PLAYERS_CAPTION_REQUIRED")}function Bu(e,t,n,r){const o=B(t,VB)
let i=null
const s=la(e,t)
if(!s&&o&&o.value&&o.ratingCount){const t=h(o,ID),n=Math.round(10*t)/10,r=e.loc.decimal(n,1),s=h(o,$P),a=e.loc.formattedCount(s)
let c
c=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.ShortTemplate",s).replace(CD,a)
const l=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.LongTemplate",s).replace(CD,a).replace("{rating}",r),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",r)
i=new X5(wj,wj,{rating:n,ratingFormatted:r},aW,c,c,l,u,c)}else{if(n)return null
const t=e.loc.string(KP)
if(s&&t!==KP)i=new X5(wj,wj,{},aW,null,t,null,t)
else if(!s){const t=e.loc.string("BADGE_NOT_ENOUGH_RATINGS_CAPTION")
i=new X5(wj,wj,{},aW,null,t,null,t)}}if(i){let t
return t=new cJ(EH),i.clickAction=Xu(e)?t:new lJ(new uJ(vW,Fq)),i}return null}function Uu(e,t,n,r){if((0,Hv.isSome)(B(t,Eq)))return null
const o=q(t,"contentRatingsBySystem.appsAustralia.rank"),i=j(t,"contentRatingsBySystem.appsAustralia.name")
if((0,Hv.isSome)(o)&&(0,Hv.isSome)(i))return Gu(e,n,"AU",o,i,!1)
const s=q(t,"contentRatingsBySystem.appsFrance.rank"),a=j(t,"contentRatingsBySystem.appsFrance.name")
if((0,Hv.isSome)(s)&&(0,Hv.isSome)(a))return Gu(e,n,"FR",s,a,!1)
const c=q(t,"contentRatingsBySystem.appsKorea.rank"),l=j(t,"contentRatingsBySystem.appsKorea.name")
return(0,Hv.isSome)(c)&&(0,Hv.isSome)(l)?Gu(e,n,"KR",c,l,!0):null}function Gu(e,t,n,r,o,i){const s=null===(c=Ff(0,r))||void 0===c?void 0:c[0],a=Bf(0,r)
var c
if((0,Hv.isNothing)(a)||(0,Hv.isNothing)(s))return null
const l=oW,u=ZP,d={contentRating:s},f=aW,h=e.loc.string(`ProductPage.Badge.AgeRating.${n}.Heading`)
let p,w
p=t?e.loc.string(qP):e.loc.string(WP),w=o
const g=e.loc.string(`ProductPage.Badge.AgeRating.${n}.AX.Caption`),v=new X5(l,u,d,f,h,p,void 0,w,g,mV)
return v.isMonochrome=!i,v.artwork=Ot(e,`resource://${a}`,26,26),v}function ju(e,t,n,r){return t?qv.context("badgesFromLookupResponse",()=>{let o,i=!1
return H(t,wq)?o=t6:n?(o=r6,-1===o.indexOf(Lu)&&o.splice(1,0,Lu),i=!0):o=n6,function(e,t,n,r,o,i){const s=[]
for(const o of t){const t=o(e,n,r,i)
t&&s.push(t)}if(o&&s.some(e=>e.key===px)){const e=s.findIndex(e=>e.key===qj)
e>=0&&s.splice(e,1)}return s}(e,o,t,n,i,r)}):[]}function Vu(e,t,n,r,o,i){return qv.context(pI,()=>i?null:Sa(e,t.id,o,n,null))}function Hu(e,t){const n=f(t,yD)
if(n){const t=new GY(n,!1)
return t.title=e.loc.string(FP),t.artwork=Ot(e,_O),t}return null}function qu(e){var t
if((0,Hv.isSome)(e)){const n=null!==(t=e.presentationHints)&&void 0!==t?t:{}
e.presentationHints={...n,isSeeAllContext:!0}}}function Wu(e,t,n,r,o){const i=`${OW}:/${xW.product}/${xW.shelf}/`+Wh(n,r,o),s=new az(i)
return s.param(zW.shelfRefreshType,rz),s.param(zW.id,t),s.build()}function zu(e){return e.featureFlags.isEnabled(RJ)}function Yu(e,t){return t?t.map(t=>Ju(e,t,yI)):[]}function Ju(e,t,n){return qv.context("titledParagraphFromVersionHistoryEntry",()=>{let r=f(t,AI);(0,Hv.isSome)(r)&&(r=r.trim())
const o=new c6(r,n),i=f(t,BD),s=e.loc.string("VERSION_STRING_TEMPLATE")
o.primarySubtitle=n===yI?i:s.replace("{version}",i)
const a=f(t,"releaseTimestamp")
if(a){const t=new Date(a)
o.secondarySubtitle=e.loc.relativeDate(t)}return o})}async function Ku(e,t,n,a,c,l=!1){return await Va("createProductPageFromResponse",async()=>{var d
const p=yt(e,t)
if(o(p))return null
p.type
const w=null==a?void 0:a[g3],g=yt(e,w),v=s(g)?c:null,m=s(g)?null:c,y=function(e,t,n){var r
const o=yt(e,t),s=o.type===Zq
i(n)&&(n.iAdClickFields&&(t[XJ]=JSON.stringify(n.iAdClickFields)),n.iAdLineItem&&(t[eK]=n.iAdLineItem))
const a=Un(e,s?VM:_V,o.id,t),c=new az(a.pageUrl)
return null!==(r=null==n?void 0:n.webBrowser)&&void 0!==r&&r&&(c.param(OR,kS),c.removeParam(dx),c.removeParam(XP),a.pageUrl=c.build()),new h3(a,{rootPosition:0,locationStack:[]})}(e,t,n),b=Zu(e,p,y,n,g,m,v,l)
y.metricsPageInformation.baseFields[KM]=vh(e,p,b.lockup.icon,null==n?void 0:n.clientIdentifierOverride),(Kt(e,KH)||Kt(e,wH))&&(y.metricsPageInformation.adPageInfo=new Q0(e,KH,Q0.createInitialPageSlotInfos(e,KH,null,null,null)))
const P=pf(e,p),I=null!==(d=null==n?void 0:n.webBrowser)&&void 0!==d&&d
I||jn(e,b,y.metricsPageInformation,t=>{const n=Af(0,p,e.appleSilicon.isSupportEnabled),r=kf(e,p,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),o=If(e,p,P,e.client.deviceType,n,!1,r),i=Of(0,P,e.client.deviceType,n,!1),a=P&&(o||i),c=function(e,t,n,r){if(!qd(e,t))return!1
if(at(e,t,Qv.ThirtyTwoBit|Qv.UnsupportedSystemDeletableApps|Qv.MinimumOSRequirement|Qv.UnsupportedPlatform|Qv.MacOSRosetta))return!1
const o=Sf(0,n,Af(0,t,r),!1),i=pf(e,t)
return o.some(e=>Pf(i,e))}(e,p,e.client.deviceType,e.appleSilicon.isSupportEnabled)
t[kD]=a&&c?"runnable":a?"purchasable":mq,s(m)&&yW.shared.addReferralContextToMetricsFieldsIfNecessary(t)},I)
const C=Nr(t,!0)
return await async function(e,t,n,a,c,l,d){var p,w
const g=pf(e,n),v=n.type===Zq,m=V(n,wq),y=!(1===g.length&&g[0]===lW),b=la(e,n),P=!!y&&!m&&!b,I=s(c)?c.clientIdentifierOverride:null,C=H(n,eG),k=t.lockup.offerDisplayProperties,O=!i(k)||k.isFree
let E
if(v){const t=fe(n,dW)
E=function(e,t,n,r){return n?qv.context("bundleChildrenShelf",()=>{const o=Iq,i=new dJ(o)
i.isHorizontal=!0
const s=n.data.length
if(!s)return null
i.title=e.loc.stringWithCount("ProductPage.AppsInBundleShelf.Title",s)
const a=zh(e,n,r,y6.LockupIconSmall,o,null,Qv.Bundles,null,e.featureFlags.isEnabled(LJ))
if(a.remainingItems.length){const e=new v3(t.id,a.remainingItems,i.title,!1,void 0,Iq,BH,null)
e.isBundleShelf=!0,i.url=qh(0,e,r)}return bh(e,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:dq,id:`${r.getSequenceId()}`,idType:Aq},i.title),i.items=a.items,Ph(r.locationTracker),r.addImpressionsToShelf(e,i,KG),Oh(r.locationTracker),i.rowsPerColumn=s<2?1:2,i}):null}(e,n,t,a)}E&&(t.shelfMapping[KG]=E)
const R=fe(n,Zq),D=function(e,t,n,r){return n?qv.context("bundleParentsShelf",()=>{const o=n.data.length
if(!o)return null
const i=Iq,a=new dJ(i)
a.isHorizontal=!0,a.title=e.loc.string("ProductPage.Section.IncludedInBundles.Title")
const c=zh(e,n,r,y6.LockupIconSmall,i)
if(0===c.remainingItems.length&&0===c.items.length)return null
if(a.items=c.items,s(c.remainingItems)){const e=new v3(t.id,c.remainingItems,a.title,!1,void 0,i,BH,null)
e.isBundleShelf=!0,a.url=qh(0,e,r)}return a.rowsPerColumn=o<2?1:2,r.addImpressionsToShelf(e,a,"bundleParent"),a}):null}(e,n,R,a)
D&&(t.shelfMapping[EG]=D)
const _={productTitle:t.title,shouldShowRatingsAndReviews:P,isFirstPartyHideableApp:C,isBundle:v,isPreorder:m},L=function(e,t,n,r,i){return qv.context("createReviewsShelves",()=>{const a={}
if(o(t))return a
const c=function(e,t){if(Xu(e))return!0
if(o(t))return!1
let n
return n=st(e).isSystemAppFromData(t),!n||e.bag.enableSystemAppReviews}(e,t),l=pf(e,t),d=fe(t,Fq),p=At(d),w=B(t,VB)
w.ratingAverage=h(w,ID),w.adamId=t.id,w.isBundle=r.isBundle,w.supportUrl=Qe(e,t,FL)
const g=tf(e,t,{useCase:y6.LockupIconMedium}),v=1===l.length&&"tv"===l[0],m=Ma(e),y=u(w,gD),T=function(e,t,n,r){return qv.context("createProductRatings",()=>{const n=wa(e,e.client.guid,eH,t)
return n.ratingAverage>0&&n.ratingCounts||r||(n.status=e.loc.string(mD)),n})}(e,w,p.length,y),b=function(e,t,n,r,o,i){return qv.context(pI,()=>{const r=Vu(e,t,n,0,o,i)
if(r){const e=new i6
return e.actionType=Ay,e.action=r,e.id="ProductReviewAction.TapToRate",e}return null})}(e,t,r.productTitle,0,r.isBundle,v),P=function(e,t,n,r,o,i,s){return qv.context("createWriteAReview",()=>{if(r)return null
{const r=new s6
r.writeReviewAction=Ia(e,t,i,s,o),r.supportAction=Hu(e,n)
const a=new i6
return a.actionType="writeAReview",a.action=r,a}})}(e,t,w,v,g,i,r.productTitle),I=qv.context(xP,()=>null),C=function(e,t,n){return qv.context("createReviewSummaryProductReview",()=>{const r=ga(e,t,n)
if((0,Hv.isNothing)(r))return null
const o=new YY
return o.review=r,o.sourceType=Qj,o})}(e,t,n),k=ga(e,t,n),O=ha(e,w,p,!0,I,C,n),E=ha(e,w,p,!0,null,null,n)
if(function(e,t,n,r,o,i,s,a){qv.context("createProductReviewActions",()=>{const c=new a6
return c.tapToRate=Vu(e,t,n,0,o,i),c.writeReviewAction=Ia(e,t,a,n,s),c.supportAction=Hu(e,r),c})}(e,t,r.productTitle,w,r.isBundle,v,g,i),v||0===p.length||La(e,e.client.guid,w,p,d.next,r.productTitle,g,!1,!1,t,n),r.shouldShowRatingsAndReviews){const o=new dJ(EH)
o.title=m,o.items=[T],a.ratingsShelf=o,n.addImpressionsToShelf(e,o,"ratingsOverview",null,null,null,e.loc.string("ProductPage.Section.Reviews.Title"))
const i=[]
if(s(b)&&c&&i.push(b),s(P)&&c&&i.push(P),s(i)){const e=new dJ($D)
e.items=i,a.allReviewActionsShelf=e}if(s(k)){const e=new dJ(Qj)
e.items=[k],a.reviewSummaryShelf=e}let l=null
s(b)&&c&&(l=new dJ($D),l.items=[b],a.tapToRateActionsShelf=l)
let u=null
s(P)&&c&&(u=new dJ($D),u.items=[P],a.writeAReviewActionsShelf=u)
const h=e.loc.string(FD),g=e.loc.string(wF),y=(0,Hv.isSome)(E)&&E.length>0
let D,_
if((0,Hv.isSome)(O)&&O.length>0&&(D=new dJ(zx),D.items=O,D.isHorizontal=!0,y?(D.title=h,D.contentsMetadata={type:"productReviewsSection",hasReviewSummary:(0,Hv.isSome)(C),reviewSummaryTitle:g},n.addImpressionsToShelf(e,D,wD,null,null,null,e.loc.string(FD))):D.title=g,a.allProductReviewsShelf=D),y&&(_=new dJ(zx),_.items=E,_.isHorizontal=!0,_.title=h,n.addImpressionsToShelf(e,_,wD,null,null,null,e.loc.string(FD)),a.userProductReviewsShelf=_),"tv"===e.client.deviceType){const t=new dJ(ND)
t.title=m
const n=[]
s(b)&&A(R=b.action)&&"TapToRate"===R[gW]&&c&&n.push(b.action),s(T.status)?e.featureFlags.isEnabled(MJ)?n.push(new o6(T.status)):n.push(Ta(T)):(n.push(ya(T)),n.push(Aa(T))),t.items=n,a.purchasedRatingsAndReviewsComponentShelf=t}if("tv"===e.client.deviceType){const t=new dJ(ND)
t.title=m
const n=[]
s(T.status)?e.featureFlags.isEnabled(MJ)?n.push(new o6(T.status)):n.push(Ta(T)):(n.push(ya(T)),n.push(Aa(T))),t.items=n,a.notPurchasedRatingsAndReviewsComponentShelf=t}let L=null
s(I)&&(L=new dJ(zx),L.items=[I],r.shouldShowRatingsAndReviews?I.review.showsBadge||(L.title=e.loc.string(lI)):L.title=m,a.editorsChoiceProductReviewsShelf=L),!v&&p.length>0&&(a.ratingsShelf.seeAllAction=function(e,t,n,r,o,i=null,s,a,c){return r?qv.context(VP,()=>{var t
const l=new wJ
let u,d,h
if((0,Hv.isSome)(null==c?void 0:c.allReviewActionsShelf)){u=S(c.allReviewActionsShelf)
const e=null!==(t=u.presentationHints)&&void 0!==t?t:{}
u.presentationHints={...e,displayIfReviewable:!0},qu(u)}if((0,Hv.isSome)(null==c?void 0:c.ratingsShelf)){d=S(c.ratingsShelf)
const e=d.items[0]
if((0,Hv.isSome)(e)&&1===d.items.length){const t=S(e)
t.context=kL,d.items=[t]}d.seeAllAction=null,d.title=null,qu(d)}(0,Hv.isSome)(null==c?void 0:c.reviewSummaryShelf)&&(h=S(c.reviewSummaryShelf),qu(h))
const p=Da(e,0,n,r,o,i,s,a,pD,{ratingsShelf:d,reviewSummaryShelf:h,reviewActionsShelf:u})
l.title=null,l.adamId=f(r,FV),l.nextPage=p.paginationToken,l.initialSortOptionIdentifier=p.initialSortId,l.sortActionSheetTitle=p.sortActionSheetTitle,l.sortOptions=p.sorts,(0,Hv.isSome)(d)&&l.shelves.push(d),(0,Hv.isSome)(h)&&l.shelves.push(h),(0,Hv.isSome)(u)&&l.shelves.push(u),l.shelves.push(p.reviewsShelf)
const w=Ea(e);(0,Hv.isSome)(w)&&(l.trailingNavBarAction=w)
const g=new EY(Fq)
return g.pageData=l,g.title=e.loc.string(cH),g}):null}(e,e.client.guid,t.id,w,p,d.next,!1,!1,a))}var R
return a})}(e,n,a,_,t.lockup.subtitle)
s(L)&&(t.shelfMapping[HU]=L.purchasedRatingsAndReviewsComponentShelf,t.shelfMapping[VU]=L.notPurchasedRatingsAndReviewsComponentShelf,t.shelfMapping[EH]=L.ratingsShelf,t.shelfMapping[yF]=L.allReviewActionsShelf,t.shelfMapping[UU]=L.allProductReviewsShelf,t.shelfMapping[CG]=L.userProductReviewsShelf,t.shelfMapping[LH]=function(e,t){const n=function(e,t){return qv.context(xP,()=>{const n=f(Ke(e,t,hV),aW)
if(n){const r=new t1(n),o=Ke(e,t,TG)
if(o){const e=f(o,OM)
r.showsBadge=e&&e===EM}return r.showsBadge||(r.title=e.loc.string(Px)),r}return null})}(e,t)
if((0,Wv.isNothing)(n))return null
const r=new dJ(LH)
return r.items=[n],n.showsBadge?r.background={type:LH}:r.title=e.loc.string(lI),r}(e,n),t.shelfMapping[GU]=L.tapToRateActionsShelf,t.shelfMapping[jU]=L.writeAReviewActionsShelf,t.shelfMapping[AF]=L.productReviewsHeader)
{const n=function(e){if(o(e.bag.ratingsAndReviewsLearnMoreEditorialId))return null
const t=new dJ(Xj),n=function(e){const t=e.loc.string(wI),n={},r=function(e){const t=e.bag.ratingsAndReviewsLearnMoreEditorialId
if(o(t))return null
const n=new EY(Tq)
return n.title=e.loc.string(wI),n.pageUrl=`https://apps.apple.com/story/id${t}`,n}(e)
if((0,Hv.isNothing)(r))return null
n[t]=r
let i=e.loc.string("ProductPage.RatingsAndReviews.Footer")
i=i.replace(Oj,t)
const s=new b5(i,GV)
return new S5(s,n)}(e)
return(0,Hv.isNothing)(n)?null:(t.items=[n],t)}(e);(0,Hv.isSome)(n)&&(t.shelfMapping[Hj]=n)}const $=function(e,t,n){const r=ga(e,t,n)
if((0,Hv.isNothing)(r))return null
const o=new dJ(Qj)
return o.items=[r],o}(e,n,a);(0,Hv.isSome)($)&&(t.shelfMapping[Qj]=$)
const F=function(e,t,n,r){return qv.context(hj,()=>function(e,t,n,r,o,i){return qv.context("standardMostRecentVersionShelf",()=>{if(!n&&!r&&!o){const n=Ze(e,t,dU)
if(n.length>1&&Yu(e,n).length>0){const r=new dJ(mI)
r.title=e.loc.string(gI)
const o=Ju(e,n[0],vI)
if(r.items=[o],i.addImpressionsToShelf(e,r,dU),r)return e.client.deviceType!==cW&&(r.seeAllAction=function(e,t,n,r){return qv.context("versionHistorySeeAllAction",()=>{const o=function(e,t,n){return qv.context("versionHistoryPageAction",()=>{const r=Yu(e,t)
let o
if(r.length>0){const t=new dJ(mI)
t.items=r
const i=new pJ([t])
i.title=e.loc.string("VERSION_HISTORY_PAGE_TITLE","Version History"),e.client.deviceType!==cW&&(i.presentationOptions=[sj])
const s=Gn(e,"VersionHistory",n,"")
jn(e,i,s)
const a=new EY(dU)
a.title=e.loc.string("ACTION_VERSION_HISTORY_SEE_ALL"),a.pageData=i,o=a}return o})}(e,t,n)
return Xs(e,o,null,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o})}(e,n,t.id,i)),r}}return null})}(e,t,r.isFirstPartyHideableApp,r.isBundle,r.isPreorder,n))}(e,n,a,{isFirstPartyHideableApp:C,isBundle:v,isPreorder:m})
F&&(t.shelfMapping[zV]=F),t.shelfMapping[RG]=function(e,t,n){return qv.context("textCardShelfFromResponse",()=>(o(t),null))}(0,n)
const N=Qe(e,n,yq)
if(e.bag.enablePrivacyNutritionLabels&&!Mi(e,n.id)&&!xi(e,N)){const s=function(e,t,n,r){return qv.context("privacyShelf",()=>{if(o(t))return null
const i=new dJ(cq)
i.title=e.loc.string(cx)
const s=bl(e,t,!1,!1,n,r)
return i.items=[s],e.client.deviceType!==cW&&"tv"!==e.client.deviceType&&(i.seeAllAction=Cl(e,t,pj,n,r,null)),i})}(e,n,a.metricsPageInformation,a.locationTracker),c=function(e,t,n){return qv.context(hj,()=>{if(o(t))return null
const r=B(t,S$)
if((0,Wv.isNothing)(r)||o(r))return null
const i=new dJ(lx),s=e.loc.string(cx)
bh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:fD,id:`${n.getSequenceId()}`,idType:Aq},s)
const a=pl(e,r,t,eH,!0,n.metricsPageInformation,n.locationTracker)
return null===a||0===a.length?null:(i.items=a,a.length<=2&&(i.presentationHints={isLowDensity:!0}),i.title=s,n.addImpressionsToShelf(e,i,"appPrivacy"),Ph(n.locationTracker),Oh(n.locationTracker),i.title=null,i)})}(e,n,a)
if(i(s)&&i(c)){t.shelfMapping[cq]=s,i(c)&&(t.shelfMapping[nq]=c)
const l=function(e,t,n,s){return qv.context(hj,()=>{if(o(t))return null
const a=Il(e,t,!1,pj,n,s)
if((1===a.length&&a[0].identifier===cD||0===a.length)&&"tv"!==e.client.deviceType)return null
const c=new dJ(jH),l=function(e,t,n,o){return qv.context("privacyFooterFromData",()=>{const t=function(e,t,n,o){let i
const s=e.loc.string(lD),a={},c=Sl(e,n,o)
r(c)?i=e.loc.string(uD):(i=e.loc.string(vP),i=i.replace(Oj,s),r(c)?i=e.loc.string(uD):a[s]=c)
const l=new b5(i,GV)
return new S5(l,a)}(e,0,n,o),s=function(e,t,n,r){if("tv"!==e.client.deviceType)return[]
const o=[],s=Sl(e,n,r)
i(s)&&o.push(s)
const a=Pl(e,n,r)
return i(a)&&o.push(a),o}(e,0,n,o)
return new P5(t,s,[].length)})}(e,0,n,s)
return c.items=[l],c})}(e,n,a.metricsPageInformation,a.locationTracker)
i(l)&&(t.shelfMapping[jH]=l)}}const U=new I5,G=new I5,q=new I5,W=new I5,z=new I5,Y=new I5,J=qf(e,n),K=function(e,t,n,o,i,s,a,c){return qv.context(hj,()=>{let l
switch(e.client.deviceType){case cW:l=function(e,t,n,o){return qv.context(UD,()=>{let i
const s=Tu(e,t)?B5:N5,a=yu(e,s,t,n,!1,!1,o,void 0)
return a.length>0&&(i=new dJ(MG),i.items=a,r(o)||o.addImpressionsToShelf(e,i,xq)),i})}(e,t,n,o)
break
case"tv":l=function(e,t,n,o,i,s,a){return qv.context("tvInformationShelf",()=>{let c
const l=yu(e,U5,t,n,!1,!1,o,a),u=function(e,t,n,r){return qv.context("productCapabilitiesAsAnnotations",()=>{const o=[],i=su(e,t,n,r.metricsPageInformation,r.locationTracker)
for(const e of i){const t=e.title,n=e.caption.styledText.rawText
if((null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0){const e=new E5(n),r=new R5(t,[e])
0===r.items_V3.length&&(r.items_V3=Au(0,r)),o.push(r)}}return o})}(e,t,s,o).concat(yu(e,G5,t,n,!1,!1,o,a)),d=tr(e,SI),f=yu(e,d?[ql]:[mu],t,n,!1,!0,o,a),h=[]
if(l.length>0){const t=new $5(e.loc.string(_D),l,i)
h.push(t)}if(u.length>0){const t=new $5(e.loc.string(LD),u,i)
h.push(t)}if(f.length>0){const t=d?e.loc.string("ProductPage.Section.ExternalPurchases.Title"):e.loc.string("ProductPage.Section.TopInAppPurchases.Title"),n=new $5(t,f,!0)
h.push(n)}return h.length>0&&(Xu(e)?(c=new dJ("annotationGroup"),c.items=h,c.background={type:xD},r(o)||o.addImpressionsToShelf(e,c,xq)):(c=new dJ("informationContainer"),c.items=[new F5(h)],r(o)||o.addImpressionsToShelf(e,c,xq))),c})}(e,t,n,o,c,a,i)
break
default:l=function(e,t,n,o,i,s){return qv.context(UD,()=>{let a
const c=Tu(e,t)?B5:N5,l=yu(e,c,t,n,i,!1,o,s)
return l.length>0&&(a=new dJ(MG),a.title=e.loc.string(_D),a.items=l,r(o)||o.addImpressionsToShelf(e,a,xq)),a})}(e,t,n,o,s,i)}return l})}(e,n,C,a,(n,r,o)=>{var s,a,c
if(n===Bl&&(U.setShelfId(xq,o),U.annotation=r,t.ageRatingAction=new cJ(xq,null,null,void 0,o,!0),t.ageRatingAction.title=e.loc.string("ProductPage.Banner.AskForException.Review.ViewAgeRatingLink")),n===$l&&i(t.banner)){i(t.banner.fullProductAction)&&(t.banner.action=t.banner.fullProductAction)
const n=t.banner.action
i(n)&&(Xu(e)?T(c=n)&&c[gW]===Uy&&(null===(s=n.shelfId)||void 0===s?void 0:s.length)>0&&n.shelfId===xq&&n.indexId===FU&&(n.index=o):function(e){return T(e)&&e[gW]===Ny}(n)&&(null===(a=n.section.shelfId)||void 0===a?void 0:a.length)>0&&n.section.shelfId===xq&&n.indexId===FU&&(n.index=o))}n===Zl&&(G.setShelfId(xq,o),G.annotation=r),n===gu&&(q.setShelfId(xq,o),q.annotation=r),n===xl&&(W.setShelfId(xq,o),W.annotation=r),n===Kl&&(z.setShelfId(xq,o),z.annotation=r),n===Xl&&(Y.setShelfId(xq,o),Y.annotation=r)},J,O,!1)
K&&(t.shelfMapping[xq]=K)
const Z=function(e,t,n,r){var o
if(!oi(e))return null
let i=ge(t,kO)
if(((0,Hv.isNothing)(i)||0===i.length)&&(i=we(t,iW)),(0,Hv.isNothing)(i)||0===i.length)return null
const s=he(t,kO),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:null!==(o=St(s))&&void 0!==o?o:void 0},c=i.some(e=>e.type!==iW),l=c?"ProductPage.Section.AppEventsAndOffers.Title":"ProductPage.Section.AppEvents.Title",u=e.loc.string(l),d=c?"EventsAndOffers":"Events"
bh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:a.recoMetricsData,targetType:dq,id:d,idType:mq},u)
const f=hi(e,i,t,!c,!1,a,!1,!1,!1,!1);(0,Hv.isSome)(f.nextAppEventPromotionStartDate)&&Br(f.nextAppEventPromotionStartDate,r)
const h=f.appPromotions
if(0===h.length)return Ph(a.locationTracker),null
const p=qa(0,h,u)
return n.addImpressionsToShelf(e,p,dq,d,mq,a.recoMetricsData),Ph(a.locationTracker),Oh(a.locationTracker),p}(e,n,a,l)
if(i(Z)&&(t.shelfMapping[zH]=Z),J){const r=function(e,t,n){if(o(t))return null
const r=f(Ke(e,t,hV),aW)
if(r){const t=e.loc.string("APP_STORE_EDITORS_ATTRIBUTION"),o=new K5(r,t),i=new dJ(WV)
return i.items=[o],n.addImpressionsToShelf(e,i,WV),i.background={type:PV,color:Se(Sx)},i}return null}(e,n,a)
r&&(t.shelfMapping[WV]=r)}t.shelfMapping[vj]=Pu(e,n,a,!1,0,J),t.shelfMapping[uV]=Pu(e,n,a,!0,0,J),t.shelfMapping[NF]=function(e,t,n){return qv.context(hj,()=>{if("tv"!==e.client.deviceType)return null
if(o(t))return null
const r=new dJ(Nj)
r.isHorizontal=!1
const i=function(e,t){return t?qv.context("externalProductLinksAsParagraphsFromData",()=>{const n=[],r=Qe(e,t,NL)
if(r){const t=e.loc.string("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",r),o=new FX(t)
e.featureFlags.isEnabled(MJ)&&(o.style=cN),o.alignment=Rq,n.push(o)}return n}):null}(e,t)
return i&&i.length>0&&(r.items=i),Xu(e)&&(r.background={type:xD}),n.addImpressionsToShelf(e,r,RN),r})}(e,n,a)
const Q=function(e,t,n,r){return qv.context("capabilitiesShelf",()=>{if(o(t))return null
const i=nt(e,t)
if(o(ce(t,i,yq)))return null
const s=su(e,t,n,r.metricsPageInformation,r.locationTracker)
if(o(s))return null
const a=new dJ("productCapability")
return a.title=e.loc.string(LD),a.items=s,a.mergeWhenFetched=!0,a.batchGroup=OV,r.addImpressionsToShelf(e,a,"supports"),a})}(e,n,O,a)
Q&&(t.shelfMapping[fq]=Q)
const X=null!==(p=null==c?void 0:c.webBrowser)&&void 0!==p&&p
if(!X){const r=fe(n,b$)
if(s(r)){const i=function(e,t,n,r){return qv.context("smallStoryShelf",()=>{var i
if(o(n))return null
const a={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:dq,id:`${r.getSequenceId()}`,idType:Aq},c=e.loc.string(uI)
bh(e,a,c)
const l=[],u=function(e){return l.push(e),!1}
let d
if(zu(e)){const t=new BZ(a.pageInformation,a.locationTracker)
d=Hc(e,n,c,null,t,u)}else{const t={metricsLocationTracker:a.locationTracker,metricsPageInformation:a.pageInformation,filterOutMediaCardKinds:new Set([QN])}
d=Vc(e,n,EV,c,null,t,u),Array.isArray(d.items)&&(d.items=d.items.filter(e=>!Bt(e)||Gc(0,e.media.kind,EV)))}if(d.isHorizontal=!0,!(null===(i=d.items)||void 0===i?void 0:i.length)&&0===l.length)return null
if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=Xv.OnShelfWillAppear),s(l)){Ph(r.locationTracker),r.addImpressionsToShelf(e,d,hH),Oh(r.locationTracker)
const n=new v3(t.id,l,d.title,!1,void 0,d.contentType,null,null,null,null,null,Bm.SmallStory)
Qa(e,d,n),d.url=qh(0,n,r)}else Ph(r.locationTracker),r.addImpressionsToShelf(e,d,hH),Oh(r.locationTracker)
return d})}(e,n,r.data,a)
i&&(t.shelfMapping[hH]=i)}}const ee={isPreorder:m},te=new I5,ne=function(e,t,n,r){return qv.context("friendsPlayingShelf",()=>{if(o(t))return null
const i=t.id
if(o(i))return null
if(!et(e,t,IB))return null
if(r.isPreorder)return null
const s=e.loc.string("ProductPage.Section.FriendsPlaying.Title","Playing This Game"),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:dq,id:`${n.getSequenceId()}`,idType:Aq}
bh(e,a,s)
const c=new dJ(dI)
c.header=oo(e,s),c.isHidden=!0,c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new v3(t.id,[],c.title,!1,void 0,null,null,null)
c.url=`${OW}:/${xW.product}/${xW.shelf}/?${zW.isGameCenterPlayerShelf}=true&${zW.id}=${i}&${zW.token}=${Wh(l,n,n.metricsPageInformation)}`,c.batchGroup=OV,n.addImpressionsToShelf(e,c,gq),Ph(n.locationTracker),Oh(n.locationTracker)
const u=new EY(wW)
return Xs(e,u,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),c})}(e,n,a,ee)
ne&&(t.shelfMapping[gq]=ne,te.setShelfId(gq))
const re=function(e,t,n,r){return qv.context("achievementsShelf",()=>{if(o(t))return null
if(r.isPreorder)return null
if(!et(e,t,IB))return null
const i=nt(e,t),s=ce(t,i,yq)
if(o(s))return null
const a=e.loc.string("ProductPage.Section.Achievements.Title",gj),c=new dJ(cI)
c.header=oo(e,a),c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new v3(t.id,[],c.title,!1,void 0,null,null,null)
return l.sourceLocationTracker=n.locationTracker,l.destinationPageInformation=n.metricsPageInformation,c.url=`${OW}:/${xW.product}/${xW.shelf}/?${zW.isGameCenterAchievementsShelf}=true&${zW.bundleId}=${s}&${zW.token}=${Wh(l,n,n.metricsPageInformation)}`,c.batchGroup=OV,Oh(n.locationTracker),c.footerTitle=e.loc.string(G$),c.footerAction=ro({objectGraph:e,target:{achievements:{bundleID:null!=s?s:""}},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker}),c.footerStyle={$kind:QH,bundleID:EN,width:16,height:16},c})}(e,n,a,{isPreorder:m})
if(re&&(t.shelfMapping[Hq]=re),!d&&!X){const r=function(e,t,n){return qv.context("moreByDeveloperShelf",()=>{if(o(t))return null
const r=Mf(0,pe(e,t,$H)),i=j(t,sH)
let a,c
if(a=fe(t,$F),!a||0===a.data.length)return null
c=a.data
const l=e.loc.string("ProductPage.Section.MoreByDeveloper.TitleTemplate").replace("{developer}",i)
let u
switch(bh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:dq,id:`${n.getSequenceId()}`,idType:Aq},l),e.client.deviceType){case lW:case"tv":u=oq
break
default:u=Iq}const d=new dJ(u)
d.title=l
const f=null,h=e.client.isCompanionVisionApp?Qv.VisionOSCompatibility:void 0
let p
if((0,Hv.isSome)(a)?p=zh(e,a,n,Kd(0,u),u,f,h):(0,Hv.isSome)(c)&&(p=Yh(e,c,n,Kd(0,u),u,f,h)),!p)return null
d.items=p.items,d.isHorizontal=!0,c.length<2?d.rowsPerColumn=1:d.rowsPerColumn=2
{const t=new EY(wW)
t.pageUrl=r,t.title=e.loc.string(cH),Xs(e,t,t.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),d.seeAllAction=t}if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=Xv.OnShelfWillAppear),s(p.remainingItems)){Ph(n.locationTracker),n.addImpressionsToShelf(e,d,$H),Oh(n.locationTracker)
const o=new v3(t.id,p.remainingItems,d.title,!1,void 0,u,f,null,null,null,null,Bm.MoreByDeveloper)
o.developerUrl=r,Qa(e,d,o),d.url=qh(0,o,n)}else Ph(n.locationTracker),n.addImpressionsToShelf(e,d,$H),Oh(n.locationTracker)
return d})}(e,n,a);(0,Hv.isSome)(r)&&(t.shelfMapping[GH]=r)}if(!d&&!X){const r=function(e,t,n){return qv.context("similarItemsShelf",()=>{var r
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const i=fe(t,OG)
if(o(i))return null
const a=qf(e,t),c=a?e.loc.string("Arcade.ProductPage.MoreFromAppleArcade"):e.loc.string("ProductPage.Section.SimilarItems.Title"),l=iq,u=BU
let d,f
switch(bh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:l,id:h3.similarItemsShelfId,idType:u},c),e.client.deviceType){case"tv":d=oq,f=!1
break
case lW:d=oq,f=!0
break
default:d=Iq,f=!0}const h=new dJ(d)
h.title=c
const p=St(i),w=zh(e,i,n,Kd(0,d),d,null,null,p)
if(!w)return null
h.items=w.items
const g=Kt(e,KH),v=Gn(e,"SimilarItems",t.id,""),m=new v3(t.id,i.data,h.title,f,void 0,d,null,null,null,null,null,Bm.SimilarItems)
{const e=Wu(0,t.id,m,n,v)
h.refreshUrl=e}if(h.isHorizontal=!0,i.data.length<2?h.rowsPerColumn=1:h.rowsPerColumn=a?2:3,e.bag.isOnDemandShelfFetchingEnabled&&(h.fetchStrategy=Xv.OnShelfWillAppear),s(w.remainingItems)||g){Ph(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),Oh(n.locationTracker)
const o=new v3(t.id,null!==(r=w.remainingItems)&&void 0!==r?r:[],h.title,f,void 0,d,null,null,h.refreshUrl,p,a,Bm.SimilarItems)
if(Qa(e,h,o),h.url=qh(0,o,n,v),g){const e=new az(h.url)
e.param(zW.isShelfWithAd,pq),e.param(zW.shelfWithAdPlacementType,KH),e.param(zW.id,t.id),h.url=e.build()}}else Ph(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),Oh(n.locationTracker)
return h})}(e,n,a);(0,Hv.isSome)(r)&&(t.shelfMapping[iq]=r)}const oe={isForSubscriptions:!0,options:c},ie=await M(Su(e,n,a,oe))
ie.success&&(0,Hv.isSome)(ie.value)&&(t.shelfMapping[$j]=ie.value)
const se={isForSubscriptions:!1,options:c},ae=await M(Su(e,n,a,se))
ae.success&&(0,Hv.isSome)(ae.value)&&(t.shelfMapping[xj]=ae.value)
const le=function(e,t,n,r){return qv.context("productMediaShelves",()=>{if(o(t))return null
const i=(e.client.deviceType,null),a=(e.client.deviceType,null),c=Ge(e,t),l=df(e,t,y6.ProductPageScreenshots,i,c,n),u=cf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},a)
let d=null
if(u)for(const e of l)if(e.mediaPlatform.isEqualTo(u.mediaPlatform)){d=e
break}let f=null
if(d){const e=d.mediaPlatform.appPlatform
if(e===nW||e===sq)for(const e of d.items){const t=e.screenshot
if(f=t.width/t.height,f<1)break}}const h=[],p=[]
if(d&&u&&u.videos)for(const n of u.videos){const o=new yz
o.video=n
const i=n.preview.width/n.preview.height,s=null===f||Math.abs(i-f)<.01,a=d.mediaPlatform.isEqualTo(u.mediaPlatform)
s&&a?h.push(o):p.push(n)
const c={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,id:t.id,isAdvert:!!r.metricsPageInformation.adPageInfo&&r.metricsPageInformation.adPageInfo.adIsPresent}
po(e,n,c)}d&&(d.items=h.concat(d.items))
let w=[],g={}
for(let n=0;n<l.length;n++){const o=l[n],i=`${w2}_${o.mediaPlatform.appPlatform}_${o.mediaPlatform.supplementaryAppPlatforms.join("_")}`
w.push(new s1(vW,i))
const a=new dJ(hI,null,o.items)
a.isHorizontal=!0
let c=!1,u=Ua(0,o.items[0])
for(const e of o.items)if(s(e.screenshot)&&e.screenshot.isPortrait()||s(e.video)&&e.video.preview.isPortrait()){u=Ua(0,e),c=!0
break}a.contentsMetadata={type:"productMedia",platform:o.mediaPlatform,allPlatforms:o.allPlatforms,platformDescription:o.platformDescription,allPlatformsDescription:o.allPlatformsDescription,allPlatformsDescriptionPlacement:o.allPlatformsDescriptionPlacement,hasPortraitMedia:c,expandProductMediaAction:null,viewProductMediaGalleryAction:Ba(e,o,t.id),aspectRatio:u},r.addImpressionsToShelf(e,a,Yq),0===n&&"tv"!==e.client.deviceType&&(a.title=e.loc.string(RP)),g[i]=a}return p.length>0&&(g[VH]=function(e,t,n){return qv.context("videoShelf",()=>{if(!t||0===t.length)return null
let r
return Xu(e)?(r=new dJ(hI),r.title=e.loc.string(TI),r.items=t.map(e=>{const t=new yz
return t.video=e,t})):(r=new dJ(Ix),r.title=e.loc.string(TI),r.items=t.map(e=>new h2(e,!0,GV,null,null,!0))),r.isHorizontal=!0,n.addImpressionsToShelf(e,r,VH),r})}(e,p,r)),{sectionMappings:w,shelfMapping:g,allProductMedia:l}})}(e,n,I,a)
t.shelfMapping={...t.shelfMapping,...le.shelfMapping}
const ue=function(e){if((0,Hv.isNothing)(e))return null
switch(e){case nW:return _q
case Kq:return Dq
case lW:return lW
case"tv":return QG
case Qq:return XV
case cW:return cW
case sq:return null
default:x(e)}}(null===(w=null==le?void 0:le.allProductMedia[0])||void 0===w?void 0:w.mediaPlatform.appPlatform),de=(t.title,function(e,t,n,r){return qv.context("createActionLinks",()=>(o(t),null))}(0,n))
if(de&&(t.shelfMapping[qx]=de),(0,Hv.isSome)(ue)&&function(e,t,n){var r
const o=(0,Yv.attributeAsDictionary)(t,`accessibility.${n}`),i=null!==(r=Qe(e,t,yq))&&void 0!==r?r:""
return Ci(e)&&!ki(e,t.id)&&!Oi(e,i)&&(0,Hv.isSome)(o)}(e,n,ue)){const r=Rl(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker)
t.shelfMapping[xH]=r
const o=Dl(e,n,ue,!1,a,a.metricsPageInformation,a.locationTracker);(0,Hv.isSome)(o)&&(t.shelfMapping[UH]=o)
const i=_l(e,n,!1,a.metricsPageInformation,a.locationTracker);(0,Hv.isSome)(i)&&(t.shelfMapping[MH]=i)}{const e=J?HB:qB,n=hl(0,e)
t.shelfMapping[e]=n}!function(e,t,n){if(t&&t.spotlightSection){const e=t.spotlightInAppProductIdentifier
if(e&&t.spotlightSection){const r=n.shelfMapping[t.spotlightSection.shelfId]
if(!r)return
if(r.presentationHints={isInProductPageSpotlight:!0},Jh(0,e,r.items),r.url){const t=new az(r.url)
t&&(r.url=t.param(zW.offerName,e).build())}}}}(0,c,t)
const ve={},me=ZP,ye=gF,Ae=GN,Te=qj,be=AD,Pe=gq,Ie=bD
ve[_U]=U,ve[me]=U,ve[ye]=G,ve[Ae]=q,ve[Te]=W,ve[be]=Y,ve[Pe]=te,ve[Ie]=z,t.badges&&Ol(e,t.badges,ve,a),null!=t.shelfMapping[tq]&&Ol(e,nd(e,t.shelfMapping[tq]),ve,a),Qu(e,t,le.sectionMappings,J,c)}(e,b,p,y,n,C,l),b.pageRefreshPolicy=Ur(e,C),b.isIncomplete=!1,b.alwaysAllowReviews=ua(e,p),b.canonicalURL=j(p,Wq),l&&(b.shareAction=null,b.titleOfferDisplayProperties=null,b.expandedOfferDetails=null,b.lockup.offerDisplayProperties=null,b.banner=null),I&&(b.shareAction=null),b})}function Zu(e,t,n,a,c,l,d,h=!1){return qv.context("createProductPageSidePack",()=>{var h,p
let w
i(a)&&(w=a.clientIdentifierOverride)
const g=t.id,v=j(t,fW),m=H(t,eG),y=la(e,t),T=qf(e,t),b={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,id:g,isAdvert:!!n.metricsPageInformation.adPageInfo&&n.metricsPageInformation.adPageInfo.adIsPresent},S=new aJ,P=new kY,I=V(t,wq)
I&&i(n)&&i(n.metricsPageInformation)&&(n.metricsPageInformation.offerType=ZV,n.metricsPageInformation.offerReleaseDate=yr(0,t)),P.adamId=g,P.bundleId=Qe(e,t,yq),S.uber=function(e,t,n){of(e,t,n)
const r=qf(e,t),s=function(e,t){return t&&!0}(0,r)?Vq:ZT,a=new T2(s)
if(a.artwork=Df(e,t,{supportsArcade:r}),a.compactArtwork=Df(e,t,{supportsArcade:r,prefersCompactVariant:!0}),a.video=_f(e,t,y6.Uber),i(a.video)&&(a.video.playbackId=function(e){return`ProductPage.${e.id}.productUberVideoPlaybackId`}(t)),r&&o(a.video)&&o(a.artwork)){const r=(e.client.deviceType,null),o=Ge(e,t),i=df(e,t,y6.ProductPageScreenshots,r,o,n)
if(i.length>0&&i[0].items.length>0){const e=i[0].items[0]
a.video=e.video,a.artwork=e.screenshot}}return o(a.compactArtwork)&&(a.compactArtwork=a.artwork),a.isValidUber(!1,!1)?a:null}(e,t,w)
const C=S.uber&&S.uber.style===Vq
P.icon=tf(e,t,{useCase:y6.ProductPageIcon,withJoeColorPlaceholder:void 0},w),S.title=v,S.isIncomplete=!0,P.title=v,P.subtitle=Td(e,t),P.developerTagline=Qe(e,t,RH),S.regularPriceFormatted=j(t,"regularPriceFormatted"),S.logoArtwork=function(e,t){let n=null,r=null
if("tv"!==e.client.deviceType)return null
n=LT,r="bb"
const o=Ke(e,t,n)
return i(o)&&i("bb")?Zd(e,o,{cropCode:"bb",useCase:y6.Default,withJoeColorPlaceholder:!0}):null}(e,t),S.navigationBarIconArtwork=null,y||(P.rating=q(t,aR)),P.children=yd(e,t,{metricsOptions:b,artworkUseCase:y6.LockupIconSmall})
const k=function(e,t,n,r,o,a,c){var l
const d=wr(e,t),f=Qe(e,t,yq),h=V(t,wq),p=vr(e,d,t,h,!1,vh(e,t,n,null==a?void 0:a.clientIdentifierOverride),o,eH,c,null==a?void 0:a.webBrowser)
if(null!==(l=null==a?void 0:a.webBrowser)&&void 0!==l&&l&&(null==a?void 0:a.webBrowserFlowType)!==Um.PurchaseAndOpen)return{buttonAction:new b2(t.id),offerAction:p}
let w
if(s(p)){i(a)&&(p.lineItem=a.iAdLineItem)
const n=s(a)?a.clientIdentifierOverride:null
if(w=br(e,p,t,h,o,eH,n),i(a)&&s(w)){const n=rt(e),r=it(e,t,Ge(e,t),q$,n),i=s(r)&&!u(a.isCppDeepLinkDisabled),c=s(a.externalDeepLinkUrl)
let l;(i||c)&&(l=i?r:a.externalDeepLinkUrl,w=ra(e,w,p.adamId,f,l,!1,o))}}return{buttonAction:w,offerAction:p}}(e,t,P.icon,0,b,a,l)
if(P.buttonAction=k.buttonAction,I){let n
S.theme=rL
let r=null
if(T)n="",r=e.loc.uppercased(nh(e,t,e.loc.string(OD)))
else if(n=e.loc.string(OD),i(k.offerAction.expectedReleaseDate)){const n=vx,o=e.loc.formatDate(n,k.offerAction.expectedReleaseDate),i=e.loc.string("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(PD,o)
r=nh(e,t,i)}S.expandedOfferDetails=new v2(n,r)}let O,E
C&&T&&(S.theme=uq),C&&T?(O=uq,E=Q_):(O=Ej,E=eH)
const R=UE,D=Ej,_=T?xB:Jq,L=null!==(h=null==a?void 0:a.webBrowser)&&void 0!==h&&h
let M
switch(null==a?void 0:a.webBrowserFlowType){case Um.SelectionOnly:M=!0
break
case Um.PurchaseAndOpen:M=!1
break
default:M=!0}const x=L&&M?sP:eH
let $
P.offerDisplayProperties=xr(e,k.offerAction,_,t,I,0,O,E,null,null,x,!1,!1),S.titleOfferDisplayProperties=xr(e,k.offerAction,_,t,I,0,D,R,null,null,x),L&&(P.offerDisplayProperties.ignoresContentRestrictions=!0,S.titleOfferDisplayProperties.ignoresContentRestrictions=!0)
const F=pe(e,t,$H),N=Mf(0,F)
i(N)&&($=new EY(wW),$.title=j(t,sH),$.pageUrl=N,Qs(e,$,{targetType:hW,id:F.id,actionType:pW,pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker})),S.developerAction=$,S.shareAction=Vo(e,t,n.metricsPageInformation,n.locationTracker,w),P.tertiaryTitle=bd(e,t),P.tertiaryTitleAction=Sd(e,t),P.tertiaryTitleArtwork=null
const B={appPlatforms:pf(e,t),clientIdentifierOverride:w,offerButtonShouldBeDisabled:!1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker,webBrowser:null==a?void 0:a.webBrowser,webBrowserFlowType:null==a?void 0:a.webBrowserFlowType},U=function(e,t,n){let r=null,i=null,a=null,c=null,l=null,u=!1,d=null
const f=et(e,t,zy),h=et(e,t,Yy)
if((f||h)&&(r=e.loc.string("ProductPage.Banner.UpdateRequired.iOS"),n.offerButtonShouldBeDisabled=!0),null===r&&at(e,t,Qv.SADWatchApps)&&(r=e.loc.string("OFFER_WATCH_ONLY_BANNER"),n.offerButtonShouldBeDisabled=!0),null===r&&!qd(e,t)){if(r=e.loc.string(IP),Xu(e)){const t=new cJ(xq)
t.title=e.loc.string($U),t.indexId=FU,a=t}else{const t=new uJ(vW,xq),n=new lJ(t)
n.title=e.loc.string($U),n.indexId=FU,a=n}r=e.loc.string(jN).replace(VN,a.title),n.offerButtonShouldBeDisabled=!0}if(null===r&&at(e,t,Qv.UnsupportedSystemDeletableApps|Qv.LegacyApps)&&(r=e.loc.string(CP),n.offerButtonShouldBeDisabled=!0),at(e,t,Qv.MinimumOSRequirement)){const n=bf(e,t,e.appleSilicon.isSupportEnabled)
switch(e.client.deviceType){case lW:r=e.loc.string("UNSUPPORTED_MACOS_VERSION").replace(YG,n)
break
case nW:case Kq:r=e.loc.string("UNSUPPORTED_IOS_VERSION").replace(YG,n)
break
case"tv":r=e.loc.string("UNSUPPORTED_TVOS_VERSION").replace(YG,n)
break
case cW:const o=Qe(e,t,WF)
r=e.loc.string(kP).replace(YG,o)
break
case Qq:r=e.loc.string("UNSUPPORTED_VISIONOS_VERSION").replace(YG,n)
break
default:r=e.loc.string(CP)}if(e.client.isPhone&&et(e,t,DG)){const n=Qe(e,t,WF)
r=e.loc.string(kP).replace(YG,n)}}if(at(e,t,Qv.UnsupportedPlatform))if(n.offerButtonShouldBeDisabled=!0,r=e.loc.string(IP),Xu(e)){const t=new cJ(xq)
t.title=e.loc.string($U),t.indexId=FU,a=t,r=e.loc.string(jN).replace(VN,t.title)}else{const t=new uJ(vW,xq),n=new lJ(t)
n.title=e.loc.string($U),n.indexId=FU,a=n,r=e.loc.string(jN).replace(VN,n.title)}if(at(e,t,Qv.MacOSRosetta)){if(Xu(e)){const t=new cJ(xq)
t.title=e.loc.string($U),t.indexId=FU,a=t}else{const t=new uJ(vW,xq),n=new lJ(t)
n.title=e.loc.string($U),n.indexId=FU,a=n}r=e.loc.string(jN).replace(VN,a.title)}const p=H(t,wq)
Jf(e,t)&&(r=p?e.loc.string("ProductPage.WatchOS.PreOrderRequiresiPhone"):e.loc.string("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),n.offerButtonShouldBeDisabled=!0)
const w=Qe(e,t,WF)
if(null===r&&n.clientIdentifierOverride===iY&&Xf(e,w)&&(r=e.loc.string("ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace(YG,w)),xe(e,t,XV)&&!e.client.isCompanionVisionApp){const t=e.loc.string("BANNER_VISION_ONLY_APP_LEARN_MORE_LINK")
i=function(e,t,n,r){const i=e.bag.visionOnlyAppLearnMoreEditorialItemId
if(o(i))return null
const s=new EY(Tq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Qs(e,s,{id:oU,targetType:Mq,actionType:pW,pageInformation:n,locationTracker:r}),s}(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){return t&&n?e.loc.string("BANNER_VISION_ONLY_APP_WITH_LINK").replace(Oj,t):e.loc.string("BANNER_VISION_ONLY_APP_NO_LINK")}(e,t,i),a=null,c=Ot(e,"systemimage://visionpro"),l=Se(XF),u=!0}Dr(e,t)&&!Lr(e)?(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.VisionDeviceRequired")):e.client.isCompanionVisionApp&&!Dr(e,t)&&(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.RemoteDownloadUnavailable"))
const g=er(e,t),v=tr(e,"product-page-banner")
if((null===r||!n.offerButtonShouldBeDisabled)&&g&&v){const t=e.loc.string("ProductPage.ExternalPurchasesBanner.LearnMore")
i=nr(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){if(t&&n){if((0,Wv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const n=`ProductPage.ExternalPurchasesBanner.WithLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(n).replace(Oj,t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.WithLink").replace(Oj,t)}if((0,Wv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const t=`ProductPage.ExternalPurchasesBanner.NoLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.NoLink")}(e,t,i),a=null,e.bag.externalPurchasesIncludeProductPageBannerIcon?"secondaryInfoCircle"===e.bag.externalPurchasesProductPageBannerIconVariant?(c=Ot(e,"systemimage://info.circle"),l=Se(XF)):(c=Ot(e,ux),l=Se("systemRed")):(c=null,l=null),u=!0}if(null!==r&&n.offerButtonShouldBeDisabled||!(0,Wv.isSome)(n.webBrowser)||!n.webBrowser||n.webBrowserFlowType!==Um.PurchaseAndOpen||(r=e.loc.string("ProductPage.Banner.DefaultBrowser.Message"),c=Ot(e,"systemimage://gear"),l=Se(XF),d=dx),(null==r?void 0:r.length)>0)return new m2(r,null,i,a,c,l,u,d)
if(!n.offerButtonShouldBeDisabled){const n=Tf(e,t)
if(s(n))return function(e,t){const n=e.loc.string("ProductPage.Banner.ExternalBrowser.Message")
let r=n,o=n,i=n,s=n,a=n
return[GG].includes(e.client.buildType)&&(r+="\n(Internal: unknown)",o+="\n(Internal: buyOrGet)",i+="\n(Internal: redownload)",s+="\n(Internal: update)",a+="\n(Internal: open)"),new y2(El(fx,t,r),El(fx,t,o),El(fx,t,i),El(tx,t,s),El("launch",t,a))}(e,n)}return null}(e,t,B)
A(p=U)&&"Banner"===p[gW]?S.banner=U:function(e){return A(e)&&"AppStateBanner"===e[gW]}(U)&&(S.appStateBanner=U)
const G=P.offerDisplayProperties
B.offerButtonShouldBeDisabled&&s(G)&&(P.offerDisplayProperties=G.newOfferDisplayPropertiesChangingAppearance(!1,XB))
const W=!at(e,t,Qv.MinimumOSRequirement)
if(!m&&!B.offerButtonShouldBeDisabled&&W){const n=function(e,t){return qv.context("updateOfferDataFromData",()=>{const n=Ze(e,t,fj)
if(0===n.length)return null
for(const e of n)if(f(e,kV)===tx)return e
return null})}(e,t)
S.updateBuyParams=f(n,Sj),S.externalVersionIdentifier=tt(e,t,ED)}if(T&&(P.editorialTagline=e.loc.string("APPLE_ARCADE")),S.lockup=P,S.appPlatforms=pf(e,t),i(c)){const n=ni(e,c,t,!1,!1,Gq,uq,!0,b,!0,!1,null,!1,!1)
if(i(c)&&function(e){return A(e)&&function(e){return(0,Hv.isSome)(MX[e])}(e.$kind)}(n)){const r=n
S.appPromotionDetailPageFlowAction=ri(e,c,t,r,b,rH,!1,d)}}!function(e,t,n,i,s,a){if(t.shelfMapping[Uq]=new dJ(eI,"productTopLockup"),"tv"!==e.client.deviceType){const s={developerAction:t.developerAction}
t.shelfMapping[Cq]=function(e,t,n,i){return qv.context("descriptionShelf",()=>{if(o(t))return null
const s=new dJ("productDescription"),a=function(e,t){return t?qv.context("productDescriptionLinksFromData",()=>{const n=[],r=Qe(e,t,NL)
if(r){const t=new GY(r,!1),o=e.loc.string("PRODUCT_DEVELOPER_WEBSITE")
n.push(new V5(o,t,H5))}const o=Qe(e,t,FL)
if(o){const t=new GY(o,!1),r=e.loc.string("DEVELOPER_SUPPORT")
n.push(new V5(r,t,z5))}return n}):null}(e,t),c=function(e,t,n,r){const o=ge(t,oE),i=[]
for(const t of o){const o=(0,Yv.attributeAsString)(t,fW)
if((0,Hv.isSome)(o)){let s=null
switch(t.type){case DN:s=(0,Yv.attributeAsString)(t,Wq)
break
case IV:const n=f(t,AG)
n&&(s=Fi(e,n))}if((0,Hv.isNothing)(s))continue
const a=e.required(y3).fetchFlowPage(s),c=new EY(a)
c.pageUrl=s,c.title=o
const l=new s5(o,c),u={targetType:lj,pageInformation:n,locationTracker:r,recoMetricsData:null}
Mh(e,l,Uh(e,t,o,u))
const d=Js(e,t,u)
d.targetType=u.targetType,Qs(e,c,d),i.push(l),Oh(u.locationTracker)}}return i}(e,t,n.metricsPageInformation,n.locationTracker),l=function(e,t,n=null){return qv.context("descriptionFromData",()=>{r(n)&&(n=Ge(e,t))
let o=function(e,t,n){return it(e,t,n,XA)}(e,t,n)
o||(o="")
let i=Qe(e,t,LG)
i||(i="")
let s=""
o.length>0&&i.length>0&&(s="\n\n")
const a=o+s+i
if(a.length>0){const e=new FX(a)
return e.isCollapsed=!0,e}return null})}(e,t)
if(null===l)return null
const u=new j5(l,a,c,i.developerAction)
return s.items=[u],n.addImpressionsToShelf(e,s,Cq),s})}(e,n,i,s)}{const r={useInlineUberStyle:t.uber&&t.uber.style===Vq}
t.shelfMapping[tq]=function(e,t,n,r){if(Xu(e)){const r=new dJ("productBadge"),o=ju(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation})
return r.items=o,r.isHorizontal=!0,n.addImpressionsToShelf(e,r,tq),r}{const o=new dJ(tq),i=ju(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation}),s=!r.useInlineUberStyle,a=!1,c=r.useInlineUberStyle,l=new Q5(i,s,a,c,"justified")
return o.items=[l],o.isHorizontal=!0,n.addImpressionsToShelf(e,o,tq),o}}(e,n,i,r)}Qu(e,t,[],qf(e,n),s)}(e,S,t,n,a),S.uber&&(S.presentationOptions.push(yN),S.presentationOptions.push(rM)),S.alwaysAllowReviews=ua(e,t)
const z=null==a?void 0:a.iAdDismissAdActionMetrics
if((0,Hv.isSome)(z)){const e=new HY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),f(z.invocation),f(z.purchaseType),f(z.reportingDestination)),t=new gK(e)
S.pageDisappearedAction=t
const n=new HY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),zb,f(z.purchaseType),f(z.reportingDestination))
S.lockup.buttonAction=zt(0,S.lockup.buttonAction,n)}return S})}function Qu(e,t,n,r,o){const i=function(e,t,r){return e.map(e=>e.shelfId===Yq&&r?n:e.shelfId===Yq?n[0]?[n[0]]:[]:[e]).reduce((e,t)=>e.concat(t)).map(e=>e.createShelfIdList()).reduce((e,t)=>e.concat(t))},a=$a(0,!0,e.host.platform,r,!1,!1,o),c=$a(0,!1,e.host.platform,r,!1,!1,o),l=$a(0,!0,e.host.platform,r,!0,!1,o),u=$a(0,!1,e.host.platform,r,!0,!1,o),d=$a(0,!1,e.host.platform,r,!1,!0,o),f=$a(0,!1,e.host.platform,r,!0,!0,o)
t.shelfOrderings.purchasedOrdering=i(a,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia=i(a,0,!0),t.shelfOrderings[A2]=i(c,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia=i(c,0,!0),t.shelfOrderings.purchasedOrdering_Compact=i(l,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia_Compact=i(l,0,!0),t.shelfOrderings.notPurchasedOrdering_Compact=i(u,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia_Compact=i(u,0,!0),t.shelfOrderings.downloadingOrdering=i(d,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia=i(d,0,!0),t.shelfOrderings.downloadingOrdering_Compact=i(f,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia_Compact=i(f,0,!0),t.defaultShelfOrdering=A2
for(const e of Object.keys(t.shelfMapping))s(t.shelfMapping[e])&&(t.shelfMapping[e].id=e)}function Xu(e){return e.featureFlags.isEnabled(CJ)||!0}async function ed(e,t,n={},r={},o=null,i=!1,s=!1){const a=qf(e,yt(e,t)),c=await Ku(e,t,n,r,o,s)
return Xu(e)&&!i?c:Ga(e,c,a,n)}function td(e,t,n={}){if(!e.client.isSidepackingEnabled)return null
const o=qf(e,t),i=function(e,t,n){return qv.context("createProductPageSidePackFromResponse",()=>{if(!e.client.isSidepackingEnabled)return null
const o=function(e,t,n){const r=j(t,Wq),o=j(t,fW),i=j(t,sH)
let s=null
n&&(s=n.iAdClickFields)
const a=Gn(e,_V,t.id,`${i}_${o}`,s)
return a.pageUrl=r,new h3(a,{rootPosition:0,locationStack:[]})}(e,t,n),i=Zu(e,t,o,n)
return function(e,t,n){r(n)||(t.pageMetrics.addData(Kn(e,n,void 0),[Am.PageInvocationPoint.backButton]),r(t.pageMetrics.pageFields)&&(t.pageMetrics.pageFields={}))}(e,i,o.metricsPageInformation),i})}(e,t,n)
return Xu(e)?i:Ga(e,i,o,n)}function nd(e,t){if(o(null==t?void 0:t.items))return[]
if(Xu(e))return t.items
{const e=t.items
return e.length>0?e[0].badges:[]}}function rd(e,t,n){const r=kn(0,t),o=od(e,t,r,n,l6[n],!1),i=od(e,t,r,n,u6[n],!0)
return o.rtlArtwork=i.rtlArtwork,o.rtlArtworkData=i.rtlArtworkData,o.rtlVideo=i.rtlVideo,o.rtlBackgroundColor=i.rtlBackgroundColor,o.rtlTextColorOverride=i.rtlTextColorOverride,o}function od(e,t,n,r,o,a){let c={}
for(const l of o){if(i(n)&&(c=sd(e,n,r,l,a)||id(e,n,r,l,a),s(c)))break
if(c=sd(e,t,r,l,a)||id(e,t,r,l,a),s(c))break}return(0,Wv.isNothing)(c)&&(c={}),c}function id(e,t,n,o,i){let a=null,c=null,l=null
const u=`editorialArtwork.${o}`,d=nt(e,t)
if(r(d))return null
if(c=B(t,u)||se(t,d,u),!s(c))return null
if(a=Zd(e,c,{withJoeColorPlaceholder:!0,useCase:ad(n),cropCode:cd(n,o,i)}),r(a))return null
l=a.backgroundColor
const f=ud(0,c,a)
return i?{rtlArtwork:a,rtlArtworkData:c,rtlBackgroundColor:l,rtlTextColorOverride:f}:{artwork:a,artworkData:c,backgroundColor:l,textColorOverride:f}}function sd(e,t,n,r,i){let a=null,c=null,l=null,u=null
const d=`editorialVideo.${r}`,h=nt(e,t)
if((0,Wv.isNothing)(h))return null
if(l=B(t,d)||se(t,h,d),o(l))return null
const w=p(l,UG)
s(w)&&(c=Zd(e,w,{withJoeColorPlaceholder:!0,useCase:ad(n),cropCode:"sr"})),s(c)&&(c.crop="sr",u=c.backgroundColor)
const g=f(l,rq)
if(s(c)&&(0,Wv.isSome)(g)&&g.length>0&&(a=new mz(g,c,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:dd(0,n),autoPlayPlaybackControls:{}}),a.editorialMediaFlavor=r,a.editorialMediaPlacement=n),(0,Wv.isNothing)(w)||(0,Wv.isNothing)(c))return null
const v=ud(0,w,c)
return i?{rtlVideo:a,rtlArtwork:c,rtlArtworkData:w,rtlBackgroundColor:u,rtlTextColorOverride:v}:{video:a,artwork:c,artworkData:w,backgroundColor:u,textColorOverride:v}}function ad(e){switch(e){case Fm.Hero:return y6.GroupingHero
case Fm.LargeBreakout:return y6.ArcadeLargeBreakout
case Fm.StoryCard:return y6.TodayCardMedia
case Fm.StoryDetail:case Fm.StoryDetailLandscape:return y6.ArticleImage
case Fm.Search:return y6.SearchEditorialResult
default:return y6.Default}}function cd(e,t,n){switch(e){case Fm.Hero:switch(t){case $m.HeroStatic16x9:if(!n)return"gd"
break
case $m.HeroStaticRTL16x9:if(n)return"gg"
break
case $m.StoryCenteredStatic16x9:return n?"gh":"ge"
case $m.UniversalAStatic16x9:return n?"gj":"gi"}break
case Fm.LargeBreakout:switch(t){case $m.StoryCenteredStatic16x9:return n?"gk":"gf"
case $m.UniversalAStatic16x9:return n?"gl":"gm"}break
case Fm.StoryCard:case Fm.StoryDetail:case Fm.StoryDetailLandscape:case Fm.Search:if(t===$m.UniversalAStatic16x9)return"gn"
break
case Fm.Brick:if(t===$m.SearchCategoryBrick)return ST}return"sr"}function ld(e,t,n=!1){if((0,Wv.isNothing)(t))return null
const r=n?t.rtlTextColorOverride:t.textColorOverride,o=n?t.rtlBackgroundColor:t.backgroundColor
return(0,Wv.isSome)(r)?Ie(r,wY):(0,Wv.isSome)(o)?be(o):null}function ud(e,t,n){const r=null==n?void 0:n.textColor
if((0,Wv.isNothing)(r))return null
const o=u(t,"useCustomTextColor"),i=Ie(r,pY)||Ie(r,wY)
return o&&i?r:null}function dd(e,t){switch(t){case Fm.Hero:case Fm.StoryDetail:case Fm.StoryDetailLandscape:return{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}
default:return{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}}}function fd(e,t,n){switch(n){case PB:case SB:case pN:case hN:return rd(e,t,Fm.EditorialLockup)
case"BrickSmall":case"BrickMedium":case"BrickLarge":return rd(e,t,Fm.Brick)
case eM:case"StorySmall":return rd(e,t,Fm.StoryCard)
case VG:return rd(e,t,Fm.Hero)
case AE:return rd(e,t,Fm.LargeBreakout)
default:return{}}}function hd(e,t,n){const r=function(e,t,n){const r=function(e,t){let n=null
switch(t.type){case Xq:case XH:case vU:n=we(t,mU,!0)||we(t,OH,!0)||we(t,uW,!0)
break
case IV:n=w(t.meta,rb)
break
default:n=null}return n}(0,t)
return o(r)?null:$d(e,r,n)}(e,t,{lockupOptions:n})
if(!o(r))return null==r?void 0:r.map(e=>e.icon)}function pd(e,t,n){const r=Cn(e,t)
return o(r)?null:Cd(e,r,n)}function wd(e,t,n,r,o){if((0,Hv.isNothing)(t)||0===t.length||r.has(t))return null
const i=new d6(CF)
return i.moduleType=v_,(0,Hv.isSome)(t)&&(i.labelText=t,xh(e,i,Gh(o,v_,i.labelText,rW))),r.add(t),[i]}function gd(e,t,n){return t===JH?n?sW:KU:n?xB:Jq}function vd(e,t,n,s,a){var c,u,d,f,h,w,g,v,m,y,A
if(o(t))return
if(n.showMetadataInformationInLockup=e.bag.isLLMSearchTagsEnabled||e.client.isPad,!e.client.isPhone)return
const T=p(t,vV),b=null!==(u=null===(c=null==T?void 0:T.displayStyle)||void 0===c?void 0:c.metadataRibbon)&&void 0!==u?u:null===(d=null==s?void 0:s.displayStyle)||void 0===d?void 0:d.metadataRibbon
let S=[]
S=e.bag.isLLMSearchTagsEnabled?null!==(g=null!==(h=null===(f=null==T?void 0:T.displayStyle)||void 0===f?void 0:f.llmRibbon)&&void 0!==h?h:null===(w=null==T?void 0:T.displayStyle)||void 0===w?void 0:w.metadataRibbon)&&void 0!==g?g:null===(v=null==s?void 0:s.displayStyle)||void 0===v?void 0:v.metadataRibbon:null!==(y=null===(m=null==T?void 0:T.displayStyle)||void 0===m?void 0:m.metadataRibbon)&&void 0!==y?y:null===(A=null==s?void 0:s.displayStyle)||void 0===A?void 0:A.metadataRibbon
const P=function(e,t,n,s,a,c=f6){if(o(s))return[]
const l=[],u=new Set
for(const d of s)if(!o(d))for(const o of d){const s=c[o]
if(r(s))continue
const d=s(e,t,n,u,a.metricsOptions)
if(i(d)){l.push(...d)
break}}return l}(e,t,n,b,a),I=function(e,t,n,s,a,c=f6){if(o(s))return[]
const u=l(t.meta,"associations.tags.data"),d=[]
let f=0,h=0
const w=new Set
for(const l of s){const s=Array.isArray(l)?l:[l]
if(!o(s))for(const o of s){const s=o===z$
let l,g=t,v=""
if(o===v_){const n=p(t,vV);(0,Hv.isSome)(null==n?void 0:n.rankedSecondaryGenreShortDisplayNames)&&(v=null==n?void 0:n.rankedSecondaryGenreShortDisplayNames[h]),(0,Hv.isSome)(v)?(l=wd(e,v,0,w,a.metricsOptions),h+=1):l=[]}else{const i=c[o]
if(r(i))continue
g=s?u[f]:t,l=i(e,g,n,w,a.metricsOptions),f=s?f+1:f}if(i(l)){d.push(...l)
for(const e of l)(0,Hv.isSome)(e.impressionMetrics)&&Oh(a.metricsOptions.locationTracker)
break}}}return d}(e,t,n,S,a)
n.metadataRibbonItems=P,n.searchTagRibbonItems=I,n.shouldEvenlyDistributeRibbonItems=!e.bag.isLLMSearchTagsEnabled}function md(e,t,n,r,o,i){t&&qv.context("copyDataIntoLockup",()=>{var s,a,c,u,d,h
const p=H(t,wq)
if(r.isContainedInPreorderExclusiveShelf&&!p)return null
const w=null!==(s=null==r?void 0:r.attributePlatformOverride)&&void 0!==s?s:rt(e),g=Ge(e,t)
n.productVariantID=Ve(g),r.metricsOptions.productVariantData=g,n.adamId=t.id
const v=Qe(e,t,yq,null==r?void 0:r.attributePlatformOverride)
n.bundleId=v,n.decorations=[]
let m=null
r&&r.clientIdentifierOverride&&(m=r.clientIdentifierOverride),n.icon=tf(e,t,{useCase:r.artworkUseCase,withJoeColorPlaceholder:r.useJoeColorIconPlaceholder,joeColorPlaceholderSelectionLogic:r.joeColorPlaceholderSelectionLogic,overrideTextColorKey:r.overrideArtworkTextColorKey},m,g,r.attributePlatformOverride),r&&r.titleObjectPath?n.title=Qe(e,t,r.titleObjectPath,null==r?void 0:r.attributePlatformOverride):n.title=j(t,fW),n.useAdsLocale=r.metricsOptions.isAdvert&&(0,Wv.isSome)(e.bag.adsOverrideLanguage)
const y=qf(e,t,null==r?void 0:r.attributePlatformOverride)
y&&!r.shouldHideArcadeHeader&&(n.heading=r.metricsOptions.isAdvert?e.adsLoc.string(iR):e.loc.string(iR)),r.shouldShowFriendsPlayingShowcase&&n.decorations.push("showcaseFriendsPlaying")
const A=!y&&!p&&(null===(a=r.isMultilineTertiaryTitleAllowed)||void 0===a||a)
if(r.isSubtitleHidden||function(e,t,n){return qv.context("isBadgeMultilineFromData",()=>{if(!n)return!1
if(!Af(0,t,!1))return!1
if(Pd(e,t))return!1
const r=pf(e,t)
return Pf(r,Kq)||Pf(r,nW)})}(e,t,A)||(n.subtitle=Td(e,t,r)),n.tertiaryTitle=bd(e,t,A,r.hideCompatibilityBadge),n.tertiaryTitleAction=Sd(e,t),n.tertiaryTitleArtwork=null,n.developerTagline=Qe(e,t,RH,null==r?void 0:r.attributePlatformOverride),n.editorialTagline=Wf(e,t,Rj,!1,null==r?void 0:r.attributePlatformOverride),n.editorialDescription=Wf(e,t,aW,!1,null==r?void 0:r.attributePlatformOverride),n.shortEditorialDescription=Wf(e,t,tV,!1,null==r?void 0:r.attributePlatformOverride),n.ageRating=or(0,t,!0),n.productDescription=Qe(e,t,LG,null==r?void 0:r.attributePlatformOverride),null!==(c=null==r?void 0:r.shouldShowSupportedPlatformLabel)&&void 0!==c&&c&&function(e,t,n,r){const o=pf(e,t),i=Af(0,t,!1)
if(If(e,t,o,e.client.deviceType,i,!1))return
const s=o.filter(t=>t!==e.client.deviceType)
if(0!==s.length)if(n.tertiaryTitleIcons=s.map(e=>Kf(e)),1===s.length){const t=Nf(e,s[0])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.OnlyAvailable.Message").replace("@@platform@@",t)}else{const t=Nf(e,s[0]),r=Nf(e,s[1])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.AvailableOnTwo.Message").replace("@@platform1@@",t).replace("@@platform2@@",r)}}(e,t,n),!la(e,t)&&(q(t,sR)>0||!r||!r.hideZeroRatings)){n.rating=q(t,aR)
const o=q(t,sR),i=r.metricsOptions.isAdvert?e.bag.adsOverrideLanguage:null
n.ratingCount=e.loc.formattedCountForPreferredLocale(e,o,i)}const T=Js(e,t,r.metricsOptions,r.metricsClickOptions)
bh(e,T,n.title)
const b=wr(e,t,null==r?void 0:r.attributePlatformOverride),P=null!==(u=null==r?void 0:r.includeBetaApps)&&void 0!==u&&u,I=vh(e,t,n.icon,m),C=S(T),k=vr(e,b,t,p,P,I,C,Lq,null==r?void 0:r.referrerData),O=l(b,cR)
let E=br(e,k,t,p,C,Lq,m,r.shouldNavigateToProductPage)
const R=it(e,t,g,q$,w),D=Ut(0,t),_=!D||jt(t),L=_&&(null==R?void 0:R.length)>0,M=(null===(d=null==r?void 0:r.externalDeepLinkUrl)||void 0===d?void 0:d.length)>0
let x;(L||M)&&(x=L?R:r.externalDeepLinkUrl),(0,Wv.isSome)(x)&&(E=ra(e,E,k.adamId,v,x,P,C),(null===(h=r.crossLinkSubtitle)||void 0===h?void 0:h.length)>0&&(n.crossLinkTitle=e.loc.uppercased(j(t,fW)),n.crossLinkSubtitle=r.crossLinkSubtitle)),n.buttonAction=E,n.includeBetaApps=P,n.developerName=j(t,sH),(0,Wv.isNothing)(n.developerName)&&(n.developerName=j(t,eS)),n.children=yd(e,t,r),(0,Wv.isSome)(i)&&i(),Ph(r.metricsOptions.locationTracker)
const $=jo(e,t,m)
if($){const t=new kW,r=S(T)
r.actionType=oB,r.targetType=tW,Qs(e,t,r)
const o=new IY
o.shareAction=t,o.shareSheetData=$,n.contextMenuData=o}const F=null!=o?o:Yd(e,t)
let N=!1
F&&(N=!(Ar(0,wr(e,F))>0))
const B=gd(0,t.type,y)
n.offerDisplayProperties=r?xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,r.offerStyle,r.offerEnvironment,O[0],N,Lq,r.shouldNavigateToProductPage,r.metricsOptions.isAdvert,0,r.parentAppData,r.isBuyDisallowed):xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,null,null,O[0],N,Lq),r&&r.skipDefaultClickAction||(n.clickAction=Gd(e,t,T,{clientIdentifierOverride:m,productVariantData:g,isCppDeepLinkEligible:_})),r&&r.ordinal&&(n.ordinal=r.ordinal)
const U=Ke(e,t,TG,null==r?void 0:r.attributePlatformOverride)
if(U){const e=f(U,OM),t=e&&e===EM
n.isEditorsChoice=t}D||(n.flowPreviewActionsConfiguration=oa(e,t,!1,m,n.clickAction,r.metricsOptions,T,r.externalDeepLinkUrl,n.subtitle,n.title))
const G=Nh(e,t,n,I,r.metricsOptions,r.canDisplayArcadeOfferButton)
Mh(e,n,G)})}function yd(e,t,n){const r=fe(t,dW)
return r?xd(e,r,{lockupOptions:{...n,shouldCreateScreenshotsLockup:null==n?void 0:n.shouldIncludeScreenshotsForChildren},filter:Qv.None}):null}function Ad(e,t,n,r,s,a){var c
if(!t)return
if(s.isNetworkConstrained)return
const l=null!==(c=s.metricsOptions.isAdvert)&&void 0!==c&&c
qv.context("copyMediaIntoMixedMediaLockup",()=>{n.screenshots=uf(e,t,y6.LockupScreenshots,null,s.clientIdentifierOverride,null,l,a)
const c=n.screenshots[0]
n.trailers=[]
const u=af(e,t,r,s.metricsOptions,n.adamId,l,a)
i(u)&&(o(c)||u.mediaPlatform.isEqualTo(c.mediaPlatform))&&n.trailers.push(u)})}function Td(e,t,n=null){return(0,Wv.isNothing)(t)?null:qv.context("subtitleFromData",()=>{let r
return n&&n.subtitleObjectPath&&(r=Qe(e,t,n.subtitleObjectPath,null==n?void 0:n.attributePlatformOverride)),o(r)&&(r=Qe(e,t,RH,null==n?void 0:n.attributePlatformOverride)),r||Id(e,t,n)})}function bd(e,t,n=!1,r){return qv.context("badgeFromData",()=>{if(r)return null
const o=Af(0,t,!1)
if(o){let r=""
const i=pf(e,t)
if(Pf(i,Kq)?r="Platform.DesignedForPad":Pf(i,nW)&&(r="Platform.DesignedForPhone"),(null==r?void 0:r.length)>0)return o&&(Pd(e,t)||(r+=".NotVerified",n&&(r+=".Expanded"))),e.loc.string(r)}return null})}function Sd(e,t){return qv.context("badgeActionFromData",()=>{if(!Af(0,t,!1))return null
if(Pd(e,t))return null
const n=pf(e,t)
if(!Pf(n,Kq)&&!Pf(n,nW))return null
const r=new EY(Tq)
return r.pageUrl=`https://apps.apple.com/story/id${e.bag.appleSiliconMacUnverifiedBadgeEditorialItemId}`,r})}function Pd(e,t){if(!e.appleSilicon.isSupportEnabled)return!0
const n=Xe(e,t,fR,kq)
return!!i(n)&&n}function Id(e,t,n=null){return qv.context("categoryFromData",()=>{const r=Qe(e,t,cV,null==n?void 0:n.attributePlatformOverride)
if((null==r?void 0:r.length)>0)return r
const o=we(t,DN)
if(o.length>0){let e=o[0]
const t=GK.Games.toString()
if(e.id===t)for(const n of o){const r=j(n,_M)
if(n.id!==t&&r===t){e=n
break}}return j(e,fW)}{const e=G(t,hR)
return e.length>0?e[0]:null}})}function Cd(e,t,n){return qv.context("lockupFromData",()=>{var r,i,s,a,c,l,u,d
if(!t)return qv.unexpectedNull(SH,Gj),null
const h=Ut(0,t)
n.metricsOptions.isAdvert=h
const p=cn(e,null===(i=null===(r=n.metricsOptions.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===i?void 0:i.placementType,n.metricsOptions.locationTracker,!0)
if(n.metricsOptions.isAdEligible=p,(h||p)&&(null===(a=null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a||a.apply(e,t)),h&&(null===(l=null===(c=n.metricsOptions.pageInformation)||void 0===c?void 0:c.adPageInfo)||void 0===l||l.setTemplateType(e,rG)),!W(t))return null
switch(t.type){case JH:return n.offerEnvironment=nS,kd(e,t,n)
case iW:const r=pe(e,t,Jq)
if(o(r))return null
const i=new kY
return md(e,r,i,n),i
case TV:case VV:return function(e,t,n){return qv.context("appPromotionOfferLockupFromData",()=>{var r,o,i
const s=null!==(r=Yd(e,t))&&void 0!==r?r:n.parentAppData,a=Wd(e,t)
if(H(s,ZF)){const r=kd(e,t,n)
if((0,Wv.isNothing)(r))return null
r.offerDisplayProperties.titles[aW]=e.loc.string(rS),r.offerDisplayProperties.isStreamlinedBuy=!0,r.offerDisplayProperties.hasDiscount=!1
const o=B(a,oW),i=ci(e,s,oW),c=Zd(e,o,{useCase:n.artworkUseCase,withJoeColorPlaceholder:n.useJoeColorIconPlaceholder,style:tG,overrideTextColorKey:n.overrideArtworkTextColorKey})
return r.icon=null!=c?c:i,r}{const r=new kY
md(e,s,r,n)
const c=Js(e,t,n.metricsOptions,n.metricsClickOptions)
bh(e,c,r.title)
const l=Qe(e,s,yq),u=j(a,rj),d=j(s,tS),h=new _Y(u,s.id,l,r.buttonAction,d)
if(h.appTitle=null!==(o=j(s,fW))&&void 0!==o?o:"",h.productTitle=null!==(i=j(a,fW))&&void 0!==i?i:"",t.type===VV){const e=f(zd(a),dR);(0,Wv.isSome)(e)&&e.length>0&&(h.additionalBuyParams="adHocOfferId="+e)}else h.additionalBuyParams="contingentItemId="+t.id
return r.buttonAction=h,Ph(n.metricsOptions.locationTracker),r}})}(e,t,n)
default:const s=new kY
return md(e,t,s,n),(0,Wv.isSome)(null===(u=n.metricsOptions.pageInformation)||void 0===u?void 0:u.adPageInfo)&&((h||p)&&Gt(e,t,s,n.metricsOptions,!0),h&&(null===(d=s.searchAdOpportunity)||void 0===d||d.setTemplateType(rG))),s}})}function kd(e,t,n){return qv.context("inAppPurchaseLockupFromData",()=>function(e,t,n){return t?qv.context("makeInAppPurchaseLockup",()=>{var r
const o=null!==(r=Yd(e,t))&&void 0!==r?r:n.parentAppData
if((0,Wv.isNothing)(o))return null
const i=H(o,ZF),a=Wd(e,t)
if((0,Wv.isNothing)(a))return null
t=a
const c=new OY
md(e,t,c,n,o),c.productIdentifier=j(t,rj),c.parent=Cd(e,o,n),c.description=j(t,LG),c.isVisibleByDefault=H(t,"isMerchandisedVisibleByDefault"),c.isSubscription=H(t,RM)
const u=wr(e,t),d=l(u,cR)
c.offerDisplayProperties&&(c.offerDisplayProperties.hasDiscount=d.length>0,c.offerDisplayProperties.subscriptionFamilyId=j(t,"subscriptionFamilyId"))
const h=new EY(lR)
h.presentationContext=Wj
const p=function(e,t,n){const r=(new YJ).param(zW.id,n).param(YW,t).build()
return`${OW}:/${xW.product}/${xW.install}/?${r}`}(0,c.adamId,o.id)
h.pageUrl=p
const w=new DY
w.parentLockup=S(c.parent),w.lockup=S(c),w.preInstallOfferDescription=qo(e,u),h.pageData=w
const g=j(t,rj),v=Qe(e,o,yq),m=j(o,tS),y=s(zd(t)),A=Nh(e,t,c,tG,n.metricsOptions,n.canDisplayArcadeOfferButton)
if(bh(e,A,c.title),i&&y){const r=new _Y(g,o.id,v,c.parent.buttonAction)
c.parent&&(r.appTitle=c.parent.title),r.productTitle=c.title,r.streamlineBuyAction=function(e,t,n,r,o){var i
const a={...o.metricsOptions,id:n.id,targetId:n.id,idType:Sq,actionDetails:{parentAdamId:n.id}},c=vh(e,t,r.icon,o.clientIdentifierOverride),l=S(a),u=zd(t),d=wr(e,t),h=wr(e,n),p=new oK(f(h,Sj))
let w=null!==(i=f(u,Sj))&&void 0!==i?i:f(d,Sj)
w+=`&appAdamId=${f(n,"id")}`,w+=`&appExtVrsId=${p.get(DM,"")}`,w+=`&bid=${Qe(e,n,yq)}`,w+="&bvrs=1.0",w+=`&offerName=${Qe(e,t,rj)}`
const g=f(u,dR)
return s(g)&&(w+=`&adHocOfferId=${g}`),d[Sj]=w,vr(e,d,t,!1,!1,c,l,Lq,null==o?void 0:o.referrerData,!1,n.id)}(e,t,o,c,n),c.buttonAction=r,c.subtitle=j(o,fW)}else if(m){const t=new _Y(g,o.id,v,h,m)
c.parent&&(t.appTitle=c.parent.title),t.productTitle=c.title
const r={...n.metricsOptions,id:c.adamId,idType:Sq,actionDetails:{parentAdamId:o.id}}
Qs(e,t,r),c.buttonAction=t}else{const t=new LY(Lq)
t.title=e.loc.string("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),t.message="",t.isCancelable=!0,c.buttonAction=t}if(Ph(n.metricsOptions.locationTracker),!n||!n.skipDefaultClickAction){const n=Nd(e,t,A)
c.clickAction=n,c.productAction=n}return function(e,t,n){t&&(t.impressionMetrics||Mh(e,t,n),t.parent&&t.parent.adamId&&(0,Hv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields.parentAdamId=fh(t.parent.adamId)))}(e,c,A),c},uR):null}(e,t,n))}function Od(e,t,n){return qv.context("screenshotsLockupFromData",()=>{const r=new MY
return function(e,t,n,r){t&&qv.context("copyDataIntoScreenshotsLockup",()=>{md(e,t,n,r),n.screenshots=uf(e,t,y6.LockupScreenshots,null,r.clientIdentifierOverride)})}(e,t,r,n),r})}function Ed(e,t,n){return qv.context("posterLockupFromData",()=>{const o=new xY
return function(e,t,n,o){t&&qv.context("copyDataIntoPosterLockup",()=>{md(e,t,n,o),n.epicHeading=function(e,t){const n=Ke(e,t,"editorialArtwork.epicHeading")
return i(n)&&i("bb")?Zd(e,n,{cropCode:"bb",useCase:y6.Default}):null}(e,t),n.posterArtwork=function(e,t){const n=Ke(e,t,"editorialArtwork.postCard")
return i(n)?Zd(e,n,{cropCode:"sr",useCase:y6.Default,withJoeColorPlaceholder:!0}):null}(e,t),n.posterVideo=function(e,t,n){const o=Ke(e,t,[Oq,MT]),s=Zd(e,Ke(e,t,[Oq,MT,UG]),{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(o)){const e=f(o,rq)
return r(e)?null:new mz(e,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},autoPlayPlaybackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}})}return null}(e,t,y6.GroupingHero),n.offerDisplayProperties&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,uq,TU)),n.posterVideo?n.isDark=be(n.posterVideo.preview.backgroundColor):n.posterArtwork?n.isDark=be(n.posterArtwork.backgroundColor):n.isDark=!1
const s=et(e,t,jG)
if(et(e,t,wq)){const r=s?e.loc.string("Offer.Label.ComingSoon"):null
let o
o=e.loc.uppercased(nh(e,t,r)),(0,Wv.isSome)(o)&&(n.footerText=o)}})}(e,t,o,n),o})}function Rd(e,t,n,r,o=null,i){return qv.context("mixedMediaLockupFromData",()=>{var s,a,c
const l=new FY
if(md(e,t,l,n,null,()=>{vd(e,t,l,o,n),Ad(e,t,l,r,n,i),_d(e,t,l,o)}),(0,Wv.isSome)(null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)){const r=cn(e,null===(c=null===(a=n.metricsOptions.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,n.metricsOptions.locationTracker,!0,o)
n.metricsOptions.isAdEligible=r,r&&Gt(e,t,l,n.metricsOptions,!0)}return l})}function Dd(e,t,n,r){const o=t.type===Xq?pe(e,t,bH):t,i=Cd(e,o,n),s=nt(e,o),a=fd(e,o,r),c=fd(e,t,r),l=null==a?void 0:a.artwork,u=null==c?void 0:c.artwork
let d,f
if((0,Wv.isSome)(u),(0,Wv.isSome)(l)&&(f=ld(0,a),d=l),(0,Wv.isSome)(d)&&(0,Wv.isSome)(i)){const e=new NY(d,i,null,null,f)
return e.caption=ce(o,s,mG),(0,Wv.isSome)(e.caption),e.title=ce(o,s,iV)||j(o,cV),e.impressionMetrics=i.impressionMetrics,e}return null}function _d(e,t,n,r){var o
if(!e.client.isPhone)return
const s=f(t.meta,"imageLockupFromData")
i(s)?n.screenshotsDisplayStyle=s:i(null===(o=null==r?void 0:r.displayStyle)||void 0===o?void 0:o.screenshots)&&(n.screenshotsDisplayStyle=r.displayStyle.screenshots)}function Ld(e,t,n,r,o,i=!0,s){return qv.context("mixedMediaAdLockupFromData",()=>{const a=new FY
return H(t,"iad.format.images")?(Ad(e,t,a,r,n),function(e,t,n,r){var o
if(!function(e,t){const n=function(e,t,n){const r=Ge(e,t)
return(0,Wv.isNothing)(r)?null:Ye(r,n)}(e,t,kM)
return!n}(e,t))return
const i=G(t,"iad.assetOverride")
if(i.length){const e=function(e,t,n){const r=new Set(n),o=[],i=[],s=function(e,t){if(0===r.size)return!1
for(const o of n)if(o===t||-1!==e.indexOf(o))return r.delete(o),!0
return!1}
if(n.length&&(t.screenshots.length||t.trailers.length)){if(t.trailers.length)for(const e of t.trailers[0].videos)s(e.videoUrl,e.preview.checksum)&&o.push(e)
if(t.screenshots.length)for(const e of t.screenshots[0].artwork)s(e.template,e.checksum)&&i.push(e)}return!(0!==r.size||!o.length&&!i.length||(t.trailers.length&&(t.trailers[0].videos=o),t.screenshots.length&&(t.screenshots[0]=new Tz(i,t.screenshots[0].mediaPlatform)),0))}(0,n,i)
if(r.pageInformation.adPageInfo&&r.pageInformation.adPageInfo.adIsPresent){r.pageInformation.adPageInfo.setSpecifiedCreativeUsed(e)
const t=null!==(o=r.adsMetricsData)&&void 0!==o?o:{}
t[Jb]=e,r.adsMetricsData=t}}}(e,t,a,n.metricsOptions),md(e,t,a,n,null,()=>{_d(e,t,a,o),vd(e,t,a,o,n)})):(md(e,t,a,n,null,()=>{vd(e,t,a,o,n)}),a.screenshots=[]),Gt(e,t,a,n.metricsOptions,i,s),a})}function Md(e,t,n,r,i,s){return qv.context("arcadeLockupFromData",()=>{const a=t.marketingItemData,c=new BY
c.title=e.loc.string("ARCADE_LOCKUP_TITLE","Apple Arcade")
const l=t.marketingItemData
n={...n,mercuryMetricsData:mh(0,l)}
let u,d=Fc(0,a);(null==d?void 0:d.length)>0&&(d=d.replace(/\n/g," "),c.nonsubscribedSubtitle=d,c.subscribedSubtitle=d)
const f=$c(0,a)
u=Bc(e,t.marketingItemData,r,n),u.title=f,c.unsubscribedButtonAction=u
const h=no(0,n.pageInformation,n.locationTracker)
h.title=e.loc.string($B,FB),c.subscribedButtonAction=h
const p=Bh(e,t.marketingItemData,c.title,n)
p.displaysArcadeUpsell=!0,o(p.targetType)&&(p.targetType=tW),Mh(e,c,p)
const w=new UY(sW,e.bag.arcadeAppAdamId,null,i,null,s,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
return w.titles[EU]=e.loc.string($B,FB),c.offerDisplayProperties=w,c})}function xd(e,t,n){return r(t)?[]:$d(e,t.data,n)}function $d(e,t,n){return qv.context("lockupsFromData",()=>{var o
if(!t)return[]
const s=[]
let a=!1
for(let c=0;c<t.length&&!a;c++){const l=t[c]
if(!W(l)){n.contentUnavailable&&(a=n.contentUnavailable(c,l))
continue}const u=n.lockupOptions
let d=Qv.All
if(n.includeOrdinals){const r=n.ordinalDirection===oS?t.length-c:c+1
u.ordinal=e.loc.decimal(r).toString()}if(i(n.filter)&&(d=n.filter),at(e,l,d)&&!n.shouldShowOnUnsupportedPlatform)continue
const f=null!==(o=n.lockupOptions.shouldCreateScreenshotsLockup)&&void 0!==o&&o?Od(e,l,u):Cd(e,l,u)
!r(f)&&f.isValid()&&(s.push(f),Oh(n.lockupOptions.metricsOptions.locationTracker))}return s})}function Fd(e,t,n,r,s=null,a){return qv.context(`actionFromData: ${t.type}`,()=>{switch(t.type){case dW:case Zq:return Gd(e,t,n,{clientIdentifierOverride:r,externalDeepLinkUrl:s,isCppDeepLinkEligible:a})
case JH:return Nd(e,t,n)
case Xq:return Ud(e,t,n,r)
case IV:case XH:return function(e,t,n){return t?qv.context("editorialPageActionFromData",()=>{const r=new EY(wW)
{const n=t.href
if(o(n))return qv.unexpectedNull(SH,Bq,AG),null
r.pageUrl=Fi(e,n)}return r.title=zf(e,t,fW),o(r.title)&&(r.title=j(t,fW)),Qs(e,r,n),r}):null}(e,t,n)
case LM:return function(e,t,n){return t?qv.context("msoActionFromPlatformData",()=>{const r=j(t,Wq)
if(!r)return qv.unexpectedNull(SH,Bq,Wq),null
const o=new EY(ON)
return o.pageUrl=r,o.title=j(t,fW),Qs(e,o,n),o}):null}(e,t,n)
case MV:return function(e,t,n){return t?qv.context("groupingActionFromData",()=>{if(!t.href)return qv.unexpectedNull(SH,Bq,AG),null
const r=new EY(wW)
return r.pageUrl=ve(e,function(e,t){const n=[$q,Oq,iH,aH,IH,CV]
e.appleSilicon.isSupportEnabled&&n.push(kH),e.bag.enableUpdatedAgeRatings&&n.push(Eq),nf(e)&&n.push(TH)
const r=new dY(e,t).includingAttributes(n).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported()
oi(e)&&(r.enablingFeature(zH),r.includingScopedAttributes(iW,YK),r.includingScopedRelationships(iW,[Jq]),r.includingScopedRelationships(rT,[iW]))
const o=ne(e)
return i(o)&&r.addingQuery(FG,o),r}(e,t.href)).toString(),r.title=Hd(0,t),Qs(e,r,n),r}):null}(e,t,n)
default:return function(e,t,n){return t?qv.context("genericActionFromData",()=>{const r=f(t,kV),o=j(t,Wq)
if(!o)return qv.unexpectedNull(SH,Bq,Wq),null
const i=new EY(wW)
return i.pageUrl=o,i.title=r===MV?Hd(0,t):j(t,fW),Qs(e,i,n),i}):null}(e,t,n)}})}function Nd(e,t,n){return qv.context("iAPActionFromData",()=>{var r
const o=Yd(e,t)
if(!o)return null
const s=new EY(yH),a=az.from(j(o,Wq)),c=Ve(null!==(r=n.productVariantData)&&void 0!==r?r:Ge(e,o))
i(c)&&a.param(zW.productVariantID,c)
const l=a.toString(),u=j(t,rj),d=H(t,RM)
return s.pageUrl=function(e,t,n,r){const o=(new YJ).param(JW,t).param(zW.offerName,n).param(KW,r.toString()).build()
return`${OW}:/${xW.product}/${xW.lookup}/?${o}`}(0,l,u,d),s.title=j(t,fW),Qs(e,s,n),s})}function Bd(e,t){return o(t)?h6:qv.context(iS,()=>{if(function(e){const t=f(e,v$)
return t&&t===LL}(B(t,Mq)))return p6
const e=j(t,sS),n="List"===e||"NumberedList"===e
if(H(t,uU)||n)return w6
const r=we(t,bH),o=we(t,OH),i=s(r)&&1===r.length,a=s(o)&&1===o.length
return a&&o[0].type===iW||i&&r[0].type===iW?v6:a?g6:h6})}function Ud(e,t,n,a,c,l){return o(t)?null:qv.context(iS,()=>{var u
let d,h,p
switch(Bd(0,t)){case p6:return function(e,t,n){return qv.context("editorialItemExternalLinkActionFromData",()=>{const r=f(B(t,Mq),Wq),o=new GY(r),i=Wf(e,t,tV)
if(i)o.title=i
else{const e=new az(r)
o.title=e.host}return Qs(e,o,n),o})}(e,t,n)
case w6:d=Tq
const p=az.from(j(t,Wq))
i(c)&&p.param(zW.recoMetrics,JSON.stringify(c)),(0,Wv.isSome)(l)&&!l.isHorizontalShelfContext&&p.param(zW.todayCardConfig,JSON.stringify(l))
const w=null===(u=N(t))||void 0===u?void 0:u.id;(0,Wv.isSome)(w)&&p.param(zW.editorialCardId,w),h=p.build()
break
case g6:const g=we(t,OH)[0]
return Fd(e,g,n,a)
case v6:const v=we(t,bH),m=s(v)&&1===v.length?v[0]:we(t,OH)[0],y=pe(e,m,Jq)
if(o(y))return null
const A=wi(e,m,y,!1,!1,Gq,BH,!1,n,!1,!0,null,!1,!1)
return r(A)||A instanceof Date?null:fi(e,m,y,A,n,!0)
case m6:d=wW,h=Fi(e,t.href)
break
default:d=qq,h=f(B(t,Mq),Wq)}if((0,Wv.isNothing)(h))return null
const w=new EY(d)
w.pageUrl=h,(0,Wv.isSome)(p)&&(w.presentation=p)
let g=Wf(e,t,fW)
return r(g)&&(g=f(t,YH)),w.title=g,Qs(e,w,n),w})}function Gd(e,t,n,r){var o,s,a,c
if(!t)return null
const l=null!==(o=r.clientIdentifierOverride)&&void 0!==o?o:null,u=null!==(s=r.externalDeepLinkUrl)&&void 0!==s?s:null,d=!(null!==(a=r.isCppDeepLinkEligible)&&void 0!==a&&a),h=null!==(c=r.productVariantData)&&void 0!==c?c:Ge(e,t)
return qv.context("productActionFromData",()=>{var r,o,s
let a=j(t,Wq)
if(!a)return qv.unexpectedNull(SH,Bq,Wq),null
let c={}
const p=new az(a)
if(n.isAdvert){const o=f(t,aS)
null!==o&&o.length>0&&p.param(eK,o)
const i=null===(r=n.pageInformation.adPageInfo)||void 0===r?void 0:r.clickFields
Object.assign(i,n.adsMetricsData),p.param(XJ,JSON.stringify(i)),c={iAdClickFields:y(i),iAdLineItem:o}
const s=fn(0,t)
if((0,Wv.isSome)(s)){const r=qf(e,t)?xB:IM,o=Yt(0,n.pageInformation),i=j(t,CM),a=H(t,wq)?ZV:aW,l=new HY(s,t.id,i,r,"productPageDismissed",a,o)
p.param(tK,JSON.stringify(l)),c.iAdDismissAdActionMetrics=y(l)}}const w=Ve(h)
i(w)&&p.param(zW.productVariantID,w),c.externalDeepLinkUrl=u,i(u)&&p.param(X0,u),ru(e).platform,jd(e,t)
{c.isCppDeepLinkDisabled=d,p.param(e1,d.toString())
const e=null===(s=null===(o=n.pageInformation)||void 0===o?void 0:o.searchTermContext)||void 0===s?void 0:s.term;(0,Wv.isSome)(e)&&p.param(ZH,e),c.clientIdentifierOverride=l,(null==l?void 0:l.length)>0&&p.param(cS,l)}a=p.toString()
const g=new EY(yH)
g.pageUrl=a,g.pageData=td(e,t,c),g.title=j(t,fW),n&&n.pageInformation&&(g.referrerUrl=n.pageInformation.pageUrl)
const v=H(t,wq)
Qs(e,g,v?{...n,offerType:ZV,offerReleaseDate:yr(0,t)}:n,!0)
const m=f(t,"id")
return(0,Wv.isSome)(m)&&(g.destination=t.type===Zq?function(e){const{id:t,platform:n,lic:r,...o}=e
return{$kind:"BundlePageIntent",id:dt(t),platform:ut(n),lic:r,...o}}({...Di(e),id:m}):function(e){const{id:t,platform:n,ppid:r,lic:o,...i}=e
return{...i,$kind:"ProductPageIntent",id:dt(t),platform:ut(n),ppid:r,lic:o}}({...Di(e),platform:Vd(e,t),id:m})),g})}function jd(e,t){try{return function(e,t){const n=(0,Wv.unwrapOptional)(yt(e,t)),r=new Set(Fe(e,n,!0))
if(r.has(_q))return _q
if(r.has(Dq))return Dq
if(r.has(lW))return lW
if(r.has(XV))return Qq
if(r.has(QG))return"tv"
if(r.has(cW))return cW
throw new Error("Could not infer platform from device families")}(e,{data:[t]})}catch(t){return void e.console.error(`Error inferring preview platform from data: ${t}`)}}function Vd(e,t){return ru(e).platform||jd(e,t)}function Hd(e,t){const n=G(t,hR)
return s(n)?n[0]:j(t,fW)}function qd(e,t){if(!t)return!1
if(e.client.isCompanionVisionApp)return!0
const n=function(e,t,n){return Qe(e,t,Af(0,t,n)?kH:aH)}(e,t,e.appleSilicon.isSupportEnabled)
if(o(n))return!0
const r=n.split(" ")
return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(r,!1)}function Wd(e,t){if(!t)return null
switch(t.type){case TV:return pe(e,t,sU)
case VV:return pe(e,t,aU)}return t}function zd(e){if(!e)return null
const t=p(e,qF)
if(s(t))return t
const n=p(e,fL)
return s(n)?n:null}function Yd(e,t){if(!t)return null
switch(t.type){case TV:return pe(e,t,l$)
case VV:const n=pe(e,t,aU)
return pe(e,n,Jq)}return pe(e,t,Jq)}function Jd(e,t){t.bag.arcadeDownloadPacksMetricsEventsEnabled||(e.clickAction.actionMetrics.clearAll(),e.buttonAction.actionMetrics.clearAll(),gt(e.buttonAction)&&e.buttonAction.defaultAction.actionMetrics.clearAll()),t.bag.arcadeDownloadPacksImpressionEventsEnabled||(e.impressionMetrics=null)}function Kd(e,t){switch(t){case sN:case lE:case Iq:return y6.LockupIconSmall
case oq:return y6.LockupIconMedium
case mB:return y6.LockupIconLarge
default:return y6.Default}}function Zd(e,t,n){return qv.context("artworkFromApiArtwork",()=>{var o,s,a
const c=!!i(n.allowingTransparency)&&n.allowingTransparency,l=!!i(n.withJoeColorPlaceholder)&&n.withJoeColorPlaceholder,d=f(t,Wq)
if(r(d))return null
const p=u(t,"hasP3"),w=[kt(e,c,p,n.useCase)]
u(t,"supportsLayeredImage")
let g=null
if(c)g=Se(NG)
else if(l){const e=ih(t),i=ye(null!==(s=null===(o=n.joeColorPlaceholderSelectionLogic)||void 0===o?void 0:o.call(n,e))&&void 0!==s?s:f(t,oj))
r(i)||(g=i)}r(g)&&(g=Se(uE))
const v=null!==(a=n.overrideTextColorKey)&&void 0!==a?a:VL,m=ye(f(t,v)),y=new pz(d,n.overrideWidth||h(t,fG),n.overrideHeight||h(t,BG),w)
return y.backgroundColor=g,y.checksum=f(t,dE),i(m)&&(y.textColor=m),i(n.style)&&(y.style=n.style),i(n.cropCode)&&(y.crop=n.cropCode),i(n.contentMode)&&(y.contentMode=n.contentMode),y})}function Qd(e,t,n,r){return qv.context(bT,()=>{const o=tf(e,t,r)
if(!i(o))return null
const s=new wz(o),a=j(t,fW),c=Bh(e,t,a,n)
return Mh(e,s,c),s})}function Xd(e,t,n,r){return qv.context(bT,()=>{const i=[]
o(n.targetType)&&(n.targetType=oW)
for(const o of t){const t=Qd(e,o,n,r)
t&&(i.push(t),Oh(n.locationTracker))}return i})}function ef(e,t,n,r){const i=Ke(e,t,"editorialArtwork.searchCategoryBrick")
if(o(i))return null
let s=r
n===Nm.seeAllPage&&(s=Jv.Density1)
let a=[],c=[]
switch(s){case Jv.Density1:const e=n===Nm.categoryBreakout?"1191":"2350"
i[fG]=e,i[BG]=HL,a=[ST,"SCB.ApSCBL03"],c=[Kv.right,Kv.left]
break
case Jv.Density2:i[fG]="2482",i[BG]=HL,a=["SCB.ApSCBS01","SCB.ApSCBS02"],c=[Kv.left,Kv.right]
break
case Jv.Density3:i[fG]=HL,i[BG]=HL,a=["cc"],c=[Kv.scaleAspectFit]}return a.map((t,n)=>Zd(e,i,{cropCode:t,contentMode:n<c.length?c[n]:null,useCase:y6.Default,withJoeColorPlaceholder:!0}))}function tf(e,t,n,o,s,a){return qv.context("iconFromData",()=>{if(!t)return qv.unexpectedNull(SH,Gj),null
const c=null!=a?a:of(e,t,o),l=rf(e,t),u=o||e.host.clientIdentifier,d=function(e,t,n,r,o,i){if(r!==iY&&!et(e,t,DG))return null
if(o){const r=se(t,i,PT)
if((0,Wv.isSome)(r))return Zd(e,r,{...n,style:qL,cropCode:"bb",withJoeColorPlaceholder:!0})}const s=se(t,i,fE)
if((0,Wv.isSome)(s)){const t=o?qL:k$,r=o?"ic":void 0
return Zd(e,s,{...n,style:t,cropCode:r,withJoeColorPlaceholder:!0})}return null}(e,t,n,u,l,c)
if((0,Wv.isSome)(d))return d
const f=function(e,t,n,r,o){const s=jf(e,t),a=Uf(e,t)&&(r===sY||s),c=se(t,o,hE)
return a&&i(c)?Zd(e,c,{...n,style:aN}):null}(e,t,n,u,c)
if((0,Wv.isSome)(f))return f
const h=function(e,t,n){if(t.type!==JH)return null
const r=B(t,oW)
return(0,Wv.isSome)(r)?Zd(e,r,{...n,style:tG}):null}(e,t,n)
if((0,Wv.isSome)(h))return h
const p=function(e,t,n,r){if(t.type!==Zq)return null
if(r){const r=B(t,TH)
if((0,Wv.isSome)(r))return Zd(e,r,{...n,style:yB,cropCode:"bb"})}const o=B(t,oW)
if((0,Wv.isSome)(o)){const t=r?yB:fB,i=r?"ia":void 0
return Zd(e,o,{...n,style:t,cropCode:i,allowingTransparency:!0})}return null}(e,t,n,l)
if((0,Wv.isSome)(p))return p
r(s)&&(s=Ge(e,t))
const w=ot(e,t,s,oW,c),g=function(e,t,n,r,o){return o!==nV&&r!==cY?null:Zd(e,t,{...n,style:WL})}(e,w,n,u,c)
if((0,Wv.isSome)(g))return g
const v=function(e,t,n,r,o){return o!==nH&&r!==xz?null:Zd(e,t,{...n,style:k$})}(e,w,n,u,c)
return(0,Wv.isSome)(v)?v:function(e,t,n,r,o,i,s){const a=s===lH,c=a&&!0
if(o){const n=ot(e,t,i,TH,s)
if((0,Wv.isSome)(n))return Zd(e,n,{...r,style:yB,cropCode:"bb",allowingTransparency:c})}let l,u
return o?(l=yB,u=a?"ib":"ia"):(l=a?cN:fB,u="bb"),Zd(e,n,{...r,style:l,cropCode:u,allowingTransparency:c})}(e,t,w,n,l,s,c)})}function nf(e){return ar(e,e.bag.iconArtworkRolloutRate)&&e.bag.enableIconArtwork&&!0}function rf(e,t){const n=pf(e,t),r=e.bag.enableIPadOnlyFallbackIcons&&-1!==n.indexOf(Kq)&&-1===n.indexOf(nW)
return nf(e)&&!r}function of(e,t,n){switch(n){case iY:case sY:return kq
case cY:return nV
case xz:return nH
default:return nt(e,t,n)}}function sf(e,t,n,r){if(!t)return null
const o=Kf(t),i=Zf(0,n),s=function(e,t){switch(t){case JL:return 13/G6.width
case YL:return 11/j6.width
case zL:return 5.5/V6.width
case O$:return i3/H6.width
case E$:return i3/q6.width
default:return null}}(0,n),a=function(e,t){switch(t){case JL:return 30/G6.width
case O$:return o3/H6.width
case E$:return o3/q6.width
default:return Zf(0,t)}}(0,n)
return new gz(t,n,o,r,i,s,a)}function af(e,t,n,r,o,i=!1,s){const a=cf(e,t,n,null,null,i,s)
if(!a)return null
const c=a.videos,l=[]
if(c&&c.length>0)for(const t of c)po(e,t,{...r,id:o}),l.push(t)
let u=null
return l.length>0&&(u=new vz,u.videos=l,u.mediaPlatform=a.mediaPlatform),u}function cf(e,t,n,o=null,s=null,a=!1,c){return qv.context("platformVideoPreviewFromData",()=>{r(s)&&(s=Ge(e,t))
const u=function(e,t,n,r,o){return ot(e,t,n,r?yE:kj,void 0)}(e,t,s,a),d={}
if(!u)return null
let w=hf(e,t,e.host.clientIdentifier,e.client.deviceType)
if(i(o)){const e=[]
for(const t of w)o.includes(t)&&e.push(t)
w=e}if(0===w.length)return null
for(const t of w){const r=Ef(e,t,e.client.screenSize)
for(const t of Object.keys(u)){const r=l(u,t),o=[]
for(const s of r){const r=p(s,UG)
if(!r){qv.unexpectedNull(SH,fV,`videoPreviewsByType.${t}.previewFrame`)
continue}const a=f(s,rq)
if(!a){qv.unexpectedNull(SH,Bq,`videoPreviewsByType.${t}.video`)
continue}const l=Ot(e,f(r,Wq),h(r,fG),h(r,BG),null,null,f(r,dE))
i(c)&&(l.crop=c),o.push(new mz(a,l,n))}d[t]=o}for(const e of r)if(d[e])return new T6(d[e],sf(0,t,e))}return null})}function lf(e,t){return qv.context("videoPreviewsFromApiPlatformData",()=>{const n=cf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
return n?n.videos:[]})}function uf(e,t,n,o=null,i,s,a=!1,c){return qv.context("screenshotsFromData",()=>{const l=[]
r(s)&&(s=Ge(e,t))
let u=o
if(!u||0===u.length){const n=i||e.host.clientIdentifier
let r=e.client.deviceType
n===iY&&(r=cW),i!==xz&&i!==Mz||(r=Qq),u=hf(e,t,n,r)}for(const r of u){const o=[]
let i
if(r===sq?(i=Vf(e,t,kq),Gf(e,t,kq)&&o.push("faceTime")):i="tv"===r?Hf(e,t,s,a,nV):r===Qq?Hf(e,t,s,a,nH):r===lW?Hf(e,t,s,a,lH):Hf(e,t,s,a),!i)continue
const u=ff(e,i,r,n,o,c)
u&&l.push(u)}return l})}function df(e,t,n,r=null,o=null,i){return function(e,t,n){const r=[]
if(n&&n.length>0){const o=n.map(e=>e.mediaPlatform)
for(const i of n){const n=[]
for(const e of i.artwork){const t=new yz
t.screenshot=e,n.push(t)}const s=i.mediaPlatform,a=new Az(n,s,o,mf(e,s),wf(e,t,o),gf(e,t,o))
r.push(a)}}return r}(e,t,uf(e,t,n,r,i,o))}function ff(e,t,n,r,o,i){const a=function(e,t){return t===sq?e.client.deviceType===Kq?Kq:nW:t}(e,n),c=Ef(e,a,e.client.screenSize)
let u,d=null
for(let e=0;e<c.length&&!s(d);e++)d=l(t,c[e]),u=c[e]
if(s(d)){const t=d.map(function(t){return Zd(e,t,{useCase:r,cropCode:i})}),s=sf(0,n,u,o)
return new Tz(t,s)}return null}function hf(e,t,n,r){return $(t,`sortedAppPlatformsFromData.${n}.${r}`,()=>{var o
const i=pf(e,t),s=[]
let a=[]
const c=function(e,t){-1===a.indexOf(e)&&-1===s.indexOf(e)&&-1!==i.indexOf(e)&&(a.push(e),t&&s.push(t))}
switch((null===(o=e.activeIntent)||void 0===o?void 0:o.appPlatform)&&c(e.activeIntent.appPlatform),n!==xz&&n!==Mz||c(Qq),n){case iY:c(cW)
break
case sY:c(sq)}switch(r){case nW:c(nW)
break
case Kq:c(Kq)
break
case"tv":c("tv")
break
case cW:c(cW)
break
case lW:c(lW)
break
case Qq:c(Qq)}return n!==xz&&n!==Mz||(c(Kq),c(nW)),e.appleSilicon.isSupportEnabled?(c(Kq),c(nW)):(c(nW),c(Kq)),c(lW),c(Qq),c("tv"),c(cW),c(sq),a=a.filter(function(e){return-1===s.indexOf(e)}),a})}function pf(e,t){return t?$(t,"supportedAppPlatformsFromData",()=>{const n=Uf(e,t,kq),r=jf(e,t),o=function(e,t){return et(e,t,iH)}(e,t),i=G(t,ij),s=[]
for(const e of i)switch(e){case _q:r||s.push(nW)
break
case Dq:r||s.push(Kq)
break
case QG:s.push("tv")
break
case cW:s.push(cW)
break
case XV:s.push(Qq)}return n&&s.push(sq),o&&s.push(cW),Me(e,t,lW)&&s.push(lW),s}):null}function wf(e,t,n){if(vf(e,t,n)){const t=n[0].appPlatform.toUpperCase()
return e.loc.string(`ONLY_FOR_${t}_APP`)}let r=n.reduce((e,t)=>e.concat(yf(t)),[])
try{return e.loc.tryString(`PLATFORMS_${r.join("_")}`)}catch(t){return r=["PHONE","PAD","MAC","VISION","TV","WATCH","MESSAGES","FACETIME"].filter(e=>r.includes(e)),e.loc.string(`PLATFORMS_${r.join("_")}`)}}function gf(e,t,n){return vf(e,t,n)?"top":"bottom"}function vf(e,t,n){if(1===n.length){const r=n[0],o=Af(0,t,e.appleSilicon.isSupportEnabled),i=!1,s=Pf(Sf(0,e.client.deviceType,o,i),r.appPlatform),a=0===r.supplementaryAppPlatforms.length,c=r.appPlatform!==e.client.deviceType
if(a&&c&&!s)return!0}return!1}function mf(e,t){const n=yf(t)
return e.loc.string(`PLATFORMS_${n.join("_")}`)}function yf(e){const t=e.appPlatform.toUpperCase(),n=e.supplementaryAppPlatforms.map(e=>e.toUpperCase())
return[t].concat(n)}function Af(e,t,n){let r=H(t,hL)
return n&&r}function Tf(e,t){let n
return e.isAvailable(qz)&&[GG,nG].includes(e.client.buildType)&&(0,Wv.isSome)(e.ads.fetchAppBinaryTraitsOverride)&&(n=e.ads.fetchAppBinaryTraitsOverride()),(0,Wv.isNothing)(n)&&(n=ae(t,kq,IT)),n}function bf(e,t,n){if(Af(0,t,n)){const n=Qe(e,t,"minimumMacOSVersion")
if(s(n))return n}return ce(t,nt(e,t),IH)}function Sf(e,t,n,r){switch(t){case nW:return[nW,sq]
case Kq:return[nW,Kq,sq]
case"tv":return["tv"]
case cW:return[cW]
case lW:return n?[lW,nW,Kq]:[lW]
case Qq:return r?[Qq,nW,Kq]:[Qq]
default:return[]}}function Pf(e,t){return-1!==e.indexOf(t)}function If(e,t,n,r,o,i,s=!0){const a=function(e,t,n,r,o){let i
switch(n){case nW:return i=st(e),(0,Wv.isSome)(t)&&i.isSystemAppFromData(t)?[nW,cW,sq]:[nW,cW,sq,"tv",Qq]
case Kq:return i=st(e),(0,Wv.isSome)(t)&&i.isSystemAppFromData(t)?[nW,Kq,sq]:[nW,Kq,sq,"tv",Qq]
case"tv":return["tv"]
case cW:return[cW]
case lW:return r?[lW,nW,Kq]:[lW]
case Qq:return o?[Qq,nW,Kq]:[Qq]
default:return[]}}(e,t,r,o,i)
return!!a.some(e=>Pf(n,e))}function Cf(e,t){var n
const o=new A6
if(e.client.deviceType!==lW)return o
if(t.type!==Zq)return o.runsOnIntel=null===(n=Xe(e,t,"runsOnIntel",rt(e)))||void 0===n||n,o.runsOnAppleSilicon=et(e,t,"runsOnAppleSilicon",rt(e)),o.requiresRosetta=et(e,t,CT,rt(e)),o
const i=we(t,dW)
if(0===i.length)return o
for(const t of i){if(r(t.attributes))continue
const n=Cf(e,t)
o.runsOnIntel=o.runsOnIntel&&n.runsOnIntel,o.runsOnAppleSilicon=o.runsOnAppleSilicon&&n.runsOnAppleSilicon,o.requiresRosetta=o.requiresRosetta||n.requiresRosetta}return o}function kf(e,t,n,r){const o=Cf(e,t)
return n?o.runsOnAppleSilicon&&(!o.requiresRosetta||o.requiresRosetta&&r):o.runsOnIntel}function Of(e,t,n,r,o){const i=function(e,t,n,r){switch(t){case nW:return[nW,cW,sq]
case Kq:return[nW,Kq,sq]
case"tv":return["tv"]
case cW:return[cW]
case lW:return n?[lW,nW,Kq]:[lW]
case Qq:return r?[Qq,nW,Kq]:[Qq]
default:return[]}}(0,n,r,o)
return i.some(e=>Pf(t,e))}function Ef(e,t,n){switch(t){case lW:return[lW]
case cW:return n.isEqualTo(W6)||n.isEqualTo(n3)?[O$,E$,zL,YL,JL]:[E$,O$,zL,YL,JL]
case"tv":return["appleTV"]
case Qq:return["appleVisionPro"]
case Kq:{const t=[]
return(n.isEqualTo(L6)||n.isEqualTo(M6)||n.isEqualTo(F6)||n.isEqualTo(N6))&&e.client.screenCornerRadius>0?(t.push(fU),t.push(hU),t.push(AB),t.push(TB),t.push(Dq)):n.isEqualTo(_6)?(t.push(AB),t.push(fU),t.push(hU),t.push(TB),t.push(Dq)):n.isEqualTo(R6)||n.isEqualTo(D6)||n.isEqualTo(x6)||n.isEqualTo($6)||n.isEqualTo(B6)||n.isEqualTo(U6)?(t.push(hU),t.push(fU),t.push(AB),t.push(TB),t.push(Dq)):n.isEqualTo(E6)?(t.push(TB),t.push(Dq),t.push(hU),t.push(AB),t.push(fU)):n.isEqualTo(z6)?(t.push(hU),t.push(AB),t.push(fU),t.push(TB),t.push(Dq)):n.isEqualTo(O6)?(t.push(Dq),t.push(TB),t.push(hU),t.push(AB),t.push(fU)):(t.push(fU),t.push(hU),t.push(Dq),t.push(TB),t.push(AB)),t}case nW:{let e
e=n.isEqualTo(b6)||n.isEqualTo(K6)?pE:n.isEqualTo(S6)||n.isEqualTo(Y6)||n.isEqualTo(J6)?KL:n.isEqualTo(k6)?_q:n.isEqualTo(C6)?kT:n.isEqualTo(I6)?OT:n.isEqualTo(P6)?ET:n.isEqualTo(Z6)||n.isEqualTo(X6)?wE:n.isEqualTo(Q6)||n.isEqualTo(e3)||n.isEqualTo(t3)?gE:KL
const t=r3.indexOf(e),r=r3.slice(0,t)
r.reverse()
const o=r3.slice(t+1)
return[e].concat(r,o)}default:return[]}}function Rf(e,t){if(r(t))return null
const n=Ke(e,t,eT),o=Ke(e,t,tT),i=Af(0,t,!0)
if(xe(e,t,lW)&&!i){const i=e.bag.enableProductPageInstallSize?function(e,t){const n=se(t,lH,nT)
if((0,Wv.isNothing)(n))return null
const r=n[wO]
return(0,Wv.isNothing)(r)?null:h(r)}(0,t):function(e,t){const n=wr(e,t)
if(r(n))return null
const o=l(n,"assets")
if(!o.length)return null
for(const e of o)if(f(e,"flavor")===HS)return h(e,GN)
return null}(e,t)
if(s(o)){const e=h(o,RT)
return new bz(i,null,null,e)}if(s(n)){const e=h(n,DT),t=h(n,_T)
return new bz(i,e,t,null)}return new bz(i,null,null,null)}{const r=B(t,QA)
if(r){let t=[]
e.client.thinnedApplicationVariantIdentifier&&(t=e.client.thinnedApplicationVariantIdentifier.split(" ")),t=t.concat([e.host.deviceModel,"universal"])
for(const e of t){const t=h(r[e])
if(t){if(s(o)){const e=h(o,RT)
return new bz(t,null,null,e)}if(s(n)){const e=h(n,DT),r=h(n,_T)
return new bz(t,e,r,null)}return new bz(t,null,null,null)}}}}return null}function Df(e,t,n){let r,s=null,a=null,c=null,l=null
switch(e.client.deviceType){case lW:n.supportsArcade?(s=vE,c="sr"):(s="editorialArtwork.centeredFullscreenBackground",c="ep")
break
case"tv":n.presentedInTopShelf?(s=mE,c="sr"):(s=vE,c="ta",a="editorialArtwork.fullscreenBackground",l="sr")
break
case Qq:s="editorialArtwork.productUberStatic16x9",c="sr"
break
default:n.supportsArcade?n.prefersCompactVariant||e.client.isPhone?(s="editorialArtwork.splashTall",c="oc"):(s=vE,c="oh"):(s=ZL,c="sr")}return r=Ke(e,t,s),null!==a&&o(r)&&(r=Ke(e,t,a),null!==l&&(c=l)),i(r)&&i(c)?Zd(e,r,{cropCode:c,useCase:y6.Uber,withJoeColorPlaceholder:!0,overrideHeight:null,overrideWidth:null}):null}function _f(e,t,n,o,a){let c=[]
if(s(o))c=o
else switch(e.client.deviceType){case lW:case"tv":c=[uN]
break
case Kq:c=[QL]
break
case Qq:c=["productUberMotion16x9"]
break
default:c=[dN]}let l=null,u=null
for(const n of c)if(l=Ke(e,t,[Oq,n]),u=Ke(e,t,[Oq,n,UG]),s(l))break
const d=null!=a?a:Zd(e,u,{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(l)){const e=f(l,rq)
if(r(e))return null
let t,n
return t={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},n={muteUnmute:!0},new mz(e,d,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:t,autoPlayPlaybackControls:n})}return null}function Lf(e,t,n){let r=null
switch(e.client.deviceType){case lW:case"tv":case nW:case Qq:r=[uN,QL,dN]
break
default:r=[QL,uN,dN]}return _f(e,t,y6.Uber,r,n)}function Mf(e,t){return i(t)?`${OW}:/${xW.developer}/${xW.href}?${zW.href}=${t.href}`:null}function xf(e,t,n){return ve(e,new dY(e).forType(rN).addingQuery(oN,dW).addingQuery(aq,n).addingQuery(PH,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}function $f(e,t){switch(t){case oY:case lY:return"appStore"
case iY:return cW
case sY:return sq
case cY:return ZB
default:return null}}function Ff(e,t){switch(t){case 6:return["L",dT]
case 7:return["10",hT]
case 8:return["12",wT]
case 9:return["14",vT]
case 10:return["16",yT]
case 11:return["18",TT]
case 12:return["AL",uT]
case 13:return["A10",fT]
case 14:return["A12",pT]
case 15:return["A14",gT]
case 16:return["A16",mT]
case 17:return["A18",AT]
case 20:return["All","kr.all"]
case 21:return["12","kr.12"]
case 22:return["15","kr.15"]
case 31:return["15+","AgeRating-AU-15"]
case 32:return["R 18+","AgeRating-AU-18"]
case 47:return["18+","AgeRating-FR-18"]
default:return}}function Nf(e,t){switch(t){case nW:return e.loc.string("AppPlatform.Phone")
case Kq:return e.loc.string("AppPlatform.Pad")
case Qq:return e.loc.string("AppPlatform.Vision")
case"tv":return e.loc.string("AppPlatform.TV")
case cW:return e.loc.string("AppPlatform.Watch")
case sq:return e.loc.string("AppPlatform.Messages")
case lW:return e.loc.string("AppPlatform.Mac")
default:return""}}function Bf(e,t){var n
return null===(n=Ff(0,t))||void 0===n?void 0:n[1]}function Uf(e,t,n){return et(e,t,"hasMessagesExtension",n)}function Gf(e,t,n){return et(e,t,$L,n)}function jf(e,t){return et(e,t,"isHiddenFromSpringboard")}function Vf(e,t,n){return Ke(e,t,xL,n)}function Hf(e,t,n,r,o){return ot(e,t,n,r?aB:Yj,o)}function qf(e,t,n){return et(e,t,jG,n)}function Wf(e,t,n,r=!1,o){var i,s
if((0,Wv.isNothing)(t))return null
let a
if(r){const r=N(t)
W(r)&&(a=Qe(e,r,[hV,n],o))}return a=null!==(s=null!==(i=null!=a?a:Qe(e,t,[bB,n],o))&&void 0!==i?i:Qe(e,t,[hV,n],o))&&void 0!==s?s:Qe(e,t,["itunesNotes",n],o),a}function zf(e,t,n,r=!1){var o
let i
if(r){const r=N(t)
W(r)&&(i=Qe(e,r,[hV,n]))}return i=null!==(o=null!=i?i:Qe(e,t,[bB,n]))&&void 0!==o?o:Qe(e,t,[hV,n]),i}function Yf(e,t){return $(t,"isMacOSInstaller",()=>!1)}function Jf(e,t){const n=st(e)
return!(!function(e,t,n){if(n&&st(e).isSystemAppFromData(t)){const e=j(t,"watchBundleId")
if(s(e))switch(e){case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0
default:return!1}}return!1}(e,t,e.client.isTinkerWatch)&&(!e.client.isTinkerWatch||(n.isSystemAppFromData(t)?et(e,t,fO)||et(e,t,DG):et(e,t,dO)||et(e,t,DG))))}function Kf(e){switch(e){case nW:return _q
case Kq:return Dq
case"tv":return"tv"
case cW:return oL
case lW:return"macbook"
case sq:return Wx
case Qq:return"visionpro"
default:x(e)}}function Zf(e,t){switch(t){case fU:return 18/L6.width
case hU:return 18/R6.width
case pE:return 41.5/b6.width
case KL:return 39/S6.width
case wE:return 55/Z6.width
case gE:return 55/Q6.width
case YL:return 34/j6.width
case zL:return 55/V6.width
case O$:return 108/H6.width
case E$:return 108/q6.width
default:return null}}function Qf(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.host.isOSAtLeast(o,i,s)}function Xf(e,t){return!r(t)&&0!==t.length&&e.client.isActivePairedWatchSystemVersionBelow(t)}function eh(e,t){switch(t){case Iq:case oq:case tN:case fN:case m$:case uG:case XL:return!0
default:return!1}}function th(e,t){switch(t){case"LockupSmall":case"LockupLarge":case AE:case VG:case SB:case hN:case PB:case pN:case eM:return!0
default:return!1}}function nh(e,t,n){const r=wr(e,t)
if(f(r,kV)===ZV){const n=f(r,pU),o=Qe(e,t,CV)
if(s(o)){if(s(n)){const t=Oe(n),r={"@@expectedDateMY@@":e.loc.string("PreOrder.Date.MonthYear"),"@@expectedDateMDY@@":e.loc.string("PreOrder.Date.MonthDayYear")}
for(const[n,i]of Object.entries(r))if(o.includes(n)){let r=e.loc.formatDateWithContext(i,t,"middleOfSentence")
return o.replace(n,r)}}return o}}return n}function rh(e,t){const n=pe(e,t,bH)
return s(n)?n:et(e,t,uU)?pe(e,t,OH):null}function oh(e){var t
return null!==(t=function(e,t,n){if((0,Wv.isNothing)(e)||0===t.length&&0===n.length)return null
const r=e
if((0,Wv.isNothing)(r))return null
const o=ke(r)
for(const e of t)if(Ce(o,e))return ye(e.colorHex)
for(const e of n)if(Ce(o,e))return ye(e.colorHex)
return null}(e,c3,l3))&&void 0!==t?t:ye(s3)}function ih(e){var t,n,r,o,i
const s=[]
for(const t of l(e,NA))(0,Wv.isSome)(t)&&c(t)&&s.push(t)
return{bgColor:null!==(t=f(e,oj))&&void 0!==t?t:void 0,textColor1:null!==(n=f(e,VL))&&void 0!==n?n:void 0,textColor2:null!==(r=f(e,R$))&&void 0!==r?r:void 0,textColor3:null!==(o=f(e,TE))&&void 0!==o?o:void 0,textColor4:null!==(i=f(e,uB))&&void 0!==i?i:void 0,textGradient:(0,Yv.isDefinedNonNullNonEmpty)(s)?s:void 0}}function sh(e){var t,n,r,o,i,s
const a=ih(e),c=[]
for(const e of null!==(t=a.textGradient)&&void 0!==t?t:[]){const t=ye(e);(0,Wv.isSome)(t)&&c.push(t)}return{bgColor:null!==(n=ye(a.bgColor))&&void 0!==n?n:void 0,textColor1:null!==(r=ye(a.textColor1))&&void 0!==r?r:void 0,textColor2:null!==(o=ye(a.textColor2))&&void 0!==o?o:void 0,textColor3:null!==(i=ye(a.textColor3))&&void 0!==i?i:void 0,textColor4:null!==(s=ye(a.textColor4))&&void 0!==s?s:void 0,textGradient:(0,Yv.isDefinedNonNullNonEmpty)(c)?c:void 0}}function ah(e){const t=[oj,VL,R$,TE,uB]
for(const n of t){const t=e[n]
if(c(t)&&!Ce(ye(t),a3))return t}return null}function ch(e,t){let n=t.targetType
return n||(n=tW),n}function lh(e){let t=e.idType
return t===mq?t=null:t||(t=Sq),t}function uh(e,t){return qf(e,t)?vq:null}function dh(e,t,n){const r=f(t,kV),o=Me(e,t,lW,!0),i=xe(e,t,lW,!0),s=function(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
for(const e of n)if(o.has(e))return!0
return!1}(e,t,[_q,Dq,iN,QG,cW],!0),a=$e(e,t,[_q,Dq,iN,QG,cW],!0),c=Me(e,t,XV,!0),l=xe(e,t,XV,!0)
if(i||o&&n===lH)switch(r){case dW:return HS
case Zq:return"macSoftwareBundle"}if((l||c&&n===nH)&&r===dW)return"visionSoftware"
if(a||s||s&&n===kq||s&&n===cW||s&&n===nV)switch(r){case dW:return qS
case Zq:return"mobileSoftwareBundle"}switch(r){case JH:return"softwareAddOn"
case MV:return Jj
case A$:case Xq:return yj
case pV:return WS
default:return null}}function fh(e){return null==e?"":e}function hh(e){if(!e)return null
let t=null
const n=new az(e).query
if((0,Hv.isSome)(n))for(const e of Object.keys(n))if("referrer"===e){n[e]===CE&&(t="com.apple.siri")
break}return t}function ph(e){var t
return(0,Hv.isNothing)(e)?{}:null!==(t=g(wh(y(e))))&&void 0!==t?t:{}}function wh(e){if(r(e))return null
if(e instanceof Array){const t=[]
for(const n of e){const e=wh(n)
i(e)&&t.push(e)}return t}if(e instanceof Object){const t={}
return Object.keys(e).forEach((n,r,o)=>{const s=wh(e[n])
i(s)&&(t[n]=s)}),t}return e}function gh(e){if(!e)return null
const t=new az(e),n=t.query,o=null==n?void 0:n[ZG],i=t.pathname
return r(o)||r(i)?null:i.endsWith("/search")?o:null}function vh(e,t,n,r){if(!t||!n)return qq
if(t.type===Zq)return Wk
const o=n.style
if((0,Hv.isNothing)(o))return qq
switch(o){case fB:case yB:return kq
case cN:return lW
case WL:return"tv"
case k$:case qL:return of(e,t,null!=r?r:void 0)===nH?Qq:cW
case aN:return sq
case tG:return tG
default:return x(o),qq}}function mh(e,t){if(!i(t))return null
const n={},r=p(t,zR)
if(!s(r))return null
const o=f(r,YS);(0,Hv.isSome)(o)&&(null==o?void 0:o.length)>0&&(n[YS]=o)
const a=f(r,JS);(0,Hv.isSome)(a)&&(null==a?void 0:a.length)>0&&(n[JS]=a)
const c=f(r,KS)
return(0,Hv.isSome)(c)&&(null==c?void 0:c.length)>0&&(n[KS]=c),n.marketing={marketingItemId:t.id},n}function yh(e,t,n){let o=null
return i(e)&&(o=S(e)),i(t)&&(r(o)&&(o={}),o.odpModuleUpdate=t.toString()),s(n)&&(r(o)&&(o={}),o.userSegment=n),o}function Ah(e,t,n){const r=Dh(t.locationTracker)
return[Eh(0,t,n),...r]}function Th(e,t,n){const r=Dh(t.locationTracker)
return[Rh(0,t,n),...r]}function bh(e,t,n){const r=new u3
r.location=Eh(0,t,n),t.locationTracker.locationStack.unshift(r)}function Sh(e,t,n){const r=new u3
r.location=Rh(0,t,n),t.locationTracker.locationStack.unshift(r)}function Ph(e){0!==e.locationStack.length?e.locationStack.shift():qv.unexpectedType(SH,"non-empty location stack","empty location stack")}function Ih(e){const t=_h(e)
return t?t.position:e.rootPosition}function Ch(e){const t=_h(e)
return t?t.location:null}function kh(e,t){const n=_h(e)
n?n.position=t:e.rootPosition=t}function Oh(e){const t=_h(e)
t?t.position++:e.rootPosition++}function Eh(e,t,n){var r
const o=Rh(0,t,n)
if(!t.id&&t.locationTracker)o.idType=Aq,o.id=Ih(t.locationTracker).toString()
else{const e=lh(t);(0,Wv.isSome)(e)&&(o.idType=e)
let n=t.id;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(n=t.anonymizationOptions.anonymizationString),o.id=(0,Wv.isNothing)(n)?"":n}return t.fcKind&&(o.fcKind=t.fcKind),t.displayStyle&&(o.displayStyle=t.displayStyle),t.inAppEventId&&(o.inAppEventId=t.inAppEventId),t.relatedSubjectIds&&(o.relatedSubjectIds=t.relatedSubjectIds),t.canonicalId&&(o.canonicalId=t.canonicalId),t.optimizationEntityId&&(o.optimizationEntityId=t.optimizationEntityId),t.optimizationId&&(o.optimizationId=t.optimizationId),(0,Wv.isSome)(t.rowIndex)&&(o.rowIndex=t.rowIndex),t.productVariantData&&Object.assign(o,ze(t.productVariantData)),o}function Rh(e,t,n){var r,o
let i=n;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(i=t.anonymizationOptions.anonymizationString)
const s={locationPosition:Ih(t.locationTracker),locationType:ch(0,t),name:(0,Wv.isNothing)(i)?"":i}
return(0,Wv.isSome)(t.badges)&&(s.badges=null!==(o=y(t.badges))&&void 0!==o?o:void 0),t.recoMetricsData&&Object.assign(s,t.recoMetricsData),s}function Dh(e){return e.locationStack.map(e=>e.location)}function _h(e){return 0===e.locationStack.length?null:e.locationStack[0]}function Lh(e,t){var n,r,a,c,l,u,d,f
let h=t.id,p=t.title
if(s(t.anonymizationOptions)){const e=null!==(r=null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&void 0!==r?r:"ANONYMOUS"
h=e,p=e}else h&&t.createUniqueImpressionId&&(h=function(e,t){return`${t}${f3}${e.random.nextUUID()}`}(e,h))
const w={id:fh(h),name:fh(p),impressionType:ch(0,t)},g=lh(t);(0,Hv.isSome)(g)&&(w[ex]=g),t&&t.kind&&(w[DH]=t.kind),t&&t.softwareType&&(w[BN]=t.softwareType),t&&t.recoMetricsData&&Object.assign(w,t.recoMetricsData),t&&t.mercuryMetricsData&&Object.assign(w,t.mercuryMetricsData),t&&t.lockupDisplayStyle&&(w[KM]=t.lockupDisplayStyle)
const v=null!==(a=t.shouldOmitImpressionIndex)&&void 0!==a&&a
if(t&&t.locationTracker&&!v){const e=Ih(t.locationTracker)
w[Ob]=e,""===w.id&&(w.id=e.toString(),w[ex]=Aq)}if(t&&t.modelSource&&(w.modelSource=t.modelSource),i(t.offerType)&&(w[iF]=t.offerType),t&&i(t.displaysArcadeUpsell)&&(w[NS]=t.displaysArcadeUpsell),t&&i(t.isPreorder)&&(w[wq]=t.isPreorder),i(t.adamId)&&o(t.anonymizationOptions)&&(w[FV]=t.adamId),t&&i(t.badges)&&(w.badges=t.badges),t&&i(t.inAppEventId)&&(w[a$]=t.inAppEventId),t&&i(t.relatedSubjectIds)&&(w.relatedSubjectIds=t.relatedSubjectIds),(null===(c=null==t?void 0:t.hintsEntity)||void 0===c?void 0:c.length)&&(w[XM]=t.hintsEntity),t&&i(t.autoAdvanceInterval)&&(w.autoAdvanceInterval=t.autoAdvanceInterval),i(null==t?void 0:t.fcKind)&&(w.fcKind=t.fcKind),i(null==t?void 0:t.canonicalId)&&(w[bN]=t.canonicalId),i(null==t?void 0:t.displayStyle)&&(w[CH]=t.displayStyle),i(t.productVariantData)&&Object.assign(w,ze(t.productVariantData)),(0,Hv.isSome)(t.contentRating)&&(w[_U]=t.contentRating),(0,Hv.isSome)(t.bundleId)&&(w[yq]=t.bundleId),w.impressionType!==z$){if((0,Hv.isSome)(t.adsMetricsData)){const e=ph(t.adsMetricsData)
Object.assign(w,e)}if(null!==(l=t.isAdvert)&&void 0!==l&&l||null!==(u=t.isAdEligible)&&void 0!==u&&u){const e=null===(f=null===(d=t.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f?void 0:f.sharedImpressionsArrayFields
if((0,Hv.isSome)(e)){const t=ph(e)
Object.assign(w,t)}}}return""===w.id&&e.console.log(`impressionId missing. Tracking broken for ${w.name} of ${w.impressionType}`),w}function Mh(e,t,n){t&&(t.impressionMetrics=new jY(Lh(e,n)))}function xh(e,t,n){var r
t&&(Mh(e,t,n),(n.isAdvert||n.isAdEligible)&&(null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)&&t.impressionMetrics&&(t.impressionMetrics=new d3(t.impressionMetrics,!0)))}function $h(e,t,n,r,o,i,s=!0){var a,c,l,u,d,f
if(!t)return
const h=Lh(e,n)
if(s?(h[BS]=fh(r),h[FM]=fh(o)):(r&&(h[BS]=r),o&&(h[FM]=o)),i&&(h[US]=i),(null!==(c=null===(a=null==n?void 0:n.optimizationEntityId)||void 0===a?void 0:a.length)&&void 0!==c?c:0)>0&&(h[GS]=n.optimizationEntityId),(null!==(u=null===(l=null==n?void 0:n.optimizationId)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0&&(h[jS]=n.optimizationId),(0,Hv.isSome)(null==n?void 0:n.rowIndex)&&(h.rowIndex=n.rowIndex),t.impressionMetrics=new jY(h),(n.isAdvert||n.isAdEligible)&&(null===(d=n.pageInformation)||void 0===d?void 0:d.adPageInfo)){const r=ph(n.pageInformation.adPageInfo.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
Object.assign(t.impressionMetrics.fields,r),t.impressionMetrics=new d3(t.impressionMetrics,!0),n.isAdvert&&(null===(f=t.impressionMetrics)||void 0===f||delete f.fields[FM])}}function Fh(e,t,n,r){if(!t||!r)return
Mh(e,t,n)
const o=ph(r.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
if((0,Hv.isSome)(t.impressionMetrics)){Object.assign(t.impressionMetrics.fields,o)
const e=u(n.disableFastImpressionsForAds)
t.impressionMetrics=new d3(t.impressionMetrics,!e)}(0,Hv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields[_M]=tF)}function Nh(e,t,n,r,a,c,l){var u
const d=Bh(e,t,n.title,a)
d.lockupDisplayStyle=r,d.contentRating=null===(u=n.offerDisplayProperties)||void 0===u?void 0:u.contentRating,d.bundleId=n.bundleId,o(d.targetType)&&(d.targetType=tW),c&&qf(e,t)&&(d.displaysArcadeUpsell=!0)
const f=a.id
return s(zd(t))&&i(f)&&f.length>0&&(d.id=f),d}function Bh(e,t,n,r,o){return qv.context(GR,()=>{var i,s,a
const c=dh(e,t),l=uh(e,t),u={...r,kind:c,softwareType:l,title:n,id:t.id}
if(et(e,t,wq,o)&&(u.offerType=ZV),r.isAdvert||r.isAdEligible){const n=null!==(i=u.adsMetricsData)&&void 0!==i?i:{}
n[VS]=!0
const o=null===(a=null===(s=r.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a?void 0:a.placementType,c=Q0.containerIdFromType(e,o)
if((0,Hv.isSome)(c)){n[UB]=c
const e=zs(r.locationTracker,r.adSlotOverride)
n[oF]=`${c}_${e}`}const l=B(t,xG)
if((0,Hv.isSome)(l)){const e=fh(l[X$])
n[Y$]=e
const t=fh(l[kR])
n[NM]=t}u.adsMetricsData=n}return u})}function Uh(e,t,n,r){return qv.context(GR,()=>{const o=dh(e,t),i=uh(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:Sq,displayStyle:oM}})}function Gh(e,t,n,r){return qv.context("impressionOptionsForMetadataRibbonItem",()=>({...e,id:t,kind:null,softwareType:null,title:n,idType:r,targetType:z$}))}function jh(e,t,n){var r,o,i,s
const a=Lh(e,(r=t.term,o=n,i=t.entity,s=t.source,qv.context("impressionOptionsForSearchHint",()=>({...o,id:"",kind:null,softwareType:null,title:r,hintsEntity:i,modelSource:s}))))
t.impressionMetrics=new jY(a)}function Vh(e){const t=l(e,vH)
for(const e of t){const t=f(e,"id");(0,Hv.isNothing)(t)||(e.id=Hh(t))}}function Hh(e){return e.includes(f3)?e.split(f3)[0]:e}function qh(e,t,n,r){return o(t.remainingItems)?null:`${OW}:/${xW.product}/${xW.shelf}/`+Wh(t,n,r)}function Wh(e,t,n){return e.sourceSequenceId=t.getSequenceId(),e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function zh(e,t,n,r,o,i,s,a,c){return Yh(e,t.data,n,r,o,i,s,a,c)}function Yh(e,t,n,i,s,a,c,l,u){if(o(t))return null
const d=[],f={shouldShowSupportedPlatformLabel:null!=u&&u}
return{items:$d(e,t,{shouldShowOnUnsupportedPlatform:null!=u&&u,lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:l},artworkUseCase:i,canDisplayArcadeOfferButton:eh(0,s),...r(a)?{}:{offerStyle:a},...f},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(d.push(t),!1),filter:c}),remainingItems:d}}function Jh(e,t,n){if(!n)return
let r=-1,o=null
n.forEach((e,n)=>{const i=e,s=i,a=i&&i.adamId===t,c=s&&s.productIdentifier===t;(a||c)&&(r=n,o=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Ej,"ad",{type:rL})))}),-1!==r&&(n.splice(r,1),n.splice(0,0,o))}function Kh(e){if(-1===m3.indexOf(e.media.kind))return!1
const t=e.clickAction
if(!t)return!0
const n=t.pageUrl
if(!n)return!0
const r=new az(n),o=Zh()
for(const e of o)if(new lz(e).matches(r))return!1
return!0}function Zh(){return[{protocol:EW,path:`/{countryCode}/${xW.product}/{appName}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.isPPT}?`,`${zW.appEventId}?-caseInsensitive`,`${zW.offerItemId}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,path:`/{countryCode}/${xW.productBundle}/{appName}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:`/{countryCode}/${xW.product}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.appEventId}?-caseInsensitive`,`${zW.offerItemId}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,path:`/{countryCode}/${xW.productBundle}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:`/${xW.product}/{appName}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.appEventId}?-caseInsensitive`,`${zW.offerItemId}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,path:`/${xW.productBundle}/{appName}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:`/${xW.product}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.appEventId}?-caseInsensitive`,`${zW.offerItemId}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,path:`/${xW.product}/{id}`,query:[`${zW.v0}?`,`${zW.metrics}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,path:`/${xW.productBundle}/{id}`,query:[`${zW.action}?`,`${zW.offerName}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,query:[zW.bundleIdentifier,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]},{protocol:EW,query:[zW.action,zW.ids,`${zW.isPurchasesApp}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:EW,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.offerItemId}?`]},{protocol:EW,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,hostName:`${FW}`,path:`/${xW.siri}/{id}`,query:[`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:EW,path:`/${xW.store}/${xW.viewSoftware}`,query:[zW.id,`${zW.v0}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`]},{protocol:OW,path:`/${xW.product}/{id}`,query:[zW.invalidateWidgetsOnFailure,`${zW.metrics}?`,`${zW.offerItemId}?`,`${zW.appEventId}?`,`${zW.isPreloading}?`,`${zW.isViewOnly}?`,`${zW.includeUnlistedApps}?`,`${zW.webBrowser}?`,`${zW.webBrowserFlowType}?`]}]}function Qh(e,t,n){const r=n[aV],o=v3.fromJSON(e,r)
let i
if(o.isBundleShelf)i=Zq
else switch(o.contentType){case EV:case CU:case dF:i=Xq
break
case sN:i=JH
break
default:i=dW}const s=[$q,Oq,IH]
return e.appleSilicon.isSupportEnabled&&s.push(kH),e.bag.enableUpdatedAgeRatings&&s.push(Eq),nf(e)&&s.push(TH),new dY(e).withIdsOfType(o.remainingItems.map(e=>e.id),i).includingAdditionalPlatforms(ee(e)).includingAttributes(i===JH?[]:s)}async function Xh(e,t,n,s,a=!1){const c=n[aV],l=v3.fromJSON(e,c)
l.isFirstRender=!1
const u=St(t)
l.recoMetricsData=null!=u?u:l.recoMetricsData,n[zW.shelfRefreshType]===rz&&h3.resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,l)
const d=function(e,t,n,s){return qv.context("shelfFromLookupResponse",()=>{switch(n.onDemandShelfType){case Bm.SimilarItems:return function(e,t,n,i){return qv.context("similarItemsSecondaryShelf",()=>{var s,a,c
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const l=new h3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),u=iq,d=BU,f={pageInformation:l.metricsPageInformation,locationTracker:l.locationTracker,targetType:u,id:h3.similarItemsShelfId,idType:d,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
bh(0,f,n.title)
const h=new dJ(n.contentType)
if(Kt(e,KH)||Kt(e,wH)){const o=null===(s=Ch(l.locationTracker))||void 0===s?void 0:s.id;(0,Hv.isSome)(o)&&(null===(a=n.sourcePageInformation.adPageInfo)||void 0===a||a.recordAdResponseEventsIfNeeded(e,null==i?void 0:i.failureReason,o,0))
const u=function(e,t){var n
const r=null===(n=null==t?void 0:t.onDeviceAd)||void 0===n?void 0:n.positionInfo
if((0,Hv.isNothing)(r)||(0,Hv.isNothing)(t))return null
let o
switch(t.placementType){case KH:o=OG
break
case wH:o=PO}return(0,Hv.isNothing)(o)?null:Za(e,t,{shelfIdentifier:o,slot:r.slot-1})}(e,i)
null===(c=l.metricsPageInformation.adPageInfo)||void 0===c||c.updateForAdResponse(e,i)
const d=function(e,t){if(r(e))return[]
const n=[]
return Object.entries(e.tasks).forEach(([r,o])=>{r.startsWith(t)&&(n.push(o),delete e.tasks[r])}),n}(u,o)
d.forEach(e=>{(t=t.filter(t=>t.id!==e.data.id)).splice(e.positionInfo.slot,0,e.data)})}const p=Yh(e,t,l,Kd(0,n.contentType),n.contentType,n.offerStyle,null,n.recoMetricsData)
if(o(p))return null
h.title=n.title,h.items=p.items,h.isHorizontal=!0
const w=new v3(n.productId,t,n.title,n.shouldInferSeeAllFromFetchesItems,void 0,n.contentType,null,null,null,null,null,Bm.SimilarItems),g=Wu(0,n.productId,w,l,n.destinationPageInformation)
return h.refreshUrl=g,t.length<2?h.rowsPerColumn=1:n.supportsArcade?h.rowsPerColumn=2:h.rowsPerColumn=3,l.addImpressionsFieldsToSimilarItemsShelf(e,h,u,d),un(e,[h],KH,f.id,f.pageInformation),Ph(l.locationTracker),Oh(l.locationTracker),h})}(e,t.data,n,s)
case Bm.MoreByDeveloper:return function(e,t,n){return qv.context("moreByDeveloperSecondaryShelf",()=>{if(o(t))return null
const r=new h3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId)
bh(0,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:dq,id:`${r.getSequenceId()}`,idType:Aq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData},n.title)
const i=new dJ(n.contentType)
i.title=n.title
const s=e.client.isCompanionVisionApp?Qv.VisionOSCompatibility:void 0,a=Yh(e,t,r,Kd(0,n.contentType),n.contentType,n.offerStyle,s)
if(o(a))return null
if(i.items=a.items,i.isHorizontal=!0,t.length<2?i.rowsPerColumn=1:i.rowsPerColumn=2,(0,Hv.isSome)(n.developerUrl)){const t=new EY(wW)
t.pageUrl=n.developerUrl,t.title=e.loc.string(cH),Xs(e,t,t.pageUrl,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),i.seeAllAction=t}return r.addImpressionsToShelf(e,i,$H),Ph(r.locationTracker),Oh(r.locationTracker),i})}(e,t.data,n)
case Bm.SmallStory:return function(e,t,n){return qv.context("smallStorySecondaryShelf",()=>{if(o(t))return null
const r=new h3(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),i={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:dq,id:`${r.getSequenceId()}`,idType:Aq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
let s
if(bh(0,i,n.title),zu(e)){const r=new BZ(i.pageInformation,i.locationTracker)
s=Hc(e,null!=t?t:[],n.title,null,r)}else{const r={metricsLocationTracker:i.locationTracker,metricsPageInformation:i.pageInformation,filterOutMediaCardKinds:ep(e.host.platform)}
s=Vc(e,t,EV,n.title,null,r),Array.isArray(null==s?void 0:s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Gc(0,e.media.kind,EV)))}return s.isHorizontal=!0,r.addImpressionsToShelf(e,s,hH),Ph(r.locationTracker),Oh(r.locationTracker),s})}(e,t.data,n)}const a=new dJ(n.contentType),c=St(t),l={pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,excludeAttribution:!0,recoMetricsData:null!=c?c:n.recoMetricsData}
let u
if(n.contentType===CU){const n=Wc(e,t.data,l.pageInformation,l.locationTracker,Kh)
i(n)&&(u=[n])}else{const r={metricsOptions:l,offerStyle:n.offerStyle,artworkUseCase:Kd(0,n.contentType),canDisplayArcadeOfferButton:eh(0,n.contentType)}
n.contentType===sN&&(r.skipDefaultClickAction=!0)
const o={lockupOptions:r}
n.isBundleShelf&&(o.filter=Qv.None)
const i=xd(e,t,o),s={[iY]:k$,[sY]:aN}[e.host.clientIdentifier]
s&&i.sort((e,t)=>{const n=e.icon.style===s,r=t.icon.style===s
return n&&r?0:n&&!r?-1:1})
const a=n.spotlightInAppProductIdentifier
a&&Jh(0,a,i),u=i}return a.items=u,a.mergeWhenFetched=!0,a})}(e,t,l,s)
if(a&&function(e,t,n,o){if(r(n))return
let i=[]
const s=Nt(n),a=Jn(e,n,o)
i.push(a)
const c=Qn(e,n,o).map(e=>e.data)
i=i.concat(c),Yn(s),i.forEach(e=>Yn(e.fields)),t.pageChangeMetrics={pageFields:s,updatedEvents:i}}(e,d,l.sourcePageInformation),d.refreshUrl=l.refreshUrl,n[zW.shelfRefreshType]===rz&&h3.addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,d,l),l.shouldInferSeeAllFromFetchesItems){const t=new EY(wW)
t.title=e.loc.string(cH)
const n=new dJ(d.contentType)
n.items=function(e,t,n,r=!1){var o,s
if(!t)return null
let a=0
const c=[]
for(const e of t){if(r&&i(null!==(o=e.searchAd)&&void 0!==o?o:null===(s=e.searchAdOpportunity)||void 0===s?void 0:s.searchAd)){a+=1
continue}const t=S(e)
if(n&&t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,n)),a>0){const e=S(t.impressionMetrics.fields),n=h(e.impressionIndex);(0,Wv.isSome)(n)&&(e.impressionIndex=n-a,t.impressionMetrics=new jY(e,t.impressionMetrics.id,t.impressionMetrics.custom))}c.push(t)}return c}(0,d.items,BH,!0)
const r=new pJ([n])
jn(e,r,l.destinationPageInformation),r.title=l.title,t.pageData=r,Xs(e,t,null,{pageInformation:l.sourcePageInformation,locationTracker:l.sourceLocationTracker}),d.seeAllAction=t}return o(d.items)&&!l.hasExistingContent&&(d.isHidden=!0),d}function ep(e){const t=new Set([QN])
return e===jV&&(t.add(Aj),t.add(iO),t.add(KU),t.add(iL)),t}async function tp(e,t){return typeof campaignAttribution!==OU?await campaignAttribution.processRedirectURL(t):await e.network.fetch({url:e.bag.redirectUrlEndpoint,method:hG,headers:{"Content-Type":ZM},body:`url=${encodeURIComponent(t)}`}).then(e=>e.ok)}async function np(e,t){const n=e.required(y3)
0!==Mn(e,new az(t.url)).length&&tp(e,t.url),t.url=function(e,t){const n=new az(t.url)
if(YO in n.query){const r=f(t.referrerData,Jq)===_z,o=e.host.clientIdentifier===Dz
return r||o||delete n.query[YO],n.toString()}return t.url}(e,t)
const r=new Dm.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r)
return await n.fetchAction(o,t.url,t.referrerData).then(n=>{if(!n)throw new Error(`Promise resolved to null action for: ${t.url}`)
if(t.isIncomingURL){const e=[n]
if(T(o=n)&&o[gW]===aO)for(const t of n.actions)e.push(t)
for(const t of e){const e=t.pageData
e&&typeof e===fV&&wB in e&&zn(0,e)}}var o
if(n.actionClass===aL){const e=n
e.page===Tj||e.page===Tq||e.page===WO||e.page===Ij||e.page===YF||e.page===e$||e.page===pH||e.page===y$||e.page===zO?e.presentationContext=BH:e.page===jA?e.presentationContext=pL:e.page===pB?e.presentationContext=Wj:t.isIncomingURL?e.presentationContext=bL:(e.presentationContext="replace",e.animationBehavior=rH)}return t.isIncomingURL&&(e.deepLinks.hasResilientDeepLinks()||e.deepLinks.removeDeepLink(t.url)),r.decorate(n),n}).catch(n=>{let r=[]
n instanceof fz?r=n.reasons.filter(e=>e instanceof HK):n instanceof HK&&r.push(n)
for(const n of r)if(204===n.statusCode){const n=new LY(Lq)
n.title=e.loc.string("APP_NOT_AVAILABLE_TITLE"),n.message=e.loc.string("APP_NOT_AVAILABLE_MESSAGE"),n.isCancelable=!0
{const r=new IX(zq)
if(r.title=e.loc.string(ML),v(new az(t.url).query[VA])){const e=new U3
r.actions=[n,e]}else r.actions=[n]
return r}}throw Error(n.message)})}function rp(e,t,n){switch(t){case mO:return function(e,t){const n=Wa(e,e.bag.accountUrl)
return n.title=e.loc.string("VIEW_ACCOUNT_INFO",t$),Qs(e,n,{...t,id:pH,actionType:pW},!1,tU),n}(e,n)
case yO:return function(e,t){const n=e.bag.signup
if((0,Wv.isNothing)(n))return null
const r=Wa(e,n)
return e.featureFlags.isEnabled(mJ)?r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID_REBRAND"):r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID"),Qs(e,r,{...t,id:pH,actionType:pW},!1,tU),r}(e,n)
case yL:return function(e,t){if((0,Wv.isNothing)(e.bag.purchaseHistoryUrl))return null
const n=Wa(e,e.bag.purchaseHistoryUrl)
return n.title=e.loc.string("ACCOUNT_PURCHASE_HISTORY"),n.presentationContext=bL,Qs(e,n,{...t,id:yL,actionType:pW},!1,tU),n}(e,n)
case VF:return function(e,t){if(e.user&&e.user.isManagedAppleID)return null
const n=Wa(e,e.bag.redeemUrl)
return n.title=e.loc.string("ACCOUNT_REDEEM",bO),Qs(e,n,{...t,id:"redeemGiftCardOrCode",actionType:pW},!1,tU),n}(e,n)
case AO:return function(e,t){if(!e.bag.isMonetaryGiftingEnabled)return null
const n=Wa(e,HF)
return n.title=e.loc.string("ACCOUNT_SEND_GIFT",aA),Qs(e,n,{...t,id:"sendGiftCardByEmail",actionType:pW},!1,tU),n}(e,n)
case TO:return function(e,t){var n
const r=e.bag.accountTopUpURL
if((0,Wv.isNothing)(r)||o(r))return null
const i=Wa(e,r)
return i.title=null!==(n=e.bag.accountTopUpTitle)&&void 0!==n?n:e.loc.string("ACCOUNT_TOP_UP"),Qs(e,i,{...t,id:"addFundsToAppleId",actionType:pW},!1,tU),i}(e,n)
case AL:return function(e,t){const n=new W3(vq,cA)
return n.title=e.loc.string("ACCOUNT_SETUP_FAMILY_SHARING"),Qs(e,n,{...t,id:"setUpFamilySharing",actionType:pW},!1,tU),n}(e,n)
case TL:return function(e,t){const n=Wa(e,e.bag.manageSubscriptionsV2Url)
return n.title=e.loc.string("ACCOUNT_SUBSCRIPTIONS"),n.presentationContext=bL,Qs(e,n,{...t,id:TL,actionType:pW},!1,tU),n}(e,n)
default:return null}}function op(e){const t=new Dm.FetchTimingMetricsBuilder,n=e.addingFetchTimingMetricsBuilder(t),r={pageInformation:Gn(e,t$,pH,""),locationTracker:{rootPosition:0,locationStack:[]},targetType:Mq},o=t.measureModelConstruction(()=>{const t=new q3
return t.links[mO]=rp(e,mO,r),t.links[yO]=rp(e,yO,r),t.links[VF]=rp(e,VF,r),t.links[AO]=rp(e,AO,r),t.links[TO]=rp(e,TO,r),t.links[AL]=rp(e,AL,r),t.links[TL]=rp(e,TL,r),t.links[yL]=rp(e,yL,r),t})
return jn(n,o,r.pageInformation),o}async function ip(e,t){return await e.required(y3).fetchPage(e,t,Z3)}async function sp(e){let t
try{t=await Ln(e,function(e){return new dY(e).forType($_)}(e))}catch{t=void 0}return function(e,t){const r=[],o=new X3,i=new FX(e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_IN"),GV,y$)
o.addContentItem(new t9(i))
const a=e.bag.personalizedRecommendationsToggleEnabled
if(!a){const t={}
t[e.loc.string(F_)]=lp(e)
const n=new b5(e.loc.string("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",e.loc.string(F_)))
o.footer=new S5(n,t)}if(r.push(o),a){const t=new X3
t.addContentItem(new n9(e.loc.string(LC),!1))
const n=new b5(e.loc.string(MC))
t.footer=new S5(n),r.push(t)}{const t=new X3(e.loc.string("PERSONALIZATION_SECTION_USAGE_HEADER")),n=new b5(e.loc.string("PERSONALIZATION_SECTION_USAGE_FOOTER"))
t.footer=new S5(n),t.addContentItem(new r9(e.loc.string("PERSONALIZATION_SECTION_USAGE_CLEAR_DATA"),function(e){const t=new i9
t.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_TITLE")
const n=new vZ([t])
return n.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_HEADER"),n.isCancelable=!0,n.destructiveActionIndex=0,n}(e))),r.push(t)}const c=new X3(e.loc.string("PERSONALIZATION_INTERACTIONS")),l=new b5(e.loc.string("PERSONALIZATION_INTERACTIONS_FOOTER"))
c.footer=new S5(l)
const u=e.bag.purchaseHistoryUrl;(0,Hv.isSome)(u)?c.addContentItem(new r9(e.loc.string(xC),cp(e,Tj,u,!0),YN)):c.addContentItem(new r9(e.loc.string(xC),cp(e,qy,null,!0),YN)),c.addContentItem(new r9(e.loc.string("PERSONALIZATION_SUBSCRIPTIONS"),cp(e,null,e.bag.manageSubscriptionsV2Url,!1),YN)),c.addContentItem(new r9(e.loc.string("PERSONALIZATION_PREORDERS"),cp(e,null,e.bag.managePreordersUrl,!0),YN)),c.addContentItem(new r9(e.loc.string("PERSONALIZATION_RATINGS"),cp(e,null,e.bag.ratingsReviewsUrl,!0),YN)),r.push(c)
const d=new X3(e.loc.string("PERSONALIZATION_ADDITIONAL_INFO")),h=[e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),p=new FX(h,GV,y$)
d.addContentItem(new t9(p)),r.push(d)
const w=n(t,"results.derived-user-info")
if(s(w)){const t=new X3(e.loc.string("ACCOUNT_INFO")),n=["gender","birthyear"]
for(const e of n){const n=f(w,`${e}.label`),r=f(w,`${e}.value`);(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0&&t.addContentItem(new o9(n,r))}const o=e.featureFlags.isEnabled(mJ)?"PERSONALIZATION_ACCOUNT_INFO_FOOTER_REBRAND":"PERSONALIZATION_ACCOUNT_INFO_FOOTER",i=new b5(e.loc.string(o))
t.footer=new S5(i),r.push(t)}return new Z3(e.loc.string($C),r)}(e,t)}function ap(e){const t=[],n=e.bag.personalizedRecommendationsToggleEnabled,r=new X3,o=n?e.loc.string("PersonalizedRecommendations.OptedOut.Description"):e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_OUT"),i=new FX(o)
if(r.addContentItem(new t9(i)),t.push(r),n){const n=new X3
n.addContentItem(new n9(e.loc.string(LC),!1))
const r=new b5(e.loc.string(MC))
n.footer=new S5(r),t.push(n)}else{const n=new X3
n.addContentItem(new r9(e.loc.string(F_),lp(e),YN)),t.push(n)}return new Z3(e.loc.string($C),t)}function cp(e,t,n,r){let o
if((0,Hv.isSome)(t))o=new EY(t,n)
else{if((0,Hv.isNothing)(n))return null
o=Wa(e,n)}return r&&(o.presentationContext=bL),o}function lp(e){return cp(e,void 0,e.bag.accountUrl,!1)}async function up(e,t){const n=new dY(e).forType(FC).addingQuery(YD,"events-reminders").addingQuery("service",Z_).addingQuery(eq,"explicit")
n.isMediaRealmRequest=!0
const r=function(e,t){const n={"events-reminders":{"com.apple.AppStore":{contents:[{id:e,type:iW,notify:t}]}}}
return{method:"PATCH",headers:{"Content-Type":nM},requestBodyString:JSON.stringify(n)}}(t.appEventId,t.shouldSchedule)
return await new Promise((t,o)=>{Ln(e,n,r).then(e=>{t(!0)}).catch(e=>{o(e)})})}function dp(e){return Ne(e,Zv.ArcadeDownloadPackOnboarding)||Vm.LayoutB}function fp(e){G9||(G9=!0,j9=new k9(e.loc.string("PAGE_FACETS_SORTS_RELEASE_DATE"),D9,cU),V9=new k9(e.loc.string("PAGE_FACETS_SORTS_LAST_UPDATED"),_9,"lastUpdated"),H9=new k9(e.loc.string("PAGE_FACETS_SORTS_NAME"),L9,fW),q9=new k9(e.loc.string("PAGE_FACETS_SORTS_CATEGORY"),M9,qj),W9=new k9(e.loc.string("PAGE_FACETS_DEFAULT_ALL"),null),z9=new k9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),Y9=new k9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),J9=new k9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),K9=new k9(e.loc.string(EA),pq,null,"gamecontroller"),Z9=new k9(e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER"),pq,null,"person.2"),Q9=new k9(e.loc.string(RA),pq),U9[zW.sort]={releaseDate:[j9],lastUpdated:[V9],name:[H9],category:[q9]},U9[zW.ageRating]={"4plus":[z9],"9plus":[Y9],"12plus":[J9]},U9[zW.controllerSupport]={true:[K9],false:[]},U9[zW.multiplayerSupport]={true:[Z9],false:[]},U9[zW.comingSoon]={true:[Q9],false:[]})}function hp(e,t={}){fp(e)
const n={"filter[ageRating]":[W9]}
n[x9]=[j9],n[$9]=[Q9]
const r=[zW.sort,zW.ageRating,zW.controllerSupport,zW.multiplayerSupport,zW.comingSoon]
for(const e of r){const r=t[e]
if(o(r))continue
const a=U9[e][r],c=X9[e]
i(a)&&s(c)&&(n[`${c}`]=a)}return n}function pp(e,t){const n=new kW
return ea(e,n,t),n}function wp(e){const t=[$q,Oq,iH,aH,kj,Yj]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}function gp(e,t,n){return qv.context("createShelves",()=>{const r=[]
if(0===t.length)return r
let o=!1
for(const s of t)if(o=o||!W(s.data[0]),o)n.remainingGroups.push(s)
else{const t={index:n.lastShelfIndex,title:mp(e,s),contentType:(i=n.isCompactMode,i?Iq:tN),shouldFilter:!1,remainingContent:s.data,groupKind:s.kind,isCompactMode:n.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker},o=vp(e,t)
r.push(o),n.lastShelfIndex++}var i
return r})}function vp(e,t){const n=[],r=new dJ(t.contentType)
r.title=t.title,r.presentationHints={showSupplementaryText:!1},r.isHorizontal=t.groupKind===lU||t.groupKind===qj
const i={id:`${t.index}`,kind:null,softwareType:null,targetType:dq,title:r.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:Aq}
for(Mh(e,r,i),bh(0,i,r.title);s(t.remainingContent)&&W(t.remainingContent[0]);){const r=t.remainingContent.shift(),o={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},artworkUseCase:y6.LockupIconSmall,canDisplayArcadeOfferButton:eh(0,t.contentType),shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ),isContainedInPreorderExclusiveShelf:t.groupKind===lU},i=Rd(e,r,o,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},null,null)
yp(e,i,r)&&(i.editorialTagline=null,i.developerTagline=null,n.push(i),Oh(t.metricsLocationTracker))}return r.mergeWhenFetched=t.hasExistingContent,t.hasExistingContent=t.hasExistingContent||n.length>0,r.items=n,s(t.remainingContent)?r.url=function(e){return o(e.remainingContent)?null:`${OW}:/${xW.arcadeSeeAllGames}/${xW.shelf}/?${zW.token}=${encodeURIComponent(JSON.stringify(e))}`}(t):"tv"!==e.client.deviceType&&t.isCompactMode&&r.items.length<3&&(r.rowsPerColumn=r.items.length),Ph(t.metricsLocationTracker),r}function mp(e,t){let n,r,o=null,i=null
if((!t.name||0===t.name.length)&&t.kind!==lU)return""
switch(t.kind){case"releaseDateByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE"),n=e.loc.formatDateInSentence(r,UA,i)
break
case"lastUpdatedByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),n=e.loc.formatDateInSentence(r,UA,i)
break
case lU:n=e.loc.string("Arcade.SeeAllGames.ComingSoonShelf.Title")
break
default:n=t.name}return n}function yp(e,t,n){if(o(t.trailers)){const r=Lf(e,n)
if(s(r)){const e=new vz
r.playbackControls={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},r.autoPlayPlaybackControls={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0},r.canPlayFullScreen=!0,e.videos=[r],t.trailers=[e]}}return o(t.trailers)&&function(e){const t=e.screenshots[0]
if(o(t))return
const n=t.artwork[0],r=new mz(e8,n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,autoPlayPlaybackControls:{},playbackControls:{}}),i=new vz
i.videos=[r],e.trailers=[i]}(t),s(t.trailers)}async function Ap(e,t){const n=e.required(y3),r=az.from(t.url)
return r.param(zW.requestDescriptor,JSON.stringify(t)),await n.fetchPage(e,r.build(),C9)}async function Tp(e,t){const n=e.required(y3)
return await n.fetchMoreOfPage(e,t).then(function(e){return e})}function bp(e,t){const n=hp(e,t),r={}
for(const e of Object.keys(n))r[e]=n[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue,systemImageName:e.systemImageName}))
const o={url:`${OW}:/${xW.arcadeSeeAllGames}`,isCompactMode:!1,selectedFacetOptions:r},i=t[zW.requestDescriptor]
if(s(i)){const e=g(JSON.parse(i))
o.isCompactMode=e.isCompactMode,Object.assign(o.selectedFacetOptions,e.selectedFacetOptions)}return o}async function Sp(e,t){const n=az.from(t)
return await e.required(y3).fetchPage(e,n.build(),o8)}function Pp(e){let t=0,n=0
for(const r of e.shelves)(0,Hv.isSome)(r.batchGroup)&&r.batchGroup.length>0||(r.batchGroup=`shelfBatchGroup_${t}`,n++,5===n&&(n=0,t++))}async function Ip(e,t){const n=az.from(t.url)
return n.param(zW.isArcade,"true"),n.param(zW.isSubscribed,`${t.isSubscribed}`),n.param(zW.isTrialAvailable,`${t.isTrialAvailable}`),n.param(zW.isTrialEnrolled,`${t.isTrialEnrolled}`),await e.required(y3).fetchPage(e,n.build(),a8)}function Cp(e,t){const n=new IX(sW)
n.popToRoot=!0
const r=new ZJ([n])
return r.title=t,r}async function kp(e,t){return await e.required(y3).fetchPage(e,t,f8)}async function Op(e,t){const n=new Promise((n,r)=>{const o=t
s(o)||r(new Error("fetchUpsellGrid called with malformed contentDictionary"))
const i=we(o,uW),a={pageInformation:new nK({}),locationTracker:{rootPosition:0,locationStack:[]}},c=Xd(e,i,a,{useCase:y6.LockupIconMedium}),l=c.shift()
n(new A8(l,c))})
return await n}async function Ep(e,t){const n=g(t,aV)
let r=n.buyParams
const o=g(t,HC),i=g(t,qC);(0,Hv.isSome)(i)&&(o.adPageInfo={adAdamId:i._adAdamId,...i}),r=pr(e,f(t,FV),r,o,u(t,WC),u(t,zC),f(t,YC),f(t,JC),f(t,B_),p(t,Cj),p(t,KC),g(t,ZC),f(t,QC),f(t,"token.extRefApp2"),f(t,"token.extRefUrl2"))
const s=new oK(r),a={product:f(t,yH)||n.productIdentifier,adamId:f(t,FV),buyParams:s.toEncodedMap()}
return await Promise.resolve(a)}async function Rp(e,t){const n=t.offerAction,o=t.offerDisplayProperties
if(!n||!o)return await Promise.reject(new Error("Invalid offerToken for personalized offer fetch."))
const i=n.adamId,s={"Content-Type":ZM},a={url:e.bag.buyButtonMetadataURL,method:hG,headers:s,body:"ids="+i,signingStyle:YV},c=e.network.fetch(a)
return await c.then(t=>{if(!t.ok)throw Error(`Bad Status code ${t.status} for ${a.url}`)
const s=p(JSON.parse(t.body),i)
let c=null,u=null
const d=function(e,t){return qv.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const e=l(t,fj)
if(0===e.length)return null
for(const t of e){const e=f(t,kV)
if(e)return e}return mq})}(0,s)
if(r(d))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata")
if(d!==mq){let t=Ej
c=function(e,t,n,o){return qv.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const o=l(t,fj)
if(0===o.length)return null
let i,s=null
for(const e of o)switch(i=f(e,kV),i){case nx:case Kx:s=e
break
default:s=null}if(!s)return null
let a=f(s,Sj)
if(i===nx&&r(a))return qv.unexpectedNull(SH,Bq,uR),null
a||(a="")
const c=n.purchaseConfiguration,u=new yZ(a,c.vendor,c.appName,c.bundleId,c.appPlatforms,c.isPreorder,c.excludeAttribution,c.metricsPlatformDisplayStyle,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.appCapabilities,c.isDefaultBrowser,c.remoteDownloadIdentifiers,c.hasMacIPAPackage,c.contentRating)
u.pageInformation=c.pageInformation
const d=Tr(e,s,n.adamId,u,!1)
return function(e,t,n,r){const o=n.purchaseConfiguration.pageInformation
let i
if((0,Wv.isSome)(n.actionMetrics))for(const e of n.actionMetrics.data)if(i=l(m(e.fields),nU),i)break
Ks(e,t,t.adamId,false,o,i,!1)}(e,d,n),d})}(e,s,n)
let i=null
switch(d){case Kx:t=XB,i=e.loc.string("OfferButton.Title.BundlePurchased")
break
case nx:(r(c.price)||0===c.price)&&(i=e.loc.string(rx))}u=function(e,t,n,o,i){return r(t)?null:qv.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const r=new UY(n,t.adamId,t.bundleId,i),s=mr(0,t)
r.isFree=s
let a=null
a=s?t.title:t.priceFormatted,r.titles[aW]=a,r.priceFormatted=t.priceFormatted
const c=o.hasInAppPurchases,l=o.hasExternalPurchases
if(r.hasInAppPurchases=c,r.hasExternalPurchases=l,l){const t=e.loc.string(uP)
r.subtitles[aW]=t}else if(c){const t=e.loc.string(lP)
r.subtitles[aW]=t}return r.contentRating=o.contentRating,r.ignoresContentRestrictions=o.ignoresContentRestrictions,r.appCapabilities=t.purchaseConfiguration.appCapabilities,r})}(e,c,Jq,o,t),i&&(u.titles[aW]=i)}const h=Er(e,c,!1)
return new I8(d,h,u)})}async function Dp(e,t){var n
let r=f(t,"token.buyParams")
const s=f(t,"overrideBuyParams")
i(s)&&(r=function(e,t){const n=new oK(e),r=new oK(t),i=n.get(IZ.placementId,null);(null==i?void 0:i.length)>0&&o(r.get(IZ.placementId,null))&&r.set(IZ.placementId,i,null)
const s=n.get(IZ.containerId,null);(null==s?void 0:s.length)>0&&o(r.get(IZ.containerId,null))&&r.set(IZ.containerId,s,null)
const a=n.get(IZ.templateType,null)
return(null==a?void 0:a.length)>0&&o(r.get(IZ.templateType,null))&&r.set(IZ.templateType,a,null),r.toString()}(r,s))
const a=g(t,HC),c=g(t,qC);(0,Hv.isSome)(c)&&(a.adPageInfo={adAdamId:c._adAdamId,...c}),r=pr(e,f(t,FV),r,a,u(t,WC),u(t,zC),f(t,YC),f(t,JC),f(t,B_),p(t,Cj),p(t,KC),g(t,ZC),f(t,QC),f(t,"metrics.extRefApp2"),f(t,"metrics.extRefUrl2"))
const d=l(t,"token.appPlatforms"),w=d&&d.length&&d.length>0&&d.indexOf("tv")>=0,m=d&&d.length&&d.length>0&&d.indexOf(Qq)>=0,y=u(t,"token.isHalva")||u(t,"token.isMacOSCompatibleIOSApp"),A=u(t,"token.supportsVisionOSCompatibleIOSBinary"),T=Sf(0,e.client.deviceType,y,A).some(e=>-1!==d.indexOf(e)),b=y&&!1,S=(d.indexOf(Qq),A&&!1),P=f(t,"instalationType"),I=P===tx,C=P===iE,k=u(t,"token.isPreorder"),O=!(k||(w||m)&&!T),E=f(t,B_)===cW&&e.client.deviceType!==cW,R=f(t,"token.preflightPackageUrl"),D={...p(t,"token.additionalHeaders",{}),...p(t,"additionalHeaders",{})}
let _={}
const L=null===(n=e.paymentMetricsIdentifiersCache)||void 0===n?void 0:n.getMetricsFieldsForTypes([em.user,em.client,em.canonical])
return(0,Hv.isSome)(L)&&(_={...L}),{adamId:f(t,FV),buyParams:r,vendor:f(t,"token.vendor"),appName:f(t,"token.appName"),bundleId:f(t,"token.bundleId"),appPlatforms:d,additionalHeaders:D,isUpdate:I,isRedownload:C,isPreorder:k,createsJobs:O,preflightPackageUrl:R,isArcadeApp:v(t,"token.isArcadeApp"),forceWatchInstall:E,isMacOSCompatibleIOSApp:b,isVisionOSCompatibleIOSApp:S,presentingSceneIdentifier:f(t,"presentingSceneIdentifier"),appCapabilities:l(t,"token.appCapabilities"),isDefaultBrowser:v(t,"token.isDefaultBrowser"),requiresExceptionRequest:v(t,"requiresExceptionRequest"),forceAskToBuyReason:f(t,"forceAskToBuyReason"),contentRating:h(t,"token.contentRating"),metricsOverlay:_,remoteDownloadIdentifiers:l(t,"token.remoteDownloadIdentifiers"),hasMacIPAPackage:v(t,"token.hasMacIPAPackage")}}async function _p(e,t){const n=new dY(e).withIdsOfType(t,dW).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>{const n=At(t),r={}
for(const t of n)r[t.id]=tf(e,t,{useCase:y6.LockupIconLarge})
return r})}async function Lp(e,t){const n=new vK(t.targetingData,e.random.nextUUID()),r=xp(e,t)
if(null===r)return null
const o=Ln(e,r,function(e,t){const n={}
return(0,Wv.isSome)(t)&&t.validAdRequest()&&(n["X-Apple-App-Store-Client-Request-Id"]=t.appStoreClientRequestId,n["X-Apple-iAd-Request-Data"]=t.requestData,n["X-Apple-iAd-Env-Name"]=t.routingInfo),{headers:n}}(0,n))
if(e.bag.mediaAPISearchFocusEnabled){const n={term:t.term.trim(),entity:t.searchEntity}
e.onDeviceSearchHistoryManager.saveRecentSearchWithLimit(n,30)}const s=async function(e,t,n,r){var o
if(!t.validAdRequest())return Zt(e,"ODML fetch skipped - Malformed request"),{adverts:[],odmlSuccess:!1}
const i=await r,s=function(e,t){const n=t.results[s_]
if((0,Hv.isNothing)(n))return[]
const r=At(n),o=[]
for(const t of r){const n=f(t,"id"),r=B(t,YB)
if((0,Hv.isNothing)(n)||0===n.length||(0,Hv.isNothing)(r))continue
let i=null,s=null
e.bag.enableCPPInSearchAds&&(i=Ve(Ge(e,t)),s=qe(e,t)),o.push({instanceId:e.random.nextUUID(),adamId:n,assetInformation:{},adData:r,cppIds:s,serverCppId:i,selectedCppId:i,appBinaryTraits:Tf(e,t)})}return o}(e,i),a=function(e,t,n){const r=At(t.results.search),o=[]
for(const e of r){const t=f(e,"id");(0,Hv.isNothing)(t)||0===t.length||o.push({adamId:t,assetInformation:{}})}return o}(0,i)
if(!e.isAvailable(qz))return Zt(e,"ODML fetch skipped - Unsupported client"),{adverts:s,odmlSuccess:!1}
try{if(e.clientCapabilities.isEnabled(mY)&&e.bag.enableSRPOnDeviceAdsRanker){const t=function(e,t){const n=[],r=t.results[s_]
if((0,Hv.isNothing)(r))return[]
const o=At(r)
for(const t of o){const r=f(t,"id"),o=B(t,YB)
if((0,Hv.isNothing)(r)||0===r.length||(0,Hv.isNothing)(o))continue
const i=f(t.meta,"extraAdInfo"),s={instanceId:e.random.nextUUID(),adamId:r,assetInformation:{},appBinaryTraits:Tf(e,t),position:-1,adData:o,commonAdInfo:(0,Hv.isSome)(i)?JSON.parse(i):[]}
n.push(s)}const i=At(t.results.search)
for(const[t,r]of i.entries()){const o=f(r,"id")
if((0,Hv.isNothing)(o)||0===o.length)continue
const i={instanceId:e.random.nextUUID(),adamId:o,assetInformation:{},appBinaryTraits:Tf(e,r),position:t,adData:void 0,commonAdInfo:void 0}
n.push(i)}return n}(e,i),r=function(e,t){const n=f(t.meta,lA)
return(0,Hv.isNothing)(n)?{}:JSON.parse(n)}(0,i)
return await e.ads.processAndRankAds(t,r,n,e.bag.sponsoredSearchODMLTimeout)}{const t=await e.ads.processAdvertsForSponsoredSearch(s,a,n,e.bag.sponsoredSearchODMLTimeout,e.client.isPhone||e.client.isPad)
return t.odmlSuccess?Zt(e,"ODML processing completed"):Zt(e,"ODML processing failed"),{adverts:null!==(o=t.adverts)&&void 0!==o?o:s,odmlSuccess:t.odmlSuccess,installedStates:t.installedStates,appliedPolicy:t.appliedPolicy,appStates:t.appStates}}}catch(t){return Zt(e,`ODML fetch failed - ${t}`),{adverts:s,odmlSuccess:!1}}}(e,n,t.term,o),a=async function(e){if(function(e){switch(e){case Kq:case lW:return!0
default:return!1}}(e.client.deviceType)){const t=An(e,null,null,ee(e))
if(t)return await Ln(e,t).catch(()=>null)}return null}(e)
return await Promise.all([o,s,a]).then(([o,s,a])=>{var c,l,u,d
if(function(e){var t
const n=St(e),r=HD
i(n)&&i(e.meta)&&i(null===(t=e.meta)||void 0===t?void 0:t.metrics)&&(e.meta.metrics[sZ]=f(n,r),delete e.meta.metrics[r])}(o),null===(u=null===(l=null===(c=o.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.naturalLanguage){const t=e.storage.retrieveString(QD),n=_e(new Date).getTime().toString()
e.storage.storeString(QD,n),null===(d=e.amsEngagement)||void 0===d||d.enqueueData({eventType:"lastNLSQueryDateChange",app:Z_,oldState:t,newState:n})}return{catalogResponse:o,categoriesFilterData:a,searchResultsAdsRequestData:n,searchResultsAdData:s,requestMetadata:{requestDescriptor:t,searchRequestUrl:ve(e,r).toString()}}})}async function Mp(e,t){const n=function(e,t){const n=e.bag.isLLMSearchTagsEnabled||u(e.bag.supportedMixedMediaRequestUsecases[bq]),r=new dY(e,t,n,[IV]).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(Xq,[e_]).includingAttributes($p(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
return Je(e,r,t),r.includingRelationships(N8),oi(e)&&(r.includingAssociateKeys(dW,[iW]),r.includingScopedAttributes(iW,YK),r.includingScopedRelationships(Xq,[bH])),r}(e,t)
return await Ln(e,n)}function xp(e,t){var n
const r=null===(n=t.term)||void 0===n?void 0:n.trim()
if(o(r))return null
const i=t.origin,a=t.source,c=t.searchEntity,l=t.facets,d=t.selectedFacetOptions,f=t.spellCheckEnabled,h=t.excludedTerms,p=e.host.clientIdentifier,w=new dY(e).withSearchTerm(r).includingAdditionalPlatforms(ee(e)).includingAttributes($p(e)).includingScopedAttributes(Xq,[e_]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
if(ou(e,w),w.includingRelationships(N8),oi(e)&&(w.includingAssociateKeys(dW,[iW]),w.includingScopedAttributes(iW,YK),w.includingScopedRelationships(Xq,[bH])),u(e.client.isTinkerWatch)&&w.withFilter(FG,"tinker"),w.enablingFeature(Vx),w.enablingFeature(KI),s(t.guidedSearchTokens)&&w.addingQuery("selectedFacets",t.guidedSearchTokens.join(",")),s(t.guidedSearchOptimizationTerm)&&w.addingQuery("finalTerm",t.guidedSearchOptimizationTerm),e.bag.isLLMSearchTagsEnabled&&w.includingAssociateKeys("results:apps",[IV]),e.featureFlags.isEnabled(LJ)&&w.includingScopedAttributes(dW,[Yj]),c===QU?w.searchingOverTypes([Xq]):c===$H?w.searchingOverTypes([pV]):c===cW||c===sW?w.searchingOverTypes([dW]).withFilter(FG,c):w.searchingOverTypes([dW,pV,MV,Xq,Zq,JH]),e.appleSilicon.isSupportEnabled&&!e.appleSilicon.isRosettaAvailable&&w.addingQuery("restrict","!requiresRosetta"),l)for(const e of Object.keys(l))w.addingQuery(e,l[e])
if(d)for(const e of Object.keys(d)){const t=E9.requestValuesForSelectedFacetOptions(d[e])
if(s(t)){w.addingQuery(e,t.value)
for(const e of Object.keys(t.additionalKeyValuePairs))w.addingQuery(e,t.additionalKeyValuePairs[e])}}const g=e.bag.isNaturalLanguageSearchEnabled||e.bag.isNaturalLanguageSearchResultsEnabled,v=g?"source":"src"
if(i===J$){const e=g&&(null==a?void 0:a.length)?"hint:".concat(a):Q$
w.addingQuery(v,e)}else i===FR?w.addingQuery(v,GP):i===GB?w.addingQuery(v,GB):i===NR?w.addingQuery(v,"searchInstead"):i===BR?w.addingQuery(v,FS):i===t_&&w.addingQuery(v,lj)
switch(p){case iY:w.addingContext(cW)
break
case sY:w.addingContext(sq)
break
case aY:w.addingContext(sW)}return w.addingQuery("limit[ads-result]",e.bag.mediaAdvertRequestLimit.toString()),s(e.bag.adsOverrideLanguage)&&w.enablingFeature(hA),f&&w.enablingFeature("spellCheck"),g&&w.enablingFeature(WI),w.enablingFeature("searchResultCpps"),h&&w.addingQuery("excludeTerms",h.join(",")),w}function $p(e){const t=[Yj,xL,kj,aH,TG,$L,IH,aB,yE,n_,PF,Oq]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),e.host.isOSAtLeast(15,5,0)&&t.push(bj),t}function Fp(e,t){return qv.context("developerPageFromResponse",()=>{const n=t.data.length?t.data[0]:null
if(!n)return null
const r=Un(e,"Artist",n.id,t),i=function(e,t,n,r){switch(e.client.deviceType){case lW:return function(e,t,n,r){var i
e.appleSilicon.isSupportEnabled?(jp(t,KV,[pG,gN]),jp(t,pG,[gN])):jp(t,KV,[pG])
const a=Iq,c=y6.LockupIconSmall
let u=0
const d=[]
for(const f of K8){const h=fe(t,f),p=l(h,Gj),w=p.length
if(0===w)continue
if(f===jj&&0===w)continue
const g=Up(e,f,t)
bh(0,{pageInformation:n,locationTracker:r,idType:Aq,id:`${u}`,targetType:dq},g)
const v={lockupOptions:{metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:c},filter:Qv.DeveloperPage},m=p.filter(e=>o(e.attributes)),y=(null===(i=h.next)||void 0===i?void 0:i.length)>0||w>=8,A=Gp(e,g,t.id,p,f,a,v,n,r,h.href,y),T=A.items.length+m.length
T<3&&(A.rowsPerColumn=T)
const b={id:null,kind:null,softwareType:null,targetType:dq,title:A.title,pageInformation:n,locationTracker:r,idType:null}
if(Ph(r),Mh(e,A,b),Oh(r),m.length){const e=new e7
e.title=g,e.developerId=t.id,e.contentType=Iq,e.remainingData=m,e.lockupListOptions=v,e.relationship=f,e.roomUrl=h.href,e.shouldShowSeeAll=y,e.hasExistingContent=s(A.items),A.url=`${OW}:/${xW.developer}/${xW.shelf}/`+encodeURIComponent(JSON.stringify(e))}A.items.length>0&&(d.push(A),u++)}return d}(e,t,n,r)
case cW:return function(e,t,n,r,i,a,c){const l=we(n,r),u={lockupOptions:{metricsOptions:{pageInformation:a,locationTracker:c},artworkUseCase:y6.LockupIconSmall},filter:Qv.DeveloperPage}
bh(0,{pageInformation:a,locationTracker:c,idType:Aq,id:"0",targetType:dq},i)
const d=Gp(e,i,n.id,l,r,t,u,a,c,null,!1),f=l.filter(e=>o(e.attributes)),h={id:null,kind:null,softwareType:null,targetType:dq,title:i,pageInformation:a,locationTracker:c,idType:null}
if(Ph(c),Mh(e,d,h),Oh(c),f.length){const e=new e7
e.title=i,e.developerId=n.id,e.contentType=t,e.remainingData=f,e.lockupListOptions=u,e.hasExistingContent=s(d.items),d.url=`${OW}:/${xW.developer}/${xW.shelf}/`+encodeURIComponent(JSON.stringify(e))}return[d]}(e,Iq,t,JX,e.loc.string(RE),n,r)
case Qq:return Bp(e,t,Q8,n,r)
case LV:return Bp(e,t,X8,n,r)
default:return Bp(e,t,Z8,n,r)}}(e,n,r,{rootPosition:0,locationStack:[]})
1===i.length&&(i[0].isHorizontal=!1)
const a=Wf(e,n,aW)
if(a){const e=new FX(a,bV),t=new dJ(Nj)
t.items=[e],i.unshift(t)}const c=new pJ(i)
c.title=j(n,fW),e.client.deviceType!==cW&&(c.presentationOptions=[sj]),c.canonicalURL=j(n,Wq),jn(e,c,r)
const u=B(n,ZL)
if(u){const t=Zd(e,u,{cropCode:"sr",useCase:y6.Uber})
c.uber=t
{const e=new dJ("uber"),n=new T2(ZT)
n.artwork=t,e.items=[n],n.title=c.title,i.unshift(e),c.presentationOptions.push(rM),c.presentationOptions.push(yN)}}return c})}function Np(e,t,n){switch(t){case jj:return e.loc.string(DE)
case vN:return e.loc.string("DEVELOPER_SYSTEM_APPS")
case CB:return e.loc.string("DEVELOPER_IMESSAGE")
case wU:return e.loc.string(RE)
case gU:return e.loc.string("DEVELOPER_TV")
case Zq:return e.loc.string(_E)
case mN:return e.loc.string("DEVELOPER_VISION")
case wG:const t=H(n,QT),r=H(n,XT)
return t&&r?e.loc.string(eb):r?e.loc.string(tb):e.loc.string(nb)
case KV:return e.loc.string(LE)
default:return null}}function Bp(e,t,n,r,i){var a,c
let u,d
switch(jp(t,KV,[wG,gU]),e.client.deviceType){case"tv":case LV:u=oq,d=y6.LockupIconMedium
break
default:u=Iq,d=y6.LockupIconSmall}let f=0
const h=[]
for(const p of n){const n=fe(t,p),w=l(n,Gj),g=w.length
if(0===g)continue
if(p===jj&&0===g)continue
let v,m
v=p===CB?sY:p===wU?iY:p===gU?cY:oY,m=Np(e,p,t),bh(0,{pageInformation:r,locationTracker:i,idType:Aq,id:`${f}`,targetType:dq},m)
const y={lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},clientIdentifierOverride:v,artworkUseCase:d},filter:Qv.DeveloperPage},A=w.filter(e=>o(e.attributes)),T=((null===(a=n.next)||void 0===a?void 0:a.length)>0||g>=8)&&!0,b=Gp(e,m,t.id,w,p,u,y,r,i,n.href,T),S=b.items.length+A.length
S<3&&(b.rowsPerColumn=S)
const P={id:null,kind:null,softwareType:null,targetType:dq,title:b.title,pageInformation:r,locationTracker:i,idType:null}
if(Ph(i),Mh(e,b,P),Oh(i),A.length){const e=new e7
e.title=m,e.developerId=t.id,e.contentType=u,e.remainingData=A,e.lockupListOptions=y,e.relationship=p,e.roomUrl=n.href,e.shouldShowSeeAll=T,e.hasExistingContent=s(b.items),b.url=`${OW}:/${xW.developer}/${xW.shelf}/`+encodeURIComponent(JSON.stringify(e))}(b.items.length>0||(null===(c=b.url)||void 0===c?void 0:c.length)>0)&&(h.push(b),f++)}return h}function Up(e,t,n){switch(t){case jj:return e.loc.string(DE)
case Zq:return e.loc.string(_E)
case pG:if(e.appleSilicon.isSupportEnabled)return e.loc.string("DEVELOPER_MAC_APPS")
{const t=H(n,QT),r=H(n,XT)
return t&&r?e.loc.string(eb):r?e.loc.string(tb):e.loc.string(nb)}case gN:return e.loc.string("DEVELOPER_PHONE_PAD_APPS")
case KV:return e.loc.string(LE)
default:return null}}function Gp(e,t,n,o,s,a,c,l,u,d,f){const h=new dJ(a)
if(h.title=t,a===fN?(h.items=function(e,t,n){return qv.context("screenshotsLockupsFromData",()=>{if(!t)return[]
const o=[]
for(let s=0;s<t.length;s++){const a=t[s]
if(r(a.attributes)){n.contentUnavailable&&n.contentUnavailable(s,a)
continue}const c=n.lockupOptions
let l=Qv.All
if(i(n.filter)&&(l=n.filter),at(e,a,l))continue
const u=Od(e,a,c)
u.isValid()&&(o.push(u),Oh(n.lockupOptions.metricsOptions.locationTracker))}return o})}(e,o,c),h.isHorizontal=!1,h.presentationHints={showSupplementaryText:!1}):(h.items=$d(e,o,c),h.isHorizontal=e.client.deviceType!==cW),f){const r=new J8
r.title=t,r.url=d,r.developerId=n,r.relationshipId=s,r.clientIdentifierOverride=c.lockupOptions.clientIdentifierOverride
const o=new EY(wW)
o.pageUrl=i(p=r)?`${OW}:/${xW.developer}/${xW.room}/`+encodeURIComponent(JSON.stringify(p)):null,o.title=e.loc.string(cH),o.pageData=fc(0,t),Xs(e,o,o.pageUrl,{pageInformation:l,locationTracker:u}),h.seeAllAction=o}var p
return h}function jp(e,t,n){const o=fe(e,t)
if(r(o))return
const i=At(o)
if(r(i))return
const s=i.map(e=>e.id)
for(const t of n){const n=fe(e,t)
if(r(n))continue
const o=At(n)
r(n)||(e.relationships[t].data=o.filter(e=>!s.includes(e.id)))}}function Vp(e,t,n,r){const o=function(e,t,n,r){const o=Hp(0,n.collectionDisplayStyle)
return{...n.metricsImpressionOptions,...r,id:t.id,targetType:o}}(0,t,n,r)
return Fd(e,t,o,n.clientIdentifierOverride)}function Hp(e,t){switch(t){case um.Hero:return ZU
case um.TextOnly:return oM
case um.TextWithArtwork:return"textWithArtwork"
case um.BrickSmall:return"brickSmall"
case um.BrickMedium:return"brickMedium"
case um.BrickLarge:return"brickLarge"
case um.EditorialLockupMedium:case um.EditorialLockupMediumVariant:return"editorialLockupMedium"
case um.EditorialLockupLarge:case um.EditorialLockupLargeVariant:return"editorialLockupLarge"
case um.LockupSmall:return kB
case um.LockupLarge:return"lockupLarge"
case um.StorySmall:return"storySmall"
case um.StoryMedium:return"storyMedium"
case um.BreakoutLarge:return AN
default:return tW}}function qp(e,t,n){let r=null,s=null,a=[]
const c=kn(0,t)
switch(t.type){case Xq:case XH:case vU:a=["enrichedEditorialNotes.badge",mG,YH],r=Zp(e,t,a,!1),s=Zp(e,c,a,!1)
break
case dW:case JH:case Zq:a=[mG],r=Zp(e,t,a,!0),s=Zp(e,c,a,!0)}const l=i(s)?s:r
return o(l)?null:l}function Wp(e,t,n){let r=null,s=[]
switch(n){case pN:case hN:switch(t.type){case Xq:case XH:case vU:s=[ib,oV],r=Jp(t,s)
break
case dW:case JH:case Zq:s=[iV],r=Zp(e,t,s,!0)}break
default:switch(t.type){case Xq:case XH:case vU:s=[ib,oV],r=Zp(e,t,s,!1)
break
case IV:case dW:case JH:case Zq:s=[fW],r=Zp(e,t,s,!1)}}const a=Zp(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function zp(e,t,n=!1){let r=null,s=[]
switch(t.type){case Xq:n?s=[sb,iV]:H(t,xE)||(s=["enrichedEditorialNotes.short",$E]),r=Zp(e,t,s,!1)
break
case XH:case vU:s=[sb,iV],r=Zp(e,t,s,!1)
break
case dW:case JH:case Zq:s=[iV],r=Zp(e,t,s,!0)}const a=Zp(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Yp(e,t){let n=null,r=[]
switch(t.type){case Xq:case XH:case vU:r=[ab,x$],n=Zp(e,t,r,!1)
break
case dW:case JH:case Zq:r=[ab,x$],n=Zp(e,t,r,!0)}const o=Zp(e,kn(0,t),r,!1)
let i=null
return i=(null==o?void 0:o.length)>0?o:s(n)?n:e.loc.string(FE),i}function Jp(e,t){return o(e)?null:j(e,t)}function Kp(e,t,n){return o(e)?null:ce(e,t,n)}function Zp(e,t,n,r){if(o(t))return null
const i=nt(e,t)
for(const e of n){const n=r?Kp(t,i,e):Jp(t,e)
if(s(n))return n}return null}function Qp(e,t,n){const r={}
Sh(0,n.metricsOptions,NE)
const a=hd(e,t,n)
Ph(n.metricsOptions.locationTracker)
const c=pd(e,t,n)
return s(a)&&(a.length>1||o(c))?r.collectionIcons=a:i(c)&&(r.lockup=c,r.collectionIcons=[c.icon]),r}function Xp(e,t,n,r){const o=[],s=new dJ(r)
s.isHorizontal=j(t.data,SN)===AU
const a=In(0,t)
for(const r of a){const i={...t.metricsImpressionOptions,targetType:Hp(0,n),recoMetricsData:St(r)}
if(r.attributes&&!gw(t)){{const n=ew(e,r,t.collectionDisplayStyle,i,i,t.clientIdentifierOverride),s=j(r,DH)===VE,a=rh(e,r)
if(n.clickAction=Vp(e,s&&a?a:r,t),!n.isValid())continue
o.push(n)}Oh(t.metricsImpressionOptions.locationTracker)}else t.remainingItems.push(r),t.isDeferring=!0}return i(t.presentationHints)&&(s.presentationHints=t.presentationHints),delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=o,s.rowsPerColumn=q(t.data,CN),s.url=vw(0,0,t),Xa(e,s,t),s}function ew(e,t,n,r,i,a){const c=new r4,l=On(0,t)
if(!u(l.hideEditorialMedia)){const r=fd(e,t,n);(0,Wv.isSome)(null==r?void 0:r.artwork)&&(c.artworks=[r.artwork],c.isMediaDark=ld(0,r)),(0,Wv.isSome)(null==r?void 0:r.rtlArtwork)&&(c.rtlArtwork=null==r?void 0:r.rtlArtwork,c.isRTLMediaDark=ld(0,r,!0))}const d={metricsOptions:i,clientIdentifierOverride:a,artworkUseCase:y6.Default,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:na(0,t)}
if(Sh(0,d.metricsOptions,NE),c.collectionIcons=hd(e,t,d),Ph(d.metricsOptions.locationTracker),o(c.collectionIcons)){const n=tf(e,t,{useCase:y6.Default})
s(n)&&(c.collectionIcons=[n])}c.caption=qp(e,t),c.title=Wp(e,t,n),c.subtitle=zp(e,t),c.accessibilityLabel=c.title,c.editorialDisplayOptions=En(l)
const f=s(c.artworks)?wV:"collection_id",h={...r,id:t.id,idType:f}
return Mh(e,c,Bh(e,t,c.title,h)),c.artworkSafeArea=o4.defaultTileArtworkSafeArea,c.textSafeArea=o4.defaultTileTextSafeArea,c}function tw(e,t,n,r){const o=new K4
o.overlayType=nl(e,t),o.displayOptions={horizontalPlacement:eW,textAlignment:eW,isOverDarkContent:il(e,t)},o.badgeText=qp(e,t,um.Hero),o.titleText=Wp(e,t,um.Hero),r.suppressTagline||(o.descriptionText=zp(e,t,!0)),o.callToActionText=Yp(e,t),o.buttonTitle=ol(e,t)
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:kB,recoMetricsData:St(t)},metricsClickOptions:{id:t.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,actionDetails:{franchise:o.badgeText}},artworkUseCase:y6.LockupIconSmall,offerEnvironment:Gq,canDisplayArcadeOfferButton:th(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:na(0,t)},c=pd(e,t,a),l=Qp(e,t,a)
o.lockup=l.lockup,o.collectionIcons=l.collectionIcons
const u=j(t,YH)
s(u)&&i(c)&&(c.heading=u)
const d=(0,Wv.isSome)(r.suppressLockup)&&r.suppressLockup
if(s(o.lockup)&&!d)o.clickAction=o.lockup.clickAction,o.impressionMetrics=o.lockup.impressionMetrics
else{const r={targetType:ZU,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i={...r,id:t.id,actionDetails:{franchise:o.badgeText}}
o.clickAction=Ud(e,t,i,n.clientIdentifierOverride),Mh(e,o,Bh(e,t,o.titleText,r))}return o}function nw(e,t,n,r,o){if(!n){const e=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor
t.backgroundColor=e
const n=o?null==r?void 0:r.rtlArtworkData:null==r?void 0:r.artworkData
t.titleEffect=Mc(0,n)
const i=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork
t.artwork=i
const s=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video
t.video=s}t.isMediaDark=ld(0,r,o)}function rw(e){return{isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}}function ow(e,t,n,a,c){if(o(t))return null
let l
n.showOrdinals&&(l=e.loc.decimal(n.ordinalIndex))
let u,d=null
!i(n.shelfBackground)||n.shelfBackground.type!==PV&&n.shelfBackground.type!==sM||(d=uq),s(n)&&(u=n.clientIdentifierOverride)
const f={ordinal:l,metricsOptions:{...{...n.metricsImpressionOptions,id:t.id,idType:Sq},recoMetricsData:St(t),isAdvert:Ut(0,t),targetType:Hp(0,c)},clientIdentifierOverride:u,artworkUseCase:y6.Default,offerStyle:d,canDisplayArcadeOfferButton:th(0,c),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(hm.ShowOnlyPreorder)}
let h
switch(c){case pN:case PB:case hN:case SB:f.offerEnvironment=hq,h=Dd(e,t,f,c)
break
case"Poster":h=Ed(e,t,f)
break
default:h=Cd(e,t,f)}return r(h)||!h.isValid()?null:(h.id=function(e,t,n){return(0,Wv.isNothing)(n)?null:`${e.id}_${t}_${n}`}(n,a,h.adamId),h)}function iw(e,t){return lw(e,t,um.EditorialLockupHierarchicalPortrait,bU,!0,fm.Vertical)}function sw(e,t){return lw(e,t,um.EditorialLockupLarge,F$)}function aw(e,t,n=!0,r){return e.featureFlags.isEnabled(kJ)&&(t.showOrdinals=!0),lw(e,t,um.LockupSmall,Iq,n,r)}function cw(e,t,n=!0){return lw(e,t,um.LockupLarge,mB,n)}function lw(e,t,n,o,i=!0,s){const a=[],c=new dJ(o),l=null!=s?s:Pn(t)
c.isHorizontal=l===fm.Horizontal
const u=In(0,t),d=void 0
for(const[o,i]of u.entries()){if(i.type===iW)return null
if(r(i.attributes)||gw(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}if(at(e,i,Qv.All))continue
let o=null
if(o=ow(e,i,t,a.length,n),o&&(a.push(o),Oh(t.metricsImpressionOptions.locationTracker),t.ordinalIndex++,a.length===d))break}if(n!==um.EditorialLockupMediumVariant&&n!==um.EditorialLockupLargeVariant||(r(c.presentationHints)?c.presentationHints={showSupplementaryText:!0}:c.presentationHints={...c.presentationHints,showSupplementaryText:!0}),delete t.maxItemCount,c.eyebrow=t.eyebrow,c.eyebrowArtwork=t.eyebrowArtwork,c.title=t.title,c.subtitle=t.subtitle,c.items=a,c.rowsPerColumn=q(t.data,CN),c.shouldFilterApps=!t.filterOverrides.includes(hm.ShowInstalled),c.url=vw(0,0,t),i){let n=d;(0,Hv.isSome)(d),Xa(e,c,t,n)}return c}function uw(e,t,n,r,o,a,c){var l,d
const f=On(0,t),h=new l4
if(h.title=Wp(e,t,o),f.suppressShort||(h.description=zp(e,t)),!u(f.hideEditorialMedia)){const r=rd(e,t,n)
if(h.artwork=null==r?void 0:r.artwork,h.video=null==r?void 0:r.video,h.isMediaDark=null!==(l=ld(0,r))&&void 0!==l?l:void 0,n===Fm.StoryDetail){const n=rd(e,t,Fm.StoryDetailLandscape)
h.landscapeArtwork=null==n?void 0:n.artwork,h.landscapeVideo=null==n?void 0:n.video,h.isLandscapeMediaDark=null!==(d=ld(0,n))&&void 0!==d?d:void 0}}const p=Qp(e,t,{metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,recoMetricsData:St(t)},artworkUseCase:y6.LockupIconSmall,offerEnvironment:f.useMaterialBlur?hq:TU,canDisplayArcadeOfferButton:th(0,o),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:na(0,t),useJoeColorIconPlaceholder:!1}),w=a&&u(f.suppressLockup)
w||(h.lockup=p.lockup)
const g=Cn(e,t)
if(H(g,wq),qf(e,g),s(g)&&!w&&at(e,g,Qv.All)&&n!==Fm.StoryDetail)return null
let v
if(v=qp(e,t),h.badge={type:QV,title:v},h.collectionIcons=p.collectionIcons,i(c)){const n={id:t.id,pageInformation:c.metricsPageInformation,locationTracker:c.metricsLocationTracker,actionDetails:{franchise:h.badge.title},idType:SU}
h.clickAction=Vp(e,t,c,n)}h.editorialDisplayOptions=En(f)
const m={...r,id:t.id,idType:SU}
return Mh(e,h,Bh(e,t,h.title,m)),h}function dw(e,t,n,o){const i=[],s=new dJ(o),a=Pn(t)
s.isHorizontal=a===AU
const c=In(0,t)
for(const o of c){const s={...t.metricsImpressionOptions,targetType:Hp(0,n),recoMetricsData:St(o)}
if(!W(o)||gw(t)){t.remainingItems.push(o),t.isDeferring=!0
continue}let a=null
a=uw(e,o,Fm.StoryCard,s,t.collectionDisplayStyle,!0,t),r(a)||(i.push(a),Oh(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=i,s.rowsPerColumn=q(t.data,CN),s.url=vw(0,0,t),Xa(e,s,t),s}function fw(e,t,n){const r=_n(0,t)
o(r)||(n.displayStyle=r)}function hw(e,t,n,r,o,i,s,a=!1,c=null){const l={id:f(n,"id"),type:n.type,collectionDisplayStyle:null!=c?c:_n(0,n),filterOverrides:G(n,"filterOverrides"),pageId:t,data:n,presentationHints:{},clientIdentifierOverride:null,isFirstRender:!0,shouldFilter:!0,gamesFilter:ww(n),hasExistingContent:!1,title:null,subtitle:null,eyebrow:null,titleArtwork:null,remainingItems:[],metricsImpressionOptions:null,metricsPageInformation:i,metricsLocationTracker:s,recoMetricsData:es(e,n),isDeferring:!1,showOrdinals:!1,ordinalIndex:1,isSearchLandingPage:!1,isArcadePage:r,shelfIndex:o,isSeeAll:a}
return pw(e,n,l),l}function pw(e,t,n){let r=j(t,oV),o=j(t,iV),i=j(t,mG),a=null,c=!1
const l=pe(e,t,yU)
s(l)&&(i=e.loc.uppercased(j(t,oV)),r=j(l,oV),a=tf(e,l,{useCase:y6.LockupIconSmall}),o=null,c=!0)
const u=function(e,t,n,r,o){const i=t.type,s=_n(0,t),a={id:f(t,"id"),kind:null,softwareType:null,targetType:dq,title:n,pageInformation:r,locationTracker:o,idType:cb,shelfType:i,recoMetricsData:St(t),canonicalId:f(t.meta,bN)}
switch(i){case lm.Collection:fw(0,t,a),s===um.Hero&&function(e,t){t.title=cj
const n=rw(e)
t.autoAdvanceInterval=n.autoScrollInterval}(e,a)
break
case lm.Recommendations:fw(0,t,a)}return a}(e,t,c?i:r,n.metricsPageInformation,n.metricsLocationTracker)
n.title=r,n.subtitle=o,n.eyebrow=i,n.titleArtwork=a,n.metricsImpressionOptions=u}function ww(e){let t=null
switch(j(e,"clientFilter")){case pm.ArcadeGames:t=sW
break
case pm.AllGames:t="all"}return t}function gw(e){return e&&e.isDeferring&&e.isFirstRender}function vw(e,t,n){return o(n)?null:(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?function(e){return(new az).set(Uj,OW).append(gV,xW.editorialPage).append(gV,xW.shelf).param(zW.token,encodeURIComponent(JSON.stringify(e))).build()}(n):null}function mw(e,t,n){if(o(n)||o(t))return null
if(function(e){if(e.isSeeAll)return!1
switch(e.collectionDisplayStyle){case um.BreakoutLarge:case um.Poster:return!1}return!e.filterOverrides.includes(hm.ShowOnlyPreorder)||!1}(n)){const r=new EY(wW)
if(!nc(t)){const o=`shelf_${n.id}`
r.pageData=function(e,t,n,r,o){const i=Aw(e,void 0,(_n(0,t.data),hw(e,t.pageId,t.data,t.isArcadePage,t.shelfIndex,t.metricsPageInformation,{rootPosition:0,locationStack:[]},!0,null)))
if(null===i)return null
let s
i.title=null,i.eyebrow=null,i.isHorizontal=!1,i.id=r,s=new d5(null,t.title,null)
const a=new dJ(aM)
a.id=BE,a.items=[s]
const c=new pJ([a,i])
return c.isIncomplete=!(null!=o&&o),(0,Hv.isNothing)(c.pageMetrics.pageFields)&&(c.pageMetrics.pageFields={}),c}(e,n,t.contentType,o,(0,Hv.isSome)(n.recommendationsHref))}const o={}
n.type===lm.Recommendations&&(o[zW.editorialPageId]=n.pageId),r.pageUrl=Fi(e,n.data.href,o),r.title=e.loc.string(cH),r.referrerUrl=n.metricsPageInformation.pageUrl
const i=function(e){const t=[]
for(const n of e.locationStack)t.push({...n})
return{rootPosition:e.rootPosition,locationStack:t}}(n.metricsLocationTracker)
return kh(i,0),Xs(e,r,n.seeAllUrl,{pageInformation:n.metricsPageInformation,locationTracker:i}),r}return null}function yw(e,t,n,r,o){n||(t.backgroundColor=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor,t.artwork=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork,t.video=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video),t.isMediaDark=ld(0,r,o)}function Aw(e,t,n){let a=null
switch(n.isFirstRender&&bh(0,n.metricsImpressionOptions,n.title),n.type){case lm.ArcadeSeeAllGames:a=function(e,t){const n=new e4,o=new dJ(ME)
o.items=[n]
const i={targetType:lb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(p$),id:t.id,kind:ub,softwareType:vq}
Mh(e,n,i),bh(0,i,i.title),n.buttonAction=eo(e,cU,t.metricsPageInformation,t.metricsLocationTracker)
const a={targetType:hW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:n.buttonAction.title,id:"SeeAllGames",kind:hW,softwareType:vq}
Mh(e,n.buttonAction,a),Ph(i.locationTracker)
const c=e.bag.termsAndConditionsURL
if(!r(c)&&"tv"!==e.client.deviceType){const t=e.loc.string(GE),r=new GY(c),o=new t4(t)
o.clickAction=r,o.presentationStyle=[cM,lM,uM],n.footnote=o}o.background={type:PV,color:Se(uE)}
const l=In(0,t)
if(s(l)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
n.icons=Xd(e,l,r,{useCase:y6.LockupIconMedium})}else n.icons=[]
return o}(e,n)
break
case lm.Collection:a=function(e,t){let n=j(t.data,CH)
if(o(n))return null
let a=null
switch(n){case um.Hero:a=function(e,t){if(0!==t.shelfIndex)return null
const n=new dJ(cj),r=new I4
r.autoScrollConfiguration=rw(e)
const o=In(0,t)
for(const n of o){const o=Rn(e,n)
if(Dn(0,n)&&!W(o)||gw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i={...t.metricsImpressionOptions,idType:wV,targetType:ZU,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},s=rd(e,n,Fm.Hero),a=Qp(e,n,{metricsOptions:i,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:y6.Default,offerEnvironment:TU,canDisplayArcadeOfferButton:!0}),c=new C4,l=Zc(0,n),d=Wp(e,n,um.Hero),f=Bh(e,n,d,i)
f.isPreorder=et(e,l,wq),Mh(e,c,f),bh(0,f,d)
const h=On(0,n),p=u(h.hideEditorialMedia)
c.overlay=tw(e,n,t,h),c.collectionIcons=a.collectionIcons,c.editorialDisplayOptions=En(h),nw(0,c,p,s,!1),c.isValid()&&r.items.push(c)
const w=S(c)
nw(0,w,p,s,!0),w.isValid()&&r.rtlItems.push(w),Ph(f.locationTracker),Oh(f.locationTracker)}return delete t.maxItemCount,n.isHorizontal=!1,n.eyebrow=t.eyebrow,n.eyebrowArtwork=t.eyebrowArtwork,n.title=t.title,n.subtitle=t.subtitle,n.items=[r],n.url=vw(0,0,t),n}(e,t)
break
case um.TextOnly:a=function(e,t){var n
const o=[],i=new dJ(eq)
i.isHorizontal=j(t.data,SN)===fm.Horizontal
const s=In(0,t)
for(const n of s){if(r(n.attributes)||gw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Vp(e,n,t)
i.title=Wp(e,n,t.collectionDisplayStyle)
const s={...t.metricsImpressionOptions,id:n.id,idType:SU,targetType:oM}
Mh(e,i,Bh(e,n,i.title,s)),o.push(i),Oh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,CN))&&void 0!==n?n:1,i.url=vw(0,0,t),Xa(e,i,t),i}(e,t)
break
case um.TextWithArtwork:a=function(e,t){var n
const o=[],i=new dJ(eq)
i.isHorizontal=j(t.data,SN)===fm.Horizontal
const a=In(0,t)
for(const n of a){if(r(n.attributes)||gw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Vp(e,n,t)
let a
i.title=Wp(e,n,t.collectionDisplayStyle),a=B(n,oW),s(a)&&(i.artwork=Zd(e,a,{allowingTransparency:!0,useCase:y6.CategoryIcon})),o.push(i),Oh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,CN))&&void 0!==n?n:1,i.url=vw(0,0,t),Xa(e,i,t),i}(e,t)
break
case um.BrickSmall:a=function(e,t){return Xp(e,t,um.BrickSmall,"smallBrick")}(e,t)
break
case um.BrickMedium:a=function(e,t){return Xp(e,t,um.BrickMedium,gG)}(e,t)
break
case um.BrickLarge:a=function(e,t){return Xp(e,t,um.BrickLarge,"largeBrick")}(e,t)
break
case um.EditorialLockupHierarchicalPortrait:a=iw(e,t)
break
case um.EditorialLockupHierarchicalRows:a=function(e,t){return lw(e,t,um.EditorialLockupHierarchicalRows,bU,!0,fm.Vertical)}(e,t)
break
case um.EditorialLockupMedium:a=function(e,t){return lw(e,t,um.EditorialLockupMedium,bU)}(e,t)
break
case um.EditorialLockupMediumVariant:a=function(e,t){return lw(e,t,um.EditorialLockupMediumVariant,bU)}(e,t)
break
case um.EditorialLockupLarge:a=sw(e,t)
break
case um.EditorialLockupLargeVariant:a=function(e,t){return lw(e,t,um.EditorialLockupLargeVariant,F$)}(e,t)
break
case um.LockupMedium:a=function(e,t){return t.metricsImpressionOptions.shouldOmitImpressionIndex=!0,lw(e,t,um.LockupMedium,oq)}(e,t)
break
case um.Poster:a=function(e,t){const n=lw(e,t,um.Poster,EB)
return(0,Hv.isSome)(n)&&(n.horizontalScrollTargetBehavior=Hm.CenterAligned),n}(e,t)
break
case um.StorySmall:a=function(e,t){return dw(e,t,um.StorySmall,EV)}(e,t)
break
case um.StoryMedium:a=function(e,t){return dw(e,t,um.StoryMedium,kN)}(e,t)
break
case um.LockupSmall:a=aw(e,t)
break
case um.LockupLarge:a=cw(e,t)
break
case um.BreakoutLarge:a=function(e,t){const n=[],r=new dJ(L$)
r.isHorizontal=j(t.data,SN)===AU
const s=In(0,t)
for(const r of s){const s=Rn(e,r)
if(Dn(0,r)&&!W(s)||gw(t)){t.isDeferring=!0,t.remainingItems.push(r)
continue}const a={targetType:AN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},c=On(0,r),l=u(c.hideEditorialMedia)?null:fd(e,r,t.collectionDisplayStyle),d=Qp(e,r,{metricsOptions:a,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:y6.Default,offerEnvironment:TU,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:na(0,r)})
if(o(l)&&o(d.collectionIcons))continue
const f=qp(e,r,t.collectionDisplayStyle),h=i(f)?{type:QV,title:f}:{type:mq,title:null},p=new B4(Wp(e,r,t.collectionDisplayStyle),zp(e,r,!0),h,null),w=new X4(p,{position:eW,wantsBlur:!0},null,null==l?void 0:l.artwork,null==l?void 0:l.video,d.collectionIcons,null==l?void 0:l.backgroundColor)
w.rtlArtwork=null==l?void 0:l.rtlArtwork,w.rtlVideo=null==l?void 0:l.rtlVideo,w.rtlBackgroundColor=null==l?void 0:l.rtlBackgroundColor
const g={...a,id:r.id,idType:wV}
Mh(e,w,Bh(e,r,w.details.title,g))
const v=Vp(e,r,t)
i(v)&&(v.title=Yp(e,r)),w.details.callToActionButtonAction=v,w.clickAction=v,w.editorialDisplayOptions=En(c),w.lockup=d.lockup,w.isMediaDark=ld(0,l),w.isRTLMediaDark=ld(0,l,!0),n.push(w)}return delete t.maxItemCount,r.eyebrow=t.eyebrow,r.eyebrowArtwork=t.eyebrowArtwork,r.title=t.title,r.subtitle=t.subtitle,r.items=n,r.rowsPerColumn=q(t.data,CN),r.url=vw(0,0,t),Xa(e,r,t),r}(e,t)}return s(a)&&(a.seeAllAction=mw(e,a,t),a.id=`shelf_${t.id}`),a}(e,n)
break
case lm.Chart:a=function(e,t){let n
if(t.showOrdinals=!0,n=aw(e,t,!1,fm.Horizontal),!(0,Hv.isNothing)(n))return n.url=vw(0,0,t),Xa(e,n,t),function(e,t,n){e.featureFlags.isEnabled(AJ)?(0,Hv.isSome)(t.header)?function(e,t,n){e.featureFlags.isEnabled(AJ)?t.titleAction=n:t.accessoryAction=n}(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}(e,n,function(e,t){const n=j(t.data,PH),r=j(t.data,aq),o=new EY(wW)
return o.pageUrl=xf(e,n,r),o.title=e.loc.string(cH),o.referrerUrl=t.metricsPageInformation.pageUrl,Xs(e,o,o.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),o}(e,t)),n}(e,n)
break
case lm.Tag:case lm.Engagement:case lm.Text:case lm.Image:case lm.VideoClip:a=null
break
case lm.Header:a=function(e,t,n){var r,o,i
const a=s(B(n.data,hV))?n.data:t
if(!a)return null
if(s(B(a,$q))){const t=new I4,r=new C4,o=On(0,a),i=tw(e,a,n,o)
i.overlayType=QV,i.callToActionText=null,r.clickAction=null,i.collectionIcons=null,i.lockup=null,i.callToActionText=null,r.overlay=i
const s={artworkUseCase:y6.LockupIconSmall,offerStyle:Pj,offerEnvironment:Gq,canDisplayArcadeOfferButton:th(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:na(0,a)}
Sh(0,s.metricsOptions,NE)
const c=hd(e,a,s)
Ph(s.metricsOptions.locationTracker),r.collectionIcons=c
const l=rd(e,a,Fm.Hero),d=u(o.hideEditorialMedia)
yw(0,r,d,l,!1),r.editorialDisplayOptions=En(o),t.items=[r]
const f=S(r)
yw(0,f,d,l,!0),t.rtlItems=[f]
const h=new dJ(cj)
return h.items=[t],h}{const t=(0,Yv.attributeAsString)(a,fW)
if(s(t)&&Gi(e,null)){const s=new dJ(M$)
s.id=M$
const c=null!==(r=(0,Yv.attributeAsString)(a,mG))&&void 0!==r?r:null,l={artworkUseCase:y6.LockupIconSmall,offerStyle:Pj,offerEnvironment:Gq,canDisplayArcadeOfferButton:th(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:na(0,a),useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:ah}
let u,d=null!==(o=hd(e,n.data,l))&&void 0!==o?o:void 0
if((0,Wv.isSome)(d)&&(null==d?void 0:d.length)>=3){d=d.slice(0,3)
const r=d[0].backgroundColor;(0,Wv.isSome)(r)&&(null==r?void 0:r.type)===xV&&(u=oh(r))
const o=be(u),l=On(0,n.data),f=new f5(c,t,null,void 0,void 0,d,!1,null!=u?u:void 0,function(e,t){if(2===t)return dM
switch(e){case HG:return $$
case jE:return"Fan"
case db:return fM
default:return $$}}(null!==(i=l.fallbackDisplayStyleHint)&&void 0!==i?i:HG,null==d?void 0:d.length),o?Gq:hq),h=function(e,t,n,r){return qv.context(GR,()=>{const o=dh(e,t),i=uh(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:wV,targetType:"tagHeader"}})}(e,a,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)})
return function(e,t,n){if(!t)return
const r=new jY(Lh(e,n))
delete r.fields.impressionIndex,t.impressionMetrics=r}(e,f,h),s.items=[f],s}return null}return null}}(e,t,n)
break
case lm.Recommendations:a=function(e,t){let n=null
switch(j(t.data,CH)){case um.LockupSmall:n=aw(e,t,!1)
break
case um.LockupLarge:n=cw(e,t,!1)
break
case um.EditorialLockupHierarchicalPortrait:n=iw(e,t)
break
case um.EditorialLockupLarge:n=sw(e,t)
break
default:n=t.isFirstRender?function(){const e=new dJ(IN)
return e.isHidden=!0,e}():null}return(0,Hv.isNothing)(n)?null:(n.id=`shelf_${t.id}`,function(e,t){const n=s(we(t.data,uW))||s(t.remainingItems),r=H(t.data,"isPersonalizationAvailable"),o=t.data.href
if(!r||n||!s(o))return
const i=ve(e,new dY(e,t.data.href).addingQuery(zW.editorialPageId,t.pageId).includingRelationships([uW]))
t.recommendationsHref=i.toString()}(e,t),n.url=vw(0,0,t),Xa(e,n,t),n.seeAllAction=mw(e,n,t),n)}(e,n)
break
case lm.GameCenter:a=null
break
case lm.Upsell:a=function(e,t){const n=co(e,t.data)
if(o(n))return null
const r=n.marketingItemData
if(o(r)||o(r.attributes))return null
const i=xc(e,r,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:mh(0,r)})
Oh(t.metricsLocationTracker)
const s=new dJ(uG)
return s.items=[i],s}(e,n)
break
case lm.Marker:a=function(e,t){const n=j(t.data,DH)
if(o(n))return null
let r=null
return n===dm.QuickLinks&&(r=function(e,t){if(e.user&&e.user.isManagedAppleID)return null
{const n=[]
if((0,Wv.isSome)(e.bag.aboutAppStoreUrl)){const t=new GY(e.bag.aboutAppStoreUrl)
t.title=e.loc.string("QuickLinks.AboutTheAppStore.Title"),n.push(t)}if((0,Wv.isSome)(e.bag.aboutInAppPurchasesEditorialItemId)){const t=new EY(Tq)
t.title=e.loc.string("QuickLinks.AboutInAppPurchases.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutInAppPurchasesEditorialItemId}`,n.push(t)}if((0,Wv.isSome)(e.bag.reportProblemUrl)){const t=new GY(e.bag.reportProblemUrl)
t.title=e.loc.string(hb,"Report a Problem"),n.push(t)}if((0,Wv.isSome)(e.bag.requestARefundUrl)){const t=new GY(e.bag.requestARefundUrl)
t.title=e.loc.string("QuickLinks.RequestARefund.Title"),n.push(t)}if((0,Wv.isSome)(e.bag.changePaymentMethodUrl)){const t=new GY(e.bag.changePaymentMethodUrl)
t.title=e.loc.string("QuickLinks.ChangePaymentMethod.Title"),n.push(t)}if((0,Wv.isSome)(e.bag.aboutFrenchAppStoreEditorialItemId)){const t=new EY(Tq)
t.title=e.loc.string("QuickLinks.AboutFrenchAppStore.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutFrenchAppStoreEditorialItemId}`,n.push(t)}const r=new dJ(eq)
return r.title=e.loc.string("QuickLinks.Title"),r.items=n,r.isHorizontal=!0,r.rowsPerColumn=1,t.metricsImpressionOptions.title=r.title,r}}(e,t)),r}(e,n)}return o(null==a?void 0:a.items)&&o(null==a?void 0:a.url)&&(a=null),n.isFirstRender&&Ph(n.metricsImpressionOptions.locationTracker),Mh(e,a,n.metricsImpressionOptions),n.isFirstRender&&Oh(n.metricsImpressionOptions.locationTracker),(0,Wv.isSome)(a)&&function(e,t,n){if((0,Hv.isNothing)(t.url)||(0,Hv.isNothing)(t.impressionMetrics)||!n.showingPlaceholders)return
const o=t.url
try{const e=az.from(o).query[zW.token],n=JSON.parse(decodeURIComponent(e))
n.originalPlaceholderShelfImpressionMetrics=t.impressionMetrics,function(e,t,n){const o=az.from(t.url),i=az.from(vw(0,0,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,t,n)}catch{t.url=o}}(0,a,n),a}function Tw(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},r=co(e,t.data)
return o(r)?null:Md(e,r,n,pt(QB),Ej,UE)}function bw(e,t){const n=[$q,Oq,aj],r=[...n,vG,CV,bB,_$],o=[...n,bB],i=[...n,IH,Yj,kj,CV,iH,IH,AH]
e.appleSilicon.isSupportEnabled&&i.push(kH),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([Eq])
const s=[...i]
t.includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).enablingFeatures(["personalization","supportsCustomTextColor"]).includingRelationshipsForUpsell(!0).includingScopedAttributes(Xq,r).includingScopedAttributes(XH,o).includingScopedAttributes(dW,s)}function Sw(e){const{platform:t,...n}=e
return{...n,$kind:i7,platform:ut(t)}}function Pw(e,t,n){var r
const o=function(e,t){switch(t){case w7:return"badge_hardware"
case g7:return"badge_trial_eligible"
default:return null}}(0,t),i={offerHints:o},s=new iZ(sW,pt(mj),e.bag.metricsTopic,null,i)
s.metricsOverlay={...s.metricsOverlay,...n}
const a=null===(r=e.metricsIdentifiersCache)||void 0===r?void 0:r.getMetricsFieldsForTypes([em.user,em.client,em.canonical])
if((0,Hv.isSome)(a)&&(s.metricsOverlay={...s.metricsOverlay,...a}),e.bag.arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new EY(pB),t=ZN
e.pageData=t,e.presentationContext=Wj,s.purchaseSuccessAction=e}const c=new EY(Ij)
return c.pageData=s,c}async function Iw(e,t){const n=t.eventString,r=t.featuresDictionary
if(!i(r))return await Promise.reject("Received non-defined engagement features.")
const o=function(e,t,n,r){switch(t){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t,n){const r=[]
for(const e of v7)if(e in t){const t=new h7(e,!1)
r.push(t)}for(const o of v7){if(n.includes(o)&&!e.bag.unrestrictedServerSideTabBadging)continue
const s=t[o]
if(i(s)){const t=Pw(e,o,s)
r.push(t)
break}}if(r.length>0)return new f7(new ZJ(r))
{const e=new kW
return new f7(e)}}(e,n,r)
case"didBecomeArcadeTrialEligible":if(!e.bag.enableArcadeTrialEligibleBadging)return e.console.log(`Bag prohibits badging for identifier ${g7}`),new f7(new kW)
if(r.includes(g7))return e.console.log(`Badging identifier ${g7} was previously invalidated.`),new f7(new kW)
const t=new h7(g7,!0),o=new p7(sW,e.loc.decimal(1)),s=new ZJ([t,o])
return new f7(s)
case"didSubscribeToArcade":return function(e){const t=[]
for(const e of v7){const n=new h7(e,!1)
t.push(n)}const n=new ZJ(t)
return new f7(n)}()
case"didBecomeSubscribed":if(!i(n[g7]))return new f7(new kW)
const a=new h7(g7,!1)
return new f7(a)
case"didBecomeNonSubscribed":return new f7(new kW)
default:return null}}(e,n,r,i(t.previouslyDisabledFeatures)?t.previouslyDisabledFeatures:[])
return i(o)?await Promise.resolve(o):await Promise.reject("Did not receive a valid engagement event.")}async function Cw(e,t){var n
const r=function(e,t,n,r){if(!v7.includes(t))return null
let o=null
if(n&&e.bag.unrestrictedServerSideTabBadging){const t=e.loc.decimal(1)
o=new p7(sW,t)}else if(n&&!r.includes(t)){const t=e.loc.decimal(1)
o=new p7(sW,t)}else n||(o=new p7(sW,null))
return new f7(o)}(e,t.identifier,t.isEnabled,null!==(n=t.previouslyDisabledFeatures)&&void 0!==n?n:[])
return i(r)?await Promise.resolve(r):await Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${t.identifier}, featuresDictionary: ${JSON.stringify(t.featuresDictionary)}, previouslyDisabledFeatures: ${t.previouslyDisabledFeatures}`))}async function kw(e,t){return await e.required(y3).fetchPage(e,t,DY)}async function Ow(e,t){const n=new dY(e).withIdOfType(t,LM),r=Ln(e,n)
return await r.then(t=>function(e,t){return qv.context("msoProviderDataFromData",()=>{const n=yt(e,t),r=j(n,fW),o=j(n,Wq),i=function(e,t){return qv.context("msoProviderArtworkFromData",()=>{const n=B(t,"editorialArtwork.storeFlowcase")
if(n)return Zd(e,n,{useCase:y6.LockupIconLarge})
const r=B(t,oW)
return Zd(e,r,{useCase:y6.LockupIconLarge})})}(e,n)
i&&(i.crop="sr")
const s=function(e,t){const n=B(t,ZL)
return n?Zd(e,n,{useCase:y6.Uber}):null}(e,n)
return new C7(r,o,i,s)})}(e,t))}async function Ew(e,t){if(r(t.providerAdamId)||r(t.subscribedChannelIds))return await e.required(y3).fetchPage(e,t.url,pJ)
{const n=Rw(e,t.providerAdamId),r=Ln(e,n)
return await r.then(n=>{const r=function(e,t){return qv.context("msoAppsFromResponse",()=>{const n=yt(e,t),r=we(n,G_),o={}
for(const t of r)o[pe(e,t,Jq).id]=G(t,"channelNames")
const i=we(n,dW).map(e=>e.id)
return new k7(o,i)})}(e,n),o=function(e,t){const n=e.appsToAlwaysShow
for(const r of Object.keys(e.apps)){const o=e.apps[r]
for(const e of o)if(-1!==t.indexOf(e)){n.push(r)
break}}return n}(r,t.subscribedChannelIds)
return Dw(e,n,o)})}}function Rw(e,t){return new dY(e).withIdOfType(t,LM).includingRelationships([dW,G_]).addingQuery("limit[channel-apps]","100")}function Dw(e,t,n){return qv.context("msoRoomPageWithResponse",()=>{const r=yt(e,t),o=Un(e,qH,r.id,t),i=we(r,dW),a=we(r,G_)
for(const t of a){const n=pe(e,t,Jq)
s(n)&&i.push(n)}const c=new _2
c.ids=i.map(e=>e.id),c.shouldFilter=!1,c.metricsPageInformation=o
const l=function(e,t,n,r,o=[]){return qv.context("msoRoomPageWithContext",()=>{const i=[],s=[]
for(const e of t)-1!==n.indexOf(e.id)?i.push(e):s.push(e)
const a={rootPosition:0,locationStack:[]},c={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:a},artworkUseCase:y6.LockupIconMedium}},l=[],u={pageInformation:r.metricsPageInformation,locationTracker:a,targetType:dq,idType:Aq,id:"0"}
if(i.length>0){const t=e.loc.string("MSO_INCLUDED_IN_SUBSCRIPTION"),n=new _2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=oq,u.id="0",bh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(i[e]),!1}
const o=new dJ(oq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=$d(e,i,c),o.url=_w(n),Ph(a),o.items.length>0&&(Oh(a),l.push(o))}if(i.length>0&&s.length>0){const t=e.loc.string("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),n=new _2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=oq,u.id="1",bh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(s[e]),!1}
const o=new dJ(oq)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=$d(e,s,c),o.url=_w(n),Ph(a),o.items.length>0&&(Oh(a),l.push(o))}if(0===l.length){const n=new _2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=Iq,u.id="0",bh(0,u,null),c.contentUnavailable=function(e,r){return n.remainingContent.push(t[e]),!1}
const o=new dJ(oq)
o.shouldFilterApps=r.shouldFilter,o.items=$d(e,t,c),o.url=_w(n),Ph(a),Oh(a),l.push(o)}for(const e of l)e.isHorizontal=l.length>1
const d=o.concat(l)
return new pJ(d)})}(e,i,n,c)
return l.title=j(r,fW),l.isIncomplete=!1,jn(e,l,o),l})}function _w(e){return e.remainingContent.length?`${OW}:/${xW.mso}/${xW.shelf}/`+encodeURIComponent(JSON.stringify(e)):null}async function Lw(e,t){const n={url:`${e.bag.getCancellablePreorderItemsSrv}?&includeAllLockups=false&includeNonBookCancellablePreorderItems=true${t.isArcade?"&preorderItemType=ArcadeApp":""}`,signingStyle:YV}
return await e.network.fetch(n).then(async n=>{const r=JSON.parse(n.body)
if(0!==r.status)return await Promise.resolve("noAuthorization")
const o=r.cancellablePreorderItems.filter(e=>e.preorderAdamId.toString()===t.adamId)
if(null===o||0===o.length)return await Promise.reject("Expected AdamID was missing. This AdamId might have not been preordered before, or the isArcade flag may be incorrect.")
if(o.length>1)return await Promise.reject(`Multiple matches for adamId ${t.adamId}, when only one is expected.`)
const i=o[0].preorderId,s={url:e.bag.cancelPreorderItemSrv,method:hG,signingStyle:YV}
return s.body=`preorderId=${i}`,await e.network.fetch(s).then(async e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${s.url}`)
return 0!==JSON.parse(e.body).status?await Promise.resolve("unableToCancel"):await Promise.resolve("canceled")}).catch(async e=>await Promise.reject(e))}).catch(async e=>await Promise.reject(e))}async function Mw(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(rk))
0!==Mn(e,new az(t.url)).length&&tp(e,t.url)
const n=B7.generateProductPageOptions(e,void 0,new az(t.url)),r=e.required(y3).fetchPage(e,t.url,aJ)
if(!r){const r=new dY(e,t.url),o=await Ln(e,r)
return await Ku(e,o,n,void 0,t.referrerData)}return await r.then(n=>(e.host.clientIdentifier===lY?n&&wB in n&&zn(0,n):i(t.referrerData)&&n&&wB in n&&zn(0,n),n))}async function xw(e,t,n){const a=Xt(e,t,!1),c=new dY(e)
switch(t){case zq:c.usingCustomAttributes(Ue(e)),Qt(e)===oq&&c.includingAttributes([aB])
break
case KH:case wH:c.usingCustomAttributes(Ue(e))}const l=e.bag.adsOverrideLanguage
s(l)&&c.enablingFeature(hA).addingQuery("l",l)
const u=ve(e,c).query
try{const c=await e.ads.fetchOnDeviceAdPlacement(t,a,u,n)
return await async function(e,t,n){var a,c,l,u,d,f
o(t.clientRequestId)&&(t.clientRequestId=e.random.nextUUID(),Zt(e,`clientRequestId was nil. Assigned ${t.clientRequestId}`))
const h={clientRequestId:t.clientRequestId,iAdId:t.iAdId,placementType:null!==(c=null===(a=null==t?void 0:t.ad)||void 0===a?void 0:a.placementType)&&void 0!==c?c:n}
if(t.failureReason)return h.failureReason=t.failureReason,h
h.onDeviceAd=t.ad
let p=null===(l=t.ad)||void 0===l?void 0:l.appMetadata
const w=yt(e,p)
if(o(null===(u=null==w?void 0:w.attributes)||void 0===u?void 0:u.name)||o(null===(d=null==w?void 0:w.attributes)||void 0===d?void 0:d.platformAttributes)||o(wr(e,w)))try{const n=function(e,t){const n=new dY(e).withIdOfType(t.adamId,dW).usingCustomAttributes(Ue(e)).includingAttributes([aB])
s(t.cppIds)&&n.addingQuery(zW.productVariantID,t.cppIds[0])
const r=e.bag.adsOverrideLanguage
return s(r)&&n.addingQuery("l",r),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([Eq]),n}(e,t.ad)
p=await Ln(e,n)}catch(t){Zt(e,`fetchAds request failed - ${t}`),h.failureReason=pA}if(s(null===(f=yt(e,p))||void 0===f?void 0:f.attributes)){h.mediaResponse=function(e,t,n){const i=yt(e,t)
if(o(i)||r(i.attributes))return Zt(e,"decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null
const a=n.ad,c=`${a.adamId}|${a.metadata}`,l={clientRequestId:n.clientRequestId,impressionId:a.impressionId,metadata:a.metadata,privacy:a.privacy,lineItem:c},u=yt(e,a.appMetadata)
switch(s(i.meta)&&s(u)&&s(u.meta)&&(i.meta.passthroughAdInfo=u.meta.passthroughAdInfo,(0,Hv.isSome)(null==a?void 0:a.alignedRegionDetails)&&(i.meta.alignedRegionDetails=null==a?void 0:a.alignedRegionDetails[0])),a.placementType){case zq:const t=Qt(e)===oq
l.format={images:t,text:"",userRating:!1}
break
case AV:l.format={images:!0,text:"",userRating:!1}}return i.attributes[xG]=l,hn(0,i,a.instanceId),t}(e,p,t),pn(e,yt(e,p),h.onDeviceAd)||(Zt(e,"fetchAds request failed - localization not available"),h.failureReason=wA)
const a=function(e,t,n){return n===zq?function(e,t){var n,r
const o=Ge(e,yt(e,t.mediaResponse))
return(null===(r=null===(n=t.onDeviceAd)||void 0===n?void 0:n.cppIds)||void 0===r?void 0:r.includes(o.productPageId))?null:SO}(e,t):null}(e,h,n)
i(a)&&(Zt(e,`fetchAds request failed - ${a}`),h.failureReason=a)}return h}(e,c,t)}catch{return null}}function $w(e,t,n,r){var o,i,s
const a=fe(t,uW),c=null===a?void 0:null!==(o=St(a))&&void 0!==o?o:void 0
let l=wV
return r.pageType===Wm.ChartsAndCategories&&(l=rW),{id:n.id,kind:null,softwareType:null,targetType:dq,title:null!==(i=n.title)&&void 0!==i?i:"",pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:l,fcKind:void 0,canonicalId:null!==(s=f(t.meta,bN))&&void 0!==s?s:void 0,recoMetricsData:c}}function Fw(e,t,n,r){var o,i
return{...r.metricsOptions,...Bh(e,n,null!==(o=t.title)&&void 0!==o?o:"",r.metricsOptions),recoMetricsData:null!==(i=St(n))&&void 0!==i?i:void 0,targetType:Bw(t.density),idType:Sq}}function Nw(e,t,n,r){var o
return{pageInformation:r.metricsOptions.pageInformation,locationTracker:r.metricsOptions.locationTracker,recoMetricsData:null!==(o=St(n))&&void 0!==o?o:void 0,targetType:Bw(t),id:n.id}}function Bw(e){if((0,Wv.isNothing)(e))return Vj
switch(e){case Jv.Density1:return Vj
case Jv.Density2:return aN
default:return Vj}}function Uw(e,t,n,r=qm.Default){var o,i,s
const a=null!==(o=j(t,Nq))&&void 0!==o?o:void 0
let c=null!==(i=function(e,t,n){return B(e,t,void 0)}(t,CH))&&void 0!==i?i:void 0;(0,Hv.isNothing)(c)&&r===qm.CategoriesAndCharts&&(c={layoutDensity:Jv.Density1,layout:void 0,layoutSize:void 0})
const l=g(B(t,"itemDisplayStyle")),u=H(t,ZE),d=null!==(s=q(t,yM))&&void 0!==s?s:void 0,f=u?t.href:void 0
return new nee(t.id,a,c,d,u,f,l,n)}function Gw(e,t,n,r){return{metricsOptions:$w(0,t,n,r)}}function jw(e,t){var n,r
const o=j(t,Nq),i=f(t,"meta.autoSelectedTabId"),a=f(t,"meta.sourceShelfCanonicalId"),c=Un(e,IG,a,t),u=Ss(e)
c.recoMetricsData=yh(c.recoMetricsData,null,u)
const d={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:c,adStitcher:null,pageType:Wm.ChartsAndCategories},h=l(t,Gj),p={},w=[],g=[],v={rootPosition:0,locationStack:[]}
for(const t of h){const o=Uw(0,t,zm.CategoriesAndCharts,qm.CategoriesAndCharts),i=Gw(0,t,o,{...d,metricsLocationTracker:{rootPosition:0,locationStack:[]}})
bh(0,i.metricsOptions,o.title)
const s=Vw(e,t,!0,o,0,i)
if(Ph(i.metricsOptions.locationTracker),(0,Hv.isNothing)(s))continue
p[s.id]=s,w.push(s.id)
const a=new ree,c=new oee(t.id,o.title)
Qs(e,c,{id:o.title,canonicalId:null!==(n=f(t.meta,bN))&&void 0!==n?n:void 0,actionType:pW,targetType:hW,pageInformation:d.metricsPageInformation,locationTracker:v}),a.action=c,a.id=s.id,a.title=`${null!==(r=s.title)&&void 0!==r?r:""}`,g.push(a),Oh(v)}if(!s(w))return new iee
const m=new see
m.id=e.random.nextUUID()
const y=new dJ("pageTabs")
y.items=[m],p[m.id]=y
const A=new iee
A.shelfMapping=p
const T={}
for(const e of w)g.length>1?T[e]=[m.id,e]:T[e]=[e]
for(const e of Object.values(p))e.title=void 0
return A.title=o,A.pageTabs=m,A.columnCount=2,A.shelfOrderings=T,A.defaultShelfOrdering=w.includes(i)?i:w[0],m.tabs=g,m.selectedTabId=A.defaultShelfOrdering,jn(e,A,d.metricsPageInformation),A}function Vw(e,t,n,r,i,c){var l,u,d,h,p,w,g,v,m,y,A
const T=[],b=we(t,uW),S=new dJ(a_)
if(S.isHorizontal=!1,S.id=t.id,S.title=r.title,S.presentationHints={isWidthConstrained:!0},a(null===(l=r.displayStyle)||void 0===l?void 0:l.layoutSize)&&(S.contentsMetadata={type:"searchLandingChartsAndCategoriesSection",numberOfColumns:r.displayStyle.layoutSize}),r.hasSeeAll){const t=new EY(a_)
t.pageUrl=r.seeAllLink,t.title=e.loc.string(cH)
const n={...c.metricsOptions,targetType:hW}
Xs(e,t,t.pageUrl,n),S.seeAllAction=t}Mh(e,S,c.metricsOptions)
const P=n?Nm.seeAllPage:Nm.other
for(const t of b){let n=null,i=null
if(t.type===IV)n=null!==(u=j(t,fW))&&void 0!==u?u:"tagbrick"
else{const e=B(t,hV)
s(e)&&(n=f(e,fW),i=f(e,iU))}const a=ef(e,t,P,null===(d=null==r?void 0:r.displayStyle)||void 0===d?void 0:d.layoutDensity),l=j(t,DH),b=B(t,Mq),S=f(b,Wq),I=we(t,bH)
let C=!0,k=null
if(t.type===IV){const r=Fi(e,f(t,AG)),o=e.required(y3).fetchFlowPage(r),i=new EY(o)
i.pageUrl=r,i.title=n,k=i}else if((0,Hv.isSome)(S))switch(l){case"CategoryChart":const t=new EY(dG)
t.pageUrl=S,t.title=n,k=t
break
case"External":if(C=!1,f(b,v$)===LL)k=new GY(S),k.title=null!=n?n:""
else{const t=e.required(y3).fetchFlowPage(S),r=new EY(t)
r.pageUrl=S,r.title=null!=n?n:"",k=r}}else{if(!s(I))continue
{const t=Fi(e,I[0].href)
if(!((null==t?void 0:t.length)>0))continue
{const e=new EY(wW)
e.pageUrl=t,e.title=n,k=e}}}if(Qs(e,k,Nw(0,null===(h=null==r?void 0:r.displayStyle)||void 0===h?void 0:h.layoutDensity,t,c)),C&&o(n))continue
let O=new aee(n,a,null,null,i,k,null===(p=null==r?void 0:r.displayStyle)||void 0===p?void 0:p.layoutDensity,Hw(null===(w=null==r?void 0:r.displayStyle)||void 0===w?void 0:w.layoutDensity),qw(null===(g=null==r?void 0:r.displayStyle)||void 0===g?void 0:g.layoutDensity)),E=Fw(e,O,t,c)
y6.GroupingBrick
const R=rs(e,t,0,0,0,E)
if((0,Hv.isSome)(R)&&R.length>0){const o=R[0].backgroundColor;(0,Hv.isSome)(o)&&(null==o?void 0:o.type)===xV&&(O=new aee(n,null,R,null!==(v=oh(o))&&void 0!==v?v:void 0,i,k,null===(m=null==r?void 0:r.displayStyle)||void 0===m?void 0:m.layoutDensity,Hw(null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.layoutDensity),qw(null===(A=null==r?void 0:r.displayStyle)||void 0===A?void 0:A.layoutDensity)),E=Fw(e,O,t,c))}Mh(e,O,E),T.push(O),Oh(c.metricsOptions.locationTracker)}return o(T)?null:(S.items=T,S)}function Hw(e){switch(e){case Jv.Density1:return o4.defaultTileArtworkSafeArea
case Jv.Density2:return o4.defaultPillArtworkSafeArea
case Jv.Density3:default:return}}function qw(e){switch(e){case Jv.Density1:return o4.defaultTileTextSafeArea
case Jv.Density2:return o4.defaultPillTextSafeArea
default:return}}async function Ww(e,t){const n=new dY(t,e.url).forType(Nx).includingAgeRestrictions().includingScopedRelationships(sk,[uW]).enablingFeatures([vV,MF]).addingQuery(zW.name,KF)
Gi(t,kx)&&Ai(n),t.bag.enableUpdatedAgeRatings&&n.includingAttributes([Eq])
const r=Ln(t,n)
return await r.then(e=>jw(t,e))}function zw(e){switch(e){case $H:return rO
case QU:return jF
case cW:return oL
case sW:return"joystickcontroller.fill"
default:return}}function Yw(e,t,n,r,i){if(o(r))return null
const s=t_,a=n.term,c=r.displayLabel,l=t===QI?new n5(c,r.finalTerm,null,s):new uee(c,s)
!function(e,t,n,r,o){const i=Vx,s=nC,a={targetId:n},c=_t(e,n,s,{actionType:i,location:Th(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},n),searchTerm:r},[Vx])
t.actionMetrics.addMetricsData(c)
const l=Lt(e,r,s,i,null,a,[Vx])
t.actionMetrics.addMetricsData(l)}(e,l,c,a,i)
const u=new dee(c,r.isSelected,void 0,c,l)
return Bn(0,u,nC,i),u}function Jw(e,t,n){const r=S(t),i=S(t.attributes)
return i[YB]=n.adData,r.attributes=i,function(e,t,n){var r
const i=Ve(Ge(e,t))
if(n.selectedCppId===i||o(null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.cppData))return
const s=S(t.meta)
s.cppData[NU]=n.selectedCppId,t.meta=s}(e,r,n),hn(0,r,n.instanceId),r}function Kw(e,t,n){const r=S(t)
if((0,Hv.isNothing)(t.attributes))return r
const o=S(t.attributes)
return o[YB]=n.adData,o[FI]=n.failureReason,r.attributes=o,hn(0,r,n.instanceId),r}function Zw(e,t,n){const r=t||{},o=[]
e.client.deviceType!==lW&&o.push(new pee(WN,[new wee(e.loc.string(NI),null,r[WN]),new wee(e.loc.string(BI),_q,r[WN])])),o.push(new pee(zF,[new wee(e.loc.string(qD,qU),null,r[zF]),new wee(e.loc.string(UI,qU),pO,r[zF])]))
const s=Tn(e,n,!1)
if(s){const t=s.categories
if(t.length){const n=t.filter(e=>i(e.genreId)).map(e=>new wee(e.name,e.genreId,r[PH]))
n.unshift(new wee(e.loc.string(WD,qU),null,r[PH])),o.push(new pee(PH,n))}}const a=e.bag.searchSortOptions,c=[]
c.push(new wee(e.loc.string(zD),null,r[JV]))
for(const t of a)c.push(new wee(e.loc.string(GI+t),t,r[JV]))
c.length>1&&o.push(new pee(JV,c))
const l=e.bag.ageBands.map(e=>new wee(f(e,fW),f(e,aE),r[rB]))
return l.length>0&&e.client.deviceType!==lW&&o.push(new pee(rB,l)),o}function Qw(e,t){let n=null,r=null,o=null
const s=new O9(WN,WN,e.loc.string("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),hB,[new k9(e.loc.string(NI),null),new k9(e.loc.string(BI),_q)],null,null,eg(e,WN)),a=new O9(jI,jI,e.loc.string("SEARCH_FACET_TYPE_TITLE_PRICE"),hB,[new k9(e.loc.string(qD,qU),null),new k9(e.loc.string(UI,qU),pO)],null,null,eg(e,zF)),c=Tn(e,t,!1)
if(c){const t=c.categories
if(t.length){const r=t.filter(e=>i(e.genreId))
n=new O9(VI,VI,e.loc.string("SEARCH_FACET_TYPE_TITLE_CATEGORY"),hB,[new k9(e.loc.string(WD,qU),null)],null,null,eg(e,PH))
for(const e of r)n.options.push(new k9(e.name,e.genreId))}}const l=e.bag.searchSortOptions
r=new O9(JV,JV,e.loc.string("SEARCH_FACET_TYPE_TITLE_SORT"),hB,[new k9(e.loc.string(zD),null)],null,null,eg(e,JV))
for(const t of l)r.options.push(new k9(e.loc.string(GI+t),t))
const u=e.bag.ageBands.map(e=>new k9(f(e,fW),f(e,aE)))
u.length>0&&e.client.deviceType!==lW&&(o=new O9(HI,HI,e.loc.string("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),hB,u,null,null,eg(e,rB)))
const d=new E9([],!1,null)
{const e=[s,a]
i(n)&&e.push(n),e.push(r),i(o)&&e.push(o)
for(const t of e)t.showsSelectedOptions=!0
d.facetGroups.push(new R9(e))}return d}function Xw(e){return{targetPlatform:[new k9(e.loc.string("SEARCH_FACET_IPAD_ONLY"),null)],"filter[price]":[new k9(e.loc.string(qD,qU),null)],sort:[new k9(e.loc.string(zD),null)],"filter[genre]":[new k9(e.loc.string(WD,qU),null)]}}function eg(e,t){const n=new kW
return ea(e,n,t),n}function tg(e,t){const n=e.bag.searchResultsLearnMoreEditorialId
if((0,Hv.isNothing)(n)||0===(null==n?void 0:n.length))return
const r={kind:yj,softwareType:null,title:e.loc.string(ZI),id:n,targetType:Mq,pageInformation:t.pageInformation,locationTracker:t.locationTracker},o=e.loc.string("SEARCH_TRANSPARENCY_TEXT"),i=new EY(Tq)
i.title=o,i.pageUrl=`https://apps.apple.com/story/id${n}`,Qs(e,i,r)
const s={}
s[`${e.loc.string(ZI)}`]=i
const a=new b5(o,GV)
return new S5(a,s)}function ng(e){return A(e)&&function(e){return(0,Hv.isSome)(gee[e])}(e[gW])}function rg(e,t){if(!H(t,e_))return null
const n=j(t,c_)
if(s(n))return n
const r=j(t,YH)
return s(r)?r.replace(/\n/g," "):null}function og(e){return ng(e)&&e[gW]===py}function ig(e,t,n,a,c,l,d,f){return qv.context("searchResultFromData",()=>{var h
let p
const w=t.type,g={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:DV,createUniqueImpressionId:!0},hideZeroRatings:!0,artworkUseCase:y6.SearchIcon,isNetworkConstrained:null!=l?l:void 0,canDisplayArcadeOfferButton:eh(0,m$),clientIdentifierOverride:null!==(h=ug(0,d))&&void 0!==h?h:void 0,isMultilineTertiaryTitleAllowed:!1},v=function(e,t,n){var r,o
if(!function(e){return e.client.deviceType===nW}(e))return rH
const s=t.meta,a=null===(r=null==s?void 0:s.displayStyle)||void 0===r?void 0:r.condensed
if(i(a))return ag(e,a)
const c=null===(o=null==n?void 0:n.displayStyle)||void 0===o?void 0:o.condensed
return i(c)?ag(e,c):cg(e)}(e,t,f)
switch(w){case qN:case IF:case pV:case Xq:case MV:const l=bo(e,t,{useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0},new BZ(c.pageInformation,c.locationTracker))
if(l&&l.media&&l.media.kind===KU){const e=l.media.lockup
e.theme=Gq,p=new bee(e)}else if(function(e,t,n){if((u(n,"experiments.showGridCard")?Aee:Tee)!==Tee)return!1
switch(t.type){case MV:return s(G(t,l_))
case qN:case IF:return!0
case Xq:switch(Co(t)){case Tm.List:case Tm.NumberedList:case Tm.Grid:case Tm.River:return!0
default:return!1}default:return!1}}(0,t,n)){const n=function(e,t,n){const r=function(e,t){if(t.type===pV)return e.loc.string(XI)
const n=rg(0,t)
return s(n)?n:e.loc.string("Search.EditorialSearchResultType.Heading.Collection")}(e,t),i=function(e,t){return t.type===pV?j(t,fW):Wf(e,t,fW)}(e,t),a=Bh(e,t,i,{targetType:DV,pageInformation:n.pageInformation,locationTracker:n.locationTracker})
bh(0,a,i)
const c=Fd(e,t,{actionType:pW,targetType:hW,pageInformation:n.pageInformation,locationTracker:n.locationTracker,id:xR,idType:Aq},e.host.clientIdentifier)
c.title=e.loc.string(cH)
const l={lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:tW},skipDefaultClickAction:!1,artworkUseCase:y6.SearchIcon,hideCompatibilityBadge:!1},filter:Qv.UnsupportedPlatform}
let u=we(t,OH)
o(u)&&(u=we(t,XD))
const d=$d(e,u,l)
Ph(n.locationTracker)
const f=new yee(r,i,d,c,null)
return Mh(e,f,a),o(d)?null:f}(e,t,c)
n&&(p=n)}else{const n=function(e,t,n,o){return qv.context("editorialSearchResultFromData",()=>{var a
let c
const l=null!==(a=j(t,fW))&&void 0!==a?a:void 0
switch(t.type){case MV:{const n=new Iee(l),r=G(t,l_)
if(s(r))n.collectionAdamIds=r
else{const r=Zd(e,B(t,oW),{useCase:y6.SearchEditorialResult,allowingTransparency:!0})
n.iconArtwork=r}n.type=qj,c=n
break}case qN:case IF:{const n=new Iee(l)
n.artwork=Zd(e,B(t,oW),{useCase:y6.SearchEditorialResult,cropCode:"sr"}),n.collectionAdamIds=G(t,l_),n.type=BV,c=n
break}case Xq:{if(e.bag.searchFilterEditorialItemIds.has(t.id))return null
const a=new BZ(n.pageInformation,n.locationTracker),l=function(e,t,n,o){const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0}
a.prevailingCropCodes=o&&e.client.isPhone?{defaultCrop:"DMGE.AppST01"}:{defaultCrop:"fo"}
const c=bo(e,t,a,n)
if(!c)return null
const l=new Iee(c.title)
l.type=QU,l.clickAction=c.clickAction
let u=null
if(c.media)switch(c.media.kind){case Aj:const n=c.media
switch(l.artwork=n.artworks[0],r(l.artwork)&&(l.iconArtwork=n.icon),j(t,LN)){case Tm.AppOfTheDay:case Tm.GameOfTheDay:const n=pe(e,t,OH)
n&&(l.title=j(n,fW)||l.title)}break
case iO:case iL:u=c.media.lockups
break
case oW:const o=c.media
l.artwork=o.artworks[0]
break
case fH:case Yx:u=c.media.lockups
break
case rq:const s=c.media
if(l.artwork=s.videos[0].preview,l.video=s.videos[0],$r(d=c.overlay)&&d[gW]===Ry){const e=c.overlay
l.title=e.title,l.subtitle=e.description}else l.subtitle=s.description
break
case KN:const a=c.media
if(l.artwork=a.artworks[0],l.appEventFormattedDates=a.formattedDates,l.subtitle=c.inlineDescription,l.tintColor=a.tintColor,l.type="appEventStory",i(c.style))switch(c.style){case hq:case uq:l.mediaOverlayStyle=hq
break
case Gq:l.mediaOverlayStyle=Gq
break
default:x(c.style)}}var d
if(c.overlay)switch(c.overlay.kind){case tW:const e=c.overlay
l.artwork||(u=[e.lockup])
break
case Ty:u=c.overlay.lockups
break
case Nj:const t=c.overlay
l.subtitle=t.paragraph.text}if(i(u)){l.collectionAdamIds=[],l.collectionAppIcons=[]
for(const e of u)l.collectionAdamIds.push(e.adamId),l.collectionAppIcons.push(e.icon)
1===u.length&&(l.lockup=u[0])}const f=On(0,t)
l.editorialDisplayOptions=En(f)
const h=rg(0,t);(null==h?void 0:h.length)>0&&h!==l.title&&(l.tagline=h)
const p=c.heroMedia
return s(p)&&(s(p.artworks[0])?(l.artwork=p.artworks[0],l.artwork.crop="em"):s(p.videos[0])&&(l.video=p.videos[0])),l.video&&(l.video.canPlayFullScreen=!1,l.video.playbackControls={}),l.collectionAdamIds||l.artwork||l.iconArtwork?l:null}(e,t,a,o===eU)
c=l
break}case pV:{const n=new Iee(l)
if(n.artwork=Zd(e,B(t,ZL),{useCase:y6.SearchEditorialResult,cropCode:"sr"}),n.type=$H,(0,Wv.isSome)(n.artwork))c=n
else{let r=we(t,XD)
r=r.filter(t=>!at(e,t,Qv.DeveloperPage))
const o=[],s=[]
r.forEach(t=>{o.push(t.id)
const n=tf(e,t,{useCase:y6.SearchEditorialResult})
i(n)&&s.push(n)}),n.collectionAdamIds=o,n.collectionAppIcons=s,c=n}break}}if(r(c))return null
if(og(c)&&null!=c.collectionAdamIds&&c.collectionAdamIds.length){const e=c.collectionAdamIds.length
c.artworkGridType=e<=5?"extraLarge":e<=8?Pq:e<=16?tC:WH}const u=Bh(e,t,c.title,n)
return c.clickAction=Fd(e,t,u,null),Mh(e,c,u),c})}(e,t,g.metricsOptions,v)
n&&(n.title&&(n.title=n.title.replace(/\n/g," ")),og(n)&&n.subtitle&&(n.subtitle=n.subtitle.replace(/\n/g," ")),p=n)}break
case JH:if(o(Yd(e,t)))return null
const d=kd(e,t,g)
d.theme=Gq,lg(e,d,f),p=new bee(d)
break
default:if(delete t.attributes[xG],w===Zq){g.shouldIncludeScreenshotsForChildren=e.featureFlags.isEnabled(LJ)
const n=Cd(e,t,g)
n.showMetadataInformationInLockup=!0,lg(e,n,f),p=new See(n)}else{const n=Rd(e,t,g,{canPlayFullScreen:!1,playbackControls:{}},f)
lg(e,n,f)
const o=function(e,t,n,o,s,a){return qv.context("appEventSearchResultFromData",()=>{if(!dg(e,t))return null
const{dataItems:c,personalizationData:l}=fg(e,t,s)
let d,f
for(const n of c){const r=hg(e,n,t,a,o.offerEnvironment,o.offerStyle)
if(i(r)){d=r,f=null!=t?t:pe(e,n,Jq)
break}}if(r(d))return null
const h=u(t.meta,d_),p=new Cee
p.lockup=n,p.appEvent=d,p.alwaysShowAppEvent=h,p.clickAction=n.clickAction
const w=yh(null,null==l?void 0:l.processingType,null),g={...a,id:d.appEventId,kind:mA,targetType:s$,title:d.title,softwareType:null,recoMetricsData:w}
return i(f)&&(g.relatedSubjectIds=[f.id]),Mh(e,p,g),p})}(e,t,n,g,a,c)
i(o)?(p=o,p.condensedBehavior=rH):p=new Pee(n)}}return i(p)&&r(p.condensedBehavior)&&(p.condensedBehavior=v),p})}function sg(e,t,n,r,o,s){if(!dg(e,t))return!1
const{dataItems:a}=fg(e,t,null!=s?s:null)
let c
for(const n of a)if(c=hg(e,n,t,o,void 0,void 0),(0,Wv.isSome)(c))break
const l=!(!i(n)||!i(n[t.id]))&&n[t.id],u=!(!i(r)||!i(r[t.id]))&&["downloadable"].includes(r[t.id])
return(l||u)&&(0,Wv.isSome)(c)}function ag(e,t){switch(t){case eU:return eU
case rH:return rH
case"when-installed":return eC
default:return cg(e)}}function cg(e){return e.client.deviceType===nW?eC:rH}function lg(e,t,n){if(!n)return
const o=function(e,t,n,o){var i
if(r(t)||!e.client.isPhone)return null
const a=null===(i=null==t?void 0:t.displayStyle)||void 0===i?void 0:i.metadataPrecedenceOrder
if(!s(a))return null
const c=a.indexOf(n),l=a.indexOf(o)
return-1===c&&-1===l?null:-1!==c&&(-1===l||c<l)}(e,n,TG,VB)
i(o)&&(t.isEditorsChoice=t.isEditorsChoice&&o)}function ug(e,t){return t===cW?iY:null}function dg(e,t){if(!oi(e)||r(t.meta))return!1
const n=l(t.meta,u_).length>0
return![qN,IF,pV,Xq,MV,JH,Zq].includes(t.type)&&n}function fg(e,t,n){const r=u(t.meta,d_),o=l(t.meta,u_)
if(r)return{dataItems:[o[0]]}
const i=As(e,bq,o,!1,n,!1,void 0,t.id),s=i.personalizedData
return s.length<=0?{dataItems:[]}:{dataItems:s,personalizationData:i}}function hg(e,t,n,o,i,s){const a=wi(e,t,n,!1,!0,i,s,!1,{...o,targetType:s$},!1,!0,null,!1,!1)
return r(a)||a instanceof Date?null:a}function pg(e,t,n,s,a,c,l,d,f){var h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E
const R=new kee,D=function(e){if(e.client.isPhone&&!e.clientCapabilities.isNotEnabled(yY))switch(Ne(e,Zv.SearchResultsAdBackground)){case Oee:return"ad"
case Eee:return"clearAdWithSeparator"
case Ree:return oR
default:return}}(e);(0,Hv.isSome)(D)&&(R.itemBackground=D)
const _=null!==(h=s.requestDescriptor.isNetworkConstrained)&&void 0!==h&&h,L={canPlayFullScreen:!1,playbackControls:{}}
tn(e)||bh(0,{id:tF,kind:qS,softwareType:null,targetType:null,title:tF,pageInformation:a.pageInformation,locationTracker:a.locationTracker,idType:Aq},tF)
const M=t[n],x=Array.isArray(M)?M:[M],$=t[n-1],F=t[n+1]
let N
Zt(e,`Adverts received from ad server: ${x.filter(Hv.isSome).map(e=>`[${e.id}]`).join(", ")}`)
let B=!0
for(const s of x){if((0,Hv.isNothing)(null==s?void 0:s.attributes))continue
if(at(e,s)){Zt(e,`[${s.id}] filtered by shouldFilter() - app probably not supported on current os or device`)
continue}const h=wg(s.id,$,F,c),I=(0,Hv.isSome)(h),C=bg(t,I)
if(s.attributes[xG]=Tg(s,C),o(s.attributes[xG])){Zt(e,`[${s.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`)
continue}const k={metricsOptions:{pageInformation:a.pageInformation,locationTracker:a.locationTracker,targetType:DV,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:y6.SearchIcon,isNetworkConstrained:_,canDisplayArcadeOfferButton:eh(0,m$)},O=u(Ke(e,s,xG),"format.images")
let E=!1
const D=o(N),M=Ag(Ld(e,s,k,L,d,!0,n)),x=E?GF:null===(p=null==d?void 0:d.displayStyle)||void 0===p?void 0:p.screenshots,U=vg(e,M,s.id,C,O,N,x,h,c,l,a,f)
if(r(U)){Zt(e,`[${s.id}] will not be displayed because we could not create an ad style compatible with ${Ig(N)}`)
continue}if(!pn(e,s,null,U.style)){Zt(e,`[${s.id}] filtered because localization is not available`)
continue}if(D?(Zt(e,`[${s.id}] first ad dictates ad display style of: ${Ig(U)}`),N=U):Zt(e,`[${s.id}] will be displayed because it is compatible with the display style of: ${Ig(U)}, which is the same height as display style: ${Ig(N)}`),e.client.isPad&&0!==n&&U.style===RK){Zt(e,`[${s.id}] is being dropped because it has style TEXT in an unsupported position.`),null===(g=null===(w=a.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g||g.setMissedOpportunity(e,"TXT_NOAD","0",n)
continue}if(null===(v=a.pageInformation)||void 0===v||v.adPageInfo.apply(e,s),null===(y=null===(m=a.pageInformation)||void 0===m?void 0:m.adPageInfo)||void 0===y||y.setTemplateType(e,U.style),nn(e)){const e=null!==(A=k.metricsOptions.adsMetricsData)&&void 0!==A?A:{}
let t
e[dj]=U.style,Array.isArray(F)||(null==F?void 0:F.id)!==s.id?Array.isArray($)||(null==$?void 0:$.id)!==s.id||(t="Trailing"):t="Leading",(0,Hv.isSome)(t)&&(e[QM]=t),k.metricsOptions.adsMetricsData=e}let G=Ld(e,s,k,L,d,"ad"===R.itemBackground||R.itemBackground===oR,n)
if(G=Sg(e,G,U,I,$,B),null===(T=G.searchAdOpportunity)||void 0===T||T.setTemplateType(U.style),U.style===RK){const t=j(s,fA)
if(t!==mq){let n
n=Qe(e,s,t===Cq?LG:null!=t?t:void 0)
const r=null!==(b=G.searchAd)&&void 0!==b?b:null===(S=G.searchAdOpportunity)||void 0===S?void 0:S.searchAd
i(r)&&i(n)&&(r.advertisingText=n)}R.displaysScreenshots=!1}if((0,Hv.isSome)(G)){const n=gg(t,G.adamId);(0,Hv.isSome)(n)&&!E&&(null===(P=G.searchAdOpportunity)||void 0===P||P.setDuplicatePosition(n)),R.lockups.push(G),tn(e)||Oh(a.locationTracker),B=!1}}if(tn(e)||Ph(a.locationTracker),(0,Hv.isSome)(R.lockups)&&R.lockups.length>0){const t=x[0]
null===(I=a.pageInformation)||void 0===I||I.adPageInfo.apply(e,t),Oh(a.locationTracker)}return(0,Hv.isSome)(N)?null===(k=null===(C=a.pageInformation)||void 0===C?void 0:C.adPageInfo)||void 0===k||k.setTemplateType(e,N.style):null===(E=null===(O=a.pageInformation)||void 0===O?void 0:O.adPageInfo)||void 0===E||E.setTemplateType(e,null),R.condensedBehavior=rH,{result:R,displayStyle:null==N?void 0:N.style}}function wg(e,t,n,r){return[t,n].find(t=>{var n
if((0,Hv.isNothing)(t)||Array.isArray(t))return!1
const o=t.id===e,i=null!==(n=null==r?void 0:r[t.id])&&void 0!==n&&n
return o&&!i})}function gg(e,t){const n=e.findIndex(e=>!Array.isArray(e)&&e.id===t)
return-1===n?null:n}function vg(e,t,n,r,i,s,a,c,l,u,d,f){const h=mg(e,t,n,i,s,a)
if((0,Hv.isNothing)(h))return null
const p={platform:t.mediaPlatformUsedForDisplayStyle,style:h}
return Zt(e,`[${n}] tentatively resolved to: ${Ig(p)}`),r===_ee.DUPE_AD&&(0,Hv.isSome)(c)?function(e,t,n,r,i,s,a,c,l,u,d,f){const h=f.style
if(function(e,t){var n,r,o,i
switch(e){case mK:t.portraitScreenshots.length<=5&&t.portraitScreenshots.splice(0,4)
break
case yK:t.portraitScreenshots.splice(0,3)
break
case AK:t.portraitScreenshots.splice(0,2)
break
case TK:t.portraitScreenshots.splice(0,1)
break
case bK:null===(n=t.videos)||void 0===n||n.splice(0,1),t.portraitScreenshots.length<=4&&t.portraitScreenshots.splice(0,3)
break
case SK:null===(r=t.videos)||void 0===r||r.splice(0,1),t.portraitScreenshots.splice(0,2)
break
case PK:null===(o=t.videos)||void 0===o||o.splice(0,1),t.portraitScreenshots.splice(0,1)
break
case kK:t.landscapeScreenshots.splice(0,1)
break
case IK:case CK:null===(i=t.videos)||void 0===i||i.splice(0,1)}}(h,t),DK.includes(h))return Zt(e,`[${n}] tentative style is unrestricted. No dupe logic applied.`),f
const p=o(i),w=mg(e,t,n,r,null,s),g=function(e,t,n){switch(t){case bK:case mK:return!0
case SK:case yK:return 3===Pg(e,n)
case kK:case CK:return!0
case PK:case AK:return 2===Pg(e)
default:return!1}}(e,w,s),v=sg(e,a,c,l,u,d)
return(g||v)&&p?(Zt(e,`[${n}] Organic Dupe would be full creative as ${w} so choosing tentative style for ad`),f):g&&!p?(Zt(e,`[${n}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${h}`),f):yg(RK,i)?(Zt(e,`[${n}] tentative style would not yield full creative for organic result so returning TEXT`),{style:RK}):(Zt(e,`[${n}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}(e,t,n,i,s,a,c,l,u,d,f,p):(null==s?void 0:s.style)===RK?(Zt(e,`[${n}] tentative style would be filtered since the first ad has style: ${Ig(s)}, so returning TEXT`),{style:RK}):p}function mg(e,t,n,r,o,i){if(!r)return Zt(e,`[${n}] is not allowed to display media because of iAd configuration.`),RK
const s=null==o?void 0:o.mediaPlatform
if((0,Hv.isSome)(t.mediaPlatformUsedForDisplayStyle)&&(0,Hv.isSome)(s)&&!t.mediaPlatformUsedForDisplayStyle.isEqualTo(s))return Zt(e,`[${n}] filtered because media is derived from: ${t.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${s.mediaType}`),null
for(const n of Dee){const r=n.canDisplay(t),s=yg(n.representativeDisplayStyle,o)
if(r&&s)return n.displayStyle(e,t,i)}return Zt(e,`[${n}] filtered because we could not create a compatible style for the first style of: ${Ig(o)}`),null}function yg(e,t){if((0,Hv.isNothing)(t))return!0
let n=[]
for(const t of _K)if(t.includes(e)){n=t
break}return n.includes(t.style)}function Ag(e){var t
let n
const r=null===(t=e.trailers)||void 0===t?void 0:t[0]
let o
s(r)&&(r.videos.sort((e,t)=>Lee(e.preview,t.preview)),o=r.videos,n=r.mediaPlatform)
const i=e.screenshots[0],a=[],c=[]
return s(i)&&(i.artwork.forEach(e=>{e.isPortrait()?a.push(e):c.push(e)}),n=i.mediaPlatform),{portraitScreenshots:a,landscapeScreenshots:c,alignedRegionArtwork:e.alignedRegionArtwork,alignedRegionVideo:e.alignedRegionVideo,videos:o,mediaPlatformUsedForDisplayStyle:n}}function Tg(e,t){let n
const r=f(B(e,YB),t)
return(0,Hv.isSome)(r)&&r.length>0&&(n=JSON.parse(r)),n}function bg(e,t){return t?_ee.DUPE_AD:e.some(e=>{if(Array.isArray(e))return!1
const t=B(e,YB)
return(0,Hv.isNothing)(t)})?_ee.NORMAL:_ee.NO_ORGANIC_RESULTS}function Sg(e,t,n,r,o,i){var a,c,l,u,d,f,h,p,w,g
const v=null===(c=null===(a=t.impressionMetrics)||void 0===a?void 0:a.fields)||void 0===c?void 0:c.pageCustomId,m=(0,Hv.isSome)(v)&&v.length>0
let y,A=!1
if(r&&(A=e.bag.enableSRPNextSlot?(0,Hv.isSome)(o)&&!Array.isArray(o)&&t.adamId===o.id:!i&&!m),s(t.trailers)){const e=t.trailers.shift()
null==e||e.videos.sort((e,t)=>Lee(e.preview,t.preview)),(0,Hv.isSome)(e)&&t.trailers.unshift(e)}let T=[],b=[]
if(s(t.screenshots)){const e=t.screenshots.shift()
null==e||e.artwork.forEach(e=>{e.isPortrait()?null==T||T.push(e):null==b||b.push(e)}),y=null==e?void 0:e.mediaPlatform}if((0,Hv.isNothing)(y))return t
switch(n.style){case mK:if(t.trailers=null,b=null,t.screenshotsDisplayStyle=GF,A)if(T.length>5&&T.length<8){const e=T.splice(0,4),t=4-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,4)
else T.splice(4)
break
case yK:t.trailers=null,b=null,A?T.splice(0,3):T.splice(3)
break
case AK:t.trailers=null,b=null,A?T.splice(0,2):T.splice(2)
break
case TK:t.trailers=null,b=null,A?T.splice(0,1):T.splice(1)
break
case kK:t.trailers=null,T=null,A?b.splice(0,1):b.splice(1)
break
case bK:if(b=null,t.screenshotsDisplayStyle=GF,A)if(null===(l=t.trailers)||void 0===l||l[0].videos.splice(0,1),T.length>4&&T.length<7){const e=T.splice(0,3),t=3-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,3)
else null===(u=t.trailers)||void 0===u||u[0].videos.splice(1),T.splice(3)
break
case SK:b=null,A?(null===(d=t.trailers)||void 0===d||d[0].videos.splice(0,1),T.splice(0,2)):(null===(f=t.trailers)||void 0===f||f[0].videos.splice(1),T.splice(2))
break
case PK:b=null,A?(null===(h=t.trailers)||void 0===h||h[0].videos.splice(0,1),T.splice(0,1)):(null===(p=t.trailers)||void 0===p||p[0].videos.splice(1),T.splice(1))
break
case CK:case IK:A?null===(w=t.trailers)||void 0===w||w[0].videos.splice(0,1):null===(g=t.trailers)||void 0===g||g[0].videos.splice(1),b=null,T=null
break
case RK:case EK:case OK:t.trailers=null,b=null,T=null}if(s(t.trailers)){const e=t.trailers.shift()
t.trailers=[e].filter(Hv.isSome)}const S=(null!=b?b:[]).concat(null!=T?T:[])
if(s(S)){const e=new Tz(S,y)
t.screenshots=[e]}else t.screenshots=[]
return t}function Pg(e,t=null){if(e.client.isPhone){const e=3
return(0,Hv.isNothing)(t)?e:t===GF?4:3}return 2}function Ig(e){if((0,Hv.isNothing)(e))return""
let t=""
return(0,Hv.isSome)(e.mediaPlatform)&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function Cg(e,t,n,r,o){var i,s
if(!(ng(s=n)&&s[gW]===sy||function(e){return ng(e)&&e[gW]===iy}(n)))return
const a=n.lockup,c=t.lockups[0]
if(c.adamId!==a.adamId)return
const l=new Set
if((0,Hv.isSome)(c.screenshots)&&c.screenshots.length>0)for(const e of c.screenshots[0].artwork)l.add(e.template)
if((0,Hv.isSome)(c.trailers)&&c.trailers.length>0)for(const e of c.trailers[0].videos)l.add(e.preview.template)
if((0,Hv.isSome)(a.screenshots)&&a.screenshots.length>0){const e=a.screenshots[0].artwork.filter(e=>!l.has(e.template))
a.screenshots[0]=new Tz(e,a.screenshots[0].mediaPlatform)}if((0,Hv.isSome)(a.trailers)&&a.trailers.length>0){const e=a.trailers[0].videos.filter(e=>!l.has(e.preview.template))
a.trailers[0]=new vz(e,a.trailers[0].mediaPlatform)}if((null===(i=null==r?void 0:r.displayStyle)||void 0===i?void 0:i.screenshots)===GF)switch(o){case bK:case mK:(e=>{const t=a.screenshots[0].artwork
if(t.length>=4)return
let n=4-t.length
const r=c.screenshots[0].artwork.slice().reverse()
for(const e of r){if(n<=0)return
a.screenshots[0].artwork.unshift(e),n-=1}})()}}function kg(e,t,n,r,o,i,s,a,c){var l,u,d
let f
if((null===(l=null==r?void 0:r.lockups[0])||void 0===l?void 0:l.adamId)===t.id){const e=r.lockups[0]
f=null==n?void 0:n.find(t=>t.id===(null==e?void 0:e.adamId))}(0,Hv.isNothing)(f)&&(0,Hv.isSome)(o)&&o.id===t.id&&(f=o),(0,Hv.isNothing)(f)||sg(e,t,i,s,a,c)||function(e,t){var n
let r
r=(0,Hv.isSome)(null==t?void 0:t.meta)?S(t.meta):{},(0,Hv.isNothing)(e)?null===(n=r.cppData)||void 0===n||delete n[NU]:((0,Hv.isNothing)(r.cppData)&&(r.cppData={}),r.cppData[NU]=e),t.meta=r}(null===(d=null===(u=null==f?void 0:f.meta)||void 0===u?void 0:u.cppData)||void 0===d?void 0:d[NU],t)}function Og(e,t){var n,r,o
const i=null===(n=t.userDefaults)||void 0===n?void 0:n.integer("GuidedSearchOverrides.position")
return a(i)&&i>1?i:null===(o=null===(r=null==e?void 0:e.displayStyle)||void 0===r?void 0:r.guidedSearch)||void 0===o?void 0:o.position}async function Eg(e,t,n,r,o,s,a,c,l){var u,d,f,h,p,w,g,v,m,y,A,T,b,S
const P=[],I=[],C=n||null,k=o.filter(e=>e.type===dW).map(e=>e.id),O=bs(e,new Set(k)),E=o
let R=[0]
if((0,Wv.isSome)(s))if(tn(e)){const t=null!==(u=sn(e,n))&&void 0!==u?u:[0]
R=t.filter((e,n)=>0===e||o.length>=e-1||t[n-1]===e-1)
for(const[t,n]of R.entries()){const o=s[t]
if((0,Wv.isSome)(o)){const t=j(o,FI);(0,Wv.isSome)(t)?null===(f=null===(d=r.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f||f.recordAdResponseEventsIfNeeded(e,t,"0",n):E.splice(n,0,o)}else null===(p=null===(h=r.pageInformation)||void 0===h?void 0:h.adPageInfo)||void 0===p||p.setMissedOpportunity(e,eF,"0",n)}}else E.splice(0,0,s),nn(e)&&0===s.length&&(null===(g=null===(w=r.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g||g.setMissedOpportunity(e,eF,"0",0))
const D=Og(n,e)
let _,L,M
for(const[s,u]of E.entries()){if(s===D){const o=Rg(e,t.requestDescriptor,a,r)
if(o.length>0){const t=null!==(y=null===(m=null===(v=null==n?void 0:n.displayStyle)||void 0===v?void 0:v.guidedSearch)||void 0===m?void 0:m.title)&&void 0!==y?y:e.loc.string("Search.Guided.Title.ExploreMore"),i=new mee(t,o)
Mh(e,i,{...r,id:KI,kind:Jj,targetType:CO,title:t,softwareType:null}),P.push(i),Oh(r.locationTracker)}}if(Array.isArray(u)||(0,Wv.isSome)(fn(0,u))){const n=pg(e,E,s,t,r,null!=c?c:null,null!=l?l:null,C,O),o=n.result
_=o,L=n.displayStyle,(0,Wv.isSome)(null===(A=null==o?void 0:o.lockups)||void 0===A?void 0:A[0])&&(o.searchAdOpportunity=o.lockups[0].searchAdOpportunity,P.push(o))
continue}if(!i(u.attributes)){I.push(...o.slice(s))
break}if(at(e,u,Qv.Search))continue
let d
const f=E[s+1]
Array.isArray(f)||!(0,Wv.isSome)(B(f,YB))||at(e,f)||(d=f),((0,Wv.isSome)(null==_?void 0:_.lockups)&&_.lockups.length>0||(0,Wv.isSome)(d))&&kg(e,u,M,_,d,c,l,r,O)
const h=ig(e,u,n,O,r,t.requestDescriptor.isNetworkConstrained,t.requestDescriptor.searchEntity,C)
!(0,Wv.isNothing)(h)&&((0,Wv.isSome)(null==_?void 0:_.lockups)&&_.lockups.length>0&&Cg(0,_,h,C,L),Jt(e)&&R.includes(s)&&(0,Wv.isSome)(null===(T=r.pageInformation)||void 0===T?void 0:T.adPageInfo)&&(h.searchAdOpportunity=qt(e,r.pageInformation),null===(b=h.searchAdOpportunity)||void 0===b||b.setMissedOpportunityReason(eF),null===(S=h.searchAdOpportunity)||void 0===S||S.setTemplateType(rG)),P.push(h),Oh(r.locationTracker),_=void 0,L=void 0,M=void 0)}return await async function(e,t){return await qv.context("applyClientFilteringToIAPs",async()=>{const n={}
for(const e of t)if(e.resultType===KU){const t=e.lockup
t.parent&&t.productIdentifier&&t.parent.bundleId?n[t.productIdentifier]=t.parent.bundleId:qv.unexpectedNull(SH,Bq,`required fields for ${t.adamId}`)}return 0===Object.keys(n).length?await Promise.resolve(t):await e.clientOrdering.visibilityForIAPs(n).then(e=>t.filter(t=>{if(t.resultType!==KU)return!0
const n=t.lockup
return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}))})}(e,P).then(e=>({builtSearchResults:e,deferredSearchResults:I}))}function Rg(e,t,n,r){if((0,Wv.isNothing)(n)||0===n.length)return[]
Sh(0,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:r_},"")
const o=[]
for(const i of n){const n=Yw(e,QI,t,i,r)
n&&(o.push(n),Oh(r.locationTracker))}return Ph(r.locationTracker),o}function Dg(e,t,n,r){const o=new n5(t,t,null,r)
return o.spellCheckEnabled=!1,o.excludedTerms=[n],o.originatingTerm=n,o}function _g(e,t){return t&&t.results?t.results.slice(0,t.maxPerPage):[]}function Lg(e,t){let n=[]
if(t&&t.results&&(n=t.results.slice(t.maxPerPage,t.results.length)),o(n))return null
const r={...t}
return r.results=n,r}function Mg(e){return(0,Hv.isSome)(e)&&0!==e.length?`SearchResults.${e}.shelfId`:"SearchResults.shelfId"}function xg(e){switch(e){case Ym.iOS:return kq
case Ym.visionOS:return"visionos"
default:return"SearchTopResults"}}function $g(e,t){const n=new QK
return i(t)&&(n.facets=Zw(e,t),n.pageFacets=Qw(e),n.selectedFacetOptions=Xw(e)),n.results=[],n}function Fg(e,t){const n=new $ee([])
return i(t)&&(n.facets=Zw(e,t),n.pageFacets=Qw(e),n.selectedFacetOptions=Xw(e)),n}async function Ng(e,t){return await qv.context("searchResultsFromResponse",async()=>{var n
const r=null!==(n=e.fetchTimingMetricsBuilder)&&void 0!==n?n:new Dm.FetchTimingMetricsBuilder,a=await r.measureModelConstructionAsync(async()=>{var n,r,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E
const R=t.catalogResponse,D=t.requestMetadata,_=D.searchRequestUrl,L=t.searchResultsAdsRequestData,M=R.results.guidedSearch,$=function(e,t,n){var r,o,i,s,a,c,l
return{term:t.term,suggestedTerm:null===(o=null===(r=n.results)||void 0===r?void 0:r.spellCheck)||void 0===o?void 0:o.suggestedTerm,correctedTerm:null===(s=null===(i=n.results)||void 0===i?void 0:i.spellCheck)||void 0===s?void 0:s.correctedTerm,resultsTerm:null!==(l=null===(c=null===(a=n.results)||void 0===a?void 0:a.spellCheck)||void 0===c?void 0:c.correctedTerm)&&void 0!==l?l:t.term,originatingTerm:t.originatingTerm}}(0,D.requestDescriptor,R),F=(O=t.searchResultsAdData,(0,Hv.isSome)(O)&&"odmlSuccess"in O&&O.odmlSuccess),N={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:qn(e,D.requestDescriptor,R,$,_,xg(),L,F,M),createUniqueImpressionId:!0},B=e.featureFlags.isEnabled(IJ)||!0,U=B?new $ee:new QK,G=Og(R.meta,e);(0,Hv.isNothing)(G)&&function(e,t,n,r,i){const a=n.requestDescriptor
Sh(0,{pageInformation:i.pageInformation,locationTracker:i.locationTracker,targetType:r_},"")
const c=[]
if(s(r))for(const t of r){const n=Yw(e,eN,a,t,i)
n&&(c.push(n),Oh(i.locationTracker))}if(o(c)&&n.requestDescriptor.searchEntity){const t=function(e,t,n){var r
const o=t.searchEntity
if(!o)return null
const i=new hee(null,t_)
let s
switch(function(e,t,n,r,o){const i=Q$,s=XM,a={targetId:r},c=_t(e,r,s,{actionType:i,location:Th(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},r),searchTerm:n})
t.actionMetrics.addMetricsData(c)
const l=Lt(e,n,s,i,null,a)
t.actionMetrics.addMetricsData(l)}(e,i,t.term,o,n),o){case sW:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE")
break
case $H:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS")
break
case QU:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_STORIES")
break
case cW:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_APPLEWATCH")
break
default:x(o)}const a=new dee(s,!0,null!==(r=zw(o))&&void 0!==r?r:oO,s,i)
return Bn(0,a,XM,n),a}(e,n.requestDescriptor,i)
c.push(t),Oh(i.locationTracker)}const l=function(e,t,n){var r
if(o(n))return null
const i=t.term,s=null!==(r=t.guidedSearchTokens)&&void 0!==r?r:[],a=[]
for(const e of n){const t=e.displayLabel,n=Array.from(s)
if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t)
const r=new fee(i,n,e.finalTerm)
a.push(r)}return a}(0,n.requestDescriptor,r)
Ph(i.locationTracker),s(c)&&(t.guidedSearchTokens=c,t.guidedSearchQueries=l,function(e,t,n){const r=Ih(n.locationTracker)
t.guidedSearchTokensParentImpressionMetrics=new jY({impressionIndex:r,impressionType:r_,idType:BU,id:rC,name:"Search Revisions"})}(0,t,i),Oh(i.locationTracker))}(e,U,D,null==M?void 0:M.facets,N)
const j={id:JF,kind:null,softwareType:null,targetType:eV,title:JB,pageInformation:N.pageInformation,locationTracker:N.locationTracker,idType:BU}
let V
B&&(V=new dJ(Ox),V.id=Mg(),V.isHorizontal=!1,Mh(e,V,j),bh(0,j,JB))
let H=function(e,t){return function(e,t,n){if((0,Hv.isNothing)(n))return t
const r=[],o=t.reduce((e,t)=>({...e,[t.id]:t}),{})
if("adverts"in n){if((0,Hv.isNothing)(n.adverts)||0===n.adverts.length)return t
for(const t of n.adverts){const n=o[t.adamId]
if((0,Hv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Hv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=Jw(e,n,t)
r.push(i)}}else if("ads"in n){if((0,Hv.isNothing)(n.ads)||0===n.ads.length)return t
for(const t of n.ads){const n=o[t.adamId]
if((0,Hv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Hv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=Kw(0,n,t)
r.push(i)}}return r}(e,At(t.catalogResponse.results[s_]),t.searchResultsAdData)}(e,t)
const q=t.searchResultsAdData
if((0,Hv.isSome)(q)&&"appliedPolicy"in q&&(0,Hv.isSome)(q.appliedPolicy)&&(H=[],"ageRestricted"===q.appliedPolicy)){const t=null!==(n=an(e,lq,!0,R.meta))&&void 0!==n?n:[]
for(const n of t)null===(a=null===(r=N.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===a||a.setMissedOpportunity(e,AS,"0",n.slot)}const W=null!==(d=null===(u=null===(l=null===(c=R.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.searchSafety)&&void 0!==d&&d,z=(null===(w=null===(p=null===(h=null===(f=R.meta)||void 0===f?void 0:f.results)||void 0===h?void 0:h.search)||void 0===p?void 0:p.reason)||void 0===w?void 0:w.kind)===i_?"NLS_NORESULTS":"NLS_NOAD"
if(W){H=[]
const t=null!==(g=an(e,lq,!0,R.meta))&&void 0!==g?g:[]
for(const n of t)null===(m=null===(v=N.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===m||m.setMissedOpportunity(e,z,"0",n.slot)}const Y=await Eg(e,D,R.meta,N,function(e,t){return At(t.catalogResponse.results.search)}(0,t),H,null==M?void 0:M.facets,function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.installedStates)&&void 0!==n?n:{}}(t),function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.appStates)&&void 0!==n?n:{}}(t))
if(W&&0!==Y.builtSearchResults.length){const e=Y.builtSearchResults[0].lockup.searchAdOpportunity
null==e||e.setMissedOpportunityReason(z),null==e||e.setTemplateType(rG)}if(B&&V){const t=U
V.items=Y.builtSearchResults,t.resultsParentImpressionMetrics=V.impressionMetrics,t.shelves.push(V)
const n=function(e,t){return qv.context("createSearchResultsContextCard",()=>{var n,r
if((0,Hv.isNothing)(e)||![dV,jV].includes(t.host.platform))return
const o=null===(n=e.links)||void 0===n?void 0:n.map(Bg),i=null==o?void 0:o.reduce((e,t)=>{var n
return(null===(n=t.title)||void 0===n?void 0:n.length)&&(e[t.title]=t),e},{})
let s=e.text
1===(null==o?void 0:o.length)&&(null===(r=o[0].title)||void 0===r?void 0:r.length)?s+=" "+o[0].title:o&&o.length>1&&(s.length>0&&(s+="\n"),s+=o.map(e=>e.title).filter(e=>null==e?void 0:e.length).join("\n"))
const a=new b5(s),c=new S5(a,i)
return new Fee(c)})}(R.results.queryContext,e),r=null===(T=null===(A=null===(y=R.meta)||void 0===y?void 0:y.results)||void 0===A?void 0:A.search)||void 0===T?void 0:T.reason
if((null==r?void 0:r.kind)===i_)t.unavailableReason={title:e.loc.stringWithFallback("Search.Results.Empty.Title","No results"),message:r.text,action:(E=r.links,qv.context("actionFromSearchResultsLinks",()=>{const e=null==E?void 0:E.find(e=>e.url.length>0)
return e?Bg(e):void 0})),contextCard:n}
else if(n){const e=new dJ("searchResultsContextCard")
e.items=[n]
const r=null!==(I=null===(P=null===(S=null===(b=R.meta)||void 0===b?void 0:b.displayStyle)||void 0===S?void 0:S.queryContext)||void 0===P?void 0:P.position)&&void 0!==I?I:0
if(r>0){const n=V.items.splice(r),o={...V,id:"searchResults2",items:n}
t.shelves.push(e),t.shelves.push(o)}else t.shelves.unshift(e)}W&&0===Y.builtSearchResults.length&&(null===(k=(C=e.onDeviceSearchHistoryManager).removeRecentSearchTerm)||void 0===k||k.call(C,$.term))}else{const e=U
e.results=Y.builtSearchResults,function(e,t,n){const r=Ih(n.locationTracker)
t.resultsParentImpressionMetrics=new jY({impressionIndex:r,impressionType:eV,idType:BU,id:JF,name:JB})}(0,e,N)}return Y.deferredSearchResults.length>0&&(U.nextPage=function(e,t,n,r,i){return o(t)?null:{results:t,maxPerPage:30,requestMetadata:n,metricsOptions:i,responseMetadata:null!=r?r:{},contentOffsetWithinResultsShelf:Ih(i.locationTracker)}}(0,Y.deferredSearchResults,D,R.meta,N)),B&&Ph(j.locationTracker),U.message=function(e,t,n){const r=i(t.correctedTerm),o=i(t.suggestedTerm)
return Sh(0,{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:Mq},"spellCorrection"),r?function(e,t,n){const r=t.term,o=Dg(0,r,t.resultsTerm,NR)
ta(e,o,hW,n.locationTracker)
const i=`<i>${t.correctedTerm}</i>`,s=e.loc.string("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(o_,i),a=new S5(new b5(s,bV),{}),c=e.loc.string("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(o_,r),l={}
l[`${c}`]=o
const u=new S5(new b5(c),l)
return new Mee(a,u,o)}(e,t,n):o?function(e,t,n){const r=t.suggestedTerm,o=Dg(0,r,t.resultsTerm,BR)
ta(e,o,hW,n.locationTracker)
const i=`<i>${r}</i>`,s=e.loc.string("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(o_,i),a={}
a[`${r}`]=o,a[`${r}?`]=o
const c=new S5(new b5(s,bV),a)
return new Mee(c,null,o)}(e,t,n):(Ph(n.locationTracker),null)}(e,$,N),!o(D.requestDescriptor.searchEntity)||(U.facets=Zw(e,D.requestDescriptor.facets,t.categoriesFilterData),U.pageFacets=Qw(e,t.categoriesFilterData),U.selectedFacetOptions=s(t.requestMetadata.requestDescriptor.selectedFacetOptions)?t.requestMetadata.requestDescriptor.selectedFacetOptions:Xw(e)),U.searchTermContext=$,U.isAutoPlayEnabled="tv"!==e.client.deviceType,U.isCondensedSearchLockupsEnabled=e.client.isPhone,U.transparencyLink=tg(e,N),jn(e,U,N.pageInformation),U.searchClearAction=Ug(e,NG,N.pageInformation,N.locationTracker,$.term),U.searchCancelAction=Ug(e,Lj,N.pageInformation,N.locationTracker,$.term),U})
return a})}function Bg(e){return qv.context("actionFromSearchResultsLink",()=>{var t
const n=new GY(e.url,!1)
return n.title=null===(t=e.label)||void 0===t?void 0:t.replace(" ","\xa0"),n.artwork=new pz("systemimage://arrow.up.forward",0,0,[]),n})}function Ug(e,t,n,r,o){const s=new kW
let a,c
switch(t){case Lj:a=tj,c=Lj
break
case NG:a="delete",c=NG}return function(e,t,n,r,o){const s={searchTerm:o,actionType:n.actionType}
n.actionDetails&&(s[zG]=n.actionDetails),n.actionContext&&(s[LS]=n.actionContext),o&&(s[ZH]=o),i(n.softwareType)&&(s[BN]=n.softwareType),n.mercuryMetricsData&&Object.assign(s,n.mercuryMetricsData)
const a=_t(e,n.id,null!=r?r:ch(0,n),s)
t.actionMetrics.addMetricsData(a)}(e,s,{targetType:hW,id:c,idType:void 0,actionType:a,pageInformation:n,locationTracker:r},hW,o),s}async function Gg(e,t){return function(e,t,n){return qv.context("searchHintsFromApiResponse",()=>{var r,o,i,s
const a={targetType:LB,pageInformation:Hn(0,0,n.hintsRequestUrl,n.dataSetId),locationTracker:{rootPosition:0,locationStack:[]}}
let c=null;(null===(r=n.userTypedTerm)||void 0===r?void 0:r.length)&&(c=new n5(n.userTypedTerm,n.userTypedTerm,null,UR),c.spellCheckEnabled=!0,c.prefixTerm=t,jh(e,c,a),ta(e,c,a.targetType,a.locationTracker,a.pageInformation),Oh(a.locationTracker))
const l=null!==(i=null===(o=n.rawHints)||void 0===o?void 0:o.map(n=>function(e,t,n,r){var o,i,s,a,c
const l=null!==(o=function(e){switch(e.entity){case dW:return e.context
case pV:return $H
case Xq:return QU
default:return null}}(t))&&void 0!==o?o:void 0,u=new n5(null!==(i=t.displayTerm)&&void 0!==i?i:"",null!==(s=t.searchTerm)&&void 0!==s?s:"",null,J$,l,t.source)
return u.artwork=function(e,t){return Ot(e,`systemimage://${t}`)}(e,null!==(a=zw(l))&&void 0!==a?a:oO),u.spellCheckEnabled=!0,u.prefixTerm=n,jh(e,u,r),ta(e,u,r.targetType,r.locationTracker,null!==(c=r.pageInformation)&&void 0!==c?c:void 0),Oh(r.locationTracker),u}(e,n,t,a)))&&void 0!==i?i:[]
null!=c&&l.unshift(c)
const u=new xee(l,null!==(s=n.ghostHintsTerm)&&void 0!==s?s:null),d=Lt(e,t,"key",WR,n.hintsRequestUrl,{...Nt(a.pageInformation)})
return u.pageMetrics.pageFields=Nt(a.pageInformation),u.pageMetrics.addData(d,[Am.PageInvocationPoint.pageEnter]),u.searchClearAction=Ug(e,NG,a.pageInformation,a.locationTracker,t),u.searchCancelAction=Ug(e,Lj,a.pageInformation,a.locationTracker,t),u})}(e,t,await async function(e,t){const n=function(e,t){const n=new dY(e).includingAppBinaryTraitsAttribute(!1).forType(Cx).withLimit(10).withSearchTerm(t).addingQuery(YD,qI)
e.host.clientIdentifier===sY&&n.addingQuery(FG,sq)
const r=[]
return e.appleSilicon.isSupportEnabled&&r.push(JD),oi(e)&&r.push(zH),e.bag.isNaturalLanguageSearchEnabled&&r.push(WI),r.length>0&&n.enablingFeatures(r),n}(e,t)
return await Ln(e,n).then(t=>{var r
return{hintsRequestUrl:ve(e,n).toString(),userTypedTerm:f(t,"userTyped"),rawHints:l(t,"results.suggestions"),ghostHintsTerm:f(t,"ghosting"),dataSetId:f(null===(r=t.meta)||void 0===r?void 0:r.metrics,aZ)}})}(e,t))}function jg(e,t,n,r,i){const s=function(e,t,n,r,i){if(o(i))return[]
const s=[]
for(const[a,c]of i.entries()){const i=Vg(e,c,a,t,n,r)
o(i)||(s.push(i),Oh(n))}return s}(e,n,r,t.itemDisplayStyle,i),a=new qee
a.title=e.loc.string("Action.ClearSearches"),function(e,t){const n=_t(e,"Clear Searches",hW,{actionType:"confirm"})
t.actionMetrics.addMetricsData(n)}(e,a)
const c=new vZ([a])
c.title=e.loc.string("Sheet.ClearSearches.Title"),c.message=e.loc.string("Sheet.ClearSearches.Message"),c.destructiveActionIndex=0,c.isCancelable=!0
const l=new ZJ([c])
l.title=e.loc.string("Action.Clear")
const u=(f=t.shelfDisplayStyle).layout===Vee?cC:2===f.layoutSize?"twoColumnList":oC,d=new dJ(u)
var f
return d.id=m_,d.presentationHints={isWidthConstrained:!0},d.header={title:t.title,accessoryAction:l},d.contentType===cC&&(d.isHorizontal=!0,d.rowsPerColumn=t.shelfDisplayStyle.layoutSize),d.contentsMetadata={type:"searchFocusTwoColumnList",numberOfColumns:s.length>1?t.shelfDisplayStyle.layoutSize:1},d.items=s,d.isHidden=o(s),d.refreshUrl=function(e){return`${OW}:/${xW.searchLandingPage}/${xW.shelf}/?${zW.isOnDeviceSearchHistoryShelf}=true&${zW.token}=${function(e){return encodeURIComponent(JSON.stringify(e))}(e)}`}(t),d}function Vg(e,t,n,r,o,i){const s=t.term,a=t.entity,c=Yg(e,function(e,t,n){if((0,Wv.isNothing)(n))return t
let r
return n===$H?r="Search.ResultsTitle.InDevelopers":n===QU?r="Search.ResultsTitle.InStories":n===cW?r="Search.ResultsTitle.InWatch":n===sW&&(r="Search.ResultsTitle.InArcade"),(0,Wv.isNothing)(r)?t:e.loc.string(r).replace("@@search_term@@",t)}(e,s,a),s,a,o,FR,void 0,r,i)
return(0,Wv.isNothing)(c)?null:(c.id=t.id,Mh(e,c,{targetType:Mq,pageInformation:r,locationTracker:o,kind:Mq,softwareType:null,title:t.term,hintsEntity:t.entity,id:`${n}`,idType:Aq}),c)}function Hg(e,t,n){var r
const i=t.data
if(o(i))return
let s=0
const a=e.bag.mediaAPISearchFocusEnabled&&(0,Wv.isSome)(n.pageType)
for(const c of i){if(o(c))continue
if(a){const e=p(c,vV),t=qg(null==e?void 0:e.category)
if((0,Wv.isSome)(t)&&t!==n.pageType)continue}const i=Zg(e,n,s,t.meta||null);(0,Wv.isSome)(i)&&(n.shelves.push(i),Oh(n.metricsLocationTracker))
const l=j(c,"contentKind"),u=Uw(0,c,l),d=Qg(0,c,u,n,l)
bh(0,d.metricsOptions,null!==(r=u.title)&&void 0!==r?r:"")
const f=Wg(e,c,n,d,u,l)
Ph(n.metricsLocationTracker),o(f)||(Mh(e,f,d.metricsOptions),un(e,[f],AV,d.metricsOptions.id,n.metricsPageInformation),n.shelves.push(f),s+=1,Oh(n.metricsLocationTracker))}}function qg(e){switch(e){case KF:return Wm.Landing
case"search-focus":return Wm.Focus
default:return}}function Wg(e,t,n,c,l,u){switch(u){case zm.Suggestion:return n.pageType===Wm.Focus?function(e,t,n,r,i){var s,a,c
const l=we(t,uW)
if((0,Wv.isNothing)(l))return null
const u=[],d=new dJ(oC)
d.isHorizontal=!1,d.title=r.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,i]of l.entries()){const l=j(i,ZH)
if((0,Wv.isNothing)(l)||0===l.length)continue
const d=null!==(s=j(i,w_))&&void 0!==s?s:l,f=Yg(e,null!=d?d:"",null!=l?l:"",void 0,n.metricsLocationTracker,MB,void 0,n.metricsPageInformation,null!==(a=r.searchLandingItemDisplayStyle)&&void 0!==a?a:void 0);(0,Wv.isNothing)(f)||o(f)||(Mh(e,f,{targetType:Mq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,kind:Mq,softwareType:null,title:null!==(c=f.title)&&void 0!==c?c:"",id:`${t}`,idType:Aq}),u.push(f),Oh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,d)}(e,t,n,l):function(e,t,n,i,s){var c
const l=we(t,uW),u=[],d=new dJ(eq)
d.isHorizontal=!1,d.title=i.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,o]of l.entries()){const s={targetType:Mq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},a=zg(e,o,n,i)
r(a)||r(a.action)||(Mh(e,a.action,{...s,kind:Mq,softwareType:null,title:a.action.title,id:`${t}`,idType:Aq}),u.push(a),Oh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,a(null===(c=i.displayStyle)||void 0===c?void 0:c.layoutSize)?d.contentsMetadata={type:j$,numberOfColumns:i.displayStyle.layoutSize}:(e.client.isPhone||e.client.isPad)&&(d.contentsMetadata={type:j$,numberOfColumns:u.length>=6?2:1}),d)}(e,t,n,l)
case zm.CategoriesAndCharts:return Vw(e,t,!1,l,0,c)
case zm.Apps:return function(e,t,n,o,a){var c,l,u,d,f
const h=Qv.All,p=[]
let w=!1,g=function(e){const t=fe(e,uW)
return null==t?void 0:t.data}(t)
const v=new dJ(a.shelfStyle)
if(v.isHorizontal=!1,v.title=o.title,v.shouldFilterApps=!1,v.filteringExcludedItems=a.filteringExcludedItems,s(g)){const t=function(e,t,n){var o,s,a,c,l,u,d,f,h,p
const w=Ja(t.adStitcher,n.adPositionInfo)
if(r(w))return null
const g=w.data
try{const r=Kg(e,g,t,n)
return i(r)?n.filteringExcludedItems=[g.id]:null===(o=t.metricsPageInformation.adPageInfo)||void 0===o||o.recordLockupFromDataFailed(e,null!==(a=null===(s=n.adPositionInfo)||void 0===s?void 0:s.shelfIdentifier)&&void 0!==a?a:SF,null!==(l=null===(c=n.adPositionInfo)||void 0===c?void 0:c.slot)&&void 0!==l?l:0),r}catch(r){return Zt(e,`Failed to create SLP ad lockup: ${r}`),null===(u=t.metricsPageInformation.adPageInfo)||void 0===u||u.recordLockupFromDataFailed(e,null!==(f=null===(d=n.adPositionInfo)||void 0===d?void 0:d.shelfIdentifier)&&void 0!==f?f:SF,null!==(p=null===(h=n.adPositionInfo)||void 0===h?void 0:h.slot)&&void 0!==p?p:0),null}}(e,n,a)
t&&ft(t)&&(w=!0,p.push(t),Oh(n.metricsLocationTracker),g=g.filter(e=>e.id!==t.adamId))}const m=(0,Wv.isSome)(o.displayCount)
s(g)&&(g=wn(g,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(u=null===(l=a.metricsOptions)||void 0===l?void 0:l.recoMetricsData)&&void 0!==u?u:{}))
for(const t of g){if(t.type===iW)return null
if(r(t.attributes))continue
if(at(e,t,h))continue
const o=Kg(e,t,n,a)
o&&(p.push(o),Oh(n.metricsLocationTracker))}if(m){const e=o.displayCount
v.items=p.slice(0,e)}else v.items=p
if(m){const r=new dJ(a.shelfStyle)
r.items=w?p.splice(1,p.length-1):p
const i=new pJ([r])
i.title=v.title
const s=new EY(wW)
s.pageUrl=o.seeAllLink,s.title=e.loc.string(cH),s.pageData=i,v.seeAllAction=s,Xs(e,s,s.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),jn(e,i,Vn(0,t.id))}return(null===(d=o.displayStyle)||void 0===d?void 0:d.layout)===Hee&&(v.isHorizontal=!0,v.rowsPerColumn=null===(f=o.displayStyle)||void 0===f?void 0:f.layoutSize),v}(e,t,n,l,c)
case zm.EditorialCollection:return null
default:return function(e,t,n,r,o){return"search-recommendations-marker"!==t.type?null:j(t,H$)===JI?function(e,t,n){return jg(e,new Wee(n.title,n.displayCount,n.displayStyle,n.searchLandingItemDisplayStyle),t.metricsPageInformation,t.metricsLocationTracker,t.searchHistory)}(e,n,o):null}(e,t,n,0,l)}}function zg(e,t,n,r){var o,i
const s=j(t,ZH)
if((0,Wv.isNothing)(s)||0===s.length)return null
const a=null!==(o=j(t,w_))&&void 0!==o?o:s,c=new n5(a,s,null,MB,void 0,void 0)
return c.artwork=Jg(null!==(i=r.searchLandingItemDisplayStyle)&&void 0!==i?i:void 0,e),ta(e,c,hW,n.metricsLocationTracker),(0,Wv.isSome)(c)?new t5(c):null}function Yg(e,t,n,r,i,s,a,c,l){if(o(n))return null
const u=new n5(t,n,null,s,null!=r?r:void 0,a,[])
return u.artwork=Jg(l,e),ta(e,u,hW,i,c),u}function Jg(e,t){var n
return(null==e?void 0:e.iconKind)===Km.Symbol&&(null===(n=null==e?void 0:e.iconKind)||void 0===n?void 0:n.length)?Ot(t,`systemimage://${e.iconSymbol}`):t.client.isPhone?Ot(t,B$):void 0}function Kg(e,t,n,s){if(o(t))return null
if(s.shelfStyle!==Iq)return null
let a=null
!i(s.shelfBackground)||s.shelfBackground.type!==PV&&s.shelfBackground.type!==sM||(a=uq)
const c=Cd(e,t,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},artworkUseCase:Kd(0,s.shelfStyle),offerStyle:a,canDisplayArcadeOfferButton:eh(0,s.shelfStyle),isContainedInPreorderExclusiveShelf:!1,shouldHideArcadeHeader:!1})
return r(c)||!c.isValid()?null:c}function Zg(e,t,n,o){var i,s,a
const c=Ja(t.adStitcher,{shelfIdentifier:k2,slot:n})
if(r(c))return null
const l=c.data
try{switch(null===(i=null==o?void 0:o.adDisplayStyle)||void 0===i?void 0:i.format){case kU:return function(e,t,n){var r,o
const i=new dJ(f_)
i.isHorizontal=!1
const s=Gq,a=uq,c=Bh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:DV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=h_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Kd(0,f_),canDisplayArcadeOfferButton:eh(0,f_)},u={canPlayFullScreen:!1,playbackControls:{}}
let d=Ld(e,t,l,u,null,!1)
const h=d.screenshots[0],p=Ht(h)
n.metricsPageInformation.adPageInfo.setTemplateType(e,p)
const w=tf(e,t,{useCase:y6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:R$})
d=Ld(e,t,l,u,null,!1),null===(r=d.searchAdOpportunity)||void 0===r||r.setTemplateType(p)
const g=w.backgroundColor,v=w.textColor,m=new K0(d,[h],!0,v,g,null!==(o=e.bag.todayAdMediumLockupScreenshotsRiverSpeed)&&void 0!==o?o:8)
return Fh(e,m,c,c.pageInformation.adPageInfo),m.clickAction=Fd(e,t,c,null),i.items=[m],i}(e,l,t)
case"condensed":return function(e,t,n){var r,o
const i=new dJ(p_)
i.isHorizontal=!1
const s=Gq,a=uq,c=Bh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:DV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=h_,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Kd(0,p_),canDisplayArcadeOfferButton:eh(0,p_)}
null===(r=n.metricsPageInformation.adPageInfo)||void 0===r||r.setTemplateType(e,rG)
const u=Ld(e,t,l,{canPlayFullScreen:!1,playbackControls:{}},null,!1)
null===(o=u.searchAdOpportunity)||void 0===o||o.setTemplateType(rG)
const d=new Y0(u,u.icon)
return Fh(e,d,c,c.pageInformation.adPageInfo),i.items=[d],i}(e,l,t)
default:return null===(s=t.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,k2,n),null}}catch(r){return Zt(e,`Failed to create SLP ad shelf: ${r}`),null===(a=t.metricsPageInformation.adPageInfo)||void 0===a||a.recordLockupFromDataFailed(e,k2,n),null}}function Qg(e,t,n,r,o=null){const i=Gw(0,t,n,r)
return o===zm.Apps?{...i,shelfStyle:Iq,adPositionInfo:C2}:i}function Xg(e,t){const n=new dY(e).forType(ZD).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e)).includingScopedRelationships("search-recommendations",[uW]).addingQuery(fW,KF)
Gi(e,kx)&&Ai(n),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([Eq])
const r=cc(e,e.user.dsid)
return(null==r?void 0:r.length)>0&&n.addingQuery(KD,r),n.addingQuery(vV,"adDisplayStyle"),n}function ev(e,t,n,r){var i
if(o(t.data))return null
const s=Un(e,IG,IG,t),a=Ss(e)
s.recoMetricsData=yh(s.recoMetricsData,null,a),s.adPageInfo=dn(e,AV,n),null===(i=s.adPageInfo)||void 0===i||i.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,SF,0)
const c={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:s,adStitcher:Ka(e,n,t),pageType:Wm.Landing,recoImpressionData:gn(0,r)}
Hg(e,t,c)
const l=tv(e)
l&&c.shelves.unshift(l)
const u=new Gee(c.shelves)
return u.pageRefreshPolicy=new NZ(YI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null),jn(e,u,c.metricsPageInformation),u}function tv(e){var t
if(!e.bag.isNaturalLanguageSearchEnabled&&!e.bag.isNaturalLanguageSearchResultsEnabled)return
const n=hl(0,"searchFocusHeader",{signal:{lastNLSQueryDate:e.storage.retrieveString(QD),treatmentId:null!==(t=Ne(e,Zv.SearchLandingPage))&&void 0!==t?t:null}},"pullOnly")
return n.refreshUrl=`${OW}:/${xW.searchLandingPage}/${xW.shelf}/?${zW.isSearchFocusHeaderShelf}=true`,n}function nv(e,t,n){Hg(e,t,n)
const r=new jee(n.shelves)
return o(r.shelves)?null:(jn(e,r,n.metricsPageInformation),r)}async function rv(e,t){const n=new Dm.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await Lp(r,t)
return null===o?Fg(e,t.facets):await async function(e,t){return await Ng(e,t)}(r,o)}async function ov(e,t){return await async function(e,t){return await qv.context("paginatedSearchResultsPageWithToken",async()=>{const n=_g(0,t),r=Lg(0,t)
if(0===n.length)return await Promise.resolve(Fg(e))
const o=t.metricsOptions.pageInformation
if((0,Hv.isSome)(o)&&(0,Hv.isSome)(null==o?void 0:o.adPageInfo)){const n=y(o.adPageInfo);(0,Hv.isSome)(n)&&(o.adPageInfo=Q0.from(e,n),t.metricsOptions.pageInformation=o)}return await Mp(e,n).then(async n=>{const o=At(n),s={id:JF,kind:null,softwareType:null,targetType:eV,title:JB,pageInformation:t.metricsOptions.pageInformation,locationTracker:t.metricsOptions.locationTracker,idType:BU},a=new dJ(Ox)
return a.id=Mg(),a.isHorizontal=!1,Mh(e,a,s),bh(0,s,JB),kh(s.locationTracker,t.contentOffsetWithinResultsShelf),await Eg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(n=>{const o=tg(e,s),c=function(e,t,n,r,o=0){let i=function(e){const t=e.bag.searchResultsLearnMoreEditorialId
!(0,Hv.isNothing)(t)&&(null==t||t.length)}(e)
const s=n.builtSearchResults.length,a=n.deferredSearchResults.length>0,c=o+s
if(void 0===i||void 0===t||o>=i||a&&c<i||0===c&&!a)return r.items=n.builtSearchResults,[r]
i-=o,r.items=n.builtSearchResults.slice(0,i)
const l=new dJ("searchResultsLearnMoreNotice")
l.isHorizontal=!1
const u=new Nee(t)
l.items=[u]
const d=[r,l],f=n.builtSearchResults.slice(i)
if(f.length>0){const e=new dJ(Ox)
e.impressionMetrics=r.impressionMetrics,e.isHorizontal=!1,e.items=f,d.push(e)}return d}(e,o,n,a,t.contentOffsetWithinResultsShelf),l=new $ee(c)
return i(r)&&(r.contentOffsetWithinResultsShelf=Ih(s.locationTracker),l.nextPage=r),l.isCondensedSearchLockupsEnabled=e.client.isPhone,l.resultsParentImpressionMetrics=a.impressionMetrics,Ph(t.metricsOptions.locationTracker),l.searchClearAction=Ug(e,NG,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l.searchCancelAction=Ug(e,Lj,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l})})})}(e,t)}function iv(e){return ee(e)}function sv(e){const t=[$q,Oq,bB,IH,E_,R_,D_,aj,aH,_$]
return e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}function av(e,t,n){var r,o
t.includingAgeRestrictions().includingAdditionalPlatforms(iv(e)).includingAttributes(sv(e)).includingScopedAttributes(Dj,[aj]).includingScopedRelationships(Xq,[bH,Dx]).includingScopedRelationships(Dj,[Dx]).enablingFeature("editorialItemGroups").usingCustomAttributes(Ue(e)).includingRelationshipsForUpsell(!0),n&&(t.includingAssociateKeys(Dj,[uH,sV]),t.includingAssociateKeys(Xq,[sV])),oi(e)&&(t.enablingFeature(zH),t.addingQuery(vV,N$),t.includingScopedRelationships(iW,[Jq]),t.includingScopedAttributes(iW,YK)),si(e)&&(t.enablingFeature(DB),n&&t.includingKindsKeys(VV,[h$])),vn(e)&&t.enablingFeature("eiGroupEISelectionOnDevice"),Kt(e,zq)&&t.enablingFeature("adSupport"),t.enablingFeature("heroStyles")
const i=null!==(o=null===(r=e.userDefaults)||void 0===r?void 0:r.bool(jb))&&void 0!==o&&o
e.bag.enableDeviceDrivenDiscoveryContent&&i&&t.resourceType===zq&&t.addingQuery("pairedDevices","visionPro")}async function cv(e,t){const n=e.required(y3),i=t.url===GA,a=-1!==t.url.indexOf(xW.todayCardPreview)
if(i)return await n.fetchPage(e,t.url,tte)
if(a){const r=az.from(t.url)
return r.param(zW.fetchData,pq),await n.fetchPage(e,r.build(),tte)}{const n=function(e){return ou(e,new dY(e).forType(zq).withSparseCount(1).withSparseLimit(2))}(e)
av(e,n,!0)
const i=(0,Hv.isSome)(t.experimentIdHeader)?{"X-Apple-User-Experiment-Ids":t.experimentIdHeader}:void 0
return await async function(e,t,n,i){var a
const c=new Zm.FetchTimingMetricsBuilder,u=e.addingFetchTimingMetricsBuilder(c),d=Ln(u,t,{headers:null!=n?n:void 0})
d.then(t=>{Kt(e,zq)&&function(e,t){const n=Xt(e,t,!0)
r(n)||(e.ads.setTimeoutForCurrentOnDeviceAdFetch(t,n),function(e,t,n){e.timeoutManager.setTimeout(t,n)}(e,n,V7))}(e,zq),ac(e,e.user.dsid,t)})
const h=_(d),p=function(e,t){const n={}
if(s(t)){const r=new dY(e).withIdsOfType(t,Xq).includingAdditionalPlatforms(iv(e)).includingAttributes(sv(e))
n[Qm.OnboardingCards]=D(Ln(e,r,{}))}Kt(e,zq)&&(n[Qm.Ads]=D(xw(e,zq))),function(e){const t=Ts(e),n=ar(e,e.bag.todayTabArcadePersonalizationRate)
return t&&n}(e)&&(n[Qm.ODP]=D(async function(e,t){return await async function(e,t,n,r){const o=[t,e.timeoutManager.makePromise(r,void 0)]
return await Promise.race(o).then(e=>e)}(e,async function(e){try{const t=await async function(e,t){if(o(t.user.dsid)){const e=`${H7}: User is currently not signed in.`
throw qv.unexpectedType(_H,e,null),new Error(e)}try{const n=l((await t.onDeviceRecommendationsManager.performRequest({type:"fetchUseCases",tab:e,dsId:t.user.dsid})).useCases)
if(o(n)){const t=`${H7}: ODP returned no use cases for tab: ${e}`
throw qv.unexpectedType(_H,t,null),new Error(t)}return n}catch(t){const n=`${H7}: Failed to fetch ODP use cases for tab: ${e}, with error: ${t}`
throw qv.unexpectedType(_H,n,null),new Error(n)}}(zq,e),n=t.map(async t=>await async function(e,t){try{const n=await async function(e,t){if(o(t.user.dsid))throw new Error(`${H7}: User is currently not signed in.`)
try{return await t.onDeviceRecommendationsManager.performRequest({type:wP,dsId:t.user.dsid,useCase:e})}catch(t){const n=`${H7}: Failed to perform ODP Today recommendation for useCase: ${e}, with error: ${t}`
throw qv.unexpectedType(_H,n,null),new Error(n)}}(t,e),i=await async function(e,t){const n=l(t[gP])
if(o(n)){const t=`${H7}: ODP returned no candidates for useCase: ${e}`
throw qv.unexpectedType(_H,t,null),new Error(t)}const i=y(t[Cj]),a=n.map(e=>function(e){const t=f(e.id),n=f(e.type)
if(r(t))return
let o,i=[]
switch(n){case aD:i=l(e.candidates).map(e=>f(e.id)).filter(e=>(0,Hv.isSome)(e)),o=Dj
break
case yj:o=Xq
break
default:return}let a=[]
if(a.push({id:t,type:o}),s(i)){const e=i.map(e=>({id:e,type:Xq}))
a=a.concat(e)}return new z7(t,o,i,a)}(e)).filter(Hv.isSome)
if(r(i)||o(a)){const t=`${H7}: ODP candidates could not be parsed for useCase: ${e}`
throw qv.unexpectedType(_H,t,null),new Error(t)}return{candidates:a,metrics:i}}(t,n),a=i.metrics,c=i.candidates
if(0===c.length)return
const u=c[0],d=await async function(e,t,n,r){const o=new dY(r,t.data,!0).addingQuery(zW.onDevicePersonalizationUseCase,e).addingQuery(zW.filterRecommendable,pq)
Xi(r,o)
try{const i=await Ln(r,o)
return new W7(e,[t],n,i)}catch(e){const n=`${H7}: Failed to fetch Media API data for: ${t.data}, with error: ${e}`
throw qv.unexpectedType(_H,n,null),new Error(n)}}(t,u,a,e)
return d}catch(n){return void e.console.log(`${H7}: Failed to perform ODP Today recommendation for useCase: ${t}, with error: ${n}`)}}(e,t)),i=(await L(n)).map(e=>e.success?e.value:void 0).filter(Hv.isSome)
return new q7(i)}catch(t){return void e.console.log(`${H7}: Failed to perform ODP for Today recommendations: ${t}`)}}(e),0,V7)}(e)))
const i=e.amsEngagement
if(i&&vn(e)){const e={timeout:1e3,eventType:xK,tab:zq}
n[Qm.AMDData]=D(i.performRequest(e))}return n}(e,null!==(a=null==i?void 0:i.onboardingCardIds)&&void 0!==a?a:[]),w=await ic(e,h,p)
return c.measureModelConstruction(()=>{var t,n
const r=At(w.additionalData[Qm.OnboardingCards]),i=w.additionalData[Qm.Ads],s=w.additionalData[Qm.ODP],a=w.additionalData[Qm.AMDData],c=function(e,t,n,r,i){const s=[]
let a=o(r)
const c=Cs(e,t)
let u=0
for(const i of t){if(o(i.contents))continue
const t=As(e,zq,i.contents,!0,c)
i.contents=t.personalizedData,i.onDevicePersonalizationProcessingType=t.processingType
let d=!0
const h={label:i.label,title:i.title,meta:i.meta,date:i.date,onDevicePersonalizationProcessingType:i.onDevicePersonalizationProcessingType,isTodayForAppsModule:Tt(i)}
if(!a){for(const e of r)s.push({type:Rm.EditorialItem,data:e,isDataHydrated:W(e),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]})
d=!1,a=!0,u+=1}for(let t of i.contents){const r=f(t,"meta.personalizationData.onDeviceUseCase")
switch(t.type){case Xq:if((0,Hv.isSome)(r)){const e=null==n?void 0:n.storyData(r);(0,Hv.isSome)(e)&&(t=e)}s.push({type:Rm.EditorialItem,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]}),d=!1,u+=1
break
case Dj:const a=l(t,__)
if(o(a))continue
let f
if((0,Hv.isSome)(r)&&(f=null==n?void 0:n.storyGroupData(r)),(0,Hv.isSome)(f))t=f
else{const n=As(e,zq,a,!0,c)
t[vV].associations[uH][Gj]=n.personalizedData,i.onDevicePersonalizationProcessingType=n.processingType}s.push({type:Rm.EditorialItemGroup,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:Array.from({length:a.length},(e,t)=>t+u)}),d=!1,u+=a.length}}}return s}(e,null!==(n=null===(t=w.primaryPageData.results)||void 0===t?void 0:t.data)&&void 0!==n?n:[],s,r)
return lv(u,c,w.primaryPageData,i,a)})}(e,n,i,t)}}function lv(e,t,n,r,i){return qv.context(_j,()=>{if(o(t))return null
const a=function(e,t,n,r,o){var i,a,c,u
const d=Un(e,RS,zq,n,null,null!==(i=dn(e,zq,r,t))&&void 0!==i?i:Ys(e,zq,n,null===(a=null==r?void 0:r.onDeviceAd)||void 0===a?void 0:a.positionInfo,t)),f=Ss(e)
d.recoMetricsData=yh(d.recoMetricsData,null,f)
const h=new UZ(t,d,{rootPosition:0,locationStack:[]},Nr(n),gn(0,o))
if(Kt(e,zq)){const n=an(e,zq,!0);(0,Hv.isSome)(n)&&(h.eligibleAdLocations=n.map(e=>e.slot))
for(const t of null!=n?n:[])null===(c=d.adPageInfo)||void 0===c||c.recordAdResponseEventsIfNeeded(e,null==r?void 0:r.failureReason,t.shelfIdentifier,t.slot)
if(h.adPlacementBehavior=function(e){let t=im.insertIntoShelf
for(const n of e){let e=t
switch(n.type){case Rm.EditorialItem:e=hv(n.data)
break
case Rm.EditorialItemGroup:const t=l(n.data,__)
if(s(t))for(const n of t)if(e=hv(n),e!==im.insertIntoShelf)break}if(e!==im.insertIntoShelf){t=e
break}}return t}(t),(0,Hv.isNothing)(null==r?void 0:r.failureReason)){h.adData=yt(e,null==r?void 0:r.mediaResponse)
const t=null===(u=null==r?void 0:r.onDeviceAd)||void 0===u?void 0:u.positionInfo
if(s(t)){const e=t.slot-1
h.adLocation=e}}}return h}(e,t,n,r,i),c=uv(e,a)
return c.shelves.splice(0,0,hl(0,"todayPageHeader")),c})}function uv(e,t){var n
const r=[],o=function(e,t){switch(e.client.buildType){case GG:case nG:const e=new az
e.protocol=EW,e.host=WU,e.pathname=`/${xW.todayCardPreview}`
const n=[]
for(const e of t)switch(e.type){case Rm.EditorialItem:n.push(e.data.id)
break
case Rm.EditorialItemGroup:const t=l(e.data.meta,L_)
n.push(`${e.data.id}:[${t.map(e=>e.id).join(",")}]`)}return e.param(zW.ids,n.join(",")),e.param(zW.isTodayFeedPreview,pq),decodeURIComponent(e.build())
default:return null}}(e,t.remainingContent)
let a=Is(t.remainingContent)
const c=null===(n=t.remainingContent[0])||void 0===n?void 0:n.isFirstItemInModule
for(;a;){const n=t.remainingContent.shift()
if((0,Hv.isNothing)(n)){a=!1
break}const o=Fs(e,t);(0,Hv.isSome)(o)&&r.push(o),t.currentTodayItem=n
let i=null
switch(n.type){case Rm.EditorialItem:i=Ls(e,n,t)
break
case Rm.EditorialItemGroup:i=Ms(e,n,t)}t.currentTodayItem=void 0,(0,Hv.isSome)(i)&&r.push(i)
const s=Fs(e,t);(0,Hv.isSome)(s)&&r.push(s),a=Is(t.remainingContent)}c&&un(e,r,zq,zq,t.pageInformation)
const u=new tte(r),d=e.bag.tabsStandard.find(e=>e.id===zq),h=f(d,Nq),p=f(d,"image-identifier"),w=(0,Hv.isNothing)(p)||"doc.text.image"===p,g=null!=h?h:e.loc.string("PAGE_TITLE_TODAY")
return u.title=g,u.tabTitle=g,u.titleDetail=w?function(e){const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat")
return e.loc.formatDate(n,t)}(e):void 0,u.shortTitleDetail=w?function(e){const t=new Date
return e.loc.formatDate("MMM d",t)}(e):void 0,u.longTitle=w?function(e){if(!e.client.isPad)return
const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat.IPad")
return e.loc.formatDate(n,t)}(e):void 0,u.feedPreviewUrl=o,s(t.remainingContent)?(t.pageHasDisplayedContent=t.pageHasDisplayedContent||r.some(e=>{s(e.items)}),u.nextPage=t):function(e,t,n){const r=[],o=dl(e)
i(o)&&r.push(o)
const s=e.bag.termsAndConditionsURL
if(i(s)){const t=fl(e,s)
r.push(t)}return r}(e,t.pageInformation,t.locationTracker).forEach(e=>{u.shelves.push(e)}),jn(e,u,t.pageInformation),u}async function dv(e,t){const n=t.pageHasDisplayedContent?6:12
let r=!0,o=0,i=[]
for(;r;){const e=t.remainingContent[o]
switch(e.type){case Rm.EditorialItem:i.push(e.data)
break
case Rm.EditorialItemGroup:i.push(e.data)
const t=l(e.data,__)
i=[...i,...t]}o++,r=i.length<n&&o<t.remainingContent.length}const s=new Set(i.map(e=>e.id)),a=new dY(e,i,!0,[uH,sV])
av(e,a,!1)
const c=await Ln(e,a,{allowEmptyDataResponse:!0}),u={}
for(const e of c.data)u[e.id]=e
for(const e of t.remainingContent)fv(e,u)
return t.remainingContent=t.remainingContent.filter(e=>e.isDataHydrated||!s.has(e.data.id)),t}function fv(e,t){var n,r,o
switch(e.type){case Rm.EditorialItem:s(t[e.data.id])&&(e.data={...e.data,...t[e.data.id]}),e.isDataHydrated=W(e.data)
break
case Rm.EditorialItemGroup:s(t[e.data.id])&&(e.data={...e.data,attributes:null===(n=t[e.data.id])||void 0===n?void 0:n.attributes,relationships:null===(r=t[e.data.id])||void 0===r?void 0:r.relationships,meta:{...e.data.meta,...null===(o=t[e.data.id])||void 0===o?void 0:o.meta}}),e.isDataHydrated=W(e.data)}}function hv(e){const t=v(e,bC)
return i(t)&&t?im.replaceOrganic:i(t)&&!t?im.dropAd:im.insertIntoShelf}function pv(e,t){if(i(t.adPageInfo)){const n=y(t.adPageInfo)
s(n)&&(t.adPageInfo=Q0.from(e,n))}}function wv(e,t,n,r,o){return qv.context(sT,()=>Cd(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:y6.LockupIconSmall}))}function gv(e,t,n,o,i,s){return qv.context("topChartsPageFromApiResponse",()=>{var a
const c=[]
if((0,Wv.isSome)(o))for(const t of o.categories)(0,Wv.isSome)(t.genreId)&&c.push(vv(e,t))
const u=function(e){return l(e,"results.apps").filter(e=>!r(e.data))}(t),d=u.map(r=>function(e,t,n,r,o){return qv.context("segmentFromData",()=>{const{shortName:i,longName:s}=function(e,t,n){const r=f(t,aq)
let o=f(t,"shortName"),i=f(t,fW)
if(n!==NK)return{shortName:(0,Wv.unsafeUnwrapOptional)(o),longName:(0,Wv.unsafeUnwrapOptional)(i)}
const s=e.client.isPad
switch(r){case U2:s?(o=e.loc.string("TopCharts.iPadGames.Free.ShortName"),i=e.loc.string("TopCharts.iPadGames.Free.LongName")):(o=e.loc.string("TopCharts.Games.Free.ShortName"),i=e.loc.string("TopCharts.Games.Free.LongName"))
break
case B2:s?(o=e.loc.string("TopCharts.iPadGames.Paid.ShortName"),i=e.loc.string("TopCharts.iPadGames.Paid.LongName")):(o=e.loc.string("TopCharts.Games.Paid.ShortName"),i=e.loc.string("TopCharts.Games.Paid.LongName"))}return{shortName:(0,Wv.unsafeUnwrapOptional)(o),longName:(0,Wv.unsafeUnwrapOptional)(i)}}(e,t,o),a=f(t,aq),c=Un(e,Dy,r,n,`${a} ${s}`),l={rootPosition:0,locationStack:[]},u=[]
let d=0
const h=[]
for(const n of t.data){const t=wv(e,d,n,c,l)
if(t){if(at(e,n,Qv.Charts))continue
u.push(t),Oh(l),d++}else h.push(n)}const p=[],w=new dJ(Iq)
w.items=u,e.featureFlags.isEnabled(PJ),w.title=s,p.push(w)
const g=new ste(i,s,a,p),v=function(e,t,n,r=null,o,i){return{remainingContent:t,maxPerPage:20,highestOrdinal:0,url:n,metricsPageInformation:o,metricsLocationTracker:i}}(0,h,void 0,t.next,c,l)
return v.metricsPageInformation=c,v.metricsLocationTracker=l,v.highestOrdinal=d,g.nextPage=v,jn(e,g,c),g})}(e,r,t,n,s)).sort((e,t)=>e.chart.localeCompare(t.chart)),h=f(u,"0.href"),p=new az(h),w=null!==(a=p.query[PH])&&void 0!==a?a:n,g=mv(w,p.query[rB],c),v=function(e,t){return t.every(e=>function(e){switch(e){case V2:case H2:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_TRENDING_CHARTS"):t.every(e=>function(e){switch(e){case q2:case W2:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_EMERGING_CHARTS"):e.loc.string("PAGE_TITLE_TOP_CHARTS")}(e,d),m=new ate(w,null==g?void 0:g.ageBandId,v,d,null==g?void 0:g.name,c),y=d.findIndex(e=>e.chart===i)
y>=0&&(m.initialSegmentIndex=y)
const A=e.fetchTimingMetricsBuilder
return(0,Wv.isSome)(A)&&A.decorate(m),m})}function vv(e,t){const n=function(e,t,n=null){let r=new dY(e).forType(rN).addingQuery(oN,dW).addingQuery(PH,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)
return n&&(r=r.addingQuery(rB,n)),e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([_q,Dq])),r}(e,t.genreId,t.ageBandId),r=t.children.map(t=>vv(e,t))
return new cte(t,ve(e,n).toString(),r)}function mv(e,t,n){for(const r of n){if(t&&r.ageBandId===t||!t&&!r.ageBandId&&r.genreId===e)return r
const n=mv(e,t,r.children)
if(n)return n}return null}async function yv(e,t){const n=Tv().map(e=>new lz(e)),i=new az(t),s=n.find(e=>e.matches(i)).extractParameters(i),a=i.query[zW.genre]||s[zW.genre],c=i.query[zW.chart]||s[zW.chart],l=i.query[zW.charts],u=i.query[zW.ages]
return await async function(e,t,n,i,s){if(o(n)){const e=hc(0,i)
n=void 0!==e?`${i},${e}`:i}else n.includes(i)||(n+=`,${i}`)
const a=new Dm.FetchTimingMetricsBuilder,c=e.addingFetchTimingMetricsBuilder(a),l=pc(c,t,n,s)
let u
return u=wc(e,n,t),await Promise.all([l,u]).then(([n,o])=>a.measureModelConstruction(()=>{const s=Tn(e,o),a=r(s)?mn(t):yn(s)
return gv(c,n,t,s,i,a)}))}(e,a,l,c,u)}async function Av(e,t){const n=Pt(0,t)
if(0===n.length)return await Promise.resolve(new ste(null,null,null,[]))
let r=new dY(e,n).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([_q,Dq])),e.bag.enableUpdatedAgeRatings&&r.includingAttributes([Eq]),await Ln(e,r).then(n=>{const r=It(0,t)
return bv(e,n,t,r)})}function Tv(e){return[{path:`/{apiVersion}/catalog/{countryCode}/${xW.charts}`,query:[`${zW.genre}`,`${zW.isPPT}?`,`${zW.charts}?`]},{path:`/{countryCode}/${xW.charts}/{platform}/{chartType}/{genre}`,query:[`${zW.chart}`]},{path:`/{countryCode}/${xW.charts}/{platform}/{chart}/{genre}`,query:[`${zW.charts}?`]},{path:`/{countryCode}/${xW.charts}/{platform}`},{path:`/{countryCode}/{platform}/${xW.charts}`},{path:`/{countryCode}/{platform}/${xW.charts}/{genre}`}]}function bv(e,t,n,r){return qv.context("topChartSegmentFromLookupResponse",()=>{const o=[]
let i=n.highestOrdinal
const s=At(t)
for(const t of s)at(e,t,Qv.Charts)||(o.push(Sv(e,i,t,n.metricsPageInformation,n.metricsLocationTracker)),Oh(n.metricsLocationTracker),i++)
const a=[]
if(o.length>0){const e=new dJ(Iq)
e.items=o,a.push(e),r.highestOrdinal=i}const c=new ste(null,null,null,a)
return c.nextPage=r,c})}function Sv(e,t,n,r,o){return qv.context(sT,()=>Cd(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:y6.LockupIconSmall}))}function Pv(e,t){const n=Cs(e,[t])
if(i(t.contents)){const r=As(e,"todayWidget",t.contents,!0,n)
t.contents=r.personalizedData}return t}function Iv(e,t,n,r,s,a){const c=[]
let l=0,u=0,d=0
for(const a of t.contents){if(z(a)){l++
continue}const t=we(a,OH),f=Dv(e,a,n,r),h=null===f?Ov(e,t):[],p=Rv(a),w=[null==f?void 0:f.backgroundColor,1===h.length&&null!==h[0]?h[0].backgroundColor:void 0,ye("1C68E2")].find(e=>void 0!==e)
if(0===h.length&&null===f){u++
continue}const g=Cv(e,a,r)
let v=null,m=null,y=null
if(t.length>0&&t[0].type===iW){const e=j(t[0],r$)
if(o(e)){d++
continue}y=j(t[0],i$),v=new Date(e)
const n=j(t[0],o$)
m=i(n)?new Date(n):null}const A=Co(a)
c.push(new pte(a.id,g,p,w,be(w),h,kv(e,a,n,g,s),A===sL,f,y,v,m))}return null!==a&&t.contents.length===l+u+d&&a(`All ${t.contents.length} cards in this ${r?"primary":"secondary"} module were filtered due to being unhydrated (${l}), missing artwork (${u}) or missing metadata (${d})`),c}function Cv(e,t,n){let r=j(t,YH)
if(!n){const n=Co(t)
switch(n){case Tm.AppOfTheDay:case Tm.GameOfTheDay:r=vo(e,t,n,null)}}return r.replace(/\n/g," ")}function kv(e,t,n,r,i){let a
switch(n){case zN:a=0
break
case EC:a=1
break
case x_:a=2
break
default:a=-1}const c={widgetId:i,size:a,targetId:t.id,name:r},l=encodeURIComponent(JSON.stringify(c))
switch(Bd(0,t)){case v6:const n=we(t,bH),r=s(n)&&1===n.length?n[0]:we(t,OH)[0],i=pe(e,r,Jq)
if(o(i))break
return`${OW}:/${xW.product}/${zW.id}${i.id}?${zW.appEventId}=${r.id}${zW.invalidateWidgetsOnFailure}=true&${zW.metrics}=${l}`
case g6:const a=we(t,OH)[0]
return`${OW}:/${xW.product}/${zW.id}${a.id}?${zW.invalidateWidgetsOnFailure}=true&${zW.metrics}=${l}`
case p6:return f(B(t,Mq),Wq)}return`${OW}:/${xW.story}/${zW.id}${t.id}?${zW.invalidateWidgetsOnFailure}=true&${zW.metrics}=${l}`}function Ov(e,t){return t.map(t=>{if(t.type===JH)return null
if(rf(e,t)){const n=function(e,t){switch(Fr(e,t)){case Iz:return PT
case Cz:return null
default:return TH}}(e,t)
if((0,Hv.isSome)(n)){const r=Ev(e,t,n)
if((0,Hv.isSome)(r))return Zd(e,r,{cropCode:"bb",useCase:y6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}}const n=function(e,t){switch(Fr(e,t)){case Iz:return fE
case Cz:return hE
default:return oW}}(e,t),r=Ev(e,t,n),o=function(e,t){const n=Fr(e,t),r=nf(e)
let o
switch(n){case Iz:o=r?"ic":"bb"
break
case Cz:o="bb"
break
default:o=r?"ia":"bb"}return o}(e,t)
return Zd(e,r,{cropCode:o,useCase:y6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}).filter(e=>null!==e)}function Ev(e,t,n){return ot(e,t,Ge(e,t),n)}function Rv(e){var t
const n=B(e,hV)
let r=null
s(n)&&(r=f(n,fW))
let o=null
const i=we(e,OH)
switch(i.length>0&&(o=j(i[0],fW)),j(e,CH)){case Tm.AppOfTheDay:case Tm.GameOfTheDay:return null!==(t=null!=o?o:r)&&void 0!==t?t:""
default:return null!=r?r:""}}function Dv(e,t,n,r,o){let i=null
Co(t)===sL&&(i=function(e,t,n,r){let o=null,i=null
const s=["editorialVideo.storyCardMotion16x9.previewFrame","editorialVideo.storyCenteredMotion16x9.previewFrame","editorialVideo.storeFrontVideo4x3.previewFrame"]
for(const e of s)if(i=B(t,e),(0,Hv.isSome)(i))break
return i&&(o=Zd(e,i,{withJoeColorPlaceholder:!0,useCase:y6.WidgetEditorial}),r||(o.crop="sr")),o}(e,t,0,r))
const s=[{artworkKeyPath:CC,crop:"sr"},{artworkKeyPath:Rx,crop:"sr"}]
switch(Co(t)){case Tm.AppOfTheDay:case Tm.GameOfTheDay:const e=n===zN?RC:"nr"
s.push({artworkKeyPath:I_,crop:r?e:"fn"})
break
case Tm.Video:case Tm.FullBleedImage:const t=n===zN?DC:_C
s.push({artworkKeyPath:AM,crop:r?t:"fn"})
break
case Tm.AppEventCard:const o=n===zN?RC:"nr"
s.push({artworkKeyPath:C_,crop:r?o:"fn"})
break
default:const i=n===zN?DC:_C
s.push({artworkKeyPath:k_,crop:r?i:"fn"})}let a=null
for(const n of s)if(a=Zd(e,B(t,n.artworkKeyPath),{cropCode:n.crop,useCase:y6.WidgetEditorial,withJoeColorPlaceholder:!0}),(0,Hv.isSome)(a))break
return null!=a?a:i}async function _v(e,t){let n
switch(t.family){case 1:n=EC
break
case 2:n=x_
break
default:n=zN}let a=null
return typeof t.originalResponseHash!==OU&&null!==t.originalResponseHash&&""!==t.originalResponseHash&&typeof t.originalResponseDate!==OU&&null!==t.originalResponseDate&&""!==t.originalResponseDate&&(a={hash:t.originalResponseHash,creationDate:t.originalResponseDate}),await async function(e,t,n,a,c){return await new Promise((n,l)=>{if(!function(e,t,n,r){return!r||ar(e,e.bag.todayWidgetLivePreviewRolloutRate)}(e,0,0,a))return void l("No live preview will be shown due to losing the todayWidgetLivePreviewRolloutRate lottery.")
const u=new gte,d=e=>l(e)
Ln(e,u.make(e)).then(a=>{const l=h(a,mm.contentMaxAge),u=function(e,t){return r(e)||r(e.results)||o(e.results.data)?(t("Unable to create primary module; no results or data."),null):o(e.results.data[0].contents)?(t("Unable to create primary module; no contents."),null):e.results.data[0].contents.length===e.results.data[0].contents.filter(e=>z(e)).length?(t("Unable to create primary module; none of the cards are hydrated."),null):{label:"",title:"",meta:{},contents:e.results.data[0].contents}}(a,d)
if(null===u)return
const f=function(e){const t={label:"",title:"",meta:{},contents:[]}
if(r(e)||r(e.results)||o(e.results.data))return t
const n=e.results.data.slice(1)
return 0===n.length?t:{label:"",title:"",meta:{},contents:n.map(e=>e.contents).reduce((e,t)=>e.concat(t))}}(a),p=function(t,n,r,o,i){const a=(c=JSON.stringify(t.contents.concat(n.contents).map(e=>e.id))+(null!==r?r.toString():""),e.cryptography.hash("sha256",c))
var c
return null!==i&&s(i.hash)&&s(i.creationDate)&&i.hash===a?i:{hash:a,creationDate:(new Date).toUTCString()}}(u,f,l,0,c),w=function(e,t,n){null===n&&e.console.error("No TTL value was found--deferring to JS client for refresh time.")
const r=new Date(t.creationDate)
return r.setSeconds(r.getSeconds()+n),e.console.info(`Media API provided TTL: ${n} so timeline refresh date will be ${r}`),r}(e,p,l),g=Pv(e,u),v=Pv(e,f),m=function(e,t,n,s,a,c,l,u,d){if(r(t))return d("Unable to create a TodayWidgetContainer; primaryModule is null."),null
const f=Iv(e,t,s,!0,u,d)
if(0===f.length)return null
const h=Iv(e,n,s,!1,u,null),p=function(e,t,n,r,s,a){const c=De(t),l=Le(c,n),u={}
for(let e=0;e<r.length;e++){const t=e%r.length*2
u[r[e].storyId]=a===x_?s.slice(t,t+2):[]}const d=function(e,t,n){return function(e,r){const o=[],i=[]
return e.forEach(e=>{return void 0!==(r=e).eventStartDate&&null!==r.eventStartDate&&t<De(r.eventStartDate)&&De(r.eventStartDate)<=n?o.push(e):i.push(e)
var r}),[o,i]}(e)}(r,c,n),f=d[0]
let h=d[1]
const p=[...Array(l)].map(()=>[]),w=[...Array(l)].map((e,t)=>new Date(c.getTime()+60*t*60*1e3)),g=new Map
r.concat(s).forEach(t=>{if(i(t.eventStartDate)){const n=gi(t.eventBadgeKind,t.eventStartDate,t.eventEndDate)
g[t.storyId]=vi(e,n,t.eventStartDate,t.eventEndDate)}}),f.forEach(e=>{var t
for(let n=((Le(c,e.eventStartDate)-1)%(t=r.length)+t)%t;n<p.length&&!(e.eventEndDate<=w[n]);n+=r.length)for(let t=0;t<r.length&&!(p.length<=n+t);t++)if(0===p[n+t].length){p[n+t].push(S(e))
for(const r of u[e.storyId])p[n+t].push(S(r))
break}})
for(let e=0;e<p.length;e++){if(p[e].length>0)continue
const t=w[e]
if(h=h.filter(e=>void 0===e.eventEndDate||null===e.eventEndDate||e.eventEndDate>t),0===h.length)break
const n=h.shift()
h.push(n),p[e].push(S(n))
for(const t of u[n.storyId])p[e].push(S(t))}return p.map((e,t)=>{const n=w[t],r=e.map(e=>{const n=g[e.storyId],r=function(e,t){if(o(t))return null
const n=t.filter(t=>null===t.displayFromDate||t.displayFromDate<=e)
return 0===n.length?null:n.pop()}(w[t],n)
return null!==r?(e.heading=r.displayText,e.eventStartDate=r.countdownToDate):e.eventStartDate=null,e})
return new hte(r,n)})}(e,new Date(c.creationDate),l,f,h,s)
return new fte(p,l,c.creationDate,c.hash)}(e,g,v,t,0,p,w,OC,d)
null!==m&&n(m)}).catch(e=>{l(e)})})}(e,n,t.isSnapshot,t.isPreview,a)}var Lv,Mv,xv,$v,Fv,Nv,Bv,Uv,Gv,jv,Vv,Hv,qv,Wv,zv,Yv,Jv,Kv,Zv,Qv,Xv,em,tm,nm,rm,om,im,sm,am,cm,lm,um,dm,fm,hm,pm,wm,gm,vm,mm,ym,Am,Tm,bm,Sm,Pm,Im,Cm,km,Om,Em,Rm,Dm,_m,Lm,Mm,xm,$m,Fm,Nm,Bm,Um,Gm,jm,Vm,Hm,qm,Wm,zm,Ym,Jm,Km,Zm,Qm,Xm,ey,ty,ny,ry,oy={}
e.r(oy),e.d(oy,{downloadingOrdering:()=>h1,downloadingOrderingCompact:()=>p1,notPurchasedOrdering:()=>d1,notPurchasedOrderingCompact:()=>f1,notPurchasedSpotlightIndex:()=>c1,purchasedOrdering:()=>l1,purchasedOrderingCompact:()=>u1,purchasedSpotlightIndex:()=>a1}),Lv={},e.r(Lv),e.d(Lv,{downloadingOrdering:()=>T1,downloadingOrderingCompact:()=>b1,notPurchasedOrdering:()=>y1,notPurchasedOrderingCompact:()=>A1,notPurchasedSpotlightIndex:()=>g1,purchasedOrdering:()=>v1,purchasedOrderingCompact:()=>m1,purchasedSpotlightIndex:()=>w1}),Mv={},e.r(Mv),e.d(Mv,{notPurchasedOrdering:()=>C1,notPurchasedSpotlightIndex:()=>P1,purchasedOrdering:()=>I1,purchasedSpotlightIndex:()=>S1}),xv={},e.r(xv),e.d(xv,{notPurchasedOrdering:()=>R1,notPurchasedSpotlightIndex:()=>O1,purchasedOrdering:()=>E1,purchasedSpotlightIndex:()=>k1}),$v={},e.r($v),e.d($v,{notPurchasedOrdering:()=>M1,notPurchasedSpotlightIndex:()=>_1,purchasedOrdering:()=>L1,purchasedSpotlightIndex:()=>D1}),Fv={},e.r(Fv),e.d(Fv,{notPurchasedOrdering:()=>N1,notPurchasedSpotlightIndex:()=>$1,purchasedOrdering:()=>F1,purchasedSpotlightIndex:()=>x1}),Nv={},e.r(Nv),e.d(Nv,{notPurchasedOrdering:()=>j1,notPurchasedSpotlightIndex:()=>U1,purchasedOrdering:()=>G1,purchasedSpotlightIndex:()=>B1}),Bv={},e.r(Bv),e.d(Bv,{notPurchasedOrdering:()=>W1,notPurchasedSpotlightIndex:()=>H1,purchasedOrdering:()=>q1,purchasedSpotlightIndex:()=>V1}),Uv={},e.r(Uv),e.d(Uv,{notPurchasedOrdering:()=>K1,notPurchasedSpotlightIndex:()=>Y1,purchasedOrdering:()=>J1,purchasedSpotlightIndex:()=>z1}),Gv={},e.r(Gv),e.d(Gv,{downloadingOrdering:()=>r2,downloadingOrderingCompact:()=>o2,notPurchasedOrdering:()=>t2,notPurchasedOrderingCompact:()=>n2,notPurchasedSpotlightIndex:()=>Q1,purchasedOrdering:()=>X1,purchasedOrderingCompact:()=>e2,purchasedSpotlightIndex:()=>Z1}),jv={},e.r(jv),e.d(jv,{downloadingOrdering:()=>d2,downloadingOrderingCompact:()=>f2,notPurchasedOrdering:()=>l2,notPurchasedOrderingCompact:()=>u2,notPurchasedSpotlightIndex:()=>s2,purchasedOrdering:()=>a2,purchasedOrderingCompact:()=>c2,purchasedSpotlightIndex:()=>i2})
const iy="AppEventSearchResult",sy="AppSearchResult",ay="com.apple.MobileSMS",cy="com.apple.TVAppStore",ly="com.apple.Arcade",uy="com.apple.AppStore.ProductPageExtension",dy="com.apple.appstorecomponentsd",fy="ContingentOfferDetailPage",hy="ShelfBasedProductPage",py="EditorialSearchResult",wy="arcadeGroupingLockup",gy="Lockup",vy="arcadeGeneric",my="OfferItemDetailPage",yy="Screenshots",Ay="tapToRate",Ty="lockupList",by="TodayCardLockupOverlay",Sy="TodayCardMarketingLockupOverlay",Py="TodayCardMediaArtwork",Iy="TodayCardMediaBrandedSingleApp",Cy="TodayCardMediaList",ky="TodayCardMediaVideo",Oy="TodayCardMediaRiver",Ey="TodayCardParagraphOverlay",Ry="TodayCardThreeLineOverlay",Dy="TopChartsPage",_y="ArcadeAction",Ly="CompoundAction",My="ExternalUrlAction",xy="OfferAction",$y="OfferAlertAction",Fy="OfferConfirmationAction",Ny="ProductPageScrollAction",By="SearchAdAction",Uy="ShelfBasedPageScrollAction",Gy="flowAction",jy="expanded",Vy="continuation",Hy="signup",qy="purchases",Wy="donate",zy="is32bitOnly",Yy="requires32bit",Jy="is.workflow.my.app",Ky="com.apple.mobileme.fmf1",Zy="iPhone",Qy="iPad",Xy="com.apple.NanoCompass.watchkitapp",eA="com.apple.DeepBreathing",tA="com.apple.Depth",nA="com.apple.Mandrake",rA="SCS.ApDPCS01",oA="ACTION_SETTINGS",iA="shareSheet",sA="com.apple.InstallAssistant.",aA="Send Gift",cA="initiate",lA="additionalAdsInfo",uA="EDITORIALTAKEOVER",dA="SLPLOAD",fA="iad.format.text",hA="adsLocaleMetadata",pA="mapiFetchFail",wA="localizationNotAvailable",gA="SHARE_APP_EVENT_SUBTITLE",vA="j:mm",mA="inAppEvent",yA="systemimage://bell.fill",AA="appPromotionTitle",TA="OfferItems.FormattedDate.RedemptionDate.DateFormat",bA="OfferItems.Available.Now",SA="@@date@@",PA="arcade-see-all-games-button",IA="GAME_CENTER",CA="marketingArtwork",kA="seed",OA="upsell",EA="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",RA="PAGE_FACETS_FILTERS_COMING_SOON",DA="PAGE_FACETS_SORT_BY_TITLE",_A="controllerSupport",LA="PAGE_FACETS_INCLUDE_TITLE",MA="000000",xA="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",$A="displayBreakoutMaterial",FA="material",NA="textGradient",BA="plusLight",UA="MMMM d, y",GA="x-as3-internal:/today/test",jA="notificationSettings",VA="invalidateWidgetsOnFailure",HA="PageData",qA="ProductBuilder",WA="contingent-items:branch",zA="contingentItemOffer",YA="contingent-items:association.trunks",JA="trunks",KA="offer-items:salables",ZA="discountOffer",QA="fileSizeByDevice",XA="promotionalText",eT="backgroundAssetsInfo",tT="backgroundAssetsInfoWithOptional",nT="installSizeByDeviceInBytes",rT="editorial-item-shelves",oT="viewEditorialItem",iT="preview",sT="lockupFromApiChartItem",aT="contentRatingsBySystem.appsApple.name",cT="ageRating.value",lT="ageRating.contentLevels",uT="br.l.official",dT="br.l",fT="br.10.official",hT="br.10",pT="br.12.official",wT="br.12",gT="br.14.official",vT="br.14",mT="br.16.official",yT="br.16",AT="br.18.official",TT="br.18",bT="impressionableAppIconFromData",ST="SCB.ApSCBL01",PT="circularIconArtwork",IT="appBinaryTraits",CT="requiresRosetta",kT="iphone5",OT="iphone6",ET="iphone6+",RT="maxEssentialInstallSizeInBytes",DT="maxDownloadSizeInBytes",_T="maxInstallSizeInBytes",LT="editorialArtwork.contentLogoTrimmed",MT="posterCardVideo16x9",xT="enabled",$T="concerns",FT="ACTION_REVIEW_REPORT",NT="TOAST_CONCERN_REPORTED_TITLE",BT="TOAST_CONCERN_REPORTED_DESCRIPTION",UT="systemimage://square.and.pencil",GT="userReviewId",jT="systemimage://hand.thumbsup",VT="systemimage://hand.thumbsdown",HT="guid",qT="formBody",WT="CONTROLLER_RECOMMENDED",zT="NOT_SUPPORTED",YT="CAPABILITY_GAME_CENTER_TITLE",JT="resource://ProductCapabilityGameCenter",KT="safariExtensions",ZT="above",QT="hasApps",XT="hasGames",eb="DEVELOPER_APPS_AND_GAMES",tb="DEVELOPER_GAMES",nb="DEVELOPER_APPS",rb="associations.apps.data",ob="prefersHiddenPageTitle",ib="enrichedEditorialNotes.name",sb="enrichedEditorialNotes.tagline",ab="enrichedEditorialNotes.callToAction",cb="shelf_id",lb="arcadeSeeAllGamesFooter",ub="footer",db="three",fb="ARCADE_PREORDER_COMING_SOON",hb="REPORT_A_PROBLEM",pb="Shelves.Accessibility.Label",wb="Shelves.Accessibility.RoleDescription",gb="featuredCategories",vb="editorialCard",mb="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_GAME",yb="breakoutTall",Ab="renderGroupingPage",Tb="noPersonalizationAvailable",bb="groupingAppEvent",Sb="suppressText",Pb="layoutStyle.layoutSize",Ib="link.url",Cb="GameCenter.ContinuePlayingShelf.Title",kb="videoCard",Ob="impressionIndex",Eb="Achievements Hero",Rb="inprogress",Db="gameCenterFriendingViaPush",_b="legacy",Lb="FRIEND_SUGGESTION",Mb="smallContactCard",xb="INVITE",$b="FROM_CONTACTS",Fb="inviteFriend",Nb="removeFriendSuggestion",Bb="friendSuggestion",Ub="redownloadButtonTintUsingOfferTheme",Gb="parentShelfItems",jb="displayDeviceDrivenContent",Vb="null",Hb="smallBreakout",qb="tagBrick",Wb="advertPressed",zb="offerButtonPress",Yb="MEDRIVER_",Jb="iAdIsSpecifiedCreativeUsed",Kb="promotedContent",Zb="editorialContext",Qb="Watch",Xb="Messages",eS="developerName",tS="firstVersionSupportingInAppPurchaseApi",nS="widthConstrainedLockup",rS="OfferButton.Title.Subscribe",oS="descending",iS="editorialItemActionFromData",sS="displaySubStyle",aS="iad.lineItem",cS="clientIdentifierOverride",lS="contentRestrictionReasons",uS="clientCorrelationKey",dS="viewedInfo",fS="viewedInfoDetailed",hS="cookie",pS="ownerDsid",wS="pageExit",gS="trampoline",vS="trampolineContext",mS="widgetContext",yS="iAdOdmlSuccess",AS="ODP_NOAD",TS="APPSTORE_SEARCH_LANDING_PAGE",bS="APPSTORE_TODAY_TAB",SS="APPSTORE_PRODUCT_PAGE",PS="APPSTORE_PRODUCT_PAGE_DOWNLOAD",IS="iAdPageCustomId",CS="contingentItemId",kS="browserChoice",OS="browserChoiceScreenBuy",ES="clip",RS="Today",DS="subscriptionState",_S="buttonName",LS="actionContext",MS="selectedPageFacets",xS="Apps",$S="searchGhostHint",FS="didYouMean",NS="displaysArcadeUpsell",BS="franchise",US="isOnboardingCard",GS="optimizationEntityId",jS="optimizationId",VS="iAdEligible",HS="macSoftware",qS="iosSoftware",WS="artist",zS="pending",YS="channelPartner",JS="eligibilityType",KS="upsellScenario",ZS="modeType",QS="FreeTrial",XS="PayUpFront",eP="PayAsYouGo",tP="test",nP="rebuy=true",rP="OfferButton.FlowPreview.Get",oP="OfferButton.FlowPreview.Preorder",iP="preorderedSubscribed",sP="productPageBrowserChoiceSelect",aP="preorderSubscribed",cP="INTRO_PRICE_OFFER_SUBTITLE",lP="Offer.InlineInAppPurchases",uP="OfferButton.ExternalPurchases.Subtitle",dP="weight_parameter",fP="meta.personalizationData.isPinned",hP="meta.personalizationData.segId",pP="OnDeviceRecommendationsPageController",wP="fetchRecommendations",gP="candidates",vP="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",mP="<br><br>",yP="privacyPolicy",AP="PRODUCT_PRIVACY_DEFINITIONS_LINK",TP="privacyDefinitions",bP="ACTION_SEE_DETAILS",SP="USAGE_DATA",PP="systemimage://person.circle",IP="NOT_COMPATIBLE_BANNER",CP="UNSUPPORTED_CAPABILITIES",kP="UNSUPPORTED_WATCHOS_VERSION",OP="experimentLocale",EP="pageCustomId",RP="ProductPage.Section.ScreenshotsPreview.Title",DP="user",_P="reviewsContainer",LP="displayable-kind",MP="urlQuery",xP="editorsChoiceItem",$P="ratingCount",FP="APP_SUPPORT",NP="REVIEWS_MOST_HELPFUL",BP="REVIEWS_MOST_FAVORABLE",UP="REVIEWS_MOST_CRITICAL",GP="recent",jP="REVIEWS_MOST_RECENT",VP="reviewsPageActionFromReviewsData",HP="genreName",qP="BADGE_AGE_RATING_YEARS",WP="BADGE_AGE_RATING",zP="medicalDeviceInfo",YP="BADGE_PLAYERS_HEADING",JP="{maxPlayers}",KP="BADGE_NO_RATINGS_CAPTION",ZP="storefrontContentRating",QP="{subtitle}",XP="webBrowserFlowType",eI="marker",tI="accessibilityParagraph",nI="prefersReadableContentAlignedTitle",rI="VOICE_CONTROL",oI="AccessibilityDetails.Header.NoLearnMoreLink",iI="AccessibilityDetails.Header.NoLearnMoreLink.NoDeveloperName",sI="ProductPage.Accessibility.Header.NoSupportedFeatures.NoLearnMoreLink",aI="ProductPage.Accessibility.Header.NoReportedFeatures.NoLearnMoreLink",cI="gameCenterPlayerGameAchievementSummary",lI="ProductPage.Section.EditorsNotes.Title",uI="ProductPage.Section.FeaturedIn.Title",dI="largeGameCenterPlayer",fI="hasEula",hI="productMediaItem",pI="createTapToRateProductReviewAction",wI="ProductPage.RatingsAndReviews.Footer.LearnMore",gI="ProductPage.Section.MostRecentVersion.Title",vI="overview",mI="titledParagraph",yI="detail",AI="releaseNotes",TI="ProductPage.Section.Videos.Title",bI="textPair",SI="product-page-info-section",PI="deviceFamily",II="InfoList.AgeRating.LearnMore",CI="ageBand",kI="minAge",OI="maxAge",EI="{minAgeRating}",RI="{maxAgeRating}",DI="advisories",_I="seventeenPlus",LI="gracRegistrationNumber",MI="twelvePlus",xI="Seller",$I="isTrader",FI="adFailureReason",NI="Search.Facets.iPadAndIPhone",BI="Search.Facets.iPhoneOnly",UI="SEARCH_FACET_FREE",GI="SEARCH_FACET_",jI="filter[price]",VI="filter[genre]",HI="filter[ages]",qI="terms",WI="naturalLanguage",zI="results.contents",YI="timeSinceOnScreen",JI="recentSearches",KI="midScrollGuidedSearch",ZI="SEARCH_TRANSPARENCY_LINK",QI="rewrite",XI="EDITORIAL_SEARCH_RESULT_TYPE_DEVELOPER_TITLE_CASE",eC="whenInstalled",tC="mixed",nC="guidedLabel",rC="search-revisions",oC="singleColumnList",iC="@@chartPosition@@",sC="developerInfo",aC="divider",cC="scrollablePill",lC="displayType",uC="appMarkerType",dC="Acquisition",fC="InlineImage",hC="AppLockup",pC="InlineVideo",wC="quote",gC="Small",vC="Medium",mC="Large",yC="itunes.apple.com",AC="meta.personalizationData.optimizationId",TC="meta.personalizationData.optimizationEntityId",bC="meta.personalizationData.replaceIfAdPresent",SC="editorialBackground",PC="MC.ApSCFB01",IC="LCS.ApLCXW01",CC="editorialArtwork.storyCardStatic16x9",kC="UAS.ApXWC01",OC="com.apple.AppStore.Widgets.Today",EC="systemMedium",RC="DCEC.AppWS01",DC="MCGC.AppWS01",_C="MCGC.AppWL01",LC="PersonalizedRecommendations.Toggle.Title",MC="PersonalizedRecommendations.Toggle.Footer",xC="PERSONALIZATION_PURCHASES",$C="RECOMMENDATIONS",FC="engagement-data",NC="ArcadeOnboarding",BC="extend",UC="ALL_ARCADE_GAMES",GC="arcadeSubscribePage",jC="release",VC="nonnull",HC="token.pageInformation",qC="token.pageInformation.adPageInfo",WC="token.excludeAttribution",zC="isAppInstalled",YC="token.targetType",JC="token.metricsKind",KC="systemInformation",ZC="token.productVariantData",QC="token.inAppEventId",XC="Purchases",ek="gameCenterProfile",tk="OnDeviceRecommendationsPageController:handleShelf not implemented",nk="ProductData",rk="Product page preloading is disabled",ok="lookup",ik="app-bundle",sk="search-recommendation-sections",ak="trending-contents",ck="TodayData",lk="TodayForApps",uk="Arcade.DownloadPack.Suggestions.GetAllButtonTitle",dk="asString",fk="asNumber",hk="asBoolean",pk="asJSONValue",wk="catalog",gk="engagement",vk="view/see-all",mk="its_qt",yk="adId",Ak="prefix",Tk="username",bk="password",Sk="port",Pk="-caseInsensitive",Ik="signatureResumption",Ck="checkForLongUrl",kk="getPass",Ok="certId",Ek="hsb",Rk="metrics-identifiers",Dk="advp",_k="itsct",Lk="itscg",Mk="itcCt",xk="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/accountSummary",$k="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/redeemLandingPage",Fk="IPHONE_BRAND_NAME",Nk="IPAD_BRAND_NAME",Bk="APPLE_TV_BRAND_NAME",Uk="APPLE_WATCH_BRAND_NAME",Gk="MAC_BRAND_NAME",jk="SearchResultsPageIntent",Vk="AppEvent",Hk="ContingentOffer",qk="existing",Wk="bundle",zk="com.apple.visionproapp",Yk="editorial",Jk="InAppPurchaseLockup",Kk="MixedMediaLockup",Zk="PosterLockup",Qk="ProductPage",Xk="ScreenshotsLockup",eO="TrailersLockup",tO="arcadeTabNavBar",nO="textFollowsTintColor",rO="person.crop.square",oO="magnifyingglass",iO="list",sO="OfferStateAction",aO="TabChangeAction",cO="timer",lO="primaryTerm",uO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard",dO="isStandaloneWithCompanionForWatchOS",fO="isDeliveredInIOSAppForWatchOS",hO="isXROSCompatible",pO="free",wO="Mac",gO="systemimage://square.and.arrow.up",vO="results.data",mO="accountDetails",yO="createAccount",AO="sendGift",TO="addFunds",bO="Redeem",SO="cppAssetsMissing",PO="customers-also-bought-apps-download",IO="past",CO="module",kO="events-and-offers",OO="appPromotion",EO="trunk-app",RO="useTrunkArtwork",DO="editorialArtwork.brandLogo",_O="systemimage://questionmark.circle",LO="comingSoonApps",MO="marketingVideo",xO="supportsSharePlay",$O="filter[ageRating]",FO="filter[supportsGameController]",NO="filter[isMultiplayer]",BO="subscribe",UO="custom",GO="Arcade.Welcome.Family.Button.ExploreArcade",jO="breakoutTextAlignment",VO="left",HO="right",qO="black",WO="arcadeSubscribe",zO="hiddenPurchases",YO="isViewOnly",JO="action.kind",KO="action.url",ZO="Goto",QO="standalone-merchandised-in-apps",XO="see-all-contents",eE="requirementsByDeviceFamily",tE="licenses",nE="internetContentProviderInfo",rE="review-summary",oE="categorizations",iE="redownload",sE="future",aE="ageBandId",cE="customAttributes",lE="appShowcase",uE="placeholderBackground",dE="checksum",fE="circularArtwork",hE="ovalArtwork",pE="iphone_6_5",wE="iphone_d73",gE="iphone_d74",vE="editorialArtwork.splashFullScreen",mE="editorialArtwork.topShelf",yE="customVideoPreviewsByTypeForAd",AE="BreakoutLarge",TE="textColor3",bE="Alert.GenericError.Title",SE="Alert.GenericError.Message",PE="version",IE="decimalPad",CE="siri",kE="hasInAppPurchases",OE="systemGreen",EE="jpeg",RE="DEVELOPER_WATCH",DE="DEVELOPER_LATEST_RELEASE",_E="DEVELOPER_BUNDLES",LE="DEVELOPER_APPLE_ARCADE",ME="arcadeFooter",xE="ignoreITunesShortNotes",$E="editorialNotes.short",FE="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_VIEW",NE="collectionIcons",BE="shelf_page_header",UE="navigationBar",GE="TermsAndConditions.Title",jE="two",VE="CategoryGrouping",HE="ribbonBar",qE="onDevicePersonalization",WE="Genre",zE="collectionModule",YE="collectionLockup",JE="breakoutFullScreen",KE="Browse Categories",ZE="hasSeeAll",QE="designTag",XE="editorialStoryCard",eR="nonarcade",tR="isArcade",nR="date",rR="contentGraphicTrimmed",oR="insetAd",iR="Lockup.Heading.Arcade",sR="userRating.ratingCount",aR="userRating.value",cR="discounts",lR="inAppPurchaseInstall",uR="item.offer.buyParams",dR="offerId",fR="isVerifiedForAppleSiliconMac",hR="genreNames",pR="targetId",wR="data-metrics-impressions-low-latency",gR="media",vR="exit",mR="hasiAdData",yR="APPSTORE_SEARCH_RESULT_PAGE",AR="overridePageContext",TR="userId",bR="dsId",SR="refAppType",PR="widget",IR="iAdImpressionIndex",CR="iAdRotationCount",kR="metadata",OR="context",ER="BrowserChoice",RR="com.apple.AppStore.clipOverlay",DR="paymentTopicFromBag",_R="overlayClip",LR="offerReleaseDate",MR="buyInitiate",xR="See All",$R="searchOriginatingTerm",FR="recents",NR="undoSpellCorrection",BR="applySpellCorrection",UR="userTypedHint",GR="impressionOptions",jR="impressionParentId",VR="searchGhostHintPrefix",HR="searchGhostHintTermPhase",qR="searchGhostHintTerm",WR="input",zR="meta.metrics",YR="dsid",JR="@@durationCount@@",KR="@@postTrialPriceDuration@@",ZR="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",QR="arcade-preorder",XR="preorderedNotSubscribed",eD="confirmation",tD="preorderNotSubscribed",nD="OfferButton.IntroPrice.FreeTrial",rD="discountOwnedParent",oD="discountUnownedParent",iD="use_signals",sD="meta.personalizationData.grpId",aD="editorialItemGroup",cD="DATA_NOT_PROVIDED",lD="PRODUCT_PRIVACY_LEARN_MORE_LINK",uD="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",dD="privacyDetail",fD="privacyCard",hD="experimentId",pD="helpful",wD="mostHelpfulReviews",gD="wasReset",vD="ratingsDetails",mD="RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS",yD="supportUrl",AD="medicalDevice",TD="chartPositions",bD="highMotion",SD="{minPlayers}",PD="{releaseDate}",ID="value",CD="{count}",kD="deviceCompatibility",OD="Offer.Expanded.Title.ComingSoon",ED="externalVersionId",RD="supportsClickEventsOnSwiftUIHostingCell",DD="AccessibilityDetails.Title",_D="ProductPage.Section.Information.Title",LD="ProductPage.Section.Supports.Title",MD="safetyAndComplianceUrl",xD="darkOverlay",$D="productReviewAction",FD="ProductPage.Section.Reviews.MostHelpfulReviews.Title",ND="productRatingsAndReviewsComponent",BD="versionDisplay",UD="standardInformationShelf",GD="InfoList.AgeRating.Title",jD="Install.Size.String",VD="{fileSize}",HD="dataSetId",qD="SEARCH_FACET_ANY_PRICE",WD="SEARCH_FACET_ANY_CATEGORY",zD="SEARCH_FACET_RELEVANCE",YD="kinds",JD="macOSCompatibleIOSApps",KD="clusterId",ZD="landing:new-protocol",QD="lastNLSQueryDate",XD="top-apps",e_="showLabelInSearch",t_="guidedToken",n_="secondaryGenreShortDisplayNames",r_="SearchRevisions",o_="{searchTerm}",i_="no-results",s_="ads-result",a_="searchChartsAndCategories",c_="alternateLabel",l_="contentIds",u_="associations.app-events.data",d_="associations.app-events.attributes.forceAppEvent",f_="mediumAdLockupWithScreenshotsBackground",h_="adItem",p_="condensedAdLockupWithIconBackground",w_="displayTerm",g_="supportsGameController",v_="rankedSecondaryGenre",m_="onDeviceSearchHistory",y_="editorialLink",A_="upsellForNonacquisitionCanvas",T_="arcadeIcons",b_="AppMarker",S_="framedArtwork",P_="isAcquisition",I_="editorialArtwork.dayCard",C_="editorialArtwork.eventCard",k_="editorialArtwork.generalCard",O_="ignoreEditorialArt",E_="headerName",R_="headerBadge",D_="headerTagline",__="meta.associations.recommendations.data",L_="associations.recommendations.data",M_="todaySection",x_="systemLarge",$_="personalization-data",F_="ACCOUNT_SETTINGS",N_="upsellRecovery",B_="token.metricsPlatformDisplayStyle",U_="https",G_="channel-apps",j_="done",V_="chin",H_="Arcade.DownloadPack.Suggestions.PrimaryButtonTitle",q_="strict",W_="customIconArtwork",z_="ratings",Y_="suffix",J_="language",K_="OfferItem",Z_="com.apple.AppStore",Q_="arcadeProductPage",X_="UpdatesLockup",eL="askToBuy",tL="launchRepair",nL="editorialItemCanvas",rL="blue",oL="applewatch",iL="river",sL="Video",aL="FlowAction",cL="pageChange",lL="originalUrl",uL="updates",dL="checkForPreorders",fL="meta.discountOffer",hL="isIOSBinaryMacOSCompatible",pL="presentModal",wL="viewGenre",gL="CONTROLLER_OPTIONAL",vL="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",mL="SIRI_REMOTE_REQUIRED",yL="purchaseHistory",AL="familySharing",TL="manageSubscriptions",bL="push",SL="deepLink",PL="png",IL="close",CL="redemptionExpirationDate",kL="details",OL="systemBlue",EL="with",RL="personal-recommendations",DL="comingSoon",_L="wordmark",LL="external",ML="Action.OK",xL="messagesScreenshots",$L="supportsFunCamera",FL="supportURLForLanguage",NL="websiteUrl",BL="top-in-app-purchasables",UL="unlistedApps",GL="cabAdSupport",jL="merchandised-in-apps",VL="textColor1",HL="670",qL="roundPrerendered",WL="tvRect",zL="appleWatch_2021",YL="appleWatch_2018",JL="appleWatch",KL="iphone_5_8",ZL="editorialArtwork.bannerUber",QL="splashVideo4x3",XL="arcadeShowcase",eM="StoryMedium",tM="systemimage://exclamationmark.circle",nM="application/json",rM="prefersNonStandardBackButton",oM="textOnly",iM="subscriptionHero",sM="interactive",aM="pageHeader",cM="hasChevron",lM="textLightensOnHighlight",uM="hasSeparator",dM="TwoUp",fM="Asymmetrical",hM="cppData",pM="contingentItems",wM="prefersLargeTitleWhenRoot",gM="singleModule",vM="materialText",mM="arcadeDownloadPackCard",yM="displayCount",AM="editorialArtwork.mediaCard",TM="nonArcade",bM="locked",SM="friendingViaPush",PM="inAppPurchaseTiledLockup",IM="standardApp",CM="platformAttributes.ios.bundleId",kM="abExperiment",OM="editorialBadgeType",EM="editorialPriority",RM="isSubscription",DM="appExtVrsId",_M="parentId",LM="multiple-system-operators",MM="pageReferrer",xM="crossfireReferral",$M="advertDeviceWindow",FM="cardType",NM="iAdMetadata",BM="SearchFocus",UM="Focus",GM="position",jM="submit",VM="SoftwareBundle",HM="iAdAppStoreClientRequestId",qM="METADATA",WM="iAdMissedOpportunityReason",zM="iAdSlotInfo",YM="customProductPage",JM="prevPage",KM="platformDisplayStyle",ZM="application/x-www-form-urlencoded",QM="iAdDuplicateLayoutType",XM="hintsEntity",ex="idType",tx="update",nx="complete",rx="OfferButton.Title.Get",ox="{appName}",ix="notSubscribed",sx="OfferButton.IntroPrice.Trial",ax="meta.personalizationData.score",cx="PRODUCT_PRIVACY_TITLE",lx="privacyType",ux="systemimage://exclamationmark.triangle",dx="webBrowser",fx="install",hx="text/markdown",px="chartPosition",wx="BADGE_MFI_HEADING",gx="systemimage://person.crop.square",vx="MMM d, yyyy",mx="watchOS",yx="xrOS",Ax="prefersIndirectTouch",Tx="PRIVACY_POLICY",bx="ProductPage.Section.SafetyAndCompliance.Title",Sx="componentBackgroundStandout",Px="APP_STORE_EDITORS_NOTES",Ix="framedVideo",Cx="search-hints",kx="slp",Ox="searchResult",Ex="imageWithLabel",Rx="editorialArtwork.storyCenteredStatic16x9",Dx="header-contents",_x="materialGradient",Lx="fractionalWidth",Mx="de7bbd8e",xx="multiplex",$x="customers-also-bought-apps-with-download-intent",Fx="user-reviews",Nx="searchLanding:see-all",Bx="customArtwork",Ux="hash",Gx="dynamic",jx="apps-media-api-edge-host",Vx="guidedSearch",Hx="groupingLockup",qx="actionLinks",Wx="message",zx="productReview",Yx="multiApp",Jx="singleLockup",Kx="purchased",Zx="fields",Qx="requiresGameController",Xx="CONTROLLER_REQUIRED",e$="webView",t$="Account",n$="lockupArtwork",r$="startDate",o$="endDate",i$="badgeKind",s$="eventModule",a$="inAppEventId",c$="topic",l$="branch-app",u$="<b>",d$="</b>",f$="<br>",h$="winback",p$="Arcade.SeeAllGames.Button.Title",w$="buy",g$="breakoutCallToActionLabel",v$="target",m$="mixedMediaLockup",y$="personalizationTransparency",A$="editorial-elements",T$="alternate-apps",b$="related-editorial-items",S$="privacy",P$="accessibility",I$="supportedGameCenterFeatures",C$="privacyDetails",k$="round",O$="appleWatch_2022",E$="appleWatch_2024",R$="textColor2",D$="heic",_$="shortEditorialNotes",L$="largeHeroBreakout",M$="mediaPageHeader",x$="editorialNotes.callToAction",$$="ThreeUp",F$="largeImageLockup",N$="personalizationData",B$="systemimage://magnifyingglass",U$="categoryBrick",G$="Lockup.Footer.GamesApp",j$="searchLandingTrendingSection",V$="doNotFilter",H$="onDevicePersonalizationUseCase",q$="customDeepLink",W$="targetType",z$="tag",Y$="iAdImpressionId",J$="hints",K$="pageContext",Z$="refApp",Q$="hint",X$="impressionId",eF="NOAD",tF="ad_container",nF="extRefApp2",rF="extRefUrl2",oF="iAdSlotId",iF="offerType",sF="searchPrefix",aF="ARCADE_PREORDER_LOCKUP_COMING_SOON",cF="{price}",lF="checkmark",uF="trial",dF="miniTodayCard",fF="intermediateDetailPage",hF="{developerName}",pF="identifier",wF="ProductPage.ReviewSummary.Body.Title",gF="languages",vF="controller",mF="select",yF="allProductReviewActions",AF="productReviewsHeader",TF="LICENSE_AGREEMENT",bF="landing",SF="R8802",PF="genreShortDisplayName",IF="multirooms",CF="textLabel",kF="FullWidth",OF="work",EF="play",RF="develop",DF="app-distribution",_F="ArcadeData",LF="SearchData",MF="attributes",xF="many",$F="developer-other-apps",FF="boolean",NF="textLinksShelf",BF="arcadeComingSoon",UF="false",GF="four-screenshots",jF="appstore",VF="redeem",HF="gift",qF="meta.contingentItemOffer",WF="minimumWatchOSVersion",zF="price",YF="dynamicUI",JF="search-results",KF="search-landing",ZF="supportsStreamlinedBuy",QF="additionalTerms",XF="secondaryText",eN="toggle",tN="appTrailerLockup",nN="privacyPolicyUrl",rN="charts",oN="types",iN="ipod",sN="inAppPurchaseLockup",aN="pill",cN="unadorned",lN="multiplayer-activities",uN="splashVideo16x9",dN="splashVideo3x4",fN="screenshotsLockup",hN="EditorialLockupLargeVariant",pN="EditorialLockupMediumVariant",wN="Action.LearnMore",gN="mac-os-compatible-ios-apps",vN="system-apps",mN="xros-apps",yN="prefersOverlayedPageHeader",AN="largeBreakout",TN="canvas",bN="canonicalId",SN="layoutDirection",PN="AllGames",IN="placeholder",CN="rowCount",kN="mediumStoryCard",ON="mso",EN="com.apple.games",RN="links",DN="genres",_N="named",LN="cardDisplayStyle",MN="actionUrl",xN="impressionQueue",$N="eventVersion",FN="advertRotation",NN="impressionType",BN="softwareType",UN="PREORDER_NOTIFY_MESSAGE",GN="size",jN="NOT_COMPATIBLE_BANNER_TEMPLATE",VN="{linkTitle}",HN="systemimage://gamecontroller.fill",qN="rooms",WN="targetPlatform",zN="systemSmall",YN="navigation",JN="few",KN="appEvent",ZN="new",QN="appIcon",XN="GET",eB="code",tB="externalUrl",nB="categories",rB="ages",oB="share",iB="minPlayers",sB="maxPlayers",aB="customScreenshotsByTypeForAd",cB="productVideo",lB="EventDetails",uB="textColor4",dB="toast",fB="roundedRect",hB="singleSelection",pB="arcadeDownloadPackCategories",wB="pageMetrics",gB="sellerInfo",vB="accessibilityDetails",mB="largeLockup",yB="roundedRectPrerendered",AB="ipadPro",TB="ipad_10_5",bB="enrichedEditorialNotes",SB="EditorialLockupLarge",PB="EditorialLockupMedium",IB="isGameCenterEnabled",CB="imessage-apps",kB="lockupSmall",OB="editorial-shelves-collection:contents",EB="posterLockup",RB="editorial-elements:contents",DB="offerItems",_B="largeStoryCard",LB="listItem",MB="suggested",xB="arcadeApp",$B="ARCADE_ACTION_TITLE_EXPLORE",FB="EXPLORE",NB="extRefUrl",BB="refUrl",UB="iAdContainerId",GB="trending",jB="BADGE_MFI_SUPPORTED",VB="userRating",HB="arcadeProductPageInlineMessage",qB="productPageInlineMessage",WB="spacer",zB="rank",YB="iads",JB="Search Results",KB="coercedValue",ZB="appletv",QB="arcadeTabHeader",XB="disabled",eU="always",tU="menuItem",nU="location",rU="back",oU="LearnMore",iU="badge",sU="branch",aU="salables",cU="releaseDate",lU="comingSoonGrouping",uU="isCanvasAvailable",dU="versionHistory",fU="ipadPro_2018",hU="ipad_11",pU="expectedReleaseDate",wU="watch-apps",gU="atv-apps",vU="editorial-shelves-header",mU="primary-contents",yU="badge-content",AU="Horizontal",TU="lightOverArtwork",bU="mediumImageLockup",SU="editorial_id",PU="meta.personalizationData.appId",IU="achievement",CU="todayBrick",kU="medium",OU="undefined",EU="subscribed",RU="pageFields",DU="pageUrl",_U="contentRating",LU="hostApp",MU="pageDetails",xU="{title}",$U="NOT_COMPATIBLE_BANNER_LINK_TITLE",FU="compatibilityAnnotation",NU="ppid",BU="relationship",UU="allProductReviews",GU="tapToRateProductReviewAction",jU="writeAReviewProductReviewAction",VU="notPurchasedRatingsAndReviews",HU="purchasedRatingsAndReviews",qU="Any",WU="apps.apple.com",zU="apps-and-games",YU="eula",JU="host",KU="inAppPurchase",ZU="hero",QU="story",XU="NO_BADGE",eG="isFirstPartyHideableApp",tG="iap",nG="internal",rG="APPLOCKUP",oG="productArtwork",iG="recurringSubscriptionPeriod",sG="numOfPeriods",aG="@@count@@",cG="arcadeSeeAllGames",lG="Games",uG="upsellBreakout",dG="topCharts",fG="width",hG="POST",pG="mac-apps",wG="ios-apps",gG="brick",vG="showExpectedReleaseDate",mG="editorialNotes.badge",yG="editorialCopy",AG="href",TG="editorialBadgeInfo",bG="click",SG="iAdPlacementId",PG="iAdId",IG="SearchLanding",CG="userProductReviews",kG="discover",OG="customers-also-bought-apps",EG="bundleParents",RG="textCards",DG="isStandaloneForWatchOS",_G="chartHref",LG="description.standard",MG="annotation",xG="iad",$G="actionType",FG="contexts",NG="clear",BG="height",UG="previewFrame",GG="debug",jG="supportsArcade",VG="Hero",HG="one",qG="tvOS",WG="pageId",zG="actionDetails",YG="{osVersion}",JG="editorsChoiceProductReviews",KG="bundleChildren",ZG="term",QG="tvos",XG="tabs",ej="number",tj="dismiss",nj="priceFormatted",rj="offerName",oj="bgColor",ij="deviceFamilies",sj="prefersLargeTitle",aj="editorialClientParams",cj="heroCarousel",lj="facet",uj="query",dj="iAdTemplateType",fj="offers",hj="create",pj="detailPage",wj="rating",gj="Achievements",vj="notPurchasedLinks",mj="generic",yj="editorialItem",Aj="brandedSingleApp",Tj="finance",bj="remoteControllerRequirement",Sj="buyParams",Pj="transparent",Ij="upsellMarketingItem",Cj="metrics",kj="videoPreviewsByType",Oj="{learnMoreLink}",Ej="colored",Rj="tagline",Dj="editorial-item-groups",_j="renderPage",Lj="cancel",Mj="other",xj="inAppPurchases",$j="subscriptions",Fj="trailing",Nj="paragraph",Bj="todayCard",Uj="protocol",Gj="data",jj="latest-release-app",Vj="tile",Hj="productReviewsFooter",qj="category",Wj="presentModalFormSheet",zj="editorialElementKind",Yj="screenshotsByType",Jj="grouping",Kj="eventType",Zj="pageType",Qj="reviewSummary",Xj="linkableText",eV="SearchResults",tV="short",nV="appletvos",rV="flowPreview",oV="editorialNotes.name",iV="editorialNotes.tagline",sV="editorial-cards",aV="token",cV="genreDisplayName",lV="image",uV="purchasedLinks",dV="iOS",fV="object",hV="editorialNotes",pV="developers",wV="its_contentId",gV="pathname",vV="meta",mV="view",yV="No page routes specified",AV="searchLanding",TV="contingent-items",bV="text/x-apple-as3-nqml",SV="marketing-items",PV="color",IV="tags",CV="expectedReleaseDateDisplayFormat",kV="type",OV="gameCenter",EV="smallStoryCard",RV="completed",DV="card",_V="Software",LV="web",MV="groupings",xV="rgb",$V="Search",FV="adamId",NV="collections",BV="collection",UV="fractionalHeight",GV="text/plain",jV="macOS",VV="offer-items",HV="challenges",qV="open",WV="editorialQuote",zV="mostRecentVersion",YV="platform",JV="sort",KV="arcade-apps",ZV="preorder",QV="text",XV="realityDevice",eH="productPage",tH="preorderDisclaimer",nH="xros",rH="never",oH="children",iH="isAppleWatchSupported",sH="artistName",aH="requiredCapabilities",cH="ACTION_SEE_ALL",lH="osx",uH="recommendations",dH="absolute",fH="grid",hH="featuredIn",pH="account",wH="productPageYMALDuringDownload",gH="multiplayer",vH="impressions",mH="overlay",yH="product",AH="compatibilityControllerRequirement",TH="iconArtwork",bH="primary-content",SH="ignoredValue",PH="genre",IH="minimumOSVersion",CH="displayStyle",kH="macRequiredCapabilities",OH="card-contents",EH="productRatings",RH="subtitle",DH="kind",_H="defaultValue",LH="editorsChoice",MH="accessibilityDeveloperLink",xH="accessibilityHeader",$H="developer",FH="coercible",NH="leaderboards",BH="infer",UH="accessibilityFeatures",GH="moreByDeveloper",jH="privacyFooter",VH="videos",HH="hasMacIpaPackage",qH="Room",WH="small",zH="appEvents",YH="label",JH="in-apps",KH="productPageYMAL",ZH="searchTerm",QH="games",XH="editorial-pages",eq="action",tq="informationRibbon",nq="privacyTypes",rq="video",oq="mediumLockup",iq="similarItems",sq="messages",aq="chart",cq="privacyHeader",lq="searchResults",uq="white",dq="swoosh",fq="capabilities",hq="light",pq="true",wq="isPreorder",gq="friendsPlaying",vq="Arcade",mq="none",yq="bundleId",Aq="sequential",Tq="article",bq="search",Sq="its_id",Pq="large",Iq="smallLockup",Cq="description",kq="ios",Oq="editorialVideo",Eq="ageRating",Rq="center",Dq="ipad",_q="iphone",Lq="default",Mq="link",xq="information",$q="editorialArtwork",Fq="reviews",Nq="title",Bq="string",Uq="topLockup",Gq="dark",jq="header",Vq="inline",Hq="achievements",qq="unknown",Wq="url",zq="today",Yq="screenshots",Jq="app",Kq="pad",Zq="app-bundles",Qq="vision",Xq="editorial-items",eW="leading",tW="lockup",nW="phone",rW="static",oW="artwork",iW="app-events",sW="arcade",aW="standard",cW="watch",lW="mac",uW="contents",dW="apps",fW="name",hW="button",pW="navigate",wW="page",gW="$kind",vW="shelf"
Vv=e(8706),Hv=e(5542),qv=e(4172),Wv=e(2450)
const mW={}
class yW{static createSharedMetricsReferralContext(e){yW.shared||(yW.shared=new yW(e))}constructor(e){this.currentReferral=null,this.isMetricsReferralContextRequired=!0,this.isEventDetailClickEventOverrideNecessary=!e.host.isOSAtLeast(16,2,0)}get shouldUseJSReferralData(){return this.isMetricsReferralContextRequired&&i(this.currentReferral)}get activeReferralData(){return this.shouldUseJSReferralData&&null!==this.currentReferral&&this.currentReferral.isActive?this.currentReferral.data:null}setReferralDataForProduct(e,t){var n,o,i
if(!this.isMetricsReferralContextRequired||r(t))return
const s=null!==(n=f(t,Jq))&&void 0!==n?n:null,a=null!==(o=f(t,tB))&&void 0!==o?o:null,c=null!==(i=g(t,DH))&&void 0!==i?i:null
this.currentReferral={id:`${e}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,kind:c,refUrl:null},isActive:!1,productPageExtensionInfo:null}}setReferralDataForProductPageExtensionIfNecessary(e){var t,o
if(!this.isMetricsReferralContextRequired)return
const i=f(e,WG),s=f(e,Z$)
if(!AW.isProductPageExtension(e)||!AW.isValidPageEvent(e)||r(i)||r(s))return
const a=null!==(t=f(e,NB))&&void 0!==t?t:null,c=f(e,SR)
let l
switch(c){case gS:l=y(n(e,vS))
break
case PR:l=y(n(e,mS))
break
default:l={}}const u=null!==(o=f(e,BB))&&void 0!==o?o:null
this.currentReferral={id:`${i}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,refUrl:u,kind:{name:c,context:l}},isActive:!1,productPageExtensionInfo:{productId:i}},this.addReferralContextToMetricsFieldsIfNecessary(e)}beginReferralContextForPageIfNecessary(e){this.isMetricsReferralContextRequired&&AW.isValidPageEvent(e)&&AW.isReferralForEvent(this.currentReferral,e)&&null!==this.currentReferral&&(this.currentReferral.isActive=!0)}endReferralContextIfNecessaryForPageEvent(e){this.isMetricsReferralContextRequired&&AW.isValidPageEvent(e)&&AW.isReferralForEvent(this.currentReferral,e)&&(this.currentReferral=null)}addReferralContextToMetricsFieldsIfNecessary(e){var t
this.isMetricsReferralContextRequired&&(e[yW.referralContextEventField]=null===(t=this.currentReferral)||void 0===t?void 0:t.id)}removeReferralContextInfoFromMetricsEvent(e){this.isMetricsReferralContextRequired&&delete e[yW.referralContextEventField]}addReferralDataToEventIfNecessary(e){if(!r(this.activeReferralData)&&AW.shouldAddReferralDataToEvent(e)&&(!AW.isEventDetailsClickEvent(e)||this.isEventDetailClickEventOverrideNecessary)&&(AW.isEventDetailsClickEvent(e)&&(e[Zj]=lB),e[Z$]=this.activeReferralData.extRefApp2,e[NB]=this.activeReferralData.extRefUrl2,s(this.activeReferralData.refUrl)&&(e[BB]=this.activeReferralData.refUrl),null!==this.activeReferralData&&null!==this.activeReferralData.kind))switch(e[SR]=this.activeReferralData.kind.name,e[SR]){case gS:e[vS]=this.activeReferralData.kind.context
break
case PR:e[mS]=this.activeReferralData.kind.context}}}yW.referralContextEventField="referralContextId"
class AW{static isProductPageExtension(e){return f(e,Jq)===AW.productPageExtensionAppId}static isValidPageEvent(e){const t=f(e,Zj)
return!(0,Hv.isNothing)(t)&&AW.validPageEventTypes.has(t)}static isReferralForEvent(e,t){var n
if(r(e))return!1
const o=t[yW.referralContextEventField],s=f(t,WG)
return i(o)?o===e.id:!(!AW.isProductPageExtension(t)||!i(s))&&s===(null===(n=null==e?void 0:e.productPageExtensionInfo)||void 0===n?void 0:n.productId)}static shouldAddReferralDataToEvent(e){return e.eventType!==bG||this.isEventDetailsClickEvent(e)}static isEventDetailsClickEvent(e){if(e.eventType!==bG)return!1
const t=e.location,n=null==t?void 0:t[0]
return i(n)&&n.locationType===lB}}AW.productPageExtensionAppId=uy,AW.eventDetailsPageType=lB,AW.validPageEventTypes=new Set([_V,VM,AW.eventDetailsPageType]),zv=e(900)
class TW{constructor(e){this.$kind="ActionMetrics",this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}const bW={AdInteractionAction:"AdInteractionAction",AdTransparencyAction:"AdTransparencyAction",AlertAction:"AlertAction",AppLaunchTrampolineAction:"AppLaunchTrampolineAction",ArcadeAction:_y,ArcadeLaunchAttributionAction:"ArcadeLaunchAttributionAction",ArcadePackOfferAction:"ArcadePackOfferAction",ArcadeSeeAllGamesPageSegmentChangeAction:"ArcadeSeeAllGamesPageSegmentChangeAction",ArcadeSubscriptionStateAction:"ArcadeSubscriptionStateAction",BlankAction:"BlankAction",CancelPreorderAction:"CancelPreorderAction",ClearAppUsageDataAction:"ClearAppUsageDataAction",ClearSearchHistoryAction:"ClearSearchHistoryAction",CompoundAction:Ly,CopyTextAction:"CopyTextAction",CreateCalendarEventAction:"CreateCalendarEventAction",CrossfireReferralAction:"CrossfireReferralAction",EngagementToggleAction:"EngagementToggleAction",ExternalUrlAction:My,FamilyCircleAction:"FamilyCircleAction",FlowAction:aL,FlowBackAction:"FlowBackAction",GameCenterAchievementsAction:"GameCenterAchievementsAction",GameCenterDashboardAction:"GameCenterDashboardAction",GameCenterDenylistPlayerAction:"GameCenterDenylistPlayerAction",GameCenterInvitePlayerAction:"GameCenterInvitePlayerAction",GameCenterPlayerProfileAction:"GameCenterPlayerProfileAction",GSKWrappedAction:"GSKWrappedAction",GuidedSearchTokenToggleAction:"GuidedSearchTokenToggleAction",HttpAction:"HttpAction",HttpTemplateAction:"HttpTemplateAction",InAppPurchaseAction:"InAppPurchaseAction",InvalidateAllWidgetsAction:"InvalidateAllWidgetsAction",LegacyGameCenterInvitePlayerAction:"LegacyGameCenterInvitePlayerAction",OfferAction:xy,OfferAlertAction:$y,OfferConfirmationAction:Fy,OfferStateAction:sO,OpenAppAction:"OpenAppAction",OpenGamesUIAction:"OpenGamesUIAction",PageFacetsChangeAction:"PageFacetsChangeAction",PageTabChangeAction:"PageTabChangeAction",ProductPageScrollAction:Ny,RateLimitedAction:"RateLimitedAction",ReportConcernAction:"ReportConcernAction",ReviewSummaryReportConcernAction:"ReviewSummaryReportConcernAction",ScrollingAlertAction:"ScrollingAlertAction",SearchAction:"SearchAction",SearchAdAction:By,SearchEntityChangeAction:"SearchEntityChangeAction",SearchSegmentChangeAction:"SearchSegmentChangeAction",SelectAppAction:"SelectAppAction",ShareSheetAction:"ShareSheetAction",SheetAction:"SheetAction",ShelfBasedPageScrollAction:Uy,ShowSettingsAction:"ShowSettingsAction",TabBadgeAction:"TabBadgeAction",TabChangeAction:aO,WriteReviewAction:"WriteReviewAction"},{FlowAction:SW,...PW}=bW,IW={...PW,flowAction:Gy}
class CW{constructor(){this.title=void 0,this.artwork=void 0,this.presentationStyle=[],this.actionMetrics=new TW}}class kW extends CW{constructor(){super(...arguments),this.$kind="BlankAction",this.actionClass="BlankAction"}}const OW="x-as3-internal",EW=U_,RW="itms-appss",DW="itms-apps",_W=cy,LW=ly,MW="appstore-ui",xW={shelf:vW,store:"WebObjects/MZStore.woa/wa",storeElements:"WebObjects/MZStoreElements.woa/wa",lookup:ok,docTypeLookup:"docTypeLookup",install:fx,grouping:"viewGrouping",viewArtist:"viewArtist",viewSoftware:"viewSoftware",today:zq,arcade:sW,arcadeUpsellPreview:"arcadeUpsellPreview",arcadeSeeAllGames:cG,arcadeSeeAllGamesLoadMore:"arcadeSeeAllGamesLoadMore",genre:PH,viewGenre:wL,recommendationsSeeAll:"recommendationsSeeAll",screenshots:Yq,room:"viewRoom",multiRoom:"viewMultiRoom",charts:rN,product:Jq,game:"game",siri:CE,productBundle:ik,developer:$H,artist:WS,ratings:z_,reviews:Fq,viewReviews:"viewContentsUserReviews",personalizedReviews:"personalizedReviews",article:Tq,story:QU,editorialItem:yj,viewEditorialItem:oT,todayCardPreview:"todayCardPreview",mso:ON,resetAndRedirect:"resetAndRedirect",account:pH,personalizationTransparency:y$,href:AG,eula:YU,tvEula:"tv-eula",privacyPolicy:yP,safetyCompliance:"safety-compliance",appsForYou:"apps-for-you",storeFront:"storeFront",tab:"tab",searchLandingPage:"searchLandingPage",searchTrendingApps:"searchTrendingApps",privacyDetail:dD,privacyDefinitions:TP,reportAProblem:"reportaproblem.apple.com/store",gameCenterProfile:ek,onDeviceRecommendations:"onDeviceRecommendations",editorialPage:"editorialPage",accessibilityDetails:vB,test:tP,shelfTypes:"shelfTypes",groupingTest:Jj,builtIn:"builtIn",shelfTextTest:"shelfText",shelfLockupsTest:"shelfLockups",shelfMiscTest:"shelfMisc",lockupTest:"lockupTest",articleTestArtwork:"articleArtworkTest",articleTestSingleAppIcon:"articleSingleAppIconTest",articleTestSingleAppIconHeroArt:"articleSingleAppIconHeroArtTest",articleTestBrandedApp:"articleBrandedAppTest",articleTestMultiAppTwo:"articleMultiAppTwoTest",articleTestMultiAppThree:"articleMultiAppThreeTest",articleTestGrid:"articleGridTest",articleTestInAppPurchase:"articleInAppPurchaseTest"},$W="storepreview.apple.com",FW=yH,NW=GC,BW=cG,UW="familyCircle",GW="spamBlockingExtensions",jW=KT,VW="launchApp",HW="sharePlayApps",qW="buddyOnboarding",WW=new Set([$W,"preview.apps.apple.com"]),zW={id:"id",ids:"ids",productVariantID:NU,countryCode:"cc",language:"l",featuredContentId:"fcId",fetchData:"fetchData",isTodaySection:"isTodaySection",isTodayFeedPreview:"isTodayFeedPreview",genre:PH,bundleIdentifier:"bundleIdentifier",bundleId:yq,offerName:rj,charts:rN,ages:rB,chart:aq,types:oN,v0:"v0",action:eq,type:kV,context:OR,isArcade:tR,isSubscribed:"isSubscribed",isTrialAvailable:"isTrialAvailable",isTrialEnrolled:"isTrialEnrolled",groupingFeaturedContentId:"groupingFeaturedContentId",editorialPageShelfType:"editorialPageShelfType",nativeGroupingShelfId:"nativeGroupingShelfId",isArcadeSeeAllGamesShelf:"isArcadeSeeAllGamesShelf",isGameCenterActivityFeedShelf:"isGameCenterActivityFeedShelf",isGameCenterPlayerShelf:"isGameCenterPlayerShelf",isGameCenterPlayerRibbonItem:"isGameCenterPlayerRibbonItem",isGameCenterAchievementsShelf:"isGameCenterAchievementsShelf",isGameCenterContinuePlayingShelf:"isGameCenterContinuePlayingShelf",isGameCenterPopularWithYourFriendsShelf:"isGameCenterPopularWithYourFriendsShelf",isGameCenterSuggestedFriendsShelf:"isGameCenterSuggestedFriendsShelf",isGameCenterReengagementShelf:"isGameCenterReengagementShelf",isOnDeviceRecommendationsShelf:"isOnDeviceRecommendationsShelf",isOnDeviceSearchHistoryShelf:"isOnDeviceSearchHistoryShelf",isSearchFocusHeaderShelf:"isSearchFocusHeaderShelf",isArcadeDownloadPackShelfPlaceholder:"isArcadeDownloadPackShelfPlaceholder",onDeviceRecommendationsUseCase:"onDeviceRecommendationsUseCase",onDevicePersonalizationUseCase:H$,isPurchasesApp:"isPurchasesApp",isViewOnly:YO,includeUnlistedApps:"includeUnlistedApps",enabled:xT,href:AG,recoMetrics:"recoMetrics",showingFallbackMedia:"showingFallbackMedia",path:"path",useReleaseId:"useReleaseId",clientIdentifierOverride:cS,subscribePageMessage:Wx,editorialItem:yj,askToBuyId:"askToBuyId",appId:"appId",isPPT:"isPPT",sort:JV,grouping:Jj,code:eB,includePostSubscribeAttribution:"includePostSubscribeAttribution",campaignToken:"ct",providerToken:"pt",qToken:mk,advertisementId:yk,token:aV,parseContext:"parseContext",privacyTypeId:"privacyTypeId",requestDescriptor:"requestDescriptor",ageRating:Eq,controllerSupport:_A,multiplayerSupport:"multiplayerSupport",comingSoon:DL,binCompatGames:"binCompatGames",gamePreviews:"gamePreviews",offerHints:"offerHints",invalidateWidgetsOnFailure:VA,metrics:Cj,appEventId:"eventid",offerItemId:"offerItemId",appEventDeepLink:SL,useCaseShort:"uc",collectionId:"collection-id",seedId:"seed-id",isShelfWithAd:"isShelfWithAd",shelfWithAdPlacementType:"shelfWithAdPlacementType",shelfRefreshType:"refreshType",isPreloading:"isPreloading",name:fW,shelfType:"shelfType",shelfId:"shelfId",onbaordingCardIds:"onboardingCardIds",preview:iT,todayCardConfig:"todayCardConfig",experimentId:hD,shortEditorialNotes:_$,arcadeSubscriptionStatus:"subscriptionStatus",webBrowser:dx,webBrowserFlowType:XP,editorialPageId:"editorialPageId",editorialCardId:"filter[canvas:cardId]",filterRecommendable:"filter[recommendable]",deviceFamily:PI},YW="inAppPurchaseId",JW="productUrl",KW=RM,ZW="minExternalVersionId",QW=FV,XW=JV,ez="availableAdamIds",tz=Jq,nz=Fq,rz="productPageSimilarItems",oz=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,iz=/([^=?&]+)=?([^&]*)/g,sz=[Ux,uj,gV,JU]
class az{constructor(e){if(this.query={},!e)return
let t=e
const n=oz.exec(e)
if(n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:void 0}
for(const e of sz){if(!r.remainder)break
switch(e){case Ux:r=b(r.remainder,"#",Y_),this.hash=r.result
break
case uj:r=b(r.remainder,"?",Y_),r.result&&(this.query=az.queryFromString(r.result))
break
case gV:r=b(r.remainder,"/",Y_),r.result&&(this.pathname="/"+r.result)
break
case JU:if(r.remainder){const e=b(r.remainder,"@",Ak),t=e.result,n=e.remainder
if(t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this
switch(e===uj&&typeof t===Bq&&(t=az.queryFromString(t)),e){case Uj:this.protocol=t
break
case Tk:this.username=t
break
case bk:this.password=t
break
case Sk:this.port=t
break
case gV:this.pathname=t
break
case uj:this.query=t
break
case Ux:this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case Uj:return this.protocol
case Tk:return this.username
case bk:return this.password
case Sk:return this.port
case gV:return this.pathname
case uj:return this.query
case Ux:return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if(e===uj)typeof t===Bq&&(t=az.queryFromString(t)),r=typeof n===Bq?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if(e===gV){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(gV,e)}pathExtension(){var e
if((0,Wv.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}popPathComponent(){if(!this.pathname)return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),this.query&&Object.keys(this.query).length&&(e+="?"+az.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=iz.exec(e)
for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=iz.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new az(e)}static fromComponents(e,t,n,r,o){const i=new az
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}const cz=[EW,DW,RW,"itms-messages","itms-messagess","itms-watch","itms-watchs","macappstore","macappstores","com.apple.tvappstore",_W,LW]
class lz{constructor(e){var t
this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={}
return e.forEach((e,n)=>{C(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[]
if(!e)return t
for(const n of e){const e=n.split("=")
let r=e[0]
const o=-1!==r.indexOf("?")
r=r.replace("?","")
const i=-1!==r.indexOf(Pk)
r=r.replace(Pk,"")
let s=null
e.length>1&&(s=decodeURIComponent(e[1])),t.push({key:r,value:s,optional:o,caseInsensitive:i})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map(function(e){return new lz(e)}):this._exclusions=null}matches(e){var t,n
if(this._regex){if(!this._regex.length)return!1
let t=!1
for(const n of this._regex)if(n.test(e.toString())){t=!0
break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1
if(this._hostName&&e.host!==this._hostName)return!1
if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents()
if(t.length!==n.length)return!1
const r=t.length
for(let e=0;e<r;e++){const r=t[e]
if(!C(r)&&r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1
if(this._query)for(const r of this._query){let o
if(r.caseInsensitive)for(const[n,i]of Object.entries(null!==(t=e.query)&&void 0!==t?t:{}))r.key.toLocaleLowerCase()===n.toLocaleLowerCase()&&(o=i)
else o=null===(n=e.query)||void 0===n?void 0:n[r.key]
if(!o&&!r.optional)return!1
if(r.value&&r.value!==o)return!1}if(this._hash&&e.hash!==this._hash)return!1
if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?")
if(t.matches(e))return!1}return!0}extractParameters(e){var t,n
const r={}
if(null!==this._pathComponents&&null!==this._pathParameterMap){const t=e.pathComponents()
for(const e of Object.keys(this._pathParameterMap)){const n=k(e),o=O(t[this._pathParameterMap[e]],e)
r[n]=decodeURIComponent(o)}}if(this._query)for(const o of this._query)r[o.key]=null!==(n=null===(t=e.query)||void 0===t?void 0:t[o.key])&&void 0!==n?n:void 0
return r}}class uz{constructor(){this._routeMappings=[]}associate(e,t){const n=[]
for(const t of e)n.push(new lz(t))
this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===Bq?new az(e):e
t=function(e){let t=typeof e===Bq?new az(e):e
if(!I(t))return t
const n=t.query,r=null==n?void 0:n[Wq]
return(!t.host||0===t.host.length)&&null!=r&&(t=new az(r),(null==n?void 0:n[YR])&&(t=t.append(uj,{dsid:n[YR]})),(null==n?void 0:n[Ik])&&(t=t.append(uj,{signatureResumption:n[Ik]}))),az.fromComponents(EW,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){var t,n,r
const o=typeof e===Bq?new az(e):e
if(!I(o))return o
const i=o.build()
let s,a=(0,Wv.isNothing)(o.query)?void 0:S(o.query)
const c={},l=[{key:"MZSearch.woa",action:bq},{key:bq,action:bq},{key:"buyLandingPage",action:HF},{key:"buyCharityGiftWizard",action:Wy},{key:"longUrlHandler",action:Ck},{key:dL,action:dL}],u={"accessory-lookup":"accessoryLookup","finance-app":pH,viewEula:YU,software:dW,primaryTerm:bq}
let d=!1
for(const e of Object.keys(c))if(o.host&&-1!==o.host.indexOf(e)){d=!0,s=c[e]
break}let f=!1
for(const e of l){const t=e.key
if(o.pathname&&-1!==o.pathComponents().indexOf(t)){f=!0,s=e.action,void 0!==(null==a?void 0:a[t])&&delete a[t]
break}}for(const e of Object.keys(u)){const r=void 0!==(null===(t=o.query)||void 0===t?void 0:t[e])&&null!==o.query[e],i=(null===(n=o.query)||void 0===n?void 0:n[eq])&&-1!==o.query[eq].indexOf(e)
if(r||i){s=u[e],void 0!==(null==a?void 0:a[e])&&delete a[e]
break}}if(s===pH&&-1!==i.indexOf(kk)&&(s="addToPassbook",void 0!==a&&delete a[kk]),s){const e=null,t=null,n={action:s}
s===VF&&void 0!==a&&(a[eB]||a[Ok])?n[eB]=a[eB]||a[Ok]:s!==pH&&s!==dL&&s!==Ck||!f&&!d||(n[lL]=o.toString())
const i=null===(r=o.query)||void 0===r?void 0:r[lO]
return s===bq&&void 0!==i&&void 0!==a&&(a[lO]=i),a={...a,...n},az.fromComponents(o.protocol,t,e,a,o.hash)}return o}(t)
for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier}
return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}const dz=Symbol("PromiseResult")
class fz extends Error{constructor(e){super(function(e){return e.map(e=>e instanceof Error?e.message:JSON.stringify(e)).join("")}(e)),this.reasons=e,this.reasons=e}}class hz extends Error{constructor(e){super(e.message),this.reason=e,this.reason=e}}Yv=e(4876)
class pz{constructor(e,t,n,r,o,i){this.$kind="Artwork",this.checksum=null,this.backgroundColor=null,this.textColor=null,this.style=null,this.crop="bb",this.contentMode=null,this.imageScale=null,this.template=e,this.width=t,this.height=n,this.variants=r,this.backgroundColor=o,this.textColor=i}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return""!==this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class wz{constructor(e){this.$kind="ImpressionableArtwork",this.art=e}}!function(e){e.Density1="density_1",e.Density2="density_2",e.Density3="density_3"}(Jv||(Jv={})),function(e){e[e.scaleToFill=0]="scaleToFill",e[e.scaleAspectFit=1]="scaleAspectFit",e[e.scaleAspectFill=2]="scaleAspectFill",e[e.redraw=3]="redraw",e[e.center=4]="center",e[e.top=5]="top",e[e.bottom=6]="bottom",e[e.left=7]="left",e[e.right=8]="right",e[e.topLeft=9]="topLeft",e[e.topRight=10]="topRight",e[e.bottomLeft=11]="bottomLeft",e[e.bottomRight=12]="bottomRight"}(Kv||(Kv={}))
class gz{constructor(e,t,n,r,o,i,s){this.$kind="MediaPlatform",this.appPlatform=e,this.supplementaryAppPlatforms=r||[],this.deviceCornerRadiusFactor=o,this.mediaType=t,this.systemImageName=n,this.deviceBorderThickness=i,this.outerDeviceCornerRadiusFactor=s}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort()
const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",")
return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&e.systemImageName===this.systemImageName&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class vz{constructor(e,t){this.$kind="Trailers",e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0}}class mz{constructor(e,t,n){this.$kind="Video",this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class yz{constructor(){this.$kind="ProductMediaItem"}}class Az{constructor(e,t,n,r,o,i){this.$kind="ProductMedia",this.items=e,this.mediaPlatform=t,this.allPlatforms=n,this.platformDescription=r,this.allPlatformsDescription=o,this.allPlatformsDescriptionPlacement=i}}class Tz{constructor(e,t){this.$kind="Screenshots",this.artwork=e,this.mediaPlatform=t}}class bz{constructor(e,t,n,r){this.fileSizeByDevice=e,this.maxDownloadSizeInBytes=t,this.maxInstallSizeInBytes=n,this.maxEssentialInstallSizeInBytes=r}}class Sz{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new Sz(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}const Pz=Z_,Iz="com.apple.AppStore.BridgeStoreExtension",Cz=ay,kz=cy,Oz=ly,Ez="com.apple.TVAppStore.AppStoreTopShelfExtension",Rz="com.apple.Arcade.ArcadeTopShelfExtension",Dz=uy,_z=dy,Lz="com.apple.AppStore.Widgets",Mz=zk,xz="VisionAppStore",$z=(0,zv.makeMetatype)("app-store:storeMetrics"),Fz=(0,zv.makeMetatype)("app-store:amsEngagement"),Nz=(0,zv.makeMetatype)("app-store:device"),Bz=(0,zv.makeMetatype)("app-store:user"),Uz=(0,zv.makeMetatype)("games:player"),Gz=(0,zv.makeMetatype)("app-store:metricsIdentifiers"),jz=(0,zv.makeMetatype)("app-store:arcade"),Vz=(0,zv.makeMetatype)("app-store:gameCenter"),Hz=(0,zv.makeMetatype)("app-store:resilientDeepLinks"),qz=(0,zv.makeMetatype)("app-store:ads"),Wz=(0,zv.makeMetatype)("app-store:onDeviceRecommendationsManager"),zz=(0,zv.makeMetatype)("app-store:onDeviceSearchHistoryManager"),Yz=(0,zv.makeMetatype)("app-store:mediaTokenService"),Jz=(0,zv.makeMetatype)("app-store:adsLocalizer"),Kz=(0,zv.makeMetatype)("app-store:appDistribution"),Zz=(0,zv.makeMetatype)("app-store:timeoutManager"),Qz=(0,zv.makeMetatype)("app-store:treatmentStore"),Xz=(0,zv.makeMetatype)("app-store:userDefaults"),eY="_jet-internal:derived-data",tY={artwork:Bx,iconArtwork:W_,screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:aB,customVideoPreviewsByTypeForAd:yE,customDeepLink:q$}
class nY{constructor(e){this.implementation=e}}class rY{constructor(){this.clearCache=()=>{this.cache={}},this.cache={}}get(e,t){return t()}}const oY=Pz,iY=Iz,sY=Cz,aY=Oz,cY=kz,lY=Dz
class uY extends nY{get buildType(){return uY.cache.get("buildType",()=>this.implementation.buildType)}get buildVersion(){return this.implementation.buildVersion}get deviceType(){return uY.cache.get("deviceType",()=>this.implementation.deviceType)}get guid(){return this.implementation.guid}get isActivityAvailable(){return this.implementation.isActivityAvailable}get isElectrocardiogramInstallationAllowed(){return this.implementation.isElectrocardiogramInstallationAllowed}get isScandiumInstallationAllowed(){return this.implementation.isScandiumInstallationAllowed}get isSidepackingEnabled(){return this.implementation.isSidepackingEnabled}get isTinkerWatch(){return uY.cache.get("isTinkerWatch",()=>this.implementation.isTinkerWatch)}get screenCornerRadius(){return uY.cache.get("screenCornerRadius",()=>this.implementation.screenCornerRadius)}get screenSize(){return uY.cache.get("screenSize",()=>Sz.fromNativeSize(this.implementation.screenSize))}get storefrontIdentifier(){return this.implementation.storefrontIdentifier}get supportsHEIF(){return uY.cache.get("supportsHEIF",()=>this.implementation.supportsHEIF)}get thinnedApplicationVariantIdentifier(){return uY.cache.get("thinnedApplicationVariantIdentifier",()=>this.implementation.thinnedApplicationVariantIdentifier)}get isMandrakeSupported(){return this.implementation.isMandrakeSupported}get isCharonSupported(){return this.implementation.isCharonSupported}get maxAppContentRating(){return this.implementation.maxAppContentRating}get hostBundleId(){return uY.cache.get("hostBundleId",()=>this.implementation.hostBundleId)}isPairedSystemVersionAtLeast(e){var t,n,r
return null!==(r=null===(n=(t=this.implementation).isPairedSystemVersionAtLeast)||void 0===n?void 0:n.call(t,e))&&void 0!==r&&r}deletableSystemAppCanBeInstalledOnWatchWithBundleID(e){return this.implementation.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}deviceHasCapabilities(e){return this.implementation.deviceHasCapabilities(e)}deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t){return(!this.isPad||!e.includes("healthkit"))&&this.implementation.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t)}hasEligibilityDomain(e){return this.implementation.hasEligibilityDomain(e)}contextForEligibilityDomain(e){return this.implementation.contextForEligibilityDomain(e)}isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n){return this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}canDevicePerformAppActionWithAppCapabilities(e,t){return this.implementation.canDevicePerformAppActionWithAppCapabilities(e,t)}isAutomaticDownloadingEnabled(){return this.implementation.isAutomaticDownloadingEnabled()}isAuthorizedForUserNotifications(){return this.implementation.isAuthorizedForUserNotifications()}isActivePairedWatchSystemVersionBelow(e){const t=e.split("."),n=h(t[0])||0,r=h(t[1])||0,o=h(t[2])||0
return!this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(n,r,o)}get isPhone(){return this.deviceType===nW}get isPad(){return this.deviceType===Kq}get isiOS(){return this.isPhone||this.isPad}get isMac(){return this.deviceType===lW}get isTV(){return"tv"===this.deviceType}get isWatch(){return this.deviceType===cW}get isVision(){return this.deviceType===Qq}get isWeb(){return this.deviceType===LV}get isCompanionVisionApp(){return this.hostBundleId===zk}get remoteDownloadIdentifiers(){return this.implementation.remoteDownloadIdentifiers}}uY.type=(0,zv.makeMetatype)("app-store:client-wrapper"),uY.cache=new rY
class dY{constructor(e,t,n,r){var i
this.contentsResourceTypes=new Set,this.ids=new Set,this.idsByResourceType=new Map,this.originalOrdering=[],this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.supplementaryMetadataAssociations=[],this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.countryCodeOverride=void 0,this.objectGraph=e,this.platform=K(e),this.isMixedMediaRequest=null!=n&&n,this.supplementaryMetadataAssociations=null!=r?r:[],this.includeAppBinaryTraitsAttribute=!0,(null===(i=e.activeIntent)||void 0===i?void 0:i.platform)&&(this.platform=e.activeIntent.platform),o(t)||(typeof t===Bq?this.href=t:Array.isArray(t)&&this.withDataItems(t,r,n))}addDataToIDsByResourceType(e){const t=e.type,n=e.id
let r=this.idsByResourceType.get(t);(0,Wv.isNothing)(r)&&(r=new Set),r.add(n),this.idsByResourceType.set(t,r)}forType(e){return this.resourceType=e,this}withDataItems(e,t,n){if(0===e.length)return this
this.isMixedMediaRequest=this.isMixedMediaRequest||null!=n&&n
for(const r of e)if(this.ids.add(r.id),this.addDataToIDsByResourceType(r),(0,Wv.isSome)(n)&&n&&(0,Wv.isSome)(t)&&t.length>0)for(const e of t){const t=re(e,r);(0,Wv.isSome)(t)&&t.length>0&&t.forEach(e=>{this.addDataToIDsByResourceType(e)})}return 1===this.idsByResourceType.size?(this.resourceType=this.idsByResourceType.keys().next().value,this.isMixedMediaRequest=!1):this.idsByResourceType.size>1&&!this.isMixedMediaRequest&&(this.resourceType=uW,this.contentsResourceTypes=new Set(Array.from(this.idsByResourceType.keys()))),this.originalOrdering.push(...e),this}withIdOfType(e,t){return this.withDataItems([{id:e,type:t}])}withIdsOfType(e,t){return this.withDataItems(e.map(e=>({id:e,type:t})))}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingViews(e){this.viewsIncludes||(this.viewsIncludes=new Set)
for(const t of e)this.viewsIncludes.add(t)
return this}includingKindsKeys(e,t){this.kindIncludes||(this.kindIncludes=new Map)
let n=this.kindIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.kindIncludes.set(e,n),this}includingAssociateKeys(e,t){this.associateIncludes||(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t=SV
if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get(Xq)
e||(e=new Set),e.add(t),this.scopedRelationshipIncludes.set(Xq,e)}else this.relationshipIncludes.add(t)
{this.metaIncludes||(this.metaIncludes=new Map)
let e=this.metaIncludes.get(SV)
e||(e=new Set),e.add(Cj),this.metaIncludes.set(SV,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAgeRestrictions(){const e=this.objectGraph.client.maxAppContentRating
return e<1e3&&(this.ageRestriction=e),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){this.scopedAvailableInIncludes||(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return this.scopedSparseLimit||(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return(0,Wv.isSome)(t)?this.additionalQuery[e]=t:delete this.addingQuery[e],this}addingQueryValues(e){return this.additionalQuery={...this.addingQuery,...e},this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return this.objectGraph.appleSilicon.isSupportEnabled&&(e||this.enablingFeature(JD),this.includingScopedAttributes(dW,[fR])),this}includingAppBinaryTraitsAttribute(e=!0){return this.includeAppBinaryTraitsAttribute=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!i(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}withCountryCodeOverride(e){return this.countryCodeOverride=e,this}}const fY=(e,t)=>e||t,hY=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])?"),pY=Ae(0,0,0),wY=Ae(1,1,1),gY="FBEF7E28-E3DF-4484-A7D7-2FE19E43D2B8",vY="21FD31A2-0631-4100-9942-D368B43F00C5",mY="9C29E652-9774-4219-9BEB-9414597AD175",yY="4198D0D5-B34F-4EA5-B3C6-99C90C7732B8";(ey=Zv||(Zv={})).ArcadeDownloadPackOnboarding="Tf5Kjqz",ey.CondensedTodayAds="tBc9hUt",ey.ProductPagePreloading="m0henFo",ey.ProductPageVariants="fNPb5Km",ey.ProductPageYMALRowCount="isj11bm",ey.SearchLandingPage="WqjkRLH",ey.SearchResultsAdBackground="Zh4zkDd"
class AY{constructor(){this.cachedTreatments={},this.cachedRawTreatments={}}async loadTreatments(e){const t=this.experimentAreasForPlatform(e)
if(t.length>0)try{this.cachedRawTreatments=await e.treatmentStore.treatmentsForAreas(t)
for(const[e,t]of Object.entries(this.cachedRawTreatments)){const n=t.identifier
this.cachedTreatments[e]={...t,identifier:n.split(":")[0]}}}catch(t){e.console.error("Failed to load treatments",t)}}currentTreatmentForExperiment(e){return this.cachedTreatments[e]}createAb2Data(){const e=[]
for(const[t,n]of Object.entries(this.cachedRawTreatments))e.push({areaId:t,bucket:-2,treatmentId:n.identifier})
return e}experimentAreasForPlatform(e){const t=[]
switch(e.client.deviceType){case nW:case Kq:t.push(Zv.ArcadeDownloadPackOnboarding,Zv.CondensedTodayAds,Zv.ProductPagePreloading,Zv.ProductPageVariants,Zv.ProductPageYMALRowCount,Zv.SearchLandingPage,Zv.SearchResultsAdBackground)}return t}}AY.metatype=(0,zv.makeMetatype)("app-store:experimentCache")
const TY="3NepyQj01",bY=Lq
let SY=null
!function(e){e[e.None=0]="None",e[e.ThirtyTwoBit=2]="ThirtyTwoBit",e[e.UnsupportedSystemDeletableApps=4]="UnsupportedSystemDeletableApps",e[e.UnsupportedWatchAppOnWatchClient=8]="UnsupportedWatchAppOnWatchClient",e[e.DisabledMerchandisableIAPs=16]="DisabledMerchandisableIAPs",e[e.LegacyApps=32]="LegacyApps",e[e.LegacyProductionMacOSInstaller=64]="LegacyProductionMacOSInstaller",e[e.UnsupportedPlatform=128]="UnsupportedPlatform",e[e.UnsupportedPreorders=256]="UnsupportedPreorders",e[e.MinimumOSRequirement=512]="MinimumOSRequirement",e[e.SADWatchApps=1024]="SADWatchApps",e[e.MinimumCompanionOSRequirement=2048]="MinimumCompanionOSRequirement",e[e.MacOSCompatibleIOSBinary=4096]="MacOSCompatibleIOSBinary",e[e.MacOSRosetta=8192]="MacOSRosetta",e[e.UnsupportedPlatformForMacCharts=16384]="UnsupportedPlatformForMacCharts",e[e.VisionOSCompatibility=32768]="VisionOSCompatibility",e[e.SADMinimumOSRequirement=65536]="SADMinimumOSRequirement",e[e.DeveloperPage=76532]="DeveloperPage",e[e.Offers=77238]="Offers",e[e.TodayCard=76670]="TodayCard",e[e.Search=10750]="Search",e[e.Bundles=76286]="Bundles",e[e.Charts=68606]="Charts",e[e.ChartsMac=84862]="ChartsMac",e[e.All=80894]="All"}(Qv||(Qv={}))
const PY=[_q,Dq,lW,Qq,cW,"tv"]
class IY{constructor(){this.$kind="LockupContextMenuData"}}const CY={Lockup:gy,InAppPurchaseLockup:Jk,MixedMediaLockup:Kk,PosterLockup:Zk,ProductPage:Qk,ScreenshotsLockup:Xk,TrailersLockup:eO,UpdatesLockup:X_}
class kY{constructor(e){this.$kind=null!=e?e:gy}isValid(){return!!this.title&&!(!this.icon||!this.icon.isValid())}}class OY extends kY{constructor(){super(Jk)}}class EY extends CW{constructor(e,t){super(),this.$kind="flowAction",this.actionClass="FlowAction",this.page=e,this.pageUrl=t,this.pageData=null,this.referrerData=void 0,this.presentationContext=BH,this.animationBehavior=BH,this.origin="inapp"}}class RY{constructor(){this.$kind="PageMetrics",this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n={data:e,invocationPoints:t}
this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class DY{constructor(){this.$kind="InAppPurchaseInstallPage",this.pageMetrics=new RY,this.pageRenderMetrics={}}}class _Y extends CW{constructor(e,t,n,r,o){super(),this.$kind="InAppPurchaseAction",this.actionClass="InAppPurchaseAction",this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class LY extends CW{constructor(e){super(),this.$kind="AlertAction",this.actionClass="AlertAction",this.style=e,this.title=void 0,this.message=null,this.isCancelable=!1,this.cancelTitle=null,this.cancelAction=null,this.buttonActions=[],this.buttonTitles=[],this.destructiveActionIndex=null,this.imageName=null}}class MY extends kY{constructor(){super(Xk),this.screenshots=[],this.screenshotsDisplayStyle=GF}isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class xY extends kY{constructor(){super(Zk)}isValid(){const e=this.posterArtwork,t=this.posterVideo
return!(!e&&!t)&&super.isValid()}}class $Y extends kY{constructor(){super(eO)}isValid(){return!(!this.trailers||!this.trailers.isValid())&&!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid()}}class FY extends kY{constructor(){super(Kk),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null,this.screenshotsDisplayStyle="control",this.metadataRibbonItems=[],this.showMetadataInformationInLockup=!1,this.alignedRegionArtwork=null,this.alignedRegionVideo=null}}class NY{constructor(e,t,n,r,o=!1){this.$kind="ImageLockup",this.isDark=!1,this.artwork=e,this.lockup=t,this.caption=n,this.title=r,this.isDark=o}isValid(){return this.lockup.isValid()&&this.artwork.isValid()}}class BY{constructor(){this.$kind="ArcadeLockup"}}class UY{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S=!1,P=!1,I=!1){this.$kind="OfferDisplayProperties",this.offerType=e,this.adamId=t,this.bundleId=n,this.parentAdamId=o,this.style=null==r?BH:r,this.environment=null==i?hq:i,this.offerTint=null==s?{type:rL}:s,this.titles=null==a?{}:a,this.titleSymbolNames=null==c?{}:c,this.subtitles=null==l?{}:l,this.hasInAppPurchases=u,this.hasExternalPurchases=d,this.isDeletableSystemApp=f,this.isFree=h,this.isPreorder=p,this.offerLabelStyle=null==w?mq:w,this.hasDiscount=g,this.contentRating=v,this.subscriptionFamilyId=m,this.useAdsLocale=y,this.priceFormatted=A,this.isStreamlinedBuy=T,this.appCapabilities=b,this.ignoresContentRestrictions=S,this.isRedownloadDisallowed=P,this.isOpenBundleAllowed=I}newOfferDisplayPropertiesChangingAppearance(e,t,n,r){return new UY(this.offerType,this.adamId,this.bundleId,null==t||!e&&this.style===XB?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.offerTint:r,this.titles,this.titleSymbolNames,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId,this.useAdsLocale,this.priceFormatted,this.isStreamlinedBuy,this.appCapabilities,this.ignoresContentRestrictions,this.isRedownloadDisallowed,this.isOpenBundleAllowed)}}class GY extends CW{constructor(e,t=!0,n=new TW){super(),this.$kind="ExternalUrlAction",this.actionClass="ExternalUrlAction",this.url=e,this.isSensitive=t,this.actionMetrics=n}}class jY{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class VY extends CW{constructor(e,t){super(),this.$kind="OfferStateAction",this.actionClass="OfferStateAction",this.title=t.title,this.adamId=e,this.defaultAction=t,this.includeBetaApps=!1}}class HY{constructor(e,t,n,r,o,i,s){this.$kind="AdvertActionMetrics",this.instanceId=e,this.adamId=t,this.bundleId=n,this.advertType=r,this.invocation=o,this.purchaseType=i,this.reportingDestination=s}}class qY extends CW{constructor(e){super(),this.$kind="HttpTemplateAction",this.actionClass="HttpTemplateAction",this.message=null,this.url=e,this.method=XN,this.headers={},this.body=null,this.bodyDictionary={},this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class WY extends qY{}class zY{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class YY{constructor(){this.$kind="ProductReview",this.componentType=zx}}class JY{constructor(){this.$kind="Review"}}class KY{constructor(){this.$kind="Response"}}class ZY{constructor(e){this.$kind=null!=e?e:"Ratings"}}class QY{constructor(e,t,n,r,o,i,s){this.$kind="ReviewSummary",this.body=e,this.bodyNoTitle=t,this.subtitle=n,this.subtitleArtwork=r,this.subtitleArtworkAlignment=o,this.bodyMediaType=i,this.flowPreviewActionsConfiguration=s}}class XY extends ZY{constructor(){super("ProductStarRatings"),this.$kind="ProductStarRatings",this.componentType="starRatings"}}class eJ extends ZY{constructor(){super("ProductStarRatingsHistogram"),this.$kind="ProductStarRatingsHistogram",this.componentType="starRatingsHistogram"}}class tJ extends ZY{constructor(){super("ProductNoRatings"),this.$kind="ProductNoRatings",this.componentType="noRatings"}}class nJ{constructor(){this.$kind="TapToRate",this.componentType=Ay}}class rJ extends CW{constructor(e,t){super(),this.$kind="WriteReviewAction",this.actionClass="WriteReviewAction",this.adamId=e,this.url=t}}class oJ extends kY{constructor(){super(Qk),this.pageMetrics=new RY,this.pageRenderMetrics={}}}const iJ={DynamicGenericPage:"DynamicGenericPage",SearchChartsAndCategoriesPage:"SearchChartsAndCategoriesPage",ShelfBasedProductPage:hy}
class sJ{constructor(){this.shelfOrderings={},this.shelfMapping={},this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class aJ extends sJ{constructor(){super(...arguments),this.$kind="ShelfBasedProductPage",this.appPlatforms=[]}}class cJ extends CW{constructor(e,t,n,r,o,i){super(),this.$kind="ShelfBasedPageScrollAction",this.actionClass="ShelfBasedPageScrollAction",this.shelfId=e,this.notPurchasedShelfId=t,this.purchasedShelfId=n,this.adamId=r,this.index=o,this.clicksOnScroll=i}}class lJ extends CW{constructor(e,t){super(),this.$kind="ProductPageScrollAction",this.actionClass="ProductPageScrollAction",this.section=e,this.clicksOnScroll=t}}class uJ{constructor(e,t){this.$kind="ProductPageSection",this.type=e,this.shelfId=t}}!function(e){e.OnPageLoad="onPageLoad",e.OnShelfWillAppear="onShelfWillAppear"}(Xv||(Xv={}))
class dJ{constructor(e,t=null,n=null){this.$kind="Shelf",this.impressionMetrics=null,this.contentType=e,this.marker=t,this.items=n||[],this.header=void 0,this.url=null,this.mergeWhenFetched=!1,this.fetchStrategy=Xv.OnPageLoad,this.batchGroup=null,this.seeAllAction=null,this.footerTitle=null,this.footerAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.footerStyle=null,this.title=void 0,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.rowsPerColumn=null,this.background={type:mq},this.contentsMetadata={type:mq},this.isPersonalized=!1,this.shouldFilterApps=!1}}class fJ{constructor(){this.$kind="ReviewsContainer"}}class hJ{constructor(e,t,n,r){this.$kind="ReviewsPageSortOption",this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class pJ{constructor(e,t){this.shelves=e,this.title=void 0,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new RY,this.$kind=null!=t?t:"GenericPage"}}class wJ extends pJ{constructor(){super([],"ReviewsPage")}}const gJ="5BB5F361-F7CA-4BE5-90D4-92A973A38B03",vJ="B77D6B43-8357-42AC-9455-0BC985A4CC20",mJ="3A904FFE-6C7A-43F3-A014-CF750E1CBF5D",yJ="ACEB64F5-C210-4A63-9E78-1FA652ACE3B8",AJ="68BBAC6D-7741-47E0-99CE-5BA3B62E88A7",TJ="DA1A9665-5984-4AB6-B886-100A648F430F",bJ="3263D5D9-4A36-4C59-9B78-1EC9B7E78A1C",SJ="3771A729-28D2-498B-8128-36F745619ED2",PJ="CF3F5A4B-4F69-48AB-8FF9-CD6AA8D54A1C",IJ="DADF37D0-D667-4249-BA19-7C4A08E08281",CJ="33A25C07-53BB-4278-8C07-E6D00BE78609",kJ="3E45DDEC-6028-42C5-BA4C-7644C8E9316B",OJ="A77D5208-7747-467B-864F-76AC0E8E0DCE",EJ="979360BA-DDB0-4698-BE4F-16072F3BFB9B",RJ="564053BF-441A-44D5-B37C-2D6E112E4956",DJ="9AC2B085-5CE6-45CC-87B5-61F6E1E64541",_J="C2F1E751-7AC6-4368-917B-52900BA17FE8",LJ="5C63792A-E02C-4266-81BB-5B14330B1477",MJ="61FC0A9A-814D-46FF-AFE2-5D1907893829",xJ="7D0F61A1-4E25-40DF-A258-E028C4DCC5A1",$J=Mx,FJ="A134C61B-1BB0-45BE-B1C8-342ABE5DAACC",NJ=Mx,BJ=Mx,UJ=Mx
class GJ{constructor(e,t,n){this.$kind="ArtworkVariant",this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class jJ{constructor(e,t=null,n=null){this.$kind="FlowPreviewActionsConfiguration",this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class VJ{constructor(e,t,n){this.$kind="ReportConcernReason",this.reasonId=e,this.name=t,this.uppercaseName=n}}class HJ extends CW{constructor(e,t,n,r){super(),this.$kind="ReviewSummaryReportConcernAction",this.actionClass="ReviewSummaryReportConcernAction",this.concerns=e,this.title=t,this.explanation=n,this.sendAction=r}}class qJ extends CW{constructor(e){super(),this.$kind="HttpAction",this.actionClass="HttpAction",this.url=e,this.method=XN,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class WJ extends CW{constructor(e){super(),this.$kind="ReportConcernAction",this.actionClass="ReportConcernAction",this.reasons=e}}class zJ extends CW{constructor(e){super(),this.$kind="CopyTextAction",this.actionClass="CopyTextAction",this.text=e}}class YJ{static get contentType(){return ZM}constructor(){this._params=""}param(e,t){if(e&&t){const n=this._params.length>0?"&":""
this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}class JJ extends CW{constructor(e,t=Jq){super(),this.$kind="OpenAppAction",this.actionClass="OpenAppAction",this.adamId=e,this.destination=t}}class KJ extends CW{constructor(e,t,n){super(),this.$kind="AppLaunchTrampolineAction",this.actionClass="AppLaunchTrampolineAction",this.bundleId=e,this.payloadUrl=t,this.fallbackAction=n}}class ZJ extends CW{constructor(e){super(),this.$kind="CompoundAction",this.actionClass="CompoundAction"
const t=[]
for(const n of e)(0,Hv.isSome)(n.actionMetrics)&&(this.actionMetrics.addManyMetricsData(n.actionMetrics.data),Object.assign(this.actionMetrics.custom,n.actionMetrics.custom),n.actionMetrics.clearAll()),t.push(n)
this.actions=t}}const QJ="jet_adamId",XJ="X-AppStore-iAdClickToken",eK="X-AppStore-iAdLineItem",tK="X-AppStore-iAdDismissAdActionMetrics"
class nK{constructor(e={}){this.baseFields=e}}class rK{constructor(e){this.$kind="LintedMetricsEvent",this.fields=e}}class oK{constructor(e){if(this._values={},(0,Wv.isSome)(e)&&e.length>0){const t=e.split("&")
for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=(0,Wv.isNothing)(n)?"":decodeURIComponent(n)
this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length")
return(0,Wv.isNothing)(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t)
return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n)
return(0,Wv.isNothing)(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e=""
for(const t of Object.keys(this._values)){const n=this._values[t]
e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={}
for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n)
e[r]=o}return e}toRawMap(){return{...this._values}}}!function(e){e.client="clientId",e.user="userId",e.canonical="canonicalAccountIdentifierOverride"}(em||(em={})),function(e){e.client="APPSTORE_ENGAGEMENT_CLIENT",e.user="APPSTORE_ENGAGEMENT"}(tm||(tm={})),function(e){e.client="APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT",e.user="APPSTORE_PAYMENTS_ENGAGEMENT"}(nm||(nm={})),function(e){e.user="APPSTORE_PERSONALIZATION"}(rm||(rm={}))
const iK={[em.client]:{keyType:em.client,bagNamespace:nm.client,crossSyncDevice:!1},[em.user]:{keyType:em.user,bagNamespace:nm.user,crossSyncDevice:!0}},sK={[em.client]:{keyType:em.client,bagNamespace:tm.client,crossSyncDevice:!1},[em.user]:{keyType:em.user,bagNamespace:tm.user,crossSyncDevice:!0}},aK={[em.user]:{keyType:em.user,bagNamespace:rm.user,crossSyncDevice:!0}}
class cK{constructor(e=sK){this.cachedMetricsIds={},this.cachedMetricsFields={},this.shouldAddDsIdFallbackField=!1,this.userDsId=null,this.identifierContextMapping=e}async loadValues(e,t){e.bag.isMetricsUserIdFallbackEnabled&&!e.user.isUnderThirteen?(this.shouldAddDsIdFallbackField=!0,this.userDsId=e.user.dsid):(this.shouldAddDsIdFallbackField=!1,this.userDsId=null)
const n=[]
for(const r of t){const t=await this.loadValuesForIdType(e,r)
n.push(t)}for(const{idType:e,id:t,fields:r}of n)t&&(this.cachedMetricsIds[e]=t),r&&(this.cachedMetricsFields[e]=r)}async loadValuesForIdType(e,t){const n={idType:t},r=this.identifierContextMapping[t]
if(r){try{const o=await qv.context("MetricsIdentifiersCache:loadValues:metricsFields",async()=>await e.metricsIdentifiers.getMetricsFieldsForContexts([r]))
if((0,Hv.isSome)(o)){n[Zx]=o
const e=o[t];(0,Hv.isSome)(e)&&typeof e===Bq&&e.length>0&&(n.id=e)}}catch(n){e.console.error(`Unable to fetch metrics fields for idType ${t}`,n)}if((0,Hv.isNothing)(n.id))try{const t=await qv.context("MetricsIdentifiersCache:loadValues:metricsIdentifier",async()=>await e.metricsIdentifiers.getIdentifierForContext(r));(0,Hv.isSome)(t)&&(n.id=t)}catch(n){e.console.error(`Unable to fetch metrics identifier for idType ${t}`,n)}}return n}getMetricsIdForType(e){return this.cachedMetricsIds[e]}getMetricsFieldsForTypes(e){const t=e.map(e=>{var t
return null!==(t=this.cachedMetricsFields[e])&&void 0!==t?t:{}}),n=Object.assign({},...t)
return this.shouldAddDsIdFallbackField&&-1!==e.indexOf(em.user)&&this.addDsIdFallbackFieldIfNecessary(n),n}addDsIdFallbackFieldIfNecessary(e){const t=e[em.user];((0,Hv.isNothing)(t)||typeof t!==Bq||0===t.length||t.length===cK.clientGeneratedUserIdLength)&&(0,Hv.isSome)(this.userDsId)&&this.userDsId.length>0&&(e[bR]=this.userDsId)}setCanonicalAccountIdentifierOverride(e){e.length>=0&&(this.cachedMetricsFields[em.canonical]={[em.canonical]:e})}}cK.defaultMetatype=(0,zv.makeMetatype)("app-store:metricsIdentifiersCache"),cK.paymentMetatype=(0,zv.makeMetatype)("app-store:paymentMetricsIdentifiersCache"),cK.personalizationMetatype=(0,zv.makeMetatype)("app-store:personalizationMetricsIdentifiersCache"),cK.clientGeneratedUserIdLength=24
class lK{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=f(n,"fieldName")
if(r(t))continue
const o=h(e,t)
if(r(o))continue
let i=h(n,"magnitude")
r(i)&&(i=1048576)
let s=h(n,"significantDigits")
if(r(s)&&(s=2),i<=0||s<0){e[t]=Number.NaN
continue}const a=o/i
e[t]=Rt(a,s)}}_urlScrubbingAdParameters(e){const t=new az(e)
return t.removeParam(XJ),t.removeParam(eK),t.removeParam(tK),t.build()}_urlScrubbingExtRefUrl(e){const t=new az(e)
return t.username="",t.password="",t.pathname=void 0,t.query=void 0,t.hash=void 0,t.build()}_derezFastImpressions(e){const t=f(e,xN),n=h(e,$N)
if(t===wR){if(4===n){const t=l(e,vH)
e[vH]=t.map(e=>{if((0,Wv.isNothing)(e))return e
const t=l(e,dS)
return 0===t.length||(e[dS]=t.map(e=>{if((0,Wv.isNothing)(e))return e
const t=h(e,"d")
return e.s=0,(0,Wv.isSome)(t)&&(e.d=Rt(t,2)),e})),e})}if(5===n){const t=l(e,vH)
e[vH]=t.map(e=>{if((0,Wv.isNothing)(e))return e
delete e[FM],f(e,NN)!==z$&&(o(f(e,NM))||o(f(e,Y$)))&&delete e.id
const t=p(e,fS)
if((0,Wv.isNothing)(t)||o(t))return e
const n=f(e,SG)
return Object.entries(t).forEach(([e,r])=>{const o=l(r)
t[e]=o.map(e=>{if((0,Wv.isNothing)(e))return e
if(n===yR){const t=h(e,"s");(0,Wv.isSome)(t)&&(e.s=Rt(t,3))}else e.s=0
const t=h(e,"d")
return(0,Wv.isSome)(t)&&(e.d=Rt(t,2)),e})}),e[fS]=t,e})}}}_stripContentRatingImpressionFields(e){const t=l(e,vH)
e[vH]=t.map(e=>((0,Wv.isSome)(e)&&(delete e[_U],delete e[yq]),e))}_decorateSearchResultImpressions(e){const t=f(e,Zj),n=f(e,WG)
t===$V&&n!==J$&&function(e){const t=l(e,vH)
let n
for(const e of t){const t=f(e,NN)
if((0,Wv.isSome)(e)&&t===eV){n=e[X$]
break}}n&&(e[vH]=t.map(e=>{const t=f(e,NN),r=t===DV||t===s$
return(0,Wv.isSome)(e)&&r&&(e[jR]=n),e}))}(e)}_decorateSearchFocusImpressions(e){const t=f(e,Zj),n=f(e,WG)
t===BM&&n===UM&&function(e){var t
const n=l(e,vH)
let r
for(const e of n)if("R8804"===f(e,bN)){r=null!==(t=f(e,X$))&&void 0!==t?t:void 0
break}r&&(e[vH]=n.map(e=>{const t=f(e,bN),n=f(e,NN)
return o(t)&&n===Mq&&null!=e&&null==f(e,jR)&&(e[jR]=r),e}))}(e)}_decorateGamesSearchHintClick(e){}_decorateAll(e,t,n){var o,i,s
const a=this._options.bagProvider,c=a("metricsBase",n)
r(c)||typeof c!==fV||Object.assign(t,c),t.clientBuildType=this._options.buildType,t.resourceRevNum=this._options.jsVersion,t.xpSendMethod="jet-js",this._options.buyDecorator.useApp(f(t,Jq)),delete t[QJ]
const u=function*(e){if((0,Wv.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}}(f(t,hS))
for(const e of u)if("xp_ci"===e.key){this._options.buyDecorator.useClientId(e.value)
break}delete t[hS]
const d=null!==(i=null===(o=e.metricsIdentifiersCache)||void 0===o?void 0:o.getMetricsFieldsForTypes([em.client]))&&void 0!==i?i:{}
Object.assign(t,d),delete t.clientGeneratedId
const h=f(t,Zj),p=f(t,WG)
if(!r(h)&&!r(p)){const e=f(a("compoundSeparator",n))||"_"
t[wW]=`${h}${e}${p}`}const w=l(a("deResFields",n))
this._reduceFieldAccuracy(t,w)
const g=[DU,MN,NB,BB,Wq,"parentPageUrl"]
for(const e of g){const n=f(t,e);(0,Wv.isSome)(n)&&n.length>0&&(t[e]=e===NB?this._urlScrubbingExtRefUrl(n):this._urlScrubbingAdParameters(n))}const v=f(t,AR)
if((0,Wv.isSome)(v)&&(delete t[AR],t[K$]=v),e.bag.isMetricsUserIdFallbackEnabled){const n=f(t,TR)
let r=null;((0,Wv.isNothing)(n)||0===n.length||n.length===lK.clientGeneratedUserIdLength)&&(r=null!==(s=e.user.dsid)&&void 0!==s?s:null),(0,Wv.isSome)(r)&&r.length>0&&(t[bR]=r)}}_decorateClick(e){!function(e){const t=f(e,sF),n=f(e,VR)
r(t)&&(0,Hv.isSome)(n)&&(null==n?void 0:n.length)>0&&(e[sF]=n),f(e,HR)===zS&&delete e[qR]}(e),this._decorateSearchResultImpressions(e),this._decorateSearchFocusImpressions(e),yW.shared.addReferralDataToEventIfNecessary(e),this._filterBuyParams(e),this._decorateGamesSearchHintClick(e)
const t=f(e,Zj)
!(0,Wv.isNothing)(t)&&t.toLowerCase().includes(bq)||delete e[vH],Vh(e)}_decorateImpressions(e,t){if(o(t[vH]))return!1
this._derezFastImpressions(t),this._decorateSearchResultImpressions(t),this._stripContentRatingImpressionFields(t)
const n=f(t,BB)
return(0,Wv.isSome)(n)&&n.length>0&&(t[ZH]=gh(n),delete t[BB]),Vh(t),delete t[xN],!0}_decorateMedia(e){const t=h(e,GM)
r(t)||(e[GM]=Math.round(t))}_filterBuyParams(e){const t=f(e,"actionDetails.buyParams")
if((0,Wv.isSome)(t)&&t.length>0){const n=new oK(t);[pS].forEach(e=>{n.set(e,null,null)}),(0,Wv.isSome)(e[zG])&&(e[zG][Sj]=n.toString())}}_decoratePage(e,t){const n=f(t,wW)
r(n)||(t.pageHistory=this._options.buyDecorator.getPageHistoryFor(n)),yW.shared.setReferralDataForProductPageExtensionIfNecessary(t),yW.shared.beginReferralContextForPageIfNecessary(t),yW.shared.addReferralDataToEventIfNecessary(t)
const o=f(t,BB)
if(!r(o)){const e=hh(o),n=gh(o)
null!==e&&e.length>0&&(t[Z$]=e),null!==n&&n.length>0&&(t[ZH]=n)}}_decoratePageChange(e,t){this._decoratePage(e,t)}_decorateSearch(e){e[$N]=3,function(e){var t
const n=null!==(t=e[zG])&&void 0!==t?t:{},o=n[sF],i=f(e,VR)
r(o)&&(0,Hv.isSome)(i)&&(null==i?void 0:i.length)>0&&(n[sF]=i,e[zG]=n),f(e,HR)===zS&&delete e[qR],e[$G]===WR&&delete e[qR]}(e)}_decoratePageExit(e){yW.shared.endReferralContextIfNecessaryForPageEvent(e)}_filterExtraneous(e){!function(e){delete e[VR],delete e[HR],delete e.searchGhostHintTermLastDisplayed}(e),yW.shared.removeReferralContextInfoFromMetricsEvent(e)}makeEvent(e,t){const n=f(t,Kj)
if(this._options.isLoggingEnabled&&e.console.log(`Building event for topic: ${n}`),t[Jq]===dy)return new rK({})
const r=f(t,c$)||this._options.defaultTopic
this._decorateAll(e,t,r),e.user.isUnderThirteen&&(delete t[bR],delete t[TR],delete t.canonicalAccountIdentifierOverride)
const o=t[NB]
switch(o&&""===o&&delete t[NB],n){case bG:this._decorateClick(t)
break
case vR:break
case vH:if(!this._decorateImpressions(e,t))return new rK({})
break
case gR:this._decorateMedia(t)
break
case wW:this._decoratePage(e,t)
break
case cL:this._decoratePageChange(e,t)
break
case wS:this._decoratePageExit(t)
break
case bq:this._decorateSearch(t)}return this._filterExtraneous(t),e.bag.metricsIdMigrationEnabled&&function(e){delete e[YR],delete e.DSID}(t),new rK(t)}}lK.clientGeneratedUserIdLength=24,lK.hasIAdData=mR
class uK{constructor(e,t,n,r,o=!1){this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class dK{constructor(){this.$kind="TodayCard",this.heading=void 0,this.title=void 0,this.shortTitle=void 0,this.titleArtwork=void 0,this.media=void 0,this.heroMedia=void 0,this.overlay=void 0,this.style=void 0,this.clickAction=void 0,this.backgroundColor=void 0,this.inlineDescription=void 0,this.collapsedHeading=void 0,this.editorialDisplayOptions=void 0,this.supportsMediaMirroring=void 0}}const fK="5pdfhju01"
class hK{constructor(e,t,n){this.$kind="SearchAdOpportunity",this.instanceId=e,this.eventPayloads=t,this.searchAd=n}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}setMissedOpportunityReason(e){this.eventPayloads.placed.missedOpportunityReason=e}}class pK extends CW{constructor(e){super(),this.$kind="AdTransparencyAction",this.actionClass="AdTransparencyAction",this.adTransparencyData=e}}class wK{constructor(e,t,n,r,o){this.$kind="SearchAd",this.instanceId=e,this.iAd=t,this.eventPayloads=n,this.impressionId=r,this.transparencyAction=o}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}}class gK extends CW{constructor(e){super(),this.$kind="AdInteractionAction",this.actionClass="AdInteractionAction",this.adActionMetrics=e}}class vK{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[PG],this.requestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=(0,Hv.isSome)(this.requestData)&&this.requestData.length>0,t=(0,Hv.isSome)(this.routingInfo)&&this.routingInfo.length>0
return e&&t}}const mK="PI4",yK="PI3",AK="PI2",TK="PI1",bK="PV4",SK="PV3",PK="PV2",IK="PV1",CK="LV1",kK="LI1",OK="UV1_3x2",EK="UI1_3x2",RK="TEXT",DK=[EK],_K=[[RK],[CK,kK],[mK,yK,AK,TK,bK,SK,PK,IK],DK]
let LK=null
const MK="jet_native_advert_instanceid"
!function(e){e.Grid="grid",e.Hero="hero",e.Standard="standard"}(om||(om={})),function(e){e.insertIntoShelf="insertIntoShelf",e.replaceOrganic="replaceOrganic",e.dropAd="dropAd"}(im||(im={})),function(e){e.Icon="icon",e.Category="category"}(sm||(sm={})),function(e){e.TopLeading="topLeading",e.Top="top",e.TopTrailing="topTrailing",e.Trailing="trailing",e.BottomTrailing="bottomTrailing",e.Bottom="bottom",e.BottomLeading="bottomLeading",e.Leading="leading"}(am||(am={})),cm=e(172)
const xK="appStore.getEngagementEvents",$K=0,FK=1,NK=2
class BK{constructor(e){this.$kind="CategoryList",this.categories=e}}class UK{constructor(e,t,n,r,o){this.$kind="Category",this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}const GK={Apps:36,MacApps:39,Games:6014,Discover:39},jK=["284417353","1464590764","314638464","284993479","1351056256"];(ry=lm||(lm={})).ArcadeSeeAllGames="editorial-shelves-arcade-see-all-games",ry.Collection="editorial-shelves-collection",ry.Chart="editorial-shelves-chart",ry.Tag="editorial-shelves-tag",ry.Engagement="editorial-shelves-engagement",ry.Text="editorial-shelves-text",ry.Image="editorial-shelves-image",ry.VideoClip="editorial-shelves-video-clip",ry.Header="editorial-shelves-header",ry.Recommendations="editorial-shelves-recommendation",ry.GameCenter="editorial-shelves-game-center",ry.Upsell="editorial-shelves-upsell",ry.Marker="editorial-shelves-marker",(ny=um||(um={})).Hero="Hero",ny.TextOnly="TextOnly",ny.TextWithArtwork="TextWithArtwork",ny.BrickSmall="BrickSmall",ny.BrickMedium="BrickMedium",ny.BrickLarge="BrickLarge",ny.Charts="Charts",ny.EditorialLockupHierarchicalPortrait="EditorialLockupHierarchicalPortrait",ny.EditorialLockupHierarchicalRows="EditorialLockupHierarchicalRows",ny.EditorialLockupMedium="EditorialLockupMedium",ny.EditorialLockupMediumVariant="EditorialLockupMediumVariant",ny.EditorialLockupLarge="EditorialLockupLarge",ny.EditorialLockupLargeVariant="EditorialLockupLargeVariant",ny.LockupMedium="LockupMedium",ny.Lockup4Up="Lockup4Up",ny.Poster="Poster",ny.StorySmall="StorySmall",ny.StoryMedium="StoryMedium",ny.LockupSmall="LockupSmall",ny.LockupLarge="LockupLarge",ny.BreakoutLarge="BreakoutLarge",function(e){e.QuickLinks="QuickLinks"}(dm||(dm={})),(ty=fm||(fm={})).Vertical="Vertical",ty.Horizontal="Horizontal",ty.Condensed="Condensed",function(e){e.ShowInstalled="ShowInstalled",e.ShowAllPlatforms="ShowAllPlatforms",e.ShowOnlyPreorder="ShowOnlyPreorder"}(hm||(hm={})),function(e){e.AllGames="AllGames",e.ArcadeGames="ArcadeGames"}(pm||(pm={})),function(e){e.FriendsArePlaying="FriendsArePlaying",e.ContinuePlaying="ContinuePlaying"}(wm||(wm={})),function(e){e.ArcadeTabHeader="ArcadeTabHeader"}(gm||(gm={})),function(e){e.Arcade="Arcade"}(vm||(vm={})),function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(mm||(mm={}))
const VK="X-Apple-AppStore-UserId-Secondary"
class HK extends Error{}class qK extends Error{}const WK="x-apple-application-instance",zK="x-apple-application-site",YK=[Cq,oG,cB]
!function(e){e.AppEvent="appEvent",e.ContingentOffer="contingentOffer",e.OfferItem="offerItem"}(ym||(ym={}))
class JK{constructor(e,t,n,r,o,i){this.$kind="AppEventDetailPage",this.appEvent=e,this.artwork=t,this.video=n,this.shareAction=r,this.mediaOverlayStyle=o,this.includeBorderInDarkMode=i,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class KK extends CW{constructor(e,t,n=jy){super(),this.$kind="ShareSheetAction",this.actionClass="ShareSheetAction",this.data=e,this.activities=t,this.shareSheetStyle=n}}Am=e(447)
class ZK{constructor(){this.pageMetrics=new RY,this.pageRenderMetrics={}}}class QK extends ZK{constructor(){super(...arguments),this.$kind="SearchResults"}}class XK{constructor(e){this.promotionType=e}}class eZ extends XK{constructor(e,t,n){super(ym.ContingentOffer),this.$kind=fy,this.contingentOffer=e,this.artwork=t,this.mediaOverlayStyle=n,this.pageMetrics=new RY,this.pageRenderMetrics={},this.learnMoreActionMetrics=new TW,this.backButtonActionMetrics=new TW,this.closeButtonActionMetrics=new TW}}class tZ extends XK{constructor(e,t,n,r,o,i,s){super(ym.OfferItem),this.$kind=my,this.offerItem=e,this.artwork=t,this.learnMoreTitle=i,this.video=n,this.mediaOverlayStyle=r,this.pageMetrics=new RY,this.additionalInfo=s,this.pageRenderMetrics={},this.learnMoreActionMetrics=new TW,this.backButtonActionMetrics=new TW,this.closeButtonActionMetrics=new TW}}class nZ extends CW{constructor(e,t,n,r){super(),this.$kind="OfferAction",this.actionClass="OfferAction",this.title=e,this.adamId=t,this.parentAdamId=r,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem),this.includeBetaApps=!1}}class rZ extends CW{constructor(e,t){super(),this.$kind="OfferConfirmationAction",this.actionClass="OfferConfirmationAction",this.buyAction=e,this.confirmationInitiationAction=t}}class oZ extends CW{constructor(){super(),this.$kind="OfferAlertAction",this.actionClass="OfferAlertAction",this.title=void 0,this.message=null,this.footerMessage=null,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=XU,this.spatialControllerRequirement=null,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class iZ{constructor(e,t,n,r,o){this.$kind="MarketingItemRequestInfo",this.serviceType=e,this.placement=t,this.seed=r,this.clientOptions=o,this.metricsOverlay={topic:n}}}const sZ="data.search.dataSetId",aZ=HD,cZ=Am.PageInvocationPoint
cZ[bq]=bq,cZ[cO]=cO,cZ[rH]=rH,cZ[cL]=cL
const lZ=new Set([HM,PG,zM,yS,VS,UB,Y$,NM,FV,"iAd",SG,WM,mR,dj,Kj,xN])
class uZ{constructor(e,t,n,r,o,i){this.$kind="ShareSheetNotesMetadata",this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class dZ{constructor(e,t){this.$kind="ShareSheetActivity",this.activityType=e,this.action=t}}class fZ{constructor(e,t,n,r){this.$kind="ShareSheetArticleMetadata",this.context=Tq,this.id=e,this.text=t,this.subtitle=n,this.artwork=r}}class hZ{constructor(e,t,n){this.$kind="ShareSheetData",this.metadata=e,this.url=t,this.shortUrl=n}}class pZ{constructor(e,t,n){this.$kind="ShareSheetAppEventMetadata",this.context=KN,this.text=e,this.subtitle=t,this.artwork=n}}class wZ extends CW{constructor(e,t,n,r,o,i,s,a,c){super(),this.$kind="CreateCalendarEventAction",this.actionClass="CreateCalendarEventAction",this.startDate=e,this.endDate=t,this.isAllDay=n,this.name=r,this.location=o,this.notes=i,this.url=s,this.notAuthorizedAction=a,this.availability=c}}class gZ{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="ShareSheetProductMetadata",this.context=yH,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class vZ extends CW{constructor(e){super(),this.$kind="SheetAction",this.actionClass="SheetAction",this.actions=e,this.isCancelable=!1,this.cancelTitle=null,this.message=null,this.style=Lq,this.isCustom=!1,this.destructiveActionIndex=null}}class mZ{constructor(e,t,n){this.$kind="ShareSheetGenericMetadata",this.context=mj,this.text=e,this.subtitle=t,this.artwork=n}}class yZ{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b){this.$kind="PurchaseConfiguration",this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=f,this.supportsVisionOSCompatibleIOSBinary=h,this.inAppEventId=p,this.extRefApp2=w,this.extRefUrl2=g,this.additionalHeaders=v,this.appCapabilities=m,this.isDefaultBrowser=y,this.remoteDownloadIdentifiers=A,this.hasMacIPAPackage=T,this.contentRating=b}}class AZ extends CW{constructor(e,t,n,r){super(),this.$kind="ArcadeSubscriptionStateAction",this.actionClass="ArcadeSubscriptionStateAction",this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class TZ extends CW{constructor(e,t){super(),this.$kind="CancelPreorderAction",this.actionClass="CancelPreorderAction",this.preorderAdamId=e,this.isArcade=t}}class bZ extends CW{constructor(e,t){super(),this.$kind="RateLimitedAction",this.actionClass="RateLimitedAction",this.actionKey=e,this.primaryAction=t}}const SZ=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase()
return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||r(e)||(this._app=e)}useClientId(e){r(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0
for(const t of e){const e=f(t)
r(e)||this._pages.push(e)}}}useNativeValues(e){const t=f(e,"nativeApp")
this.useApp(t)
const n=f(e,"nativeClientId")
this.useClientId(n)
const r=l(e,"nativePageHistory")
this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice()
return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}}
let PZ=null
const IZ={containerId:"mtContainerId",placementId:"mtIadPlacementId",templateType:"mtIadTemplateType"},CZ={TodayCardMediaAppEvent:"TodayCardMediaAppEvent",TodayCardMediaArtwork:Py,TodayCardMediaBrandedSingleApp:Iy,TodayCardMediaHero:"TodayCardMediaHero",TodayCardMediaList:Cy,TodayCardMediaVideo:ky},kZ={TodayCardInAppPurchase:"TodayCardInAppPurchase",TodayCardMediaAppIcon:"TodayCardMediaAppIcon",TodayCardMediaGrid:"TodayCardMediaGrid",TodayCardMediaMediumLockupWithAlignedRegion:"TodayCardMediaMediumLockupWithAlignedRegion",TodayCardMediaMediumLockupWithScreenshots:"TodayCardMediaMediumLockupWithScreenshots",TodayCardMediaMultiApp:"TodayCardMediaMultiApp",TodayCardMediaRiver:Oy,TodayCardMediaSingleLockup:"TodayCardMediaSingleLockup",...CZ}
class OZ{constructor(e){this.impressionMetrics=null,this.kind=e}bestBackgroundColor(){}get searchAdOpportunity(){}}class EZ extends OZ{constructor(e,t,n,r){super(e),this.artworks=t,this.videos=n,this.artworkLayoutsWithMetrics=r}bestBackgroundColor(){var e,t,n
return null!==(t=null===(e=this.videos[0])||void 0===e?void 0:e.preview.backgroundColor)&&void 0!==t?t:null===(n=this.artworks[0])||void 0===n?void 0:n.backgroundColor}}class RZ extends EZ{constructor(e,t,n,r){super(oW,e,t,n),this.$kind="TodayCardMediaArtwork",this.titleBackingGradient=r}}class DZ extends OZ{constructor(e,t){super(Yx),this.$kind="TodayCardMediaMultiApp",this.lockups=e,this.additionalText=t}}class _Z extends EZ{constructor(e,t){super(ZU,e,t,[]),this.$kind="TodayCardMediaHero"}isValid(){const e=this.artworks.every(e=>e.isValid())&&this.artworks.length>0,t=this.videos.length>0
return e||t}}const LZ={TodayCardActionOverlay:"TodayCardActionOverlay",TodayCardAppEventLockupOverlay:"TodayCardAppEventLockupOverlay",TodayCardArcadeLockupOverlay:"TodayCardArcadeLockupOverlay",TodayCardLockupListOverlay:"TodayCardLockupListOverlay",TodayCardLockupOverlay:by,TodayCardMarketingLockupOverlay:Sy,TodayCardParagraphOverlay:Ey,TodayCardThreeLineOverlay:Ry}
class MZ{constructor(e){this.kind=e}}class xZ extends MZ{constructor(e){super(eq),this.$kind="TodayCardActionOverlay",this.action=e}}class $Z extends EZ{constructor(e,t,n,r,o,i,s){super(KN,r,o,i),this.$kind="TodayCardMediaAppEvent",this.formattedDates=e,this.startDate=t,this.tintColor=n,this.blurStyle=s}}class FZ extends MZ{constructor(e){super(tW),this.$kind="TodayCardLockupOverlay",this.lockup=e,this.displaysIcon=!0}}class NZ{constructor(e,t,n,r,o=!1,i=!1){this.$kind="PageRefreshPolicy",this.strategy=e,this.updateDelayInterval=t,this.timeSinceOnScreenInterval=n,this.timeToLiveEndDate=r,this.refreshWhileVisible=o,this.refreshForDeviceDrivenContentChange=i}}class BZ{constructor(e,t,n){this.locationTracker={rootPosition:0,locationStack:[]},this.parsedCardCount=0,this.currentRowIndex=0,this.pageInformation=e,this.locationTracker=null!=t?t:{rootPosition:0,locationStack:[]},this.refreshController=n}}class UZ extends BZ{constructor(e,t,n,r,o){super(t,n,r),this.pageHasDisplayedContent=!1,this.remainingContent=e,this.adPlacementBehavior=im.insertIntoShelf,this.recoImpressionData=o}}!function(e){e.AppEventCard="AppEventCard",e.AppOfTheDay="AppOfTheDay",e.FullBleedImage="FullBleedImage",e.GameOfTheDay="GameOfTheDay",e.Grid="Grid",e.InAppPurchase="InAppPurchase",e.List="List",e.NumberedList="NumberedList",e.River="River",e.ShortImage="ShortImage",e.SingleApp="SingleApp",e.Video="Video"}(Tm||(Tm={})),function(e){e.SmallCard="smallCard",e.MediumCard="mediumCard"}(bm||(bm={})),function(e){e.NoArtwork="no-artwork",e.ContentArtworkWithTitle="content-artwork-with-title",e.CategoryArtworkWithTitle="category-artwork-with-title",e.CategoryArtworkWithBadge="category-artwork-with-badge"}(Sm||(Sm={})),function(e){e.AppOfTheDay="app-of-the-day",e.GameOfTheDay="game-of-the-day"}(Pm||(Pm={})),function(e){e.Eyebrow="eyebrow",e.Title="title"}(Im||(Im={})),function(e){e.LinearGradient="linear-gradient"}(Cm||(Cm={})),function(e){e.Inline="inline",e.Article="article"}(km||(km={}))
const GZ={top:0,left:0,bottom:0,right:0}
!function(e){e.Mini="mini",e.ExtraWide="extraWide",e.None="none"}(Om||(Om={}))
const jZ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},VZ={collapsedContentMode:Kv.top,expandedContentMode:Kv.top,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},HZ={objectPath:"editorialVideo.categoryDetailMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:jZ,rtl:jZ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},{ltr:VZ,rtl:VZ,collapsedSize:{type:UV,height:1}}],sourceWidth:800,sourceHeight:450,type:rq,crops:["sr"]},qZ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},WZ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},zZ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},YZ={objectPath:"editorialArtwork.categoryDetailStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:qZ,rtl:qZ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},{maxWidth:704,ltr:WZ,rtl:WZ,collapsedSize:{type:UV,height:1.08}},{ltr:zZ,rtl:zZ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:lV},JZ={collapsedContentMode:Kv.bottomLeft,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:GZ},KZ={collapsedContentMode:Kv.bottomLeft,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},ZZ={collapsedContentMode:Kv.topLeft,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},QZ={maxWidth:250,ltr:JZ,rtl:JZ,collapsedSize:{type:UV,height:1},priority:Om.Mini},XZ={objectPath:I_,cardArtLayoutMetrics:[QZ,{maxWidth:704,ltr:KZ,rtl:KZ,collapsedSize:{type:UV,height:1.062}},{ltr:ZZ,rtl:ZZ,collapsedSize:{type:Lx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:lV},eQ={collapsedContentMode:Kv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Kv.bottomLeft,expandedLayoutInsets:GZ},tQ={collapsedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedContentMode:Kv.bottomLeft,expandedLayoutInsets:GZ},nQ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},rQ={maxWidth:250,ltr:eQ,rtl:eQ,collapsedSize:{type:UV,height:1},priority:Om.Mini},oQ={objectPath:C_,cardArtLayoutMetrics:[rQ,{maxWidth:704,ltr:tQ,rtl:tQ,collapsedSize:{type:UV,height:1.062}},{ltr:nQ,rtl:nQ,collapsedSize:{type:Lx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:lV},iQ={collapsedContentMode:Kv.bottomLeft,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:GZ},sQ={collapsedContentMode:Kv.bottomLeft,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},aQ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},cQ={maxWidth:250,ltr:iQ,rtl:iQ,collapsedSize:{type:UV,height:1},priority:Om.Mini},lQ={objectPath:k_,cardArtLayoutMetrics:[cQ,{maxWidth:704,ltr:sQ,rtl:sQ,collapsedSize:{type:UV,height:1.062}},{ltr:aQ,rtl:aQ,collapsedSize:{type:Lx,width:1}}],crops:[PC],sourceWidth:800,sourceHeight:490,type:lV},uQ=Kv.topRight,dQ={top:-108,left:495,bottom:0,right:0},fQ=Kv.topLeft,hQ={top:-108,left:-495,bottom:0,right:0},pQ={type:dH,width:1124,height:482},wQ={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:uQ,expandedLayoutInsets:dQ},gQ={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:fQ,expandedLayoutInsets:hQ},vQ={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:-165,left:524,bottom:0,right:0},expandedContentMode:uQ,expandedLayoutInsets:dQ},mQ={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:-165,left:-524,bottom:0,right:0},expandedContentMode:fQ,expandedLayoutInsets:hQ},yQ={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:uQ,expandedLayoutInsets:dQ},AQ={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:fQ,expandedLayoutInsets:hQ},TQ={objectPath:"editorialVideo.listCardMotion21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:wQ,rtl:gQ,collapsedSize:{type:dH,width:914,height:392},expandedSize:pQ,priority:Om.Mini},{ltr:vQ,rtl:mQ,collapsedSize:{type:dH,width:1188,height:509},expandedSize:pQ},{ltr:yQ,rtl:AQ,collapsedSize:{type:dH,width:1456,height:624},expandedSize:pQ,priority:Om.ExtraWide}],crops:[],sourceWidth:1208,sourceHeight:518,type:rq},bQ={collapsedContentMode:Kv.bottomRight,collapsedLayoutInsets:GZ,expandedContentMode:Kv.topRight,expandedLayoutInsets:GZ},SQ={collapsedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedContentMode:Kv.topLeft,expandedLayoutInsets:GZ},PQ={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Kv.right,expandedLayoutInsets:GZ},IQ={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Kv.left,expandedLayoutInsets:GZ},CQ={collapsedContentMode:Kv.scaleAspectFill,collapsedLayoutInsets:GZ,expandedContentMode:Kv.bottomRight,expandedLayoutInsets:{top:50,left:495,bottom:0,right:0}},kQ={collapsedContentMode:Kv.scaleAspectFill,collapsedLayoutInsets:GZ,expandedContentMode:Kv.bottomRight,expandedLayoutInsets:{top:50,left:-495,bottom:0,right:0}},OQ={objectPath:"editorialArtwork.listCardStatic21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:bQ,rtl:SQ,sourceCropOverrideLTR:"LCS.ApLCS01",sourceCropOverrideRTL:"LCS.ApLCS02",sourceSizeOverride:new Sz(550,264),priority:Om.Mini},{ltr:PQ,rtl:IQ,collapsedSize:{type:dH,width:672,height:279}},{ltr:CQ,rtl:kQ,expandedSize:{type:dH,width:1124,height:482},sourceCropOverrideLTR:IC,sourceCropOverrideRTL:IC,priority:Om.ExtraWide}],crops:["LCS.ApLCL01","LCS.ApLCL02"],sourceWidth:688,sourceHeight:286,type:lV},EQ={collapsedContentMode:Kv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Kv.bottomLeft,expandedLayoutInsets:GZ},RQ={collapsedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedContentMode:Kv.bottomLeft,expandedLayoutInsets:GZ},DQ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottomLeft,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},_Q={maxWidth:250,ltr:EQ,rtl:EQ,collapsedSize:{type:UV,height:1},priority:Om.Mini},LQ={objectPath:AM,cardArtLayoutMetrics:[_Q,{maxWidth:704,ltr:RQ,rtl:RQ,collapsedSize:{type:UV,height:1.062}},{ltr:DQ,rtl:DQ,collapsedSize:{type:Lx,width:1}}],crops:[PC],sourceWidth:800,sourceHeight:490,type:lV},MQ={collapsedContentMode:Kv.center,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},xQ={objectPath:"editorialVideo.storeFrontVideo",cardArtLayoutMetrics:[{ltr:MQ,rtl:MQ,collapsedSize:{type:UV,height:1},expandedSize:{type:UV,height:1}}],crops:[],sourceWidth:875,sourceHeight:492,type:rq},$Q={collapsedContentMode:Kv.center,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},FQ={objectPath:"editorialVideo.storeFrontVideo4x3",cardArtLayoutMetrics:[{ltr:$Q,rtl:$Q,collapsedSize:{type:UV,height:1},expandedSize:{type:UV,height:1}}],crops:[],sourceWidth:656,sourceHeight:492,type:rq},NQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},BQ={collapsedContentMode:Kv.top,expandedContentMode:Kv.top,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},UQ={objectPath:"editorialVideo.storyCardMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:NQ,rtl:NQ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},{ltr:BQ,rtl:BQ,collapsedSize:{type:UV,height:1}}],sourceWidth:800,sourceHeight:450,type:rq,crops:["sr"]},GQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},jQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},VQ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},HQ={maxWidth:250,ltr:GQ,rtl:GQ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},qQ={objectPath:CC,cardArtLayoutMetrics:[HQ,{maxWidth:704,ltr:jQ,rtl:jQ,collapsedSize:{type:UV,height:1.08}},{ltr:VQ,rtl:VQ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:lV},WQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},zQ={collapsedContentMode:Kv.top,expandedContentMode:Kv.top,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},YQ={objectPath:"editorialVideo.storyCenteredMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:WQ,rtl:WQ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},{ltr:zQ,rtl:zQ,collapsedSize:{type:UV,height:1}}],sourceWidth:800,sourceHeight:450,type:rq,crops:["sr"]},JQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},KQ={collapsedContentMode:Kv.bottom,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},ZQ={collapsedContentMode:Kv.scaleAspectFill,expandedContentMode:Kv.bottom,collapsedLayoutInsets:GZ,expandedLayoutInsets:GZ},QQ={maxWidth:250,ltr:JQ,rtl:JQ,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},XQ={maxWidth:704,ltr:KQ,rtl:KQ,collapsedSize:{type:UV,height:1.08}},eX={ltr:ZQ,rtl:ZQ},tX={objectPath:Rx,cardArtLayoutMetrics:[QQ,XQ,eX],crops:["sr"],sourceWidth:800,sourceHeight:450,type:lV},nX={objectPath:Rx,cardArtLayoutMetrics:[QQ,XQ,eX],crops:["nr"],sourceWidth:1280,sourceHeight:586,type:lV},rX={type:dH,width:1200,height:675},oX={top:-130,left:0,bottom:0,right:0},iX={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-16,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},sX={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:-116,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},aX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:-116,left:-70,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},cX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:-116,left:70,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},lX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},uX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},dX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},fX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:oX},hX={objectPath:"editorialVideo.universalAMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:iX,rtl:iX,collapsedSize:{type:dH,width:455,height:256},expandedSize:rX,priority:Om.Mini},{maxWidth:699,ltr:sX,rtl:sX,collapsedSize:{type:dH,width:1094,height:614},expandedSize:rX},{maxWidth:899,ltr:aX,rtl:cX,collapsedSize:{type:dH,width:1092,height:614},expandedSize:rX},{maxWidth:1090,ltr:lX,rtl:uX,collapsedSize:{type:dH,width:1392,height:783},expandedSize:rX},{ltr:dX,rtl:fX,collapsedSize:{type:dH,width:1600,height:900},expandedSize:rX}],crops:[kC],sourceWidth:1600,sourceHeight:900,type:rq},pX={collapsedContentMode:Kv.top,collapsedLayoutInsets:{top:16,left:0,bottom:0,right:0},expandedContentMode:Kv.top,expandedLayoutInsets:GZ},wX={collapsedContentMode:Kv.scaleAspectFill,collapsedLayoutInsets:GZ,expandedContentMode:Kv.scaleAspectFill,expandedLayoutInsets:GZ},gX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:{top:0,left:-70,bottom:0,right:0},expandedContentMode:Kv.center,expandedLayoutInsets:GZ},vX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:{top:0,left:70,bottom:0,right:0},expandedContentMode:Kv.center,expandedLayoutInsets:GZ},mX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},yX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},AX={collapsedContentMode:Kv.topLeft,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},TX={collapsedContentMode:Kv.topRight,collapsedLayoutInsets:GZ,expandedContentMode:Kv.center,expandedLayoutInsets:GZ},bX={objectPath:"editorialArtwork.universalAStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:pX,rtl:pX,collapsedSize:{type:dH,width:455,height:256},priority:Om.Mini},{maxWidth:699,ltr:wX,rtl:wX},{maxWidth:899,ltr:gX,rtl:vX},{maxWidth:1090,ltr:mX,rtl:yX,collapsedSize:{type:dH,width:1400,height:527}},{ltr:AX,rtl:TX,collapsedSize:{type:dH,width:1600,height:604}}],crops:[kC],sourceWidth:1600,sourceHeight:604,type:lV}
class SX extends MZ{constructor(e){super(Ty),this.$kind="TodayCardLockupListOverlay",this.lockups=e}}class PX extends MZ{constructor(e){super("arcadeLockup"),this.$kind="TodayCardArcadeLockupOverlay",this.arcadeLockup=e}}class IX extends CW{constructor(e){super(),this.$kind="TabChangeAction",this.actionClass="TabChangeAction",this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class CX extends CW{constructor(e){super(),this.$kind="OpenGamesUIAction",this.actionClass="OpenGamesUIAction",this.target=e}}Hv.Color.fromRGB(1,90/255,80/255)
const kX="isOnBoardingCard"
class OX extends EZ{constructor(e,t,n,r,o){super(Aj,t,n,r),this.$kind="TodayCardMediaBrandedSingleApp",this.icon=e,this.titleBackingGradient=o}bestBackgroundColor(){var e
return null!==(e=super.bestBackgroundColor())&&void 0!==e?e:this.icon.backgroundColor}}class EX extends OZ{constructor(e){super(QN),this.$kind="TodayCardMediaAppIcon",this.icon=e}bestBackgroundColor(){return this.icon.backgroundColor}}class RX extends OZ{constructor(e){super(KU),this.$kind="TodayCardInAppPurchase",this.lockup=e}bestBackgroundColor(){return this.lockup.icon.backgroundColor}}class DX extends EZ{constructor(e,t,n,r,o,i){super(iO,t,n,r),this.$kind="TodayCardMediaList",this.lockups=e,this.marketingText=o,this.isMediaDark=i}}class _X extends OZ{constructor(e){super(iL),this.$kind="TodayCardMediaRiver",this.lockups=e,this.lockupImpressionLimit=10}}const LX=new Set([Tm.Grid,Tm.List,Tm.NumberedList,Tm.River]),MX={AppEvent:Vk,ContingentOffer:Hk,OfferItem:K_}
class xX{constructor(e){this.promotionType=e}}class $X extends xX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(ym.ContingentOffer),this.$kind=Hk,this.backgroundArtwork=e,this.isStreamlinedBuy=n,this.mediaOverlayStyle=t,this.titleFormatted=o,this.subtitle=i,this.additionalInfo=l,this.description=s,this.label=a,this.badge=c,this.offerLockup=d,this.trunkAppIcon=u,this.learnMoreTitle=r,this.clickAction=null}}class FX{constructor(e,t,n){this.$kind="Paragraph",this.text=e,this.mediaType=t||GV,this.style=n||aW,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class NX{constructor(e,t,n){this.periodDuration=e,this.periodCount=t,this.type=n}isEqualTo(e){return e.periodDuration===this.periodDuration&&e.periodCount===this.periodCount&&e.type===this.type}}class BX extends xX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(ym.OfferItem),this.$kind=K_,this.moduleArtwork=e,this.moduleVideo=t,this.isStreamlinedBuy=r,this.mediaOverlayStyle=n,this.titleFormatted=o,this.description=a,this.badge=c,this.offerLockup=d,this.subtitle=s,this.endDate=l,this.expiryDateFormatted=i,this.iapArtwork=u,this.clickAction=null}}class UX{constructor(e,t,n,r,o,i,s,a,c,l,u){this.$kind="AppEventNotificationConfig",this.appEventId=e,this.title=t,this.detail=n,this.artworkUrl=r,this.displayTime=o,this.scheduledAction=i,this.notAuthorizedAction=s,this.failureAction=a,this.destinationUrl=c,this.scheduleClickEvent=l,this.cancelScheduleClickEvent=u}}class GX extends xX{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w){super(ym.AppEvent),this.$kind=Vk,this.appEventId=e,this.moduleArtwork=t,this.moduleVideo=n,this.title=r,this.subtitle=o,this.detail=i,this.startDate=s,this.endDate=a,this.appEventBadgeKind=c,this.kind=l,this.requirements=u,this.lockup=d,this.hideLockupWhenNotInstalled=f,this.formattedDates=h,this.mediaOverlayStyle=p,this.includeBorderInDarkMode=w,this.clickAction=null}}!function(e){e.available="available",e.happening="happening",e.live="live"}(Em||(Em={}))
class jX{constructor(e,t,n,r,o){this.$kind="AppEventFormattedDate",this.showLiveIndicator=e,this.displayFromDate=t,this.displayText=n,this.countdownToDate=r,this.countdownStringKey=o}}const VX="RoutableArticlePageIntent"
let HX=null
const qX=[jj,vN,KV,Zq,wG,CB,wU,gU],WX=[jj,mN,KV,wG],zX=[jj,KV,Zq,pG],YX=[jj,vN,KV,Zq,wG,CB,wU,gU,mN,pG],JX=wU
let KX=null
const ZX=[Cq,QA,xL,IH,nN,XA,Yj,$L,FL,dU,kj,NL,CV,eE,bj,eT,tT,xO,nT,"miniGamesDeepLink","gameDisplayName"],QX=/id([0-9]+)\/?$/i,XX={915249334:"1462947752"},e0=258,t0=261,n0=265,r0=304,o0=305,i0=311,s0=312,a0=414,c0=415,l0=416,u0=417,d0=418,f0=420,h0=421,p0=422,w0=423,g0=424,v0=425,m0=429,y0=430,A0=431,T0=437,b0=476,S0=495,P0=496,I0=497,C0=500,k0=501,O0=518,E0=548,R0=557,D0=584,_0=587,L0=566,M0=new Set([117,122,118,195,194,197,369,370,371,372,373,374,375,376,377,378,379,380,395,396,397,398,399,400,491,492,493,504,505,506,520,521,522,523,524,525,530,531,532,533,567,571]),x0=new Set([491,492,493]),$0=new Set([530,531,532,533]),F0=new Set([567,571]),N0=new Set([i0,s0,b0]),B0=new Set([...N0,O0]),U0=new Set([R0,d0,A0,m0,y0,f0,r0,o0,260,I0]),G0=new Set([413,a0,254,255,256,266,271,436])
class j0{}class V0 extends Error{}class H0 extends j0{constructor(e){super(),this.rawData=e,this.appId=null,this.groupId=null,this.score=0,this.segScores=new Map,this.modifiedScore=0,this.onDeviceScore=0}}class q0 extends j0{constructor(e){super(),this.rawData=e,this.isExactMatch=!1,this.isWildcardMatch=!1,this.isUnpersonalizedMatch=!1,this.isFallbackMatch=!1,this.appId=null,this.groupId=null,this.score=0,this.modifiedScore=0,this.onDeviceScore=0}}const W0="-1",z0={contentsNotChanged:0,contentsFiltered:1,contentsSorted:2}
class Y0{constructor(e,t){this.$kind="CondensedAdLockupWithIconBackground",this.lockup=e,this.backgroundArtwork=t}}class J0 extends OZ{constructor(e){super(Jx),this.$kind="TodayCardMediaSingleLockup",this.condensedAdLockupWithIconBackground=e}bestBackgroundColor(){var e
return null===(e=this.condensedAdLockupWithIconBackground)||void 0===e?void 0:e.backgroundArtwork.backgroundColor}get searchAdOpportunity(){return this.condensedAdLockupWithIconBackground.lockup.searchAdOpportunity}}class K0{constructor(e,t,n,r,o,i){this.$kind="MediumAdLockupWithScreenshotsBackground",this.lockup=e,this.screenshots=t,this.isAnimated=n,this.secondaryTextColor=r,this.backgroundColor=o,this.riverSpeed=i}}class Z0 extends OZ{constructor(e){super("mediumLockupWithScreenshots"),this.$kind="TodayCardMediaMediumLockupWithScreenshots",this.mediumAdLockupWithScreenshotsBackground=e}get searchAdOpportunity(){return this.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity}}!function(e){e.EditorialItem="editorialItem",e.EditorialItemGroup="editorialItemGroup"}(Rm||(Rm={}))
class Q0{constructor(e,t,n,r,o,s,a){this.missedOpportunityReasons={},this.placementType=t,this.placementId=null===t?null:this.placementIdFromType(t),this.pageFields={},this.clickFields={},this.impressionsFields={},this.sharedImpressionsArrayFields={},this._adApplied=!1,this._adAdamId=void 0,this.positionInfo=a,this.slotInfo=n,this.setInitialAdData(e,r,o),i(s)&&(this.pageFields[yS]=s)}static from(e,t){var n,r,o,i
const s=new Q0(e,f(t.placementType),l(t.slotInfo),null!==(n=f(t.iAdId))&&void 0!==n?n:void 0,null!==(r=f(t.appStoreClientRequestId))&&void 0!==r?r:void 0,null!==(o=v(t.wasOdmlSuccessful))&&void 0!==o?o:void 0,g(t.positionInfo))
return s._adApplied=u(t._adApplied),s._adAdamId=null!==(i=f(t._adAdamId))&&void 0!==i?i:void 0,Object.assign(s.pageFields,t.pageFields),Object.assign(s.clickFields,t.clickFields),Object.assign(s.impressionsFields,t.impressionsFields),Object.assign(s.sharedImpressionsArrayFields,t.sharedImpressionsArrayFields),s.updateContainerId(e,f(t.containerId)),s}static createInitialPageSlotInfos(e,t,n,r,o){var i
const s=an(e,t,!0,o),a=(0,Hv.isNothing)(s)?[]:s.map(e=>e.slot),c=Q0.containerIdFromType(e,t)
switch(t){case KH:case wH:const t=null!==(i=null==n?void 0:n.slot)&&void 0!==i?i:0
return[{containerId:c,slots:[{slotId:`${c}_${t}`,slotIndex:t,hasAdData:!1}]}]
case lq:if(!nn(e))return null
0===a.length&&a.push(0)
const o=a.map(e=>({slotId:`${c}_${e}`,slotIndex:e,hasAdData:!1}))
return[{containerId:c,slots:o}]
case zq:const s={},l=(0,Hv.isSome)(n)?n.slot-1:null
let u=!1
return a.forEach(e=>{var t
const n=u?e-1:e,o=null==r?void 0:r.find(e=>e.containedAdSlots.includes(n)),i=l===e,a=function(e,t,n){return(0,Hv.isNothing)(n)?"0":n.type===Rm.EditorialItemGroup?(!(n.containedAdSlots.length>1)||e===n.containedAdSlots[0]||n.containedAdSlots[n.containedAdSlots.length-1],"0"):"0"}(n,0,o),c=null!==(t=s[a])&&void 0!==t?t:{containerId:a,slots:[]}
s[a]=c
const d={slotId:`${a}_${e}`,slotIndex:e,hasAdData:!1}
c.slots.push(d),u=u||i}),Object.values(s)
default:return null}}get adIsPresent(){return this._adApplied}get adAdamId(){return this._adAdamId}updateForAdResponse(e,t){var n
r(t)||(this.placementType=t.placementType,this.placementId=this.placementIdFromType(this.placementType),this.positionInfo=null===(n=t.onDeviceAd)||void 0===n?void 0:n.positionInfo,this.setInitialAdData(e,t.iAdId,t.clientRequestId))}setInitialAdData(e,t,n){if((0,Hv.isNothing)(n))return
const r=(0,Hv.isNothing)(t)?"-1":t
switch(this.pageFields[lK.hasIAdData]=!0,this.placementType){case zq:case KH:case wH:case lq:if(on(e,this.placementType))break
this.impressionsFields[lK.hasIAdData]=!0,this.clickFields[HM]=n,this.impressionsFields[HM]=n}if(rn(e,this.placementType)&&(this.pageFields[IR]=null,this.pageFields[CR]=null,this.pageFields[dj]=null,this.clickFields[IR]=null,this.clickFields[CR]=null,this.impressionsFields[Y$]=null,this.impressionsFields[IR]=null,this.impressionsFields[CR]=null,this.impressionsFields[dj]=null),this.pageFields[HM]=n,this.pageFields[PG]=r,this.impressionsFields[PG]=r,this.clickFields[PG]=r,this.updateContainerId(e,null),this.updateSlotInfo(),(0,Hv.isSome)(this.placementId)&&this.placementId.length>0)switch(this.pageFields[SG]=this.placementId,this.clickFields[SG]=this.placementId,this.impressionsFields[SG]=this.placementId,this.placementType){case zq:case KH:case wH:case lq:if(on(e,this.placementType))break
this.sharedImpressionsArrayFields[SG]=this.placementId}}updateContainerId(e,t){this.placementType===zq?(this.containerId=null!=t?t:null,i(this.containerId)&&(this.clickFields[UB]=this.containerId,this.sharedImpressionsArrayFields[UB]=this.containerId)):(this.containerId=Q0.containerIdFromType(e,this.placementType),i(this.containerId)&&(this.pageFields[UB]=this.containerId,this.clickFields[UB]=this.containerId))}containerIdForSlotIndex(e){if((0,Hv.isNothing)(e)||(0,Hv.isNothing)(this.slotInfo))return null
for(const t of this.slotInfo)for(const n of t.slots)if(n.slotIndex===e)return t.containerId
return this.containerId}apply(e,t){if((0,Hv.isNothing)(t)||o(t))return
const n=t.id,r=B(t,xG)
if(this._adAdamId=n,r){this.impressionsFields[lK.hasIAdData]=!0,this.clickFields[lK.hasIAdData]=!0
const o=fh(r[X$])
this.clickFields[Y$]=o
const i=fh(r[kR])
this.clickFields[NM]=i,this.pageFields[FV]=n,this.pageFields.iAd={iAdFormat:ph(g(m(r),"format")),iAdAlgoId:fh(r.algoId),iAdImpressionId:fh(r[X$]),iAdMetadata:fh(r[kR])}
const s=Ge(e,t)
this.updateIAdMetricsFieldsForProductVariantData(s,this.clickFields),this._adApplied=!0}this.updateSlotInfo()}applyClickFieldsFromPageRequest(e,t){this._adApplied=!0,this._adAdamId=e,Object.assign(this.clickFields,t),Object.keys(this.pageFields).forEach(e=>delete this.pageFields[e])}setSpecifiedCreativeUsed(e){this.clickFields[Jb]=e}setTemplateType(e,t){this.placementType===lq&&nn(e)?this.sharedImpressionsArrayFields[dj]=t:(this.pageFields[dj]=t,this.impressionsFields[dj]=t),this.clickFields[dj]=t}recordLockupFromDataFailed(e,t,n){this.setMissedOpportunity(e,qM,t,n)}recordAdResponseEventsIfNeeded(e,t,n,r){if(!(0,Hv.isNothing)(t)&&0!==t.length)switch(t){case pA:case SO:case"insufficientAssets":this.setMissedOpportunity(e,qM,n,r)
break
case"noAdAvailable":this.setMissedOpportunity(e,eF,n,r)
break
case"timeout":this.setMissedOpportunity(e,"APSLA",n,r)
break
case wA:this.setMissedOpportunity(e,"NOLOC",n,r)
break
case"policyAdDrop":case"policyViolation":this.setMissedOpportunity(e,AS,n,r)}}setMissedOpportunity(e,t,n,r){var o,i,s
const a=null===(o=this.missedOpportunityReasons[n])||void 0===o?void 0:o[r]
if(!(0,Hv.isSome)(a)){switch(null!==(i=(s=this.missedOpportunityReasons)[n])&&void 0!==i||(s[n]={}),this.missedOpportunityReasons[n][r]=t,this.clickFields[WM]=t,this.placementType){case zq:case KH:case wH:break
default:if(rn(e,this.placementType))break
this.pageFields[WM]=t,this.impressionsFields[WM]=t}this.updateSlotInfo()}}missedOpportunityReason(e,t){var n
return null===(n=this.missedOpportunityReasons[e])||void 0===n?void 0:n[t]}placementIdFromType(e){switch(e){case AV:return TS
case lq:return yR
case zq:return bS
case KH:return SS
case wH:return PS
default:throw new Error(`This method should never be called with value: ${e}`)}}static placementTypeFromPlacementId(e,t){switch(t){case TS:return AV
case yR:return lq
case bS:return zq
case SS:return KH
case PS:return wH
default:return e.console.log(`Failed to get placementType from placementId ${t}. Defaulting to searchResults`),lq}}static containerIdFromType(e,t){switch(t){case KH:return OG
case wH:return PO
case zq:return null
case lq:return nn(e)?"0":null
default:return null}}impressionsArrayFieldsForCurrentItem(e,t,n){if(this.placementType!==zq)return{}
const r=zs(t,n)
return{iAdSlotId:`${this.containerIdForSlotIndex(r)}_${r}`}}get adjustedSlotIndex(){var e
const t=null===(e=this.positionInfo)||void 0===e?void 0:e.slot
return i(t)?t-1:null}updateSlotInfo(){var e,t
if(!(0,Hv.isNothing)(this.slotInfo)){switch(this.placementType){case KH:case wH:case lq:for(const t of this.slotInfo)for(const n of t.slots){if((0,Hv.isSome)(t.containerId)){const r=null===(e=this.missedOpportunityReasons[t.containerId])||void 0===e?void 0:e[n.slotIndex];(0,Hv.isSome)(r)&&(n.missedOpportunityReason=r)}n.hasAdData=this.adIsPresent&&(0,Hv.isNothing)(n.missedOpportunityReason)}break
case zq:const n=this.adjustedSlotIndex
for(const e of this.slotInfo)for(const r of e.slots){const o=n===r.slotIndex,s=this.adIsPresent&&o
let a;(0,Hv.isSome)(e.containerId)&&(a=null===(t=this.missedOpportunityReasons[e.containerId])||void 0===t?void 0:t[r.slotIndex],(0,Hv.isSome)(a)&&(r.missedOpportunityReason=a)),!o&&i(n)&&(a=eF),r.hasAdData=s,(0,Hv.isSome)(a)&&(r.missedOpportunityReason=a)}}(0,Hv.isSome)(this.slotInfo)&&this.slotInfo.length>0&&(this.pageFields[zM]=this.slotInfo,this.clickFields[zM]=this.slotInfo,this.impressionsFields[zM]=this.slotInfo)}}updateIAdMetricsFieldsForProductVariantData(e,t){(0,Hv.isSome)(e)&&Ye(e,YM)?t[IS]=e.productPageId:delete t[IS]}updateIAdMetricsFieldsForAlignedRegion(e,t){}fastImpressionsEventVersion(e){switch(this.placementType){case KH:case wH:case zq:return 5
case lq:return nn(e)?5:4
default:return 4}}shouldIncludeAdRotationFields(e){switch(this.placementType){case KH:case wH:case zq:return!1
case AV:return!0
case lq:return!nn(e)
default:return!0}}shouldIncludeAdFieldsForPad(e){return!!e.client.isPad&&0===Object.keys(this.missedOpportunityReasons).length}}const X0="externalDeepLinkUrl",e1="isCppDeepLinkDisabled"
class t1{constructor(e){this.$kind="EditorsChoice",this.showsBadge=!1,this.title=void 0,this.notes=e,this.isCollapsed=!0}}const n1={11:"43",30:"44"},r1=pD,o1="ReviewsPage.ShelfId",i1=new Set([jq,Uq,Yq])
class s1{constructor(e,t,n){this.sectionType=e,this.shelfId=t,this.shelfBasedMappedIds=n}createProductPageSection(e){return i1.has(this.sectionType)?new uJ(this.sectionType,null):new uJ(this.sectionType,this.shelfId)}createShelfIdList(){return this.shelfBasedMappedIds||[this.shelfId]}}const a1=5,c1=5,l1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(vW,zH),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,UU,yF,Hj]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],u1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(vW,zH),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,Qj,CG,JG,Hj,GU,jU]),new s1(vW,GU),new s1(vW,CG),new s1(vW,JG),new s1(vW,jU),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],d1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,zH),new s1(vW,WV),new s1(vW,VH),new s1(vW,LH),new s1(vW,Fq,[EH,UU,Hj]),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],f1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,zH),new s1(vW,WV),new s1(vW,VH),new s1(vW,LH),new s1(vW,Fq,[EH,Qj,CG,JG,Hj]),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],h1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,iq),new s1(vW,KG),new s1(vW,EG),new s1(vW,zH),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,UU,yF,Hj]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH)],p1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,qB),new s1(vW,tH),new s1(vW,iq),new s1(vW,KG),new s1(vW,EG),new s1(vW,zH),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,Qj,CG,JG,Hj,GU,jU]),new s1(vW,GU),new s1(vW,CG),new s1(vW,JG),new s1(vW,jU),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH)],w1=5,g1=5,v1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(vW,zH),new s1(vW,zV),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,UU,yF,Hj]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],m1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(vW,zH),new s1(vW,zV),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,Qj,CG,JG,Hj,GU,jU]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],y1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,VH),new s1(vW,LH),new s1(vW,Fq,[EH,UU,Hj]),new s1(vW,zH),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],A1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,VH),new s1(vW,LH),new s1(vW,Fq,[EH,Qj,CG,JG,Hj]),new s1(vW,zH),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],T1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(vW,iq),new s1(vW,zH),new s1(vW,zV),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,yF,UU,Hj]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH)],b1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,HB),new s1(vW,tH),new s1(vW,iq),new s1(vW,zH),new s1(vW,zV),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,LH),new s1(vW,Fq,[EH,GU,Qj,CG,JG,Hj,jU]),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH)],S1=5,P1=5,I1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(vW,zH),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,Fq),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],C1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,tH),new s1(vW,KG),new s1(vW,EG),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,zH),new s1(vW,WV),new s1(vW,VH),new s1(vW,Fq),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,$j),new s1(vW,xj),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,GH),new s1(vW,iq)],k1=5,O1=5,E1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,tH),new s1(vW,zH),new s1(vW,zV),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,Fq),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],R1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tq),new s1(vW,tH),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,WV),new s1(vW,VH),new s1(vW,Fq),new s1(vW,zH),new s1(vW,Hq),new s1(vW,gq),new s1(vW,zV),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,hH),new s1(vW,iq),new s1(vW,GH)],D1=5,_1=5,L1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,Hq),new s1(vW,gq),new s1(vW,HU),new s1(vW,GH),new s1(vW,iq),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,NF)],M1=[new s1(jq,jq),new s1(Uq,Uq),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,VH),new s1(vW,VU),new s1(vW,Hq),new s1(vW,gq),new s1(vW,GH),new s1(vW,iq),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,NF)],x1=5,$1=5,F1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,Hq),new s1(vW,gq),new s1(vW,HU),new s1(vW,iq),new s1(vW,GH),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,NF)],N1=[new s1(jq,jq),new s1(Uq,Uq),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,VH),new s1(vW,VU),new s1(vW,Hq),new s1(vW,gq),new s1(vW,iq),new s1(vW,GH),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,NF)],B1=5,U1=5,G1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tH),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,AF),new s1(vW,HU),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,GH),new s1(vW,iq)],j1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,VH),new s1(vW,AF),new s1(vW,VU),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,GH),new s1(vW,iq)],V1=5,H1=5,q1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tH),new s1(vW,Hq),new s1(vW,gq),new s1(vW,VH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,AF),new s1(vW,HU),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,uV),new s1(vW,fq),new s1(vW,iq),new s1(vW,GH)],W1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,tH),new s1(Yq,Yq),new s1(vW,RG),new s1(vW,VH),new s1(vW,AF),new s1(vW,VU),new s1(vW,Hq),new s1(vW,gq),new s1(vW,cq),new s1(vW,nq),new s1(vW,jH),new s1(vW,xH),new s1(vW,UH),new s1(vW,MH),new s1(vW,xq),new s1(vW,vj),new s1(vW,fq),new s1(vW,iq),new s1(vW,GH)],z1=3,Y1=3,J1=[new s1(jq,jq),new s1(Uq,Uq),new s1(vW,zV),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,cq),new s1(vW,nq),new s1(vW,qx)],K1=[new s1(jq,jq),new s1(Uq,Uq),new s1(Yq,Yq),new s1(vW,Cq),new s1(vW,zV),new s1(vW,cq),new s1(vW,nq),new s1(vW,qx)],Z1=a1,Q1=c1,X1=[...l1],e2=[...u1],t2=[...d1],n2=[...f1],r2=[...h1],o2=[...p1],i2=w1,s2=g1,a2=[...v1],c2=[...m1],l2=[...y1],u2=[...A1],d2=[...T1],f2=[...b1]
class h2{constructor(e,t,n=GV,r=null,o=null,i=null){this.$kind="FramedVideo",this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===FF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class p2{constructor(e){this.$kind="ProductMediaGalleryPage",this.productMedia=e,this.pageMetrics=new RY,this.pageRenderMetrics={}}}const w2="product_media",g2=new Set([MH,UH,xH,Hq,qx,zH,KG,EG,fq,Cq,WV,hH,gq,xj,xq,tq,vj,uV,GH,zV,tH,jH,cq,nq,Fq,iq,$j,RG,NF,VH])
class v2{constructor(e,t){this.$kind="ProductPageExpandedOfferDetails",this.title=e,this.subtitle=t}}class m2{constructor(e,t,n,r,o,i,s,a,c){this.$kind="Banner",this.message=e,this.focusedMessage=t,this.action=n,this.fullProductAction=r,this.leadingArtwork=o,this.leadingArtworkTintColor=i,this.includeBackgroundBorder=s,this.kind=a,this.hideCriteria=c}}class y2{constructor(e,t,n,r,o){this.$kind="AppStateBanner",this.unknownBanner=e,this.buyBanner=t,this.downloadBanner=n,this.updateBanner=r,this.openBanner=o}}const A2="notPurchasedOrdering"
class T2{constructor(e){this.$kind="Uber",this.style=e}isValidUber(e,t){function n(e){return null!=e&&0!==Object.keys(e).length}return n(this.artwork)||n(this.compactArtwork)||n(this.video)||n(this.compactVideo)||(e||t)&&n(this.iconArtwork)}}class b2 extends CW{constructor(e){super(),this.$kind="SelectAppAction",this.actionClass="SelectAppAction",this.adamId=e}}class S2{constructor(e,t){this.$kind="DynamicUIRequestInfo",this.clientOptions=t,this.metricsOverlay={topic:e}}}class P2{constructor(){this.$kind="ArcadeDownloadPackCard"}}class I2{constructor(){this.$kind="Placeholder"}}const C2={shelfIdentifier:"first",slot:0},k2="SLPPage",O2=oq,E2="RoomPageIntent"
Dm=e(8836)
class R2{constructor(e){this.builderClass=e}async handleShelf(e,t,n,r){throw new Error(`${this.builderClass} does not implement handleShelf`)}async handlePagination(e,t,n,r,o){throw new Error(`${this.builderClass} does not implement handlePagination`)}shelfRoute(e){return[{protocol:OW,path:`${this.shelfPath}{data}`}]}paginationRoute(e){return[{protocol:OW,path:`${this.paginationPath}`}]}shelfUrl(e){return`${OW}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${xW.shelf}/`}get paginationUrl(){return`${OW}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${xW.lookup}/`}static createFlowAction(e,t,n){const r=new EY(t)
return r.pageUrl=n.build(),r.pageData=e,r}}!function(e){e.Page="page",e.Shelf="shelf",e.Pagination="pagination"}(_m||(_m={}))
class D2 extends R2{defaultAttributes(e){return[]}defaultTab(e){return null}prepareRequest(e,t,n,r,o){t.includingAdditionalPlatforms(this.defaultPlatforms(e)),t.includingAttributes(this.defaultAttributes(e)),t.usingCustomAttributes(Ue(e))}defaultAction(e,t,n,r){return D2.createFlowAction(t,this.pageType(),r)}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{var r
let i
const s=t.build()
if($i(e,t)?i=new dY(e,s):((0,Hv.isSome)(o)&&(n[zW.includeUnlistedApps]="1"),i=this.generatePageRequest(e,t,n)),!i)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,i,_m.Page,t,n),i.attributingTo(s)
const a=null!==(r=e.fetchTimingMetricsBuilder)&&void 0!==r?r:new Dm.FetchTimingMetricsBuilder,c=void 0===e.fetchTimingMetricsBuilder?e.addingFetchTimingMetricsBuilder(a):e
let l
l=_(Ln(c,i)),l.then(t=>{ac(e,e.user.dsid,t)})
const u=this.generateAdditionalPageRequirements(e,t,n),d=await ic(e,l,u)
let f={originalData:d.primaryPageData}
this.supportsDataAugmenting()&&(f=await this.augmentData(c,t,n,d.primaryPageData))
const h=await a.measureModelConstructionAsync(async()=>await this.renderPage(c,f.originalData,n,d.additionalData,f.additionalData,o)),p=this.defaultTab(h),w=this.defaultAction(e,h,n,t),g=n[zW.isPPT]
if(t.removeParam(zW.isPPT),null===p||g)return w
{const e=new IX(p)
return e.actions=[w],e}},async e=>await this.handlePageError(e,t,n))}async handlePageError(e,t,n){throw e}async handleShelf(e,t,n,r){return await Va(`${this.builderClass}.handleShelf`,async()=>{let r
const o=t.build()
if(r=$i(e,t)?new dY(e,o):this.generateShelfRequest(e,t,n),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,_m.Shelf,t,n),r.attributingTo(t.build())
const i=await Ln(e,r),s=await this.renderShelf(e,i,n)
return this.shelfRequiresAdditionalModification(s,n)?await this.performAdditionalShelfModifications(e,s,n):s},async e=>await this.handleShelfError(e,n))}async performAdditionalShelfModifications(e,t,n){return t}shelfRequiresAdditionalModification(e,t){return!1}async handleShelfError(e,t){throw e}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>{let r
const i=t.build()
if(r=$i(e,t)?new dY(e,i):this.generatePaginationRequest(e,t,n,o),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,_m.Pagination,t,n),r.attributingTo(t.build())
const s=await Ln(e,r)
return await this.renderPaginatedPage(e,s,o)},async e=>await this.handlePaginationError(e,n,o))}async handlePaginationError(e,t,n){throw e}generateAdditionalPageRequirements(e,t,n){return{}}generateShelfRequest(e,t,n){throw new Error(`generateShelfRequest is not supported on: ${this.builderClass}`)}generatePaginationRequest(e,t,n,r){throw new Error(`generatePaginationRequest is not supported on: ${this.builderClass}`)}supportsDataAugmenting(){return!1}async augmentData(e,t,n,r){const o={url:t,parameters:n}
return await sc(e,r,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,o)}additionalDataKeysNeededForData(e,t,n){return null}fetchAdditionalDataForKey(e,t){return null}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async renderPaginatedPage(e,t,n){throw new Error(`renderPaginatedPage is not supported on: ${this.builderClass}`)}}Lm=e(1974)
class _2{constructor(){this.profile=tW,this.maxPerPage=20}}class L2 extends D2{defaultAttributes(e){return rc(e)}defaultPlatforms(e){return ee(e)}pageType(){return wW}generatePaginationRequest(e,t,n,r){return new dY(e,r.remainingContent)}async renderPaginatedPage(e,t,n){const r=n
return await this.pageWithContent(e,t,r)}async pageWithContent(e,t,n,r=!0){return await Va("pageWithContent",async()=>function(e,t,n,r=!0){var o
const i=n.preferredShelfContentType||O2,s=new dJ(i),a={id:null,kind:null,softwareType:null,targetType:dq,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:wV,recoMetricsData:null!==(o=St(t))&&void 0!==o?o:{}}
Mh(e,s,a),bh(0,a,n.title),s.isHorizontal=!1,s.shouldFilterApps=n.shouldFilter
const c=At(t)
r&&(n.remainingContent=[]),s.items=$d(e,c,{contentUnavailable:(e,t)=>(r&&(n.remainingContent=Ct(0,c,e)),!0),lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Kd(0,i)}})
const l=new pJ([s])
return n.remainingContent.length&&(l.nextPage=n),l}(e,t,n,r))}}class M2 extends L2{requestWithFilter(e,t,n){return new dY(e).forType(dW).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(t,n)}async renderPage(e,t,n,r){return await Va(_j,async()=>{const r=new _2
r.url=this.paginationUrl,r.metricsPageInformation=this.pageInformation(e,t,n),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const o=await this.pageWithContent(e,t,r)
return jn(e,o,r.metricsPageInformation),o})}}const{routes:x2,makeCanonicalUrl:$2}=uc(oc,"/room/{id}"),{routes:F2,makeCanonicalUrl:N2}=dc(oc,"/{platform}/room/{id}"),B2="top-paid",U2="top-free",G2="top-free-safari-extensions",j2="top-paid-safari-extensions",V2="top-trending-free",H2="top-trending-paid",q2="top-emerging-free",W2="top-emerging-paid"
class z2{constructor(e,t,n,r){this.$kind="GameCenterGameplayHistory",this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class Y2{constructor(e,t){this.$kind="GameCenterGameplayHistoryRecord",this.playerId=e,this.timestamp=t}}class J2 extends CW{constructor(e){super(),this.$kind="CrossfireReferralAction",this.actionClass="CrossfireReferralAction",this.referrerData=e}}class K2{supports(e,t,n,r){return this._supports(e,t,n,r)}_supports(e,t,n,r){const o=this.supportedFeaturedContentIds.has(n)
let s
return s=!i(r)||this.supportedNativeGroupingShelfIds.has(r),o&&s}createShelf(e,t,n,o,a){var c,l,u
const d=t,f=this.initialShelfDataFromGroupingMediaApiData(e,d),h=this.shelfTokenFromBaseTokenAndMediaApiData(e,d,o,n),p=this.shelfMetricsOptionsFromBaseMetricsOptions(e,h,a),w=s(p)
w&&this.shouldImpressShelf()&&bh(0,p,h.title),s(f.shelfContents)&&(f.shelfContents=wn(f.shelfContents,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(l=null==a?void 0:a.recoMetricsData)&&void 0!==l?l:{}))
const g=this._createShelf(e,h,f,n)
if(w&&this.shouldImpressShelf()&&(Ph(p.locationTracker),i(g)&&(Mh(e,g,p),(null===(u=g.url)||void 0===u?void 0:u.length)>0&&s(g.impressionMetrics)&&h.showingPlaceholders))){const e=g.url
try{const t=az.from(e).pathComponents().pop(),n=JSON.parse(decodeURIComponent(t))
n.originalPlaceholderShelfImpressionMetrics=g.impressionMetrics,function(e,t,n){const o=az.from(t.url),i=az.from(Ki(0,t,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,g,n)}catch{g.url=e}}return this.finalizeInitialShelfForDisplay(e,g,h,f,n),w&&this.shouldPrepareLocationTrackerForNextPosition()&&Oh(n.metricsLocationTracker),g}constructor(e){this.supportedFeaturedContentIds=new Set([]),this.supportedNativeGroupingShelfIds=new Set([]),this.builderClass=e}incompleteShelfFetchStrategy(e){return Xv.OnShelfWillAppear}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return n}shouldImpressShelf(){return!0}shouldPrepareLocationTrackerForNextPosition(){return!0}finalizeInitialShelfForDisplay(e,t,n,r,i){var a,c
if(o(t))return
n.isSearchLandingPage&&as(0,t,n),(null===(a=t.url)||void 0===a?void 0:a.length)>0&&s(i.additionalShelfParameters)&&(t.url=az.from(t.url).append(uj,i.additionalShelfParameters).build()),t.fetchStrategy=this.incompleteShelfFetchStrategy(e)
const l=(0,Hv.isSome)(t)&&(null===(c=t.url)||void 0===c?void 0:c.length)>0
o(t.items)&&!l&&(t.isHidden=!0),t.accessibilityMetadata=gc(e,t)}finalizeSecondaryShelfForDisplay(e,t,n,i){if(!o(t)){if(n.remainingItems.length){const t=n.remainingItems.map(e=>e.id)
e.console.warn("Could not load items for: "+t.join(","))}var a,c
if(t&&(t.mergeWhenFetched=((c=n).shelfStyle,!(c.showingPlaceholders||c.shelfStyle===mM||c.shelfStyle===HE&&(0,Hv.isSome)(c.initialHydratedItems)&&c.initialHydratedItems.length>0)),t.networkTimingMetrics=i.responseTimingValues,t.nextPreferredContentRefreshDate=null==(a={timeToLive:null,nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:!1})?void 0:a.nextPreferredContentRefreshDate),s(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])
!n.hasExistingContent&&o(t.items)&&(t.isHidden=!0),n.isSearchLandingPage&&as(0,t,n),t.accessibilityMetadata=gc(e,t)}}async handleShelf(e,t,n,r){const o=n[aV],i=JSON.parse(o)
i.isFirstRender=!1
try{const r=await this.secondaryShelfDataForShelfUrl(e,t,i,n),o=this._createShelf(e,i,r,null)
return this.finalizeSecondaryShelfForDisplay(e,o,i,r),o}catch(e){if(i&&!i.hasExistingContent){const e=new dJ(i.shelfStyle)
return e.isHidden=!0,e}throw e}}shelfRoute(e){return s(this.supportedNativeGroupingShelfIds)?function(e,t){const n=[]
for(const t of e)n.push(vc(-1,t,void 0))
return n}(this.supportedNativeGroupingShelfIds):mc(this.supportedFeaturedContentIds)}static async secondaryGroupingShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const r=function(e,t,n){var r
const o=(null===(r=t.relationshipToFetch)||void 0===r?void 0:r.length)>0
let i=At(n)
if(o){const r={}
for(const e of n.data)r[e.id]=e
i=[]
for(const n of t.remainingItems){const o=pe(e,n,t.relationshipToFetch)
s(o)&&(n.relationships[t.relationshipToFetch].data=[r[o.id]]),i.push(n)}}return i}(e,n,t)
return{shelfContents:r,responseTimingValues:t[mm.timingValues]}})}static async secondaryGroupingShelfMediaApiData(e,t,n,r){const o=t.build()
let i
return i=$i(e,t)?new dY(e,o):Qi(e,n),i?(i.includingAdditionalPlatforms(function(e){return ee(e)}(e)),i.includingAttributes(function(e){const t=[$q,iH,aH,yU]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}(e)),i.usingCustomAttributes(Ue(e)),i.attributingTo(t.build()),await Ln(e,i).then(e=>(Zi(n,i.ids),e))):await Promise.reject(new Error(`Could not construct media API request for: ${t}`))}}class Z2 extends K2{constructor(){super("GroupingGameCenterPopularWithYourFriendsController"),this.batchGroupKey=OV,this.supportedFeaturedContentIds=new Set([S0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isGameCenterPopularWithYourFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.gameCenter.fetchGamesPopularWithFriends(this.gameCategoryFilter(n.gamesFilter),30)
return await o.then(async t=>{const n=t.map(e=>this.gameplayHistoryFromData(e)).sort((e,t)=>t.records.length-e.records.length).filter(t=>this.isCompatibleGameCenterPlatform(e,t.platformId)).map(e=>e.adamId)
if(0===n.length){const e={shelfContents:[]}
return await Promise.resolve(e)}const r=new dY(e).withIdsOfType(n.slice(0,100),dW).includingAgeRestrictions()
return Xi(e,r),await Ln(e,r,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[mm.timingValues]}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Xv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingPopularWithFriendsShelfForGrouping(e,n,t):this.popularWithFriendsShelfForGrouping(e,n,t)}pendingPopularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelfForGrouping(e,t,n),o=az.from(Ji(n))
return r.url=o.param(zW.isGameCenterPopularWithYourFriendsShelf,pq).build(),r}popularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelf(e,t.shelfContents,n)
return r.mergeWhenFetched=!0,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header.title=n.title,r.header.subtitle=n.subtitle,r}popularWithFriendsShelf(e,t,n){const r=n.shelfStyle||oq,o=new dJ(r)
o.isHorizontal=!0
const s=[]
for(let o=0;o<t.length;o++){const a=t[o],c={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a),anonymizationOptions:{anonymizationString:`"GAME"${o+1}`}},artworkUseCase:Kd(0,r),canDisplayArcadeOfferButton:eh(0,r),shouldHideArcadeHeader:e.featureFlags.isEnabled(yJ)&&n.isArcadePage,shouldShowFriendsPlayingShowcase:!0},l=et(e,a,IB)
if(H(a,wq)||!l)continue
const u=Cd(e,a,c)
u.clickAction=yc(e,u.clickAction),i(u)&&(s.push(u),Oh(c.metricsOptions.locationTracker))}let a
switch(e.client.deviceType){case nW:a=2
break
case Kq:case lW:case"tv":a=6
break
default:a=0}if(o.header=oo(e),s.length<a)return o.isHidden=!0,o
if(o.items=s.slice(0,12),o.isHidden=!1,o.batchGroup=OV,s.length>12){const t=new dJ(oq)
t.items=s,t.rowsPerColumn=1
const r=new pJ([t])
r.title=n.title
const i=new EY(wW)
i.title=e.loc.string(cH),i.pageData=r,Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),fs(e,o,i)}return o.footerTitle=e.loc.string(G$),o.footerAction=ro({objectGraph:e,metricsLocationTracker:n.metricsLocationTracker,metricsPageInformation:n.metricsPageInformation}),o.footerStyle={$kind:QH,bundleID:EN,width:16,height:16},o}isCompatibleGameCenterPlatform(e,t){return 1===t}gameplayHistoryFromData(e){const t=f(e,FV),n=h(e,"platformId"),r=u(e,tR),o=this.gameplayHistoryRecordFromData(l(e,"records"))
return new z2(t,n,r,o)}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=f(e,"playerId"),n=h(e,"timestamp")
return new Y2(t,n)})}gameCategoryFilter(e){return e===TM?eR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:wV}}}class Q2 extends K2{constructor(){super("ArcadeDownloadPackShelfController"),this.shelfId="arcadeDownloadPackShelf",this.supportedFeaturedContentIds=new Set([L0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isArcadeDownloadPackShelfPlaceholder]}]}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return Ac(e,t,n,r)}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],categoriesContents:[],apps:[],title:""}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Wv.isNothing)(o)||0===o.apps.length)return{shelfContents:[],categoriesContents:[],apps:[],title:""}
const i=o.apps,s=this.shelfTitle(e,za(o.subscriptionStatus))
if((0,Wv.isSome)(t.query[zW.isArcadeDownloadPackShelfPlaceholder]))return{shelfContents:[],categoriesContents:[],apps:i,title:s}
const a=i.map(e=>e.adamId),c=i.map(e=>e.categoryId),l=dW,u=Xq,d=new dY(e).addingQuery(`ids[${l}]`,Array.from(a).join(",")).addingQuery(`ids[${u}]`,Array.from(c).join(",")).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e))
return await Ln(e,d).then(async e=>({shelfContents:e.data.filter(e=>e.type===l),categoriesContents:e.data.filter(e=>e.type===u),apps:i,title:s,responseTimingValues:e[mm.timingValues]}))}_createShelf(e,t,n,r){if(t.isFirstRender){const n=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Wv.isNothing)(n)||0===n.apps.length){const n=this.emptyShelfWithRefreshUrl(e)
return n.refreshUrl=this.shelfRefreshURL(t),Oh(r.metricsLocationTracker),n}{const o=this.placeholderShelf(e,t,n.apps,this.shelfTitle(e,za(n.subscriptionStatus)))
return Oh(r.metricsLocationTracker),o}}if(n.apps.length>0&&((0,Wv.isNothing)(n.shelfContents)||0===n.shelfContents.length))return this.placeholderShelf(e,t,n.apps,n.title)
{const r=this.shelfMetrics(n.title,t)
bh(0,r,n.title)
const o=this.downloadPackShelf(e,t,n)
return o.refreshUrl=this.shelfRefreshURL(t),Ph(t.metricsLocationTracker),Mh(e,o,r),o}}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return null}emptyShelfWithRefreshUrl(e){const t=new dJ(this.useCustomDownloadPackCardShelf(e)?mM:Iq)
return t.id=this.shelfId,t.isHidden=!0,t}placeholderShelf(e,t,n,r){const o=this.useCustomDownloadPackCardShelf(e)?this.downloadPackCardPlaceholderShelf(e,t,n.length):this.smallLockupsPlaceholderShelf(e,t,n)
return o.url=az.from(Ji(t)).build(),o.title=r,o}downloadPackCardPlaceholderShelf(e,t,n){const r=new dJ(mM)
r.id=this.shelfId
const o=new P2
return o.numberOfPlaceholders=n,r.items=[o],t.shelfStyle=r.contentType,r}smallLockupsPlaceholderShelf(e,t,n){const r=new dJ(Iq)
return r.id=this.shelfId,r.items=[],r.isHorizontal=!0,r.rowsPerColumn=2,r.items=Array(n.length).fill(new I2),r.placeholderContentType=r.contentType,r.contentType=IN,t.showingPlaceholders=!0,t.remainingItems=n.map(e=>({id:e.adamId,type:dW})),r}downloadPackShelf(e,t,n){const r=this.categoriesMapFromResponse(e,n.categoriesContents,n.apps),o=this.useCustomDownloadPackCardShelf(e),i=o?mM:Iq,s=this.lockupsFromResponse(e,t,r,o,o,Kd(0,i),(0,Wv.isSome)(n.shelfContents)?n.shelfContents:[],n.apps),a=new dJ(i)
if(a.id=this.shelfId,a.title=n.title,o){const e=new P2
e.lockups=s,a.items=[e]}else a.items=s,a.isHorizontal=!0,a.rowsPerColumn=2
return a.isHidden=0===s.length,a}useCustomDownloadPackCardShelf(e){return e.client.isPhone}shelfRefreshURL(e){return az.from(Ji(e)).param(zW.isArcadeDownloadPackShelfPlaceholder,pq).build()}lockupsFromResponse(e,t,n,r,o,i,s,a){return qv.context("lockupsFromResponse",()=>{const c=new Map
for(const e of s)c.set(e.id,e)
const l=t.metricsLocationTracker,u=t.metricsPageInformation,d=[]
for(const t of a){const s=c.get(t.adamId)
if((0,Wv.isNothing)(s))continue
const a=Cd(e,s,{offerStyle:o?Pj:void 0,offerEnvironment:o?Gq:void 0,metricsOptions:{pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},metricsClickOptions:{id:s.id,pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},artworkUseCase:i,shouldHideArcadeHeader:!0,isSubtitleHidden:r});(0,Wv.isNothing)(a)||(Jd(a,e),Oh(l),r?a.heading=n.get(a.adamId):a.subtitle=n.get(a.adamId),d.push(a))}return d})}categoriesMapFromResponse(e,t,n){const r=new Map
for(const o of n){const n=t.find(e=>e.id===o.categoryId)
if(!n)continue
const i=zf(e,n,fW)
r.set(o.adamId,i)}return r}shelfTitle(e,t){return e.loc.string(t===ZN?"Arcade.DownloadPack.ShelfTitle.NewUser":"Arcade.DownloadPack.ShelfTitle")}shelfMetrics(e,t){return{id:t.id,kind:null,softwareType:vq,targetType:dq,title:e,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:wV,fcKind:t.featuredContentId}}}class X2 extends K2{constructor(){super("GroupingAppEventShelfController"),this.supportedFeaturedContentIds=new Set([519,O0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
if(!((null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0)){const t=[],r=[],o=[]
for(const e of n.remainingItems)switch(e.type){case TV:r.push(e)
break
case VV:o.push(e)
break
case iW:t.push(e)}const i=new dY(e,t)
Je(e,i,t)
const s=new dY(e,r)
Je(e,s,r)
const a=new dY(e,o)
Je(e,a,o)
const c=await Promise.all([this.fetchRemainingItems(e,i),this.fetchRemainingItems(e,s),this.fetchRemainingItems(e,a)]),l={...c[0],...c[1],...c[2]},u=[]
for(const e of n.remainingItems){const t=l[e.id];(0,Hv.isSome)(t)&&u.push(t)}return Zi(n,new Set([...a.ids,...s.ids,...i.ids])),{shelfContents:u}}try{const o=await K2.secondaryGroupingShelfMediaApiData(e,t,n,r),s=yt(e,o),a=this.initialShelfDataFromGroupingMediaApiData(e,s)
a.responseTimingValues=o[mm.timingValues]
const c=j(s,Yi(0,n.featuredContentId))
return i(c)&&(null==c?void 0:c.length)>0&&(a.shelfTitle=c),a}catch{return{shelfContents:[]}}}async fetchRemainingItems(e,t){const n={}
if(t.ids.size>0){Xi(e,t)
try{await Ln(e,t).then(e=>{(e=>{for(const t of e.data)n[t.id]=t})(e)})}catch(n){e.console.error("Error fetching remaining items",t.ids)}}return n}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=n.featuredContentId===O0
let i=null
const a=this.initialShelfDataFromGroupingMediaApiData(e,t)
o&&s(a.shelfContents)&&(i=this.personalizedDataResultFromDataItems(e,a.shelfContents))
const c={...n,shouldPersonalizeData:o,personalizedDataResult:i},l=s(a.shelfContents),u=!H(t,Tb)
return!l&&u?(c.recommendationsHref=t.href,c.isValidRecommendationsShelf=!0):c.isValidRecommendationsShelf=l,c}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(s(t.personalizedDataResult)){const e=yh(n.recoMetricsData,t.personalizedDataResult.processingType,null)
r.recoMetricsData=e}return r}_createShelf(e,t,n,i){var a
if(!oi(e))return null
if(!t.isValidRecommendationsShelf)return null
const c={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:t.metricsPageInformation.recoMetricsData}
let l=n.shelfContents
s(t.personalizedDataResult)&&t.isFirstRender&&(l=t.personalizedDataResult.personalizedData)
const u=[]
for(const e of l)r(e.attributes)||zi(t)?(t.isDeferring=!0,t.remainingItems.push(e)):u.push(e)
const d=hi(e,u,null,!1,!1,c,!1,!0,t.isArcadePage,!1)
Br(d.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const f=d.appPromotions,h=new dJ(OO)
return h.isHorizontal=!0,h.title=null!==(a=n.shelfTitle)&&void 0!==a?a:t.title,h.items=f,o(h.items)&&t.isFirstRender&&ec(e,h,t,t.featuredContentId),h.url=Ki(0,h,t),o(h.items)&&o(h.url)?t.isFirstRender?null:X2.makeHiddenShelf(t):h}personalizedDataResultFromDataItems(e,t){const n=new Set
for(const e of t){const t=f(e,PU);(null==t?void 0:t.length)>0&&n.add(t)}const r=bs(e,n)
return As(e,bb,t,!1,r,null,null,null,!0)}static makeHiddenShelf(e){const t=new dJ(e.shelfStyle)
return t.isHidden=!0,t}}class e4{constructor(){this.$kind="ArcadeFooter"}}class t4{constructor(e){this.$kind="Footnote",this.text=e,this.presentationStyle=[],this.clickAction=null}}class n4 extends K2{constructor(){super("GroupingArcadeFooterShelfController"),this.supportedFeaturedContentIds=new Set([-1]),this.supportedNativeGroupingShelfIds=new Set([1])}shouldImpressShelf(){return!1}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:bt(t),responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=so(e,this.numberOfIconsForArcadeAppGrid(e.client.deviceType))
return await Ln(e,o).then(t=>{const n=this.initialShelfDataFromGroupingMediaApiData(e,t)
return n.responseTimingValues=t[mm.timingValues],n})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldIncludeShelfUrl:n.isFirstRender}
return o.showingPlaceholders=n.isFirstRender,o}_createShelf(e,t,n,o){const i=new e4,a=new dJ(ME)
a.items=[i]
const c={targetType:lb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(p$),id:t.id,kind:ub,softwareType:vq}
Mh(e,i,c),bh(0,c,c.title),i.buttonAction=eo(e,cU,t.metricsPageInformation,t.metricsLocationTracker)
const l={targetType:hW,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:i.buttonAction.title,id:PA,kind:hW,softwareType:vq}
Mh(e,i.buttonAction,l),Ph(c.locationTracker)
const u=e.bag.termsAndConditionsURL
if(!r(u)&&"tv"!==e.client.deviceType){const t=e.loc.string(GE),n=new GY(u),r=new t4(t)
r.clickAction=n,r.presentationStyle=[cM,lM,uM],i.footnote=r}if(a.background={type:PV,color:Se(uE)},s(n.shelfContents)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
i.icons=Xd(e,n.shelfContents,r,{useCase:y6.LockupIconMedium})}else i.icons=[]
return t.shouldIncludeShelfUrl&&(a.url=Ji(t)),a}numberOfIconsForArcadeAppGrid(e){return e===nW?9:20}}class r4{constructor(){this.$kind="Brick",this.artworks=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=mq,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null,this.editorialDisplayOptions={},this.artworkSafeArea=null,this.textSafeArea=null}isValid(){var e,t,n,r
const o=null!==(t=null===(e=this.artworks)||void 0===e?void 0:e.every((e,t)=>(0,Hv.isSome)(e)&&e.isValid()))&&void 0!==t&&t,i=(null!==(r=null===(n=this.collectionIcons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0,s=(0,Hv.isSome)(this.backgroundColor)
return(0,Hv.isSome)(this.clickAction)&&(o||i||s)}}!function(e){e.TopRight="topRight",e.TopLeft="topLeft",e.MiddleLeft="middleLeft"}(Mm||(Mm={})),function(e){e.SquareByWidth="squareByWidth",e.SquareByHeight="squareByHeight",e.FreeForm="freeForm"}(xm||(xm={}))
class o4{constructor(e,t,n,r,o){this.width=e,this.height=t,this.asRatioOfSize=null!=n&&n,this.location=r,this.constraint=o}}o4.defaultTileArtworkSafeArea={width:.4,height:.4,asRatioOfSize:!0,constraint:xm.SquareByWidth,location:{relativeLocation:Mm.TopRight}},o4.defaultPillArtworkSafeArea={width:.28,height:1,asRatioOfSize:!0,constraint:xm.FreeForm,location:{relativeLocation:Mm.MiddleLeft}},o4.defaultTileTextSafeArea={width:.15,height:0,asRatioOfSize:!0},o4.defaultPillTextSafeArea={width:.28,height:0,asRatioOfSize:!0}
class i4 extends K2{constructor(){super("GroupingBrickShelfController"),this.supportedFeaturedContentIds=new Set([h0,p0,w0,t0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,oH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(e=>({shelfContents:ss(e.shelfContents,we(n.featuredContentData,oH))}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,Sb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Fr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,CH)===WH
let d
if(l){d=new dJ(U$)
const n=h(t.featuredContentData.attributes,Pb)
d.rowsPerColumn=null!=n?n:Z(e),Ch(t.metricsLocationTracker).name=KE}else d=new dJ(gG)
d.isHorizontal=!0
for(const n of r.shelfContents){const r=i4.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s)
r?(a.push(r),Oh(t.metricsLocationTracker)):c.push(n)}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[oH].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,yM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const p=u(t.featuredContentData.attributes,ZE)
if(l&&p){const n=new dJ(U$)
n.items=this.sortCategories(e,a),n.presentationHints={isSeeAllContext:!0}
const r=new pJ([n])
r.title=t.title
const o=new EY(wW)
o.title=e.loc.string(cH),o.pageData=r,d.seeAllAction=o,Xs(e,o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}const w=d&&o(d.items)&&t.isFirstRender
if(w&&ec(e,d,t,t.featuredContentId),!w&&i4.shouldDisplayChooseYourFavoritesBrick(e,t,l,s)){const n=i4.createChooseYourFavoritesBrick(e,t.metricsPageInformation,t.metricsLocationTracker)
d.items.splice(0,0,n)}return t.presentationHints=d.presentationHints,d.url=Ki(0,d,t),d}static shouldDisplayChooseYourFavoritesBrick(e,t,n,r){return t.isArcadePage&&n&&e.featureFlags.isEnabled(OJ)&&(0,Hv.isSome)(null==r?void 0:r.additionalShelfParameters)&&((null==r?void 0:r.additionalShelfParameters.isSubscribed)===pq||(null==r?void 0:r.additionalShelfParameters.isTrialEnrolled)===pq)}static createBrick(e,t,n,r,o,s,a){const c={targetType:n?Vj:gG,pageInformation:r,locationTracker:o,recoMetricsData:St(t)},l=os(e,t,s,!1,null,c,a)
if(!l)return null
const u=new r4,d={useCase:y6.GroupingBrick}
if(n){const t=ef(e,l.content,Nm.categoryBreakout,Jv.Density1)
u.artworks=t}else if(l.artwork&&(null==s?void 0:s.featuredContentId)!==t0){let t=p(l.artwork,iM)
t||(t=p(l.artwork,"originalFlowcaseBrick"))
const n=ts(e,t,d)
u.artworks=[n]}else{const n=ns(e,t,1060,520,d)
u.artworks=[n]}u.accessibilityLabel=l.title,u.shortEditorialDescription=l.title,u.clickAction=l.action,435===q(t,zj)&&(u.personalizationStyle=ON)
const f=pe(e,t,uW)
if(i(f)){const n=Js(e,f,c)
u.flowPreviewActionsConfiguration=oa(e,t,!0,null==s?void 0:s.clientIdentifierOverride,u.clickAction,c,n)}return Mh(e,u,Bh(e,t,l.title,c)),u.artworkSafeArea=o4.defaultTileArtworkSafeArea,u.textSafeArea=o4.defaultTileTextSafeArea,u.isValid()?u:null}static createChooseYourFavoritesBrick(e,t,n){const r=new r4,o=new pz("",1060,520,[],ye("efac78"))
r.artworks=[o]
const i=e.loc.string("ARCADE_CHOOSE_YOUR_FAVORITES_BRICK_TITLE")
r.accessibilityLabel=i,r.shortEditorialDescription=i
const s=new EY(pB)
var a
return s.presentationContext=Wj,s.pageData=qq,r.clickAction=s,Mh(e,r,(a={targetType:gG,pageInformation:t,locationTracker:n,recoMetricsData:null},qv.context("impressionOptionsForArcadeChooseYourFavoritesBrick",()=>({...a,id:"",kind:null,softwareType:null,title:"choose_your_games_brick"})))),r.artworkSafeArea=o4.defaultTileArtworkSafeArea,r.textSafeArea=o4.defaultTileTextSafeArea,r}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,CH)===WH&&(r.title=KE),r}sortCategories(e,t){return t.sort((t,n)=>{try{return t.shortEditorialDescription.localeCompare(n.shortEditorialDescription,e.loc.safeIdentifier,{usage:JV})}catch(e){return 0}})}}class s4 extends K2{constructor(){super("GroupingCategoryShelfController"),this.supportedFeaturedContentIds=new Set([v0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=pe(e,t,oH)
return n?{shelfContents:we(n,oH)}:{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(t=>{const r=pe(e,n.featuredContentData,oH)
return r?{shelfContents:ss(t.shelfContents,we(r,oH))}:{shelfContents:[]}})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,i){var a
if(o(n.shelfContents))return null
const c=[]
let l=!1
for(const o of n.shelfContents){const n=pe(e,o,Jj)
if(r(n))continue
const a=ls(0,n)
if(r(o.attributes)||r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const d={targetType:LB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)},f=Fd(e,n,{...d,id:a},t.clientIdentifierOverride)
Mh(e,f,{...d,kind:Mq,softwareType:u(null==i?void 0:i.isArcadePage)?vq:null,title:f.title,id:a})
const h=B(n,oW)
h.width>h.height&&(l=!0),s(h)&&(f.artwork=Zd(e,h,{allowingTransparency:!0,useCase:y6.CategoryIcon})),c.push(f),Oh(t.metricsLocationTracker)}const d=this.shelfForCategoryActions(e,c,t)
if(d.title=t.title,d.subtitle=t.subtitle,d.url=Ki(0,d,t),l){const e=null!==(a=d.presentationHints)&&void 0!==a?a:{}
d.presentationHints={...e,itemsHaveRectangularArtwork:!0}}return d}shelfForCategoryActions(e,t,n){const r=new dJ(eq)
let o
switch(e.client.deviceType){case"tv":r.isHorizontal=!0,o=8
break
case lW:r.isHorizontal=!1,o=null
break
case LV:r.isHorizontal=!0,r.rowsPerColumn=3,o=24
break
default:r.isHorizontal=!1,o=6}if(null!==o&&t.length>o){r.items=t.slice(0,o)
const i=new EY(wW)
i.title=e.loc.string(cH),Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),r.seeAllAction=i
const s=new dJ(eq)
s.isHorizontal=!1,this.sortCategories(e,t),s.items=t
const a=new pJ([s])
a.title=e.loc.string("PAGE_TITLE_CATEGORIES"),i.pageData=a}else r.items=t
return r}sortCategories(e,t){t.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:JV})}catch(e){return 0}})}}class a4{constructor(){this.$kind="EditorialCard",this.adamId=void 0,this.caption=null,this.title=void 0,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.decorations=[],this.flowPreviewActionsConfiguration=null,this.appEventFormattedDates=null,this.mediaOverlayStyle=null}isValid(){return!!(this.clickAction&&this.artwork&&this.artwork.isValid()&&this.caption&&this.title)}}class c4 extends K2{constructor(){super("GroupingEditorialCardShelfController"),this.supportedFeaturedContentIds=new Set([c0,l0,k0,u0,e0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,oH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){const i=new dJ(vb)
i.isHorizontal=!0
const s=this.personalizationDataContainerForEditorialCardItemsDataArray(e,n.shelfContents),a=[]
for(const i of n.shelfContents){const n=c4.makeEditorialCard(e,i,s,r,t)
!o(n)&&n.isValid()&&(a.push(n),Oh(t.metricsLocationTracker))}return delete t.maxItemCount,i.items=a,i.url=Ki(0,i,t),i}static makeEditorialCard(e,t,n,o,s){var a,c,l
const u={targetType:ZU,pageInformation:null==s?void 0:s.metricsPageInformation,locationTracker:null==s?void 0:s.metricsLocationTracker,recoMetricsData:St(t),id:t.id,idType:SU},d=q(t,zj),h=os(e,t,s,d===k0,n,u,o,()=>{null==s||s.remainingItems.push(t)})
if(!h)return null;(null===(c=null===(a=h.content)||void 0===a?void 0:a.id)||void 0===c?void 0:c.length)>0&&(u.id=h.content.id,u.idType=Sq,u.adamId=h.content.id)
const w=new a4
let g=j(t,"designBadge")
g||(g=h.caption),w.caption=g
let v=j(t,Nq)
v||(v=h.title),w.title=v
let m=us(j(t,QE))
m||(m=h.subtitle),w.subtitle=m
const y={useCase:y6.GroupingHero,withJoeColorPlaceholder:!0}
if(h.artwork&&(null==s?void 0:s.featuredContentId)!==e0){let t=p(h.artwork,iM)
r(t)&&i(h.appEvent)&&(t=p(h.artwork,"eventCard")),w.artwork=ts(e,t,y)}else w.artwork=ns(e,t,416,204,y)
if(w.clickAction=h.action,i(h.appEvent)&&(w.appEventFormattedDates=h.appEvent.formattedDates),w.lockup=h.lockup,i(w.artwork)&&i(w.artwork.backgroundColor)){const e=be(w.artwork.backgroundColor)
if(w.mediaOverlayStyle=e?Gq:hq,i(w.lockup)&&i(w.lockup.offerDisplayProperties)){const t=e?Gq:hq
w.lockup.offerDisplayProperties=w.lockup.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,Pj,t)}}w.adamId=f(h.content,"id")
const A=pe(e,t,uW)
if(i(A)){const n=Js(e,A,u)
n.targetType=u.targetType,w.flowPreviewActionsConfiguration=oa(e,t,!1,null==s?void 0:s.clientIdentifierOverride,w.clickAction,u,n)}const T=Bh(e,null!==(l=h.content)&&void 0!==l?l:t,h.title,u)
if(i(h.onDevicePersonalizationDataProcessingType)){const e=yh(T.recoMetricsData,h.onDevicePersonalizationDataProcessingType,null)
T.recoMetricsData=e}return i(h.appEvent)&&(T.inAppEventId=h.appEvent.appEventId,i(h.appEvent.lockup)&&(T.relatedSubjectIds=[h.appEvent.lockup.adamId])),i(s)&&Mh(e,w,T),w}personalizationDataContainerForEditorialCardItemsDataArray(e,t){var n,r
if(!Ts(e))return null
const o=new Set
for(const e of t){const t=q(e,zj)===k0,i=(null===(n=f(e,Wq))||void 0===n?void 0:n.length)>0,s=(null===(r=j(e,Ib))||void 0===r?void 0:r.length)>0,a=de(e,uW,!1)
if(t&&!i&&!s&&a){const t=we(e,uW)
for(const e of t){const t=f(e,PU);(null==t?void 0:t.length)>0&&o.add(t)}}}return bs(e,o)}}class l4{constructor(e,t,n,r,o,i,s){this.$kind="EditorialStoryCard",this.title=e,this.artwork=t,this.video=n,this.heading=r,this.badge=o,this.description=i,this.clickAction=s,this.shelfBackground=null,this.collectionIcons=null,this.editorialDisplayOptions={}}}class u4 extends K2{constructor(){super("GroupingEditorialStoryCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}shelfRoute(e){return mc(this.supportedFeaturedContentIds,["shelfContentType=editorialStoryCard"])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&cs(0,j(t,CH))===XE}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,oH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,CH)
return o.shelfStyle=cs(0,i),o}_createShelf(e,t,n,r){const i=[]
for(const r of n.shelfContents){if(!W(r)||zi(t)){t.remainingItems.push(r),t.isDeferring=!0
continue}const n=u4.makeStoryCard(e,r,t)
o(n)||(i.push(n),Oh(t.metricsLocationTracker))}const s=new dJ(t.shelfStyle)
return s.title=t.title,s.items=i,s.isHorizontal=!0,s.background={type:sM},s.url=Ki(0,s,t),s.isHorizontal=!0,s}static makeStoryCard(e,t,n){let s=B(t,"editorialArtwork.subscriptionHero")
o(s)&&(s=B(t,AM))
const a=Zd(e,s,{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:y6.TodaySmallStoryCard})
if(r(a))return null
const c=j(t,oV),l=j(t,YH),u=j(t,$E),d=new l4(c,a,null,l,{type:QV,title:l},u),f=go(e,t,null,new BZ(null==n?void 0:n.metricsPageInformation,null==n?void 0:n.metricsLocationTracker))
i(f)&&(d.clickAction=f.clickAction)
const h=be(a.backgroundColor)?Gq:hq
return d.shelfBackground={type:oW,artwork:a,style:h},d}}class d4 extends CW{constructor(){super(...arguments),this.$kind="GameCenterDashboardAction",this.actionClass="GameCenterDashboardAction"}}class f4 extends K2{constructor(){super("GroupingGameCenterActivityFeedController"),this.batchGroupKey=OV,this.supportedFeaturedContentIds=new Set([E0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isGameCenterActivityFeedShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],activities:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=this.gameCategoryFilter(n.gamesFilter)
return await e.gameCenter.fetchActivityFeedCards(o,20).then(e=>({shelfContents:[],activities:e}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Xv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingActivityFeedShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.activityFeedShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingActivityFeedShelfForGrouping(e,t,n){if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const r=this.activityFeedShelfForGrouping(e,{shelfContents:[],activities:[]},t,n),o=az.from(Ji(t))
return r.url=o.param(zW.isGameCenterActivityFeedShelf,pq).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}activityFeedShelfForGrouping(e,t,n,r){if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const o=this.activityFeedShelf(e,t.activities,n,r),i=e.loc.string("Arcade.ActivityFeed.RecentActivity")
return o.header=oo(e,i),fs(e,o,o.seeAllAction),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o}activityFeedShelf(e,t,n,r=!1){const o=new dJ("gameCenterActivityFeedCard")
let i
return o.isHorizontal=!0,o.mergeWhenFetched=!0,o.batchGroup=this.batchGroupKey,o.items=t,o.isHidden=0===o.items.length,t.forEach((t,o)=>{const i={id:"friendActivity",idType:rW,targetType:"chiclet",kind:null,softwareType:r?vq:null,title:"",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}
Mh(e,t,i)
const s=new TW,a=new TW,c=new TW,l=new TW,u=new TW;[{targetId:"playerName",metrics:s},{targetId:"profileImage",metrics:a},{targetId:"leaderboardAchievement",metrics:c},{targetId:IU,metrics:l},{targetId:t.adamID||"gameIcon",metrics:u}].forEach(t=>function(e,t,n,r,o){const i={actionType:pW,id:r,idType:rW,location:Th(0,o,n)},s=_t(e,r,Mq,i)
t.addMetricsData(s)}(e,t.metrics,n.title,t.targetId,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),t.profileActionMetrics=s,t.profileAvatarActionMetrics=a,t.leaderboardActionMetrics=c,t.achievementActionMetrics=l,t.appActionMetrics=u,Oh(n.metricsLocationTracker)}),e.featureFlags.isGSEUIEnabled($J)||(i=new d4,i.title=e.loc.string("Arcade.ActivityFeed.AllActivity",e.loc.string(cH)),Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),o.seeAllAction=i,o}gameCategoryFilter(e){return e===TM?eR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,title:"Friend Activity",badges:{gameCenter:!0},idType:cb}}}class h4{constructor(){this.$kind="VideoCard",this.flowPreviewActionsConfiguration=null}}class p4 extends K2{constructor(){super("GroupingGameCenterContinuePlayingShelfController"),this.batchGroupKey="gameCenterContinuePlaying",this.supportedFeaturedContentIds=new Set([C0])}_supports(e,t,n,r){return super._supports(e,t,n,r)&&this.supportsVideoCardShelf(e,e.host.platform)}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isGameCenterContinuePlayingShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=Date.now(),i=this.maximumNumberOfRecentGamesToRequest(),s=e.gameCenter.fetchRecentlyPlayedGamesWithinSeconds(this.gameCategoryFilter(n.gamesFilter),i,e.bag.recentlyPlayedGamesWindowInSeconds)
return await s.then(async t=>{const n=Date.now()
let r
if(e.console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-o).toString(10)+" milliseconds."),0===t.length){const e={shelfContents:[]}
return await Promise.resolve(e)}{const n=new dY(e).withIdsOfType(t.slice(0,this.maximumNumberOfRecentGamesToShow()),dW).includingAgeRestrictions()
Xi(e,n),r=Ln(e,n,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[mm.timingValues]}))}return await r})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Xv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingContinuePlayingForGrouping(e,t):this.continuePlayingShelfForGrouping(e,n.shelfContents,t)}pendingContinuePlayingForGrouping(e,t){const n=this.continuePlayingShelfForGrouping(e,[],t)
if(!n)return null
const r=az.from(Ji(t))
return n.url=r.param(zW.isGameCenterContinuePlayingShelf,pq).build(),n.batchGroup=this.batchGroupKey,n}continuePlayingShelfForGrouping(e,t,n){return qv.context("continuePlayingShelfForGrouping",()=>{const r=this.videoCardContinuePlayingShelf(e,t,n)
return r.mergeWhenFetched=!1,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header=oo(e,e.loc.string(Cb),n.subtitle),r})}supportsVideoCardShelf(e,t){switch(t){case dV:case qG:case jV:return!0
default:return!1}}videoCardContinuePlayingShelf(e,t,n){return qv.context("videoCardContinuePlayingShelf",()=>{const r=new dJ(kb)
r.isHorizontal=!0,r.batchGroup=this.batchGroupKey
const o=[]
for(const r of t){if(at(e,r))continue
const t=this.editorialSplashVideoCardForContinuePlaying(e,r,n)
t&&o.push(t)}return r.items=o,r})}editorialSplashVideoCardForContinuePlaying(e,t,n){return qv.context("editorialSplashVideoCardForContinuePlaying",()=>{var r
const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:tW},i=e.featureFlags.isEnabled(yJ)&&u(n.isArcadePage),s=qf(e,t),a={metricsOptions:o,artworkUseCase:y6.LockupIconSmall,offerEnvironment:Gq,offerStyle:uq,canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:i,isSubtitleHidden:s&&!i},c=this.editorialSplashVideoWithTopShelfStill(e,t)
if(!c||!c.preview)return null
const l=Cd(e,t,a)
if(!l)return null
l.clickAction=yc(e,l.clickAction)
const d=this.clickActionForVideoCard(e,t,e.host.platform,o,n.clientIdentifierOverride)
if(!d)return null
const f=new h4
f.video=c,f.lockup=l,f.overlayStyle=Gq,f.clickAction=d
const h=Js(e,t,o)
f.flowPreviewActionsConfiguration=oa(e,t,!0,n.clientIdentifierOverride,f.clickAction,o,h)
const p=Bh(e,t,l.title,o)
return Mh(e,f,p),null===(r=f.impressionMetrics)||void 0===r||delete r.fields[Ob],f})}editorialSplashVideoWithTopShelfStill(e,t){return qv.context("editorialSplashVideoWithTopShelfStill",()=>{let n=null
const r=Ke(e,t,mE)
return i(r)&&(n=Zd(e,r,{withJoeColorPlaceholder:!0,useCase:y6.VideoCardStill,cropCode:"sr"})),Lf(e,t,n)})}clickActionForVideoCard(e,t,n,r,o){let i=Fd(e,t,Js(e,t,r),o)
if(i=yc(e,i),n===qG){const n=new JJ(t.id,Jq)
Qs(e,n,{actionType:qV,id:t.id,contextualAdamId:t.id,anonymizationOptions:r.anonymizationOptions,pageInformation:r.pageInformation,locationTracker:r.locationTracker})
const o=new VY(t.id,i)
return o.openAction=n,o.cancelAction=i,o}return i}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}gameCategoryFilter(e){return e===TM?eR:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:wV,title:e.loc.string(Cb)}}}class w4 extends CW{constructor(e){super(),this.$kind="GameCenterAchievementsAction",this.actionClass="GameCenterAchievementsAction",this.bundleId=e}}class g4{constructor(e,t,n,r,o,i,s,a,c){this.$kind="GameCenterReengagement",this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class v4{constructor(e){this.$kind="GameCenterAchievementStatus",this.type=e}}class m4{constructor(e,t,n,r){this.$kind="GameCenterAchievement",this.id=e,this.title=t,this.subtitle=n,this.status=r}}class y4 extends K2{constructor(){super("GroupingGameCenterReengagementShelfController"),this.batchGroupKey=OV,this.supportedFeaturedContentIds=new Set([494])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isGameCenterReengagementShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],achievementData:null,achievementSummaryData:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchRengagementDataForLocalPlayer().then(async t=>{const n=f(t,FV),r=y(t[IU]),i=y(t.achievementSummary)
if(o(n)){const e={shelfContents:[],responseTimingValues:null,achievementData:null,achievementSummaryData:null}
return await Promise.resolve(e)}const s=new dY(e).withIdOfType(n,dW).includingAgeRestrictions()
return Xi(e,s),await Ln(e,s,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[mm.timingValues],achievementData:r,achievementSummaryData:i}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingGameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage):this.gameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage)}pendingGameCenterReengagementShelf(e,t,n,r){const o=this.gameCenterReengagementShelf(e,t,n,r)
if(!o)return null
const i=az.from(Ji(n))
return o.url=i.param(zW.isGameCenterReengagementShelf,pq).build(),o.batchGroup=this.batchGroupKey,o}gameCenterReengagementShelf(e,t,n,r=!1){return qv.context("gameCenterReengagementShelf",()=>{if(!s(t.shelfContents))return null
const o=new dJ("gameCenterReengagement")
o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=this.batchGroupKey
const i={id:n.id,kind:null,softwareType:r?vq:null,targetType:Hq,title:Eb,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:wV,fcKind:n.featuredContentId,badges:{gameCenter:!0}},a=_f(e,t.shelfContents[0],y6.Uber)
let c=Se("componentBackground"),l=null
s(a)&&(l=a.preview,c=l.backgroundColor)
const u={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},offerStyle:uq,artworkUseCase:Kd(0,Iq),isSubtitleHidden:!0}}
bh(0,i,i.title)
const d=$d(e,t.shelfContents,u)[0]
d.clickAction=yc(e,d.clickAction),Ph(n.metricsLocationTracker)
let f=null
s(d)&&(f=new w4(d.bundleId),f.title=Eb,Qs(e,f,i))
const h=e.loc.string("GameCenter.Reengagement.Badge.GameCenter"),p=this.achievementFromData(e,t.achievementData),w=this.achievementCountsFromData(e,t.achievementSummaryData),g=this.shelfMetadataForAchievement(e,p,w),v=new g4("gamecenter.fill",h,g.title,g.subtitle,p,d,c,l,f)
return o.items=[v],Mh(e,v,i),o})}achievementStatusFromData(e,t){const n=f(t,kV),r=new v4(n)
return r.percent=h(t,"percent"),r.date=f(t,nR),r.artwork=new pz(f(t,"artwork.template"),h(t,"artwork.width"),h(t,"artwork.height"),[]),r}achievementFromData(e,t){const n=f(t,"id"),r=f(t,Nq),o=f(t,RH),i=this.achievementStatusFromData(e,p(t,"status"))
return new m4(n,r,o,i)}achievementCountsFromData(e,t){return{completed:h(t,"completedAchievements"),total:h(t,"totalAchievements")}}shelfMetadataForAchievement(e,t,n){if(!i(t))return{title:"",subtitle:null}
if(0===n.completed)return{title:e.loc.string("GameCenter.Reengagement.Achievement.First.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.First.Subtitle")}
switch(t.status.type){case bM:case"hidden":case Rb:return{title:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Subtitle")}
case RV:const t=e.loc.stringWithCount("GameCenter.AchievementSummary.TotalToCompleteCount",n.total),r=e.loc.stringWithCount("GameCenter.AchievementSummary.NumberCompletedCount",n.completed),o=e.loc.string("GameCenter.AchievementSummary.CompletedCount.Subtitle").replace("@@completedCount@@",r).replace("@@totalCount@@",t)
return{title:e.loc.string("GameCenter.Reengagement.Achievement.CompletedCount.Title"),subtitle:o}
default:return{title:"",subtitle:null}}}}class A4 extends CW{constructor(e){super(),this.$kind="GameCenterInvitePlayerAction",this.actionClass="GameCenterInvitePlayerAction",this.invitationType=e}}class T4 extends CW{constructor(e){super(),this.$kind="GameCenterDenylistPlayerAction",this.actionClass="GameCenterDenylistPlayerAction",this.contactId=e}}class b4{constructor(e,t,n,r,o,i,s,a){this.$kind="SmallContactCard",this.id=e,this.title=t,this.subtitle=n,this.buttonText=r,this.contactId=o,this.buttonAction=i,this.removeButtonAction=s,this.shouldShowMessagesBadge=a}}class S4 extends CW{constructor(e){super(),this.$kind="LegacyGameCenterInvitePlayerAction",this.actionClass="LegacyGameCenterInvitePlayerAction",this.contactId=e}}class P4 extends K2{constructor(){super("GroupingGameCenterSuggestedFriendsController"),this.batchGroupKey=OV,this.supportedFeaturedContentIds=new Set([P0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:OW,path:`/${xW.grouping}/${xW.shelf}/{token}`,query:[zW.isGameCenterSuggestedFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{$kind:SM,shelfContents:[],suggestedFriends:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchSuggestedFriends(10).then(t=>e.clientCapabilities.isEnabled(Db)?{$kind:SM,shelfContents:[],suggestedFriends:t}:{$kind:_b,shelfContents:[],suggestedFriends:t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Xv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingSuggestedFriendsShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.suggestedFriendsShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingSuggestedFriendsShelfForGrouping(e,t,n){if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const r=this.suggestedFriendsShelfForGrouping(e,{$kind:e.clientCapabilities.isEnabled(Db)?SM:_b,shelfContents:[],suggestedFriends:[]},t,n),o=az.from(Ji(t))
return r.url=o.param(zW.isGameCenterSuggestedFriendsShelf,pq).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}suggestedFriendsShelfForGrouping(e,t,n,r){if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
let o
return o=t.$kind===SM?this.suggestedFriendsShelf(e,t.suggestedFriends,n,r):this.legacySuggestedFriendsShelf(e,t.suggestedFriends,n,r),o.header=oo(e,n.title,n.subtitle),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o.footerTitle=e.loc.string(G$),o.footerAction=ro({objectGraph:e,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker}),o.footerStyle={$kind:QH,bundleID:EN,width:16,height:16},o}suggestedFriendsShelf(e,t,n,r=!1){const o=Lb
if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const i=new dJ(Mb)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=OV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i],l=e.loc.string(xb),u=e.loc.string($b),d={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
let f,h
c.supportsFriendingViaPush&&c.contactAssociationID?(f={contact:{contactID:c.contactID,contactAssociationID:c.contactAssociationID}},h=!1):(f={messages:{contactID:c.contactID}},h=!0)
const p=new A4(f)
Qs(e,p,{...d,actionType:Fb})
const w=new T4(c.contactID)
Qs(e,w,{...d,actionType:Nb})
const g={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Bb,softwareType:r?vq:null,anonymizationOptions:{anonymizationString:a}},v=new b4(c.contactID,c.fullName,u,l,c.contactID,p,w,h)
Mh(e,v,g),s.push(v),Oh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}legacySuggestedFriendsShelf(e,t,n,r=!1){const o=Lb
if(e.client.deviceType!==nW&&e.client.deviceType!==Kq)return null
const i=new dJ(Mb)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=OV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i]
c.buttonText=e.loc.string(xb),c.subtitle=e.loc.string($b)
const l={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
c.buttonAction=new S4(c.contactId),Qs(e,c.buttonAction,{...l,actionType:Fb}),c.removeButtonAction=new T4(c.contactId),Qs(e,c.removeButtonAction,{...l,actionType:Nb}),Mh(e,c,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Bb,softwareType:r?vq:null,anonymizationOptions:{anonymizationString:a}}),s.push(c),Oh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:wV}}}class I4{constructor(){this.$kind="HeroCarousel",this.items=[],this.rtlItems=[]}}class C4{constructor(){this.$kind="HeroCarouselItem"}isValid(){const e=(0,Hv.isSome)(this.collectionIcons)&&this.collectionIcons.length>0,t=(0,Hv.isSome)(this.artwork)&&this.artwork.isValid(),n=(0,Hv.isSome)(this.video),r=t||n||e,o=(0,Hv.isSome)(this.overlay)&&this.overlay.isValid()
return r&&o}}class k4{constructor(e){this.$kind="TitleEffect",this.isFallbackStyle=!1,this.type=e}}class O4{constructor(e,t,n){this.$kind="ArticlePage",this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class E4{constructor(e,t,n,r){this.$kind="RoundedButton",this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class R4{constructor(e,t,n=GV,r=null,o=null,i=null){this.$kind="FramedArtwork",this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===FF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class D4{constructor(e,t,n,r){this.$kind="Quote",this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class _4{constructor(e,t,n){this.$kind="HorizontalRule",this.style=e,this.color=t,this.isFullWidth=n}}class L4{constructor(e,t){this.$kind="AppShowcase",this.type=e,this.lockup=t}}class M4{constructor(e){this.$kind="InAppPurchaseShowcase",this.lockup=e}}class x4{constructor(e,t,n,r=!0){this.$kind="EditorialLink",this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class $4{constructor(e,t){this.$kind="ClientControlButton",this.title=e,this.buttonAction=t}}class F4{constructor(e,t){this.$kind="ArcadeShowcase",this.unsubscribedAction=e,this.subscribedAction=t}}class N4{constructor(e,t,n,r,o,i,s){this.$kind="UpsellBreakout",this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s}}class B4{constructor(e,t,n,r,o,i){this.$kind="BreakoutDetails",this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class U4 extends CW{constructor(e,t,n,r,o){super(),this.$kind="ArcadeAction",this.actionClass="ArcadeAction",this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n,this.paymentMetricsOverlay=o}}class G4{constructor(e){this.$kind="InlineTodayCards",this.cards=e}}new Set([oW,QN,fH,Yx,rq])
const j4=new Set([Aj,oW,QN,fH,Yx,rq]),V4=new Set([Aj,oW,QN,fH,Yx,rq]),H4=new Set([Aj,oW,fH,rq]),q4=(new Set([Aj,oW,iL,QN,rq]),Se(Sx)),W4=Se(Sx),z4=Se(Sx)
class Y4{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1,this.allowUnpublishedAppEventPreviews=!1}}const J4=[hC,fC,pC,b_]
class K4{constructor(){this.$kind="HeroCarouselItemOverlay"}isValid(){const e=void 0!==this.callToActionText&&null!==this.callToActionText&&void 0!==this.clickAction&&null!==this.clickAction,t=void 0!==this.titleText&&null!==this.titleText,n=void 0!==this.lockup&&null!==this.lockup,r=void 0!==this.collectionIcons&&null!==this.collectionIcons
return t&&(n||r||e)}}class Z4 extends K2{constructor(){super("GroupingHeroCarouselShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,CH)===ZU}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,i){if(0!==i.shelves.length)return null
const a=new dJ(cj),c=t.featuredContentData,l={targetType:dq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(c)},u=new I4
u.autoScrollConfiguration={isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}
const d=Bh(e,c,cj,l)
d.autoAdvanceInterval=u.autoScrollConfiguration.autoScrollInterval,Mh(e,a,d),bh(0,d,cj)
for(const i of n.shelfContents){if(r(i.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}const n=rh(e,i)
if(_c(0,i)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(i),t.relationshipToFetch=bH
continue}const s={targetType:AN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},a=Pc(e,i),c=Sc(e,i)
if(o(a.video)&&o(c.artwork))continue
const l=new C4,d=Zc(0,i),f=rl(e,i),h=Bh(e,i,f,s)
h.isPreorder=et(e,d,wq),Mh(e,l,h),bh(0,h,f)
const p=a.artworkData||c.artworkData,w=a.backgroundColor||c.backgroundColor,g={metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,canDisplayArcadeOfferButton:eh(0,t.shelfStyle),lockupArtworkUseCase:Kd(0,t.shelfStyle),isContainedInPreorderExclusiveShelf:t.featuredContentId===I0}
l.overlay=tl(e,i,g),l.backgroundColor=w,l.titleEffect=Mc(0,p),l.artwork=c.artwork,l.video=a.video
const v=Lc(e,i),m={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i),targetType:AN,id:i.id}
v&&(Qs(e,v,m),l.clickAction=v),u.items.push(l),Ph(h.locationTracker),Oh(h.locationTracker)}return s(u.items)&&(a.items=[u],i.pageTitleEffect=u.items[0].titleEffect),a.url=Ki(0,a,t),Ph(d.locationTracker),Oh(d.locationTracker),a}}class Q4 extends K2{constructor(){super("GroupingHorizontalCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&cs(0,j(t,CH))!==XE}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,CH)
return o.shelfStyle=cs(0,i),o}_createShelf(e,t,n,r){var o
const i=function(e){return t.remainingItems.push(e),!1}
let s
if(e.featureFlags.isEnabled(EJ)){const r=new BZ(t.metricsPageInformation,t.metricsLocationTracker)
s=Hc(e,null!==(o=n.shelfContents)&&void 0!==o?o:[],t.title,t.subtitle,r)}else{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation}
let o
if(t.shelfStyle===EV)o=t.shelfStyle
else switch(e.client.deviceType){case lW:case"tv":case LV:o=t.shelfStyle
break
case cW:o=Bj
break
default:o=CU}s=Vc(e,n.shelfContents,o,t.title,t.subtitle,r,i),s.contentType===EV&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Gc(0,e.media.kind,EV)))}return s.url=Ki(0,s,t),s.isHorizontal=!0,s}}class X4{constructor(e,t,n,r,o,i,s){this.$kind="LargeHeroBreakout",this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.collectionIcons=i,this.backgroundColor=s,this.editorialDisplayOptions={}}}class e5 extends K2{constructor(e=null){super(e||"GroupingLargeBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,CH)===Pq}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}isInHeroPosition(){return!1}_createShelf(e,t,n,i){const a=s(i)&&o(i.pageTitleEffect)&&0===i.shelves.length,c=s(n.shelfContents)?[n.shelfContents[0]]:[],l=[]
for(const n of c){if(r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const s={targetType:this.isInHeroPosition()?"heroBreakout":AN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},c=Pc(e,n),u=Sc(e,n),d=c.artworkData||u.artworkData,f=e5.createLargeBreakout(e,n,t,this.isInHeroPosition(),a,s)
o(f)||(l.push(f),a&&(i.pageTitleEffect=Mc(0,d)))}const u=new dJ(L$)
return u.isHorizontal=!1,u.items=l,u.url=Ki(0,u,t),0===i.shelves.length&&(u.presentationHints={isFirstShelf:!0}),u}static createLargeBreakout(e,t,n,r,i,s){const a=rh(e,t)
if(_c(0,t)&&!W(a))return n.isDeferring=!0,n.remainingItems.push(t),n.relationshipToFetch=bH,null
const c=Pc(e,t),l=Sc(e,t)
if(o(c.video)&&o(l.artwork))return null
const u=c.backgroundColor||l.backgroundColor,d=r?null:j(t,"breakoutBadge")
let f
const h=j(t,YH)
f=et(e,t,vG)?e.loc.uppercased(nh(e,a,h)):h
let p={type:mq};(null==f?void 0:f.length)>0&&(p={type:QV,title:f})
const w=zf(e,t,fW)||Qe(e,a,fW),g=zf(e,t,tV)||Qe(e,a,Rj),v=Ic(e,t,!0,0,!1),m=kc(e,t,0,!1),y=new B4(w,g,p,null,v,Oc(0,m,t)),A=new X4(y,{position:m||eW},d,l.artwork,c.video,null,u),T=Bh(e,t,A.details.title,s),b=et(e,Zc(0,t),wq)
T.isPreorder=b,Mh(e,A,T),bh(0,T,A.details.title)
const S=Lc(e,t),P={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:hW,id:t.id}
return Qs(e,S,P),A.details.callToActionButtonAction=S,A.clickAction=S,Ph(s.locationTracker),A.flowPreviewActionsConfiguration=oa(e,t,!0,n.clientIdentifierOverride,S,s,P),A}}class t5 extends CW{constructor(e){super(),this.$kind="SearchAdAction",this.actionClass="SearchAdAction",this.action=e}}class n5 extends CW{constructor(e,t,n,r,o,i,s,a){super(),this.$kind="SearchAction",this.actionClass="SearchAction",this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.source=i,this.presentationStyle=null!=s?s:[nO],this.referrerData=a}}class r5 extends K2{constructor(){super("GroupingLinkShelfController"),this.supportedFeaturedContentIds=new Set([T0,n0])}initialShelfDataFromGroupingMediaApiData(e,t){let n=we(t,oH)
return o(n)&&(n=G(t,RN)),{shelfContents:n}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldHideShelf:H(t,"hide"),areContentLinks:s(we(t,oH))}
return o.clientIdentifierOverride=Fr(e,t),o}_createShelf(e,t,n,i){if(t.shouldHideShelf)return null
const s=[]
for(let a=0;a<n.shelfContents.length;a++){const c=n.shelfContents[a],l={targetType:Mq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
t.areContentLinks&&(l.recoMetricsData=St(c))
let d=null
if(t.isSearchLandingPage){const n=this.trendingSearchLinkFromData(e,c,t.metricsLocationTracker)
if(r(n)||r(n.action))continue
Mh(e,null==n?void 0:n.action,{...l,kind:Mq,softwareType:u(null==i?void 0:i.isArcadePage)?vq:null,title:n.action.title,id:`${a}`,idType:Aq}),d=n}else{const n=os(e,c,t,!1,null,l,null)
if(o(n)||o(n.action.title))continue
d=n.action
const r=ls(0,c)
r&&Mh(e,d,{...l,kind:Mq,softwareType:u(null==i?void 0:i.isArcadePage)?vq:null,title:d.title,id:r})}o(d)||(s.push(d),Oh(t.metricsLocationTracker))}if(o(s))return null
if(t.isSearchLandingPage&&e.client.isPhone&&s.length>=6)for(const t of s)T(a=t)&&a[gW]===By&&(t.action.artwork=Ot(e,B$))
var a
const c=new dJ(eq)
return c.isHorizontal=!1,c.items=s,c.title=t.title,c.subtitle=t.subtitle,c.presentationHints={isWidthConstrained:!0},c.url=Ki(0,c,t),t.isSearchLandingPage&&(e.client.isPhone||e.client.isPad)&&(c.contentsMetadata={type:j$,numberOfColumns:s.length>=6?2:1}),c}trendingSearchLinkFromData(e,t,n){const r=f(t,YH)
if((0,Hv.isNothing)(r)||0===r.length)return null
const o=new n5(r,r,null,MB)
return ta(e,o,hW,n),Oh(n),new t5(o)}}class o5 extends K2{constructor(e=null){super(e||"GroupingLockupShelfController"),this.supportedFeaturedContentIds=new Set([...M0,...U0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,uW)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,oH)),{shelfContents:r}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return Ac(e,t,n,r)}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(r.displayStyle=t.shelfStyle,t.featuredContentId===R0){const n=f(B(pe(e,t.featuredContentData,XO),hV),fW)
r.title=n,r.idType=wV,r.badges={forYou:!0},r.targetType="swooshBreakout"}return r}_createShelf(e,t,n,r){if(t.featuredContentId===R0){const t=!s(n.shelfContents),r=e.client.isPad
if(t||r)return null}return Tc(e,t,n,r)}}class i5 extends K2{constructor(){super("GroupingPersonalizedLockupShelfController"),this.supportedFeaturedContentIds=N0}shelfRoute(e){return mc(this.supportedFeaturedContentIds,[`${zW.isOnDeviceRecommendationsShelf}?`,`${zW.onDeviceRecommendationsUseCase}?`])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,uW)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,oH)),{shelfContents:r||[],containsODPShelfContents:!1,recoMetrics:St(n),candidates:null,isHiddenShelf:!1,responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
const i=r[zW.onDeviceRecommendationsUseCase]
return(null==i?void 0:i.length)>0?await hs(e,i,vW).then(e=>({shelfContents:At(e.dataContainer),containsODPShelfContents:!0,recoMetrics:e.recoMetrics,candidates:e.candidates,isHiddenShelf:!1})).catch(async o=>o instanceof V0?await i5.fetchODPFallbackContent(e,t,n,r).catch(e=>i5.makeHiddenShelfData(n)):i5.makeHiddenShelfData(n)):(null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0?await K2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const n=yt(e,t),r=this.initialShelfDataFromGroupingMediaApiData(e,n)
return r.responseTimingValues=t[mm.timingValues],r.shelfTitle=j(n,fW),r}):await K2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>{const t={shelfContents:At(e)||[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!1,responseTimingValues:e[mm.timingValues]}
return t.shelfTitle=n.title,t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=Ac(e,t,n,r)
return this.addPersonalizationValuesToShelfToken(e,o,t,r),o}_createShelf(e,t,n,r){var s,a
if(!t.isValidRecommendationsShelf)return null
let c=null
if((0,Hv.isNothing)(t.title)&&(t.title=n.shelfTitle),n.containsODPShelfContents){c=this.personalizedShelf(e,n,t,r)
const o=(new az).set(Uj,OW).path(`${xW.onDeviceRecommendations}`).param(zW.onDeviceRecommendationsUseCase,t.onDeviceRecommendationsUseCase).param(zW.token,JSON.stringify(t)).build(),i=new EY(wW,o)
i.title=e.loc.string(cH),i.pageData=this.odpSeeAllPage(e,n.shelfTitle,O2),fs(e,c,i),c.mergeWhenFetched=!1}else n.isHiddenShelf?c=i5.makeHiddenShelf(t):i(t.recommendationsHref)?(c=this.personalizedShelf(e,n,t,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t)):(c=Tc(e,t,n,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t))
const l=(0,Hv.isSome)(c.header),u=l&&o(null===(s=c.header)||void 0===s?void 0:s.title),d=!l&&o(c.title),f=(null===(a=n.shelfTitle)||void 0===a?void 0:a.length)>0
return u&&f?c.header.title=n.shelfTitle:d&&f&&(c.title=n.shelfTitle),c}personalizedShelf(e,t,n,r){const o=Ch(n.metricsLocationTracker)
o&&o.fcKind===n.featuredContentId&&Ph(n.metricsLocationTracker)
const i={id:n.id,kind:null,softwareType:u(null==r?void 0:r.isArcadePage)?vq:null,targetType:dq,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:wV,fcKind:n.featuredContentId,recoMetricsData:t.recoMetrics,displayStyle:n.shelfStyle}
bh(0,i,n.title)
const s=Tc(e,n,t,r)
return Ph(n.metricsLocationTracker),Mh(e,s,i),s}addPersonalizationValuesToShelfToken(e,t,n,r){const o=t.featuredContentId===b0
if(!r.hasAuthenticatedUser&&!t.isSearchLandingPage&&!o)return void e.console.log(`Skipping recommendations shelf with fcID ${t.featuredContentId}: No user logged-in`)
const i=j(n,H$)
if((null==i?void 0:i.length)>0)return t.onDeviceRecommendationsUseCase=i,t.recommendationsHref=n.href,void(t.isValidRecommendationsShelf=!0)
const a=s(we(n,uW)),c=!H(n,Tb)
!a&&c?(t.recommendationsHref=n.href,t.isValidRecommendationsShelf=!0):t.isValidRecommendationsShelf=a}addOnDeviceQueryParamsIfNecessary(e,t,n){var r
if(o(t))return null
if((null===(r=n.onDeviceRecommendationsUseCase)||void 0===r?void 0:r.length)>0){const e=new az(t)
return e.param(zW.isOnDeviceRecommendationsShelf,pq),e.param(zW.onDeviceRecommendationsUseCase,n.onDeviceRecommendationsUseCase),e.build()}return t}odpSeeAllPage(e,t,n){const r=new dJ(n||O2)
r.isHorizontal=!1,r.items=Gb
const o=new pJ([r])
return o.isIncomplete=!0,o.title=t,o}static async fetchODPFallbackContent(e,t,n,r){return await new Promise((r,o)=>{const i=Qi(e,n)
if(!i){const e=`OnDeviceRecommendationsShelfController: Could not construct media API request for: ${t}`
return qv.unexpectedType(_H,e,null),void o(new Error(e))}Xi(e,i),i.attributingTo(t.build()),Ln(e,i).then(t=>{const n=fe(yt(e,t),uW),o=St(n),i={shelfContents:At(n),containsODPShelfContents:!1,recoMetrics:o,candidates:null,responseTimingValues:t[mm.timingValues]}
r(i)}).catch(e=>{const n=`OnDeviceRecommendationsShelfController: Failed to fetch fallback shelf contents: ${t}`
qv.unexpectedType(_H,n,null),o(e)})})}static makeHiddenShelfData(e){return{shelfContents:[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!0}}static makeHiddenShelf(e){const t=new dJ(e.shelfStyle)
return t.isHidden=!0,t}}class s5{constructor(e,t){this.$kind="RibbonBarItem",this.title=e,this.clickAction=t,this.artwork=null,this.accessibilityLabel=null}}class a5 extends K2{constructor(){super("GroupingRibbonBarShelfController"),this.supportedFeaturedContentIds=new Set([556])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,o){var i
const s=[],a=new dJ(HE)
a.isHorizontal=!0
const c=ar(e,e.bag.arcadeCategoryBarSAGUpliftDisplayRate)
if(t.isArcadePage&&t.isFirstRender&&c){const n=a5.createSeeAllGamesRibbonItem(e,t.metricsPageInformation,t.metricsLocationTracker)
s.push(n),Oh(t.metricsLocationTracker)}let l=null!==(i=n.shelfContents)&&void 0!==i?i:[];(0,Hv.isSome)(t.initialHydratedItems)&&t.initialHydratedItems.length>0&&(l=t.initialHydratedItems.concat(l))
const u=[]
let d=!1
for(const n of l){if(r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n),a5.shouldPriorizeItemWithData(e,n)&&(d=!0)
continue}let i=!1;(0,Hv.isSome)(t.featuredContentData)&&(i=(0,Yv.attributeAsString)(t.featuredContentData,CH)===oM)
const a=a5.createRibbonItem(e,n,t.metricsPageInformation,t.metricsLocationTracker,i,t,o);(0,Hv.isSome)(a)&&(a5.shouldPriorizeItemWithData(e,n)?s.unshift(a):s.push(a),u.push(n)),Oh(t.metricsLocationTracker)}return a.items=s,d&&u.length>0&&(t.initialHydratedItems=u),a.url=Ki(0,a,t),a}static createRibbonItem(e,t,n,r,o,i,s){var a,c,l
const u={targetType:lj,pageInformation:n,locationTracker:r,recoMetricsData:St(t)}
let d
if(t.type===IV){if(!Gi(e,Jj))return null
d=is(e,t)}else d=os(e,t,i,!1,null,u,s)
const f=Js(e,t,u)
f.targetType=u.targetType
const h=Fd(e,t,f,null==i?void 0:i.clientIdentifierOverride),p=null!==(a=null==d?void 0:d.action)&&void 0!==a?a:h,w=null!==(c=zf(e,t,fW))&&void 0!==c?c:(0,Yv.attributeAsString)(t,fW),g=null!==(l=null==d?void 0:d.title)&&void 0!==l?l:w,v=new s5(g,p),m=Sn(e,t)
let y
if(o)y=null
else if((0,Hv.isSome)(m))y=Zd(e,m,{useCase:y6.RibbonBarFacet})
else{let t
t=i.isArcadePage?"resource://arcade-ribbon-bar-fallback-icon":"resource://appstore-ribbon-bar-fallback-icon",y=Ot(e,t,36,36)}return v.artwork=y,v.accessibilityLabel=g,Mh(e,v,Bh(e,t,g,u)),v}static createSeeAllGamesRibbonItem(e,t,n){const r=e.loc.string("Arcade.CategoryBar.AllGames.Title"),o=eo(e,cU,t,n,r,PN,mq,lj),i=new s5(r,o),s=Ot(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACACAYAAADHy7H2AAABdWlDQ1BrQ0dDb2xvclNwYWNlRGlzcGxheVAzAAAokXWQvUvDUBTFT6tS0DqIDh0cMolD1NIKdnFoKxRFMFQFq1OafgltfCQpUnETVyn4H1jBWXCwiFRwcXAQRAcR3Zw6KbhoeN6XVNoi3sfl/Ticc7lcwBtQGSv2AijplpFMxKS11Lrke4OHnlOqZrKooiwK/v276/PR9d5PiFlNu3YQ2U9cl84ul3aeAlN//V3Vn8maGv3f1EGNGRbgkYmVbYsJ3iUeMWgp4qrgvMvHgtMunzuelWSc+JZY0gpqhrhJLKc79HwHl4plrbWD2N6f1VeXxRzqUcxhEyYYilBRgQQF4X/8044/ji1yV2BQLo8CLMpESRETssTz0KFhEjJxCEHqkLhz634PrfvJbW3vFZhtcM4v2tpCAzidoZPV29p4BBgaAG7qTDVUR+qh9uZywPsJMJgChu8os2HmwiF3e38M6Hvh/GMM8B0CdpXzryPO7RqFn4Er/QcXKWq8UwZBywAAAARjSUNQDA0AAW4D4+8AAAB4ZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAASAAAAAEAAABIAAAAAQACoAIABAAAAAEAAACCoAMABAAAAAEAAACAAAAAACBAcQEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIGaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yMTk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIxNjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KIUPY5gAAGmtJREFUeAHtXXuMJMV5r+qZ2Qe7h299bA7O3B0GGwOXBwEsbMXCC1H+QJjHgpbHEcyBEiLl4cgJxLKElIkUS4DtQCCSpZOSEAx3hjW+YwmclAfa4MQScfBL2Tg5ED5uyfFYw0Lu9nZvHl35/b7qmu3Z65numZ3dndnpupvt7np+31e/+qq6uuorpVKXSiCVQCqBVAKpBFIJpBJIJZBKIJVAKoF6EtD1ApcbZpRa0fxJHwpAMe3hVprfleS1ZRVlRkayqr8/ozbPa7Wh36gTW3118KBRw8NG7djR2sqamrJ0D73mqdmztRqY8QQKc8M+yirpfN5fSWgYA/zdOJarKnfoNQNabLkrwe/MjFbnnqvV9LRXkfGm+bLOT5ZaweuygWCuvLKXhOgDB060gqDl5mHyylNTY6SpoMfHy8vNL5ze5PPIe2pF8g6X08i9GRvrUacf0/qR5cm/aSCIUA5N9uhHJxcc4ebma7aoTHabMmYLNPZpaDcbAJE+hGfg13RZLn939Y0xnucVlPGPI/9ZlPUO7t9Qpb7XUfnHXDyza6QvTJ/zb+YqgD9woAAmRLuhAvpVdmG70t6ZyujTkecQaBnwld/jad0yXgNayyjjBCB+FGX8HH5vqkJxWo8/e9jxIoCYmfH1ZHMaoimCTR7dgJr0dV755o6xYVUo3YiKvgJEfgJyolAAANWjPKuxhdimSnJsLrm6jgY6GuVSHc/jbhbiP4xq+gGENqH37vtHpjK7dgEMj1bAuiSnRI8EgdN45pbRzyDX6wDyS5D4LFw/jDIHlNYefja/leCVOVt+i7gj2N/B7xXw+qLKZZ/Uj40LKAgINIYCwhpyDZNs7rorp3fvJjHK3Dx6p9LmbuXp86XSSajvs5oYTrXMSqIvZcRLSxwydCIH0lABymThw58UpMrl4xDQ8ypT/rJ+fOLV5WgGJ1gzduWwyvU+AAauA68bAQBwB5aMKYOeEoq2/LaQz4qwOCYBZ/ixZWVQak5D7Qjrvoj4Z/B/WD+x/yFcVRi4fE7imHlixwGhUz1m57V/CUK+IML3/XmQeYI1LjVkQDDIRNVL/ga1whsE0xvRws8n+yMWo8KFuxP6uWcXbiPhr0iDCRApi7JOUdlMRpXK00iyC9rhhWbA4Pg1t157AYh/Gt3eeQAZKxxdklQ8LsIjKygkS0un47eaboYt5WWRLysbKyOXOa+ShhLlP2SIH3lmmTkIfQCNERSZx1Qx+9vUCA7ACE/kyEAiZzgI4xsAnNl53UMqm/0CxF6EBkAfrUogrQe13YP7HpCHrgPjAotgkEgcoOO0fad9to8MQqDghF2rPCM9gYSfe+YVz4xHvyDfIF4GVwhDyu1FIHk6BhB8gJa7FTL/trn1+k9xrMBuAmGJHMdABL0Zu3obyj2gvAxB8AESUy2TPvLJH8smDSw3+JFGchPQKtfwPdPjORwuz6xOGw+PEkF4DvyQP8uB5pMye3GlvAENM6vK/hy6iM/72eJfw08JGKQL51O8o1ATOSCsH5nPm1tHb0eCR1E4+6HjATEWo4lyWoVI5Mq2nKKocd9Mqb7yp/XfTBwNd21JKDE7R19QWe9yAOs9xOcbAytbGkSS9Csex/JKFcOBbAYNdFCVS3ejm/g6/LTK53WS12kyFesCNTNvdl6FkbH5kiTQAQgokvYRi5DG/gEioIiyxi/PoZ3tUAven0hg4SA1VV1n7ro4xwgCeguC9/FIbWLFzsB2cVb27FuoHU5Aa6HT0F80O2/4OPyMOnIkll+ykggIiGcz0z03Ievz8eMoPFEBLGS1HWsrACdVbRndFwcPNxLI0kXw3bue2/2ynaQx5nehCRiTKjnIsl7CNQ0jJPqkm8hlPoLX6RtIDQf28qofQ1osEKANMuwSmA9e1H5d3g6UKUCwmBuIyX2tgwUR0oqL6HC3o9FcJiQtLHAME+lkgAhWzW2jv4gIv4IfB4bCq80uMlm7eLI+MYhExWhzBTW5JWwytp5jIyAjafnm86ObIMxz2bTg7LDfltK+fy1Q2UkUMd5C/24uFmLPss08kvDhYSuTkvokQM8xgaiEyLjt6ekFWuw8lfPPFBKPHI3FcDwQBgZsnEIZo2ezOQBCe4ogmiq+dPky8DbqYxJl06Xx6tIzO6Kza2NfO4eBhmvYdaOu/K1CrfsGUof0eCDMzVk0efoM5DOIH/vPWITVKXO1g0gr1CWclqlgJaPoyRrqkh+P6Hy9XUDfSZxaylGnmm9LPZiXxlQ/3FPjnPqqy0k8EAYGbPZKnYYsOXKmqqybKcLbz0mXZjaaO6/h9LfCnEg071uutl2BNsMSL5gUk/vO+MO6KXNGIqPVJpKMLt2+TNehP1oY4QRvv22BoD0KkGqns0RTBVnTr+Yx60h37FhVCL3YakLv3IP4tkXvTnPkCxqQF3Nqhfg/y5/EbyUMN/FAGBwMpGH6pJ/l9GhnQYH8BjzoHIa5diRtRwthWSiVt5qOb0pIgVlKbbuU6ljt/WSrO6gh+fKbiN54ICxmY+cN7IBk0bez7sCvtnxE0p23vjuwCESmjIl59x0gMkGbe9bjtZr0RoBQnbJLnoCIjuwfpHoaWAOSAiEW0J2sEWKZq0RIgVARRfRN56qDaH5q+aZAqCEZ+25Ud6BdI2VneqdAqFtv3aIPkrw+1hVUGrheJJBqhPVSk8vkIwXCMgW4XpKnQFgvNblMPlIgLFOA6yV5CoT1UpPL5CMFwjIFuF6Sp0BYLzW5TD5SICxTgOsleQqE9VKTy+Sju4DQPZ8OGoZFdwGhgU8Hss4P4uwW7HQXEBpuJ0zQwQtTGuA3BUIDwlrPUZMDwV8XLQOWG7z4DmKSVe747eAVSl7yxbfxQKgs+4YtBDqsjxVJxotTorfJH9fVl1WxYDe4vhpBWT5vuZqcxN4QE2zkcYCIiN++XpZf2q9I6OKB4JZ9e3oOwuFSf2ydIBwSlrDW0cKAhdE/1Z+z9pQqy/SrCUR0jBMF7tz42ylcLjJh+Q3Wmpu5xYD6d/FAOLrZCsMo2ggoQEpMExZv/RLaKVTDKtnMAi2ewAba0Ek8CADGxgKZwFobIdF5jnx5sl1PLM5JZdFgxkn8hlmLB4Lb+6j020jIVsJ9AXUzDRfQJvdYlS6V+q6zjqZmZ2ttXrH7HgxM2DFNJ+3jIIta9nlmxWCGljrDxp08OalbZ/FAGJgJMtBv4IatJD5Nm9R+QAbpB8286NfpJxZRxsejgRCMiXxP2VFEwD3TdYTjzm+Y+AHZ7wMM/ys019rwG2IovlJ7zrWbQgc3TQNVh4OWFYOvUAlrfSstBDt+YKUT28T/S8iZPZuW16KrOBg7QDA/oqUVOETtEGdHbtgA62UxxH0dw/ppofzcVthH2L27tGiASv8gkF8WBUS3qDaTmd3Harjf8V2A+HtC3uIO75OphS1n8SzkXkI/+xbQwrTRoDk59Zr5hAiELRvAWOvv673P0kor9HhgI7oOdbEaQVrO7CwrHq68Hy3r/3DD7fEwPkG/tnacBOD4gHz+u96z/0cQmFZnnVXTMil3Q7PrgLmg95DuOZ3xepCmRF5Dwm47pjkIgCOd/apYQgdRfpYeYgoogU3qWCAwM1g8PyF2B/dMvIiCngPiOKBKsOteUq/lH2qtHrRsvE+bB4WQsbG+0Nb3aNoqLShzP/rZBcgYecB0RnTs9vC13cIJmNfjtv/n1HkX/b0QNpKMvERAEMG99JKYnINhx7vxO4TZBNpLoBptx4ZCmggCDxZYqdof0Xue+SdnJhDPdR20QVmMiO15+hXg/R4YsuxHAlgdsR1N3cSrHCjCtwiF9Vt9GrTBDOrmXtFstMuc0Ix/IiCQN752iRnbb00cwSBqDGJBgd6HQIgTOgXPe6GNaVbRuXJJQ0AHbDNnswOqWN6LLuGPA1rswDcBYQQDoyHtX6lS8avI61T0MZQX8hdArDG/jgZcjRgLg3FwQwOot+vH9/04eDNKPLPYsLZzBp/NTaPnm4x5XGcyF0F9oiJgRl7DAB/JWn0wOD5YUbCJCGMYtNquzdf1E8+IoU1p4Qn6SqSvODKFjMmPglX2P4KQv4IfbRlyjEGgIIwVsurT0MAk/uG0AvQIOdRBBlr6FYwM7szt3fevYj0/P1l2tJP+OOcEGBevKjxQsbS1qNXO0buN9u+EMM6B9WDbfTC2AJaCopDwv6WOZBtmbMdIwUjJ1gnen43C24F/v+aYhjGtrcjE2iBMKsvgM4UK49y/hLt7UfTleMR5FEHBlldGY3T88L+lzvKLLDnwreSM+X5W9mF471XHyvfpCZgYXi0z/Y6KxVdKsE3DjtnSZyGDSxF+Pn4fAXE018uBC8HBltpqh/GJwakx+igynsH1Z3j+iSrr7+on9/2UhQld4+NFCGtZNYPEWo2N8U1C3jbMbVd/VJUzn0URF+J3NkJ/AddTUQrMC0Ej2YEbvFrmSD/VPFU/p/rfRBn/A2h+X/WbSdqYZknNgoBpF+HFpwadPcXlEE5xOflgDDnxZMg7RRVP6VWZEx5U17LKqiItA42Yy5RUrjyvtl00t/QtgK9MPF+qMp1clbj5BwEWvlG48yrCOSGMpgf7wWuupbyykIH+sppTBTUwcDxS1jipRs0NF924JkxX0vuWVA6EkAGROcXvEkNDpShBJSWomXgCyHfxVvPWIDVPWbVAC9SjQwDBsQin35dZAfXKqRUmA0HMjkr4zEzRnaFRK34S/5YAYWlBUjGc3+apZLOzK1KGfD3cglPkpnCGBL4boJBlqf+lPCR9DroNT9EA15EV5pen5o2M+PySuFb8JpVLGi+VQCqBVAKpBFIJpBJYHxJYkYFcOlhcAXBwaV0wWFz6utyK0loChPT1sbVHD8dVbNu9Pq7phFJ/L05lObGgtk1gQkk+NFXkl04oVUSR+KZpjVA1xcyDwjf2XYYp5k+h5PPwSzLFzLL57i9Xvo/jxj3DuzIv4OLRT1wQKXKKuYAp5t6VnmLeecPZmLe6DMQ0MsXs+JAvVHwIXBXPITm4cF4Zp/2mmDmzxnl30QgHf3gPiNyFejwHVdnAR6eKXAI+cRHn/Gs9O3/5umM/wbgPMfbjz/uQ2ve0b+7T33rmu4zNrqvZ6VdWDPPAH2NuueaX8SX6Xjxejt+m6I9OFQAzWcg5vsJXBrOOnV8oetWthPNP1UcnUMT1INOQxB5V6LkPPB5zdVOVPMEDM2/IVT5D3zZ6Po6gfVy182doo76m9+7/EhlsBgwEAQTEmsJn6Ou4puErWPTRiwoIfYaWcInDeKvkKp+hQWIOdYDP0OVXcLzEHfqJiX9b8c/Q7nxlc/M1l+CI3OchlGHj++GjUByw3HWV5FJphaEK4cKUTB9W7OwFGHaSkGbAIOluvfYBlcndo0ol7uvA52xZCsmyHJ/uyuir4Ryf0IE8cE9jraL+EACKownNGFZjPS8DSpxfCcJc3Lp0Jf48LJqA5yv/5vVnYGXSU/iwPIyVSh+gIAqB+fDHe/5W27lyQ3RAbZZKOC85cwuO9f2LgCCutUzkCBpGxGmwv6eyAgIu2uWaBpQhfVGb8Esc4FO/MVxsewq+gP8dzu6+UO9+uchP5+QhiSMzsU7GAoOD7I+w3sP/GhavfhRL1fgNnF/A1qLiSUk9R5rIm48zEKnGfx8rjH5DxjU447peQoY5zWFuuu4cCPirqljkfknml0hezGO1nAjftvl+0PpznctywcyfBzxgHIdP8glcMsampno52IIwP4M8P4fv7XaZFrHY3o78FaTFaPNFIXV8fEGAXY/uodesXDycg53JADhchqcS7Kevl+kKh9mteb3Qgsexcukq1Vu+SkqcTFZuLBAANlljINlpM4pxAU8Osy0kUe+TjJAVikWgYo8T1i8q9UmMbX4VHkYdOsSVzZGOIKFalQPRtQboRaNkk/W0kVmuimewWi6L67zOZqG4/WtYMNcquG6uHiGxQFB3XZyVg6a56kepi4OegN1EfNp6Ja9WGLUWV/na171PS7GVjb0RRLjT1U0Pl93x0FN2LaL52ln9OdpwxSY/n+rrEnPL1TyrEzu/Aw0nD9F/4iuzsMEOsLZs2oYstqIfsjm5kqPzbR9f2nPQ2H/Bv0rbY36HXsOCX1u5JxE6Pe1kciEGxQxuf73nmLDdA/Z5+iW812zHC8VWCTq4IZYHx7TL6uTr3HBQ5cUzEci181SzneRIP2gmDhTBrIIRdTTvFQMa5uOdxGSFVmu/4gS43YjxDWZ44bCqqSbwg4TRwggC5VLZMJrZjMy4KpkDxQAc4YhtfY/XbTYKc5osqiWpQ0O1eCd/5PCMQPt1Dq/ConTZJYAA7OJQd7oYIxmMUksYDLNugzsSWG2ERPBeqjsRCJYXowfVcB9XG2OH8MlrKaXVVOwmmKEACDZt5/wlcLG5hxfwAIc7Q2MZvK/l4oHwapDUNwPInHmybdneqFau7eQvUggI0qpXzRe5kzvybGh6C4PCn+Z8A9tYZzlb3cHOCj2QlPh4IFT6zOCDEiAgZdkCk5azpvFYuQEBGZXrsRMsH4sgybWakRFum2M8gN6yGxG7nb0sv+GPgDHUxgPBZeB1pEAc9e7KV6t4CI8wusO7fDV26Tvr6pvE9Zs4YmdJIKW2UQmkQIiV2LrQhLFcdhcQ4juFisAwOJDYbnBRCVinN90FhG6p1SbA2l1AaEJA3ZIkBUK31HQMnykQYgTULcEpELqlpmP4TIEQI6BuCU6B0C01HcNnCoQYAXVLcAqEbqnpGD5TIMQIqFuCUyB0S03H8JkCIUZA3RKcAqFGTWMtVld9mUiBUAMIzruBD5YuSUdeUyDEVlsHr1CK5W0xQgqERVlE3nXomkXLi04O4uRA8GU/A5eBdrK2xEYXY/ctRFZ73vrSrK8cm8f9csmFGZnlmnrW47WasHgguLOhPb1g1/lj6VbnDaQC8OJsJy3WTlRwqmO1NPJ2gChmdjSOD1bJF39WZ7SGT8H6ZcuJsccfJyAnHgib3ZHAPu0hYPNrh42nq8b+eh6G9GFVBK6yTF+e5A/QYipb5nl8sGwSWQzvkDtyjHrlRdO4h3V/mq+ShPN213ggLO4c5hmC3BnMTbF1M3WZt9VVKlW/7w65UDMz0Xs4jzxrN/362p6Z2Hnaj3XDA09xsTzI+suYDj0eCG7vo2/eRM7OSkonAYG0Cp8wlPAW7pW0epq7j3KzZ1uRaWNPve0kTi3l4AubkXy/gObKOlPqxjGP2i6KXednd/24p6jr3JwVWE/msCqZd6AuN9uxQlTktvTj8Naenq6DkQEO+dCPHMAYoI7TeqpOaHsG2YE8BsOG2/pgds+bFkKtfYQ6g+Qkm2Dt7melH9v3LiB1MOg3NTdAtr2zLYRvADQ2hfOE9MtC86GsVf9RDLguwy//ByzGua4wKmZb+qFafFiTI20/VUXvDSFySwvsI4jtpMAAFeT6z7TGAcT14L7c9i+SFqz8S+tih1SP+RcRTF8fLb5EOncsjt478RPw+GNEsqYA8NABjvv50A2SWPMCjYdZmmt0gyGG4scINrJVK8Xckyjkv6FyqHrqqppQGat+K/VvK46nt2YCyydP6Uf3vy+2IisCiiaN5oUlxJhv4OBP3pbr97DR+ayyLzlegMYegkGtN2A752mWL6aScd51HC2JgEBkmV27+nB9Txn/gSDTUyAcWiyzAIwraRXD5QWBHQJed7WXGQDN/6mKOUt3z9FYALvDyfTeZ/4WBjsnoWo3gkm+k7NHtBBbRX7qFmWp4V+2fpyoh27B6Af14xOvCq1btsTyy/wTAYERFU5YF9t9FI5RD0M4tEwGIWPixQTawYHCXSVh6I8l2nq4OLX8wuHuninj4kMM+EfjWbCb5G1EPz+L1vFbAPEx0QY0RJnAVeYTcrnbYatxGjaYPsw8UTwFbodlji53XZqvo9VdGe7uw2ncvQtbGs/lG4onlcxnmQEVK3dZlcsNQht8U+/dZw2M5kcySc92CBftiqt5lSPoYa6NEWDd8yGooT+UwaPv44BqAQRbDF9VZG42EBdjyzytna519+TBysVeOf6kOVk6N60b3oDqwl2YROQfJpeBS3DPkdIAgJqRCjR6FwTzgjMfjLDEzvGLE2AvAE3fhtlh2J8uc2x0HKW6lkaS2aBCsnQ8ktZqHuxz2H/pPcljGscvnwOeOafBf4s8s8wc6mBApF72vwnNR9Cz0YrhdKZO4kLEJ4kOCtB/OtVpbrn2DhBxN34XSD9MGPgyk8FWR0HZCmrxpAyKCQAjAyNUgsnChz/IDL9ymbOHBzCv8mWNE9/NH1zZG/u6WIN9J1AxVedl7kc1wNakNyTVTlZxLC/oKaFYxy8hwcpqnVvUPwRcBuXhPGiUyDPLOXg35hAKfVjv2fcgC3WG03mf1DUMBGZszbqO+FQ7ENSw6indCGKuADGfQCgNONEoZ08wSGMSCqd1zomZwBPVaOaROWwR493ZmB8CDBP6if3/wAJlbBNxUm0jxISBZG69/tcg/FGUdQnyOAtXWJqDBtKoFYKQbiV4Zb7CL76XwPAPfu/g9wqUx4so9ym95zuv45nmgxvSBExD1zTJ0ocemsRxwJOVDxuwbLpFZbLbQPAWkASbwGoDiuAbBs5LDqtIKbv5P2LGycNA1UfL17Mo6x0MCN9Qpb7XORZwGTfTHbi0S69ije3SA0WdFy1Hgfer7MJ2tMozURmnIz4MV0FFa8M3DrbcVjq8tcAMsIeZXaPeRcUfUYXitB5/9rArhADgtLl7/XX+Sa9NA8EV4MzVtfocZpd/o1c0Go0pVYKvAFC4frzRbCLjC/hhl3ol8o4sMIGnAOD0Y7rZrs8VsWwguIzcOUpq8zz0QD/eJbb6cirZML7t0+3Y4RS6S9L8dWrK0s2pU34bGJixLXBu2Ec5paQj5WYJELD9zl1ZVThoZyhZ7tBrBrTY9/VW8koiye8MjhzmEcu0DOtkvGm+rPN28N4sLy5dy4DgMgxfUfMrmj/LQgGtA1iY+CbuV5rfduK1CfGkSVIJpBJIJZBKIJVAKoFUAqkEUgmkEuhoCfw/vJfHMO4YqncAAAAASUVORK5CYII=",36,36)
var a
return i.artwork=s,i.accessibilityLabel=r,Mh(e,i,(a={targetType:lj,pageInformation:t,locationTracker:n,recoMetricsData:null},qv.context("impressionOptionsForArcadeSeeAllGamesRibbonItem",()=>({...a,id:PN,idType:mq,kind:null,softwareType:null,title:"All Games"})))),i}static createTagsRibbonShelf(e,t){const n=ge(t,oE),r=new dJ("ribbonFlow"),o=[]
for(const t of n){const n=(0,Yv.attributeAsString)(t,fW)
let r=null
switch(t.type){case DN:r=(0,Yv.attributeAsString)(t,Wq)
break
case IV:r=Fi(e,f(t,AG))}if((0,Hv.isNothing)(r))continue
const i=e.required(y3).fetchFlowPage(r),s=new EY(i)
if(s.pageUrl=r,(0,Hv.isSome)(n)){const e=new s5(n,s)
o.push(e)}}return r.items=o,r.isHorizontal=!0,r}static shouldPriorizeItemWithData(e,t){var n,r
return null!==(r=null===(n=e.userDefaults)||void 0===n?void 0:n.bool(jb))&&void 0!==r&&r&&e.bag.ribbonBarVisionEditorialItemIds.includes(t.id)&&e.bag.enableDeviceDrivenDiscoveryContent}}class c5{constructor(e,t,n){this.$kind="SmallBreakout",this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class l5 extends K2{constructor(){super("GroupingSmallBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,CH)===WH}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,o){const i=[]
for(const o of n.shelfContents){if(r(o.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}const n=rh(e,o)
if(_c(0,o)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(o),t.relationshipToFetch=bH
continue}const s={targetType:Hb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)}
let a
const c=j(o,YH)
a=et(e,o,vG)?e.loc.uppercased(nh(e,n,c)):c
let l={type:mq};(null==a?void 0:a.length)>0&&(l={type:QV,title:a})
const u=zf(e,o,fW)||Qe(e,n,fW),d=zf(e,o,tV)||Qe(e,n,Rj),h=tf(e,n,{useCase:y6.ArcadeSmallBreakout,withJoeColorPlaceholder:!0}),p=ye(f(se(n,nt(e,o),oW),uB))||(null==h?void 0:h.backgroundColor),w=new B4(u,d,l,null,Cc(0,p),null),g=new c5(w,h,p),v=Bh(e,o,g.details.title,s),m=et(e,Zc(0,o),wq)
v.isPreorder=m,Mh(e,g,v),bh(0,v,g.details.title)
const y=Lc(e,o),A={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o),targetType:hW,id:o.id}
Qs(e,y,A),g.details.callToActionButtonAction=y,g.clickAction=y,Ph(s.locationTracker),g.flowPreviewActionsConfiguration=oa(e,o,!0,null==t?void 0:t.clientIdentifierOverride,y,s,A),i.push(g)}const s=new dJ(Hb)
return s.isHorizontal=!1,s.items=i,s.url=Ki(0,s,t),0===o.shelves.length&&(s.presentationHints={isFirstShelf:!0}),s}}class u5 extends K2{constructor(){super("GroupingTagBrickShelfController"),this.supportedFeaturedContentIds=new Set([D0,_0])}initialShelfDataFromGroupingMediaApiData(e,t){var n
return(0,Hv.isSome)(t)?{shelfContents:null!==(n=we(t,uW))&&void 0!==n?n:null}:{shelfContents:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>({shelfContents:e.data}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,Sb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Fr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,CH)===WH,d=new dJ(qb),p=h(t.featuredContentData.attributes,Pb)
if(d.rowsPerColumn=null!=p?p:Z(e),d.isHorizontal=!0,(0,Hv.isSome)(r.shelfContents))for(const n of r.shelfContents){const r=u5.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s);(0,Hv.isSome)(null==r?void 0:r.shortEditorialDescription)?((0,Hv.isSome)(r)&&a.push(r),Oh(t.metricsLocationTracker)):(t.remainingItems.push(n),c.push(n))}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.contents.data"))&&(0,Hv.isSome)(t.featuredContentData.relationships)&&(t.featuredContentData.relationships[uW].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,yM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const w=u(t.featuredContentData.attributes,ZE)
if(l&&w){const n=new dJ(U$)
n.items=a,n.presentationHints={isSeeAllContext:!0}
const r=new pJ([n])
r.title=t.title
const o=new EY(wW)
o.title=e.loc.string(cH),o.pageData=r,d.seeAllAction=o,Xs(e,o,"",{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}return d&&o(d.items)&&t.isFirstRender&&ec(e,d,t,t.featuredContentId),t.presentationHints=d.presentationHints,d.url=Ki(0,d,t),d}static createBrick(e,t,n,r,o,s,a){var c,l,u
const d=null!==(c=St(t))&&void 0!==c?c:void 0,f={targetType:n?Vj:gG,pageInformation:r,locationTracker:o,recoMetricsData:d},h=is(e,t)
if(!h){const e=new r4
return e.shortEditorialDescription=j(t,fW),e}const p=new r4,w=(y6.GroupingBrick,rs(e,t,0,0,0,f))
if(w.length>0){const e=w[0].backgroundColor
p.collectionIcons=w,(0,Hv.isSome)(e)&&(null==e?void 0:e.type)===xV&&(p.backgroundColor=null!==(l=oh(e))&&void 0!==l?l:void 0)}p.accessibilityLabel=h.title,p.shortEditorialDescription=h.shortEditorialDescription,p.clickAction=h.action,435===q(t,zj)&&(p.personalizationStyle=ON)
const g=pe(e,t,uW)
if(i(g)){const n=Js(e,g,f),r=null!==(u=null==s?void 0:s.clientIdentifierOverride)&&void 0!==u?u:null
p.flowPreviewActionsConfiguration=oa(e,t,!0,r,p.clickAction,f,n)}return Mh(e,p,Bh(e,t,h.title,f)),p.artworkSafeArea=o4.defaultTileArtworkSafeArea,p.textSafeArea=o4.defaultTileTextSafeArea,p.isValid()?p:null}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,CH)===WH&&(r.title=KE),r}}class d5{constructor(e,t,n,r){this.impressionMetrics=null,this.badge=e,this.title=t,this.subtitle=n,this.$kind=null!=r?r:"PageHeader"}}class f5 extends d5{constructor(e,t,n,r,o,i,s,a,c,l){super(e,t,n,"MediaPageHeader"),this.artwork=r,this.video=o,this.collectionIcons=i,this.useGeneratedBackgroundGradient=s,this.backgroundColor=a,this.style=c,this.backgroundStyle=l}}class h5{constructor(e,t){this.$kind="TitledButton",this.title=e,this.action=t}}class p5{constructor(e){this.$kind="TitledButtonStack",this.buttons=e}}class w5{constructor(e,t,n){this.$kind="UnifiedMessage",this.placement=e,this.context=t,this.deliveryMethod=null!=n?n:"pushAndPull"}}const g5=[new X2,new n4,new i4,new a5,new s4,new c4,new u4,new p4,new Z2,new y4,new P4,new f4,new Z4,new Q4,new e5,new r5,new o5,new i5,new l5,new Q2,new class extends K2{constructor(){super("GroupingMediaPageHeaderShelfController"),this.supportedFeaturedContentIds=new Set([585])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,uW)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await K2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){var o
if(!Gi(e,Jj))return null
const i=n.shelfContents[0]
let s
if((0,Hv.isSome)(i)){s=null!==(o=null==r?void 0:r.pageTitle)&&void 0!==o?o:null
const t=Zd(e,p(Rc(e,i),"categoryDetailStatic16x9"),{withJoeColorPlaceholder:!0,useCase:y6.Default,cropCode:"CDS.ApTCHM01"})
if((0,Hv.isSome)(s)&&(0,Hv.isSome)(t)){const e=be(t.backgroundColor),n=new f5(null,s,null,t,null,null,!1,null,null,e?Gq:hq),r=new dJ(M$)
return r.items=[n],r}return null}return null}},new u5]
class v5{constructor(e,t,n,r,o,i,s,a){this.$kind="PrivacyType",this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class m5{constructor(e,t,n,r,o=[]){this.$kind="PrivacyCategory",this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}class y5{constructor(e,t,n){this.$kind="PrivacyPurpose",this.identifier=e,this.title=t,this.categories=n}}class A5{constructor(e,t){this.$kind="PrivacyHeaderSupplementaryItem",this.bodyText=e,this.action=t}}class T5{constructor(e,t,n,r,o,i){this.$kind="PrivacyHeader",this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class b5{constructor(e,t=GV){this.$kind="StyledText",this.rawText=e,this.rawTextType=t}}class S5{constructor(e,t){this.$kind="LinkableText",this.styledText=e,this.linkedSubstrings=t}}class P5{constructor(e,t,n){this.$kind="PrivacyFooter",this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class I5{setShelfId(e,t){this.shelfId=e,this.index=t,g2.has(e)&&(this.section=new uJ(vW,e))}}class C5{constructor(e,t){this.$kind="AccessibilityParagraph",this.text=e,this.actions=t}}class k5{constructor(e,t,n){this.$kind="AccessibilityFeatures",this.title=e,this.artwork=t,this.features=n}}class O5{constructor(e,t,n){this.$kind="AccessibilityFeature",this.title=e,this.description=t,this.artwork=n}}class E5{constructor(e,t={}){this.$kind="AnnotationItem",this.text=e,this.heading=t.heading,this.headingArtworks=t.headingArtworks,this.listText=t.listText,this.textPairs=t.textPairs}}class R5{constructor(e,t,n,r){this.$kind="Annotation",this.title=e,this.summary=n,this.items=t,this.items_V3=[],this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class D5{constructor(e,t,n,r,o,i,s){this.$kind="ProductCapability",this.type=e,this.title=t,this.caption=n,this.captionTrailingArtwork=r,this.linkAction=o,this.artwork=i,this.artworkTintColor=s}}const{routes:_5,makeCanonicalUrl:L5}=dc(bi,"/{platform}/story/{id}"),{routes:M5,makeCanonicalUrl:x5}=uc(bi,"/story/{id}")
class $5{constructor(e,t,n){this.$kind="AnnotationGroup",this.title=e,this.annotations=t,this.forceExpanded=n}}class F5{constructor(e){this.$kind="InformationContainer",this.annotationGroups=e}}const N5=[pu,gu,xl,jl,vu,$l,Hl,Ql,Zl,Kl,Bl,mu,ql,Wl,Xl,Vl],B5=[gu,xl,jl,vu,$l,Hl,Ql,Zl,Kl,Bl,mu,ql,pu,Wl,Xl,Vl],U5=[pu,xl,function(e,t,n,r,o,i){const s=Ze(e,t,dU)
if(0===s.length)return null
const a=s[0]
let c=null
const l=f(a,cU)
if(l){const t=e.loc.string("ProductPage.VersionAnnotation.Value.DateFormat")
c=e.loc.formatDate(t,new Date(l))}const u=f(a,BD)
if(0===s.length)return null
let d
if(u&&c)d=e.loc.string("ProductPage.VersionAnnotation.Value").replace("@@version@@",u).replace(SA,c)
else{if(!u)return null
d=u}const h=new E5(d),p=o?"":e.loc.string("ProductPage.VersionAnnotation.Title"),w=new R5(p,[h])
return w&&!r?w:null},gu,Wl,Vl],G5=[$l,Zl,Bl,function(e,t,n,r,o,i){const s=[],a=Nl(e,t);(0,Hv.isSome)(a)&&s.push(a)
const c=Gl(e,t)
if((0,Hv.isSome)(c)&&s.push(c),0===s.length)return null
const l=e.loc.string("InfoList.AgeRating.Title.KR"),u=new R5(l,s)
return u.shouldAlwaysPresentExpanded=!0,u}]
class j5{constructor(e,t,n,r){this.$kind="ProductDescription",this.paragraph=e,this.developerAction=r,this.tags=n,this.developerLinks=t}}class V5{constructor(e,t,n,r){this.$kind="ProductPageLink",this.text=e,this.clickAction=t,this.systemImageName=n,this.adamIdForPurchaseHistoryFilter=r}}const H5="safari",q5="hand.raised.fill",W5="doc.plaintext",z5="questionmark.circle",Y5="exclamationmark.triangle",J5="checkmark.seal"
class K5{constructor(e,t){this.$kind="EditorialQuote",this.text=e,this.attribution=t}}class Z5 extends CW{constructor(e){super(),this.$kind="GameCenterPlayerProfileAction",this.actionClass="GameCenterPlayerProfileAction",this.playerId=e}}class Q5{constructor(e,t,n,r,o){this.$kind="InformationRibbon",this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class X5{constructor(e,t,n,r,o,i,s,a,c,l=BH){this.$kind="Badge",this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r,this.isMonochrome=!0}}const e6="DeveloperPageIntent",t6=[ku,Uu,Iu,xu,$u,_u,function(e,t,n,r){var o
return null!==(o=Ou(e,t))&&void 0!==o?o:Eu(e,t)},Mu],n6=[Bu,Lu,Cu,ku,Uu],r6=[Bu,ku,Uu,Ou,function(e,t,n,r){if(!et(e,t,IB))return null
const o=e.loc.string("BADGE_FRIENDS_HEADING","Friends"),i=aW,s=gq,a=gq,c={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:t.id}
return new X5(s,a,c,i,o,"",null,"",o,BH)},Cu,Iu,xu,$u,_u,Eu,Mu,function(e,t,n,o){if(st(e).isSystemAppFromData(t))return null
const i=Rf(e,t)
if(r(i)||r(i.fileSizeByDevice))return null
const s=function(e,t){let n
if(n=(0,Wv.isSome)(t.maxEssentialInstallSizeInBytes)?t.fileSizeByDevice+t.maxEssentialInstallSizeInBytes:(0,Wv.isSome)(t.maxInstallSizeInBytes)?t.fileSizeByDevice+t.maxInstallSizeInBytes:t.fileSizeByDevice,n<=0)return null
const r=e.loc.fileSize(n).trim().split(/\s+/)
return 2!==r.length?null:{size:r[0],unit:r[1]}}(e,i)
if(!s)return null
const a={paragraphText:s.size},c=s.unit,l=e.loc.string("BADGE_SIZE_HEADING")
return new X5(Nj,GN,a,aW,l,c,null,null,c,mV)}]
class o6{constructor(e){this.componentType=Wx,this.$kind="ProductRatingsAndReviewsMessage",this.messageText=e}}class i6{constructor(){this.$kind="ProductReviewAction"}}class s6{constructor(){this.$kind="ProductWriteAReview"}}class a6{constructor(){this.$kind="ProductReviewActions",this.componentType="productReviewActions"}}class c6{constructor(e,t,n){this.$kind="TitledParagraph",this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}!function(e){e.StoryCenteredMotion16x9="storyCenteredMotion16x9",e.StoryCenteredStatic16x9="storyCenteredStatic16x9",e.StoryDetailMotion3x4="storyDetailMotion3x4",e.StoryDetailStatic3x4="storyDetailStatic3x4",e.HeroMotion16x9="heroMotion16x9",e.HeroStatic16x9="heroStatic16x9",e.HeroMotionRTL16x9="heroMotionRTL16x9",e.HeroStaticRTL16x9="heroStaticRTL16x9",e.LargeBreakoutMotion16x9="largeBreakoutMotion16x9",e.LargeBreakoutStatic16x9="largeBreakoutStatic16x9",e.LargeBreakoutRTLMotion16x9="largeBreakoutRTLMotion16x9",e.LargeBreakoutRTLStatic16x9="largeBreakoutRTLStatic16x9",e.StoryCardMotion3x4="storyCardMotion3x4",e.StoryCardStatic3x4="storyCardStatic3x4",e.StorySearchStatic16x9="storySearchStatic16x9",e.SubscriptionHero="subscriptionHero",e.UniversalAMotion16x9="universalAMotion16x9",e.UniversalAStatic16x9="universalAStatic16x9",e.BrickStatic16x9="brickStatic16x9",e.BrickStaticRTL16x9="brickStaticRTL16x9",e.SearchCategoryBrick="searchCategoryBrick"}($m||($m={})),function(e){e.Hero="hero",e.LargeBreakout="largeBreakout",e.StoryCard="storyCard",e.StoryDetail="storyDetail",e.StoryDetailLandscape="storyDetailLandscape",e.Search="search",e.Brick="brick",e.EditorialLockup="editorialLockup",e.EditorialPage="editorialPage"}(Fm||(Fm={}))
const l6={hero:[$m.HeroMotion16x9,$m.HeroStatic16x9,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],largeBreakout:[$m.LargeBreakoutMotion16x9,$m.LargeBreakoutStatic16x9,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyCard:[$m.StoryCardMotion3x4,$m.StoryCardStatic3x4,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyDetail:[$m.StoryDetailMotion3x4,$m.StoryDetailStatic3x4,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyDetailLandscape:[$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9,$m.StoryDetailMotion3x4,$m.StoryDetailStatic3x4],search:[$m.StorySearchStatic16x9,$m.StoryCenteredStatic16x9,$m.UniversalAStatic16x9],brick:[$m.BrickStatic16x9,$m.HeroStatic16x9,$m.StoryCenteredStatic16x9,$m.UniversalAStatic16x9,$m.SearchCategoryBrick],editorialLockup:[$m.SubscriptionHero],editorialPage:[$m.StoryCardStatic3x4,$m.HeroStatic16x9,$m.StoryCenteredStatic16x9,$m.SubscriptionHero]},u6={hero:[$m.HeroMotionRTL16x9,$m.HeroStaticRTL16x9,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],largeBreakout:[$m.LargeBreakoutRTLMotion16x9,$m.LargeBreakoutRTLStatic16x9,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyCard:[$m.StoryCardMotion3x4,$m.StoryCardStatic3x4,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyDetail:[$m.StoryDetailMotion3x4,$m.StoryDetailStatic3x4,$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9],storyDetailLandscape:[$m.StoryCenteredMotion16x9,$m.StoryCenteredStatic16x9,$m.UniversalAMotion16x9,$m.UniversalAStatic16x9,$m.StoryDetailMotion3x4,$m.StoryDetailStatic3x4],search:[$m.StorySearchStatic16x9,$m.StoryCenteredStatic16x9,$m.UniversalAStatic16x9],brick:[$m.BrickStaticRTL16x9,$m.HeroStatic16x9,$m.StoryCenteredStatic16x9,$m.UniversalAStatic16x9,$m.SearchCategoryBrick],editorialLockup:[$m.SubscriptionHero],editorialPage:[$m.StoryCardStatic3x4,$m.HeroStatic16x9,$m.StoryCenteredStatic16x9,$m.SubscriptionHero]}
class d6{constructor(e){this.$kind="MetadataRibbonItem",this.viewType=e,this.moduleType=null,this.labelText=null,this.borderedText=null,this.highlightedText=null,this.starRating=null,this.secondaryViewPlacement=eW,this.artwork=null,this.maxCharacterCount=null,this.truncationLegibilityCharacterCountThreshold=null,this.allowsTruncation=null}}const f6={chartPositions:function(e,t,n,r,i){var s,a
const c=function(e,t){const n=Ke(e,t,TD)
if(o(n))return null
const r=$f(0,e.host.clientIdentifier)
return o(r)?null:p(n,r)}(e,t)
if(o(c))return null
const l=h(c,GM)
if((0,Wv.isNothing)(l)||l>50)return null
const u=null!==(s=f(c,"genreShortName"))&&void 0!==s?s:f(c,HP)
if(null!=u){if(r.has(u))return null
r.add(u)}let d
d=e.bag.isLLMSearchTagsEnabled?new d6("highlightedText"):new d6("borderedTextLabel"),d.moduleType=TD
const w=(0,Wv.isSome)(null===(a=n.searchAdOpportunity)||void 0===a?void 0:a.searchAd)||(0,Wv.isSome)(n.searchAd)?e.bag.adsOverrideLanguage:null,g=(0,Wv.isSome)(w)?e.adsLoc:e.loc
{const t=g.string("MetadataRibbon.ChartPosition").replace(iC,e.loc.formattedCountForPreferredLocale(e,l,w))
e.bag.isLLMSearchTagsEnabled?(d.highlightedText=t,d.labelText=g.string("MetadataRibbon.ChartPositionAndCategory.Tags").replace(iC,e.loc.formattedCountForPreferredLocale(e,l,w)).replace("@@category@@",u)):(d.labelText=u,d.borderedText=t)}return d.secondaryViewPlacement=eW,xh(e,d,Gh(i,px,d.labelText,rW)),[d]},genreDisplayName:function(e,t,n,r,i){const s=Sn(e,t,!0),a=(0,Hv.isSome)(s),c=Id(e,t)
if(o(c))return null
if(null!=c){if(r.has(c))return null
r.add(c)}const l=new d6(a?Ex:CF)
if(l.moduleType=cV,l.labelText=c,a){const t=Zd(e,s,{useCase:y6.CategoryIcon})
t.crop="sr",l.artwork=t}return xh(e,l,Gh(i,cV,l.labelText,rW)),[l]},genreShortDisplayName:function(e,t,n,r,o){const i=Sn(e,t,!0),s=(0,Hv.isSome)(i),a=j(t,PF)
if(null!=a){if(r.has(a))return null
r.add(a)}if((0,Hv.isNothing)(a)||0===a.length)return null
const c=new d6(s?Ex:CF)
return c.moduleType=PF,c.labelText=a,s&&(c.artwork=Zd(e,i,{useCase:y6.CategoryIcon,cropCode:"sr"})),xh(e,c,Gh(o,cV,c.labelText,rW)),[c]},secondaryGenreShortDisplayNames:function(e,t,n,r,i){const s=G(t,n_)
return o(s)?null:s.map(t=>{const n=new d6(CF)
n.moduleType=PF,n.labelText=t
const r=Gh(i,cV,n.labelText,rW)
return xh(e,n,r),Oh(i.locationTracker),n}).filter(e=>null!=e.labelText&&!r.has(e.labelText))},developerInfo:function(e,t,n,r,o){var i
let s=n.developerName
if((0,Hv.isNothing)(s)&&(s=null!==(i=j(t,sH))&&void 0!==i?i:j(t,eS)),null!=s){if(r.has(s))return null
r.add(s)}if((0,Hv.isSome)(s)&&s.length>0){const t=new d6(Ex)
t.moduleType=sC,t.labelText=s,t.artwork=Ot(e,gx)
const n=6
return t.maxCharacterCount=16,t.truncationLegibilityCharacterCountThreshold=Math.min(n,s.length),t.allowsTruncation=s.length>=n,xh(e,t,Gh(o,sC,t.labelText,rW)),[t]}return null},editorialBadgeInfo:function(e,t,n,r,o){var i
if(n.isEditorsChoice){const t=new d6(LH)
return t.moduleType=TG,t.useAdsLocale=((0,Wv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd)||(0,Wv.isSome)(n.searchAd))&&(0,Wv.isSome)(e.bag.adsOverrideLanguage),xh(e,t,Gh(o,TG,"Editors Choice",rW)),[t]}return null},userRating:function(e,t,n,r,o){const s=et(e,t,wq)
if(i(n.ratingCount)&&i(n.rating)&&!s){const t=new d6("starRating")
return t.moduleType=VB,t.starRating=n.rating,t.labelText=n.ratingCount,xh(e,t,Gh(o,VB,"User Rating",rW)),[t]}return null},supportsGameController:function(e,t,n,r,o){var i
let s=!1
switch(Qe(e,t,bj)){case Xx:case gL:s=!0}if(et(e,t,g_)&&(s=!0),!s)return null
const a=new d6(Ex)
a.moduleType=g_
const c=((0,Wv.isSome)(n.searchAd)||(0,Wv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd))&&(0,Wv.isSome)(e.bag.adsOverrideLanguage)
return a.labelText=c?e.adsLoc.string(jB):e.loc.string(jB),a.artwork=Ot(e,HN),xh(e,a,Gh(o,g_,"Supports Game Controller",rW)),[a]},tag:function(e,t,n,r,o){const i=t,s=new d6(CF)
return s.moduleType=z$,s.labelText=j(i,fW),(0,Hv.isNothing)(s.labelText)||0===s.labelText.length||r.has(s.labelText)?null:(xh(e,s,Gh(o,i.id,s.labelText,"tag_id")),r.add(s.labelText),[s])},divider:function(e,t,n,r,o){const i=new d6(aC)
return i.moduleType=aC,i.labelText="|",[i]}},h6=0,p6=1,w6=2,g6=3,v6=4,m6=5,y6={Default:0,LockupIconSmall:1,LockupIconMedium:2,LockupIconLarge:3,LockupScreenshots:4,ArcadeSmallBreakout:5,ArcadeLargeBreakout:6,ArcadeContextualUpsell:7,SearchIcon:8,SearchEditorialResult:9,ProductPageIcon:10,ProductPageScreenshots:11,ProductPageBadge:12,ArticleImage:13,ArticleScreenshots:14,TodayCardMedia:15,TodaySmallStoryCard:16,TodayCardBrandedTitle:17,GroupingBrick:18,GroupingHero:19,CategoryIcon:20,Uber:21,TVTopShelf:22,VideoCardStill:23,ArcadeWelcomeSheet:24,WidgetLockupIcon:25,WidgetEditorial:26,ImageLockup:27,CategoryBreakoutShelf:28,RibbonBarFacet:29,MediaPageHeader:30}
class A6{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}!function(e){e[e.seeAllPage=0]="seeAllPage",e[e.categoryBreakout=1]="categoryBreakout",e[e.other=2]="other"}(Nm||(Nm={}))
class T6{constructor(e,t){this.videos=e,this.mediaPlatform=t}}const b6=new Sz(414,896),S6=new Sz(375,812),P6=new Sz(414,736),I6=new Sz(375,667),C6=new Sz(320,568),k6=new Sz(320,480),O6=(new Sz(768,1024),new Sz(810,1080)),E6=new Sz(834,1112),R6=new Sz(834,1194),D6=new Sz(1194,834),_6=new Sz(1024,1366),L6=new Sz(1024,1366),M6=new Sz(1366,1024),x6=new Sz(744,1133),$6=new Sz(1133,744),F6=new Sz(1032,1376),N6=new Sz(1376,1032),B6=new Sz(834,1210),U6=new Sz(1210,834),G6=new Sz(312,390),j6=new Sz(368,448),V6=new Sz(396,484),H6=new Sz(410,502),q6=new Sz(416,496),W6=new Sz(410,502),z6=new Sz(820,1180),Y6=new Sz(360,780),J6=new Sz(390,844),K6=new Sz(428,926),Z6=new Sz(393,852),Q6=new Sz(430,932),X6=new Sz(402,874),e3=new Sz(440,956),t3=new Sz(420,912),n3=new Sz(422,514),r3=[gE,pE,wE,KL,ET,OT,kT,_q],o3=112.5,i3=4.5,s3="#9BA9BD",a3={colorHex:s3,maxSaturation:4,maxBrightness:9},c3=[a3],l3=[{colorHex:"#F7816F",minHue:0,maxHue:16},{colorHex:"#FF9034",minHue:17,maxHue:33},{colorHex:"#E3B059",minHue:34,maxHue:59},{colorHex:"#74BD66",minHue:60,maxHue:129},{colorHex:"#72C792",minHue:130,maxHue:169},{colorHex:"#61BFE2",minHue:170,maxHue:209},{colorHex:"#6EA3E9",minHue:210,maxHue:239},{colorHex:"#7D69FA",minHue:240,maxHue:259},{colorHex:"#B363F7",minHue:260,maxHue:289},{colorHex:"#EE7CBD",minHue:290,maxHue:360}]
class u3{constructor(){this.position=0}}class d3 extends jY{constructor(e,t){super(e.fields,e.id,e.custom||{}),void 0!==this.custom&&(this.custom.isFast=t),this.isFast=t}}const f3="::"
class h3{constructor(e,t,n=0){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t,this.sequenceId=n}addImpressionsToShelf(e,t,n,r,o,i,s){Mh(e,t,{id:null!=r?r:`${this.sequenceId}`,idType:null!=o?o:Aq,kind:null,softwareType:null,targetType:n,title:null!=s?s:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,recoMetricsData:i}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n,r){t&&(Mh(e,t,{id:h3.similarItemsShelfId,kind:null,softwareType:null,targetType:n,title:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:r}),this.sequenceId++)}static resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,t){const n=t.sourceLocationTracker
kh(n,0),Ch(n).id=h3.similarItemsDuringDownloadShelfId}static addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,t,n){t&&Mh(e,t,{id:h3.similarItemsDuringDownloadShelfId,kind:null,softwareType:null,targetType:iq,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:BU})}}h3.similarItemsShelfId=OG,h3.similarItemsDuringDownloadShelfId=PO
const p3="write-review",w3=Fq,g3="appPromotionRequirementKey"
Pe(ye("F0F0F8"),ye("303031")),function(e){e.MoreByDeveloper="moreByDeveloper",e.SimilarItems="similarItems",e.SmallStory="smallStory"}(Bm||(Bm={})),function(e){e.SelectionOnly="selectionOnly",e.PurchaseAndOpen="purchaseAndOpen"}(Um||(Um={}))
class v3{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.isFirstRender=!0,this.isBundleShelf=!1,this.showingPlaceholders=!1,this.productId=e,this.onDemandShelfType=d,this.remainingItems=t,this.title=n,this.shouldInferSeeAllFromFetchesItems=r,this.capabilities=o,this.contentType=i,this.offerStyle=s,this.spotlightInAppProductIdentifier=a,this.refreshUrl=c,this.recoMetricsData=l,this.supportsArcade=u}static fromJSON(e,t){if((0,Wv.isNothing)(t))throw new Error("tokenJson is required")
const n=JSON.parse(t,(t,n)=>typeof n===fV&&"adPageInfo"===t&&s(n)&&(0,Wv.isSome)(e)?Q0.from(e,n):n)
return n}}const m3=[Aj,fH,oW,rq],y3=(0,zv.makeMetatype)("app-store:page-router")
class A3{constructor(){this.registeredBuilders=new Set,this.pageRouter=new uz,this.shelfRouter=new uz,this.paginationRouter=new uz}registerPageBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.pageRouter.associate(t.pageRoute(e),t),this.shelfRouter.associate(t.shelfRoute(e),t),this.paginationRouter.associate(t.paginationRoute(e),t)}registerShelfBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.shelfRouter.associate(t.shelfRoute(e),t)}registerPaginationBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.paginationRouter.associate(t.paginationRoute(e),t)}fetchFlowPage(e){const t=this.pageRouter.routedObjectForUrl(e)
if(!t.object)return"unknown"
const n=t.object
return n.builderClass===qA&&t.parameters[zW.action]!==w3&&t.parameters[zW.action]!==p3?yH:n.pageType()}async fetchPage(e,t,n){return await this.fetchAction(e,t,null).then(async r=>await new Promise((o,i)=>{if(!r)throw new Error(`Promise resolved to null action for: ${t}`)
if(r.actionClass!==aL){if(r.actionClass===aO){const e=r
if(1===e.actions.length&&e.actions[0].actionClass===aL){const t=e.actions[0].pageData
return P(t,n)?void o(t):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(t)}`))}}i(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const s=r.pageData
if(!P(s,n)){const a=r.pageUrl
return a&&a!==t?void this.fetchPage(e,a,n).then(e=>{o(e)}).catch(e=>{i(e)}):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(s)}`))}o(s)}}))}async fetchAction(e,t,n,r=new Set){var o
const i=this.pageRouter.routedObjectForUrl(t)
if(!i.object)return await this.redirectAndRefetchActionIfPossible(e,i.normalizedUrl,r)
const s=i.object
return await s.handlePage(e,i.normalizedUrl,null!==(o=i.parameters)&&void 0!==o?o:{},i.matchedRuleIdentifier,n)}async fetchMoreOfPage(e,t){const n=t.url
if(!n)throw new Error("Page token missing required `url` property")
const r=this.paginationRouter.routedObjectForUrl(n)
if(!r.object)throw new Error(`fetchMoreOfPage: Unhandled pagination url: ${n}`)
const o=r.object
return await o.handlePagination(e,r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t)}async fetchShelves(e,t){const n=Object.keys(t),r=n.map(e=>t[e]),o=await L(r.map(async t=>{if((0,Hv.isNothing)(t))throw new Error("fetchShelves: Null shelf url")
const n=this.shelfRouter.routedObjectForUrl(t)
if((0,Hv.isNothing)(n.object))throw new Error(`fetchShelves: Unhandled shelf url: ${t}`)
const r=n.object
return await r.handleShelf(e,n.normalizedUrl,n.parameters,n.matchedRuleIdentifier)})),i={shelves:{},errors:{}}
for(const[e,t]of o.entries()){const r=n[e];(0,Hv.isNothing)(r)||(t.success?i.shelves[r]=t.value:i.errors[r]=t.error)}if(Object.keys(i.shelves).length>0)return i
{const e=Object.keys(i.errors).map(e=>i.errors[e].message)
throw 0===e.length?new Error(`Could not load any shelves: ${JSON.stringify(t)}`):new Error(e.join("\n"))}}async redirectAndRefetchActionIfPossible(e,t,n=new Set){const r=t.toString()
if(n.has(r))throw new Error(`redirectAndRefetchActionIfPossible: Redirect cycle detected for URL: ${r}`)
n.add(r)
const o=await M(e.network.fetch({url:r,method:XN}))
if(!o.success)throw new Error(`redirectAndRefetchActionIfPossible: Failed to fetch page at url: ${t}`)
const i=o.value
if(this.hasGotoURLInResponse(e,i))return new kW
if(200===i.status&&i.redirected&&i.url)return await this.fetchAction(e,i.url,null,n)
throw new Error(`redirectAndRefetchActionIfPossible: Unhandled page url: ${t}`)}hasGotoURLInResponse(e,t){if(o(t.body))return!1
try{const n=m(e.plist.parse(t.body)),r=f(n,JO),o=f(n,KO)
return!(r!==ZO||!(0,Hv.isSome)(o))}catch{return!1}}fetchBuilder(e){const t=this.pageRouter.routedObjectForUrl(e)||this.shelfRouter.routedObjectForUrl(e)||this.paginationRouter.routedObjectForUrl(e)
return t?t.object:null}}Gm=e(9100)
const T3={bag:(jm=e(1222)).bag,dispatcher:(0,zv.makeMetatype)("dispatcher"),host:jm.host,localizer:jm.localizer,network:jm.net,plist:jm.plist,platform:jm.platform,router:(0,zv.makeMetatype)("router"),client:(0,zv.makeMetatype)("client"),debugSettings:(0,zv.makeMetatype)("debugSettings"),nativeIntentDispatcher:(0,zv.makeMetatype)("nativeIntentDispatcher"),personNameComponentsFormatter:(0,zv.makeMetatype)("personNameComponentsFormatter")},b3=(0,zv.makeMetatype)("app-store:active-intent")
class S3{constructor(e){this.implementation=e,this.inferredPreviewPlatform=void 0}setInferredPreviewPlatform(e){this.inferredPreviewPlatform=e}get previewPlatform(){var e
return null!==(e=this.inferredPreviewPlatform)&&void 0!==e?e:this.implementation.previewPlatform}get platform(){if((0,Wv.isSome)(this.previewPlatform))switch(this.previewPlatform){case Dq:case _q:case lW:case cW:return this.previewPlatform
case"tv":return ZB
case Qq:return XV
default:x(this.previewPlatform)}}get attributePlatform(){if((0,Wv.isSome)(this.previewPlatform))switch(this.previewPlatform){case _q:case Dq:return kq
case lW:return lH
case"tv":return nV
case Qq:return nH
case cW:return cW
default:x(this.previewPlatform)}}get appPlatform(){if((0,Wv.isSome)(this.previewPlatform))switch(this.previewPlatform){case Dq:return Kq
case _q:return nW
case lW:return lW
case"tv":return"tv"
case Qq:return Qq
case cW:return cW
default:x(this.previewPlatform)}}}const P3=(0,zv.makeMetatype)("app-store:locale")
class I3{constructor(e){this.objectGraph=e}get activeStorefront(){return this.objectGraph.bag.mediaCountryCode}get activeLanguage(){return this.objectGraph.bag.language}setActiveLocale(e){}normalize(e){return{storefront:this.activeStorefront,language:this.activeLanguage}}deriveLocaleForUrl(e){return e}}const C3=(0,zv.makeMetatype)("app-store:seo")
class k3 extends nY{get isSupportEnabled(){return k3.cache.get("isSupportEnabled",()=>i(this.implementation)&&this.implementation.isSupportEnabled)}get isRosettaAvailable(){return k3.cache.get("isRosettaAvailable",()=>i(this.implementation)&&this.implementation.isRosettaAvailable)}}k3.type=(0,zv.makeMetatype)("app-store:as-wrapper"),k3.cache=new rY
class O3 extends nY{constructor(){super(...arguments),this.cache={}}registerBagKeys(e){this.implementation.registerBagKeys(e)}string(e,t=!1){return this.fromCache(e,t,()=>this.implementation.string(e))}double(e,t=!1){return this.fromCache(e,t,()=>this.implementation.double(e))}integer(e,t=!1){return this.fromCache(e,t,()=>this.implementation.integer(e))}boolean(e,t=!1){return this.fromCache(e,t,()=>this.implementation.boolean(e))}array(e,t=!1){return this.fromCache(e,t,()=>this.implementation.array(e))}dictionary(e,t=!1){return this.fromCache(e,t,()=>this.implementation.dictionary(e))}url(e,t=!1){return this.fromCache(e,t,()=>this.implementation.url(e))}fromCache(e,t=!1,n){if(t)return n()
{const t=this.cache[e]
if((0,Hv.isSome)(t))return t.value
{const t=n()
return this.cache[e]={value:t},t}}}}class E3 extends nY{constructor(e){super(new O3(e)),this.underlyingBag=e}get todayAdMediumLockupScreenshotEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-enabled"))&&void 0!==e&&e}get todayAdMediumLockupScreenshotAnimationEnabled(){var e
return null===(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-animation-enabled"))||void 0===e||e}get trendingSearchesURL(){return this.implementation.url("trending-searches")}get userRateURL(){return this.implementation.url("p2-application-user-rate-content")}get saveUserReviewURL(){return this.implementation.url("save-user-review")}get writeReviewURL(){return this.implementation.url("p2-application-user-write-review")}get passbookMainURL(){return this.implementation.url("passbook")}get metricsConfiguration(){return y(this.implementation.dictionary(Cj))}get metricsPaymentNamespaceEnabled(){if(o(this.metricsPaymentTopic))return!1
const e=y(this.implementation.dictionary(Rk)),t=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT"),n=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT")
return(0,Hv.isSome)(t)&&0!==t.length&&(0,Hv.isSome)(n)&&0!==n.length}get metricsPaymentTopic(){var e
return null!==(e=f(this.metricsConfiguration,"topics.APPSTORE_PAYMENTS_ENGAGEMENT_TOPIC"))&&void 0!==e?e:null}get personalizationUserIdEnabled(){const e=p(y(this.implementation.dictionary(Rk)),"APPSTORE_PERSONALIZATION")
return(0,Hv.isSome)(e)&&0!==Object.keys(e).length}get language(){return this.implementation.string(J_)}get mediaApiLanguage(){return this.implementation.string("language-tag")||this.implementation.string(J_)}get termsAndConditionsURL(){return this.implementation.url("p2-service-terms-url")}get isMonetaryGiftingEnabled(){return this.implementation.boolean("isBuyingScheduledGiftCertificateEnabled")}get accountTopUpURL(){return this.implementation.url("AddFundsUrl")}get accountTopUpTitle(){return this.implementation.string("account-top-up-title")}get isContentGiftingEnabled(){return this.implementation.boolean("isScheduledGiftingEnabled")}get buyButtonMetadataURL(){return this.implementation.url("personalized-buy-buttons/software")}get isTVAppEnabled(){return this.implementation.boolean("uvSearch/nowplaying-enabled")}get emailSupportLinkURL(){return this.implementation.url("supportLinkUrl")}get voteUrl(){return this.implementation.url("voteUrl")}get enableReviewSummarization(){return this.implementation.boolean("enable-review-summarization")}get reviewSummaryReportConcernData(){return y(this.implementation.dictionary("review-summarization-report-concern"))}get reportConcernUrl(){return this.implementation.url("reportConcernUrl")}get reportConcernExplanation(){return this.implementation.string("reportConcernExplanation")}get reportConcernReasons(){return l(m(this.implementation.array("reportConcernReasons")))}get reportProblemEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-report-problem-enabled"))&&void 0!==e&&e}get productPageReportProblemURL(){return this.implementation.string("product-page-report-problem-url")}get productPageReportProblemSADSubscriptionArray(){return l(m(this.implementation.array("product-page-report-problem-sad-subscriptions")))}get productPageReportProblemSecondPartyAppArray(){const e=l(m(this.implementation.array("product-page-report-problem-second-party-apps")))
return o(e)?["1473505534","1416238567","640199958","1529498570","915061776","1130498044","1070072560"]:e}get createAccountUrl(){var e
return null!==(e=this.implementation.url("createAccountUrl"))&&void 0!==e?e:uO}get mediaCountryCode(){return this.implementation.string("countryCode")}get mediaHost(){return this.implementation.url("apps-media-api-host")}mediaEdgeHost(e){return e.host.clientIdentifier===_z?this.implementation.url(jx):this.implementation.string(jx)}get mediaAPICatalogMixedShouldUseEdge(){var e
return null!==(e=this.implementation.boolean("apps-media-api-catalog-mixed-should-use-edge"))&&void 0!==e&&e}get mediaEdgeSearchHost(){return this.implementation.string("apps-media-api-search-edge-host")}get mediaPreviewHost(){return this.implementation.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.implementation.string("notification-settings-media-api-host")}get edgeEndpoints(){return l(m(this.implementation.array("apps-media-api-edge-end-points")))}get mediaAdvertRequestLimit(){var e
return null!==(e=this.implementation.double("apps-media-api-search-ads-limit"))&&void 0!==e?e:4}get searchSortOptions(){return l(m(this.implementation.array("searchSortOptions")))}get ageBands(){return l(m(this.implementation.array("ageBands")))}get redirectUrlWhitelistedQueryParams(){let e=l(m(this.implementation.array("processRedirectUrl/whitelistedQueryParams")))
return o(e)&&(e=["affC",yk,Dk,"at","ct",_k,Lk,"itscc",Mk,mk,"ls","partnerId","pt","qtkid","uo"]),e}get redirectUrlEndpoint(){var e
return null!==(e=this.implementation.string("processRedirectUrl/endpoint"))&&void 0!==e?e:"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"}get aristotleParentAppAdamId(){var e
return null!==(e=this.implementation.string("aristotle-app-id"))&&void 0!==e?e:"383941000"}get arcadeAppAdamId(){return this.implementation.string("app-store-app-id")}get arcadeProductFamilyId(){var e
return null!==(e=this.implementation.string("arcade-iap-family-id"))&&void 0!==e?e:this.implementation.string("ocelot-iap-family-id")}get arcadeProductId(){var e
return null!==(e=this.implementation.string("arcade-iap-offer-name"))&&void 0!==e?e:this.implementation.string("ocelot-iap-offer-name")}get arcadeCategoryBarSAGUpliftDisplayRate(){var e
return null!==(e=this.implementation.double("arcade-category-bar-see-all-games-display-rate"))&&void 0!==e?e:0}get isArcadeEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-enabled"))&&void 0!==e&&e}get isAppsGroupingTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-groupings-tags-enabled"))&&void 0!==e&&e}get isAppsProductPageTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-product-page-tags-enabled"))&&void 0!==e&&e}get isAppsSlpTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-slp-tags-enabled"))&&void 0!==e&&e}get searchResultsLearnMoreEditorialId(){return this.implementation.string("transparencyLawEditorialItemId")}get systemApps(){return l(m(this.implementation.array("hideableSystemApps")))}get nonDeletableSystemApps(){const e=m(this.implementation.array("nonDeletableSystemApps"))
return s(e)?l(e):[{id:1635387927,"bundle-id":tA},{id:1635862301,"bundle-id":nA},{id:1584216343,"bundle-id":"com.apple.findmy.finddevices"},{id:1584215960,"bundle-id":"com.apple.NanoWorldClock"},{id:1584215812,"bundle-id":"com.apple.HeartRate"},{id:1584215851,"bundle-id":"com.apple.SessionTrackerApp"},{id:1146562108,"bundle-id":"com.apple.NanoPhone"},{id:1146560473,"bundle-id":ay},{id:1584215428,"bundle-id":"com.apple.NanoPhotos"},{id:1459455352,"bundle-id":eA},{id:1067456176,"bundle-id":Xy}]}get tabsStandard(){return l(m(this.implementation.array("tabs/standard")))}get watchAppsGroupingURL(){var e
return null!==(e=this.implementation.url("watchAppsGrouping"))&&void 0!==e?e:"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"}get requireAgeVerification(){return this.implementation.boolean("requireAgeVerification")}get ageRatingLearnMoreEditorialItemId(){return this.implementation.string("ageRatingLearnMoreEditorialItemId")}get appleSiliconMacUnverifiedBadgeEditorialItemId(){return this.implementation.string("appleSiliconMacUnverifiedBadgeEditorialItemId")}get safariExtensionsGroupingURL(){return this.implementation.url("safariExtensionsGrouping")}get familySubscriptionsLearnMoreEditorialItemId(){return this.implementation.string("familySubscriptionsLearnMoreEditorialItemId")}get dynamicUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/dynamic-url-patterns")))}get financeUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/url-patterns")))}get webViewRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/v2-url-patterns")))}get arcadePreOrderUpsellLimitSeconds(){var e
return null!==(e=this.implementation.double("arcadePreOrderUpsellLimitSeconds"))&&void 0!==e?e:86400}get recentlyPlayedGamesWindowInSeconds(){var e
return null!==(e=this.implementation.double("recentlyPlayedGamesWindowInSeconds"))&&void 0!==e?e:7776e3}get gamesFriendsPlayedWindowInSeconds(){var e
return null!==(e=this.implementation.integer("games-friends-played-window-in-seconds"))&&void 0!==e?e:15778800}get enableComingSoonToggle(){return this.implementation.boolean("enableComingSoonToggle")}get enableAppAccessibilityLabels(){var e
return null!==(e=this.implementation.boolean("enable-app-accessibility-labels"))&&void 0!==e&&e}get enablePrivacyNutritionLabels(){var e
return null!==(e=this.implementation.boolean("enable-privacy-nutrition-labels"))&&void 0!==e&&e}get enableSellerInfo(){var e
return null!==(e=this.implementation.boolean("enable-seller-info"))&&void 0!==e&&e}get enableSellerICPAnnotation(){var e
return null!==(e=this.implementation.boolean("enable-seller-icp"))&&void 0!==e&&e}get enableFeaturedCategoriesOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-featured-categories-on-groupings"))&&void 0!==e&&e}get enableCategoryBricksOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-category-bricks-on-groupings"))&&void 0!==e&&e}get sponsoredSearchODMLTimeout(){var e
return null!==(e=this.implementation.double("sponsored-search-odml-timeout"))&&void 0!==e?e:3}get isSearchLandingAdsEnabled(){var e
return null!==(e=this.implementation.boolean("isSearchLandingAdsEnabled"))&&void 0!==e&&e}get isLLMSearchTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-tags-enabled"))&&void 0!==e&&e}get searchLandingAdFetchTimeout(){var e
return null!==(e=this.implementation.double("search-landing-ad-fetch-timeout"))&&void 0!==e?e:.175}get searchLandingPageOffscreenRefreshInterval(){var e
return null!==(e=this.implementation.double("search-landing-offscreen-refresh-interval-in-seconds"))&&void 0!==e?e:60}get searchLandingPageRefreshUpdateDelayInterval(){var e
return null!==(e=this.implementation.double("search-landing-page-update-delay-interval-in-seconds"))&&void 0!==e?e:.3}get appPrivacyLearnMoreEditorialItemId(){return this.implementation.string("appPrivacyLearnMoreEditorialItemId")}get ratingsAndReviewsLearnMoreEditorialId(){return this.implementation.string("ratings-and-reviews-learn-more-editorial-item-id")}get reviewSummarizationLearnMoreEditorialItemId(){return this.implementation.string("review-summarization-learn-more-editorial-item-id")}get suppressedPrivacyAppIds(){return l(m(this.implementation.array("suppressedPrivacyLabels")))}get suppressedAccessibilityAppIds(){return l(m(this.implementation.array("suppressed-accessibility-labels")))}get appPrivacyDefinitionsEditorialItemId(){return this.implementation.string("appPrivacyDefinitionsEditorialItemId")}get webNavigationCategoryTabsEditorialItemId(){return this.implementation.string("web-navigation-category-tabs-editorial-item-id")}get todayWidgetLivePreviewRolloutRate(){var e
return null!==(e=this.implementation.double("todayWidgetLivePreviewRolloutRate"))&&void 0!==e?e:1}get hero3RolloutRate(){var e
return null!==(e=this.implementation.double("arcade-hero-shelf-tagline-style-rollout-rate"))&&void 0!==e?e:1}get arcadeTrialEnrolledStateRate(){var e
return null!==(e=this.implementation.double("arcade-trial-enrolled-state-rate"))&&void 0!==e?e:0}get marketingItemSelectionTimeout(){var e
return null!==(e=this.implementation.double("marketing-item-selection-timeout"))&&void 0!==e?e:1}get enableAppEvents(){var e
return null!==(e=this.implementation.boolean("enableAppEvents"))&&void 0!==e&&e}get enableProductPageVariants(){var e
return null!==(e=this.implementation.boolean("enableProductPageVariants"))&&void 0!==e&&e}get enableArcadeTrialEligibleBadging(){return this.implementation.boolean("enable-arcade-trial-eligible-badging")}get heroCarouselAutoScrollDuration(){var e
return null!==(e=this.implementation.double("heroCarouselAutoScrollDuration"))&&void 0!==e?e:7}get enableAdditionalLoggingForPPV(){var e
return null!==(e=this.implementation.boolean("enableAdditionalLoggingForPPV"))&&void 0!==e&&e}get enableOnDevicePersonalization(){const e=this.implementation.boolean("enable-on-device-personalization")
return!!r(e)||e}get enableAutomaticPageRefresh(){var e
return null===(e=this.implementation.boolean("enable-automatic-page-refresh"))||void 0===e||e}get enableSystemAppReviews(){var e
return null!==(e=this.implementation.boolean("enable-system-app-reviews"))&&void 0!==e&&e}get enableCPPInSearchAds(){return this.implementation.boolean("enableCPPsInSearchAds")||!1}get cancelPreorderItemSrv(){return this.implementation.url("cancelPreorderItemSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancel"}get getCancellablePreorderItemsSrv(){return this.implementation.url("getCancellablePreorderItemsSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancellable"}get enabledAdPlacements(){return l(m(this.implementation.array("enabled-ad-placements")))}get adPlacementTimeouts(){return p(y(this.implementation.dictionary("ad-placement-timeouts")))}get inAppPurchasesLearnMoreEditorialItemId(){return this.implementation.string("in-app-purchases-learn-more-editorial-item-id")}get enableExternalPurchases(){var e
return null!==(e=this.implementation.boolean("enable-external-purchase"))&&void 0!==e&&e}get enabledExternalPurchasesPlacements(){return l(m(this.implementation.array("enabled-external-purchase-placements")))}get externalPurchasesLearnMoreEditorialItemId(){return this.implementation.string("external-purchase-learn-more-editorial-item-id")}get externalBrowserLearnMoreEditorialItemId(){return this.implementation.string("external-browser-learn-more-editorial-item-id")}get sharePlayAppsEditorialItemId(){return this.implementation.string("share-play-apps-editorial-item-id")}get externalPurchasesIncludeProductPageBannerIcon(){var e
return null!==(e=this.implementation.boolean("external-purchase-product-page-banner-include-icon"))&&void 0!==e&&e}get externalPurchasesProductPageAnnotationVariant(){return this.implementation.string("external-purchase-product-page-annotation-variant")}get newEventsForODJAreEnabled(){var e
return null!==(e=this.implementation.boolean("new-events-for-odj-are-enabled"))&&void 0!==e&&e}get defaultChart(){return y(this.implementation.dictionary("default-chart"))}get accountUrl(){var e
return null!==(e=this.implementation.url("accountUrl"))&&void 0!==e?e:xk}get redeemUrl(){var e
return null!==(e=this.implementation.url("redeemUrl"))&&void 0!==e?e:$k}get manageSubscriptionsUrl(){var e
return null!==(e=this.implementation.url("manageSubscriptionsUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink"}get manageSubscriptionsV2Url(){var e
return null!==(e=this.implementation.url("manageSubscriptionsV2Url"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/"}get medicalDeviceComplianceStatementRegion(){return this.implementation.string("medical-devices-compliance-statement-region")}get adsOverrideLanguage(){return this.implementation.string("ads-override-language")}get gameControllerRecommendedRolloutRate(){var e
return null!==(e=this.implementation.double("game-controller-recommended-rollout-rate"))&&void 0!==e?e:0}get gameControllerLearnMoreEditorialItemId(){return this.implementation.string("game-controller-learn-more-editorial-item-id")}get spatialControlsLearnMoreEditorialItemId(){return this.implementation.string("spatial-controllers-learn-more-editorial-item-id")}get mediaAPISearchFocusEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-focus-suggestions-enabled"))&&void 0!==e&&e}get supportsSearchLandingPageV2(){var e
return null!==(e=this.implementation.boolean("supports-apps-slp-v2"))&&void 0!==e&&e}get searchLandingPageV2RolloutRate(){var e
return null!==(e=this.implementation.double("apps-slp-v2-rollout-rate"))&&void 0!==e?e:0}get todayTabArcadePersonalizationRate(){var e
return null!==(e=this.implementation.double("today-tab-arcade-personalization-rate"))&&void 0!==e?e:0}get gameCenterExtendSupportedFeatures(){var e
return null!==(e=this.implementation.boolean("game-center-extend-supported-features"))&&void 0!==e&&e}get adPlacementEligibleSlotPositions(){const e=y(this.implementation.dictionary("ad-placement-eligible-slot-positions"))
return s(e)?e:{today:[{shelfIdentifier:"0",slot:0},{shelfIdentifier:"0",slot:1}],"product-page-ymal":[{shelfIdentifier:OG,slot:0}]}}get managePreordersUrl(){var e
return null!==(e=this.implementation.url("preordersUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/preorders"}get modifyAccount(){var e
return null!==(e=this.implementation.url("modifyAccount"))&&void 0!==e?e:xk}get purchaseHistoryUrl(){return this.implementation.url("purchaseHistoryUrl")}get ratingsReviewsUrl(){var e
return null!==(e=this.implementation.url("ratingsReviewsUrl"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/ratings-reviews"}get signup(){var e
return null!==(e=this.implementation.url(Hy))&&void 0!==e?e:uO}get redeemCodeLanding(){var e
return null!==(e=this.implementation.url("redeemCodeLanding"))&&void 0!==e?e:$k}get reportProblemUrl(){return this.implementation.string("reportProblemUrl")}get unrestrictedServerSideTabBadging(){var e
return null!==(e=this.implementation.boolean("unrestricted-server-side-tab-badging"))&&void 0!==e&&e}get todayAdCondensedEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-condensed-enabled"))&&void 0!==e&&e}get safariExtensionsEditorialPageId(){return this.implementation.url("safari-extensions-editorial-page-id")}get buddyOnboardingEditorialItemId(){return this.implementation.string("buddy-onboarding-editorial-item-id")}get productPageFriendsPlayingClickEventsEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-friends-playing-click-events-enabled"))&&void 0!==e&&e}get highMotionLearnMoreEditorialItemId(){return this.implementation.string("high-motion-learn-more-editorial-item-id")}get todayAdMediumLockupScreenshotsRiverSpeed(){return this.implementation.double("today-ad-medium-lockup-screenshots-river-speed")}get arcadeDownloadPackCategoriesCollectionId(){return this.implementation.string("arcade-download-packs-onboarding-collection-id")}get arcadeDownloadPackShelfTTLInSeconds(){var e
return null!==(e=this.implementation.integer("arcade-starter-pack-ttl-in-seconds"))&&void 0!==e?e:0}get enableOfferItems(){var e
return null!==(e=this.implementation.boolean("enable-winback-offers"))&&void 0!==e&&e}get appDistributionMediaAPIHost(){return this.implementation.string("app-distribution-media-api-host")}get appDistributionLanguageTag(){return this.implementation.string("app-distribution-language-tag")}get arcadeDownloadPackPostSubscribeTrigger(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-post-subscribe-trigger"))||void 0===e||e}get enableContingentOffers(){var e
return null!==(e=this.implementation.boolean("enable-contingent-offers"))&&void 0!==e&&e}get arcadeDownloadPackRolloutRate(){var e
return null!==(e=this.implementation.double("arcade-download-packs-rollout-rate"))&&void 0!==e?e:0}get enableVisionPlatform(){var e
return null!==(e=this.implementation.boolean("enable-vision-platform"))&&void 0!==e&&e}get supportedMixedMediaRequestUsecases(){var e
return null!==(e=p(y(this.implementation.dictionary("supported-mixed-media-request-usecases"))))&&void 0!==e?e:{}}get arcadeDownloadPacksMetricsEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-metrics-events-enabled"))||void 0===e||e}get arcadeDownloadPacksImpressionEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-impression-events-enabled"))||void 0===e||e}get visionOnlyAppLearnMoreEditorialItemId(){return this.implementation.string("vision-only-app-learn-more-editorial-item-id")}get arcadeDownloadPacksCIPDeeplinkIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-cip-deeplink-trigger"))&&void 0!==e&&e}get arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-hw-tabbadge-trigger"))&&void 0!==e&&e}get aboutAppStoreUrl(){return this.implementation.string("about-app-store-url")}get aboutInAppPurchasesEditorialItemId(){return this.implementation.string("about-in-app-purchases-editorial-item-id")}get requestARefundUrl(){return this.implementation.string("request-a-refund-url")}get personalizedRecommendationsToggleEnabled(){var e
return null!==(e=this.implementation.boolean("enable-personalized-recommendations-toggle"))&&void 0!==e&&e}get metricsIdMigrationEnabled(){var e
return null===(e=this.implementation.boolean("metrics-id-migration-enabled"))||void 0===e||e}get isNaturalLanguageSearchEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-enabled"))&&void 0!==e&&e}get isNaturalLanguageSearchResultsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-results-enabled"))&&void 0!==e&&e}get changePaymentMethodUrl(){return this.implementation.string("change-payment-method-url")}get aboutFrenchAppStoreEditorialItemId(){return this.implementation.string("about-app-store-editorial-item-id")}get isOnDemandShelfFetchingEnabled(){var e
return null===(e=this.implementation.boolean("on-demand-product-shelf-fetching-enabled"))||void 0===e||e}get isMetricsUserIdFallbackEnabled(){var e
return null!==(e=this.implementation.boolean("metrics-user-id-fallback-enabled"))&&void 0!==e&&e}get isMetricsAb2DataFallbackEnabled(){var e
return null===(e=this.implementation.boolean("metrics-ab2data-fallback-enabled"))||void 0===e||e}get enableRecoOnDeviceReordering(){var e
return null!==(e=this.implementation.boolean("enable-on-device-reco-reordering"))&&void 0!==e&&e}get ribbonBarVisionEditorialItemIds(){return l(m(this.implementation.array("ribbon-bar-vision-editorial-item-ids")))}get searchFilterEditorialItemIds(){const e=l(m(this.implementation.array("search-filter-editorial-item-ids")))
return new Set(e)}get accessibilityLearnMoreEditorialItemId(){return this.implementation.string("accessibility-learn-more-editorial-item-id")}get enableDeviceDrivenDiscoveryContent(){var e
return null!==(e=this.implementation.boolean("enable-device-driven-discovery-content"))&&void 0!==e&&e}get enableProductPageInstallSize(){var e
return null!==(e=this.implementation.boolean("enable-product-page-install-size"))&&void 0!==e&&e}get enableIconArtwork(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork"))&&void 0!==e&&e}get iconArtworkRolloutRate(){var e
return null!==(e=this.implementation.double("icon-artwork-rollout-rate"))&&void 0!==e?e:0}get enableUpdatedAgeRatings(){var e
return null!==(e=this.implementation.boolean("enable-app-store-age-ratings"))&&void 0!==e&&e}get enableAgeRatingFilter(){var e
return null!==(e=this.implementation.boolean("enable-age-rating-filter"))&&void 0!==e&&e}get enableTwoPhaseOfferConfirmation(){var e
return null!==(e=this.implementation.boolean("enable-two-phase-offer-confirmation"))&&void 0!==e&&e}get externalPurchasesProductPageBannerTextVariant(){return this.implementation.string("external-purchase-product-page-banner-text-variant")}get externalPurchasesProductPageBannerIconVariant(){return this.implementation.string("external-purchase-product-page-banner-icon-variant")}get maxGamesForFetchingEvents(){var e
return null!==(e=this.implementation.integer("max-games-for-fetching-events"))&&void 0!==e?e:30}get mockHomeFeedURL(){return this.implementation.string("mock-home-feed-url")}get metricsTopic(){var e
{const t="xp_ase_appstore_ue"
return null!==(e=this.implementation.string("metrics_topic"))&&void 0!==e?e:t}}get playTogetherGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("play-together-arcade-game-recommendations"))&&void 0!==e?e:"1803255513"}get playTogetherGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("play-together-non-arcade-game-recommendations"))&&void 0!==e?e:"1804480915"}get multiplayerActivityGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-arcade-game-recommendations"))&&void 0!==e?e:"1821553042"}get multiplayerActivityGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-non-arcade-game-recommendations"))&&void 0!==e?e:"1821553152"}get showArcadeSubscriberAccessBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-subscriber-access-badge"))&&void 0!==e&&e}get gamesCrossUseConsentLearnMoreURL(){return this.implementation.string("games-crossuse-consent-learn-more-url")}get gamesPlayNowHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesPlayNowHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get gamesEditorialHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesEditorialHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get completedChallengesInActiveShelfTimeThreshold(){var e
return null!==(e=this.implementation.integer("completed-challenges-in-active-shelf-time-threshold"))&&void 0!==e?e:86400}get requestReviewEnabled(){var e
return null===(e=this.implementation.boolean("request-review-enabled"))||void 0===e||e}get requestReviewMinAppLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-app-launch-count"))&&void 0!==e?e:15}get requestReviewMinGameLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-game-launch-count"))&&void 0!==e?e:5}get enableLicenses(){var e
return null!==(e=this.implementation.boolean("enable-licenses"))&&void 0!==e&&e}get chartDetailPageItemCount(){var e
return null!==(e=this.implementation.integer("chart-detail-page-item-count"))&&void 0!==e?e:25}get enableSRPNextSlot(){var e
return null!==(e=this.implementation.boolean("enable-srp-next-slot"))&&void 0!==e&&e}get enableSRPV5Impressions(){var e
return null!==(e=this.implementation.boolean("enable-srp-v5-impressions"))&&void 0!==e&&e}get enableSRPOnDeviceAdsRanker(){var e
return null!==(e=this.implementation.boolean("enable-srp-on-device-ads-ranker"))&&void 0!==e&&e}get editorialShelvesCollectionContentsLimit(){var e
return null!==(e=this.implementation.integer("editorial-shelves-collection-contents-limit"))&&void 0!==e?e:75}get metricsAllowedListURLParams(){let e=l(m(this.implementation.array("metrics-allowed-list-url-params")))
return o(e)&&(e=[_k,Lk,Mk,"ct","pt",Dk,"mttn3pid","mttnagencyid","mttncc","mttnpid","mttnsiteid","mttnsub1","mttnsub2","mttnsubad","mttnsubkw","mttnsubplmnt","id",ZG,"salableAdamId","ign-itscg","ign-itsct","utm_campaign",KD]),e}get enableIPadOnlyFallbackIcons(){var e
return null!==(e=this.implementation.boolean("enable-ipad-only-fallback-icons"))&&void 0!==e&&e}get disablePaginatedGameLibraryShelf(){var e
return null!==(e=this.implementation.boolean("disable-paginated-game-library-shelf"))&&void 0!==e&&e}get gameLibraryNumberOfItemsFromBelowToFetchNextPage(){var e
return null!==(e=this.implementation.integer("game-library-number-of-items-from-below-to-fetch-next-page"))&&void 0!==e?e:48}get disabledRichLinkPresentationEditorialItemIds(){var e
return l(m(null!==(e=this.implementation.array("disabled-rich-link-presentation-editorial-item-ids"))&&void 0!==e?e:["1842906680"]))}}E3.type=(0,zv.makeMetatype)("app-store:bag-wrapper")
class R3 extends nY{constructor(e,t){super(e),this.cache={},this.packageProperties=t}isEnabled(e){return this.fromCache(e,()=>{var t,n
return!(!(0,Hv.isSome)(this.implementation)||!this.implementation.isEnabled(e))||!!(0,Hv.isSome)(null===(t=this.packageProperties)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.packageProperties)||void 0===n?void 0:n.clientFeatures[e])})}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Hv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}}R3.type=(0,zv.makeMetatype)("app-store:client-capabilities-wrapper")
class D3 extends nY{async orderedVisibleIAPs(e,t,n,r){return await new Promise((o,i)=>{const s=t.filter(e=>null!=e),a=n.filter(e=>null!=e)
this.implementation.orderedVisibleIAPs(e,s,a,r,(e,t)=>{t?i(t):o(e)})})}async visibilityForIAPs(e){return await new Promise((t,n)=>{this.implementation.visibilityForIAPs(e,(e,n)=>{t(n?{}:e)})})}}D3.type=(0,zv.makeMetatype)("app-store:client-ordering-wrapper")
class _3 extends nY{info(...e){return this.implementation.info(...e)}error(...e){return this.implementation.error(...e)}log(...e){return this.implementation.log(...e)}warn(...e){return this.implementation.warn(...e)}}_3.type=(0,zv.makeMetatype)("app-store:console-wrapper")
class L3 extends nY{constructor(){super(...arguments),this.cache={}}isEnabled(e){return this.fromCache(e,()=>{if(this.implementation.isEnabled(e))return!0
const t=this.legacyFeatureFlagFromModernFeatureFlag(e)
return!!(0,Hv.isSome)(t)&&this.implementation.isEnabled(t)})}isGSEUIEnabled(e){return Boolean(this.implementation.isGSEUIEnabled(e))}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Hv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}legacyFeatureFlagFromModernFeatureFlag(e){switch(e){case gJ:return"open_in_story_share_sheet"
case vJ:return"product_accessibility_support_2025A"
case mJ:return"AppleAccount.AABranding"
case"FA3FF1EE-3B29-4131-8A33-31C764E6B6DC":return"aligned_region_artwork_2025A"
case yJ:return"hide_arcade_header_on_arcade_tab"
case AJ:return"shelf_header"
case TJ:return"game_center_shelf_header"
case bJ:return"arcade_see_all_games_menu_uplift"
case SJ:return"see_all_games_segmented_nav_2024A"
case PJ:return"shelves_2_0_top_charts"
case"D4105739-EE9B-4C2E-AEE6-5F5744B016B1":return"shelves_2_0_arcade"
case"FF4FF053-4635-431B-A32C-19921296CD83":return"shelves_2_0_generic"
case IJ:return"shelves_2_0_search"
case CJ:return"shelves_2_0_product"
case"75A39BC1-112E-473B-8CB8-83D5D155982F":return"shelves_2_0_privacy_detail_page_2025C"
case kJ:return"force_display_lockup_ordinals"
case OJ:return"arcade_choose_your_favorites_brick_Future"
case EJ:return"mini_today_cards_grouping"
case RJ:return"mini_today_cards_product"
case DJ:return"mini_today_cards_article"
case _J:return"contingent_offers_personalization"
case LJ:return"voyager_bundles_2025A"
case MJ:return"tv_product_page_2024E"
case xJ:return"app_genome_2025A"
case $J:return NJ
case"0027F7B8-F19A-4C57-8F1C-17DF011F98DA":return"spatial_controllers_2025A"
case"6707A833-E8E1-4C9E-9B83-19564F590B5D":return BJ
case"336CC1B2-6AD8-45EC-AF22-B23023110241":return UJ
case"BE3D1F90-21C1-4161-B2B9-88FA3B6CE4AF":return"5pqn2upm"
case"9EB5A10B-BE28-449D-AFE9-706A5ACF043B":return"ma1h52"
case"A50E8778-88AD-45BC-993A-B5BF157633DF":return"now_playing_feature_entry_points"
case"46669451-9170-4764-8534-348007111CDB":return"arcade_dashboard"
case FJ:return null
default:x(e)}}}L3.type=(0,zv.makeMetatype)("app-store:feature-flags-wrapper")
class M3 extends nY{get clientIdentifier(){return M3.cache.get("clientIdentifier",()=>this.implementation.clientIdentifier)}get clientVersion(){return M3.cache.get("clientVersion",()=>this.implementation.clientVersion)}get deviceLocalizedModel(){return this.implementation.deviceLocalizedModel}get deviceModel(){return M3.cache.get("deviceModel",()=>this.implementation.deviceModel)}get deviceModelFamily(){return M3.cache.get("deviceModelFamily",()=>this.implementation.deviceModelFamily)}get devicePhysicalModel(){return M3.cache.get("devicePhysicalModel",()=>this.implementation.devicePhysicalModel)}get deviceMarketingFamilyName(){return M3.cache.get("deviceMarketingFamilyName",()=>this.implementation.deviceMarketingFamilyName)}get osBuild(){return M3.cache.get("osBuild",()=>this.implementation.osBuild)}get platform(){return this.implementation.platform}isOSAtLeast(e,t,n){return this.implementation.isOSAtLeast(e,t,n)}get isiOS(){return this.platform===dV}get isMac(){return this.platform===jV}get isTV(){return this.platform===qG}get isWatch(){return this.platform===mx}get isWeb(){return this.platform===LV}get isWindows(){return"Windows"===this.platform}get isVision(){return this.platform===yx}}M3.type=(0,zv.makeMetatype)("app-store:host-wrapper"),M3.cache=new rY
class x3{constructor(){this.locData={},this.language="en"}updateLocalizationData(e,t){this.locData=e,this.language=t}localize(e,t){let n=this.locData[e]
return void 0!==n&&typeof n===Bq||(n=e),t&&(n=this.replaceTokens(n,t)),n=this.replaceMarkupTokens(n,t),n}localizeWithCount(e,t,n,r){let o,i,s=null
return 0===n&&(o=`${t}.zero`,this.isLocalized(e,o)&&(s=o)),null===s&&(s=t,i=this.pluralCategory(e,n),i!==Mj&&(o=`${t}.${i}`,this.isLocalized(e,o)&&(s=o))),r||(r={}),void 0===r.count&&(r.count=this.formatNumber(n.toString())),void 0===r.number&&(r.number=this.formatNumber(n.toString())),this.localize(null!=s?s:t,r)}replaceTokens(e,t){return Object.entries(t).forEach(([t,n])=>{const r="@@"+t+"@@"
e=this.replaceSubstring(e,r,n)}),e}replaceMarkupTokens(e,t){if(e.indexOf("##")<=-1)return e
let n
return t?(n={...x3.MARKUP_PARAMS},Object.entries(t).forEach(([e,t])=>{n[e]=t})):n=x3.MARKUP_PARAMS,Object.entries(n).forEach(([t,n])=>{const r="##"+t+"##"
e=e.replace(new RegExp(r,"gi"),n)}),e=e.replace(/##([^##]+)##/gi,"<$1>")}replaceSubstring(e,t,n){return e.split(t).join(n)}formatNumber(e){let t=this.locData._decimalSeparator
void 0!==t&&typeof t===Bq||(t=".")
let n=this.locData._thousandsSeparator
void 0!==n&&typeof n===Bq||(n=".")
const r=parseFloat(e).toString().split("."),o=r[0].split("")
for(let e=o.length-3;e>0;e-=3)o.splice(e,0,n)
return r[0]=o.join(""),r.join(t)}isLocalized(e,t){const n=this.locData[t]
return void 0!==n&&typeof n===Bq&&(-1===t.indexOf(".")||n!==t&&(0!==n.indexOf("**")||n.lastIndexOf("**")!==n.length-2)||(e.console.error("Unlocalized key in keys dictionary",t),!1))}pluralCategory(e,t){const n=x3.pluralCategoryFnByLanguage[this.language]
return void 0!==n?n(t):(e.console.warn("Missing plural category function for: "+this.language),Mj)}}x3.MARKUP_PARAMS={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},x3.pluralCategoryDefault=function(e){return Mj},x3.pluralCategoryOne=function(e){return 1===e?HG:Mj},x3.pluralCategoryArabic=function(e){const t=e>>0
if(t!==e)return Mj
if(0===t)return"zero"
if(1===t)return HG
if(2===t)return jE
const n=t%100
return n>=11?xF:n>=3?JN:Mj},x3.pluralCategoryFrench=function(e){return e<2&&e>=0?HG:Mj},x3.pluralCategoryHebrew=function(e){const t=e>>0
return t!==e?Mj:1===t?HG:2===t?jE:0==t%10&&t>10?xF:Mj},x3.pluralCategoryPolish=function(e){const t=e>>0
if(t!==e)return Mj
if(1===t)return HG
const n=t%10
if(n<=4&&n>=2){const e=t%100
if(e>14||e<12)return JN}return xF},x3.pluralCategoryRomanian=function(e){const t=e>>0
if(t!==e)return JN
if(0===t)return JN
if(1===t)return HG
const n=e%100
return n<=19&&n>=1?JN:Mj},x3.pluralCategoryRussian=function(e){const t=e>>0
if(t!==e)return Mj
const n=t%10
if(n>=5||0===n)return xF
const r=t%100
return r<=14&&r>=11?xF:1===n?HG:JN},x3.pluralCategoryFnByLanguage={zh:x3.pluralCategoryDefault,id:x3.pluralCategoryDefault,ja:x3.pluralCategoryDefault,ko:x3.pluralCategoryDefault,ms:x3.pluralCategoryDefault,th:x3.pluralCategoryDefault,vi:x3.pluralCategoryDefault,en:x3.pluralCategoryOne,ca:x3.pluralCategoryOne,da:x3.pluralCategoryOne,nl:x3.pluralCategoryOne,de:x3.pluralCategoryOne,el:x3.pluralCategoryOne,fi:x3.pluralCategoryOne,hu:x3.pluralCategoryOne,it:x3.pluralCategoryOne,nb:x3.pluralCategoryOne,no:x3.pluralCategoryOne,pt:x3.pluralCategoryOne,es:x3.pluralCategoryOne,sv:x3.pluralCategoryOne,tr:x3.pluralCategoryOne,ar:x3.pluralCategoryArabic,fr:x3.pluralCategoryFrench,iw:x3.pluralCategoryHebrew,pl:x3.pluralCategoryPolish,ro:x3.pluralCategoryRomanian,ru:x3.pluralCategoryRussian}
class $3 extends nY{constructor(e,t){super(e),this.locFile=null,this.ampLoc=new x3,this.LOC_STRING_CACHE={},this.objectGraph=t}get identifier(){return this.implementation.identifier}get safeIdentifier(){return this.implementation.identifier.split("_")[0]}string(e,t){return this.implementation.string(e)}tryString(e){const t=this.implementation.string(e)
if(t===e||t===`**${e}**`)throw qv.context("tryString",()=>{qv.unexpectedType(KB,"Localization key",e,null)}),new Error(`No value exists for localization key '${e}'`)
return t}stringWithFallback(e,t){const n=this.implementation.string(e)
return n===`**AppStore.${e}**`?t:n}stringForPreferredLocale(e,t,n,r){if(o(n))return this.string(t,r)
const i=`${t}_${n}`
let s=this.LOC_STRING_CACHE[i]
if(!s)if(s=this.implementation.stringForPreferredLocale(t,n),s&&s!==t)this.LOC_STRING_CACHE[i]=s
else{const e=this.ampLoc.localize(t)
s=e!==t?e:r||t}return s}stringWithCount(e,t,n){let r=this.implementation.stringWithCount(e,t)
if(!r||r===e){const o=this.ampLoc.localizeWithCount(this.objectGraph,e,t,n)
o&&(r=o)}return r}stringWithCounts(e,t,n){return this.implementation.stringWithCounts(e,t)}uppercased(e){return e?e.toLocaleUpperCase(this.safeIdentifier):null}decimal(e,t){let n=this.implementation.decimal(e,t)
return n||(n=typeof e===ej?`* ${e.toString()} *`:this.nullString()),n}fileSize(e){let t=this.implementation.fileSize(e)
return t||(t=this.nullString()),t}formattedCount(e){let t=this.implementation.formattedCount(e)
return t||(t=this.nullString()),t}formattedCountForPreferredLocale(e,t,n){if(o(n))return this.formattedCount(t)
let r=this.implementation.formattedCountForPreferredLocale(t,n)
return r||(r=this.nullString()),r}timeAgoWithContext(e,t){let n=this.implementation.timeAgoWithContext(e,t)
return n||(n=this.nullString()),n}formatDate(e,t){let n=this.implementation.formatDate(e,t)
return n||(n=this.nullString()),n}formatDateWithContext(e,t,n){let r=this.implementation.formatDateWithContext(e,t,n)
return r||(r=this.nullString()),r}formatDateInSentence(e,t,n){let r=this.implementation.formatDateInSentence(e,t,n)
return r||(r=this.nullString()),r}relativeDate(e){let t=this.implementation.relativeDate(e)
return t||(t=this.nullString()),t}formatDuration(e,t){let n=this.implementation.formatDuration(e,t)
return n||(n=this.nullString()),n}applyLocalizations(e,t,n){this.isLocFileLoaded(e)||(this.locFile=e,this.ampLoc.updateLocalizationData(t,n.slice(0,2)))}isLocFileLoaded(e){return this.locFile===e}normalizedLocale(e,t,n){if("yue-hant"===(t=t.toLowerCase())){const t=e.packageProperties.asString("macauStorefrontIdentifier")
return typeof n===Bq&&typeof t===Bq&&-1!==n.indexOf(t)?"zh-ma":"zh-hk"}return t}nullString(){return"* null *"}load(e){if(void 0===e.bag.language||null===e.bag.language)throw new Error("Bag language is not available. Unable to load localizations.")
const t=this.normalizedLocale(e,e.bag.language,e.client.storefrontIdentifier),n=`local/${t}`
if(!this.isLocFileLoaded(n)){const r=e.packageProperties.asDictionary(`localizations.${t}`)
if(null!=r)this.applyLocalizations(n,r,t)
else{const r=e.packageProperties.asDictionary("localizations.en-us")
null!=r&&this.applyLocalizations(n,r,t)}}}deviceDisplayName(e){if(e.host.deviceLocalizedModel)return e.host.deviceLocalizedModel
switch(e.client.deviceType){case nW:const e=this.string(Fk)
return e===Fk?Zy:e
case Kq:const t=this.string(Nk)
return t===Nk?Qy:t
case"tv":const n=this.string(Bk)
return n===Bk?"Apple\xa0TV":n
case cW:const r=this.string(Uk)
return r===Uk?"Apple\xa0Watch":r
case lW:const o=this.string(Gk)
return o===Gk?wO:o
default:return null}}}$3.type=(0,zv.makeMetatype)("app-store:loc-wrapper")
class F3 extends nY{value(e){return n(this.implementation,e)}enabled(e){var t,n
const r=this.value(e)
return typeof r!==OU?Boolean(r):!!(0,Wv.isSome)(null===(t=this.implementation)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.implementation)||void 0===n?void 0:n.clientFeatures[e])}isEnabled(e){return this.enabled(e)}isNotEnabled(e){return!this.enabled(e)}asDictionary(e){return p(this.implementation,e)}asString(e){return f(this.implementation,e)}asNumber(e){return h(this.implementation,e)}asArray(e){return l(this.implementation,e)}}F3.type=(0,zv.makeMetatype)("app-store:package-properties-wrapper")
class N3 extends nY{retrieveString(e){const t=this.implementation.retrieveString(e)
return(null==t?void 0:t.length)>0&&"<null>"!==t?t:null}storeString(e,t){this.implementation.storeString(t,e)}}N3.type=(0,zv.makeMetatype)("app-store:storage-wrapper")
class B3 extends Gm.ObjectGraph{configureDefaults(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x){let $=this.addingCryptography(t).addingHost(n).addingNetwork(r).addingPlatform(o).addingPlist(i).addingRandom(s).addingServices(a).addingCookieProvider(c).addingBag(e).addingConsole(l).addingStoreMetrics(u).addingAMSEngagement(d).addingLoc(f).addingAdsLoc(h).addingDevice(p).addingClient(w).addingPackageProperties(g).addingUser(v).addingPlayer(m).addingMetricsIdentifiers(y).addingClientOrdering(A).addingArcade(T).addingGameCenter(b).addingDeepLinks(S).addingAppleSilicon(P).addingStorage(I).addingAds(C).addingOnDeviceRecommendationsManager(k).addingOnDeviceSearchHistoryManager(O).addingFeatureFlags(E).addingClientCapabilities(R,g).addingMediaToken(D).addingAppDistribution(_).addingTimeoutManager(L).addingAdsLoc(h).addingTreatmentStore(M).addingUserDefaults(x)
return $.loc.load($),$=$.addingLocale(new I3($)),$}get bag(){return this.required(E3.type)}addingBag(e){return this.addingBagWrapper(new E3(e)).adding(jm.bag,e)}addingBagWrapper(e){return this.adding(E3.type,e)}get console(){return this.required(_3.type)}addingConsole(e){return this.addingConsoleWrapper(new _3(e))}addingConsoleWrapper(e){return this.adding(_3.type,e)}get cryptography(){return this.required(jm.cryptography)}addingCryptography(e){return this.adding(jm.cryptography,e)}get host(){return this.required(M3.type)}addingHost(e){return this.addingHostWrapper(new M3(e))}addingHostWrapper(e){return this.adding(M3.type,e)}get locale(){return this.required(P3)}addingLocale(e){return this.adding(P3,e)}get network(){return this.required(jm.net)}addingNetwork(e){return this.adding(jm.net,e)}get platform(){return this.required(jm.platform)}addingPlatform(e){return this.adding(jm.platform,e)}get plist(){return this.required(jm.plist)}addingPlist(e){return this.adding(jm.plist,e)}get random(){return this.required(jm.random)}addingRandom(e){return this.adding(jm.random,e)}get services(){return this.required(jm.services)}addingServices(e){return this.adding(jm.services,e)}get cookieProvider(){return this.required(jm.cookieProvider)}addingCookieProvider(e){return this.adding(jm.cookieProvider,e)}get fetchTimingMetricsBuilder(){return this.optional(Dm.fetchTimingMetricsBuilderType)}addingFetchTimingMetricsBuilder(e){return this.adding(Dm.fetchTimingMetricsBuilderType,e)}get storeMetrics(){return this.required($z)}addingStoreMetrics(e){return this.adding($z,e)}get amsEngagement(){return this.optional(Fz)}addingAMSEngagement(e){return this.adding(Fz,e)}get loc(){return this.required($3.type)}addingLoc(e){return this.addingLocWrapper(new $3(e,this))}addingLocWrapper(e){return this.adding($3.type,e)}get adsLoc(){return this.required(Jz)}addingAdsLoc(e){return this.adding(Jz,e)}get device(){return this.required(Nz)}addingDevice(e){return this.adding(Nz,e)}get client(){return this.required(uY.type)}addingClient(e){return this.addingClientWrapper(new uY(e))}addingClientWrapper(e){return this.adding(uY.type,e)}get packageProperties(){return this.required(F3.type)}addingPackageProperties(e){return this.addingPackagePropertiesWrapper(new F3(e))}addingPackagePropertiesWrapper(e){return this.adding(F3.type,e)}get clientCapabilities(){return this.required(R3.type)}addingClientCapabilities(e,t){return this.addingClientCapabilitiesWrapper(new R3(e,t))}addingClientCapabilitiesWrapper(e){return this.adding(R3.type,e)}get user(){return this.required(Bz)}addingUser(e){return this.adding(Bz,e)}get player(){}addingPlayer(e){return this.adding(Uz,e)}get metricsIdentifiers(){return this.required(Gz)}addingMetricsIdentifiers(e){return this.adding(Gz,e)}get clientOrdering(){return this.required(D3.type)}addingClientOrdering(e){return this.addingClientOrderingWrapper(new D3(e))}addingClientOrderingWrapper(e){return this.adding(D3.type,e)}get arcade(){return this.required(jz)}addingArcade(e){return this.adding(jz,e)}get gameCenter(){return this.required(Vz)}addingGameCenter(e){return this.adding(Vz,e)}get deepLinks(){return this.required(Hz)}addingDeepLinks(e){return this.adding(Hz,e)}get appleSilicon(){return this.required(k3.type)}addingAppleSilicon(e){return this.addingAppleSiliconWrapper(new k3(e))}addingAppleSiliconWrapper(e){return this.adding(k3.type,e)}get storage(){return this.required(N3.type)}addingStorage(e){return this.addingStorageWrapper(new N3(e))}addingStorageWrapper(e){return this.adding(N3.type,e)}get ads(){return this.required(qz)}addingAds(e){return this.adding(qz,e)}get onDeviceRecommendationsManager(){return this.required(Wz)}addingOnDeviceRecommendationsManager(e){return this.adding(Wz,e)}get onDeviceSearchHistoryManager(){return this.required(zz)}addingOnDeviceSearchHistoryManager(e){return this.adding(zz,e)}get featureFlags(){return this.required(L3.type)}addingFeatureFlags(e){return this.addingFeatureFlagsWrapper(new L3(e))}addingFeatureFlagsWrapper(e){return this.adding(L3.type,e)}get mediaToken(){return this.required(Yz)}addingMediaToken(e){return this.adding(Yz,e)}get appDistribution(){return this.required(Kz)}addingAppDistribution(e){return this.adding(Kz,e)}get timeoutManager(){return this.required(Zz)}addingTimeoutManager(e){return this.adding(Zz,e)}get treatmentStore(){return this.required(Qz)}addingTreatmentStore(e){return this.adding(Qz,e)}get experimentCache(){return this.optional(AY.metatype)}get metricsIdentifiersCache(){return this.optional(cK.defaultMetatype)}get paymentMetricsIdentifiersCache(){return this.optional(cK.paymentMetatype)}get personalizationMetricsIdentifiersCache(){return this.optional(cK.personalizationMetatype)}get userDefaults(){if(this.client.isiOS)return this.required(Xz)}addingUserDefaults(e){return this.adding(Xz,e)}isAvailable(e){return i(this.optional(e))}get activeIntent(){return this.optional(b3)}addingActiveIntent(e){return this.adding(b3,new S3(e))}get seo(){return this.optional(C3)}addingSEO(e){return this.adding(C3,e)}get dispatcher(){return this.required(T3.dispatcher)}get nativeIntentDispatcher(){return this.required(T3.nativeIntentDispatcher)}get debugSettings(){return this.required(T3.debugSettings)}get router(){return this.required(T3.router)}get localizer(){return this.required(T3.localizer)}get personNameComponentsFormatter(){return this.required(T3.personNameComponentsFormatter)}}class U3 extends CW{constructor(){super(...arguments),this.$kind="InvalidateAllWidgetsAction",this.actionClass="InvalidateAllWidgetsAction"}}class G3{constructor(){this.$intentKind="GenericPageIntent"}async perform(e,t){const n=t.required(y3)
return await n.fetchPage(t,e.url,pJ)}}class j3{constructor(){this.$intentKind="GenericPageMoreIntent"}async perform(e,t){const n=t.required(y3)
return await n.fetchMoreOfPage(t,e.pageToken)}}class V3{constructor(){this.$intentKind="ShelvesIntent"}async perform(e,t){const n=t.required(y3)
return await n.fetchShelves(t,e.requests)}}class H3{constructor(){this.$intentKind="ActionIntent"}async perform(e,t){return await np(t,e)}}class q3{constructor(){this.$kind="AccountLinks",this.links={},this.pageMetrics=new RY,this.pageRenderMetrics=null}}class W3 extends CW{constructor(e,t,n){super(),this.$kind="FamilyCircleAction",this.actionClass="FamilyCircleAction",this.clientName=e,this.eventType=t,this.additionalParameters=n}}class z3{constructor(){this.$intentKind="AccountLinksIntent"}async perform(e,t){return op(t)}}class Y3 extends R2{constructor(e,t){super("AccountController"),t.exportingService("AccountData",{fetchAccountLinks:async t=>op(e)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class J3 extends R2{constructor(){super("DynamicUIBuilder")}pageType(){return YF}async handlePage(e,t,n,r,o){const i=new EY(YF)
i.pageUrl=t.toString(),i.referrerUrl=t.build()
const s=new S2(e.bag.metricsTopic)
if(e.bag.arcadeDownloadPacksCIPDeeplinkIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new EY(pB),t=ZN
e.pageData=t,e.presentationContext=Wj,s.carrierLinkSuccessAction=e}return i.pageData=s,i}pageRoute(e){const t=e.bag.dynamicUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class K3 extends R2{constructor(){super("FinancePageBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=new EY(Tj)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.financeUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class Z3{constructor(e,t){this.$kind="GenericAccountPage",this.title=e,this.sections=t||[],this.pageMetrics=new RY,this.pageRenderMetrics={}}}class Q3{constructor(e,t){this.$kind="PersonalizationTransparencyPage",this.personalizationEnabledPage=e,this.personalizationDisabledPage=t}}class X3{constructor(e,t){this.$kind="AccountSection",this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class e9{constructor(e){this.type=e}}class t9 extends e9{constructor(e){super(QV),this.$kind="AccountSectionText",this.text=e}}class n9 extends e9{constructor(e,t){super("personalizedRecommendationsToggle"),this.$kind="AccountSectionPersonalizedRecommendationsToggle",this.title=e,this.defaultValue=t}}class r9 extends e9{constructor(e,t,n){super(Mq),this.$kind="AccountSectionLink",this.title=e,this.action=t,this.displayType=n||eq}}class o9 extends e9{constructor(e,t){super("infoListItem"),this.$kind="AccountSectionInfoListItem",this.title=e,this.value=t}}class i9 extends CW{constructor(){super(...arguments),this.$kind="ClearAppUsageDataAction",this.actionClass="ClearAppUsageDataAction"}}class s9{constructor(){this.$intentKind="GenericAccountPageIntent"}async perform(e,t){return await ip(t,e.url)}}class a9{constructor(){this.$intentKind="PersonalizationTransparencyPageIntent"}async perform(e,t){return await async function(e){const t=e.required(y3),n=`${OW}:///${xW.account}/${xW.personalizationTransparency}`
return await t.fetchPage(e,n,Q3)}(t)}}class c9 extends R2{constructor(e,t){super("PersonalizationTransparencyBuilder"),t.exportingService(HA,{fetchGenericAccount:async t=>await ip(e,t.url)})}async handlePage(e,t,n,r,o){return await async function(e,t,n){let r,o
if(e.bag.personalizedRecommendationsToggleEnabled){o=y$
const t=await sp(e),n=ap(e)
r=new Q3(t,n)}else o=pH,r=v(n[zW.enabled])?await sp(e):ap(e)
return R2.createFlowAction(r,o,t)}(e,t,n)}pageRoute(e){return e.bag.personalizedRecommendationsToggleEnabled?[{protocol:OW,path:`/${xW.account}/${xW.personalizationTransparency}`},{path:`${xW.personalizationTransparency}`}]:[{protocol:OW,path:`/${xW.account}/${xW.personalizationTransparency}`,query:[zW.enabled]},{path:`${xW.personalizationTransparency}`,query:[zW.enabled]}]}pageType(){return pH}}class l9 extends R2{constructor(){super("ShowAccountPageBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){let i,s=[]
{i=uL
const e=new EY(pH)
e.presentationContext=Wj,e.animationBehavior=rH,s=[e]}const a=new IX(i)
return a.actions=s,a}pageRoute(e){return[{hostName:"showAccountPage"},{hostName:"showPurchasesPage"}]}}class u9 extends R2{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){return new EY(Tj,e.bag.manageSubscriptionsUrl)}pageRoute(e){return[{hostName:"showSubscriptionsPage"}]}}class d9 extends R2{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=new IX(uL)
if(e.client.deviceType!==lW){const e=new EY(pH)
e.presentationContext=Wj,e.animationBehavior=rH,i.actions=[e]}return i}pageRoute(e){return[{hostName:"showUpdatesPage"},{path:"updates"},{path:"{countryCode}/updates"},{query:[`${zW.action}=updates`]}]}}class f9 extends R2{constructor(){super("StorefrontChangeController")}async handlePage(e,t,n,r,o){const i={url:t.toString(),signingStyle:YV}
return await e.network.fetch(i),null}pageRoute(e){return[{protocol:EW,path:`/${xW.store}/${xW.resetAndRedirect}`}]}pageType(){return qq}}class h9 extends R2{constructor(){super("WebUIPageBuilder")}pageType(){return e$}async handlePage(e,t,n,r,o){const i=new EY(e$)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.webViewRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class p9{constructor(){this.$intentKind="UpdateAppEventNotificationIntent"}async perform(e,t){return await up(t,e)}}class w9 extends R2{constructor(e,t){super("AppEventsController"),t.exportingService("AppEvents",{updateAppEventNotification:async t=>await up(e,t)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class g9 extends R2{constructor(){super("AppClipSubscribeBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const s=f(n[zW.appId])
if(!i(s))throw new Error(`No adamId supplied in appClipSubscribe url: ${t}`)
const a=new dY(e).withIdOfType(s,dW).includingAdditionalPlatforms(ee(e)),c=Cd(e,yt(e,await Ln(e,a)),{metricsOptions:{pageInformation:new nK({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),l=(new az).set(Uj,DW).set(JU,WU).path(xW.product).path(s).build(),u=new EY(yH)
u.pageUrl=l
const d=to(e,pt(mj),s,c.buttonAction),h=new IX(sW)
return h.actions=[u,d],h}pageRoute(e){return[{hostName:"appClipSubscribe",query:[zW.appId,zW.context]}]}}class v9{constructor(e,t,n,r,o){this.$kind="ArcadeDownloadPackCategory",this.id=e,this.title=t,this.artwork=n,this.gradientStartColor=r,this.gradientEndColor=o,this.selectActionMetrics=new TW,this.deselectActionMetrics=new TW}}class m9{constructor(e,t){this.$kind="ArcadeDownloadPackSuggestion",this.lockup=e,this.categoryId=t}}class y9 extends CW{constructor(e){super(),this.$kind="ArcadePackOfferAction",this.actionClass="ArcadePackOfferAction",this.offerActions=e}}class A9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackCategoriesPage",this.title=e,this.categories=t,this.maxNumberOfCategoriesToChoose=n,this.maxNumberOfCategoriesToChooseTemplate=r,this.numberOfChosenCategoriesTemplate=o,this.primaryAction=i,this.dismissAction=s,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class T9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackSuggestionsPage",this.title=e,this.suggestions=t,this.getAllAction=n,this.getAllButtonStyle=r,this.primaryAction=o,this.primaryActionKind=i,this.primaryActionSecondaryTitle=s,this.pageMetrics=new RY,this.pageRenderMetrics={}}}!function(e){e.Control="Tf5Kjqz00",e.LayoutA="Tf5Kjqz01",e.LayoutB="Tf5Kjqz02"}(Vm||(Vm={}))
class b9{constructor(){this.$intentKind="ArcadeDownloadPackCategoriesPageIntent",this.maxNumberOfCategoriesToChoose=4}async perform(e,t){return await this.fetchDownloadPackPage(t,za(e.subscriptionStatus))}async fetchDownloadPackPage(e,t){const n=new kW
n.title=e.loc.string("Arcade.DownloadPack.CategorySelection.PrimaryButtonTitle")
const r=new kW
r.title=e.loc.string("Arcade.DownloadPack.CategorySelection.SecondaryButtonTitle")
const o=await this.fetchCategories(e),i=new A9(e.loc.string(t===qk?"Arcade.DownloadPack.CategorySelection.Title.CurrentUser":"Arcade.DownloadPack.CategorySelection.Title"),o,this.maxNumberOfCategoriesToChoose,"Arcade.DownloadPack.CategorySelection.MaxCount","Arcade.DownloadPack.CategorySelection.Selected.Full",n,r),s=new nK({pageId:"SelectCategories",pageType:NC}),a={rootPosition:0,locationStack:[]}
return e.bag.arcadeDownloadPacksMetricsEventsEnabled&&(n.actionMetrics.addMetricsData(_t(e,"Ok",hW,{actionType:pW})),r.actionMetrics.addMetricsData(_t(e,"Skip",hW,{actionType:tj})),o.forEach(t=>{t.selectActionMetrics.addMetricsData(_t(e,t.id,lj,{actionType:mF})),t.deselectActionMetrics.addMetricsData(_t(e,t.id,lj,{actionType:"remove"}))}),jn(e,i,s)),e.bag.arcadeDownloadPacksImpressionEventsEnabled&&o.forEach(t=>{const n={id:t.id,idType:Sq,kind:hW,locationTracker:a,pageInformation:s,softwareType:vq,targetType:lj,title:t.title}
Mh(e,t,n),Oh(a)}),i}async fetchCategories(e){const t=e.bag.arcadeDownloadPackCategoriesCollectionId,n=new dY(e).withIdOfType(t,NV).addingQuery(BC,SC).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>this.categoriesFromResponse(e,t))}categoriesFromResponse(e,t){return qv.context("categoriesFromResponse",()=>{const n=At(t),r=[]
for(const t of n){const n=t.id,o=zf(e,t,fW),i=p(Ke(e,t,$q),rR)
if((0,Hv.isNothing)(i))continue
const s=Zd(e,i,{useCase:y6.CategoryIcon}),a=Ze(e,t,"editorialBackground.stops").map(e=>ye(f(e,PV))).filter(e=>(0,Hv.isSome)(e))
if(0===a.length){e.console.log(`Empty gradient for category: ${n}`)
continue}const c=a[0],l=1===a.length?a[0]:a[1],u=new v9(n,o,s,c,l)
r.push(u)}return r.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:JV})}catch(e){return 0}})})}}class S9{constructor(){this.$intentKind="ArcadeDownloadPackSuggestionsPageIntent",this.maxGamesCount=4}async perform(e,t){const n={rootPosition:0,locationStack:[]},r=new nK({pageId:"DownloadStarterPack",pageType:NC})
return await this.fetchSuggestedGames(t,e.categories,this.maxGamesCount,r,n).then(o=>this.createSuggestionsPage(o,t,za(e.subscriptionStatus),r,n))}async fetchSuggestedGames(e,t,n,r,o){const i=new dY(e).forType(RL).addingQuery("include[personal-recommendations]",uW).addingQuery("associate[apps]",qj).addingQuery("limit[personal-recommendations:contents]",`${n}`).addingQuery("omit[resource:apps]","autos").addingQuery("sparseLimit[apps:association.category]","0").addingQuery("sparseLimit[personal-recommendations:contents]",`${n}`).addingQuery(eq,"arcade-onboarding").includingAdditionalPlatforms(ee(e)),s=this.fetchOptions(t,Xq)
return await Ln(e,i,s).then(n=>this.suggestionFromResponse(e,t,n,r,o))}suggestionFromResponse(e,t,n,r,o){return qv.context("suggestionFromResponse",()=>{const i={}
for(const e of t)i[e.id]=e
const s=At(fe(yt(e,n),uW)),a=[]
for(const t of s){const n=l(t.meta,"associations.category.data")[0].id,s=Cd(e,t,{offerStyle:Pj,offerEnvironment:Gq,metricsOptions:{pageInformation:r,locationTracker:o,badges:{categoryId:n}},metricsClickOptions:{id:t.id,pageInformation:r,locationTracker:o,badges:{categoryId:n}},artworkUseCase:y6.LockupIconSmall,isSubtitleHidden:!0});(0,Hv.isNothing)(s)||(s.heading=i[n].title,Oh(o),Jd(s,e),a.push(new m9(s,n)))}return a})}createSuggestionsPage(e,t,n,r,o){const i=e.map(e=>this.offerAction(e.lockup.buttonAction)).filter(e=>(0,Hv.isSome)(e)),s=new y9(i)
s.title=function(e){switch(dp(e)){case Vm.Control:return e.loc.string(uk)
case Vm.LayoutA:case Vm.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.DownloadAllButtonTitle")
default:return e.loc.string(uk)}}(t)
const a=i.map(e=>e.adamId),c=new kW
c.title=function(e){switch(dp(e)){case Vm.Control:return e.loc.string(H_)
case Vm.LayoutA:case Vm.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.NotNowButtonTitle")
default:return e.loc.string(H_)}}(t)
const l=new T9(t.loc.string(n===ZN?"Arcade.DownloadPack.Suggestions.Title.NewUser":"Arcade.DownloadPack.Suggestions.Title"),e,s,function(e){switch(dp(e)){case Vm.Control:return V_
case Vm.LayoutA:return"withinLockups"
case Vm.LayoutB:default:return V_}}(t),c,function(e){switch(dp(e)){case Vm.Control:case Vm.LayoutA:return j_
case Vm.LayoutB:return"getAll"
default:return j_}}(t),function(e){switch(dp(e)){case Vm.Control:return null
case Vm.LayoutA:case Vm.LayoutB:return e.loc.string(H_)
default:return null}}(t))
return t.bag.arcadeDownloadPacksMetricsEventsEnabled&&(Qs(t,s,{id:"GetAll",actionType:w$,subjectIds:a,actionDetails:{subjectIds:a},pageInformation:r,locationTracker:o,targetType:hW}),c.actionMetrics.addMetricsData(_t(t,"Done",hW,{actionType:pW})),jn(t,l,r)),l}offerAction(e){return Nn(e)?e:gt(e)?Nn(e.defaultAction)?e.defaultAction:Nn(e.buyAction)?e.buyAction:null:null}fetchOptions(e,t){const n={selected:e.map(e=>({id:e.id,type:t}))}
return{method:hG,headers:{"Content-Type":nM},requestBodyString:JSON.stringify(n)}}}class P9 extends R2{constructor(e,t){super("ArcadeDownloadPackBuilder")}pageRoute(e){return ar(e,e.bag.arcadeDownloadPackRolloutRate)?[{hostName:"arcadeDownloadPack",query:[`${zW.arcadeSubscriptionStatus}?`]}]:[]}async handlePage(e,t,n,r,o){const i=new EY(pB),s=f(n,zW.arcadeSubscriptionStatus)
return i.pageData=za(s),i}pageType(){return pB}}class I9 extends R2{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return Tq}defaultTab(e){return sW}pageRoute(e){return[{path:"arcade/offers",query:[`${zW.offerHints}?`]},{path:"/{countryCode}/arcade/offers",query:[`${zW.offerHints}?`]}]}async handlePage(e,t,n,r,o){var i
const s=null!==(i=n[zW.offerHints])&&void 0!==i?i:"deeplink_hardware_firstchance",a={offerHints:s},c=new iZ(sW,pt(mj),e.bag.metricsTopic,null,a)
c.offerHints=s
const l=new EY(Ij)
return l.pageData=c,l.referrerUrl=t.build(),l}}class C9 extends pJ{constructor(e){super(e,"ArcadeSeeAllGamesPage"),this.pageSegments=[]}}class k9{constructor(e,t,n=null,r){this.$kind="PageFacetOption",this.title=e,this.value=t,this.systemImageName=r,this.metricsValue=n}}k9.defaultValue="pageFacetsDefaultValue",k9.trueValue=new k9(pq,UF),k9.falseValue=new k9(UF,UF)
class O9{constructor(e,t,n,r,o=[],i=null,s=null,a=null,c=!1,l=!1,u=!1){this.$kind="PageFacetsFacet",this.id=e,this.parameterName=t,this.title=n,this.displayType=r,this.defaultOptions=i,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l,this.isHiddenFromMenu=u}}class E9{constructor(e,t,n){this.$kind="PageFacets",this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return(0,Hv.isSome)(e)&&0!==Object.keys(e).length}}E9.requestValuesForSelectedFacetOptions=function(e){if(E9.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>E9.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={}
for(const e of r){const t=e.split("=")
2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null}
class R9{constructor(e=[],t=null){this.$kind="PageFacetsGroup",this.title=t,this.facets=e}}const D9="-releaseDateByDay&sort=name",_9="-lastUpdatedByDay&sort=name",L9="alphabet&sort=name",M9="category&sort=-releaseDate",x9="groupBy",$9=EL,F9=LO,N9=lU,B9="filter[platform]",U9={}
let G9=!1,j9=null,V9=null,H9=null,q9=null,W9=null,z9=null,Y9=null,J9=null,K9=null,Z9=null,Q9=null
const X9={}
X9[zW.sort]=x9,X9[zW.ageRating]=$O,X9[zW.controllerSupport]=FO,X9[zW.multiplayerSupport]=NO,X9[zW.comingSoon]=$9,X9[zW.binCompatGames]=B9
const e8=GA
class t8{constructor(){this.$intentKind="ArcadeSeeAllGamesPageIntent"}async perform(e,t){return await Ap(t,e.requestDescriptor)}}class n8{constructor(){this.$intentKind="ArcadeSeeAllGamesPageMoreIntent"}async perform(e,t){return await Tp(t,e.pageToken)}}class r8 extends D2{constructor(e,t){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,t.exportingService(_F,{fetchArcadeSeeAllGames:async t=>await Ap(e,t),fetchMoreArcadeSeeAllGames:async t=>await Tp(e,t.pageToken)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[$q,Oq,iH,aH,kj,Yj,CV]
return e.bag.enableUpdatedAgeRatings&&t.push(Eq),e.appleSilicon.isSupportEnabled&&t.push(kH),t}defaultTab(e){return sW}pageType(){return cG}pageRoute(e){return[{identifier:cG,path:`/${xW.arcadeSeeAllGames}`,query:[`${zW.requestDescriptor}?`,`${zW.sort}?`,`${zW.ageRating}?`,`${zW.controllerSupport}?`,`${zW.multiplayerSupport}?`,`${zW.comingSoon}?`]},{identifier:cG,hostName:`${BW}`,query:[`${zW.requestDescriptor}?`,`${zW.sort}?`,`${zW.ageRating}?`,`${zW.controllerSupport}?`,`${zW.multiplayerSupport}?`,`${zW.comingSoon}?`]},{path:"/{countryCode}/{platform}/arcade/see-all",query:[`${zW.requestDescriptor}?`,`${zW.sort}?`,`${zW.ageRating}?`,`${zW.controllerSupport}?`,`${zW.multiplayerSupport}?`,`${zW.comingSoon}?`]}]}paginationRoute(e){return[{identifier:cG,protocol:OW,path:`/${xW.arcadeSeeAllGames}/${xW.arcadeSeeAllGamesLoadMore}`}]}shelfRoute(e){return[{protocol:OW,path:`/${xW.arcadeSeeAllGames}/${xW.shelf}/`,query:[`${zW.token}`]}]}generatePageRequest(e,t,n){return qv.context("generatePageRequest",()=>{const t=bp(e,n),r=io(e).includingAdditionalPlatforms(ee(e)).includingRelationships([]).withSparseLimit(10).includingAttributes(wp(e)).usingCustomAttributes(Ue(e))
return function(e,t){let n=!1
for(const e of Object.keys(t)){if(e===$9&&s(t[e])){const r=t[x9]
if(s(r))switch(r[0].value){case D9:case _9:t[e][0].value=N9
break
case L9:t[e][0].value=F9
break
case M9:t[e][0].value=F9,n=!0}}e===B9&&o(t[e])&&(t[e]=U9[zW.binCompatGames].false)}n&&e.withSparseCount(4)
for(const n of Object.keys(t)){const r=E9.requestValuesForSelectedFacetOptions(t[n])
if(s(r)){s(r.value)&&e.addingQuery(n,r.value)
for(const t of Object.keys(r.additionalKeyValuePairs))e.addingQuery(t,r.additionalKeyValuePairs[t])}}}(r,s(t.selectedFacetOptions)?t.selectedFacetOptions:hp(e)),r})}async renderPage(e,t,n,o){return await Va(_j,async()=>{const o=g(t),i=bp(e,n),a=Un(e,qH,cG,o),c=function(e,t,n){return{url:az.fromComponents(OW,null,`/${xW.arcadeSeeAllGames}/${xW.arcadeSeeAllGamesLoadMore}`).build(),metricsPageInformation:n,metricsLocationTracker:{rootPosition:0,locationStack:[]},remainingGroups:[],lastShelfIndex:0,isCompactMode:t.isCompactMode}}(0,i,a),u=new C9(gp(e,l(o,"results.groups"),c))
u.title=e.loc.string(UC),u.pageFacets=function(e){fp(e),e.featureFlags.isEnabled(SJ)
const t=e.loc.string("PAGE_FACETS_FILTERS_AGE_RATINGS"),n=new O9(zW.ageRating,$O,t,hB,[W9,z9,Y9,J9],[W9],"age",pp(e,JV)),r=e.featureFlags.isEnabled(bJ)||!1,o=new O9(zW.sort,x9,e.loc.string(DA),hB,[j9,V9,H9,q9],r?[j9]:null,JV,pp(e,JV)),i=e.loc.string(EA),s=new O9(zW.controllerSupport,FO,i,eN,[K9],null,_A,pp(e,JV)),a=e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),c=new O9(zW.multiplayerSupport,NO,a,eN,[Z9],null,gH,pp(e,JV)),l=new O9(zW.comingSoon,$9,e.loc.string(RA),eN,[Q9],[Q9],DL,pp(e,DL))
l.isHiddenFromMenu=r
const u=new E9([],!1,null)
switch(e.client.deviceType){case lW:u.facetGroups.push(new R9([n])),e.bag.enableComingSoonToggle&&u.facetGroups.push(new R9([l],e.loc.string(LA))),u.facetGroups.push(new R9([s,c],e.loc.string("PAGE_FACETS_SUPPORTS_TITLE"))),u.facetGroups.push(new R9([o]))
break
case"tv":u.facetGroups.push(new R9([n],e.loc.string("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")))
const t=[s,c]
e.bag.enableComingSoonToggle&&t.push(l),u.facetGroups.push(new R9(t,e.loc.string("PAGE_FACETS_FILTERS_TITLE"))),u.facetGroups.push(new R9([o],e.loc.string("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")))
break
default:o.displayOptionsInline=!0,u.facetGroups.push(new R9([o],e.loc.string(DA))),n.showsSelectedOptions=!0,u.facetGroups.push(new R9([s,c,n],e.loc.string("PAGE_FACETS_FILTER_BY_TITLE"))),e.bag.enableComingSoonToggle&&u.facetGroups.push(new R9([l],e.loc.string(LA)))}return u}(e),u.selectedFacetOptions=s(i.selectedFacetOptions)?i.selectedFacetOptions:hp(e),u.pageSegments=[],jn(e,u,a)
const d=u.pageMetrics.instructions
if(!r(d))for(const e of d)e.data.includingFields.push(MS)
return c.remainingGroups.length>0&&(u.nextPage=c),u})}generatePaginationRequest(e,t,n,r){const o=g(r)
let i=[],s=20,a=!0
for(const e of o.remainingGroups)a=a&&(e.data.length<s||0===i.length),a&&(i=i.concat(e.data),s-=e.data.length)
return new dY(e,i).includingAdditionalPlatforms(ee(e)).includingAttributes(wp(e)).usingCustomAttributes(Ue(e))}async renderPaginatedPage(e,t,n){const r=g(n),o=[]
let i=20
const a={}
for(const e of t.data)a[e.id]=e
let c=!0
for(const e of r.remainingGroups){if(c=c&&(e.data.length<i||0===o.length),c){for(let t=0;t<e.data.length;t++){const n=a[e.data[t].id]
s(n)&&(e.data[t]=n)}i-=e.data.length}o.push(e)}r.remainingGroups=[]
const l=gp(e,o,r),u=new C9(l)
return u.title=e.loc.string(UC),r.remainingGroups.length>0&&(u.nextPage=r),u}generateShelfRequest(e,t,n){const r=g(JSON.parse(n[aV])).remainingContent.slice(0,20),o=new dY(e,r).includingAdditionalPlatforms(ee(e)).includingAttributes(wp(e)).usingCustomAttributes(Ue(e))
return Je(e,o,r),o}async renderShelf(e,t,n){const r=g(JSON.parse(n[aV]))
return r.remainingContent=t.data.concat(r.remainingContent.slice(20,r.remainingContent.length)),r.isFirstRender=!1,vp(e,r)}}class o8{constructor(e,t,n,r){this.$kind="ArcadeSubscribePage",this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class i8{constructor(){this.$intentKind="ArcadeSubscribePageIntent"}async perform(e,t){return await Sp(t,e.url)}}class s8 extends D2{constructor(e,t){super("ArcadeSubscribeBuilder"),t.exportingService(_F,{fetchSubscribePage:async t=>await Sp(e,t.url)})}defaultPlatforms(e){return ee(e)}defaultTab(e){return sW}defaultAttributes(e){const t=[$q,iH,aH]
return e.appleSilicon.isSupportEnabled&&t.push(kH),t}pageType(){return WO}pageRoute(e){return[{hostName:"arcadeSubscribePageCustomContext",query:[`${zW.appId}?`,`${zW.context}?`,`${zW.subscribePageMessage}?`,`${zW.askToBuyId}?`,`${zW.editorialItem}?`,`${zW.includePostSubscribeAttribution}?`]},{hostName:`${NW}`,query:[`${zW.appId}?`,`${zW.context}?`,`${zW.subscribePageMessage}?`,`${zW.askToBuyId}?`,`${zW.editorialItem}?`,`${zW.includePostSubscribeAttribution}?`]},{path:"arcade/subscribe",query:[`${zW.appId}?`,`${zW.context}?`,`${zW.subscribePageMessage}?`,`${zW.askToBuyId}?`,`${zW.editorialItem}?`,`${zW.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${zW.appId}?`,`${zW.context}?`,`${zW.subscribePageMessage}?`,`${zW.askToBuyId}?`,`${zW.editorialItem}?`,`${zW.includePostSubscribeAttribution}?`]}]}generatePageRequest(e,t,n){return ao(e,this.marketingItemContextFromParameters(n),f(n,zW.appId)).attributingTo(t.build())}async renderPage(e,t,n,o){var a,c
const u=o[s8.contextualAppRequirementKey]
let d=null
s(u)&&(d=yt(e,u))
const h=l(t,vO).map(e=>y(e)),p=e.arcade.getMarketingItemFromMarketingItems(h),w=p,g=Nc(e,w,0,!1,!1,_L),m=this.marketingItemContextFromParameters(n),A=e.client.isPhone,b=m===pt(tL),S=new UY(sW,e.bag.arcadeAppAdamId,null,Ej,null,b&&A?"arcadeLaunchRepairCompactSheet":GC,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
S.titles[EU]=e.loc.string($B,FB)
const P=f(n,zW.appId),I=function(e,t,n,r){var o
const s=Un(e,"Upsell",n,r)
return i(r)&&(s.mercuryMetricsData=null!==(o=mh(0,r))&&void 0!==o?o:void 0),s}(e,0,w.id,w)
I.offerType=BO,I.baseFields.upsellType=this.metricsUpsellType(m),I.baseFields.subscriptionSKU=e.bag.arcadeProductId
const C={pageInformation:I,locationTracker:{rootPosition:0,locationStack:[]}},k=Uc(e,{marketingItemData:p},$c(0,w),C,!1)
if(!T(c=k)||c[gW]!==_y)throw new Error("Only buy actions are supported on the upsell page")
const O=new o8(g,e.loc.string(xA),k,S)
let E
O.askToBuyMessage=f(n,zW.subscribePageMessage),O.askToBuyId=f(n,zW.askToBuyId),jn(e,O,I)
let R=!1
if(s(d)){O.primaryIcon=Qd(e,d,C,{useCase:y6.LockupIconLarge})
const t=V(d,wq),r=Js(e,d,C)
r.excludeAttribution=!v(n[zW.includePostSubscribeAttribution]),E=Sr(e,d,Lq,m,t,r),R=!0}if(!v(n[zW.includePostSubscribeAttribution])){const e=O.pageMetrics.instructions
if(!r(e))for(const t of e)t.data.includingFields.push(xM)}let D=[]
const _=o[s8.contextualIconsRequirementKey]
if(s(_)&&(D=bt(_)),i(p)&&(D=we(p,uW)),s(D)){const t=[]
for(const n of D)if(n.id===P){if(!R){O.primaryIcon=Qd(e,n,C,{useCase:y6.LockupIconLarge})
const t=V(d,wq),r=Js(e,n,C)
E=Sr(e,n,Lq,m,t,r)}}else t.push(Qd(e,n,C,{useCase:y6.LockupIconMedium}))
O.icons=t}return i(E)&&(k.postSubscribeAction=E),b&&i(P)&&(O.openAppAction=new JJ(P)),s(O.icons)||i(O.primaryIcon)||(O.artwork=this.genericArtworkFromData(e,w)),b&&(O.singleIcon=O.primaryIcon,(null===(a=O.singleIcon)||void 0===a?void 0:a.art)&&(O.singleIcon.art.contentMode=Kv.scaleAspectFit)),O.subscribedOfferButtonAction=new IX(sW),O}genericArtworkFromData(e,t){if(!i(t))return null
const n=e.client.isPhone,r=function(e,t,n){const r=function(e,t){return Rc(e,t)}(e,t)
return p(r,n)}(e,t,n?yb:JE)
if(!s(r))return null
let o=null,a=h(r,BG)
return n?(o="of",a=a-296-1602):(o="og",a=a-344-772),Zd(e,r,{cropCode:o,allowingTransparency:!0,useCase:y6.ArcadeContextualUpsell,overrideHeight:a})}metricsUpsellType(e){return i(e)?e:pt(mj)}marketingItemContextFromParameters(e){let t=f(e,zW.context)
const n=f(e,zW.askToBuyId)
switch(o(t)&&s(n)&&(t=eL),t){case tL:return pt(tL)
case eL:return pt(eL)
default:return t}}}s8.contextualIconsRequirementKey="contextualIconsRequirement",s8.contextualAppRequirementKey="contextualPrimaryIconRequirement"
class a8 extends pJ{constructor(e){super(e,"ArcadePage")}}const c8="amdImpressionData"
class l8 extends D2{constructor(e=null){super(e||"AbstractGroupingPageController")}generateAdditionalPageRequirements(e,t,n){var r
const o=super.generateAdditionalPageRequirements(e,t,n),i=e.amsEngagement
if(!i||!vn(e))return o
const s=[QH,dW,sW],a=null===(r=e.bag.tabsStandard.find(e=>e.url===t.toString()))||void 0===r?void 0:r.id
if(!s.includes(a))return o
const c={timeout:1e3,eventType:xK,tab:a}
return o[c8]=D(i.performRequest(c)),o}async renderPage(e,t,n,r,o,s){return await Va(Ab,async()=>{const a=function(e,t){const n=yt(e,t)
return n&&de(n,XG)?ul(e,n):null}(e,t),c=function(e,t,n){const r=yt(e,t)
if((0,Wv.isNothing)(r))return null
const o=Un(e,WE,r.id,t),s=Ss(e)
return o.recoMetricsData=yh(o.recoMetricsData,null,s),{shelves:[],metricsPageInformation:o,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:j(r,"id"),pageGenreId:null,hasAuthenticatedUser:i(e.user.dsid),refreshController:Nr(t),recoImpressionData:gn(0,null==n?void 0:n[c8])}}(e,t,r)
return(0,Wv.isNothing)(a)||(0,Wv.isNothing)(c)?null:this.renderGroupingPage(e,a,c,n,r,o,s)})}}class u8{constructor(){this.$intentKind="ArcadePageIntent"}async perform(e,t){return await Ip(t,e)}}class d8 extends l8{constructor(e,t){super("ArcadePageBuilder"),t.exportingService(_F,{fetchPage:async t=>await Ip(e,t)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[$q,iH,aH,yU]
return e.bag.enableUpdatedAgeRatings&&t.push(Eq),e.appleSilicon.isSupportEnabled&&t.push(kH),t}pageType(){return sW}pageRoute(e){return[{protocol:EW,path:`/${xW.store}/${xW.grouping}`,query:[zW.isArcade,`${zW.isTrialAvailable}?`,`${zW.isTrialEnrolled}?`,`${zW.isSubscribed}?`,zW.id]},{hostName:$W,path:`/WebObjects/{storePreviewInstance}/wa/${xW.grouping}`,query:[zW.isArcade,`${zW.isTrialAvailable}?`,`${zW.isTrialEnrolled}?`,`${zW.isSubscribed}?`,zW.id,`${zW.useReleaseId}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[zW.isArcade,`${zW.isTrialAvailable}?`,`${zW.isTrialEnrolled}?`,`${zW.isSubscribed}?`]},{protocol:EW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[zW.isArcade,`${zW.isTrialAvailable}?`,`${zW.isTrialEnrolled}?`,`${zW.isSubscribed}?`]},{protocol:EW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[zW.isArcade,`${zW.isTrialAvailable}?`,`${zW.isTrialEnrolled}?`,`${zW.isSubscribed}?`]}]}generatePageRequest(e,t,n){const r=n[zW.id],o=v(n[zW.isSubscribed]),s=v(n[zW.isTrialEnrolled])
if(!a(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
const c=[$q,Oq,iH,aH,CV,vG]
e.appleSilicon.isSupportEnabled&&c.push(kH),e.bag.enableUpdatedAgeRatings&&c.push(Eq),nf(e)&&c.push(TH)
let l=new dY(e).includingAgeRestrictions().includingAttributes(c).includingMacOSCompatibleIOSAppsWhenSupported()
oi(e)&&(l.enablingFeature(zH),l.includingScopedAttributes(iW,YK),l.includingScopedRelationships(iW,[Jq])),ii(e)&&(l.enablingFeature(pM),yi(l)),si(e)&&(l.enablingFeature(DB),Ti(l))
const u=ne(e)
if(i(u)&&l.addingQuery(FG,u),o){const t=!0,n=ar(e,e.bag.arcadeTrialEnrolledStateRate)
t&&s&&n?l.addingQuery(XG,"trial-enrolled"):l.addingQuery(XG,"subscriber")}else l.addingQuery(XG,"nonsubscriber"),l.includingRelationshipsForUpsell(!1)
l.withIdOfType(r,MV)
const d=t.query[zW.useReleaseId]
return WW.has(t.host)&&(null==d?void 0:d.length)>0&&(l=l.addingQuery(jC,d),l.isStorePreviewRequest=!0),l.enablingFeature(qE),l.enablingFeature(gb),l.withSparseCount(Q(e)),l.includingScopedSparseLimit(RB,X(e)),l.attributingTo(t.build())}renderGroupingPage(e,t,n,r,i,a,c){return qv.context(_j,()=>{const i=v(r[zW.isSubscribed]),c=v(r[zW.isTrialAvailable]),l=v(r[zW.isTrialEnrolled]),u={}
u[zW.isArcade]="true",u[zW.isSubscribed]=`${i}`,u[zW.isTrialAvailable]=`${c}`,u[zW.isTrialEnrolled]=`${l}`,n.additionalShelfParameters=u,n.isArcadePage=!0,n.metricsPageInformation.isCrossfireReferralCandidate=!0
let d=null,f=null
if(!i){const r=co(e,t.originalGroupingData)
if(r)d=r.marketingItemData
else if(a){qv.unexpectedNull(_H,VC,"relationships.upsell")
const e=lo(0,a.get(N_))
e&&(d=e.marketingItemData)}if(s(d)&&s(d.attributes)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,mercuryMetricsData:mh(0,d)}
f=xc(e,d,t),s(n)&&o(n.pageTitleEffect)&&0===n.shelves.length&&(n.pageTitleEffect=function(e,t){const n=Pc(e,t,!0),r=Sc(e,t)
return Mc(0,n.artworkData||r.artworkData,!0)}(e,d)),Oh(n.metricsLocationTracker)}}const h=d8.insertUpsellBreakoutShelfIntoParseContextIfNecessary(f,i,n)
cl(e,t,n)
const p=new a8(n.shelves)
jn(e,p,n.metricsPageInformation),p.tabTitle=j(t.originalGroupingData,fW)
const w=j(t.originalGroupingData,fW)
e.host.clientIdentifier,h||(p.title=w)
const g=new k4(PV)
g.color=Se("primaryText"),g.isFallbackStyle=!0,e.clientCapabilities.isEnabled("arcadeStandardLargeTitle")?p.presentationOptions=[wM]:p.presentationOptions=[]
let m=!1
if(n.shelves.length>0){const e=n.shelves[0].contentType===L$,t=n.shelves[0].contentType===uG,r=n.shelves[0].contentType===cj
m=e||t||r}if(m&&(p.presentationOptions.push(yN),p.titleEffect=n.pageTitleEffect||g),!i&&s(f)){p.subscriptionOfferAction=d8.createSubscribeAction(e,f,{id:null,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:hW}),p.subscriptionOfferDisplayProperties=new UY(sW,e.bag.arcadeAppAdamId,null,Ej,null,sW,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r={marketingItemData:d}
p.subscriptionLockup=Md(e,r,t,pt(QB),Ej,UE)}const y={id:"arcade-see-all-games-footer",presentationHints:{},featuredContentId:-1,featuredContentData:null,nativeGroupingShelfId:1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
if(this.insertUnifiedMessageShelves(e,p),p.shelves.length>0){const t=d8.groupingArcadeFooterShelfController.createShelf(e,null,n,y,null)
p.shelves.push(t)}if(0===p.shelves.length)throw new Error(`Missing content for Arcade grouping ${JSON.stringify(r)}`)
return p.autoUpsellAction=to(e,pt(mj),null,null),Pp(p),p})}static insertUpsellBreakoutShelfIntoParseContextIfNecessary(e,t,n){return qv.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(o(e))return t||qv.unexpectedNull(SH,VC,uG),!1
const r=new dJ(uG)
return r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t,n){if(o(t))return null
{const r=to(e,pt(tO),null,null,n)
return r.title=t.offerButtonAction.title,r}}createTermsAndConditionsShelf(e){return!r(e.bag.termsAndConditionsURL)&&e.client.deviceType,null}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t,n){if(r(n))return null
const o=yt(e,t),i=v(n.parameters[zW.isSubscribed]),s=co(e,o)
return!i&&r(s)?new Set([N_]):null}fetchAdditionalDataForKey(e,t){return qv.context("fetchAdditionalDataForKey",async()=>{let n
return t===N_&&(n=ao(e,pt(QB)),qv.unexpectedNull(SH,SV,"upsellRecovery.marketingItem")),r(n)?null:await Ln(e,n).catch(()=>null)})}insertUnifiedMessageShelves(e,t){t.shelves.length<=0||(t.shelves.splice(1,0,hl(0,"arcadePageHeader")),t.shelves.splice(6,0,hl(0,"arcadePageMid")),t.shelves.push(hl(0,"arcadePageFooter")))}}d8.groupingArcadeFooterShelfController=new n4
class f8{constructor(e,t){this.$kind="ArcadeWelcomePage",this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class h8{constructor(e,t,n,r,o){this.$kind="ArcadeWelcomeContent",this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class p8{constructor(e,t,n){this.$kind="ArcadeWelcomeItem",this.headline=e,this.body=t,this.artwork=n}}const w8={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:MA,textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},g8={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:MA,textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"}
class v8{constructor(){this.$intentKind="ArcadeWelcomePageIntent"}async perform(e,t){return await kp(t,e.url)}}class m8 extends R2{constructor(e,t){super("ArcadeWelcomeBuilder"),t.exportingService(_F,{fetchArcadeWelcomePage:async t=>await kp(e,t.url)})}pageType(){return"arcadeWelcome"}async handlePage(e,t,n,r,o){const i=await this.generatePage(e,n,r)
return R2.createFlowAction(i,this.pageType(),t)}pageRoute(e){return[{hostName:"arcadeWelcomePage",query:[`${zW.context}?`]}]}async generatePage(e,t,n){return function(e,t){return function(e,t){const n={rootPosition:0,locationStack:[]},r=function(e,t){if(rr(t)){const t=new kW
return t.title=e.loc.string("ARCADE_WELCOME_TV_CONTINUE_BUTTON"),t}return Cp(0,e.loc.string("ARCADE_WELCOME_CONTINUE_BUTTON"))}(e,t)
Qs(e,r,{id:"arcade-welcome-continue",actionType:pW,pageInformation:new nK,locationTracker:n,targetType:hW})
const o=function(e,t){return rr(t)?Cp(0,e.loc.string(GO)):null}(e,t)
o&&Qs(e,o,{id:"arcade-welcome-create-family",actionType:pW,pageInformation:new nK,locationTracker:n,targetType:hW})
let i=w8,s="oe"
e.client.isPad&&(i=g8,s="og")
const a=new h8(e.loc.string("ARCADE_WELCOME_INDIVIDUAL_TITLE"),e.loc.string("Arcade.Welcome.Family.Description"),[new p8(null,null,Zd(e,i,{useCase:y6.ArcadeWelcomeSheet,cropCode:s}))],r,o)
if(rr(t)){a.nonDismissingContinueAction=Cp(0,e.loc.string(GO)),r.title=a.nonDismissingContinueAction.title
const t=new kW
t.title=e.loc.string(xA),a.dismissingFamilyAction=t,o.title=a.dismissingFamilyAction.title}else a.nonDismissingContinueAction=Cp(0,e.loc.string(GO)),r.title=a.nonDismissingContinueAction.title
return new f8(a,a)}(e,t)}(e,t[zW.context])}}class y8 extends R2{constructor(){super("FamilyCircleBuilder")}pageType(){return qq}defaultTab(e){return sW}async handlePage(e,t,n,r,o){var i
const s=new IX(sW),a=null!==(i=t.query[Kj])&&void 0!==i?i:cA,c=new W3(vq,a,t.query)
return s.actions.push(c),s}pageRoute(e){return[{hostName:`${UW}`},{path:`${UW}`}]}}class A8{constructor(e,t){this.$kind="UpsellGridContent",this.primaryIcon=e,this.icons=t}}class T8{constructor(){this.$intentKind="ArcadeUpsellGridIntent"}async perform(e,t){return await Op(t,e.contentDictionary)}}class b8 extends R2{constructor(e,t){super("MarketingItemUpsellBuilder"),t.exportingService(_F,{fetchUpsellGrid:async t=>await Op(e,t.contentDictionary)})}pageType(){return Ij}pageRoute(e){return[{hostName:`${NW}`,query:[`${zW.appId}?`,`${zW.context}?`,`${zW.includePostSubscribeAttribution}?`],exclusions:[{query:[`${zW.askToBuyId}`]}]},{path:"arcade/subscribe",query:[`${zW.appId}?`,`${zW.context}?`,`${zW.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${zW.appId}?`,`${zW.context}?`,`${zW.includePostSubscribeAttribution}?`]}]}async handlePage(e,t,n,r,o){var i
const s=pt(f(n,zW.context)),a=f(n,zW.appId),c=new iZ(sW,s,e.bag.metricsTopic,a),l=new EY(Ij),u=null===(i=e.metricsIdentifiersCache)||void 0===i?void 0:i.getMetricsFieldsForTypes([em.user,em.client,em.canonical])
return(0,Hv.isSome)(u)&&(c.metricsOverlay={...c.metricsOverlay,...u}),l.pageData=c,l}}class S8{constructor(){this.$intentKind="ArcadeSubscriptionDecorationIntent"}async perform(e,t){return await Ep(t,e.json)}}class P8 extends R2{constructor(e,t){super("ArcadePurchaseDecorationController"),t.exportingService(XC,{decorateArcadePurchase:async t=>await Ep(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class I8{constructor(e,t,n){this.$kind="PersonalizedOfferContext",this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}class C8{constructor(){this.$intentKind="PersonalizedOfferContextIntent"}async perform(e,t){return await Rp(t,e.offerToken)}}class k8 extends R2{constructor(e,t){super("CompleteCollectionController"),t.exportingService("CMCPersonalizationData",{fetchPersonalizedOfferContext:async t=>await Rp(e,t.offerToken)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class O8{constructor(e,t){this.purchase=e,this.buyParams=t}}class E8{constructor(e,t){this.items=e,this.commonBuyParams=t}}class R8{constructor(){this.$intentKind="PurchaseDecorationIntent"}async perform(e,t){return await Dp(t,e.json)}}class D8{constructor(){this.$intentKind="PurchasesDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await Dp(t,r))
return n}}class _8{constructor(){this.$intentKind="BatchPurchaseDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await Dp(t,r))
const r=n.map(e=>e.buyParams),[o,i]=function(e){const t=[]
for(const n of e)t.push(new oK(n).toRawMap())
const n=function(e){if(0===e.length)return{}
const t={},n=e[0]
for(const r of Object.keys(n)){let o=!0
for(let t=1;t<e.length;t++)if(e[t][r]!==n[r]){o=!1
break}o&&(t[r]=n[r])}return t}(t)
for(const e of t)for(const t of Object.keys(n))delete e[t]
return[t,n]}(r),s=[]
for(let e=0;e<n.length;e++)s.push(new O8(n[e],o[e]))
return new E8(s,i)}}class L8 extends R2{constructor(e,t){super("PurchaseDecorationController"),t.exportingService(XC,{decoratePurchase:async t=>await Dp(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class M8{constructor(){this.$intentKind="IconArtworkIntent"}async perform(e,t){return await _p(t,e.adamIds)}}class x8 extends R2{constructor(e,t){super("IconLookupController"),t.exportingService("ContentData",{fetchIconArtwork:async t=>await _p(e,t.adamIds)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class $8 extends R2{constructor(){super("ContentLink")}pageType(){return wW}async handlePage(e,t,n,o,s){if(r(f(n,zW.path)))throw new Error(`Unhandled search url: ${t}`)
const a=await M(e.network.fetch({url:t.build(),method:XN}))
if(!a.success)throw new Error(`Unhandled search url: ${t}`)
const c=a.value
if(this.hasGotoURLInResponse(e,c))return new kW
if(i(c.url))return await e.required(y3).fetchAction(e,c.url,s)
throw new Error(`Unhandled search url: ${t}`)}pageRoute(e){return[{hostName:"search.itunes.apple.com",path:"WebObjects/MZContentLink.woa/wa/link",query:[zW.path]}]}hasGotoURLInResponse(e,t){const n=t.body
if((0,Hv.isNothing)(n)||0===n.length)return!1
try{const t=m(e.plist.parse(n)),r=f(t,JO),o=f(t,KO)
return!!(r===ZO&&(0,Hv.isSome)(o)&&o.length>0)}catch{return!1}}}class F8 extends R2{constructor(){super("ExperimentLink")}pageType(){return qq}async handlePage(e,t,n,r,o){const i={url:t.toString()},s=await M(e.network.fetch(i))
if(!s.success)throw s.error
const a=s.value
if(a.status>=200&&a.status<300){const e=new LY(Lq)
return e.title="You have been enrolled in the AB test",e.message=`Test ${t.query.ab2} is now active on your device.`,e.buttonTitles=["OK"],e.buttonActions=[new IX(BH)],e}throw new Error(`unexpected response status: ${a.status} from ${a.url}`)}pageRoute(e){return[{protocol:EW,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}const N8=[dW,XD]
class B8 extends R2{constructor(){super("FallbackActionBuilder")}async handlePage(e,t,n,i,s){return await async function(e,t,n,i){var s
const a=t.query[eq]
switch(a){case pH:const n=new EY(Tj)
n.presentationContext=Wj,n.animationBehavior=eU
const c=t.query[lL]
return c?n.pageUrl=c:t.query[Vy]?n.pageUrl=az.fromComponents(null,a,null,{continuation:t.query[Vy]}).toString():n.pageUrl=a,await Promise.resolve(n)
case Hy:const l=new EY(Tj)
return l.presentationContext=Wj,l.animationBehavior=eU,l.pageUrl=function(e){let t=e.bag.createAccountUrl
return(r(t)||typeof t!==Bq)&&(t=uO),new az(t)}(e).build(),await Promise.resolve(l)
case Kx:let u,d=[]
{u=uL
const e=new EY(pH)
e.presentationContext=Wj,e.animationBehavior=rH
const t=new EY(qy)
t.animationBehavior=rH,d=[e,t]}const f=new IX(u)
return f.actions=d,await Promise.resolve(f)
case dL:const h=t.query[lL]
if(h.length>0){const t={url:h,signingStyle:YV}
return e.network.fetch(t),await Promise.resolve(new kW)}return await Promise.reject(new Error("Original url is missing when creating deep-link for checkForPreorders."))
case VF:const p=new EY(Tj)
p.presentationContext=Wj,p.animationBehavior=eU
const w=new az(a)
return t.query[eB]&&t.query[eB].length>0&&w.param(zW.code,t.query[eB]),p.pageUrl=w.build(),await Promise.resolve(p)
case HF:const g=new EY(Tj)
return g.presentationContext=Wj,g.animationBehavior=eU,g.pageUrl=a,await Promise.resolve(g)
case Wy:const v=new EY(Tj)
return v.presentationContext=Wj,v.animationBehavior=eU,v.pageUrl="charity",await Promise.resolve(v)
case bq:let m=t.query[ZG]
if(m||(m=null!==(s=t.query.q)&&void 0!==s?s:t.query[lO]),m&&m.length>0){const t=m
if(m=m.replace(/\+/g," ").trim(),t.endsWith("+")&&m.length>0&&(m+="+"),o(m))return await Promise.reject(new Error("Empty search term."))
const n=ve(e,xp(e,{term:m,origin:tB})).toString(),r=new n5(m,m,n,tB,null,null,null,i)
ta(e,r,hW,{rootPosition:0,locationStack:[]})
{const e=new EY(bq)
return e.pageData=r,await Promise.resolve(e)}}{const e=new IX(bq)
return await Promise.resolve(e)}}return await Promise.reject(new Error(`FlowAction was not able to be created for this action URL: ${t}`))}(e,t,0,s)}pageRoute(e){return[{query:[`${zW.action}=account`]},{query:[`${zW.action}=signup`]},{query:[`${zW.action}=purchased`]},{query:[`${zW.action}=checkForPreorders`]},{query:[`${zW.action}=redeem`]},{query:[`${zW.action}=gift`]},{query:[`${zW.action}=donate`]},{query:[`${zW.action}=search`]}]}pageType(){return qq}}class U8 extends R2{constructor(){super("GameCenterProfileLinkController")}defaultTab(e){return sW}pageType(){return qq}async handlePage(e,t,n,r,o){let i=!1
if(e.host.clientIdentifier===aY)i=!0
else for(const t of e.bag.tabsStandard)if("ocelot"===f(t,"id")){i=!0
break}const s=new IX(i?sW:QH),a=n[zW.id]||"GameCenter.localPlayer"
return s.actions.push(new Z5(a)),s}pageRoute(e){return[{identifier:ek,path:`/${xW.gameCenterProfile}`,query:[`${zW.id}?`]}]}}class G8 extends R2{constructor(){super("HiddenPurchasesLinkController")}pageType(){return zO}async handlePage(e,t,n,r,o){const i=new EY(zO)
return i.presentationContext=pL,i}pageRoute(e){const t=[]
return t.push({hostName:"showHiddenPurchases"}),t}}class j8 extends R2{constructor(){super("LibraryLink")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${t.query.g}&mt=8`
return await e.required(y3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${zW.action}=library-link`]}]}}class V8 extends R2{constructor(){super("LongUrlBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const a=t.query[lL]
if((0,Hv.isNothing)(a)||0===a.length)throw new Error("Original url is missing when creating deep-link for checkForLongUrl.")
const c=await M(e.network.fetch({url:a,method:XN,signingStyle:YV}))
if(!c.success)throw new Error(`Unable to fetch long url: ${a}`)
const l=c.value
let u
const d=l.headers["Content-Type"]
if(l.ok&&l.redirected&&i(l.url))u=l.url
else{if(l.ok&&a!==l.url)return e.console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${a}. Redirected url: ${l.url}`),new kW
if(l.ok&&s(d)&&-1!==d.toLowerCase().indexOf("text/xml")){const t=m(e.plist.parse(l.body)),n=f(t,JO),r=f(t,KO)
n===ZO&&r&&(u=r)}}if((null==u?void 0:u.length)>0)return await e.required(y3).fetchAction(e,u,o)
throw new Error(`Unable to map long url for: ${a}`)}pageRoute(e){return[{query:[`${zW.action}=checkForLongUrl`]}]}}class H8 extends R2{constructor(){super("MultiplexingBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=new dY(e).withIdOfType(n.id,xx)
return await Ln(e,i).then(async t=>await this.actionFromMultiplexResponse(e,t))}pageRoute(e){return[{protocol:EW,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[zW.id]}]}async actionFromMultiplexResponse(e,t){const n=p(t,"results.target"),r=p(t,"results.target-link")
return n?await this.targetDataToAction(e,n):r?await this.targetLinkDataToAction(r):null}async targetDataToAction(e,t){const n=f(t,AG)
if(!n)return null
const r=Fi(e,n)
return await e.required(y3).fetchAction(e,r,null)}async targetLinkDataToAction(e){const t=f(e,Wq),n=new az(t),r=this.addProtocolToURLIfNeeded(n).toString()
return await Promise.resolve(new GY(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol=U_),e}}class q8 extends R2{constructor(){super("NotificationSettingsLinkController")}pageType(){return qq}async handlePage(e,t,n,r,o){return new EY(jA)}pageRoute(e){const t=[]
return t.push({path:"notifications/settings"}),t}}class W8 extends R2{constructor(){super("TabSelectionBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=t.pathComponents(),s=i.length-1
let a,c
return a=s>=0?i[s]:t.query[eq],null!=a&&this.currentDeviceSupportsUrlAction(e,a)&&(c=new IX(a),c.popToRoot=t.query.popToRoot===pq),void 0===c&&(c=new IX(zq)),c}pageRoute(e){const t=[zq,"home",QH,dW,kG,hj,OF,EF,RF,nB,sW,zU],n=[]
for(const e of t){const t=`${zW.action}=${e}`,r=`${e}`
n.push({query:[t]}),n.push({path:r}),n.push({path:`{countryCode}/${r}`})}return n.push({path:"{countryCode}/ipad"}),n.push({path:"{countryCode}/iphone"}),W8.supportedIOSTabs.forEach(e=>{n.push({path:`{countryCode}/ipad/${e}`}),n.push({path:`{countryCode}/iphone/${e}`})}),n}currentDeviceSupportsUrlAction(e,t){return!!W8.supportedIOSTabs.includes(t)}}W8.supportedMacTabs=[kG,sW,hj,OF,EF,RF,nB,bq],W8.supportedIOSTabs=[zq,dW,QH,sW,bq],W8.supportedTvTabs=[kG,dW,QH,sW,bq],W8.supportedVisionOSTabs=[zU,sW,bq]
class z8 extends R2{constructor(){super("PassbookBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){const i=this.assemblePassbookRoomURL(e,t).build()
return await e.required(y3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${zW.action}=passbook`]}]}assemblePassbookRoomURL(e,t){let n=e.bag.passbookMainURL
return null!=n&&typeof n===Bq||(n="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new az(n)}}class Y8 extends R2{constructor(){super("WatchCategoryBuilder")}pageType(){return qq}async handlePage(e,t,n,r,o){if(e.client.deviceType!==nW)throw new Error(`Unsupported url for current platform: ${t}`)
const i=e.bag.watchAppsGroupingURL,s=await M(e.required(y3).fetchAction(e,i,o))
if(!s.success)throw s.error
const a=s.value,c=new IX(dW)
return c.actions=[a],c}pageRoute(e){return[{query:[`${zW.action}=watchCategory`]}]}}class J8 extends _2{}const K8=[jj,KV,Zq,pG,gN],Z8=[jj,KV,vN,Zq,wG,CB,wU,gU],Q8=[jj,mN,KV,wG],X8=[jj,vN,Zq,wG,pG,KV,mN,gU,wU,CB]
class e7{}class t7 extends R2{constructor(){super("DeveloperBuilder")}async handlePage(e,t,n,r,o){const i=function(e,t){const n=Ni(t)
if(!a(n))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return Ri(e,new dY(e).withIdOfType(t,pV))}(e,n)}(e,t)
return await Ln(e,i).then(t=>Fp(e,t)).then(e=>R2.createFlowAction(e,wW,t))}pageRoute(e){return[{protocol:EW,path:`/${xW.developer}/{id}`},{protocol:EW,path:`/${xW.developer}/{developerName}/{id}`},{protocol:EW,path:`/{countryCode}/${xW.developer}/{developerName}/{id}`},{protocol:EW,path:`/{countryCode}/${xW.artist}/{developerName}/{id}`},{protocol:EW,path:`/${xW.store}/${xW.viewArtist}`,query:[zW.id,`${zW.v0}?`]}]}async handleShelf(e,t,n,r){const i=n[aV],s=JSON.parse(i),a=new dY(e,s.remainingData).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e)).includingMacOSCompatibleIOSAppsWhenSupported()
return function(e,t,n){const r=Gp(e,n.title,n.developerId,At(t),n.relationship,n.contentType,n.lockupListOptions,n.lockupListOptions.lockupOptions.metricsOptions.pageInformation,n.lockupListOptions.lockupOptions.metricsOptions.locationTracker,n.roomUrl,(0,Hv.isSome)(n.roomUrl))
return r.mergeWhenFetched=!0,!n.hasExistingContent&&o(r.items)&&(r.isHidden=!0),r}(e,await Ln(e,a),s)}shelfRoute(e){return[{protocol:OW,path:`/${xW.developer}/${xW.shelf}/{token}`}]}pageType(){return wW}}class n7 extends R2{constructor(){super("DeveloperHrefBuilder")}async handlePage(e,t,n,r,o){const i=n[zW.href],s=function(e,t){return Ri(e,new dY(e,t))}(e,i)
return await Ln(e,s).then(t=>Fp(e,t)).then(e=>R2.createFlowAction(e,wW,t))}pageRoute(e){return[{protocol:OW,path:`/${xW.developer}/${xW.href}`,query:[zW.href]}]}pageType(){return wW}}class r7 extends L2{constructor(){super("DeveloperRoomBuilder")}pageRoute(e){return[{protocol:OW,path:`/${xW.developer}/${xW.room}/{token}`}]}paginationRoute(e){return[{protocol:OW,path:`${this.paginationPath}`,query:[`${zW.token}`]}]}generatePageRequest(e,t,n){const o=n[aV],i=JSON.parse(o)
if(r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new dY(e,i.url).withSparseLimit(i.maxPerPage).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e))}async renderPage(e,t,n,r){return await Va(_j,async()=>{const r=n[aV],o=JSON.parse(r),i=Un(e,qH,`${o.developerId}_${o.relationshipId}`,t)
o.metricsPageInformation=i,o.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=await this.pageWithContent(e,t,o)
return s.title=o.title,this.configurePaginationForPage(s,o,t.next),jn(e,s,i),s})}generatePaginationRequest(e,t,n,r){var o
const i=r,a=Pt(0,i)
let c
return s(a)?c=new dY(e,a):(null===(o=i.nextHref)||void 0===o?void 0:o.length)>0&&(c=new dY(e,i.nextHref).withSparseLimit(i.maxPerPage)),c.includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e)),c}async renderPaginatedPage(e,t,n){const r=n,o=s(r.remainingContent),i=await this.pageWithContent(e,t,r,!o),a=It(0,r)
return this.configurePaginationForPage(i,a,o?r.nextHref:t.next),i}configurePaginationForPage(e,t,n){const r=(null==n?void 0:n.length)>0,o=s(t.remainingContent)
r||o?(t.nextHref=n,t.url=`${this.paginationUrl}?${zW.token}=${JSON.stringify(t)}`,e.nextPage=t):e.nextPage=null}}!function(e){e.ViewAligned="viewAligned",e.CenterAligned="centerAligned"}(Hm||(Hm={}))
class o7 extends D2{constructor(){super("EditorialPageController")}defaultPlatforms(e){return ee(e)}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o)
const s=r.pathname===`/${xW.editorialPage}/${xW.shelf}`
let a
t.includingScopedRelationships("editorial-shelves",[uW]).includingScopedRelationships(XH,[mU]),s?t.includingAssociateKeys(dW,[sV]).includingAssociateKeys(Xq,[sV]):(t.includingRelationships([TN]).withSparseCount(5).withSparseLimit(12).includingAssociateKeys(OB,[sV]),t.includingAssociateKeys(IV,[dW])),bw(e,t),a=r.query[zW.context]||ne(e),i(a)&&t.addingQuery(FG,a)}generatePageRequest(e,t,n){var r
let i
i=t.host===jW?e.bag.safariExtensionsEditorialPageId:t.query[zW.id]||n[zW.id]
const s=n[zW.name]
if(o(i)&&o(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
const a=new dY(e)
let c=!1
return(null===(r=t.pathname)||void 0===r?void 0:r.includes(IV))&&(a.forType(IV),c=!0),c||a.forType(XH),(null==i?void 0:i.length)>0&&(c?a.withIdOfType(i,IV):a.withIdOfType(i,XH)),(null==s?void 0:s.length)>0&&a.addingQuery(zW.name,s),a.attributingTo(t.build())}pageRoute(e){return[{protocol:OW,path:`${xW.editorialPage}`,query:[`${zW.name}`,`${zW.isArcade}?`]},{protocol:OW,path:`${xW.editorialPage}`,query:[`${zW.id}`,`${zW.isArcade}?`]},{protocol:EW,path:"/{countryCode}/editorial-page/id{id}"},{protocol:EW,path:"/editorial-page/id{id}"},{protocol:EW,path:"/{countryCode}/{platform}/editorial/{id}"},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{path:"{apiVersion}/editorial/{countryCode}/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{path:"{apiVersion}/editorial/editorial-pages/{id}",query:[`${zW.name}?`,`${zW.isArcade}?`]},{path:"{apiVersion}/catalog/{countryCode}/tags/{id}",query:[`${zW.deviceFamily}?`]}]}pageType(){return wW}async renderPage(e,t,n,a,c,l){return await Va("renderEditorialPage",async()=>await async function(e,t,n){var a,c
const l=yt(e,t)
if(!s(l))return null
const u=we(l,TN)
if(!s(u))return null
let d="Editorial"
f(l,kV)===IV&&(d="TagRoom")
const h=Un(e,d,l.id,t),p={rootPosition:0,locationStack:[]},w=Ss(e)
h.recoMetricsData=yh(h.recoMetricsData,null,w)
const g=Nr(t),{isArcadePage:v}=n,m=[]
let y=null,A=null
if(!i(l.attributes))return null
y={id:l.id,type:l.type,attributes:l.attributes,relationships:l.relationships,meta:l.meta}
let T=!1
for(const t of u){const n=m.length,o=hw(e,y.id,t,v,n,h,p),i=Aw(e,y,o)
if(!r(i)){if(0===m.length){const e=i.presentationHints
i.presentationHints={...e,isFirstShelf:!0}}o.type===lm.Upsell&&(T=!0),i.contentType===uG&&(A=Tw(e,o)),m.push(i)}}const b=v?new a8(m):new pJ(m)
b.title=T?null:null!==(a=j(l,oV))&&void 0!==a?a:j(l,fW),b.canonicalURL=j(l,Wq),b.shareAction=function(e,t){var n
const s=j(t,Wq),a=j(t,oV)
if(r(s)||r(a))return null
const c=function(e,t,n,r,i,s){return qv.context("shareSheetDataForGenericPage",()=>{if(o(n))return null
const e=new mZ(t,r,null!=s?s:void 0)
return new hZ(e,n,null)})}(0,a,s,e.loc.string("SHARE_EDITORIAL_PAGE_SUBTITLE"),0,null===(n=rd(e,t,Fm.EditorialPage))||void 0===n?void 0:n.artwork)
if((0,Hv.isNothing)(c))return null
const l=function(e,t){const n=[]
if((null==t?void 0:t.length)>0){const r=Go(e,t)
i&&n.push(r)}return n}(e,s)
return new KK(c,l)}(e,l),b.pageRefreshPolicy=Ur(e,g),v&&i(A)&&(b.subscriptionLockup=A),v&&(h.isCrossfireReferralCandidate=!0),jn(e,b,h)
const S=(null===(c=m[m.length-1])||void 0===c?void 0:c.contentType)===ME
if(e.client.deviceType!==cW&&"tv"!==e.client.deviceType&&!S){const t=e.bag.termsAndConditionsURL
if(!r(t)){const n=fl(e,t)
m.push(n)}}if(m.length>0){const e=m[0].contentType===L$,t=m[0].contentType===uG,n=m[0].contentType===cj,r=m[0].contentType===M$;(e||t||n||r)&&b.presentationOptions.push(yN),r&&(b.presentationOptions.push(rM),b.presentationOptions.push(ob))}return Pp(b),b}(e,t,{isArcadePage:v(n,zW.isArcade)}))}shelfRoute(e){return[{protocol:OW,path:`/${xW.editorialPage}/${xW.shelf}/`,query:[`${zW.token}`]}]}generateShelfRequest(e,t,n){const r=n[zW.token],o=JSON.parse(decodeURIComponent(r)),i=s(o.remainingItems),a=!i&&(0,Wv.isSome)(o.recommendationsHref)&&o.recommendationsHref.length>0
if(i){const t=o.remainingItems,n=new dY(e,t,!0,[sV])
return Je(e,n,t),n}if(a){const t=new dY(e,o.recommendationsHref)
return oi(e)&&(t.enablingFeature(zH),t.includingMetaKeys(RB,[N$,hM]),t.includingScopedAttributes(iW,[Cq,oG,cB]),t.includingScopedRelationships(iW,[Jq])),si(e)&&(t.enablingFeature(DB),Ti(t)),t}return null}async renderShelf(e,t,n){var i
const a=n[zW.token],c=JSON.parse(decodeURIComponent(a)),l=s(c.remainingItems),u=!l&&(null===(i=c.recommendationsHref)||void 0===i?void 0:i.length)>0
if(c.isFirstRender=!1,l)c.remainingItems=this.buildHydratedShelfItems(e,c.remainingItems,t)
else if(u){c.data={...c.data,...yt(e,t)}
const n=we(c.data,uW)
c.remainingItems=s(n)?n:[],pw(e,c.data,c)}const d=Aw(e,void 0,c)
return o(d)&&!c.hasExistingContent?this.makeHiddenShelf():(function(e,t,n){if(!o(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])}(0,d,c),!c.hasExistingContent&&o(d.items)&&(d.isHidden=!0),d)}buildHydratedShelfItems(e,t,n){var r,o,i,s
const a=new Map,c=At(n)
for(const t of c)a[this.dataMapKey(e,t.type,t.id)]=t
const l=[]
for(const n of t){const t=a[this.dataMapKey(e,n.type,n.id)]
if((0,Wv.isSome)(t)){const c=kn(0,n)
if((0,Wv.isSome)(c)){const n=a[this.dataMapKey(e,sV,c.id)]
if((0,Wv.isSome)(n)){const e=null!==(r=t.meta)&&void 0!==r?r:{},a=null!==(o=y(e.associations))&&void 0!==o?o:{},c=null!==(i=y(a[sV]))&&void 0!==i?i:{},l=null!==(s=y(n))&&void 0!==s?s:{}
c.data=[l],a[sV]=c,e.associations=a,t.meta=e}}l.push(t)}}return l}dataMapKey(e,t,n){return`${t}_${n}`}makeHiddenShelf(){const e=new dJ(IN)
return e.isHidden=!0,e}}const i7="EditorialShelfCollectionPageIntent",{routes:s7,makeCanonicalUrl:a7}=uc(Sw,"/collections/{id}"),{routes:c7,makeCanonicalUrl:l7}=dc(Sw,"/{platform}/collections/{id}")
class u7 extends D2{constructor(){super("EditorialShelfCollectionPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){return function(e){const t=[$q,Oq,iH,aH,CV,vG,yU,AH]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH),t}(e)}pageType(){return wW}pageRoute(e){return[{protocol:EW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${zW.shelfId}}`},{protocol:EW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${zW.shelfId}}`},{protocol:EW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-collection/{${zW.shelfId}}`}]}generatePageRequest(e,t,n){if(o(n[zW.shelfId]))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new dY(e).forType("editorial-shelves-collection").attributingTo(t.build())}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([uW]).includingScopedRelationships(XH,[mU]).includingAssociateKeys(OB,[sV]),bw(e,t)}async renderPage(e,t,n,r,o,i){return await Va("renderEditorialShelfCollectionPage",async()=>function(e,t){const n=yt(e,t)
if(!s(n))return null
const r=Un(e,qH,n.id,t),o=Nr(t),i=(_n(0,n),hw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=[],c=(0,Wv.unwrapOptional)(Aw(e,void 0,i))
c.title=null,c.eyebrow=null,c.isHorizontal=!1
const l=j(n,oV)
if((0,Wv.isSome)(l)){const e=new dJ(aM)
let t
e.id=BE,t=new d5(null,l,j(n,iV)),e.items=[t],a.push(e)}a.push(c)
const u=new pJ(a)
return u.pageRefreshPolicy=Ur(e,o),jn(e,u,r),u}(e,t))}}class d7 extends D2{constructor(){super("EditorialShelfRecommendationPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[$q,Oq,iH,aH,CV,vG,yU,AH]
return e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),t}pageType(){return wW}pageRoute(e){return[{protocol:EW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${zW.shelfId}}`,query:[`${zW.editorialPageId}?`]},{protocol:EW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${zW.shelfId}}`,query:[`${zW.editorialPageId}?`]},{protocol:EW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-recommendation/{${zW.shelfId}}`,query:[`${zW.editorialPageId}?`]}]}generatePageRequest(e,t,n){const r=n[zW.shelfId],o=n[zW.editorialPageId]
if((0,Hv.isNothing)(r)||0===r.length||(0,Hv.isNothing)(o)||0===o.length)throw new Error(`Unable to map ${t.build()} to a media api url`)
const i=new dY(e,t.toString())
return i.addingQuery(zW.editorialPageId,o),i}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([uW]),bw(e,t)}async renderPage(e,t,n,r,o,i){return await Va("renderEditorialShelfRecommendationPage",async()=>{const n=yt(e,t)
if(!s(n))return null
const r=Un(e,qH,n.id,t),o=Nr(t),i=(_n(0,n),hw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=Aw(e,void 0,i)
let c
a.title=null,a.eyebrow=null,a.isHorizontal=!1,c=new d5(null,j(n,oV),j(n,iV))
const l=new dJ(aM)
l.id=BE,l.items=[c]
const u=new pJ([l,a])
return u.pageRefreshPolicy=Ur(e,o),jn(e,u,r),u})}}class f7{constructor(e){this.$kind="AppStoreEngagementTask",this.action=e}}class h7 extends CW{constructor(e,t){super(),this.$kind="EngagementToggleAction",this.actionClass="EngagementToggleAction",this.identifier=e,this.value=t}}class p7 extends CW{constructor(e,t){super(),this.$kind="TabBadgeAction",this.actionClass="TabBadgeAction",this.navigationTab=e,this.text=t}}const w7="com.apple.Arcade.ArcadeHardware1",g7="com.apple.Arcade.TrialEligible1",v7=[w7,g7]
class m7{constructor(){this.$intentKind="EngagementEventIntent"}async perform(e,t){return await Iw(t,e)}}class y7{constructor(){this.$intentKind="BadgingEventIntent"}async perform(e,t){return await Cw(t,e)}}class A7 extends R2{constructor(e,t){super("UserEngagementController"),t.exportingService("AppStoreEngagement",{fetchEngagementTask:async t=>await Iw(e,t),fetchBadgingTask:async t=>await Cw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class T7 extends l8{constructor(){super("GroupingPageBuilder")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[$q,iH,aH,yU]
return e.bag.enableUpdatedAgeRatings&&t.push(Eq),e.appleSilicon.isSupportEnabled&&t.push(kH),t}prepareRequest(e,t,n,r,o){if(function(e,t){t.includingAdditionalPlatforms(ee(e)),t.includingAgeRestrictions(),t.usingCustomAttributes(Ue(e)),t.includingMacOSCompatibleIOSAppsWhenSupported(),oi(e)&&(t.enablingFeature(zH),t.includingMetaKeys(RB,[N$,hM]),t.includingScopedAttributes(iW,YK),t.includingScopedRelationships(iW,[Jq])),Gi(e,Jj)&&Ai(t),ii(e)&&(t.enablingFeature(pM),yi(t)),si(e)&&(t.enablingFeature(DB),Ti(t)),t.enablingFeature("categoryHeaders"),t.enablingFeature(qE),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([Eq]),e.bag.enableFeaturedCategoriesOnGroupings&&t.enablingFeature(gb),e.bag.enableCategoryBricksOnGroupings&&t.enablingFeature("categoryBricks")}(e,t),n===_m.Page){const n=r.query.id
let o,i
const s=r.pathComponents();-1!==s.indexOf(wL)?o=n:-1!==s.indexOf(PH)?o=Ni(r):i=n,a(i)?t=t.withIdOfType(i,MV):a(o)&&(t=t.addingQuery(PH,o)),t.withSparseCount(Q(e)),t.includingScopedSparseLimit(RB,X(e))}const s=r.query[zW.context]||ne(e)
i(s)&&t.addingQuery(FG,s)
const c=r.query[zW.useReleaseId]
r.host===$W&&(null==c?void 0:c.length)>0&&(t.isStorePreviewRequest=!0,t=t.addingQuery(jC,c))}pageType(){return wW}pageRoute(e){return[{protocol:EW,path:`/${xW.store}/${xW.grouping}`,query:[zW.id,`${zW.context}?`]},{hostName:$W,path:`/WebObjects/{storePreviewInstance}/wa/${xW.grouping}`,query:[zW.id,`${zW.useReleaseId}?`]},{protocol:EW,path:`/{countryCode}/${xW.genre}/{genreName}/{id}`},{protocol:EW,path:`/{countryCode}/${xW.genre}/{id}`},{protocol:EW,path:`/{countryCode}/{platform}/${xW.grouping}/{id}`},{protocol:EW,path:`/${xW.store}/${xW.viewGenre}`,query:[zW.id]},{hostName:$W,path:`/WebObjects/{storePreviewInstance}/wa/${xW.viewGenre}`,query:[zW.id,`${zW.useReleaseId}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:EW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:EW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:EW,hostName:`${jW}`}]}generatePageRequest(e,t,n){var r
let o,s,c=t.query.id
if(t.host===jW&&(null===(r=e.bag.safariExtensionsGroupingURL)||void 0===r?void 0:r.length)>0){const n=az.from(e.bag.safariExtensionsGroupingURL)
i(n)&&(c=Ni(n),t.query.id=c)}const l=t.pathComponents()
if(-1!==l.indexOf(wL)?o=c:-1!==l.indexOf(PH)?o=Ni(t):s=c,!a(s)&&!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
const u=function(e){const t=[$q,Oq,iH,aH,CV,vG,yU]
e.appleSilicon.isSupportEnabled&&t.push(kH),e.bag.enableUpdatedAgeRatings&&t.push(Eq),nf(e)&&t.push(TH)
const n=new dY(e).forType(MV).includingAgeRestrictions().includingAttributes(t).includingRelationshipsForUpsell(!0)
return Gi(e,Jj)&&Ai(n),n}(e)
return u.attributingTo(t.build())}renderGroupingPage(e,t,n,o,i,s,a){return qv.context(Ab,()=>function(e,t,n){var o
n.pageGenreId=q(t.originalGroupingData,PH)||(r(o=j(t.originalGroupingData,"chartUrl"))?null:h(az.from(o).query,PH))
const i=function(e,t,n){let r=null
switch(n){case GK.Apps:r=e.host.clientIdentifier===oY?e.loc.string("GROUPING_APPS"):e.loc.string("GROUPING_APP_STORE","App Store")
break
case GK.Discover:r=e.loc.string("GROUPING_DISCOVER")
break
default:r=Hd(0,t)}return r}(e,t.originalGroupingData,n.pageGenreId)
if(n.pageTitle=i,cl(e,t,n),"tv"!==e.client.deviceType&&e.client.deviceType!==LV){const t=dl(e,n.metricsPageInformation,n.metricsLocationTracker)
t&&n.shelves.push(t)}if(e.client.deviceType!==cW&&"tv"!==e.client.deviceType){const t=e.bag.termsAndConditionsURL
if(!r(t)){const r=fl(e,t)
n.shelves.push(r)}}const s=new pJ(n.shelves)
switch(e.client.deviceType){case"tv":s.title=i
break
case cW:s.title=i,s.presentationOptions=[wM]
break
case LV:s.title=i,s.presentationOptions=[wM]
const e=s.shelves[0].contentType;[cj,vb,_B].includes(e)&&s.presentationOptions.push(yN)
break
default:s.title=i,s.presentationOptions=[wM]}return n.shelves[0].contentType===M$&&(s.presentationOptions.push(rM),s.presentationOptions.push(ob),s.presentationOptions.push(yN)),s.pageRefreshPolicy=Ur(e,null==n?void 0:n.refreshController),jn(e,s,n.metricsPageInformation),function(e,t,n){if(!(t.shelves.length<=0))switch(n){case GK.Apps:t.shelves.splice(0,0,hl(0,"appsPageHeader")),t.shelves.splice(6,0,hl(0,"appsPageMid")),t.shelves.push(hl(0,"appsPageFooter"))
break
case GK.Games:t.shelves.splice(0,0,hl(0,"gamesPageHeader")),t.shelves.splice(6,0,hl(0,"gamesPageMid")),t.shelves.push(hl(0,"gamesPageFooter"))}}(0,s,n.pageGenreId),Pp(s),s}(e,t,n))}}class b7 extends R2{constructor(){super(pP)}pageRoute(e){return[{protocol:OW,path:`${xW.onDeviceRecommendations}`,query:[zW.onDeviceRecommendationsUseCase,zW.token]}]}async handlePage(e,t,n,r,o){const i=n[zW.onDeviceRecommendationsUseCase]
return await hs(e,i,vW).then(r=>{const o=JSON.parse(n[zW.token]),i=new _2
i.title=o.title
const s=this.makePage(e,r.dataContainer,r.recoMetrics,i),a=new EY(wW,t.build())
return a.pageData=s,a})}makePage(e,t,n,r){const o=Ss(e)
r.url=this.paginationUrl,r.metricsPageInformation=Un(e,qH,"onDevicePersonalizationSeeAll",t),r.metricsPageInformation.recoMetricsData=yh(n,null,o),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const i=new dJ(O2),s={id:null,kind:null,softwareType:null,targetType:dq,title:r.title,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:wV,recoMetricsData:n}
Mh(e,i,s),bh(0,s,r.title),i.isHorizontal=!1,i.shouldFilterApps=r.shouldFilter
const a=At(t)
r.remainingContent=[],i.items=$d(e,a,{contentUnavailable:(e,t)=>(r.remainingContent=Ct(0,a,e),!0),lockupOptions:{metricsOptions:{pageInformation:s.pageInformation,locationTracker:s.locationTracker},clientIdentifierOverride:r.clientIdentifierOverride,artworkUseCase:Kd(0,i.contentType)}})
const c=new pJ([i])
return c.title=r.title,r.remainingContent.length&&(c.nextPage=r),jn(e,c,r.metricsPageInformation),c}async handleShelf(e,t,n,r){throw new Error(tk)}shelfRoute(e){return[]}pageType(){return wW}}class S7{constructor(){this.$intentKind="InAppPurchaseInstallPageIntent"}async perform(e,t){return await kw(t,e.url)}}class P7 extends R2{constructor(e,t){super("InAppPurchaseInstallController"),t.exportingService(nk,{fetchInstallPage:async t=>await kw(e,t.url)})}async handlePage(e,t,n,r,o){const i=n[zW.id],s=n[YW],a=new dY(e).withIdOfType(s,JH),c=await Ln(e,a,{}),l=function(e,t,n){const r={pageId:n||"",pageType:"IAPInstallPage",parentId:fh(t)}
return new nK(r)}(0,i,s),u=yt(e,c)
let d
const f={metricsOptions:{pageInformation:l,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:y6.LockupIconSmall}
s&&u&&(d=kd(e,u,f),d.theme=Gq)
const h=pe(e,u,Jq)
let p
i&&h&&(p=Cd(e,h,f))
const w=new DY
w.isComplete=!0,w.lockup=d,w.parentLockup=p
const g=wr(e,u)
return w.preInstallOfferDescription=qo(e,g),function(e,t,n){jn(e,t,n)}(e,w,l),R2.createFlowAction(w,lR,t)}pageRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.install}`,query:[`${zW.id}`,`${YW}?`]}]}pageType(){return lR}}class I7 extends R2{constructor(e,t){super("MetricsLinterController"),t.exportingService("Metrics",{async lintEvent(t){const n=hr(e).makeEvent(e,t.fields)
return await Promise.resolve(n)}})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class C7{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class k7{constructor(e,t){this.$kind="MSOAppsResponse",this.apps=e,this.appsToAlwaysShow=t}}class O7{constructor(){this.$intentKind="MSOProviderDataIntent"}async perform(e,t){return await Ow(t,e.providerAdamId)}}class E7{constructor(){this.$intentKind="MSOPageIntent"}async perform(e,t){return await Ew(t,e)}}class R7 extends R2{constructor(e,t){super("MSOBuilder"),t.exportingService("MSOData",{fetchProviderData:async t=>await Ow(e,t.providerAdamId),fetchPage:async t=>await Ew(e,t)})}async handlePage(e,t,n,r,o){const i=function(e){const t=e[ez]
return t?t.split(","):[]}(n),s=function(e,t){return Rw(e,Ni(t))}(e,t.removeParam(ez)),a=Dw(e,await Ln(e,s),i)
return R2.createFlowAction(a,ON,t)}pageRoute(e){return[{protocol:EW,path:`/{countryCode}/${xW.mso}/{appName}/{id}`,query:[`${ez}?`]},{protocol:EW,path:`/${xW.mso}/{providerName}/{id}`,query:[`${ez}?`]},{protocol:EW,path:`/{countryCode}/${xW.mso}/{id}`,query:[`${ez}?`]},{protocol:EW,path:`/${xW.mso}/{id}`,query:[`${ez}?`]},{protocol:EW,path:`/${xW.mso}`,query:[zW.id,`${ez}?`]},{protocol:EW,path:`{countryCode}/${xW.mso}`,query:[zW.id,`${ez}?`]}]}async handleShelf(e,t,n,r){const o=n[aV],i=JSON.parse(o),s=new dY(e,i.remainingContent).includingAdditionalPlatforms(ee(e)).includingAttributes([$q,Oq,IH])
return function(e,t,n){const r=At(t),o=n
o.remainingContent=[]
const i={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},artworkUseCase:Kd(0,n.preferredShelfContentType)},contentUnavailable:function(e,t){return o.remainingContent=Ct(0,o.remainingContent,e),o.remainingContent.push(r[e]),!1}},s=new dJ(n.preferredShelfContentType)
return s.shouldFilterApps=n.shouldFilter,s.items=$d(e,r,i),s.mergeWhenFetched=!0,s.url=_w(o),s}(e,await Ln(e,s),i)}shelfRoute(e){return[{protocol:OW,path:`/${xW.mso}/${xW.shelf}/{token}`}]}pageType(){return ON}}class D7{constructor(){this.$intentKind="CancelPreorderIntent"}async perform(e,t){return await Lw(t,e)}}class _7 extends R2{constructor(e,t){super("CancelPreorderController"),t.exportingService("Preorder",{cancelPreorder:async t=>await Lw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class L7 extends D2{constructor(){super("AccessibilityDetailsBuilder")}defaultPlatforms(e){return[]}pageType(){return vB}pageRoute(e){return[{protocol:OW,path:`${xW.accessibilityDetails}/${xW.product}/{id}`,query:[`${zW.deviceFamily}`]},{protocol:OW,path:`${xW.accessibilityDetails}/${xW.productBundle}/{id}`,query:[`${zW.deviceFamily}`]}]}generatePageRequest(e,t,n){const r=Ni(t)
if((0,Wv.isNothing)(r)||Si(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
const o=function(e){switch(e[zW.deviceFamily]){case _q:return _q
case Dq:return Dq
case lW:return lW
case QG:return ZB
case XV:return XV
case cW:return cW
default:return null}}(n)
if((0,Wv.isNothing)(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing required platform.`)
let i=dW;(0,Wv.isSome)(t.pathname)&&-1!==t.pathname.indexOf(xW.productBundle)&&(i=Zq)
const s=new dY(e).withIdOfType(r,i).includingAttributes([vB,sH])
return s.platform=o,s}async renderPage(e,t,n,r){return await Va(_j,async()=>{const r=yt(e,t)
if((0,Wv.isNothing)(r))return null
const o=n[zW.deviceFamily]
if((0,Wv.isNothing)(o))return null
const i=Un(e,"AppAccessibilityDetails",r.id,t),s={rootPosition:0,locationStack:[]},a=[]
{const t=Rl(e,r,o,!0,null,i,s)
a.push(t)
const n=_l(e,r,!0,i,s);(0,Wv.isSome)(n)&&a.push(n)
const c=Dl(e,r,o,!0,null,i,s);(0,Wv.isSome)(c)&&a.push(c)}const c=new pJ(a)
return c.title=e.loc.string(DD),c.presentationOptions=[sj,Ax,nI],jn(e,c,i),c})}}class M7 extends D2{constructor(){super("EulaBuilder")}defaultPlatforms(e){return ee(e)}generatePageRequest(e,t,n){const o=t.query.resourceId,i=t.query.resourceType
if(r(o)||r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
const s=new dY(e).withIdOfType(o,YU)
return s.targetResourceType=i,s}pageRoute(e){return[{protocol:OW,path:`${xW.eula}`}]}pageType(){return wW}async renderPage(e,t,n,r){return await Va(_j,async()=>{const n=f(t,"results.eula.text").split(/\n{1,2}/),r=[]
for(const e of n){const t=new FX(e)
t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,r.push(t)}const o=new dJ(Nj)
o.isHorizontal=!1,o.items=r
const i=new pJ([o])
return i.title=e.loc.string(TF),i})}}class x7 extends R2{constructor(){super("PersonalizedReviewsBuilder")}async handlePage(e,t,n,r,o){throw new Error("PersonalizedReviewsBuilder:handlePage not implemented")}pageRoute(e){return[]}async handleShelf(e,t,n,r){const o=n[aV],i=JSON.parse(o),s=new dY(e).withIdOfType(i.adamId,Fq)
try{const t=await Ln(e,s)
return ka(e,e.client.guid,i,t)}catch{return ka(e,e.client.guid,i)}}shelfRoute(e){return[{protocol:OW,path:`/${xW.personalizedReviews}/${xW.shelf}/{token}`}]}pageType(){return qq}}class $7 extends D2{constructor(){super("PrivacyDetailBuilder")}defaultPlatforms(e){return ee(e)}pageType(){return dD}pageRoute(e){return[{protocol:OW,path:`${xW.privacyDetail}/${xW.product}/{id}`,query:[`${zW.privacyTypeId}?`]},{protocol:OW,path:`${xW.privacyDetail}/${xW.productBundle}/{id}`,query:[`${zW.privacyTypeId}?`]}]}generatePageRequest(e,t,n){const r=Ni(t)
if((0,Wv.isNothing)(r)||0===r.length)throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
let o=dW
const i=[C$,sH,nN]
return-1!==t.pathname.indexOf(xW.productBundle)&&(o=Zq),new dY(e).withIdOfType(r,o).addingQuery(Zx,i.join(","))}async renderPage(e,t,n,s){return await Va(_j,async()=>{const s=n[zW.privacyTypeId]
return function(e,t,n){return qv.context("privacyDetailPageFromResponse",()=>{const s=yt(e,t)
if(o(s))return null
const a=Un(e,"PrivacyDetails",s.id,t),c={rootPosition:0,locationStack:[]}
let l=[]
if(!Tl(e)){const t=function(e,t,n,r){const o=new dJ(cq)
o.isHorizontal=!1
const i=bl(e,t,!0,!0,n,r)
return o.items=[i],o.presentationHints={isFirstShelf:!0},o}(e,s,a,c)
i(t)&&l.push(t)}const u=function(e,t,n,s,a){const c=B(t,C$)
if(o(c))return[]
const l=pl(e,c,t,pj,!0,n,s)
if(0===l.length)return[]
const u=[]
for(const t of l)if(r(a)||t.identifier===a||e.client.deviceType!==cW){const e=new dJ(lx)
i(t.identifier)&&t.identifier===a?(t.wantsScrollFocus=!0,e.id="privacyTypeShelf_"+t.identifier):t.wantsScrollFocus=!1,e.items=[t],e.presentationHints={isSingleDensity:!0},u.push(e)
for(const e of t.purposes){const t=new dJ("privacyCategory")
t.title=e.title,t.items=e.categories,u.push(t)}}return u}(e,s,a,c,n)
l=l.concat(u)
const d=new pJ(l)
d.title=e.loc.string(cx)
for(const e of u)if((0,Wv.isSome)(e.id)){d.loadCompletedAction=new cJ(e.id)
break}return jn(e,d,a),d})}(e,t,s)})}}class F7 extends R2{constructor(){super("ProductInAppPurchaseBuilder")}async handlePage(e,t,n,r,o){const i=n[JW],s=Bi(e,new az(i)),a={},c=n[KW]===pq
a.spotlightSection=Fa(c),a.spotlightInAppProductIdentifier=n[zW.offerName]
const l=await Ln(e,s),u=await ed(e,l,a)
return R2.createFlowAction(u,yH,t)}pageRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.lookup}`,query:[JW,zW.offerName,KW]}]}pageType(){return yH}}class N7{constructor(){this.$intentKind="ShelfBasedProductPageIntent"}async perform(e,t){return await Mw(t,e)}}class B7 extends D2{constructor(e,t){super(qA),t.exportingService(nk,{fetchPage:async t=>await async function(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(rk))
if(0!==Mn(e,new az(t.url)).length&&tp(e,t.url),t.preloading){const e=new az(t.url)
e.param(zW.isPreloading,pq),t.url=e.build()}const n=B7.generateProductPageOptions(e,void 0,new az(t.url)),r=e.required(y3).fetchPage(e,t.url,oJ)
if(!r){const r=new dY(e,t.url),o=await Ln(e,r)
return await ed(e,o,n,{},null,t.preloading)}return await r.then(n=>(e.host.clientIdentifier===lY?n&&wB in n&&zn(0,n):i(t.referrerData)&&n&&wB in n&&zn(0,n),n))}(e,t),fetchShelfBasedPage:async t=>await Mw(e,t)})}defaultPlatforms(e){return ee(e)}pageType(){return yH}defaultTab(e){return B7.representsArcadeApp(e)?sW:super.defaultTab(e)}defaultAction(e,t,n,r){if(ht(t))return t
const o=super.defaultAction(e,t,n,r)
if(!vt(t)&&!mt(t))return o
const i=1===t.appPlatforms.length&&"tv"===t.appPlatforms[0]
if(n[zW.action]!==p3||i){if(n[zW.action]!==w3||i)return o
{const e=t.shelfMapping[Fq]||t.shelfMapping[EH]
let n=null
return e&&e.seeAllAction&&(n=e.seeAllAction,n.animationBehavior=rH),o.animationBehavior=rH,new ZJ([o,n])}}{const n=B7.representsBundle(t)
let r=null,i=null,s=null,a=null
vt(t)?(r=t.adamId,i=t.icon,s=t.title,a=t.subtitle):mt(t)&&(r=t.lockup.adamId,i=t.lockup.icon,s=t.lockup.title,a=t.lockup.subtitle)
const c=Pa(e,r,n,i,!1,a,s)
return o.animationBehavior=rH,new ZJ([o,c])}}static generateProductPageOptions(e,t,n){const r={clientIdentifierOverride:n.query[zW.clientIdentifierOverride]},o=null==t?void 0:t[zW.offerName]
if(o){const e=t[KW]===pq
r.spotlightSection=Fa(e),r.spotlightInAppProductIdentifier=o}const s=n.query[XJ]
s&&(r.iAdClickFields=JSON.parse(s))
const a=n.query[eK]
a&&(r.iAdLineItem=a)
const c=n.query[tK];(0,Hv.isSome)(c)&&(r.iAdDismissAdActionMetrics=JSON.parse(c))
const l=n.query[X0]
i(l)&&(r.externalDeepLinkUrl=l)
const u=n.query[e1]
i(u)&&(r.isCppDeepLinkDisabled=JSON.parse(u))
const d=null==t?void 0:t[zW.webBrowser];(0,Hv.isSome)(d)&&(r.webBrowser="1"===d)
const f=null==t?void 0:t[zW.webBrowserFlowType]
return(0,Hv.isSome)(f)&&(r.webBrowserFlowType=f),e.client.isCompanionVisionApp&&(r.clientIdentifierOverride=Mz),r}pageRoute(e){return Zh()}generatePageRequest(e,t,n){var o
const i=n[zW.bundleIdentifier],s=n[zW.ids],a=n[zW.productVariantID],c="1"===n[zW.includeUnlistedApps]||"1"===n[zW.isViewOnly]
let l=null
if(i){const t=st(e).adamIdFromSystemBundleId(i)
l=(0,Hv.isSome)(t)?Ui(e,t,!1,void 0,!1,c):function(e,t,n,r){const o=ZX
e.bag.enablePrivacyNutritionLabels&&!xi(e,t)&&o.push(S$),Ci(e)&&!Oi(e,t)&&o.push(P$),e.appleSilicon.isSupportEnabled&&o.push(kH),e.bag.enableUpdatedAgeRatings&&o.push(Eq),nf(e)&&o.push(TH),e.bag.enableLicenses&&o.push(tE)
const i=new dY(e).forType(dW).withFilter(yq,t).includingAdditionalPlatforms(ee(e)).includingRelationships([$H,OG,$F,Fq,Zq,b$,T$]).includingAttributes(o).addingRelationshipLimit(Fq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Wv.isSome)(n)&&i.addingQuery(zW.productVariantID,n),Kt(e,KH)&&i.enablingFeature(GL),r&&i.enablingFeature(UL),ii(e)?i.includingViews([QO]):i.includingRelationships([jL]),i}(e,i,a,c)}else if(n[zW.action]===ok&&s){const r=(null===(o=t.pathname)||void 0===o?void 0:o.length)>0&&-1!==t.pathname.indexOf(ik)
l=Ui(e,s,v(n,zW.isPurchasesApp),a,r,c)}else l=Bi(e,t,c)
if(r(l))throw new Error(`Unable to map ${t.build()} to a media api url`)
return l}generateAdditionalPageRequirements(e,t,n){const r=super.generateAdditionalPageRequirements(e,t,n),o=function(e){for(const[t,n]of Object.entries(e))if(t.toLocaleLowerCase()===zW.appEventId.toLocaleLowerCase())return n
return null}(n),i=n[zW.offerItemId]
if((null==o?void 0:o.length)>0&&oi(e)){const t=new dY(e).withIdOfType(o,iW).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(iW,YK).includingScopedAvailableIn(iW,[IO,sE])
r[g3]=D(Ln(e,t))}else if(s(i)&&si(e)){const t=new dY(e).withIdOfType(i,VV).includingAdditionalPlatforms(ee(e))
Ti(t),r[g3]=D(Ln(e,t))}return r}async renderPage(e,t,n,r,o,i){return await Va(_j,async()=>{const o=Un(e,_V,"",t),a=B7.generateProductPageOptions(e,n,new az(o.pageUrl)),c=yt(e,t),l=B7.alternativeAppForPlatform(e,c,rt(e))
if(null!==l)return l
const u="1"===n[zW.isViewOnly]
s(i)&&yW.shared.setReferralDataForProduct(c.id,i)
const d=await ed(e,t,a,r,i,v(n[zW.isPreloading]),u),f=e.fetchTimingMetricsBuilder
return(0,Hv.isSome)(f)&&f.decorate(d),d})}shelfRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.shelf}/{token}`}]}generateShelfRequest(e,t,n){return Qh(e,0,n)}async renderShelf(e,t,n){return await Xh(e,t,n)}shelfRequiresAdditionalModification(e,t){return!0}async performAdditionalShelfModifications(e,t,n){const r=n[aV],o=v3.fromJSON(e,r)
return new Set([EV,CU,dF]).has(t.contentType)&&0===t.items.length&&!o.isFirstRender&&(t.isHidden=!0),t}async handleShelfError(e,t){const n=t[aV],r=v3.fromJSON(null,n)
if(r&&!r.hasExistingContent){const e=new dJ(r.contentType)
return e.isHidden=!0,e}return await super.handleShelfError(e,t)}static alternativeAppForPlatform(e,t,n){if(!ie(t,n)){const r=we(t,T$)
if(s(r))for(const t of r){const r=Qe(e,t,Wq)
if(ie(t,n)&&(null==r?void 0:r.length)>0)return new EY(qq,r)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Zj in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[Zj]===VM}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Zj in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[BN]===vq}}class U7{constructor(e,t,n,r,o,i){this.$kind="GameCenterPlayerGameAchievementSummary",this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.completedText=r,this.action=o,this.achievements=i}}class G7 extends R2{async handlePage(e,t,n,r,o){throw new Error(`handlePage is not supported on: ${this.builderClass}`)}async renderPage(e,t,n){throw new Error(`renderPage is not supported on: ${this.builderClass}`)}async handleShelf(e,t,n,r){const o=await M(this.renderShelf(e,t,n))
return o.success?o.value:await this.handleShelfError(o.error,n)}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async handleShelfError(e,t){throw e}}class j7 extends G7{constructor(){super("ProductBuilderNative")}pageType(){return yH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.shelf}`,query:[zW.isGameCenterPlayerShelf,zW.token]},{protocol:OW,path:`/${xW.product}/${xW.shelf}`,query:[zW.isGameCenterPlayerRibbonItem]},{protocol:OW,path:`/${xW.product}/${xW.shelf}`,query:[zW.isGameCenterAchievementsShelf,zW.token]}]}async renderShelf(e,t,n){if(t.query[zW.isGameCenterPlayerShelf]){const r=t.query[zW.id],o=await e.gameCenter.fetchFriendsThatPlayGame(r),i=n[zW.token]
return bu(e,o,!0,v3.fromJSON(e,i))}if(t.query[zW.isGameCenterPlayerRibbonItem]){const n=t.query[zW.id],r=await e.gameCenter.fetchFriendsThatPlayGame(n)
return bu(e,r,!1)}if(t.query[zW.isGameCenterAchievementsShelf]){const r=t.query[zW.bundleId],o=await e.gameCenter.fetchAchievementSummaryForGame(r),i=n[zW.token],s=v3.fromJSON(e,i)
let a=null
if(o.length>0){const t=ro({objectGraph:e,target:{achievements:{bundleID:r}},metricsPageInformation:s.sourcePageInformation,metricsLocationTracker:s.sourceLocationTracker}),n=e.loc.string("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed"),i=o[0].achievements
let c=null
const l=i.filter(e=>e.status.type===RV)
if(l.length>0&&(c=l[0]),null===c){const e=i.filter(e=>e.status.type===Rb||e.status.type===bM)
e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(c=e[0])}null!==c&&(a=new U7(o[0].bundleId,o[0].completedAchievements,o[0].totalAchievements,n,t,[c]))}const c=function(e,t,n){const r=new dJ(cI)
if(r.isHorizontal=!0,t){const o={pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:Hq,title:gj,id:"achievements_summary",idType:Sq,softwareType:null,targetType:Hq,badges:{gameCenter:!0}}
Mh(e,r,o),Qs(e,t.action,o),r.items=[t]}return r.mergeWhenFetched=!0,r.batchGroup=OV,r.isHidden=0===r.items.length,r}(e,a,s)
return c}return await super.renderShelf(e,t,n)}}const V7="todayTabPersonalization",H7="OnDeviceRecommendationsTodayShelfController"
class q7{constructor(e){this.recommendations=e}storyData(e){var t
const n=this.recommendationForUseCase(e),r=null==n?void 0:n.candidate(Xq)
if(!(0,Hv.isNothing)(n)&&!(0,Hv.isNothing)(r))return null===(t=null==n?void 0:n.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===r.id)}storyGroupData(e){var t,n
const r=this.recommendationForUseCase(e),o=null==r?void 0:r.candidate(Dj)
if((0,Hv.isNothing)(r)||(0,Hv.isNothing)(o))return
const i=null===(t=null==r?void 0:r.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===(null==o?void 0:o.id)),s=null===(n=null==r?void 0:r.dataContainer)||void 0===n?void 0:n.data.filter(e=>o.candidateIDs.includes(e.id))
return(0,Hv.isNothing)(i)||(0,Hv.isNothing)(s)?void 0:(i[vV]={associations:{recommendations:{data:s}}},i)}recommendationForUseCase(e){return this.recommendations.find(t=>t.useCase===e)}}class W7{constructor(e,t,n,r){this.useCase=e,this.candidates=t,this.recoMetrics=n,this.dataContainer=r}candidate(e){return this.candidates.find(t=>t.type===e)}}class z7{constructor(e,t,n,r){this.id=e,this.type=t,this.candidateIDs=n,this.data=r}}class Y7 extends G7{constructor(){super("ProductPageShelfWithAdController")}pageType(){return yH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.shelf}/{token}`,query:[zW.isShelfWithAd,zW.shelfWithAdPlacementType]}]}async renderShelf(e,t,n){const r=n[zW.shelfWithAdPlacementType],o=t.query[zW.id],i=xw(e,r,o).catch(()=>null),s=Qh(e,0,n)
s.attributingTo(t.build())
const a=Ln(e,s)
return await Promise.all([a,i]).then(async([t,r])=>await Xh(e,t,n,r,!0))}}class J7 extends G7{constructor(){super("ProductPageSimilarItemsShelfRefreshController")}pageType(){return yH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:OW,path:`/${xW.product}/${xW.shelf}/{token}`,query:[`${zW.shelfRefreshType}=${rz}`]}]}async renderShelf(e,t,n){const r=t.query[zW.id]
let o=Promise.resolve(null),i=!1
i=Kt(e,wH),i&&(o=xw(e,wH,r).catch(()=>null))
const s=function(e,t){const n=[$q,Oq,IH]
return e.bag.enableUpdatedAgeRatings&&n.push(Eq),nf(e)&&n.push(TH),new dY(e).withIdOfType(t,$x).enablingFeature(vV).includingAdditionalPlatforms(ee(e)).includingAttributes(n).enablingFeature(GL)}(e,r)
s.attributingTo(t.build())
const a=Ln(e,s).catch(async()=>{const r=Qh(e,0,n)
return r.attributingTo(t.build()),await Ln(e,r)})
return await Promise.all([a,o]).then(async([t,r])=>await Xh(e,t,n,r,i))}}class K7 extends R2{constructor(){super("ReviewsAdapterBuilder")}async handlePage(e,t,n,r,o){const i=Bi(e,t),s=await Ln(e,i),a=await ed(e,s)
let c,l
if(Xu(e)){const e=a
c=e.shelfMapping[EH],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}else{const e=a
c=e.shelfMapping[Fq],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}const u=R2.createFlowAction(a,yH,t)
let d=null
return c&&c.seeAllAction&&!l&&(d=c.seeAllAction,d.animationBehavior=rH),d?(u.animationBehavior=rH,new ZJ([u,d])):u}pageRoute(e){return[{protocol:EW,path:`/{countryCode}/${xW.product}/{appName}/{id}`,hash:nz},{protocol:EW,path:`/${xW.store}/${xW.viewReviews}`,query:[zW.id]}]}async handlePagination(e,t,n,r,o){const i=n[QW],s=n[XW],a=l(o.remainingContent),c=new dY(e,o.nextHref).includingAdditionalPlatforms(ee(e)).addingQuery(JV,s),u=await Ln(e,c,{})
return _a(e,e.client.guid,i,a,u,!1,s)}paginationRoute(e){return[{protocol:OW,path:`/${xW.reviews}/${xW.shelf}/{adamId}/{sort}`}]}pageType(){return yH}}class Z7 extends R2{constructor(){super("SortedReviewsBuilder")}async handlePage(e,t,n,r,o){const a=n[QW],c=n[XW],l=new dY(e).withIdOfType(a,Fx).includingAdditionalPlatforms(ee(e)).addingQuery(JV,c),u=await Ln(e,l,{}),d=n[zW.token]
let f=null
if(s(d))try{f=JSON.parse(d)}catch(e){}const h=_a(e,e.client.guid,a,[],u,!0,c,f)
return i(null==f?void 0:f.reviewActionsShelf)&&h.shelves.unshift(f.reviewActionsShelf),i(null==f?void 0:f.reviewSummaryShelf)&&h.shelves.unshift(f.reviewSummaryShelf),i(null==f?void 0:f.ratingsShelf)&&h.shelves.unshift(f.ratingsShelf),R2.createFlowAction(h,Fq,t)}pageRoute(e){return[{protocol:OW,path:`/${xW.reviews}/{adamId}/{sort}`,query:[`${zW.token}?`]}]}pageType(){return Fq}}class Q7 extends M2{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t,n){return Vn(0,"accessory")}generatePageRequest(e,t,n){const r=[]
for(const e of Object.keys(t.query))e.startsWith("id")&&r.push(t.query[e])
return this.requestWithFilter(e,"deviceProtocol",r.join(","))}pageRoute(e){return[{query:[`${zW.action}=accessoryLookup`]}]}}class X7 extends R2{constructor(){super("CollectionDeepLinkingController")}pageType(){return wW}pageRoute(e){return[{protocol:EW,path:"{countryCode}/{tab}/recommendations",query:[`${zW.useCaseShort}`,`${zW.collectionId}?`,`${zW.seedId}?`]}]}async handlePage(e,t,n,r,o){const i=n[xW.tab],s=n[zW.useCaseShort],a=n[zW.collectionId],c=n[zW.seedId]
let l=new dY(e).forType(RL).addingQuery(fW,i).addingQuery("filter[recoUseCase]",s).includingRelationships([uW]).includingAdditionalPlatforms(ee(e))
l.enablingFeature(qE),(null==a?void 0:a.length)>0&&(l=l.addingQuery(BV,a)),(null==c?void 0:c.length)>0&&(l=l.addingQuery(kA,c))
const u=await M(Ln(e,l))
if(!u.success)throw new Error(`CollectionDeeplinkingController: Failed to fetch Media API data for useCase: ${s}`)
const d=u.value,f=j(yt(e,d),H$),h=await((null==f?void 0:f.length)>0?this.makeODPPage(e,s,f,d):this.makeCollectionPage(e,s,d))
let p
const w=this.createTabChangeActionForRequest(i),g=new EY(wW,t.build())
return g.pageData=h,null!=w?(w.actions=[g],p=w):p=g,p}async makeODPPage(e,t,n,r){const o=new Promise((o,i)=>{hs(e,n,wW).then(n=>{const i=yt(e,r),s=new _2
s.title=j(i,Nq),s.metricsPageInformation=Un(e,qH,t,r),s.metricsPageInformation.recoMetricsData=yh(St(r),null,n.recoMetrics),s.shouldFilter=!1,s.metricsLocationTracker={rootPosition:0,locationStack:[]}
const a=this.makePage(e,s,n.dataContainer)
o(a)}).catch(e=>{i(e)})})
return await o}async makeCollectionPage(e,t,n){const r=yt(e,n),o=fe(r,uW),i=new _2
return i.url=this.paginationUrl,i.title=j(r,Nq),i.metricsPageInformation=Un(e,qH,t,n),i.metricsPageInformation.recoMetricsData=St(n),i.shouldFilter=!1,i.metricsLocationTracker={rootPosition:0,locationStack:[]},await Promise.resolve(this.makePage(e,i,o))}makePage(e,t,n){return qv.context("makePage",()=>{const r=t.preferredShelfContentType||O2,o=new dJ(r),i={id:null,kind:null,softwareType:null,targetType:dq,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:wV,recoMetricsData:St(n)}
Mh(e,o,i),bh(0,i,t.title),o.isHorizontal=!1,o.shouldFilterApps=t.shouldFilter
const s=At(n)
t.remainingContent=[],o.items=$d(e,s,{contentUnavailable:(e,n)=>(t.remainingContent=Ct(0,s,e),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:Kd(0,r)}})
const a=new pJ([o])
return a.title=t.title,t.remainingContent.length&&(a.nextPage=t),a})}createTabChangeActionForRequest(e){const t=e
return new Set([zq,dW,QH,bq,uL,sW,kG,hj,OF,EF,RF,nB,pH,zU]).has(t)?new IX(t):null}async handleShelf(e,t,n,r){throw new Error(tk)}shelfRoute(e){return[]}paginationRoute(e){return[{protocol:OW,path:`${this.paginationPath}`}]}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>{const n=o,r=new dY(e,n.remainingContent)
if(!r)throw new Error(`Could not construct media API request for: ${t}`)
r.includingAdditionalPlatforms(ee(e))
const i=[$q,Oq,iH,aH]
e.appleSilicon.isSupportEnabled&&i.push(kH),e.bag.enableUpdatedAgeRatings&&i.push(Eq),nf(e)&&i.push(TH),r.includingAttributes(i),r.usingCustomAttributes(Ue(e)),r.attributingTo(t.build())
const s=await Ln(e,r)
return this.makePage(e,n,s)})}}class eee extends L2{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t,n){const r=Ni(t),o=n[zW.grouping]
if(!this.isValidId(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
if(!this.isValidId(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing grouping.`)
return new dY(e).withIdOfType(r,A$).addingQuery(Jj,o).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}async renderPage(e,t,n){return await Va(_j,async()=>{const r=yt(e,t),o=fe(r,uW),i=n[zW.grouping],s=Un(e,qH,`${r.id}-${i}`,t),a=new _2
a.remainingContent=o.data,a.url=this.paginationUrl,a.shouldFilter=!H(r,V$),a.metricsPageInformation=s,a.metricsLocationTracker={rootPosition:0,locationStack:[]},a.title=j(r,fW)
const c=await this.pageWithContent(e,o,a)
return c.title=a.title,jn(e,c,s),c})}pageRoute(e){return[{protocol:EW,path:`/{countryCode}/${xW.appsForYou}/{title}/{id}`,query:[zW.grouping]},{protocol:EW,path:`/{countryCode}/${xW.appsForYou}/{id}`,query:[zW.grouping]},{protocol:EW,path:`/${xW.appsForYou}/{title}/{id}`,query:[zW.grouping]},{protocol:EW,path:`/${xW.appsForYou}/{id}`,query:[zW.grouping]}]}isValidId(e){return!(r(e)||isNaN(e))}}class tee extends L2{constructor(){super("RoomBuilder")}generatePageRequest(e,t,n){let r=t.query[zW.featuredContentId]
if(this.isValidRoomId(r)||(r=n.id),!this.isValidRoomId(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return new dY(e).withIdOfType(t,qN).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,r)}prepareRequest(e,t,n,r,o){!function(e,t){t.includingAdditionalPlatforms(ee(e)).includingAttributes(rc(e)).usingCustomAttributes(Ue(e)).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,t)}async renderPage(e,t,n,r){return await Va(_j,async()=>{const n=yt(e,t),r=fe(n,uW),o=Un(e,qH,n.id,t),i=new _2
i.remainingContent=r.data,i.url=this.paginationUrl,i.shouldFilter=!H(n,V$),i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=j(n,zj)
var a
i.preferredShelfContentType=null==(a=Number(s))?null:a===A0?PM:null,i.clientIdentifierOverride=Fr(e,n),i.title=j(n,Nq)
const c=await this.pageWithContent(e,r,i)
return c.title=i.title,jn(e,c,o),c})}pageRoute(e){return[{protocol:EW,path:`/${xW.store}/${xW.room}`,query:[zW.featuredContentId]},{protocol:EW,path:`/${xW.storeElements}/${xW.recommendationsSeeAll}`},{protocol:EW,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:EW,path:"/{countryCode}/collection/today-view-widgets",query:[zW.featuredContentId]},{protocol:EW,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return a(e)}}!function(e){e[e.Default=0]="Default",e[e.CategoriesAndCharts=1]="CategoriesAndCharts"}(qm||(qm={}))
class nee{constructor(e,t,n,r,o,i,s=null,a){this.id=e,this.title=t,this.searchLandingItemDisplayStyle=s,this.displayStyle=n,this.displayCount=r,this.hasSeeAll=o,this.seeAllLink=i,this.searchShelfKind=a}}!function(e){e[e.Landing=0]="Landing",e[e.Results=1]="Results",e[e.ChartsAndCategories=2]="ChartsAndCategories",e[e.Focus=3]="Focus"}(Wm||(Wm={})),function(e){e.Suggestion="Query",e.CategoriesAndCharts="EditorialLink",e.Apps="AppsLockup",e.EditorialCollection="EditorialCollection"}(zm||(zm={}))
class ree{constructor(){this.$kind="PageTab"}}class oee extends CW{constructor(e,t,n){super(),this.$kind="PageTabChangeAction",this.actionClass="PageTabChangeAction",this.selectedTabId=e,this.title=t}}class iee extends sJ{constructor(){super(...arguments),this.$kind="SearchChartsAndCategoriesPage"}}class see{constructor(){this.$kind="PageTabs",this.id=random.nextUUID()}}class aee{constructor(e,t,n,r,o,i,s,a,c){this.$kind="SearchChartOrCategory",this.title=e,this.artwork=t,this.collectionIcons=n,this.backgroundColor=r,this.badge=o,this.action=i,this.density=s,this.artworkSafeArea=a,this.textSafeArea=c}}class cee{constructor(){this.$intentKind="SearchChartsAndCategoriesPageIntent"}async perform(e,t){return await Ww(e,t)}}class lee extends R2{constructor(e,t){super("SearchChartsAndCategoriesPageBuilder"),t.exportingService(LF,{fetchSearchChartsAndCategoriesPage:async t=>await Ww(t,e)})}pageType(){return a_}pageRoute(e){return[{path:"/{apiVersion}/recommendations/{countryCode}/search-recommendations/{search-recommendations-id}"}]}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{const n=new dY(e,t.toString()).forType(Nx).includingAgeRestrictions().includingScopedRelationships(sk,[uW]).enablingFeature(vV).enablingFeature(MF).addingQuery(zW.name,KF)
Gi(e,kx)&&Ai(n)
const r=await this.fetchCategoriesAndChartsPage(e,n)
return R2.createFlowAction(r,this.pageType(),t)})}async fetchCategoriesAndChartsPage(e,t){const n=Ln(e,t)
return await n.then(t=>jw(e,t))}}class uee extends CW{constructor(e,t){super(),this.$kind="GuidedSearchTokenToggleAction",this.actionClass="GuidedSearchTokenToggleAction",this.targetToken=e,this.searchOrigin=t}}class dee{constructor(e,t,n,r,o){this.$kind="GuidedSearchToken",this.value=e,this.isSelected=t,this.leadingIcon=n,this.displayName=r,this.clickAction=o}}class fee{constructor(e,t,n){this.$kind="GuidedSearchQuery",this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class hee extends CW{constructor(e,t){super(),this.$kind="SearchEntityChangeAction",this.actionClass="SearchEntityChangeAction",this.entity=e,this.searchOrigin=t}}class pee{constructor(e,t){this.$kind="SearchFacetSet",this.type=e,this.values=t}}class wee{constructor(e,t,n=null){this.$kind="SearchFacetValue",this.name=e,this.value=t,this.isSelected=t===n}}const gee={AdvertsSearchResult:"AdvertsSearchResult",AppEventSearchResult:iy,AppSearchResult:sy,BundleSearchResult:"BundleSearchResult",EditorialSearchResult:py,GuidedSearchResult:"GuidedSearchResult",InAppPurchaseSearchResult:"InAppPurchaseSearchResult",SearchLockupCollection:"SearchLockupCollection"}
class vee{constructor(e){this.impressionMetrics=null,this.resultType=e,this.clickAction=void 0}}class mee extends vee{constructor(e,t){super(Vx),this.$kind="GuidedSearchResult",this.title=e,this.tokens=t}}class yee extends vee{constructor(e,t,n,r,o){super("lockupCollection"),this.$kind="SearchLockupCollection",this.heading=e,this.headingArtwork=o,this.title=t,this.items=n,this.detailAction=r}}const Aee=0,Tee=1
class bee extends vee{constructor(e){super(KU),this.$kind="InAppPurchaseSearchResult",this.lockup=e}}class See extends vee{constructor(e){super(Wk),this.$kind="BundleSearchResult",this.lockup=e}}class Pee extends vee{constructor(e){super("content"),this.$kind="AppSearchResult",this.lockup=e}}class Iee extends vee{constructor(e){super(Yk),this.$kind="EditorialSearchResult",this.title=e}}class Cee extends vee{constructor(){super(KN),this.$kind="AppEventSearchResult"}}class kee extends vee{constructor(){super("advert"),this.$kind="AdvertsSearchResult",this.lockups=[],this.displaysScreenshots=!0,this.itemBackground="ad"}}const Oee="E1Aan4l00",Eee="E1Aan4l01",Ree="E1Aan4l02",Dee=[new class{canDisplay(e){return(0,Hv.isSome)(e.alignedRegionArtwork)||(0,Hv.isSome)(e.alignedRegionVideo)}get representativeDisplayStyle(){return EK}displayStyle(e,t,n){return(0,Hv.isSome)(t.alignedRegionArtwork)?EK:OK}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isLandscape())&&void 0!==r&&r}get representativeDisplayStyle(){return CK}displayStyle(e,t,n){return CK}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isPortrait())&&void 0!==r&&r}get representativeDisplayStyle(){return bK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Pg(e,n)
return 4===o&&r>=4?bK:3===o&&r>=3?SK:r>=2?PK:IK}},new class{canDisplay(e){return e.landscapeScreenshots.length>0}get representativeDisplayStyle(){return kK}displayStyle(e,t,n){return kK}},new class{canDisplay(e){return e.portraitScreenshots.length>0}get representativeDisplayStyle(){return mK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=Pg(e,n)
return 4===o&&r>=4?mK:3===o&&r>=3?yK:r>=2?AK:TK}},new class{canDisplay(e){return!0}get representativeDisplayStyle(){return RK}displayStyle(e,t,n){return RK}}],_ee={NO_ORGANIC_RESULTS:"NOORGANIC",NORMAL:"NORMAL",DUPE_AD:"DUP"},Lee=(e,t)=>{const n=e.isLandscape()
return n===t.isLandscape()?0:n?-1:1}
class Mee{constructor(e,t,n=null){this.$kind="SearchResultsMessage",this.primaryText=e,this.secondaryText=t,this.messageClickAction=n}}class xee{constructor(e,t){this.$kind="SearchHintSet",this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new RY,this.pageRenderMetrics={}}}!function(e){e.visionOS="xros",e.iOS="ios"}(Ym||(Ym={}))
class $ee extends ZK{constructor(e=[]){super(),this.$kind="SearchResultsPage",this.shelves=[],this.shelves=e}}class Fee{constructor(e,t){this.$kind="SearchResultsContextCard",this.message=e,this.action=t}}class Nee{constructor(e){this.$kind="SearchResultsLearnMoreNotice",this.linkableText=e}}!function(e){e[e.EmptyResults=0]="EmptyResults",e[e.Picker=1]="Picker",e[e.NonNative=2]="NonNative"}(Jm||(Jm={}))
class Bee{constructor(){this.$intentKind="SearchHintsIntent"}async perform(e,t){return await Gg(t,e.term)}}class Uee extends R2{constructor(e,t){super("SearchHintsBuilder"),t.exportingService(LF,{fetchHints:async t=>await Gg(e,t.term)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class Gee extends pJ{constructor(e){super(e,"SearchLandingPage")}}class jee extends pJ{constructor(e){super(e,"SearchFocusPage")}}!function(e){e.Chiclet="chiclet",e.App="app",e.Symbol="symbol"}(Km||(Km={}))
const Vee="word_cloud",Hee="horizontal"
class qee extends CW{constructor(){super(...arguments),this.$kind="ClearSearchHistoryAction",this.actionClass="ClearSearchHistoryAction"}}class Wee{constructor(e,t,n,r){this.title=e,this.maxItems=t,this.shelfDisplayStyle=n,this.itemDisplayStyle=r}}class zee extends R2{constructor(){super("SearchLandingPageBuilder")}pageRoute(e){return[{protocol:OW,path:`${xW.searchLandingPage}`}]}shelfRoute(e){return[{protocol:OW,path:`${xW.searchLandingPage}/${xW.shelf}`,query:[zW.isOnDeviceSearchHistoryShelf]},{protocol:OW,path:`${xW.searchLandingPage}/${xW.shelf}`,query:[zW.isSearchFocusHeaderShelf]}]}pageType(){return wW}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{const n=await this.fetchPage(e)
return R2.createFlowAction(n,this.pageType(),t)})}async handleShelf(e,t,n,r){return await Va(`${this.builderClass}.handleShelf`,async()=>{var o,s,a
const c=v(null!==(o=n[zW.isOnDeviceSearchHistoryShelf])&&void 0!==o?o:t.query[zW.isOnDeviceSearchHistoryShelf]),l=c?function(e){if(!(0,Wv.isNothing)(e))return JSON.parse(decodeURIComponent(e))}(null!==(s=n[zW.token])&&void 0!==s?s:t.query[zW.token]):void 0,u=v(null!==(a=n[zW.isSearchFocusHeaderShelf])&&void 0!==a?a:t.query[zW.isSearchFocusHeaderShelf])
return c&&i(l)?await this.handleSearchHistoryShelfAsync(e,l):u?tv(e):await super.handleShelf(e,t,n,r)})}handleSearchHistoryShelf(e,t,n,r){e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems).then(n=>{const r=Gn(e,BM,UM," ")
return bh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:m_,pageInformation:r},t.title),jg(e,t,r,{rootPosition:0,locationStack:[]},n)}).then(n,r)}async handleSearchHistoryShelfAsync(e,t){const n=await e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems),r=Gn(e,BM,UM," ")
return bh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:m_,pageInformation:r},t.title),jg(e,t,r,{rootPosition:0,locationStack:[]},n)}async fetchPage(e){return await async function(e){const t=Kt(e,AV)?xw(e,AV).catch(()=>null):null
return await async function(e,t){return function(e){return!e.bag.supportsSearchLandingPageV2||!ar(e,e.bag.searchLandingPageV2RolloutRate)}(e)?await async function(e,t){const n=new dY(e).forType(bF).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
n.targetResourceType=MV
const r=cc(e,e.user.dsid);(null==r?void 0:r.length)>0&&n.addingQuery(KD,r)
const s=new Dm.FetchTimingMetricsBuilder,a=e.addingFetchTimingMetricsBuilder(s),c=Ln(a,n)
return await Promise.all([c,t]).then(([e,t])=>s.measureModelConstruction(()=>function(e,t,n){var r
const s=l(t,zI)[0]
if(o(s))return null
if(!de(s,XG))return null
const a=j(s,"id"),c=Un(e,WE,s.id,t),u=Ss(e)
c.recoMetricsData=yh(c.recoMetricsData,null,u),c.adPageInfo=dn(e,AV,n),null===(r=c.adPageInfo)||void 0===r||r.recordAdResponseEventsIfNeeded(e,null==n?void 0:n.failureReason,SF,0)
const d={shelves:[],metricsPageInformation:c,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:a,pageGenreId:q(s,PH),hasAuthenticatedUser:i(e.user.dsid),isSearchLandingPage:!0,adStitcher:Ka(e,n)}
cl(e,ul(e,s),d)
const f=new Gee(d.shelves),h=new NZ(YI,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null)
return f.pageRefreshPolicy=h,jn(e,f,d.metricsPageInformation),f}(a,e,t)))}(e,t):e.bag.mediaAPISearchFocusEnabled?await async function(e,t){const n=Xg(e).enablingFeature("search-focus-suggestions"),r=new Dm.FetchTimingMetricsBuilder,i=e.addingFetchTimingMetricsBuilder(r),s=Ln(i,n),a=e.amsEngagement
let c=null
if(a&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:xK,tab:bq}
c=a.performRequest(e)}return await Promise.all([s,t,c]).then(async([e,t,n])=>await r.measureModelConstructionAsync(async()=>await async function(e,t,n,r){const i=ev(e,t,n,r)
return await async function(e,t){var n
if(o(t.data))return null
const r=Un(e,BM,UM,t," "),i=Ss(e)
r.recoMetricsData=yh(r.recoMetricsData,null,i)
const s={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:r,pageType:Wm.Focus},a=function(e,t,n){const r=e.data
if(o(r))return null
for(const e of r){if(o(e))continue
const r=p(e,vV)
if(qg(null==r?void 0:r.category)===t.pageType&&n===j(e,H$))return e}return null}(t,s,JI)
if((0,Wv.isNothing)(a))return nv(e,t,s)
const c=null!==(n=q(a,yM))&&void 0!==n?n:0,l=e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(c)
return await l.then(n=>(s.searchHistory=n,nv(e,t,s)))}(e,t).then(e=>(i.searchFocusPage=e,i))}(i,e,t,n)))}(e,t):await async function(e,t){const n=Xg(e),r=new Dm.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r),i=Ln(o,n),s=e.amsEngagement
let a
if(s&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:xK,tab:bq}
a=s.performRequest(e)}return await Promise.all([i,t,a]).then(([e,t,n])=>r.measureModelConstruction(()=>ev(o,e,t,n)))}(e,t)}(e,t).catch(async n=>{if((0,Wv.isSome)(e.bag.trendingSearchesURL))return await async function(e,t){const n={url:e.bag.trendingSearchesURL},r=e.network.fetch(n).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${n.url}`)
return JSON.parse(e.body)})
return await Promise.all([r,t]).then(([t,n])=>{var r
const o=new Gee(function(e,t){return qv.context("trendingSearchesShelfForResponse",()=>{const n={rootPosition:0,locationStack:[]},r=l(t,"trendingSearches").map(t=>{const r=f(t,YH),o=new n5(r,r,f(t,Wq),GB)
return e.client.isPhone&&(o.artwork=Ot(e,B$)),ta(e,o,hW,n),Oh(n),o})
let o=0
switch(e.client.deviceType){case Kq:o=10
break
case nW:o=7}const i=new dJ(eq)
return i.title=r.length>0?f(t,"header.label"):null,i.isHorizontal=!1,i.items=r.slice(0,o),[i]})}(e,t)),i=Gn(e,IG,GB,"")
return i.adPageInfo=dn(e,AV,n),null===(r=i.adPageInfo)||void 0===r||r.setMissedOpportunity(e,dA,SF,0),jn(e,o,i),o})}(e,t)
throw n})}(e)}}const{routes:Yee,makeCanonicalUrl:Jee}=dc(function(e){return function(e){const{platform:t,...n}=e
return{...n,platform:ut(t),$kind:jk}}({...e,origin:"userText"})},"/{platform}/search",[ZG])
class Kee{constructor(){this.$intentKind=jk,this.routes=Yee}async perform(e,t){return await function(e,t,n){return n(e.addingActiveIntent({previewPlatform:t.platform}))}(t,e,async t=>{const n=await rv(t,e)
return(0,Hv.isNothing)(n.canonicalURL)&&(n.canonicalURL=this.staticCanonicalUrlFor(e,t)),n})}actionFor(e,t){const n=new EY(bq)
return n.destination=e,n.pageUrl=Jee(t,e),n}staticCanonicalUrlFor(e,t){return Jee(t,e)}}class Zee{constructor(){this.$intentKind="SearchResultsPageMoreIntent"}async perform(e,t){return await ov(t,e.pageToken)}}class Qee extends R2{constructor(e,t){super("SearchResultsBuilder"),t.exportingService(LF,{fetchResults:async t=>await async function(e,t){const n=new Dm.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await Lp(r,t)
return null===o?$g(r,t.facets):await async function(e,t){return await Ng(e,t)}(r,o)}(e,t),fetchMoreResults:async t=>await async function(e,t){return await async function(e,t){return await qv.context("paginatedSearchResultsWithToken",async()=>{const n=_g(0,t),r=Lg(0,t)
return 0===n.length?await Promise.resolve($g(e)):await Mp(e,n).then(async n=>{const o=At(n)
return await Eg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(e=>{const t=new QK
return t.results=e.builtSearchResults,t.nextPage=r,t})})})}(e,t)}(e,t.pageToken),fetchSearchResultsPage:async t=>await rv(e,t),fetchMoreOfSearchResultsPage:async t=>await ov(e,t.pageToken)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class Xee{constructor(){this.$intentKind="ArticlePageIntent"}async perform(e,t){return await t.required(y3).fetchPage(t,e.url,O4)}}class ete extends R2{constructor(e,t){super("ArticleBuilder"),t.exportingService(ck,{fetchArticle:async t=>await e.required(y3).fetchPage(e,t.url,O4)})}async handlePage(e,t,n,c,l){const u=new Dm.FetchTimingMetricsBuilder,d=e.addingFetchTimingMetricsBuilder(u),h=JSON.parse(f(t.query,zW.recoMetrics)),p=function(e,t,n){const r=t.pathComponents()
if(r.indexOf(QU)<0&&r.indexOf(yj)<0&&r.indexOf(oT)<0&&t.host!==GW&&t.host!==HW&&t.host!==qW)throw new Error(`Unable to map ${t.build()} to a media api url`)
let o
if(o=t.host===GW?e.packageProperties.asString("spamBlockingExtensionsEditorialItemID"):t.host===HW?e.bag.sharePlayAppsEditorialItemId:t.host===qW?e.bag.buddyOnboardingEditorialItemId:Ni(t),!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
if(!a(o))throw new Error(`Unable to map ${t} to a media api url`)
const i=function(e,t,n){const r=new dY(e).withIdOfType(t.id,Xq).includingAdditionalPlatforms(ee(e)).includingAttributes(function(e){const t=[Yj,kj,aH,IH,$q,Oq,aj,_$,bB]
return e.bag.enableUpdatedAgeRatings&&t.push(Eq),e.appleSilicon.isSupportEnabled&&t.push(kH),nf(e)&&t.push(TH),t}(e)).includingRelationships([TN]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Hv.isNothing)(n)&&r.includingAgeRestrictions(),oi(e)&&(r.enablingFeature(zH),r.includingScopedAttributes(iW,YK),r.includingScopedRelationships(iW,[Jq]),r.includingScopedRelationships(rT,[iW]),r.includingScopedAvailableIn(iW,[IO])),si(e)&&(r.enablingFeature(DB),r.includingScopedRelationships(VV,[aU]),r.includingAssociateKeys(Xq,[sV]),r.includingMetaKeys(KA,[ZA]),r.includingScopedAttributes(VV,[Nq,RH,QF,CL])),r}(e,bi({...Di(e),id:o}),n),c=t.query[zW.editorialCardId]
s(c)&&i.withFilter("canvas:cardId",c)
const l=t.query[zW.preview]
return WW.has(t.host)&&(null==l?void 0:l.length)>0&&(i.addingQuery(iT,l),i.isStorePreviewRequest=!0),i.attributingTo(t.build())}(e,t,l),w=await Ln(d,p),g=await async function(e,t){return await sc(e,t,zc,Yc)}(e,w),v=new Y4
v.todayShelfRecoMetricsData=h,v.showingFallbackMediaInline=Boolean(n[zW.showingFallbackMedia]),v.additionalData=g.additionalData
const y=f(t.query,zW.todayCardConfig);(null==y?void 0:y.length)>0&&(v.todayCardConfig=JSON.parse(y)),v.allowUnpublishedAppEventPreviews=(0,Hv.isSome)(n[zW.preview]),v.isResilientDeepLink=e.deepLinks.hasResilientDeepLinks(),e.client.isCompanionVisionApp&&(v.clientIdentifierOverride=Mz)
const T=u.measureModelConstruction(()=>function(e,t,n){return qv.context("articlePageWithResponse",()=>{var s
const a=yt(e,t)
n.metricsPageInformation=Un(e,yj,a.id,t),n.metricsLocationTracker={rootPosition:0,locationStack:[]},n.pageId=a.id
const c=new BZ(n.metricsPageInformation,n.metricsLocationTracker,n.refreshController),l=function(e,t){if(!i(t))return null
if((0,Hv.isSome)(t.todayCardConfig))return t.todayCardConfig
const n={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!1,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
switch(n.clientIdentifierOverride=t.clientIdentifierOverride,n.useOTDTextStyle=!1,n.allowUnpublishedAppEventPreviews=t.allowUnpublishedAppEventPreviews,n.currentRowIndex=void 0,e.client.deviceType){case lW:n.prevailingCropCodes={defaultCrop:"en"},n.coercedCollectionTodayCardDisplayStyle=Tm.Grid,n.heroDisplayContext=km.Article
break
case"tv":n.prevailingCropCodes={defaultCrop:"ek","editorialArtwork.storyCenteredStatic16x9":"SCS.ApDHXL01"},n.coercedCollectionTodayCardDisplayStyle=Tm.Grid,n.heroDisplayContext=km.Article
break
case LV:n.coercedCollectionTodayCardDisplayStyle=Tm.River,n.prevailingCropCodes={defaultCrop:"sr","editorialArtwork.dayCard":"grav.west"}}return n}(e,n)
let u=bo(e,a,l,c)
const d=null==u?void 0:u.media;(0,Hv.isNothing)(u)&&(u=null)
const h=null!==(s=null==u?void 0:u.title)&&void 0!==s?s:void 0,p=j(a,DH)
n.crossLinkSubtitle=Bo(e,a),n.clientIdentifierOverride=l.clientIdentifierOverride,bh(0,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:Tq,id:n.pageId,idType:Sq},h)
const w=function(e,t,n,r){return qv.context("renderArticle",()=>{var o
const s=[],a=null!==(o=we(t,TN))&&void 0!==o?o:[]
for(const n of a){r.module=j(n,lC),r.subStyle=null,s.length
const o=Kc(e,n,t,r)
if(o.length>0)for(const e of o)e.title=r.titleForNextShelf,s.push(e),r.titleForNextShelf=null
r.index++,Oh(r.metricsLocationTracker)}if(r.showingFallbackMediaInline&&0===s.length){const e=function(e,t){if(A(n=t)&&n[gW]===Cy||function(e){return A(e)&&e[gW]===Oy}(t)){const e=new dJ(Iq)
return e.items=t.lockups,e}var n
return null}(0,n)
i(e)&&s.push(e)}return s})}(e,a,d,n),g=w[w.length-1],v=n.isResilientDeepLink||p===K_?null:function(e,t,n){const s=Zc(0,t)
let a=null
const c=Wf(e,t,fW),l=Wf(e,t,tV)
if(c&&l&&(a=e.loc.string("ShareSheet.TitleSubtitle.Format","{title}: {subtitle}").replace(xU,c).replace(QP,l)),!a&&c&&(a=c),!a&&l&&(a=l),!a&&s){const n=j(s,fW),r=j(t,LN)
switch(r){case Tm.GameOfTheDay:a=e.loc.string("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(xU,n)
break
case Tm.AppOfTheDay:a=e.loc.string("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(xU,n)
break
default:e.console.log(`No title for article with unknown style: ${r}`)}}const u=j(t,Wq)
let d
switch(j(t,LN)){case Tm.Grid:case Tm.List:case Tm.River:d=Ot(e,"resource://ShareCollectionThumbnail",40,40)
break
default:d=null}const f=function(e,t,n,o,s,a){return r(a)?null:qv.context("shareSheetDataForArticle",()=>{let r=s;(0,Hv.isNothing)(r)&&(0,Hv.isSome)(a)&&(r=function(e,t){const n=Co(t)
{const r=No(e,t,km.Article,n)
if(i(r))return r}return Do(e,B(t,Ro(0,n)),void 0)}(e,a))
const o=e.loc.string("ShareSheet.Story.Subtitle"),c=new fZ(a.id,t,o,r)
return new hZ(c,n,null)})}(e,a,u,0,d,t)
if(!i(f))return null
const h=function(e,t,n,r){const s=[]
if((null==t?void 0:t.length)>0){const n=Go(e,t)
i(n)&&s.push(n)}if((null==n?void 0:n.length)>0){const t=Go(e,n,"Copy Card Preview Link")
i(t)&&s.push(t)}if((0,Hv.isSome)(r)){let t
e.featureFlags.isGSEUIEnabled($J)&&e.featureFlags.isEnabled(gJ)&&(t=function(e,t){if(o(e))return
const n=new GY(e)
return n.title=t,new dZ("com.apple.AppStore.openInGameCenterActivity",n)}(`games:///story/id${r}`,e.loc.string("ShareSheet.OpenInGameCenter.Title"))),i(t)&&s.push(t)}return s}(e,u,function(e,t,n){if((0,Hv.isNothing)(t))return null
switch(e.client.buildType){case GG:case nG:const e=new az
return e.protocol=EW,e.host=WU,e.pathname=`/${xW.todayCardPreview}`,e.param(zW.ids,`${t}`),e.param(zW.isTodayFeedPreview,pq),e.param(zW.isTodaySection,n.useOTDTextStyle?pq:UF),decodeURIComponent(e.build())
default:return null}}(e,t.id,n),t.id)
return new KK(f,h)}(e,a,l)
if(i(v)){Qs(e,v,{targetType:hW,id:n.pageId,actionType:oB,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})
const t=function(e,t,n){if(t&&n){const e=t.items.length
if(e>0&&-1!==J4.indexOf(n)){const n=t.items[e-1]
switch(t.contentType){case S_:case Ix:return n&&n.isFullWidth
default:return!0}}}return!1}(0,g,n.module),r=function(e,t,n,r){if(!i(t)||e.client.isCompanionVisionApp)return null
const o=new E4(oB,e.loc.string("SHARE_STORY"),!r,t),s=new dJ("roundedButton")
return s.items=[o],s}(e,v,0,t)
r&&w.push(r)}const y=new O4(u,w,v)
if(y.editorialStoryCard=null,y.title=null==u?void 0:u.title,y.subtitle=null==u?void 0:u.inlineDescription,function(e,t,n,r){const o=Zc(0,n)
if(o){const i=na(0,n)
return void(t.footerLockup=function(e,t,n,r){return Cd(e,t,{offerStyle:Qc(e),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:r,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:y6.Default,canDisplayArcadeOfferButton:eh(0,Iq)})}(e,o,r,i))}const s=H(n,P_)
if(i(r.additionalData)&&s){const o=co(e,n)
t.arcadeFooterLockup=function(e,t,n){return Md(e,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},pt(yj),BH,null)}(e,o,r)}}(e,y,a,n),y.shouldTerminateOnClose=n.isResilientDeepLink,jn(e,y,n.metricsPageInformation,e=>{let t=h
var n
if(A(n=null==u?void 0:u.media)&&n[gW]===Iy&&function(e){return $r(e)&&e[gW]===by}(null==u?void 0:u.overlay)&&(t=(null==u?void 0:u.overlay).lockup.title),!t)return
let r=f(m(e[MU]),FH)
r=r||f(m(e[WG])),e[MU]=r?`${r}_${t}`:`unknown_${t}`}),y.canonicalURL=j(a,Wq),(0,Hv.isSome)(a)){const e=j(a,Wq);(0,Hv.isSome)(e)&&(y.viewArticleAction=new GY(e,!0))}return y})}(d,g.originalData,v)),b=R2.createFlowAction(T,Tq,t)
{const e=new IX(zq)
return e.actions=[b],e}}pageRoute(e){return[{protocol:EW,path:`/{countryCode}/${xW.editorialItem}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/{countryCode}/${xW.editorialItem}/{seoSlug}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/{countryCode}/${xW.story}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/{countryCode}/{platform}/${xW.story}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/{countryCode}/${xW.story}/{seoSlug}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/${xW.story}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/${xW.story}/{seoSlug}/{id}`,query:[`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:`/${xW.store}/${xW.viewEditorialItem}`,query:[zW.id,`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[zW.id,`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[zW.id,`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[zW.id,`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[zW.id,`${zW.showingFallbackMedia}?`,`${zW.preview}?`,`${zW.todayCardConfig}?`]},{protocol:EW,hostName:`${GW}`},{protocol:OW,path:`/${xW.story}/{id}`,query:[`${zW.metrics}?`,`${zW.invalidateWidgetsOnFailure}?`]},{protocol:EW,hostName:`${HW}`},{protocol:EW,hostName:`${qW}`}]}pageType(){return Tq}}Zm=e(1415)
class tte{constructor(e,t,n,r,o,i){this.$kind="TodayPage",this.shelves=e,this.title=n,this.titleDetail=o,this.shortTitleDetail=i,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new RY,this.pageRenderMetrics={}}}!function(e){e.OnboardingCards="onboardingCards",e.Ads="ads",e.ODP="ODP",e.AMDData="amdData"}(Qm||(Qm={}))
class nte extends R2{constructor(){super("TodayCardPreviewBuilder")}pageType(){return zq}pageRoute(e){return[{protocol:EW,path:`/${xW.todayCardPreview}`,query:[`${zW.ids}?`,`${zW.isTodaySection}?`,`${zW.isTodayFeedPreview}?`,`${zW.preview}?`,`${zW.experimentId}?`,`${zW.fetchData}?`]}]}async handlePage(e,t,n,r,i){return await Va(`${this.builderClass}.pageHandler`,async()=>{var r
const i=new EY(this.pageType())
if(i.pageUrl=t.build(),!v(n[zW.fetchData]))return i
const a=null===(r=n[zW.experimentId])||void 0===r?void 0:r.split(","),c=n[zW.ids]
if(s(a)&&o(c)){const t={}
for(const e of a){const n=e.split(":")[0],r=e.split(":")[1]
t[n]=r}const n=s(t)?JSON.stringify(t):void 0,r=await cv(e,{experimentIdHeader:n,url:"",onboardingCardIds:[]})
return i.pageData=r,i}{const n=lv(e,this.createFlattenedTodayItemsFromUrl(t),nte.emptyTodayPageResponse,null,null)
return i.pageData=n,i}})}createFlattenedTodayItemsFromUrl(e){const t=[],n=f(e.query[zW.ids]),r=(0,Hv.isSome)(e.query[zW.isTodayFeedPreview])&&v(e.query[zW.isTodayFeedPreview]),o=(0,Hv.isSome)(e.query[zW.isTodaySection])&&v(e.query[zW.isTodaySection])
if(!s(n))return t
const i=n.match(/([a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?:\[[^\]]+\]|[a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?)/g)
let a=r,c=0
for(const e of i){const n=e.split(":")[0],r=nte.storyGroupIdRegex.exec(e)
if((0,Hv.isSome)(r)){const e=r[1].split(",").map(e=>this.createUnhydratedEditorialItemFromId(e,o))
t.push({type:Rm.EditorialItemGroup,data:{id:n,type:Dj,relationships:{},meta:{associations:{recommendations:{data:e}}}},isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...nte.previewModuleData},containedAdSlots:Array.from({length:e.length},(e,t)=>t+c)}),a=!1,c+=e.length}else t.push({type:Rm.EditorialItem,data:this.createUnhydratedEditorialItemFromId(e,o),isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...nte.previewModuleData},containedAdSlots:[c]}),a=!1,c+=1}return t}createUnhydratedEditorialItemFromId(e,t){const n=e.split(":")[0],r=e.split(":")[1],o=(0,Hv.isSome)(r)?{"editorial-cards":{data:[{id:`${n}-${r}`,type:sV}]}}:{}
return{id:n,type:Xq,relationships:{},meta:{personalizationData:{isOfTheDay:t},associations:o}}}}nte.storyGroupIdRegex=/\[(.*)\]/,nte.previewModuleData={label:lk,title:"Today Preview",meta:{},isTodayForAppsModule:!1},nte.emptyTodayPageResponse={results:{data:[]}}
class rte{constructor(){this.$intentKind="TodayPageIntent"}async perform(e,t){const n=e.isRunningPPTs?JSON.stringify({NyCxKBD:"client-perf"}):void 0
return await cv(t,{url:e.url,onboardingCardIds:e.onboardingCardIds,experimentIdHeader:n})}}class ote{constructor(){this.$intentKind="TodayPageMoreIntent"}async perform(e,t){const n=e.pageToken
return pv(t,n.pageInformation),await dv(t,n),uv(t,n)}}class ite extends R2{constructor(e,t){super("TodayPageBuilder"),t.exportingService(ck,{fetchPage:async t=>await cv(e,{url:t.url,onboardingCardIds:t.onboardingCardIds}),async fetchMoreOfPage(t){const n=t.pageToken
return pv(e,n.pageInformation),await dv(e,n),uv(e,n)}})}defaultTab(e){return zq}pageType(){return zq}pageRoute(e){return[]}async handlePage(e,t,n,r,o){throw new Error("handlePage not implemented for TodayBuilder")}}class ste{constructor(e,t,n,r){this.$kind="TopChartSegment",this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new RY,this.pageRenderMetrics={}}}class ate{constructor(e,t,n,r,o,i,s){this.genreId=e,this.ageBandId=t,this.title=n,this.segments=r,this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0,this.$kind=null!=s?s:Dy}}class cte extends UK{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.$kind="TopChartCategory",this.shortName=this.name,this.longName=this.name,this.url=t}}class lte{constructor(){this.$intentKind="TopChartsPageIntent"}async perform(e,t){return await yv(t,e.url)}}class ute{constructor(){this.$intentKind="TopChartsPageMoreIntent"}async perform(e,t){return await Av(t,e.pageToken)}}class dte extends R2{constructor(e,t){super("TopChartsBuilder"),t.exportingService("TopChartData",{fetchPage:async t=>await yv(e,t.url),fetchMoreOfSegment:async t=>await Av(e,t.pageToken)})}pageRoute(e){return Tv()}async handlePage(e,t,n,i,a){const c=n[zW.isPPT]
t.removeParam(zW.isPPT)
let l=t.query[zW.chart],u=n[zW.genre]
o(u)&&(u=f(e.bag.defaultChart,"genre-id"),o(l)&&(l=f(e.bag.defaultChart,"chart-id")))
let d=n[zW.charts]
if(o(d)){const e=hc(0,l)
d=void 0!==e?`${l},${e}`:l}else d.includes(l)||(d+=`,${l}`)
const h=pc(e,u,d,n[zW.ages])
let p
p=wc(e,d,u)
const[w,g]=await Promise.all([h,p]),v=Tn(e,g)
let m,y
if(m=gv(e,w,u,v,l,r(v)?mn(u):yn(v)),y=dG,c&&s(m.segments)){const t=m.segments[0],n=t.nextPage,r=Pt(0,n)
if(s(r)){const o=new dY(e,r),i=await Ln(e,o),s=It(0,n)
s.remainingContent=[],s.maxPerPage=0
const a=bv(e,i,n,s),c=t.shelves.concat(a.shelves),l=new ste(t.shortName,t.longName,t.chart,c)
l.pageMetrics=t.pageMetrics,l.nextPage=null,m.segments[0]=l}}return R2.createFlowAction(m,y,t)}pageType(){return dG}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>function(e){var t,n
const r=new pJ(e.shelves)
return r.title=null!==(t=e.longName)&&void 0!==t?t:e.shortName,r.pageMetrics=e.pageMetrics,r.pageRenderMetrics=e.pageRenderMetrics,s(null===(n=null==e?void 0:e.nextPage)||void 0===n?void 0:n.remainingContent)&&(r.nextPage=e.nextPage),r}(await Av(e,o)))}}class fte{constructor(e,t,n,r){this.$kind="TodayWidgetContainerTemplate",this.collections=e,this.refreshDate=t,this.originalResponseDate=n,this.originalResponseHash=r}}class hte{constructor(e,t){this.$kind="TodayWidgetCardCollectionTemplate",this.cards=e,this.displayDate=t}}class pte{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="WidgetTodayCardTemplate",this.storyId=e,this.heading=t,this.title=n,this.backgroundColor=r,this.isDark=o,this.iconArtwork=i,this.url=s,this.eventBadgeKind=l,this.editorialArtwork=c,this.isVideoArtwork=a,this.eventStartDate=u,this.eventEndDate=d}}class wte{make(e){const t=new dY(e).forType(this.typeForUseCase()).withIdsOfType(this.ids(),this.typeForUseCase()).addingContext(this.context()).includingAttributes(this.attributesForUseCase()).asPartialResponseLimitedToFields(this.fieldsForRequest()).withSparseCount(this.sparseCountForUseCase()).withSparseLimit(this.sparseLimitForUseCase()).enablingFeature(this.enablingFeature(e)).usingCustomAttributes(this.shouldUseCustomAttributes(e)),n=this.addingQuery()
if(null!==n)for(const e of n)t.addingQuery(e.key,e.value)
return t}}class gte extends wte{context(){return PR}typeForUseCase(){return zq}attributesForUseCase(){return[$q,Oq,IH]}sparseCountForUseCase(){return null}sparseLimitForUseCase(){return null}addingQuery(){return null}ids(){return[]}fieldsForRequest(){return[c_,oW,i$,LN,fE,CH,sS,$q,Zb,hV,Oq,o$,"id",uU,DH,YH,Mq,IH,fW,hE,r$]}enablingFeature(e){return oi(e)?zH:null}shouldUseCustomAttributes(e){return Ue(e)}}class vte{constructor(){this.$intentKind="WidgetIntent"}async perform(e,t){const n=e.widgetKind
if(n===OC)return await _v(t,e)
throw Error(`Invalid widgetKind of '${n}'`)}}class mte extends R2{constructor(e,t){super("WidgetController"),t.exportingService("WidgetData",{fetchTodayWidget:async t=>await _v(e,t)})}async handlePage(e,t,n,r,o){throw new Error(yV)}pageRoute(e){return[]}pageType(){return qq}}class yte{constructor(){this.$intentKind="MetricsFieldLintingIntent"}async perform(e,t){const n=hr(t).makeEvent(t,y(e.fields))
return await Promise.resolve(n)}}class Ate{constructor(){this.$intentKind="AppUpdateLockupsIntent"}async perform(e,t){const n=this.createUpdateLockups(t,e.appUpdateMetadata)
return await Promise.resolve(n)}createUpdateLockups(e,t){const n={lockupOptions:{metricsOptions:{pageInformation:Gn(e,t$,"Updates",""),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:y6.LockupIconSmall}}
return this.updatesLockupsFromData(e,t,n)}updatesLockupsFromData(e,t,n){return qv.context("updatesLockupsFromData",()=>{const a=[]
return null==t||t.forEach((t,c)=>{var l
const u=t.updateMetadata
if(r(u.attributes))return void(n.contentUnavailable&&n.contentUnavailable(c,u))
const d=n.lockupOptions
let h=Qv.All
if(i(n.filter)&&(h=n.filter),at(e,u,h))return
const p=function(e){return e?{...e,isValid:e.isValid,$kind:X_}:null}(Cd(e,u,d))
if(r(p)||!p.isValid())return
const w=se(u,nt(e,u),"latestVersionInfo"),g=f(w,BD),v=f(w,cU)
p.releaseDate=new Date(v),p.installDate=t.updateInstallDate
const m=t.isUpdateAvailable||t.isUpdating?p.releaseDate:p.installDate
let y=this.timeAgoStringForDate(e,m)
o(y)&&(y=e.loc.string("UPDATES_VERSION_FORMAT").replace("{updateVersion}",g)),s(y)&&(p.subtitle=y)
const A=f(w,AI);(0,Hv.isSome)(A)&&(p.whatsNew=new FX(A.trim())),p.version=g,p.size=null===(l=Rf(e,u))||void 0===l?void 0:l.fileSizeByDevice,p.externalVersionId=tt(e,u,ED),a.push(p),Oh(n.lockupOptions.metricsOptions.locationTracker)}),a})}timeAgoStringForDate(e,t){if((0,Hv.isNothing)(t))return
const n=(new Date).getTime()-t.getTime(),r=Math.floor(n/864e5)
switch(r){case 0:return e.loc.string("LOCKUPS_TODAY")
case 1:return e.loc.string("LOCKUPS_YESTERDAY")
case 2:case 3:return e.loc.string("LOCKUPS_DAYS_AGO_FORMAT").replace("{daysAgo}",r.toString())
default:const n=vx
return e.loc.formatDate(n,t)}}}Xm=e(5881)
class Tte{constructor(){this.dispatcher=new Xm.IntentDispatcher}register(e){this.dispatcher.register(e)}async dispatch(e,t){const n=await this.createIntentObjectGraphWithAsyncValues(t)
return await this.dispatcher.dispatch(e,n)}controller(e){return this.dispatcher.controller(e)}get registeredControllers(){return this.dispatcher.registeredControllers}async createIntentObjectGraphWithAsyncValues(e){const t=new AY,n=new cK,r=new cK(aK)
let o
if(e instanceof B3){let i=e
i=i.addingBag(i.bag.underlyingBag),await t.loadTreatments(i),await n.loadValues(i,[em.client,em.user]),e.bag.personalizationUserIdEnabled&&await r.loadValues(e,[em.user]),i.clientCapabilities.isEnabled(DR)&&i.bag.metricsPaymentNamespaceEnabled&&(o=new cK(iK),await o.loadValues(i,[em.client,em.user])),e=i}return e.adding(AY.metatype,t).adding(cK.defaultMetatype,n).adding(cK.paymentMetatype,o||n).adding(cK.personalizationMetatype,r)}}class bte extends Vv.LegacyRuntime{constructor(e,t){super(e,t,{})}exportingService(e,t){this.wrapServiceInValidation(t)
const n={...this.serviceWithName(e)||{},...t}
return super.exportingService(e,n)}exportingServiceName(e,t,n){const r={}
r[t]=n,this.exportingService(e,r)}wrapServiceInValidation(e){for(const t of Object.keys(e)){const n=e[t]
n instanceof Function&&(e[t]=function(...e){const t=n.apply(this,e)
return t instanceof Promise?t.then(e=>(qv.recordValidationIncidents(e),e)):(qv.recordValidationIncidents(t),t)})}}}(0,Vv.exportBootstrap)(function(e){const[t,n]=function(){const e=new A3,t=function(e,t,n){var r,o
const i=function(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x,$,F){return e.configureDefaults(n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,L,M,x,$,F).adding(y3,t)}(new B3("app-store"),e,bag,cryptography,host,net,platform,plist,random,services,cookieProvider,console,ask.storeMetrics,ask.amsEngagement,ask.loc,ask.adsLoc,ask.device,ask.client,ask.props,ask.user,ask.player,ask.metricsIdentifiers,ask.clientOrdering,ask.arcade,ask.gameCenter,ask.resilientDeepLinks,ask.appleSilicon,ask.storage,ask.ads,ask.onDeviceRecommendationsManager,ask.onDeviceSearchHistoryManager,null!==(r=ask.featureFlags)&&void 0!==r?r:{isEnabled:()=>!1,isGSEUIEnabled:()=>!1},null!==(o=ask.clientCapabilities)&&void 0!==o?o:{isEnabled:()=>!1},mediaToken,ask.appDistribution,ask.timeoutManager,ask.treatmentStore,ask.userDefaults)
return yW.createSharedMetricsReferralContext(i),i}(e),n=new Tte,r=new bte(n,t)
return function(e,t){const n=e.required(y3)
t.exportingService(HA,{fetchGeneric:async t=>await n.fetchPage(e,t.url,pJ),fetchMoreOfGeneric:async t=>await n.fetchMoreOfPage(e,t.pageToken),fetchShelves:async t=>await n.fetchShelves(e,t.requests),fetchAction:async t=>await np(e,t)})}(t,r),e.registerPageBuilder(t,new ite(t,r)),e.registerPageBuilder(t,new ete(t,r)),e.registerPageBuilder(t,new nte),e.registerPageBuilder(t,new dte(t,r)),e.registerShelfBuilder(t,new X2),e.registerShelfBuilder(t,new n4),e.registerShelfBuilder(t,new i4),e.registerShelfBuilder(t,new u5),e.registerShelfBuilder(t,new s4),e.registerShelfBuilder(t,new a5),e.registerShelfBuilder(t,new c4),e.registerShelfBuilder(t,new u4),e.registerShelfBuilder(t,new f4),e.registerShelfBuilder(t,new p4),e.registerShelfBuilder(t,new Z2),e.registerShelfBuilder(t,new y4),e.registerShelfBuilder(t,new P4),e.registerShelfBuilder(t,new Z4),e.registerShelfBuilder(t,new Q4),e.registerShelfBuilder(t,new e5),e.registerShelfBuilder(t,new r5),e.registerShelfBuilder(t,new o5),e.registerShelfBuilder(t,new i5),e.registerShelfBuilder(t,new l5),e.registerPageBuilder(t,new b7),e.registerPageBuilder(t,new d8(t,r)),e.registerPageBuilder(t,new r8(t,r)),e.registerPageBuilder(t,new b8(t,r)),e.registerPageBuilder(t,new I9),e.registerPageBuilder(t,new s8(t,r)),e.registerPageBuilder(t,new m8(t,r)),e.registerPageBuilder(t,new y8),e.registerPageBuilder(t,new g9),e.registerPageBuilder(t,new P9(t,r)),e.registerShelfBuilder(t,new Q2),e.registerPageBuilder(t,new o7),e.registerPageBuilder(t,new u7),e.registerPageBuilder(t,new d7),e.registerPageBuilder(t,new T7),e.registerPageBuilder(t,new j7),e.registerPageBuilder(t,new Y7),e.registerPageBuilder(t,new J7),e.registerPageBuilder(t,new B7(t,r)),e.registerPageBuilder(t,new F7),e.registerPageBuilder(t,new K7),e.registerPageBuilder(t,new Z7),e.registerPageBuilder(t,new x7),e.registerPageBuilder(t,new M7),e.registerPageBuilder(t,new $7),e.registerPageBuilder(t,new L7),e.registerPageBuilder(t,new zee),e.registerPageBuilder(t,new lee(t,r)),e.registerPageBuilder(t,new Qee(t,r)),e.registerPageBuilder(t,new Uee(t,r)),e.registerPageBuilder(t,new t7),e.registerPageBuilder(t,new n7),e.registerPageBuilder(t,new r7),e.registerPageBuilder(t,new Y3(t,r)),e.registerPageBuilder(t,new c9(t,r)),e.registerPageBuilder(t,new J3),e.registerPageBuilder(t,new h9),e.registerPageBuilder(t,new K3),e.registerPageBuilder(t,new f9),e.registerPageBuilder(t,new l9),e.registerPageBuilder(t,new u9),e.registerPageBuilder(t,new d9),e.registerPageBuilder(t,new W8),e.registerPageBuilder(t,new z8),e.registerPageBuilder(t,new j8),e.registerPageBuilder(t,new G8),e.registerPageBuilder(t,new $8),e.registerPageBuilder(t,new V8),e.registerPageBuilder(t,new Y8),e.registerPageBuilder(t,new F8),e.registerPageBuilder(t,new B8),e.registerPageBuilder(t,new H8),e.registerPageBuilder(t,new U8),e.registerPageBuilder(t,new q8),e.registerPageBuilder(t,new R7(t,r)),e.registerPageBuilder(t,new P7(t,r)),e.registerPageBuilder(t,new tee),e.registerPageBuilder(t,new eee),e.registerPageBuilder(t,new Q7),e.registerPageBuilder(t,new X7),e.registerPageBuilder(t,new A7(t,r)),e.registerPageBuilder(t,new mte(t,r)),e.registerPageBuilder(t,new w9(t,r)),e.registerPageBuilder(t,new I7(t,r)),e.registerPageBuilder(t,new k8(t,r)),e.registerPageBuilder(t,new L8(t,r)),e.registerPageBuilder(t,new P8(t,r)),e.registerPageBuilder(t,new _7(t,r)),e.registerPageBuilder(t,new x8(t,r)),[n,r]}()
return t.register(new z3),t.register(new H3),t.register(new Ate),t.register(new u8),t.register(new t8),t.register(new n8),t.register(new i8),t.register(new S8),t.register(new T8),t.register(new v8),t.register(new b9),t.register(new S9),t.register(new Xee),t.register(new y7),t.register(new _8),t.register(new D7),t.register(new m7),t.register(new s9),t.register(new G3),t.register(new j3),t.register(new M8),t.register(new S7),t.register(new yte),t.register(new E7),t.register(new O7),t.register(new a9),t.register(new C8),t.register(new R8),t.register(new D8),t.register(new Bee),t.register(new Kee),t.register(new Zee),t.register(new cee),t.register(new N7),t.register(new V3),t.register(new rte),t.register(new ote),t.register(new lte),t.register(new ute),t.register(new p9),t.register(new vte),n})})()})()

//# sourceMappingURL=main.js.map