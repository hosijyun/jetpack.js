(()=>{function e(r){var o,i=n[r]
return void 0!==i?i.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,e),o.exports)}var t={172:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7691),t)},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.demoteByEngagements=void 0,t.demoteByEngagements=function(e,t){return[...e]}},2305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3745:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2305),t),o(n(3756),t)},7691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3745),t),o(n(230),t)},9100:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4908),t)},6451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LazyProxyFactory=void 0,t.LazyProxyFactory=class{static makeProxy(e,t){const r=new n(t),o={get:(t,n,o)=>{if(void 0===r.createRealObjectIfNeeded(e))return
const i=r.realObject[n]
return"function"==typeof i?i.bind(r.realObject):i},set:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.set(r.realObject,n,o,r.realObject),has:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.has(r.realObject,n),deleteProperty:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.deleteProperty(r.realObject,n),ownKeys:t=>void 0===r.createRealObjectIfNeeded(e)?[]:Reflect.ownKeys(r.realObject),getOwnPropertyDescriptor:(t,n)=>{if(void 0!==r.createRealObjectIfNeeded(e))return Reflect.getOwnPropertyDescriptor(r.realObject,n)},defineProperty:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.defineProperty(r.realObject,n,o),preventExtensions:t=>void 0!==r.createRealObjectIfNeeded(e)&&(Reflect.preventExtensions(r),Reflect.preventExtensions(r.realObject)),isExtensible:t=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.isExtensible(r.realObject),getPrototypeOf:t=>void 0===r.createRealObjectIfNeeded(e)?null:Reflect.getPrototypeOf(r.realObject),setPrototypeOf:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.setPrototypeOf(r.realObject,n)}
return new Proxy(r,o)}}
class n{constructor(e){this.lazyProvider=e}createRealObjectIfNeeded(e){return void 0===this.realObject&&(this.realObject=this.lazyProvider.lazyDependencyFor(e)),this.realObject}}},4908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.ObjectGraph=void 0
const r=n(2450)
t.ObjectGraph=class{constructor(e){this._members={},this.name=e}adding(e,t){const n=this.clone()
return n._members[e.name]=t,n}removing(e){const t=this.clone()
return delete t._members[e.name],t}optional(e){return this._members[e.name]}required(e){const t=this._members[e.name]
if((0,r.isNothing)(t)){const t=Object.keys(this._members).sort().join(", ")
throw new Error(`No member with type ${e.name} found in ${this.name}. Candidates ${t}`)}return t}clone(){const e=new(0,this.constructor)(this.name)
for(const[t,n]of Object.entries(this._members))e._members[t]=n
return e}},t.inject=function(e,t){return t.required(e)}},9089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseActionProvider=void 0
const r=n(2450)
t.isBaseActionProvider=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.actionFor)}},129:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9089),t)},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntentDispatcher=void 0
const r=n(2450),o=n(4395),i=n(3907),s=n(1222)
t.IntentDispatcher=class{constructor(){this.dispatchableMap={}}register(e){if((0,r.isNothing)(e.$intentKind))throw new Error("Dispatcher cannot register a controller without an $intentKind")
if(e.$intentKind in this.dispatchableMap)throw new Error(`Dispatcher already has a controller registered for ${e.$intentKind}`)
this.dispatchableMap[e.$intentKind]=e}async dispatch(e,t){if("$static"===e.$kind){const t=Reflect.get(e,"$data")
if((0,r.isNothing)(t))throw new Error("StaticIntent<R> contains no data")
return t}const n=this.dispatchableMap[e.$kind]
if((0,r.isNothing)(n)||!(0,o.isIntentController)(n))throw new Error(`No controller registered to handle ${e.$kind}`)
const a=e.$pageIntentInstrumentation,c=t.optional(s.net)
if((0,r.isSome)(a)&&(0,r.isSome)(c)){const r=new i.ProxiedNetwork(c,a),o=t.adding(s.net,r)
return await n.perform(e,o)}return await n.perform(e,t)}controller(e){return this.dispatchableMap[e.$kind]}get registeredControllers(){return Object.values(this.dispatchableMap)}}},8346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4395),t),o(n(3421),t),o(n(8770),t),o(n(867),t)},4395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIntentController=void 0
const r=n(2450)
t.isIntentController=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.perform)}},867:(e,t)=>{function n(e){return{$kind:"$static",$data:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Continuous=t.makeSidepackedIntent=t.makeStaticContinuousIntentsOf=t.makeStaticIntent=void 0,t.makeStaticIntent=n,t.makeStaticContinuousIntentsOf=function(e){const t=new Array
for(const o of e)t.push(n(r.of(o)))
return t},t.makeSidepackedIntent=function(e,t){return{$kind:"$sidepacked",$initial:e,$intent:t}}
class r{static of(e){return new r(new o(e))}static contentsOf(e){return new r(e)}constructor(e){this.base=e,this.$wrappedField="base"}toJSON(){if(this.base instanceof o)return this.base.toJSON()
throw new TypeError("Continuous was not created with a single element")}async*[Symbol.asyncIterator](){yield*this.base}}t.Continuous=r
class o{constructor(e){this.element=e,this.$wrappedField="element"}toJSON(){return this.element}async*[Symbol.asyncIterator](){yield this.element}}},5881:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(8346),t),o(n(129),t)},5542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(5827),t),o(n(8037),t),o(n(1777),t),o(n(1415),t),o(n(7312),t)},1777:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1077),t),o(n(4172),t)},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueAsNumber=t.valueAsString=t.valueAsBoolean=void 0
const r=n(2450),o=n(4172)
t.valueAsBoolean=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("boolean"==typeof e)return e
if("string"==typeof e){if("true"===e)return!0
if("false"===e)return!1}const i=Boolean(e)
switch(t){case"strict":o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)})
break
case"coercible":if((0,r.isNothing)(i))return o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)}),null}return i},t.valueAsString=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("string"==typeof e)return e
const i="object"==typeof e?null:String(e)
switch(t){case"strict":o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})
break
case"coercible":(0,r.isNothing)(i)&&o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})}return i},t.valueAsNumber=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("number"==typeof e)return e
const i=Number(e)
switch(t){case"strict":o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)})
break
case"coercible":if(isNaN(i))return o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)}),null}return i}},1077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4409),t),o(n(2506),t),o(n(6418),t)},2506:(e,t,n)=>{function r(e){if(Array.isArray(e))return e
switch(typeof e){case"string":{const t=i[e]
if((0,o.isSome)(t))return t
{const t=Object.freeze(e.split("."))
return i[e]=t,t}}case"number":case"symbol":return[e]
default:throw new TypeError(`${e.toString()} is not a KeyPath`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.keyPathContains=t.keyPathEndsWith=t.keyPathStartsWith=t.keyPathsEqual=t.isKeyPathThis=t.thisKeyPath=t.keysOf=void 0
const o=n(2450),i={}
t.keysOf=r,t.thisKeyPath=Object.freeze([]),t.isKeyPathThis=function(e){return Array.isArray(e)&&0===e.length},t.keyPathsEqual=function(e,t){if(e===t)return!0
const n=r(e),o=r(t)
if(n.length!==o.length)return!1
for(let e=0,t=n.length;e<t;e+=1)if(n[e]!==o[e])return!1
return!0},t.keyPathStartsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[0]===t}},t.keyPathEndsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[n.length-1]===t}},t.keyPathContains=function(e,t){return e===t||r(e).includes(t)}},6853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectCursor=void 0
const r=n(2450),o=n(2879),i=n(2506),s=n(7454)
t.ObjectCursor=class{constructor(e){this.values=[e],this.keyPaths=[i.thisKeyPath],this.savedDepths=[]}get currentValue(){return this.values[this.values.length-1]}get currentKeyPath(){return this.keyPaths[this.keyPaths.length-1]}interject(e,t){this.values.push(e),this.keyPaths.push(t)}reuse(e,t=i.thisKeyPath){this.values.length=0,this.values.push(e),this.keyPaths.length=0,this.keyPaths.push(t),this.savedDepths.length=0}moveTo(e){const t=(0,s.traverse)(this.currentValue,e)
return this.values.push(t),this.keyPaths.push(e),t}moveBack(){const e=this.values.length
if(1===e)throw new Error("Cannot move back past the root of a cursor")
const t=this.savedDepths.length
if(t>0&&e<=this.savedDepths[t-1])throw new Error("Cannot move back past the most recent saved state")
this.values.pop(),this.keyPaths.pop()}saveState(){this.savedDepths.push(this.values.length)}restoreState(){const e=this.savedDepths.pop()
if((0,r.isNothing)(e))throw new Error("Calls to restoreState must balance previous calls to saveState")
this.values.length=e,this.keyPaths.length=e}clone(){const e=(0,o.shallowCloneOf)(this)
return e.values=this.values.slice(),e.keyPaths=this.keyPaths.slice(),e.savedDepths=this.savedDepths.slice(),e}}},4409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectReader=void 0
const r=n(2450),o=n(2879),i=n(6418),s=n(2506),a=n(6853),c=n(7454),l=new Map
class u{constructor(e){this._cursor=new a.ObjectCursor(e)}get currentKeyPath(){return this._cursor.currentKeyPath}has(e){return(0,s.keyPathEndsWith)(this._cursor.currentKeyPath,e)||(0,r.isSome)(this.get(e))}select(e,t=!1){return!t&&(0,s.keyPathsEqual)(this._cursor.currentKeyPath,e)||this._cursor.moveTo(e),this}deselect(){return this._cursor.moveBack(),this}saveSelection(){return this._cursor.saveState(),this}restoreSelection(){return this._cursor.restoreState(),this}get(e=s.thisKeyPath){return(0,s.isKeyPathThis)(e)?this._cursor.currentValue:(0,c.traverse)(this._cursor.currentValue,e)}asBoolean(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsBoolean)(this.get(e),t,String(e))}asNumber(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsNumber)(this.get(e),t,String(e))}asString(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsString)(this.get(e),t,String(e))}*[Symbol.iterator](){const e=this.get()
if((0,r.isNothing)(e))return
const t=u._clone(this)
if(Array.isArray(e)){let n=0
for(const r of e)t.saveSelection(),t._cursor.interject(r,n),yield t,t.restoreSelection(),n+=1}else yield t
u._recycle(t)}reduce(e,t){const n=this.get()
if((0,r.isNothing)(n))return e
if(!Array.isArray(n))return t(e,this)
try{let r=e
for(let e=0,o=n.length;e<o;e+=1)this.saveSelection(),this._cursor.interject(n[e],e),r=t(r,this),this.restoreSelection()
return r}catch(e){throw this.restoreSelection(),e}}map(e){return this.reduce(new Array,(t,n)=>(t.push(e(n)),t))}compactMap(e){return this.reduce(new Array,(t,n)=>{const o=e(n)
return(0,r.isSome)(o)&&t.push(o),t})}applyTo(e,...t){this.saveSelection()
try{const n=e(this,...t)
return this.restoreSelection(),n}catch(e){throw this.restoreSelection(),e}}callOn(e,t,...n){this.saveSelection()
try{const r=e.call(t,this,...n)
return this.restoreSelection(),r}catch(e){throw this.restoreSelection(),e}}clone(){const e=(0,o.shallowCloneOf)(this)
return e._cursor=this._cursor.clone(),e}static optimizeIterationUpToDepth(e){for(let t=0;t<e;t+=1)u._recycle(new u(void 0))}static _clone(e){const t=l.get(e.constructor)
if((0,r.isSome)(t)){const n=t.pop()
if((0,r.isSome)(n))return n.onReuseToIterate(e),n}return e.clone()}onReuseToIterate(e){const t=e._cursor
this._cursor.reuse(t.currentValue,t.currentKeyPath)}static _recycle(e){const t=e.constructor,n=l.get(t)
if((0,r.isSome)(n)){if(n.length>=5)return
e.onRecycleForIteration(),n.push(e)}else e.onRecycleForIteration(),l.set(t,[e])}onRecycleForIteration(){this._cursor.reuse(void 0)}}t.ObjectReader=u},7454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverse=void 0
const r=n(2450),o=n(2506)
t.traverse=function(e,t){if("object"!=typeof e)return e
if(!(0,r.isSome)(e))return e
const n=(0,o.keysOf)(t)
switch(n.length){case 0:return e
case 1:return e[n[0]]
default:let t=e
for(const e of n){const n=t[e]
if("object"!=typeof n)return n
if(!(0,r.isSome)(n))return n
t=n}return t}}},4172:(e,t,n)=>{function r(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function o(e,t,n,o){u({type:"badType",expected:t,actual:`${r(n)} (${n})`,objectPath:(0,d.isSome)(o)&&o.length>0?o:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}function i(e){return!(0,d.isNothing)(e)&&(Object.prototype.hasOwnProperty.call(e,"$incidents")||Object.isExtensible(e))}function s(e){f.nameStack.push(e)}function a(){return 0===f.nameStack.length?["<empty stack>"]:f.nameStack.slice(0)}function c(){f.nameStack.length,f.nameStack.pop()}function l(e,t,n){let r,i=null;(0,d.isSome)(n)&&n.length>0&&(i=e,f.suppressedIncidentPaths.push(n))
try{s(e),r=t()}catch(e){throw e.hasThrown||(o("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===i&&f.suppressedIncidentPaths.pop(),c()}return r}function u(e){f.suppressedIncidentPaths.includes(e.objectPath)||f.incidents.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unexpectedNull=t.catchingContext=t.context=t.recordValidationIncidents=t.endContext=t.getContextNames=t.beginContext=t.messageForRecoveryAction=t.isValidatable=t.unexpectedType=t.extendedTypeof=void 0
const d=n(2450)
t.extendedTypeof=r,t.unexpectedType=o,t.isValidatable=i,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format"
case"defaultValue":return"Default value used"
case"ignoredValue":return"Ignored value"
default:return"Unknown"}}
const f={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()}
t.beginContext=s,t.getContextNames=a,t.endContext=c,t.recordValidationIncidents=function(e){i(e)&&(e.$incidents=f.incidents),f.incidents=[],f.nameStack=[],f.suppressedIncidentPaths=[]},t.context=l,t.catchingContext=function(e,t,n){let r=null
try{r=l(e,t)}catch(e){r=null,(0,d.isSome)(n)&&(r=n(e))}return r},t.unexpectedNull=function(e,t,n){u({type:"nullValue",expected:t,actual:"null",objectPath:(0,d.isSome)(n)&&n.length>0?n:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}},3647:(e,t,n)=>{function r(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function o(e,t){return r("back","button",{...e,actionType:"back"},t)}function i(e,t,n){const r=f.MetricsEventType.page
return u({...e,eventType:r,...t},n,r)}function s(e,t,n,r,o,i){const s=f.MetricsEventType.search,a={...o,eventType:s,term:e,targetType:t,actionType:n}
return(0,h.isSome)(r)&&(a.actionUrl=r),u(a,i,s)}function a(e,t,n=4){const r=f.MetricsEventType.impressions
return u({...e,eventType:r,impressionQueue:"data-metrics",eventVersion:n},t,r)}function c(e,t){const n=f.MetricsEventType.media
return u({...e,eventType:n},t,n)}function l(e,t,n,r){const o=f.MetricsEventType.click
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function u(e,t,n){return{fields:e,includingFields:t.defaultIncludeRequests[n],excludingFields:t.defaultExcludeRequests[n],topic:d(e,t.defaultTopic),shouldFlush:!!(0,h.isSome)(t.shouldFlush)&&t.shouldFlush(e)}}function d(e,t){const n=e.topic
return(0,h.isSome)(n)?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.createMetricsMediaClickData=t.createMetricsMediaData=t.createMetricsImpressionsData=t.createMetricsSearchData=t.createMetricsPageData=t.createMetricsBackClickData=t.createMetricsClickData=t.MediaClickEventBuilder=t.MediaEventBuilder=t.ImpressionsEventBuilder=t.SearchEventBuilder=t.PageEventBuilder=t.BackClickEventBuilder=t.ClickEventBuilder=t.EventBuilder=void 0
const f=n(447),h=n(2450)
class p{constructor(e){this.configuration=e,this.eventFields={}}withEventFields(e){return this.eventFields=e,this}withConfiguration(e){return this.configuration=e,this}withDefaultTopic(e){return this.configuration={...this.configuration,defaultTopic:e},this}withDefaultIncludeRequests(e){return this.configuration={...this.configuration,defaultIncludeRequests:e},this}withDefaultExcludeRequests(e){return this.configuration={...this.configuration,defaultExcludeRequests:e},this}withShouldFlush(e){return this.configuration={...this.configuration,shouldFlush:e},this}}t.EventBuilder=p,t.ClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return r(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.BackClickEventBuilder=class extends p{build(){return o(this.eventFields,this.configuration)}},t.PageEventBuilder=class extends p{constructor(e){super(e),this.timingMetrics={}}withTimingMetrics(e){return this.timingMetrics=e,this}build(){return i(this.eventFields,this.timingMetrics,this.configuration)}},t.SearchEventBuilder=class extends p{constructor(e){super(e.configuration),this.term=e.term,this.targetType=e.targetType,this.actionType=e.actionType,this.actionUrl=null}withTerm(e){return this.term=e,this}withTargetType(e){return this.targetType=e,this}withActionType(e){return this.actionType=e,this}withActionUrl(e){return this.actionUrl=e,this}build(){return s(this.term,this.targetType,this.actionType,this.actionUrl,this.eventFields,this.configuration)}},t.ImpressionsEventBuilder=class extends p{constructor(){super(...arguments),this.impressionsEventVersion=4}withImpressionsEventVersion(e){return this.impressionsEventVersion=e,this}build(){return a(this.eventFields,this.configuration,this.impressionsEventVersion)}},t.MediaEventBuilder=class extends p{build(){return c(this.eventFields,this.configuration)}},t.MediaClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return l(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.createMetricsClickData=r,t.createMetricsBackClickData=o,t.createMetricsPageData=i,t.createMetricsSearchData=s,t.createMetricsImpressionsData=a,t.createMetricsMediaData=c,t.createMetricsMediaClickData=l},4927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cookieValueForKey=t.cookiesOf=void 0
const r=n(2450)
t.cookiesOf=function*(e){if((0,r.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}},t.cookieValueForKey=function(e,t){for(const n of e)if(n.key===t)return n.value
return null}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLinter=void 0
const r=n(4409),o=n(447),i=n(2450),s=n(7771)
t.EventLinter=class{constructor(e){this.options=Object.freeze(e)}get defaultTopic(){return this.options.defaultTopic}applyDeResolutionRules(e,t){const n=new r.ObjectReader(e)
for(const r of t){const t=n.asNumber(r.fieldName)
if((0,i.isNothing)(t))continue
let o=r.magnitude;(0,i.isNothing)(o)&&(o=1048576)
let a=r.significantDigits
if((0,i.isNothing)(a)&&(a=2),o<=0||a<0){e[r.fieldName]=Number.NaN
continue}const c=t/o
e[r.fieldName]=s.reduceSignificantDigits(c,a)}}decorateCommonEventFields(e,t){const n=new r.ObjectReader(e),o=this.options.configuration,s=o.baseFields(t);(0,i.isSome)(s)&&Object.assign(e,s),e.clientBuildType=this.options.environment.buildType,e.resourceRevNum=this.options.environment.jsVersion,e.xpSendMethod="jet-js"
const a=n.asString("pageType"),c=n.asString("pageId")
if((0,i.isSome)(a)&&(0,i.isSome)(c)&&(0,i.isNothing)(e.page)){const n=o.compoundSeparator(t),r=(0,i.isSome)(n)?(0,i.unwrapOptional)(n):"_"
e.page=`${a}${r}${c}`}const l=o.deResolutionRules(t)
this.applyDeResolutionRules(e,l)}decorateMediaEventEvents(e){const t=new r.ObjectReader(e).asNumber("position");(0,i.isSome)(t)&&(e.position=Math.round(t))}lint(e,t={}){const n=new r.ObjectReader(e),s=n.asString("eventType")
this.options.isLoggingEnabled
const a=JSON.parse(JSON.stringify(e)),c=n.asString("topic"),l=(0,i.isSome)(c)?(0,i.unwrapOptional)(c):this.options.defaultTopic
this.decorateCommonEventFields(a,l),s===o.MetricsEventType.media&&this.decorateMediaEventEvents(a)
for(const e of this.options.rules)e.apply(a,t)
return{fields:a}}}},8836:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTimingMetricsBuilderType=t.FetchTimingMetricsBuilder=void 0
const r=n(2450),o=n(900),i=n(2366)
t.FetchTimingMetricsBuilder=class{constructor(){this.metrics=[]}measureParsing(e,t){const n=e.metrics.length>0?[...e.metrics]:[],r=Date.now(),o=t(e),i=Date.now()
return n.length>0&&(n[0].parseStartTime=r,n[0].parseEndTime=i),this.metrics.push(...n),o}measureModelConstruction(e){const t=Date.now(),n=e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}async measureModelConstructionAsync(e){const t=Date.now(),n=await e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}saveModelConstructionTimes(e,t){this.metrics.length>0?(this.metrics[0].modelConstructionStartTime=e,this.metrics[0].modelConstructionEndTime=t):this.metrics.push({modelConstructionStartTime:e,modelConstructionEndTime:t})}decorate(e){if((0,r.isNothing)(e))throw new Error("Cannot decorate null or undefined")
if("object"!=typeof e)throw new Error("View model to decorate must be an object")
if((0,i.isPromise)(e))throw new Error("Cannot decorate a Promise object")
this.metrics.length>0&&(e.$networkPerformance=this.metrics)}},t.fetchTimingMetricsBuilderType=(0,o.makeMetatype)("jet-engine:fetchTimingMetricsBuilder")},8267:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7581),t),o(n(7764),t),o(n(7771),t),o(n(4698),t)},7581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsLocationTracker=void 0
const r=n(4172),o=n(2450),i=n(4698)
class s{constructor(e=0,t=[]){this.rootPosition=e,this.locationStack=t.map(e=>new a(e))}get isEmpty(){return 0===this.locationStack.length}pushLocation(e){this.locationStack.push(new a(e))}popLocation(){var e
return 0===this.locationStack.length?(r.unexpectedType("ignoredValue","non-empty location stack","empty location stack"),null):null===(e=this.locationStack.pop())||void 0===e?void 0:e.location}get currentPosition(){const e=this.lastStackItem
return(0,o.isSome)(e)?e.position:this.rootPosition}setCurrentPosition(e){const t=this.lastStackItem;(0,o.isSome)(t)?t.position=e:this.rootPosition=e}nextPosition(){const e=this.lastStackItem;(0,o.isSome)(e)?e.position+=1:this.rootPosition+=1}get stackItemsToLocations(){return this.locationStack.map(e=>e.location)}get lastStackItem(){const e=this.locationStack.length
return 0===e?null:this.locationStack[e-1]}static locationsByAddingBasicLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildBasicLocation(e,t)),n}static locationsByAddingContentLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildContentLocation(e,t)),n}static pushBasicLocation(e,t){e.locationTracker.pushLocation(s.buildBasicLocation(e,t))}static pushContentLocation(e,t){e.locationTracker.pushLocation(s.buildContentLocation(e,t))}static popLocation(e){return e.locationTracker.popLocation()}static buildBasicLocation(e,t){let n=t;(0,o.isSome)(e.anonymizationOptions)&&(n=e.anonymizationOptions.anonymizationString)
const r={locationPosition:e.locationTracker.currentPosition,locationType:i.targetTypeForMetricsOptions(e),name:n}
return(0,o.isSome)(e.recoMetricsData)&&Object.assign(r,e.recoMetricsData),r}static buildContentLocation(e,t){const n=s.buildBasicLocation(e,t)
if((0,o.isNothing)(e.id))n.idType="sequential",n.id=e.locationTracker.currentPosition.toString()
else{n.idType=i.idTypeForMetricsOptions(e)
let t=e.id;(0,o.isSome)(e.anonymizationOptions)&&(t=e.anonymizationOptions.anonymizationString),n.id=t}return(0,o.isSome)(e.fcKind)&&(n.fcKind=e.fcKind),(0,o.isSome)(e.displayStyle)&&(n.displayStyle=e.displayStyle),n}}t.MetricsLocationTracker=s
class a{constructor(e,t=0){this.location=e,this.position=t}}},7764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSignificantDigits=void 0,t.reduceSignificantDigits=function(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}},4698:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchTermFromRefURL=t.extractSiriRefAppFromRefURL=t.idTypeForMetricsOptions=t.targetTypeForMetricsOptions=void 0
const r=n(2450),o=n(1974)
t.targetTypeForMetricsOptions=function(e){let t=e.targetType
return(0,r.isNothing)(t)&&(t="lockup"),t},t.idTypeForMetricsOptions=function(e){let t=e.idType
return(0,r.isNothing)(t)&&(t="its_id"),t},t.extractSiriRefAppFromRefURL=function(e){const t=new o.URL(e)
if((0,r.isNothing)(t.query))return null
let n=null
for(const e of Object.keys(t.query))if("referrer"===e){"siri"===t.query[e]&&(n="com.apple.siri")
break}return n},t.searchTermFromRefURL=function(e){const t=new o.URL(e),n=t.query
if((0,r.isNothing)(n))return null
const i=n.term,s=t.pathname
return(0,r.isNothing)(i)||(0,r.isNothing)(s)?null:s.endsWith("/search")?i:null}},1415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3647),t),o(n(4927),t),o(n(8535),t),o(n(8836),t),o(n(8267),t),o(n(6094),t)},6094:(e,t,n)=>{function r(e,t){const n=e.optional(a.fetchTimingMetricsBuilderType)
if((0,s.isSome)(n))return e
if(t)throw new Error("Could not find FetchTimingMetricsBuilder in the object graph")
return e.adding(a.fetchTimingMetricsBuilderType,new a.FetchTimingMetricsBuilder)}async function o(e,t,n){const r=(0,i.inject)(a.fetchTimingMetricsBuilderType,t),o=await r.measureModelConstructionAsync(async()=>{const r=n(e,t)
return await Promise.resolve(r)})
if((0,s.isNothing)(o))throw new Error("model builder function returned null or undefined")
return r.decorate(o),o}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndBuildModel=t.requestAndBuildModel=void 0
const i=n(9100),s=n(2450),a=n(8836)
t.requestAndBuildModel=async function(e,t,n,i){const s=r(t,!0),a=await n(e,s)
return await o(a,s,i)},t.parseAndBuildModel=async function(e,t,n,c){const l=r(t,!1),u=(0,i.inject)(a.fetchTimingMetricsBuilderType,l).measureParsing(e,()=>n(e,l))
if((0,s.isNothing)(u))throw new Error("parser function returned null or undefined")
return await o(u,l,c)}},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompoundAction=t.isCompoundAction=void 0,t.isCompoundAction=function(e){return"compoundAction"===(null==e?void 0:e.$kind)},t.makeCompoundAction=function(e,t){return{$kind:"compoundAction",subactions:t,actionMetrics:e}}},9120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyAction=t.isEmptyAction=void 0,t.isEmptyAction=function(e){return"emptyAction"===(null==e?void 0:e.$kind)},t.makeEmptyAction=function(e){return{$kind:"emptyAction",actionMetrics:e}}},9634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4789),t),o(n(573),t),o(n(9120),t),o(n(9634),t),o(n(5599),t),o(n(2170),t),o(n(6158),t),o(n(9400),t),o(n(4362),t)},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeArtworkURLTemplate=void 0
const r=n(4172),o=n(2450),i=n(1974),s=new RegExp("^({w}|[0-9]+(?:.[0-9]*)?)x({h}|[0-9]+(?:.[0-9]*)?)({c}|[a-z]{2}).({f}|[a-z]+)$")
t.makeArtworkURLTemplate=function(e){if(void 0===new i.URL(e).pathname)return r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid URL string",e)}),null
const t=e.substring(e.lastIndexOf("/")+1),n=s.exec(t)
return(0,o.isNothing)(n)||5!==n.length?(r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid artwork URL template ending with {w}x{h}{c}.{f} format",t)}),null):e}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areEqual=t.luminanceFrom=t.dynamicWith=t.named=t.rgbWith=t.htmlWith=t.Color=void 0
const r=n(2450)
t.Color={fromHex:e=>(0,r.isNothing)(e)?null:{$kind:"html",value:e},fromRGB:(e,t,n,r=1)=>({$kind:"rgb",red:e,green:t,blue:n,alpha:r}),named:e=>({$kind:"named",name:e}),dynamicWith:(e,t,n,r)=>({$kind:"dynamic",lightColor:e,lightHighContrastColor:t,darkColor:n,darkHighContrastColor:r}),luminanceFrom:e=>.2126*e.red+.7152*e.green+.0722*e.blue,areEqual(e,n){if((0,r.isNothing)(e))return(0,r.isNothing)(n)
if((0,r.isNothing)(n))return(0,r.isNothing)(e)
const o=e.$kind,i=n.$kind
if("named"===o&&"named"===i){const t=n
return e.name===t.name}if("rgb"===o&&"rgb"===i){const t=e,r=n
return t.red===r.red&&t.green===r.green&&t.blue===r.blue&&t.alpha===r.alpha}if("dynamic"===o&&"dynamic"===i){const r=e,o=n
return t.Color.areEqual(r.lightColor,o.lightColor)&&t.Color.areEqual(r.lightHighContrastColor,o.lightHighContrastColor)&&t.Color.areEqual(r.darkColor,o.darkColor)&&t.Color.areEqual(r.darkHighContrastColor,o.darkHighContrastColor)}return!1}}
const o=t.Color.fromHex
t.htmlWith=o
const i=t.Color.fromRGB
t.rgbWith=i
const s=t.Color.named
t.named=s
const a=t.Color.dynamicWith
t.dynamicWith=a
const c=t.Color.luminanceFrom
t.luminanceFrom=c
const l=t.Color.areEqual
t.areEqual=l},5827:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1235),t),o(n(998),t),o(n(7615),t),o(n(6301),t),o(n(8681),t),o(n(9184),t),o(n(7129),t),o(n(2359),t)},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.menuSeparatorID=void 0,t.menuSeparatorID="com.apple.JetEngine.separator"},9184:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6882:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportBootstrap=void 0
const r=n(6451)
t.exportBootstrap=function(e){"undefined"!=typeof $exportBootstrap&&$exportBootstrap(t=>(function(e){const t=e.$lazyDependencyNames,n=new Set(null!=t?t:[]),o=globalThis.$lazyGlobalNames,i=new Set(null!=o?o:[]),s=new Set([...n,...i]),a=new Map,c=globalThis.$lazyProvider
for(const e of s)a.set(e,r.LazyProxyFactory.makeProxy(e,c))
for(const t of n)e[t]=a.get(t)
for(const e of i)globalThis[e]=a.get(e)}(t),e(t)))},globalThis.has_lazy_support=!0},8706:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6882),t),o(n(4816),t)},4816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyRuntime=t.Runtime=void 0
const n="function"==typeof exportService
class r{constructor(e,t){this.dispatcher=e,this.objectGraph=t}async dispatch(e){return await this.dispatcher.dispatch(e,this.objectGraph)}}t.Runtime=r,t.LegacyRuntime=class extends r{constructor(e,t,n){super(e,t),this.services=n}serviceWithName(e){return this.services[e]}exportingService(e,t){return n&&function(e,t){exportService(e,t)}(e,t),this.services[e]=t,this}}},1219:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof preprocessor&&(globalThis.preprocessor={PRODUCTION_BUILD:!1,CARRY_BUILD:!1,DEBUG_BUILD:!1,INTERNAL_BUILD:!1}),"undefined"==typeof testContent&&(globalThis.testContent={INCLUDE_TEST_CONTENT:!1}),o(n(1219),t),o(n(8045),t),o(n(3922),t),o(n(9891),t),o(n(1121),t),o(n(9247),t),o(n(3907),t),o(n(6534),t),o(n(5817),t),o(n(3043),t),o(n(5037),t),o(n(5937),t),o(n(1222),t)},9247:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3907:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxiedNetwork=void 0,t.ProxiedNetwork=class{constructor(e,t){this.original=e,this.pageIntentInstrumentation=t}async fetch(e){return e.$pageIntentInstrumentation=this.pageIntentInstrumentation,await this.original.fetch(e)}}},6534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.services=t.random=t.plist=t.platform=t.net=t.localizer=t.host=t.cryptography=t.cookieProvider=t.bundle=t.bag=void 0
const r=n(900)
t.bag=(0,r.makeMetatype)("jet-engine:bag"),t.bundle=(0,r.makeMetatype)("jet-engine:bundle"),t.cookieProvider=(0,r.makeMetatype)("jet-engine:cookieProvider"),t.cryptography=(0,r.makeMetatype)("jet-engine:cryptography"),t.host=(0,r.makeMetatype)("jet-engine:host"),t.localizer=(0,r.makeMetatype)("jet-engine:localizer"),t.net=(0,r.makeMetatype)("jet-engine:net"),t.platform=(0,r.makeMetatype)("jet-engine:platform"),t.plist=(0,r.makeMetatype)("jet-engine:plist"),t.random=(0,r.makeMetatype)("jet-engine:random"),t.services=(0,r.makeMetatype)("jet-engine:services")},8037:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1721),t),o(n(9031),t),o(n(447),t),o(n(2024),t),o(n(2450),t)},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9031:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2490),t)},447:(e,t)=>{var n,r,o
Object.defineProperty(t,"__esModule",{value:!0}),t.notInstrumented=t.NotInstrumentedMetricsType=t.MetricsEventType=t.PageInvocationPoint=t.EMPTY_LINTED_METRICS_EVENT=void 0,t.EMPTY_LINTED_METRICS_EVENT={fields:{},issues:[]},(o=t.PageInvocationPoint||(t.PageInvocationPoint={})).pageEnter="pageEnter",o.pageExit="pageExit",o.appExit="appExit",o.appEnter="appEnter",o.backButton="backButton",(r=t.MetricsEventType||(t.MetricsEventType={})).click="click",r.page="page",r.search="search",r.impressions="impressions",r.media="media",r.pageRender="pageRender",function(e){e[e.ActionMetrics=0]="ActionMetrics",e[e.FetchTimingMetrics=1]="FetchTimingMetrics",e[e.PageMetrics=2]="PageMetrics",e[e.ImpressionMetrics=3]="ImpressionMetrics"}(n=t.NotInstrumentedMetricsType||(t.NotInstrumentedMetricsType={})),t.notInstrumented=function(e){switch(e){case n.ActionMetrics:return{data:[],custom:{}}
case n.FetchTimingMetrics:return{}
case n.PageMetrics:return{instructions:[],custom:{}}
case n.ImpressionMetrics:return{id:{id:"",impressionIndex:-1},fields:{},custom:{}}
default:return{}}}},2024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2450:(e,t)=>{function n(e){return null==e}function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.flatMapOptional=t.mapOptional=t.unsafeUnwrapOptional=t.unwrapOptional=t.isSome=t.isNothing=t.unsafeUninitialized=void 0,t.unsafeUninitialized=function(){},t.isNothing=n,t.isSome=r,t.unwrapOptional=function(e){if(n(e))throw new ReferenceError
return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return r(e)?t(e):e},t.flatMapOptional=function(e,t){return r(e)?t(e):e}},2879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shallowCloneOf=void 0,t.shallowCloneOf=function(e){const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e)}},6151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0,t.ExpiringValue=class{constructor(e,t){this._value=e,this._maxAge=t}isValid(){return Date.now()<this._maxAge}get value(){return this.isValid()?this._value:null}}},7312:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2879),t),o(n(6151),t),o(n(900),t),o(n(2366),t),o(n(4805),t),o(n(3087),t),o(n(1974),t)},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMetatype=void 0,t.makeMetatype=function(e){return{name:e}}},2366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0,t.isPromise=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}},4805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RewindableValue=void 0
const r=n(2879)
t.RewindableValue=class{constructor(e){this._values=[e]}get(){return this._values[this._values.length-1]}set(e){this._values[this._values.length-1]=e}save(){this._values.push(this._values[this._values.length-1])}restore(){if(1===this._values.length)throw new RangeError("Calls to restore must balance previous calls to save")
this._values.pop()}clone(){const e=(0,r.shallowCloneOf)(this)
return e._values=this._values.slice(),e}}},3087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.difference=t.symmetricDifference=t.intersection=t.union=t.isSuperset=void 0,t.isSuperset=function(e,t){for(const n of t)if(!e.has(n))return!1
return!0},t.union=function(e,t){const n=new Set(e)
for(const e of t)n.add(e)
return n},t.intersection=function(e,t){const n=new Set
for(const r of t)e.has(r)&&n.add(r)
return n},t.symmetricDifference=function(e,t){const n=new Set(e)
for(const e of t)n.has(e)?n.delete(e):n.add(e)
return n},t.difference=function(e,t){const n=new Set(e)
for(const e of t)n.delete(e)
return n}},1974:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.QueryHandling=void 0
const o=n(2450),i=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,s=/([^=?&]+)=?([^&]*)/g,a=["hash","query","pathname","host"]
var c
!function(e){e.FORM_ENCODED="form-encoded",e.RFC3986="rfc3986"}(c=t.QueryHandling||(t.QueryHandling={}))
class l{constructor(e,t){var n
if(this.query={},this.queryHandling=null==t?void 0:t.queryHandling,(0,o.isNothing)(e))return
let s=e
const c=i.exec(e)
if((0,o.isSome)(c)){let e=c[1]
null!=e&&(e=e.split(":")[0]),this.protocol=null!=e?e:void 0,s=null!==(n=c[3])&&void 0!==n?n:void 0}let u={remainder:s,result:void 0}
for(const e of a){if(void 0===u||void 0===u.remainder)break
switch(e){case"hash":u=r(u.remainder,"#","suffix"),this.hash=null==u?void 0:u.result
break
case"query":u=r(u.remainder,"?","suffix"),void 0!==(null==u?void 0:u.result)&&(this.query=l.queryFromString(u.result,this.queryHandling))
break
case"pathname":u=r(u.remainder,"/","suffix"),void 0!==(null==u?void 0:u.result)&&(this.pathname="/"+u.result)
break
case"host":{const e=r(u.remainder,"@","prefix"),t=null==e?void 0:e.result,n=null==e?void 0:e.remainder
if(void 0!==t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(void 0!==n){const e=n.split(":")
this.host=e[0],this.port=e[1]}break}default:throw new Error("Unhandled case!")}}}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}set(e,t){if(void 0===t)return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}append(e,t){let n,r=this.get(e)
if("query"===e)void 0===r&&(r={}),"string"==typeof t&&(t=l.queryFromString(t,this.queryHandling)),n="string"==typeof r?{existingValue:r,...t}:{...r,...t}
else{void 0===r&&(r="")
let o=r
void 0===o&&(o="")
let i=o
if("pathname"===e){const e=o.length
0!==e&&"/"===o[e-1]||(i+="/")}i+=t,n=i}return this.set(e,n)}param(e,t){return null===e||(void 0===this.query&&(this.query={}),void 0===t?delete this.query[e]:this.query[e]=t),this}removeParam(e){return void 0===e||void 0===this.query||e in this.query&&delete this.query[e],this}path(e){return this.append("pathname",e)}pathExtension(){var e,t
if(void 0===this.pathname)return
const n=null!==(t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split("."))&&void 0!==t?t:[]
return n.filter(function(e){return""!==e}).length<2?void 0:n.pop()}pathComponents(){return void 0===this.pathname?[]:this.pathname.split("/").filter(e=>e.length>0)}build(){return this.toString()}toString(){let e=""
return void 0!==this.protocol&&(e+=this.protocol+"://"),void 0!==this.username&&(e+=encodeURIComponent(this.username),void 0!==this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),void 0!==this.host&&(e+=this.host,void 0!==this.port&&(e+=":"+this.port)),void 0!==this.pathname&&(e+=this.pathname),void 0!==this.query&&0!==Object.keys(this.query).length&&(e+="?"+l.toQueryString(this.query,this.queryHandling)),void 0!==this.hash&&(e+="#"+this.hash),e}static queryFromString(e,t=c.FORM_ENCODED){const n={}
let r=s.exec(e)
for(;null!==r&&r.length>=3;){let o=r[1],i=r[2]
t===c.FORM_ENCODED&&(o=o.replace(/\+/g," "),i=i.replace(/\+/g," "))
const a=decodeURIComponent(o),l=decodeURIComponent(i)
n[a]=l,r=s.exec(e)}return n}static toQueryString(e,t=c.RFC3986){let n="",r=!0
for(const o of Object.keys(e)){r||(n+="&"),r=!1,n+=l.encodeQueryComponent(o,t)
const i=e[o]
null!==i&&i.length>0&&(n+="="+l.encodeQueryComponent(i,t))}return n}static encodeQueryComponent(e,t){return t===c.FORM_ENCODED?encodeURIComponent(e).replace(/%20/g,"+"):encodeURIComponent(e)}static from(e){return new l(e)}static fromComponents(e,t,n,r,o,i){const s=new l(void 0,i)
return s.protocol=e,s.host=t,s.pathname=n,s.query=null!=r?r:{},s.hash=o,s}}t.URL=l},4592:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAugmentedData=void 0
const s=i(n(8156))
t.fetchAugmentedData=async function(e,t,n,r,o){const i=n(e,t,o)
if(null==i)return await Promise.resolve({originalData:t,additionalData:null})
const a=Array.from(i),c=[]
for(const t of a){const n=r(e,t)
if(s.isNull(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}},4876:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6297),t),o(n(4592),t),o(n(2299),t),o(n(2930),t),o(n(7582),t),o(n(2390),t),o(n(8097),t)},9846:function(e,t,n){function r(e,t,n){return h.isNull(e)?null:h.asDictionary(e.attributes,t,n)}function o(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.attributes,t,n)}function i(e,t,n="coercible"){if(h.isNull(e))return null
const r=h.asString(e.attributes,t,n)
return(0,f.isNothing)(r)?null:new Date(r)}function s(e){return!h.isNull(h.asDictionary(e,"attributes"))}function a(e){const t=h.asDictionary(e,"meta")
if((0,f.isNothing)(t))throw new p.MissingFieldError(e,"meta")
return t}function c(e,t){let n
return n=Array.isArray(e)?e:[e],Array.isArray(t)?n.push(...t):n.push(t),n}var l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n)
return u(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.concatObjectPaths=t.requiredMetaAttributeAsNumber=t.requiredMetaAttributeAsString=t.requiredMeta=t.requiredAttributeAsDictionary=t.requiredAttributeAsDate=t.requiredAttributeAsString=t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=t.attributeKeyAsCustomAttributeKey=t.isNotHydrated=t.hasAttributes=t.attributeAsNumber=t.attributeAsBooleanOrFalse=t.attributeAsBoolean=t.attributeAsDate=t.metaAsString=t.attributeAsString=t.attributeAsArrayOrEmpty=t.attributeAsInterface=t.attributeAsDictionary=void 0
const f=n(2450),h=d(n(8156)),p=d(n(8747))
t.attributeAsDictionary=r,t.attributeAsInterface=function(e,t,n){return r(e,t,n)},t.attributeAsArrayOrEmpty=function(e,t){return h.isNull(e)?[]:h.asArrayOrEmpty(e.attributes,t)},t.attributeAsString=o,t.metaAsString=function(e,t,n="coercible"){return h.isNull(e)?null:h.asString(e.meta,t,n)},t.attributeAsDate=i,t.attributeAsBoolean=function(e,t,n="coercible"){return h.isNull(e)?null:h.asBoolean(e.attributes,t,n)},t.attributeAsBooleanOrFalse=function(e,t){return!h.isNull(e)&&h.asBooleanOrFalse(e.attributes,t)},t.attributeAsNumber=function(e,t,n="coercible"){return h.isNull(e)?null:h.asNumber(e.attributes,t,n)},t.hasAttributes=s,t.isNotHydrated=function(e){return!s(e)},t.attributeKeyAsCustomAttributeKey=function(e){return w[e]},t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=function(e){return"customArtwork"===e||"customIconArtwork"===e}
const w={artwork:"customArtwork",iconArtwork:"customIconArtwork",screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:"customScreenshotsByTypeForAd",customVideoPreviewsByTypeForAd:"customVideoPreviewsByTypeForAd"}
t.requiredAttributeAsString=function(e,t){const n=o(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDate=function(e,t){const n=i(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDictionary=function(e,t){const n=r(e,t)
if((0,f.isNothing)(n))throw new p.MissingFieldError(e,c("attributes",t))
return n},t.requiredMeta=a,t.requiredMetaAttributeAsString=function(e,t){const n=a(e),r=h.asString(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.requiredMetaAttributeAsNumber=function(e,t){const n=a(e),r=h.asNumber(n,t)
if((0,f.isNothing)(r))throw new p.MissingFieldError(e,c("meta",t))
return r},t.concatObjectPaths=c},3389:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.BagWrapper=void 0
const s=n(5542),a=i(n(1222)),c=n(8156)
t.BagWrapper=class{constructor(e){this.bag=e.required(a.bag)}get language(){return this.bag.string("language")}get mediaCountryCode(){return this.bag.string("countryCode")}get mediaHost(){return this.bag.url("apps-media-api-host")}get mediaPreviewHost(){return this.bag.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.bag.string("notification-settings-media-api-host")}get mediaApiLanguage(){const e=this.bag.string("language-tag")
return(0,s.isSome)(e)?e:this.bag.string("language")}get edgeEndpoints(){const e=this.bag.array("apps-media-api-edge-end-points")
return void 0===e?[]:(0,c.asArrayOrEmpty)((0,c.asJSONValue)(e))}get mediaEdgeSearchHost(){return this.bag.string("apps-media-api-search-edge-host")}get redirectUrlWhitelistedQueryParams(){let e=(0,c.asArrayOrEmpty)((0,c.asJSONValue)(this.bag.array("processRedirectUrl/whitelistedQueryParams")))
return(0,c.isNullOrEmpty)(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e}}},1031:function(e,t,n){function r(e){return c.isDefinedNonNull(e.attributes)}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.metricsFromMediaApiObject=t.dataCollectionFromResultsListContainer=t.isDataCollectionPartiallyHydrated=t.isDataCollectionHydrated=t.isDataHydrated=t.dataCollectionFromDataContainer=t.dataFromDataContainer=t.requiredStringID=void 0
const a=n(2450),c=s(n(8156))
n(2930),t.requiredStringID=function(e){const t=c.asString(e,"id")
if((0,a.isNothing)(t))throw new Error(`Data.id '${e.id}' is not a string.`)
return t},t.dataFromDataContainer=function(e){const t=c.asArrayOrEmpty(e,"data")
return t.length,1!==t.length?null:t[0]},t.dataCollectionFromDataContainer=function(e){return c.asArrayOrEmpty(e,"data")},t.isDataHydrated=r,t.isDataCollectionHydrated=function(e){for(let t=e.length-1;t>=0;t-=1)if(!r(e[t]))return!1
return!0},t.isDataCollectionPartiallyHydrated=function(e){for(const t of e)if(r(t))return!0
return!1},t.dataCollectionFromResultsListContainer=function(e){return c.asArrayOrEmpty(e,"results.contents")},t.metricsFromMediaApiObject=function(e){return c.asDictionary(e,"meta.metrics")}},8747:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MissingFieldError=void 0
class n extends Error{constructor(e,t){super(),this.dataId=e.id,this.dataType=e.type,this.attributePath=t}}t.MissingFieldError=n},6297:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9846),t),o(n(3389),t),o(n(1031),t),o(n(3734),t),o(n(3665),t),o(n(2299),t),o(n(8156),t),o(n(4029),t),o(n(8747),t)},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2299:function(e,t,n){function r(e){switch(host.platform){case"iOS":return"iPad"===host.deviceModelFamily?"ipad":"iphone"
case"macOS":return"mac"
case"tvOS":return"appletv"
case"watchOS":return"watch"
case"xrOS":return"realityDevice"
default:return null}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.defaultPlatformForClient=void 0
const a=s(n(8156))
t.defaultPlatformForClient=r,t.Request=class{constructor(e,t){if(this.contentsResourceTypes=new Set,this.ids=new Set,this.seeds=new Set,this.relationshipIncludes=new Set,this.relationshipIncludesOnly=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.shouldOmitAutomaticRelationship=!1,this.objectGraph=e,this.platform=r(),!a.isNullOrEmpty(t))if("string"==typeof t)this.href=t
else if(Array.isArray(t)){const e=new Set
for(const n of t)e.add(n.type),this.ids.add(n.id)
1===e.size?this.resourceType=e.values().next().value:e.size>1&&(this.resourceType="contents",this.contentsResourceTypes=e)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.ids.add(t)
return this}withSeeds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.seeds.add(t)
return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingOnlyRelationships(e){for(const t of e)this.relationshipIncludesOnly.add(t)
return this}includingScopedRelationships(e,t){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){null==this.metaIncludes&&(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingAssociateKeys(e,t){null==this.associateIncludes&&(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t="marketing-items"
if(e){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get("editorial-items")
null==e&&(e=new Set),e.add(t),this.scopedRelationshipIncludes.set("editorial-items",e)}else this.relationshipIncludes.add(t)
{null==this.metaIncludes&&(this.metaIncludes=new Map)
let e=this.metaIncludes.get("marketing-items")
null==e&&(e=new Set),e.add("metrics"),this.metaIncludes.set("marketing-items",e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){null==this.scopedAttributeIncludes&&(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){null==this.scopedAvailableInIncludes&&(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return null==this.scopedSparseLimit&&(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}format(e){return this.responseFormat=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!a.isDefinedNonNull(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}}},8156:function(e,t,n){function r(e){return i(e)?null:Array.isArray(e)?e.join("."):e}function o(e,t,n){if(null==e)return n
if(s(t))return e
let r
if("string"==typeof t){if(r=w[t],s(r)){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),w[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function i(e){return null==e}function s(e){return i(e)||0===Object.keys(e).length}function a(e){return null!=e}function c(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return s
if("string"==typeof s)return s
{const e="object"==typeof s?null:String(s)
switch(n){case"strict":h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})
break
case"coercible":i(e)&&h.context("asString",()=>{h.unexpectedType("coercedValue","string",s,r(t))})}return e}}function l(e,t,n){const s=o(e,t,null)
return s instanceof Object&&!Array.isArray(s)?s:(i(s)||h.context("asDictionary",()=>{h.unexpectedType("defaultValue","object",s,r(t))}),a(n)?n:null)}var u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n)
return d(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.asJSONData=t.asJSONValue=t.asBoolean=t.asInterface=t.asDictionary=t.asNumber=t.asDate=t.asString=t.asBooleanOrFalse=t.asArrayOrEmpty=t.isArrayDefinedNonNullAndEmpty=t.isNumber=t.isDefinedNonNullNonEmpty=t.isDefinedNonNull=t.isNullOrEmpty=t.isNull=t.traverse=t.objectPathToString=void 0
const h=f(n(4172)),p=n(2450)
t.objectPathToString=r
const w={}
t.traverse=o,t.isNull=i,t.isNullOrEmpty=s,t.isDefinedNonNull=a,t.isDefinedNonNullNonEmpty=function(e){return a(e)&&0!==Object.keys(e).length},t.isNumber=function(e){if(i(e))return!1
let t
return t="string"==typeof e?parseInt(e):e,!Number.isNaN(t)},t.isArrayDefinedNonNullAndEmpty=function(e){return a(e)&&0===e.length},t.asArrayOrEmpty=function(e,t){const n=o(e,t,null)
return Array.isArray(n)?n:(i(n)||h.context("asArrayOrEmpty",()=>{h.unexpectedType("defaultValue","array",n,r(t))}),[])},t.asBooleanOrFalse=function(e,t){const n=o(e,t,null)
return"boolean"==typeof n?n:(i(n)||h.context("asBooleanOrFalse",()=>{h.unexpectedType("defaultValue","boolean",n,r(t))}),!1)},t.asString=c,t.asDate=function(e,t,n="coercible"){const r=c(e,t,n)
return(0,p.isNothing)(r)?null:new Date(r)},t.asNumber=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s)||"number"==typeof s)return s
{const e=Number(s)
switch(n){case"strict":h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(isNaN(e))return h.context("asNumber",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return e}},t.asDictionary=l,t.asInterface=function(e,t,n){return l(e,t,n)},t.asBoolean=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return null
if("boolean"==typeof s)return s
if("string"==typeof s){if("true"===s)return!0
if("false"===s)return!1}const a=Boolean(s)
switch(n){case"strict":h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(i(a))return h.context("asBoolean",()=>{h.unexpectedType("coercedValue","number",s,r(t))}),null}return a},t.asJSONValue=function(e){if(null==e)return null
switch(typeof e){case"string":case"number":case"boolean":return e
case"object":return Array.isArray(e),e
default:return h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","JSONValue",typeof e)}),null}},t.asJSONData=function(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(h.context("asJSONValue",()=>{h.unexpectedType("defaultValue","object",typeof e)}),null)}},4029:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=n(8156),s=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,a=/([^=?&]+)=?([^&]*)/g,c=["hash","query","pathname","host"]
class l{constructor(e){if(this.query={},(0,i.isNullOrEmpty)(e))return
let t=e
const n=s.exec(e)
if(null!=n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let o={remainder:t,result:void 0}
for(const e of c){if(!o.remainder)break
switch(e){case"hash":o=r(o.remainder,"#","suffix"),this.hash=o.result
break
case"query":o=r(o.remainder,"?","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.query=l.queryFromString(o.result))
break
case"pathname":o=r(o.remainder,"/","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.pathname="/"+o.result)
break
case"host":if(o.remainder){const e=r(o.remainder,"@","prefix"),t=e.result,n=e.remainder
if((0,i.isDefinedNonNullNonEmpty)(t)){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if((0,i.isNullOrEmpty)(t))return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if("query"===e)"string"==typeof t&&(t=l.queryFromString(t)),r="string"==typeof n?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if("pathname"===e){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(null==this.query&&(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&null!=this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append("pathname",e)}pathExtension(){var e
if((0,o.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return(0,i.isNullOrEmpty)(this.pathname)?[]:this.pathname.split("/").filter(e=>e.length>0)}popPathComponent(){if((0,i.isNullOrEmpty)(this.pathname))return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return(0,i.isDefinedNonNullNonEmpty)(this.protocol)&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),(0,i.isDefinedNonNullNonEmpty)(this.host)&&(e+=this.host,this.port&&(e+=":"+this.port)),(0,i.isDefinedNonNullNonEmpty)(this.pathname)&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),null!=this.query&&Object.keys(this.query).length>0&&(e+="?"+l.toQueryString(this.query)),(0,i.isDefinedNonNullNonEmpty)(this.hash)&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=a.exec(e)
for(;null!=n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=a.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r];(0,i.isDefinedNonNullNonEmpty)(o)&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new l(e)}static fromComponents(e,t,n,r,o){const i=new l
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}t.URL=l},2930:function(e,t,n){async function r(e,t,n){const r=await e.network.fetch(t)
if(!r.ok)throw Error(`Bad Status code ${r.status} for ${t.url}`)
const o=Date.now(),i=n(r.body),s=Date.now(),c=function(e,t,n){return f.isNull(e)||0===e.length?null:{...e[0],parseStartTime:t,parseEndTime:n}}(r.metrics,o,s)
return f.isDefinedNonNull(c)&&(i[a.timingValues]=c),i[a.requestedUrl]=t.url.toString(),i}function o(e,t){return e.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return f.isDefinedNonNull(null===(n=t.query)||void 0===n?void 0:n[e])})}async function i(e,t,n,r,c={},l=!1,u){var p,m,y,A
const T=new h.URL(n),b=o(e,T)
for(const e of b)T.removeParam(e)
const S=T.toString()
let P=c.headers
null==P&&(P={}),P.Authorization="Bearer "+r
const C={url:S,excludeIdentifierHeadersForAccount:null!==(p=c.excludeIdentifierHeadersForAccount)&&void 0!==p&&p,alwaysIncludeAuthKitHeaders:null===(m=c.alwaysIncludeAuthKitHeaders)||void 0===m||m,alwaysIncludeMMeClientInfoAndDeviceHeaders:null===(y=c.alwaysIncludeMMeClientInfoAndDeviceHeaders)||void 0===y||y,headers:P,method:c.method,body:c.requestBodyString,timeout:c.timeout},I=await e.network.fetch(C)
try{if(401===I.status||403===I.status){if(l)throw Error("We refreshed the token but we still get 401 from the API")
return t.resetToken(),await t.refreshToken().then(async r=>await i(e,t,n,r,c,!0,u))}if(404===I.status)throw s()
if(!I.ok){const e=null!==(A=I.headers["x-apple-jingle-correlation-key"])&&void 0!==A?A:"N/A",t=new w(`Bad Status code ${I.status} (correlationKey: ${e}) for ${S}, original ${n}`)
throw t.statusCode=I.status,t}const r=t=>{const r=Date.now()
let o
if(f.isNull(t.body)||""===t.body){if(204!==t.status)throw s()
o={}}else o=JSON.parse(t.body)
const i=Date.now()
if(o[a.pageInformation]=f.asJSONData(function(e,t){const n=e.storefrontIdentifier
let r=null
if(f.isDefinedNonNullNonEmpty(n)){const e=n.split("-")
f.isDefinedNonNullNonEmpty(e)&&(r=e[0])}return{serverInstance:t.headers[g],storeFrontHeader:n,language:e.bagLanguage,storeFront:r,environmentDataCenter:t.headers[v]}}(e,t)),t.metrics.length>0){const e={...t.metrics[0],parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}else{const e={pageURL:t.url,parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}if(o[a.contentMaxAge]=function(e){const t=Object.keys(e.headers).find(e=>"cache-control"===e.toLowerCase())
if(f.isNull(t)||""===t)return null
const n=e.headers[t]
if(f.isNullOrEmpty(n))return null
const r=n.match(/max-age=(\d+)/)
return f.isNull(r)||r.length<2?null:f.asNumber(r[1])}(t),Array.isArray(o.data)&&f.isArrayDefinedNonNullAndEmpty(o.data)&&!f.asBooleanOrFalse(c.allowEmptyDataResponse))throw s()
return o[a.requestedUrl]=n,o}
return(0,d.isSome)(u)?u.measureParsing(I,r):r(I)}catch(e){if(e instanceof w)throw e
throw new Error(`Error Fetching - filtered: ${S}, original: ${n}, ${e.name}, ${e.message}`)}}function s(){const e=new w("No content")
return e.statusCode=204,e}var a,c=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n)
return l(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.redirectParametersInUrl=t.fetchData=t.fetchPlist=t.fetchJSON=t.fetch=t.ResponseMetadata=void 0
const d=n(2450),f=u(n(8156)),h=u(n(4029)),p=u(n(8097))
!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(a=t.ResponseMetadata||(t.ResponseMetadata={})),t.fetch=r,t.fetchJSON=async function(e,t){return await r(e,t,e=>(0,d.isSome)(e)?JSON.parse(e):{})},t.fetchPlist=async function(e,t){return await r(e,t,n=>{if((0,d.isSome)(n))return e.plist.parse(n)
throw new Error(`Could not fetch Plist, response body was not defined for ${t.url}`)})},t.fetchData=async function(e,t,n,r){const o=p.buildURLFromRequest(e,n).toString(),s=(Date.now(),await t.refreshToken()),c=await i(e,t,o,s,r,!1,e.fetchTimingMetricsBuilder)
return Date.now(),n.canonicalUrl&&(c[a.requestedUrl]=n.canonicalUrl),c},t.redirectParametersInUrl=o
class w extends Error{}t.NetworkError=w
const g="x-apple-application-instance",v="x-apple-application-site"},7582:function(e,t,n){function r(e,t){const n=d.attributeAsDictionary(e,"platformAttributes")
return u.traverse(n,t)}function o(e,t,n){const o=r(e,t)
return u.isNull(o)?null:u.asDictionary(o,n)}function i(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asString(i,n,o)}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredPlatformAttributeAsDictionary=t.requiredPlatformAttributeAsString=t.platformAttributeAsNumber=t.platformAttributeAsBooleanOrFalse=t.platformAttributeAsBoolean=t.platformAttributeAsString=t.platformAttributeAsArrayOrEmpty=t.platformAttributeAsDictionary=t.hasPlatformAttribute=void 0
const l=n(2450),u=c(n(8156)),d=c(n(9846)),f=c(n(8747))
t.hasPlatformAttribute=function(e,t){const n=r(e,t)
return u.isDefinedNonNullNonEmpty(n)},t.platformAttributeAsDictionary=o,t.platformAttributeAsArrayOrEmpty=function(e,t,n){const o=r(e,t)
return u.isNull(o)?[]:u.asArrayOrEmpty(o,n)},t.platformAttributeAsString=i,t.platformAttributeAsBoolean=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asBoolean(i,n,o)},t.platformAttributeAsBooleanOrFalse=function(e,t,n){const o=r(e,t)
return!u.isNull(o)&&u.asBooleanOrFalse(o,n)},t.platformAttributeAsNumber=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asNumber(i,n,o)},t.requiredPlatformAttributeAsString=function(e,t,n){const r=i(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r},t.requiredPlatformAttributeAsDictionary=function(e,t,n){const r=o(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r}},2390:function(e,t,n){function r(e,t){return l.asInterface(e.relationships,t)}function o(e,t){const n=l.asArrayOrEmpty(e.relationships,[t,"data"])
return 0===n.length?null:(n.length,n[0])}function i(e,t){return l.asArrayOrEmpty(e.relationships,[t,"data"])}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredRelationshipCollectionNonEmpty=t.requiredRelationshipData=t.relationshipViewsCollection=t.relationshipCollection=t.relationshipData=t.relationship=t.hasRelationship=void 0
const l=c(n(8156)),u=n(2450),d=c(n(8747))
t.hasRelationship=function(e,t,n=!0){const o=r(e,t)
return!((0,u.isNothing)(o)||n&&0===o.data.length)},t.relationship=r,t.relationshipData=o,t.relationshipCollection=i,t.relationshipViewsCollection=function(e,t){return l.asArrayOrEmpty(e.views,[t,"data"])},t.requiredRelationshipData=function(e,t){const n=o(e,t)
if((0,u.isNothing)(n))throw new d.MissingFieldError(e,["relationships",t,"data"])
return n},t.requiredRelationshipCollectionNonEmpty=function(e,t){const n=i(e,t)
if(0===n.length)throw new d.MissingFieldError(e,["relationships",t,"data"])
return n}},8097:function(e,t,n){function r(e){switch(e){case"apps":case"app-events":case"activities":case"arcade-apps":case"app-bundles":case"charts":case"contents":case"developers":case"eula":case"in-apps":case"multiple-system-operators":case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"chart-list":default:return"catalog"
case"games/recommendations":return"games/recommendations"
case"categories":case"editorial-items":case"editorial-item-groups":case"editorial-elements":case"groupings":case"multiplex":case"multirooms":case"rooms":case"today":case"collections":return"editorial"
case"ratings":return"ratings"
case"personalization-data":case"reviews":return"me"
case"upsellMarketingItem":case"landing":case"engagement-data":return"engagement"
case"landing:new-protocol":case"recommendations":case"personal-recommendations":return"recommendations"}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.buildURLFromRequest=void 0
const a=n(2450),c=s(n(8156)),l=s(n(4029)),u=s(n(9846))
t.buildURLFromRequest=function(e,t){var n,o
const i=c.isDefinedNonNullNonEmpty(t.href)?t.href:function(e,t){switch(t){case"games/search":return`/v1/games/${r(t)}/${e.mediaCountryCode}`
case"personalization-data":case"reviews":return`/v1/${r(t)}/`
default:return`/v1/${r(t)}/${e.mediaCountryCode}/`}}(e,t.resourceType),s=new l.URL(i)
if(c.isDefinedNonNullNonEmpty(t.resourceType))for(const e of function(e,t){switch(e){case"eula":return void 0===t?[e]:[e,t]
case"landing:new-protocol":case"recommendations":case"searchLanding:see-all":case"search-hints":case"games/recommendations":return[]
case"landing":return void 0===t?["search",e]:["search",e,t]
case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"game-highlights":return["apps"]
case"reviews":return["reviews","apps"]
case"multiplex":return["multiplex"]
case"upsellMarketingItem":return["upsell","marketing-items"]
case"trending-contents":return["search",e]
case"player-highlights":return["players"]
case"search-suggestions":case"games/search":case"games/search-suggestions":case"search-groups":return["search"]
case"chart-list":return["charts"]
default:return[e]}}(t.resourceType,t.targetResourceType))s.append("pathname",e)
if(t.ids.size>1||(0,a.isSome)(t.useIdsAsQueryParam))s.param("ids",Array.from(t.ids).join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
s.append("pathname",encodeURIComponent(e))}if(t.seeds.size>0&&s.param("seeds",Array.from(t.seeds).join(",")),void 0!==t.resourceType){const e=function(e){switch(e){case"user-reviews":return"reviews"
case"customers-also-bought-apps-with-download-intent":return"view/customers-also-bought-apps-with-download-intent"
case"collections":default:return null
case"searchLanding:see-all":return"view/see-all"
case"search-hints":return"search/suggestions"
case"game-highlights":case"player-highlights":return"view/highlights"
case"games/search":case"search-groups":return"groups"
case"games/search-suggestions":case"search-suggestions":return"suggestions"}}(t.resourceType)
c.isDefinedNonNullNonEmpty(e)&&s.append("pathname",e)}if(s.param("platform",null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&s.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t.push("customArtwork"),t}(e)),e.sort(),s.param("extend",e.join(","))}if(c.isDefinedNonNull(t.ageRestriction)&&s.param("restrict[ageRestriction]",t.ageRestriction.toString()),c.isDefinedNonNull(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())s.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludesOnly.size>0?s.param("includeOnly",Array.from(t.relationshipIncludesOnly).sort().join(",")):t.relationshipIncludes.size>0&&s.param("include",Array.from(t.relationshipIncludes).sort().join(",")),t.shouldOmitAutomaticRelationship&&s.param("omit[resource]","autos"),c.isDefinedNonNull(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())s.param(`include[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())s.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())s.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())s.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNullNonEmpty(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),s.param("fields",e.join(","))}if(c.isDefinedNonNull(t.limit)&&t.limit>0&&s.param("limit",`${t.limit}`),c.isDefinedNonNull(t.sparseLimit)&&s.param("sparseLimit",`${t.sparseLimit}`),c.isDefinedNonNull(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())s.param(`sparseLimit[${e}]`,String(n))
c.isDefinedNonNull(t.sparseCount)&&s.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
s.param(`limit[${e}]`,`${n}`)}c.isDefinedNonNullNonEmpty(t.additionalQuery)&&s.append("query",t.additionalQuery),c.isDefinedNonNullNonEmpty(t.searchTerm)&&(((0,a.isNothing)(t.resourceType)||"search-hints"!==t.resourceType)&&(s.append("pathname","search"),s.param("bubble[search]",t.searchTypes.join(","))),s.param("term",t.searchTerm)),c.isDefinedNonNullNonEmpty(t.enabledFeatures)&&s.param("with",t.enabledFeatures.join(",")),c.isDefinedNonNullNonEmpty(t.context)&&s.param("contexts",t.context),c.isDefinedNonNullNonEmpty(t.filterType)&&c.isDefinedNonNullNonEmpty(t.filterValue)&&s.param(`filter[${t.filterType}]`,t.filterValue)
const f=e.mediaApiLanguage
return c.isDefinedNonNull(f)&&c.isNull(t.additionalQuery.l)&&s.param("l",f),c.isDefinedNonNullNonEmpty(t.responseFormat)&&s.param("format[resources]",t.responseFormat),s.host=null!==(o=function(e,t,n){var r
const o=null!==(r=t.pathname)&&void 0!==r?r:""
let i=null
return i=n.isStorePreviewRequest?e.mediaPreviewHost:n.isMediaRealmRequest?e.mediaRealmHost:o.includes("search/landing")?-1!==e.edgeEndpoints.indexOf("landing")?e.mediaEdgeHost:e.mediaHost:e.edgeEndpoints.map(e=>o.includes(e)).reduce(d,!1)?o.includes("search")&&!o.includes("view/see-all")?e.mediaEdgeSearchHost:e.mediaEdgeHost:e.mediaHost,c.isNull(i)&&(i="api.apps.apple.com"),i}(e,s,t))&&void 0!==o?o:void 0,s.protocol="https",s}
const d=(e,t)=>e||t}},n={}
e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function t(e){return r(e)?null:Array.isArray(e)?e.join("."):e}function n(e,t,n){if(null==e)return n
if(!t)return e
let r
if(typeof t===Sq){if(r=rW[t],!r){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),rW[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function r(e){return null==e}function o(e){return r(e)||0===Object.keys(e).length}function i(e){return typeof e!==wU&&null!==e}function s(e){return!(0,Uv.isNothing)(e)&&(typeof e===Sq||Array.isArray(e)?e.length>0:0!==Object.keys(e).length)}function a(e){if(r(e))return!1
let t
return t=typeof e===Sq?parseInt(e):e,!Number.isNaN(t)}function c(e){return!(0,Uv.isNothing)(e)&&typeof e===Sq}function l(e,t){var n
return null!==(n=w(e,t,[]))&&void 0!==n?n:[]}function u(e,t){return d(e,!1,t)}function d(e,o,i){const s=n(e,i,null)
return typeof s===PF?s:(r(s)||Bv.context("asBooleanWithDefault",()=>{Bv.unexpectedType(yH,PF,s,t(i))}),o)}function f(e,o,i=CH){const s=n(e,o,null)
if(r(s))return s
if(typeof s===Sq)return s
{const e=typeof s===Zj?null:String(s)
switch(i){case R_:Bv.context(tk,()=>{Bv.unexpectedType(xB,Sq,s,t(o))})
break
case CH:r(e)&&Bv.context(tk,()=>{Bv.unexpectedType(xB,Sq,s,t(o))})}return e}}function h(e,o,i=CH){const s=n(e,o,null)
if(r(s)||typeof s===PG)return s
{const e=Number(s)
switch(i){case R_:Bv.context(nk,()=>{Bv.unexpectedType(xB,PG,s,t(o))})
break
case CH:if(isNaN(e))return Bv.context(nk,()=>{Bv.unexpectedType(xB,PG,s,t(o))}),null}return e}}function p(e,o,s){const a=n(e,o,null)
return a instanceof Object&&!Array.isArray(a)?a:(r(a)||Bv.context("asDictionary",()=>{Bv.unexpectedType(yH,Zj,a,t(o))}),i(s)?s:null)}function w(e,o,s){const a=n(e,o,null)
return Array.isArray(a)?a:(r(a)||Bv.context("asArray",()=>{Bv.unexpectedType(yH,"array",a,t(o))}),i(s)?s:null)}function g(e,t,n){return p(e,t,n)}function v(e,o,i=CH){const s=n(e,o,null)
if(r(s))return null
if(typeof s===PF)return s
if(typeof s===Sq){if(s===XH)return!0
if(s===kF)return!1}const a=Boolean(s)
switch(i){case R_:Bv.context(rk,()=>{Bv.unexpectedType(xB,PG,s,t(o))})
break
case CH:if(r(a))return Bv.context(rk,()=>{Bv.unexpectedType(xB,PG,s,t(o))}),null}return a}function m(e){if(null==e)return null
switch(typeof e){case Sq:case PG:case PF:return e
case Zj:return Array.isArray(e),e
default:return Bv.context(ok,()=>{Bv.unexpectedType(yH,"JSONValue",typeof e)}),null}}function y(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(Bv.context(ok,()=>{Bv.unexpectedType(yH,Zj,typeof e)}),null)}function A(e){return(0,Nv.isSome)(e)&&typeof e.$kind===Sq}function T(e){return A(e)&&function(e){return(0,Nv.isSome)(uW[e])}(e[tW])&&(0,Nv.isSome)(e.actionClass)&&function(e){return(0,Nv.isSome)(aW[e])}(e.actionClass)}function b(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
n===uk?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}function S(e){if(null==e)return e
const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e),t}function P(e,t){return e instanceof t}function C(e){return!(!(0,Uv.isSome)(e.protocol)||-1===WW.indexOf(e.protocol))}function I(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t+1}function k(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t?e.substring(t+1,n):e}function O(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1))
return n>=0&&r>n?e.substring(n,r):e}function E(e){return{success:!0,value:e,error:null,[JW]:!0}}function R(e){return{success:!1,value:null,error:e instanceof Error?e:new Error(String(e)),[JW]:!0}}async function D(e){return await M(e)}async function _(e){return await e}async function L(e){return await Promise.all(e.map(D))}async function M(e){try{const t="function"==typeof e?e():e
return E(await t)}catch(e){return R(e)}}function x(e){throw new Error(`This method should never be called with value: ${e}`)}function $(e,t,r){return e?Bv.context(t,()=>{let o=e[Nz],i=null
return o?(i=n(o,t),i||(i=F(o,t,r))):(o={},e[Nz]=o,i=F(o,t,r)),i}):null}function F(e,t,n){const r=n()
return e[t]=r,r}function N(e){return g(function(e){return l(e,"meta.associations.editorial-cards.data")}(e)[0])}function B(e,t,n){return(0,Uv.isNothing)(e)?null:p(e.attributes,t,n)}function U(e,t){return r(e)?[]:w(e.attributes,t)}function G(e,t){var n
return null!==(n=U(e,t))&&void 0!==n?n:[]}function j(e,t,n=CH){return r(e)?null:f(e.attributes,t,n)}function V(e,t,n=CH){return r(e)?null:v(e.attributes,t,n)}function H(e,t){return!r(e)&&u(e.attributes,t)}function q(e,t,n=CH){return r(e)?null:h(e.attributes,t,n)}function W(e){return!r(p(e,TF))}function z(e){return!W(e)}function Y(e){return Bz[e]}function J(e){return e===Ex||e===D_}function K(e){if(e.client.isCompanionVisionApp)return GV
switch(e.client.deviceType){case jq:return mq
case $q:return gq
case"tv":return $B
case Yq:return Yq
case zq:return zq
case Fq:return GV
case AV:return AV
default:return null}}function Z(e){return e.client.isPhone?2:1}function Q(e){switch(e.client.deviceType){case jq:return 4
case $q:return 5
case"tv":return 6
case Yq:return 5
case zq:return 10
default:return null}}function X(e){switch(e.client.deviceType){case jq:return 9
case $q:return 12
case"tv":case Yq:return 15
case zq:return 3
case AV:return 12
default:return null}}function ee(e){switch(e.host.clientIdentifier){case hz:case pz:case vz:return[]
default:{const t=K(e)
return function(e,t){const n=new Set
if(n.add(mq),n.add(gq),n.add($B),n.add(Yq),n.add(zq),e.bag.enableVisionPlatform&&n.add(GV),(0,Uv.isSome)(t))for(const e of t)n.delete(e)
return Array.from(n)}(e,(0,Uv.isSome)(t)?new Set([t]):void 0)}}}function te(e){switch(e.client.deviceType){case jq:return 6
case $q:return 10
case Yq:return 12
case Fq:return 10
default:return 8}}function ne(e){let t=null
return e.host.clientIdentifier===Hz?t=qH:e.host.clientIdentifier===Vz&&(t=zq),t}function re(e,t){if(o(t))return null
const n=l(t,`meta.associations.${e}.data`)
return(0,Uv.isNothing)(n)?null:[...n]}function oe(e,t){return n(B(e,"platformAttributes"),null!=t?t:void 0)}function ie(e,t){return s(oe(e,t))}function se(e,t,n){const o=oe(e,t)
return r(o)?null:p(o,n)}function ae(e,t,n){const o=oe(e,t)
return r(o)?[]:l(o,n)}function ce(e,t,n,o=CH){const i=oe(e,t)
return r(i)?null:f(i,n,o)}function le(e,t,n,o=CH){const i=oe(e,t)
return r(i)?null:v(i,n,o)}function ue(e,t,n){const o=oe(e,t)
return!r(o)&&u(o,n)}function de(e,t,n=!0){const r=fe(e,t)
return!!r&&!(!r.data||n&&0===r.data.length)}function fe(e,t){return i(e)?g(e.relationships,t):null}function he(e,t){return g(e.views,t)}function pe(e,t,n){const r=l(t.relationships,[n,kj])
return 0===r.length?null:(r.length>1&&e.console.warn(`there was an array of relationships when only the first was asked for in relationship ${n}`),r[0])}function we(e,t,n=!1){return!de(e,t,!1)&&n?null:l(e.relationships,[t,kj])}function ge(e,t){return l(e.views,[t,kj])}function ve(e,t){var n,o,a
const c=t.href&&t.href.length>0?t.href:function(e,t,n,r){switch(n){case T_:case bq:case mF:return`/v1/${me(n)}/`
default:const o=(0,Uv.isSome)(r)&&r.length>0?r:e.bag.mediaCountryCode,i=`/v1/${me(n)}/${o}`
return t?i:`${i}/`}}(e,t.isMixedMediaRequest,t.resourceType,t.countryCodeOverride),l=new qW(c)
if(s(t.resourceType))for(const e of function(e,t){switch(e){case $U:return void 0===t?[e]:[e,t]
case $D:return[]
case lF:return void 0===t?[aq,e]:[aq,e,t]
case kx:return[Kq]
case bq:return[bq,Kq]
case Cx:return[Cx]
case dj:return[bA,aV]
case ZI:return[aq,e]
case Ix:return[Kq]
case Ox:case gx:return[]
case mF:return[Kq]
default:return[e]}}(t.resourceType,t.targetResourceType))l.append(eV,e)
if(t.isMixedMediaRequest)for(const[e,n]of t.idsByResourceType.entries())l.param(`ids[${e}]`,Array.from(n).sort().join(","))
else if(t.ids.size>1||t.useIdsAsQueryParam)l.param("ids",Array.from(t.ids).sort().join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
l.append(eV,e)}if(void 0!==t.resourceType){const e=function(e){switch(e){case kx:return bq
case Ix:return"view/customers-also-bought-apps-with-download-intent"
case PV:return Jq
case Ox:return ak
case gx:return"search/suggestions"
default:return null}}(t.resourceType)
s(e)&&l.append(eV,e)}if(l.param(MV,null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&l.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e,t){const n=t.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return n.push(Ex),t.includes(sH)&&n.push(sH),n.push($$),n}(0,e)),e.sort(),l.param(EI,e.join(","))}if(i(t.ageRestriction)&&e.bag.enableAgeRatingFilter&&l.param("restrict[ageRestriction]",t.ageRestriction.toString()),t.includeAppBinaryTraitsAttribute&&t.includingScopedAttributes(Kq,[yT]),i(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())l.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludes.size>0&&l.param("include",Array.from(t.relationshipIncludes).sort().join(",")),i(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())l.param(`include[${e}]`,Array.from(n).sort().join(","))
if(i(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())l.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(i(a=t.viewsIncludes)&&a.size>0&&l.param("views",Array.from(t.viewsIncludes).sort().join(",")),i(t.kindIncludes))for(const[e,n]of t.kindIncludes.entries())l.param(`kinds[${e}]`,Array.from(n).sort().join(","))
if(i(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())l.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(i(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())l.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(s(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=Y(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),l.param(Gx,e.join(","))}if(i(t.limit)&&t.limit>0&&l.param("limit",`${t.limit}`),i(t.sparseLimit)&&l.param("sparseLimit",`${t.sparseLimit}`),i(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())l.param(`sparseLimit[${e}]`,String(n))
i(t.sparseCount)&&l.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
l.param(`limit[${e}]`,`${n}`)}s(t.additionalQuery)&&l.append(KG,t.additionalQuery),s(t.searchTerm)&&(((0,Uv.isNothing)(t.resourceType)||t.resourceType!==gx)&&(l.append(eV,aq),l.param("bubble[search]",t.searchTypes.join(","))),l.param(jU,t.searchTerm)),s(t.enabledFeatures)&&l.param(wL,t.enabledFeatures.join(",")),s(t.context)&&l.param(IG,t.context),s(t.filterType)&&s(t.filterValue)&&l.param(`filter[${t.filterType}]`,t.filterValue)
const u=e.bag.mediaApiLanguage
return i(u)&&r(t.additionalQuery.l)&&l.param("l",u),l.host=null!==(o=function(e,t,n){var o
const i=null!==(o=t.pathname)&&void 0!==o?o:""
let s=null
return s=n.isStorePreviewRequest?e.bag.mediaPreviewHost:n.isMediaRealmRequest?e.bag.mediaRealmHost:i.includes("search/landing")?-1!==e.bag.edgeEndpoints.indexOf(lF)?e.bag.mediaEdgeHost(e):e.bag.mediaHost:n.resourceType===mF&&(0,Uv.isSome)(e.bag.appDistributionMediaAPIHost)?e.bag.appDistributionMediaAPIHost:n.isMixedMediaRequest&&e.bag.mediaAPICatalogMixedShouldUseEdge?e.bag.mediaEdgeHost(e):e.bag.edgeEndpoints.map(e=>i.includes(e)).reduce(Kz,!1)?i.includes(aq)&&!i.includes(ak)?e.bag.mediaEdgeSearchHost:e.bag.mediaEdgeHost(e):e.bag.mediaHost,r(s)&&(s="api.apps.apple.com"),s}(e,l,t))&&void 0!==o?o:void 0,l.protocol=C_,l}function me(e){switch(e){case Kq:case Vq:case FV:case xq:case VF:case Jq:case Qj:case $U:case FH:case yM:case kx:case Ix:return ik
case VN:case BH:case Nq:case vj:case d$:case TV:case Cx:case fF:case _N:case _q:case PV:return Nk
case __:return __
case T_:case bq:return"me"
case dj:case lF:return sk
case $D:case gL:return QV
case kI:return sk
case mF:return"listing"
default:return ik}}function ye(e){if((0,Uv.isNothing)(e)||""===e)return null
const t=Zz.exec(e)
return null===t||4!==t.length&&5!==t.length?null:{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,alpha:(0,Uv.isSome)(t[4])?parseInt(t[4],16)/255:void 0,type:bV}}function Ae(e,t,n,r){return{red:e,green:t,blue:n,alpha:r,type:bV}}function Te(e){return.2126*e.red+.7152*e.green+.0722*e.blue}function be(e,t=84){if((0,Uv.isNothing)(e))return!1
switch(e.type){case bV:return 100*Te(e)<t
case yN:return e.name===MO
default:return!1}}function Se(e){return{name:e,type:yN}}function Pe(e,t){return{lightColor:e,darkColor:t,type:Dx}}function Ce(e,t){return!(0,Uv.isNothing)(e)&&!(0,Uv.isNothing)(t)&&(e.type===bV&&t.type===bV?e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha:e.type===yN&&t.type===yN?e.name===t.name:e.type===Dx&&t.type===Dx&&Ce(e.lightColor,t.lightColor)&&Ce(e.darkColor,t.darkColor))}function Ie(e,t){if((0,Uv.isNothing)(e))return!1
const n=function(e){return typeof e===Zj&&null!==e&&(fV in e&&e.type===yk)}(e)?e:ke(e)
return function(e){if(typeof e!==Zj||null===e)return!1
const t=e
return"colorHex"in t&&typeof t.colorHex===Sq&&"maxSaturation"in t&&typeof t.maxSaturation===PG&&"maxBrightness"in t&&typeof t.maxBrightness===PG}(t)?n.saturation<=t.maxSaturation||n.brightness<=t.maxBrightness:n.hue>=t.minHue&&n.hue<=t.maxHue}function ke(e){const t=e.red,n=e.green,r=e.blue,o=Math.max(t,n,r),i=o-Math.min(t,n,r),s=100*o,a=0===o?0:i/o*100
let c=0
if(0!==i)switch(o){case t:c=60*((n-r)/i+(n<r?6:0))
break
case n:c=60*((r-t)/i+2)
break
case r:c=60*((t-n)/i+4)}return c=(c+360)%360,{type:yk,hue:c,saturation:a,brightness:s}}function Oe(e){return r(e)||""===e?null:(-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/")))}function Ee(e){if(r(e))return null
const t=function(e){return r(e)?null:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e)
return r(t)?null:t.getTime()}function Re(e){if(r(e))return null
const t=new Date(e)
return t.setHours(0,0,0,0),t}function De(e){return r(e)?null:_e(e)}function _e(e){const t=new Date(e.getTime())
return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function Le(e,t){return r(e)||r(t)?null:Math.ceil((t.getTime()-_e(e).getTime())/36e5)}function Me(e,t,n,r=!1){return $(t,`dataHasDeviceFamily.${n}`,()=>!(!t||!n)&&-1!==Fe(e,t,r).indexOf(n))}function xe(e,t,n,r=!1){var o
return null!==(o=Me(e,t,n,r))&&void 0!==o&&o&&1===Fe(e,t,r).length}function $e(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
return n.length===o.size&&n.every(e=>o.has(e))}function Fe(e,t,n=!1){const r=G(t,qG)
if(0===r.length&&n){const r=we(t,Kq)
if((0,Uv.isSome)(r))for(const t of r){const r=Fe(e,t,n)
if(s(r))return r}}return r}function Ne(e,t){var n
const r=e.optional(rY.metatype)
return null===(n=null==r?void 0:r.currentTreatmentForExperiment(t))||void 0===n?void 0:n.identifier}function Be(e){return Ne(e,qv.ProductPagePreloading)===oY}function Ue(e){return e.bag.enableProductPageVariants}function Ge(e,t,r){if(void 0===r&&(r=function(e){const t=function(e){return Ne(e,qv.ProductPageVariants)}(e)
return t}(e)),o(t.id))return
const i={adamID:t.id,productPageId:iY,treatmentPageIdMap:{[iY]:iY},experimentIdMap:{},experimentLocaleMap:{}}
return o(n(t,tV,null))||(function(e,t,r){const i=n(r,"meta.cppData",null)
if(o(i))return
const a=f(i,IU)
s(a)&&(t.productPageId=a)}(0,i,t),function(e,t,r,i,a){const c=n(a,"meta.experimentData",null)
if(o(c))return
const l=n(c,r,null)
if(o(l))return
const u=f(l,XR),d=f(l,CP)
let h=null
const p=n(l,"trafficAllocation",null)
h=s(p)?function(e,t,n){if(void 0===n||o(n))return iY
for(const[e,r]of Object.entries(t))if(s(r)&&-1!==r.indexOf(n))return e
return iY}(0,p,i):function(e,t,n){const r=Ke(e,t,`customAttributes.${n}`)
if(o(r))return iY
const i=Object.keys(r)[0]
return o(i)?iY:i}(e,a,r),s(h)&&s(u)&&(t.treatmentPageIdMap[r]=h,t.experimentIdMap[r]=u,s(d)&&(t.experimentLocaleMap[r]=d))}(e,i,iY,r,t)),i}function je(e,t,r,s,a){if(o(t))return null
let c
if(r.productPageId!==iY){const e=r.treatmentPageIdMap[iY]
c=a?[`${r.productPageId}.${iY}.${s}`,`${iY}.${e}.${s}`,`${iY}.${iY}.${s}`]:[`${r.productPageId}.${iY}.${s}`,`${iY}.${iY}.${s}`]}else{const e=r.treatmentPageIdMap[iY]
c=[`${iY}.${e}.${s}`,`${iY}.${iY}.${s}`]}for(const e of c){const r=n(t,e)
if(i(r))return r}return null}function Ve(e){return(0,Uv.isNothing)(e)||e.productPageId===iY?null:e.productPageId}function He(e,t){return Ve(Ge(e,t))}function qe(e,t){const n=Ke(e,t,ZO)
return null===n||o(n)?null:Object.keys(n).filter(e=>e!==iY)}function We(e){const t={}
Ye(e,MM)&&(t[IP]=e.productPageId)
const n=e.treatmentPageIdMap[iY],r=e.experimentIdMap[iY],o=e.experimentLocaleMap[iY]
return Ye(e,hM)&&(t.pageVariantId=n,t.pageExperimentId=r,t.pageExperimentLocale=o),t}function ze(e){const t={}
Ye(e,MM)&&(t[IP]=e.productPageId)
const n=e.treatmentPageIdMap[iY],r=e.experimentIdMap[iY],o=e.experimentLocaleMap[iY]
return Ye(e,hM)&&(t.variantId=n,t[XR]=r,t[CP]=o),t}function Ye(e,t){if(r(e))return!1
switch(t){case MM:return s(e.productPageId)&&e.productPageId!==iY
case hM:return s(e.experimentIdMap)
default:x(t)}}function Je(e,t,n){for(const r of n){const n=He(e,r)
i(n)&&t.addingQuery(`ppid[apps:${r.id}]`,`${n}`)}}function Ke(e,t,n,r,o){if(r||(r=nt(e,t)),(0,Uv.isNothing)(r))return null
let i=se(t,r,n)
return i||(i=B(t,n,o)),i}function Ze(e,t,n,r){const i=null!=r?r:nt(e,t)
if((0,Uv.isNothing)(i))return[]
let s=ae(t,i,n)
return o(s)&&(s=G(t,n)),s}function Qe(e,t,n,r,o=CH){let i
const s=null!=r?r:nt(e,t)
return(0,Uv.isSome)(s)&&(i=ce(t,s,n,o)),i||(i=j(t,n,o)),i}function Xe(e,t,n,o,i=CH){if(o||(o=nt(e,t)),(0,Uv.isNothing)(o))return null
let s=le(t,o,n,i)
return r(s)&&(s=V(t,n,i)),s}function et(e,t,n,o){if(o||(o=nt(e,t)),(0,Uv.isNothing)(o))return!1
let i=le(t,o,n)
return r(i)&&(i=H(t,n)),i}function tt(e,t,n,o=CH){const i=nt(e,t)
if((0,Uv.isNothing)(i))return null
let s=function(e,t,n,o=CH){const i=oe(e,t)
return r(i)?null:h(i,n,o)}(t,i,n,o)
return r(s)&&(s=q(t,n)),s}function nt(e,t,n){const o="bestAttributePlatformFromData",i=(0,Uv.isSome)(n)?`${o}.${n}`:o
return $(t,i,()=>{const o=$e(e,t,[mq,gq,qF],!0),i=xe(e,t,BG),s=xe(e,t,Yq),a=xe(e,t,zq),c=xe(e,t,GV)
let l=null
if(i?l=Gj:s?l=ZV:o?l=pq:a?l=zq:c&&(l=HV),!r(l))return l
const u=function(e,t){const n=rt(e)
if(null===n)return[]
switch(n){case pq:return t===yz||t===mz?[HV,pq,Gj,ZV]:[pq,Gj,ZV,HV]
case ZV:return[ZV,pq,Gj,HV]
case Gj:return[Gj,pq,ZV,HV]
case zq:return[pq,zq,ZV,HV]
case HV:return[HV,pq,Gj,ZV]
default:return[n]}}(e,n)
for(const e of u)if(ie(t,e))return e
return rt(e)})}function rt(e){var t
if(null===(t=e.activeIntent)||void 0===t?void 0:t.attributePlatform)return e.activeIntent.attributePlatform
switch(e.client.deviceType){case jq:case $q:return pq
case"tv":return Gj
case Yq:return ZV
case zq:return zq
case Fq:return HV
default:return null}}function ot(e,t,n,r,o){const i=Y(r)
if((0,Uv.isNothing)(i))return null
const a=je(0,Ke(e,t,ZO,o),n,i,J(i))
return s(a)?p(a):Ke(e,t,r,o)}function it(e,t,n,r,o){const i=Y(r)
if((0,Uv.isNothing)(i))return null
const a=je(0,Ke(e,t,ZO,o),n,i,J(i))
return s(a)?f(a):Qe(e,t,r)}function st(e){return null!==sY||(sY={bundleIdFromData:t=>Qe(e,t,oq),isSystemAppFromData:e=>H(e,VU),isUnsupportedDeletableSystemAppFromData:e=>!1,adamIdFromSystemBundleId(e){}}),sY}function at(e,t,n=Wv.All){let o=!1
return n&Wv.ThirtyTwoBit&&(o=o||function(e,t){return et(e,t,Gy)||et(e,t,jy)}(e,t)),n&Wv.UnsupportedSystemDeletableApps&&(o=o||function(e,t){return $(t,"shouldFilterDeletableSystemApp",()=>{const n=st(e)
if(!n.isSystemAppFromData(t))return!1
const r=n.bundleIdFromData(t),o=e.host.deviceModel,s=o.startsWith(qy),a=o.startsWith(Wy)
let c
switch(c=!!Wf(e,"12.3")||e.bag.isTVAppEnabled,r){case"com.apple.Bridge":case"com.apple.Passbook":return!s
case"com.apple.Photo-Booth":return!a
case"com.apple.tv":return!c
case"com.apple.videos":return c
case"com.apple.iCloudDriveApp":return!0
case"com.apple.facetime":case"com.apple.mobilephone":return!lt(e,"any-telephony")||!lt(e,"venice")
case"com.apple.Fitness":if(a||s){let t=!1
return i(e.user.isFitnessAppInstallationAllowed)&&(t=e.user.isFitnessAppInstallationAllowed),!t}return!0
case"com.apple.measure":return!lt(e,"arkit")
case"com.apple.Jellyfish":return!lt(e,"front-depth-camera")
case Vy:case Hy:return!0
case"com.apple.NanoHeartRhythm":return!e.client.isElectrocardiogramInstallationAllowed
case zy:return!lt(e,"magnetometer")
case"com.apple.NanoOxygenSaturation.watchkitapp":return!e.client.isScandiumInstallationAllowed
case Yy:case"com.apple.NanoRadio":return!0
case Jy:return!e.client.isCharonSupported
case Ky:return!e.client.isMandrakeSupported
case"com.apple.GenerativePlaygroundApp":return!lt(e,"generative-model-systems")
case Fk:const t=a&&e.clientCapabilities.isEnabled(eY)
return!(s||t)}return!1})}(e,t)),n&Wv.UnsupportedWatchAppOnWatchClient&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const n=et(e,t,zV),r=t.type===xq
return e.host.clientIdentifier===Vz&&!n&&!r})}(e,t)),n&Wv.DisabledMerchandisableIAPs&&(o=o||function(e,t){return t.type===FH&&!s(p(t,_F))&&!s(p(t,Z_))&&!H(t,"isMerchandisedEnabled")}(0,t)),n&Wv.LegacyApps&&(o=o||function(e,t){return $(t,"shouldFilterLegacyApps",()=>{switch(Qe(e,t,oq)){case"com.apple.mobileme.fmip1":case Vy:return!0}return!1})}(e,t)),n&Wv.LegacyProductionMacOSInstaller&&(o=o||function(e,t){return $(t,"isLegacyMacOSInstaller",()=>(Qe(e,t,oq),!1))}(e,t)),n&Wv.UnsupportedPlatform&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatform",()=>{if(t.type!==Kq&&t.type!==xq)return!1
const n=cf(e,t),r=pf(0,t,e.appleSilicon.isSupportEnabled)
return!yf(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&Wv.UnsupportedPlatformForMacCharts&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPlatformForCharts",()=>{if(t.type!==Kq&&t.type!==xq)return!1
const n=cf(e,t),r=pf(0,t,!0)
return!yf(e,t,n,e.client.deviceType,r,!1)})}(e,t)),n&Wv.UnsupportedPreorders&&(o=o||function(e,t){return $(t,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!H(t,eq))return!1
if(t.type!==Kq)return!1
const n=cf(e,t),r=pf(0,t,e.appleSilicon.isSupportEnabled)
return!bf(0,n,e.client.deviceType,r,!1)})}(e,t)),n&Wv.MinimumOSRequirement&&(o=o||ct(e,t)),n&Wv.SADWatchApps&&(o=o||function(e,t){const n=H(t,VU),r=!et(e,t,nO)&&et(e,t,AG)
return n&&r}(e,t)),n&Wv.MinimumCompanionOSRequirement&&(o=o||function(e,t){return e.client.deviceType===zq&&(!et(e,t,AG)&&!et(e,t,tO)&&!function(e,t){return!(!r(t)&&0!==t.length)||e.client.isPairedSystemVersionAtLeast(t)}(e,ce(t,nt(e,t),uH)))}(e,t)),n&Wv.MacOSCompatibleIOSBinary&&(o=o||function(e,t){return e.client.deviceType===Yq&&(et(e,t,Q_,rt(e))&&!e.appleSilicon.isSupportEnabled)}(e,t)),n&Wv.MacOSRosetta&&(o=o||function(e,t){const n=cf(e,t)
return!(e.client.deviceType!==Yq||!n.includes(Yq))&&!Tf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable)}(e,t)),n&Wv.VisionOSCompatibility&&(o=o||function(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=ue(t,pq,rO)
return!(cf(e,t).indexOf(Fq)>-1||n)}(e,t)),n&Wv.SADMinimumOSRequirement&&(o=o||function(e,t){return!!st(e).isSystemAppFromData(t)&&ct(e,t)}(e,t)),o}function ct(e,t){return!(!e.client.isPhone||!et(e,t,AG)||function(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.client.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(o,i,s)}(e,Qe(e,t,LF)))||!Wf(e,gf(e,t,e.appleSilicon.isSupportEnabled))}function lt(e,t,n){return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp([t],!1)}function ut(e){if((0,Uv.isNothing)(e))return
const t=e.toLocaleLowerCase()
return function(e){return aY.includes(e)}(t)?t:void 0}function dt(e){return e.startsWith("id")?e.substring(2):e}function ft(e){return A(e)&&function(e){return(0,Nv.isSome)(lY[e])}(e.$kind)}function ht(e){return T(e)&&e[tW]===xy}function pt(e){var t
switch(e){case B_:return"arcadeAskToBuy"
case ij:return dy
case Mx:return ly
case U_:return"arcadeLaunchRepair"
case jV:return F_
case"topShelfATV":return"arcadeTopShelfATV"
case"topShelfATVClickThrough":return"arcadeTopShelfATVClickThrough"
case sj:return"arcadeTodayCard"
case G_:return"arcadeStoryCanvas"
case IF:return IF
case FB:return FB
case qk:return qk
default:return null!==(t=e)&&void 0!==t?t:dy}}function wt(e){return T(e)&&e[tW]===Oy}function gt(e){return T(e)&&e[tW]===Kk}function vt(e){return ft(e)&&e[tW]===jk}function mt(e){return function(e){return A(e)&&function(e){return(0,Nv.isSome)(jY[e])}(e[tW])}(e)&&e[tW]===ay}function yt(e,t){const n=l(t,kj)
return n.length>1&&e.console.warn("tried to extract data from container but more than one member present"),1!==n.length?null:n[0]}function At(e){return l(e,kj)}function Tt(e){const t=XI,r=n(e,HE)
return e.label===t||i(r)}function bt(e){return l(e,FC)}function St(e){return p(e,LR)}function Pt(e,t){return t&&t.remainingContent?t.remainingContent.slice(0,t.maxPerPage):[]}function Ct(e,t,n){const r={...t}
if(t&&t.remainingContent){const e=It(0,t.remainingContent,t.maxPerPage,n)
r.remainingContent=e}return r}function It(e,t,n,r){return t.slice(n,null!=r?r:t.length)}function kt(e,t=!1,n=!1,r=n6.Default){const o=function(e,t){let n
switch(e.host.clientIdentifier){case hz:case pz:case vz:n=!1
break
default:n=e.client.supportsHEIF}return t?n?b$:lL:n?b$:mE}(e,t)
return function(e,t,n=!1,r=n6.Default){return new PJ(t,t===b$?60:70,n)}(0,o,n,r)}function Ot(e,t,n=0,r=0,o=null,i=null,s=null){const a=new QW(t,n,r,[kt(e,!1,!1,n6.Default)])
return a.backgroundColor=o,a.textColor=i,a.checksum=s,a}function Et(e){return`resource://${e}`}function Rt(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}function Dt(e,t){var n
const r=null!==(n=t.excludingFields)&&void 0!==n?n:[]
return r.push("amsMetricsID"),new zJ(t.fields,t.includingFields,r,t.topic,t.shouldFlush)}function _t(e,t,n,r,o,i){const s={}
Object.assign(s,r),s[Rj]=vU,s[AM]=n,s[iS]=t
const a=["impressionsSnapshot",mU]
return a.push(sS),o&&a.push(...o),Ft(e,s),Dt(0,new zJ(s,a,[],$t(e,s),xt(e,s,null,i)))}function Lt(e,t,n,r,o,i,s){const a={}
Object.assign(a,i),a[jU]=t,a[AM]=n,a[GB]=r,o&&(a[TN]=o),a[Rj]=aq
const c=[TM]
return s&&c.push(...s),Ft(e,a),Dt(0,new zJ(a,c,[],$t(e,a),xt(e,a)))}function Mt(e,t,n,r,o){const i={}
Object.assign(i,t),i[Rj]=BV,i[bN]="data-metrics",i[SN]=4
const s=[BV,mU,TM]
return s.push(sS),n&&s.push(SM),r&&s.push(PN),o&&s.push("impressionsAppendix"),Ft(e,i),Dt(0,new zJ(i,s,[SN],$t(e,i),xt(e,i)))}function xt(e,t,n=null,r){var o,i
const a=t[Rj]
let c=!1
if(!s(a))return c
const l=null!=r&&r
switch(a){case vU:c=u(t,WJ.hasIAdData)||l
break
case nR:c=!0
break
case BV:c=u(t,WJ.hasIAdData),t[bN]!==tR||(null===(o=null==n?void 0:n.adPageInfo)||void 0===o?void 0:o.placementType)!==NH&&(null===(i=null==n?void 0:n.adPageInfo)||void 0===i?void 0:i.placementType)!==rH||(c=!0)
break
case eW:c=e.host.clientIdentifier===zz&&(u(t,WJ.hasIAdData)||l)}return e.host.clientIdentifier,c}function $t(e,t){return t[Xx]||e.bag.metricsTopic}function Ft(e,t){e.bag.isMetricsAb2DataFallbackEnabled&&(0,Nv.isSome)(e.experimentCache)&&(t.alt_ab2_data=JSON.stringify(e.experimentCache.createAb2Data()))}function Nt(e){var t
const n={}
if(!e)return n
Object.assign(n,e.baseFields),e.pageUrl?n[yU]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(n[yU]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(n,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(n,e.mercuryMetricsData),e.productVariantData&&Object.assign(n,We(e.productVariantData)),e.adPageInfo&&i(e.adPageInfo.pageFields[WJ.hasIAdData])&&(n[WJ.hasIAdData]=e.adPageInfo.pageFields[WJ.hasIAdData])
const r=null===(t=e.adPageInfo)||void 0===t?void 0:t.pageFields[hG]
return i(r)&&(n[hG]=r),ch(n)}function Bt(e){return A(e)&&"TodayCard"===e[tW]}function Ut(e,t){return s(B(t,CG))}function Gt(e,t,n,o,i=!0,s){if(!o.isAdvert)return void Vt(e,t,n,o)
n.searchAdOpportunity=function(e,t,n,o){const i=function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=B(t,CG),a=j(t,"iad.impressionId"),c=j(t,"iad.privacy"),l=j(t,fM),u=new ZJ(c)
u.title=e.adsLoc.string("IAD_PRIVACY_MARKER_BUTTON_TITLE")
const d=Bf(e,t)?TB:dM,f=H(t,eq)?NV:Wq,h=Yt(0,n),p=new kY(i,t.id,l,d,"markerPress",f,h),w=Wt(i,n,a,o),g=zt(0,u,p)
return new QJ(i,s,w,a,g)}(e,t,n,o)
return new KJ(i.instanceId,i.eventPayloads,i)}(e,t,o.pageInformation,s)
const a=n.searchAdOpportunity.searchAd,c=Bf(e,t)?TB:dM,l=Yt(0,o.pageInformation),u=j(t,fM),d=H(t,eq)?NV:Wq,f=new kY(a.instanceId,t.id,u,c,Gb,d,l)
n.clickAction=zt(0,n.clickAction,f)
const h=new kY(a.instanceId,t.id,u,c,jb,d,l)
n.buttonAction=zt(0,n.buttonAction,h),n.itemBackground=e.clientCapabilities.isEnabled("insetAdItemBackground")?Vb:"ad",n.offerDisplayProperties&&i&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,wj,"ad")),H(t,"iad.format.userRating")||(n.rating=null,n.ratingCount=null),Vt(e,t,n,o)}function jt(e){const t=u(B(e,CG),"passthroughAdInfo.deepLinkEligible"),n=u(e,"meta.passthroughAdInfo.deepLinkEligible")
return t||n}function Vt(e,t,n,o){const i=_h(e,t,n,dh(e,t,n.icon,null),o,!0)
!function(e,t,n){var o,i,s,a,c,l,u,d,f,h,p,w
const g=null!==(i=null===(o=t.searchAdOpportunity)||void 0===o?void 0:o.searchAd)&&void 0!==i?i:t.searchAd
if(r(g))return
null===(s=t.clickAction)||void 0===s||s.actionMetrics.clearAll(),t.clickAction&&Qs(e,t.clickAction,n,!0)
const v=n.pageInformation,m={actionType:"ad_transparency"};(null==v?void 0:v.adPageInfo)&&Object.assign(m,v.adPageInfo.clickFields),(null===(c=null===(a=null==n?void 0:n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType)===zH&&(0,Uv.isSome)(null===(l=null==n?void 0:n.adsMetricsData)||void 0===l?void 0:l.iAdSlotId)&&(m[z$]=null===(u=null==n?void 0:n.adsMetricsData)||void 0===u?void 0:u.iAdSlotId),(0,Uv.isSome)(null===(d=null==n?void 0:n.adsMetricsData)||void 0===d?void 0:d.iAdDuplicateLayoutType)&&(m[NM]=null===(f=null==n?void 0:n.adsMetricsData)||void 0===f?void 0:f.iAdDuplicateLayoutType)
const y=_t(e,t.adamId,Qq,m)
null!==(w=null===(p=null===(h=null==v?void 0:v.adPageInfo)||void 0===h?void 0:h.shouldIncludeAdRotationFields)||void 0===p?void 0:p.call(h,e))&&void 0!==w&&w&&y.includingFields.push(PN),g.transparencyAction.actionMetrics.addMetricsData(y)}(e,n,i),Dh(e,n,i,i.pageInformation.adPageInfo)}function Ht(e){var t
return[Hb,"U","I",(null!==(t=null==e?void 0:e.artwork)&&void 0!==t?t:[]).length].join("")}function qt(e,t){let n
const r=null==t?void 0:t.adPageInfo.placementType
if((0,Nv.isSome)(r))try{n=e.ads.getIdentifierForMissedOpportunity(r)}catch{n=e.random.nextUUID(),Zt(e,`Error: getIdentifierForMissedOpportunity threw exception. Assigned ${n}`)}else n=e.random.nextUUID(),Zt(e,`Error: placementType was null or empty. Assigned ${n}`)
const o=Wt(n,t,e.random.nextUUID())
return new KJ(n,o)}function Wt(e,t,n,r){const o=null==t?void 0:t.baseFields.pageId,i=typeof o===Sq?o:Dq
return{placed:{adInstanceId:e,impressionId:null!=n?n:void 0,slot:null!=r?r:void 0,pageIdentifier:i},pageEnter:{pageIdentifier:i},pageExit:{pageIdentifier:i},onScreen:{adInstanceId:e},offScreen:{adInstanceId:e},visible:{adInstanceId:e},completed:{adInstanceId:e}}}function zt(e,t,n){const r=new XJ(n),o=new MJ([r,t])
return o.title=t.title,o}function Yt(e,t){const n=null==t?void 0:t.adPageInfo
if(r(n))return wU
const o=n.placementType
switch(o){case oV:return Wb
case zH:return"searchAds"
case _q:case NH:case rH:return Wb
default:throw new Error(`This method should never be called with value: ${o}`)}}function Jt(e){return!!function(e){return e.host.clientIdentifier===jz||e.host.clientIdentifier===zz}(e)||e.host.platform===Dq}function Kt(e,t){if(!Jt(e))return!1
switch(t){case oV:const n=en(t)
return(0,Nv.isSome)(n)?e.bag.isSearchLandingAdsEnabled||e.bag.enabledAdPlacements.includes(n):e.bag.isSearchLandingAdsEnabled
case zH:return!0
case _q:const o=en(t)
return!r(o)&&e.bag.enabledAdPlacements.includes(o)&&(0,Nv.isSome)(Qt(e))
case NH:case rH:const i=en(t)
return!r(i)&&e.bag.enabledAdPlacements.includes(i)
default:return!1}}function Zt(e,t){e.console.log(`[Ads] ${t}`),e.client.buildType===WU&&e.isAvailable(Ez)&&i(e.ads.debugLog)&&((0,Nv.isNothing)(gK)&&(0,Nv.isSome)(e.ads.isNativeAdLoggingEnabled)&&(gK=e.ads.isNativeAdLoggingEnabled()),gK&&e.ads.debugLog(t))}function Qt(e){if(e.bag.todayAdMediumLockupScreenshotEnabled)return VH
if(e.bag.todayAdCondensedEnabled){if(!e.client.isPhone)return
return Bx}return function(e){return!!e.client.isPhone&&Ne(e,qv.CondensedTodayAds)===JJ}(e)?Bx:void 0}function Xt(e,t,n){var r,o,i,s,a
const c=e.bag.adPlacementTimeouts,l=.3
switch(t){case zH:return n?null:null!==(r=null==c?void 0:c["search-results-in-seconds"])&&void 0!==r?r:l
case oV:return n?null:null!==(o=e.bag.searchLandingAdFetchTimeout)&&void 0!==o?o:l
case _q:return n?null!==(i=null==c?void 0:c["today-in-seconds"])&&void 0!==i?i:l:null
case NH:return n?null:null!==(s=null==c?void 0:c["product-page-ymal-in-seconds"])&&void 0!==s?s:l
case rH:return n?null:null!==(a=null==c?void 0:c["product-page-ymal-during-download-in-seconds"])&&void 0!==a?a:l
default:return l}}function en(e){switch(e){case zH:return Wx
case oV:return $F
case _q:return _q
case NH:return"product-page-ymal"
case rH:return"product-page-ymal-during-download"
default:return}}function tn(e){return e.bag.enableSRPNextSlot&&e.clientCapabilities.isEnabled(tY)}function nn(e){return e.bag.enableSRPV5Impressions&&e.clientCapabilities.isEnabled(tY)}function rn(e,t){return t===zH&&nn(e)}function on(e,t){return t===zH&&!nn(e)}function sn(e,t){var n
const r=[0]
if(!tn(e))return r
const o=f(t,rA)
if((0,Nv.isNothing)(o))return r
const i=null===(n=w(JSON.parse(o).intendedSlots))||void 0===n?void 0:n.filter(e=>typeof e===PG)
return(0,Nv.isNothing)(i)?r:i}function an(e,t,n){if((0,Nv.isNothing)(t))return
if(n)switch(t){case oV:return
case zH:if(!nn(e))return}const r=en(t)
return(0,Nv.isNothing)(r)?void 0:e.bag.adPlacementEligibleSlotPositions[r]}function cn(e,t,n,r,o){var i
if((0,Nv.isNothing)(n)||(0,Nv.isNothing)(t))return!1
const s=null===(i=Ah(n))||void 0===i?void 0:i.id
if((0,Nv.isNothing)(s))return!1
let a
a=(0,Nv.isSome)(o)?o:ln(e,t,s,r)
const c=yh(n)
return a.includes(c)}function ln(e,t,n,r){const o=an(e,t,r)
if((0,Nv.isNothing)(o))return[]
const i=[]
for(const e of o)e.shelfIdentifier===n&&i.push(e.slot)
return i}function un(e,t,n,o,i){var s,a,c,l
if(!Jt(e)||r(i.adPageInfo))return
const u=ln(e,n,o,!1)
if(0===u.length)return
const d=[]
for(const e of t){if(e.contentType!==dq&&e.contentType!==Cj)continue
const t=e.items;(0,Nv.isSome)(t)&&t.length>0&&d.push(...t)}for(const t of u){const n=null===(s=i.adPageInfo)||void 0===s?void 0:s.missedOpportunityReason(o,t)
if((0,Nv.isNothing)(n)||n===oA||n===iA)return
const r=d[t]
if((0,Nv.isSome)(r.searchAdOpportunity))return
if(Bt(r)&&(0,Nv.isSome)(null===(a=r.media)||void 0===a?void 0:a.searchAdOpportunity))return
r.searchAdOpportunity=qt(e,i),null===(c=r.searchAdOpportunity)||void 0===c||c.setMissedOpportunityReason(n),null===(l=r.searchAdOpportunity)||void 0===l||l.setTemplateType(zU)}}function dn(e,t,n,o=null){var i,s
return!Jt(e)||r(n)?null:new x0(e,t,x0.createInitialPageSlotInfos(e,t,null===(i=null==n?void 0:n.onDeviceAd)||void 0===i?void 0:i.positionInfo,o,void 0),n.iAdId,n.clientRequestId,void 0,null===(s=n.onDeviceAd)||void 0===s?void 0:s.positionInfo)}function fn(e,t){return j(t,vK)}function hn(e,t,n){s(null==t?void 0:t.attributes)&&(t.attributes[vK]=n)}function pn(e,t,n,r){var i,a,c,l,u
const d=e.bag.adsOverrideLanguage
if(o(d)||o(t))return!0
let f=null===(i=t.meta)||void 0===i?void 0:i.resource
if(o(f)&&s(n)&&(f=null===(u=null===(l=null===(c=null===(a=null==n?void 0:n.appMetadata)||void 0===a?void 0:a.data)||void 0===c?void 0:c[0])||void 0===l?void 0:l.meta)||void 0===u?void 0:u.resource),o(f))return!1
if(j(f,"name.locale")!==d)return!1
const h=Qe(e,t,vH),p=Qe(e,f,"subtitle.locale")
if(s(h)&&p!==d)return!1
if(r===hK){const n=j(t,sA)
if((0,Nv.isSome)(n)&&n!==rq){let r
const o=n
r=n===hq?bG:n
const i=Qe(e,t,r),a=Qe(e,f,o.concat(".locale"))
if(s(i)&&a!==d)return!1}}return!0}function wn(e,t,n){const r=n.reco_algoId
if(o(r)||o(e)||o(t[r]))return e
const i=e.map(e=>{var t
return{identifier:h(e.id),score:null!==(t=h(e,JM))&&void 0!==t?t:0}}),s=t[r],a=(0,nm.demoteByEngagements)(i,s),c=e.reduce((e,t)=>({...e,[t.id]:t}),{})
return a.map(e=>c[e.identifier.toString()])}function gn(e,t){if(!s(t))return{}
const n=p(t,"data.engagementEvents.impression"),r={}
for(const e in n)if(s(e)){const t=l(n,e)
r[e]=t.map(e=>({adamIdentifier:h(e[SV]),timestamp:h(e.eventTimeMillis)}))}return r}function vn(e){return e.bag.enableRecoOnDeviceReordering}function mn(e){return e===PK.Apps.toString()?AK:e===PK.Games.toString()?TK:yK}function yn(e){const t=e.categories
if(s(t)){const e=t[0].genreId
if(e===PK.Games.toString())return TK
if(e===PK.Apps.toString())return AK}return yK}function An(e,t,n=e.host.clientIdentifier,r=[]){t||(t=PK.Apps)
const o=new Jz(e).forType(VN).includingAdditionalPlatforms(r).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAgeRestrictions().addingQuery(lH,`${t}`)
return n===Vz?o.addingContext(zq):n===Hz&&o.addingContext(qH),o}function Tn(e,t,n=!0){return Bv.context("categoryListFromApiResponse",()=>{const r=l(t,"results.categories"),o=bn(e,p(r,"0"),n)
return o?new bK(o.children):null})}function bn(e,t,n=!0){return Bv.context("categoryFromApiResponse",()=>{if(!t)return null
const r=f(t,Zq),o=f(t,lH),s=f(t,HN),a=qd(e,p(t,Hq),{allowingTransparency:!0,useCase:n6.CategoryIcon}),c=l(t,WV).map(t=>bn(e,p(t),n)).filter(e=>i(e)),u=function(e,t){return t.sort((t,n)=>{try{return t.name.localeCompare(n.name,e.loc.safeIdentifier,{usage:xV})}catch(e){return 0}})}(e,c),d=f(t,$H)
return d&&n&&u.unshift(new SK(d,o,a,s,[])),new SK(r,o,a,s,u)})}function Sn(e,t,n=!1,r=!1,o=!0){const i=n?"contentIconTrimmedMonochrome":"contentIconTrimmed",s="brandLogo",a=Ke(e,t,Tq)
if(r)return p(a,s)
{let e=p(a,i)
return o&&(0,Nv.isNothing)(e)&&(e=p(a,s)),e}}function Pn(e){const t=j(e.data,lN)
return t===sm.Horizontal?sm.Horizontal:t===sm.Condensed?sm.Condensed:sm.Vertical}function Cn(e,t){if(!t.isFirstRender)return s(t.remainingItems)?t.remainingItems:[]
const n=we(t.data,Jq)
return s(n)?n:[]}function In(e,t){let n=null
switch(t.type){case Nq:case BH:case oU:n=pe(e,t,aH)||pe(e,t,wH)||pe(e,t,Jq)||pe(e,t,Mq)
break
case Kq:case FH:case xq:n=t}return n}function kn(e,t){if(o(t))return null
const n=l(t.meta,"associations.editorial-cards.data")
return o(n)?null:n[0]}function On(e,t){return g({...B(t,zG,{}),...B(kn(0,t),zG,{})})}function En(e){return{showAppIcon:d(e.showAppIcon,!1),suppressLockup:d(e.suppressLockup,!1),useGeneratedBackground:d(e.useGeneratedBackground,!1),useMaterialBlur:d(e.useMaterialBlur,!0),useTextProtectionColor:d(e.useTextProtectionColor,!1)}}function Rn(e,t){if(!W(t))return null
let n
return n=t.type===Nq?Zf(e,t):t,W(n)?n:null}function Dn(e,t){const n=s(B(t,yq)),r=H(t,ZB)
return!n&&!r}function _n(e,t){const n=t.type
return n!==rm.Collection&&n!==rm.Recommendations?null:j(t,dH)}async function Ln(e,t,n){var r
const o=Date.now(),i=await e.mediaToken.refreshToken(),s=e.fetchTimingMetricsBuilder,a=null!=n?n:{},c=null===(r=e.personalizationMetricsIdentifiersCache)||void 0===r?void 0:r.getMetricsIdForType(Yv.user);(0,Uv.isSome)(c)&&((0,Uv.isSome)(null==a?void 0:a.headers)?a.headers[IK]=c:a.headers={[IK]:c})
const l=await xn(e,t,i,a,!1,s),u=Date.now()
t.canonicalUrl&&(l[fm.requestedUrl]=t.canonicalUrl)
const d=u-o
if(d>500){const n=ve(e,t).toString()
e.console.warn("Fetch took too long ("+d.toString()+"ms) "+n)}return l}function Mn(e,t){return e.bag.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return i(null===(n=t.query)||void 0===n?void 0:n[e])})}async function xn(e,t,n,a={},c=!1,l){var d,f
const p=ve(e,t).toString(),w=new qW(p),g=Mn(e,w)
for(const e of g)w.removeParam(e)
const v=w.toString()
let m=a.headers
m||(m={}),m.Authorization="Bearer "+n
const A=await e.network.fetch({url:v,headers:m,method:a.method,body:a.requestBodyString,timeout:a.timeout})
try{if(401===A.status||403===A.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
return e.mediaToken.resetToken(),await e.mediaToken.refreshToken().then(async n=>await xn(e,t,n,a,!0,l))}if(404===A.status)throw $n()
if(!A.ok){const e=new kK(`Bad Status code ${A.status} for ${v}, original ${p}`)
throw e.statusCode=A.status,e}const n=n=>{var c,l
const d=Date.now()
let f
if(r(n.body)||""===n.body){if(204!==n.status)throw $n()
f={}}else try{f=JSON.parse(n.body)}catch(t){let r=t.message
throw[RG,WU].includes(e.client.buildType)&&(r=`${t.message}, body: ${n.body}`),new OK(r)}const w=Date.now()
if(f){if(f[fm.pageInformation]=y(function(e,t){const n=e.client.storefrontIdentifier
let r=null
if((null==n?void 0:n.length)>0){const e=n.split("-")
s(e)&&(r=e[0])}return{serverInstance:t.headers[EK],storeFrontHeader:n,language:e.bag.language,storeFront:r,environmentDataCenter:t.headers[RK]}}(e,n)),n.metrics.length>0){const e={...n.metrics[0],parseStartTime:d,parseEndTime:w}
f[fm.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:d,parseEndTime:w}
f[fm.timingValues]=e}if(f[fm.contentMaxAge]=function(e,t){const n=Object.keys(t.headers).find(e=>"cache-control"===e.toLowerCase())
if(r(n)||""===n)return null
const i=t.headers[n]
if(o(i))return null
const s=i.match(/max-age=(\d+)/)
return r(s)||s.length<2?null:h(s[1])}(0,n),Array.isArray(f.data)&&i(l=f.data)&&0===l.length&&!u(a.allowEmptyDataResponse))throw $n()
Array.isArray(f.data)&&t.originalOrdering.length>1&&(f.data=function(e,t,n,r=[]){const o={}
for(const e of n)o[e.id]=e
const i=[]
for(const e of t){const t=o[e.id]
if((0,Uv.isSome)(t)){if(s(r)){t.meta={...e.meta}
for(const n of r)Fn(0,n,t,e,o)}i.push(t)}}return i}(0,t.originalOrdering,null!==(c=f.data)&&void 0!==c?c:[],t.supplementaryMetadataAssociations)),f[fm.requestedUrl]=p}return f}
return(0,Uv.isSome)(l)?l.measureParsing(A,n):n(A)}catch(e){if(e instanceof kK)throw e
const t=null!==(d=A.headers["x-apple-jingle-correlation-key"])&&void 0!==d?d:null===(f=A.metrics[0])||void 0===f?void 0:f.clientCorrelationKey
throw new Error(`Error Fetching - filtered: ${v}, original: ${p}, correlationKey: ${null!=t?t:"N/A"}, ${e.name}, ${e.message}`)}}function $n(){const e=new kK("No content")
return e.statusCode=204,e}function Fn(e,t,n,r,o){var i;(0,Uv.isNothing)(n.meta)?n.meta={associations:{}}:(0,Uv.isNothing)(n.meta.associations)&&(n.meta.associations={})
const a=re(t,r)
if(s(a)){const e=[]
for(const t of a){const n=o[t.id];(0,Uv.isSome)(n)&&e.push(n)}(null!==(i=p(n.meta.associations))&&void 0!==i?i:{})[t]={data:e}}}function Nn(e){return T(e)&&e[tW]===Ey}function Bn(e,t,n,r){const o=yh(r.locationTracker),i={impressionIndex:o,id:o.toString(),idType:sq,name:t.displayName,impressionType:n,parentId:zC}
t.impressionMetrics=new CY(i)}function Un(e,t,n,r,o,s){var a,c,l
const u=null!==(a=g(r,fm.pageInformation,{}))&&void 0!==a?a:{},d=g(r,fm.timingValues),h=f(r,fm.requestedUrl)
let p
const w=u
if(w.pageType=t,w.pageId=n,o&&(w[bU]=o),t===mV){const t=yt(e,r)
if((0,Uv.isSome)(t)){const n=j(t,Zq),r=j(t,$V)
w[bU]=`${r}_${n}`,Bf(e,t)&&(w[IN]=nq),p=Ge(e,t)}}else t===ME?w[bU]=`${t}_${n}`:t===wV?w[bU]=_S:t===pG&&n===pG&&(w[bU]=`${t}_${n}`)
const v=new BJ(null!==(c=ch(w))&&void 0!==c?c:{})
null!==d&&(v.timingMetrics=d,(0,Uv.isSome)(h)&&(v.pageUrl=h)),i(p)&&(v.productVariantData=p)
const m=null!=s?s:Ys(e,n,r)
return(0,Uv.isSome)(m)&&(v.adPageInfo=m),v.recoMetricsData=null!==(l=St(r))&&void 0!==l?l:void 0,v}function Gn(e,t,n,r,o){var i
const s=new BJ({pageType:t,pageId:n,page:`${t}_${n}`,pageDetails:r})
if(o){const t=x0.placementTypeFromPlacementId(e,f(o,fG))
s.adPageInfo=new x0(e,t,x0.createInitialPageSlotInfos(e,t,null,null,null),null!==(i=f(o,hG))&&void 0!==i?i:void 0),s.adPageInfo.applyClickFieldsFromPageRequest(n,o)}return s}function jn(e,t,n,o,i){if(r(n))return
t.pageMetrics.pageFields=Nt(n),t.pageMetrics.addManyInstructions(Qn(e,n,o)),t.pageMetrics.addData(Jn(e,n,o,i),[pm.PageInvocationPoint.pageEnter]),t.pageMetrics.addData(function(e,t,n){const r=Jn(e,t,n)
return r.fields[Rj]=hS,r}(e,n,o),[pm.PageInvocationPoint.pageExit]),t.pageMetrics.pageRenderFields=Zn(e,n,o),t.pageRenderMetrics=Zn(e,n,o),function(e){const t=A(o=e)&&o[tW]===Bj,n=function(e){return A(e)&&e[tW]===sy}(e),r=function(e){return A(e)&&e[tW]===fy}(e)
var o
return!t&&!n&&!r}(t)&&t.pageMetrics.addData(Kn(e,n,o),[pm.PageInvocationPoint.backButton])
const s=e.fetchTimingMetricsBuilder;(0,Uv.isSome)(s)&&s.decorate(t)}function Vn(e,t){return new BJ({pageType:DH,pageId:t,page:`${DH}_${t}`})}function Hn(e,t,n,r){const o={pageId:B$,pageType:wV}
r&&(o[VK]=r)
const i=new BJ(o)
return i.pageUrl=n,i}function qn(e,t,n,r,i,a,c,l,u){const d=Un(e,wV,a,n)
if(d.searchTermContext=r,d.pageUrl=i,u&&(d.guidedSearch=function(e,t,n){const r={}
if(s(t.guidedSearchTokens)&&(r.searchSelectedGuidedFacets=t.guidedSearchTokens),n&&n.finalTerm&&(r.searchGuidedFinalQuery=n.finalTerm),!o(r))return r}(0,t,u)),Jt(e)&&(0,Uv.isSome)(c)){const t=sn(e,n.meta)
d.adPageInfo=new x0(e,zH,x0.createInitialPageSlotInfos(e,zH,null,null,t),c.iAdId,c.appStoreClientRequestId,l)}return d}function Wn(e,t,n,r,o,s){let a="",c=""
switch(t){case hm.AppEvent:a=`${n}_${r}`,c=KN
break
case hm.ContingentOffer:case hm.OfferItem:a=`${n}`,c="OfferDetails"}const l={pageId:a,pageType:c}
i(o)&&(l[G$]=o[Mq],l[PB]=o[jN])
const u=new BJ(l)
return u.recoMetricsData=null!=s?s:void 0,u}function zn(e,t){if(r(t)||r(t.pageMetrics))return
const n=t.pageMetrics.instructions
if(!r(n))for(const e of n)e.data.fields[Rj]===eW&&e.data.includingFields.push(bM)
let o=null
if(vt(t)?o=t:mt(t)&&(o=t.lockup),o){const e=[]
if(Nn(o.buttonAction))e.push(o.buttonAction)
else if(T(i=o.buttonAction)&&i[tW]===Dy&&Nn(o.buttonAction.buyAction))e.push(o.buttonAction.buyAction)
else if(function(e){return T(e)&&e[tW]===Ry}(o.buttonAction)&&Nn(o.buttonAction.completionAction))e.push(o.buttonAction.completionAction)
else if(gt(o.buttonAction)){if(Nn(o.buttonAction.buyAction)&&e.push(o.buttonAction.buyAction),Nn(o.buttonAction.defaultAction)&&e.push(o.buttonAction.defaultAction),Nn(o.buttonAction.openAction)&&e.push(o.buttonAction.openAction),ht(o.buttonAction.subscribePageAction)&&o.buttonAction.subscribePageAction.page===xO&&(0,Uv.isSome)(o.buttonAction.subscribePageAction.pageUrl)&&o.buttonAction.subscribePageAction.pageUrl.length>0){const e=qW.from(o.buttonAction.subscribePageAction.pageUrl)
e.param(DW.includePostSubscribeAttribution,XH),o.buttonAction.subscribePageAction.pageUrl=e.build()}ht(o.buttonAction.subscribePageAction)&&function(e){return A(e)&&"MarketingItemRequestInfo"===e[tW]}(o.buttonAction.subscribePageAction.pageData)&&Nn(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)&&e.push(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const t of e)t.purchaseConfiguration&&(t.purchaseConfiguration.excludeAttribution=!1)}var i}function Yn(e){Object.keys(e).filter(e=>!WK.has(e)).forEach(t=>delete e[t])}function Jn(e,t,n,r){var o,s,a,c,l,u
const d=Xn(t,n)
t.adPageInfo&&Object.assign(d,t.adPageInfo.pageFields),i(t.offerReleaseDate)&&(d[mR]=Ee(t.offerReleaseDate))
const f=t.searchTermContext
f&&(d[mH]=f.term,f.suggestedTerm&&(d.searchSuggestedTerm=f.suggestedTerm),f.correctedTerm&&(d.searchCorrectedTerm=f.correctedTerm),f.originatingTerm&&(d[TR]=f.originatingTerm)),t.guidedSearch&&Object.assign(d,t.guidedSearch)
const h=function(e,t,n,r,o,i){const s={}
Object.assign(s,o),s[Rj]=eW,r&&(s[aS]=r.clientCorrelationKey,s.requestStartTime=r.requestStartTime,s.responseStartTime=r.responseStartTime,s.responseEndTime=r.responseEndTime)
const a=[mU,TM]
return a.push("userContentRestriction"),n&&a.push("crossfireReferralCandidate"),Ft(e,s),Dt(0,new zJ(s,a,[],$t(e,s),xt(e,s,null,i)))}(e,0,null!==(o=t.isCrossfireReferralCandidate)&&void 0!==o&&o,t.timingMetrics,d,r),p=null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.adIsPresent)&&void 0!==a&&a,w=null!==(u=null===(l=null===(c=null==t?void 0:t.adPageInfo)||void 0===c?void 0:c.shouldIncludeAdRotationFields)||void 0===l?void 0:l.call(c,e))&&void 0!==u&&u
return p&&w&&h.includingFields.push(PN),h}function Kn(e,t,n){return function(e,t){const n={}
return Object.assign(n,t),n[GB]=VB,_t(e,VB,Qq,n)}(e,Xn(t,n))}function Zn(e,t,n){const r=Xn(t,n)
return t.searchTermContext&&(r[mH]=t.searchTermContext.term),t.baseFields&&Object.assign(r,t.baseFields),function(e,t,n){const r={}
return Object.assign(r,n),r[Rj]="pageRender",t&&(r[yU]||(r[yU]=t.pageURL),r[aS]=t.clientCorrelationKey,r.platformRequestStartTime=t.requestStartTime,r.platformResponseStartTime=t.responseStartTime,r.platformResponseEndTime=t.responseEndTime,r.platformResponseWasCached=t.responseWasCached,r.platformJsonParseStartTime=t.parseStartTime,r.platformJsonParseEndTime=t.parseEndTime),Ft(e,r),r}(e,t.timingMetrics,r)}function Qn(e,t,n){var r,o,s,a
const c=Xn(t,n)
t.searchTermContext&&(c[mH]=t.searchTermContext.term)
const l=S(c)
t.adPageInfo&&Object.assign(l,t.adPageInfo.impressionsFields),t.guidedSearch&&Object.assign(l,t.guidedSearch)
const u=i(t.adPageInfo),d=null!==(o=null===(r=t.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad(e))&&void 0!==o&&o,f=[{data:Mt(e,l,u&&d,null!==(a=null===(s=t.adPageInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields(e))&&void 0!==a&&a,!0),invocationPoints:[pm.PageInvocationPoint.appExit,pm.PageInvocationPoint.pageExit]}]
if(u){const n=function(e,t,n){var r,o,s,a,c,l
const u=null!==(s=null===(o=null===(r=null==n?void 0:n.adPageInfo)||void 0===r?void 0:r.shouldIncludeAdFieldsForPad)||void 0===o?void 0:o.call(r,e))&&void 0!==s&&s,d=null!==(l=null===(c=null===(a=null==n?void 0:n.adPageInfo)||void 0===a?void 0:a.shouldIncludeAdRotationFields)||void 0===c?void 0:c.call(a,e))&&void 0!==l&&l,f=[],h=Mt(e,t,u,d,!1).fields
if(h[bN]=tR,null!==n&&i(n.adPageInfo)){const t=n.adPageInfo.fastImpressionsEventVersion(e)
h[SN]=t,f.push(SN),5===t&&(h.viewableArea="excludingTabBar",delete h[fG])}const p=["fastImpressions",mU,TM]
return u&&p.push(SM),d&&p.push(PN),Dt(0,new zJ(h,p,f,$t(e,h),xt(e,h,n)))}(e,l,t)
f.push({data:n,invocationPoints:[pm.PageInvocationPoint.appExit,pm.PageInvocationPoint.pageExit,pm.PageInvocationPoint.timer]})}return f}function Xn(e,t){const n={}
return i(e.offerType)&&(n[Y$]=e.offerType),void 0!==t&&n&&t(n),n}function er(e,t){const n=et(e,t,"usesExternalPurchase"),r=et(e,t,"usesExternalLinkPurchase")
return n||r}function tr(e,t){return e.bag.enableExternalPurchases&&e.bag.enabledExternalPurchasesPlacements.includes(t)}function nr(e,t,n,r){const i=e.bag.externalPurchasesLearnMoreEditorialItemId
if(o(i)||!e.bag.enableExternalPurchases)return null
const s=new fY(cq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Qs(e,s,{id:HB,targetType:yq,actionType:Xq,pageInformation:n,locationTracker:r}),s}function rr(e){switch(e){case ly:case F_:case jV:case Mx:return!0
default:return!1}}function or(e,t,n=!1){const r=j(t,"ageRating.name")
return(0,Nv.isSome)(r)?r:n?j(t,tT):void 0}function ir(e,t,n=!1){const r=q(t,nT)
return(0,Nv.isSome)(r)?r:n?q(t,"contentRatingsBySystem.appsApple.value"):void 0}function sr(e,t){const n=new Map([["br.100.official",oT],["br.100",iT],["br.210.official",sT],["br.210",aT],["br.300.official",cT],["br.300",lT],["br.314.official",uT],["br.314",dT],["br.416.official",fT],["br.416",hT],["br.618.official",pT],["br.618",wT]]),r=e.locale.activeStorefront+"."+j(t,nT)+(H(t,"ageRating.isOfficial")?".official":"")
return n.get(r)}function ar(e,t){var n
if(t<=0)return!1
if(t>=1)return!0
const r=null===(n=e.metricsIdentifiersCache)||void 0===n?void 0:n.getMetricsIdForType(Yv.user)
return!(0,Nv.isNothing)(r)&&0!==r.length&&!(r.length<2)&&function(e){function t(e){const t=e.charCodeAt(0)
return t>=48&&t<=57?52+t-48:t>=65&&t<=90?26+t-65:t>=97&&t<=122?t-97:t}const n=e.slice(-2)
return(62*t(n[0])+t(n[1]))/3843}(r)<t}function cr(e,t){switch(ur(e,t)){case tL:case Vx:case rL:case nL:case UT:return!0
default:return!1}}function lr(e,t){return ar(e,e.bag.gameControllerRecommendedRolloutRate)&&ur(e,t)===UT}function ur(e,t){const n=rt(e)
if(null===n)return GU
if(!ie(t,n)){const r=Ke(e,t,iH)
if(null===r||o(r))return GU
const i=r[n]
return o(i)?GU:i}const r=Qe(e,t,qU)
return s(r)?r:GU}function dr(e,t){return rt(e),GT}function fr(e,t=null){return e===Yq?function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER"
return e&&(t+=`&installMajorOSBundle=${e}`),t}(t):null}function hr(e){var t
return null===aZ&&(aZ=new WJ({defaultTopic:e.bag.metricsTopic,buildType:e.client.buildType,jsVersion:null!==(t=e.packageProperties.asString(hE))&&void 0!==t?t:Dq,buyDecorator:sZ,isLoggingEnabled:!0,bagProvider:(t,o)=>{const i=e.bag.metricsConfiguration
if(!r(o)){const e=n(i,[o,t])
if(!r(e))return e}return n(i,t)}})),aZ}function pr(e,t,n,a,c,l,u,d,h,p,w,g,v,m,A){const T=function(e,t){const n=new GJ(t),r=f(e.bag.metricsConfiguration,"metricsBase.language")
return n.set("languageId",r),n.toString()}(e,n)
return function(e,t,n,o,s,a,c){const l=new GJ(t)
return function(e,t,n,o,s,a,c){var l,u
const d=f(a,U$)
t.set(U$,d)
const h=e.clientCapabilities.isEnabled(gR)?e.bag.metricsPaymentTopic:void 0
t.set(Xx,null!=h?h:e.bag.metricsTopic),sZ.useNativeValues(a)
const p=sZ.params
for(const e of Object.keys(p)){if(e===xM&&(0,Uv.isSome)(t.get(xM)))continue
const n=f(p,e)
t.set(e,n)}if(!r(c))for(const e of Object.keys(c)){const n=f(c,e)
t.set(e,n),t.set(e,n,null)}if(!a)return t.set(mH,null),void t.set($M,null)
const w=f(a,TU);(0,Uv.isSome)(w)&&w.length>0&&t.set(TU,w)
const g=(null===(l=t.get(PS,null))||void 0===l?void 0:l.length)>0,v=f(a,Mq)
if(g?t.set(Mq,e.host.clientIdentifier):(0,Uv.isSome)(v)&&v.length>0&&t.set(Mq,v),!o&&!oW.shared.shouldUseJSReferralData){const e=f(a,W$),n=ah(e)
e&&n&&(a[G$]=n)
const r=f(a,"usageContext")
if((0,Uv.isSome)(r)){switch(r){case yV:t.set(TU,"com.apple.AppStore.overlay")
break
case vR:t.set(TU,wR)}t.set(q$,w,null)}else{const e=f(a,q$)
t.set(q$,e,null)
const n=f(a,W$)
t.set(W$,n,null),f(a,"extRefAppType")===kS&&t.set(TU,wR)}}const m=t.get(MG),y=t.get(Dj),A=(null!==(u=null==m?void 0:m.split("_"))&&void 0!==u?u:[]).includes(n)
if(y!==mV||A){const e=uh(f(a,CB))
i(e)&&t.set(mH,e)}t.set(fS,null,null)}(e,l,n,o,0,a,c),l.toString()}(e,function(e,t,n,a,c,l,u,d,h,p,w,g){const v=new GJ(t)
return function(e,t,n,s,a,c,l,u,d,h,p,w){var g,v,m
const A=Nt(s)
a&&t.set(CN,a),c&&t.set(fH,c)
const T=f(y(A),MG)
t.set(MG,T)
const b=f(y(A),Dj)
t.set(Dj,b)
const S=f(y(A),IB);(0,Uv.isSome)(S)&&S.length>0&&t.set(cZ.containerId,S,null)
const P=(null!==(g=null==T?void 0:T.split("_"))&&void 0!==g?g:[]).includes(n),C=b===mV,I=(null===(v=t.get(PS,null))||void 0===v?void 0:v.length)>0
if(!C||P||I){let e=f(y(s),"searchTermContext.resultsTerm")
o(e)&&(e=function(e){if((0,Nv.isNothing)(e))return null
const t=new qW(e),n=t.query,r=null==n?void 0:n[mH],o=t.pathname
return(0,Nv.isNothing)(r)||(0,Nv.isNothing)(o)?null:o.includes("/app")?r:null}(null==s?void 0:s.pageUrl)),r(e)||t.set(mH,e)}if(C&&(0,Uv.isSome)(s)&&(0,Uv.isSome)(s.pageUrl)&&(null===(m=new qW(s.pageUrl).query)||void 0===m?void 0:m[hR])===CS&&(t.set(xM,pR),t.set(IS,"1",null)),function(e,t,n,r){const o=i(n)&&n.adamID===t,s=i(r)&&r.adamID===t&&!o
if(o&&i(n)){const t=We(n)
for(const n of Object.keys(t)){const r=f(t,n);(0,Uv.isSome)(r)&&e.set(n,r)}}if(s&&i(r)){const t=ze(r)
for(const n of Object.keys(t)){const r=f(t,n);(0,Uv.isSome)(r)&&e.set(n,r)}}}(t,n,null==s?void 0:s.productVariantData,null!=u?u:void 0),!r(l)&&l.length>0&&t.set($M,l),t.set(Qx,d),!h)if(i(oW.shared.activeReferralData)){if(t.set(q$,oW.shared.activeReferralData.extRefApp2,null),t.set(W$,oW.shared.activeReferralData.extRefUrl2,null),(0,Uv.isSome)(oW.shared.activeReferralData.kind)){const e=oW.shared.activeReferralData.kind.name
e!==kS&&"appClip"!==e||t.set(TU,wR)}}else t.set(q$,p,null),t.set(W$,w,null)}(0,v,n,a,c,l,u,d,h,p,w,g),function(e,t,n,r){var o
if((0,Uv.isNothing)(r))return
const i=[],a=r.adPageInfo
if((0,Uv.isSome)(a)){const e=(0,Uv.isSome)(a.clickFields[rR]),n=a.adAdamId===t
if(e&&n){const e=function(e,t){if((0,Uv.isNothing)(e))return!1
const n=e.baseFields[Dj]
switch(t.placementType){case oV:return n===pG
case _q:return n===OS
case NH:case rH:const r=e.baseFields[MG],o=t.adAdamId===r
return(n===mV||n===EM)&&!o
default:return n===wV}}(r,a)?"iAdSponsored":"iAdOriginated"
i.push({key:e,value:XH})}}if(s(i)){const t=i.map(e=>`${e.key}=${e.value}`).join(";"),r=null===(o=e.cryptography)||void 0===o?void 0:o.base64Encode(t);(0,Uv.isSome)(r)&&n.set("extraInfo",r)}}(e,n,v,a),v.toString()}(e,T,t,a,u,d,h,g,v,c,m,A),t,c,0,p,w)}function wr(e,t,n){return Bv.context("offerDataFromData",()=>{const r=Ze(e,t,QG,n)
return 0===r.length?null:r[0]})}function gr(e,t){const n=G(t,QG)
return 0===n.length?null:n[0]}function vr(e,t,n,o,a,c,l,u=vq,d,h,p){return Bv.context(`offerActionFromOfferData: ${n.id}`,()=>{var w,g,v,m,y,A,T
let b=f(t,lj)
if(r(b))return Bv.unexpectedNull(cH,Sq,ZE),null
if(n.type===xq&&(b.indexOf("rebuy")>=0?b=b.replace("rebuy=false",XS):(b.length>0&&(b+="&"),b+=XS)),s(l.inAppEventId)&&(b.length>0&&(b+="&"),b+=`mtInAppEventId=${l.inAppEventId}`),l.isAdvert){const e=null===(g=null===(w=l.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementId
i(e)&&(b.length>0&&(b+="&"),b+=`${cZ.placementId}=${e}`)
const t=null===(m=null===(v=l.pageInformation)||void 0===v?void 0:v.adPageInfo)||void 0===m?void 0:m.containerId
i(t)&&(b.length>0&&(b+="&"),b+=`${cZ.containerId}=${t}`)
const n=null===(A=null===(y=l.pageInformation)||void 0===y?void 0:y.adPageInfo)||void 0===A?void 0:A.clickFields[ZG]
i(n)&&(b.length>0&&(b+="&"),b+=`${cZ.templateType}=${n}`)}const S=n.id
if(r(S))return Bv.unexpectedNull(cH,Sq,"item.offer.id"),null
const P=function(e,t,n,r,o,i,s,a,c,l){return Bv.context("purchaseConfigurationFromProduct",()=>{const u=j(t,Zq)
let d=j(t,$V)
d||(d=QS)
const h=st(e).bundleIdFromData(t),p=cf(e,t),w=j(t,rS),g=Qe(e,t,"preflightPackageUrl"),v=Bf(e,t),m=pf(0,t,e.appleSilicon.isSupportEnabled),y=f(c,Mq),A=f(c,jN),T=_r(e,t)?e.client.remoteDownloadIdentifiers:[],b=function(e,t){return et(e,t,RH)}(e,t),S=ir(0,t,!0),P=new nZ(n,d,u,h,p,r,o,s,w,!1,g,v,m,!1,a.inAppEventId,y,A,void 0,wf(e,t),l,T,b,S)
return P.pageInformation={...i},P.productVariantData=Ge(e,t),P.targetType=a.targetType,P.metricsKind=a.kind,P})}(e,n,b,o,l.excludeAttribution,l.pageInformation,c,l,d,h),C=Tr(e,t,S,P,a,u,null!==(T=l.isAdvert)&&void 0!==T&&T,p)
return function(e,t,n,r,o){var i,s,a,c,l
const u=n.pageInformation,d={...n,targetType:Qq},f=ph(e,d,null!==(i=t.title)&&void 0!==i?i:"")
let h=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:t.adamId;(0,Uv.isSome)(n.targetId)&&(null===(c=n.targetId)||void 0===c?void 0:c.length)>0&&(h=n.targetId),Ks(e,t,h,r,u,f,null!==(l=n.isAdvert)&&void 0!==l&&l,n.recoMetricsData,o,d)}(e,C,l,o,h),C})}function mr(e,t){return r(t)||r(t.price)||0===t.price}function yr(e,t){return Bv.context("expectedReleaseDateFromData",()=>Oe(j(t,"offers.0.expectedReleaseDate")))}function Ar(e,t){const n=f(t,fV)
return n===s$||n===VM||n===NV?h(t,MF):null}function Tr(e,t,n,r,o,i=vq,s=!1,a){return Bv.context("offerActionFromOfferData",()=>{const c=f(t,fV),l=s&&i===vq&&(0,Uv.isSome)(e.bag.adsOverrideLanguage)?e.adsLoc:e.loc
let u
switch(c){case"get":if(i===jj)u=e.loc.string(eP,"Get")
else{const e=HM
u=l.string(e)}break
case NV:u=i===jj?e.loc.string(tP,"Pre-Order"):l.string(HM)
break
default:u=c}let d=null,h=null
const p=Ar(0,t)
p>0&&(d=p,h=f(t,jG))
const w=Oe(f(t,tU)),g=new BK(u,n,r,a)
return g.price=d,g.priceFormatted=h,g.expectedReleaseDate=w,g.includeBetaApps=o,g})}function br(e,t,n,o,i,a=vq,c=null,l=!1){if((0,Uv.isNothing)(t))return null
if(jf(0,n)){if(a===jj)return null
if(a===vq)return Dd(e,n,i,null)
const r=Qe(e,n,oq)
if(s(r)){const e=fr(Yq,r)
if((0,Uv.isSome)(e)){const n=new PY(e)
return new IY(t.adamId,n)}}}if(a===vq&&(n.type===xq||Vf(e,n)||l))return Dd(e,n,i,null)
if(o&&"tv"!==e.client.deviceType&&!Bf(e,n)){const o=function(e,t,n,o,i){if(r(t))return null
const s=Pr(e,n,t,!1,o)
return s.buyAction=t,s}(e,t,n,i)
if(null!==o)return o}const u=xe(e,n,GV),d=e.client.isCompanionVisionApp
if(!Bf(e,n)&&(d||u&&e.client.deviceType!==Fq))return function(e,t,n,r,o){const i=Rr(e,t,n,r,o),s=new IY(t.adamId,i)
return s.title=t.title,s}(e,t,n,mr(0,t),Bf(e,n))
if(xe(e,n,BG)&&"tv"!==e.client.deviceType)return function(e,t,n){const r=new gY(vq)
r.title=e.loc.string("Alert.Buy.TvOnly.Title"),r.message=e.loc.string("Alert.Buy.TvOnly.Message"),r.isCancelable=!0,r.buttonActions=n?[Mr(e,t)]:[t],r.buttonTitles=[e.loc.string("Alert.Buy.TvOnly.ButtonTitle")]
const o=new IY(t.adamId,r)
return o.title=t.title,o}(e,t,et(e,n,jx))
if(!et(e,n,nO)&&et(e,n,AG)&&e.client.deviceType!==zq)return function(e,t){const n=new gY(vq)
n.title=e.loc.string("Alert.Buy.WatchOnly.Title"),n.message=e.loc.string("Alert.Buy.WatchOnly.Message"),n.isCancelable=!0,n.buttonActions=[t],n.buttonTitles=[e.loc.string("Alert.Buy.WatchOnly.ButtonTitle")]
const r=new IY(t.adamId,n)
return r.title=t.title,r}(e,t)
const f=Qe(e,n,LF)
if(s(c)&&c===Vz&&(0,Uv.isSome)(f)&&zf(e,f))return function(e,t,n){const r=new gY(vq)
r.title=e.loc.string("ProductPage.WatchOSUpdateRequired.Title").replace($G,n),r.message=e.loc.string("ProductPage.WatchOSUpdateRequired.Message").replace($G,n),r.buttonActions=[t],r.buttonTitles=[e.loc.string(AL)]
const o=new IY(t.adamId,t)
return o.buyAction=r,o}(e,t,f)
if(function(e,t){return!!Bf(e,t)}(e,n)){if(Bf(e,n))return function(e,t,n,r,o,i,s){if(!Bf(e,n))return t
switch(e.client.deviceType){case"tv":return function(e,t,n,r,o,i){var s,a,c,l
const u=kr(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new jK(qq,o,e.bag.metricsTopic,n.id);(0,Uv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[mH]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical]);(0,Uv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new fY(dj)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Zs(e,g,i),r){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=null,t}{const o=new IY(n.id,d),i=kr(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
case Fq:return function(e,t,n,r,o,i){var s,a,c,l
const u=Or(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,h=rr(o),p=new jK(qq,o,e.bag.metricsTopic,n.id);(0,Uv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(p.metricsOverlay[mH]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical]);(0,Uv.isSome)(w)&&(p.metricsOverlay={...p.metricsOverlay,...w}),h&&(p.purchaseSuccessAction=f,p.carrierLinkSuccessAction=f)
const g=new fY(dj)
if(g.pageData=p,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),Nn(d)&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),Zs(e,g,i),r&&null!==f){const t=Pr(e,n,f,!0,i)
t.buyAction=d
const r=Pr(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=Ir(e,g),t}{const o=new IY(n.id,d),i=Or(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
default:return function(e,t,n,r,o,i,s){var a,c,l,u
const d=rr(i),f=new jK(qq,i,e.bag.metricsTopic,n.id);(0,Uv.isSome)(null===(c=null===(a=s.pageInformation)||void 0===a?void 0:a.searchTermContext)||void 0===c?void 0:c.term)&&(f.metricsOverlay[mH]=null===(l=s.pageInformation.searchTermContext)||void 0===l?void 0:l.term)
const h=null===(u=e.metricsIdentifiersCache)||void 0===u?void 0:u.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical]);(0,Uv.isSome)(h)&&(f.metricsOverlay={...f.metricsOverlay,...h}),e.client.isCompanionVisionApp&&(0,Uv.isNothing)(f.metricsOverlay[TU])&&(f.metricsOverlay[TU]=mz),d&&(f.purchaseSuccessAction=t,f.carrierLinkSuccessAction=t)
const p=new fY(dj)
if(p.pageData=f,s&&s.pageInformation&&(p.referrerUrl=s.pageInformation.pageUrl),s.actionDetails={buyParams:t.purchaseConfiguration.buyParams,...s.actionDetails},Zs(e,p,s),r&&Nn(t)){const r=Pr(e,n,t,!0,s)
r.buyAction=t
const o=Pr(e,n,t,!0,s)
return o.buyAction=t,r.subscribePageAction=o,t.buyCompletedAction=Ir(e,p),r}const w=xe(e,n,GV)
if(_r(e,n)||w&&e.client.deviceType!==Fq){const r=Rr(e,t,n,!0,!0),o=Rr(e,p,n,!0,!0),i=new IY(n.id,r)
return i.subscribePageAction=new IY(n.id,o),i}const g=new IY(n.id,t)
return g.subscribePageAction=p,g}(e,t,n,r,0,i,s)}}(e,t,n,o,0,function(e,t,n){if(n)return pt(IF)
switch(t){case jV:return pt(jV)
case vq:case jj:return pt(Mx)
default:return pt(ij)}}(0,a,o),i)
const s=function(e,t,n,o,i){return"tv"===e.client.deviceType?kr(e,t,null,n,o):{startAction:r(t)?null:t,underlyingOfferAction:null}}(e,t,n,o),c=s.startAction
if(o){const t=Pr(e,n,s.underlyingOfferAction,!1,i)
return t.buyAction=c,t}return c}return Er(e,t,o,i)}function Sr(e,t,n,r,o,i,s=null){switch(r){case pt(jV):case pt(Mx):const r=Jd(e,t,{useCase:n6.LockupIconLarge}),a=Js(e,t,i)
return vr(e,wr(e,t),t,o,!1,dh(e,t,r,s),a,n)
default:return null}}function Pr(e,t,n,r,o){let i
if(r){const s=Cr(e,t,n.purchaseConfiguration.appName,r,!0,o),a=Cr(e,t,n.purchaseConfiguration.appName,r,!1,o)
i=new rZ(a,a,s,a)}else i=Cr(e,t,n.purchaseConfiguration.appName,!1,!1,o)
return new IY(t.id,i)}function Cr(e,t,n,r,o,i){const s=new oZ(t.id,r)
let a,c,l,u
if(a=e.loc.string("CANCEL_COMING_SOON_TITLE"),e.client.isAutomaticDownloadingEnabled()&&(r&&o||!r)?(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON_DOWNLOAD"),l=e.loc.string("COMING_SOON_BODY_DOWNLOAD").replace(qM,n)):(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON"),l=e.loc.string("COMING_SOON_BODY").replace(qM,n)),c=e.loc.string("CANCEL_COMING_SOON_CANCEL"),e.client.deviceType===Yq||"tv"===e.client.deviceType){const e=new gY(vq)
e.title=a,e.message=l,e.buttonActions=[s],e.isCancelable=!0,e.cancelTitle=c,e.destructiveActionIndex=0,u=e}else if(e.client.deviceType===Fq){const t=new gY(vq)
t.title=a,t.artwork=Ot(e,"systemimage://bell.slash.fill",95,90),t.message=l,t.buttonActions=[s],t.isCancelable=!0,t.cancelTitle=c,u=t}else{const e=new eZ([s])
e.title=a,e.message=l,e.isCancelable=!0,e.cancelTitle=c,e.isCustom=!1,e.destructiveActionIndex=0,u=e}Qs(e,s,{...i,actionType:"cancelPreorder"})
const d=new _J(t.id,Mq),f=new IY(t.id,u)
return f.openAction=d,f}function Ir(e,t){const n=Ot(e,"systemimage://checkmark",95,90),r=Ot(e,hA,95,90)
let o,i
o=new gY(QN),o.title="",o.artwork=n,e.client.isAutomaticDownloadingEnabled()?(o.message=e.loc.string(FR),o.toastDuration=2.5):(o.message=e.loc.string(kN),o.toastDuration=1.5)
{const n=new gY(QN)
n.title="",n.artwork=r,n.message=e.loc.string(kN),n.toastDuration=1.5
const o=new iZ(NR,new MJ([t,n]))
o.rateLimit=e.bag.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=n,i=o}const s=!e.client.isAuthorizedForUserNotifications()
return e.bag.newEventsForODJAreEnabled&&s?new rZ(new fW,new fW,new fW,new fW):new rZ(i,o,o,o)}function kr(e,t,n,o,s,a){if(r(t))return{startAction:null,underlyingOfferAction:null}
const c=new GK,l=mr(0,t),u=t.purchaseConfiguration.appName
c.shouldCheckForAvailableDiskSpace=!s,c.remoteControllerRequirement=GU,c.shouldCheckForGameController=et(e,o,jx)
const d=ir(0,o,!0)
if(i(d)&&(c.checkRestrictionsForContentRating=d),l){const t=s?e.loc.string("OfferAlert.TV.Title.PredorderFree"):e.loc.string("OfferAlert.TV.Title.Free")
c.title=t.replace(SU,u)}else{const n=s?e.loc.string("OfferAlert.TV.Title.PreorderPaid"):e.loc.string("OfferAlert.TV.Title.Paid")
c.title=n.replace(SU,u).replace(Z$,t.priceFormatted)}const f=S(t)
f.title=s?e.loc.string("OfferButton.Title.Preorder"):l?e.loc.string(HM):e.loc.string("OfferButton.Title.Buy")
const h=(0,Uv.isNothing)(n)?f:n
c.completionAction=h,c.shouldIncludeActiveAccountInFooterMessage=!0
const p=[]
et(e,o,gE)&&p.push(e.loc.string("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases")),p.length>0&&(c.footerMessage=p.join(e.loc.string("TV_OFFER_ALERT_FOOTER_LINE_BREAK"))),c.impressionMetrics=f.impressionMetrics
const w=S(c)
w.shouldPromptForConfirmation=!1,w.title=null,w.footerMessage=null
const g=new IY(t.adamId,w)
return Bf(e,o)||(g.buyAction=c),g.openAction=t,{startAction:g,underlyingOfferAction:f}}function Or(e,t,n,o,i,s){if(r(t))return{startAction:null,underlyingOfferAction:null}
const a=new GK,c=mr(0,t)
a.remoteControllerRequirement=ur(e,o),a.spatialControllerRequirement=dr(e)
const l=S(t)
l.title=i?e.loc.string("OFFER_BUTTON_TITLE_PREORDER"):c?e.loc.string("OFFER_BUTTON_TITLE_GET"):e.loc.string("OFFER_BUTTON_TITLE_BUY")
const u=(0,Uv.isNothing)(n)?l:n
a.completionAction=u,a.impressionMetrics=l.impressionMetrics
const d=S(a)
d.shouldPromptForConfirmation=!1,d.title=null,d.footerMessage=null
const f=new IY(t.adamId,d)
return f.buyAction=a,f.cancelAction=l,f.openAction=l,{startAction:f,underlyingOfferAction:l}}function Er(e,t,n,o){if(r(t))return null
if(!e.bag.enableTwoPhaseOfferConfirmation||n)return t
const i=new fW
i.impressionMetrics=t.impressionMetrics
const s=S(o)
r(s)||(s.actionType=yR,s.targetType=Qq,Qs(e,i,s))
const a=new UK(t,i)
return a.confirmationAccessibilityAction=function(e,t){if(r(t))return null
const n=new gY(vq)
r(t.priceFormatted)?(n.title=e.loc.string(UN),n.message="Are you sure you want to get "+t.purchaseConfiguration.appName):(n.title="Buy App",n.message=`Are you sure you want to buy ${t.purchaseConfiguration.appName} for ${t.priceFormatted}`),n.isCancelable=!0,n.buttonActions=[t]
const o=new IY(t.adamId,t)
return o.buyAction=n,o}(e,t),a}function Rr(e,t,n,r,o){const i=new gY(vq)
return i.isCancelable=!0,i.buttonActions=[t],i.imageName="vision.pro",_r(e,n)?r?(i.title=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Title"),i.message=o?e.loc.string("Alert.Buy.VisionOnly.Message.Arcade"):e.loc.string("Alert.Buy.VisionOnly.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.ButtonTitle")]),i}function Dr(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=cf(e,t).includes(Fq)||function(e){return ue(e,pq,rO)}(t)
return!!n}function _r(e,t){return!!Dr(e,t)&&Lr(e)}function Lr(e){return!((0,Uv.isNothing)(e.client.remoteDownloadIdentifiers)||0===e.client.remoteDownloadIdentifiers.length)}function Mr(e,t){const n=new gY(vq)
return n.title=e.loc.string("Alert.Buy.TvGameControllerRequired.Title"),n.message=e.loc.string("Alert.Buy.TvGameControllerRequired.Message"),n.buttonTitles=[e.loc.string("Alert.Buy.TvGameControllerRequired.ButtonTitle")],n.isCancelable=!0,n.buttonActions=[t],n}function xr(e,t,n,o,s,a,c,l,u,d,h=vq,p=!1,w=!1,g,v,m=!1){return r(t)?null:Bv.context("displayPropertiesFromOfferAction",()=>{var r
let a=c
!m&&at(e,o,Wv.Offers)&&(a=NB),m||Bd(e,o)||(a=NB),m||!e.client.isCompanionVisionApp||_r(e,o)||(a=NB)
const g=null!==(r=jd(e,o))&&void 0!==r?r:v
let y
g&&(y=g.id)
let A=new SY(n,t.adamId,t.bundleId,a,y,l)
A.isPreorder=s
const T=w&&h===vq&&(0,Uv.isSome)(e.bag.adsOverrideLanguage),b=T?e.adsLoc:e.loc
if(A.useAdsLocale=T,s)if(Bf(e,o))A.offerLabelStyle=IF,A.subtitles[tU]=Kf(e,o,e.loc.string(K$)),A.titleSymbolNames[nP]=Q$,A.titleSymbolNames[BR]="bell.fill",A.subtitles[tU]===e.loc.string(sb)&&(A.subtitles[tU]=e.loc.string(K$))
else{A.offerLabelStyle=NV,A.titleSymbolNames[Wq]=Q$
const t=Kf(e,o,"");(0,Uv.isSome)(t)&&(A.subtitles[tU]=t)}const P=mr(0,t)
A.isFree=P
let C=null
if(h===vq&&(o.type===xq||jf(0,o)||Vf(e,o)||p))C=e.loc.string("OfferButton.Title.View")
else{if(h===jj&&(o.type===xq||jf(0,o)||Vf(e,o)))return null
C=h===rP?e.loc.string("OfferButton.Title.Select"):P?h===jj?s?e.loc.string(tP):e.loc.string(eP):t.title:h===jj?s?e.loc.string("OfferButton.FlowPreview.PreorderWithPrice").replace(Z$,t.priceFormatted):e.loc.string("OfferButton.FlowPreview.BuyWithPrice").replace(Z$,t.priceFormatted):t.priceFormatted}if(A.titles[Wq]=C,A.priceFormatted=t.priceFormatted,e.bag.enableTwoPhaseOfferConfirmation&&h!==jj&&(A.titles[UR]=P?e.loc.string("OfferButton.Title.ConfirmGet"):e.loc.string("OfferButton.Title.ConfirmBuy")),Bf(e,o))if(h===jj){const t=e.loc.string("OfferButton.FlowPreview.Arcade.Standard")
A.titles[Wq]=t,A.titles[X$]=t,A.titles[DV]=e.loc.string("OfferButton.FlowPreview.Arcade.Open"),A.titles[WM]=t,s&&(A.titles[oP]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderSubscribed"),A.titles[GR]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderNotSubscribed"))}else{const e=b.string("OfferButton.Arcade.Title.Standard")
A.titles[Wq]=e,A.titles[X$]=e,A.titles[DV]=b.string("OfferButton.Arcade.Title.Open"),A.titles[WM]=e,s&&(A.titles[oP]=b.string("OfferButton.Arcade.Title.PreorderSubscribed"),A.titles[GR]=b.string("OfferButton.Arcade.Title.PreorderNotSubscribed"),A.titles[nP]=b.string("OfferButton.Arcade.Title.PreorderedSubscribed"),A.titles[BR]=b.string("OfferButton.Arcade.Title.PreorderedNotSubscribed"))}if(u&&h!==jj){const t=f(u,YS),n=f(u,jG)
if(i(n)&&i(t)){let r=null,o=null
switch(t){case JS:d?(r=e.loc.string(jR),o=e.loc.string(jR)):(r=e.loc.string(jR),o=e.loc.string(zM))
break
case KS:const t=e.loc.string("OfferButton.IntroPrice.PaidUpfront.Trial").replace(Z$,n)
d?(r=t,o=t):(r=t,o=e.loc.string(zM))
break
case ZS:r=e.loc.string(zM),o=e.loc.string(zM)}A.titles[VR]=r,A.titles[HR]=o,A.subtitles[VR]=e.loc.string(iP),A.subtitles[HR]=e.loc.string(iP)
const i=10
let s=!1
for(const e of Object.keys(A.titles))if(A.titles[e].length>i){s=!0
break}s&&(A=A.newOfferDisplayPropertiesChangingAppearance(!1,null,Qb))}}const I=et(e,o,gE),k=er(e,o),O=tr(e,Bq),E=k&&O
if(A.hasInAppPurchases=I,A.hasExternalPurchases=E,I||E){const t=E?aP:sP,n=b.string(t)
A.subtitles[Wq]=n,e.bag.enableTwoPhaseOfferConfirmation&&h!==jj&&(A.subtitles[UR]=n)}A.isDeletableSystemApp=st(e).isSystemAppFromData(o)&&!Vf(e,o)
const R=ir(0,o,!0)
return A.contentRating=null!=R?R:void 0,A.appCapabilities=t.purchaseConfiguration.appCapabilities,o.type===xq&&h!==jj&&(A.offerToken={offerAction:t,offerDisplayProperties:S(A)}),A})}function $r(e){return A(e)&&function(e){return(0,Nv.isSome)(gZ[e])}(e[tW])}function Fr(e,t){switch(j(t,zb)){case Yb:return lz
case Jb:return uz
case"RealityDevice":return e.bag.enableDeviceDrivenDiscoveryContent?yz:null
default:return null}}function Nr(e,t=!1){return{timeToLive:Gr(e),nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:t}}function Br(e,t){r(t)||r(e)||(r(t.nextPreferredContentRefreshDate)||e.getTime()<t.nextPreferredContentRefreshDate.getTime())&&e.getTime()>(new Date).getTime()&&(t.nextPreferredContentRefreshDate=e)}function Ur(e,t){if(!function(e){return e.bag.enableAutomaticPageRefresh}(e))return null
if(r(t))return null
let n,o=!1
if(i(t.timeToLive)&&i(t.nextPreferredContentRefreshDate)){const e=jr(t.timeToLive)
e.getTime()<t.nextPreferredContentRefreshDate.getTime()&&e.getTime()>(new Date).getTime()?n=e:(n=t.nextPreferredContentRefreshDate,o=!0)}else if(i(t.timeToLive))n=jr(t.timeToLive)
else{if(!i(t.nextPreferredContentRefreshDate))return null
n=t.nextPreferredContentRefreshDate,o=!0}if(n.getTime()<=(new Date).getTime())return null
const s=o&&t.refreshWhileVisibleForNextPreferredContentRefreshDate
return new TZ("timeToLive",0,null,n,s)}function Gr(e){return e[fm.contentMaxAge]}function jr(e){const t=new Date
return t.setSeconds(t.getSeconds()+e),t}function Vr(e,t){return t?[KQ,iX]:[]}function Hr(e,t){return Qr(WZ,t)}function qr(e,t){return Qr(gQ,t)}function Wr(e){return mQ}function zr(e){return AQ}function Yr(e){return SQ}function Jr(e){return OQ}function Kr(e){return DQ}function Zr(e,t){return e.client.isCompanionVisionApp?BQ:Qr(NQ,t)}function Qr(e,t){const n={...e}
return(0,Nv.isSome)(t)&&(n.crops=t),n}function Xr(e,t,n){const r=Io(t,n.coercedCollectionTodayCardDisplayStyle),o=n.isHorizontalShelfContext?function(e,t){const n=[]
return n.push(Zr(e,[Zy])),t.horizontalCardContentType===yB&&n.push(Wr()),n.push(qr(0,["sr"]),Hr(0,["sr"])),n}(e,n):function(e,t,n){const r=new Set([wm.List,wm.NumberedList])
if(e.client.isPad&&n.isHeroCard&&!r.has(t))return Vr(0,n.isHeroCard)
switch(t){case wm.AppEventCard:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),GZ]
case wm.AppOfTheDay:case wm.GameOfTheDay:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),$Z]
case wm.List:case wm.NumberedList:return[oQ,dQ]
case wm.ShortImage:return n.isSearchContext?[Hr(),Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr()]:[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),Hr(),qr()]
case wm.FullBleedImage:return[Yr(),Jr(),kZ,Qr(DZ,undefined),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr(),Hr()]
case wm.SingleApp:case wm.Video:default:return[Yr(),Jr(),Kr(),Zr(e),...Vr(0,n.isHeroCard),Wr(),zr(),qr(),Hr()]}}(e,r,n)
let i,s=!1
const a=N(t)
if(W(a)&&(i=o.find(e=>(0,Nv.isSome)(B(a,e.objectPath))),s=(0,Nv.isSome)(i)),(0,Nv.isNothing)(i)&&(i=o.find(e=>(0,Nv.isSome)(B(t,e.objectPath)))),!i)return
const c=B(s?a:t,i.objectPath)
if(i.type===Yj){const t=i.crops.map(t=>{let r=t
return n.isSearchContext&&(0,Nv.isSome)(n.prevailingCropCodes)?r=n.prevailingCropCodes.defaultCrop:(0,Nv.isSome)(n.prevailingCropCodes)&&(0,Nv.isSome)(n.prevailingCropCodes[i.objectPath])&&(r=n.prevailingCropCodes[i.objectPath]),qd(e,c,{withJoeColorPlaceholder:!0,cropCode:r,useCase:n6.TodayCardMedia,overrideHeight:i.sourceHeight,overrideWidth:i.sourceWidth})}),r=eh(c)
return{artworks:t,videos:[],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:r}}{const t=p(c,EG),r=h(t,tG),o=h(t,OG)>=r
let s=i.sourceHeight,a=i.sourceWidth
o&&([s,a]=[a,s])
const l=qd(e,t,{withJoeColorPlaceholder:!0,cropCode:i.crops[0],useCase:n6.TodayCardMedia,overrideHeight:s,overrideWidth:a})
if((0,Nv.isNothing)(l))return
let u={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0};(0,Nv.isSome)(n.videoPlaybackControls)&&(u=n.videoPlaybackControls)
let d={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0};(0,Nv.isSome)(n.videoPlaybackControls)&&(d=n.videoAutoplayPlaybackControls)
const w=f(c,jH)
if((0,Nv.isNothing)(w))return
const g=new nz(w,l,{playbackControls:u,autoPlayPlaybackControls:d,canPlayFullScreen:n.enableFullScreenVideo}),v=eh(t)
return{artworks:[],videos:[g],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:v}}}function eo(e,t=YB,n,r,o,i,s,a=Qq){const c=qW.fromComponents(hW,null,`/${yW.arcadeSeeAllGames}`,{sort:t}),l=new fY(QU,c.build())
return l.title=null!=o?o:e.loc.string(i$),Qs(e,l,{id:null!=i?i:mA,idType:s,targetType:a,actionType:Xq,actionContext:nq,pageInformation:n,locationTracker:r}),l}function to(e,t,n,r,o){var s,a,c,l
const u=new jK(qq,t,e.bag.metricsTopic,n)
u.purchaseSuccessAction=r,u.carrierLinkSuccessAction=r
const d=new fY(dj);(0,Nv.isSome)(null===(a=null===(s=null==o?void 0:o.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(u.metricsOverlay[mH]=null===(c=o.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const f=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([Yv.user,Yv.client])
return(0,Nv.isSome)(f)&&(u.metricsOverlay={...u.metricsOverlay,...f}),d.pageData=u,i(o)&&Zs(e,d,o),d}function no(e,t,n,r){{const e=new cX(qq)
return i(r)&&(e.popToRoot=r),new MJ([e])}}function ro({objectGraph:e,metricsPageInformation:t,metricsLocationTracker:n,target:r={playNow:{}}}){const o=new lX(r)
return Qs(e,o,{targetType:yq,id:JB,actionType:Xq,pageInformation:t,locationTracker:n}),o}function oo(e,t,n,r){let o
o=Ot(e,"resource://GameCenterEyebrow",16,16)
const i=e.featureFlags.isEnabled(rJ),s=e.featureFlags.isEnabled(oJ),a=e.featureFlags.isGSEUIEnabled(yJ)
if(a){const r={eyebrowColor:Se(BF),includeSeparator:!i,prefersShelfHeader:s}
return{eyebrow:e.loc.string(yA),eyebrowArtwork:o,eyebrowArtworkType:em.Icon,title:t,subtitle:n,configuration:r}}{const c={eyebrowColor:a?Se(pL):void 0,includeSeparator:!i,prefersShelfHeader:s}
return(0,Nv.isSome)(r)&&r?{title:t,titleArtwork:o,titleArtworkType:em.Icon,subtitle:n,configuration:c}:{eyebrow:e.loc.uppercased(e.loc.string(yA)),eyebrowArtwork:o,eyebrowArtworkType:em.Icon,title:t,subtitle:n,configuration:c}}}function io(e,t=!1){let n=new Jz(e).forType(FV).includingAgeRestrictions()
return t&&(n=n.addingQuery(wL,bO)),n}function so(e,t){return io(e).withSparseLimit(t).asPartialResponseLimitedToFields([Hq]).usingCustomAttributes(Ue(e))}function ao(e,t,n){return function(e,t,n){o(t)&&(t=pt(ij))
const r=new Jz(e).forType(dj).addingQuery("serviceType",qq).addingQuery("placement",t).includingMetaKeys(aV,[fj]).includingRelationships([Jq]).includingAttributes([AA,SO]).includingAgeRestrictions()
return i(n)&&r.addingQuery(TA,n),r}(e,t,n)}function co(e,t){let n=null
const s=fe(t,bA)||fe(t,aV)
if(o(s)||o(s.data))return null
const a=s.data.map(e=>e.type===aV?e:null).filter(e=>i(e))
if(o(a))return null
const c=e.bag.marketingItemSelectionTimeout
if(1===a.length||0===c)n=a[0]
else try{n=e.arcade.getMarketingItemWithTimeout(a,c)}catch{n=a[0]}return r(n)?null:{marketingItemData:n}}function lo(e,t){if(!t)return null
let n=null
const r=l(t,aO)
return r.length>0&&(n=r[0]),i(n)?{marketingItemData:n}:null}function uo(e,t,n,r,o){const i=On(0,r)
if((0,Nv.isSome)(i.suppressLockup)&&i.suppressLockup)return null
let s=null
const a=(0,Nv.isSome)(o)&&1===o.length,c=(0,Nv.isSome)(o)&&o.length>1
return a?s=new AZ(o[0]):c&&(s=new sX(o)),s}function fo(e,t,n,r,o,i,s){if(!H(o,l_))return
let a=co(e,o);(0,Uv.isNothing)(a)&&(0,Nv.isSome)(i)&&(a=lo(0,i.arcadeUpsellEditorialResponse))
const c=function(e,t,n,r,o,i,s){if(!function(e){const t=e.host.platform
return t===Kj||t===OV}(e))return null
ho(e,t,n,r)
const a=$o(),c=Od(e,i,s,pt(sj),a,Cj)
return new aX(c)}(e,o,t,n,0,a,s)
if(c){t.overlay=c,t.impressionMetrics.fields[xS]=!0
const r=ho(e,o,t,n)
t.style!==r&&(t.style=r)}}function ho(e,t,n,r){const o=!r.enableListCardToMultiAppFallback,i=Xr(e,t,r),s=Mo(null==i?void 0:i.joeColors)
return o?n.style:s}function po(e,t,n){if((0,Nv.isNothing)(t))return
const r=Nt(n.pageInformation)
if(null===r)return
r.id=sh(n.id)
const o=rh(n);(0,Nv.isSome)(o)&&(r[GM]=o),r[fV]=jH,r.typeDetails="iTunesStoreContent",r[jB]=ph(e,n,""),n.actionDetails&&(r[xG]=n.actionDetails),t.templateMediaEvent=function(e,t){const n={}
return Object.assign(n,t),n[Rj]=cS,Ft(e,n),Dt(0,new zJ(n,[],[],$t(e,n),xt(e,n)))}(e,r)
const i=S(r)
i[TN]=t.videoUrl,t.templateClickEvent=function(e,t,n,r){const o={}
Object.assign(o,r),o[Rj]=vU,o[AM]=n,o[iS]=null
const i=[mU]
return Ft(e,o),Dt(0,new zJ(o,i,[],$t(e,o),xt(e,o)))}(e,0,Qq,i)}function wo(e,t){return u(t,uX)}function go(e,t,n,r,o){return Bv.context("createTodayBaseCard",()=>{const i=new YJ,s=Io(t,null==n?void 0:n.coercedCollectionTodayCardDisplayStyle),a=vo(e,t,s,n)
i.heading=a
const c=function(e,t,n){var r
let o=null
if((null==n?void 0:n.useOTDTextStyle)&&(o=null!==(r=j(t,"ofTheDayLabel"))&&void 0!==r?r:j(t,$H),(0,Uv.isSome)(o)&&(o=o.replace(/\n/g,r$))),(0,Uv.isNothing)(o)&&(o=Uf(e,t,Zq,!0)),(0,Uv.isNothing)(o)){const e=mo(0,t)
o=(0,Uv.isSome)(e)?j(e,Zq):null}return o}(e,t,n)
i.title=null!=c?c:void 0
const l=Qe(e,t,[S$,Zq])
i.shortTitle=l
const u=function(e,t){return qd(e,B(t,kT),{contentMode:Hv.scaleAspectFit,allowingTransparency:!0,useCase:n6.TodayCardBrandedTitle})}(e,t)
i.titleArtwork=u
const d=function(e,t){var n
const r=On(0,t)
if(H(t,PE)||r.suppressNoteShort)return null
let o=Uf(e,t,Uj,!0)
if((0,Uv.isNothing)(o)&&!r.suppressNoteTagline){const r=mo(0,t);(0,Uv.isSome)(r)&&(o=null!==(n=Uf(e,r,gj))&&void 0!==n?n:wd(e,r))}return o}(e,t)
i.inlineDescription=d
const f=Po(e,t,n,r,c)
return f.adSlotOverride=r.parsedCardCount,i.clickAction=function(e,t,n,r,o,i,s){var a
const c=i,l={cardType:n,franchise:j(t,$H)},u=wo(0,t)
return u&&(l[FS]=u),c[xG]=l,(0,Uv.isSome)(s)&&s(c),Md(e,t,c,null!==(a=null==r?void 0:r.clientIdentifierOverride)&&void 0!==a?a:e.host.clientIdentifier,Ws(o.currentTodayItem),r)}(e,t,s,n,r,f,o),Rh(e,i,f,a,s,wo(0,t)),i.editorialDisplayOptions=function(e,t,n){var r
const o=On(0,t),i=e.client.isPad&&(null==n?void 0:n.isHeroCard)
return{suppressTagline:V(t,PE),suppressLockup:v(o.suppressLockup),showBadgeInSmallCards:null!==(r=n.alwaysShowBadgeInSmallCards)&&void 0!==r?r:v(o.showBadgeInSmallCards),useMaterialBlur:n.alwaysUseMaterialBlur||i||v(o.useMaterialBlur)}}(e,t,n),i})}function vo(e,t,n,o){var i,s
let a=null
if(null==o?void 0:o.useOTDTextStyle)a=o.isHorizontalShelfContext?j(t,$H):null
else if(function(e,t){let n=j(e,"ofTheDayIntent")
if((0,Nv.isNothing)(n))switch(Io(e,null==t?void 0:t.coercedCollectionTodayCardDisplayStyle)){case wm.AppOfTheDay:n=mm.AppOfTheDay
break
case wm.GameOfTheDay:n=mm.GameOfTheDay}return n===mm.AppOfTheDay||n===mm.GameOfTheDay}(t,o))a=null!==(i=j(t,zD))&&void 0!==i?i:j(t,$H),r(a)&&n===wm.AppOfTheDay?a="FEATURED APP":r(a)&&n===wm.GameOfTheDay&&(a="FEATURED GAME")
else if(n===wm.AppEventCard){const n=mo(0,t);(0,Uv.isSome)(n)&&(a=null!==(s=Gf(e,t,qB,!0))&&void 0!==s?s:j(n,fH))}else a=j(t,$H)
return a}function mo(e,t){const n=we(t,aH)
if(1===(null==n?void 0:n.length))return n[0]
const r=Oo(0,t)
return 1===r.length?r[0]:null}function yo(e,t,n,r,o){return Bv.context("addArtworkMediaToBaseCard",()=>{var i
if(H(t,h_))return!1
const s=Xr(e,t,r)
return!(0,Uv.isNothing)(s)&&((0,Uv.isSome)(o)&&po(e,null==s?void 0:s.videos[0],{pageInformation:o.pageInformation,locationTracker:o.locationTracker,id:t.id}),n.media=new hZ(s.artworks,s.videos,s.artworkLayoutsWithMetrics,null!==(i=_o(0,t,r))&&void 0!==i?i:void 0),n.style=Mo(s.joeColors,HG),(0,Uv.isSome)(n.clickAction)&&wt(n.clickAction)&&(n.overlay=new mZ(n.clickAction),n.style=JH),!0)})}function Ao(e,t,n,r,o){return Bv.context("createTodaySingleAppCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=yo(e,t,s,n,r),c=Oo(0,t),l=ko(e,c,n,r.pageInformation,r.locationTracker,Cj,null,na(0,t)),u=uo(0,0,0,t,l)
var d
return i(u)&&$r(d=u)&&d[tW]===Sy&&(u.style=JH),s.overlay=u,a||1!==c.length||To(e,t,s,c,n,r)?(fo(e,s,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),s):(Co(r),null)})}function To(e,t,n,r,o,i){if(1!==r.length)return!1
o.useJoeColorIconPlaceholder=!0,n.style=kq
const s=$o(0,n.style),a=ko(e,r,o,i.pageInformation,i.locationTracker,Fo(n.style),s,na(0,t))
if(1!==a.length)return!1
const c=a[0]
return n.media=new fX(c.icon),!0}function bo(e,t,n,a,c){return Bv.catchingContext("todayCardFromData",()=>{const l=Io(t,n.coercedCollectionTodayCardDisplayStyle),d=Fr(e,t);(0,Nv.isSome)(d)&&(function(e,t,n,r){var o
if(n===mz||n===yz)return!0
const i=Oo(0,t),s=Io(t,r.coercedCollectionTodayCardDisplayStyle)
if(!new Set([wm.AppEventCard,wm.Grid,wm.InAppPurchase,wm.List,wm.NumberedList,wm.River,wm.ShortImage,wm.SingleApp]).has(s))return!1
if(i.length>=6&&s===wm.Grid)return!1
const a=Ro(0,s)
return!(!H(t,h_)&&Do(e,B(t,a),null===(o=r.prevailingCropCodes)||void 0===o?void 0:o.defaultCrop)||function(e,t){if(1===t.length){const e=t[0]
if(e.type===FH)return e}return null}(0,i))}(e,t,d,n)?n.clientIdentifierOverride=d:n.clientIdentifierOverride=null),n.crossLinkSubtitle=Bo(e,t)
let f=null
switch(l){case wm.AppOfTheDay:case wm.GameOfTheDay:f=function(e,t,n,r,i){return Bv.context("createTodayBrandedCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=Xr(e,t,n)
if(!((0,Uv.isSome)(a)&&(0,Uv.isSome)(a.joeColors.bgColor)&&(a.artworks.length>0||a.videos.length>0)))return Co(r),Ao(e,t,n,r)
s.style=Mo(null==a?void 0:a.joeColors,HG)
const c=$o(0,s.style),l=Oo(0,t),u=ko(e,l,n,r.pageInformation,r.locationTracker,Fo(s.style),c,na(0,t),!0)
if(o(u)||1!==u.length)return Co(r),null
n.isHorizontalShelfContext||(s.overlay=uo(0,0,0,t,u))
const d=u[0]
return s.media=new dX(d.icon,a.artworks,a.videos,a.artworkLayoutsWithMetrics,_o(0,t,n)),s.media.impressionMetrics=d.impressionMetrics,fo(e,s,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Co(r),s})}(e,t,n,a,c)
break
case wm.Video:f=function(e,t,n,r,o){return Bv.context("createTodayVideoCard",()=>{const i=go(e,t,n,r)
yo(e,t,i,n,r),So(e,t,n,r)
const s=$o(0,i.style),a=Oo(0,t),c=ko(e,a,n,r.pageInformation,r.locationTracker,Cj,s,na(0,t)),l=uo(0,0,0,t,c)
return i.overlay=l,fo(e,i,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i})}(e,t,n,a,c)
break
case wm.FullBleedImage:f=function(e,t,n,r,o){return Bv.context("createTodayFullBleedImageCard",()=>{const i=go(e,t,n,r)
if(So(e,t,n,r),!yo(e,t,i,n,r))return Co(r),null
const s=Oo(0,t),a=$o(0,i.style),c=ko(e,s,n,r.pageInformation,r.locationTracker,Fo(i.style),a,na(0,t)),l=uo(0,0,0,t,c)
return i.overlay=l,fo(e,i,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i})}(e,t,n,a,c)
break
case wm.InAppPurchase:f=function(e,t,n,r,i){return Bv.context("createTodayInAppPurchaseCard",()=>{const s=go(e,t,n,r)
So(e,t,n,r)
const a=function(e,t){if(1===t.length){const e=t[0]
if(e.type===FH)return e}return null}(0,Oo(0,t))
if(o(a))return Co(r),null
const c=Td(e,a,{offerStyle:wj,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker},artworkUseCase:n6.LockupIconSmall})
return o(c)?(Co(r),null):(c.theme=TH,s.media=new hX(c),s.media.impressionMetrics=c.impressionMetrics,s.media.impressionMetrics.fields[mM]=s.impressionMetrics.fields.id,s.style=JH,fo(e,s,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),Co(r),s)})}(e,t,n,a,c)
break
case wm.AppEventCard:f=function(e,t,n,r,o){return Bv.context("createTodayAppEventCard",()=>{var i,s,a,c,l
if(!oi(e))return null
const d=function(e,t){let n
const r=we(t,aH)
if(r.length>0)n=r[0]
else{const e=we(t,wH)
if(0===e.length)return null
n=e[0]}return n}(0,t)
if((0,Uv.isNothing)(d))return null
const f=go(e,t,n,r,t=>{t.inAppEventId=d.id
const n=pe(e,d,Mq);(0,Nv.isSome)(n)&&(t.relatedSubjectIds=[n.id])});(0,Nv.isSome)(f.editorialDisplayOptions)&&(f.editorialDisplayOptions.useMaterialBlur=!0),So(e,t,n,r)
const h=Xr(e,t,n)
if((0,Uv.isNothing)(h))return Co(r),null
const p=null!==(s=null===(i=h.joeColors)||void 0===i?void 0:i.textColor4)&&void 0!==s?s:Qz,w=be(null!==(c=null===(a=h.joeColors)||void 0===a?void 0:a.bgColor)&&void 0!==c?c:Qz)?kq:QH,g={pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:Zx}
f.style=null!==(l=Lo(h.joeColors,ZN))&&void 0!==l?l:be(p)?kq:QH
const v=$o(0,f.style),m=j(t,$H),y=wi(e,d,null,!1,!1,Fo(f.style),v,!0,g,!0,!0,m,!1,u(n.allowUnpublishedAppEventPreviews))
if((0,Uv.isNothing)(y)||y instanceof Date)return Br(y,r.refreshController),Co(r),null
const A=y
return f.media=new yZ(A.formattedDates,A.startDate,p,h.artworks,h.videos,h.artworkLayoutsWithMetrics,w),(0,Nv.isSome)(A.lockup)&&(f.overlay=new AZ(A.lockup)),fo(e,f,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),f})}(e,t,n,a,c)
break
case wm.List:case wm.NumberedList:f=function(e,t,n,r,o){return Bv.context("createTodayListCard",()=>{var i,s,a
const c=go(e,t,n,r)
So(e,t,n,r),n.useJoeColorIconPlaceholder=!0
let l=Oo(0,t)
const u=ko(e,l,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0)
if(0===u.length)return Co(r),null
if(n.canDisplayArcadeOfferButton=!1,u.length<function(e){return"tv"===e.client.deviceType?3:4}(e)&&n.enableListCardToMultiAppFallback)Eo(e,t,u,c)
else{if(Io(t,n.coercedCollectionTodayCardDisplayStyle)===wm.NumberedList){let e=1
for(const t of u)t.ordinal=`${e}`,e++}const r=Xr(e,t,n),o=Lo(null==r?void 0:r.joeColors,HG),l=!0
null==r||r.videos.forEach(e=>{e.canPlayFullScreen=!1,e.playbackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},e.autoPlayPlaybackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}}),c.style=l?void 0:JH,c.media=new pX(u,null!==(i=null==r?void 0:r.artworks)&&void 0!==i?i:[],null!==(s=null==r?void 0:r.videos)&&void 0!==s?s:[],null!==(a=null==r?void 0:r.artworkLayoutsWithMetrics)&&void 0!==a?a:[],void 0,l?o!==JH:o===kq)}return fo(e,c,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),c})}(e,t,n,a,c)
break
case wm.River:case wm.Grid:f=function(e,t,n,r,o){return Bv.context("createTodayRiverCard",()=>{const i=go(e,t,n,r)
n.useJoeColorIconPlaceholder=!0,So(e,t,n,r)
const s=function(e,t,n,r,o){const i=Oo(0,t).filter(t=>{const n=$f(e,t)
return!Mf(e,t)||!n})
return ko(e,i,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0,!1)}(e,t,n,r)
return 0===s.length?(Co(r),null):(n.canDisplayArcadeOfferButton=!1,s.length<function(e){return"tv"===e.client.deviceType?2:4}(e)?Eo(e,t,s,i):(i.style=kq,function(e){for(const t of e)be(t.icon.backgroundColor,90)||(t.icon.backgroundColor=Ae(.8,.8,.8))}(s),i.media=new wX(s)),fo(e,i,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i)})}(e,t,n,a,c)
break
case wm.SingleApp:f=Ao(e,t,n,a,c)
break
case wm.ShortImage:f=function(e,t,n,r,o){return Bv.context("createTodayShortImageCard",()=>{const i=go(e,t,n,r)
So(e,t,n,r)
const s=yo(e,t,i,n,r)
let a=!1
const c=Oo(0,t),l=$o(0,i.style),u=ko(e,c,n,r.pageInformation,r.locationTracker,Fo(i.style),l,na(0,t)),d=uo(0,0,0,t,u)
return i.overlay=d,s||1!==c.length||(a=To(e,t,i,c,n,r)),s||a?(fo(e,i,n,Io(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),Co(r),i):(Co(r),null)})}(e,t,n,a,c)
break
default:f=null}return r(f)?(e.console.log(`Unknown style: ${l}`),f):(function(e,t,n,r){const o=Io(r,n.coercedCollectionTodayCardDisplayStyle),s=No(e,r,n.heroDisplayContext,o,n.prevailingCropCodes)
let a=[],c=[]
var l
i(s)&&(a=[s]),i(t.media)&&(A(l=t.media)&&l[tW]===Ty||function(e){return A(e)&&e[tW]===my}(t.media))&&(c=t.media.videos),new wZ(a,c)}(e,f,n,t),function(e){(0,Nv.isSome)(e.clickAction)&&wt(e.clickAction)&&(e.overlay=new mZ(e.clickAction),e.style=JH)}(f),function(e,t){(0,Nv.isNothing)(e.media)||(e.media.otdTextStyle=t.useOTDTextStyle)}(f,n),function(e,t){const n=t.media
if(!function(e){return A(e)&&function(e){return Object.values(uZ).includes(e)}(e[tW])}(r=n)||!function(e){return Object.values(lZ).includes(e)}(r[tW]))return
var r
const o=s(n.videos)
t.supportsMediaMirroring=o}(0,f),(0,Nv.isNothing)(f.media)&&(e.console.log(`Missing required media: ${l}`),f=null),f)},t=>(e.console.log(t),null))}function So(e,t,n,r,i){const a=s(i)?i:function(e,t,n){let r=Uf(e,t,Zq)
if(o(r))switch(n){case wm.AppOfTheDay:case wm.GameOfTheDay:r=j(t,$H)}return r}(e,t,Io(t,n.coercedCollectionTodayCardDisplayStyle))
gh(e,Po(e,t,n,r,a),null!=a?a:"")}function Po(e,t,n,r,o){var i
return Lh(e,t,null!=o?o:"",{...null==n?void 0:n.baseMetricsOptions,targetType:Cj,pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdEligible:null!==(i=null==n?void 0:n.isAdEligible)&&void 0!==i&&i,optimizationId:f(t,uI),optimizationEntityId:f(t,dI),rowIndex:null==n?void 0:n.currentRowIndex,displayStyle:null==n?void 0:n.metricsDisplayStyle})}function Co(e){mh(e.locationTracker)}function Io(e,t){const n=j(e,AN)
return gX.has(n)&&(0,Nv.isSome)(t)?t:n}function ko(e,t,n,r,i,a,c,l,u=!0){return o(t)?[]:Rd(e,t.filter(e=>!s(e.attributes)||e.type!==FH),{lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},offerEnvironment:a,offerStyle:c,clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:l,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:n6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,useJoeColorIconPlaceholder:n.useJoeColorIconPlaceholder,skipDefaultClickAction:!u},filter:Wv.TodayCard})}function Oo(e,t){return we(t,wH)}function Eo(e,t,n,r){const o=Uf(e,t,Uj)
if(r.media=new pZ(n,o),r.style=kq,(0,Nv.isSome)(r.clickAction)&&ht(r.clickAction)){const e=qW.from(r.clickAction.pageUrl)
e.param(DW.showingFallbackMedia,XH),r.clickAction.pageUrl=e.build()}}function Ro(e,t){switch(t){case wm.AppOfTheDay:case wm.GameOfTheDay:return u_
case wm.AppEventCard:return d_
case wm.Video:case wm.FullBleedImage:return sM
default:return f_}}function Do(e,t,n){if(o(t))return null
const r=qd(e,t,{withJoeColorPlaceholder:!0,useCase:n6.TodayCardMedia})
return r.crop=n||"sr",r}function _o(e,t,n){const r=B(t,Ro(0,Io(t,n.coercedCollectionTodayCardDisplayStyle)))
return i(r)?f(r,"bgGradientKind"):null}function Lo(e,t=HG){if((0,Nv.isNothing)(e))return
if((0,Nv.isSome)(null==e?void 0:e.textGradient)&&2===e.textGradient.length)return be(e.textGradient[0])?JH:kq
const n=e[t]
if((0,Nv.isNothing)(n))return
const r=Te(n)
return r<=.1?kq:r>=.84?JH:QH}function Mo(e,t=HG){var n
return null!==(n=Lo(e,t))&&void 0!==n?n:QH}function xo(e,t){return i(t.heading)?t.heading.replace(/\n/g," "):t.collapsedHeading}function $o(e,t){return uj}function Fo(e){return e===JH?QH:Cj}function No(e,n,r,o,i){const s=function(e,t,n,r){return t===cq?Ro(0,n):"editorialArtwork.crossoverCard"}(0,r,o,Object.keys(B(n,Tq)))
return Do(e,B(n,s),function(e,t,n,r){return Tm.Article,Tm.Article,null==r?void 0:r.defaultCrop}(0,0,t(s),i))}function Bo(e,t){let n=Gf(e,t,Uj)
if(s(n)||(n=Uf(e,t,Zq)),!s(n)){const e=j(t,dH)
e!==wm.AppOfTheDay&&e!==wm.GameOfTheDay||(n=j(t,$H))}return n}function Uo(e,t,n){const r=j(t,n)
if(o(r))return null
const s=new qW(r)
let a=null
switch(e.host.clientIdentifier){case Hz:a=qH
break
case Vz:a=zq}a&&s.param(BW,a)
const c=Ve(Ge(e,t))
return i(c)&&s.param(DW.productVariantID,c),s.toString()}function Go(e,t,n){if(o(t))return null
const r=new RJ(t)
return r.title=null!=n?n:e.loc.string("ShareSheet.CopyLink.Title"),r.artwork=Ot(e,"systemimage://link"),new YK("com.apple.AppStore.copyLinkActivity",r)}function jo(e,t,n){return Bv.context("shareSheetDataForProductFromProductData",()=>{if(r(t))return null
const o=Uo(e,t,Rq),s=j(t,Zq),a=j(t,$V),c=t.id,l=e.client.storefrontIdentifier
if(!(o&&s&&a&&c))return null
const u=Uo(e,t,"shortUrl")
let d=null,f=null
const h=rf(e,t,n6.LockupScreenshots),p=nf(e,t),w=Qe(e,t,vH)||a
let g
const v=xe(e,t,Yq)
Me(e,t,Yq),g=v?iO:Kj,i(t)&&j(t,Rq)&&(d=Jd(e,t,{useCase:n6.LockupIconSmall},n),f=function(e,t){return Bv.context("notesMetadataFromProductData",()=>{var n
if(r(t))return null
const o=j(t,Zq)
if((0,Nv.isNothing)(o)||0===o.length)return null
const i=Uo(e,t,Rq),s=j(t,$V),a=j(t,"genreNames.0"),c=null===(n=Pf(e,t))||void 0===n?void 0:n.fileSizeByDevice
let l
switch(t.type){case Kq:l=Mq
break
case xq:l=$k
break
case FH:l=HU
break
default:l=null}return new zK(o,i,s,a,c,l)})}(e,t))
const m=new XK(c,l,s,g,d,h,p,!1,w,null,null,f)
return new KK(m,o,u)})}function Vo(e,t,n,o,s){return Bv.context(`shareActionFromData: ${t.type}`,()=>{var a
const c=t.id
switch(e.client.deviceType){case Yq:{const r=jo(e,t)
if(r){const t=new LK(r,[])
return Qs(e,t,{targetType:Qq,id:c,actionType:qN,pageInformation:n,locationTracker:o}),t}break}case jq:case $q:case Fq:{const l=jo(e,t,s),u=[]
if((null===(a=null==l?void 0:l.url)||void 0===a?void 0:a.length)>0){const t=Go(e,l.url)
i&&u.push(t)}const d=function(e,t){if(!e.bag.isContentGiftingEnabled)return null
if(r(t))return null
const n=wr(e,t)
return r(n)||V(t,eq)?null:h(n,MF)>0?t.id:null}(e,t)
if(d){const t=new fY(cj)
t.presentationContext=X_,t.title=e.loc.string("SHARE_GIFT_APP"),t.artwork=Ot(e,"systemimage://app.gift"),t.pageUrl=`gift/${d}`,Qs(e,t,{targetType:Qq,id:c,actionType:DF,actionContext:Xy,pageInformation:n,locationTracker:o})
const r=new YK("com.apple.AppStore.giftActivity",t)
u.push(r)}if(l){const t=new LK(l,u,$y)
return t.title=e.loc.string("SHARE_APP"),t.artwork=Ot(e,sO),Qs(e,t,{targetType:Qq,id:c,actionType:qN,actionContext:Xy,pageInformation:n,locationTracker:o}),t}if(u.length>0){const t=u.map(e=>e.action),r=new eZ(t)
return r.isCancelable=!0,r.isCustom=!0,Qs(e,r,{targetType:Qq,id:c,actionType:"actionSheet",pageInformation:n,locationTracker:o}),r}break}}return null})}function Ho(e,t,n){if((0,Nv.isNothing)(t))return null
const r=t.match(/P(\d+)([A-Z]+)/)
if(!r||3!==r.length)return null
let o=h(r[1]),i=r[2]
return o&&i?("D"===i&&o>0&&o%7==0&&(i="W",o/=7),new TX(o,null!=n?n:1,i)):null}function qo(e,t){const n=l(t,JE)[0]
if(!n)return null
const r=f(n,JU),o=h(n,KU),i=f(t,JU),s=h(t,KU)
if(!r||!i)return null
const a=f(n,YS),c=Ho(0,r,o),u=Ho(0,i,s),d=f(n,jG).replace(/ /g,"\xa0"),p=f(t,jG).replace(/ /g,"\xa0")
let w=Wo(e,u.type,u.periodDuration,p)
switch(w=w.replace(/\//g,"\u2060/\u2060"),a){case JS:const t=zo(e,c.type,c.periodDuration*c.periodCount)
if(t&&w)return e.loc.string("InAppOfferPage.Description.FreeTrialTemplate").replace(xR,t).replace($R,w)
break
case KS:const n=zo(e,c.type,c.periodDuration*c.periodCount)
if(n&&w)return e.loc.string("InAppOfferPage.Description.PaidUpFrontTemplate").replace(xR,n).replace("@@trialPrice@@",d).replace($R,w)
break
case ZS:const r=Wo(e,c.type,c.periodDuration,d),o=zo(e,c.type,c.periodDuration*c.periodCount)
if(o&&w)return e.loc.string("InAppOfferPage.Description.PaidTrialTemplate").replace("@@trialPriceDuration@@",r).replace(xR,o).replace($R,w)
break
default:return null}return null}function Wo(e,t,n,r){let o
switch(t){case"D":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Days.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Days",n)
break
case"W":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Weeks.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Weeks",n)
break
case"M":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Months.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Months",n)
break
case"Y":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Years.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Years",n)}return o.replace("@@price@@",r)}function zo(e,t,n){switch(t){case"D":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Days.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Days",n)
case"W":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Weeks.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Weeks",n)
case"M":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Months.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Months",n)
case"Y":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Years.one").replace(ZU,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Years",n)}return null}function Yo(e,t){var n,r,i
const s=pe(e,t,WB)
if((0,Uv.isNothing)(s))return
const a=wr(e,s),c=p(s,_F)
if(o(a)||o(c))return
const l=null===(n=Jo(e,f(a,JU),h(a,KU),f(a,jG)))||void 0===n?void 0:n.replace("/","/\u2060"),u=null===(r=Jo(e,f(c,JU),h(c,KU),f(c,jG)))||void 0===r?void 0:r.replace("/","/\u2060")
if(o(l)||o(u))return null
const d=j(t,Zq),w={"@@discountedPrice@@/@@recurringSubscriptionPeriod@@":u,"@@regularPrice@@/@@recurringSubscriptionPeriod@@":l,"@@discountedPricePerRecurringSubscriptionPeriod@@":u,"@@regularPricePerRecurringSubscriptionPeriod@@":l}
let g=null!=d?d:""
Object.keys(w).forEach(e=>{g=g.replace(e,w[e])})
const v=g.replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,""),m=new AX(g,sV,pA),y=null!==(i=j(t,bG))&&void 0!==i?i:"",A=e.loc.string("ContingentOffer.Description.Format"),T={"@@BranchName@@":j(s,Zq),"@@RegularPrice@@":l,"@@DiscountedPrice@@":u}
let b=A
return Object.keys(T).forEach(e=>{b=b.replace(e,T[e])}),{title:m,rawTitle:v,description:[b,y].join(" ")}}function Jo(e,t,n,r){const o=Ho(0,t,n)
if(!(0,Uv.isNothing)(o)&&!(0,Uv.isNothing)(r))return Wo(e,o.type,o.periodDuration,r)}function Ko(e,t,n,r,o){let i
switch(t){case HB:i=Xq
break
case VB:i=VB
break
case dL:i=GG}const s={targetType:Qq,actionType:i,targetId:t,idType:void 0,location:ph(e,{pageInformation:n,locationTracker:r,targetType:Qq,id:t},null!=o?o:t)}
return _t(e,t,Qq,s)}function Zo(e,t,n,r){const o=Ho(0,t,n)
return(0,Uv.isNothing)(o)||(0,Uv.isNothing)(r)?null:Wo(e,null==o?void 0:o.type,null==o?void 0:o.periodDuration,r)}function Qo(e,t,n,r,o){let i
switch(t){case HB:i=Xq
break
case VB:i=VB
break
case dL:i=GG}const s={targetType:Qq,actionType:i,targetId:t,idType:void 0,location:ph(e,{pageInformation:n,locationTracker:r,targetType:Qq,id:t},null!=o?o:t)}
return _t(e,t,Qq,s)}function Xo(e){switch(e.type){case Vq:return hm.AppEvent
case iV:return hm.ContingentOffer
case EV:return hm.OfferItem
default:return null}}function ei(e){switch(e.type){case Vq:return Zx
case iV:case EV:return gO
default:return null}}function ti(e){switch(e.type){case Vq:return fA
case iV:return"contingentPriceOffer"
case EV:return"winbackPriceOffer"
default:return null}}function ni(e,t,n,s,a,c,l,u,d,w,v,m,y,A){const T=Xo(t),b={...d,targetType:ei(t)}
switch(T){case hm.AppEvent:return wi(e,t,n,s,a,c,l,u,b,w,v,m,y,A)
case hm.ContingentOffer:return function(e,t,n,s,a,c,l,u){var d,f,h,w
if(t.type!==iV)return null
const v=ci(e,t,zx)
if(r(v))return null
const m=be(v.backgroundColor)?kq:QH,y=j(t,qB),A=j(t,vH),T=j(t,$H),b=e.loc.string("ContingentOffer.AdditionalInfoButton.Title")
if((0,Uv.isNothing)(y)||(0,Uv.isNothing)(T))return null
const S=pe(e,t,WB)
if((0,Uv.isNothing)(S)||o(p(S,_F)))return null
const P=Yo(e,t)
if((0,Uv.isNothing)(P)||(0,Uv.isNothing)(null==P?void 0:P.title))return null
const C=pe(e,t,e$),I=H(C,FF),k=ui(e,t,C,"",s,a,!1,c,l,null,u,!0)
if((0,Uv.isNothing)(k))return null
const O=pe(e,t,mO)
let E;(0,Uv.isSome)(O)&&(0,Uv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(d=ci(e,O,Hq))&&void 0!==d?d:ai(e,O,Hq)),(0,Uv.isSome)(A)&&(null==A?void 0:A.length)>0&&(E=null!==(f=function(e,t){var n,r
const o=g(t,"meta.associations.trunks")
if((0,Uv.isNothing)(o))return null
const i=o.data[0]
if(null!==(r=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n[yO])&&void 0!==r&&r){const t=Ke(e,i,AO)
return(0,Uv.isNothing)(t)?null:qd(e,t,{useCase:n6.LockupIconSmall,style:XN})}return null}(e,t))&&void 0!==f?f:E)
const R=function(e,t,n){const r=t$+j(n,Zq)+n$,o=j(n,bG)+r$,i=t$+e.loc.string("ContingentOffer.Terms.Title")+n$,s=j(t,NF)
return new AX([r,o,i,s].join(r$),sV)}(e,t,S),D=new yX(v,m,I,b,P.title,null!=A?A:void 0,null!==(h=P.description)&&void 0!==h?h:void 0,T,y,R,null!=E?E:void 0,k)
return D.title=null!==(w=P.rawTitle)&&void 0!==w?w:void 0,i(C)&&(D.clickAction=fi(e,t,C,D,c,l)),D}(e,t,0,c,l,b,v,y)
case hm.OfferItem:return function(e,t,n,s,a,c,l,u){var d,w,g,v,m,y
if(t.type!==EV)return null
const A=j(t,fH)
if("resubscription"!==A&&A!==o$)return null
const T=QH,b=pe(e,t,zB)
if((0,Uv.isNothing)(b))return null
const S=p(b,Z_),P=wr(e,b)
if((0,Uv.isNothing)(S))return null
const C=null!==(d=null!=n?n:pe(e,t,Mq))&&void 0!==d?d:pe(e,b,Mq),I=H(C,FF),k=j(t,fL)
if((0,Uv.isNothing)(k)||!function(e){if((0,Uv.isNothing)(e)||o(e))return!1
const t=new Date(e)
if(r(t))return!1
const n=new Date
return!(t.getTime()<=n.getTime())}(k))return null
const O=new Date(k)
let E=function(e,t){if((0,Uv.isNothing)(t))return null
const n=Re(t),o=new Date,i=(a=n,r(s=o)||r(a)?null:Math.floor((a.getTime()-s.getTime())/864e5))
var s,a
if((0,Uv.isNothing)(i))return null
const c=function(e,t){var n,r
return(null===(n=Re(e))||void 0===n?void 0:n.getTime())===(null===(r=Re(t))||void 0===r?void 0:r.getTime())}(o,t)
if(i>90)return e.loc.string(gA)
if(i>5){const n=o.getFullYear()!==t.getFullYear()?e.loc.string("OfferItems.FormattedDate.NextYear.DateFormat"):e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.DateFormat"),r=e.loc.uppercased(e.loc.formatDate(n,t))
return(0,Uv.isNothing)(r)?null:e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.Title").replace(vA,r)}return i>1?e.loc.string("OfferItems.FormattedDate.FiveDaysOrLess.Title").replace(ZU,e.loc.formattedCount(i)):1!==i||c?e.loc.string("OfferItems.FormattedDate.Today.Title"):e.loc.string("OfferItems.FormattedDate.Tomorrow.Title")}(e,O);(0,Uv.isNothing)(E)&&(E=e.loc.string(gA))
let R=Jd(e,b,{useCase:n6.LockupIconLarge,withJoeColorPlaceholder:!0,overrideTextColorKey:ZN})
o(R)&&(R=Ot(e,TO,200,200,{type:bV,red:0,green:0,blue:0,alpha:1}),R.style=HU)
const D=Ho(0,f(S,JU),h(S,KU)),_=(0,Uv.isSome)(D)?zo(e,D.type,D.periodDuration*D.periodCount):void 0,L=null===(w=Zo(e,f(P,JU),h(P,KU),f(P,jG)))||void 0===w?void 0:w.replace("/","/\u2060"),M=null===(g=Zo(e,f(S,JU),h(S,KU),f(S,jG)))||void 0===g?void 0:g.replace("/","/\u2060"),x=e.loc.string(wA),$={"@@redemptionDate@@":e.loc.formatDate(x,O),"@@skuName@@":null!==(v=j(b,Zq))&&void 0!==v?v:"@@skuName@@","@@discountedPrice@@":null!=M?M:"@@discountedPrice@@","@@regularPricePerDuration@@":null!=L?L:"@@regularPricePerDuration@@","@@discountDuration@@":null!=_?_:"@@discountDuration@@","@@payUpfrontPrice@@":null!==(m=f(S,jG))&&void 0!==m?m:"@@payUpfrontPrice@@"},F=j(t,qB)
if((0,Uv.isNothing)(F))return null
const N=pi(j(t,Pq),$),B=new AX(N,sV,pA),U=pi(j(t,vH),$),G=pi(null!==(y=j(t,hL))&&void 0!==y?y:"",$)
let V
if(i(C)&&(V=ui(e,t,C,"",s,a,!1,c,l,null,u,!0)),(0,Uv.isNothing)(V))return null
const q=new bX(null,null,T,I,B,E,U,G,F,O,R,V)
return q.title=N,i(C)&&(q.clickAction=fi(e,t,C,q,c,l)),q}(e,t,n,c,l,b,v,y)
default:return null}}function ri(e,t,n,o,a,c,l,u){const d=Xo(t),f={...a,targetType:ei(t)}
switch(d){case hm.AppEvent:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=ai(e,t,YU),p=li(e,t,JN,!0,!0),w=S(o),g=null!==(d=null==p?void 0:p.preview)&&void 0!==d?d:h
let v=kq,m=!0,y=!1
i(g)&&(m=be(g.backgroundColor),y=be(g.backgroundColor,10),v=m?kq:QH)
const A=Wn(0,hm.AppEvent,t.id,n.id,l,null!==(f=a.recoMetricsData)&&void 0!==f?f:null),T={...a,pageInformation:A,locationTracker:{rootPosition:0,locationStack:[]},targetType:KN},b={...T,id:n.id,inAppEventId:t.id,relatedSubjectIds:[n.id]}
w.notificationConfig=di(e,t,o,b,!1)
const P=function(e,t,n,r){var o,s
const a=j(t,Rq)
if((0,Nv.isNothing)(a)||0===a.length)return null
const c=null!==(o=n.moduleArtwork)&&void 0!==o?o:null===(s=n.moduleVideo)||void 0===s?void 0:s.preview
let l=e.loc.string(uA)
l===uA&&(l=n.subtitle)
const u=function(e,t,n,r,o,i){return Bv.context("shareSheetDataForAppEvent",()=>{const e=new ZK(t,n,i)
return new KK(e,r,void 0)})}(0,n.title,l,a,0,c)
if(!i(u))return null
const d=function(e,t,n){var r
const o=[]
if((null==n?void 0:n.length)>0){const t=Go(e,n)
i&&o.push(t)}if(t.startDate.getTime()<=Date.now())return o
if(e.host.clientIdentifier===zz)return o
const s=new gY(vq)
s.title=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_TITLE"),s.message=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_DETAIL"),s.isCancelable=!0,s.buttonTitles=[e.loc.string(Qy)],s.buttonActions=[new PY("prefs:root=Privacy&path=CALENDARS",!0)]
let a=!1
if(i(t.endDate)){const e=Re(t.startDate),n=Re(t.endDate),r=t.endDate.getTime()-t.startDate.getTime(),o=216e5
n.getTime()>e.getTime()&&r>o&&(a=!0)
const i=8634e4
e.getTime()===n.getTime()&&r>=i&&(a=!0)}const c=new QK(t.startDate,t.endDate,a,t.title,null===(r=t.lockup)||void 0===r?void 0:r.title,t.detail,n,s,oO)
c.title=e.loc.string("SHARE_SHEET_ADD_TO_CALENDAR"),c.artwork=Ot(e,"systemimage://calendar.circle")
const l=new YK("com.apple.AppStore.createCalendarEventActivity",c)
return o.unshift(l),o}(e,n,a),f=new LK(u,d)
return Qs(e,f,{...r,targetType:Bq,actionType:qN,idType:lq}),f}(e,t,o,b),C=m?kq:QH,I=ui(e,t,n,w.title,C,uj,!1,T,c,l,!1,!1)
if(r(I))return null
w.lockup=I
const k=new _K(w,h,p,P,v,y)
return jn(e,k,A,e=>{s(l)&&oW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),k}(e,t,n,o,a,l,u),f=new fY("appEventDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case hm.ContingentOffer:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const h=ci(e,t,YU),p=S(o)
let w=kq,g=!0
i(h)&&(g=be(h.backgroundColor),w=g?kq:QH)
const v=Wn(0,hm.ContingentOffer,t.id,n.id,l,null!==(d=a.recoMetricsData)&&void 0!==d?d:null),m={...a,pageInformation:v,locationTracker:{rootPosition:0,locationStack:[]}},y=g?kq:QH,A=ui(e,t,n,null!==(f=p.title)&&void 0!==f?f:void 0,y,uj,!1,m,c,l,!1,!1)
if(r(A))return null
p.offerLockup=A,p.trunkAppIcon=o.trunkAppIcon
const T=new FK(p,null!=h?h:void 0,w)
return T.backButtonActionMetrics.addMetricsData(Ko(e,VB,v,m.locationTracker)),T.learnMoreActionMetrics.addMetricsData(Ko(e,HB,v,m.locationTracker,o.learnMoreTitle)),T.closeButtonActionMetrics.addMetricsData(Ko(e,dL,v,m.locationTracker)),jn(e,T,v,e=>{s(l)&&oW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),T}(e,t,n,o,a,l,u),f=new fY("contingentOfferDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case hm.OfferItem:return function(e,t,n,o,i,a,c,l){const u=function(e,t,n,o,i,a,c,l){var u,d
let f=ci(e,t,YU)
f=null
const h=kq,p=S(o),w=Wn(0,hm.OfferItem,t.id,n.id,c,null!==(u=i.recoMetricsData)&&void 0!==u?u:null),g={...i,pageInformation:w,locationTracker:{rootPosition:0,locationStack:[]}},v=kq,m=ui(e,t,n,null!==(d=p.title)&&void 0!==d?d:void 0,v,uj,!1,g,a,c,!1,!1)
if(r(m))return null
p.offerLockup=m
const y=e.loc.string("Winback.AdditionalInfoButton.Title"),A=pe(e,t,zB),T=j(t,fL)
let b;(0,Uv.isSome)(T)&&(0,Uv.isSome)(A)&&(b=function(e,t,n,r){if((0,Uv.isNothing)(n))return
const o=j(n,Zq),i=(0,Uv.isSome)(o)?t$+o+n$:void 0,s=j(n,bG),a=(0,Uv.isSome)(s)?s+r$:void 0,c=t$+e.loc.string("Promotion.Terms.Title")+n$
let l
const u=e.loc.string(wA)
if((0,Uv.isSome)(o)&&(0,Uv.isSome)(r)){const n={"@@redemptionDate@@":e.loc.formatDate(u,r),"@@skuName@@":o}
l=pi(j(t,NF),n)}const d=[i,a,c,l].filter(Uv.isSome).join(r$)
return new AX(d,sV)}(e,t,A,new Date(T)))
const P=new NK(p,void 0,void 0,h,!1,y,b)
return P.backButtonActionMetrics.addMetricsData(Qo(e,VB,w,g.locationTracker)),P.learnMoreActionMetrics.addMetricsData(Qo(e,HB,w,g.locationTracker,y)),P.closeButtonActionMetrics.addMetricsData(Qo(e,dL,w,g.locationTracker)),jn(e,P,w,e=>{s(c)&&oW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),P}(e,t,n,o,i,c,l),d=new fY("offerItemDetail")
return d.title=o.title,d.pageData=u,d.animationBehavior=a,i&&i.pageInformation&&(d.referrerUrl=i.pageInformation.pageUrl),d}(e,t,n,o,f,c,l,u)
default:return null}}function oi(e){return e.bag.enableAppEvents&&!0}function ii(e){return e.bag.enableContingentOffers&&!0}function si(e){return e.bag.enableOfferItems&&!0}function ai(e,t,n){const r=B(t,n)
return(0,Nv.isNothing)(r)?null:qd(e,r,{useCase:n6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function ci(e,t,n){const r=nt(e,t)
if((0,Nv.isNothing)(r))return null
const o=se(t,r,n)
return(0,Nv.isNothing)(o)?null:qd(e,o,{useCase:n6.Default,withJoeColorPlaceholder:!0,cropCode:"sr"})}function li(e,t,n,o,i){const s=ai(e,t,`${n}.previewFrame`)
if(r(s))return null
const a=j(t,`${n}.video`)
if(r(a))return null
const c=new nz(a,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:o,playbackControls:i?{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}:{},autoPlayPlaybackControls:i?{muteUnmute:!0}:{}})
return c.canPlayFullScreen=o,c.allowsAutoPlay=!0,c.looping=!0,c}function ui(e,t,n,i,s,a,c,l,u,d,f,h){var p,w,g,v
if((0,Nv.isNothing)(t)||(0,Nv.isNothing)(n))return null
const m=Xo(t),y={...l,id:t.id,relatedSubjectIds:[n.id],idType:lq},A={...l,id:n.id,relatedSubjectIds:[n.id],targetType:Bq,idType:lq,kind:null,softwareType:null,title:null!==(p=j(n,Zq))&&void 0!==p?p:"",excludeAttribution:o(d)}
if(m===hm.AppEvent&&(y[Qx]=t.id,A[Qx]=t.id),(v=l)&&Object.prototype.hasOwnProperty.call(v,"id")&&(y.id=l.id,y.idType=l.idType),h){const n=m===hm.ContingentOffer?null===(w=Yo(e,t))||void 0===w?void 0:w.rawTitle:j(t,Zq)
gh(e,y,null!=n?n:"")}const T=j(t,cL),b={metricsOptions:A,artworkUseCase:n6.LockupIconSmall,externalDeepLinkUrl:null!=T?T:void 0,crossLinkSubtitle:c?i:void 0,offerEnvironment:s,offerStyle:a,skipDefaultClickAction:!u,includeBetaApps:!0,referrerData:null!=d?d:void 0,shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ)&&f,parentAppData:n,useJoeColorIconPlaceholder:!0,overrideArtworkTextColorKey:ZN},S=Ad(e,m===hm.AppEvent?n:t,b)
return h&&mh(l.locationTracker),r(S)?null:(c&&(S.crossLinkTitle=null!==(g=e.loc.uppercased(S.title))&&void 0!==g?g:void 0),S)}function di(e,t,n,r,o){if(n.startDate.getTime()<=Date.now())return null
if((0,Nv.isNothing)(n.lockup))return null
const i=e.loc.string("APP_EVENTS_NOTIFICATION_TITLE").replace("{appTitle}",n.lockup.title),s=e.loc.string("APP_EVENTS_NOTIFICATION_DETAIL").replace("{eventTitle}",n.title),a=n.startDate,c=n.lockup.icon,l=n.lockup.icon.template.replace("{w}",`${c.width}`).replace("{h}",`${c.height}`).replace("{c}","wd").replace("{f}",lL)
let u,d
if(o&&(u=new gY(QN),u.title=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_TITLE"),u.message=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_DETAIL"),u.artwork=Ot(e,hA)),e.bag.newEventsForODJAreEnabled){const o=new fW,i=Nt(r.pageInformation)
i[GB]="notifyActivateNotificationsDisabled",i[jB]=ph(e,{...r,id:t.id},""),i[Xx]=""
const s=_t(e,n.lockup.adamId,Bq,i)
o.actionMetrics.addMetricsData(s),d=o}else{const t=new gY(vq)
t.title=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_TITLE"),t.message=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_DETAIL"),t.isCancelable=!0,t.buttonTitles=[e.loc.string(Qy)],t.buttonActions=[new PY("prefs:root=NOTIFICATIONS_ID&path=com.apple.AppStore",!0)],d=t}const f=new gY(vq)
f.title=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_TITLE"),f.message=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_DETAIL"),f.isCancelable=!0
const h=(new qW).set(Ij,mW).param(DW.appId,n.lockup.adamId).param(DW.bundleId,n.lockup.bundleId).param(DW.appEventId,n.appEventId)
h.host=kW
const p=j(t,cL);(0,Nv.isSome)(p)&&(null==p?void 0:p.length)>0&&h.param(DW.appEventDeepLink,encodeURIComponent(p))
const w=Nt(r.pageInformation)
w[GB]="notifyActivate",w[jB]=ph(e,{...r,id:t.id},"")
const g=_t(e,n.lockup.adamId,Bq,w),v=S(w)
v[GB]="notifyDeactivate"
const m=_t(e,n.lockup.adamId,Bq,v)
return new SX(t.id,i,s,l,a,u,d,f,h.build(),g,m)}function fi(e,t,n,r,o,i){const s=ri(e,t,n,r,o,TH,i,null)
if((0,Nv.isNothing)(s))return
const a={id:t.id,actionDetails:{action:"Open",contentType:ei(t)},relatedSubjectIds:[n.id],...o}
return Xo(t)===hm.AppEvent&&(a[Qx]=t.id),Qs(e,s,a),s}function hi(e,t,n=null,o,s,a,c,l,u,d){var f
const h=[]
let p
for(const w of t){const t=ni(e,w,n,o,!0,QH,TH,s,a,c,l,null,u,d)
if(r(t))continue
if(t instanceof Date){((0,Nv.isNothing)(p)||t.getTime()<p.getTime())&&(p=t)
continue}const g=t,v={...a,id:w.id,kind:ti(w),targetType:ei(w),title:null!==(f=g.title)&&void 0!==f?f:"",softwareType:null},m=null!=n?n:pe(e,w,Mq)
i(m)&&(v.relatedSubjectIds=[m.id]),Oh(e,g,v),bh(v.locationTracker),h.push(g)}return{appPromotions:h,nextAppEventPromotionStartDate:p}}function pi(e,t){let n=null!=e?e:""
return Object.keys(t).forEach(e=>{n=n.replace(e,t[e])}),n}function wi(e,t,n,r,a,c,l,u,d,f,h,p,w,g){var v,m,y
if(t.type!==Vq)return null
const A=j(t,"promotionStartDate")
if((0,Nv.isNothing)(A)||0===A.length)return null
const T=new Date(A)
if((0,Nv.isNothing)(T))return null
const b=new Date
if(T.getTime()>b.getTime()&&!g)return T
const S=ai(e,t,zx),P=li(e,t,"lockupVideo",!1,!1)
if((0,Nv.isNothing)(S)&&o(P))return null
const C=null!==(v=null==P?void 0:P.preview)&&void 0!==v?v:S,I=be(null==C?void 0:C.backgroundColor)?kq:QH,k=be(null==C?void 0:C.backgroundColor,10),O=j(t,Zq)
let E=j(t,fH)
s(p)&&(E=p)
const R=j(t,Yx)
if((0,Nv.isNothing)(O)||0===O.length||(0,Nv.isNothing)(E)||0===E.length||(0,Nv.isNothing)(R)||0===R.length)return null
const D=new Date(R)
if((0,Nv.isNothing)(D))return null
const _=null!==(m=j(t,bG))&&void 0!==m?m:"",L=null!=n?n:pe(e,t,Mq)
let M=null
if((0,Nv.isSome)(L)&&(M=ui(e,t,L,O,c,l,u,d,h,null,w,!0)),(0,Nv.isNothing)(M))return e.console.warn(`Parent app for event ${t.id} is missing, returning null.`),null
const x=j(t,"requirement"),$=j(t,vH),F=j(t,Jx)
let N
if((0,Nv.isSome)(F)&&F.length>0&&(N=new Date(F)),void 0!==N&&N.getTime()<=b.getTime()&&!f)return null
const B=gi(null!==(y=j(t,Kx))&&void 0!==y?y:void 0,D,N),U=vi(e,B,D,N),G=new PX(t.id,null!=S?S:void 0,null!=P?P:void 0,O,null!=$?$:void 0,_,D,N,B,E,null!=x?x:void 0,M,r,U,I,k)
if(i(L)){const n={...d,id:L.id,inAppEventId:t.id,relatedSubjectIds:[L.id]}
G.notificationConfig=di(e,t,G,n,!0)}return a&&i(L)&&(G.clickAction=fi(e,t,L,G,d,h)),G}function gi(e,t,n){let r=null!=e?e:Sm.live
return r===Sm.live&&i(n)&&n.getTime()-t.getTime()>216e5&&(r=Sm.happening),r}function vi(e,t,n,r){const o=[],i=Re(n)
if((0,Nv.isNothing)(i))return[]
const s=e.loc.string("AppEvents.FormattedDate.SevenDaysOrMore.DateFormat"),a=e.loc.uppercased(e.loc.formatDate(s,n)),c=new CX(!1,void 0,null!=a?a:void 0,void 0,void 0)
o.push(c)
const l=new Date(i)
l.setDate(l.getDate()-6)
const u=e.loc.string("AppEvents.FormattedDate.SixDaysOrLess.DateFormat"),d=e.loc.formatDate(u,n),f=e.loc.uppercased(d),h=new CX(!1,l,null!=f?f:void 0,void 0,void 0)
o.push(h)
const p=new Date(i)
p.setDate(p.getDate()-1)
const w=e.loc.string("AppEvents.FormattedDate.Tomorrow"),g=e.loc.formatDateInSentence(w,dA,n),v=e.loc.uppercased(g),m=new CX(!1,p,null!=v?v:void 0,void 0,void 0)
if(o.push(m),n.getHours()>1||1===n.getHours()&&n.getMinutes()>0){let t
t=n.getHours()>=19?e.loc.string("AppEvents.FormattedDate.Tonight"):e.loc.string("AppEvents.FormattedDate.Today")
const r=e.loc.formatDateInSentence(t,dA,n),s=e.loc.uppercased(r),a=new CX(!1,null!=i?i:void 0,null!=s?s:void 0,void 0,void 0)
o.push(a)}const y=new Date(n)
let A
switch(y.setHours(y.getHours()-1),t){case Sm.available:A="AppEvents.FormattedDate.AvailableIn.MinutesCountdown"
break
case Sm.happening:case Sm.live:default:A="AppEvents.FormattedDate.StartsIn.MinutesCountdown"}const T=new CX(!1,y,void 0,n,A)
let b,S
switch(o.push(T),t){case Sm.available:b=e.loc.string("AppEvents.FormattedDate.NowAvailable"),S=!1
break
case Sm.happening:b=e.loc.string("AppEvents.FormattedDate.HappeningNow"),S=!1
break
case Sm.live:default:b=e.loc.string("AppEvents.FormattedDate.Live"),S=!0}const P=new CX(S,n,b,void 0,void 0)
if(o.push(P),null!==r){const t=new CX(!1,r,e.loc.string("AppEvents.FormattedDate.EventEnded"),void 0,void 0)
o.push(t)}return o}function mi(e){e.includingScopedRelationships(iV,[mO,e$,WB]),e.includingViews([uL,GO]),e.includingScopedAttributes(iV,[Zq,vH,NF]),e.includingMetaKeys(UA,[GA]),e.includingMetaKeys(jA,[yO]),e.includingAssociateKeys(iV,[VA])}function yi(e){e.includingScopedRelationships(iV,[mO,e$,WB]),e.includingScopedAttributes(iV,[Zq,vH,NF]),e.includingMetaKeys(UA,[GA]),e.includingMetaKeys(jA,[yO]),e.includingAssociateKeys(iV,[VA])}function Ai(e){e.enablingFeature(lV),e.includingScopedAttributes(lV,[Tq]),e.addingQuery("associate[tags]",Kq),e.includingScopedRelationships(d$,[Jq,jO])}function Ti(e){e.includingScopedRelationships(EV,[zB]),e.includingScopedAttributes(EV,[Pq,vH,NF,fL]),e.includingMetaKeys(HA,[qA]),e.includingKindsKeys(EV,[o$])}function bi(e){const{id:t,platform:n,...r}=e
return{...r,id:dt(t),platform:ut(n),$kind:IX}}function Si(e){return 0===e.length}function Pi(e){return!Si(e)}function Ci(e){if(null===kX){kX=new Set
for(const t of e.bag.suppressedAccessibilityAppIds)kX.add(t)}}function Ii(e){return e.featureFlags.isEnabled(eJ)&&e.bag.enableAppAccessibilityLabels}function ki(e,t){return Ci(e),(0,Nv.isSome)(kX)&&Pi(t)&&kX.has(t)}function Oi(e,t){return Ci(e),!!t.startsWith(eA)||(0,Nv.isSome)(kX)&&Pi(t)&&kX.has(t)}function Ei(e){const t=[Tq,wq,JV,uH]
return t.push(zV),e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}function Ri(e,t){return t.includingAdditionalPlatforms(ee(e)).includingRelationships(function(e){let t=[]
switch(e.client.deviceType){case Yq:t=t.concat(RX),e.appleSilicon.isSupportEnabled&&t.push(nN)
break
case zq:t.push(_X)
break
case Fq:t=t.concat(EX)
break
case AV:t=t.concat(DX)
break
default:t=t.concat(OX)}return t}(e)).includingAttributes(Ei(e)).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e)),t}function Di(e){return{storefront:e.locale.activeStorefront,language:e.locale.activeLanguage}}function _i(e,t){return e.locale.normalize(t)}function Li(e){if(null===LX){LX=new Set
for(const t of e.bag.suppressedPrivacyAppIds)LX.add(t)}}function Mi(e,t){return Li(e),!(0,Uv.isNothing)(LX)&&!o(t)&&LX.has(t)}function xi(e,t){return Li(e),!(0,Uv.isNothing)(LX)&&!o(t)&&(!(!LX.has("com.apple.InstallAssistant.*")||!t.startsWith(eA))||LX.has(t))}function $i(e,t){const n=t.host
if(r(n))return!1
const o=[e.bag.mediaHost,e.bag.mediaEdgeHost(e),e.bag.mediaEdgeSearchHost]
for(const e of o)if(!r(e)&&-1!==n.indexOf(e))return!0
return!1}function Fi(e,t,n){if(!(0,Uv.isNothing)(t))return ve(e,new Jz(e,t).addingQueryValues(n)).toString()}function Ni(e){let t=e.query.id
const n=e.pathname
if(r(t)&&(null==n?void 0:n.length)>0){const e=xX.exec(n)
e&&e.length>1&&(t=e[1])}if(!a(t)){const n=e.pathComponents()
s(n)&&(t=n[n.length-1])}return t}function Bi(e,t,n=!1){var r,o
let s=Ni(t)
if(!a(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
s in $X&&(s=$X[s])
let c=Kq,l=MX,u=[]
u=[vG,bq,xq,CL,h$,f$]
const d=null===(r=t.pathname)||void 0===r?void 0:r.split("/"),f=(0,Uv.isSome)(d)&&d.includes(yW.productBundle)
f&&(c=xq,l=[$j,hj,uH,VO,qU],u=[Kq,bq,h$]),u.push(SF),e.bag.enablePrivacyNutritionLabels&&!Mi(e,s)&&l.push(p$),Ii(e)&&!ki(e,s)&&l.push(w$),e.appleSilicon.isSupportEnabled&&l.push(hH),e.bag.enableUpdatedAgeRatings&&l.push(iq),Kd(e)&&l.push(sH),e.bag.enableLicenses&&l.push(HO)
const h=v(t.query[DW.isArcade]);(null===h||h)&&(l.push(WN,zN,wq),u.push(PH)),e.bag.enableSellerInfo&&l.push(rB),e.bag.enableSellerICPAnnotation&&l.push(qO),e.bag.gameCenterExtendSupportedFeatures&&l.push(g$),va(e)&&u.push(WO)
const p=new Jz(e).withIdOfType(s,c).includingAdditionalPlatforms(ee(e)).includingAgeRestrictions().includingRelationships(u).includingAttributes(l).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e)).includingViews([zO,CL])
p.addingRelationshipLimit(bq,te(e)),(null===(o=t.query[DW.productVariantID])||void 0===o?void 0:o.length)>0&&p.addingQuery(DW.productVariantID,t.query[DW.productVariantID])
const w=t.query[xW]
return i(w)&&p.addingQuery(xW,w),oi(e)&&!f&&(ii(e)||p.includingScopedRelationships(Kq,[Vq]),p.includingScopedAttributes(Vq,DK),p.includingScopedAvailableIn(Vq,[JO])),ii(e)&&mi(p),si(e)&&Ti(p),Kt(e,NH)&&p.enablingFeature(kL),n&&p.enablingFeature(IL),ii(e)||p.includingRelationships([OL]),p.attributingTo(t.build())}function Ui(e,t,n,r,o,i){const s=MX
e.bag.enablePrivacyNutritionLabels&&!Mi(e,t)&&s.push(p$),Ii(e)&&!ki(e,t)&&s.push(w$),e.appleSilicon.isSupportEnabled&&s.push(hH),e.bag.enableUpdatedAgeRatings&&s.push(iq),Kd(e)&&s.push(sH),e.bag.enableLicenses&&s.push(HO),e.bag.gameCenterExtendSupportedFeatures&&s.push(g$)
const a=new Jz(e).withIdOfType(t,Kq).includingAdditionalPlatforms(ee(e)).includingAttributes(s).includingRelationships([PH,vG,SF,bq,xq,h$,f$]).addingRelationshipLimit(bq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingViews([CL]).usingCustomAttributes(Ue(e))
return n&&a.addingQuery("availability",YO),(0,Uv.isSome)(r)&&a.addingQuery(DW.productVariantID,r),i&&a.enablingFeature(IL),oi(e)&&!o&&(ii(e)||a.includingScopedRelationships(Kq,[Vq]),a.includingScopedAttributes(Vq,DK),a.includingScopedAvailableIn(Vq,[JO])),ii(e)&&mi(a),si(e)&&Ti(a),ii(e)||a.includingRelationships([OL]),va(e)&&a.includingRelationships([WO]),Kt(e,NH)&&a.enablingFeature(kL),a}function Gi(e,t){if(!e.client.isPhone||!e.featureFlags.isEnabled(mJ))return!1
if((0,Nv.isNothing)(t))return!0
switch(t){case Fj:return e.bag.isAppsGroupingTagsEnabled
case oH:return e.bag.isAppsProductPageTagsEnabled
case vx:return e.bag.isAppsSlpTagsEnabled
default:return!1}}function ji(e){return b0.has(e)}function Vi(e){return v0.has(e)}function Hi(e){return A0.has(e)}function qi(e){return y0.has(e)}function Wi(e,t,n){const r=q(t,xj)
let o=null
const i=j(t,"gamesFilter")
switch(i){case qq:case aM:case"all":o=i
break
default:r!==s0&&r!==l0||(o=qq)}let a=null,c=j(t,Yi(0,r)),l=null,d=null,h=j(t,gj)
const p={}
let w=!1
const g=we(t,sU)[0]
if(r===i0&&s(g))if(a=e.loc.uppercased(j(t,Yi(0,r))),h=null,g.type===PV){c=Uf(e,g,Zq)
const t=Sn(e,g,!1)
if((0,Nv.isSome)(t)){l=qd(e,t,{useCase:n6.LockupIconSmall,style:YF})
const n={type:yN,name:BF}
p.eyebrowColor=n}d={forYou:!0}}else w=!0,c=j(g,Yi(0,r)),l=Jd(e,g,{useCase:n6.LockupIconSmall})
const v={featuredContentId:r,id:f(t,"id"),presentationHints:{},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,featuredContentData:t,title:c,subtitle:h,eyebrow:a,titleArtwork:l,shelfHeaderConfiguration:p,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
return{shelfToken:v,metricsOptions:{id:v.id,kind:null,softwareType:u(null==n?void 0:n.isArcadePage)?nq:null,targetType:KH,title:w?v.eyebrow:v.title,badges:d,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:Xj,fcKind:r,recoMetricsData:es(e,t)}}}function zi(e){return e&&e.isDeferring&&e.isFirstRender}function Yi(e,t){switch(t){case f0:case s0:case a0:return Pq
default:return Zq}}function Ji(e){let t=(new qW).set(Ij,hW).append(eV,yW.grouping).append(eV,yW.shelf).append(eV,encodeURIComponent(JSON.stringify(e))).param(DW.groupingFeaturedContentId,`${e.featuredContentId}`)
return(0,Nv.isSome)(e.nativeGroupingShelfId)&&(t=t.param(DW.nativeGroupingShelfId,`${e.nativeGroupingShelfId}`)),t.build()}function Ki(e,t,n){if(o(n))return null
r(n.shelfStyle)&&(n.shelfStyle=t.contentType)
const i=t.contentType!==dN&&s(t.items)
return n.hasExistingContent=n.hasExistingContent||i&&n.isFirstRender,(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?Ji(n):null}function Zi(e,t){e.remainingItems=e.remainingItems.filter(e=>!t.has(e.id))}function Qi(e,t,n){var r
const o=s(t.remainingItems),i=!o&&(null===(r=t.recommendationsHref)||void 0===r?void 0:r.length)>0
if(o){const n=function(e,t){var n
const r=(null===(n=t.relationshipToFetch)||void 0===n?void 0:n.length)>0
let o=t.remainingItems
return r&&(o=t.remainingItems.map(n=>pe(e,n,t.relationshipToFetch))),o}(e,t),r=new Jz(e,n,!0)
return Je(e,r,n),Xi(e,r),r}if(i){const n=new Jz(e,t.recommendationsHref).includingAgeRestrictions()
return Xi(e,n),oi(e)&&(n.enablingFeature(MH),n.includingMetaKeys(vB,[E$,XL]),n.includingScopedAttributes(Vq,DK),n.includingScopedRelationships(Vq,[Mq])),ii(e)&&(n.enablingFeature(eM),yi(n)),si(e)&&(n.enablingFeature(mB),Ti(n)),Gi(e,Fj)&&Ai(n),n}return null}function Xi(e,t){t.includingAdditionalPlatforms(ee(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
let n=[Tq,wq,uH]
t.includesResourceType(Vq)&&oi(e)&&(t.enablingFeature(MH),t.includingMetaKeys(vB,[E$,XL]),t.includingScopedAttributes(Vq,DK),t.includingScopedRelationships(Vq,[Mq])),t.includesResourceType(iV)&&ii(e)&&(t.enablingFeature(eM),yi(t),n=[]),t.includesResourceType(EV)&&si(e)&&(t.enablingFeature(mB),Ti(t),n=[]),(t.includesResourceType(Kq)||t.includesResourceType(Vq))&&(n=n.concat($j,hj,uV)),e.bag.enableUpdatedAgeRatings&&n.push(iq),Gi(e,Fj)&&Ai(t),t.includingAttributes(n)}function es(e,t){const n=q(t,xj)
switch(n){case e0:case qX:case WX:case zX:case u0:case FX:case KX:case ZX:case QX:case NX:case p0:case w0:return St(fe(t,WV))
case o0:case BX:{const e=fe(t,WV),n=G(t,vN)
return s(e)?St(e):s(n)?St(t):null}case HX:case XX:case g0:return null
default:if(function(e){return Vi(e)||ji(e)||S0.has(e)||e===d0}(n)){let e=fe(t,Jq)
if(r(e))return null
const n=e.data
return n&&0!==n.length||(e=fe(t,WV)),St(e)}return e.console.warn("Unknown featured content ID:",n),null}}function ts(e,t,n){const r=qd(e,t,n)
return r&&(r.crop="sr"),r}function ns(e,t,n,r,o){const i=B(t,Hq)
if(i instanceof Array){const t=function(e,t,n,r){const o=n/r
let i=0,s=null
for(const e of t){const t=h(e,tG),r=t/h(e,OG);(r===o||Math.abs(o-r)<=Math.abs(o-i))&&(!s||t<=n&&t>s.width||s.width>n&&t<s.width&&t>s.width)&&(s=e,i=r)}return s?Ot(e,f(s,Rq),h(s,tG),h(s,OG),null,null,f(s,eE)):null}(e,i,n,r)
return t.crop="bb",t}return null!=i?ts(e,i,o):null}function rs(e,t,n,r,o,i){const s=l(t.meta,ZT),a=[]
if((0,Nv.isSome)(s))for(const t of s){const n=Ad(e,t,{artworkUseCase:n6.LockupIconSmall,metricsOptions:i,useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:th}),r=null==n?void 0:n.icon;(0,Nv.isSome)(r)&&a.push(r)}return a}function os(e,t,n,a,c,l,u,d){var h,p,w
const g=(null===(h=f(t,Rq))||void 0===h?void 0:h.length)>0,v=(null===(p=j(t,yb))||void 0===p?void 0:p.length)>0,m=de(t,aH,!1),y=de(t,Jq,!1)||m
let A=j(t,fH)===Fb
if(v||g)return function(e,t,n,o,s){const a=i(f(t,Rq))?t:B(t,yq)
if(r(a)||zi(n))return c=t,s?s():null==n||n.remainingItems.push(c),null
var c
const l=f(a,c$),u=f(a,Rq),d=f(a,$H),h=us(j(t,UE))||d
let p=null
if(l===yL)p=new PY(u),p.title=h
else{const t=e.required(n3).fetchFlowPage(u),n=new fY(t)
n.pageUrl=u,n.title=h,p=n}return p.presentationStyle=[Wk],Qs(e,p,{...o,id:""}),{action:p,caption:null,title:h,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,l,d)
if(y){let h,p,g
if(a&&!m){g=As(e,"groupingCommon",we(t,Jq),!0,c,!1,1)
const n=g.personalizedData
if(0===n.length)return null
h=n[0]}else h=pe(e,t,m?aH:Jq)
if(j(h,fH)===Fb&&(p=h,h=pe(e,h,aH),A=!0),r(h))return null
if(r(h.attributes)||zi(n))return s(n)&&(n.isDeferring=!0),function(e){d?d():null==n||n.remainingItems.push(e)}(h),null
let v=Uf(e,h,gj)||wd(e,h)
const y=Js(e,t,l)
y.targetType=l.targetType
let T=Dd(e,h,y,null==n?void 0:n.clientIdentifierOverride)
const b=H(h,ZB)
let S,P=null,C=null,I=null
const k=j(h,"itunesNotes.short"),O=(null===(w=h.id)||void 0===w?void 0:w.length)>0,E={...l,id:O?h.id:t.id,idType:O?lq:uU}
switch(h.type){case TV:P=B(h,Hq),A&&(h=null!=p?p:t)
break
case Nq:{const t=pe(e,h,wH)
if(s(t)){const r={...E,inAppEventId:t.id},s=pe(e,t,Mq)
i(s)&&(r.relatedSubjectIds=[s.id])
const a=wi(e,t,null,!1,!0,kq,JH,!1,r,!1,!0,null,n.isArcadePage,!1)
if("AppEventCard"===j(h,AN)){if(a instanceof Date)return Br(a,u.refreshController),null
if((0,Nv.isNothing)(a))return null
S=a,b||(T=S.clickAction),o(v)&&(v=Uf(e,t,Uj))}}C=j(h,$H),C&&(C=C.replace(/\n/g," "))
const a=pe(e,h,Jq),c=f(h,Hj)
o(v)&&(c?v=c:a&&(v=Uf(e,a,Uj))),o(v)&&i(S)&&(v=S.subtitle)
let d=j(h,CE);((0,Nv.isNothing)(d)||0===d.length)&&(d=v)
const p={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
if(r(S)&&na(0,h),p.clientIdentifierOverride=Fr(e,h),i(S))I=S.lockup
else{const t=null,r=null
{gh(e,E,null==n?void 0:n.title)
const o=ko(e,we(h,wH),p,l.pageInformation,l.locationTracker,t,r,na(0,h))
1===o.length&&(I=o[0]),mh(E.locationTracker)}}}default:{const t=[Kq,FV,xq,FH]
if(r(I)&&t.indexOf(h.type)>-1){gh(e,E,null==n?void 0:n.title)
const t={metricsOptions:{pageInformation:l.pageInformation,locationTracker:l.locationTracker,recoMetricsData:St(h)},clientIdentifierOverride:null==n?void 0:n.clientIdentifierOverride,artworkUseCase:Hd(0,null==n?void 0:n.shelfStyle),canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ)&&n.isArcadePage}
I=Ad(e,h,t),mh(E.locationTracker)}P=Ke(e,h,Tq)||B(h,Tq),o(v)&&i(I)&&(v=I.subtitle)
break}}if(i(T)&&(T.presentationStyle=[Wk],!A)){const n=us(j(t,UE)),r=Uf(e,h,Zq)
T.title=n||r||T.title||v||C}return{action:T,caption:C,title:null==T?void 0:T.title,subtitle:v,artwork:P,shortEditorialDescription:k,content:h,lockup:I,appEvent:S,onDevicePersonalizationDataProcessingType:null==g?void 0:g.processingType}}return null}function is(e,t,n,r){const o=j(t,Zq),i=Fi(e,f(t,uG)),s=e.required(n3).fetchFlowPage(i),a=new fY(s)
return a.pageUrl=i,{action:a,caption:Nb,title:o,subtitle:Nb,artwork:null,shortEditorialDescription:o}}function ss(e,t){const n={}
for(const t of e)n[t.id]=t
const r=[Jq,Fj],o=[]
for(const e of t){let t=!0
for(const o of r){const r=we(e,o)
if(i(r)){const i=[]
for(const e of r){const t=n[e.id]
s(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function as(e,t,n){t.seeAllAction=null,t.isHorizontal=!1,t.shouldFilterApps&&(t.filteredItemsMinimumCount=0,t.filteringExcludedItems=n.includedAdAdamIds)}function cs(e,t){switch(t){case LH:return pV
case pU:return hN
case uq:return yB
case vV:return GE
default:return null}}function ls(e,t){let n=j(t,SV)
return n||(n=j(t,"contentId")),n||(n=j(t,"id")),n}function us(e){if(r(e))return null
const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"")
return t.match(/^\s*$/)?null:t}function ds(e,t,n){e.featureFlags.isEnabled(rJ)?t.titleAction=n:t.accessoryAction=n}function fs(e,t,n){e.featureFlags.isEnabled(rJ)?(0,Nv.isSome)(t.header)?ds(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}async function hs(e,t,n){const r=n===nW?"OnDeviceRecommendationsShelfController":dP
return await new Promise((n,i)=>{if(o(e.user.dsid)){const e=`${r}: User is currently not signed in.`
return Bv.unexpectedType(yH,e,null),void i(new Error(e))}if(o(t)){const e=`${r}: Missing valid useCase for ODP: ${t}`
return Bv.unexpectedType(yH,e,null),void i(new Error(e))}e.onDeviceRecommendationsManager.performRequest({type:fP,dsId:e.user.dsid,useCase:t}).then(a=>{const c=l(a[hP]),u=y(a[fj])
if(o(c)){const e=`${r}: ODP returned no candidate ids for useCase: ${t}`
return Bv.unexpectedType(yH,e,null),void i(new I0(e))}if(o(u)){const e=`${r}: ODP returned no metrics for useCase: ${t}`
return Bv.unexpectedType(yH,e,null),void i(new Error(e))}const d=[]
for(const e of c)s(e)&&d.push({id:e,type:Kq})
const f=new Jz(e,d).withFilter("apps:recommendable",XH).addingQuery(DW.onDevicePersonalizationUseCase,t)
Xi(e,f),Ln(e,f).then(e=>{n({candidates:c,recoMetrics:u,dataContainer:e})}).catch(e=>{const t=`${r}: Failed to fetch Media API data for candidates: ${c}`
Bv.unexpectedType(yH,t,null),i(new Error(t))})}).catch(e=>{const n=`${r}: Failed to perform ODP for useCase: ${t}, ${e}`
Bv.unexpectedType(yH,n,null),i(new Error(n))})})}function ps(e){const t=new Set,n=[]
return e.forEach((e,r)=>{t.has(e.appId)||(n.push(e.appId),t.add(e.appId))}),n}function ws(e,t){var n
const r=Number(null!==(n=t[cP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.onDeviceScore
t.modifiedScore=r*n+(1-r)*e}return e.sort((e,t)=>t.modifiedScore-e.modifiedScore),e}function gs(e,t){const n=e.filter(e=>i(e.pinnedPosition))
e=e.filter(e=>r(e.pinnedPosition))
const o=new Map
e.reverse(),e.forEach((e,t)=>{e.appId in o?o[e.appId].push(e):o[e.appId]=[e]})
const s=[],a=Math.max(...Object.values(o).map(e=>e.length))
for(let e=0;e<a;e++){const e=[]
t.forEach(t=>{t in o&&o[t].length>0&&(s.push(o[t].pop()),0!==o[t].length&&e.push(t))}),t=e}const c=new Array(n.length+s.length)
n.sort((e,t)=>e.pinnedPosition-t.pinnedPosition)
for(const e of n)e.pinnedPosition<c.length?c[e.pinnedPosition]=e:s.push(e)
s.reverse()
for(const[e,t]of c.entries())r(t)&&s.length&&(c[e]=s.pop())
return c}function vs(e){const t=new Map
return s(e)&&e.split(",").forEach(e=>{const n=e.split("=")
2===n.length&&t.set(n[0],Number(n[1]))}),t}function ms(e,t,n,s,a,c,l,u){var d
let p={sortedDataItems:[],processingType:0}
if(null!==(d=null==n?void 0:n.metricsData[qR])&&void 0!==d&&d){const e=function(e,t,n,r,o){const s=[]
for(const e of t){const t=new O0(e),a=h(e,JM)
let c=f(e,dU)
if(((0,Nv.isNothing)(c)||0===c.length)&&(null==o?void 0:o.length)>0&&(c=o),(0,Nv.isNothing)(c)||0===c.length)r&&(t.isUnpersonalizedMatch=!0,s.push(t))
else{if(i(n)){const e=n[c]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=c,t.score=null!=a?a:0,s.push(t)}}return s}(0,t,null==n?void 0:n.personalizationData,s,l),r=ws(e,null==n?void 0:n.metricsData),o=e.every((e,t)=>e===r[t])
p={sortedDataItems:r,processingType:o?R0.contentsNotChanged:R0.contentsSorted},i(c)&&p.sortedDataItems.length>=c&&(p.sortedDataItems=p.sortedDataItems.slice(0,c))}else{const d=function(e,t,n,r,s){const a=[]
for(const c of t){const t=new O0(c),l=f(c,uP)
let u=f(c,dU),d=f(c,WR)
if(((0,Nv.isNothing)(u)||0===u.length)&&(null==s?void 0:s.length)>0&&(u=s,d=e.random.nextUUID()),o(l)||o(u)||o(d)){r&&(t.isUnpersonalizedMatch=!0,a.push(t))
continue}const h=l.split(",")
if(h.includes(E0)&&(t.isWildcardMatch=!0),i(n)){const e=n[u]
if(i(e))for(const n of h)if(e.userSegments.includes(n)){t.isExactMatch=!0
break}}t.appId=u,t.groupId=d,a.push(t)}return a}(e,t,null==n?void 0:n.personalizationData,s,l),h=ps(d),w=function(e,t){var n
const r=new Set,i=[],s=t.filter(e=>e.isExactMatch).map(e=>e.groupId),a=new Set(s)
t.forEach((e,t)=>{if(o(e.groupId))i.push(e)
else if(!r.has(e.groupId))if(e.isUnpersonalizedMatch)i.push(e)
else{if(e.isExactMatch)return r.add(e.groupId),void i.push(e)
if(!a.has(e.groupId)){if(e.isWildcardMatch)return r.add(e.groupId),void i.push(e)
e.isFallbackMatch=!0,i.push(e)}}})
const c=[],l=i.slice().reverse()
for(const e of l)e.isFallbackMatch&&r.has(e.groupId)||(c.push(e),(null===(n=e.groupId)||void 0===n?void 0:n.length)>0&&r.add(e.groupId))
return c.reverse(),c}(0,d)
p=function(e,t,n,o,i,s){let a
const c=t.filter(e=>e.isExactMatch||e.isWildcardMatch||e.isUnpersonalizedMatch||r(e.groupId))
return r(i)?a=ys(c,o,s):c.length>=i||!n?(a=ys(c,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)):(a=ys(t,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)),a}(0,w,a,h,c,u)}const w=p.sortedDataItems.map(e=>e.rawData)
return{personalizedData:w,processingType:(t.length!==w.length?R0.contentsFiltered:R0.contentsNotChanged)+p.processingType}}function ys(e,t,n){const r=e.filter(e=>e.isExactMatch)
let o=e.filter(e=>!e.isExactMatch)
i(n)&&n&&(o=gs(o,t))
const s=r.concat(o),a=e.every((e,t)=>e===s[t])
return{sortedDataItems:s,processingType:a?R0.contentsNotChanged:R0.contentsSorted}}function As(e,t,n,r,a,c=!1,l,u,d){return Ts(e)?t===gb?function(e,t,n,r,o){var a,c
let l=t,u=!1
const d=[]
e.featureFlags.isEnabled(wJ)||(l=t.filter((e,t)=>!s(e.type)||e.type===Vq||(d.push(t),!1)),u=l.length!==t.length)
const p=null==r?void 0:r.metricsData,w=null!==(a=p.use_segment_scores)&&void 0!==a&&a,g=null!==(c=p[qR])&&void 0!==c&&c
let m
if(m=w||g?function(e,t,n,r){var o
let s=[],a=[]
null!==(o=null==n?void 0:n.metricsData[qR])&&void 0!==o&&o?(s=function(e,t,n){const r=[]
for(const[e,o]of t.entries()){const t=new k0(o),s=v(o,lP),a=f(o,dU),c=h(o,JM)
if(i(n)){const e=n[a]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=a,t.score=null!=c?c:0,s&&(t.pinnedPosition=e),r.push(t)}return r}(0,t,null==n?void 0:n.personalizationData),a=ws(s,null==n?void 0:n.metricsData)):(s=function(e,t){const n=[]
for(const[e,r]of t.entries()){const t=new k0(r),o=f(r,dU),i=f(r,WR),s=h(r,JM),a=f(r,"meta.personalizationData.segScores"),c=v(r,lP),l=vs(a)
t.appId=o,t.groupId=i,t.score=null!=s?s:0,t.segScores=l,c&&(t.pinnedPosition=e),n.push(t)}return n}(0,t),a=function(e,t){const n=function(e,t){var n
for(const r of e){const e=r.appId,o=r.segScores,s=r.score
if(i(t)){const a=t[e]
if(i(a)){let e=0,t=0
for(const n of a.userSegments)o.has(n)&&(t+=o.get(n),e+=1)
if(e){const n=t/e
r.modifiedScore=s*n}}else{const e=null!==(n=o.get("0"))&&void 0!==n?n:0
r.modifiedScore=s*e}}else r.modifiedScore=s}return e}(e,null==t?void 0:t.personalizationData),r=function(e,t){var n
const r=Number(null!==(n=t[cP])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.modifiedScore
t.modifiedScore=r*n+(1-r)*e}return e}(n,null==t?void 0:t.metricsData)
return r.sort((e,t)=>t.modifiedScore-e.modifiedScore),r}(s,n),i(r)&&r&&(a=gs(a,ps(a))))
const c=a.map(e=>e.rawData),l=a.every((e,t)=>e===s[t])?R0.contentsNotChanged:R0.contentsSorted
return{personalizedData:c,processingType:(t.length!==c.length?R0.contentsFiltered:R0.contentsNotChanged)+l}}(0,l,r,o):ms(e,l,r,n,null,null,null,o),u){const e=m.personalizedData
d.forEach(n=>{const r=t[n]
n<e.length?e.splice(n,0,r):e.push(r)}),m={personalizedData:e,processingType:m.processingType}}return m}(e,n,r,a,d):ms(e,n,a,r,c,l,u,d):function(e,t,n){let r=[]
const s=new Set
for(const e of t){const t=f(e,uP),n=f(e,dU),i=f(e,WR)
o(t)||o(n)||o(i)?r.push(e):s.has(i)||t.split(",").includes(E0)&&(r.push(e),s.add(i))}return i(n)&&r.length>n&&(r=r.slice(0,n)),{personalizedData:r,processingType:null}}(0,n,l)}function Ts(e){return e.user.isOnDevicePersonalizationEnabled&&e.bag.enableOnDevicePersonalization}function bs(e,t){return Ts(e)?e.host.platform===Kj?e.user.onDevicePersonalizationDataContainerForAppIds(Array.from(t)):{personalizationData:{},metricsData:null}:null}function Ss(e){return Ts(e)&&e.host.platform===Kj?e.user.onDevicePersonalizationDataContainerForAppIds([]).metricsData:null}function Ps(e,t,n,r){return kd(e,t,{offerEnvironment:"ad",offerStyle:uj,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdvert:!0,adSlotOverride:r.parsedCardCount,disableFastImpressionsForAds:!0},clientIdentifierOverride:n.clientIdentifierOverride,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:n6.LockupIconSmall,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton},{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{}},null,!1)}function Cs(e){for(const t of e)switch(t.type){case Pm.EditorialItem:case Pm.EditorialItemGroup:return W(t.data)}return!1}function Is(e,t){if(!Ts(e))return null
const n=new Set
for(const e of t){if(r(e.contents))continue
const t=e=>f(e,dU)
for(const r of e.contents)if(r.type===vj){const e=l(r.meta,m_)
for(const r of e){const e=t(r)
s(e)&&n.add(e.toString())}}else{const e=t(r)
s(e)&&n.add(e.toString())}}return bs(e,n)}function ks(e,t,n,r,o,i){var s
const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
return a.useOTDTextStyle=null!==(s=v(t,"meta.personalizationData.isOfTheDay"))&&void 0!==s&&s,a.replaceIfAdPresent=v(t,fI),a.isAdEligible=n,a.currentRowIndex=r,a.metricsDisplayStyle=o,a.isHeroCard=i,a}function Os(e,t){if(e.client.isPhone)return t.currentRowIndex}function Es(e,t,n){switch(t){case Qv.Grid:n%2==1&&e.currentRowIndex++
break
case Qv.Hero:0!==n&&(n-1)%2!=1||e.currentRowIndex++
break
case Qv.Standard:e.currentRowIndex++}}function Rs(e,t,n,r){if(e.client.isPad)t.currentRowMetricsDisplayStyle=gm.MediumCard
else switch(n){case Qv.Grid:t.currentRowMetricsDisplayStyle=gm.SmallCard
break
case Qv.Hero:t.currentRowMetricsDisplayStyle=0===r?gm.MediumCard:gm.SmallCard
break
case Qv.Standard:t.currentRowMetricsDisplayStyle=gm.MediumCard}}function Ds(e,t){var n
if(t.type===Nq)return Qv.Standard
let r
const o=N(t)
return W(o)&&(r=j(o,"editorialItemGroupDisplayStyle")),(0,Nv.isNothing)(r)&&(r=null!==(n=j(t,dH))&&void 0!==n?n:Qv.Standard),function(e,t){return!(0,Nv.isNothing)(t)&&(t!==Qv.Grid||e.client.isPhone)}(e,r)?r:Qv.Standard}function _s(e){return e.adLocation===e.parsedCardCount||!(0,Nv.isNothing)(e.eligibleAdLocations)&&e.eligibleAdLocations.includes(e.parsedCardCount)}function Ls(e,t,n){var r
const o=xs(e,t,n,()=>{var r,o,i
const s=[]
null===(r=n.pageInformation.adPageInfo)||void 0===r||r.updateContainerId(e,null===(o=n.pageInformation.adPageInfo)||void 0===o?void 0:o.containerIdForSlotIndex(null!==(i=n.parsedCardCount)&&void 0!==i?i:0))
const a=Ds(e,t.data)
Rs(e,n,a,0)
const c=ks(0,t.data,_s(n),Os(e,n),n.currentRowMetricsDisplayStyle,!1)
c.baseMetricsOptions={recoMetricsData:Ws(t)}
const l=$s(e,n,c,t.data)
return(0,Nv.isNothing)(l)||(s.push(l),bh(n.locationTracker),n.parsedCardCount++,Es(n,a,0)),s})
if(o.contentsMetadata={type:y_,debugSectionTypeIndicatorColor:t.type===Pm.EditorialItemGroup?Se(vE):Se(pL),groupDisplayStyle:Qv.Standard},!t.isFirstItemInModule){const e=qs(0,t);(0,Nv.isSome)(e)&&(o.background=e.shelfBackground,(0,Nv.isSome)(null===(r=o.header)||void 0===r?void 0:r.configuration)&&(o.header.configuration.eyebrowColor=e.eyebrowColor,o.header.configuration.titleColor=e.titleColor,o.header.configuration.subtitleColor=e.subtitleColor))}return o}function Ms(e,t,n){var r
let o=!0
const i=xs(e,t,n,()=>{var r,i,s,a,c,u,d
const f=[],h=vn(e)&&null!==(r=(0,jv.asNumber)(t.data,"meta.personalizationData.displayEICount"))&&void 0!==r?r:100
let p=l(t.data.meta,m_);(0,Nv.isSome)(n.recoImpressionData)&&(p=wn(p,n.recoImpressionData,null!==(i=n.pageInformation.recoMetricsData)&&void 0!==i?i:{}))
const w=Ds(e,t.data)
let g=0
for(const[r,i]of p.entries()){null===(s=n.pageInformation.adPageInfo)||void 0===s||s.updateContainerId(e,null===(a=n.pageInformation.adPageInfo)||void 0===a?void 0:a.containerIdForSlotIndex(null!==(c=n.parsedCardCount)&&void 0!==c?c:0)),Rs(e,n,w,g)
const l=ks(0,i,_s(n),Os(e,n),n.currentRowMetricsDisplayStyle,w===Qv.Hero&&0===r),d=$s(e,n,l,i)
if((0,Nv.isSome)(d)&&(f.push(d),bh(n.locationTracker),n.parsedCardCount++,Es(n,w,g),g++),l.isHeroCard&&(0,Nv.isNothing)(d)&&([RG,WU].includes(e.client.buildType)&&Bv.unexpectedType(yH,`Hero story group ${null===(u=t.data)||void 0===u?void 0:u.id} must contain a valid hero card at index ${r}. Unable to parse card ${i.id}.`,null),o=!1),r<p.length-1&&n.adPlacementBehavior===Xv.insertIntoShelf){const t=Ns(e,n,ks(0,n.adData,_s(n),Os(e,n),void 0,!1));(0,Nv.isSome)(t)&&(n.parsedCardCount++,Es(n,Qv.Standard,0),bh(n.locationTracker),f.push(t))}if(f.length===h)break}if(o){const n=3
f.length!==n&&([RG,WU].includes(e.client.buildType)&&Bv.unexpectedType(yH,`Hero story group ${null===(d=t.data)||void 0===d?void 0:d.id} must contain exactly ${n} items but only found ${f.length} items.`,null),o=!1)}return f})
let s=Ds(e,t.data)
if(s!==Qv.Hero||o||(s=Qv.Standard),i.contentsMetadata={type:y_,debugSectionTypeIndicatorColor:Se(vE),groupDisplayStyle:s},!t.isFirstItemInModule){const e=qs(0,t);(0,Nv.isSome)(e)?(i.background=e.shelfBackground,(0,Nv.isSome)(null===(r=i.header)||void 0===r?void 0:r.configuration)&&(i.header.configuration.eyebrowColor=e.eyebrowColor,i.header.configuration.titleColor=e.titleColor,i.header.configuration.subtitleColor=e.subtitleColor)):s===Qv.Hero&&Array.isArray(i.items)&&(i.background=function(e){const t=e.map(e=>e.media.bestBackgroundColor()).filter(e=>(0,Nv.isSome)(e))
let n=null
if(t.length>0&&t.length<=4&&t.length===e.length)switch(t.length){case 1:n={type:bx,colors:{colorCount:"oneColor",color:t[0]}}
break
case 2:n={type:bx,colors:{colorCount:"twoColor",top:t[0],bottom:t[1]}}
break
case 3:n={type:bx,colors:{colorCount:"threeColor",top:t[0],bottomLeading:t[1],bottomTrailing:t[2]}}
break
case 4:n={type:bx,colors:{colorCount:"fourColor",topLeading:t[0],topTrailing:t[1],bottomLeading:t[2],bottomTrailing:t[3]}}}else n={type:cV,color:Se("secondarySystemBackground")}
return n}(i.items))}return i}function xs(e,t,n,r){const i=t.type===Pm.EditorialItemGroup,s=new YY(Cj)
if(s.id=t.data.id,s.isHorizontal=!1,s.header=function(e,t,n){var r
if(null!==(r=v(t.data,"meta.personalizationData.suppressHeader"))&&void 0!==r&&r)return null
const o={eyebrow:Bs(0,t),eyebrowArtwork:js(e,t,ym.Eyebrow),eyebrowArtworkType:Vs(e,t,ym.Eyebrow),title:Us(0,t),titleArtwork:js(e,t,ym.Title),titleArtworkType:Vs(e,t,ym.Title),subtitle:Gs(0,t),configuration:{eyebrowImageColor:null,titleImageColor:null,includeSeparator:!1}}
return(0,Nv.isSome)(o.eyebrow)||(0,Nv.isSome)(o.title)||(0,Nv.isSome)(o.subtitle)?o:null}(e,t),i){const r={id:s.id,kind:zR,softwareType:null,targetType:KH,title:Us(0,t,!0),pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:lq,recoMetricsData:Ws(t)}
t.type===Pm.EditorialItemGroup&&(r[BS]=f(t.data,uI),r[NS]=f(t.data,dI)),Oh(e,s,r),gh(e,r,r.title)}return s.items=r(),s.isHidden=o(s.items),i&&(mh(n.locationTracker),bh(n.locationTracker)),s}function $s(e,t,n,r){var o
let a
if(t.adPlacementBehavior===Xv.replaceOrganic&&i(n.replaceIfAdPresent)&&v(n.replaceIfAdPresent)){const o=Ns(e,t,n)
a=s(o)?o:bo(e,r,n,t)}else t.adPlacementBehavior===Xv.dropAd&&i(n.replaceIfAdPresent)&&!v(n.replaceIfAdPresent)?(a=bo(e,r,n,t),s(t.adData)&&(null===(o=t.pageInformation.adPageInfo)||void 0===o||o.setMissedOpportunity(e,oA,"0",t.parsedCardCount))):a=bo(e,r,n,t)
return a}function Fs(e,t){let n=null
if(!Kt(e,_q)||(0,Nv.isNothing)(t.adData)||t.adPlacementBehavior!==Xv.insertIntoShelf)return n
if(t.adLocation!==t.parsedCardCount)return n
n=new YY(Cj),n.id=t.adData.id,n.isHorizontal=!1,n.contentsMetadata={type:y_,debugSectionTypeIndicatorColor:Se(pL),groupDisplayStyle:Qv.Standard}
const r=[],o=Ns(e,t,ks(0,t.adData,_s(t),Os(e,t),void 0,!1))
return(0,Nv.isSome)(o)&&(t.parsedCardCount++,Es(t,Qv.Standard,0),bh(t.locationTracker),r.push(o)),n.items=r,s(n.items)?n:null}function Ns(e,t,n){var o,s,a
if(!Kt(e,_q))return null
if(t.adLocation!==t.parsedCardCount&&t.adPlacementBehavior!==Xv.replaceOrganic)return null
null===(o=t.pageInformation.adPageInfo)||void 0===o||o.updateContainerId(e,null===(s=t.pageInformation.adPageInfo)||void 0===s?void 0:s.containerIdForSlotIndex(null!==(a=t.parsedCardCount)&&void 0!==a?a:0))
const c=function(e,t,n,o){return Bv.context("createTodayAdCard",()=>{var s,a,c,l,u,d,h
if(r(t))return null
const p=go(e,t,n,o)
So(e,t,n,o,f(t.attributes.name))
const w=Lh(e,t,f(t.attributes.name),{targetType:Cj,pageInformation:o.pageInformation,locationTracker:o.locationTracker,isAdvert:!0,rowIndex:n.currentRowIndex,displayStyle:n.metricsDisplayStyle}),g=Ge(e,t)
w.productVariantData=g,w.adSlotOverride=o.parsedCardCount,w.kind=QD
const v=w
let m
null===(s=w.pageInformation)||void 0===s||s.adPageInfo.apply(e,t),i(n)&&(m=n.clientIdentifierOverride)
const y=(0,Nv.isSome)(null)
switch(p.style=kq,Qt(e)){case Bx:null===(c=null===(a=w.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c||c.setTemplateType(e,zU)
break
case VH:y&&(null===(u=null===(l=w.pageInformation)||void 0===l?void 0:l.adPageInfo)||void 0===u||u.setTemplateType(e,[Hb,"U","I",1,"_2x1"].join("")))}let A=Ps(e,t,n,o)
if(r(A))return null===(d=o.pageInformation.adPageInfo)||void 0===d||d.recordLockupFromDataFailed(e,"0",o.parsedCardCount),Co(o),Rh(e,p,w,null,null,!1,!1),null
switch(null===(h=A.searchAdOpportunity)||void 0===h||h.setTemplateType(zU),Qt(e)){case Bx:const i=new D0(A,A.icon)
p.media=new _0(i),p.media.impressionMetrics=A.impressionMetrics
break
case VH:p.media=function(e,t,n,o,i,s,a){return e.media=function(e,t,n,r,o){var i,s
const a=t.screenshots[0],c=Ht(a)
null===(i=r.adPageInfo)||void 0===i||i.setTemplateType(e,c),null===(s=t.searchAdOpportunity)||void 0===s||s.setTemplateType(c)
const l=Jd(e,o,{useCase:n6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:T$})
let u=l.backgroundColor,d=l.textColor
const f={type:bV,red:1,green:1,blue:1}
Ce(f,u)?(u=d,d=void 0):Ce(f,d)&&(d=void 0)
const h=new L0(t,[a],n,d,u,8)
return new M0(h)}(t,n,t.bag.todayAdMediumLockupScreenshotAnimationEnabled,a.pageInformation,o),r(n=Ps(t,o,i,s))?null:(n.searchAdOpportunity=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity,n.searchAd=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAd,e.media.mediumAdLockupWithScreenshotsBackground.lockup=n,e.media.impressionMetrics=n.impressionMetrics,e.media)}(p,e,A,t,n,o,w)
break
default:return null}Co(o)
const T=jt(t)
return p.clickAction=Dd(e,t,v,m,void 0,T),function(e,t,n,o){let i=fn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),Zt(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=Bf(e,t)?TB:dM,a=Yt(0,o.pageInformation),c=j(t,fM),l=H(t,eq)?NV:Wq,u=new kY(i,t.id,c,s,Gb,l,a)
n.clickAction=zt(0,n.clickAction,u)}(e,t,p,w),Rh(e,p,w,null,null,!1,!1),p})}(e,t.adData,n,t)
return(0,Nv.isSome)(c)?c:null}function Bs(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderBadge)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,w_)),(0,Nv.isSome)(r))return r
switch(t.data.type){case Nq:r=j(t.data,w_)
break
case vj:r=j(t.data,[dV,qB])}return r}function Us(e,t,n=!1){const r=On(0,t.data)
if((t.isFirstItemInModule||r.suppressHeaderName)&&!n)return null
let o
const i=N(t.data)
if(W(i)&&(o=j(i,p_)),(0,Nv.isSome)(o))return o
switch(t.data.type){case Nq:o=j(t.data,p_)
break
case vj:o=j(t.data,[dV,Zq])}return o}function Gs(e,t){const n=On(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderTagline)return null
let r
const o=N(t.data)
if(W(o)&&(r=j(o,g_)),(0,Nv.isSome)(r))return r
switch(t.data.type){case Nq:r=j(t.data,g_)
break
case vj:r=j(t.data,[dV,gj])}return r}function js(e,t,n){var r
const o=On(0,t.data),i=pe(e,t.data,Tx),s=null!==(r=o.headerArtworkBehavior)&&void 0!==r?r:vm.NoArtwork
switch(n){case ym.Eyebrow:return s===vm.CategoryArtworkWithBadge?Hs(e,i):null
case ym.Title:switch(s){case vm.CategoryArtworkWithTitle:return Hs(e,i)
case vm.ContentArtworkWithTitle:return Jd(e,i,{useCase:n6.LockupIconSmall})
default:return null}default:return null}}function Vs(e,t,n){const r=pe(e,t.data,Tx),o=j(t.data,[zG,"headerArtworkBehavior"])
switch(n){case ym.Eyebrow:return o===vm.CategoryArtworkWithBadge&&(0,Nv.isSome)(Hs(e,r))?em.Category:null
case ym.Title:switch(o){case vm.CategoryArtworkWithTitle:return(0,Nv.isSome)(Hs(e,r))?em.Category:null
case vm.ContentArtworkWithTitle:return(0,Nv.isSome)(Hs(e,r))?em.Icon:null
default:return null}default:return null}}function Hs(e,t){const n=Sn(e,t,!1,!1,!1)
return(0,Nv.isNothing)(n)?null:qd(e,n,{useCase:n6.CategoryIcon,allowingTransparency:!0,cropCode:"sr"})}function qs(e,t){const n=B(t.data,hI,null),r=null==n?void 0:n[fV]
if((0,Nv.isNothing)(r))return null
let o=null
if(r===Am.LinearGradient){const e=g(n).stops.map(e=>ye(e.color)),t={type:"gradient",colors:e,start:tm.Top,end:tm.Bottom},r=be(e[0]),i={type:bV,red:60/255,green:60/255,blue:67/255,alpha:.6},s={type:bV,red:235/255,green:235/255,blue:245/255,alpha:.6}
o={shelfBackground:t,eyebrowColor:r?s:i,titleColor:Se(r?JH:MO),subtitleColor:r?s:i}}else o=null
return o}function Ws(e){var t,n
return(0,Nv.isNothing)(e)?{}:null!==(n=hh(null!==(t=p(e.moduleMetadata,LR))&&void 0!==t?t:{},e.moduleMetadata.onDevicePersonalizationProcessingType,null))&&void 0!==n?n:{}}function zs(e,t){let n
if((0,Nv.isSome)(t))n=t
else{const t=Ah(e),o=(r=e).locationStack.length<2?null:r.locationStack[1].position
n=(0,Nv.isSome)(t)&&(0,Nv.isSome)(o)&&(t.locationType===Cj||t.name===H$)?o:yh(e)}var r
return n}function Ys(e,t,n,r=null,o=null){var i
const s=f(n,$J)
if((0,Nv.isNothing)(s))return null
const a=JSON.parse(s),c=x0.placementTypeFromPlacementId(e,f(a,fG)),l=new x0(e,c,x0.createInitialPageSlotInfos(e,c,r,o,void 0),null!==(i=f(a,hG))&&void 0!==i?i:void 0,void 0,void 0,r)
return l.applyClickFieldsFromPageRequest(null!=t?t:void 0,a),l}function Js(e,t,n,i){return Bv.context("clickOptionsForLockup",()=>{var s,a,c
const l=t.id.slice()
let u=t.id
void 0!==n.anonymizationOptions&&n.anonymizationOptions.anonymizationString.length>0&&(u=n.anonymizationOptions.anonymizationString)
const d={...n,...i,id:u,contextualAdamId:l,softwareType:oh(e,t)}
if(o(d.targetType)&&(d.targetType=Bq),r(d.kind)&&(d.kind=ih(e,t)),V(t,eq)&&(d.offerType=NV),n.isAdvert||n.isAdEligible){const t=null!==(s=d.adsMetricsData)&&void 0!==s?s:{},r=null===(c=null===(a=n.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,o=x0.containerIdFromType(e,r)
if(r===zH&&(0,Uv.isSome)(o)){const e=zs(n.locationTracker,n.adSlotOverride)
t[z$]=`${o}_${e}`}d.adsMetricsData=t}return d})}function Ks(e,t,n,r,o,a,c,l,u,d){var f,h,p,w,g,v,m,y,A,T,b,S
const P={}
if(o){const e=o
c&&(null!==(p=null===(h=null===(f=e.adPageInfo)||void 0===f?void 0:f.adAdamId)||void 0===h?void 0:h.length)&&void 0!==p?p:0)>0&&(0,Uv.isSome)(e.adPageInfo)&&e.adPageInfo.adAdamId===t.adamId&&Object.assign(P,e.adPageInfo.clickFields),s(e.searchTermContext)&&(P[mH]=e.searchTermContext.term)}(0,Uv.isSome)(l)&&Object.assign(P,l),P[xG]={buyParams:t.purchaseConfiguration.buyParams},void 0!==a&&(P[jB]=a),P[xJ]=t.adamId,t.actionMetrics.custom[xJ]=t.adamId,r&&(P[Y$]=NV,i(t.expectedReleaseDate)&&(P[mR]=Ee(t.expectedReleaseDate))),(null===(g=null===(w=null==d?void 0:d.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g?void 0:g.placementType)===zH&&(0,Uv.isSome)(null===(v=null==d?void 0:d.adsMetricsData)||void 0===v?void 0:v.iAdSlotId)&&(P[z$]=null===(m=null==d?void 0:d.adsMetricsData)||void 0===m?void 0:m.iAdSlotId),(0,Uv.isSome)(null===(y=null==d?void 0:d.adsMetricsData)||void 0===y?void 0:y.iAdDuplicateLayoutType)&&(P[NM]=null===(A=null==d?void 0:d.adsMetricsData)||void 0===A?void 0:A.iAdDuplicateLayoutType)
const C=_t(e,n,Qq,P,void 0,u)
P[xJ]=t.adamId,t.actionMetrics.custom[xJ]=t.adamId,C.includingFields.push("appState"),t.purchaseConfiguration.isArcadeApp&&C.includingFields.push(ES)
const I=null!==(S=null===(b=null===(T=null==o?void 0:o.adPageInfo)||void 0===T?void 0:T.shouldIncludeAdRotationFields)||void 0===b?void 0:b.call(T,e))&&void 0!==S&&S
c&&I&&C.includingFields.push(PN),c&&e.client.isPad&&C.includingFields.push(SM),t.actionMetrics.addMetricsData(C)}function Zs(e,t,n){var r
Qs(e,t,{...n,actionType:yR,subscriptionSKU:null!==(r=e.bag.arcadeProductId)&&void 0!==r?r:void 0,actionContext:nq,targetType:Qq})}function Qs(e,t,n,r=!1,o){var s,a,c,l,u,d,f,h,p,w,g,v,m,y,A
let b=n.actionType
b||(b=Xq)
const S={actionType:b}
let P
P=T(A=t)&&A[tW]===ky?t.actions:[t],P.forEach(e=>{if(ht(e)){const t=e
S[TN]=t.pageUrl}else if(wt(e)){const t=e
S[TN]=t.url}}),n.actionDetails&&(S[xG]=n.actionDetails),n.actionContext&&(S[RS]=n.actionContext),i(n.offerType)&&(S[Y$]=n.offerType),i(n.offerReleaseDate)&&(S[mR]=Ee(n.offerReleaseDate))
const C=null!==(c=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:null==t?void 0:t.title)&&void 0!==c?c:""
let I
S[jB]=ph(e,n,C),n.pageInformation&&n.pageInformation.searchTermContext&&(S[mH]=n.pageInformation.searchTermContext.term),i(n.softwareType)&&(S[IN]=n.softwareType),(n.isAdvert||n.isAdEligible)&&r&&(null===(l=n.pageInformation)||void 0===l?void 0:l.adPageInfo)&&(Object.assign(S,n.pageInformation.adPageInfo.clickFields),e.client.isPad&&(I=[SM])),n.mercuryMetricsData&&Object.assign(S,n.mercuryMetricsData),(0,Uv.isSome)(n.subjectIds)&&(S.subjectIds=n.subjectIds),(null===(d=null===(u=null==n?void 0:n.pageInformation)||void 0===u?void 0:u.adPageInfo)||void 0===d?void 0:d.placementType)===zH&&(0,Uv.isSome)(null===(f=n.adsMetricsData)||void 0===f?void 0:f.iAdSlotId)&&(S[z$]=null===(h=n.adsMetricsData)||void 0===h?void 0:h.iAdSlotId),(0,Uv.isSome)(null===(p=n.adsMetricsData)||void 0===p?void 0:p.iAdDuplicateLayoutType)&&(S[NM]=null===(w=n.adsMetricsData)||void 0===w?void 0:w.iAdDuplicateLayoutType)
const k=_t(e,n.id,null!=o?o:nh(0,n),S,I)
n.actionContext===nq&&(n.actionType===s$||n.actionType===yR)&&(k.includingFields.push(ES),k.fields[xJ]=n.contextualAdamId,(0,Uv.isSome)(t.adamId)&&(t.actionMetrics.custom[xJ]=t.adamId))
const O=null!==(y=null===(m=null===(v=null===(g=n.pageInformation)||void 0===g?void 0:g.adPageInfo)||void 0===v?void 0:v.shouldIncludeAdRotationFields)||void 0===m?void 0:m.call(v,e))&&void 0!==y&&y
n.isAdvert&&O&&k.includingFields.push(PN),t.actionMetrics.addMetricsData(k)}function Xs(e,t,n,r){const o={}
i(n)&&(o[TN]=n),r.targetType||(r.targetType=Qq),o[jB]=wh(0,r,t.title),o[GB]=Xq,o[c$]="button_See All"
const s=_t(e,AR,Qq,o)
t.actionMetrics.addMetricsData(s)}function ea(e,t,n){const r={}
r[GB]="filter"
const o=_t(e,`filter_${n}`,Qq,r)
o.includingFields.push(DS),t.actionMetrics.addMetricsData(o)}function ta(e,t,n,r,o){var i,a,c,l
const u=function(e){switch(e){case kB:return kB
case AB:return AB
case bR:return"recentQuery"
case B$:return UM
case SR:return"searchInsteadFor"
case PR:return MS
case CR:return CR
default:return IR}}(t.origin);(0,Uv.isNothing)(o)&&(o=new BJ({page:wV,pageType:wV,pageId:wV,pageDetails:_S}))
const d={pageInformation:o,locationTracker:r,targetType:n},f={...Nt(o),actionType:u,actionUrl:sh(t.url),location:wh(0,d,t.term),searchTerm:t.term},h={targetId:t.term},p={};(null===(i=t.prefixTerm)||void 0===i?void 0:i.length)&&(p[J$]=t.prefixTerm),(null===(a=t.entity)||void 0===a?void 0:a.length)&&(p[BM]=t.entity),s(p)&&(h[xG]=p),(null===(c=t.originatingTerm)||void 0===c?void 0:c.length)&&(f[TR]=t.originatingTerm,h[TR]=t.originatingTerm)
const w=_t(e,t.term,n,f,[LS])
t.actionMetrics.addMetricsData(w)
const g=Lt(e,t.term,n,u,null!==(l=t.url)&&void 0!==l?l:null,h,[LS])
t.actionMetrics.addMetricsData(g)}function na(e,t){return i(t)?j(t,"customUrl"):null}function ra(e,t,n,r,o,i,a){if(!s(o)&&e.client.deviceType!==Yq)return t
let c
{const e=new _J(n,Mq)
c=new LJ(r,o,e)}const l=S(a)
if(l.actionType=DV,l.actionDetails={actionUrl:o},Qs(e,c,l,!0,Qq),gt(t))return t.openAction=c,t.includeBetaApps=i,t
{const e=new IY(n,t)
return e.openAction=c,e.includeBetaApps=i,e}}function oa(e,t,n,o,a,c,l,u,d,f){return Bv.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const h=ia(e,t)
if(!s(h))return null
const p=[]
let w=null,g=null
const v=H(h,eq)
if(n){const t=Bf(e,h),n=ud(0,h.type,t),s=function(e,t,n,o,i,s,a){return r(t)||t.type!==Kq?null:vr(e,wr(e,t),t,n,!1,dh(e,t,Jd(e,t,null,s),s),a,jj)}(e,h,v,0,0,o,l)
g=xr(e,s,n,h,v,0,null,null,null,null,jj)
const a=function(e,t,n,o,i,s,a,c){if(r(n))return null
let l=br(e,n,t,o,s,jj,i)
return(null==c?void 0:c.length)>0&&(l=ra(e,l,n.adamId,null,c,!1,s)),l}(e,h,s,v,o,l,0,u)
i(a)&&i(g)&&(w=p.length,a.artwork=Ot(e,"systemimage://arrow.down.circle"),p.push(a))}const m=function(e,t,n){const r=Vo(e,t,n.pageInformation,n.locationTracker)
return i(r)?(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SHARE"),r.artwork=Ot(e,sO),r):r}(e,h,c)
i(m)&&p.push(m)
const y=la(e,h)
if(!v&&!y){if(i(a)&&ht(a)&&(vt(a.pageData)||mt(a.pageData))){const t=function(e,t,n){const r=function(e,t,n){return Bv.context("seeRatingsAndReviewsActionFromData",()=>{const t=S(n)
if(vt(n.pageData)||mt(n.pageData)){let r
r=new qY(gH)
const o=zu(e)?r:new WY(new zY(nW,bq)),i=S(n.pageData)
i.fullProductFetchedAction=o,t.pageData=i}return t})}(e,t.id,n)
return i(r)&&(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),r.artwork=Ot(e,"systemimage://star"),r.animationBehavior=qV),r}(e,h,a)
i(t)&&p.push(t)}if(!xe(e,t,BG)){const t=function(e,t,n,r){const o=Ca(e,t,n,r)
return i(o)&&(o.title=e.loc.string("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),o.artwork=Ot(e,MT)),o}(e,h,d,f)
i(t)&&p.push(t)}}return new CJ(p,g,w)})}function ia(e,t){return Bv.context(`productDataFromData: ${t.type}`,()=>{switch(t.type){case Kq:case xq:return t
case Nq:{const n=we(t,wH)
if(s(n)&&1===n.length){const t=n[0]
return ia(e,t)}break}case d$:{const n=we(t,Jq)
if(s(n)&&1===n.length){const t=n[0]
return ia(e,t)}break}default:return null}return null})}function sa(e,t,n,r){const o=e.bag.voteUrl,i=f(t,"id",CH),s=new qW(o).param(xT,i),a=new OJ(s.build()),c=new gY(QN)
return r?(a.title=e.loc.string("ACTION_REVIEW_HELPFUL"),c.title=e.loc.string("TOAST_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,$T),c.artwork=Ot(e,$T)):(a.title=e.loc.string("ACTION_REVIEW_NOT_HELPFUL"),c.title=e.loc.string("TOAST_NOT_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_NOT_HELPFUL_DESCRIPTION"),a.artwork=Ot(e,FT),c.artwork=Ot(e,FT)),a.method=rG,a.isStoreRequest=!0,a.disableCache=!0,a.headers={"Content-Type":DJ.contentType},a.body=(new DJ).param("vote",r?"1":"0").param(NT,n).build(),a.successAction=c,a}function aa(e,t,n){return Bv.context("reportConcernActionFromApiRow",()=>{const r=f(t,"id",CH),i=e.bag.reportConcernUrl,s=new OY(i)
s.method=rG,s.isStoreRequest=!0,s.disableCache=!0,s.needsAuthentication=!0,s.headers={"Content-Type":DJ.contentType},s.body=(new DJ).param(xT,r).param(NT,n).build()
const a=new RY("selectedReason",BT,pE),c=new RY("explanation",BT,UV)
s.parameters=[a,c]
{const t=new gY(QN)
t.title=e.loc.string(_T),t.message=e.loc.string(LT),t.artwork=Ot(e,GL),s.successAction=t}const l=new gY(vq)
l.title=e.loc.string(dE),l.message=e.loc.string(fE),l.isCancelable=!0,s.failureAction=l
let u=e.bag.reportConcernReasons
o(u)&&(u=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}])
const d=u.map(e=>new IJ(f(e,"reasonId"),f(e,Zq),f(e,"upperCaseName"))),h=new EJ(d)
return h.title=e.loc.string(DT),h.explanation=e.bag.reportConcernExplanation,o(h.explanation)&&(h.explanation="Tell us a little more (Optional)"),h.artwork=Ot(e,GL),h.sendAction=s,h})}function ca(e,t,n){return`${hW}:/${yW.reviews}/${yW.shelf}/${t}/${n}`}function la(e,t){return!(!i(t)||ua(e,t)||!H(t,VU)&&!H(t,"reviewsRestricted"))}function ua(e,t){return!(o(t)||!e.bag.enableSystemAppReviews)&&st(e).isSystemAppFromData(t)}function da(e){return e.featureFlags.isEnabled(AJ)&&(0,Nv.isSome)(e.bag.saveUserReviewURL)}function fa(e,t){const n=qW.from(e),r=f(n.query,RP)
return t&&(null==r?void 0:r.length)>0&&(n.query[RP]=B0[r]||r),n}function ha(e,t,n,r=!1,o,a,c){return Bv.context("createProductReviewsList",()=>{const l=[]
if(s(a)){if((0,Nv.isSome)(c)){const t={id:`${c.getSequenceId()}`,kind:null,softwareType:null,targetType:Nj,title:e.loc.string(nF),pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,idType:sq}
gh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:Nj,id:`${c.getSequenceId()}`,idType:sq},e.loc.string(nF)),Oh(e,a,t),mh(c.locationTracker),bh(c.locationTracker)}l.push(a)}if(s(o),i(n)&&n.length>0){const o=!1,i=!o,s=o?n.slice(0,1):n,a=!1,u=pa(e,e.client.guid,t,s,r&&i,a&&i,i,c);(0,Nv.isSome)(c)&&gh(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:tD,id:`${c.getSequenceId()}`,idType:sq},null),u.forEach((t,n)=>{const r=new DY
if(r.sourceType=OP,r.review=t,l.push(r),(0,Nv.isSome)(c)){const t={id:r.id,idType:lq,kind:null,softwareType:null,title:null,pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:"helpfulReview"}
Oh(e,r,t),bh(c.locationTracker)}}),(0,Nv.isSome)(c)&&(mh(c.locationTracker),bh(c.locationTracker))}return l})}function pa(e,t,n,r,i=!1,s=!1,a=!0,c){return Bv.context("createReviewItems",()=>{const l=function(t,n){return n?1e3*((new Date).getTime()-t.getTime())<3600?e.loc.string("TimeAgo.Edited.JustNow"):e.loc.string("TimeAgo.Edited.Time").replace("{time}",e.loc.timeAgoWithContext(t,"standalone")):e.loc.timeAgoWithContext(t,"standalone")}
return r.map(r=>{var u
const d=new _Y
d.id=f(r,"id",CH),d.title=j(r,Pq)
const h=j(r,HE)
h&&(d.date=new Date(h),d.dateText=l(d.date,H(r,"isEdited"))),d.contents=j(r,"review"),d.rating=q(r,tj),d.reviewerName=j(r,"userName"),d.dateAuthorText=e.loc.string("ProductPage.Section.Reviews.DateAuthor").replace("{date}",d.dateText).replace("{author}",d.reviewerName)
let p=null
const w=j(r,"developerResponse.id")
if((null==w?void 0:w.length)>0){const e=new LY
e.id=w,e.contents=j(r,"developerResponse.body")
const t=j(r,"developerResponse.modified")
t&&(e.date=new Date(t),e.dateText=l(e.date,!1)),d.response=e,p=d.response.contents}if(a&&(f(n,SV),d.flowPreviewActionsConfiguration=function(e,t,n,r,i){var s
if(o(t)||e.client.deviceType!==jq&&e.client.deviceType!==$q&&e.client.deviceType!==Yq)return null
const a=[sa(e,t,n,!0),sa(e,t,n,!1)]
return(null===(s=e.bag.reportConcernUrl)||void 0===s?void 0:s.length)>0&&a.push(aa(e,t,n)),(null==i?void 0:i.length)>0&&a.push(function(e,t){const n=new RJ(t)
return n.title=e.loc.string("ACTION_REVIEW_COPY"),n.artwork=Ot(e,"systemimage://doc.on.doc"),n}(e,i)),new CJ(a)}(e,r,t,0,p)),s){const n=[sa(e,r,t,!0),sa(e,r,t,!1)];(null===(u=e.bag.reportConcernUrl)||void 0===u?void 0:u.length)>0&&n.push(aa(e,r,t)),d.voteActions=n}return i&&(d.moreAction=function(e,t,n,r,o){return r?Bv.context("singleReviewActionFromReviewData",()=>{const t=Ia(e,0,n,[r],null,null,null,o),i=new QY
i.adamId=f(n,SV),i.targetReviewId=f(r,"id",CH),i.shelves=[t]
const s=new fY(bq)
return s.pageData=i,s.title=Ma(e),s}):null}(e,0,n,r,c)),d})})}function wa(e,t,n,r){return r?Bv.context("ratingsFromApiResponses",()=>{const t=new MY
t.productId=f(r,SV,CH),t.ratingAverage=h(r,"ratingAverage"),t.totalNumberOfRatings=h(r,LP),t.totalNumberOfReviews=h(r,"totalNumberOfReviews"),t.context=n
const o=l(r,"ratingCountList").slice().reverse(),i=o.reduce((e,t)=>e+t,0)
if(t.ratingCounts=i>0?o.map(e=>e/i*t.totalNumberOfRatings):o,!(t.ratingAverage>0&&t.ratingCounts)){const n=u(r,nD)
t.status=n?e.loc.string("RATINGS_STATUS_DEVELOPER_RESET"):e.loc.string("RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return t}):null}function ga(e,t,n){if(!va(e))return null
const r=fe(t,WO)
if((0,Nv.isNothing)(r))return null
const i=r.data
if(o(i))return null
const s=i[0],a=f(s,"id",CH),c=ma(e,s,!0),u=ma(e,s,!1),d=e.loc.string("ProductPage.ReviewSummary.Subtitle"),h=e.bag.reviewSummaryReportConcernData
if((0,Nv.isNothing)(u)||(0,Nv.isNothing)(c))return null
const p=j(t,Zq),w=Qe(e,s,UV),g=Ot(e,"systemimage://text.line.2.summary"),m=new xY(c,u,d,g,Uq,rx,function(e,t,n,r,o,i,s){const a=[],c=function(e,t,n,r){return Bv.context("reviewSummaryReportConcernActionFromApiRow",()=>{if(!v(t,ET))return null
const r=function(e,t){const n=new Jz(e)
n.includeAppBinaryTraitsAttribute=!1,n.resourceType=RT
const r=ve(e,n),o=new OY(r.toString())
o.method=rG,o.disableCache=!0,o.needsMediaToken=!0,o.headers={"Content-Type":jL},o.bodyDictionary={report:{contentId:t,contentKind:"review-summaries",concerns:null}}
const i=new gY(QN)
i.title=e.loc.string(_T),i.message=e.loc.string(LT),i.artwork=Ot(e,GL),o.successAction=i
const s=new gY(vq)
return s.title=e.loc.string(dE),s.message=e.loc.string(fE),s.isCancelable=!0,o.failureAction=s,o}(e,n),o=l(t,RT).map(t=>{let n,r
const o=f(t,fH)
switch(o){case"OFFENSIVE":case"OFFENSIVE_OR_HARMFUL":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.UppercaseName")
break
case"MISREPRESENTING_THE_APP":case"MISREPRESENT":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.UppercaseName")
break
case"SOMETHING_ELSE":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.UppercaseName")}return new IJ(o,n,r)})
if(0===o.length)return null
const i=e.loc.string(DT),s=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Explanation"),a=new kJ(o,i,s,r)
return a.artwork=Ot(e,GL),a})}(e,t,o);(0,Nv.isSome)(c)&&a.push(c)
const u=Ea(e);(0,Nv.isSome)(u)&&a.push(u)
const d=function(e,t,n,r,o){if(![RG,WU].includes(e.client.buildType))return null
const i=new PY(`tap-to-radar://new/problem?componentid=999915&title=Review Summary Feedback: ${n}&description=App ID: ${t}\nApp name: ${n}\nReview summary ID: ${r}\nReview summary: ${o}\n\nFeedback: `,!0)
return i.title=e.loc.string("Action.ProvideFeedback"),i.artwork=Ot(e,"systemimage://ant.circle"),i}(e,n,r,o,i)
return(0,Nv.isSome)(d)&&a.push(d),new CJ(a)}(e,h,t.id,p,a,w,e.client.guid)),y={id:`${n.getSequenceId()}`,kind:null,softwareType:null,targetType:Nj,title:e.loc.string(nF),pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,idType:sq}
return gh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:Nj,id:`${n.getSequenceId()}`,idType:sq},m.title),Oh(e,m,y),mh(n.locationTracker),bh(n.locationTracker),m}function va(e){return e.bag.enableReviewSummarization}function ma(e,t,n){const r=Qe(e,t,UV)
if((0,Nv.isNothing)(r))return null
const o=`^[${e.loc.string(nF)}](jetFont: 'reviewSummaryTitle')`,i=`^[${r}](jetFont: 'reviewSummaryText')`
return n?e.loc.string("ProductPage.ReviewSummary.Body").replace("{styledTitle}",o).replace("{reviewSummary}",i):i}function ya(e){if(!e)return null
const t=new $Y
return ba(e,t),t}function Aa(e){if(!e)return null
const t=new FY
return ba(e,t),t}function Ta(e){if(!e)return null
const t=new NY
return ba(e,t),t}function ba(e,t){t.ratingAverage=e.ratingAverage,t.ratingCounts=e.ratingCounts,t.totalNumberOfRatings=e.totalNumberOfRatings,t.totalNumberOfReviews=e.totalNumberOfReviews,t.status=e.status,t.reviews=e.reviews,t.actions=e.actions,t.nextPage=e.nextPage}function Sa(e,t,n,r=null,o=null){const i=new BY
switch(e.client.deviceType){case"tv":i.title=e.loc.string("TV_SELECT_TO_RATE")
break
case Yq:i.title=e.loc.string("CLICK_TO_RATE")
break
default:i.title=e.loc.string("TAP_TO_RATE")}return i.rating=o,i.rateAction=function(e,t,n,r=null){const o=new gY(QN)
o.title=e.loc.string("TOAST_TAP_TO_RATE_TITLE"),o.message=e.loc.string("TOAST_TAP_TO_RATE_DESCRIPTION"),o.artwork=Ot(e,"resource://ToastStar.png",95,90)
const i=new EY(function(e,t,n){return fa(da(e)?e.bag.saveUserReviewURL:e.bag.userRateURL,n).param("id",t).build()}(e,t,n))
i.useModernRatingsAPI=da(e),i.adamId=t,i.method=rG,da(e)&&(i.headers={"Content-Type":jL}),i.isStoreRequest=!0,i.disableCache=!0,i.successAction=o
const s=new RY(tj,DP,pE),a=new RY(da(e)?hE:"versionToReview",DP,pE)
return i.parameters=[s,a],i}(e,t,n,r),i}function Pa(e,t,n,r,o=!1,i,s){return Bv.context("createWriteReviewAction",()=>{const a=o?e.loc.string("EDIT_REVIEW"):e.loc.string("WRITE_A_REVIEW"),c=function(e,t,n){return fa(e.bag.writeReviewURL,n).param("id",t).build()}(e,t,n)
let l,u
if((0,Nv.isSome)(r)){const t=kt(e,!0,!1,n6.LockupIconSmall),n=r.template.replace("{c}",`${r.crop}-${t.quality}`).replace("{f}",t.format)
l=new QW(n,r.width,r.height,r.variants),l.backgroundColor=r.backgroundColor,l.textColor=r.textColor,l.checksum=r.checksum,l.style=r.style,l.crop=r.crop,l.contentMode=r.contentMode,l.imageScale=r.imageScale}switch(e.client.deviceType){case Yq:{const e=new UY(t,c)
e.title=a,e.appIcon=l,e.itemDescription=i,e.appName=s,u=e
break}default:{const n=new UY(t,c)
n.title=a,n.appName=s,n.itemDescription=i,n.appIcon=l,n.artwork=Ot(e,MT),u=n
break}}return u})}function Ca(e,t,n,r,o){return Bv.context("writeReviewActionFromData",()=>{const s=t.id
if((null==s?void 0:s.length)>0){const a=t.type===xq,c=q(t,tj),l=i(c)&&c>0
return Pa(e,s,a,o,l,n,r)}return null})}function Ia(e,t,n,r,o=!1,i=!1,s=!0,a){return Bv.context("reviewsShelfForReviewsData",()=>{{const t=new YY(Fx)
return null==a||a.addImpressionsToShelf(e,t,rD),t.items=ha(e,n,r,o,null,null,a),t}})}function ka(e,t,n,o){return Bv.context("personalizedReviewsContainerShelf",()=>{const s=yt(e,o),a=q(s,tj)
return function(e,t,n,o,s,a,c,l,d,h,p=!1,w=!0,g=null,v=!1){return Bv.context("reviewsContainerShelfForReviewsData",()=>{const w=function(e,t,n,o,s,a,c,l,d,h=null,p=!1){return Bv.context("reviewsContainerForReviewsData",()=>{const w=new JY,g=f(n,SV),v=u(n,"isBundle")
w.adamId=g,w.ratings=wa(e,0,hL,n)
{const t=ga(e,s,d)
i(t)&&(w.reviewSummary=t)}if(p||(w.tapToRate=Sa(e,g,v,a,h)),i(o)&&o.length>0){const r=!1,i=!r,s=r?o.slice(0,1):o
w.reviews=pa(e,t,n,s,i,!1,i,d)}if(r(w.reviews)||0===w.reviews.length){const t=w.ratings.ratingAverage>0&&w.ratings.ratingCounts,r=u(n,nD)
t||r||(w.ratings.status=e.loc.string(oD))}if(r(l)||(w.editorsChoice=l),!p){const t=i(h)&&h>0
w.writeReviewAction=Pa(e,g,v,c,t,wd(e,s),a)}const m=f(n,iD)
if(m){const t=new PY(m,!1)
t.title=e.loc.string(MP),w.supportAction=t}let y=!1
for(const t of o)if(ua(e,t)){y=!0
break}return w.alwaysAllowReviews=y,w})}(e,t,n,o,a,s,c,l,d,g,v),m=new YY(EP)
return m.title=Ma(e),m.items=[w],null==d||d.addImpressionsToShelf(e,m,rD),p&&i(w.reviews)&&w.reviews.length>0&&(m.seeAllAction=La(e,0,n,o,h,s,c,!1,!1)),m})}(e,t,n.ratingsData,n.reviewItems,n.appName,s,n.appIcon,n.editorsChoice,n.shelfMetrics,n.nextPageHref,n.includeSeeAllAction,!1,a)})}function Oa(e,t,n,r,o,i=null){const a=function(e,t,n,r=null){let o=`${hW}:/${yW.reviews}/${t}/${n}`
return s(r)&&(o=`${o}/?${DW.token}=${encodeURIComponent(JSON.stringify(r))}`),o}(0,t,n,i)
return new KY(n,r,o,a)}function Ea(e){const t=e.bag.reviewSummarizationLearnMoreEditorialItemId
if(o(t))return null
const n=e.loc.string(tN),r=new fY(cq)
return r.title=n,r.pageUrl=`https://apps.apple.com/story/id${t}`,r.artwork=Ot(e,TO),r}function Ra(e,t,n,o,i,s=null,a=null,c,l=null,u,d,h=!1,p=!1,w=U0,g=null){const v=new QY
return v.shelves=[],Bv.context("reviewsPageForReviewsData",()=>{const t=r(a)?f(n,SV):a
i&&r(n)
const c=Da(e,0,t,n,o,s,h,p,w,g,d)
return c.reviewsShelf.presentationHints={...c.reviewsShelf.presentationHints,isSortable:i&&c.reviewsShelf.presentationHints.isSortable},v.adamId=t,v.shelves.push(c.reviewsShelf),v.nextPage=c.paginationToken,v.initialSortOptionIdentifier=c.initialSortId,v.sortActionSheetTitle=c.sortActionSheetTitle,v.sortOptions=c.sorts,v.alwaysAllowReviews=ua(e,u),v})}function Da(e,t,n,r,i,a=null,c=!1,l=!1,u=U0,d=null,f){const h=(null==a?void 0:a.length)>0&&s(i)&&i.length%2>0,p=h?i.slice(0,i.length-1):i,w=h?i.slice(i.length-1):[],g=Ia(e,0,r,p,c,l,!0,f)
var v
g.id=o(v=u)?G0:`${G0}.${v}`
const m={reviewsShelf:g}
return g.presentationHints={isSortable:i.length>0||(null==a?void 0:a.length)>0,isSeeAllContext:!0},m.initialSortId=u,m.sortActionSheetTitle=e.loc.string("REVIEWS_SORT_BY"),m.sorts=[Oa(0,n,eD,e.loc.string(xP),e.loc.string(xP),d),Oa(0,n,"favorable",e.loc.string($P),e.loc.string($P),d),Oa(0,n,"critical",e.loc.string(FP),e.loc.string(FP),d),Oa(0,n,NP,e.loc.string(BP),e.loc.string(BP),d)],(null==a?void 0:a.length)>0&&(m.paginationToken=function(e,t,n,r,o){return{url:ca(0,t,r),remainingContent:o,nextHref:n,profile:Bq,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(0,n,a,u,w)),m}function _a(e,t,n,r,o,i,a,c,l){return Bv.context("reviewsPageForReviewsMediaContainer",()=>{let t
return t=s(o.data)?r.concat(o.data):r,Ra(e,0,null,t,i,o.next,n,0,null,null,l,!1,!1,a,c)})}function La(e,t,n,r,o=null,i=null,s=null,a,c,l,u){return n?Bv.context(UP,()=>{const t=Ra(e,0,n,r,!0,o,null,0,s,l,u,a,c)
t.title=null
const i=new fY(bq)
return i.pageData=t,i.title=e.loc.string(KV),i}):null}function Ma(e){switch(e.client.deviceType){case"tv":return e.loc.string("TV_PRODUCT_SECTION_RATINGS")
case zq:return null
default:return e.loc.string("PRODUCT_SECTION_REVIEWS")}}function xa(e,t){return t.map(t=>t.createProductPageSection(e))}function $a(e,t,n,r,o,i,s){const a=function(e,t,n){switch(t){case LG:return n?Dv:Rv
case cx:return Mv
case Kj:return n?kv:Qm
case OV:return n?Ev:Ov
case lx:return n?Lv:_v
case AV:return n?$v:xv
default:return Qm}}(0,n,r)
let c=[]
c=t?o&&a.purchasedOrderingCompact?a.purchasedOrderingCompact.slice():a.purchasedOrdering.slice():i&&a.downloadingOrdering?o&&a.downloadingOrderingCompact?a.downloadingOrderingCompact.slice():a.downloadingOrdering.slice():o&&a.notPurchasedOrderingCompact?a.notPurchasedOrderingCompact.slice():a.notPurchasedOrdering.slice()
const l=t?a.purchasedSpotlightIndex:a.notPurchasedSpotlightIndex
if(s&&s.spotlightSection){const e=function(e,t){for(let n=0;n<t.length;n++){const r=t[n]
if(e.sectionType===r.sectionType&&e.shelfId===r.shelfId&&JSON.stringify(e.shelfBasedMappedIds)===JSON.stringify(r.shelfBasedMappedIds))return n}return-1}(s.spotlightSection,c);-1!==e&&(c.splice(e,1),c.splice(l,0,s.spotlightSection))}return c}function Fa(e){return new V0(nW,e?bj:Tj)}function Na(e){var t
return(0,Nv.isSome)(e)&&(null===(t=e.id)||void 0===t?void 0:t.indexOf(Q1))>-1}function Ba(e,t,n){if(!e.featureFlags.isEnabled(vJ))return null
const r=new Z1(t)
jn(e,r,Gn(e,"ProductMediaGallery",n,""))
const o=new fY("productMediaGallery")
return o.pageData=r,o}function Ua(e,t){var n
return r(t)?1:i(null===(n=t.video)||void 0===n?void 0:n.preview)&&t.video.preview.height>0?t.video.preview.width/t.video.preview.height:i(t.screenshot)&&t.screenshot.height>0?t.screenshot.width/t.screenshot.height:1}function Ga(e,t,n,r){return Bv.context("createProductPageFromShelfBasedProductPage",()=>{var o,a,c,l
const u=new GY
return u.adamId=t.lockup.adamId,u.bundleId=t.lockup.bundleId,u.icon=t.lockup.icon,u.isEditorsChoice=t.lockup.isEditorsChoice,u.ordinal=t.lockup.ordinal,u.title=t.lockup.title,u.subtitle=t.lockup.subtitle,u.developerTagline=t.lockup.developerTagline,u.editorialTagline=t.lockup.editorialTagline,u.editorialDescription=t.lockup.editorialDescription,u.shortEditorialDescription=t.lockup.shortEditorialDescription,u.rating=t.lockup.rating,u.ratingCount=t.lockup.ratingCount,u.ageRating=t.lockup.ageRating,u.buttonAction=t.lockup.buttonAction,u.offerDisplayProperties=t.lockup.offerDisplayProperties,u.titleOfferDisplayProperties=t.titleOfferDisplayProperties,u.clickAction=t.lockup.clickAction,u.children=t.lockup.children,u.contextMenuData=t.lockup.contextMenuData,u.shelfBackground=t.lockup.shelfBackground,u.searchAd=t.lockup.searchAd,u.searchAdOpportunity=t.lockup.searchAdOpportunity,u.crossLinkTitle=t.lockup.crossLinkTitle,u.crossLinkSubtitle=t.lockup.crossLinkSubtitle,u.tertiaryTitle=t.lockup.tertiaryTitle,u.tertiaryTitleAction=t.lockup.tertiaryTitleAction,u.tertiaryTitleArtwork=t.lockup.tertiaryTitleArtwork,u.flowPreviewActionsConfiguration=t.lockup.flowPreviewActionsConfiguration,u.productDescription=t.lockup.productDescription,u.itemBackground=t.lockup.itemBackground,u.developerAction=t.developerAction,u.ageRatingAction=t.ageRatingAction,u.logoArtwork=t.logoArtwork,u.navigationBarIconArtwork=t.navigationBarIconArtwork,u.uberArtwork=null===(o=t.uber)||void 0===o?void 0:o.artwork,u.uberArtworkForCompactDisplay=null===(a=t.uber)||void 0===a?void 0:a.compactArtwork,u.uberVideo=null===(c=t.uber)||void 0===c?void 0:c.video,u.uberStyle=null===(l=t.uber)||void 0===l?void 0:l.style,u.media=function(e){const t=[]
for(const n of Object.values(e.shelfMapping))if(Na(n)){const e=n.contentsMetadata,r=n.items
t.push(new oz(r,e.platform,e.allPlatforms,e.platformDescription,e.allPlatformsDescription,e.allPlatformsDescriptionPlacement))}return t}(t),i(t.shelfMapping[xH])&&(u.badges=Ku(e,t.shelfMapping[xH])),u.shareAction=t.shareAction,u.pageMetrics=t.pageMetrics,u.pageRenderMetrics=t.pageRenderMetrics,u.isComplete=!t.isIncomplete,u.hasDarkUserInterfaceStyle=t.hasDarkUserInterfaceStyle,u.mediaSectionTitle=e.loc.string(kP),u.expandedOfferDetails=t.expandedOfferDetails,u.regularPriceFormatted=t.regularPriceFormatted,u.theme=t.theme,u.externalVersionIdentifier=t.externalVersionIdentifier,u.updateBuyParams=t.updateBuyParams,u.appPlatforms=t.appPlatforms,u.descriptionHeader=t.descriptionHeader,u.description=t.description,u.banner=t.banner,u.secondaryBanner=t.secondaryBanner,u.fullProductFetchedAction=t.fullProductFetchedAction,u.appPromotionDetailPageFlowAction=t.appPromotionDetailPageFlowAction,u.pageRefreshPolicy=t.pageRefreshPolicy,u.purchasedOrdering=xa(e,$a(0,!0,e.host.platform,n,!1,!1,r)),u.notPurchasedOrdering=xa(e,$a(0,!1,e.host.platform,n,!1,!1,r)),u.shelfMapping=function(e,t){const n={}
for(const r of X1){let o
o=r===bq?ja(e,t):t.shelfMapping[r],s(o)&&(n[r]=o)}return n}(e,t),u.alwaysAllowReviews=t.alwaysAllowReviews,u})}function ja(e,t){const n=t.shelfMapping[gH],r=t.shelfMapping[OU],i=t.shelfMapping[AH],a=t.shelfMapping[EU],c=t.shelfMapping[RU]
if(o(n)&&o(r)&&o(i)&&o(a)&&o(c))return null
let l=null,u=[],d=null,f=null,h=null,p=null,w=null
if(s(null==r?void 0:r.items))for(const e of r.items){const t=e
switch(t.sourceType){case AH:l=t.review
break
case OP:u.push(t.review)}}else u=null
if(s(null==i?void 0:i.items)&&(l=i.items[0]),s(null==a?void 0:a.items)&&(f=a.items[0].action),s(null==c?void 0:c.items)){const e=c.items[0].action
h=e.writeReviewAction,p=e.supportAction}s(null==n?void 0:n.items)&&(d=n.items[0],w=null==n?void 0:n.seeAllAction)
const g=new JY
g.adamId=t.lockup.adamId,g.ratings=d,g.tapToRate=f,g.editorsChoice=l,g.reviews=u,g.supportAction=p,g.writeReviewAction=h,g.alwaysAllowReviews=t.alwaysAllowReviews
const v=new YY(EP)
return v.title=Ma(e),v.items=[g],v.seeAllAction=w,v}async function Va(e,t,n){Bv.beginContext(e)
let r=await M(t())
if(!r.success&&(0,Nv.isSome)(n)&&(r=await M(n(r.error))),Bv.endContext(),r.success)return r.value
throw r.error}function Ha(e,t,n,r,i){if(!oi(e))return null
if(o(t))return null
const s={pageInformation:n,locationTracker:r},a=hi(e,t,null,!1,!1,s,!0,!0,!1,i.allowUnpublishedAppEventPreviews);(0,Nv.isSome)(a.nextAppEventPromotionStartDate)&&(0,Nv.isSome)(null==i?void 0:i.refreshController)&&Br(a.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const c=a.appPromotions
if(0===c.length)return null
const l=qa(0,c,void 0)
return l.isHorizontal=!1,Oh(e,l,{...s,id:"",kind:null,softwareType:null,targetType:KH,title:""}),l}function qa(e,t,n){const r=new YY(vO)
return r.isHorizontal=!0,r.title=n,r.items=t,r}function Wa(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n){const n=r.replace(/\//g,"\\/")
if(new RegExp(n).test(t)){const n=new fY(xF,t)
return n.pageData=new s2(e.bag.metricsTopic),n}}const r=e.bag.webViewRegexStrings
for(const e of r){const n=e.replace(/\//g,"\\/")
if(new RegExp(n).test(t))return new fY(Hx,t)}return new fY(cj,t)}function za(e){switch(e){case NN:return NN
case xk:return xk
default:return Dq}}function Ya(e){return`${e.shelfIdentifier}.${e.slot}`}function Ja(e,t){if(r(e))return null
const n=Ya(t),o=e.tasks[n]
return r(o)?null:(delete e.tasks[n],o)}function Ka(e,t,n){var r
const o=(null==n?void 0:n.meta)||null,i=null===(r=null==o?void 0:o.adDisplayStyle)||void 0===r?void 0:r.slot
return(0,Nv.isSome)(i)?Za(e,t,{shelfIdentifier:u2,slot:i}):Za(e,t,l2)}function Za(e,t,n){const o=null==t?void 0:t.mediaResponse
if((0,Nv.isNothing)(o)||(0,Nv.isSome)(null==t?void 0:t.failureReason))return null
const i={tasks:{}}
return function(e,t){if(r(e))return
const n=Ya(t.positionInfo)
e.tasks[n]=t}(i,{data:yt(e,o),positionInfo:n}),i}function Qa(e,t,n){e.bag.isOnDemandShelfFetchingEnabled&&(0,Uv.isSome)(t)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=tc(e,t,n.remainingItems.length))}function Xa(e,t,n,r,i){(0,Uv.isSome)(t)&&(0,Uv.isSome)(t.url)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=tc(e,t,null!=r?r:n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,i))}function ec(e,t,n,r){n.showingPlaceholders=tc(e,t,n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,r)}function tc(e,t,n,r=!1,i=!1,a=null){if(s(t.items))return!1
if(!function(e,t){switch(t){case dq:case VH:case iB:case sG:case D$:case Tb:case gB:case GF:case QF:case vO:case FN:case pV:case Ub:case eF:return!0
default:return!1}}(0,t.contentType)||r)return!1
const c=function(e,t,n){return t>0?t:(0,Uv.isSome)(n)&&!ji(n)?0:e.client.isPad?15:6}(e,n,a),l=new Array(c)
for(let e=0;e<c;e+=1)l[e]=new c2
if(o(l))return!1
const u=function(e,t){if((0,Uv.isSome)(t.rowsPerColumn))return t.rowsPerColumn
switch(t.contentType){case dq:return 3
case VH:return 2
case iB:return 1
case D$:return null
default:return 1}}(0,t)
return(0,Uv.isSome)(u)&&(t.rowsPerColumn=u),t.placeholderContentType=t.contentType,t.contentType=dN,t.items=l,s(i)&&(t.presentationHints={...t.presentationHints,isAppleArcadeContext:i}),t.isHidden=!1,!0}function nc(e){return e.contentType===dN}function rc(e){const t=[Tq,wq,zV,JV]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}function oc(e){const{platform:t,id:n,...r}=e
return{...r,platform:ut(t),id:dt(n),$kind:f2}}async function ic(e,t,n){var r
const o=Object.keys(n),i=o.map(async e=>await n[e]),s=await async function(e){const t=await Promise.all(e.map(async e=>{try{const t=await e
return function(e){return null!==e&&typeof e===Zj&&JW in e}(t)?t:E(t)}catch(e){return R(e instanceof Error?e:new Error(String(e)))}})),n=[]
if(t.forEach(e=>{e.success||n.push(e.error)}),n.length>0)throw 1===n.length?n[0]:new KW(n)
return t}([t,...i]),a=s[0],c=a.value
if(!a.success||(0,Nv.isNothing)(c))throw null!==(r=a.error)&&void 0!==r?r:new Error("Unknown primaryPageData error")
const l={},u=s.slice(1)
for(const[t,n]of u.entries()){const r=o[t]
n.success?l[r]=n.value:(l[r]=null,e.console.log(`Builder - failed to fetch additionalPageRequirement ${r}, reason: ${n.error}`))}return{primaryPageData:c,additionalData:l}}async function sc(e,t,n,o,i){const s=n(e,t,i)
if(!s)return await Promise.resolve({originalData:t})
const a=Array.from(s),c=[]
for(const t of a){const n=o(e,t)
if(r(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}function ac(e,t,n){if(o(t))return
const r=function(e){return f(e,"meta.metrics.clusterId")}(n)
o(r)||function(e,t,n){const r=lc(t)
e.storage.storeString(r,n)}(e,t,r)}function cc(e,t){return o(t)?null:function(e,t){const n=lc(t)
return e.storage.retrieveString(n)}(e,t)}function lc(e){return e+"-cohort-id"}function uc(e,t,n=[],r){const o={exclusions:null==r?void 0:r.exclusions},i=n.slice()
return(null==r?void 0:r.optionalQuery)&&i.push(...r.optionalQuery.map(e=>`${e}?`)),{routes(n){var s
return[{rules:[{...o,path:t,query:[`${DW.language}?`,...i]},{...o,path:`/{${yW.storeFront}}${t}`,query:[`${DW.language}?`,...i]},...null!==(s=null==r?void 0:r.extraRules)&&void 0!==s?s:[]],handler(t,r){const{[yW.storeFront]:o,[DW.language]:i,...s}=r
return e({...s,..._i(n,{storefront:o,language:i})})}}]},makeCanonicalUrl(e,o){const i=function(e,t,n){const r=new km.URL("https://apps.apple.com"),{storefront:o,language:i}=function(e,t){return e.locale.deriveLocaleForUrl(t)}(e,n)
return r.path(o),r.path(t.substr(1)),(0,Nv.isSome)(i)&&r.param("l",i),r}(e,t,o),s=i.pathComponents()
for(const[e,t]of s.entries())if(t.startsWith("{")&&t.endsWith("}")){const n=t.substring(1,t.length-1)
s[e]=o[n]}i.set(eV,"/"+s.join("/"))
const a=n.slice()
a.sort((e,t)=>e.localeCompare(t))
for(const e of a){if(!(e in o))throw new Error(`expected queryParmeters to contain: ${e}`)
const t=o[e]
i.param(e,t)}if(null==r?void 0:r.optionalQuery){const e=r.optionalQuery.slice()
e.sort((e,t)=>e.localeCompare(t)),e.forEach(e=>{const t=o[e]
t&&i.param(e,t)})}return i.toString()}}}function dc(e,t,n){const r=new YY(n||d2)
r.isHorizontal=!1,r.items=xb
const o=new ZY([r])
return o.isIncomplete=!0,o.title=t,o}function fc(e,t){if(!(0,Uv.isNothing)(t))switch(t){case S2:return b2
case b2:return S2
default:return}}async function hc(e,t,n,r=null){const o=function(e,t,n,r=null,o=e.host.clientIdentifier){const i=[zV,JV,uH]
e.bag.enableUpdatedAgeRatings&&i.push(iq),e.appleSilicon.isSupportEnabled&&i.push(hH)
const a=new Jz(e).forType(VF).addingQuery(lH,t).includingAttributes(i).addingQuery(HF,Kq).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
return s(n)&&a.addingQuery(DW.charts,n),o===Vz?a.addingContext(zq):o===Hz&&a.addingContext(qH),e.appleSilicon.isSupportEnabled&&a.includingAdditionalPlatforms([mq,gq]),(0,Uv.isSome)(r)&&a.addingQuery(DW.ages,r),a}(e,t,n,r)
return o.withLimit(200),o.enablingFeature("newChartsElements"),await Ln(e,o)}async function pc(e,t,n){let r
return r=e.host.clientIdentifier===Hz||function(e){return s(e)&&(-1!==e.indexOf(P2)||-1!==e.indexOf(C2))}(t)?Promise.resolve({}):Ln(e,An(e,n)).catch(()=>{}),await r}function wc(e,t){var n
let r=e.loc.string(cb)
return(0,Nv.isSome)(t.title)?r=`${t.title}, ${r}`:(0,Nv.isSome)(null===(n=t.header)||void 0===n?void 0:n.title)&&(r=`${t.header.title}, ${r}`),{label:r,roleDescription:e.loc.string(lb)}}function gc(e,t,n){const r=s(n)?[...n]:[]
return r.push(`${DW.groupingFeaturedContentId}=${e}`),s(t)&&r.push(`${DW.nativeGroupingShelfId}=${t}`),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:r}}function vc(e,t){const n=[]
for(const r of e)n.push(gc(r,null,t))
return n}function mc(e,t){if([Kj,OV,LG].includes(e.host.platform)&&ht(t)){const e={app:"com.apple.gamecenter.from.browse",kind:{name:hV}}
return t.referrerData=e,new MJ([new _2(e),t])}return t}function yc(e,t,n,r){const o={...n,shouldFilter:!H(t,M$),chartUrl:j(t,TG),chartIdentifier:j(t,WH),roomRelationshipData:pe(e,t,"room")}
return Vi(o.featuredContentId)?(o.seeAllUrl=function(e,t,n){const r=j(t,TG),o=new qW(r),i=j(t,WH)
s(i)&&o.param(DW.chart,i)
const a=function(e,t,n){var r
const o=null!==(r=(null==n?void 0:n.editorialCharts.length)>1)&&void 0!==r&&r,i=null==n?void 0:n.editorialCharts.map(e=>e.type.toString()).join(",")
if((0,Uv.isSome)(i)&&i.includes(t)&&o)return i
const s=fc(0,t)
return void 0===s?t:[t,s].join(",")}(0,i,n)
return s(a)&&o.param(DW.charts,a),o.toString()}(0,t,r.chartSet),o.showOrdinals=!0,o.shouldFilter=!1):s(o.roomRelationshipData)&&(o.seeAllUrl=Fi(e,o.roomRelationshipData.href)),o.shelfStyle=function(e,t,n,r){const o=n.featuredContentId
if(o===h0||o===YX||o===s0||function(e){return T0.has(e)}(o)){let e=j(t,dH)
return e||(e=o===jX||o===VX?uq:o===s0||o===h0?pU:LH),`${e}Lockup`}if(o===r0)return uM
if(o===t0)return QF
if(o===UX||o===GX||o===n0||o===JX)return GF
if(Vi(o))return dq
if(o===c0)return gB
switch(r.shelves.length%3){case 0:return dq
case 1:return VH
default:return iB}}(0,t,o,r),o.clientIdentifierOverride=Fr(e,t),o}function Ac(e,t,n,a){const c=(l=t.featuredContentId,m0.has(l)?Wv.ChartsMac:Wv.All)
var l
let u,d,h=[]
if(s(n.shelfContents)){const o=function(e,t,n,o){var s
const a=Ja(t,n)
if(r(a))return null
const c=a.data,l=Tc(e,c,o)
return i(l)?o.includedAdAdamIds=[c.id]:null===(s=o.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,n.shelfIdentifier,n.slot),l}(e,null==a?void 0:a.adStitcher,l2,t)
o&&ft(o)&&(h.push(o),bh(t.metricsLocationTracker),t.ordinalIndex++,n.shelfContents=n.shelfContents.filter(e=>e.id!==o.adamId))}for(const o of n.shelfContents){if(o.type===Vq)return null
if(t.featuredContentId===h0&&o.type===Nq){u=o
continue}if(r(o.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}if(at(e,o,c))continue
const n=Tc(e,o,t)
n&&(h.push(n),bh(t.metricsLocationTracker),t.ordinalIndex++)}!Vi(t.featuredContentId)||qi(t.featuredContentId)||Hi(t.featuredContentId)||(h=function(e,t){if(!e)return null
const n=e.length,r=n%3
return n>=3?e.slice(0,n-r):e}(h)),delete t.maxItemCount,d=Hi(t.featuredContentId)?oo(e,t.title):{eyebrow:t.eyebrow,eyebrowArtwork:t.eyebrowArtwork,title:t.title,titleArtwork:t.titleArtwork,subtitle:t.subtitle,configuration:t.shelfHeaderConfiguration}
const w=new YY(t.shelfStyle)
let g
if(w.isHorizontal=!0,w.items=h,w.shouldFilterApps=t.shouldFilter,Hi(t.featuredContentId)&&(w.footerTitle=e.loc.string(_$),w.footerAction=ro({objectGraph:e,metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker}),w.footerStyle={$kind:_H,bundleID:gN,width:16,height:16},w.items.forEach((t,n)=>{(0,Uv.isSome)(t)&&ft(t)&&(t.clickAction=mc(e,t.clickAction))})),t.featuredContentId===h0?function(e,t,n,r,o,i,a){if((0,Uv.isNothing)(i)&&(i=pe(e,t.featuredContentData,jO)),r.configuration.includeTrailingArtwork=!0,!W(i)){const e=j(t.featuredContentData,Zq)
return r.eyebrow=e,r.title="",n.footerTitle="",t.isDeferring=!0,void t.remainingItems.push(i)}const c=j(t.featuredContentData,Zq)
r.eyebrow=c
const l=B(i,dV),u=f(l,Zq)
r.title=u,Ah(t.metricsLocationTracker).name=u,s(t.originalPlaceholderShelfImpressionMetrics)&&(t.originalPlaceholderShelfImpressionMetrics.fields.name=u)
const d=B(i,Tq)
if((0,Uv.isNothing)(d))return void(n.isHidden=!0)
const h=p(d,"storyBackgroundStatic16x9"),w={useCase:n6.CategoryBreakoutShelf,withJoeColorPlaceholder:!0},g=ts(e,h,w),v=be(g.backgroundColor)?kq:QH
n.background={type:Hq,artwork:g,style:v},o.forEach((t,n)=>{(0,Uv.isSome)(t)&&ft(t)&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,uj,v),t.subtitleTextFilter=LA,e.clientCapabilities.isNotEnabled(Mb)&&(t.redownloadButtonTint=Se(JH)))})
const m=p(d,qE)
if((0,Uv.isNothing)(m))return void(n.isHidden=!0)
const y={contentMode:Hv.scaleAspectFit,useCase:n6.GroupingBrick},A=ts(e,m,y)
r.trailingArtwork=A
const T=f(i.attributes,Rq),b=f(i.attributes,a$),S={id:i.id,idType:lq,targetType:Qq,actionType:Xq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
if((0,Uv.isSome)(T)){n.footerTitle=b
const t=e.required(n3).fetchFlowPage(T),r=new fY(t)
r.title=b,r.pageUrl=T,Qs(e,r,S),n.footerAction=r}else{const r={targetType:Qq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},o=os(e,i,t,!1,null,r,a);(0,Uv.isSome)(o.action)&&(o.action.actionMetrics.clearAll(),o.action.title=null!=b?b:f(l,"callToAction"),Qs(e,o.action,S),n.footerAction=o.action,n.footerTitle=o.action.title)}}(e,t,w,d,h,u,a):e.clientCapabilities.isNotEnabled(Mb)&&w.items.forEach((e,t)=>{(0,Uv.isSome)(e)&&ft(e)&&(e.redownloadButtonTint=Se(pL))}),w&&o(w.items)&&t.isFirstRender&&ec(e,w,t,t.featuredContentId),Vi(t.featuredContentId))g=new fY(eG)
else if(g=new fY(eW),!nc(w)){const e=function(e,t){if(!t)return null
switch(t){case WF:case uM:return t
default:return null}}(0,t.shelfStyle)
g.pageData=dc(0,t.title,e)}g.pageUrl=t.seeAllUrl,g.title=e.loc.string(KV),g.referrerUrl=t.metricsPageInformation.pageUrl,Xs(e,g,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})
const v=function(e,t,n){return n.featuredContentId!==h0&&!qi(n.featuredContentId)&&!Hi(n.featuredContentId)&&n.featuredContentId!==c0}(0,w.items,t),m=i(g.pageUrl)||i(g.pageData)
if(v&&m&&ds(e,d,g),t.shelfStyle===QF||t.shelfStyle===GF){const e=j(t.featuredContentData,"suppressTagline")!==XH
r(w.presentationHints)?w.presentationHints={showSupplementaryText:e}:w.presentationHints={...w.presentationHints,showSupplementaryText:e}}return t.shelfStyle,w.header=d,w.url=Ki(0,w,t),w}function Tc(e,t,n){if(o(t))return null
let a
n.showOrdinals&&(a=e.loc.decimal(n.ordinalIndex))
let c,l=null
!i(n.shelfBackground)||n.shelfBackground.type!==cV&&n.shelfBackground.type!==WL||(l=JH),s(n)&&(c=n.clientIdentifierOverride)
const u={ordinal:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},clientIdentifierOverride:c,artworkUseCase:Hd(0,n.shelfStyle),offerStyle:l,canDisplayArcadeOfferButton:Yf(0,n.shelfStyle),isContainedInPreorderExclusiveShelf:n.featuredContentId===c0,shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ)&&n.isArcadePage}
let d
switch(n.shelfStyle){case GF:d=function(e,t,n,r){return Bv.context("trailersLockupFromData",()=>{const o=new yY
return function(e,t,n,r,o){t&&Bv.context("copyDataIntoTrailersLockup",()=>{fd(e,t,n,o),n.trailers=ef(e,t,r,o.metricsOptions,n.adamId)})}(e,t,o,r,n),o})}(e,t,u,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
break
case QF:d=bd(e,t,u)
break
case gB:d=Sd(e,t,u)
break
case WF:case uM:d=Td(e,t,u)
break
case"smallImageLockup":case lU:case O$:d=Cd(e,t,u,om.EditorialLockupLarge)
break
default:d=Ad(e,t,u)}return r(d)||!d.isValid()?null:d}function bc(e,t,n=!1){const r=Ec(e,t),o=e.client.isPhone
let i=o?hb:FE
n&&(i="topShelf")
const a=p(r,i)
let c=null,l=null
return s(a)&&(c=qd(e,a,{withJoeColorPlaceholder:!0,useCase:n6.ArcadeLargeBreakout}),s(c)&&(c.crop=o?"oa":n?"ta":"ob",l=c.backgroundColor)),{artwork:c,artworkData:a,backgroundColor:l}}function Sc(e,t,n=!1,r=!1){const o=function(e,t){switch(t.type){case Nq:return B(t,wq)
case aV:return B(t,SO)
default:return se(t,nt(e,t),SO)}}(e,t),i=e.client.isPhone||r,a=i?"breakoutVideo9x16":"breakoutVideo16x9",c=p(o,i?"sizzleVideo9x16":"sizzleVideo16x9")||p(o,a)
let l=null,u=null,d=null
if(s(c)){d=p(c,EG)
const t=qd(e,d,{withJoeColorPlaceholder:!0,useCase:n6.ArcadeLargeBreakout})
s(t)&&(t.crop="sr",u=t.backgroundColor)
const r=f(c,jH)
s(t)&&(null==r?void 0:r.length)>0&&(l=new nz(r,t,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:n},autoPlayPlaybackControls:{}}))}return{video:l,artworkData:d,backgroundColor:u}}function Pc(e,t,n=!0,r,o){const i=Sc(e,t),s=bc(e,t),a=i.backgroundColor||s.backgroundColor
return Ic(e,t,0,o),(t.type===aV?u(Oc(0,t),"displayMaterial"):H(t,RA))&&n?DA:Cc(0,a)}function Cc(e,t){return t?be(t,50)?kq:QH:kq}function Ic(e,t,n,r){if(e.client.isPhone||r)return fq
const o=t.type===aV?f(Oc(0,t),"textPosition"):j(t,DO)
if((0,Nv.isNothing)(o)||0===o.length)return Uq
switch(o.toLowerCase()){case _O:return Uq
case fq:return fq
case LO:return Sj
default:return Uq}}function kc(e,t,n,r=!1){switch(t){case Uq:case Sj:return Uq
case fq:return r||n.type===aV?fq:function(e,t){var n
switch((null!==(n=j(t,DO))&&void 0!==n?n:"").toLowerCase()){case _O:return Uq
case fq:return fq
case LO:return Sj
default:return Uq}}(0,n)
default:return Uq}}function Oc(e,t){return t.type!==aV?null:B(t,"display.templateParameters")}function Ec(e,t){switch(t.type){case Nq:return B(t,Tq)
case aV:return B(t,AA)
default:return se(t,nt(e,t),Tq)}}function Rc(e,t){return t.type===aV?f(gr(0,t),"callToActionLabel"):j(t,a$)}function Dc(e,t){const n=s(B(t,yq)),r=H(t,ZB)
return!n&&!r}function _c(e,t){const n=B(t,yq),o=s(n),i=(j(t,fH),H(t,ZB)),a=pe(e,t,aH)
if(!o&&!i&&!W(a))return null
let c=null
if(c=o?f(n,Rq):j(i?t:a,Rq),r(c))return null
let l=null
if(o&&f(n,c$)===yL)l=new PY(c)
else if(e.isAvailable(n3)){const t=e.required(n3).fetchFlowPage(c),n=new fY(t)
n.pageUrl=c,t===oH&&(n.pageData=Ju(e,a)),l=n}return l&&(l.title=Rc(0,t)),l}function Lc(e,t,n=!1){if(o(t))return null
let r=null
const i=Se(JH),s=Se(MO),a=ye(f(t,HG)),c=l(t,_A).map(e=>ye(e)),u=Cc(0,a)
if(2===c.length){r=new u4("horizontalGradient")
const e=c[0],t=c[1]
r.gradientStartColor=Pe(e,e),r.gradientEndColor=Pe(t,t),r.filter=LA,n||(r.accessoryColor=r.gradientEndColor)}else r=new u4(cV),r.color=u===kq?i:s,n||(r.accessoryColor=r.color),r.isFallbackStyle=!0
return r}function Mc(e,t,n,r=JH){if(o(t)||o(t.attributes))return null
const s=Sc(e,t,!0),a=bc(e,t),c=s.backgroundColor||a.backgroundColor,l=Ic(e,t,0,!0),u=Pc(e,t,!1,0,!0)!==DA&&!0,d=Fc(e,t,0,!1,u,mL)
let h=null
"tv"!==e.client.deviceType&&(h=d.description,d.description=null)
const p=function(e,t){const n=Oc(0,t),r=f(n,"ctaButtonBackgroundColor"),o=f(n,"ctaButtonTextColor")
return i(r)&&i(o)?{type:EO,fillColor:ye(r),textColor:ye(o)}:{type:j_,fillColor:null,textColor:null}}(0,t),w=new SY(qq,e.bag.arcadeAppAdamId,null,r,null,qq,p,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId),g=new T4(d,w,{backgroundColor:c,wantsMaterialDetailBackground:!1,wantsBlur:u,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:l},null,h,a.artwork,s.video),v=Lh(e,t,g.details.title,{...n,targetType:XU})
return v.displaysArcadeUpsell=!0,Oh(e,g,v),gh(e,v,g.details.title),g.offerButtonAction=Nc(e,t,pt(FB),n),mh(n.locationTracker),g}function xc(e,t){return Rc(0,t)}function $c(e,t){return j(t,vH)}function Fc(e,t,n,r,o,i){let s=null
switch(i){case mL:s={type:mL}
break
case UV:const e=j(t,qB)
s=(null==e?void 0:e.length)>0?{type:UV,title:e}:{type:rq}
break
default:s={type:rq}}let a=Pc(e,t,r,0,!0)
const c=Ic(e,t,0,!0)
return o&&(a=kq),new b4(function(e,t){return j(t,Pq)}(0,t),$c(0,t),s,null,a,kc(0,c,t,!0))}function Nc(e,t,n,r){const o={marketingItemData:t},i=n===pt(FB)&&e.bag.arcadeDownloadPackPostSubscribeTrigger&&ar(e,e.bag.arcadeDownloadPackRolloutRate)
return Bc(e,o,xc(0,t),r,i)}function Bc(e,t,n,r,o){const s=t.marketingItemData
if(!i(s))return null
const a=gr(0,s),c=f(a,fH)===yq,u=f(a,Rq)
if(c&&u){const t=function(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n)if(new RegExp(r).test(t)){const n=new fY(xF,t)
return n.pageData=new s2(e.bag.metricsTopic),n}const r=e.bag.financeUIRegexStrings
for(const e of r)if(new RegExp(e).test(t))return new fY(cj,t)
const o=e.bag.webViewRegexStrings
for(const e of o)if(new RegExp(e).test(t))return new fY(Hx,t)
return new PY(t,!1)}(e,u),o={id:e.bag.arcadeAppAdamId,actionType:s$,actionContext:nq,contextualAdamId:e.bag.arcadeAppAdamId,offerType:OO,targetType:Qq,mercuryMetricsData:fh(0,s),...r}
return t.title=n,Qs(e,t,o),t}{const t=function(e,t,n,r){const o=gr(0,t),s=f(o,VG),a=f(o,lj)
if(!i(s)||!i(a))return null
const c=l(o,"serviceTypes").length>1&&e.bag.aristotleParentAppAdamId?e.bag.aristotleParentAppAdamId:e.bag.arcadeAppAdamId,u=new S4(s,c,{buyParams:a,productIdentifier:s,pageInformation:r.pageInformation},null,null),d={id:c,actionType:s$,targetType:Qq,subscriptionSKU:s,actionContext:nq,contextualAdamId:c,actionDetails:{buyParams:a},offerType:OO,mercuryMetricsData:fh(0,t),...r}
return u.title=n,Qs(e,u,d),u}(e,s,n,r)
if(o){const e=new fY(tB),r=NN
e.pageData=r,e.presentationContext=Mj
const o=new rZ(void 0,void 0,e,void 0),i=new MJ([t,o])
return i.title=n,i}return t}}function Uc(e,t,n){switch(n){case pV:return k4.has(t)
case hN:return C4.has(t)
case yB:return I4.has(t)
default:return!1}}function Gc(e,t,n,o,s,a){const c=new bZ(o.metricsPageInformation,o.metricsLocationTracker)
null==a&&((a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}).isHorizontalShelfContext=!0),e.client.deviceType!==zq&&(a.coercedCollectionTodayCardDisplayStyle=wm.Grid)
const l=Io(t,a.coercedCollectionTodayCardDisplayStyle)
if(a.prevailingCropCodes=function(e,t,n){switch(t){case pV:return null
case hN:return{defaultCrop:"el"}
case yB:return n===wm.Video?{defaultCrop:"sr"}:{defaultCrop:"ek"}
default:return null}}(0,n,l),a.horizontalCardContentType=n,!i(t.attributes))return s&&s(t),null
const u=bo(e,t,a,c,o.augmentingData)
if(r(u))return null
{u.collapsedHeading=xo(0,u),u.inlineDescription=Hc(e,u,t),u.inlineDescription===u.collapsedHeading&&(u.inlineDescription=null)
const n=u.media
n&&n.kind===aj&&(u.title=null)}if(n===yB){const e=u.heroMedia
if(!i(e)||0===e.artworks.length&&0===e.videos.length)return null}return Uc(0,u.media.kind,n)&&i(o.filterOutMediaCardKinds)&&o.filterOutMediaCardKinds.has(u.media.kind)?null:(function(e,t,n){if("tv"!==e.client.deviceType||!H(n,l_))return
const r=new PY("com.apple.Arcade://")
t.clickAction=r}(e,u,t),u)}function jc(e,t,n,r,s,a,c){if(!i(n))return null
const l=new YY(n)
return r&&(l.title=r),l.subtitle=s,l.isHorizontal=!0,l.items=n===hU?[qc(e,t,a.metricsPageInformation,a.metricsLocationTracker,()=>!0,c)]:function(e,t,n,r,i,s){const a=[]
for(const s of t){const t=Gc(e,s,n,r,i,void 0)
o(t)||(a.push(t),bh(r.metricsLocationTracker))}return a}(e,t,n,a,c),l}function Vc(e,t,n,r,s,a){const c=new YY(eF)
n&&(c.title=n),c.subtitle=r,c.isHorizontal=!0
const l=[],u={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
u.metricsDisplayStyle=gm.SmallCard,u.alwaysShowBadgeInSmallCards=!0,u.alwaysUseMaterialBlur=!0
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=bo(e,n,u,s)
o(t)||(l.push(t),bh(s.locationTracker))}return c.items=l,c}function Hc(e,t,n){{let o=Gf(e,n,Zq)
return i(o)&&(o=o.replace(/\n/g," ")),t.media.kind===aj&&$r(r=t.overlay)&&r[tW]===vy&&i(t.overlay.lockup)?t.overlay.lockup.title:o}var r}function qc(e,t,n,o,s,a){return Bv.context("todayCardsFromPlatformData",()=>{if(!t)return null
const c={useOTDTextStyle:!1,enableFullScreenVideo:!1,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
c.coercedCollectionTodayCardDisplayStyle=wm.Grid,c.prevailingCropCodes={defaultCrop:"fo"},c.isHorizontalShelfContext=!0
const l=new bZ(n,o),u=[]
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=bo(e,n,c,l)
if(!r(t)&&s(t)){t.collapsedHeading=xo(0,t),t.inlineDescription=Hc(e,t,n),t.inlineDescription===t.collapsedHeading&&(t.inlineDescription=null)
const r=t.media
r&&r.kind===aj&&(t.title=null),u.push(t)}}return u.length?new P4(u):null})}function Wc(e,t){const n=new Set,r=yt(e,t),o=we(r,aN)
for(const t of o){const o=Yc(e,t,r)
if(s(o))for(const e of o)n.add(e)}return n}function zc(e,t){let n
return t===i_&&(n=ao(e,pt(G_))),t===s_&&(n=so(e,10)),r(n)?null:Ln(e,n).catch(()=>null)}function Yc(e,t,n){if(j(t,XC)!==a_)return null
const o=j(t,eI),i=r(co(e,n)),s=[]
return o===tI&&(s.push(s_),i&&s.push(i_)),s}function Jc(e,t,n,a,c){return Bv.catchingContext(`module: ${a.module}`,()=>{var c
const l=[]
switch(a.module){case"Header":a.titleForNextShelf=j(t,lG)
break
case"TextBlock":{const e=function(e,t,n){const r=j(t,lG)
if(!r)return null
const o=new AX(r,sV,cq)
Xc(0,o,n)
const i=new YY(Pj)
return i.items=[o],i}(0,t,a);(0,Nv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"CollectionLockup":{const n=function(e,t,n){const r=H(t,"showOrdinals"),o="OrdinalDesc"===j(t,"collectionLockupDisplayType")?eS:"ascending",i=j(t,"collectionLockupSize")
let s
if(n.subStyle=i,i)switch(i){case cI:s=iB
break
case aI:s=VH
break
default:s=dq}const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Hd(0,s),canDisplayArcadeOfferButton:Yf(0,s)},c=we(t,Jq)
if((0,Nv.isNothing)(c))return null
let l=[]
if(l=Rd(e,c,{includeOrdinals:r,ordinalDirection:o,lockupOptions:a}),!l||0===l.length)return null
const u=new YY(s)
return u.items=l,u}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case nI:{const n=function(e,t,n){const r=j(t,"inlineImageDisplayType"),o=qd(e,B(t,Hq),{useCase:n6.ArticleImage,allowingTransparency:r===pF&&!0,withJoeColorPlaceholder:!1})
if(!o)return null
const i=new h4(o,!1,sV)
i.caption=j(t,lG),n.subStyle=r,r&&("BoundingBox"===r?(i.isFullWidth=!1,i.hasRoundedCorners=!0):(i.isFullWidth=!0,i.hasRoundedCorners=!1)),Xc(0,i,n)
const s=new YY(c_)
return s.items=[i],s}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case rI:{const n=function(e,t,n){const r=Qc(e,t)
if(!r)return null
let o=null
const a=we(t,Vq)
if(s(a)&&(o=Ha(e,a,n.metricsPageInformation,n.metricsLocationTracker,n),i(o)))return o
const c=j(t,"appLockupSize")
let l
n.subStyle=c
let u=!1
if(c)switch(c){case sI:l=dq,u=!0
break
case aI:l=VH,u=!0
break
default:l=QO}const d=na(0,t)
if(u){const t=new YY(l)
let i
if(i=Ad(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:d,artworkUseCase:Hd(0,l)}),(0,Nv.isNothing)(i))return null
t.items=[i],o=t}else o=function(e,t,n){const r=new YY(QO),o="tv"!==e.client.deviceType,i=Qc(e,t),s=na(0,t),a=Ad(e,i,{offerStyle:wj,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:n6.LockupIconSmall}),c=new g4(uq,a)
c.description=wd(e,i)
let l=null
switch(j(t,"appLockupVideo")){case"AppTrailer":{const t=nf(e,i)
t&&t.length>0&&(l=t[0])
break}}return l&&(po(e,l,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId}),c.video=l),o&&(r.background={type:cV,color:E4}),r.items=[c],r}(e,t,n)
return o}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TipBlock":{const n=function(e,t,n){const r=qd(e,B(t,Hq),{useCase:n6.ArticleImage})
if(!r)return null
const o=j(t,lG),i=j(t,"tipNumber"),s=new h4(r,!1,sV)
s.isFullWidth=!1,s.hasRoundedCorners=!0,s.caption=o,s.ordinal=i,Xc(0,s,n)
const a=new YY(c_)
return a.items=[s],a}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"PullQuote":{const n=function(e,t,n){const r=j(t,iI),o=j(t,"quoteAttribution"),i=qd(e,B(t,Hq),{useCase:n6.ArticleImage}),s=j(t,"pullQuoteDisplayType")===pF,a=new p4(r,o,i,s)
Xc(0,a,n)
const c=new YY(iI)
return c.items=[a],c}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"HorizontalRule":{const e=function(e,t,n){const r=j(t,"lineStyle"),i=j(t,dH)===pF
let s=Se("defaultLine")
const a=B(t,"customColor"),c=ye(f(a,"lightMode")),l=ye(f(a,"darkMode"))
o(c)||o(l)||(s=Pe(c,l))
const u=new w4(r,s,i),d=new YY("horizontalRule")
return d.items=[u],d}(0,t);(0,Nv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case oI:{const n=function(e,t,n){const r=qd(e,B(t,"video.previewFrame"),{useCase:n6.ArticleImage})
if(!r)return null
const o=j(t,"video.video")
if(!o)return null
const i=j(t,"inlineVideoDisplayType")===pF,s=new nz(o,r,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
po(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const a=new K1(s,i,sV)
a.caption=j(t,lG),Xc(0,a,n)
const c=new YY(wx)
return c.items=[a],c}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppMedia":{const n=function(e,t,n){const o=Qc(e,t)
if(!o)return null
const s=j(t,"appMediaOption"),a=j(t,"appMediaPlatform")
switch(n.subStyle=s,s){case hy:{let t=null
if(t=new YY(Lq),r(a)){const n=rf(e,o,n6.ArticleScreenshots)
n&&n.length>0&&(t.items=[n[0]])}else{const n=function(e,t){switch(t){case Yb:return zq
case Kj:return e.client.isPad?$q:jq
case LG:return"tv"
case Jb:return qH
case"visionOS":return Fq
default:return null}}(e,a)
if(n){const r=rf(e,o,n6.ArticleScreenshots,[n])
r&&r.length&&(t.items=[r[0]])}}return i(t)&&0===t.items.length?null:t}case"AppTrailers":const t=new YY(wx),s=nf(e,o)
if(s&&s.length>0){const r=s[0]
po(e,r,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const o=new K1(r,!1,kV,null,null,!0)
return t.items=[o],t}return null
default:return null}}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"LinkBlock":{const r=function(e,t,n,r){const o=j(t,Rq)
if(!o)return null
const i=new qW(o),s=j(t,"urlTitle")
let a=j(t,lG)
a||(a=i.host)
const c=[lI,MU,"music.apple.com","books.apple.com","podcasts.apple.com","watch-app.cdn-apple.com","tv.apple.com"]
let l=!1
for(const e of c)i.host.endsWith(e)&&(l=!0)
e.bag.disabledRichLinkPresentationEditorialItemIds.includes(r.id)&&(l=!1)
const u=e.required(n3).fetchFlowPage(o)
!(0,Nv.isSome)(u)||u!==cq&&u!==xF||(i.protocol="itms-appss://")
const d=new PY(i.build())
Qs(e,d,{targetType:yq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const f=new m4(s,a,d,l)
Xc(0,f,n)
const h=new YY(o_)
return h.items=[f],h}(e,t,a,n);(0,Nv.isSome)(r)&&(l.push(r),a.hasFocusableElements=!0)
break}case"TextList":{const e=function(e,t,n){const r=G(t,lG)
if(!r.length)return null
const o=j(t,"textListDisplayType")
n.subStyle=o
let i,s=!1
s="Bulleted"===o,i=s?"<ul>":"<ol>"
for(const e of r){const t=JSON.stringify(e)
i=`${i}<li>${JSON.parse(t)}</li>`}i=s?`${i}</ul>`:`${i}</ol>`
const a=new AX(i,sV,cq)
Xc(0,a,n)
const c=new YY(Pj)
return c.items=[a],c}(0,t,a);(0,Nv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"IAPLockup":{const n=function(e,t,n){const r=Qc(e,t)
if(!r)return null
const o=Td(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:n6.LockupIconSmall})
if(!o)return null
const i=new v4(o),s=new YY("inAppPurchaseShowcase")
return s.background={type:cV,color:O4},s.items=[i],s}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case a_:{const o=function(e,t,n,o){const a=j(t,eI)
o.subStyle=a
let c=null
switch(a){case"OSUpgrade":c=function(e,t,n){const r=e.client.deviceType
if(r!==Yq)return null
const o=fr(r)
if(null===o)return null
const i=new PY(o)
Qs(e,i,{targetType:yq,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const s=e.loc.string("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),a=new y4(s,i)
Xc(0,a,n)
const c=new YY("clientControlButton")
return c.items=[a],c}(e,0,o)
break
case tI:c=function(e,t,n,o){let a=co(e,n)
if(!a&&o.additionalData&&(a=lo(0,o.additionalData.get(i_))),!i(a))return null
const c={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},l=no(0,o.metricsPageInformation,o.metricsLocationTracker,!1)
let u
l.title=e.loc.string(bB,SB)
const d=Rc(0,a.marketingItemData)
s(d)?(u=Nc(e,a.marketingItemData,pt(G_),c),i(u)&&(u.title=d)):(u=no(0,o.metricsPageInformation,o.metricsLocationTracker,!1),u.title=e.loc.string(bB,SB))
const f=new A4(u,l),h=$c(0,a.marketingItemData)
f.unsubscribedDescription=h
const p=new SY(qq,e.bag.arcadeAppAdamId,null,wj,null,kq,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
p.titles[gU]=e.loc.string(bB,SB),f.offerDisplayProperties=p,Oh(e,f,{...c,targetType:BL,title:d,id:t.id,kind:BL,softwareType:null,displaysArcadeUpsell:!0})
{if(r(o.additionalData))return null
const t=o.additionalData.get(s_)
if(s(t)){const n={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},r=bt(t)
f.iconArtworks=zd(e,r,n,{useCase:n6.LockupIconMedium})}}const w=new YY(BL)
return w.items=[f],w.background={type:cV,color:R4},w}(e,t,n,o)}return c}(e,t,n,a);(0,Nv.isSome)(o)&&(l.push(o),a.hasFocusableElements=!0)
break}case"StoryList":{const n=function(e,t,n,r){const o=we(t,Jq)
if(!o)return null
const i=j(t,Zq),s=j(t,gj)
let a=null
if(e.featureFlags.isEnabled(pJ))a=Vc(e,o,i,s,new bZ(n.metricsPageInformation,n.metricsLocationTracker))
else{const t=!0,r=t?pV:hU
a=jc(e,o,r,i,s,n,null),t&&Array.isArray(a.items)&&(a.items=a.items.filter(e=>!Bt(e)||Uc(0,e.media.kind,r)))}return a}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppEventLockup":{const n=function(e,t,n){const r=Qc(e,t)
return r?Ha(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n):null}(e,t,a);(0,Nv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"OfferItemLockup":{const n=function(e,t,n){const r=pe(e,t,Jq)
if(o(r))return null
const i=j(t,lG),s=new AX(i,sV,cq),a=new YY(Pj)
return a.items=[s],[a,Ha(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n)]}(e,t,a);(0,Nv.isSome)(n)&&(l.push(...n),a.hasFocusableElements=!0)
break}default:e.console.log(`Unknown module: ${a.module}`)}for(const e of l){const t=null!==(c=e.presentationHints)&&void 0!==c?c:{}
e.presentationHints={...t,isArticleContext:!0}}return l})}function Kc(e,t){const n=we(t,wH)
if(1!==n.length)return null
const r=n[0]
if(!r)return null
switch(r.type){case Kq:case xq:return r
default:return null}}function Zc(e){return e.client.deviceType===Yq?JH:TH}function Qc(e,t,n){return pe(e,t,Jq)||null}function Xc(e,t,n,o){if(!t)return
let i=n.module
n.subStyle&&(i=i+"_"+n.subStyle),r(o)&&(o={id:`${n.index}`,impressionIndex:n.index,idType:sq,impressionType:i,kind:"iosModule"}),t.impressionMetrics=new CY(ch(o))}function el(e,t,n){const r=new L4
r.overlayType=tl(e,t),r.displayOptions={horizontalPlacement:il(e,t),textAlignment:sl(e,t),isOverDarkContent:ol(e,t)}
const a=Zf(e,t),c=j(t,$H)
if(et(e,t,aG)?r.badgeText=e.loc.uppercased(Kf(e,a,c)):r.badgeText=c,r.titleText=Gf(e,t,Zq)||Qe(e,a,Zq),r.overlayType===nM||r.overlayType===xE?r.descriptionText=Gf(e,t,gj):r.descriptionText=Gf(e,t,Uj)||Qe(e,a,gj),r.callToActionText=j(t,a$),r.buttonTitle=rl(e,t),r.overlayType!==Bq&&r.overlayType!==nM||(r.lockup=function(e,t,n){let r=pe(e,t,aH)
const i=we(t,wH)
if(o(r)&&s(i)&&(r=i[0]),o(r))return null
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},artworkUseCase:n.lockupArtworkUseCase,offerStyle:uj,offerEnvironment:kq,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ),isContainedInPreorderExclusiveShelf:n.isContainedInPreorderExclusiveShelf},c=Ad(e,r,a),l=Zf(e,t),u=Gf(e,t,Uj)||Qe(e,l,gj)
return(null==u?void 0:u.length)>0&&(c.subtitle=u),c}(e,t,n)),(null==c?void 0:c.length)>0&&i(r.lockup)&&(r.lockup.heading=c),r.collectionIcons=function(e,t){const n=we(t,wH)
if(o(n))return null
const r=[]
for(const t of n){const n=Jd(e,t,{useCase:n6.LockupIconSmall,withJoeColorPlaceholder:!0})
s(n)&&r.push(n)}return s(r)?r:null}(e,t),s(r.lockup))r.clickAction=r.lockup.clickAction,r.impressionMetrics=r.lockup.impressionMetrics
else{const o={targetType:Bq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i=nl(e,t),s=_c(e,t)
s.title=i,Qs(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:Bq,id:t.id}),r.clickAction=s,Oh(e,r,Lh(e,t,i,o))}return r}function tl(e,t){const n=H(t,RA),r=j(t,fH),a=we(t,wH),c=Gf(e,t,gj),l=function(e){return ar(e,e.bag.hero3RolloutRate)}(e)&&(null==c?void 0:c.length)>0
let u=pe(e,t,aH)
return o(u)&&s(a)&&(u=a[0]),i(u)&&"App"===r?l?nM:Bq:s(a)&&"Collection"===r?l?xE:$E:n?rM:UV}function nl(e,t){const n=tl(e,t),r=pe(e,t,aH)
switch(n){case Bq:case nM:return j(r,Zq)
case rM:case UV:case $E:case xE:return Gf(e,t,Zq)||Qe(e,r,Zq)
default:return null}}function rl(e,t){if("tv"!==e.client.deviceType)return null
switch(tl(e,t)){case Bq:return e.loc.string(fb)
case rM:case UV:let t=e.loc.string(IE)
return t===IE&&(t=e.loc.string(fb)),t
case $E:return e.loc.string("HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_COLLECTION")
default:return null}}function ol(e,t){const n=Sc(e,t),r=bc(e,t),o=n.backgroundColor||r.backgroundColor
return!o||be(o,50)}function il(e,t){if(e.client.isPhone)return fq
const n=j(t,DO)
if(!s(n))return Uq
switch(n.toLowerCase()){case _O:return Uq
case fq:return fq
case LO:return Sj
default:return Uq}}function sl(e,t){return il(e,t),Uq}function al(e,t,n){Bv.catchingContext("parseGrouping",()=>{for(const r of t.data){const o=q(r,xj)
if(Vi(o)){const e=f(r,"id")
n.chartSet=cl(e,t.editorialChartSets)}else n.chartSet=null
const s=Wi(e,r,n),a=s.shelfToken,c=s.metricsOptions
let l
for(const t of X4)if(t.supports(e,r,o)){l=Bv.catchingContext("parseGroupingShelf",()=>t.createShelf(e,r,n,a,c))
break}i(l)&&(n.shelves.push(l),un(e,n.shelves,oV,c.id,n.metricsPageInformation))}})}function cl(e,t){for(const n of t){if(n.id===e)return n
for(const t of n.editorialCharts)if(t.id===e)return n}return null}function ll(e,t){const n=[],r=[]
return function t(o){const s=q(o,xj)
Bv.catchingContext(`flattenGroupingTree.addMediaApiDataToGroupingData: ${s}`,()=>{const a=pe(e,o,UG)
if(i(a))t(a)
else if(function(e){return P0.has(e)}(s)){const e=we(o,WV)
for(const n of e)t(n)}else if(s===XX){const e=q(c=o,xj)!==XX?null:{id:f(c,"id"),name:j(c,Zq),editorialCharts:we(c,WV).map(e=>function(e){return Vi(q(e,xj))?{id:f(e,"id"),href:j(e,TG),name:j(e,Zq),type:j(e,WH)}:null}(e)).filter(e=>(0,Nv.isSome)(e))};(0,Nv.isSome)(e)&&r.push(e)
const n=we(o,WV)
for(const e of n)t(e)}else n.push(o)
var c})}(t),{data:n,editorialChartSets:r,originalGroupingData:t}}function ul(e,t,n){var r,o,i,s,a,c
if(e.user&&e.user.isManagedAppleID)return null
{const t=[],n=e.loc.string("FOOTER_REDEEM",fO),l=Wa(e,e.bag.redeemUrl),u=new K4(n,l)
if(u.id=RF,t.push(u),e.bag.isMonetaryGiftingEnabled){const n=e.loc.string("FOOTER_SEND_GIFT",tA),r=Wa(e,DF),o=new K4(n,r)
o.id=DF,t.push(o)}const d=e.bag.accountTopUpURL
if((0,Nv.isSome)(d)){const n=null!==(r=e.bag.accountTopUpTitle)&&void 0!==r?r:e.loc.string("FOOTER_ADD_MONEY"),o=Wa(e,d),i=new K4(n,o)
i.id="topUp",t.push(i)}let f
{f=new YY("titledButtonStack")
const n=new Z4(t)
n.compactLineBreaks=n.buttons.map((e,t)=>t),f.items=[n]
const r=e.loc.string(cb),l=e.loc.string(lb)
f.accessibilityMetadata={label:null!==(s=null!==(o=f.title)&&void 0!==o?o:null===(i=f.header)||void 0===i?void 0:i.title)&&void 0!==s?s:r,roleDescription:l.replace("%d",`${null!==(c=null===(a=n.buttons)||void 0===a?void 0:a.length)&&void 0!==c?c:0}`)}}return f}}function dl(e,t,n=!0){const r=new PY(t),o=e.loc.string(RE),i=new N2(o)
i.clickAction=r,i.presentationStyle=[YL,JL],n&&i.presentationStyle.push(KL)
const s=new YY("footnote")
if(s.items=[i],e.bag.emailSupportLinkURL){const t=new PY(e.bag.emailSupportLinkURL),r=new N2("Email Support")
r.clickAction=t,r.presentationStyle=[YL,JL],n&&r.presentationStyle.push(KL),s.items.push(r)}return s}function fl(e,t,n,r){const o=new YY("unifiedMessage")
return o.id=t,o.items=[new Q4(t,n,r)],o.isHidden=!0,o}function hl(e,t,n,r,o,a,c){var u
const d=l(t,GH),f=[]
for(const t of d){const l=y(t)
if(s(l)){const t=pl(e,l,n,r,o,a,c)
i(t)&&f.push(t)}}if(0===f.length){const t=function(e,t,n,r,o){const i=YR,s=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),a=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),c=Ot(e,ex),l=wl(e,t,i,n,r,o)
return new e5(i,s,a,c,n,[],[],l)}(e,n,r,a,c)
f.push(t)}for(const t of f)Oh(e,t,{id:null,kind:null,softwareType:null,title:null!==(u=t.title)&&void 0!==u?u:"",pageInformation:a,locationTracker:c,targetType:QR}),bh(c)
return f}function pl(e,t,n,r,a,c,u){const d=f(t,XM),h=f(t,QM),p=f(t,hq)
if((0,Uv.isNothing)(d)||o(d)||(0,Uv.isNothing)(h)||o(h)||(0,Uv.isNothing)(p)||o(p))return null
const w=yl(e,t,function(e,t){switch(t){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash"
case"DATA_USED_TO_TRACK_YOU":return"systemimage://person.fill.viewfinder"
case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle"
case"DATA_LINKED_TO_YOU":return TP
default:return null}}(0,d)),g=a?gl(e,t,r):[],v=function(e,t,n){const r=l(t,"purposes"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=ml(e,r,n)
i(t)&&o.push(t)}}return o}(e,t,r),m=wl(e,n,d,r,c,u)
return new e5(d,h,p,w,r,v,g,m)}function wl(e,t,n,r,o,i){let s=null
return r!==jV&&r!==tF||(s=Cl(e,t,Al(e)&&r===jV?tF:ej,o,i,n)),s}function gl(e,t,n){const r=l(t,"dataCategories"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=vl(e,r,n===jV?jV:ej)
i(t)&&o.push(t)}}return o}function vl(e,t,n){const i=f(t,XM),s=f(t,"dataCategory")
if((0,Uv.isNothing)(i)||o(i)||(0,Uv.isNothing)(s)||o(s))return null
const a=yl(e,t,function(e,t){switch(t){case"FINANCIAL_INFO":return"systemimage://creditcard.fill"
case"CONTACT_INFO":return"systemimage://info.circle.fill"
case"OTHER":return"systemimage://ellipsis.circle.fill"
case"SENSITIVE_INFO":return"systemimage://eye.fill"
case AP:return"systemimage://chart.bar.fill"
case"CONTACTS":return TP
case"PURCHASES":return"systemimage://bag.fill"
case"LOCATION":return"systemimage://location.fill"
case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill"
case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill"
case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill"
case"BROWSING_HISTORY":return"systemimage://clock.fill"
case"DIAGNOSTICS":return"systemimage://gearshape.fill"
case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill"
case"BODY":return"systemimage://figure"
case"SURROUNDING":return"systemimage://arkit"
default:return null}}(0,i))
if(r(a))return null
let c=[]
n===ej&&(c=l(t,"dataTypes"))
const u=new t5(i,s,a,n,c)
return i===AP&&(u.prefersSmallArtwork=!0),u}function ml(e,t,n){const r=f(t,XM),i=f(t,"purpose"),s=gl(e,t,n)
return(0,Uv.isNothing)(r)||o(r)||(0,Uv.isNothing)(i)||o(i)||0===s.length?null:new n5(r,i,s)}function yl(e,t,n){let o=null
if((0,Uv.isSome)(n)&&(null==n?void 0:n.length)>0&&(o=Ot(e,n)),r(o)){const n=p(t,Hq)
i(n)&&(o=qd(e,n,{useCase:n6.Default,allowingTransparency:!0}))}return o}function Al(e){return e.client.deviceType===zq}function Tl(e,t,n,a,c,l){return Bv.context("createPrivacyHeaderFromData",()=>{const u=function(e,t,n,r,a,c){let l,u=sV
const d=pe(e,t,PH),h=s(d)&&CK.indexOf(d.id)>-1
l=n&&!h?e.loc.string("PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_HEADER_TEMPLATE")
const p=Pl(e,t,r,ej,a,c),w=1===p.length&&p[0].identifier===YR||0===p.length
w&&(l=e.loc.string("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"))
const g=j(t,$V)
i(g)?l=l.replace(ZM,t$+g+n$):(l=w?e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE"):n?e.loc.string("PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),u=kV)
const v=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK")
l=l.replace("{privacyPolicyLink}",v)
const m=function(e,t,n,r){let i
{const n=Qe(e,t,jF)
if((0,Uv.isNothing)(n)||o(n))return null
i=new PY(n,!1)}return i.title=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),Qs(e,i,{targetType:yq,id:gP,pageInformation:n,locationTracker:r}),i}(e,t,a,c),y={}
if(i(m)&&(y[v]=m),n){const n=function(e,t,n,r){const i=f(B(t,v$),"managePrivacyChoicesUrl")
if((0,Uv.isNothing)(i)||o(i))return null
const s=new PY(i,!1)
return Qs(e,s,{targetType:yq,id:"managePrivacyChoices",pageInformation:n,locationTracker:r}),s}(e,t,a,c)
if(i(n)){const t=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK")
l+=wP,l+=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",t),n.title=t,y[t]=n}}const A=new i5(l,u)
return new s5(A,y)}(e,t,n,a,c,l),d=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(vP),a=e.loc.string("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",s),c=Sl(e,o,i)
if(r(c))return null
c.title=s
const l={}
l[s]=c
const u=new i5(a,kV)
return new s5(u,l)}(e,0,n,c,l)
let h,p
n&&(h=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(JR),a=bl(e,o,i)
let c
const l={}
r(a)?c=e.loc.string(KR):(c=e.loc.string(pP).replace(pj,s),a.title=s,l[s]=a)
const u=new i5(c,kV)
return new s5(u,l)}(e,0,n,c,l),s(h)&&(p=bl(e,c,l)))
const w=[]
if(i(d)){const e=new r5(d,void 0)
w.push(e)}if(i(h)){const e=new r5(h,p)
w.push(e)}return new o5(u,n,[],[],w,void 0)})}function bl(e,t,n){const r=e.bag.appPrivacyLearnMoreEditorialItemId
if((0,Uv.isNothing)(r)||0===r.length)return null
const o=new fY(cq)
return o.title=e.loc.string(JR),o.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,o,{targetType:Qq,id:"privacyLearnMore",pageInformation:t,locationTracker:n}),o}function Sl(e,t,n){const r=e.bag.appPrivacyDefinitionsEditorialItemId
if((0,Uv.isNothing)(r)||0===r.length)return null
const o=new fY(cq)
return o.title=e.loc.string(vP),o.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,o,{targetType:Qq,id:mP,pageInformation:t,locationTracker:n}),o}function Pl(e,t,n,r,o,i){var a
let c=[]
const l=B(t,n?v$:p$)
return s(l)&&(c=null!==(a=hl(e,l,t,r,e.client.deviceType!==zq||r===tF,o,i))&&void 0!==a?a:[],1===c.length&&0===c[0].categories.length&&(c[0].style=jV)),c}function Cl(e,t,n,o,a,c){if(r(t.id))return null
const l=new fY(ZR)
l.title=e.loc.string(yP),l.pageData=function(e,t,n,r,o){const i=[]
if(e.client.deviceType!==zq||n!==ej){const n=new YY(YH),s=Tl(e,t,!0,!1,r,o)
n.items=[s],n.presentationHints={isFirstShelf:!0},i.push(n)}const s=new ZY(i)
return e.client.deviceType===zq&&n!==ej||(s.isIncomplete=!0),s.title=e.loc.string(KM),s}(e,t,n,o,a)
const u=t.type===xq?yW.productBundle:yW.product
let d
s(c)&&(d={privacyTypeId:c})
const f=qW.fromComponents(hW,null,`/${yW.privacyDetail}/${u}/${t.id}`,d)
l.pageUrl=f.build()
const h={targetType:Qq,id:"seeDetails",pageInformation:o,locationTracker:a}
return i(c)&&(h.targetType=QR,h.id=c),Qs(e,l,h),l}function Il(e,t,n){if(!s(t))return null
let r=null
r=(0,Uv.isNothing)(n)?"sr":n
const i=qd(e,t,{cropCode:r,useCase:n6.ProductPageBadge,allowingTransparency:!0})
return o(i)?null:i}function kl(e,t,n,r){let o=0
for(const i of t){const t=n[i.key]
if(t){let n
if(zu(e))n=new qY(t.shelfId,null,null,void 0,t.index,!0)
else if((0,Uv.isSome)(t.section)){const e=new WY(t.section,!0)
e.index=t.index,n=e}i.clickAction=n}let s
switch(i.key){case AU:case AH:case tj:case rF:case YM:case oF:case Lj:s=iF
break
default:s=Xq}i.clickAction&&Qs(e,i.clickAction,{targetType:qB,id:i.key,idType:sq,actionType:s,actionDetails:{position:o},pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o+=1}}function Ol(e,t,n){return new t2(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,{type:"canPerformAppAction",appAction:e,appCapabilities:t})}function El(e,t,n,r,o,i,s){return Bv.context("createHeaderShelf",()=>{const a=new YY(ZP)
a.presentationHints={isSeeAllContext:r}
const c=e.loc.string("ProductPage.Accessibility.Shelf.Title")
if(!r){a.title=c
const o=_l(t,n,r)
if((0,Nv.isSome)(o)&&Pi(o)){const r=Ll(e,t,n,Qq,i,s)
a.seeAllAction=r}}const l=function(e,t,n,r,o,i){const s=_l(t,n,r),a=function(e,t,n){const r=e.bag.accessibilityLearnMoreEditorialItemId
if((0,Nv.isNothing)(r))return null
const o=new fY(cq)
return o.title=e.loc.string(tN),o.pageUrl=`https://apps.apple.com/story/id${r}`,e.clientCapabilities.isEnabled(wD)&&Qs(e,o,{id:HB,targetType:Qq,pageInformation:t,locationTracker:n}),o}(e,o,i),c=(0,jv.attributeAsString)(t,$V),l=(0,Nv.isSome)(c)&&Pi(c)
let u
u=function(e,t,n,r){if(e)return(0,Nv.isSome)(n)&&r?"AccessibilityDetails.Header":r?eC:(0,Nv.isSome)(n)?"AccessibilityDetails.Header.NoDeveloperName":tC
{const e=(0,Nv.isSome)(t)
return e&&Pi(t)?(0,Nv.isSome)(n)?"ProductPage.Accessibility.Header.SupportedFeatures":"ProductPage.Accessibility.Header.SupportedFeatures.NoLearnMoreLink":e?(0,Nv.isSome)(n)?"ProductPage.Accessibility.Header.NoSupportedFeatures":nC:(0,Nv.isSome)(n)?"ProductPage.Accessibility.Header.NoReportedFeatures":rC}}(r,s,a,l)
let d=e.loc.string(u),f=kV
const h={}
if((0,Nv.isSome)(a)){const t=e.loc.string(tN)
d=d.replace(pj,t),h[t]=a}l&&(d=d.replace(ZM,`<b>${c}</b>`),f=sV)
const p=new i5(d,f)
return new s5(p,h)}(e,t,n,r,i,s),u=new l5(l,[])
return(0,Nv.isSome)(o)&&!r&&(o.addImpressionsToShelf(e,a,"accessibilityOverview"),bh(o.locationTracker)),a.items=[u],a})}function Rl(e,t,n,r,o=null,i,s){return Bv.context("createFeaturesShelf",()=>{const a=function(e,t,n,r){const o=_l(t,n,r)
return(0,Nv.isNothing)(o)?[]:o.reduce((t,n)=>{const r=f(n,XM),o=f(n,Pq),i=f(n,hq)
if((0,Nv.isNothing)(r)||0===r.length||(0,Nv.isNothing)(o)||0===o.length)return t
const s=function(e){switch(e){case"VOICEOVER":return"voiceover"
case XP:return"voice.control"
case"LARGER_TEXT":return"textformat.size"
case"SUFFICIENT_CONTRAST":return"circle.lefthalf.filled.inverse"
case"DARK_INTERFACE":return"appearance.darkmode"
case"DIFFERENTIATE_WITHOUT_COLOR_ALONE":return"xmark.triangle.circle.square.fill"
case"REDUCED_MOTION":return"circle.dotted.and.circle"
case"CAPTIONS":return"captions.bubble.fill"
case"AUDIO_DESCRIPTIONS":return"quote.bubble.fill"
default:return null}}(r)
if((0,Nv.isNothing)(s))return t
const a=Ot(e,`systemimage://${s}`)
return a.imageScale=function(e){return e===XP?LH:null}(r),t.push(new d5(o,null!=i?i:null,a)),t},[])}(e,t,n,r)
if(Si(a))return null
const c=new YY(IH)
c.presentationHints={isSeeAllContext:r}
const l=e.loc.string("ProductPage.Accessibility.Card.SupportedFeaturesTitle"),u=new u5(l,Ot(e,"systemimage://accessibility"),a)
return r||((0,Nv.isSome)(o)&&(o.addImpressionsToShelf(e,c,"supportedFeaturesCard",void 0,void 0,null,l),bh(o.locationTracker)),u.clickAction=Ll(e,t,n,vV,i,s)),c.items=[u],c})}function Dl(e,t,n,r,o){return Bv.context("createDeveloperLinkShelf",()=>{const i=function(e,t,n,r,o){const i=function(e,t,n,r,o){const i=function(e,t){const n=t?oB:w$
return(0,jv.attributeAsString)(e,`${n}.developerUrl`)}(t,n)
if((0,Nv.isNothing)(i)||Si(i))return null
const s=new PY(i,!1)
return s.title=e.loc.string("Accessibility.DeveloperUrlLinkActionTitle"),e.clientCapabilities.isEnabled(wD)&&Qs(e,s,{id:"AccessibilitySite",targetType:yq,pageInformation:r,locationTracker:o}),s}(e,t,n,r,o)
if((0,Nv.isNothing)(i))return null
const s=e.loc.string("Accessibility.DeveloperUrlLinkTitle"),a=e.loc.string("Accessibility.DeveloperUrlText").replace("{accessibilitySite}",s),c={}
c[s]=i
const l=new i5(a,kV)
return new s5(l,c)}(e,t,n,r,o)
if((0,Nv.isNothing)(i))return null
const s=new YY(ZP)
return s.items=[new l5(i,[])],s.presentationHints={isSeeAllContext:n},s})}function _l(e,t,n){return U(e,`${n?oB:w$}.${t}.supportedCategories`)}function Ll(e,t,n,r,o,i){const s=new fY(oB)
s.title=e.loc.string(yP),s.pageData=function(e,t,n,r,o){const i=[],s=El(e,t,n,!0,null,r,o)
i.push(s)
const a=Dl(e,t,!0,r,o);(0,Nv.isSome)(a)&&i.push(a)
const c=new ZY(i)
return c.title=e.loc.string(gD),c.isIncomplete=!0,c.presentationOptions=[WG,ux,QP],c}(e,t,n,o,i)
const a=t.type===xq?yW.productBundle:yW.product,c=jv.URL.fromComponents(hW,null,`/${yW.accessibilityDetails}/${a}/${t.id}`,{deviceFamily:n})
return s.pageUrl=c.build(),e.clientCapabilities.isEnabled(wD)&&Qs(e,s,{id:"AccessibilityDetails",targetType:r,pageInformation:o,locationTracker:i}),s}function Ml(e,t,n,r,o,i){if(r)return null
const s=yd(e,t)
if((0,Nv.isNothing)(s))return null
const a=new f5(s),c=o?"":e.loc.string("InfoList.Category.Title")
return new h5(c,[a],void 0)}function xl(e,t,n,a,c,l){const u=B(t,VO)
let d=[],f=function(e,t){let n
if(Bd(e,t)){const r=pf(0,t,e.appleSilicon.isSupportEnabled),o=!1,i=cf(e,t),s=Tf(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),a=function(e,t,n,r,o,i=!0){return!!vf(0,n,r,o).some(e=>mf(t,e))}(0,i,e.client.deviceType,r,o,s),c=e.loc.deviceDisplayName(e)
a&&c&&(n=e.loc.string("InfoList.Requirements.Summary").replace("{deviceName}",c))}return n}(e,t)
const h=et(e,t,AT,rt(e))
if(s(u)){const t=function(e){const t=[mq,gq,qF,Yq,GV,BG,zq],n=function(e,t,n){let r=null
switch(t){case jq:r=mq
break
case $q:r=gq
break
case Yq:r=Yq
break
case"tv":r=BG
break
case zq:r=zq
break
case Fq:r=GV}return i(n)&&n===qF&&(r=qF),r}(0,e.client.deviceType,e.host.deviceModel)
if(i(n)){const e=t.indexOf(n)
e>0&&(t.splice(e,1),t.unshift(n))}return t}(e)
for(const n of t){const t=p(u,n)
if(s(t)){const r=$l(0,t,e.appleSilicon.isSupportEnabled&&n===Yq&&h&&!e.appleSilicon.isRosettaAvailable)
i(r)&&d.push(r)}}!i(f)&&d.length>0&&(f=d[0].text)}else{const n=function(e,t){const n=Qe(e,t,"requirementsString")
return r(n)?null:new f5(n)}(e,t)
i(n)&&(d=[n])}if(o(d))return null
const w=c?"":e.loc.string("Requirements"),g=new h5(w,d,f)
return 0===g.items_V3.length&&(g.items_V3=wu(0,g)),g}function $l(e,t,n){var r
const o=null!==(r=f(t,AC))&&void 0!==r?r:void 0
let i=f(t,"requirementString")
const a=l(t,"devices")
if(n){const e=f(t,"rosettaUnavailableRequirementString")
s(e)&&(i=e)}if((0,Nv.isNothing)(i))return null
const c=[]
for(const e of a)c.push("\u2022\t\u2068"+e+"\u2069")
const u=c.length>0?c.join("\n"):void 0
return new f5(i,{heading:o,listText:u})}function Fl(e,t){const n=B(t,"contentRatingsBySystem.appsKorea")
if((0,Nv.isNothing)(n))return null
const r=h(n,_B)
if((0,Nv.isNothing)(r))return null
const o=l(n,bC)[0]
if((0,Nv.isNothing)(o))return null
const i=Lf(0,r),s=[]
return(0,Nv.isSome)(i)&&s.push(Ot(e,`resource://${i}`)),new f5(o,{headingArtworks:s})}function Nl(e,t,n,o,s,a){var c
return null!==(c=function(e,t,n,r,o,i){const s=or(0,t)
if((0,Nv.isNothing)(s))return null
const a=e.loc.string(TC),c=Bl(e,a)
let u,d
u=e.loc.string(ID),d=s
const h=new h5(u,[],d,c),p=sr(e,t)
if((0,Nv.isSome)(p)){const t=Ot(e,Et(p),30,30)
h.items_V3.push({$kind:Hq,artwork:t})}else h.items_V3.push({$kind:"textEncapsulation",text:s})
const w=function(e,t){return j(t,"ageRating.description")}(0,t)
let g="";(0,Nv.isSome)(w)&&(g+=w)
const v={};(0,Nv.isSome)(c)&&(v[a]=c,g.length>0&&(g+="\n"),g+=a)
const m=new s5(new i5(g,rx),v)
h.items_V3.push({$kind:rj,linkableText:m})
const y=function(e,t){const n=G(t,rT)
let r=""
for(const e of n){const t=f(e,"level"),n=l(e,"contentDescriptors")
if(0!==n.length){r.length>0&&(r+="\n\n"),r+=`**${t}**`
for(const e of n){const t=f(e,hq);(0,Nv.isSome)(t)&&(r+="\n",r+=t)}}}if(0===r.length)return
const o=new s5(new i5(r,rx))
return{$kind:rj,linkableText:o}}(0,t);(0,Nv.isSome)(y)&&(h.items_V3.push({$kind:DN}),h.items_V3.push(y))
const A=function(e,t){return j(t,"ageRating.ageGuidanceUrl")}(0,t)
if((0,Nv.isSome)(A)){const t=new PY(A)
t.title=e.loc.string("InfoList.AgeRating.DeveloperInfo"),h.items_V3.push({$kind:DN}),h.items_V3.push({$kind:Qq,action:t})}return h}(e,t))&&void 0!==c?c:function(e,t,n,o,s,a){const c=B(t,"contentRatingsBySystem.appsApple")
if(r(c))return null
const u=f(c,Zq)
if(r(u))return null
if(99===h(c,_B))return null
const d=l(c,bC)
let p
const w=se(t,nt(e,t),"ageBand"),g=h(w,"minAge"),v=h(w,"maxAge")
p=i(g)&&i(v)?e.loc.string("InfoList.AgeRating.Summary").replace("{ageRating}",u).replace("{minAgeRating}",e.loc.decimal(g)).replace("{maxAgeRating}",e.loc.decimal(v)):u
const m=[]
let y,A="";(0,Nv.isSome)(p)&&(A+=p)
for(const e of d)A+="\n",A+=e
m.push(new f5(A))
{const n=Fl(e,t);(0,Nv.isSome)(n)&&m.push(n)
const r=Ul(e,t);(0,Nv.isSome)(r)&&m.push(r)}(m.length>1||m[0].text!==p)&&(y=p)
const T=s?"":e.loc.string(ID),b=e.loc.string(TC),S=Bl(e,b)
return new h5(T,m,y,S)}(e,t,0,0,s)}function Bl(e,t){let n
if((0,Nv.isSome)(e.bag.ageRatingLearnMoreEditorialItemId)&&e.bag.ageRatingLearnMoreEditorialItemId.length>0){const r=new fY(cq)
r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.ageRatingLearnMoreEditorialItemId}`
const o=bi({...Di(e),id:e.bag.ageRatingLearnMoreEditorialItemId})
r.destination=o,n=r}return n}function Ul(e,t){if(e.bag.requireAgeVerification&&function(e,t,n){const r=q(t,"contentRatingsBySystem.appsApple.rank")
if((0,Nv.isNothing)(r))return!1
let o
switch(n){case CC:o=3
break
case SC:o=4
break
case"adultOnly":o=5
break
default:o=1}return r>=o}(0,t,SC)&&function(e,t){var n
const r=null!==(n=we(t,mN))&&void 0!==n?n:[]
for(const e of r)if(f(e,"id")===PK.Games.toString())return!0
return!1}(0,t)){let n
if(t.type===xq){const r=fe(t,Kq)
if(i(r))for(const t of r.data)if(i(j(t,PC))){n=e.loc.string("AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles")
break}}else i(j(t,PC))&&(n=e.loc.string("AgeVerification.ProductPage.Rating.UnsuitableForJuveniles"))
return(0,Nv.isNothing)(n)?null:new f5(n)}return null}function Gl(e,t,n,r,o,i){const s=ar(e,e.bag.gameControllerRecommendedRolloutRate),a=lr(e,t)
if(s&&a){const n=o?"":e.loc.string("ProductPage.Info.GameController.Title")
let r
r=a?"ProductPage.Info.GameController.Recommended":"ProductPage.Info.GameController.Required"
const i=e.loc.string(r),s=j(t,$V),c=a?"ProductPage.Info.GameController.Recommended.Summary.v2":"ProductPage.Info.GameController.Required.Summary.v2",l=e.loc.string(c).replace(ZM,s),u=[new f5(l)]
let d
const f=e.bag.gameControllerLearnMoreEditorialItemId
if((0,Nv.isSome)(f)&&f.length>0){const t=new fY(cq),n=a?"ProductPage.Info.GameController.Recommended.LearnMore":"ProductPage.Info.GameController.Required.LearnMore"
t.title=e.loc.string(n),t.pageUrl=`https://apps.apple.com/story/id${f}`,d=t}return new h5(n,u,i,d)}return null}function jl(e,t,n,r,o,i){const s=Qe(e,t,"copyright")
if((0,Nv.isNothing)(s))return null
const a=new f5(s),c=o?"":e.loc.string("InfoList.Copyright")
return new h5(c,[a])}function Vl(e,t,n,r,i,s){var a
if(!function(e,t){var n
const r=wf(e,t),o=new Set(["uses-non-webkit-browser-engine","is-custom-browser-engine-app"])
return null!==(n=null==r?void 0:r.some(e=>o.has(e)))&&void 0!==n&&n}(e,t))return null
const c=null!==(a=function(e,t,n){const r=e.bag.externalBrowserLearnMoreEditorialItemId
if(o(r))return null
const i=new fY(cq)
return i.title=e.loc.string(tN),i.pageUrl=`https://apps.apple.com/story/id${r}`,Qs(e,i,{id:HB,targetType:yq,actionType:Xq,pageInformation:t,locationTracker:n}),i}(e,s.metricsPageInformation,s.locationTracker))&&void 0!==a?a:void 0
let l=c
const u=i?"":e.loc.string("Annotations.ExternalBrowser.Title"),d=e.loc.string("Annotations.ExternalBrowser.Value.Summary"),f=e.loc.string("Annotations.ExternalBrowser.Value.Expanded"),h=[new f5(f)]
return new h5(u,h,d,l)}function Hl(e,t,n,r,o,i){const s=er(e,t),a=tr(e,yC)
if(!s||!a)return null
const c=o?"":e.loc.string("Annotations.ExternalPurchases.Title"),l=e.loc.string("YES")
let u
if((0,Uv.isSome)(e.bag.externalPurchasesProductPageAnnotationVariant)){const t=`Annotations.ExternalPurchases.Expanded.Variant${e.bag.externalPurchasesProductPageAnnotationVariant}`
u=e.loc.string(t)}else u=e.loc.string("Annotations.ExternalPurchases.Expanded")
const d=new f5(u),f=e.loc.string("Annotations.ExternalPurchases.Expanded.LearnMore")
let h=nr(e,f,i.metricsPageInformation,i.locationTracker)
return new h5(c,[d],l,null!=h?h:void 0)}function ql(e,t,n,r,o,i){const s=(0,jv.attributeAsDictionary)(t,"licenses.gameLicenseVietnam"),a=[Yl(e.loc.string("InfoList.GameLicense.Disclaimer"))],c=(0,jv.asString)(s,"licenseId")
if(!(0,Nv.isSome)(c)||!Pi(c))return null
a.push(Wl(),zl(e.loc.string("InfoList.GameLicense.Id.Title")),Yl(c))
const l=(0,jv.asString)(s,"licenseUrl");(0,Nv.isSome)(l)&&Pi(l)&&a.push(Wl(),zl(e.loc.string("InfoList.GameLicense.Url.Title")),function(e){const t={}
return t[e]=new PY(e,!1),{$kind:rj,linkableText:new s5(new i5(e),t)}}(l))
const u=o?"":e.loc.string("InfoList.GameLicense.Title"),d=new h5(u,[],c)
return d.items_V3=a,d}function Wl(){return{$kind:DN}}function zl(e){return{$kind:rj,linkableText:new s5(new i5(`**${e}**`))}}function Yl(e){return{$kind:rj,linkableText:new s5(new i5(e))}}function Jl(e,t,n,r,o,i){return null}function Kl(e,t,n,r,s,a){var c
const l=Ze(e,t,"languageList")
if(o(l))return null
const u=l.length
if(u<1)return null
let d,f
switch(u){case 0:break
case 1:f=l[0]
break
case 2:f=e.loc.string("InfoList.Two.Languages.Summary").replace("{first}",l[0]).replace("{second}",l[1])
break
default:const t=u-1
d=e.loc.string("InfoList.More.Languages.Summary").replace("{language}",l[0]).replace(dD,e.loc.formattedCount(t)),f=null!==(c=function(e,t){if(null==e||null==t)return null
if(0===e.length)return""
let n=e.length,r=""
return e.forEach((e,o)=>{null===e?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(l,e.loc.string("Conjunction.Separator")))&&void 0!==c?c:void 0}if(!i(f))return null
const h=new f5(f),p=s?"":e.loc.string("Supported.Languages")
return new h5(p,[h],d)}function Zl(e,t,n,r,o,i){if(!H(t,"usesLocationBackgroundMode"))return null
const s=o?"":e.loc.string("InfoList.Location.Title"),a=e.loc.string("InfoList.Location.Description"),c=new f5(a)
return new h5(s,[c])}function Ql(e){var t
return{platform:null===(t=e.activeIntent)||void 0===t?void 0:t.previewPlatform}}function Xl(e,t){var n
return(null===(n=e.activeIntent)||void 0===n?void 0:n.previewPlatform)?t.addingQuery("previewPlatform",e.activeIntent.platform).addingQuery(MV,AV):t}function eu(e,t){const n={...t,id:`id${t.id}`}
return t.platform?g5(e,n):m5(e,n)}function tu(e,t,n,r,o){return Bv.context("capabilitiesFromData",()=>[nu(e,t,r,o),ru(e,t),cu(e,t),ou(e,t),iu(e,t),su(e,t,n),null,au(e,t)].filter(e=>e))}function nu(e,t,n,r){if(!(0,Nv.isSome)(t)||!et(e,t,fB))return null
if(e.bag.gameCenterExtendSupportedFeatures){const o=function(e){var t
if(!(0,Uv.isNothing)(e))return null!==(t=$(e,"supportedGameCenterFeaturesFromData",()=>{const t=[],n=l(e,"attributes.supportedGameCenterFeatures")
return n.includes(Cq)&&t.push(Cq),n.includes(RV)&&t.push(RV),n.includes(pH)&&t.push(pH),n.includes(JF)&&t.push(JF),t}))&&void 0!==t?t:void 0}(t),i=null==o?void 0:o.includes(pH),s=null==o?void 0:o.includes(Cq)
let a
a=i&&s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ALL_FEATURES"):i?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_LEADERBOARDS"):s?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_ACHIEVEMENTS"):e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_NO_FEATURES")
const c=e.loc.string(jT),u=Ot(e,VT,46,45)
if(e.client.isPhone){let o
o=(0,Nv.isSome)(t)&&e.clientCapabilities.isEnabled("gameProductIdOpenGamesUIAction")?ro({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r,target:{gamePage:{productID:t.id}}}):ro({objectGraph:e,metricsPageInformation:n,metricsLocationTracker:r})
const i=e.loc.string("ProductPage.Capability.GameCenter.ActionTitle")
a=`${a}\n${i}`
const s=new i5(a),l={}
l[i]=o
const d=new s5(s,l),f=Ot(e,"systemimage://arrow.up.forward.square.fill",16,16)
return new p5(hV,c,d,f,void 0,u)}{const e=new i5(a),t=new s5(e)
return new p5(hV,c,t,null,null,u)}}{const t=e.loc.string(jT),n=new i5(e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION")),r=new s5(n),o=Ot(e,VT,46,45)
return new p5(hV,t,r,void 0,null,o)}}function ru(e,t){if(!et(e,t,"isSiriSupported"))return null
const n=e.loc.string("CAPABILITY_SIRI_TITLE"),r=new i5(e.loc.string("CAPABILITY_SIRI_EXPLANATION")),o=new s5(r),i=Ot(e,"resource://ProductCapabilitySiri",46,45)
return new p5(wE,n,o,void 0,null,i)}function ou(e,t){if(!et(e,t,"supportsPassbook"))return null
const n=e.loc.string("CAPABILITY_WALLET_TITLE"),r=new i5(e.loc.string("CAPABILITY_WALLET_EXPLANATION")),o=new s5(r),i=Ot(e,"resource://ProductCapabilityWallet",46,45)
return new p5("wallet",n,o,void 0,null,i)}function iu(e,t){if(!cr(e,t))return null
const n=e.loc.string("CAPABILITY_MFI_CONTROLLERS_TITLE")
let r=null
const o=e.bag.gameControllerLearnMoreEditorialItemId
if(ar(e,e.bag.gameControllerRecommendedRolloutRate)&&(0,Nv.isSome)(o)&&(null==o?void 0:o.length)>0){const t=bi({...Di(e),...Ql(e),id:o})
r=new fY(cq),r.title=e.loc.string("ProductPage.Capability.GameController.ActionTitle"),r.pageUrl=eu(e,t)}let i=r?e.loc.string("ProductPage.Capability.GameController.Explanation.v2.WithNewlineActionTemplate"):e.loc.string("ProductPage.Capability.GameController.Explanation.v2")
const s={};(null==r?void 0:r.title)&&(i=i.replace(pj,r.title),s[r.title]=r)
const a=new i5(i),c=new s5(a,s),l=Ot(e,"resource://ProductCapabilityController",46,45)
return new p5("controllers",n,c,void 0,null,l)}function su(e,t,n){const r=j(t,"familyShareEnabledDate")
if(!r||H(t,VU))return null
const o=new Date(r),i=new Date
if(!o||o>i)return null
const s=et(e,t,gE),a=s&&et(e,t,"hasFamilyShareableInAppPurchases")
let c=null
const l=e.bag.familySubscriptionsLearnMoreEditorialItemId
if((0,Nv.isSome)(l)&&(null==l?void 0:l.length)>0&&a){const t=bi({...Di(e),...Ql(e),id:l})
c=new fY(cq),c.title=e.loc.string("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),c.pageUrl=eu(e,t)}const u=e.loc.string("CAPABILITY_FAMILY_SHARING_TITLE")
let d
if(a?d=c?"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION":s||n||(d=c?"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION"),!d)return null
let f=e.loc.string(d)
const h={};(null==c?void 0:c.title)&&(f=f.replace(pj,c.title),h[c.title]=c)
const p=new i5(f),w=new s5(p,h),g=Ot(e,"resource://ProductCapabilityFamilySharing",46,45)
return new p5(iL,u,w,void 0,c,g)}function au(e,t){if(!et(e,t,"hasSafariExtension"))return null
const n=e.loc.string("CAPABILITY_SAFARI_EXTENSION_TITLE"),r=new i5(e.loc.string("CAPABILITY_SAFARI_EXTENSION_EXPLANATION")),o=new s5(r),i=Ot(e,"resource://ProductCapabilitySafariExtension",129,129)
return new p5(HT,n,o,void 0,null,i)}function cu(e,t){if(!et(e,t,PO))return null
const n=e.loc.string("CAPABILITY_SHAREPLAY_TITLE"),r=new i5(e.loc.string("CAPABILITY_SHAREPLAY_EXPLANATION")),o=new s5(r),i=Ot(e,"systemimage://shareplay"),s=Se(vE)
return new p5("sharePlay",n,o,void 0,null,i,s)}function lu(e,t,n,r,o,i){if(r)return null
const s=Qe(e,t,"seller"),a=Ke(e,t,rB),c=Ke(e,t,qO),l=e.bag.enableSellerICPAnnotation&&!0
if((0,Nv.isNothing)(s))return null
const u=Qe(e,t,"sellerLabel")||e.loc.string(IC)
let d,h=[]
const p=f(a,Zq),w=(0,Nv.isSome)(p)&&(null==p?void 0:p.length)>0?p:s,g=o?"":u
let m=null
if((0,Nv.isSome)(a)){const[t,n]=function(e,t){const n=[],r={name:"ProductPage.SellerInfo.Name.Title",dunsNumber:"ProductPage.SellerInfo.DunsNumber.Title",address:"ProductPage.SellerInfo.Address.Title",brn:"ProductPage.SellerInfo.BusinessRegistrationNumber.Title",phoneNumber:"ProductPage.SellerInfo.PhoneNumber.Title",email:"ProductPage.SellerInfo.Email.Title",usci:"ProductPage.SellerInfo.UnifiedSocialCreditIdentifier.Title"},o=f(t,Zq),i=(0,Nv.isSome)(o)&&(null==o?void 0:o.length)>0?o:e.loc.string(IC),s=(0,Nv.isSome)(f(t,kC))
if(s){const r=v(t,kC),o=r?"ProductPage.SellerInfo.VerifiedSeller.Subtitle":"ProductPage.SellerInfo.UnverifiedSeller.Subtitle"
if(n.push(new f5(e.loc.string(o).replace("{seller}",i))),!r)return[n,i]}let a=null
1!==Object.keys(t).length||Object.keys(t).includes(Zq)||(a=e.loc.string("ProductPage.SellerInfo.SeeDetails.Title"))
for(const[o,i]of Object.entries(r)){if(o===Zq&&s)continue
const r=uu(e,o,e.loc.string(i),t);(0,Nv.isSome)(r)&&n.push(r)}return[n,a]}(e,a)
m=n,h=h.concat(t)}if(l&&(0,Nv.isSome)(c)){const t=uu(e,"filingNumber",e.loc.string("ProductPage.Info.ICPNumber.Title"),c)
if(0===h.length){const e=new f5(w)
h.push(e)}(0,Nv.isSome)(t)&&h.push(t)}if(h.length>0)(0,Nv.isNothing)(m)&&(m=h.length>1?w:void 0),d=new h5(g,h,m,void 0)
else{const e=new f5(s)
d=new h5(g,[e])}return(0,Nv.isSome)(d),d}function uu(e,t,n,r){let o=f(r,t)
return(0,Nv.isSome)(o)?("brn"===t&&(o=o+"\n"+e.loc.string("ProductPage.SellerInfo.BusinessRegistrationNumber.Subtitle")),new f5(o,{heading:n})):null}function du(e,t,n,o,s,a){const c=Pf(e,t)
if(n||r(c)||r(c.fileSizeByDevice))return null
const l=e.loc.fileSize(c.fileSizeByDevice),u=s?"":e.loc.string("File.Size")
let d,f=c.fileSizeByDevice
if(i(c.maxEssentialInstallSizeInBytes)){const t=c.fileSizeByDevice+c.maxEssentialInstallSizeInBytes,n=e.loc.string(kD).replace(OD,e.loc.fileSize(t)),r=new f5(n)
d=new h5(u,[r],void 0)}else if(i(c.maxInstallSizeInBytes)){const t=[],n=new f5(l,{heading:e.loc.string("Initial.App.Size")})
t.push(n)
const r=e.loc.string(kD).replace(OD,e.loc.fileSize(c.maxInstallSizeInBytes)),o=new f5(r,{heading:e.loc.string("Additional.Content.After.App.Install")})
t.push(o),f+=c.maxInstallSizeInBytes
const i=e.loc.string(kD).replace(OD,e.loc.fileSize(f))
d=new h5(u,t,i)}else{const e=new f5(l)
d=new h5(u,[e],void 0)}return d}function fu(e,t,n,r,o,i){return null}function hu(e,t,n,r,o,i){const s=ge(t,CL)
if((0,Nv.isNothing)(s)||Si(s))return null
const a=[],c=[]
for(const t of s){const n=j(t,Zq)
if((0,Nv.isNothing)(n))continue
const r=wr(e,t)
if((0,Nv.isNothing)(r))continue
const o=f(r,jG)
if((0,Nv.isNothing)(o))continue
const i=f(r,JU),s=h(r,KU)
let l=e.loc.string("InfoList.IAP.Duration")
if((0,Nv.isSome)(i)){l=l.replace("{name}",n)
const t=Ho(0,i,s)
let r
switch(null==t?void 0:t.type){case"D":r="days"
break
case"W":r="weeks"
break
case"M":r="months"
break
case"Y":r="years"
break
default:l=`${n}`}if((0,Nv.isSome)(r)&&(0,Nv.isSome)(t)){const n=e.loc.formatDuration(t.periodDuration,r);(0,Nv.isSome)(n)&&(l=l.replace("{duration}",n))}}else l=`${n}`
a.push([l,o]),c.push({$kind:mC,leadingText:l,trailingText:o})}const l=e.loc.string("ProductPage.Info.InAppPurchases.LearnMore"),u=function(e,t){const n=e.bag.inAppPurchasesLearnMoreEditorialItemId
if((0,Nv.isNothing)(n)||Si(n))return null
const r=new fY(cq)
return r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.inAppPurchasesLearnMoreEditorialItemId}`,r}(e,l)
if((0,Nv.isSome)(u)){c.push({$kind:DN,size:LH})
const e={}
e[l]=u,c.push({$kind:rj,linkableText:new s5(new i5(l),e)})}const d=o?"":e.loc.string("InfoList.InAppPurchases"),p=[new f5(void 0,{textPairs:a})],w=new h5(d,p,e.loc.string("YES"))
return w.items_V3=c,w}function pu(e,t,n,r,o,i,s,a){const c=[]
for(const l of t){const t=l(e,n,r,o,i,s);(0,Nv.isSome)(t)&&(0===t.items_V3.length&&(t.items_V3=wu(0,t)),t.expandAction=void 0,c.push(t),a&&a(l,t,c.length-1))}return c}function wu(e,t){const n=[]
for(const e of t.items){if(n.length>0&&n.push({$kind:DN}),(0,Nv.isSome)(e.headingArtworks))for(const t of e.headingArtworks)n.push({$kind:Hq,artwork:t})
let t=""
if((0,Nv.isSome)(e.heading)&&(t+=`**${e.heading}**`),(0,Nv.isSome)(e.text)&&(t.length>0&&(t+="\n"),t+=e.text),(0,Nv.isSome)(e.listText)&&(t.length>0&&(t+="\n"),t+=e.listText),t.length>0&&n.push({$kind:rj,linkableText:new s5(new i5(t,rx))}),(0,Nv.isSome)(e.textPairs))for(const t of e.textPairs)n.push({$kind:mC,leadingText:t[0],trailingText:t[1]})}return(0,Nv.isSome)(t.linkAction)&&n.push({$kind:Qq,action:t.linkAction}),n}function gu(e,t){const n=Ke(e,t,qO),r=e.bag.enableSellerICPAnnotation&&(0,Nv.isSome)(n),o=Ke(e,t,rB),i=e.bag.enableSellerInfo&&(0,Nv.isSome)(o)
return r||i}function vu(e,t,n,r){const o=new YY(aC)
o.isHorizontal=!0
let i=null
i=n?t.slice(0,8):t
const a=[]
for(let t=0;t<i.length;t++){const n=i[t]
if(n.action=new lX({player:{playerID:n.playerId}}),s(r)){const o="friendPlayer",i={pageInformation:r.destinationPageInformation,locationTracker:r.sourceLocationTracker,id:"",idType:sq,anonymizationOptions:{anonymizationString:`FRIEND${t+1}`}}
if(Oh(e,n,{...i,kind:o,title:"",softwareType:null}),e.bag.productPageFriendsPlayingClickEventsEnabled){const t={...i,kind:o,targetType:Bq,actionType:Xq,softwareType:null}
Qs(e,n.action,t)}}a.push(n),s(r)&&bh(r.sourceLocationTracker)}if(o.items=a,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=hV,n&&t.length>8){const n=new YY("smallGameCenterPlayer")
n.title=e.loc.stringWithCount("ProductPage.FriendsPlaying.SeeAllTitle",t.length),n.items=t.map(e=>(e.action=new M5(e.playerId),e)),n.rowsPerColumn=1
const i=new ZY([n])
i.title=null==r?void 0:r.title
const s=new fY(eW)
s.title=e.loc.string(KV),s.pageData=i,o.seeAllAction=s}return s(r)&&(Oh(e,o,{id:"",kind:null,softwareType:null,targetType:KH,title:r.title,pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker,idType:sq,badges:{gameCenter:!0}}),o.footerTitle=e.loc.string(_$),o.footerAction=ro({objectGraph:e,target:{friends:{}},metricsPageInformation:null==r?void 0:r.sourcePageInformation,metricsLocationTracker:null==r?void 0:r.sourceLocationTracker}),o.footerStyle={$kind:_H,bundleID:gN,width:16,height:16}),o}async function mu(e,t,n,i){return await Va("inAppPurchasesShelf",async()=>{var a
if(!function(e,t){return t!==OV&&!e.client.isCompanionVisionApp}(e,e.host.platform))return null
if(o(t))return null
let c
if(c=ii(e)?he(t,GO):fe(t,OL),(0,Nv.isNothing)(c)||0===c.data.length)return null
if(0===c.data.filter(function(e){return H(e,gM)===i.isForSubscriptions}).length)return null
const l={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:KH,id:`${n.getSequenceId()}`,idType:sq},u=WF,d=new YY(u),f=V(t,eq)?NB:TH,h=Qe(e,t,oq),p=null===(a=i.options)||void 0===a?void 0:a.spotlightInAppProductIdentifier
!function(e,t,n){const o=Mq
for(const e of n.data){let n=fe(e,o)
n||(n={data:[t]}),r(e.relationships)&&(e.relationships={}),e.relationships[o]=n}}(0,t,c)
const w=[],g=function(e,t,n,r,o,i){const s=Rd(e,t,{lockupOptions:{metricsOptions:r,offerStyle:n,skipDefaultClickAction:!0,artworkUseCase:n6.LockupIconSmall},contentUnavailable:function(e,t){return w.push(t),!1}})
return o&&Vh(0,o,s),s}(e,c.data,f,l,p).filter(function(e){return e.productIdentifier===p&&(i.options.spotlightSection=new V0(nW,i.isForSubscriptions?bj:Tj)),e.isSubscription===i.isForSubscriptions})
if(0===g.length&&0===w.length)return null
if(d.items=await async function(e,t,n,r){if((0,Nv.isNothing)(n))return t
const o=[],i=[]
for(const e of t){const t=e.productIdentifier
o.push(t),e.isVisibleByDefault&&i.push(t)}const s=await M(e.clientOrdering.orderedVisibleIAPs(n,o,i,r))
return s.success?function(e,t){const n={}
for(const t of e)n[t.productIdentifier]=t
const r=[]
for(const e of t){const t=n[e]
if(t){const e=S(t)
r.push(e)}}return r}(t,s.value):t}(e,g,h,p),s(w)){const e=new e3(t.id,w,d.title,!1,void 0,u,f,null)
e.appBundleId=h,e.iapShelfContext=i,i.isForSubscriptions?e.inAppShelfId=bj:e.inAppShelfId=Tj,d.url=Bh(0,e,n)}let v
return i.isForSubscriptions?(d.title=e.loc.string("ProductPage.Section.Subscriptions.Title","Subscriptions"),v="subscription"):(d.title=e.loc.string("ProductPage.Section.InAppPurchases.Title"),v="iAP"),gh(e,l,d.title),mh(n.locationTracker),bh(n.locationTracker),d.isHorizontal=!0,n.addImpressionsToShelf(e,d,v),d})}function yu(e,t,n,r,s,a){return Bv.context(XG,()=>o(t)?null:function(e,t,n,r,o){return Bv.context("standardLinksShelf",()=>{const s=new YY("productPageLink"),{metricsPageInformation:a,locationTracker:c}=n,l=[]
if(e.client.deviceType!==Yq){const n=Qe(e,t,PL)
if(n){const t=new PY(n,!1),r=e.loc.string("DEVELOPER_WEBSITE")
l.push(new I5(r,t,k5))}}const u=Qe(e,t,jF)
if(u){const t=new PY(u,!1),n=e.loc.string(dx)
l.push(new I5(n,t,O5))}if(V(t,cC)){const n=function(e,t){const n=t.id,r=t.type
return i(t)&&i(n)&&i(r)?`${hW}:/${yW.eula}?resourceType=${r}&resourceId=${n}`:null}(0,t)
if(n){const t=new fY(eW)
t.pageUrl=n
const r=e.loc.string(cF)
l.push(new I5(r,t,E5))}}const d=f(Ke(e,t,rB),yD)
if((null==d?void 0:d.length)>0){const t=new PY(d,!1),n=e.loc.string(fx)
l.push(new I5(n,t,_5))}const h=e.bag.productPageReportProblemSADSubscriptionArray,p=t.id,w=h.includes(p),g=st(e).isSystemAppFromData(t),v=t.type===xq,m=r&&!g,y=e.bag.productPageReportProblemSecondPartyAppArray.includes(p)
if(!v&&!y&&!o&&e.bag.reportProblemEnabled&&(w||m)){const n=function(e,t){const n=t.id,r=e.bag.productPageReportProblemURL
return i(n)&&i(r)?r.replace("{productId}",n):null}(e,t)
if((null==n?void 0:n.length)>0){const t=new PY(n,!1),r=e.loc.string(ab),o=new I5(r,t,D5,w?null:p)
l.push(o)}}return l&&l.length>0&&(s.items=l),n.addImpressionsToShelf(e,s,vN),s})}(e,t,n,r,a))}function Au(e,t,n,i){const s=yd(e,t)
if(o(s))return null
const a=e.loc.string("BADGE_CATEGORY_HEADING"),c=new $5(Hq,Lj,{},Wq,a,s,null,s,a,TH)
if(new fY(eW).title=j(t,$V),n&&"tv"!==e.client.deviceType){const n=Sn(e,t,!0)
if(r(n))return null
c.artwork=Il(e,n,"bb")}return c}function Tu(e,t,n,r){const o=Ke(e,t,sD)
if(o){const t=Rf(0,e.host.clientIdentifier)
if(t){const n=p(o,t)
if(n){const t=h(n,OM),r=f(n,GP),o=f(n,lH),i=f(n,WH),s=e.loc.string("BADGE_CHART_POSITION_HEADING"),a=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",t.toString()),c=new $5(ox,ox,{position:e.loc.decimal(t)},Wq,s,r,null,a,r,nV),l=Ef(e,o,i)
if((0,Uv.isSome)(l)){const e=new fY(eG)
e.pageUrl=l,c.clickAction=e}return c}}}return null}function bu(e,t,n,r){var o
return null!==(o=function(e,t,n,r){const o=or(0,t)
if((0,Nv.isNothing)(o))return null
let i
i=n?function(e,t){const n=G(t,rT)
for(const e of n)if("IAC"===f(e,fH))return!0
return!1}(0,t)?e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon.InAppControls"):e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon"):e.loc.string("ProductPage.Badge.AgeRating.Caption")
const s=e.loc.string("ProductPage.Badge.AgeRating.Heading"),a=e.loc.string("ProductPage.Badge.AgeRating.AX.Caption"),c=sr(e,t),l=(0,Nv.isSome)(c)?Hq:AU,u=new $5(l,AU,{contentRating:o},Wq,s,i,void 0,o,a,nV)
return(0,Nv.isSome)(c)&&(u.isMonochrome=!1,u.artwork=Ot(e,Et(c),26,26)),u}(e,t,n))&&void 0!==o?o:function(e,t,n,r){const o=j(t,tT)
if((0,Nv.isNothing)(o))return null
const i={contentRating:o},s=q(t,"contentRatingsBySystem.appsBrazil.rank"),a=Lf(0,null!=s?s:void 0)
let c
a&&(i.contentRatingResource=a),c=n?e.loc.string(jP):e.loc.string(VP)
const l=e.loc.string("BADGE_AGE_RATING_HEADING"),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE")
return new $5(AU,AU,i,Wq,l,c,void 0,o,u,nV)}(e,t,n)}function Su(e,t,n,r){return function(e,t,n,r){if(lr(e,t)){let t,n
t=e.loc.string(ix),n=e.loc.string("ProductPage.Badge.GameController.Recommended")
const r=new $5(Cu(e),oF,{},Wq,t,n,void 0,void 0,n,nV)
return r.artwork=Iu(e),r.clickAction=zu(e)?new qY(ZH):new WY(new zY(nW,ZH)),r}return null}(e,t)}function Pu(e,t,n,r){return function(e,t,n,r){if(!cr(e,t)||function(e,t){switch(ur(e,t)){case Vx:case rL:case nL:return!0
default:return!1}}(e,t)||lr(e,t)||function(e,t){return"REQUIRED"===dr(e)}(e))return null
{let t,n
t=e.loc.string(ix),n=e.loc.string(OB)
const r=new $5(Cu(e),oF,{},Wq,t,n,void 0,void 0,n,nV)
return r.artwork=Iu(e),r.clickAction=zu(e)?new qY(ZH):new WY(new zY(nW,ZH)),r}}(e,t)}function Cu(e){return e.clientCapabilities.isEnabled("artworkControllerBadge")?Hq:oF}function Iu(e){const t=Ot(e,RN)
return t.imageScale=LH,t}function ku(e,t,n,o){const s=pe(e,t,PH),a=e.loc.string("BADGE_DEVELOPER_HEADING"),c=j(t,$V),l=new $5(Hq,PH,{},Wq,a,c,null,c,a,TH)
if(n&&"tv"!==e.client.deviceType){const t=Sn(e,s,!0)
r(t)?l.artwork=Ot(e,sx,26,26):l.artwork=Il(e,t)}const u=Of(0,s)
if(i(u)){const n=new fY(eW)
n.title=j(t,$V),n.pageUrl=u,s&&(n.destination=function({id:e,...t}){return{...t,id:dt(e),$kind:F5}}({...Di(e),id:s.id})),Qs(e,n,{targetType:xH,id:s.id,actionType:Xq,pageInformation:o.pageInformation,locationTracker:o.locationTracker}),l.clickAction=n}return l}function Ou(e,t,n,r){const o=Ke(e,t,dG)
if(o){const r=f(o,pM)
if(r&&r===wM){let r,o
r=G(t,eR)[0]===JB?e.loc.string("EDITORIAL_BADGE_GAMES"):e.loc.string("EDITORIAL_BADGE_APPS"),o=n?e.loc.string("EDITORS_CHOICE_RIBBON_HEADING"):e.loc.string("EDITORS_CHOICE_SINGLE_LINE")
const i=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),s=new $5(AH,AH,{},Wq,o,r,null,i,r)
return zu(e)?s.clickAction=new qY(AH):s.clickAction=new WY(new zY(nW,bq)),s}}return null}function Eu(e,t,r,o){const i=Ze(e,t,"supportedLocales"),s=(a=i).length<=0?null:{tag:f(n(a,"0.tag")).split("-")[0].toUpperCase(),name:f(n(a,"0.name"))}
var a
if(!s)return null
const c={paragraphText:s.tag}
let l
const u=i.length-1
l=u>0?e.loc.stringWithCount("ProductPage.Badge.Language.Caption",u).replace("{number_other_languages}",e.loc.formattedCount(u)):s.name
const d=e.loc.string("BADGE_LANGUAGE_HEADING")
return new $5(Pj,rF,c,Wq,d,l,null,null,l,nV)}function Ru(e,t,n,r){const o=tt(e,t,WN),s=tt(e,t,zN)
if(!i(o)||!i(s))return null
if(o<=0||s<=0||o>s)return null
const a=e.loc.string(HP),c=_u(e,o,s,!1),l=_u(e,o,s,!0),u=e.loc.string(HP),d={paragraphText:Du(e,o,s)}
return new $5(Pj,YV,d,Wq,a,c,null,l,u,nV)}function Du(e,t,n){return t===n?t<=32?e.loc.formattedCount(t):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(cD,e.loc.formattedCount(32)):n<=32?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(cD,e.loc.formattedCount(t)).replace(qP,e.loc.formattedCount(n)):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(cD,e.loc.formattedCount(t)).replace(qP,e.loc.formattedCount(32))}function _u(e,t,n,r){return 1===t&&1===n?e.loc.string("BADGE_PLAYERS_CAPTION_SINGLE"):1===t||r?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER"):e.loc.string("BADGE_PLAYERS_CAPTION_REQUIRED")}function Lu(e,t,n,r){const o=B(t,EB)
let i=null
const s=la(e,t)
if(!s&&o&&o.value&&o.ratingCount){const t=h(o,uD),n=Math.round(10*t)/10,r=e.loc.decimal(n,1),s=h(o,LP),a=e.loc.formattedCount(s)
let c
c=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.ShortTemplate",s).replace(dD,a)
const l=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.LongTemplate",s).replace(dD,a).replace("{rating}",r),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",r)
i=new $5(tj,tj,{rating:n,ratingFormatted:r},Wq,c,c,l,u,c)}else{if(n)return null
const t=e.loc.string(WP)
if(s&&t!==WP)i=new $5(tj,tj,{},Wq,null,t,null,t)
else if(!s){const t=e.loc.string("BADGE_NOT_ENOUGH_RATINGS_CAPTION")
i=new $5(tj,tj,{},Wq,null,t,null,t)}}if(i){let t
return t=new qY(gH),i.clickAction=zu(e)?t:new WY(new zY(nW,bq)),i}return null}function Mu(e,t,n,r){if((0,Nv.isSome)(B(t,iq)))return null
const o=q(t,"contentRatingsBySystem.appsAustralia.rank"),i=j(t,"contentRatingsBySystem.appsAustralia.name")
if((0,Nv.isSome)(o)&&(0,Nv.isSome)(i))return xu(e,n,"AU",o,i,!1)
const s=q(t,"contentRatingsBySystem.appsFrance.rank"),a=j(t,"contentRatingsBySystem.appsFrance.name")
if((0,Nv.isSome)(s)&&(0,Nv.isSome)(a))return xu(e,n,"FR",s,a,!1)
const c=q(t,"contentRatingsBySystem.appsKorea.rank"),l=j(t,"contentRatingsBySystem.appsKorea.name")
return(0,Nv.isSome)(c)&&(0,Nv.isSome)(l)?xu(e,n,"KR",c,l,!0):null}function xu(e,t,n,r,o,i){const s=null===(c=Df(0,r))||void 0===c?void 0:c[0],a=Lf(0,r)
var c
if((0,Nv.isNothing)(a)||(0,Nv.isNothing)(s))return null
const l=Hq,u=zP,d={contentRating:s},f=Wq,h=e.loc.string(`ProductPage.Badge.AgeRating.${n}.Heading`)
let p,w
p=t?e.loc.string(jP):e.loc.string(VP),w=o
const g=e.loc.string(`ProductPage.Badge.AgeRating.${n}.AX.Caption`),v=new $5(l,u,d,f,h,p,void 0,w,g,nV)
return v.isMonochrome=!i,v.artwork=Ot(e,`resource://${a}`,26,26),v}function $u(e,t,n,r){return t?Bv.context("badgesFromLookupResponse",()=>{let o,i=!1
return H(t,eq)?o=N5:n?(o=U5,-1===o.indexOf(Ou)&&o.splice(1,0,Ou),i=!0):o=B5,function(e,t,n,r,o,i){const s=[]
for(const o of t){const t=o(e,n,r,i)
t&&s.push(t)}if(o&&s.some(e=>e.key===ox)){const e=s.findIndex(e=>e.key===Lj)
e>=0&&s.splice(e,1)}return s}(e,o,t,n,i,r)}):[]}function Fu(e,t,n,r,o,i){return Bv.context(uC,()=>i?null:Sa(e,t.id,o,n,null))}function Nu(e,t){const n=f(t,iD)
if(n){const t=new PY(n,!1)
return t.title=e.loc.string(MP),t.artwork=Ot(e,TO),t}return null}function Bu(e){var t
if((0,Nv.isSome)(e)){const n=null!==(t=e.presentationHints)&&void 0!==t?t:{}
e.presentationHints={...n,isSeeAllContext:!0}}}function Uu(e,t,n,r,o){const i=`${hW}:/${yW.product}/${yW.shelf}/`+Uh(n,r,o),s=new qW(i)
return s.param(DW.shelfRefreshType,GW),s.param(DW.id,t),s.build()}function Gu(e){return e.featureFlags.isEnabled(hJ)}function ju(e,t){return t?t.map(t=>Vu(e,t,wC)):[]}function Vu(e,t,n){return Bv.context("titledParagraphFromVersionHistoryEntry",()=>{let r=f(t,gC);(0,Nv.isSome)(r)&&(r=r.trim())
const o=new q5(r,n),i=f(t,PD),s=e.loc.string("VERSION_STRING_TEMPLATE")
o.primarySubtitle=n===wC?i:s.replace("{version}",i)
const a=f(t,"releaseTimestamp")
if(a){const t=new Date(a)
o.secondarySubtitle=e.loc.relativeDate(t)}return o})}async function Hu(e,t,n,a,c,l=!1){return await Va("createProductPageFromResponse",async()=>{var d
const p=yt(e,t)
if(o(p))return null
p.type
const w=null==a?void 0:a[X6],g=yt(e,w),v=s(g)?c:null,m=s(g)?null:c,y=function(e,t,n){var r
const o=yt(e,t),s=o.type===xq
i(n)&&(n.iAdClickFields&&(t[$J]=JSON.stringify(n.iAdClickFields)),n.iAdLineItem&&(t[FJ]=n.iAdLineItem))
const a=Un(e,s?EM:mV,o.id,t),c=new qW(a.pageUrl)
return null!==(r=null==n?void 0:n.webBrowser)&&void 0!==r&&r&&(c.param(hR,CS),c.removeParam(tx),c.removeParam(JP),a.pageUrl=c.build()),new K6(a,{rootPosition:0,locationStack:[]})}(e,t,n),b=qu(e,p,y,n,g,m,v,l)
y.metricsPageInformation.baseFields[$M]=dh(e,p,b.lockup.icon,null==n?void 0:n.clientIdentifierOverride),(Kt(e,NH)||Kt(e,rH))&&(y.metricsPageInformation.adPageInfo=new x0(e,NH,x0.createInitialPageSlotInfos(e,NH,null,null,null)))
const P=cf(e,p),C=null!==(d=null==n?void 0:n.webBrowser)&&void 0!==d&&d
C||jn(e,b,y.metricsPageInformation,t=>{const n=pf(0,p,e.appleSilicon.isSupportEnabled),r=Tf(e,p,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),o=yf(e,p,P,e.client.deviceType,n,!1,r),i=bf(0,P,e.client.deviceType,n,!1),a=P&&(o||i),c=function(e,t,n,r){if(!Bd(e,t))return!1
if(at(e,t,Wv.ThirtyTwoBit|Wv.UnsupportedSystemDeletableApps|Wv.MinimumOSRequirement|Wv.UnsupportedPlatform|Wv.MacOSRosetta))return!1
const o=vf(0,n,pf(0,t,r),!1),i=cf(e,t)
return o.some(e=>mf(i,e))}(e,p,e.client.deviceType,e.appleSilicon.isSupportEnabled)
t[fD]=a&&c?"runnable":a?"purchasable":rq,s(m)&&oW.shared.addReferralContextToMetricsFieldsIfNecessary(t)},C)
const I=Nr(t,!0)
return await async function(e,t,n,a,c,l,d){var p,w
const g=cf(e,n),v=n.type===xq,m=V(n,eq),y=!(1===g.length&&g[0]===Yq),b=la(e,n),P=!!y&&!m&&!b,C=s(c)?c.clientIdentifierOverride:null,I=H(n,VU),k=t.lockup.offerDisplayProperties,O=!i(k)||k.isFree
let E
if(v){const t=fe(n,Kq)
E=function(e,t,n,r){return n?Bv.context("bundleChildrenShelf",()=>{const o=dq,i=new YY(o)
i.isHorizontal=!0
const s=n.data.length
if(!s)return null
i.title=e.loc.stringWithCount("ProductPage.AppsInBundleShelf.Title",s)
const a=Gh(e,n,r,n6.LockupIconSmall,o,null,Wv.Bundles,null,e.featureFlags.isEnabled(gJ))
if(a.remainingItems.length){const e=new e3(t.id,a.remainingItems,i.title,!1,void 0,dq,TH,null)
e.isBundleShelf=!0,i.url=Bh(0,e,r)}return gh(e,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:KH,id:`${r.getSequenceId()}`,idType:sq},i.title),i.items=a.items,mh(r.locationTracker),r.addImpressionsToShelf(e,i,NG),bh(r.locationTracker),i.rowsPerColumn=s<2?1:2,i}):null}(e,n,t,a)}E&&(t.shelfMapping[NG]=E)
const R=fe(n,xq),D=function(e,t,n,r){return n?Bv.context("bundleParentsShelf",()=>{const o=n.data.length
if(!o)return null
const i=dq,a=new YY(i)
a.isHorizontal=!0,a.title=e.loc.string("ProductPage.Section.IncludedInBundles.Title")
const c=Gh(e,n,r,n6.LockupIconSmall,i)
if(0===c.remainingItems.length&&0===c.items.length)return null
if(a.items=c.items,s(c.remainingItems)){const e=new e3(t.id,c.remainingItems,a.title,!1,void 0,i,TH,null)
e.isBundleShelf=!0,a.url=Bh(0,e,r)}return a.rowsPerColumn=o<2?1:2,r.addImpressionsToShelf(e,a,"bundleParent"),a}):null}(e,n,R,a)
D&&(t.shelfMapping[mG]=D)
const _={productTitle:t.title,shouldShowRatingsAndReviews:P,isFirstPartyHideableApp:I,isBundle:v,isPreorder:m},L=function(e,t,n,r,i){return Bv.context("createReviewsShelves",()=>{const a={}
if(o(t))return a
const c=function(e,t){if(zu(e))return!0
if(o(t))return!1
let n
return n=st(e).isSystemAppFromData(t),!n||e.bag.enableSystemAppReviews}(e,t),l=cf(e,t),d=fe(t,bq),p=At(d),w=B(t,EB)
w.ratingAverage=h(w,uD),w.adamId=t.id,w.isBundle=r.isBundle,w.supportUrl=Qe(e,t,SL)
const g=Jd(e,t,{useCase:n6.LockupIconMedium}),v=1===l.length&&"tv"===l[0],m=Ma(e),y=u(w,nD),T=function(e,t,n,r){return Bv.context("createProductRatings",()=>{const n=wa(e,e.client.guid,jV,t)
return n.ratingAverage>0&&n.ratingCounts||r||(n.status=e.loc.string(oD)),n})}(e,w,p.length,y),b=function(e,t,n,r,o,i){return Bv.context(uC,()=>{const r=Fu(e,t,n,0,o,i)
if(r){const e=new j5
return e.actionType=py,e.action=r,e.id="ProductReviewAction.TapToRate",e}return null})}(e,t,r.productTitle,0,r.isBundle,v),P=function(e,t,n,r,o,i,s){return Bv.context("createWriteAReview",()=>{if(r)return null
{const r=new V5
r.writeReviewAction=Ca(e,t,i,s,o),r.supportAction=Nu(e,n)
const a=new j5
return a.actionType="writeAReview",a.action=r,a}})}(e,t,w,v,g,i,r.productTitle),C=Bv.context(_P,()=>null),I=function(e,t,n){return Bv.context("createReviewSummaryProductReview",()=>{const r=ga(e,t,n)
if((0,Nv.isNothing)(r))return null
const o=new DY
return o.review=r,o.sourceType=Nj,o})}(e,t,n),k=ga(e,t,n),O=ha(e,w,p,!0,C,I,n),E=ha(e,w,p,!0,null,null,n)
if(function(e,t,n,r,o,i,s,a){Bv.context("createProductReviewActions",()=>{const c=new H5
return c.tapToRate=Fu(e,t,n,0,o,i),c.writeReviewAction=Ca(e,t,a,n,s),c.supportAction=Nu(e,r),c})}(e,t,r.productTitle,w,r.isBundle,v,g,i),v||0===p.length||La(e,e.client.guid,w,p,d.next,r.productTitle,g,!1,!1,t,n),r.shouldShowRatingsAndReviews){const o=new YY(gH)
o.title=m,o.items=[T],a.ratingsShelf=o,n.addImpressionsToShelf(e,o,"ratingsOverview",null,null,null,e.loc.string("ProductPage.Section.Reviews.Title"))
const i=[]
if(s(b)&&c&&i.push(b),s(P)&&c&&i.push(P),s(i)){const e=new YY(TD)
e.items=i,a.allReviewActionsShelf=e}if(s(k)){const e=new YY(Nj)
e.items=[k],a.reviewSummaryShelf=e}let l=null
s(b)&&c&&(l=new YY(TD),l.items=[b],a.tapToRateActionsShelf=l)
let u=null
s(P)&&c&&(u=new YY(TD),u.items=[P],a.writeAReviewActionsShelf=u)
const h=e.loc.string(bD),g=e.loc.string(nF),y=(0,Nv.isSome)(E)&&E.length>0
let D,_
if((0,Nv.isSome)(O)&&O.length>0&&(D=new YY(Fx),D.items=O,D.isHorizontal=!0,y?(D.title=h,D.contentsMetadata={type:"productReviewsSection",hasReviewSummary:(0,Nv.isSome)(I),reviewSummaryTitle:g},n.addImpressionsToShelf(e,D,tD,null,null,null,e.loc.string(bD))):D.title=g,a.allProductReviewsShelf=D),y&&(_=new YY(Fx),_.items=E,_.isHorizontal=!0,_.title=h,n.addImpressionsToShelf(e,_,tD,null,null,null,e.loc.string(bD)),a.userProductReviewsShelf=_),"tv"===e.client.deviceType){const t=new YY(SD)
t.title=m
const n=[]
s(b)&&A(R=b.action)&&"TapToRate"===R[tW]&&c&&n.push(b.action),s(T.status)?e.featureFlags.isEnabled(vJ)?n.push(new G5(T.status)):n.push(Ta(T)):(n.push(ya(T)),n.push(Aa(T))),t.items=n,a.purchasedRatingsAndReviewsComponentShelf=t}if("tv"===e.client.deviceType){const t=new YY(SD)
t.title=m
const n=[]
s(T.status)?e.featureFlags.isEnabled(vJ)?n.push(new G5(T.status)):n.push(Ta(T)):(n.push(ya(T)),n.push(Aa(T))),t.items=n,a.notPurchasedRatingsAndReviewsComponentShelf=t}let L=null
s(C)&&(L=new YY(Fx),L.items=[C],r.shouldShowRatingsAndReviews?C.review.showsBadge||(L.title=e.loc.string(iC)):L.title=m,a.editorsChoiceProductReviewsShelf=L)
!v&&!(r.isBundle&&!1)&&p.length>0&&(a.ratingsShelf.seeAllAction=function(e,t,n,r,o,i=null,s,a,c){return r?Bv.context(UP,()=>{var t
const l=new QY
let u,d,h
if((0,Nv.isSome)(null==c?void 0:c.allReviewActionsShelf)){u=S(c.allReviewActionsShelf)
const e=null!==(t=u.presentationHints)&&void 0!==t?t:{}
u.presentationHints={...e,displayIfReviewable:!0},Bu(u)}if((0,Nv.isSome)(null==c?void 0:c.ratingsShelf)){d=S(c.ratingsShelf)
const e=d.items[0]
if((0,Nv.isSome)(e)&&1===d.items.length){const t=S(e)
t.context=hL,d.items=[t]}d.seeAllAction=null,d.title=null,Bu(d)}(0,Nv.isSome)(null==c?void 0:c.reviewSummaryShelf)&&(h=S(c.reviewSummaryShelf),Bu(h))
const p=Da(e,0,n,r,o,i,s,a,eD,{ratingsShelf:d,reviewSummaryShelf:h,reviewActionsShelf:u})
l.title=null,l.adamId=f(r,SV),l.nextPage=p.paginationToken,l.initialSortOptionIdentifier=p.initialSortId,l.sortActionSheetTitle=p.sortActionSheetTitle,l.sortOptions=p.sorts,(0,Nv.isSome)(d)&&l.shelves.push(d),(0,Nv.isSome)(h)&&l.shelves.push(h),(0,Nv.isSome)(u)&&l.shelves.push(u),l.shelves.push(p.reviewsShelf)
const w=Ea(e);(0,Nv.isSome)(w)&&(l.trailingNavBarAction=w)
const g=new fY(bq)
return g.pageData=l,g.title=e.loc.string(KV),g}):null}(e,e.client.guid,t.id,w,p,d.next,!1,!1,a))}var R
return a})}(e,n,a,_,t.lockup.subtitle)
s(L)&&(t.shelfMapping[_U]=L.purchasedRatingsAndReviewsComponentShelf,t.shelfMapping[DU]=L.notPurchasedRatingsAndReviewsComponentShelf,t.shelfMapping[gH]=L.ratingsShelf,t.shelfMapping[sF]=L.allReviewActionsShelf,t.shelfMapping[OU]=L.allProductReviewsShelf,t.shelfMapping[wG]=L.userProductReviewsShelf,t.shelfMapping[AH]=function(e,t){const n=function(e,t){return Bv.context(_P,()=>{const n=f(Ke(e,t,dV),Wq)
if(n){const r=new N0(n),o=Ke(e,t,dG)
if(o){const e=f(o,pM)
r.showsBadge=e&&e===wM}return r.showsBadge||(r.title=e.loc.string(px)),r}return null})}(e,t)
if((0,Uv.isNothing)(n))return null
const r=new YY(AH)
return r.items=[n],n.showsBadge?r.background={type:AH}:r.title=e.loc.string(iC),r}(e,n),t.shelfMapping[EU]=L.tapToRateActionsShelf,t.shelfMapping[RU]=L.writeAReviewActionsShelf,t.shelfMapping[aF]=L.productReviewsHeader)
{const n=function(e){if(o(e.bag.ratingsAndReviewsLearnMoreEditorialId))return null
const t=new YY(rj),n=function(e){const t=e.loc.string(dC),n={},r=function(e){const t=e.bag.ratingsAndReviewsLearnMoreEditorialId
if(o(t))return null
const n=new fY(cq)
return n.title=e.loc.string(dC),n.pageUrl=`https://apps.apple.com/story/id${t}`,n}(e)
if((0,Nv.isNothing)(r))return null
n[t]=r
let i=e.loc.string("ProductPage.RatingsAndReviews.Footer")
i=i.replace(pj,t)
const s=new i5(i,kV)
return new s5(s,n)}(e)
return(0,Nv.isNothing)(n)?null:(t.items=[n],t)}(e);(0,Nv.isSome)(n)&&(t.shelfMapping[_j]=n)}const $=function(e,t,n){const r=ga(e,t,n)
if((0,Nv.isNothing)(r))return null
const o=new YY(Nj)
return o.items=[r],o}(e,n,a);(0,Nv.isSome)($)&&(t.shelfMapping[Nj]=$)
const F=function(e,t,n,r){return Bv.context(XG,()=>function(e,t,n,r,o,i){return Bv.context("standardMostRecentVersionShelf",()=>{if(!n&&!r&&!o){const n=Ze(e,t,QB)
if(n.length>1&&ju(e,n).length>0){const r=new YY(pC)
r.title=e.loc.string(fC)
const o=Vu(e,n[0],hC)
if(r.items=[o],i.addImpressionsToShelf(e,r,QB),r)return e.client.deviceType!==zq&&(r.seeAllAction=function(e,t,n,r){return Bv.context("versionHistorySeeAllAction",()=>{const o=function(e,t,n){return Bv.context("versionHistoryPageAction",()=>{const r=ju(e,t)
let o
if(r.length>0){const t=new YY(pC)
t.items=r
const i=new ZY([t])
i.title=e.loc.string("VERSION_HISTORY_PAGE_TITLE","Version History"),e.client.deviceType!==zq&&(i.presentationOptions=[WG])
const s=Gn(e,"VersionHistory",n,"")
jn(e,i,s)
const a=new fY(QB)
a.title=e.loc.string("ACTION_VERSION_HISTORY_SEE_ALL"),a.pageData=i,o=a}return o})}(e,t,n)
return Xs(e,o,null,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o})}(e,n,t.id,i)),r}}return null})}(e,t,r.isFirstPartyHideableApp,r.isBundle,r.isPreorder,n))}(e,n,a,{isFirstPartyHideableApp:I,isBundle:v,isPreorder:m})
F&&(t.shelfMapping[LV]=F),t.shelfMapping[yG]=function(e,t,n){return Bv.context("textCardShelfFromResponse",()=>(o(t),null))}(0,n)
const N=Qe(e,n,oq)
if(e.bag.enablePrivacyNutritionLabels&&!Mi(e,n.id)&&!xi(e,N)){const s=function(e,t,n,r){return Bv.context("privacyShelf",()=>{if(o(t))return null
const i=new YY(YH)
i.title=e.loc.string(KM)
const s=Tl(e,t,!1,!1,n,r)
return i.items=[s],e.client.deviceType!==zq&&"tv"!==e.client.deviceType&&(i.seeAllAction=Cl(e,t,ej,n,r,null)),i})}(e,n,a.metricsPageInformation,a.locationTracker),c=function(e,t,n){return Bv.context(XG,()=>{if(o(t))return null
const r=B(t,p$)
if((0,Uv.isNothing)(r)||o(r))return null
const i=new YY(QM),s=e.loc.string(KM)
gh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:QR,id:`${n.getSequenceId()}`,idType:sq},s)
const a=hl(e,r,t,jV,!0,n.metricsPageInformation,n.locationTracker)
return null===a||0===a.length?null:(i.items=a,a.length<=2&&(i.presentationHints={isLowDensity:!0}),i.title=s,n.addImpressionsToShelf(e,i,"appPrivacy"),mh(n.locationTracker),bh(n.locationTracker),i.title=null,i)})}(e,n,a)
if(i(s)&&i(c)){t.shelfMapping[YH]=s,i(c)&&(t.shelfMapping[GH]=c)
const l=function(e,t,n,s){return Bv.context(XG,()=>{if(o(t))return null
const a=Pl(e,t,!1,ej,n,s)
if((1===a.length&&a[0].identifier===YR||0===a.length)&&"tv"!==e.client.deviceType)return null
const c=new YY(OH),l=function(e,t,n,o){return Bv.context("privacyFooterFromData",()=>{const t=function(e,t,n,o){let i
const s=e.loc.string(JR),a={},c=bl(e,n,o)
r(c)?i=e.loc.string(KR):(i=e.loc.string(pP),i=i.replace(pj,s),r(c)?i=e.loc.string(KR):a[s]=c)
const l=new i5(i,kV)
return new s5(l,a)}(e,0,n,o),s=function(e,t,n,r){if("tv"!==e.client.deviceType)return[]
const o=[],s=bl(e,n,r)
i(s)&&o.push(s)
const a=Sl(e,n,r)
return i(a)&&o.push(a),o}(e,0,n,o)
return new a5(t,s,[].length)})}(e,0,n,s)
return c.items=[l],c})}(e,n,a.metricsPageInformation,a.locationTracker)
i(l)&&(t.shelfMapping[OH]=l)}}const U=new c5,G=new c5,q=new c5,W=new c5,z=new c5,Y=Bf(e,n),J=function(e,t,n,o,i,s,a,c){return Bv.context(XG,()=>{let l
switch(e.client.deviceType){case zq:l=function(e,t,n,o){return Bv.context(CD,()=>{let i
const s=gu(e,t)?b5:T5,a=pu(e,s,t,n,!1,!1,o,void 0)
return a.length>0&&(i=new YY(SG),i.items=a,r(o)||o.addImpressionsToShelf(e,i,Aq)),i})}(e,t,n,o)
break
case"tv":l=function(e,t,n,o,i,s,a){return Bv.context("tvInformationShelf",()=>{let c
const l=pu(e,S5,t,n,!1,!1,o,a),u=function(e,t,n,r){return Bv.context("productCapabilitiesAsAnnotations",()=>{const o=[],i=tu(e,t,n,r.metricsPageInformation,r.locationTracker)
for(const e of i){const t=e.title,n=e.caption.styledText.rawText
if((null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0){const e=new f5(n),r=new h5(t,[e])
0===r.items_V3.length&&(r.items_V3=wu(0,r)),o.push(r)}}return o})}(e,t,s,o).concat(pu(e,P5,t,n,!1,!1,o,a)),d=tr(e,yC),f=pu(e,d?[Hl]:[hu],t,n,!1,!0,o,a),h=[]
if(l.length>0){const t=new y5(e.loc.string(vD),l,i)
h.push(t)}if(u.length>0){const t=new y5(e.loc.string(mD),u,i)
h.push(t)}if(f.length>0){const t=d?e.loc.string("ProductPage.Section.ExternalPurchases.Title"):e.loc.string("ProductPage.Section.TopInAppPurchases.Title"),n=new y5(t,f,!0)
h.push(n)}return h.length>0&&(zu(e)?(c=new YY("annotationGroup"),c.items=h,c.background={type:AD},r(o)||o.addImpressionsToShelf(e,c,Aq)):(c=new YY("informationContainer"),c.items=[new A5(h)],r(o)||o.addImpressionsToShelf(e,c,Aq))),c})}(e,t,n,o,c,a,i)
break
default:l=function(e,t,n,o,i,s){return Bv.context(CD,()=>{let a
const c=gu(e,t)?b5:T5,l=pu(e,c,t,n,i,!1,o,s)
return l.length>0&&(a=new YY(SG),a.title=e.loc.string(vD),a.items=l,r(o)||o.addImpressionsToShelf(e,a,Aq)),a})}(e,t,n,o,s,i)}return l})}(e,n,I,a,(n,r,o)=>{var s,a,c
if(n===Nl&&(U.setShelfId(Aq,o),U.annotation=r,t.ageRatingAction=new qY(Aq,null,null,void 0,o,!0),t.ageRatingAction.title=e.loc.string("ProductPage.Banner.AskForException.Review.ViewAgeRatingLink")),n===xl&&i(t.banner)){i(t.banner.fullProductAction)&&(t.banner.action=t.banner.fullProductAction)
const n=t.banner.action
i(n)&&(zu(e)?T(c=n)&&c[tW]===My&&(null===(s=n.shelfId)||void 0===s?void 0:s.length)>0&&n.shelfId===Aq&&n.indexId===CU&&(n.index=o):function(e){return T(e)&&e[tW]===_y}(n)&&(null===(a=n.section.shelfId)||void 0===a?void 0:a.length)>0&&n.section.shelfId===Aq&&n.indexId===CU&&(n.index=o))}n===Kl&&(G.setShelfId(Aq,o),G.annotation=r),n===du&&(q.setShelfId(Aq,o),q.annotation=r),n===Ml&&(W.setShelfId(Aq,o),W.annotation=r),n===Jl&&(z.setShelfId(Aq,o),z.annotation=r)},Y,O,!1)
J&&(t.shelfMapping[Aq]=J)
const K=function(e,t,n,r){var o
if(!oi(e))return null
let i=ge(t,uL)
if(((0,Nv.isNothing)(i)||0===i.length)&&(i=we(t,Vq)),(0,Nv.isNothing)(i)||0===i.length)return null
const s=he(t,uL),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:null!==(o=St(s))&&void 0!==o?o:void 0},c=i.some(e=>e.type!==Vq),l=c?"ProductPage.Section.AppEventsAndOffers.Title":"ProductPage.Section.AppEvents.Title",u=e.loc.string(l),d=c?"EventsAndOffers":"Events"
gh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:a.recoMetricsData,targetType:KH,id:d,idType:rq},u)
const f=hi(e,i,t,!c,!1,a,!1,!1,!1,!1);(0,Nv.isSome)(f.nextAppEventPromotionStartDate)&&Br(f.nextAppEventPromotionStartDate,r)
const h=f.appPromotions
if(0===h.length)return mh(a.locationTracker),null
const p=qa(0,h,u)
return n.addImpressionsToShelf(e,p,KH,d,rq,a.recoMetricsData),mh(a.locationTracker),bh(a.locationTracker),p}(e,n,a,l)
if(i(K)&&(t.shelfMapping[MH]=K),Y){const r=function(e,t,n){if(o(t))return null
const r=f(Ke(e,t,dV),Wq)
if(r){const t=e.loc.string("APP_STORE_EDITORS_ATTRIBUTION"),o=new L5(r,t),i=new YY(_V)
return i.items=[o],n.addImpressionsToShelf(e,i,_V),i.background={type:cV,color:Se(hx)},i}return null}(e,n,a)
r&&(t.shelfMapping[_V]=r)}t.shelfMapping[oj]=yu(e,n,a,!1,0,Y),t.shelfMapping[Jj]=yu(e,n,a,!0,0,Y),t.shelfMapping[CF]=function(e,t,n){return Bv.context(XG,()=>{if("tv"!==e.client.deviceType)return null
if(o(t))return null
const r=new YY(Pj)
r.isHorizontal=!1
const i=function(e,t){return t?Bv.context("externalProductLinksAsParagraphsFromData",()=>{const n=[],r=Qe(e,t,PL)
if(r){const t=e.loc.string("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",r),o=new AX(t)
e.featureFlags.isEnabled(vJ)&&(o.style=YF),o.alignment=fq,n.push(o)}return n}):null}(e,t)
return i&&i.length>0&&(r.items=i),zu(e)&&(r.background={type:AD}),n.addImpressionsToShelf(e,r,vN),r})}(e,n,a)
const Z=function(e,t,n,r){return Bv.context("capabilitiesShelf",()=>{if(o(t))return null
const i=nt(e,t)
if(o(ce(t,i,oq)))return null
const s=tu(e,t,n,r.metricsPageInformation,r.locationTracker)
if(o(s))return null
const a=new YY("productCapability")
return a.title=e.loc.string(mD),a.items=s,a.mergeWhenFetched=!0,a.batchGroup=hV,r.addImpressionsToShelf(e,a,"supports"),a})}(e,n,O,a)
Z&&(t.shelfMapping[ZH]=Z)
const Q=null!==(p=null==c?void 0:c.webBrowser)&&void 0!==p&&p
if(!Q){const r=fe(n,h$)
if(s(r)){const i=function(e,t,n,r){return Bv.context("smallStoryShelf",()=>{var i
if(o(n))return null
const a={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:KH,id:`${r.getSequenceId()}`,idType:sq},c=e.loc.string(sC)
gh(e,a,c)
const l=[],u=function(e){return l.push(e),!1}
let d
if(Gu(e)){const t=new bZ(a.pageInformation,a.locationTracker)
d=Vc(e,n,c,null,t,u)}else{const t={metricsLocationTracker:a.locationTracker,metricsPageInformation:a.pageInformation,filterOutMediaCardKinds:new Set([BN])}
d=jc(e,n,pV,c,null,t,u),Array.isArray(d.items)&&(d.items=d.items.filter(e=>!Bt(e)||Uc(0,e.media.kind,pV)))}if(d.isHorizontal=!0,!(null===(i=d.items)||void 0===i?void 0:i.length)&&0===l.length)return null
if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=zv.OnShelfWillAppear),s(l)){mh(r.locationTracker),r.addImpressionsToShelf(e,d,tH),bh(r.locationTracker)
const n=new e3(t.id,l,d.title,!1,void 0,d.contentType,null,null,null,null,null,Lm.SmallStory)
Qa(e,d,n),d.url=Bh(0,n,r)}else mh(r.locationTracker),r.addImpressionsToShelf(e,d,tH),bh(r.locationTracker)
return d})}(e,n,r.data,a)
i&&(t.shelfMapping[tH]=i)}}const X={isPreorder:m},ee=new c5,te=function(e,t,n,r){return Bv.context("friendsPlayingShelf",()=>{if(o(t))return null
const i=t.id
if(o(i))return null
if(!et(e,t,fB))return null
if(r.isPreorder)return null
const s=e.loc.string("ProductPage.Section.FriendsPlaying.Title","Playing This Game"),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:KH,id:`${n.getSequenceId()}`,idType:sq}
gh(e,a,s)
const c=new YY(aC)
c.header=oo(e,s),c.isHidden=!0,c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new e3(t.id,[],c.title,!1,void 0,null,null,null)
c.url=`${hW}:/${yW.product}/${yW.shelf}/?${DW.isGameCenterPlayerShelf}=true&${DW.id}=${i}&${DW.token}=${Uh(l,n,n.metricsPageInformation)}`,c.batchGroup=hV,n.addImpressionsToShelf(e,c,tq),mh(n.locationTracker),bh(n.locationTracker)
const u=new fY(eW)
return Xs(e,u,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),c})}(e,n,a,X)
te&&(t.shelfMapping[tq]=te,ee.setShelfId(tq))
const ne=function(e,t,n,r){return Bv.context("achievementsShelf",()=>{if(o(t))return null
if(r.isPreorder)return null
if(!et(e,t,fB))return null
const i=nt(e,t),s=ce(t,i,oq)
if(o(s))return null
const a=e.loc.string("ProductPage.Section.Achievements.Title",nj),c=new YY(oC)
c.header=oo(e,a),c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new e3(t.id,[],c.title,!1,void 0,null,null,null)
return l.sourceLocationTracker=n.locationTracker,l.destinationPageInformation=n.metricsPageInformation,c.url=`${hW}:/${yW.product}/${yW.shelf}/?${DW.isGameCenterAchievementsShelf}=true&${DW.bundleId}=${s}&${DW.token}=${Uh(l,n,n.metricsPageInformation)}`,c.batchGroup=hV,bh(n.locationTracker),c.footerTitle=e.loc.string(_$),c.footerAction=ro({objectGraph:e,target:{pageAchievements:{}},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker}),c.footerStyle={$kind:_H,bundleID:gN,width:16,height:16},c})}(e,n,a,{isPreorder:m})
if(ne&&(t.shelfMapping[Cq]=ne),!d&&!Q){const r=function(e,t,n){return Bv.context("moreByDeveloperShelf",()=>{if(o(t))return null
const r=Of(0,pe(e,t,PH)),i=j(t,$V)
let a,c
if(a=fe(t,SF),!a||0===a.data.length)return null
c=a.data
const l=e.loc.string("ProductPage.Section.MoreByDeveloper.TitleTemplate").replace("{developer}",i)
let u
switch(gh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:KH,id:`${n.getSequenceId()}`,idType:sq},l),e.client.deviceType){case Yq:case"tv":u=VH
break
default:u=dq}const d=new YY(u)
d.title=l
const f=null,h=e.client.isCompanionVisionApp?Wv.VisionOSCompatibility:void 0
let p
if((0,Nv.isSome)(a)?p=Gh(e,a,n,Hd(0,u),u,f,h):(0,Nv.isSome)(c)&&(p=jh(e,c,n,Hd(0,u),u,f,h)),!p)return null
d.items=p.items,d.isHorizontal=!0,c.length<2?d.rowsPerColumn=1:d.rowsPerColumn=2
{const t=new fY(eW)
t.pageUrl=r,t.title=e.loc.string(KV),Xs(e,t,t.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),d.seeAllAction=t}if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=zv.OnShelfWillAppear),s(p.remainingItems)){mh(n.locationTracker),n.addImpressionsToShelf(e,d,PH),bh(n.locationTracker)
const o=new e3(t.id,p.remainingItems,d.title,!1,void 0,u,f,null,null,null,null,Lm.MoreByDeveloper)
o.developerUrl=r,Qa(e,d,o),d.url=Bh(0,o,n)}else mh(n.locationTracker),n.addImpressionsToShelf(e,d,PH),bh(n.locationTracker)
return d})}(e,n,a);(0,Nv.isSome)(r)&&(t.shelfMapping[kH]=r)}if(!d&&!Q){const r=function(e,t,n){return Bv.context("similarItemsShelf",()=>{var r
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const i=fe(t,vG)
if(o(i))return null
const a=Bf(e,t),c=a?e.loc.string("Arcade.ProductPage.MoreFromAppleArcade"):e.loc.string("ProductPage.Section.SimilarItems.Title"),l=HH,u=kU
let d,f
switch(gh(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:l,id:K6.similarItemsShelfId,idType:u},c),e.client.deviceType){case"tv":d=VH,f=!1
break
case Yq:d=VH,f=!0
break
default:d=dq,f=!0}const h=new YY(d)
h.title=c
const p=St(i),w=Gh(e,i,n,Hd(0,d),d,null,null,p)
if(!w)return null
h.items=w.items
const g=Kt(e,NH),v=Gn(e,"SimilarItems",t.id,""),m=new e3(t.id,i.data,h.title,f,void 0,d,null,null,null,null,null,Lm.SimilarItems)
{const e=Uu(0,t.id,m,n,v)
h.refreshUrl=e}if(h.isHorizontal=!0,i.data.length<2?h.rowsPerColumn=1:h.rowsPerColumn=a?2:3,e.bag.isOnDemandShelfFetchingEnabled&&(h.fetchStrategy=zv.OnShelfWillAppear),s(w.remainingItems)||g){mh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),bh(n.locationTracker)
const o=new e3(t.id,null!==(r=w.remainingItems)&&void 0!==r?r:[],h.title,f,void 0,d,null,null,h.refreshUrl,p,a,Lm.SimilarItems)
if(Qa(e,h,o),h.url=Bh(0,o,n,v),g){const e=new qW(h.url)
e.param(DW.isShelfWithAd,XH),e.param(DW.shelfWithAdPlacementType,NH),e.param(DW.id,t.id),h.url=e.build()}}else mh(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,h,l,u),bh(n.locationTracker)
return h})}(e,n,a);(0,Nv.isSome)(r)&&(t.shelfMapping[HH]=r)}const re={isForSubscriptions:!0,options:c},oe=await M(mu(e,n,a,re))
oe.success&&(0,Nv.isSome)(oe.value)&&(t.shelfMapping[bj]=oe.value)
const ie={isForSubscriptions:!1,options:c},se=await M(mu(e,n,a,ie))
se.success&&(0,Nv.isSome)(se.value)&&(t.shelfMapping[Tj]=se.value)
const ae=function(e,t,n,r){return Bv.context("productMediaShelves",()=>{if(o(t))return null
const i=(e.client.deviceType,null),a=(e.client.deviceType,null),c=Ge(e,t),l=of(e,t,n6.ProductPageScreenshots,i,c,n),u=tf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},a)
let d=null
if(u)for(const e of l)if(e.mediaPlatform.isEqualTo(u.mediaPlatform)){d=e
break}let f=null
if(d){const e=d.mediaPlatform.appPlatform
if(e===jq||e===qH)for(const e of d.items){const t=e.screenshot
if(f=t.width/t.height,f<1)break}}const h=[],p=[]
if(d&&u&&u.videos)for(const n of u.videos){const o=new rz
o.video=n
const i=n.preview.width/n.preview.height,s=null===f||Math.abs(i-f)<.01,a=d.mediaPlatform.isEqualTo(u.mediaPlatform)
s&&a?h.push(o):p.push(n)
const c={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,id:t.id,isAdvert:!!r.metricsPageInformation.adPageInfo&&r.metricsPageInformation.adPageInfo.adIsPresent}
po(e,n,c)}d&&(d.items=h.concat(d.items))
let w=[],g={}
for(let n=0;n<l.length;n++){const o=l[n],i=`${Q1}_${o.mediaPlatform.appPlatform}_${o.mediaPlatform.supplementaryAppPlatforms.join("_")}`
w.push(new V0(nW,i))
const a=new YY(lC,null,o.items)
a.isHorizontal=!0
let c=!1,u=Ua(0,o.items[0])
for(const e of o.items)if(s(e.screenshot)&&e.screenshot.isPortrait()||s(e.video)&&e.video.preview.isPortrait()){u=Ua(0,e),c=!0
break}a.contentsMetadata={type:"productMedia",platform:o.mediaPlatform,allPlatforms:o.allPlatforms,platformDescription:o.platformDescription,allPlatformsDescription:o.allPlatformsDescription,allPlatformsDescriptionPlacement:o.allPlatformsDescriptionPlacement,hasPortraitMedia:c,expandProductMediaAction:null,viewProductMediaGalleryAction:Ba(e,o,t.id),aspectRatio:u},r.addImpressionsToShelf(e,a,Lq),0===n&&"tv"!==e.client.deviceType&&(a.title=e.loc.string(kP)),g[i]=a}return p.length>0&&(g[EH]=function(e,t,n){return Bv.context("videoShelf",()=>{if(!t||0===t.length)return null
let r
return zu(e)?(r=new YY(lC),r.title=e.loc.string(vC),r.items=t.map(e=>{const t=new rz
return t.video=e,t})):(r=new YY(wx),r.title=e.loc.string(vC),r.items=t.map(e=>new K1(e,!0,kV,null,null,!0))),r.isHorizontal=!0,n.addImpressionsToShelf(e,r,EH),r})}(e,p,r)),{sectionMappings:w,shelfMapping:g,allProductMedia:l}})}(e,n,C,a)
t.shelfMapping={...t.shelfMapping,...ae.shelfMapping}
const le=function(e){if((0,Nv.isNothing)(e))return null
switch(e){case jq:return mq
case $q:return gq
case Yq:return Yq
case"tv":return BG
case Fq:return GV
case zq:return zq
case qH:return null
default:x(e)}}(null===(w=null==ae?void 0:ae.allProductMedia[0])||void 0===w?void 0:w.mediaPlatform.appPlatform),ue=(t.title,function(e,t,n,r){return Bv.context("createActionLinks",()=>(o(t),null))}(0,n))
if(ue&&(t.shelfMapping[xx]=ue),(0,Nv.isSome)(le)&&function(e,t,n){var r
const o=(0,jv.attributeAsDictionary)(t,`accessibility.${n}`),i=null!==(r=Qe(e,t,oq))&&void 0!==r?r:""
return Ii(e)&&!ki(e,t.id)&&!Oi(e,i)&&(0,Nv.isSome)(o)}(e,n,le)){const r=El(e,n,le,!1,a,a.metricsPageInformation,a.locationTracker)
t.shelfMapping[SH]=r
const o=Rl(e,n,le,!1,a,a.metricsPageInformation,a.locationTracker);(0,Nv.isSome)(o)&&(t.shelfMapping[IH]=o)
const i=Dl(e,n,!1,a.metricsPageInformation,a.locationTracker);(0,Nv.isSome)(i)&&(t.shelfMapping[bH]=i)}{const e=Y?RB:DB,n=fl(0,e)
t.shelfMapping[e]=n}!function(e,t,n){if(t&&t.spotlightSection){const e=t.spotlightInAppProductIdentifier
if(e&&t.spotlightSection){const r=n.shelfMapping[t.spotlightSection.shelfId]
if(!r)return
if(r.presentationHints={isInProductPageSpotlight:!0},Vh(0,e,r.items),r.url){const t=new qW(r.url)
t&&(r.url=t.param(DW.offerName,e).build())}}}}(0,c,t)
const de={},ve=zP,me=rF,ye=YM,Ae=Lj,Te=tq,be=aD
de[AU]=U,de[ve]=U,de[me]=G,de[ye]=q,de[Ae]=W,de[Te]=ee,de[be]=z,t.badges&&kl(e,t.badges,de,a),null!=t.shelfMapping[xH]&&kl(e,Ku(e,t.shelfMapping[xH]),de,a),Wu(e,t,ae.sectionMappings,Y,c)}(e,b,p,y,n,I,l),b.pageRefreshPolicy=Ur(e,I),b.isIncomplete=!1,b.alwaysAllowReviews=ua(e,p),b.canonicalURL=j(p,Rq),l&&(b.shareAction=null,b.titleOfferDisplayProperties=null,b.expandedOfferDetails=null,b.lockup.offerDisplayProperties=null,b.banner=null),C&&(b.shareAction=null),b})}function qu(e,t,n,a,c,l,d,h=!1){return Bv.context("createProductPageSidePack",()=>{var h,p
let w
i(a)&&(w=a.clientIdentifierOverride)
const g=t.id,v=j(t,Zq),m=H(t,VU),y=la(e,t),T=Bf(e,t),b={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,id:g,isAdvert:!!n.metricsPageInformation.adPageInfo&&n.metricsPageInformation.adPageInfo.adIsPresent},S=new HY,P=new uY,C=V(t,eq)
C&&i(n)&&i(n.metricsPageInformation)&&(n.metricsPageInformation.offerType=NV,n.metricsPageInformation.offerReleaseDate=yr(0,t)),P.adamId=g,P.bundleId=Qe(e,t,oq),S.uber=function(e,t,n){Qd(e,t,n)
const r=Bf(e,t),s=function(e,t){return t&&!0}(0,r)?Eq:qT,a=new o2(s)
if(a.artwork=Cf(e,t,{supportsArcade:r}),a.compactArtwork=Cf(e,t,{supportsArcade:r,prefersCompactVariant:!0}),a.video=If(e,t,n6.Uber),i(a.video)&&(a.video.playbackId=function(e){return`ProductPage.${e.id}.productUberVideoPlaybackId`}(t)),r&&o(a.video)&&o(a.artwork)){const r=(e.client.deviceType,null),o=Ge(e,t),i=of(e,t,n6.ProductPageScreenshots,r,o,n)
if(i.length>0&&i[0].items.length>0){const e=i[0].items[0]
a.video=e.video,a.artwork=e.screenshot}}return o(a.compactArtwork)&&(a.compactArtwork=a.artwork),a.isValidUber(!1,!1)?a:null}(e,t,w)
const I=S.uber&&S.uber.style===Eq
P.icon=Jd(e,t,{useCase:n6.ProductPageIcon,withJoeColorPlaceholder:void 0},w),S.title=v,S.isIncomplete=!0,P.title=v,P.subtitle=wd(e,t),P.developerTagline=Qe(e,t,vH),S.regularPriceFormatted=j(t,"regularPriceFormatted"),S.logoArtwork=function(e,t){let n=null,r=null
if("tv"!==e.client.deviceType)return null
n=kT,r="bb"
const o=Ke(e,t,n)
return i(o)&&i("bb")?qd(e,o,{cropCode:"bb",useCase:n6.Default,withJoeColorPlaceholder:!0}):null}(e,t),S.navigationBarIconArtwork=null,y||(P.rating=q(t,YE)),P.children=hd(e,t,{metricsOptions:b,artworkUseCase:n6.LockupIconSmall})
const k=function(e,t,n,r,o,a,c){var l
const d=wr(e,t),f=Qe(e,t,oq),h=V(t,eq),p=vr(e,d,t,h,!1,dh(e,t,n,null==a?void 0:a.clientIdentifierOverride),o,jV,c,null==a?void 0:a.webBrowser)
if(null!==(l=null==a?void 0:a.webBrowser)&&void 0!==l&&l&&(null==a?void 0:a.webBrowserFlowType)!==Mm.PurchaseAndOpen)return{buttonAction:new i2(t.id),offerAction:p}
let w
if(s(p)){i(a)&&(p.lineItem=a.iAdLineItem)
const n=s(a)?a.clientIdentifierOverride:null
if(w=br(e,p,t,h,o,jV,n),i(a)&&s(w)){const n=rt(e),r=it(e,t,Ge(e,t),$$,n),i=s(r)&&!u(a.isCppDeepLinkDisabled),c=s(a.externalDeepLinkUrl)
let l;(i||c)&&(l=i?r:a.externalDeepLinkUrl,w=ra(e,w,p.adamId,f,l,!1,o))}}return{buttonAction:w,offerAction:p}}(e,t,P.icon,0,b,a,l)
if(P.buttonAction=k.buttonAction,C){let n
S.theme=j_
let r=null
if(T)n="",r=e.loc.uppercased(Kf(e,t,e.loc.string(hD)))
else if(n=e.loc.string(hD),i(k.offerAction.expectedReleaseDate)){const n=ax,o=e.loc.formatDate(n,k.offerAction.expectedReleaseDate),i=e.loc.string("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(lD,o)
r=Kf(e,t,i)}S.expandedOfferDetails=new e2(n,r)}let O,E
I&&T&&(S.theme=JH),I&&T?(O=JH,E=F_):(O=wj,E=jV)
const R=EE,D=wj,_=T?TB:Mq,L=null!==(h=null==a?void 0:a.webBrowser)&&void 0!==h&&h
let M
switch(null==a?void 0:a.webBrowserFlowType){case Mm.SelectionOnly:M=!0
break
case Mm.PurchaseAndOpen:M=!1
break
default:M=!0}const x=L&&M?rP:jV
let $
P.offerDisplayProperties=xr(e,k.offerAction,_,t,C,0,O,E,null,null,x,!1,!1),S.titleOfferDisplayProperties=xr(e,k.offerAction,_,t,C,0,D,R,null,null,x),L&&(P.offerDisplayProperties.ignoresContentRestrictions=!0,S.titleOfferDisplayProperties.ignoresContentRestrictions=!0)
const F=pe(e,t,PH),N=Of(0,F)
i(N)&&($=new fY(eW),$.title=j(t,$V),$.pageUrl=N,Qs(e,$,{targetType:Qq,id:F.id,actionType:Xq,pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker})),S.developerAction=$,S.shareAction=Vo(e,t,n.metricsPageInformation,n.locationTracker,w),P.tertiaryTitle=gd(e,t),P.tertiaryTitleAction=vd(e,t),P.tertiaryTitleArtwork=null
const B={appPlatforms:cf(e,t),clientIdentifierOverride:w,offerButtonShouldBeDisabled:!1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker,webBrowser:null==a?void 0:a.webBrowser,webBrowserFlowType:null==a?void 0:a.webBrowserFlowType},U=function(e,t,n){let r=null,i=null,a=null,c=null,l=null,u=!1,d=null
const f=et(e,t,Gy),h=et(e,t,jy)
if((f||h)&&(r=e.loc.string("ProductPage.Banner.UpdateRequired.iOS"),n.offerButtonShouldBeDisabled=!0),null===r&&at(e,t,Wv.SADWatchApps)&&(r=e.loc.string("OFFER_WATCH_ONLY_BANNER"),n.offerButtonShouldBeDisabled=!0),null===r&&!Bd(e,t)){if(r=e.loc.string(bP),zu(e)){const t=new qY(Aq)
t.title=e.loc.string(PU),t.indexId=CU,a=t}else{const t=new zY(nW,Aq),n=new WY(t)
n.title=e.loc.string(PU),n.indexId=CU,a=n}r=e.loc.string(ON).replace(EN,a.title),n.offerButtonShouldBeDisabled=!0}if(null===r&&at(e,t,Wv.UnsupportedSystemDeletableApps|Wv.LegacyApps)&&(r=e.loc.string(SP),n.offerButtonShouldBeDisabled=!0),at(e,t,Wv.MinimumOSRequirement)){const n=gf(e,t,e.appleSilicon.isSupportEnabled)
switch(e.client.deviceType){case Yq:r=e.loc.string("UNSUPPORTED_MACOS_VERSION").replace($G,n)
break
case jq:case $q:r=e.loc.string("UNSUPPORTED_IOS_VERSION").replace($G,n)
break
case"tv":r=e.loc.string("UNSUPPORTED_TVOS_VERSION").replace($G,n)
break
case zq:const o=Qe(e,t,LF)
r=e.loc.string(PP).replace($G,o)
break
case Fq:r=e.loc.string("UNSUPPORTED_VISIONOS_VERSION").replace($G,n)
break
default:r=e.loc.string(SP)}if(e.client.isPhone&&et(e,t,AG)){const n=Qe(e,t,LF)
r=e.loc.string(PP).replace($G,n)}}if(at(e,t,Wv.UnsupportedPlatform))if(n.offerButtonShouldBeDisabled=!0,r=e.loc.string(bP),zu(e)){const t=new qY(Aq)
t.title=e.loc.string(PU),t.indexId=CU,a=t,r=e.loc.string(ON).replace(EN,t.title)}else{const t=new zY(nW,Aq),n=new WY(t)
n.title=e.loc.string(PU),n.indexId=CU,a=n,r=e.loc.string(ON).replace(EN,n.title)}if(at(e,t,Wv.MacOSRosetta)){if(zu(e)){const t=new qY(Aq)
t.title=e.loc.string(PU),t.indexId=CU,a=t}else{const t=new zY(nW,Aq),n=new WY(t)
n.title=e.loc.string(PU),n.indexId=CU,a=n}r=e.loc.string(ON).replace(EN,a.title)}const p=H(t,eq)
Vf(e,t)&&(r=p?e.loc.string("ProductPage.WatchOS.PreOrderRequiresiPhone"):e.loc.string("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),n.offerButtonShouldBeDisabled=!0)
const w=Qe(e,t,LF)
if(null===r&&n.clientIdentifierOverride===Vz&&zf(e,w)&&(r=e.loc.string("ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace($G,w)),xe(e,t,GV)&&!e.client.isCompanionVisionApp){const t=e.loc.string("BANNER_VISION_ONLY_APP_LEARN_MORE_LINK")
i=function(e,t,n,r){const i=e.bag.visionOnlyAppLearnMoreEditorialItemId
if(o(i))return null
const s=new fY(cq)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,Qs(e,s,{id:HB,targetType:yq,actionType:Xq,pageInformation:n,locationTracker:r}),s}(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){return t&&n?e.loc.string("BANNER_VISION_ONLY_APP_WITH_LINK").replace(pj,t):e.loc.string("BANNER_VISION_ONLY_APP_NO_LINK")}(e,t,i),a=null,c=Ot(e,"systemimage://visionpro"),l=Se(BF),u=!0}Dr(e,t)&&!Lr(e)?(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.VisionDeviceRequired")):e.client.isCompanionVisionApp&&!Dr(e,t)&&(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.RemoteDownloadUnavailable"))
const g=er(e,t),v=tr(e,"product-page-banner")
if((null===r||!n.offerButtonShouldBeDisabled)&&g&&v){const t=e.loc.string("ProductPage.ExternalPurchasesBanner.LearnMore")
i=nr(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){if(t&&n){if((0,Uv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const n=`ProductPage.ExternalPurchasesBanner.WithLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(n).replace(pj,t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.WithLink").replace(pj,t)}if((0,Uv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const t=`ProductPage.ExternalPurchasesBanner.NoLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.NoLink")}(e,t,i),a=null,e.bag.externalPurchasesIncludeProductPageBannerIcon?"secondaryInfoCircle"===e.bag.externalPurchasesProductPageBannerIconVariant?(c=Ot(e,"systemimage://info.circle"),l=Se(BF)):(c=Ot(e,ex),l=Se("systemRed")):(c=null,l=null),u=!0}if(null!==r&&n.offerButtonShouldBeDisabled||!(0,Uv.isSome)(n.webBrowser)||!n.webBrowser||n.webBrowserFlowType!==Mm.PurchaseAndOpen||(r=e.loc.string("ProductPage.Banner.DefaultBrowser.Message"),c=Ot(e,"systemimage://gear"),l=Se(BF),d=tx),(null==r?void 0:r.length)>0)return new t2(r,null,i,a,c,l,u,d)
if(!n.offerButtonShouldBeDisabled){const n=wf(e,t)
if(s(n))return function(e,t){const n=e.loc.string("ProductPage.Banner.ExternalBrowser.Message")
let r=n,o=n,i=n,s=n,a=n
return[RG].includes(e.client.buildType)&&(r+="\n(Internal: unknown)",o+="\n(Internal: buyOrGet)",i+="\n(Internal: redownload)",s+="\n(Internal: update)",a+="\n(Internal: open)"),new n2(Ol(nx,t,r),Ol(nx,t,o),Ol(nx,t,i),Ol(jM,t,s),Ol("launch",t,a))}(e,n)}return null}(e,t,B)
A(p=U)&&"Banner"===p[tW]?S.banner=U:function(e){return A(e)&&"AppStateBanner"===e[tW]}(U)&&(S.appStateBanner=U)
const G=P.offerDisplayProperties
B.offerButtonShouldBeDisabled&&s(G)&&(P.offerDisplayProperties=G.newOfferDisplayPropertiesChangingAppearance(!1,NB))
const W=!at(e,t,Wv.MinimumOSRequirement)
if(!m&&!B.offerButtonShouldBeDisabled&&W){const n=function(e,t){return Bv.context("updateOfferDataFromData",()=>{const n=Ze(e,t,QG)
if(0===n.length)return null
for(const e of n)if(f(e,fV)===jM)return e
return null})}(e,t)
S.updateBuyParams=f(n,lj),S.externalVersionIdentifier=tt(e,t,pD)}if(T&&(P.editorialTagline=e.loc.string("APPLE_ARCADE")),S.lockup=P,S.appPlatforms=cf(e,t),i(c)){const n=ni(e,c,t,!1,!1,kq,JH,!0,b,!0,!1,null,!1,!1)
if(i(c)&&function(e){return A(e)&&function(e){return(0,Nv.isSome)(vX[e])}(e.$kind)}(n)){const r=n
S.appPromotionDetailPageFlowAction=ri(e,c,t,r,b,qV,!1,d)}}!function(e,t,n,i,s,a){if(t.shelfMapping[Iq]=new YY(KP,"productTopLockup"),"tv"!==e.client.deviceType){const s={developerAction:t.developerAction}
t.shelfMapping[hq]=function(e,t,n,i){return Bv.context("descriptionShelf",()=>{if(o(t))return null
const s=new YY("productDescription"),a=function(e,t){return t?Bv.context("productDescriptionLinksFromData",()=>{const n=[],r=Qe(e,t,PL)
if(r){const t=new PY(r,!1),o=e.loc.string("PRODUCT_DEVELOPER_WEBSITE")
n.push(new I5(o,t,k5))}const o=Qe(e,t,SL)
if(o){const t=new PY(o,!1),r=e.loc.string("DEVELOPER_SUPPORT")
n.push(new I5(r,t,R5))}return n}):null}(e,t),c=function(e,t,n,r){const o=ge(t,zO),i=[]
for(const t of o){const o=(0,jv.attributeAsString)(t,Zq)
if((0,Nv.isSome)(o)){let s=null
switch(t.type){case mN:s=(0,jv.attributeAsString)(t,Rq)
break
case lV:const n=f(t,uG)
n&&(s=Fi(e,n))}if((0,Nv.isNothing)(s))continue
const a=e.required(n3).fetchFlowPage(s),c=new fY(a)
c.pageUrl=s,c.title=o
const l=new V4(o,c),u={targetType:JG,pageInformation:n,locationTracker:r,recoMetricsData:null}
Oh(e,l,Mh(e,t,o,u))
const d=Js(e,t,u)
d.targetType=u.targetType,Qs(e,c,d),i.push(l),bh(u.locationTracker)}}return i}(e,t,n.metricsPageInformation,n.locationTracker),l=function(e,t,n=null){return Bv.context("descriptionFromData",()=>{r(n)&&(n=Ge(e,t))
let o=function(e,t,n){return it(e,t,n,zA)}(e,t,n)
o||(o="")
let i=Qe(e,t,bG)
i||(i="")
let s=""
o.length>0&&i.length>0&&(s="\n\n")
const a=o+s+i
if(a.length>0){const e=new AX(a)
return e.isCollapsed=!0,e}return null})}(e,t)
if(null===l)return null
const u=new C5(l,a,c,i.developerAction)
return s.items=[u],n.addImpressionsToShelf(e,s,hq),s})}(e,n,i,s)}{const r={useInlineUberStyle:t.uber&&t.uber.style===Eq}
t.shelfMapping[xH]=function(e,t,n,r){if(zu(e)){const r=new YY("productBadge"),o=$u(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation})
return r.items=o,r.isHorizontal=!0,n.addImpressionsToShelf(e,r,xH),r}{const o=new YY(xH),i=$u(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation}),s=!r.useInlineUberStyle,a=!1,c=r.useInlineUberStyle,l=new x5(i,s,a,c,"justified")
return o.items=[l],o.isHorizontal=!0,n.addImpressionsToShelf(e,o,xH),o}}(e,n,i,r)}Wu(e,t,[],Bf(e,n),s)}(e,S,t,n,a),S.uber&&(S.presentationOptions.push(iN),S.presentationOptions.push(VL)),S.alwaysAllowReviews=ua(e,t)
const z=null==a?void 0:a.iAdDismissAdActionMetrics
if((0,Nv.isSome)(z)){const e=new kY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),f(z.invocation),f(z.purchaseType),f(z.reportingDestination)),t=new XJ(e)
S.pageDisappearedAction=t
const n=new kY(f(z.instanceId),f(z.adamId),f(z.bundleId),f(z.advertType),jb,f(z.purchaseType),f(z.reportingDestination))
S.lockup.buttonAction=zt(0,S.lockup.buttonAction,n)}return S})}function Wu(e,t,n,r,o){const i=function(e,t,r){return e.map(e=>e.shelfId===Lq&&r?n:e.shelfId===Lq?n[0]?[n[0]]:[]:[e]).reduce((e,t)=>e.concat(t)).map(e=>e.createShelfIdList()).reduce((e,t)=>e.concat(t))},a=$a(0,!0,e.host.platform,r,!1,!1,o),c=$a(0,!1,e.host.platform,r,!1,!1,o),l=$a(0,!0,e.host.platform,r,!0,!1,o),u=$a(0,!1,e.host.platform,r,!0,!1,o),d=$a(0,!1,e.host.platform,r,!1,!0,o),f=$a(0,!1,e.host.platform,r,!0,!0,o)
t.shelfOrderings.purchasedOrdering=i(a,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia=i(a,0,!0),t.shelfOrderings[r2]=i(c,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia=i(c,0,!0),t.shelfOrderings.purchasedOrdering_Compact=i(l,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia_Compact=i(l,0,!0),t.shelfOrderings.notPurchasedOrdering_Compact=i(u,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia_Compact=i(u,0,!0),t.shelfOrderings.downloadingOrdering=i(d,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia=i(d,0,!0),t.shelfOrderings.downloadingOrdering_Compact=i(f,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia_Compact=i(f,0,!0),t.defaultShelfOrdering=r2
for(const e of Object.keys(t.shelfMapping))s(t.shelfMapping[e])&&(t.shelfMapping[e].id=e)}function zu(e){return e.featureFlags.isEnabled(lJ)||!0}async function Yu(e,t,n={},r={},o=null,i=!1,s=!1){const a=Bf(e,yt(e,t)),c=await Hu(e,t,n,r,o,s)
return zu(e)&&!i?c:Ga(e,c,a,n)}function Ju(e,t,n={}){if(!e.client.isSidepackingEnabled)return null
const o=Bf(e,t),i=function(e,t,n){return Bv.context("createProductPageSidePackFromResponse",()=>{if(!e.client.isSidepackingEnabled)return null
const o=function(e,t,n){const r=j(t,Rq),o=j(t,Zq),i=j(t,$V)
let s=null
n&&(s=n.iAdClickFields)
const a=Gn(e,mV,t.id,`${i}_${o}`,s)
return a.pageUrl=r,new K6(a,{rootPosition:0,locationStack:[]})}(e,t,n),i=qu(e,t,o,n)
return function(e,t,n){r(n)||(t.pageMetrics.addData(Kn(e,n,void 0),[pm.PageInvocationPoint.backButton]),r(t.pageMetrics.pageFields)&&(t.pageMetrics.pageFields={}))}(e,i,o.metricsPageInformation),i})}(e,t,n)
return zu(e)?i:Ga(e,i,o,n)}function Ku(e,t){if(o(null==t?void 0:t.items))return[]
if(zu(e))return t.items
{const e=t.items
return e.length>0?e[0].badges:[]}}function Zu(e,t,n){const r=kn(0,t),o=Qu(e,t,r,n,W5[n],!1),i=Qu(e,t,r,n,z5[n],!0)
return o.rtlArtwork=i.rtlArtwork,o.rtlArtworkData=i.rtlArtworkData,o.rtlVideo=i.rtlVideo,o.rtlBackgroundColor=i.rtlBackgroundColor,o.rtlTextColorOverride=i.rtlTextColorOverride,o}function Qu(e,t,n,r,o,a){let c={}
for(const l of o){if(i(n)&&(c=ed(e,n,r,l,a)||Xu(e,n,r,l,a),s(c)))break
if(c=ed(e,t,r,l,a)||Xu(e,t,r,l,a),s(c))break}return(0,Uv.isNothing)(c)&&(c={}),c}function Xu(e,t,n,o,i){let a=null,c=null,l=null
const u=`editorialArtwork.${o}`,d=nt(e,t)
if(r(d))return null
if(c=B(t,u)||se(t,d,u),!s(c))return null
if(a=qd(e,c,{withJoeColorPlaceholder:!0,useCase:td(n),cropCode:nd(n,o,i)}),r(a))return null
l=a.backgroundColor
const f=od(0,c,a)
return i?{rtlArtwork:a,rtlArtworkData:c,rtlBackgroundColor:l,rtlTextColorOverride:f}:{artwork:a,artworkData:c,backgroundColor:l,textColorOverride:f}}function ed(e,t,n,r,i){let a=null,c=null,l=null,u=null
const d=`editorialVideo.${r}`,h=nt(e,t)
if((0,Uv.isNothing)(h))return null
if(l=B(t,d)||se(t,h,d),o(l))return null
const w=p(l,EG)
s(w)&&(c=qd(e,w,{withJoeColorPlaceholder:!0,useCase:td(n),cropCode:"sr"})),s(c)&&(c.crop="sr",u=c.backgroundColor)
const g=f(l,jH)
if(s(c)&&(0,Uv.isSome)(g)&&g.length>0&&(a=new nz(g,c,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:id(0,n),autoPlayPlaybackControls:{}}),a.editorialMediaFlavor=r,a.editorialMediaPlacement=n),(0,Uv.isNothing)(w)||(0,Uv.isNothing)(c))return null
const v=od(0,w,c)
return i?{rtlVideo:a,rtlArtwork:c,rtlArtworkData:w,rtlBackgroundColor:u,rtlTextColorOverride:v}:{video:a,artwork:c,artworkData:w,backgroundColor:u,textColorOverride:v}}function td(e){switch(e){case Dm.Hero:return n6.GroupingHero
case Dm.LargeBreakout:return n6.ArcadeLargeBreakout
case Dm.StoryCard:return n6.TodayCardMedia
case Dm.StoryDetail:case Dm.StoryDetailLandscape:return n6.ArticleImage
case Dm.Search:return n6.SearchEditorialResult
default:return n6.Default}}function nd(e,t,n){switch(e){case Dm.Hero:switch(t){case Rm.HeroStatic16x9:if(!n)return"gd"
break
case Rm.HeroStaticRTL16x9:if(n)return"gg"
break
case Rm.StoryCenteredStatic16x9:return n?"gh":"ge"
case Rm.UniversalAStatic16x9:return n?"gj":"gi"}break
case Dm.LargeBreakout:switch(t){case Rm.StoryCenteredStatic16x9:return n?"gk":"gf"
case Rm.UniversalAStatic16x9:return n?"gl":"gm"}break
case Dm.StoryCard:case Dm.StoryDetail:case Dm.StoryDetailLandscape:case Dm.Search:if(t===Rm.UniversalAStatic16x9)return"gn"
break
case Dm.Brick:if(t===Rm.SearchCategoryBrick)return vT}return"sr"}function rd(e,t,n=!1){if((0,Uv.isNothing)(t))return null
const r=n?t.rtlTextColorOverride:t.textColorOverride,o=n?t.rtlBackgroundColor:t.backgroundColor
return(0,Uv.isSome)(r)?Ce(r,Xz):(0,Uv.isSome)(o)?be(o):null}function od(e,t,n){const r=null==n?void 0:n.textColor
if((0,Uv.isNothing)(r))return null
const o=u(t,"useCustomTextColor"),i=Ce(r,Qz)||Ce(r,Xz)
return o&&i?r:null}function id(e,t){switch(t){case Dm.Hero:case Dm.StoryDetail:case Dm.StoryDetailLandscape:return{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}
default:return{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}}}function sd(e,t,n){switch(n){case dB:case uB:case eN:case XF:return Zu(e,t,Dm.EditorialLockup)
case"BrickSmall":case"BrickMedium":case"BrickLarge":return Zu(e,t,Dm.Brick)
case UL:case"StorySmall":return Zu(e,t,Dm.StoryCard)
case nG:return Zu(e,t,Dm.Hero)
case lE:return Zu(e,t,Dm.LargeBreakout)
default:return{}}}function ad(e,t,n){const r=function(e,t,n){const r=function(e,t){let n=null
switch(t.type){case Nq:case BH:case oU:n=we(t,iU,!0)||we(t,wH,!0)||we(t,Jq,!0)
break
case lV:n=w(t.meta,ZT)
break
default:n=null}return n}(0,t)
return o(r)?null:Rd(e,r,n)}(e,t,{lockupOptions:n})
if(!o(r))return null==r?void 0:r.map(e=>e.icon)}function cd(e,t,n){const r=In(e,t)
return o(r)?null:Ad(e,r,n)}function ld(e,t,n,r,o){if((0,Nv.isNothing)(t)||0===t.length||r.has(t))return null
const i=new Y5(hF)
return i.moduleType=n_,(0,Nv.isSome)(t)&&(i.labelText=t,Eh(e,i,xh(o,n_,i.labelText,Gq))),r.add(t),[i]}function ud(e,t,n){return t===FH?n?qq:NU:n?TB:Mq}function dd(e,t,n,s,a){var c,u,d,f,h,w,g,v,m,y,A
if(o(t))return
if(n.showMetadataInformationInLockup=e.bag.isLLMSearchTagsEnabled||e.client.isPad,!e.client.isPhone)return
const T=p(t,tV),b=null!==(u=null===(c=null==T?void 0:T.displayStyle)||void 0===c?void 0:c.metadataRibbon)&&void 0!==u?u:null===(d=null==s?void 0:s.displayStyle)||void 0===d?void 0:d.metadataRibbon
let S=[]
S=e.bag.isLLMSearchTagsEnabled?null!==(g=null!==(h=null===(f=null==T?void 0:T.displayStyle)||void 0===f?void 0:f.llmRibbon)&&void 0!==h?h:null===(w=null==T?void 0:T.displayStyle)||void 0===w?void 0:w.metadataRibbon)&&void 0!==g?g:null===(v=null==s?void 0:s.displayStyle)||void 0===v?void 0:v.metadataRibbon:null!==(y=null===(m=null==T?void 0:T.displayStyle)||void 0===m?void 0:m.metadataRibbon)&&void 0!==y?y:null===(A=null==s?void 0:s.displayStyle)||void 0===A?void 0:A.metadataRibbon
const P=function(e,t,n,s,a,c=J5){if(o(s))return[]
const l=[],u=new Set
for(const d of s)if(!o(d))for(const o of d){const s=c[o]
if(r(s))continue
const d=s(e,t,n,u,a.metricsOptions)
if(i(d)){l.push(...d)
break}}return l}(e,t,n,b,a),C=function(e,t,n,s,a,c=J5){if(o(s))return[]
const u=l(t.meta,"associations.tags.data"),d=[]
let f=0,h=0
const w=new Set
for(const l of s){const s=Array.isArray(l)?l:[l]
if(!o(s))for(const o of s){const s=o===F$
let l,g=t,v=""
if(o===n_){const n=p(t,tV);(0,Nv.isSome)(null==n?void 0:n.rankedSecondaryGenreShortDisplayNames)&&(v=null==n?void 0:n.rankedSecondaryGenreShortDisplayNames[h]),(0,Nv.isSome)(v)?(l=ld(e,v,0,w,a.metricsOptions),h+=1):l=[]}else{const i=c[o]
if(r(i))continue
g=s?u[f]:t,l=i(e,g,n,w,a.metricsOptions),f=s?f+1:f}if(i(l)){d.push(...l)
for(const e of l)(0,Nv.isSome)(e.impressionMetrics)&&bh(a.metricsOptions.locationTracker)
break}}}return d}(e,t,n,S,a)
n.metadataRibbonItems=P,n.searchTagRibbonItems=C,n.shouldEvenlyDistributeRibbonItems=!e.bag.isLLMSearchTagsEnabled}function fd(e,t,n,r,o,i){t&&Bv.context("copyDataIntoLockup",()=>{var s,a,c,u,d,h
const p=H(t,eq)
if(r.isContainedInPreorderExclusiveShelf&&!p)return null
const w=null!==(s=null==r?void 0:r.attributePlatformOverride)&&void 0!==s?s:rt(e),g=Ge(e,t)
n.productVariantID=Ve(g),r.metricsOptions.productVariantData=g,n.adamId=t.id
const v=Qe(e,t,oq,null==r?void 0:r.attributePlatformOverride)
n.bundleId=v,n.decorations=[]
let m=null
r&&r.clientIdentifierOverride&&(m=r.clientIdentifierOverride),n.icon=Jd(e,t,{useCase:r.artworkUseCase,withJoeColorPlaceholder:r.useJoeColorIconPlaceholder,joeColorPlaceholderSelectionLogic:r.joeColorPlaceholderSelectionLogic,overrideTextColorKey:r.overrideArtworkTextColorKey},m,g,r.attributePlatformOverride),r&&r.titleObjectPath?n.title=Qe(e,t,r.titleObjectPath,null==r?void 0:r.attributePlatformOverride):n.title=j(t,Zq),n.useAdsLocale=r.metricsOptions.isAdvert&&(0,Uv.isSome)(e.bag.adsOverrideLanguage)
const y=Bf(e,t,null==r?void 0:r.attributePlatformOverride)
y&&!r.shouldHideArcadeHeader&&(n.heading=r.metricsOptions.isAdvert?e.adsLoc.string(WE):e.loc.string(WE)),r.shouldShowFriendsPlayingShowcase&&n.decorations.push("showcaseFriendsPlaying")
const A=!y&&!p&&(null===(a=r.isMultilineTertiaryTitleAllowed)||void 0===a||a)
if(r.isSubtitleHidden||function(e,t,n){return Bv.context("isBadgeMultilineFromData",()=>{if(!n)return!1
if(!pf(0,t,!1))return!1
if(md(e,t))return!1
const r=cf(e,t)
return mf(r,$q)||mf(r,jq)})}(e,t,A)||(n.subtitle=wd(e,t,r)),n.tertiaryTitle=gd(e,t,A,r.hideCompatibilityBadge),n.tertiaryTitleAction=vd(e,t),n.tertiaryTitleArtwork=null,n.developerTagline=Qe(e,t,vH,null==r?void 0:r.attributePlatformOverride),n.editorialTagline=Uf(e,t,gj,!1,null==r?void 0:r.attributePlatformOverride),n.editorialDescription=Uf(e,t,Wq,!1,null==r?void 0:r.attributePlatformOverride),n.shortEditorialDescription=Uf(e,t,Uj,!1,null==r?void 0:r.attributePlatformOverride),n.ageRating=or(0,t,!0),n.productDescription=Qe(e,t,bG,null==r?void 0:r.attributePlatformOverride),null!==(c=null==r?void 0:r.shouldShowSupportedPlatformLabel)&&void 0!==c&&c&&function(e,t,n,r){const o=cf(e,t),i=pf(0,t,!1)
if(yf(e,t,o,e.client.deviceType,i,!1))return
const s=o.filter(t=>t!==e.client.deviceType)
if(0!==s.length)if(n.tertiaryTitleIcons=s.map(e=>Hf(e)),1===s.length){const t=_f(e,s[0])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.OnlyAvailable.Message").replace("@@platform@@",t)}else{const t=_f(e,s[0]),r=_f(e,s[1])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.AvailableOnTwo.Message").replace("@@platform1@@",t).replace("@@platform2@@",r)}}(e,t,n),!la(e,t)&&(q(t,zE)>0||!r||!r.hideZeroRatings)){n.rating=q(t,YE)
const o=q(t,zE),i=r.metricsOptions.isAdvert?e.bag.adsOverrideLanguage:null
n.ratingCount=e.loc.formattedCountForPreferredLocale(e,o,i)}const T=Js(e,t,r.metricsOptions,r.metricsClickOptions)
gh(e,T,n.title)
const b=wr(e,t,null==r?void 0:r.attributePlatformOverride),P=null!==(u=null==r?void 0:r.includeBetaApps)&&void 0!==u&&u,C=dh(e,t,n.icon,m),I=S(T),k=vr(e,b,t,p,P,C,I,vq,null==r?void 0:r.referrerData),O=l(b,JE)
let E=br(e,k,t,p,I,vq,m,r.shouldNavigateToProductPage)
const R=it(e,t,g,$$,w),D=Ut(0,t),_=!D||jt(t),L=_&&(null==R?void 0:R.length)>0,M=(null===(d=null==r?void 0:r.externalDeepLinkUrl)||void 0===d?void 0:d.length)>0
let x;(L||M)&&(x=L?R:r.externalDeepLinkUrl),(0,Uv.isSome)(x)&&(E=ra(e,E,k.adamId,v,x,P,I),(null===(h=r.crossLinkSubtitle)||void 0===h?void 0:h.length)>0&&(n.crossLinkTitle=e.loc.uppercased(j(t,Zq)),n.crossLinkSubtitle=r.crossLinkSubtitle)),n.buttonAction=E,n.includeBetaApps=P,n.developerName=j(t,$V),(0,Uv.isNothing)(n.developerName)&&(n.developerName=j(t,Kb)),n.children=hd(e,t,r),(0,Uv.isSome)(i)&&i(),mh(r.metricsOptions.locationTracker)
const $=jo(e,t,m)
if($){const t=new fW,r=S(T)
r.actionType=qN,r.targetType=Bq,Qs(e,t,r)
const o=new cY
o.shareAction=t,o.shareSheetData=$,n.contextMenuData=o}const F=null!=o?o:jd(e,t)
let N=!1
F&&(N=!(Ar(0,wr(e,F))>0))
const B=ud(0,t.type,y)
n.offerDisplayProperties=r?xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,r.offerStyle,r.offerEnvironment,O[0],N,vq,r.shouldNavigateToProductPage,r.metricsOptions.isAdvert,0,r.parentAppData,r.isBuyDisallowed):xr(e,k,B,t,p,r.isContainedInPreorderExclusiveShelf,null,null,O[0],N,vq),r&&r.skipDefaultClickAction||(n.clickAction=xd(e,t,T,{clientIdentifierOverride:m,productVariantData:g,isCppDeepLinkEligible:_})),r&&r.ordinal&&(n.ordinal=r.ordinal)
const U=Ke(e,t,dG,null==r?void 0:r.attributePlatformOverride)
if(U){const e=f(U,pM),t=e&&e===wM
n.isEditorsChoice=t}D||(n.flowPreviewActionsConfiguration=oa(e,t,!1,m,n.clickAction,r.metricsOptions,T,r.externalDeepLinkUrl,n.subtitle,n.title))
const G=_h(e,t,n,C,r.metricsOptions,r.canDisplayArcadeOfferButton)
Oh(e,n,G)})}function hd(e,t,n){const r=fe(t,Kq)
return r?Ed(e,r,{lockupOptions:{...n,shouldCreateScreenshotsLockup:null==n?void 0:n.shouldIncludeScreenshotsForChildren},filter:Wv.None}):null}function pd(e,t,n,r,s,a){var c
if(!t)return
if(s.isNetworkConstrained)return
const l=null!==(c=s.metricsOptions.isAdvert)&&void 0!==c&&c
Bv.context("copyMediaIntoMixedMediaLockup",()=>{n.screenshots=rf(e,t,n6.LockupScreenshots,null,s.clientIdentifierOverride,null,l,a)
const c=n.screenshots[0]
n.trailers=[]
const u=ef(e,t,r,s.metricsOptions,n.adamId,l,a)
i(u)&&(o(c)||u.mediaPlatform.isEqualTo(c.mediaPlatform))&&n.trailers.push(u)})}function wd(e,t,n=null){return(0,Uv.isNothing)(t)?null:Bv.context("subtitleFromData",()=>{let r
return n&&n.subtitleObjectPath&&(r=Qe(e,t,n.subtitleObjectPath,null==n?void 0:n.attributePlatformOverride)),o(r)&&(r=Qe(e,t,vH,null==n?void 0:n.attributePlatformOverride)),r||yd(e,t,n)})}function gd(e,t,n=!1,r){return Bv.context("badgeFromData",()=>{if(r)return null
const o=pf(0,t,!1)
if(o){let r=""
const i=cf(e,t)
if(mf(i,$q)?r="Platform.DesignedForPad":mf(i,jq)&&(r="Platform.DesignedForPhone"),(null==r?void 0:r.length)>0)return o&&(md(e,t)||(r+=".NotVerified",n&&(r+=".Expanded"))),e.loc.string(r)}return null})}function vd(e,t){return Bv.context("badgeActionFromData",()=>{if(!pf(0,t,!1))return null
if(md(e,t))return null
const n=cf(e,t)
if(!mf(n,$q)&&!mf(n,jq))return null
const r=new fY(cq)
return r.pageUrl=`https://apps.apple.com/story/id${e.bag.appleSiliconMacUnverifiedBadgeEditorialItemId}`,r})}function md(e,t){if(!e.appleSilicon.isSupportEnabled)return!0
const n=Xe(e,t,XE,pq)
return!!i(n)&&n}function yd(e,t,n=null){return Bv.context("categoryFromData",()=>{const r=Qe(e,t,zj,null==n?void 0:n.attributePlatformOverride)
if((null==r?void 0:r.length)>0)return r
const o=we(t,mN)
if(o.length>0){let e=o[0]
const t=PK.Games.toString()
if(e.id===t)for(const n of o){const r=j(n,mM)
if(n.id!==t&&r===t){e=n
break}}return j(e,Zq)}{const e=G(t,eR)
return e.length>0?e[0]:null}})}function Ad(e,t,n){return Bv.context("lockupFromData",()=>{var r,i,s,a,c,l,u,d
if(!t)return Bv.unexpectedNull(cH,kj),null
const h=Ut(0,t)
n.metricsOptions.isAdvert=h
const p=cn(e,null===(i=null===(r=n.metricsOptions.pageInformation)||void 0===r?void 0:r.adPageInfo)||void 0===i?void 0:i.placementType,n.metricsOptions.locationTracker,!0)
if(n.metricsOptions.isAdEligible=p,(h||p)&&(null===(a=null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a||a.apply(e,t)),h&&(null===(l=null===(c=n.metricsOptions.pageInformation)||void 0===c?void 0:c.adPageInfo)||void 0===l||l.setTemplateType(e,zU)),!W(t))return null
switch(t.type){case FH:return n.offerEnvironment=Qb,Td(e,t,n)
case Vq:const r=pe(e,t,Mq)
if(o(r))return null
const i=new uY
return fd(e,r,i,n),i
case iV:case EV:return function(e,t,n){return Bv.context("appPromotionOfferLockupFromData",()=>{var r,o,i
const s=null!==(r=jd(e,t))&&void 0!==r?r:n.parentAppData,a=Ud(e,t)
if(H(s,FF)){const r=Td(e,t,n)
if((0,Uv.isNothing)(r))return null
r.offerDisplayProperties.titles[Wq]=e.loc.string(Xb),r.offerDisplayProperties.isStreamlinedBuy=!0,r.offerDisplayProperties.hasDiscount=!1
const o=B(a,Hq),i=ci(e,s,Hq),c=qd(e,o,{useCase:n.artworkUseCase,withJoeColorPlaceholder:n.useJoeColorIconPlaceholder,style:HU,overrideTextColorKey:n.overrideArtworkTextColorKey})
return r.icon=null!=c?c:i,r}{const r=new uY
fd(e,s,r,n)
const c=Js(e,t,n.metricsOptions,n.metricsClickOptions)
gh(e,c,r.title)
const l=Qe(e,s,oq),u=j(a,VG),d=j(s,Zb),h=new wY(u,s.id,l,r.buttonAction,d)
if(h.appTitle=null!==(o=j(s,Zq))&&void 0!==o?o:"",h.productTitle=null!==(i=j(a,Zq))&&void 0!==i?i:"",t.type===EV){const e=f(Gd(a),QE);(0,Uv.isSome)(e)&&e.length>0&&(h.additionalBuyParams="adHocOfferId="+e)}else h.additionalBuyParams="contingentItemId="+t.id
return r.buttonAction=h,mh(n.metricsOptions.locationTracker),r}})}(e,t,n)
default:const s=new uY
return fd(e,t,s,n),(0,Uv.isSome)(null===(u=n.metricsOptions.pageInformation)||void 0===u?void 0:u.adPageInfo)&&((h||p)&&Gt(e,t,s,n.metricsOptions,!0),h&&(null===(d=s.searchAdOpportunity)||void 0===d||d.setTemplateType(zU))),s}})}function Td(e,t,n){return Bv.context("inAppPurchaseLockupFromData",()=>function(e,t,n){return t?Bv.context("makeInAppPurchaseLockup",()=>{var r
const o=null!==(r=jd(e,t))&&void 0!==r?r:n.parentAppData
if((0,Uv.isNothing)(o))return null
const i=H(o,FF),a=Ud(e,t)
if((0,Uv.isNothing)(a))return null
t=a
const c=new dY
fd(e,t,c,n,o),c.productIdentifier=j(t,VG),c.parent=Ad(e,o,n),c.description=j(t,bG),c.isVisibleByDefault=H(t,"isMerchandisedVisibleByDefault"),c.isSubscription=H(t,gM)
const u=wr(e,t),d=l(u,JE)
c.offerDisplayProperties&&(c.offerDisplayProperties.hasDiscount=d.length>0,c.offerDisplayProperties.subscriptionFamilyId=j(t,"subscriptionFamilyId"))
const h=new fY(KE)
h.presentationContext=Mj
const p=function(e,t,n){const r=(new DJ).param(DW.id,n).param(_W,t).build()
return`${hW}:/${yW.product}/${yW.install}/?${r}`}(0,c.adamId,o.id)
h.pageUrl=p
const w=new pY
w.parentLockup=S(c.parent),w.lockup=S(c),w.preInstallOfferDescription=qo(e,u),h.pageData=w
const g=j(t,VG),v=Qe(e,o,oq),m=j(o,Zb),y=s(Gd(t)),A=_h(e,t,c,HU,n.metricsOptions,n.canDisplayArcadeOfferButton)
if(gh(e,A,c.title),i&&y){const r=new wY(g,o.id,v,c.parent.buttonAction)
c.parent&&(r.appTitle=c.parent.title),r.productTitle=c.title,r.streamlineBuyAction=function(e,t,n,r,o){var i
const a={...o.metricsOptions,id:n.id,targetId:n.id,idType:lq,actionDetails:{parentAdamId:n.id}},c=dh(e,t,r.icon,o.clientIdentifierOverride),l=S(a),u=Gd(t),d=wr(e,t),h=wr(e,n),p=new GJ(f(h,lj))
let w=null!==(i=f(u,lj))&&void 0!==i?i:f(d,lj)
w+=`&appAdamId=${f(n,"id")}`,w+=`&appExtVrsId=${p.get(vM,"")}`,w+=`&bid=${Qe(e,n,oq)}`,w+="&bvrs=1.0",w+=`&offerName=${Qe(e,t,VG)}`
const g=f(u,QE)
return s(g)&&(w+=`&adHocOfferId=${g}`),d[lj]=w,vr(e,d,t,!1,!1,c,l,vq,null==o?void 0:o.referrerData,!1,n.id)}(e,t,o,c,n),c.buttonAction=r,c.subtitle=j(o,Zq)}else if(m){const t=new wY(g,o.id,v,h,m)
c.parent&&(t.appTitle=c.parent.title),t.productTitle=c.title
const r={...n.metricsOptions,id:c.adamId,idType:lq,actionDetails:{parentAdamId:o.id}}
Qs(e,t,r),c.buttonAction=t}else{const t=new gY(vq)
t.title=e.loc.string("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),t.message="",t.isCancelable=!0,c.buttonAction=t}if(mh(n.metricsOptions.locationTracker),!n||!n.skipDefaultClickAction){const n=_d(e,t,A)
c.clickAction=n,c.productAction=n}return function(e,t,n){t&&(t.impressionMetrics||Oh(e,t,n),t.parent&&t.parent.adamId&&(0,Nv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields.parentAdamId=sh(t.parent.adamId)))}(e,c,A),c},ZE):null}(e,t,n))}function bd(e,t,n){return Bv.context("screenshotsLockupFromData",()=>{const r=new vY
return function(e,t,n,r){t&&Bv.context("copyDataIntoScreenshotsLockup",()=>{fd(e,t,n,r),n.screenshots=rf(e,t,n6.LockupScreenshots,null,r.clientIdentifierOverride)})}(e,t,r,n),r})}function Sd(e,t,n){return Bv.context("posterLockupFromData",()=>{const o=new mY
return function(e,t,n,o){t&&Bv.context("copyDataIntoPosterLockup",()=>{fd(e,t,n,o),n.epicHeading=function(e,t){const n=Ke(e,t,"editorialArtwork.epicHeading")
return i(n)&&i("bb")?qd(e,n,{cropCode:"bb",useCase:n6.Default}):null}(e,t),n.posterArtwork=function(e,t){const n=Ke(e,t,"editorialArtwork.postCard")
return i(n)?qd(e,n,{cropCode:"sr",useCase:n6.Default,withJoeColorPlaceholder:!0}):null}(e,t),n.posterVideo=function(e,t,n){const o=Ke(e,t,[wq,OT]),s=qd(e,Ke(e,t,[wq,OT,EG]),{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(o)){const e=f(o,jH)
return r(e)?null:new nz(e,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},autoPlayPlaybackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}})}return null}(e,t,n6.GroupingHero),n.offerDisplayProperties&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,JH,cU)),n.posterVideo?n.isDark=be(n.posterVideo.preview.backgroundColor):n.posterArtwork?n.isDark=be(n.posterArtwork.backgroundColor):n.isDark=!1
const s=et(e,t,DG)
if(et(e,t,eq)){const r=s?e.loc.string("Offer.Label.ComingSoon"):null
let o
o=e.loc.uppercased(Kf(e,t,r)),(0,Uv.isSome)(o)&&(n.footerText=o)}})}(e,t,o,n),o})}function Pd(e,t,n,r,o=null,i){return Bv.context("mixedMediaLockupFromData",()=>{var s,a,c
const l=new AY
if(fd(e,t,l,n,null,()=>{dd(e,t,l,o,n),pd(e,t,l,r,n,i),Id(e,t,l,o)}),(0,Uv.isSome)(null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.adPageInfo)){const r=sn(e,o),i=cn(e,null===(c=null===(a=n.metricsOptions.pageInformation)||void 0===a?void 0:a.adPageInfo)||void 0===c?void 0:c.placementType,n.metricsOptions.locationTracker,!0,r)
n.metricsOptions.isAdEligible=i,i&&Gt(e,t,l,n.metricsOptions,!0)}return l})}function Cd(e,t,n,r){const o=t.type===Nq?pe(e,t,aH):t,i=Ad(e,o,n),s=nt(e,o),a=sd(e,o,r),c=sd(e,t,r),l=null==a?void 0:a.artwork,u=null==c?void 0:c.artwork
let d,f
if((0,Uv.isSome)(u),(0,Uv.isSome)(l)&&(f=rd(0,a),d=l),(0,Uv.isSome)(d)&&(0,Uv.isSome)(i)){const e=new TY(d,i,null,null,f)
return e.caption=ce(o,s,cG),(0,Uv.isSome)(e.caption),e.title=ce(o,s,Hj)||j(o,zj),e.impressionMetrics=i.impressionMetrics,e}return null}function Id(e,t,n,r){var o
if(!e.client.isPhone)return
const s=f(t.meta,"imageLockupFromData")
i(s)?n.screenshotsDisplayStyle=s:i(null===(o=null==r?void 0:r.displayStyle)||void 0===o?void 0:o.screenshots)&&(n.screenshotsDisplayStyle=r.displayStyle.screenshots)}function kd(e,t,n,r,o,i=!0,s){return Bv.context("mixedMediaAdLockupFromData",()=>{const a=new AY
return H(t,"iad.format.images")?(pd(e,t,a,r,n),function(e,t,n,r){var o
if(!function(e,t){const n=function(e,t,n){const r=Ge(e,t)
return(0,Uv.isNothing)(r)?null:Ye(r,n)}(e,t,hM)
return!n}(e,t))return
const i=G(t,"iad.assetOverride")
if(i.length){const e=function(e,t,n){const r=new Set(n),o=[],i=[],s=function(e,t){if(0===r.size)return!1
for(const o of n)if(o===t||-1!==e.indexOf(o))return r.delete(o),!0
return!1}
if(n.length&&(t.screenshots.length||t.trailers.length)){if(t.trailers.length)for(const e of t.trailers[0].videos)s(e.videoUrl,e.preview.checksum)&&o.push(e)
if(t.screenshots.length)for(const e of t.screenshots[0].artwork)s(e.template,e.checksum)&&i.push(e)}return!(0!==r.size||!o.length&&!i.length||(t.trailers.length&&(t.trailers[0].videos=o),t.screenshots.length&&(t.screenshots[0]=new iz(i,t.screenshots[0].mediaPlatform)),0))}(0,n,i)
if(r.pageInformation.adPageInfo&&r.pageInformation.adPageInfo.adIsPresent){r.pageInformation.adPageInfo.setSpecifiedCreativeUsed(e)
const t=null!==(o=r.adsMetricsData)&&void 0!==o?o:{}
t[qb]=e,r.adsMetricsData=t}}}(e,t,a,n.metricsOptions),fd(e,t,a,n,null,()=>{Id(e,t,a,o),dd(e,t,a,o,n)})):(fd(e,t,a,n,null,()=>{dd(e,t,a,o,n)}),a.screenshots=[]),Gt(e,t,a,n.metricsOptions,i,s),a})}function Od(e,t,n,r,i,s){return Bv.context("arcadeLockupFromData",()=>{const a=t.marketingItemData,c=new bY
c.title=e.loc.string("ARCADE_LOCKUP_TITLE","Apple Arcade")
const l=t.marketingItemData
n={...n,mercuryMetricsData:fh(0,l)}
let u,d=$c(0,a);(null==d?void 0:d.length)>0&&(d=d.replace(/\n/g," "),c.nonsubscribedSubtitle=d,c.subscribedSubtitle=d)
const f=xc(0,a)
u=Nc(e,t.marketingItemData,r,n),u.title=f,c.unsubscribedButtonAction=u
const h=no(0,n.pageInformation,n.locationTracker)
h.title=e.loc.string(bB,SB),c.subscribedButtonAction=h
const p=Lh(e,t.marketingItemData,c.title,n)
p.displaysArcadeUpsell=!0,o(p.targetType)&&(p.targetType=Bq),Oh(e,c,p)
const w=new SY(qq,e.bag.arcadeAppAdamId,null,i,null,s,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
return w.titles[gU]=e.loc.string(bB,SB),c.offerDisplayProperties=w,c})}function Ed(e,t,n){return r(t)?[]:Rd(e,t.data,n)}function Rd(e,t,n){return Bv.context("lockupsFromData",()=>{var o
if(!t)return[]
const s=[]
let a=!1
for(let c=0;c<t.length&&!a;c++){const l=t[c]
if(!W(l)){n.contentUnavailable&&(a=n.contentUnavailable(c,l))
continue}const u=n.lockupOptions
let d=Wv.All
if(n.includeOrdinals){const r=n.ordinalDirection===eS?t.length-c:c+1
u.ordinal=e.loc.decimal(r).toString()}if(i(n.filter)&&(d=n.filter),at(e,l,d)&&!n.shouldShowOnUnsupportedPlatform)continue
const f=null!==(o=n.lockupOptions.shouldCreateScreenshotsLockup)&&void 0!==o&&o?bd(e,l,u):Ad(e,l,u)
!r(f)&&f.isValid()&&(s.push(f),bh(n.lockupOptions.metricsOptions.locationTracker))}return s})}function Dd(e,t,n,r,s=null,a){return Bv.context(`actionFromData: ${t.type}`,()=>{switch(t.type){case Kq:case xq:return xd(e,t,n,{clientIdentifierOverride:r,externalDeepLinkUrl:s,isCppDeepLinkEligible:a})
case FH:return _d(e,t,n)
case Nq:return Md(e,t,n,r)
case lV:case BH:return function(e,t,n){return t?Bv.context("editorialPageActionFromData",()=>{const r=new fY(eW)
{const n=t.href
if(o(n))return Bv.unexpectedNull(cH,Sq,uG),null
r.pageUrl=Fi(e,n)}return r.title=Gf(e,t,Zq),o(r.title)&&(r.title=j(t,Zq)),Qs(e,r,n),r}):null}(e,t,n)
case yM:return function(e,t,n){return t?Bv.context("msoActionFromPlatformData",()=>{const r=j(t,Rq)
if(!r)return Bv.unexpectedNull(cH,Sq,Rq),null
const o=new fY(pN)
return o.pageUrl=r,o.title=j(t,Zq),Qs(e,o,n),o}):null}(e,t,n)
case TV:return function(e,t,n){return t?Bv.context("groupingActionFromData",()=>{if(!t.href)return Bv.unexpectedNull(cH,Sq,uG),null
const r=new fY(eW)
return r.pageUrl=ve(e,function(e,t){const n=[Tq,wq,zV,JV,uH,uV]
e.appleSilicon.isSupportEnabled&&n.push(hH),e.bag.enableUpdatedAgeRatings&&n.push(iq),Kd(e)&&n.push(sH)
const r=new Jz(e,t).includingAttributes(n).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported()
oi(e)&&(r.enablingFeature(MH),r.includingScopedAttributes(Vq,DK),r.includingScopedRelationships(Vq,[Mq]),r.includingScopedRelationships(ZA,[Vq]))
const o=ne(e)
return i(o)&&r.addingQuery(IG,o),r}(e,t.href)).toString(),r.title=Nd(0,t),Qs(e,r,n),r}):null}(e,t,n)
default:return function(e,t,n){return t?Bv.context("genericActionFromData",()=>{const r=f(t,fV),o=j(t,Rq)
if(!o)return Bv.unexpectedNull(cH,Sq,Rq),null
const i=new fY(eW)
return i.pageUrl=o,i.title=r===TV?Nd(0,t):j(t,Zq),Qs(e,i,n),i}):null}(e,t,n)}})}function _d(e,t,n){return Bv.context("iAPActionFromData",()=>{var r
const o=jd(e,t)
if(!o)return null
const s=new fY(oH),a=qW.from(j(o,Rq)),c=Ve(null!==(r=n.productVariantData)&&void 0!==r?r:Ge(e,o))
i(c)&&a.param(DW.productVariantID,c)
const l=a.toString(),u=j(t,VG),d=H(t,gM)
return s.pageUrl=function(e,t,n,r){const o=(new DJ).param(LW,t).param(DW.offerName,n).param(MW,r.toString()).build()
return`${hW}:/${yW.product}/${yW.lookup}/?${o}`}(0,l,u,d),s.title=j(t,Zq),Qs(e,s,n),s})}function Ld(e,t){return o(t)?K5:Bv.context(tS,()=>{if(function(e){const t=f(e,c$)
return t&&t===yL}(B(t,yq)))return Z5
const e=j(t,nS),n="List"===e||"NumberedList"===e
if(H(t,ZB)||n)return Q5
const r=we(t,aH),o=we(t,wH),i=s(r)&&1===r.length,a=s(o)&&1===o.length
return a&&o[0].type===Vq||i&&r[0].type===Vq?e6:a?X5:K5})}function Md(e,t,n,a,c,l){return o(t)?null:Bv.context(tS,()=>{var u
let d,h,p
switch(Ld(0,t)){case Z5:return function(e,t,n){return Bv.context("editorialItemExternalLinkActionFromData",()=>{const r=f(B(t,yq),Rq),o=new PY(r),i=Uf(e,t,Uj)
if(i)o.title=i
else{const e=new qW(r)
o.title=e.host}return Qs(e,o,n),o})}(e,t,n)
case Q5:d=cq
const p=qW.from(j(t,Rq))
i(c)&&p.param(DW.recoMetrics,JSON.stringify(c)),(0,Uv.isSome)(l)&&!l.isHorizontalShelfContext&&p.param(DW.todayCardConfig,JSON.stringify(l))
const w=null===(u=N(t))||void 0===u?void 0:u.id;(0,Uv.isSome)(w)&&p.param(DW.editorialCardId,w),h=p.build()
break
case X5:const g=we(t,wH)[0]
return Dd(e,g,n,a)
case e6:const v=we(t,aH),m=s(v)&&1===v.length?v[0]:we(t,wH)[0],y=pe(e,m,Mq)
if(o(y))return null
const A=wi(e,m,y,!1,!1,kq,TH,!1,n,!1,!0,null,!1,!1)
return r(A)||A instanceof Date?null:fi(e,m,y,A,n,!0)
case t6:d=eW,h=Fi(e,t.href)
break
default:d=Dq,h=f(B(t,yq),Rq)}if((0,Uv.isNothing)(h))return null
const w=new fY(d)
w.pageUrl=h,(0,Uv.isSome)(p)&&(w.presentation=p)
let g=Uf(e,t,Zq)
return r(g)&&(g=f(t,$H)),w.title=g,Qs(e,w,n),w})}function xd(e,t,n,r){var o,s,a,c
if(!t)return null
const l=null!==(o=r.clientIdentifierOverride)&&void 0!==o?o:null,u=null!==(s=r.externalDeepLinkUrl)&&void 0!==s?s:null,d=!(null!==(a=r.isCppDeepLinkEligible)&&void 0!==a&&a),h=null!==(c=r.productVariantData)&&void 0!==c?c:Ge(e,t)
return Bv.context("productActionFromData",()=>{var r,o,s
let a=j(t,Rq)
if(!a)return Bv.unexpectedNull(cH,Sq,Rq),null
let c={}
const p=new qW(a)
if(n.isAdvert){const o=f(t,rS)
null!==o&&o.length>0&&p.param(FJ,o)
const i=null===(r=n.pageInformation.adPageInfo)||void 0===r?void 0:r.clickFields
Object.assign(i,n.adsMetricsData),p.param($J,JSON.stringify(i)),c={iAdClickFields:y(i),iAdLineItem:o}
const s=fn(0,t)
if((0,Uv.isSome)(s)){const r=Bf(e,t)?TB:dM,o=Yt(0,n.pageInformation),i=j(t,fM),a=H(t,eq)?NV:Wq,l=new kY(s,t.id,i,r,"productPageDismissed",a,o)
p.param(NJ,JSON.stringify(l)),c.iAdDismissAdActionMetrics=y(l)}}const w=Ve(h)
i(w)&&p.param(DW.productVariantID,w),c.externalDeepLinkUrl=u,i(u)&&p.param($0,u),Ql(e).platform,$d(e,t)
{c.isCppDeepLinkDisabled=d,p.param(F0,d.toString())
const e=null===(s=null===(o=n.pageInformation)||void 0===o?void 0:o.searchTermContext)||void 0===s?void 0:s.term;(0,Uv.isSome)(e)&&p.param(mH,e),c.clientIdentifierOverride=l,(null==l?void 0:l.length)>0&&p.param(oS,l)}a=p.toString()
const g=new fY(oH)
g.pageUrl=a,g.pageData=Ju(e,t,c),g.title=j(t,Zq),n&&n.pageInformation&&(g.referrerUrl=n.pageInformation.pageUrl)
const v=H(t,eq)
Qs(e,g,v?{...n,offerType:NV,offerReleaseDate:yr(0,t)}:n,!0)
const m=f(t,"id")
return(0,Uv.isSome)(m)&&(g.destination=t.type===xq?function(e){const{id:t,platform:n,lic:r,...o}=e
return{$kind:"BundlePageIntent",id:dt(t),platform:ut(n),lic:r,...o}}({...Di(e),id:m}):function(e){const{id:t,platform:n,ppid:r,lic:o,...i}=e
return{...i,$kind:"ProductPageIntent",id:dt(t),platform:ut(n),ppid:r,lic:o}}({...Di(e),platform:Fd(e,t),id:m})),g})}function $d(e,t){try{return function(e,t){const n=(0,Uv.unwrapOptional)(yt(e,t)),r=new Set(Fe(e,n,!0))
if(r.has(mq))return mq
if(r.has(gq))return gq
if(r.has(Yq))return Yq
if(r.has(GV))return Fq
if(r.has(BG))return"tv"
if(r.has(zq))return zq
throw new Error("Could not infer platform from device families")}(e,{data:[t]})}catch(t){return void e.console.error(`Error inferring preview platform from data: ${t}`)}}function Fd(e,t){return Ql(e).platform||$d(e,t)}function Nd(e,t){const n=G(t,eR)
return s(n)?n[0]:j(t,Zq)}function Bd(e,t){if(!t)return!1
if(e.client.isCompanionVisionApp)return!0
const n=function(e,t,n){return Qe(e,t,pf(0,t,n)?hH:JV)}(e,t,e.appleSilicon.isSupportEnabled)
if(o(n))return!0
const r=n.split(" ")
return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(r,!1)}function Ud(e,t){if(!t)return null
switch(t.type){case iV:return pe(e,t,WB)
case EV:return pe(e,t,zB)}return t}function Gd(e){if(!e)return null
const t=p(e,_F)
if(s(t))return t
const n=p(e,Z_)
return s(n)?n:null}function jd(e,t){if(!t)return null
switch(t.type){case iV:return pe(e,t,e$)
case EV:const n=pe(e,t,zB)
return pe(e,n,Mq)}return pe(e,t,Mq)}function Vd(e,t){t.bag.arcadeDownloadPacksMetricsEventsEnabled||(e.clickAction.actionMetrics.clearAll(),e.buttonAction.actionMetrics.clearAll(),gt(e.buttonAction)&&e.buttonAction.defaultAction.actionMetrics.clearAll()),t.bag.arcadeDownloadPacksImpressionEventsEnabled||(e.impressionMetrics=null)}function Hd(e,t){switch(t){case WF:case QO:case dq:return n6.LockupIconSmall
case VH:return n6.LockupIconMedium
case iB:return n6.LockupIconLarge
default:return n6.Default}}function qd(e,t,n){return Bv.context("artworkFromApiArtwork",()=>{var o,s,a
const c=!!i(n.allowingTransparency)&&n.allowingTransparency,l=!!i(n.withJoeColorPlaceholder)&&n.withJoeColorPlaceholder,d=f(t,Rq)
if(r(d))return null
const p=u(t,"hasP3"),w=[kt(e,c,p,n.useCase)]
u(t,"supportsLayeredImage")
let g=null
if(c)g=Se(kG)
else if(l){const e=Xf(t),i=ye(null!==(s=null===(o=n.joeColorPlaceholderSelectionLogic)||void 0===o?void 0:o.call(n,e))&&void 0!==s?s:f(t,HG))
r(i)||(g=i)}r(g)&&(g=Se(XO))
const v=null!==(a=n.overrideTextColorKey)&&void 0!==a?a:EL,m=ye(f(t,v)),y=new QW(d,n.overrideWidth||h(t,tG),n.overrideHeight||h(t,OG),w)
return y.backgroundColor=g,y.checksum=f(t,eE),i(m)&&(y.textColor=m),i(n.style)&&(y.style=n.style),i(n.cropCode)&&(y.crop=n.cropCode),i(n.contentMode)&&(y.contentMode=n.contentMode),y})}function Wd(e,t,n,r){return Bv.context(gT,()=>{const o=Jd(e,t,r)
if(!i(o))return null
const s=new XW(o),a=j(t,Zq),c=Lh(e,t,a,n)
return Oh(e,s,c),s})}function zd(e,t,n,r){return Bv.context(gT,()=>{const i=[]
o(n.targetType)&&(n.targetType=Hq)
for(const o of t){const t=Wd(e,o,n,r)
t&&(i.push(t),bh(n.locationTracker))}return i})}function Yd(e,t,n,r){const i=Ke(e,t,"editorialArtwork.searchCategoryBrick")
if(o(i))return null
let s=r
n===_m.seeAllPage&&(s=Vv.Density1)
let a=[],c=[]
switch(s){case Vv.Density1:const e=n===_m.categoryBreakout?"1191":"2350"
i[tG]=e,i[OG]=RL,a=[vT,"SCB.ApSCBL03"],c=[Hv.right,Hv.left]
break
case Vv.Density2:i[tG]="2482",i[OG]=RL,a=["SCB.ApSCBS01","SCB.ApSCBS02"],c=[Hv.left,Hv.right]
break
case Vv.Density3:i[tG]=RL,i[OG]=RL,a=["cc"],c=[Hv.scaleAspectFit]}return a.map((t,n)=>qd(e,i,{cropCode:t,contentMode:n<c.length?c[n]:null,useCase:n6.Default,withJoeColorPlaceholder:!0}))}function Jd(e,t,n,o,s,a){return Bv.context("iconFromData",()=>{if(!t)return Bv.unexpectedNull(cH,kj),null
const c=null!=a?a:Qd(e,t,o),l=Zd(e,t),u=o||e.host.clientIdentifier,d=function(e,t,n,r,o,i){if(r!==Vz&&!et(e,t,AG))return null
if(o){const r=se(t,i,mT)
if((0,Uv.isSome)(r))return qd(e,r,{...n,style:DL,cropCode:"bb",withJoeColorPlaceholder:!0})}const s=se(t,i,tE)
if((0,Uv.isSome)(s)){const t=o?DL:m$,r=o?"ic":void 0
return qd(e,s,{...n,style:t,cropCode:r,withJoeColorPlaceholder:!0})}return null}(e,t,n,u,l,c)
if((0,Uv.isSome)(d))return d
const f=function(e,t,n,r,o){const s=$f(e,t),a=Mf(e,t)&&(r===Hz||s),c=se(t,o,nE)
return a&&i(c)?qd(e,c,{...n,style:zF}):null}(e,t,n,u,c)
if((0,Uv.isSome)(f))return f
const h=function(e,t,n){if(t.type!==FH)return null
const r=B(t,Hq)
return(0,Uv.isSome)(r)?qd(e,r,{...n,style:HU}):null}(e,t,n)
if((0,Uv.isSome)(h))return h
const p=function(e,t,n,r){if(t.type!==xq)return null
if(r){const r=B(t,sH)
if((0,Uv.isSome)(r))return qd(e,r,{...n,style:sB,cropCode:"bb"})}const o=B(t,Hq)
if((0,Uv.isSome)(o)){const t=r?sB:XN,i=r?"ia":void 0
return qd(e,o,{...n,style:t,cropCode:i,allowingTransparency:!0})}return null}(e,t,n,l)
if((0,Uv.isSome)(p))return p
r(s)&&(s=Ge(e,t))
const w=ot(e,t,s,Hq,c),g=function(e,t,n,r,o){return o!==Gj&&r!==Wz?null:qd(e,t,{...n,style:_L})}(e,w,n,u,c)
if((0,Uv.isSome)(g))return g
const v=function(e,t,n,r,o){return o!==HV&&r!==yz?null:qd(e,t,{...n,style:m$})}(e,w,n,u,c)
return(0,Uv.isSome)(v)?v:function(e,t,n,r,o,i,s){const a=s===ZV,c=a&&!0
if(o){const n=ot(e,t,i,sH,s)
if((0,Uv.isSome)(n))return qd(e,n,{...r,style:sB,cropCode:"bb",allowingTransparency:c})}let l,u
return o?(l=sB,u=a?"ib":"ia"):(l=a?YF:XN,u="bb"),qd(e,n,{...r,style:l,cropCode:u,allowingTransparency:c})}(e,t,w,n,l,s,c)})}function Kd(e){return ar(e,e.bag.iconArtworkRolloutRate)&&e.bag.enableIconArtwork&&!0}function Zd(e,t){const n=cf(e,t),r=e.bag.enableIPadOnlyFallbackIcons&&-1!==n.indexOf($q)&&-1===n.indexOf(jq)
return Kd(e)&&!r}function Qd(e,t,n){switch(n){case Vz:case Hz:return pq
case Wz:return Gj
case yz:return HV
default:return nt(e,t,n)}}function Xd(e,t,n,r){if(!t)return null
const o=Hf(t),i=qf(0,n),s=function(e,t){switch(t){case xL:return 13/P6.width
case ML:return 11/C6.width
case LL:return 5.5/I6.width
case y$:return j6/k6.width
case A$:return j6/O6.width
default:return null}}(0,n),a=function(e,t){switch(t){case xL:return 30/P6.width
case y$:return G6/k6.width
case A$:return G6/O6.width
default:return qf(0,t)}}(0,n)
return new ez(t,n,o,r,i,s,a)}function ef(e,t,n,r,o,i=!1,s){const a=tf(e,t,n,null,null,i,s)
if(!a)return null
const c=a.videos,l=[]
if(c&&c.length>0)for(const t of c)po(e,t,{...r,id:o}),l.push(t)
let u=null
return l.length>0&&(u=new tz,u.videos=l,u.mediaPlatform=a.mediaPlatform),u}function tf(e,t,n,o=null,s=null,a=!1,c){return Bv.context("platformVideoPreviewFromData",()=>{r(s)&&(s=Ge(e,t))
const u=function(e,t,n,r,o){return ot(e,t,n,r?cE:hj,void 0)}(e,t,s,a),d={}
if(!u)return null
let w=af(e,t,e.host.clientIdentifier,e.client.deviceType)
if(i(o)){const e=[]
for(const t of w)o.includes(t)&&e.push(t)
w=e}if(0===w.length)return null
for(const t of w){const r=Sf(e,t,e.client.screenSize)
for(const t of Object.keys(u)){const r=l(u,t),o=[]
for(const s of r){const r=p(s,EG)
if(!r){Bv.unexpectedNull(cH,Zj,`videoPreviewsByType.${t}.previewFrame`)
continue}const a=f(s,jH)
if(!a){Bv.unexpectedNull(cH,Sq,`videoPreviewsByType.${t}.video`)
continue}const l=Ot(e,f(r,Rq),h(r,tG),h(r,OG),null,null,f(r,eE))
i(c)&&(l.crop=c),o.push(new nz(a,l,n))}d[t]=o}for(const e of r)if(d[e])return new o6(d[e],Xd(0,t,e))}return null})}function nf(e,t){return Bv.context("videoPreviewsFromApiPlatformData",()=>{const n=tf(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
return n?n.videos:[]})}function rf(e,t,n,o=null,i,s,a=!1,c){return Bv.context("screenshotsFromData",()=>{const l=[]
r(s)&&(s=Ge(e,t))
let u=o
if(!u||0===u.length){const n=i||e.host.clientIdentifier
let r=e.client.deviceType
n===Vz&&(r=zq),i!==yz&&i!==mz||(r=Fq),u=af(e,t,n,r)}for(const r of u){const o=[]
let i
if(r===qH?(i=Ff(e,t,pq),xf(e,t,pq)&&o.push("faceTime")):i="tv"===r?Nf(e,t,s,a,Gj):r===Fq?Nf(e,t,s,a,HV):r===Yq?Nf(e,t,s,a,ZV):Nf(e,t,s,a),!i)continue
const u=sf(e,i,r,n,o,c)
u&&l.push(u)}return l})}function of(e,t,n,r=null,o=null,i){return function(e,t,n){const r=[]
if(n&&n.length>0){const o=n.map(e=>e.mediaPlatform)
for(const i of n){const n=[]
for(const e of i.artwork){const t=new rz
t.screenshot=e,n.push(t)}const s=i.mediaPlatform,a=new oz(n,s,o,ff(e,s),lf(e,t,o),uf(e,t,o))
r.push(a)}}return r}(e,t,rf(e,t,n,r,i,o))}function sf(e,t,n,r,o,i){const a=function(e,t){return t===qH?e.client.deviceType===$q?$q:jq:t}(e,n),c=Sf(e,a,e.client.screenSize)
let u,d=null
for(let e=0;e<c.length&&!s(d);e++)d=l(t,c[e]),u=c[e]
if(s(d)){const t=d.map(function(t){return qd(e,t,{useCase:r,cropCode:i})}),s=Xd(0,n,u,o)
return new iz(t,s)}return null}function af(e,t,n,r){return $(t,`sortedAppPlatformsFromData.${n}.${r}`,()=>{var o
const i=cf(e,t),s=[]
let a=[]
const c=function(e,t){-1===a.indexOf(e)&&-1===s.indexOf(e)&&-1!==i.indexOf(e)&&(a.push(e),t&&s.push(t))}
switch((null===(o=e.activeIntent)||void 0===o?void 0:o.appPlatform)&&c(e.activeIntent.appPlatform),n!==yz&&n!==mz||c(Fq),n){case Vz:c(zq)
break
case Hz:c(qH)}switch(r){case jq:c(jq)
break
case $q:c($q)
break
case"tv":c("tv")
break
case zq:c(zq)
break
case Yq:c(Yq)
break
case Fq:c(Fq)}return n!==yz&&n!==mz||(c($q),c(jq)),e.appleSilicon.isSupportEnabled?(c($q),c(jq)):(c(jq),c($q)),c(Yq),c(Fq),c("tv"),c(zq),c(qH),a=a.filter(function(e){return-1===s.indexOf(e)}),a})}function cf(e,t){return t?$(t,"supportedAppPlatformsFromData",()=>{const n=Mf(e,t,pq),r=$f(e,t),o=function(e,t){return et(e,t,zV)}(e,t),i=G(t,qG),s=[]
for(const e of i)switch(e){case mq:r||s.push(jq)
break
case gq:r||s.push($q)
break
case BG:s.push("tv")
break
case zq:s.push(zq)
break
case GV:s.push(Fq)}return n&&s.push(qH),o&&s.push(zq),Me(e,t,Yq)&&s.push(Yq),s}):null}function lf(e,t,n){if(df(e,t,n)){const t=n[0].appPlatform.toUpperCase()
return e.loc.string(`ONLY_FOR_${t}_APP`)}let r=n.reduce((e,t)=>e.concat(hf(t)),[])
try{return e.loc.tryString(`PLATFORMS_${r.join("_")}`)}catch(t){return r=["PHONE","PAD","MAC","VISION","TV","WATCH","MESSAGES","FACETIME"].filter(e=>r.includes(e)),e.loc.string(`PLATFORMS_${r.join("_")}`)}}function uf(e,t,n){return df(e,t,n)?"top":"bottom"}function df(e,t,n){if(1===n.length){const r=n[0],o=pf(0,t,e.appleSilicon.isSupportEnabled),i=!1,s=mf(vf(0,e.client.deviceType,o,i),r.appPlatform),a=0===r.supplementaryAppPlatforms.length,c=r.appPlatform!==e.client.deviceType
if(a&&c&&!s)return!0}return!1}function ff(e,t){const n=hf(t)
return e.loc.string(`PLATFORMS_${n.join("_")}`)}function hf(e){const t=e.appPlatform.toUpperCase(),n=e.supplementaryAppPlatforms.map(e=>e.toUpperCase())
return[t].concat(n)}function pf(e,t,n){let r=H(t,Q_)
return n&&r}function wf(e,t){let n
return e.isAvailable(Ez)&&[RG,WU].includes(e.client.buildType)&&(0,Uv.isSome)(e.ads.fetchAppBinaryTraitsOverride)&&(n=e.ads.fetchAppBinaryTraitsOverride()),(0,Uv.isNothing)(n)&&(n=ae(t,pq,yT)),n}function gf(e,t,n){if(pf(0,t,n)){const n=Qe(e,t,"minimumMacOSVersion")
if(s(n))return n}return ce(t,nt(e,t),uH)}function vf(e,t,n,r){switch(t){case jq:return[jq,qH]
case $q:return[jq,$q,qH]
case"tv":return["tv"]
case zq:return[zq]
case Yq:return n?[Yq,jq,$q]:[Yq]
case Fq:return r?[Fq,jq,$q]:[Fq]
default:return[]}}function mf(e,t){return-1!==e.indexOf(t)}function yf(e,t,n,r,o,i,s=!0){const a=function(e,t,n,r,o){let i
switch(n){case jq:return i=st(e),(0,Uv.isSome)(t)&&i.isSystemAppFromData(t)?[jq,zq,qH]:[jq,zq,qH,"tv",Fq]
case $q:return i=st(e),(0,Uv.isSome)(t)&&i.isSystemAppFromData(t)?[jq,$q,qH]:[jq,$q,qH,"tv",Fq]
case"tv":return["tv"]
case zq:return[zq]
case Yq:return r?[Yq,jq,$q]:[Yq]
case Fq:return o?[Fq,jq,$q]:[Fq]
default:return[]}}(e,t,r,o,i)
return!!a.some(e=>mf(n,e))}function Af(e,t){var n
const o=new r6
if(e.client.deviceType!==Yq)return o
if(t.type!==xq)return o.runsOnIntel=null===(n=Xe(e,t,"runsOnIntel",rt(e)))||void 0===n||n,o.runsOnAppleSilicon=et(e,t,"runsOnAppleSilicon",rt(e)),o.requiresRosetta=et(e,t,AT,rt(e)),o
const i=we(t,Kq)
if(0===i.length)return o
for(const t of i){if(r(t.attributes))continue
const n=Af(e,t)
o.runsOnIntel=o.runsOnIntel&&n.runsOnIntel,o.runsOnAppleSilicon=o.runsOnAppleSilicon&&n.runsOnAppleSilicon,o.requiresRosetta=o.requiresRosetta||n.requiresRosetta}return o}function Tf(e,t,n,r){const o=Af(e,t)
return n?o.runsOnAppleSilicon&&(!o.requiresRosetta||o.requiresRosetta&&r):o.runsOnIntel}function bf(e,t,n,r,o){const i=function(e,t,n,r){switch(t){case jq:return[jq,zq,qH]
case $q:return[jq,$q,qH]
case"tv":return["tv"]
case zq:return[zq]
case Yq:return n?[Yq,jq,$q]:[Yq]
case Fq:return r?[Fq,jq,$q]:[Fq]
default:return[]}}(0,n,r,o)
return i.some(e=>mf(t,e))}function Sf(e,t,n){switch(t){case Yq:return[Yq]
case zq:return n.isEqualTo(E6)||n.isEqualTo(B6)?[y$,A$,LL,ML,xL]:[A$,y$,LL,ML,xL]
case"tv":return["appleTV"]
case Fq:return["appleVisionPro"]
case $q:{const t=[]
return(n.isEqualTo(g6)||n.isEqualTo(v6)||n.isEqualTo(A6)||n.isEqualTo(T6))&&e.client.screenCornerRadius>0?(t.push(XB),t.push(eU),t.push(aB),t.push(cB),t.push(gq)):n.isEqualTo(w6)?(t.push(aB),t.push(XB),t.push(eU),t.push(cB),t.push(gq)):n.isEqualTo(h6)||n.isEqualTo(p6)||n.isEqualTo(m6)||n.isEqualTo(y6)||n.isEqualTo(b6)||n.isEqualTo(S6)?(t.push(eU),t.push(XB),t.push(aB),t.push(cB),t.push(gq)):n.isEqualTo(f6)?(t.push(cB),t.push(gq),t.push(eU),t.push(aB),t.push(XB)):n.isEqualTo(R6)?(t.push(eU),t.push(aB),t.push(XB),t.push(cB),t.push(gq)):n.isEqualTo(d6)?(t.push(gq),t.push(cB),t.push(eU),t.push(aB),t.push(XB)):(t.push(XB),t.push(eU),t.push(gq),t.push(cB),t.push(aB)),t}case jq:{let e
e=n.isEqualTo(i6)||n.isEqualTo(L6)?rE:n.isEqualTo(s6)||n.isEqualTo(D6)||n.isEqualTo(_6)?$L:n.isEqualTo(u6)?mq:n.isEqualTo(l6)?TT:n.isEqualTo(c6)?bT:n.isEqualTo(a6)?ST:n.isEqualTo(M6)||n.isEqualTo($6)?oE:n.isEqualTo(x6)||n.isEqualTo(F6)||n.isEqualTo(N6)?iE:$L
const t=U6.indexOf(e),r=U6.slice(0,t)
r.reverse()
const o=U6.slice(t+1)
return[e].concat(r,o)}default:return[]}}function Pf(e,t){if(r(t))return null
const n=Ke(e,t,YA),o=Ke(e,t,JA),i=pf(0,t,!0)
if(xe(e,t,Yq)&&!i){const i=e.bag.enableProductPageInstallSize?function(e,t){const n=se(t,ZV,KA)
if((0,Uv.isNothing)(n))return null
const r=n[iO]
return(0,Uv.isNothing)(r)?null:h(r)}(0,t):function(e,t){const n=wr(e,t)
if(r(n))return null
const o=l(n,"assets")
if(!o.length)return null
for(const e of o)if(f(e,"flavor")===GS)return h(e,YM)
return null}(e,t)
if(s(o)){const e=h(o,PT)
return new sz(i,null,null,e)}if(s(n)){const e=h(n,CT),t=h(n,IT)
return new sz(i,e,t,null)}return new sz(i,null,null,null)}{const r=B(t,WA)
if(r){let t=[]
e.client.thinnedApplicationVariantIdentifier&&(t=e.client.thinnedApplicationVariantIdentifier.split(" ")),t=t.concat([e.host.deviceModel,"universal"])
for(const e of t){const t=h(r[e])
if(t){if(s(o)){const e=h(o,PT)
return new sz(t,null,null,e)}if(s(n)){const e=h(n,CT),r=h(n,IT)
return new sz(t,e,r,null)}return new sz(t,null,null,null)}}}}return null}function Cf(e,t,n){let r,s=null,a=null,c=null,l=null
switch(e.client.deviceType){case Yq:n.supportsArcade?(s=sE,c="sr"):(s="editorialArtwork.centeredFullscreenBackground",c="ep")
break
case"tv":n.presentedInTopShelf?(s=aE,c="sr"):(s=sE,c="ta",a="editorialArtwork.fullscreenBackground",l="sr")
break
case Fq:s="editorialArtwork.productUberStatic16x9",c="sr"
break
default:n.supportsArcade?n.prefersCompactVariant||e.client.isPhone?(s="editorialArtwork.splashTall",c="oc"):(s=sE,c="oh"):(s=FL,c="sr")}return r=Ke(e,t,s),null!==a&&o(r)&&(r=Ke(e,t,a),null!==l&&(c=l)),i(r)&&i(c)?qd(e,r,{cropCode:c,useCase:n6.Uber,withJoeColorPlaceholder:!0,overrideHeight:null,overrideWidth:null}):null}function If(e,t,n,o,a){let c=[]
if(s(o))c=o
else switch(e.client.deviceType){case Yq:case"tv":c=[KF]
break
case $q:c=[NL]
break
case Fq:c=["productUberMotion16x9"]
break
default:c=[ZF]}let l=null,u=null
for(const n of c)if(l=Ke(e,t,[wq,n]),u=Ke(e,t,[wq,n,EG]),s(l))break
const d=null!=a?a:qd(e,u,{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(l)){const e=f(l,jH)
if(r(e))return null
let t,n
return t={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},n={muteUnmute:!0},new nz(e,d,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:t,autoPlayPlaybackControls:n})}return null}function kf(e,t,n){let r=null
switch(e.client.deviceType){case Yq:case"tv":case jq:case Fq:r=[KF,NL,ZF]
break
default:r=[NL,KF,ZF]}return If(e,t,n6.Uber,r,n)}function Of(e,t){return i(t)?`${hW}:/${yW.developer}/${yW.href}?${DW.href}=${t.href}`:null}function Ef(e,t,n){return ve(e,new Jz(e).forType(VF).addingQuery(HF,Kq).addingQuery(WH,n).addingQuery(lH,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}function Rf(e,t){switch(t){case jz:case zz:return"appStore"
case Vz:return zq
case Hz:return qH
case Wz:return $B
default:return null}}function Df(e,t){switch(t){case 6:return["L",iT]
case 7:return["10",aT]
case 8:return["12",lT]
case 9:return["14",dT]
case 10:return["16",hT]
case 11:return["18",wT]
case 12:return["AL",oT]
case 13:return["A10",sT]
case 14:return["A12",cT]
case 15:return["A14",uT]
case 16:return["A16",fT]
case 17:return["A18",pT]
case 20:return["All","kr.all"]
case 21:return["12","kr.12"]
case 22:return["15","kr.15"]
case 31:return["15+","AgeRating-AU-15"]
case 32:return["R 18+","AgeRating-AU-18"]
case 47:return["18+","AgeRating-FR-18"]
default:return}}function _f(e,t){switch(t){case jq:return e.loc.string("AppPlatform.Phone")
case $q:return e.loc.string("AppPlatform.Pad")
case Fq:return e.loc.string("AppPlatform.Vision")
case"tv":return e.loc.string("AppPlatform.TV")
case zq:return e.loc.string("AppPlatform.Watch")
case qH:return e.loc.string("AppPlatform.Messages")
case Yq:return e.loc.string("AppPlatform.Mac")
default:return""}}function Lf(e,t){var n
return null===(n=Df(0,t))||void 0===n?void 0:n[1]}function Mf(e,t,n){return et(e,t,"hasMessagesExtension",n)}function xf(e,t,n){return et(e,t,bL,n)}function $f(e,t){return et(e,t,"isHiddenFromSpringboard")}function Ff(e,t,n){return Ke(e,t,TL,n)}function Nf(e,t,n,r,o){return ot(e,t,n,r?YN:$j,o)}function Bf(e,t,n){return et(e,t,DG,n)}function Uf(e,t,n,r=!1,o){var i,s
if((0,Uv.isNothing)(t))return null
let a
if(r){const r=N(t)
W(r)&&(a=Qe(e,r,[dV,n],o))}return a=null!==(s=null!==(i=null!=a?a:Qe(e,t,[lB,n],o))&&void 0!==i?i:Qe(e,t,[dV,n],o))&&void 0!==s?s:Qe(e,t,["itunesNotes",n],o),a}function Gf(e,t,n,r=!1){var o
let i
if(r){const r=N(t)
W(r)&&(i=Qe(e,r,[dV,n]))}return i=null!==(o=null!=i?i:Qe(e,t,[lB,n]))&&void 0!==o?o:Qe(e,t,[dV,n]),i}function jf(e,t){return $(t,"isMacOSInstaller",()=>!1)}function Vf(e,t){const n=st(e)
return!(!function(e,t,n){if(n&&st(e).isSystemAppFromData(t)){const e=j(t,"watchBundleId")
if(s(e))switch(e){case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0
default:return!1}}return!1}(e,t,e.client.isTinkerWatch)&&(!e.client.isTinkerWatch||(n.isSystemAppFromData(t)?et(e,t,nO)||et(e,t,AG):et(e,t,tO)||et(e,t,AG))))}function Hf(e){switch(e){case jq:return mq
case $q:return gq
case"tv":return"tv"
case zq:return V_
case Yq:return"macbook"
case qH:return $x
case Fq:return"visionpro"
default:x(e)}}function qf(e,t){switch(t){case XB:return 18/g6.width
case eU:return 18/h6.width
case rE:return 41.5/i6.width
case $L:return 39/s6.width
case oE:return 55/M6.width
case iE:return 55/x6.width
case ML:return 34/C6.width
case LL:return 55/I6.width
case y$:return 108/k6.width
case A$:return 108/O6.width
default:return null}}function Wf(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=h(n[0])||0,i=h(n[1])||0,s=h(n[2])||0
return e.host.isOSAtLeast(o,i,s)}function zf(e,t){return!r(t)&&0!==t.length&&e.client.isActivePairedWatchSystemVersionBelow(t)}function Yf(e,t){switch(t){case dq:case VH:case GF:case QF:case l$:case XU:case BL:return!0
default:return!1}}function Jf(e,t){switch(t){case"LockupSmall":case"LockupLarge":case lE:case nG:case uB:case XF:case dB:case eN:case UL:return!0
default:return!1}}function Kf(e,t,n){const r=wr(e,t)
if(f(r,fV)===NV){const n=f(r,tU),o=Qe(e,t,uV)
if(s(o)){if(s(n)){const t=Oe(n),r={"@@expectedDateMY@@":e.loc.string("PreOrder.Date.MonthYear"),"@@expectedDateMDY@@":e.loc.string("PreOrder.Date.MonthDayYear")}
for(const[n,i]of Object.entries(r))if(o.includes(n)){let r=e.loc.formatDateWithContext(i,t,"middleOfSentence")
return o.replace(n,r)}}return o}}return n}function Zf(e,t){const n=pe(e,t,aH)
return s(n)?n:et(e,t,ZB)?pe(e,t,wH):null}function Qf(e){var t
return null!==(t=function(e,t,n){if((0,Uv.isNothing)(e)||0===t.length&&0===n.length)return null
const r=e
if((0,Uv.isNothing)(r))return null
const o=ke(r)
for(const e of t)if(Ie(o,e))return ye(e.colorHex)
for(const e of n)if(Ie(o,e))return ye(e.colorHex)
return null}(e,q6,W6))&&void 0!==t?t:ye(V6)}function Xf(e){var t,n,r,o,i
const s=[]
for(const t of l(e,_A))(0,Uv.isSome)(t)&&c(t)&&s.push(t)
return{bgColor:null!==(t=f(e,HG))&&void 0!==t?t:void 0,textColor1:null!==(n=f(e,EL))&&void 0!==n?n:void 0,textColor2:null!==(r=f(e,T$))&&void 0!==r?r:void 0,textColor3:null!==(o=f(e,uE))&&void 0!==o?o:void 0,textColor4:null!==(i=f(e,ZN))&&void 0!==i?i:void 0,textGradient:(0,jv.isDefinedNonNullNonEmpty)(s)?s:void 0}}function eh(e){var t,n,r,o,i,s
const a=Xf(e),c=[]
for(const e of null!==(t=a.textGradient)&&void 0!==t?t:[]){const t=ye(e);(0,Uv.isSome)(t)&&c.push(t)}return{bgColor:null!==(n=ye(a.bgColor))&&void 0!==n?n:void 0,textColor1:null!==(r=ye(a.textColor1))&&void 0!==r?r:void 0,textColor2:null!==(o=ye(a.textColor2))&&void 0!==o?o:void 0,textColor3:null!==(i=ye(a.textColor3))&&void 0!==i?i:void 0,textColor4:null!==(s=ye(a.textColor4))&&void 0!==s?s:void 0,textGradient:(0,jv.isDefinedNonNullNonEmpty)(c)?c:void 0}}function th(e){const t=[HG,EL,T$,uE,ZN]
for(const n of t){const t=e[n]
if(c(t)&&!Ie(ye(t),H6))return t}return null}function nh(e,t){let n=t.targetType
return n||(n=Bq),n}function rh(e){let t=e.idType
return t===rq?t=null:t||(t=lq),t}function oh(e,t){return Bf(e,t)?nq:null}function ih(e,t,n){const r=f(t,fV),o=Me(e,t,Yq,!0),i=xe(e,t,Yq,!0),s=function(e,t,n,r=!1){const o=new Set(Fe(e,t,r))
for(const e of n)if(o.has(e))return!0
return!1}(e,t,[mq,gq,qF,BG,zq],!0),a=$e(e,t,[mq,gq,qF,BG,zq],!0),c=Me(e,t,GV,!0),l=xe(e,t,GV,!0)
if(i||o&&n===ZV)switch(r){case Kq:return GS
case xq:return"macSoftwareBundle"}if((l||c&&n===HV)&&r===Kq)return"visionSoftware"
if(a||s||s&&n===pq||s&&n===zq||s&&n===Gj)switch(r){case Kq:return jS
case xq:return"mobileSoftwareBundle"}switch(r){case FH:return"softwareAddOn"
case TV:return Fj
case d$:case Nq:return sj
case Qj:return VS
default:return null}}function sh(e){return null==e?"":e}function ah(e){if(!e)return null
let t=null
const n=new qW(e).query
if((0,Nv.isSome)(n))for(const e of Object.keys(n))if("referrer"===e){n[e]===wE&&(t="com.apple.siri")
break}return t}function ch(e){var t
return(0,Nv.isNothing)(e)?{}:null!==(t=g(lh(y(e))))&&void 0!==t?t:{}}function lh(e){if(r(e))return null
if(e instanceof Array){const t=[]
for(const n of e){const e=lh(n)
i(e)&&t.push(e)}return t}if(e instanceof Object){const t={}
return Object.keys(e).forEach((n,r,o)=>{const s=lh(e[n])
i(s)&&(t[n]=s)}),t}return e}function uh(e){if(!e)return null
const t=new qW(e),n=t.query,o=null==n?void 0:n[jU],i=t.pathname
return r(o)||r(i)?null:i.endsWith("/search")?o:null}function dh(e,t,n,r){if(!t||!n)return Dq
if(t.type===xq)return $k
const o=n.style
if((0,Nv.isNothing)(o))return Dq
switch(o){case XN:case sB:return pq
case YF:return Yq
case _L:return"tv"
case m$:case DL:return Qd(e,t,null!=r?r:void 0)===HV?Fq:zq
case zF:return qH
case HU:return HU
default:return x(o),Dq}}function fh(e,t){if(!i(t))return null
const n={},r=p(t,LR)
if(!s(r))return null
const o=f(r,qS);(0,Nv.isSome)(o)&&(null==o?void 0:o.length)>0&&(n[qS]=o)
const a=f(r,WS);(0,Nv.isSome)(a)&&(null==a?void 0:a.length)>0&&(n[WS]=a)
const c=f(r,zS)
return(0,Nv.isSome)(c)&&(null==c?void 0:c.length)>0&&(n[zS]=c),n.marketing={marketingItemId:t.id},n}function hh(e,t,n){let o=null
return i(e)&&(o=S(e)),i(t)&&(r(o)&&(o={}),o.odpModuleUpdate=t.toString()),s(n)&&(r(o)&&(o={}),o.userSegment=n),o}function ph(e,t,n){const r=Ch(t.locationTracker)
return[Sh(0,t,n),...r]}function wh(e,t,n){const r=Ch(t.locationTracker)
return[Ph(0,t,n),...r]}function gh(e,t,n){const r=new z6
r.location=Sh(0,t,n),t.locationTracker.locationStack.unshift(r)}function vh(e,t,n){const r=new z6
r.location=Ph(0,t,n),t.locationTracker.locationStack.unshift(r)}function mh(e){0!==e.locationStack.length?e.locationStack.shift():Bv.unexpectedType(cH,"non-empty location stack","empty location stack")}function yh(e){const t=Ih(e)
return t?t.position:e.rootPosition}function Ah(e){const t=Ih(e)
return t?t.location:null}function Th(e,t){const n=Ih(e)
n?n.position=t:e.rootPosition=t}function bh(e){const t=Ih(e)
t?t.position++:e.rootPosition++}function Sh(e,t,n){var r
const o=Ph(0,t,n)
if(!t.id&&t.locationTracker)o.idType=sq,o.id=yh(t.locationTracker).toString()
else{const e=rh(t);(0,Uv.isSome)(e)&&(o.idType=e)
let n=t.id;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(n=t.anonymizationOptions.anonymizationString),o.id=(0,Uv.isNothing)(n)?"":n}return t.fcKind&&(o.fcKind=t.fcKind),t.displayStyle&&(o.displayStyle=t.displayStyle),t.inAppEventId&&(o.inAppEventId=t.inAppEventId),t.relatedSubjectIds&&(o.relatedSubjectIds=t.relatedSubjectIds),t.canonicalId&&(o.canonicalId=t.canonicalId),t.optimizationEntityId&&(o.optimizationEntityId=t.optimizationEntityId),t.optimizationId&&(o.optimizationId=t.optimizationId),(0,Uv.isSome)(t.rowIndex)&&(o.rowIndex=t.rowIndex),t.productVariantData&&Object.assign(o,ze(t.productVariantData)),o}function Ph(e,t,n){var r,o
let i=n;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(i=t.anonymizationOptions.anonymizationString)
const s={locationPosition:yh(t.locationTracker),locationType:nh(0,t),name:(0,Uv.isNothing)(i)?"":i}
return(0,Uv.isSome)(t.badges)&&(s.badges=null!==(o=y(t.badges))&&void 0!==o?o:void 0),t.recoMetricsData&&Object.assign(s,t.recoMetricsData),s}function Ch(e){return e.locationStack.map(e=>e.location)}function Ih(e){return 0===e.locationStack.length?null:e.locationStack[0]}function kh(e,t){var n,r,a,c,l,u,d,f
let h=t.id,p=t.title
if(s(t.anonymizationOptions)){const e=null!==(r=null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&void 0!==r?r:"ANONYMOUS"
h=e,p=e}else h&&t.createUniqueImpressionId&&(h=function(e,t){return`${t}${J6}${e.random.nextUUID()}`}(e,h))
const w={id:sh(h),name:sh(p),impressionType:nh(0,t)},g=rh(t);(0,Nv.isSome)(g)&&(w[GM]=g),t&&t.kind&&(w[fH]=t.kind),t&&t.softwareType&&(w[IN]=t.softwareType),t&&t.recoMetricsData&&Object.assign(w,t.recoMetricsData),t&&t.mercuryMetricsData&&Object.assign(w,t.mercuryMetricsData),t&&t.lockupDisplayStyle&&(w[$M]=t.lockupDisplayStyle)
const v=null!==(a=t.shouldOmitImpressionIndex)&&void 0!==a&&a
if(t&&t.locationTracker&&!v){const e=yh(t.locationTracker)
w[bb]=e,""===w.id&&(w.id=e.toString(),w[GM]=sq)}if(t&&t.modelSource&&(w.modelSource=t.modelSource),i(t.offerType)&&(w[Y$]=t.offerType),t&&i(t.displaysArcadeUpsell)&&(w[xS]=t.displaysArcadeUpsell),t&&i(t.isPreorder)&&(w[eq]=t.isPreorder),i(t.adamId)&&o(t.anonymizationOptions)&&(w[SV]=t.adamId),t&&i(t.badges)&&(w.badges=t.badges),t&&i(t.inAppEventId)&&(w[Qx]=t.inAppEventId),t&&i(t.relatedSubjectIds)&&(w.relatedSubjectIds=t.relatedSubjectIds),(null===(c=null==t?void 0:t.hintsEntity)||void 0===c?void 0:c.length)&&(w[BM]=t.hintsEntity),t&&i(t.autoAdvanceInterval)&&(w.autoAdvanceInterval=t.autoAdvanceInterval),i(null==t?void 0:t.fcKind)&&(w.fcKind=t.fcKind),i(null==t?void 0:t.canonicalId)&&(w[cN]=t.canonicalId),i(null==t?void 0:t.displayStyle)&&(w[dH]=t.displayStyle),i(t.productVariantData)&&Object.assign(w,ze(t.productVariantData)),(0,Nv.isSome)(t.contentRating)&&(w[AU]=t.contentRating),(0,Nv.isSome)(t.bundleId)&&(w[oq]=t.bundleId),w.impressionType!==F$){if((0,Nv.isSome)(t.adsMetricsData)){const e=ch(t.adsMetricsData)
Object.assign(w,e)}if(null!==(l=t.isAdvert)&&void 0!==l&&l||null!==(u=t.isAdEligible)&&void 0!==u&&u){const e=null===(f=null===(d=t.pageInformation)||void 0===d?void 0:d.adPageInfo)||void 0===f?void 0:f.sharedImpressionsArrayFields
if((0,Nv.isSome)(e)){const t=ch(e)
Object.assign(w,t)}}}return""===w.id&&e.console.log(`impressionId missing. Tracking broken for ${w.name} of ${w.impressionType}`),w}function Oh(e,t,n){t&&(t.impressionMetrics=new CY(kh(e,n)))}function Eh(e,t,n){var r
t&&(Oh(e,t,n),(n.isAdvert||n.isAdEligible)&&(null===(r=n.pageInformation)||void 0===r?void 0:r.adPageInfo)&&t.impressionMetrics&&(t.impressionMetrics=new Y6(t.impressionMetrics,!0)))}function Rh(e,t,n,r,o,i,s=!0){var a,c,l,u,d,f
if(!t)return
const h=kh(e,n)
if(s?(h[$S]=sh(r),h[PM]=sh(o)):(r&&(h[$S]=r),o&&(h[PM]=o)),i&&(h[FS]=i),(null!==(c=null===(a=null==n?void 0:n.optimizationEntityId)||void 0===a?void 0:a.length)&&void 0!==c?c:0)>0&&(h[NS]=n.optimizationEntityId),(null!==(u=null===(l=null==n?void 0:n.optimizationId)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0&&(h[BS]=n.optimizationId),(0,Nv.isSome)(null==n?void 0:n.rowIndex)&&(h.rowIndex=n.rowIndex),t.impressionMetrics=new CY(h),(n.isAdvert||n.isAdEligible)&&(null===(d=n.pageInformation)||void 0===d?void 0:d.adPageInfo)){const r=ch(n.pageInformation.adPageInfo.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
Object.assign(t.impressionMetrics.fields,r),t.impressionMetrics=new Y6(t.impressionMetrics,!0),n.isAdvert&&(null===(f=t.impressionMetrics)||void 0===f||delete f.fields[PM])}}function Dh(e,t,n,r){if(!t||!r)return
Oh(e,t,n)
const o=ch(r.impressionsArrayFieldsForCurrentItem(e,n.locationTracker,n.adSlotOverride))
if((0,Nv.isSome)(t.impressionMetrics)){Object.assign(t.impressionMetrics.fields,o)
const e=u(n.disableFastImpressionsForAds)
t.impressionMetrics=new Y6(t.impressionMetrics,!e)}(0,Nv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields[mM]=H$)}function _h(e,t,n,r,a,c,l){var u
const d=Lh(e,t,n.title,a)
d.lockupDisplayStyle=r,d.contentRating=null===(u=n.offerDisplayProperties)||void 0===u?void 0:u.contentRating,d.bundleId=n.bundleId,o(d.targetType)&&(d.targetType=Bq),c&&Bf(e,t)&&(d.displaysArcadeUpsell=!0)
const f=a.id
return s(Gd(t))&&i(f)&&f.length>0&&(d.id=f),d}function Lh(e,t,n,r,o){return Bv.context(kR,()=>{var i,s,a
const c=ih(e,t),l=oh(e,t),u={...r,kind:c,softwareType:l,title:n,id:t.id}
if(et(e,t,eq,o)&&(u.offerType=NV),r.isAdvert||r.isAdEligible){const n=null!==(i=u.adsMetricsData)&&void 0!==i?i:{}
n[US]=!0
const o=null===(a=null===(s=r.pageInformation)||void 0===s?void 0:s.adPageInfo)||void 0===a?void 0:a.placementType,c=x0.containerIdFromType(e,o)
if((0,Nv.isSome)(c)){n[IB]=c
const e=zs(r.locationTracker,r.adSlotOverride)
n[z$]=`${c}_${e}`}const l=B(t,CG)
if((0,Nv.isSome)(l)){const e=sh(l[j$])
n[N$]=e
const t=sh(l[fR])
n[CM]=t}u.adsMetricsData=n}return u})}function Mh(e,t,n,r){return Bv.context(kR,()=>{const o=ih(e,t),i=oh(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:lq,displayStyle:HL}})}function xh(e,t,n,r){return Bv.context("impressionOptionsForMetadataRibbonItem",()=>({...e,id:t,kind:null,softwareType:null,title:n,idType:r,targetType:F$}))}function $h(e,t,n){var r,o,i,s
const a=kh(e,(r=t.term,o=n,i=t.entity,s=t.source,Bv.context("impressionOptionsForSearchHint",()=>({...o,id:"",kind:null,softwareType:null,title:r,hintsEntity:i,modelSource:s}))))
t.impressionMetrics=new CY(a)}function Fh(e){const t=l(e,BV)
for(const e of t){const t=f(e,"id");(0,Nv.isNothing)(t)||(e.id=Nh(t))}}function Nh(e){return e.includes(J6)?e.split(J6)[0]:e}function Bh(e,t,n,r){return o(t.remainingItems)?null:`${hW}:/${yW.product}/${yW.shelf}/`+Uh(t,n,r)}function Uh(e,t,n){return e.sourceSequenceId=t.getSequenceId(),e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function Gh(e,t,n,r,o,i,s,a,c){return jh(e,t.data,n,r,o,i,s,a,c)}function jh(e,t,n,i,s,a,c,l,u){if(o(t))return null
const d=[],f={shouldShowSupportedPlatformLabel:null!=u&&u}
return{items:Rd(e,t,{shouldShowOnUnsupportedPlatform:null!=u&&u,lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:l},artworkUseCase:i,canDisplayArcadeOfferButton:Yf(0,s),...r(a)?{}:{offerStyle:a},...f},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(d.push(t),!1),filter:c}),remainingItems:d}}function Vh(e,t,n){if(!n)return
let r=-1,o=null
n.forEach((e,n)=>{const i=e,s=i,a=i&&i.adamId===t,c=s&&s.productIdentifier===t;(a||c)&&(r=n,o=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,wj,"ad",{type:j_})))}),-1!==r&&(n.splice(r,1),n.splice(0,0,o))}function Hh(e){if(-1===t3.indexOf(e.media.kind))return!1
const t=e.clickAction
if(!t)return!0
const n=t.pageUrl
if(!n)return!0
const r=new qW(n),o=qh()
for(const e of o)if(new zW(e).matches(r))return!1
return!0}function qh(){return[{protocol:pW,path:`/{countryCode}/${yW.product}/{appName}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.isPPT}?`,`${DW.appEventId}?-caseInsensitive`,`${DW.offerItemId}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,path:`/{countryCode}/${yW.productBundle}/{appName}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:`/{countryCode}/${yW.product}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.appEventId}?-caseInsensitive`,`${DW.offerItemId}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,path:`/{countryCode}/${yW.productBundle}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:`/${yW.product}/{appName}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.appEventId}?-caseInsensitive`,`${DW.offerItemId}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,path:`/${yW.productBundle}/{appName}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:`/${yW.product}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.appEventId}?-caseInsensitive`,`${DW.offerItemId}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,path:`/${yW.product}/{id}`,query:[`${DW.v0}?`,`${DW.metrics}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,path:`/${yW.productBundle}/{id}`,query:[`${DW.action}?`,`${DW.offerName}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,query:[DW.bundleIdentifier,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]},{protocol:pW,query:[DW.action,DW.ids,`${DW.isPurchasesApp}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:pW,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.offerItemId}?`]},{protocol:pW,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,hostName:`${TW}`,path:`/${yW.siri}/{id}`,query:[`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:pW,path:`/${yW.store}/${yW.viewSoftware}`,query:[DW.id,`${DW.v0}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`]},{protocol:hW,path:`/${yW.product}/{id}`,query:[DW.invalidateWidgetsOnFailure,`${DW.metrics}?`,`${DW.offerItemId}?`,`${DW.appEventId}?`,`${DW.isPreloading}?`,`${DW.isViewOnly}?`,`${DW.includeUnlistedApps}?`,`${DW.webBrowser}?`,`${DW.webBrowserFlowType}?`]}]}function Wh(e,t,n){const r=n[Wj],o=e3.fromJSON(e,r)
let i
if(o.isBundleShelf)i=xq
else switch(o.contentType){case pV:case hU:case eF:i=Nq
break
case WF:i=FH
break
default:i=Kq}const s=[Tq,wq,uH]
return e.appleSilicon.isSupportEnabled&&s.push(hH),e.bag.enableUpdatedAgeRatings&&s.push(iq),Kd(e)&&s.push(sH),new Jz(e).withIdsOfType(o.remainingItems.map(e=>e.id),i).includingAdditionalPlatforms(ee(e)).includingAttributes(i===FH?[]:s)}async function zh(e,t,n,s,a=!1){const c=n[Wj],l=e3.fromJSON(e,c)
l.isFirstRender=!1
const u=St(t)
l.recoMetricsData=null!=u?u:l.recoMetricsData,n[DW.shelfRefreshType]===GW&&K6.resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,l)
const d=function(e,t,n,s){return Bv.context("shelfFromLookupResponse",()=>{switch(n.onDemandShelfType){case Lm.SimilarItems:return function(e,t,n,i){return Bv.context("similarItemsSecondaryShelf",()=>{var s,a,c
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const l=new K6(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),u=HH,d=kU,f={pageInformation:l.metricsPageInformation,locationTracker:l.locationTracker,targetType:u,id:K6.similarItemsShelfId,idType:d,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
gh(0,f,n.title)
const h=new YY(n.contentType)
if(Kt(e,NH)||Kt(e,rH)){const o=null===(s=Ah(l.locationTracker))||void 0===s?void 0:s.id;(0,Nv.isSome)(o)&&(null===(a=n.sourcePageInformation.adPageInfo)||void 0===a||a.recordAdResponseEventsIfNeeded(e,i,o,0))
const u=function(e,t){var n
const r=null===(n=null==t?void 0:t.onDeviceAd)||void 0===n?void 0:n.positionInfo
if((0,Nv.isNothing)(r)||(0,Nv.isNothing)(t))return null
let o
switch(t.placementType){case NH:o=vG
break
case rH:o=pO}return(0,Nv.isNothing)(o)?null:Za(e,t,{shelfIdentifier:o,slot:r.slot-1})}(e,i)
null===(c=l.metricsPageInformation.adPageInfo)||void 0===c||c.updateForAdResponse(e,i)
const d=function(e,t){if(r(e))return[]
const n=[]
return Object.entries(e.tasks).forEach(([r,o])=>{r.startsWith(t)&&(n.push(o),delete e.tasks[r])}),n}(u,o)
d.forEach(e=>{(t=t.filter(t=>t.id!==e.data.id)).splice(e.positionInfo.slot,0,e.data)})}const p=jh(e,t,l,Hd(0,n.contentType),n.contentType,n.offerStyle,null,n.recoMetricsData)
if(o(p))return null
h.title=n.title,h.items=p.items,h.isHorizontal=!0
const w=new e3(n.productId,t,n.title,n.shouldInferSeeAllFromFetchesItems,void 0,n.contentType,null,null,null,null,null,Lm.SimilarItems),g=Uu(0,n.productId,w,l,n.destinationPageInformation)
return h.refreshUrl=g,t.length<2?h.rowsPerColumn=1:n.supportsArcade?h.rowsPerColumn=2:h.rowsPerColumn=3,l.addImpressionsFieldsToSimilarItemsShelf(e,h,u,d),un(e,[h],NH,f.id,f.pageInformation),mh(l.locationTracker),bh(l.locationTracker),h})}(e,t.data,n,s)
case Lm.MoreByDeveloper:return function(e,t,n){return Bv.context("moreByDeveloperSecondaryShelf",()=>{if(o(t))return null
const r=new K6(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId)
gh(0,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:KH,id:`${r.getSequenceId()}`,idType:sq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData},n.title)
const i=new YY(n.contentType)
i.title=n.title
const s=e.client.isCompanionVisionApp?Wv.VisionOSCompatibility:void 0,a=jh(e,t,r,Hd(0,n.contentType),n.contentType,n.offerStyle,s)
if(o(a))return null
if(i.items=a.items,i.isHorizontal=!0,t.length<2?i.rowsPerColumn=1:i.rowsPerColumn=2,(0,Nv.isSome)(n.developerUrl)){const t=new fY(eW)
t.pageUrl=n.developerUrl,t.title=e.loc.string(KV),Xs(e,t,t.pageUrl,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),i.seeAllAction=t}return r.addImpressionsToShelf(e,i,PH),mh(r.locationTracker),bh(r.locationTracker),i})}(e,t.data,n)
case Lm.SmallStory:return function(e,t,n){return Bv.context("smallStorySecondaryShelf",()=>{if(o(t))return null
const r=new K6(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),i={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:KH,id:`${r.getSequenceId()}`,idType:sq,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
let s
if(gh(0,i,n.title),Gu(e)){const r=new bZ(i.pageInformation,i.locationTracker)
s=Vc(e,null!=t?t:[],n.title,null,r)}else{const r={metricsLocationTracker:i.locationTracker,metricsPageInformation:i.pageInformation,filterOutMediaCardKinds:Yh(e.host.platform)}
s=jc(e,t,pV,n.title,null,r),Array.isArray(null==s?void 0:s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Uc(0,e.media.kind,pV)))}return s.isHorizontal=!0,r.addImpressionsToShelf(e,s,tH),mh(r.locationTracker),bh(r.locationTracker),s})}(e,t.data,n)}const a=new YY(n.contentType),c=St(t),l={pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,excludeAttribution:!0,recoMetricsData:null!=c?c:n.recoMetricsData}
let u
if(n.contentType===hU){const n=qc(e,t.data,l.pageInformation,l.locationTracker,Hh)
i(n)&&(u=[n])}else{const r={metricsOptions:l,offerStyle:n.offerStyle,artworkUseCase:Hd(0,n.contentType),canDisplayArcadeOfferButton:Yf(0,n.contentType)}
n.contentType===WF&&(r.skipDefaultClickAction=!0)
const o={lockupOptions:r}
n.isBundleShelf&&(o.filter=Wv.None)
const i=Ed(e,t,o),s={[Vz]:m$,[Hz]:zF}[e.host.clientIdentifier]
s&&i.sort((e,t)=>{const n=e.icon.style===s,r=t.icon.style===s
return n&&r?0:n&&!r?-1:1})
const a=n.spotlightInAppProductIdentifier
a&&Vh(0,a,i),u=i}return a.items=u,a.mergeWhenFetched=!0,a})}(e,t,l,s)
if(a&&function(e,t,n,o){if(r(n))return
let i=[]
const s=Nt(n),a=Jn(e,n,o)
i.push(a)
const c=Qn(e,n,o).map(e=>e.data)
i=i.concat(c),Yn(s),i.forEach(e=>Yn(e.fields)),t.pageChangeMetrics={pageFields:s,updatedEvents:i}}(e,d,l.sourcePageInformation),d.refreshUrl=l.refreshUrl,n[DW.shelfRefreshType]===GW&&K6.addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,d,l),l.shouldInferSeeAllFromFetchesItems){const t=new fY(eW)
t.title=e.loc.string(KV)
const n=new YY(d.contentType)
n.items=function(e,t,n,r=!1){var o,s
if(!t)return null
let a=0
const c=[]
for(const e of t){if(r&&i(null!==(o=e.searchAd)&&void 0!==o?o:null===(s=e.searchAdOpportunity)||void 0===s?void 0:s.searchAd)){a+=1
continue}const t=S(e)
if(n&&t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,n)),a>0){const e=S(t.impressionMetrics.fields),n=h(e.impressionIndex);(0,Uv.isSome)(n)&&(e.impressionIndex=n-a,t.impressionMetrics=new CY(e,t.impressionMetrics.id,t.impressionMetrics.custom))}c.push(t)}return c}(0,d.items,TH,!0)
const r=new ZY([n])
jn(e,r,l.destinationPageInformation),r.title=l.title,t.pageData=r,Xs(e,t,null,{pageInformation:l.sourcePageInformation,locationTracker:l.sourceLocationTracker}),d.seeAllAction=t}return o(d.items)&&!l.hasExistingContent&&(d.isHidden=!0),d}function Yh(e){const t=new Set([BN])
return e===OV&&(t.add(aj),t.add(Jk),t.add(NU),t.add(H_)),t}async function Jh(e,t){return typeof campaignAttribution!==wU?await campaignAttribution.processRedirectURL(t):await e.network.fetch({url:e.bag.redirectUrlEndpoint,method:rG,headers:{"Content-Type":FM},body:`url=${encodeURIComponent(t)}`}).then(e=>e.ok)}async function Kh(e,t){const n=e.required(n3)
0!==Mn(e,new qW(t.url)).length&&Jh(e,t.url),t.url=function(e,t){const n=new qW(t.url)
if(FO in n.query){const r=f(t.referrerData,Mq)===gz,o=e.host.clientIdentifier===wz
return r||o||delete n.query[FO],n.toString()}return t.url}(e,t)
const r=new Cm.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r)
return await n.fetchAction(o,t.url,t.referrerData).then(n=>{if(!n)throw new Error(`Promise resolved to null action for: ${t.url}`)
if(t.isIncomingURL){const e=[n]
if(T(o=n)&&o[tW]===Zk)for(const t of n.actions)e.push(t)
for(const t of e){const e=t.pageData
e&&typeof e===Zj&&nB in e&&zn(0,e)}}var o
if(n.actionClass===W_){const e=n
e.page===cj||e.page===cq||e.page===xO||e.page===dj||e.page===xF||e.page===Hx||e.page===nH||e.page===u$||e.page===$O?e.presentationContext=TH:e.page===$A?e.presentationContext=X_:e.page===tB?e.presentationContext=Mj:t.isIncomingURL?e.presentationContext=aL:(e.presentationContext="replace",e.animationBehavior=qV)}return t.isIncomingURL&&(e.deepLinks.hasResilientDeepLinks()||e.deepLinks.removeDeepLink(t.url)),r.decorate(n),n}).catch(n=>{let r=[]
n instanceof KW?r=n.reasons.filter(e=>e instanceof kK):n instanceof kK&&r.push(n)
for(const n of r)if(204===n.statusCode){const n=new gY(vq)
n.title=e.loc.string("APP_NOT_AVAILABLE_TITLE"),n.message=e.loc.string("APP_NOT_AVAILABLE_MESSAGE"),n.isCancelable=!0
{const r=new cX(_q)
if(r.title=e.loc.string(AL),v(new qW(t.url).query[FA])){const e=new S3
r.actions=[n,e]}else r.actions=[n]
return r}}throw Error(n.message)})}function Zh(e,t,n){switch(t){case cO:return function(e,t){const n=Wa(e,e.bag.accountUrl)
return n.title=e.loc.string("VIEW_ACCOUNT_INFO",qx),Qs(e,n,{...t,id:nH,actionType:Xq},!1,UB),n}(e,n)
case lO:return function(e,t){const n=e.bag.signup
if((0,Uv.isNothing)(n))return null
const r=Wa(e,n)
return e.featureFlags.isEnabled(tJ)?r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID_REBRAND"):r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID"),Qs(e,r,{...t,id:nH,actionType:Xq},!1,UB),r}(e,n)
case oL:return function(e,t){if((0,Uv.isNothing)(e.bag.purchaseHistoryUrl))return null
const n=Wa(e,e.bag.purchaseHistoryUrl)
return n.title=e.loc.string("ACCOUNT_PURCHASE_HISTORY"),n.presentationContext=aL,Qs(e,n,{...t,id:oL,actionType:Xq},!1,UB),n}(e,n)
case RF:return function(e,t){if(e.user&&e.user.isManagedAppleID)return null
const n=Wa(e,e.bag.redeemUrl)
return n.title=e.loc.string("ACCOUNT_REDEEM",fO),Qs(e,n,{...t,id:"redeemGiftCardOrCode",actionType:Xq},!1,UB),n}(e,n)
case uO:return function(e,t){if(!e.bag.isMonetaryGiftingEnabled)return null
const n=Wa(e,DF)
return n.title=e.loc.string("ACCOUNT_SEND_GIFT",tA),Qs(e,n,{...t,id:"sendGiftCardByEmail",actionType:Xq},!1,UB),n}(e,n)
case dO:return function(e,t){var n
const r=e.bag.accountTopUpURL
if((0,Uv.isNothing)(r)||o(r))return null
const i=Wa(e,r)
return i.title=null!==(n=e.bag.accountTopUpTitle)&&void 0!==n?n:e.loc.string("ACCOUNT_TOP_UP"),Qs(e,i,{...t,id:"addFundsToAppleId",actionType:Xq},!1,UB),i}(e,n)
case iL:return function(e,t){const n=new E3(nq,nA)
return n.title=e.loc.string("ACCOUNT_SETUP_FAMILY_SHARING"),Qs(e,n,{...t,id:"setUpFamilySharing",actionType:Xq},!1,UB),n}(e,n)
case sL:return function(e,t){const n=Wa(e,e.bag.manageSubscriptionsV2Url)
return n.title=e.loc.string("ACCOUNT_SUBSCRIPTIONS"),n.presentationContext=aL,Qs(e,n,{...t,id:sL,actionType:Xq},!1,UB),n}(e,n)
default:return null}}function Qh(e){const t=new Cm.FetchTimingMetricsBuilder,n=e.addingFetchTimingMetricsBuilder(t),r={pageInformation:Gn(e,qx,nH,""),locationTracker:{rootPosition:0,locationStack:[]},targetType:yq},o=t.measureModelConstruction(()=>{const t=new O3
return t.links[cO]=Zh(e,cO,r),t.links[lO]=Zh(e,lO,r),t.links[RF]=Zh(e,RF,r),t.links[uO]=Zh(e,uO,r),t.links[dO]=Zh(e,dO,r),t.links[iL]=Zh(e,iL,r),t.links[sL]=Zh(e,sL,r),t.links[oL]=Zh(e,oL,r),t})
return jn(n,o,r.pageInformation),o}async function Xh(e,t){return await e.required(n3).fetchPage(e,t,M3)}async function ep(e){let t
try{t=await Ln(e,function(e){return new Jz(e).forType(T_)}(e))}catch{t=void 0}return function(e,t){const r=[],o=new $3,i=new AX(e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_IN"),kV,u$)
o.addContentItem(new N3(i))
const a=e.bag.personalizedRecommendationsToggleEnabled
if(!a){const t={}
t[e.loc.string(b_)]=rp(e)
const n=new i5(e.loc.string("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",e.loc.string(b_)))
o.footer=new s5(n,t)}if(r.push(o),a){const t=new $3
t.addContentItem(new B3(e.loc.string(SI),!1))
const n=new i5(e.loc.string(PI))
t.footer=new s5(n),r.push(t)}{const t=new $3(e.loc.string("PERSONALIZATION_SECTION_USAGE_HEADER")),n=new i5(e.loc.string("PERSONALIZATION_SECTION_USAGE_FOOTER"))
t.footer=new s5(n),t.addContentItem(new U3(e.loc.string("PERSONALIZATION_SECTION_USAGE_CLEAR_DATA"),function(e){const t=new j3
t.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_TITLE")
const n=new eZ([t])
return n.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_HEADER"),n.isCancelable=!0,n.destructiveActionIndex=0,n}(e))),r.push(t)}const c=new $3(e.loc.string("PERSONALIZATION_INTERACTIONS")),l=new i5(e.loc.string("PERSONALIZATION_INTERACTIONS_FOOTER"))
c.footer=new s5(l)
const u=e.bag.purchaseHistoryUrl;(0,Nv.isSome)(u)?c.addContentItem(new U3(e.loc.string(CI),np(e,cj,u,!0),xN)):c.addContentItem(new U3(e.loc.string(CI),np(e,By,null,!0),xN)),c.addContentItem(new U3(e.loc.string("PERSONALIZATION_SUBSCRIPTIONS"),np(e,null,e.bag.manageSubscriptionsV2Url,!1),xN)),c.addContentItem(new U3(e.loc.string("PERSONALIZATION_PREORDERS"),np(e,null,e.bag.managePreordersUrl,!0),xN)),c.addContentItem(new U3(e.loc.string("PERSONALIZATION_RATINGS"),np(e,null,e.bag.ratingsReviewsUrl,!0),xN)),r.push(c)
const d=new $3(e.loc.string("PERSONALIZATION_ADDITIONAL_INFO")),h=[e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),p=new AX(h,kV,u$)
d.addContentItem(new N3(p)),r.push(d)
const w=n(t,"results.derived-user-info")
if(s(w)){const t=new $3(e.loc.string("ACCOUNT_INFO")),n=["gender","birthyear"]
for(const e of n){const n=f(w,`${e}.label`),r=f(w,`${e}.value`);(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0&&t.addContentItem(new G3(n,r))}const o=e.featureFlags.isEnabled(tJ)?"PERSONALIZATION_ACCOUNT_INFO_FOOTER_REBRAND":"PERSONALIZATION_ACCOUNT_INFO_FOOTER",i=new i5(e.loc.string(o))
t.footer=new s5(i),r.push(t)}return new M3(e.loc.string(II),r)}(e,t)}function tp(e){const t=[],n=e.bag.personalizedRecommendationsToggleEnabled,r=new $3,o=n?e.loc.string("PersonalizedRecommendations.OptedOut.Description"):e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_OUT"),i=new AX(o)
if(r.addContentItem(new N3(i)),t.push(r),n){const n=new $3
n.addContentItem(new B3(e.loc.string(SI),!1))
const r=new i5(e.loc.string(PI))
n.footer=new s5(r),t.push(n)}else{const n=new $3
n.addContentItem(new U3(e.loc.string(b_),rp(e),xN)),t.push(n)}return new M3(e.loc.string(II),t)}function np(e,t,n,r){let o
if((0,Nv.isSome)(t))o=new fY(t,n)
else{if((0,Nv.isNothing)(n))return null
o=Wa(e,n)}return r&&(o.presentationContext=aL),o}function rp(e){return np(e,void 0,e.bag.accountUrl,!1)}async function op(e,t){const n=new Jz(e).forType(kI).addingQuery(LD,"events-reminders").addingQuery("service",$_).addingQuery(UH,"explicit")
n.isMediaRealmRequest=!0
const r=function(e,t){const n={"events-reminders":{"com.apple.AppStore":{contents:[{id:e,type:Vq,notify:t}]}}}
return{method:"PATCH",headers:{"Content-Type":jL},requestBodyString:JSON.stringify(n)}}(t.appEventId,t.shouldSchedule)
return await new Promise((t,o)=>{Ln(e,n,r).then(e=>{t(!0)}).catch(e=>{o(e)})})}function ip(e){return Ne(e,qv.ArcadeDownloadPackOnboarding)||Fm.LayoutB}function sp(e){P9||(P9=!0,C9=new u9(e.loc.string("PAGE_FACETS_SORTS_RELEASE_DATE"),p9,YB),I9=new u9(e.loc.string("PAGE_FACETS_SORTS_LAST_UPDATED"),w9,"lastUpdated"),k9=new u9(e.loc.string("PAGE_FACETS_SORTS_NAME"),g9,Zq),O9=new u9(e.loc.string("PAGE_FACETS_SORTS_CATEGORY"),v9,Lj),E9=new u9(e.loc.string("PAGE_FACETS_DEFAULT_ALL"),null),R9=new u9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),D9=new u9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),_9=new u9(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),L9=new u9(e.loc.string(SA),XH,null,"gamecontroller"),M9=new u9(e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER"),XH,null,"person.2"),x9=new u9(e.loc.string(PA),XH),S9[DW.sort]={releaseDate:[C9],lastUpdated:[I9],name:[k9],category:[O9]},S9[DW.ageRating]={"4plus":[R9],"9plus":[D9],"12plus":[_9]},S9[DW.controllerSupport]={true:[L9],false:[]},S9[DW.multiplayerSupport]={true:[M9],false:[]},S9[DW.comingSoon]={true:[x9],false:[]})}function ap(e,t={}){sp(e)
const n={"filter[ageRating]":[E9]}
n[m9]=[C9],n[y9]=[x9]
const r=[DW.sort,DW.ageRating,DW.controllerSupport,DW.multiplayerSupport,DW.comingSoon]
for(const e of r){const r=t[e]
if(o(r))continue
const a=S9[e][r],c=$9[e]
i(a)&&s(c)&&(n[`${c}`]=a)}return n}function cp(e,t){const n=new fW
return ea(e,n,t),n}function lp(e){const t=[Tq,wq,zV,JV,hj,$j]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}function up(e,t,n){return Bv.context("createShelves",()=>{const r=[]
if(0===t.length)return r
let o=!1
for(const s of t)if(o=o||!W(s.data[0]),o)n.remainingGroups.push(s)
else{const t={index:n.lastShelfIndex,title:fp(e,s),contentType:(i=n.isCompactMode,i?dq:GF),shouldFilter:!1,remainingContent:s.data,groupKind:s.kind,isCompactMode:n.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker},o=dp(e,t)
r.push(o),n.lastShelfIndex++}var i
return r})}function dp(e,t){const n=[],r=new YY(t.contentType)
r.title=t.title,r.presentationHints={showSupplementaryText:!1},r.isHorizontal=t.groupKind===KB||t.groupKind===Lj
const i={id:`${t.index}`,kind:null,softwareType:null,targetType:KH,title:r.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:sq}
for(Oh(e,r,i),gh(0,i,r.title);s(t.remainingContent)&&W(t.remainingContent[0]);){const r=t.remainingContent.shift(),o={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},artworkUseCase:n6.LockupIconSmall,canDisplayArcadeOfferButton:Yf(0,t.contentType),shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ),isContainedInPreorderExclusiveShelf:t.groupKind===KB},i=Pd(e,r,o,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},null,null)
hp(e,i,r)&&(i.editorialTagline=null,i.developerTagline=null,n.push(i),bh(t.metricsLocationTracker))}return r.mergeWhenFetched=t.hasExistingContent,t.hasExistingContent=t.hasExistingContent||n.length>0,r.items=n,s(t.remainingContent)?r.url=function(e){return o(e.remainingContent)?null:`${hW}:/${yW.arcadeSeeAllGames}/${yW.shelf}/?${DW.token}=${encodeURIComponent(JSON.stringify(e))}`}(t):"tv"!==e.client.deviceType&&t.isCompactMode&&r.items.length<3&&(r.rowsPerColumn=r.items.length),mh(t.metricsLocationTracker),r}function fp(e,t){let n,r,o=null,i=null
if((!t.name||0===t.name.length)&&t.kind!==KB)return""
switch(t.kind){case"releaseDateByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE"),n=e.loc.formatDateInSentence(r,MA,i)
break
case"lastUpdatedByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),n=e.loc.formatDateInSentence(r,MA,i)
break
case KB:n=e.loc.string("Arcade.SeeAllGames.ComingSoonShelf.Title")
break
default:n=t.name}return n}function hp(e,t,n){if(o(t.trailers)){const r=kf(e,n)
if(s(r)){const e=new tz
r.playbackControls={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},r.autoPlayPlaybackControls={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0},r.canPlayFullScreen=!0,e.videos=[r],t.trailers=[e]}}return o(t.trailers)&&function(e){const t=e.screenshots[0]
if(o(t))return
const n=t.artwork[0],r=new nz(F9,n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,autoPlayPlaybackControls:{},playbackControls:{}}),i=new tz
i.videos=[r],e.trailers=[i]}(t),s(t.trailers)}async function pp(e,t){const n=e.required(n3),r=qW.from(t.url)
return r.param(DW.requestDescriptor,JSON.stringify(t)),await n.fetchPage(e,r.build(),l9)}async function wp(e,t){const n=e.required(n3)
return await n.fetchMoreOfPage(e,t).then(function(e){return e})}function gp(e,t){const n=ap(e,t),r={}
for(const e of Object.keys(n))r[e]=n[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue,systemImageName:e.systemImageName}))
const o={url:`${hW}:/${yW.arcadeSeeAllGames}`,isCompactMode:!1,selectedFacetOptions:r},i=t[DW.requestDescriptor]
if(s(i)){const e=g(JSON.parse(i))
o.isCompactMode=e.isCompactMode,Object.assign(o.selectedFacetOptions,e.selectedFacetOptions)}return o}async function vp(e,t){const n=qW.from(t)
return await e.required(n3).fetchPage(e,n.build(),G9)}function mp(e){let t=0,n=0
for(const r of e.shelves)(0,Nv.isSome)(r.batchGroup)&&r.batchGroup.length>0||(r.batchGroup=`shelfBatchGroup_${t}`,n++,5===n&&(n=0,t++))}async function yp(e,t){const n=qW.from(t.url)
return n.param(DW.isArcade,"true"),n.param(DW.isSubscribed,`${t.isSubscribed}`),n.param(DW.isTrialAvailable,`${t.isTrialAvailable}`),n.param(DW.isTrialEnrolled,`${t.isTrialEnrolled}`),await e.required(n3).fetchPage(e,n.build(),H9)}function Ap(e,t){const n=new cX(qq)
n.popToRoot=!0
const r=new MJ([n])
return r.title=t,r}async function Tp(e,t){return await e.required(n3).fetchPage(e,t,J9)}async function bp(e,t){const n=new Promise((n,r)=>{const o=t
s(o)||r(new Error("fetchUpsellGrid called with malformed contentDictionary"))
const i=we(o,Jq),a={pageInformation:new BJ({}),locationTracker:{rootPosition:0,locationStack:[]}},c=zd(e,i,a,{useCase:n6.LockupIconMedium}),l=c.shift()
n(new r8(l,c))})
return await n}async function Sp(e,t){const n=g(t,Wj)
let r=n.buyParams
const o=g(t,MI),i=g(t,xI);(0,Nv.isSome)(i)&&(o.adPageInfo={adAdamId:i._adAdamId,...i}),r=pr(e,f(t,SV),r,o,u(t,$I),u(t,FI),f(t,NI),f(t,BI),f(t,P_),p(t,fj),p(t,UI),g(t,GI),f(t,jI),f(t,"token.extRefApp2"),f(t,"token.extRefUrl2"))
const s=new GJ(r),a={product:f(t,oH)||n.productIdentifier,adamId:f(t,SV),buyParams:s.toEncodedMap()}
return await Promise.resolve(a)}async function Pp(e,t){const n=t.offerAction,o=t.offerDisplayProperties
if(!n||!o)return await Promise.reject(new Error("Invalid offerToken for personalized offer fetch."))
const i=n.adamId,s={"Content-Type":FM},a={url:e.bag.buyButtonMetadataURL,method:rG,headers:s,body:"ids="+i,signingStyle:MV},c=e.network.fetch(a)
return await c.then(t=>{if(!t.ok)throw Error(`Bad Status code ${t.status} for ${a.url}`)
const s=p(JSON.parse(t.body),i)
let c=null,u=null
const d=function(e,t){return Bv.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const e=l(t,QG)
if(0===e.length)return null
for(const t of e){const e=f(t,fV)
if(e)return e}return rq})}(0,s)
if(r(d))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata")
if(d!==rq){let t=wj
c=function(e,t,n,o){return Bv.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const o=l(t,QG)
if(0===o.length)return null
let i,s=null
for(const e of o)switch(i=f(e,fV),i){case VM:case Ux:s=e
break
default:s=null}if(!s)return null
let a=f(s,lj)
if(i===VM&&r(a))return Bv.unexpectedNull(cH,Sq,ZE),null
a||(a="")
const c=n.purchaseConfiguration,u=new nZ(a,c.vendor,c.appName,c.bundleId,c.appPlatforms,c.isPreorder,c.excludeAttribution,c.metricsPlatformDisplayStyle,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.appCapabilities,c.isDefaultBrowser,c.remoteDownloadIdentifiers,c.hasMacIPAPackage,c.contentRating)
u.pageInformation=c.pageInformation
const d=Tr(e,s,n.adamId,u,!1)
return function(e,t,n,r){const o=n.purchaseConfiguration.pageInformation
let i
if((0,Uv.isSome)(n.actionMetrics))for(const e of n.actionMetrics.data)if(i=l(m(e.fields),jB),i)break
Ks(e,t,t.adamId,false,o,i,!1)}(e,d,n),d})}(e,s,n)
let i=null
switch(d){case Ux:t=NB,i=e.loc.string("OfferButton.Title.BundlePurchased")
break
case VM:(r(c.price)||0===c.price)&&(i=e.loc.string(HM))}u=function(e,t,n,o,i){return r(t)?null:Bv.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const r=new SY(n,t.adamId,t.bundleId,i),s=mr(0,t)
r.isFree=s
let a=null
a=s?t.title:t.priceFormatted,r.titles[Wq]=a,r.priceFormatted=t.priceFormatted
const c=o.hasInAppPurchases,l=o.hasExternalPurchases
if(r.hasInAppPurchases=c,r.hasExternalPurchases=l,l){const t=e.loc.string(aP)
r.subtitles[Wq]=t}else if(c){const t=e.loc.string(sP)
r.subtitles[Wq]=t}return r.contentRating=o.contentRating,r.ignoresContentRestrictions=o.ignoresContentRestrictions,r.appCapabilities=t.purchaseConfiguration.appCapabilities,r})}(e,c,Mq,o,t),i&&(u.titles[Wq]=i)}const h=Er(e,c,!1)
return new c8(d,h,u)})}async function Cp(e,t){var n
let r=f(t,"token.buyParams")
const s=f(t,"overrideBuyParams")
i(s)&&(r=function(e,t){const n=new GJ(e),r=new GJ(t),i=n.get(cZ.placementId,null);(null==i?void 0:i.length)>0&&o(r.get(cZ.placementId,null))&&r.set(cZ.placementId,i,null)
const s=n.get(cZ.containerId,null);(null==s?void 0:s.length)>0&&o(r.get(cZ.containerId,null))&&r.set(cZ.containerId,s,null)
const a=n.get(cZ.templateType,null)
return(null==a?void 0:a.length)>0&&o(r.get(cZ.templateType,null))&&r.set(cZ.templateType,a,null),r.toString()}(r,s))
const a=g(t,MI),c=g(t,xI);(0,Nv.isSome)(c)&&(a.adPageInfo={adAdamId:c._adAdamId,...c}),r=pr(e,f(t,SV),r,a,u(t,$I),u(t,FI),f(t,NI),f(t,BI),f(t,P_),p(t,fj),p(t,UI),g(t,GI),f(t,jI),f(t,"metrics.extRefApp2"),f(t,"metrics.extRefUrl2"))
const d=l(t,"token.appPlatforms"),w=d&&d.length&&d.length>0&&d.indexOf("tv")>=0,m=d&&d.length&&d.length>0&&d.indexOf(Fq)>=0,y=u(t,"token.isHalva")||u(t,"token.isMacOSCompatibleIOSApp"),A=u(t,"token.supportsVisionOSCompatibleIOSBinary"),T=vf(0,e.client.deviceType,y,A).some(e=>-1!==d.indexOf(e)),b=y&&!1,S=(d.indexOf(Fq),A&&!1),P=f(t,"instalationType"),C=P===jM,I=P===YO,k=u(t,"token.isPreorder"),O=!(k||(w||m)&&!T),E=f(t,P_)===zq&&e.client.deviceType!==zq,R=f(t,"token.preflightPackageUrl"),D={...p(t,"token.additionalHeaders",{}),...p(t,"additionalHeaders",{})}
let _={}
const L=null===(n=e.paymentMetricsIdentifiersCache)||void 0===n?void 0:n.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical])
return(0,Nv.isSome)(L)&&(_={...L}),{adamId:f(t,SV),buyParams:r,vendor:f(t,"token.vendor"),appName:f(t,"token.appName"),bundleId:f(t,"token.bundleId"),appPlatforms:d,additionalHeaders:D,isUpdate:C,isRedownload:I,isPreorder:k,createsJobs:O,preflightPackageUrl:R,isArcadeApp:v(t,"token.isArcadeApp"),forceWatchInstall:E,isMacOSCompatibleIOSApp:b,isVisionOSCompatibleIOSApp:S,presentingSceneIdentifier:f(t,"presentingSceneIdentifier"),appCapabilities:l(t,"token.appCapabilities"),isDefaultBrowser:v(t,"token.isDefaultBrowser"),requiresExceptionRequest:v(t,"requiresExceptionRequest"),forceAskToBuyReason:f(t,"forceAskToBuyReason"),contentRating:h(t,"token.contentRating"),metricsOverlay:_,remoteDownloadIdentifiers:l(t,"token.remoteDownloadIdentifiers"),hasMacIPAPackage:v(t,"token.hasMacIPAPackage")}}async function Ip(e,t){const n=new Jz(e).withIdsOfType(t,Kq).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>{const n=At(t),r={}
for(const t of n)r[t.id]=Jd(e,t,{useCase:n6.LockupIconLarge})
return r})}async function kp(e,t){const n=new eK(t.targetingData,e.random.nextUUID()),r=Ep(e,t)
if(null===r)return null
const o=Ln(e,r,function(e,t){const n={}
return(0,Uv.isSome)(t)&&t.validAdRequest()&&(n["X-Apple-App-Store-Client-Request-Id"]=t.appStoreClientRequestId,n["X-Apple-iAd-Request-Data"]=t.requestData,n["X-Apple-iAd-Env-Name"]=t.routingInfo),{headers:n}}(0,n))
if(e.bag.mediaAPISearchFocusEnabled){const n={term:t.term.trim(),entity:t.searchEntity}
e.onDeviceSearchHistoryManager.saveRecentSearchWithLimit(n,30)}const s=async function(e,t,n,r){var o
if(!t.validAdRequest())return Zt(e,"ODML fetch skipped - Malformed request"),{adverts:[],odmlSuccess:!1}
const i=await r,s=function(e,t){const n=t.results[qD]
if((0,Nv.isNothing)(n))return[]
const r=At(n),o=[]
for(const t of r){const n=f(t,"id"),r=B(t,LB)
if((0,Nv.isNothing)(n)||0===n.length||(0,Nv.isNothing)(r))continue
let i=null,s=null
e.bag.enableCPPInSearchAds&&(i=Ve(Ge(e,t)),s=qe(e,t)),o.push({instanceId:e.random.nextUUID(),adamId:n,assetInformation:{},adData:r,cppIds:s,serverCppId:i,selectedCppId:i,appBinaryTraits:wf(e,t)})}return o}(e,i),a=function(e,t,n){const r=At(t.results.search),o=[]
for(const e of r){const t=f(e,"id");(0,Nv.isNothing)(t)||0===t.length||o.push({adamId:t,assetInformation:{}})}return o}(0,i)
if(!e.isAvailable(Ez))return Zt(e,"ODML fetch skipped - Unsupported client"),{adverts:s,odmlSuccess:!1}
try{if(e.clientCapabilities.isEnabled(nY)&&e.bag.enableSRPOnDeviceAdsRanker){const t=function(e,t){const n=[],r=t.results[qD]
if((0,Nv.isNothing)(r))return[]
const o=At(r)
for(const t of o){const r=f(t,"id"),o=B(t,LB)
if((0,Nv.isNothing)(r)||0===r.length||(0,Nv.isNothing)(o))continue
const i=f(t.meta,"extraAdInfo"),s={instanceId:e.random.nextUUID(),adamId:r,assetInformation:{},appBinaryTraits:wf(e,t),position:-1,adData:o,commonAdInfo:(0,Nv.isSome)(i)?JSON.parse(i):[]}
n.push(s)}const i=At(t.results.search)
for(const[t,r]of i.entries()){const o=f(r,"id")
if((0,Nv.isNothing)(o)||0===o.length)continue
const i={instanceId:e.random.nextUUID(),adamId:o,assetInformation:{},appBinaryTraits:wf(e,r),position:t,adData:void 0,commonAdInfo:void 0}
n.push(i)}return n}(e,i),r=function(e,t){const n=f(t.meta,rA)
return(0,Nv.isNothing)(n)?{}:JSON.parse(n)}(0,i)
return await e.ads.processAndRankAds(t,r,n,e.bag.sponsoredSearchODMLTimeout)}{const t=await e.ads.processAdvertsForSponsoredSearch(s,a,n,e.bag.sponsoredSearchODMLTimeout,e.client.isPhone||e.client.isPad)
return t.odmlSuccess?Zt(e,"ODML processing completed"):Zt(e,"ODML processing failed"),{adverts:null!==(o=t.adverts)&&void 0!==o?o:s,odmlSuccess:t.odmlSuccess,installedStates:t.installedStates,appliedPolicy:t.appliedPolicy,appStates:t.appStates}}}catch(t){return Zt(e,`ODML fetch failed - ${t}`),{adverts:s,odmlSuccess:!1}}}(e,n,t.term,o),a=async function(e){if(function(e){switch(e){case $q:case Yq:return!0
default:return!1}}(e.client.deviceType)){const t=An(e,null,null,ee(e))
if(t)return await Ln(e,t).catch(()=>null)}return null}(e)
return await Promise.all([o,s,a]).then(([o,s,a])=>{var c,l,u,d
if(function(e){var t
const n=St(e),r=ED
i(n)&&i(e.meta)&&i(null===(t=e.meta)||void 0===t?void 0:t.metrics)&&(e.meta.metrics[VK]=f(n,r),delete e.meta.metrics[r])}(o),null===(u=null===(l=null===(c=o.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.naturalLanguage){const t=e.storage.retrieveString(FD),n=_e(new Date).getTime().toString()
e.storage.storeString(FD,n),null===(d=e.amsEngagement)||void 0===d||d.enqueueData({eventType:"lastNLSQueryDateChange",app:$_,oldState:t,newState:n})}return{catalogResponse:o,categoriesFilterData:a,searchResultsAdsRequestData:n,searchResultsAdData:s,requestMetadata:{requestDescriptor:t,searchRequestUrl:ve(e,r).toString()}}})}async function Op(e,t){const n=function(e,t){const n=e.bag.isLLMSearchTagsEnabled||u(e.bag.supportedMixedMediaRequestUsecases[aq]),r=new Jz(e,t,n,[lV]).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(Nq,[BD]).includingAttributes(Rp(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
return Je(e,r,t),r.includingRelationships(T8),oi(e)&&(r.includingAssociateKeys(Kq,[Vq]),r.includingScopedAttributes(Vq,DK),r.includingScopedRelationships(Nq,[aH])),r}(e,t)
return await Ln(e,n)}function Ep(e,t){var n
const r=null===(n=t.term)||void 0===n?void 0:n.trim()
if(o(r))return null
const i=t.origin,a=t.source,c=t.searchEntity,l=t.facets,d=t.selectedFacetOptions,f=t.spellCheckEnabled,h=t.excludedTerms,p=e.host.clientIdentifier,w=new Jz(e).withSearchTerm(r).includingAdditionalPlatforms(ee(e)).includingAttributes(Rp(e)).includingScopedAttributes(Nq,[BD]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ue(e))
if(Xl(e,w),w.includingRelationships(T8),oi(e)&&(w.includingAssociateKeys(Kq,[Vq]),w.includingScopedAttributes(Vq,DK),w.includingScopedRelationships(Nq,[aH])),u(e.client.isTinkerWatch)&&w.withFilter(IG,"tinker"),w.enablingFeature(Lx),w.enablingFeature(UC),s(t.guidedSearchTokens)&&w.addingQuery("selectedFacets",t.guidedSearchTokens.join(",")),s(t.guidedSearchOptimizationTerm)&&w.addingQuery("finalTerm",t.guidedSearchOptimizationTerm),e.bag.isLLMSearchTagsEnabled&&w.includingAssociateKeys("results:apps",[lV]),e.featureFlags.isEnabled(gJ)&&w.includingScopedAttributes(Kq,[$j]),c===UU?w.searchingOverTypes([Nq]):c===PH?w.searchingOverTypes([Qj]):c===zq||c===qq?w.searchingOverTypes([Kq]).withFilter(IG,c):w.searchingOverTypes([Kq,Qj,TV,Nq,xq,FH]),e.appleSilicon.isSupportEnabled&&!e.appleSilicon.isRosettaAvailable&&w.addingQuery("restrict","!requiresRosetta"),l)for(const e of Object.keys(l))w.addingQuery(e,l[e])
if(d)for(const e of Object.keys(d)){const t=f9.requestValuesForSelectedFacetOptions(d[e])
if(s(t)){w.addingQuery(e,t.value)
for(const e of Object.keys(t.additionalKeyValuePairs))w.addingQuery(e,t.additionalKeyValuePairs[e])}}const g=e.bag.isNaturalLanguageSearchEnabled||e.bag.isNaturalLanguageSearchResultsEnabled,v=g?"source":"src"
if(i===B$){const e=g&&(null==a?void 0:a.length)?"hint:".concat(a):UM
w.addingQuery(v,e)}else i===bR?w.addingQuery(v,NP):i===kB?w.addingQuery(v,kB):i===SR?w.addingQuery(v,"searchInstead"):i===PR?w.addingQuery(v,MS):i===UD&&w.addingQuery(v,JG)
switch(p){case Vz:w.addingContext(zq)
break
case Hz:w.addingContext(qH)
break
case qz:w.addingContext(qq)}return w.addingQuery("limit[ads-result]",e.bag.mediaAdvertRequestLimit.toString()),s(e.bag.adsOverrideLanguage)&&w.enablingFeature(aA),f&&w.enablingFeature("spellCheck"),g&&w.enablingFeature($C),w.enablingFeature("searchResultCpps"),h&&w.addingQuery("excludeTerms",h.join(",")),w}function Rp(e){const t=[$j,TL,hj,JV,dG,bL,uH,YN,cE,GD,dF,wq]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),e.host.isOSAtLeast(15,5,0)&&t.push(qU),t}function Dp(e,t){return Bv.context("developerPageFromResponse",()=>{const n=t.data.length?t.data[0]:null
if(!n)return null
const r=Un(e,"Artist",n.id,t),i=function(e,t,n,r){switch(e.client.deviceType){case Yq:return function(e,t,n,r){var i
e.appleSilicon.isSupportEnabled?($p(t,FV,[oG,nN]),$p(t,oG,[nN])):$p(t,FV,[oG])
const a=dq,c=n6.LockupIconSmall
let u=0
const d=[]
for(const f of L8){const h=fe(t,f),p=l(h,kj),w=p.length
if(0===w)continue
if(f===Oj&&0===w)continue
const g=Mp(e,f,t)
gh(0,{pageInformation:n,locationTracker:r,idType:sq,id:`${u}`,targetType:KH},g)
const v={lockupOptions:{metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:c},filter:Wv.DeveloperPage},m=p.filter(e=>o(e.attributes)),y=(null===(i=h.next)||void 0===i?void 0:i.length)>0||w>=8,A=xp(e,g,t.id,p,f,a,v,n,r,h.href,y),T=A.items.length+m.length
T<3&&(A.rowsPerColumn=T)
const b={id:null,kind:null,softwareType:null,targetType:KH,title:A.title,pageInformation:n,locationTracker:r,idType:null}
if(mh(r),Oh(e,A,b),bh(r),m.length){const e=new F8
e.title=g,e.developerId=t.id,e.contentType=dq,e.remainingData=m,e.lockupListOptions=v,e.relationship=f,e.roomUrl=h.href,e.shouldShowSeeAll=y,e.hasExistingContent=s(A.items),A.url=`${hW}:/${yW.developer}/${yW.shelf}/`+encodeURIComponent(JSON.stringify(e))}A.items.length>0&&(d.push(A),u++)}return d}(e,t,n,r)
case zq:return function(e,t,n,r,i,a,c){const l=we(n,r),u={lockupOptions:{metricsOptions:{pageInformation:a,locationTracker:c},artworkUseCase:n6.LockupIconSmall},filter:Wv.DeveloperPage}
gh(0,{pageInformation:a,locationTracker:c,idType:sq,id:"0",targetType:KH},i)
const d=xp(e,i,n.id,l,r,t,u,a,c,null,!1),f=l.filter(e=>o(e.attributes)),h={id:null,kind:null,softwareType:null,targetType:KH,title:i,pageInformation:a,locationTracker:c,idType:null}
if(mh(c),Oh(e,d,h),bh(c),f.length){const e=new F8
e.title=i,e.developerId=n.id,e.contentType=t,e.remainingData=f,e.lockupListOptions=u,e.hasExistingContent=s(d.items),d.url=`${hW}:/${yW.developer}/${yW.shelf}/`+encodeURIComponent(JSON.stringify(e))}return[d]}(e,dq,t,_X,e.loc.string(yE),n,r)
case Fq:return Lp(e,t,x8,n,r)
case AV:return Lp(e,t,$8,n,r)
default:return Lp(e,t,M8,n,r)}}(e,n,r,{rootPosition:0,locationStack:[]})
1===i.length&&(i[0].isHorizontal=!1)
const a=Uf(e,n,Wq)
if(a){const e=new AX(a,sV),t=new YY(Pj)
t.items=[e],i.unshift(t)}const c=new ZY(i)
c.title=j(n,Zq),e.client.deviceType!==zq&&(c.presentationOptions=[WG]),c.canonicalURL=j(n,Rq),jn(e,c,r)
const u=B(n,FL)
if(u){const t=qd(e,u,{cropCode:"sr",useCase:n6.Uber})
c.uber=t
{const e=new YY("uber"),n=new o2(qT)
n.artwork=t,e.items=[n],n.title=c.title,i.unshift(e),c.presentationOptions.push(VL),c.presentationOptions.push(iN)}}return c})}function _p(e,t,n){switch(t){case Oj:return e.loc.string(AE)
case rN:return e.loc.string("DEVELOPER_SYSTEM_APPS")
case hB:return e.loc.string("DEVELOPER_IMESSAGE")
case nU:return e.loc.string(yE)
case rU:return e.loc.string("DEVELOPER_TV")
case xq:return e.loc.string(TE)
case oN:return e.loc.string("DEVELOPER_VISION")
case iG:const t=H(n,WT),r=H(n,zT)
return t&&r?e.loc.string(YT):r?e.loc.string(JT):e.loc.string(KT)
case FV:return e.loc.string(bE)
default:return null}}function Lp(e,t,n,r,i){var a,c
let u,d
switch($p(t,FV,[iG,rU]),e.client.deviceType){case"tv":case AV:u=VH,d=n6.LockupIconMedium
break
default:u=dq,d=n6.LockupIconSmall}let f=0
const h=[]
for(const p of n){const n=fe(t,p),w=l(n,kj),g=w.length
if(0===g)continue
if(p===Oj&&0===g)continue
let v,m
v=p===hB?Hz:p===nU?Vz:p===rU?Wz:jz,m=_p(e,p,t),gh(0,{pageInformation:r,locationTracker:i,idType:sq,id:`${f}`,targetType:KH},m)
const y={lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},clientIdentifierOverride:v,artworkUseCase:d},filter:Wv.DeveloperPage},A=w.filter(e=>o(e.attributes)),T=((null===(a=n.next)||void 0===a?void 0:a.length)>0||g>=8)&&!0,b=xp(e,m,t.id,w,p,u,y,r,i,n.href,T),S=b.items.length+A.length
S<3&&(b.rowsPerColumn=S)
const P={id:null,kind:null,softwareType:null,targetType:KH,title:b.title,pageInformation:r,locationTracker:i,idType:null}
if(mh(i),Oh(e,b,P),bh(i),A.length){const e=new F8
e.title=m,e.developerId=t.id,e.contentType=u,e.remainingData=A,e.lockupListOptions=y,e.relationship=p,e.roomUrl=n.href,e.shouldShowSeeAll=T,e.hasExistingContent=s(b.items),b.url=`${hW}:/${yW.developer}/${yW.shelf}/`+encodeURIComponent(JSON.stringify(e))}(b.items.length>0||(null===(c=b.url)||void 0===c?void 0:c.length)>0)&&(h.push(b),f++)}return h}function Mp(e,t,n){switch(t){case Oj:return e.loc.string(AE)
case xq:return e.loc.string(TE)
case oG:if(e.appleSilicon.isSupportEnabled)return e.loc.string("DEVELOPER_MAC_APPS")
{const t=H(n,WT),r=H(n,zT)
return t&&r?e.loc.string(YT):r?e.loc.string(JT):e.loc.string(KT)}case nN:return e.loc.string("DEVELOPER_PHONE_PAD_APPS")
case FV:return e.loc.string(bE)
default:return null}}function xp(e,t,n,o,s,a,c,l,u,d,f){const h=new YY(a)
if(h.title=t,a===QF?(h.items=function(e,t,n){return Bv.context("screenshotsLockupsFromData",()=>{if(!t)return[]
const o=[]
for(let s=0;s<t.length;s++){const a=t[s]
if(r(a.attributes)){n.contentUnavailable&&n.contentUnavailable(s,a)
continue}const c=n.lockupOptions
let l=Wv.All
if(i(n.filter)&&(l=n.filter),at(e,a,l))continue
const u=bd(e,a,c)
u.isValid()&&(o.push(u),bh(n.lockupOptions.metricsOptions.locationTracker))}return o})}(e,o,c),h.isHorizontal=!1,h.presentationHints={showSupplementaryText:!1}):(h.items=Rd(e,o,c),h.isHorizontal=e.client.deviceType!==zq),f){const r=new _8
r.title=t,r.url=d,r.developerId=n,r.relationshipId=s,r.clientIdentifierOverride=c.lockupOptions.clientIdentifierOverride
const o=new fY(eW)
o.pageUrl=i(p=r)?`${hW}:/${yW.developer}/${yW.room}/`+encodeURIComponent(JSON.stringify(p)):null,o.title=e.loc.string(KV),o.pageData=dc(0,t),Xs(e,o,o.pageUrl,{pageInformation:l,locationTracker:u}),h.seeAllAction=o}var p
return h}function $p(e,t,n){const o=fe(e,t)
if(r(o))return
const i=At(o)
if(r(i))return
const s=i.map(e=>e.id)
for(const t of n){const n=fe(e,t)
if(r(n))continue
const o=At(n)
r(n)||(e.relationships[t].data=o.filter(e=>!s.includes(e.id)))}}function Fp(e,t,n,r){const o=function(e,t,n,r){const o=Np(0,n.collectionDisplayStyle)
return{...n.metricsImpressionOptions,...r,id:t.id,targetType:o}}(0,t,n,r)
return Dd(e,t,o,n.clientIdentifierOverride)}function Np(e,t){switch(t){case om.Hero:return BU
case om.TextOnly:return HL
case om.TextWithArtwork:return"textWithArtwork"
case om.BrickSmall:return"brickSmall"
case om.BrickMedium:return"brickMedium"
case om.BrickLarge:return"brickLarge"
case om.EditorialLockupMedium:case om.EditorialLockupMediumVariant:return"editorialLockupMedium"
case om.EditorialLockupLarge:case om.EditorialLockupLargeVariant:return"editorialLockupLarge"
case om.LockupSmall:return pB
case om.LockupLarge:return"lockupLarge"
case om.StorySmall:return"storySmall"
case om.StoryMedium:return"storyMedium"
case om.BreakoutLarge:return sN
default:return Bq}}function Bp(e,t,n){let r=null,s=null,a=[]
const c=kn(0,t)
switch(t.type){case Nq:case BH:case oU:a=["enrichedEditorialNotes.badge",cG,$H],r=qp(e,t,a,!1),s=qp(e,c,a,!1)
break
case Kq:case FH:case xq:a=[cG],r=qp(e,t,a,!0),s=qp(e,c,a,!0)}const l=i(s)?s:r
return o(l)?null:l}function Up(e,t,n){let r=null,s=[]
switch(n){case eN:case XF:switch(t.type){case Nq:case BH:case oU:s=[XT,Vj],r=Vp(t,s)
break
case Kq:case FH:case xq:s=[Hj],r=qp(e,t,s,!0)}break
default:switch(t.type){case Nq:case BH:case oU:s=[XT,Vj],r=qp(e,t,s,!1)
break
case lV:case Kq:case FH:case xq:s=[Zq],r=qp(e,t,s,!1)}}const a=qp(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Gp(e,t,n=!1){let r=null,s=[]
switch(t.type){case Nq:n?s=[eb,Hj]:H(t,PE)||(s=["enrichedEditorialNotes.short",CE]),r=qp(e,t,s,!1)
break
case BH:case oU:s=[eb,Hj],r=qp(e,t,s,!1)
break
case Kq:case FH:case xq:s=[Hj],r=qp(e,t,s,!0)}const a=qp(e,kn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function jp(e,t){let n=null,r=[]
switch(t.type){case Nq:case BH:case oU:r=[tb,I$],n=qp(e,t,r,!1)
break
case Kq:case FH:case xq:r=[tb,I$],n=qp(e,t,r,!0)}const o=qp(e,kn(0,t),r,!1)
let i=null
return i=(null==o?void 0:o.length)>0?o:s(n)?n:e.loc.string(IE),i}function Vp(e,t){return o(e)?null:j(e,t)}function Hp(e,t,n){return o(e)?null:ce(e,t,n)}function qp(e,t,n,r){if(o(t))return null
const i=nt(e,t)
for(const e of n){const n=r?Hp(t,i,e):Vp(t,e)
if(s(n))return n}return null}function Wp(e,t,n){const r={}
vh(0,n.metricsOptions,kE)
const a=ad(e,t,n)
mh(n.metricsOptions.locationTracker)
const c=cd(e,t,n)
return s(a)&&(a.length>1||o(c))?r.collectionIcons=a:i(c)&&(r.lockup=c,r.collectionIcons=[c.icon]),r}function zp(e,t,n,r){const o=[],s=new YY(r)
s.isHorizontal=j(t.data,lN)===aU
const a=Cn(0,t)
for(const r of a){const i={...t.metricsImpressionOptions,targetType:Np(0,n),recoMetricsData:St(r)}
if(r.attributes&&!uw(t)){{const n=Yp(e,r,t.collectionDisplayStyle,i,i,t.clientIdentifierOverride)
if(n.clickAction=Fp(e,r,t),!n.isValid())continue
o.push(n)}bh(t.metricsImpressionOptions.locationTracker)}else t.remainingItems.push(r),t.isDeferring=!0}return i(t.presentationHints)&&(s.presentationHints=t.presentationHints),delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=o,s.rowsPerColumn=q(t.data,fN),s.url=dw(0,0,t),Xa(e,s,t),s}function Yp(e,t,n,r,i,a){const c=new U2,l=On(0,t)
if(!u(l.hideEditorialMedia)){const r=sd(e,t,n);(0,Uv.isSome)(null==r?void 0:r.artwork)&&(c.artworks=[r.artwork],c.isMediaDark=rd(0,r)),(0,Uv.isSome)(null==r?void 0:r.rtlArtwork)&&(c.rtlArtwork=null==r?void 0:r.rtlArtwork,c.isRTLMediaDark=rd(0,r,!0))}const d={metricsOptions:i,clientIdentifierOverride:a,artworkUseCase:n6.Default,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:na(0,t)}
if(vh(0,d.metricsOptions,kE),c.collectionIcons=ad(e,t,d),mh(d.metricsOptions.locationTracker),o(c.collectionIcons)){const n=Jd(e,t,{useCase:n6.Default})
s(n)&&(c.collectionIcons=[n])}c.caption=Bp(e,t),c.title=Up(e,t,n),c.subtitle=Gp(e,t),c.accessibilityLabel=c.title,c.editorialDisplayOptions=En(l)
const f=s(c.artworks)?Xj:"collection_id",h={...r,id:t.id,idType:f}
return Oh(e,c,Lh(e,t,c.title,h)),c.artworkSafeArea=G2.defaultTileArtworkSafeArea,c.textSafeArea=G2.defaultTileTextSafeArea,c}function Jp(e,t,n,r){const o=new L4
o.overlayType=tl(e,t),o.displayOptions={horizontalPlacement:Uq,textAlignment:Uq,isOverDarkContent:ol(e,t)},o.badgeText=Bp(e,t,om.Hero),o.titleText=Up(e,t,om.Hero),r.suppressTagline||(o.descriptionText=Gp(e,t,!0)),o.callToActionText=jp(e,t),o.buttonTitle=rl(e,t)
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:pB,recoMetricsData:St(t)},metricsClickOptions:{id:t.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,actionDetails:{franchise:o.badgeText}},artworkUseCase:n6.LockupIconSmall,offerEnvironment:kq,canDisplayArcadeOfferButton:Jf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:na(0,t)},c=cd(e,t,a),l=Wp(e,t,a)
o.lockup=l.lockup,o.collectionIcons=l.collectionIcons
const u=j(t,$H)
s(u)&&i(c)&&(c.heading=u)
const d=(0,Uv.isSome)(r.suppressLockup)&&r.suppressLockup
if(s(o.lockup)&&!d)o.clickAction=o.lockup.clickAction,o.impressionMetrics=o.lockup.impressionMetrics
else{const r={targetType:BU,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t)},i={...r,id:t.id,actionDetails:{franchise:o.badgeText}}
o.clickAction=Md(e,t,i,n.clientIdentifierOverride),Oh(e,o,Lh(e,t,o.titleText,r))}return o}function Kp(e,t,n,r,o){if(!n){const e=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor
t.backgroundColor=e
const n=o?null==r?void 0:r.rtlArtworkData:null==r?void 0:r.artworkData
t.titleEffect=Lc(0,n)
const i=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork
t.artwork=i
const s=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video
t.video=s}t.isMediaDark=rd(0,r,o)}function Zp(e){return{isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}}function Qp(e,t,n,a,c){if(o(t))return null
let l
n.showOrdinals&&(l=e.loc.decimal(n.ordinalIndex))
let u,d=null
!i(n.shelfBackground)||n.shelfBackground.type!==cV&&n.shelfBackground.type!==WL||(d=JH),s(n)&&(u=n.clientIdentifierOverride)
const f={ordinal:l,metricsOptions:{...{...n.metricsImpressionOptions,id:t.id,idType:lq},recoMetricsData:St(t),isAdvert:Ut(0,t),targetType:Np(0,c)},clientIdentifierOverride:u,artworkUseCase:n6.Default,offerStyle:d,canDisplayArcadeOfferButton:Jf(0,c),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(am.ShowOnlyPreorder)}
let h
switch(c){case eN:case dB:case XF:case uB:f.offerEnvironment=QH,h=Cd(e,t,f,c)
break
case"Poster":h=Sd(e,t,f)
break
default:h=Ad(e,t,f)}return r(h)||!h.isValid()?null:(h.id=function(e,t,n){return(0,Uv.isNothing)(n)?null:`${e.id}_${t}_${n}`}(n,a,h.adamId),h)}function Xp(e,t){return rw(e,t,om.EditorialLockupHierarchicalPortrait,lU,!0,sm.Vertical)}function ew(e,t){return rw(e,t,om.EditorialLockupLarge,O$)}function tw(e,t,n=!0,r){return e.featureFlags.isEnabled(uJ)&&(t.showOrdinals=!0),rw(e,t,om.LockupSmall,dq,n,r)}function nw(e,t,n=!0){return rw(e,t,om.LockupLarge,iB,n)}function rw(e,t,n,o,i=!0,s){const a=[],c=new YY(o),l=null!=s?s:Pn(t)
c.isHorizontal=l===sm.Horizontal
const u=Cn(0,t),d=void 0
for(const[o,i]of u.entries()){if(i.type===Vq)return null
if(r(i.attributes)||uw(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}if(at(e,i,Wv.All))continue
let o=null
if(o=Qp(e,i,t,a.length,n),o&&(a.push(o),bh(t.metricsImpressionOptions.locationTracker),t.ordinalIndex++,a.length===d))break}if(n!==om.EditorialLockupMediumVariant&&n!==om.EditorialLockupLargeVariant||(r(c.presentationHints)?c.presentationHints={showSupplementaryText:!0}:c.presentationHints={...c.presentationHints,showSupplementaryText:!0}),delete t.maxItemCount,c.eyebrow=t.eyebrow,c.eyebrowArtwork=t.eyebrowArtwork,c.title=t.title,c.subtitle=t.subtitle,c.items=a,c.rowsPerColumn=q(t.data,fN),c.shouldFilterApps=!t.filterOverrides.includes(am.ShowInstalled),c.url=dw(0,0,t),i){let n=d;(0,Nv.isSome)(d),Xa(e,c,t,n)}return c}function ow(e,t,n,r,o,a,c){var l,d
const f=On(0,t),h=new W2
if(h.title=Up(e,t,o),f.suppressShort||(h.description=Gp(e,t)),!u(f.hideEditorialMedia)){const r=Zu(e,t,n)
if(h.artwork=null==r?void 0:r.artwork,h.video=null==r?void 0:r.video,h.isMediaDark=null!==(l=rd(0,r))&&void 0!==l?l:void 0,n===Dm.StoryDetail){const n=Zu(e,t,Dm.StoryDetailLandscape)
h.landscapeArtwork=null==n?void 0:n.artwork,h.landscapeVideo=null==n?void 0:n.video,h.isLandscapeMediaDark=null!==(d=rd(0,n))&&void 0!==d?d:void 0}}const p=Wp(e,t,{metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,recoMetricsData:St(t)},artworkUseCase:n6.LockupIconSmall,offerEnvironment:f.useMaterialBlur?QH:cU,canDisplayArcadeOfferButton:Jf(0,o),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:na(0,t),useJoeColorIconPlaceholder:!1}),w=a&&u(f.suppressLockup)
w||(h.lockup=p.lockup)
const g=In(e,t)
if(H(g,eq),Bf(e,g),s(g)&&!w&&at(e,g,Wv.All)&&n!==Dm.StoryDetail)return null
let v
if(v=Bp(e,t),h.badge={type:UV,title:v},h.collectionIcons=p.collectionIcons,i(c)){const n={id:t.id,pageInformation:c.metricsPageInformation,locationTracker:c.metricsLocationTracker,actionDetails:{franchise:h.badge.title},idType:uU}
h.clickAction=Fp(e,t,c,n)}h.editorialDisplayOptions=En(f)
const m={...r,id:t.id,idType:uU}
return Oh(e,h,Lh(e,t,h.title,m)),h}function iw(e,t,n,o){const i=[],s=new YY(o),a=Pn(t)
s.isHorizontal=a===aU
const c=Cn(0,t)
for(const o of c){const s={...t.metricsImpressionOptions,targetType:Np(0,n),recoMetricsData:St(o)}
if(!W(o)||uw(t)){t.remainingItems.push(o),t.isDeferring=!0
continue}let a=null
a=ow(e,o,Dm.StoryCard,s,t.collectionDisplayStyle,!0,t),r(a)||(i.push(a),bh(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=i,s.rowsPerColumn=q(t.data,fN),s.url=dw(0,0,t),Xa(e,s,t),s}function sw(e,t,n){const r=_n(0,t)
o(r)||(n.displayStyle=r)}function aw(e,t,n,r,o,i,s,a=!1,c=null){const l={id:f(n,"id"),type:n.type,collectionDisplayStyle:null!=c?c:_n(0,n),filterOverrides:G(n,"filterOverrides"),pageId:t,data:n,presentationHints:{},clientIdentifierOverride:null,isFirstRender:!0,shouldFilter:!0,gamesFilter:lw(n),hasExistingContent:!1,title:null,subtitle:null,eyebrow:null,titleArtwork:null,remainingItems:[],metricsImpressionOptions:null,metricsPageInformation:i,metricsLocationTracker:s,recoMetricsData:es(e,n),isDeferring:!1,showOrdinals:!1,ordinalIndex:1,isSearchLandingPage:!1,isArcadePage:r,shelfIndex:o,isSeeAll:a}
return cw(e,n,l),l}function cw(e,t,n){let r=j(t,Vj),o=j(t,Hj),i=j(t,cG),a=null,c=!1
const l=pe(e,t,sU)
s(l)&&(i=e.loc.uppercased(j(t,Vj)),r=j(l,Vj),a=Jd(e,l,{useCase:n6.LockupIconSmall}),o=null,c=!0)
const u=function(e,t,n,r,o){const i=t.type,s=_n(0,t),a={id:f(t,"id"),kind:null,softwareType:null,targetType:KH,title:n,pageInformation:r,locationTracker:o,idType:nb,shelfType:i,recoMetricsData:St(t),canonicalId:f(t.meta,cN)}
switch(i){case rm.Collection:sw(0,t,a),s===om.Hero&&function(e,t){t.title=YG
const n=Zp(e)
t.autoAdvanceInterval=n.autoScrollInterval}(e,a)
break
case rm.Recommendations:sw(0,t,a)}return a}(e,t,c?i:r,n.metricsPageInformation,n.metricsLocationTracker)
n.title=r,n.subtitle=o,n.eyebrow=i,n.titleArtwork=a,n.metricsImpressionOptions=u}function lw(e){let t=null
switch(j(e,"clientFilter")){case cm.ArcadeGames:t=qq
break
case cm.AllGames:t="all"}return t}function uw(e){return e&&e.isDeferring&&e.isFirstRender}function dw(e,t,n){return o(n)?null:(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?function(e){return(new qW).set(Ij,hW).append(eV,yW.editorialPage).append(eV,yW.shelf).param(DW.token,encodeURIComponent(JSON.stringify(e))).build()}(n):null}function fw(e,t,n){if(o(n)||o(t))return null
if(function(e){if(e.isSeeAll)return!1
switch(e.collectionDisplayStyle){case om.BreakoutLarge:case om.Poster:return!1}return!e.filterOverrides.includes(am.ShowOnlyPreorder)||!1}(n)){const r=new fY(eW)
if(!nc(t)){const o=`shelf_${n.id}`
r.pageData=function(e,t,n,r,o){const i=pw(e,void 0,(_n(0,t.data),aw(e,t.pageId,t.data,t.isArcadePage,t.shelfIndex,t.metricsPageInformation,{rootPosition:0,locationStack:[]},!0,null)))
if(null===i)return null
let s
i.title=null,i.eyebrow=null,i.isHorizontal=!1,i.id=r,s=new Y4(null,t.title,null)
const a=new YY(zL)
a.id=OE,a.items=[s]
const c=new ZY([a,i])
return c.isIncomplete=!(null!=o&&o),(0,Nv.isNothing)(c.pageMetrics.pageFields)&&(c.pageMetrics.pageFields={}),c}(e,n,t.contentType,o,(0,Nv.isSome)(n.recommendationsHref))}const o={}
n.type===rm.Recommendations&&(o[DW.editorialPageId]=n.pageId),r.pageUrl=Fi(e,n.data.href,o),r.title=e.loc.string(KV),r.referrerUrl=n.metricsPageInformation.pageUrl
const i=function(e){const t=[]
for(const n of e.locationStack)t.push({...n})
return{rootPosition:e.rootPosition,locationStack:t}}(n.metricsLocationTracker)
return Th(i,0),Xs(e,r,n.seeAllUrl,{pageInformation:n.metricsPageInformation,locationTracker:i}),r}return null}function hw(e,t,n,r,o){n||(t.backgroundColor=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor,t.artwork=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork,t.video=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video),t.isMediaDark=rd(0,r,o)}function pw(e,t,n){let a=null
switch(n.isFirstRender&&gh(0,n.metricsImpressionOptions,n.title),n.type){case rm.ArcadeSeeAllGames:a=function(e,t){const n=new F2,o=new YY(SE)
o.items=[n]
const i={targetType:rb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(i$),id:t.id,kind:ob,softwareType:nq}
Oh(e,n,i),gh(0,i,i.title),n.buttonAction=eo(e,YB,t.metricsPageInformation,t.metricsLocationTracker)
const a={targetType:Qq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:n.buttonAction.title,id:"SeeAllGames",kind:Qq,softwareType:nq}
Oh(e,n.buttonAction,a),mh(i.locationTracker)
const c=e.bag.termsAndConditionsURL
if(!r(c)&&"tv"!==e.client.deviceType){const t=e.loc.string(RE),r=new PY(c),o=new N2(t)
o.clickAction=r,o.presentationStyle=[YL,JL,KL],n.footnote=o}o.background={type:cV,color:Se(XO)}
const l=Cn(0,t)
if(s(l)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
n.icons=zd(e,l,r,{useCase:n6.LockupIconMedium})}else n.icons=[]
return o}(e,n)
break
case rm.Collection:a=function(e,t){let n=j(t.data,dH)
if(o(n))return null
let a=null
switch(n){case om.Hero:a=function(e,t){if(0!==t.shelfIndex)return null
const n=new YY(YG),r=new c4
r.autoScrollConfiguration=Zp(e)
const o=Cn(0,t)
for(const n of o){const o=Rn(e,n)
if(Dn(0,n)&&!W(o)||uw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i={...t.metricsImpressionOptions,idType:Xj,targetType:BU,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},s=Zu(e,n,Dm.Hero),a=Wp(e,n,{metricsOptions:i,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:n6.Default,offerEnvironment:cU,canDisplayArcadeOfferButton:!0}),c=new l4,l=Kc(0,n),d=Up(e,n,om.Hero),f=Lh(e,n,d,i)
f.isPreorder=et(e,l,eq),Oh(e,c,f),gh(0,f,d)
const h=On(0,n),p=u(h.hideEditorialMedia)
c.overlay=Jp(e,n,t,h),c.collectionIcons=a.collectionIcons,c.editorialDisplayOptions=En(h),Kp(0,c,p,s,!1),c.isValid()&&r.items.push(c)
const w=S(c)
Kp(0,w,p,s,!0),w.isValid()&&r.rtlItems.push(w),mh(f.locationTracker),bh(f.locationTracker)}return delete t.maxItemCount,n.isHorizontal=!1,n.eyebrow=t.eyebrow,n.eyebrowArtwork=t.eyebrowArtwork,n.title=t.title,n.subtitle=t.subtitle,n.items=[r],n.url=dw(0,0,t),n}(e,t)
break
case om.TextOnly:a=function(e,t){var n
const o=[],i=new YY(UH)
i.isHorizontal=j(t.data,lN)===sm.Horizontal
const s=Cn(0,t)
for(const n of s){if(r(n.attributes)||uw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Fp(e,n,t)
i.title=Up(e,n,t.collectionDisplayStyle)
const s={...t.metricsImpressionOptions,id:n.id,idType:uU,targetType:HL}
Oh(e,i,Lh(e,n,i.title,s)),o.push(i),bh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,fN))&&void 0!==n?n:1,i.url=dw(0,0,t),Xa(e,i,t),i}(e,t)
break
case om.TextWithArtwork:a=function(e,t){var n
const o=[],i=new YY(UH)
i.isHorizontal=j(t.data,lN)===sm.Horizontal
const a=Cn(0,t)
for(const n of a){if(r(n.attributes)||uw(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Fp(e,n,t)
let a
i.title=Up(e,n,t.collectionDisplayStyle),a=B(n,Hq),s(a)&&(i.artwork=qd(e,a,{allowingTransparency:!0,useCase:n6.CategoryIcon})),o.push(i),bh(t.metricsImpressionOptions.locationTracker)}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=q(t.data,fN))&&void 0!==n?n:1,i.url=dw(0,0,t),Xa(e,i,t),i}(e,t)
break
case om.BrickSmall:a=function(e,t){return zp(e,t,om.BrickSmall,"smallBrick")}(e,t)
break
case om.BrickMedium:a=function(e,t){return zp(e,t,om.BrickMedium,sG)}(e,t)
break
case om.BrickLarge:a=function(e,t){return zp(e,t,om.BrickLarge,"largeBrick")}(e,t)
break
case om.EditorialLockupHierarchicalPortrait:a=Xp(e,t)
break
case om.EditorialLockupHierarchicalRows:a=function(e,t){return rw(e,t,om.EditorialLockupHierarchicalRows,lU,!0,sm.Vertical)}(e,t)
break
case om.EditorialLockupMedium:a=function(e,t){return rw(e,t,om.EditorialLockupMedium,lU)}(e,t)
break
case om.EditorialLockupMediumVariant:a=function(e,t){return rw(e,t,om.EditorialLockupMediumVariant,lU)}(e,t)
break
case om.EditorialLockupLarge:a=ew(e,t)
break
case om.EditorialLockupLargeVariant:a=function(e,t){return rw(e,t,om.EditorialLockupLargeVariant,O$)}(e,t)
break
case om.LockupMedium:a=function(e,t){return t.metricsImpressionOptions.shouldOmitImpressionIndex=!0,rw(e,t,om.LockupMedium,VH)}(e,t)
break
case om.Poster:a=function(e,t){const n=rw(e,t,om.Poster,gB)
return(0,Nv.isSome)(n)&&(n.horizontalScrollTargetBehavior=Nm.CenterAligned),n}(e,t)
break
case om.StorySmall:a=function(e,t){return iw(e,t,om.StorySmall,pV)}(e,t)
break
case om.StoryMedium:a=function(e,t){return iw(e,t,om.StoryMedium,hN)}(e,t)
break
case om.LockupSmall:a=tw(e,t)
break
case om.LockupLarge:a=nw(e,t)
break
case om.BreakoutLarge:a=function(e,t){const n=[],r=new YY(P$)
r.isHorizontal=j(t.data,lN)===aU
const s=Cn(0,t)
for(const r of s){const s=Rn(e,r)
if(Dn(0,r)&&!W(s)||uw(t)){t.isDeferring=!0,t.remainingItems.push(r)
continue}const a={targetType:sN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(r)},c=On(0,r),l=u(c.hideEditorialMedia)?null:sd(e,r,t.collectionDisplayStyle),d=Wp(e,r,{metricsOptions:a,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:n6.Default,offerEnvironment:cU,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:na(0,r)})
if(o(l)&&o(d.collectionIcons))continue
const f=Bp(e,r,t.collectionDisplayStyle),h=i(f)?{type:UV,title:f}:{type:rq,title:null},p=new b4(Up(e,r,t.collectionDisplayStyle),Gp(e,r,!0),h,null),w=new $4(p,{position:Uq,wantsBlur:!0},null,null==l?void 0:l.artwork,null==l?void 0:l.video,d.collectionIcons,null==l?void 0:l.backgroundColor)
w.rtlArtwork=null==l?void 0:l.rtlArtwork,w.rtlVideo=null==l?void 0:l.rtlVideo,w.rtlBackgroundColor=null==l?void 0:l.rtlBackgroundColor
const g={...a,id:r.id,idType:Xj}
Oh(e,w,Lh(e,r,w.details.title,g))
const v=Fp(e,r,t)
i(v)&&(v.title=jp(e,r)),w.details.callToActionButtonAction=v,w.clickAction=v,w.editorialDisplayOptions=En(c),w.lockup=d.lockup,w.isMediaDark=rd(0,l),w.isRTLMediaDark=rd(0,l,!0),n.push(w)}return delete t.maxItemCount,r.eyebrow=t.eyebrow,r.eyebrowArtwork=t.eyebrowArtwork,r.title=t.title,r.subtitle=t.subtitle,r.items=n,r.rowsPerColumn=q(t.data,fN),r.url=dw(0,0,t),Xa(e,r,t),r}(e,t)}return s(a)&&(a.seeAllAction=fw(e,a,t),a.id=`shelf_${t.id}`),a}(e,n)
break
case rm.Chart:a=function(e,t){let n
if(t.showOrdinals=!0,n=tw(e,t,!1,sm.Horizontal),!(0,Nv.isNothing)(n))return n.url=dw(0,0,t),Xa(e,n,t),function(e,t,n){e.featureFlags.isEnabled(rJ)?(0,Nv.isSome)(t.header)?function(e,t,n){e.featureFlags.isEnabled(rJ)?t.titleAction=n:t.accessoryAction=n}(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}(e,n,function(e,t){const n=j(t.data,lH),r=j(t.data,WH),o=new fY(eW)
return o.pageUrl=Ef(e,n,r),o.title=e.loc.string(KV),o.referrerUrl=t.metricsPageInformation.pageUrl,Xs(e,o,o.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),o}(e,t)),n}(e,n)
break
case rm.Tag:case rm.Engagement:case rm.Text:case rm.Image:case rm.VideoClip:a=null
break
case rm.Header:a=function(e,t,n){var r,o,i
const a=s(B(n.data,dV))?n.data:t
if(!a)return null
if(s(B(a,Tq))){const t=new c4,r=new l4,o=On(0,a),i=Jp(e,a,n,o)
i.overlayType=UV,i.callToActionText=null,r.clickAction=null,i.collectionIcons=null,i.lockup=null,i.callToActionText=null,r.overlay=i
const s={artworkUseCase:n6.LockupIconSmall,offerStyle:uj,offerEnvironment:kq,canDisplayArcadeOfferButton:Jf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:na(0,a)}
vh(0,s.metricsOptions,kE)
const c=ad(e,a,s)
mh(s.metricsOptions.locationTracker),r.collectionIcons=c
const l=Zu(e,a,Dm.Hero),d=u(o.hideEditorialMedia)
hw(0,r,d,l,!1),r.editorialDisplayOptions=En(o),t.items=[r]
const f=S(r)
hw(0,f,d,l,!0),t.rtlItems=[f]
const h=new YY(YG)
return h.items=[t],h}{const t=(0,jv.attributeAsString)(a,Zq)
if(s(t)&&Gi(e,null)){const s=new YY(C$)
s.id=C$
const c=null!==(r=(0,jv.attributeAsString)(a,cG))&&void 0!==r?r:null,l={artworkUseCase:n6.LockupIconSmall,offerStyle:uj,offerEnvironment:kq,canDisplayArcadeOfferButton:Jf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)},externalDeepLinkUrl:na(0,a),useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:th}
let u,d=null!==(o=ad(e,n.data,l))&&void 0!==o?o:void 0
if((0,Uv.isSome)(d)&&(null==d?void 0:d.length)>=3){d=d.slice(0,3)
const r=d[0].backgroundColor;(0,Uv.isSome)(r)&&(null==r?void 0:r.type)===bV&&(u=Qf(r))
const o=be(u),l=On(0,n.data),f=new J4(c,t,null,void 0,void 0,d,!1,null!=u?u:void 0,function(e,t){if(2===t)return ZL
switch(e){case _G:return k$
case DE:return"Fan"
case ib:return QL
default:return k$}}(null!==(i=l.fallbackDisplayStyleHint)&&void 0!==i?i:_G,null==d?void 0:d.length),o?kq:QH),h=function(e,t,n,r){return Bv.context(kR,()=>{const o=ih(e,t),i=oh(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:Xj,targetType:"tagHeader"}})}(e,a,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a)})
return function(e,t,n){if(!t)return
const r=new CY(kh(e,n))
delete r.fields.impressionIndex,t.impressionMetrics=r}(e,f,h),s.items=[f],s}return null}return null}}(e,t,n)
break
case rm.Recommendations:a=function(e,t){let n=null
switch(j(t.data,dH)){case om.LockupSmall:n=tw(e,t,!1)
break
case om.LockupLarge:n=nw(e,t,!1)
break
case om.EditorialLockupHierarchicalPortrait:n=Xp(e,t)
break
case om.EditorialLockupLarge:n=ew(e,t)
break
default:n=t.isFirstRender?function(){const e=new YY(dN)
return e.isHidden=!0,e}():null}return(0,Nv.isNothing)(n)?null:(n.id=`shelf_${t.id}`,function(e,t){const n=s(we(t.data,Jq))||s(t.remainingItems),r=H(t.data,"isPersonalizationAvailable"),o=t.data.href
if(!r||n||!s(o))return
const i=ve(e,new Jz(e,t.data.href).addingQuery(DW.editorialPageId,t.pageId).includingRelationships([Jq]))
t.recommendationsHref=i.toString()}(e,t),n.url=dw(0,0,t),Xa(e,n,t),n.seeAllAction=fw(e,n,t),n)}(e,n)
break
case rm.GameCenter:a=null
break
case rm.Upsell:a=function(e,t){const n=co(e,t.data)
if(o(n))return null
const r=n.marketingItemData
if(o(r)||o(r.attributes))return null
const i=Mc(e,r,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:fh(0,r)})
bh(t.metricsLocationTracker)
const s=new YY(XU)
return s.items=[i],s}(e,n)
break
case rm.Marker:a=function(e,t){const n=j(t.data,fH)
if(o(n))return null
let r=null
return n===im.QuickLinks&&(r=function(e,t){if(e.user&&e.user.isManagedAppleID)return null
{const n=[]
if((0,Uv.isSome)(e.bag.aboutAppStoreUrl)){const t=new PY(e.bag.aboutAppStoreUrl)
t.title=e.loc.string("QuickLinks.AboutTheAppStore.Title"),n.push(t)}if((0,Uv.isSome)(e.bag.aboutInAppPurchasesEditorialItemId)){const t=new fY(cq)
t.title=e.loc.string("QuickLinks.AboutInAppPurchases.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutInAppPurchasesEditorialItemId}`,n.push(t)}if((0,Uv.isSome)(e.bag.reportProblemUrl)){const t=new PY(e.bag.reportProblemUrl)
t.title=e.loc.string(ab,"Report a Problem"),n.push(t)}if((0,Uv.isSome)(e.bag.requestARefundUrl)){const t=new PY(e.bag.requestARefundUrl)
t.title=e.loc.string("QuickLinks.RequestARefund.Title"),n.push(t)}if((0,Uv.isSome)(e.bag.changePaymentMethodUrl)){const t=new PY(e.bag.changePaymentMethodUrl)
t.title=e.loc.string("QuickLinks.ChangePaymentMethod.Title"),n.push(t)}if((0,Uv.isSome)(e.bag.aboutFrenchAppStoreEditorialItemId)){const t=new fY(cq)
t.title=e.loc.string("QuickLinks.AboutFrenchAppStore.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutFrenchAppStoreEditorialItemId}`,n.push(t)}const r=new YY(UH)
return r.title=e.loc.string("QuickLinks.Title"),r.items=n,r.isHorizontal=!0,r.rowsPerColumn=1,t.metricsImpressionOptions.title=r.title,r}}(e,t)),r}(e,n)}return o(null==a?void 0:a.items)&&o(null==a?void 0:a.url)&&(a=null),n.isFirstRender&&mh(n.metricsImpressionOptions.locationTracker),Oh(e,a,n.metricsImpressionOptions),n.isFirstRender&&bh(n.metricsImpressionOptions.locationTracker),(0,Uv.isSome)(a)&&function(e,t,n){if((0,Nv.isNothing)(t.url)||(0,Nv.isNothing)(t.impressionMetrics)||!n.showingPlaceholders)return
const o=t.url
try{const e=qW.from(o).query[DW.token],n=JSON.parse(decodeURIComponent(e))
n.originalPlaceholderShelfImpressionMetrics=t.impressionMetrics,function(e,t,n){const o=qW.from(t.url),i=qW.from(dw(0,0,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,t,n)}catch{t.url=o}}(0,a,n),a}function ww(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},r=co(e,t.data)
return o(r)?null:Od(e,r,n,pt(FB),wj,EE)}function gw(e,t){const n=[Tq,wq,zG],r=[...n,aG,uV,lB,S$],o=[...n,lB],i=[...n,uH,$j,hj,uV,zV,uH,iH]
e.appleSilicon.isSupportEnabled&&i.push(hH),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([iq])
const s=[...i]
t.includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).enablingFeatures(["personalization","supportsCustomTextColor"]).includingRelationshipsForUpsell(!0).includingScopedAttributes(Nq,r).includingScopedAttributes(BH,o).includingScopedAttributes(Kq,s)}function vw(e){const{platform:t,...n}=e
return{...n,$kind:j8,platform:ut(t)}}function mw(e,t,n){var r
const o=function(e,t){switch(t){case Q8:return"badge_hardware"
case X8:return"badge_trial_eligible"
default:return null}}(0,t),i={offerHints:o},s=new jK(qq,pt(ij),e.bag.metricsTopic,null,i)
s.metricsOverlay={...s.metricsOverlay,...n}
const a=null===(r=e.metricsIdentifiersCache)||void 0===r?void 0:r.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical])
if((0,Nv.isSome)(a)&&(s.metricsOverlay={...s.metricsOverlay,...a}),e.bag.arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new fY(tB),t=NN
e.pageData=t,e.presentationContext=Mj,s.purchaseSuccessAction=e}const c=new fY(dj)
return c.pageData=s,c}async function yw(e,t){const n=t.eventString,r=t.featuresDictionary
if(!i(r))return await Promise.reject("Received non-defined engagement features.")
const o=function(e,t,n,r){switch(t){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t,n){const r=[]
for(const e of e7)if(e in t){const t=new K8(e,!1)
r.push(t)}for(const o of e7){if(n.includes(o)&&!e.bag.unrestrictedServerSideTabBadging)continue
const s=t[o]
if(i(s)){const t=mw(e,o,s)
r.push(t)
break}}if(r.length>0)return new J8(new MJ(r))
{const e=new fW
return new J8(e)}}(e,n,r)
case"didBecomeArcadeTrialEligible":if(!e.bag.enableArcadeTrialEligibleBadging)return e.console.log(`Bag prohibits badging for identifier ${X8}`),new J8(new fW)
if(r.includes(X8))return e.console.log(`Badging identifier ${X8} was previously invalidated.`),new J8(new fW)
const t=new K8(X8,!0),o=new Z8(qq,e.loc.decimal(1)),s=new MJ([t,o])
return new J8(s)
case"didSubscribeToArcade":return function(e){const t=[]
for(const e of e7){const n=new K8(e,!1)
t.push(n)}const n=new MJ(t)
return new J8(n)}()
case"didBecomeSubscribed":if(!i(n[X8]))return new J8(new fW)
const a=new K8(X8,!1)
return new J8(a)
case"didBecomeNonSubscribed":return new J8(new fW)
default:return null}}(e,n,r,i(t.previouslyDisabledFeatures)?t.previouslyDisabledFeatures:[])
return i(o)?await Promise.resolve(o):await Promise.reject("Did not receive a valid engagement event.")}async function Aw(e,t){var n
const r=function(e,t,n,r){if(!e7.includes(t))return null
let o=null
if(n&&e.bag.unrestrictedServerSideTabBadging){const t=e.loc.decimal(1)
o=new Z8(qq,t)}else if(n&&!r.includes(t)){const t=e.loc.decimal(1)
o=new Z8(qq,t)}else n||(o=new Z8(qq,null))
return new J8(o)}(e,t.identifier,t.isEnabled,null!==(n=t.previouslyDisabledFeatures)&&void 0!==n?n:[])
return i(r)?await Promise.resolve(r):await Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${t.identifier}, featuresDictionary: ${JSON.stringify(t.featuresDictionary)}, previouslyDisabledFeatures: ${t.previouslyDisabledFeatures}`))}async function Tw(e,t){return await e.required(n3).fetchPage(e,t,pY)}async function bw(e,t){const n=new Jz(e).withIdOfType(t,yM),r=Ln(e,n)
return await r.then(t=>function(e,t){return Bv.context("msoProviderDataFromData",()=>{const n=yt(e,t),r=j(n,Zq),o=j(n,Rq),i=function(e,t){return Bv.context("msoProviderArtworkFromData",()=>{const n=B(t,"editorialArtwork.storeFlowcase")
if(n)return qd(e,n,{useCase:n6.LockupIconLarge})
const r=B(t,Hq)
return qd(e,r,{useCase:n6.LockupIconLarge})})}(e,n)
i&&(i.crop="sr")
const s=function(e,t){const n=B(t,FL)
return n?qd(e,n,{useCase:n6.Uber}):null}(e,n)
return new l7(r,o,i,s)})}(e,t))}async function Sw(e,t){if(r(t.providerAdamId)||r(t.subscribedChannelIds))return await e.required(n3).fetchPage(e,t.url,ZY)
{const n=Pw(e,t.providerAdamId),r=Ln(e,n)
return await r.then(n=>{const r=function(e,t){return Bv.context("msoAppsFromResponse",()=>{const n=yt(e,t),r=we(n,I_),o={}
for(const t of r)o[pe(e,t,Mq).id]=G(t,"channelNames")
const i=we(n,Kq).map(e=>e.id)
return new u7(o,i)})}(e,n),o=function(e,t){const n=e.appsToAlwaysShow
for(const r of Object.keys(e.apps)){const o=e.apps[r]
for(const e of o)if(-1!==t.indexOf(e)){n.push(r)
break}}return n}(r,t.subscribedChannelIds)
return Cw(e,n,o)})}}function Pw(e,t){return new Jz(e).withIdOfType(t,yM).includingRelationships([Kq,I_]).addingQuery("limit[channel-apps]","100")}function Cw(e,t,n){return Bv.context("msoRoomPageWithResponse",()=>{const r=yt(e,t),o=Un(e,DH,r.id,t),i=we(r,Kq),a=we(r,I_)
for(const t of a){const n=pe(e,t,Mq)
s(n)&&i.push(n)}const c=new w2
c.ids=i.map(e=>e.id),c.shouldFilter=!1,c.metricsPageInformation=o
const l=function(e,t,n,r,o=[]){return Bv.context("msoRoomPageWithContext",()=>{const i=[],s=[]
for(const e of t)-1!==n.indexOf(e.id)?i.push(e):s.push(e)
const a={rootPosition:0,locationStack:[]},c={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:a},artworkUseCase:n6.LockupIconMedium}},l=[],u={pageInformation:r.metricsPageInformation,locationTracker:a,targetType:KH,idType:sq,id:"0"}
if(i.length>0){const t=e.loc.string("MSO_INCLUDED_IN_SUBSCRIPTION"),n=new w2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=VH,u.id="0",gh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(i[e]),!1}
const o=new YY(VH)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Rd(e,i,c),o.url=Iw(n),mh(a),o.items.length>0&&(bh(a),l.push(o))}if(i.length>0&&s.length>0){const t=e.loc.string("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),n=new w2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=VH,u.id="1",gh(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(s[e]),!1}
const o=new YY(VH)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Rd(e,s,c),o.url=Iw(n),mh(a),o.items.length>0&&(bh(a),l.push(o))}if(0===l.length){const n=new w2
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=dq,u.id="0",gh(0,u,null),c.contentUnavailable=function(e,r){return n.remainingContent.push(t[e]),!1}
const o=new YY(VH)
o.shouldFilterApps=r.shouldFilter,o.items=Rd(e,t,c),o.url=Iw(n),mh(a),bh(a),l.push(o)}for(const e of l)e.isHorizontal=l.length>1
const d=o.concat(l)
return new ZY(d)})}(e,i,n,c)
return l.title=j(r,Zq),l.isIncomplete=!1,jn(e,l,o),l})}function Iw(e){return e.remainingContent.length?`${hW}:/${yW.mso}/${yW.shelf}/`+encodeURIComponent(JSON.stringify(e)):null}async function kw(e,t){const n={url:`${e.bag.getCancellablePreorderItemsSrv}?&includeAllLockups=false&includeNonBookCancellablePreorderItems=true${t.isArcade?"&preorderItemType=ArcadeApp":""}`,signingStyle:MV}
return await e.network.fetch(n).then(async n=>{const r=JSON.parse(n.body)
if(0!==r.status)return await Promise.resolve("noAuthorization")
const o=r.cancellablePreorderItems.filter(e=>e.preorderAdamId.toString()===t.adamId)
if(null===o||0===o.length)return await Promise.reject("Expected AdamID was missing. This AdamId might have not been preordered before, or the isArcade flag may be incorrect.")
if(o.length>1)return await Promise.reject(`Multiple matches for adamId ${t.adamId}, when only one is expected.`)
const i=o[0].preorderId,s={url:e.bag.cancelPreorderItemSrv,method:rG,signingStyle:MV}
return s.body=`preorderId=${i}`,await e.network.fetch(s).then(async e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${s.url}`)
return 0!==JSON.parse(e.body).status?await Promise.resolve("unableToCancel"):await Promise.resolve("canceled")}).catch(async e=>await Promise.reject(e))}).catch(async e=>await Promise.reject(e))}async function Ow(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(zI))
0!==Mn(e,new qW(t.url)).length&&Jh(e,t.url)
const n=b7.generateProductPageOptions(e,void 0,new qW(t.url)),r=e.required(n3).fetchPage(e,t.url,HY)
if(!r){const r=new Jz(e,t.url),o=await Ln(e,r)
return await Hu(e,o,n,void 0,t.referrerData)}return await r.then(n=>(e.host.clientIdentifier===zz?n&&nB in n&&zn(0,n):i(t.referrerData)&&n&&nB in n&&zn(0,n),n))}async function Ew(e,t,n){const a=Xt(e,t,!1),c=new Jz(e)
switch(t){case _q:c.usingCustomAttributes(Ue(e)),Qt(e)===VH&&c.includingAttributes([YN])
break
case NH:case rH:c.usingCustomAttributes(Ue(e))}const l=e.bag.adsOverrideLanguage
s(l)&&c.enablingFeature(aA).addingQuery("l",l)
const u=ve(e,c).query
try{const c=await e.ads.fetchOnDeviceAdPlacement(t,a,u,n)
return await async function(e,t,n){var a,c,l,u,d,f
o(t.clientRequestId)&&(t.clientRequestId=e.random.nextUUID(),Zt(e,`clientRequestId was nil. Assigned ${t.clientRequestId}`))
const h={clientRequestId:t.clientRequestId,iAdId:t.iAdId,placementType:null!==(c=null===(a=null==t?void 0:t.ad)||void 0===a?void 0:a.placementType)&&void 0!==c?c:n}
if(t.failureReason)return h.failureReason=t.failureReason,h
h.onDeviceAd=t.ad
let p=null===(l=t.ad)||void 0===l?void 0:l.appMetadata
const w=yt(e,p)
if(o(null===(u=null==w?void 0:w.attributes)||void 0===u?void 0:u.name)||o(null===(d=null==w?void 0:w.attributes)||void 0===d?void 0:d.platformAttributes)||o(wr(e,w)))try{const n=function(e,t){const n=new Jz(e).withIdOfType(t.adamId,Kq).usingCustomAttributes(Ue(e)).includingAttributes([YN])
s(t.cppIds)&&n.addingQuery(DW.productVariantID,t.cppIds[0])
const r=e.bag.adsOverrideLanguage
return s(r)&&n.addingQuery("l",r),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([iq]),n}(e,t.ad)
p=await Ln(e,n)}catch(t){Zt(e,`fetchAds request failed - ${t}`),h.failureReason=cA}if(s(null===(f=yt(e,p))||void 0===f?void 0:f.attributes)){h.mediaResponse=function(e,t,n){const i=yt(e,t)
if(o(i)||r(i.attributes))return Zt(e,"decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null
const a=n.ad,c=`${a.adamId}|${a.metadata}`,l={clientRequestId:n.clientRequestId,impressionId:a.impressionId,metadata:a.metadata,privacy:a.privacy,lineItem:c},u=yt(e,a.appMetadata)
switch(s(i.meta)&&s(u)&&s(u.meta)&&(i.meta.passthroughAdInfo=u.meta.passthroughAdInfo,(0,Nv.isSome)(null==a?void 0:a.alignedRegionDetails)&&(i.meta.alignedRegionDetails=null==a?void 0:a.alignedRegionDetails[0])),a.placementType){case _q:const t=Qt(e)===VH
l.format={images:t,text:"",userRating:!1}
break
case oV:l.format={images:!0,text:"",userRating:!1}}return i.attributes[CG]=l,hn(0,i,a.instanceId),t}(e,p,t),pn(e,yt(e,p),h.onDeviceAd)||(Zt(e,"fetchAds request failed - localization not available"),h.failureReason=lA)
const a=function(e,t,n){return n===_q?function(e,t){var n,r
const o=Ge(e,yt(e,t.mediaResponse))
return(null===(r=null===(n=t.onDeviceAd)||void 0===n?void 0:n.cppIds)||void 0===r?void 0:r.includes(o.productPageId))?null:hO}(e,t):null}(e,h,n)
i(a)&&(Zt(e,`fetchAds request failed - ${a}`),h.failureReason=a)}return h}(e,c,t)}catch{return null}}function Rw(e,t,n,r){var o,i,s
const a=fe(t,Jq),c=null===a?void 0:null!==(o=St(a))&&void 0!==o?o:void 0
let l=Xj
return r.pageType===Um.ChartsAndCategories&&(l=Gq),{id:n.id,kind:null,softwareType:null,targetType:KH,title:null!==(i=n.title)&&void 0!==i?i:"",pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:l,fcKind:void 0,canonicalId:null!==(s=f(t.meta,cN))&&void 0!==s?s:void 0,recoMetricsData:c}}function Dw(e,t,n,r){var o,i
return{...r.metricsOptions,...Lh(e,n,null!==(o=t.title)&&void 0!==o?o:"",r.metricsOptions),recoMetricsData:null!==(i=St(n))&&void 0!==i?i:void 0,targetType:Lw(t.density),idType:lq}}function _w(e,t,n,r){var o
return{pageInformation:r.metricsOptions.pageInformation,locationTracker:r.metricsOptions.locationTracker,recoMetricsData:null!==(o=St(n))&&void 0!==o?o:void 0,targetType:Lw(t),id:n.id}}function Lw(e){if((0,Uv.isNothing)(e))return Ej
switch(e){case Vv.Density1:return Ej
case Vv.Density2:return zF
default:return Ej}}function Mw(e,t,n,r=Bm.Default){var o,i,s
const a=null!==(o=j(t,Pq))&&void 0!==o?o:void 0
let c=null!==(i=function(e,t,n){return B(e,t,void 0)}(t,dH))&&void 0!==i?i:void 0;(0,Nv.isNothing)(c)&&r===Bm.CategoriesAndCharts&&(c={layoutDensity:Vv.Density1,layout:void 0,layoutSize:void 0})
const l=g(B(t,"itemDisplayStyle")),u=H(t,BE),d=null!==(s=q(t,iM))&&void 0!==s?s:void 0,f=u?t.href:void 0
return new B7(t.id,a,c,d,u,f,l,n)}function xw(e,t,n,r){return{metricsOptions:Rw(0,t,n,r)}}function $w(e,t){var n,r
const o=j(t,Pq),i=f(t,"meta.autoSelectedTabId"),a=f(t,"meta.sourceShelfCanonicalId"),c=Un(e,pG,a,t),u=Ss(e)
c.recoMetricsData=hh(c.recoMetricsData,null,u)
const d={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:c,adStitcher:null,pageType:Um.ChartsAndCategories},h=l(t,kj),p={},w=[],g=[],v={rootPosition:0,locationStack:[]}
for(const t of h){const o=Mw(0,t,Gm.CategoriesAndCharts,Bm.CategoriesAndCharts),i=xw(0,t,o,{...d,metricsLocationTracker:{rootPosition:0,locationStack:[]}})
gh(0,i.metricsOptions,o.title)
const s=Fw(e,t,!0,o,0,i)
if(mh(i.metricsOptions.locationTracker),(0,Nv.isNothing)(s))continue
p[s.id]=s,w.push(s.id)
const a=new U7,c=new G7(t.id,o.title)
Qs(e,c,{id:o.title,canonicalId:null!==(n=f(t.meta,cN))&&void 0!==n?n:void 0,actionType:Xq,targetType:Qq,pageInformation:d.metricsPageInformation,locationTracker:v}),a.action=c,a.id=s.id,a.title=`${null!==(r=s.title)&&void 0!==r?r:""}`,g.push(a),bh(v)}if(!s(w))return new j7
const m=new V7
m.id=e.random.nextUUID()
const y=new YY("pageTabs")
y.items=[m],p[m.id]=y
const A=new j7
A.shelfMapping=p
const T={}
for(const e of w)g.length>1?T[e]=[m.id,e]:T[e]=[e]
for(const e of Object.values(p))e.title=void 0
return A.title=o,A.pageTabs=m,A.columnCount=2,A.shelfOrderings=T,A.defaultShelfOrdering=w.includes(i)?i:w[0],m.tabs=g,m.selectedTabId=A.defaultShelfOrdering,jn(e,A,d.metricsPageInformation),A}function Fw(e,t,n,r,i,c){var l,u,d,h,p,w,g,v,m,y,A
const T=[],b=we(t,Jq),S=new YY(WD)
if(S.isHorizontal=!1,S.id=t.id,S.title=r.title,S.presentationHints={isWidthConstrained:!0},a(null===(l=r.displayStyle)||void 0===l?void 0:l.layoutSize)&&(S.contentsMetadata={type:"searchLandingChartsAndCategoriesSection",numberOfColumns:r.displayStyle.layoutSize}),r.hasSeeAll){const t=new fY(WD)
t.pageUrl=r.seeAllLink,t.title=e.loc.string(KV)
const n={...c.metricsOptions,targetType:Qq}
Xs(e,t,t.pageUrl,n),S.seeAllAction=t}Oh(e,S,c.metricsOptions)
const P=n?_m.seeAllPage:_m.other
for(const t of b){let n=null,i=null
if(t.type===lV)n=null!==(u=j(t,Zq))&&void 0!==u?u:"tagbrick"
else{const e=B(t,dV)
s(e)&&(n=f(e,Zq),i=f(e,qB))}const a=Yd(e,t,P,null===(d=null==r?void 0:r.displayStyle)||void 0===d?void 0:d.layoutDensity),l=j(t,fH),b=B(t,yq),S=f(b,Rq),C=we(t,aH)
let I=!0,k=null
if(t.type===lV){const r=Fi(e,f(t,uG)),o=e.required(n3).fetchFlowPage(r),i=new fY(o)
i.pageUrl=r,i.title=n,k=i}else if((0,Nv.isSome)(S))switch(l){case"CategoryChart":const t=new fY(eG)
t.pageUrl=S,t.title=n,k=t
break
case"External":if(I=!1,f(b,c$)===yL)k=new PY(S),k.title=null!=n?n:""
else{const t=e.required(n3).fetchFlowPage(S),r=new fY(t)
r.pageUrl=S,r.title=null!=n?n:"",k=r}}else{if(!s(C))continue
{const t=Fi(e,C[0].href)
if(!((null==t?void 0:t.length)>0))continue
{const e=new fY(eW)
e.pageUrl=t,e.title=n,k=e}}}if(Qs(e,k,_w(0,null===(h=null==r?void 0:r.displayStyle)||void 0===h?void 0:h.layoutDensity,t,c)),I&&o(n))continue
let O=new H7(n,a,null,null,i,k,null===(p=null==r?void 0:r.displayStyle)||void 0===p?void 0:p.layoutDensity,Nw(null===(w=null==r?void 0:r.displayStyle)||void 0===w?void 0:w.layoutDensity),Bw(null===(g=null==r?void 0:r.displayStyle)||void 0===g?void 0:g.layoutDensity)),E=Dw(e,O,t,c)
n6.GroupingBrick
const R=rs(e,t,0,0,0,E)
if((0,Nv.isSome)(R)&&R.length>0){const o=R[0].backgroundColor;(0,Nv.isSome)(o)&&(null==o?void 0:o.type)===bV&&(O=new H7(n,null,R,null!==(v=Qf(o))&&void 0!==v?v:void 0,i,k,null===(m=null==r?void 0:r.displayStyle)||void 0===m?void 0:m.layoutDensity,Nw(null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.layoutDensity),Bw(null===(A=null==r?void 0:r.displayStyle)||void 0===A?void 0:A.layoutDensity)),E=Dw(e,O,t,c))}Oh(e,O,E),T.push(O),bh(c.metricsOptions.locationTracker)}return o(T)?null:(S.items=T,S)}function Nw(e){switch(e){case Vv.Density1:return G2.defaultTileArtworkSafeArea
case Vv.Density2:return G2.defaultPillArtworkSafeArea
case Vv.Density3:default:return}}function Bw(e){switch(e){case Vv.Density1:return G2.defaultTileTextSafeArea
case Vv.Density2:return G2.defaultPillTextSafeArea
default:return}}async function Uw(e,t){const n=new Jz(t,e.url).forType(Ox).includingAgeRestrictions().includingScopedRelationships(KI,[Jq]).enablingFeatures([tV,TF]).addingQuery(DW.name,$F)
Gi(t,vx)&&Ai(n),t.bag.enableUpdatedAgeRatings&&n.includingAttributes([iq])
const r=Ln(t,n)
return await r.then(e=>$w(t,e))}function Gw(e){switch(e){case PH:return zk
case UU:return EF
case zq:return V_
case qq:return"joystickcontroller.fill"
default:return}}function jw(e,t,n,r,i){if(o(r))return null
const s=UD,a=n.term,c=r.displayLabel,l=t===jC?new B4(c,r.finalTerm,null,s):new z7(c,s)
!function(e,t,n,r,o){const i=Lx,s=WC,a={targetId:n},c=_t(e,n,s,{actionType:i,location:wh(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},n),searchTerm:r},[Lx])
t.actionMetrics.addMetricsData(c)
const l=Lt(e,r,s,i,null,a,[Lx])
t.actionMetrics.addMetricsData(l)}(e,l,c,a,i)
const u=new Y7(c,r.isSelected,void 0,c,l)
return Bn(0,u,WC,i),u}function Vw(e,t,n){const r=S(t),i=S(t.attributes)
return i[LB]=n.adData,r.attributes=i,function(e,t,n){var r
const i=Ve(Ge(e,t))
if(n.selectedCppId===i||o(null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.cppData))return
const s=S(t.meta)
s.cppData[IU]=n.selectedCppId,t.meta=s}(e,r,n),hn(0,r,n.instanceId),r}function Hw(e,t,n){const r=S(t),o=S(t.attributes)
return o[LB]=n.adData,r.attributes=o,hn(0,r,n.instanceId),r}function qw(e,t,n){const r=t||{},o=[]
e.client.deviceType!==Yq&&o.push(new Z7(LN,[new Q7(e.loc.string(OC),null,r[LN]),new Q7(e.loc.string(EC),mq,r[LN])])),o.push(new Z7(MF,[new Q7(e.loc.string(RD,LU),null,r[MF]),new Q7(e.loc.string(RC,LU),oO,r[MF])]))
const s=Tn(e,n,!1)
if(s){const t=s.categories
if(t.length){const n=t.filter(e=>i(e.genreId)).map(e=>new Q7(e.name,e.genreId,r[lH]))
n.unshift(new Q7(e.loc.string(DD,LU),null,r[lH])),o.push(new Z7(lH,n))}}const a=e.bag.searchSortOptions,c=[]
c.push(new Q7(e.loc.string(_D),null,r[xV]))
for(const t of a)c.push(new Q7(e.loc.string(DC+t),t,r[xV]))
c.length>1&&o.push(new Z7(xV,c))
const l=e.bag.ageBands.map(e=>new Q7(f(e,Zq),f(e,KO),r[HN]))
return l.length>0&&e.client.deviceType!==Yq&&o.push(new Z7(HN,l)),o}function Ww(e,t){let n=null,r=null,o=null
const s=new d9(LN,LN,e.loc.string("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),eB,[new u9(e.loc.string(OC),null),new u9(e.loc.string(EC),mq)],null,null,Yw(e,LN)),a=new d9(_C,_C,e.loc.string("SEARCH_FACET_TYPE_TITLE_PRICE"),eB,[new u9(e.loc.string(RD,LU),null),new u9(e.loc.string(RC,LU),oO)],null,null,Yw(e,MF)),c=Tn(e,t,!1)
if(c){const t=c.categories
if(t.length){const r=t.filter(e=>i(e.genreId))
n=new d9(LC,LC,e.loc.string("SEARCH_FACET_TYPE_TITLE_CATEGORY"),eB,[new u9(e.loc.string(DD,LU),null)],null,null,Yw(e,lH))
for(const e of r)n.options.push(new u9(e.name,e.genreId))}}const l=e.bag.searchSortOptions
r=new d9(xV,xV,e.loc.string("SEARCH_FACET_TYPE_TITLE_SORT"),eB,[new u9(e.loc.string(_D),null)],null,null,Yw(e,xV))
for(const t of l)r.options.push(new u9(e.loc.string(DC+t),t))
const u=e.bag.ageBands.map(e=>new u9(f(e,Zq),f(e,KO)))
u.length>0&&e.client.deviceType!==Yq&&(o=new d9(MC,MC,e.loc.string("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),eB,u,null,null,Yw(e,HN)))
const d=new f9([],!1,null)
{const e=[s,a]
i(n)&&e.push(n),e.push(r),i(o)&&e.push(o)
for(const t of e)t.showsSelectedOptions=!0
d.facetGroups.push(new h9(e))}return d}function zw(e){return{targetPlatform:[new u9(e.loc.string("SEARCH_FACET_IPAD_ONLY"),null)],"filter[price]":[new u9(e.loc.string(RD,LU),null)],sort:[new u9(e.loc.string(_D),null)],"filter[genre]":[new u9(e.loc.string(DD,LU),null)]}}function Yw(e,t){const n=new fW
return ea(e,n,t),n}function Jw(e,t){const n=e.bag.searchResultsLearnMoreEditorialId
if((0,Nv.isNothing)(n)||0===(null==n?void 0:n.length))return
const r={kind:sj,softwareType:null,title:e.loc.string(GC),id:n,targetType:yq,pageInformation:t.pageInformation,locationTracker:t.locationTracker},o=e.loc.string("SEARCH_TRANSPARENCY_TEXT"),i=new fY(cq)
i.title=o,i.pageUrl=`https://apps.apple.com/story/id${n}`,Qs(e,i,r)
const s={}
s[`${e.loc.string(GC)}`]=i
const a=new i5(o,kV)
return new s5(a,s)}function Kw(e){return A(e)&&function(e){return(0,Nv.isSome)(X7[e])}(e[tW])}function Zw(e,t){if(!H(t,BD))return null
const n=j(t,zD)
if(s(n))return n
const r=j(t,$H)
return s(r)?r.replace(/\n/g," "):null}function Qw(e){return Kw(e)&&e[tW]===cy}function Xw(e,t,n,a,c,l,d,f){return Bv.context("searchResultFromData",()=>{var h
let p
const w=t.type,g={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:vV,createUniqueImpressionId:!0},hideZeroRatings:!0,artworkUseCase:n6.SearchIcon,isNetworkConstrained:null!=l?l:void 0,canDisplayArcadeOfferButton:Yf(0,l$),clientIdentifierOverride:null!==(h=og(0,d))&&void 0!==h?h:void 0,isMultilineTertiaryTitleAllowed:!1},v=function(e,t,n){var r,o
if(!function(e){return e.client.deviceType===jq}(e))return qV
const s=t.meta,a=null===(r=null==s?void 0:s.displayStyle)||void 0===r?void 0:r.condensed
if(i(a))return tg(e,a)
const c=null===(o=null==n?void 0:n.displayStyle)||void 0===o?void 0:o.condensed
return i(c)?tg(e,c):ng(e)}(e,t,f)
switch(w){case _N:case fF:case Qj:case Nq:case TV:const l=bo(e,t,{useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0},new bZ(c.pageInformation,c.locationTracker))
if(l&&l.media&&l.media.kind===NU){const e=l.media.lockup
e.theme=kq,p=new iee(e)}else if(function(e,t,n){if((u(n,"experiments.showGridCard")?ree:oee)!==oee)return!1
switch(t.type){case TV:return s(G(t,YD))
case _N:case fF:return!0
case Nq:switch(Io(t)){case wm.List:case wm.NumberedList:case wm.Grid:case wm.River:return!0
default:return!1}default:return!1}}(0,t,n)){const n=function(e,t,n){const r=function(e,t){if(t.type===Qj)return e.loc.string(VC)
const n=Zw(0,t)
return s(n)?n:e.loc.string("Search.EditorialSearchResultType.Heading.Collection")}(e,t),i=function(e,t){return t.type===Qj?j(t,Zq):Uf(e,t,Zq)}(e,t),a=Lh(e,t,i,{targetType:vV,pageInformation:n.pageInformation,locationTracker:n.locationTracker})
gh(0,a,i)
const c=Dd(e,t,{actionType:Xq,targetType:Qq,pageInformation:n.pageInformation,locationTracker:n.locationTracker,id:AR,idType:sq},e.host.clientIdentifier)
c.title=e.loc.string(KV)
const l={lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:Bq},skipDefaultClickAction:!1,artworkUseCase:n6.SearchIcon,hideCompatibilityBadge:!1},filter:Wv.UnsupportedPlatform}
let u=we(t,wH)
o(u)&&(u=we(t,ND))
const d=Rd(e,u,l)
mh(n.locationTracker)
const f=new nee(r,i,d,c,null)
return Oh(e,f,a),o(d)?null:f}(e,t,c)
n&&(p=n)}else{const n=function(e,t,n,o){return Bv.context("editorialSearchResultFromData",()=>{var a
let c
const l=null!==(a=j(t,Zq))&&void 0!==a?a:void 0
switch(t.type){case TV:{const n=new cee(l),r=G(t,YD)
if(s(r))n.collectionAdamIds=r
else{const r=qd(e,B(t,Hq),{useCase:n6.SearchEditorialResult,allowingTransparency:!0})
n.iconArtwork=r}n.type=Lj,c=n
break}case _N:case fF:{const n=new cee(l)
n.artwork=qd(e,B(t,Hq),{useCase:n6.SearchEditorialResult,cropCode:"sr"}),n.collectionAdamIds=G(t,YD),n.type=CV,c=n
break}case Nq:{if(e.bag.searchFilterEditorialItemIds.has(t.id))return null
const a=new bZ(n.pageInformation,n.locationTracker),l=function(e,t,n,o){const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0}
a.prevailingCropCodes=o&&e.client.isPhone?{defaultCrop:"DMGE.AppST01"}:{defaultCrop:"fo"}
const c=bo(e,t,a,n)
if(!c)return null
const l=new cee(c.title)
l.type=UU,l.clickAction=c.clickAction
let u=null
if(c.media)switch(c.media.kind){case aj:const n=c.media
switch(l.artwork=n.artworks[0],r(l.artwork)&&(l.iconArtwork=n.icon),j(t,AN)){case wm.AppOfTheDay:case wm.GameOfTheDay:const n=pe(e,t,wH)
n&&(l.title=j(n,Zq)||l.title)}break
case Jk:case H_:u=c.media.lockups
break
case Hq:const o=c.media
l.artwork=o.artworks[0]
break
case eH:case Nx:u=c.media.lockups
break
case jH:const s=c.media
if(l.artwork=s.videos[0].preview,l.video=s.videos[0],$r(d=c.overlay)&&d[tW]===Py){const e=c.overlay
l.title=e.title,l.subtitle=e.description}else l.subtitle=s.description
break
case FN:const a=c.media
if(l.artwork=a.artworks[0],l.appEventFormattedDates=a.formattedDates,l.subtitle=c.inlineDescription,l.tintColor=a.tintColor,l.type="appEventStory",i(c.style))switch(c.style){case QH:case JH:l.mediaOverlayStyle=QH
break
case kq:l.mediaOverlayStyle=kq
break
default:x(c.style)}}var d
if(c.overlay)switch(c.overlay.kind){case Bq:const e=c.overlay
l.artwork||(u=[e.lockup])
break
case wy:u=c.overlay.lockups
break
case Pj:const t=c.overlay
l.subtitle=t.paragraph.text}if(i(u)){l.collectionAdamIds=[],l.collectionAppIcons=[]
for(const e of u)l.collectionAdamIds.push(e.adamId),l.collectionAppIcons.push(e.icon)
1===u.length&&(l.lockup=u[0])}const f=On(0,t)
l.editorialDisplayOptions=En(f)
const h=Zw(0,t);(null==h?void 0:h.length)>0&&h!==l.title&&(l.tagline=h)
const p=c.heroMedia
return s(p)&&(s(p.artworks[0])?(l.artwork=p.artworks[0],l.artwork.crop="em"):s(p.videos[0])&&(l.video=p.videos[0])),l.video&&(l.video.canPlayFullScreen=!1,l.video.playbackControls={}),l.collectionAdamIds||l.artwork||l.iconArtwork?l:null}(e,t,a,o===BB)
c=l
break}case Qj:{const n=new cee(l)
if(n.artwork=qd(e,B(t,FL),{useCase:n6.SearchEditorialResult,cropCode:"sr"}),n.type=PH,(0,Uv.isSome)(n.artwork))c=n
else{let r=we(t,ND)
r=r.filter(t=>!at(e,t,Wv.DeveloperPage))
const o=[],s=[]
r.forEach(t=>{o.push(t.id)
const n=Jd(e,t,{useCase:n6.SearchEditorialResult})
i(n)&&s.push(n)}),n.collectionAdamIds=o,n.collectionAppIcons=s,c=n}break}}if(r(c))return null
if(Qw(c)&&null!=c.collectionAdamIds&&c.collectionAdamIds.length){const e=c.collectionAdamIds.length
c.artworkGridType=e<=5?"extraLarge":e<=8?uq:e<=16?qC:LH}const u=Lh(e,t,c.title,n)
return c.clickAction=Dd(e,t,u,null),Oh(e,c,u),c})}(e,t,g.metricsOptions,v)
n&&(n.title&&(n.title=n.title.replace(/\n/g," ")),Qw(n)&&n.subtitle&&(n.subtitle=n.subtitle.replace(/\n/g," ")),p=n)}break
case FH:if(o(jd(e,t)))return null
const d=Td(e,t,g)
d.theme=kq,rg(e,d,f),p=new iee(d)
break
default:if(delete t.attributes[CG],w===xq){g.shouldIncludeScreenshotsForChildren=e.featureFlags.isEnabled(gJ)
const n=Ad(e,t,g)
n.showMetadataInformationInLockup=!0,rg(e,n,f),p=new see(n)}else{const n=Pd(e,t,g,{canPlayFullScreen:!1,playbackControls:{}},f)
rg(e,n,f)
const o=function(e,t,n,o,s,a){return Bv.context("appEventSearchResultFromData",()=>{if(!ig(e,t))return null
const{dataItems:c,personalizationData:l}=sg(e,t,s)
let d,f
for(const n of c){const r=ag(e,n,t,a,o.offerEnvironment,o.offerStyle)
if(i(r)){d=r,f=null!=t?t:pe(e,n,Mq)
break}}if(r(d))return null
const h=u(t.meta,KD),p=new lee
p.lockup=n,p.appEvent=d,p.alwaysShowAppEvent=h,p.clickAction=n.clickAction
const w=hh(null,null==l?void 0:l.processingType,null),g={...a,id:d.appEventId,kind:fA,targetType:Zx,title:d.title,softwareType:null,recoMetricsData:w}
return i(f)&&(g.relatedSubjectIds=[f.id]),Oh(e,p,g),p})}(e,t,n,g,a,c)
i(o)?(p=o,p.condensedBehavior=qV):p=new aee(n)}}return i(p)&&r(p.condensedBehavior)&&(p.condensedBehavior=v),p})}function eg(e,t,n,r,o,s){if(!ig(e,t))return!1
const{dataItems:a}=sg(e,t,null!=s?s:null)
let c
for(const n of a)if(c=ag(e,n,t,o,void 0,void 0),(0,Uv.isSome)(c))break
const l=!(!i(n)||!i(n[t.id]))&&n[t.id],u=!(!i(r)||!i(r[t.id]))&&["downloadable"].includes(r[t.id])
return(l||u)&&(0,Uv.isSome)(c)}function tg(e,t){switch(t){case BB:return BB
case qV:return qV
case"when-installed":return HC
default:return ng(e)}}function ng(e){return e.client.deviceType===jq?HC:qV}function rg(e,t,n){if(!n)return
const o=function(e,t,n,o){var i
if(r(t)||!e.client.isPhone)return null
const a=null===(i=null==t?void 0:t.displayStyle)||void 0===i?void 0:i.metadataPrecedenceOrder
if(!s(a))return null
const c=a.indexOf(n),l=a.indexOf(o)
return-1===c&&-1===l?null:-1!==c&&(-1===l||c<l)}(e,n,dG,EB)
i(o)&&(t.isEditorsChoice=t.isEditorsChoice&&o)}function og(e,t){return t===zq?Vz:null}function ig(e,t){if(!oi(e)||r(t.meta))return!1
const n=l(t.meta,JD).length>0
return![_N,fF,Qj,Nq,TV,FH,xq].includes(t.type)&&n}function sg(e,t,n){const r=u(t.meta,KD),o=l(t.meta,JD)
if(r)return{dataItems:[o[0]]}
const i=As(e,aq,o,!1,n,!1,void 0,t.id),s=i.personalizedData
return s.length<=0?{dataItems:[]}:{dataItems:s,personalizationData:i}}function ag(e,t,n,o,i,s){const a=wi(e,t,n,!1,!0,i,s,!1,{...o,targetType:Zx},!1,!0,null,!1,!1)
return r(a)||a instanceof Date?null:a}function cg(e,t,n,s,a,c,l,d,f){var h,p,w,g,v,m,y,A,T,b,S,P,C,I,k,O,E
const R=new uee,D=null!==(h=s.requestDescriptor.isNetworkConstrained)&&void 0!==h&&h,_={canPlayFullScreen:!1,playbackControls:{}}
tn(e)||gh(0,{id:H$,kind:jS,softwareType:null,targetType:null,title:H$,pageInformation:a.pageInformation,locationTracker:a.locationTracker,idType:sq},H$)
const L=t[n],M=Array.isArray(L)?L:[L],x=t[n-1],$=t[n+1]
let F
Zt(e,`Adverts received from ad server: ${M.filter(Nv.isSome).map(e=>`[${e.id}]`).join(", ")}`)
let N=!0
for(const s of M){if((0,Nv.isNothing)(null==s?void 0:s.attributes))continue
if(at(e,s)){Zt(e,`[${s.id}] filtered by shouldFilter() - app probably not supported on current os or device`)
continue}const h=lg(s.id,x,$,c),C=(0,Nv.isSome)(h),I=gg(t,C)
if(s.attributes[CG]=wg(s,I),o(s.attributes[CG])){Zt(e,`[${s.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`)
continue}const k={metricsOptions:{pageInformation:a.pageInformation,locationTracker:a.locationTracker,targetType:vV,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:n6.SearchIcon,isNetworkConstrained:D,canDisplayArcadeOfferButton:Yf(0,l$)},O=u(Ke(e,s,CG),"format.images")
let E=!1
const L=o(F),M=pg(kd(e,s,k,_,d,!0,n)),B=E?OF:null===(p=null==d?void 0:d.displayStyle)||void 0===p?void 0:p.screenshots,U=dg(e,M,s.id,I,O,F,B,h,c,l,a,f)
if(r(U)){Zt(e,`[${s.id}] will not be displayed because we could not create an ad style compatible with ${yg(F)}`)
continue}if(!pn(e,s,null,U.style)){Zt(e,`[${s.id}] filtered because localization is not available`)
continue}if(L?(Zt(e,`[${s.id}] first ad dictates ad display style of: ${yg(U)}`),F=U):Zt(e,`[${s.id}] will be displayed because it is compatible with the display style of: ${yg(U)}, which is the same height as display style: ${yg(F)}`),e.client.isPad&&0!==n&&U.style===hK){Zt(e,`[${s.id}] is being dropped because it has style TEXT in an unsupported position.`),null===(g=null===(w=a.pageInformation)||void 0===w?void 0:w.adPageInfo)||void 0===g||g.setMissedOpportunity(e,"TXT_NOAD","0",n)
continue}if(null===(v=a.pageInformation)||void 0===v||v.adPageInfo.apply(e,s),null===(y=null===(m=a.pageInformation)||void 0===m?void 0:m.adPageInfo)||void 0===y||y.setTemplateType(e,U.style),nn(e)){const e=null!==(A=k.metricsOptions.adsMetricsData)&&void 0!==A?A:{}
if(e[ZG]=U.style,C){const t=Array.isArray($)?void 0:$.id;(0,Nv.isSome)(t)&&(e[NM]=h.id===t?"Leading":"Trailing")}k.metricsOptions.adsMetricsData=e}let G=kd(e,s,k,_,d,"ad"===R.itemBackground||R.itemBackground===Vb,n)
if(G=vg(G,U,C,x,N),null===(T=G.searchAdOpportunity)||void 0===T||T.setTemplateType(U.style),U.style===hK){const t=j(s,sA)
if(t!==rq){let n
n=Qe(e,s,t===hq?bG:null!=t?t:void 0)
const r=null!==(b=G.searchAd)&&void 0!==b?b:null===(S=G.searchAdOpportunity)||void 0===S?void 0:S.searchAd
i(r)&&i(n)&&(r.advertisingText=n)}R.displaysScreenshots=!1}if((0,Nv.isSome)(G)){const n=ug(t,G.adamId);(0,Nv.isSome)(n)&&!E&&(null===(P=G.searchAdOpportunity)||void 0===P||P.setDuplicatePosition(n)),R.lockups.push(G),tn(e)||bh(a.locationTracker),N=!1}}if(tn(e)||mh(a.locationTracker),(0,Nv.isSome)(R.lockups)&&R.lockups.length>0){const t=M[0]
null===(C=a.pageInformation)||void 0===C||C.adPageInfo.apply(e,t),bh(a.locationTracker)}return(0,Nv.isSome)(F)?null===(k=null===(I=a.pageInformation)||void 0===I?void 0:I.adPageInfo)||void 0===k||k.setTemplateType(e,F.style):null===(E=null===(O=a.pageInformation)||void 0===O?void 0:O.adPageInfo)||void 0===E||E.setTemplateType(e,null),R.condensedBehavior=qV,{result:R,displayStyle:null==F?void 0:F.style}}function lg(e,t,n,r){return[t,n].find(t=>{var n
if((0,Nv.isNothing)(t)||Array.isArray(t))return!1
const o=t.id===e,i=null!==(n=null==r?void 0:r[t.id])&&void 0!==n&&n
return o&&!i})}function ug(e,t){const n=e.findIndex(e=>!Array.isArray(e)&&e.id===t)
return-1===n?null:n}function dg(e,t,n,r,i,s,a,c,l,u,d,f){const h=fg(e,t,n,i,s,a)
if((0,Nv.isNothing)(h))return null
const p={platform:t.mediaPlatformUsedForDisplayStyle,style:h}
return Zt(e,`[${n}] tentatively resolved to: ${yg(p)}`),r===fee.DUPE_AD&&(0,Nv.isSome)(c)?function(e,t,n,r,i,s,a,c,l,u,d,f){const h=f.style
if(function(e,t){var n,r,o,i
switch(e){case tK:t.portraitScreenshots.length<=5&&t.portraitScreenshots.splice(0,4)
break
case nK:t.portraitScreenshots.splice(0,3)
break
case rK:t.portraitScreenshots.splice(0,2)
break
case oK:t.portraitScreenshots.splice(0,1)
break
case iK:null===(n=t.videos)||void 0===n||n.splice(0,1),t.portraitScreenshots.length<=4&&t.portraitScreenshots.splice(0,3)
break
case sK:null===(r=t.videos)||void 0===r||r.splice(0,1),t.portraitScreenshots.splice(0,2)
break
case aK:null===(o=t.videos)||void 0===o||o.splice(0,1),t.portraitScreenshots.splice(0,1)
break
case uK:t.landscapeScreenshots.splice(0,1)
break
case cK:case lK:null===(i=t.videos)||void 0===i||i.splice(0,1)}}(h,t),pK.includes(h))return Zt(e,`[${n}] tentative style is unrestricted. No dupe logic applied.`),f
const p=o(i),w=fg(e,t,n,r,null,s),g=function(e,t,n){switch(t){case iK:case tK:return!0
case sK:case nK:return 3===mg(e,n)
case uK:case lK:return!0
case aK:case rK:return 2===mg(e)
default:return!1}}(e,w,s),v=eg(e,a,c,l,u,d)
return(g||v)&&p?(Zt(e,`[${n}] Organic Dupe would be full creative as ${w} so choosing tentative style for ad`),f):g&&!p?(Zt(e,`[${n}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${h}`),f):hg(hK,i)?(Zt(e,`[${n}] tentative style would not yield full creative for organic result so returning TEXT`),{style:hK}):(Zt(e,`[${n}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}(e,t,n,i,s,a,c,l,u,d,f,p):(null==s?void 0:s.style)===hK?(Zt(e,`[${n}] tentative style would be filtered since the first ad has style: ${yg(s)}, so returning TEXT`),{style:hK}):p}function fg(e,t,n,r,o,i){if(!r)return Zt(e,`[${n}] is not allowed to display media because of iAd configuration.`),hK
const s=null==o?void 0:o.mediaPlatform
if((0,Nv.isSome)(t.mediaPlatformUsedForDisplayStyle)&&(0,Nv.isSome)(s)&&!t.mediaPlatformUsedForDisplayStyle.isEqualTo(s))return Zt(e,`[${n}] filtered because media is derived from: ${t.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${s.mediaType}`),null
for(const n of dee){const r=n.canDisplay(t),s=hg(n.representativeDisplayStyle,o)
if(r&&s)return n.displayStyle(e,t,i)}return Zt(e,`[${n}] filtered because we could not create a compatible style for the first style of: ${yg(o)}`),null}function hg(e,t){if((0,Nv.isNothing)(t))return!0
let n=[]
for(const t of wK)if(t.includes(e)){n=t
break}return n.includes(t.style)}function pg(e){var t
let n
const r=null===(t=e.trailers)||void 0===t?void 0:t[0]
let o
s(r)&&(r.videos.sort((e,t)=>hee(e.preview,t.preview)),o=r.videos,n=r.mediaPlatform)
const i=e.screenshots[0],a=[],c=[]
return s(i)&&(i.artwork.forEach(e=>{e.isPortrait()?a.push(e):c.push(e)}),n=i.mediaPlatform),{portraitScreenshots:a,landscapeScreenshots:c,alignedRegionArtwork:e.alignedRegionArtwork,alignedRegionVideo:e.alignedRegionVideo,videos:o,mediaPlatformUsedForDisplayStyle:n}}function wg(e,t){let n
const r=f(B(e,LB),t)
return(0,Nv.isSome)(r)&&r.length>0&&(n=JSON.parse(r)),n}function gg(e,t){return t?fee.DUPE_AD:e.some(e=>{if(Array.isArray(e))return!1
const t=B(e,LB)
return(0,Nv.isNothing)(t)})?fee.NORMAL:fee.NO_ORGANIC_RESULTS}function vg(e,t,n,r,o){var i,a,c,l,u,d,f,h,p,w
const g=null===(a=null===(i=e.impressionMetrics)||void 0===i?void 0:i.fields)||void 0===a?void 0:a.pageCustomId,v=(0,Nv.isSome)(g)&&g.length>0
let m=!1;(0,Nv.isSome)(r)&&!Array.isArray(r)&&(m=e.adamId===r.id)
const y=n&&!o&&!v||m
if(s(e.trailers)){const t=e.trailers.shift()
null==t||t.videos.sort((e,t)=>hee(e.preview,t.preview)),(0,Nv.isSome)(t)&&e.trailers.unshift(t)}let A,T=[],b=[]
if(s(e.screenshots)){const t=e.screenshots.shift()
null==t||t.artwork.forEach(e=>{e.isPortrait()?null==T||T.push(e):null==b||b.push(e)}),A=null==t?void 0:t.mediaPlatform}if((0,Nv.isNothing)(A))return e
switch(t.style){case tK:if(e.trailers=null,b=null,e.screenshotsDisplayStyle=OF,y)if(T.length>5&&T.length<8){const e=T.splice(0,4),t=4-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,4)
else T.splice(4)
break
case nK:e.trailers=null,b=null,y?T.splice(0,3):T.splice(3)
break
case rK:e.trailers=null,b=null,y?T.splice(0,2):T.splice(2)
break
case oK:e.trailers=null,b=null,y?T.splice(0,1):T.splice(1)
break
case uK:e.trailers=null,T=null,y?b.splice(0,1):b.splice(1)
break
case iK:if(b=null,e.screenshotsDisplayStyle=OF,y)if(null===(c=e.trailers)||void 0===c||c[0].videos.splice(0,1),T.length>4&&T.length<7){const e=T.splice(0,3),t=3-T.length,n=e.splice(e.length-t)
T.unshift(...n)}else T.splice(0,3)
else null===(l=e.trailers)||void 0===l||l[0].videos.splice(1),T.splice(3)
break
case sK:b=null,y?(null===(u=e.trailers)||void 0===u||u[0].videos.splice(0,1),T.splice(0,2)):(null===(d=e.trailers)||void 0===d||d[0].videos.splice(1),T.splice(2))
break
case aK:b=null,y?(null===(f=e.trailers)||void 0===f||f[0].videos.splice(0,1),T.splice(0,1)):(null===(h=e.trailers)||void 0===h||h[0].videos.splice(1),T.splice(1))
break
case lK:case cK:y?null===(p=e.trailers)||void 0===p||p[0].videos.splice(0,1):null===(w=e.trailers)||void 0===w||w[0].videos.splice(1),b=null,T=null
break
case hK:case fK:case dK:e.trailers=null,b=null,T=null}if(s(e.trailers)){const t=e.trailers.shift()
e.trailers=[t].filter(Nv.isSome)}const S=(null!=b?b:[]).concat(null!=T?T:[])
if(s(S)){const t=new iz(S,A)
e.screenshots=[t]}else e.screenshots=[]
return e}function mg(e,t=null){if(e.client.isPhone){const e=3
return(0,Nv.isNothing)(t)?e:t===OF?4:3}return 2}function yg(e){if((0,Nv.isNothing)(e))return""
let t=""
return(0,Nv.isSome)(e.mediaPlatform)&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function Ag(e,t,n,r,o){var i,s
if(!(Kw(s=n)&&s[tW]===ey||function(e){return Kw(e)&&e[tW]===Xm}(n)))return
const a=n.lockup,c=t.lockups[0]
if(c.adamId!==a.adamId)return
const l=new Set
if((0,Nv.isSome)(c.screenshots)&&c.screenshots.length>0)for(const e of c.screenshots[0].artwork)l.add(e.template)
if((0,Nv.isSome)(c.trailers)&&c.trailers.length>0)for(const e of c.trailers[0].videos)l.add(e.preview.template)
if((0,Nv.isSome)(a.screenshots)&&a.screenshots.length>0){const e=a.screenshots[0].artwork.filter(e=>!l.has(e.template))
a.screenshots[0]=new iz(e,a.screenshots[0].mediaPlatform)}if((0,Nv.isSome)(a.trailers)&&a.trailers.length>0){const e=a.trailers[0].videos.filter(e=>!l.has(e.preview.template))
a.trailers[0]=new tz(e,a.trailers[0].mediaPlatform)}if((null===(i=null==r?void 0:r.displayStyle)||void 0===i?void 0:i.screenshots)===OF)switch(o){case iK:case tK:(e=>{const t=a.screenshots[0].artwork
if(t.length>=4)return
let n=4-t.length
const r=c.screenshots[0].artwork.slice().reverse()
for(const e of r){if(n<=0)return
a.screenshots[0].artwork.unshift(e),n-=1}})()}}function Tg(e,t,n,r,o,i,s,a,c){var l,u,d
let f
if((null===(l=null==r?void 0:r.lockups[0])||void 0===l?void 0:l.adamId)===t.id){const e=r.lockups[0]
f=null==n?void 0:n.find(t=>t.id===(null==e?void 0:e.adamId))}(0,Nv.isNothing)(f)&&(0,Nv.isSome)(o)&&o.id===t.id&&(f=o),(0,Nv.isNothing)(f)||eg(e,t,i,s,a,c)||function(e,t){var n
let r
r=(0,Nv.isSome)(null==t?void 0:t.meta)?S(t.meta):{},(0,Nv.isNothing)(e)?null===(n=r.cppData)||void 0===n||delete n[IU]:((0,Nv.isNothing)(r.cppData)&&(r.cppData={}),r.cppData[IU]=e),t.meta=r}(null===(d=null===(u=null==f?void 0:f.meta)||void 0===u?void 0:u.cppData)||void 0===d?void 0:d[IU],t)}function bg(e,t){var n,r,o
const i=null===(n=t.userDefaults)||void 0===n?void 0:n.integer("GuidedSearchOverrides.position")
return a(i)&&i>1?i:null===(o=null===(r=null==e?void 0:e.displayStyle)||void 0===r?void 0:r.guidedSearch)||void 0===o?void 0:o.position}async function Sg(e,t,n,r,o,s,a,c,l){var u,d,f,h,p,w,g,v,m
const y=[],A=[],T=n||null,b=o.filter(e=>e.type===Kq).map(e=>e.id),S=bs(e,new Set(b)),P=o
let C=[0]
if((0,Uv.isSome)(s))if(tn(e)){const t=sn(e,n)
C=t.filter((e,n)=>0===e||o.length>=e-1||t[n-1]===e-1)
for(const[t,n]of C.entries())(0,Uv.isSome)(s[t])?P.splice(n,0,s[t]):null===(u=r.pageInformation)||void 0===u||u.adPageInfo.setMissedOpportunity(e,V$,"0",n)}else P.splice(0,0,s),nn(e)&&0===s.length&&(null===(d=r.pageInformation)||void 0===d||d.adPageInfo.setMissedOpportunity(e,V$,"0",0))
const I=bg(n,e)
let k,O,E
for(const[s,u]of P.entries()){if(s===I){const o=Pg(e,t.requestDescriptor,a,r)
if(o.length>0){const t=null!==(p=null===(h=null===(f=null==n?void 0:n.displayStyle)||void 0===f?void 0:f.guidedSearch)||void 0===h?void 0:h.title)&&void 0!==p?p:e.loc.string("Search.Guided.Title.ExploreMore"),i=new tee(t,o)
Oh(e,i,{...r,id:UC,kind:Fj,targetType:gO,title:t,softwareType:null}),y.push(i),bh(r.locationTracker)}}if(Array.isArray(u)||(0,Uv.isSome)(fn(0,u))){const n=cg(e,P,s,t,r,null!=c?c:null,null!=l?l:null,T,S),o=n.result
k=o,O=n.displayStyle,(0,Uv.isSome)(null===(w=null==o?void 0:o.lockups)||void 0===w?void 0:w[0])&&(o.searchAdOpportunity=o.lockups[0].searchAdOpportunity,y.push(o))
continue}if(!i(u.attributes)){A.push(...o.slice(s))
break}if(at(e,u,Wv.Search))continue
let d
const b=P[s+1]
Array.isArray(b)||!(0,Uv.isSome)(B(b,LB))||at(e,b)||(d=b),((0,Uv.isSome)(null==k?void 0:k.lockups)&&k.lockups.length>0||(0,Uv.isSome)(d))&&Tg(e,u,E,k,d,c,l,r,S)
const R=Xw(e,u,n,S,r,t.requestDescriptor.isNetworkConstrained,t.requestDescriptor.searchEntity,T)
!(0,Uv.isNothing)(R)&&((0,Uv.isSome)(null==k?void 0:k.lockups)&&k.lockups.length>0&&Ag(0,k,R,T,O),Jt(e)&&C.includes(s)&&(0,Uv.isSome)(null===(g=r.pageInformation)||void 0===g?void 0:g.adPageInfo)&&(R.searchAdOpportunity=qt(e,r.pageInformation),null===(v=R.searchAdOpportunity)||void 0===v||v.setMissedOpportunityReason(V$),null===(m=R.searchAdOpportunity)||void 0===m||m.setTemplateType(zU)),y.push(R),bh(r.locationTracker),k=void 0,O=void 0,E=void 0)}return await async function(e,t){return await Bv.context("applyClientFilteringToIAPs",async()=>{const n={}
for(const e of t)if(e.resultType===NU){const t=e.lockup
t.parent&&t.productIdentifier&&t.parent.bundleId?n[t.productIdentifier]=t.parent.bundleId:Bv.unexpectedNull(cH,Sq,`required fields for ${t.adamId}`)}return 0===Object.keys(n).length?await Promise.resolve(t):await e.clientOrdering.visibilityForIAPs(n).then(e=>t.filter(t=>{if(t.resultType!==NU)return!0
const n=t.lockup
return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}))})}(e,y).then(e=>({builtSearchResults:e,deferredSearchResults:A}))}function Pg(e,t,n,r){if((0,Uv.isNothing)(n)||0===n.length)return[]
vh(0,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:jD},"")
const o=[]
for(const i of n){const n=jw(e,jC,t,i,r)
n&&(o.push(n),bh(r.locationTracker))}return mh(r.locationTracker),o}function Cg(e,t,n,r){const o=new B4(t,t,null,r)
return o.spellCheckEnabled=!1,o.excludedTerms=[n],o.originatingTerm=n,o}function Ig(e,t){return t&&t.results?t.results.slice(0,t.maxPerPage):[]}function kg(e,t){let n=[]
if(t&&t.results&&(n=t.results.slice(t.maxPerPage,t.results.length)),o(n))return null
const r={...t}
return r.results=n,r}function Og(e){return(0,Nv.isSome)(e)&&0!==e.length?`SearchResults.${e}.shelfId`:"SearchResults.shelfId"}function Eg(e){switch(e){case jm.iOS:return pq
case jm.visionOS:return"visionos"
default:return"SearchTopResults"}}function Rg(e,t){const n=new xK
return i(t)&&(n.facets=qw(e,t),n.pageFacets=Ww(e),n.selectedFacetOptions=zw(e)),n.results=[],n}function Dg(e,t){const n=new gee([])
return i(t)&&(n.facets=qw(e,t),n.pageFacets=Ww(e),n.selectedFacetOptions=zw(e)),n}async function _g(e,t){return await Bv.context("searchResultsFromResponse",async()=>{var n
const r=null!==(n=e.fetchTimingMetricsBuilder)&&void 0!==n?n:new Cm.FetchTimingMetricsBuilder,a=await r.measureModelConstructionAsync(async()=>{var n,r,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,C,I,k
const O=t.catalogResponse,E=t.requestMetadata,R=E.searchRequestUrl,D=t.searchResultsAdsRequestData,_=O.results.guidedSearch,L=function(e,t,n){var r,o,i,s,a,c,l
return{term:t.term,suggestedTerm:null===(o=null===(r=n.results)||void 0===r?void 0:r.spellCheck)||void 0===o?void 0:o.suggestedTerm,correctedTerm:null===(s=null===(i=n.results)||void 0===i?void 0:i.spellCheck)||void 0===s?void 0:s.correctedTerm,resultsTerm:null!==(l=null===(c=null===(a=n.results)||void 0===a?void 0:a.spellCheck)||void 0===c?void 0:c.correctedTerm)&&void 0!==l?l:t.term,originatingTerm:t.originatingTerm}}(0,E.requestDescriptor,O),M=(I=t.searchResultsAdData,(0,Nv.isSome)(I)&&"odmlSuccess"in I&&I.odmlSuccess),$={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:qn(e,E.requestDescriptor,O,L,R,Eg(),D,M,_),createUniqueImpressionId:!0},F=e.featureFlags.isEnabled(cJ)||!0,N=F?new gee:new xK,B=bg(O.meta,e);(0,Nv.isNothing)(B)&&function(e,t,n,r,i){const a=n.requestDescriptor
vh(0,{pageInformation:i.pageInformation,locationTracker:i.locationTracker,targetType:jD},"")
const c=[]
if(s(r))for(const t of r){const n=jw(e,UF,a,t,i)
n&&(c.push(n),bh(i.locationTracker))}if(o(c)&&n.requestDescriptor.searchEntity){const t=function(e,t,n){var r
const o=t.searchEntity
if(!o)return null
const i=new K7(null,UD)
let s
switch(function(e,t,n,r,o){const i=UM,s=BM,a={targetId:r},c=_t(e,r,s,{actionType:i,location:wh(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},r),searchTerm:n})
t.actionMetrics.addMetricsData(c)
const l=Lt(e,n,s,i,null,a)
t.actionMetrics.addMetricsData(l)}(e,i,t.term,o,n),o){case qq:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE")
break
case PH:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS")
break
case UU:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_STORIES")
break
case zq:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_APPLEWATCH")
break
default:x(o)}const a=new Y7(s,!0,null!==(r=Gw(o))&&void 0!==r?r:Yk,s,i)
return Bn(0,a,BM,n),a}(e,n.requestDescriptor,i)
c.push(t),bh(i.locationTracker)}const l=function(e,t,n){var r
if(o(n))return null
const i=t.term,s=null!==(r=t.guidedSearchTokens)&&void 0!==r?r:[],a=[]
for(const e of n){const t=e.displayLabel,n=Array.from(s)
if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t)
const r=new J7(i,n,e.finalTerm)
a.push(r)}return a}(0,n.requestDescriptor,r)
mh(i.locationTracker),s(c)&&(t.guidedSearchTokens=c,t.guidedSearchQueries=l,function(e,t,n){const r=yh(n.locationTracker)
t.guidedSearchTokensParentImpressionMetrics=new CY({impressionIndex:r,impressionType:jD,idType:kU,id:zC,name:"Search Revisions"})}(0,t,i),bh(i.locationTracker))}(e,N,E,null==_?void 0:_.facets,$)
const U={id:Wx,kind:null,softwareType:null,targetType:Bj,title:MB,pageInformation:$.pageInformation,locationTracker:$.locationTracker,idType:kU}
let G
F&&(G=new YY(mx),G.id=Og(),G.isHorizontal=!1,Oh(e,G,U),gh(0,U,MB))
let j=function(e,t){return function(e,t,n){if((0,Nv.isNothing)(n))return t
const r=[],o=t.reduce((e,t)=>({...e,[t.id]:t}),{})
if("adverts"in n){if((0,Nv.isNothing)(n.adverts)||0===n.adverts.length)return t
for(const t of n.adverts){const n=o[t.adamId]
if((0,Nv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Nv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=Vw(e,n,t)
r.push(i)}}else if("ads"in n){if((0,Nv.isNothing)(n.ads)||0===n.ads.length)return t
for(const t of n.ads){const n=o[t.adamId]
if((0,Nv.isNothing)(n)){Zt(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if((0,Nv.isNothing)(n.attributes)){Zt(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const i=Hw(0,n,t)
r.push(i)}}return r}(e,At(t.catalogResponse.results[qD]),t.searchResultsAdData)}(e,t)
const V=t.searchResultsAdData
if((0,Nv.isSome)(V)&&"appliedPolicy"in V&&(0,Nv.isSome)(V.appliedPolicy)&&(j=[],"ageRestricted"===V.appliedPolicy)){const t=null!==(n=an(e,zH,!0))&&void 0!==n?n:[]
for(const n of t)null===(r=$.pageInformation)||void 0===r||r.adPageInfo.setMissedOpportunity(e,mS,"0",n.slot)}const H=null!==(u=null===(l=null===(c=null===(a=O.meta)||void 0===a?void 0:a.results)||void 0===c?void 0:c.search)||void 0===l?void 0:l.searchSafety)&&void 0!==u&&u,q=(null===(p=null===(h=null===(f=null===(d=O.meta)||void 0===d?void 0:d.results)||void 0===f?void 0:f.search)||void 0===h?void 0:h.reason)||void 0===p?void 0:p.kind)===HD?"NLS_NORESULTS":"NLS_NOAD"
if(H){j=[]
const t=null!==(w=an(e,zH,!0))&&void 0!==w?w:[]
for(const n of t)null===(g=$.pageInformation)||void 0===g||g.adPageInfo.setMissedOpportunity(e,q,"0",n.slot)}const W=await Sg(e,E,O.meta,$,function(e,t){return At(t.catalogResponse.results.search)}(0,t),j,null==_?void 0:_.facets,function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.installedStates)&&void 0!==n?n:{}}(t),function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.appStates)&&void 0!==n?n:{}}(t))
if(H&&0!==W.builtSearchResults.length){const e=W.builtSearchResults[0].lockup.searchAdOpportunity
null==e||e.setMissedOpportunityReason(q),null==e||e.setTemplateType(zU)}if(F&&G){const t=N
G.items=W.builtSearchResults,t.resultsParentImpressionMetrics=G.impressionMetrics,t.shelves.push(G)
const n=function(e,t){return Bv.context("createSearchResultsContextCard",()=>{var n,r
if((0,Nv.isNothing)(e)||![Kj,OV].includes(t.host.platform))return
const o=null===(n=e.links)||void 0===n?void 0:n.map(Lg),i=null==o?void 0:o.reduce((e,t)=>{var n
return(null===(n=t.title)||void 0===n?void 0:n.length)&&(e[t.title]=t),e},{})
let s=e.text
1===(null==o?void 0:o.length)&&(null===(r=o[0].title)||void 0===r?void 0:r.length)?s+=" "+o[0].title:o&&o.length>1&&(s.length>0&&(s+="\n"),s+=o.map(e=>e.title).filter(e=>null==e?void 0:e.length).join("\n"))
const a=new i5(s),c=new s5(a,i)
return new vee(c)})}(O.results.queryContext,e),r=null===(y=null===(m=null===(v=O.meta)||void 0===v?void 0:v.results)||void 0===m?void 0:m.search)||void 0===y?void 0:y.reason
if((null==r?void 0:r.kind)===HD)t.unavailableReason={title:e.loc.stringWithFallback("Search.Results.Empty.Title","No results"),message:r.text,action:(k=r.links,Bv.context("actionFromSearchResultsLinks",()=>{const e=null==k?void 0:k.find(e=>e.url.length>0)
return e?Lg(e):void 0})),contextCard:n}
else if(n){const e=new YY("searchResultsContextCard")
e.items=[n]
const r=null!==(S=null===(b=null===(T=null===(A=O.meta)||void 0===A?void 0:A.displayStyle)||void 0===T?void 0:T.queryContext)||void 0===b?void 0:b.position)&&void 0!==S?S:0
if(r>0){const n=G.items.splice(r),o={...G,id:"searchResults2",items:n}
t.shelves.push(e),t.shelves.push(o)}else t.shelves.unshift(e)}H&&0===W.builtSearchResults.length&&(null===(C=(P=e.onDeviceSearchHistoryManager).removeRecentSearchTerm)||void 0===C||C.call(P,L.term))}else{const e=N
e.results=W.builtSearchResults,function(e,t,n){const r=yh(n.locationTracker)
t.resultsParentImpressionMetrics=new CY({impressionIndex:r,impressionType:Bj,idType:kU,id:Wx,name:MB})}(0,e,$)}return W.deferredSearchResults.length>0&&(N.nextPage=function(e,t,n,r,i){return o(t)?null:{results:t,maxPerPage:30,requestMetadata:n,metricsOptions:i,responseMetadata:null!=r?r:{},contentOffsetWithinResultsShelf:yh(i.locationTracker)}}(0,W.deferredSearchResults,E,O.meta,$)),F&&mh(U.locationTracker),N.message=function(e,t,n){const r=i(t.correctedTerm),o=i(t.suggestedTerm)
return vh(0,{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:yq},"spellCorrection"),r?function(e,t,n){const r=t.term,o=Cg(0,r,t.resultsTerm,SR)
ta(e,o,Qq,n.locationTracker)
const i=`<i>${t.correctedTerm}</i>`,s=e.loc.string("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(VD,i),a=new s5(new i5(s,sV),{}),c=e.loc.string("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(VD,r),l={}
l[`${c}`]=o
const u=new s5(new i5(c),l)
return new pee(a,u,o)}(e,t,n):o?function(e,t,n){const r=t.suggestedTerm,o=Cg(0,r,t.resultsTerm,PR)
ta(e,o,Qq,n.locationTracker)
const i=`<i>${r}</i>`,s=e.loc.string("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(VD,i),a={}
a[`${r}`]=o,a[`${r}?`]=o
const c=new s5(new i5(s,sV),a)
return new pee(c,null,o)}(e,t,n):(mh(n.locationTracker),null)}(e,L,$),!o(E.requestDescriptor.searchEntity)||(N.facets=qw(e,E.requestDescriptor.facets,t.categoriesFilterData),N.pageFacets=Ww(e,t.categoriesFilterData),N.selectedFacetOptions=s(t.requestMetadata.requestDescriptor.selectedFacetOptions)?t.requestMetadata.requestDescriptor.selectedFacetOptions:zw(e)),N.searchTermContext=L,N.isAutoPlayEnabled="tv"!==e.client.deviceType,N.isCondensedSearchLockupsEnabled=e.client.isPhone,N.transparencyLink=Jw(e,$),jn(e,N,$.pageInformation),N.searchClearAction=Mg(e,kG,$.pageInformation,$.locationTracker,L.term),N.searchCancelAction=Mg(e,yj,$.pageInformation,$.locationTracker,L.term),N})
return a})}function Lg(e){return Bv.context("actionFromSearchResultsLink",()=>{var t
const n=new PY(e.url,!1)
return n.title=null===(t=e.label)||void 0===t?void 0:t.replace(" ","\xa0"),n.artwork=new QW("systemimage://arrow.up.forward",0,0,[]),n})}function Mg(e,t,n,r,o){const s=new fW
let a,c
switch(t){case yj:a=GG,c=yj
break
case kG:a="delete",c=kG}return function(e,t,n,r,o){const s={searchTerm:o,actionType:n.actionType}
n.actionDetails&&(s[xG]=n.actionDetails),n.actionContext&&(s[RS]=n.actionContext),o&&(s[mH]=o),i(n.softwareType)&&(s[IN]=n.softwareType),n.mercuryMetricsData&&Object.assign(s,n.mercuryMetricsData)
const a=_t(e,n.id,null!=r?r:nh(0,n),s)
t.actionMetrics.addMetricsData(a)}(e,s,{targetType:Qq,id:c,idType:void 0,actionType:a,pageInformation:n,locationTracker:r},Qq,o),s}async function xg(e,t){return function(e,t,n){return Bv.context("searchHintsFromApiResponse",()=>{var r,o,i,s
const a={targetType:wN,pageInformation:Hn(0,0,n.hintsRequestUrl,n.dataSetId),locationTracker:{rootPosition:0,locationStack:[]}}
let c=null;(null===(r=n.userTypedTerm)||void 0===r?void 0:r.length)&&(c=new B4(n.userTypedTerm,n.userTypedTerm,null,CR),c.spellCheckEnabled=!0,c.prefixTerm=t,$h(e,c,a),ta(e,c,a.targetType,a.locationTracker,a.pageInformation),bh(a.locationTracker))
const l=null!==(i=null===(o=n.rawHints)||void 0===o?void 0:o.map(n=>function(e,t,n,r){var o,i,s,a,c
const l=null!==(o=function(e){switch(e.entity){case Kq:return e.context
case Qj:return PH
case Nq:return UU
default:return null}}(t))&&void 0!==o?o:void 0,u=new B4(null!==(i=t.displayTerm)&&void 0!==i?i:"",null!==(s=t.searchTerm)&&void 0!==s?s:"",null,B$,l,t.source)
return u.artwork=function(e,t){return Ot(e,`systemimage://${t}`)}(e,null!==(a=Gw(l))&&void 0!==a?a:Yk),u.spellCheckEnabled=!0,u.prefixTerm=n,$h(e,u,r),ta(e,u,r.targetType,r.locationTracker,null!==(c=r.pageInformation)&&void 0!==c?c:void 0),bh(r.locationTracker),u}(e,n,t,a)))&&void 0!==i?i:[]
null!=c&&l.unshift(c)
const u=new wee(l,null!==(s=n.ghostHintsTerm)&&void 0!==s?s:null),d=Lt(e,t,"key",_R,n.hintsRequestUrl,{...Nt(a.pageInformation)})
return u.pageMetrics.pageFields=Nt(a.pageInformation),u.pageMetrics.addData(d,[pm.PageInvocationPoint.pageEnter]),u.searchClearAction=Mg(e,kG,a.pageInformation,a.locationTracker,t),u.searchCancelAction=Mg(e,yj,a.pageInformation,a.locationTracker,t),u})}(e,t,await async function(e,t){const n=function(e,t){const n=new Jz(e).includingAppBinaryTraitsAttribute(!1).forType(gx).withLimit(10).withSearchTerm(t).addingQuery(LD,xC)
e.host.clientIdentifier===Hz&&n.addingQuery(IG,qH)
const r=[]
return e.appleSilicon.isSupportEnabled&&r.push(MD),oi(e)&&r.push(MH),e.bag.isNaturalLanguageSearchEnabled&&r.push($C),r.length>0&&n.enablingFeatures(r),n}(e,t)
return await Ln(e,n).then(t=>{var r
return{hintsRequestUrl:ve(e,n).toString(),userTypedTerm:f(t,"userTyped"),rawHints:l(t,"results.suggestions"),ghostHintsTerm:f(t,"ghosting"),dataSetId:f(null===(r=t.meta)||void 0===r?void 0:r.metrics,HK)}})}(e,t))}function $g(e,t,n,r,i){const s=function(e,t,n,r,i){if(o(i))return[]
const s=[]
for(const[a,c]of i.entries()){const i=Fg(e,c,a,t,n,r)
o(i)||(s.push(i),bh(n))}return s}(e,n,r,t.itemDisplayStyle,i),a=new Cee
a.title=e.loc.string("Action.ClearSearches"),function(e,t){const n=_t(e,"Clear Searches",Qq,{actionType:"confirm"})
t.actionMetrics.addMetricsData(n)}(e,a)
const c=new eZ([a])
c.title=e.loc.string("Sheet.ClearSearches.Title"),c.message=e.loc.string("Sheet.ClearSearches.Message"),c.destructiveActionIndex=0,c.isCancelable=!0
const l=new MJ([c])
l.title=e.loc.string("Action.Clear")
const u=(f=t.shelfDisplayStyle).layout===See?QC:2===f.layoutSize?"twoColumnList":YC,d=new YY(u)
var f
return d.id=r_,d.presentationHints={isWidthConstrained:!0},d.header={title:t.title,accessoryAction:l},d.contentType===QC&&(d.isHorizontal=!0,d.rowsPerColumn=t.shelfDisplayStyle.layoutSize),d.contentsMetadata={type:"searchFocusTwoColumnList",numberOfColumns:s.length>1?t.shelfDisplayStyle.layoutSize:1},d.items=s,d.isHidden=o(s),d.refreshUrl=function(e){return`${hW}:/${yW.searchLandingPage}/${yW.shelf}/?${DW.isOnDeviceSearchHistoryShelf}=true&${DW.token}=${function(e){return encodeURIComponent(JSON.stringify(e))}(e)}`}(t),d}function Fg(e,t,n,r,o,i){const s=t.term,a=t.entity,c=jg(e,function(e,t,n){if((0,Uv.isNothing)(n))return t
let r
return n===PH?r="Search.ResultsTitle.InDevelopers":n===UU?r="Search.ResultsTitle.InStories":n===zq?r="Search.ResultsTitle.InWatch":n===qq&&(r="Search.ResultsTitle.InArcade"),(0,Uv.isNothing)(r)?t:e.loc.string(r).replace("@@search_term@@",t)}(e,s,a),s,a,o,bR,void 0,r,i)
return(0,Uv.isNothing)(c)?null:(c.id=t.id,Oh(e,c,{targetType:yq,pageInformation:r,locationTracker:o,kind:yq,softwareType:null,title:t.term,hintsEntity:t.entity,id:`${n}`,idType:sq}),c)}function Ng(e,t,n){var r
const i=t.data
if(o(i))return
let s=0
const a=e.bag.mediaAPISearchFocusEnabled&&(0,Uv.isSome)(n.pageType)
for(const c of i){if(o(c))continue
if(a){const e=p(c,tV),t=Bg(null==e?void 0:e.category)
if((0,Uv.isSome)(t)&&t!==n.pageType)continue}const i=qg(e,n,s,t.meta||null);(0,Uv.isSome)(i)&&(n.shelves.push(i),bh(n.metricsLocationTracker))
const l=j(c,"contentKind"),u=Mw(0,c,l),d=Wg(0,c,u,n,l)
gh(0,d.metricsOptions,null!==(r=u.title)&&void 0!==r?r:"")
const f=Ug(e,c,n,d,u,l)
mh(n.metricsLocationTracker),o(f)||(Oh(e,f,d.metricsOptions),un(e,[f],oV,d.metricsOptions.id,n.metricsPageInformation),n.shelves.push(f),s+=1,bh(n.metricsLocationTracker))}}function Bg(e){switch(e){case $F:return Um.Landing
case"search-focus":return Um.Focus
default:return}}function Ug(e,t,n,c,l,u){switch(u){case Gm.Suggestion:return n.pageType===Um.Focus?function(e,t,n,r,i){var s,a,c
const l=we(t,Jq)
if((0,Uv.isNothing)(l))return null
const u=[],d=new YY(YC)
d.isHorizontal=!1,d.title=r.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,i]of l.entries()){const l=j(i,mH)
if((0,Uv.isNothing)(l)||0===l.length)continue
const d=null!==(s=j(i,e_))&&void 0!==s?s:l,f=jg(e,null!=d?d:"",null!=l?l:"",void 0,n.metricsLocationTracker,AB,void 0,n.metricsPageInformation,null!==(a=r.searchLandingItemDisplayStyle)&&void 0!==a?a:void 0);(0,Uv.isNothing)(f)||o(f)||(Oh(e,f,{targetType:yq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,kind:yq,softwareType:null,title:null!==(c=f.title)&&void 0!==c?c:"",id:`${t}`,idType:sq}),u.push(f),bh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,d)}(e,t,n,l):function(e,t,n,i,s){var c
const l=we(t,Jq),u=[],d=new YY(UH)
d.isHorizontal=!1,d.title=i.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,o]of l.entries()){const s={targetType:yq,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},a=Gg(e,o,n,i)
r(a)||r(a.action)||(Oh(e,a.action,{...s,kind:yq,softwareType:null,title:a.action.title,id:`${t}`,idType:sq}),u.push(a),bh(n.metricsLocationTracker))}return o(u)?null:(d.items=u,a(null===(c=i.displayStyle)||void 0===c?void 0:c.layoutSize)?d.contentsMetadata={type:L$,numberOfColumns:i.displayStyle.layoutSize}:(e.client.isPhone||e.client.isPad)&&(d.contentsMetadata={type:L$,numberOfColumns:u.length>=6?2:1}),d)}(e,t,n,l)
case Gm.CategoriesAndCharts:return Fw(e,t,!1,l,0,c)
case Gm.Apps:return function(e,t,n,o,a){var c,l,u,d,f
const h=Wv.All,p=[]
let w=!1,g=function(e){const t=fe(e,Jq)
return null==t?void 0:t.data}(t)
const v=new YY(a.shelfStyle)
if(v.isHorizontal=!1,v.title=o.title,v.shouldFilterApps=!1,v.filteringExcludedItems=a.filteringExcludedItems,s(g)){const t=function(e,t,n){var o,s,a,c,l,u,d,f,h,p
const w=Ja(t.adStitcher,n.adPositionInfo)
if(r(w))return null
const g=w.data
try{const r=Hg(e,g,t,n)
return i(r)?n.filteringExcludedItems=[g.id]:null===(o=t.metricsPageInformation.adPageInfo)||void 0===o||o.recordLockupFromDataFailed(e,null!==(a=null===(s=n.adPositionInfo)||void 0===s?void 0:s.shelfIdentifier)&&void 0!==a?a:uF,null!==(l=null===(c=n.adPositionInfo)||void 0===c?void 0:c.slot)&&void 0!==l?l:0),r}catch(r){return Zt(e,`Failed to create SLP ad lockup: ${r}`),null===(u=t.metricsPageInformation.adPageInfo)||void 0===u||u.recordLockupFromDataFailed(e,null!==(f=null===(d=n.adPositionInfo)||void 0===d?void 0:d.shelfIdentifier)&&void 0!==f?f:uF,null!==(p=null===(h=n.adPositionInfo)||void 0===h?void 0:h.slot)&&void 0!==p?p:0),null}}(e,n,a)
t&&ft(t)&&(w=!0,p.push(t),bh(n.metricsLocationTracker),g=g.filter(e=>e.id!==t.adamId))}const m=(0,Uv.isSome)(o.displayCount)
s(g)&&(g=wn(g,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(u=null===(l=a.metricsOptions)||void 0===l?void 0:l.recoMetricsData)&&void 0!==u?u:{}))
for(const t of g){if(t.type===Vq)return null
if(r(t.attributes))continue
if(at(e,t,h))continue
const o=Hg(e,t,n,a)
o&&(p.push(o),bh(n.metricsLocationTracker))}if(m){const e=o.displayCount
v.items=p.slice(0,e)}else v.items=p
if(m){const r=new YY(a.shelfStyle)
r.items=w?p.splice(1,p.length-1):p
const i=new ZY([r])
i.title=v.title
const s=new fY(eW)
s.pageUrl=o.seeAllLink,s.title=e.loc.string(KV),s.pageData=i,v.seeAllAction=s,Xs(e,s,s.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),jn(e,i,Vn(0,t.id))}return(null===(d=o.displayStyle)||void 0===d?void 0:d.layout)===Pee&&(v.isHorizontal=!0,v.rowsPerColumn=null===(f=o.displayStyle)||void 0===f?void 0:f.layoutSize),v}(e,t,n,l,c)
case Gm.EditorialCollection:return null
default:return function(e,t,n,r,o){return"search-recommendations-marker"!==t.type?null:j(t,x$)===BC?function(e,t,n){return $g(e,new Iee(n.title,n.displayCount,n.displayStyle,n.searchLandingItemDisplayStyle),t.metricsPageInformation,t.metricsLocationTracker,t.searchHistory)}(e,n,o):null}(e,t,n,0,l)}}function Gg(e,t,n,r){var o,i
const s=j(t,mH)
if((0,Uv.isNothing)(s)||0===s.length)return null
const a=null!==(o=j(t,e_))&&void 0!==o?o:s,c=new B4(a,s,null,AB,void 0,void 0)
return c.artwork=Vg(null!==(i=r.searchLandingItemDisplayStyle)&&void 0!==i?i:void 0,e),ta(e,c,Qq,n.metricsLocationTracker),(0,Uv.isSome)(c)?new N4(c):null}function jg(e,t,n,r,i,s,a,c,l){if(o(n))return null
const u=new B4(t,n,null,s,null!=r?r:void 0,a,[])
return u.artwork=Vg(l,e),ta(e,u,Qq,i,c),u}function Vg(e,t){var n
return(null==e?void 0:e.iconKind)===Hm.Symbol&&(null===(n=null==e?void 0:e.iconKind)||void 0===n?void 0:n.length)?Ot(t,`systemimage://${e.iconSymbol}`):t.client.isPhone?Ot(t,R$):void 0}function Hg(e,t,n,s){if(o(t))return null
if(s.shelfStyle!==dq)return null
let a=null
!i(s.shelfBackground)||s.shelfBackground.type!==cV&&s.shelfBackground.type!==WL||(a=JH)
const c=Ad(e,t,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t)},artworkUseCase:Hd(0,s.shelfStyle),offerStyle:a,canDisplayArcadeOfferButton:Yf(0,s.shelfStyle),isContainedInPreorderExclusiveShelf:!1,shouldHideArcadeHeader:!1})
return r(c)||!c.isValid()?null:c}function qg(e,t,n,o){var i,s,a
const c=Ja(t.adStitcher,{shelfIdentifier:u2,slot:n})
if(r(c))return null
const l=c.data
try{switch(null===(i=null==o?void 0:o.adDisplayStyle)||void 0===i?void 0:i.format){case pU:return function(e,t,n){var r,o
const i=new YY(ZD)
i.isHorizontal=!1
const s=kq,a=JH,c=Lh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:vV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=QD,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Hd(0,ZD),canDisplayArcadeOfferButton:Yf(0,ZD)},u={canPlayFullScreen:!1,playbackControls:{}}
let d=kd(e,t,l,u,null,!1)
const h=d.screenshots[0],p=Ht(h)
n.metricsPageInformation.adPageInfo.setTemplateType(e,p)
const w=Jd(e,t,{useCase:n6.Default,withJoeColorPlaceholder:!0,overrideTextColorKey:T$})
d=kd(e,t,l,u,null,!1),null===(r=d.searchAdOpportunity)||void 0===r||r.setTemplateType(p)
const g=w.backgroundColor,v=w.textColor,m=new L0(d,[h],!0,v,g,null!==(o=e.bag.todayAdMediumLockupScreenshotsRiverSpeed)&&void 0!==o?o:8)
return Dh(e,m,c,c.pageInformation.adPageInfo),m.clickAction=Dd(e,t,c,null),i.items=[m],i}(e,l,t)
case"condensed":return function(e,t,n){var r,o
const i=new YY(XD)
i.isHorizontal=!1
const s=kq,a=JH,c=Lh(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:vV,recoMetricsData:St(t),isAdvert:Ut(0,t)})
c.kind=QD,c.pageInformation.adPageInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),isAdvert:Ut(0,t),disableFastImpressionsForAds:!0},artworkUseCase:Hd(0,XD),canDisplayArcadeOfferButton:Yf(0,XD)}
null===(r=n.metricsPageInformation.adPageInfo)||void 0===r||r.setTemplateType(e,zU)
const u=kd(e,t,l,{canPlayFullScreen:!1,playbackControls:{}},null,!1)
null===(o=u.searchAdOpportunity)||void 0===o||o.setTemplateType(zU)
const d=new D0(u,u.icon)
return Dh(e,d,c,c.pageInformation.adPageInfo),i.items=[d],i}(e,l,t)
default:return null===(s=t.metricsPageInformation.adPageInfo)||void 0===s||s.recordLockupFromDataFailed(e,u2,n),null}}catch(r){return Zt(e,`Failed to create SLP ad shelf: ${r}`),null===(a=t.metricsPageInformation.adPageInfo)||void 0===a||a.recordLockupFromDataFailed(e,u2,n),null}}function Wg(e,t,n,r,o=null){const i=xw(0,t,n,r)
return o===Gm.Apps?{...i,shelfStyle:dq,adPositionInfo:l2}:i}function zg(e,t){const n=new Jz(e).forType($D).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e)).includingScopedRelationships("search-recommendations",[Jq]).addingQuery(Zq,$F)
Gi(e,vx)&&Ai(n),e.bag.enableUpdatedAgeRatings&&n.includingAttributes([iq])
const r=cc(e,e.user.dsid)
return(null==r?void 0:r.length)>0&&n.addingQuery(xD,r),n.addingQuery(tV,"adDisplayStyle"),n}function Yg(e,t,n,r){var i
if(o(t.data))return null
const s=Un(e,pG,pG,t),a=Ss(e)
s.recoMetricsData=hh(s.recoMetricsData,null,a),s.adPageInfo=dn(e,oV,n),null===(i=s.adPageInfo)||void 0===i||i.recordAdResponseEventsIfNeeded(e,n,uF,0)
const c={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:s,adStitcher:Ka(e,n,t),pageType:Um.Landing,recoImpressionData:gn(0,r)}
Ng(e,t,c)
const l=Jg(e)
l&&c.shelves.unshift(l)
const u=new Tee(c.shelves)
return u.pageRefreshPolicy=new TZ(NC,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null),jn(e,u,c.metricsPageInformation),u}function Jg(e){var t
if(!e.bag.isNaturalLanguageSearchEnabled&&!e.bag.isNaturalLanguageSearchResultsEnabled)return
const n=fl(0,"searchFocusHeader",{signal:{lastNLSQueryDate:e.storage.retrieveString(FD),treatmentId:null!==(t=Ne(e,qv.SearchLandingPage))&&void 0!==t?t:null}},"pullOnly")
return n.refreshUrl=`${hW}:/${yW.searchLandingPage}/${yW.shelf}/?${DW.isSearchFocusHeaderShelf}=true`,n}function Kg(e,t,n){Ng(e,t,n)
const r=new bee(n.shelves)
return o(r.shelves)?null:(jn(e,r,n.metricsPageInformation),r)}async function Zg(e,t){const n=new Cm.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await kp(r,t)
return null===o?Dg(e,t.facets):await async function(e,t){return await _g(e,t)}(r,o)}async function Qg(e,t){return await async function(e,t){return await Bv.context("paginatedSearchResultsPageWithToken",async()=>{const n=Ig(0,t),r=kg(0,t)
if(0===n.length)return await Promise.resolve(Dg(e))
const o=t.metricsOptions.pageInformation
if((0,Nv.isSome)(o)&&(0,Nv.isSome)(null==o?void 0:o.adPageInfo)){const n=y(o.adPageInfo);(0,Nv.isSome)(n)&&(o.adPageInfo=x0.from(e,n),t.metricsOptions.pageInformation=o)}return await Op(e,n).then(async n=>{const o=At(n),s={id:Wx,kind:null,softwareType:null,targetType:Bj,title:MB,pageInformation:t.metricsOptions.pageInformation,locationTracker:t.metricsOptions.locationTracker,idType:kU},a=new YY(mx)
return a.id=Og(),a.isHorizontal=!1,Oh(e,a,s),gh(0,s,MB),Th(s.locationTracker,t.contentOffsetWithinResultsShelf),await Sg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(n=>{const o=Jw(e,s),c=function(e,t,n,r,o=0){let i=function(e){const t=e.bag.searchResultsLearnMoreEditorialId
!(0,Nv.isNothing)(t)&&(null==t||t.length)}(e)
const s=n.builtSearchResults.length,a=n.deferredSearchResults.length>0,c=o+s
if(void 0===i||void 0===t||o>=i||a&&c<i||0===c&&!a)return r.items=n.builtSearchResults,[r]
i-=o,r.items=n.builtSearchResults.slice(0,i)
const l=new YY("searchResultsLearnMoreNotice")
l.isHorizontal=!1
const u=new mee(t)
l.items=[u]
const d=[r,l],f=n.builtSearchResults.slice(i)
if(f.length>0){const e=new YY(mx)
e.impressionMetrics=r.impressionMetrics,e.isHorizontal=!1,e.items=f,d.push(e)}return d}(e,o,n,a,t.contentOffsetWithinResultsShelf),l=new gee(c)
return i(r)&&(r.contentOffsetWithinResultsShelf=yh(s.locationTracker),l.nextPage=r),l.isCondensedSearchLockupsEnabled=e.client.isPhone,l.resultsParentImpressionMetrics=a.impressionMetrics,mh(t.metricsOptions.locationTracker),l.searchClearAction=Mg(e,kG,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l.searchCancelAction=Mg(e,yj,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l})})})}(e,t)}function Xg(e){return ee(e)}function ev(e){const t=[Tq,wq,lB,uH,p_,w_,g_,zG,JV,S$]
return e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}function tv(e,t,n){var r,o
t.includingAgeRestrictions().includingAdditionalPlatforms(Xg(e)).includingAttributes(ev(e)).includingScopedAttributes(vj,[zG]).includingScopedRelationships(Nq,[aH,Tx]).includingScopedRelationships(vj,[Tx]).enablingFeature("editorialItemGroups").usingCustomAttributes(Ue(e)).includingRelationshipsForUpsell(!0),n&&(t.includingAssociateKeys(vj,[QV,qj]),t.includingAssociateKeys(Nq,[qj])),oi(e)&&(t.enablingFeature(MH),t.addingQuery(tV,E$),t.includingScopedRelationships(Vq,[Mq]),t.includingScopedAttributes(Vq,DK)),si(e)&&(t.enablingFeature(mB),n&&t.includingKindsKeys(EV,[o$])),vn(e)&&t.enablingFeature("eiGroupEISelectionOnDevice"),Kt(e,_q)&&t.enablingFeature("adSupport"),t.enablingFeature("heroStyles")
const i=null!==(o=null===(r=e.userDefaults)||void 0===r?void 0:r.bool($b))&&void 0!==o&&o
e.bag.enableDeviceDrivenDiscoveryContent&&i&&t.resourceType===_q&&t.addingQuery("pairedDevices","visionPro")}async function nv(e,t){const n=e.required(n3),i=t.url===xA,a=-1!==t.url.indexOf(yW.todayCardPreview)
if(i)return await n.fetchPage(e,t.url,xee)
if(a){const r=qW.from(t.url)
return r.param(DW.fetchData,XH),await n.fetchPage(e,r.build(),xee)}{const n=function(e){return Xl(e,new Jz(e).forType(_q).withSparseCount(1).withSparseLimit(2))}(e)
tv(e,n,!0)
const i=(0,Nv.isSome)(t.experimentIdHeader)?{"X-Apple-User-Experiment-Ids":t.experimentIdHeader}:void 0
return await async function(e,t,n,i){var a
const c=new qm.FetchTimingMetricsBuilder,u=e.addingFetchTimingMetricsBuilder(c),d=Ln(u,t,{headers:null!=n?n:void 0})
d.then(t=>{Kt(e,_q)&&function(e,t){const n=Xt(e,t,!0)
r(n)||(e.ads.setTimeoutForCurrentOnDeviceAdFetch(t,n),function(e,t,n){e.timeoutManager.setTimeout(t,n)}(e,n,I7))}(e,_q),ac(e,e.user.dsid,t)})
const h=_(d),p=function(e,t){const n={}
if(s(t)){const r=new Jz(e).withIdsOfType(t,Nq).includingAdditionalPlatforms(Xg(e)).includingAttributes(ev(e))
n[Wm.OnboardingCards]=D(Ln(e,r,{}))}Kt(e,_q)&&(n[Wm.Ads]=D(Ew(e,_q))),function(e){const t=Ts(e),n=ar(e,e.bag.todayTabArcadePersonalizationRate)
return t&&n}(e)&&(n[Wm.ODP]=D(async function(e,t){return await async function(e,t,n,r){const o=[t,e.timeoutManager.makePromise(r,void 0)]
return await Promise.race(o).then(e=>e)}(e,async function(e){try{const t=await async function(e,t){if(o(t.user.dsid)){const e=`${k7}: User is currently not signed in.`
throw Bv.unexpectedType(yH,e,null),new Error(e)}try{const n=l((await t.onDeviceRecommendationsManager.performRequest({type:"fetchUseCases",tab:e,dsId:t.user.dsid})).useCases)
if(o(n)){const t=`${k7}: ODP returned no use cases for tab: ${e}`
throw Bv.unexpectedType(yH,t,null),new Error(t)}return n}catch(t){const n=`${k7}: Failed to fetch ODP use cases for tab: ${e}, with error: ${t}`
throw Bv.unexpectedType(yH,n,null),new Error(n)}}(_q,e),n=t.map(async t=>await async function(e,t){try{const n=await async function(e,t){if(o(t.user.dsid))throw new Error(`${k7}: User is currently not signed in.`)
try{return await t.onDeviceRecommendationsManager.performRequest({type:fP,dsId:t.user.dsid,useCase:e})}catch(t){const n=`${k7}: Failed to perform ODP Today recommendation for useCase: ${e}, with error: ${t}`
throw Bv.unexpectedType(yH,n,null),new Error(n)}}(t,e),i=await async function(e,t){const n=l(t[hP])
if(o(n)){const t=`${k7}: ODP returned no candidates for useCase: ${e}`
throw Bv.unexpectedType(yH,t,null),new Error(t)}const i=y(t[fj]),a=n.map(e=>function(e){const t=f(e.id),n=f(e.type)
if(r(t))return
let o,i=[]
switch(n){case zR:i=l(e.candidates).map(e=>f(e.id)).filter(e=>(0,Nv.isSome)(e)),o=vj
break
case sj:o=Nq
break
default:return}let a=[]
if(a.push({id:t,type:o}),s(i)){const e=i.map(e=>({id:e,type:Nq}))
a=a.concat(e)}return new R7(t,o,i,a)}(e)).filter(Nv.isSome)
if(r(i)||o(a)){const t=`${k7}: ODP candidates could not be parsed for useCase: ${e}`
throw Bv.unexpectedType(yH,t,null),new Error(t)}return{candidates:a,metrics:i}}(t,n),a=i.metrics,c=i.candidates
if(0===c.length)return
const u=c[0],d=await async function(e,t,n,r){const o=new Jz(r,t.data,!0).addingQuery(DW.onDevicePersonalizationUseCase,e).addingQuery(DW.filterRecommendable,XH)
Xi(r,o)
try{const i=await Ln(r,o)
return new E7(e,[t],n,i)}catch(e){const n=`${k7}: Failed to fetch Media API data for: ${t.data}, with error: ${e}`
throw Bv.unexpectedType(yH,n,null),new Error(n)}}(t,u,a,e)
return d}catch(n){return void e.console.log(`${k7}: Failed to perform ODP Today recommendation for useCase: ${t}, with error: ${n}`)}}(e,t)),i=(await L(n)).map(e=>e.success?e.value:void 0).filter(Nv.isSome)
return new O7(i)}catch(t){return void e.console.log(`${k7}: Failed to perform ODP for Today recommendations: ${t}`)}}(e),0,I7)}(e)))
const i=e.amsEngagement
if(i&&vn(e)){const e={timeout:1e3,eventType:mK,tab:_q}
n[Wm.AMDData]=D(i.performRequest(e))}return n}(e,null!==(a=null==i?void 0:i.onboardingCardIds)&&void 0!==a?a:[]),w=await ic(e,h,p)
return c.measureModelConstruction(()=>{var t,n
const r=At(w.additionalData[Wm.OnboardingCards]),i=w.additionalData[Wm.Ads],s=w.additionalData[Wm.ODP],a=w.additionalData[Wm.AMDData],c=function(e,t,n,r,i){const s=[]
let a=o(r)
const c=Is(e,t)
let u=0
for(const i of t){if(o(i.contents))continue
const t=As(e,_q,i.contents,!0,c)
i.contents=t.personalizedData,i.onDevicePersonalizationProcessingType=t.processingType
let d=!0
const h={label:i.label,title:i.title,meta:i.meta,date:i.date,onDevicePersonalizationProcessingType:i.onDevicePersonalizationProcessingType,isTodayForAppsModule:Tt(i)}
if(!a){for(const e of r)s.push({type:Pm.EditorialItem,data:e,isDataHydrated:W(e),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]})
d=!1,a=!0,u+=1}for(let t of i.contents){const r=f(t,"meta.personalizationData.onDeviceUseCase")
switch(t.type){case Nq:if((0,Nv.isSome)(r)){const e=null==n?void 0:n.storyData(r);(0,Nv.isSome)(e)&&(t=e)}s.push({type:Pm.EditorialItem,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:[u]}),d=!1,u+=1
break
case vj:const a=l(t,v_)
if(o(a))continue
let f
if((0,Nv.isSome)(r)&&(f=null==n?void 0:n.storyGroupData(r)),(0,Nv.isSome)(f))t=f
else{const n=As(e,_q,a,!0,c)
t[tV].associations[QV][kj]=n.personalizedData,i.onDevicePersonalizationProcessingType=n.processingType}s.push({type:Pm.EditorialItemGroup,data:t,isDataHydrated:W(t),isFirstItemInModule:d,moduleMetadata:{...h},containedAdSlots:Array.from({length:a.length},(e,t)=>t+u)}),d=!1,u+=a.length}}}return s}(e,null!==(n=null===(t=w.primaryPageData.results)||void 0===t?void 0:t.data)&&void 0!==n?n:[],s,r)
return rv(u,c,w.primaryPageData,i,a)})}(e,n,i,t)}}function rv(e,t,n,r,i){return Bv.context(mj,()=>{if(o(t))return null
const a=function(e,t,n,r,o){var i,a,c,u
const d=Un(e,OS,_q,n,null,null!==(i=dn(e,_q,r,t))&&void 0!==i?i:Ys(e,_q,n,null===(a=null==r?void 0:r.onDeviceAd)||void 0===a?void 0:a.positionInfo,t)),f=Ss(e)
d.recoMetricsData=hh(d.recoMetricsData,null,f)
const h=new SZ(t,d,{rootPosition:0,locationStack:[]},Nr(n),gn(0,o))
if(Kt(e,_q)){const n=an(e,_q,!0);(0,Nv.isSome)(n)&&(h.eligibleAdLocations=n.map(e=>e.slot))
for(const t of null!=n?n:[])null===(c=d.adPageInfo)||void 0===c||c.recordAdResponseEventsIfNeeded(e,r,t.shelfIdentifier,t.slot)
if(h.adPlacementBehavior=function(e){let t=Xv.insertIntoShelf
for(const n of e){let e=t
switch(n.type){case Pm.EditorialItem:e=av(n.data)
break
case Pm.EditorialItemGroup:const t=l(n.data,v_)
if(s(t))for(const n of t)if(e=av(n),e!==Xv.insertIntoShelf)break}if(e!==Xv.insertIntoShelf){t=e
break}}return t}(t),(0,Nv.isNothing)(null==r?void 0:r.failureReason)){h.adData=yt(e,null==r?void 0:r.mediaResponse)
const t=null===(u=null==r?void 0:r.onDeviceAd)||void 0===u?void 0:u.positionInfo
if(s(t)){const e=t.slot-1
h.adLocation=e}}}return h}(e,t,n,r,i),c=ov(e,a)
return c.shelves.splice(0,0,fl(0,"todayPageHeader")),c})}function ov(e,t){var n
const r=[],o=function(e,t){switch(e.client.buildType){case RG:case WU:const e=new qW
e.protocol=pW,e.host=MU,e.pathname=`/${yW.todayCardPreview}`
const n=[]
for(const e of t)switch(e.type){case Pm.EditorialItem:n.push(e.data.id)
break
case Pm.EditorialItemGroup:const t=l(e.data.meta,m_)
n.push(`${e.data.id}:[${t.map(e=>e.id).join(",")}]`)}return e.param(DW.ids,n.join(",")),e.param(DW.isTodayFeedPreview,XH),decodeURIComponent(e.build())
default:return null}}(e,t.remainingContent)
let a=Cs(t.remainingContent)
const c=null===(n=t.remainingContent[0])||void 0===n?void 0:n.isFirstItemInModule
for(;a;){const n=t.remainingContent.shift()
if((0,Nv.isNothing)(n)){a=!1
break}const o=Fs(e,t);(0,Nv.isSome)(o)&&r.push(o),t.currentTodayItem=n
let i=null
switch(n.type){case Pm.EditorialItem:i=Ls(e,n,t)
break
case Pm.EditorialItemGroup:i=Ms(e,n,t)}t.currentTodayItem=void 0,(0,Nv.isSome)(i)&&r.push(i)
const s=Fs(e,t);(0,Nv.isSome)(s)&&r.push(s),a=Cs(t.remainingContent)}c&&un(e,r,_q,_q,t.pageInformation)
const u=new xee(r),d=e.bag.tabsStandard.find(e=>e.id===_q),h=f(d,Pq),p=f(d,"image-identifier"),w=(0,Nv.isNothing)(p)||"doc.text.image"===p,g=null!=h?h:e.loc.string("PAGE_TITLE_TODAY")
return u.title=g,u.tabTitle=g,u.titleDetail=w?function(e){const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat")
return e.loc.formatDate(n,t)}(e):void 0,u.shortTitleDetail=w?function(e){const t=new Date
return e.loc.formatDate("MMM d",t)}(e):void 0,u.longTitle=w?function(e){if(!e.client.isPad)return
const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat.IPad")
return e.loc.formatDate(n,t)}(e):void 0,u.feedPreviewUrl=o,s(t.remainingContent)?(t.pageHasDisplayedContent=t.pageHasDisplayedContent||r.some(e=>{s(e.items)}),u.nextPage=t):function(e,t,n){const r=[],o=ul(e)
i(o)&&r.push(o)
const s=e.bag.termsAndConditionsURL
if(i(s)){const t=dl(e,s)
r.push(t)}return r}(e,t.pageInformation,t.locationTracker).forEach(e=>{u.shelves.push(e)}),jn(e,u,t.pageInformation),u}async function iv(e,t){const n=t.pageHasDisplayedContent?6:12
let r=!0,o=0,i=[]
for(;r;){const e=t.remainingContent[o]
switch(e.type){case Pm.EditorialItem:i.push(e.data)
break
case Pm.EditorialItemGroup:i.push(e.data)
const t=l(e.data,v_)
i=[...i,...t]}o++,r=i.length<n&&o<t.remainingContent.length}const s=new Set(i.map(e=>e.id)),a=new Jz(e,i,!0,[QV,qj])
tv(e,a,!1)
const c=await Ln(e,a,{allowEmptyDataResponse:!0}),u={}
for(const e of c.data)u[e.id]=e
for(const e of t.remainingContent)sv(e,u)
return t.remainingContent=t.remainingContent.filter(e=>e.isDataHydrated||!s.has(e.data.id)),t}function sv(e,t){var n,r,o
switch(e.type){case Pm.EditorialItem:s(t[e.data.id])&&(e.data={...e.data,...t[e.data.id]}),e.isDataHydrated=W(e.data)
break
case Pm.EditorialItemGroup:s(t[e.data.id])&&(e.data={...e.data,attributes:null===(n=t[e.data.id])||void 0===n?void 0:n.attributes,relationships:null===(r=t[e.data.id])||void 0===r?void 0:r.relationships,meta:{...e.data.meta,...null===(o=t[e.data.id])||void 0===o?void 0:o.meta}}),e.isDataHydrated=W(e.data)}}function av(e){const t=v(e,fI)
return i(t)&&t?Xv.replaceOrganic:i(t)&&!t?Xv.dropAd:Xv.insertIntoShelf}function cv(e,t){if(i(t.adPageInfo)){const n=y(t.adPageInfo)
s(n)&&(t.adPageInfo=x0.from(e,n))}}function lv(e,t,n,r,o){return Bv.context(eT,()=>Ad(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:n6.LockupIconSmall}))}function uv(e,t,n,o,i,s){return Bv.context("topChartsPageFromApiResponse",()=>{var a
const c=[]
if((0,Uv.isSome)(o))for(const t of o.categories)(0,Uv.isSome)(t.genreId)&&c.push(dv(e,t))
const u=function(e){return l(e,"results.apps").filter(e=>!r(e.data))}(t),d=u.map(r=>function(e,t,n,r,o){return Bv.context("segmentFromData",()=>{const{shortName:i,longName:s}=function(e,t,n){const r=f(t,WH)
let o=f(t,"shortName"),i=f(t,Zq)
if(n!==TK)return{shortName:(0,Uv.unsafeUnwrapOptional)(o),longName:(0,Uv.unsafeUnwrapOptional)(i)}
const s=e.client.isPad
switch(r){case S2:s?(o=e.loc.string("TopCharts.iPadGames.Free.ShortName"),i=e.loc.string("TopCharts.iPadGames.Free.LongName")):(o=e.loc.string("TopCharts.Games.Free.ShortName"),i=e.loc.string("TopCharts.Games.Free.LongName"))
break
case b2:s?(o=e.loc.string("TopCharts.iPadGames.Paid.ShortName"),i=e.loc.string("TopCharts.iPadGames.Paid.LongName")):(o=e.loc.string("TopCharts.Games.Paid.ShortName"),i=e.loc.string("TopCharts.Games.Paid.LongName"))}return{shortName:(0,Uv.unsafeUnwrapOptional)(o),longName:(0,Uv.unsafeUnwrapOptional)(i)}}(e,t,o),a=f(t,WH),c=Un(e,Cy,r,n,`${a} ${s}`),l={rootPosition:0,locationStack:[]},u=[]
let d=0
const h=[]
for(const n of t.data){const t=lv(e,d,n,c,l)
if(t){if(at(e,n,Wv.Charts))continue
u.push(t),bh(l),d++}else h.push(n)}const p=[],w=new YY(dq)
w.items=u,e.featureFlags.isEnabled(aJ),w.title=s,p.push(w)
const g=new Uee(i,s,a,p),v=function(e,t,n,r=null,o,i){return{remainingContent:t,maxPerPage:20,highestOrdinal:0,url:n,metricsPageInformation:o,metricsLocationTracker:i}}(0,h,void 0,t.next,c,l)
return v.metricsPageInformation=c,v.metricsLocationTracker=l,v.highestOrdinal=d,g.nextPage=v,jn(e,g,c),g})}(e,r,t,n,s)).sort((e,t)=>e.chart.localeCompare(t.chart)),h=f(u,"0.href"),p=new qW(h),w=null!==(a=p.query[lH])&&void 0!==a?a:n,g=fv(w,p.query[HN],c),v=function(e,t){return t.every(e=>function(e){switch(e){case I2:case k2:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_TRENDING_CHARTS"):t.every(e=>function(e){switch(e){case O2:case E2:return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_EMERGING_CHARTS"):e.loc.string("PAGE_TITLE_TOP_CHARTS")}(e,d),m=new Gee(w,null==g?void 0:g.ageBandId,v,d,null==g?void 0:g.name,c),y=d.findIndex(e=>e.chart===i)
y>=0&&(m.initialSegmentIndex=y)
const A=e.fetchTimingMetricsBuilder
return(0,Uv.isSome)(A)&&A.decorate(m),m})}function dv(e,t){const n=function(e,t,n=null){let r=new Jz(e).forType(VF).addingQuery(HF,Kq).addingQuery(lH,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)
return n&&(r=r.addingQuery(HN,n)),e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([mq,gq])),r}(e,t.genreId,t.ageBandId),r=t.children.map(t=>dv(e,t))
return new jee(t,ve(e,n).toString(),r)}function fv(e,t,n){for(const r of n){if(t&&r.ageBandId===t||!t&&!r.ageBandId&&r.genreId===e)return r
const n=fv(e,t,r.children)
if(n)return n}return null}async function hv(e,t){const n=wv().map(e=>new zW(e)),i=new qW(t),s=n.find(e=>e.matches(i)).extractParameters(i),a=i.query[DW.genre]||s[DW.genre],c=i.query[DW.chart]||s[DW.chart],l=i.query[DW.charts],u=i.query[DW.ages]
return await async function(e,t,n,i,s){if(o(n)){const e=fc(0,i)
n=void 0!==e?`${i},${e}`:i}else n.includes(i)||(n+=`,${i}`)
const a=new Cm.FetchTimingMetricsBuilder,c=e.addingFetchTimingMetricsBuilder(a),l=hc(c,t,n,s)
let u
return u=pc(e,n,t),await Promise.all([l,u]).then(([n,o])=>a.measureModelConstruction(()=>{const s=Tn(e,o),a=r(s)?mn(t):yn(s)
return uv(c,n,t,s,i,a)}))}(e,a,l,c,u)}async function pv(e,t){const n=Pt(0,t)
if(0===n.length)return await Promise.resolve(new Uee(null,null,null,[]))
let r=new Jz(e,n).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([mq,gq])),e.bag.enableUpdatedAgeRatings&&r.includingAttributes([iq]),await Ln(e,r).then(n=>{const r=Ct(0,t)
return gv(e,n,t,r)})}function wv(e){return[{path:`/{apiVersion}/catalog/{countryCode}/${yW.charts}`,query:[`${DW.genre}`,`${DW.isPPT}?`,`${DW.charts}?`]},{path:`/{countryCode}/${yW.charts}/{platform}/{chartType}/{genre}`,query:[`${DW.chart}`]},{path:`/{countryCode}/${yW.charts}/{platform}/{chart}/{genre}`,query:[`${DW.charts}?`]},{path:`/{countryCode}/${yW.charts}/{platform}`},{path:`/{countryCode}/{platform}/${yW.charts}`},{path:`/{countryCode}/{platform}/${yW.charts}/{genre}`}]}function gv(e,t,n,r){return Bv.context("topChartSegmentFromLookupResponse",()=>{const o=[]
let i=n.highestOrdinal
const s=At(t)
for(const t of s)at(e,t,Wv.Charts)||(o.push(vv(e,i,t,n.metricsPageInformation,n.metricsLocationTracker)),bh(n.metricsLocationTracker),i++)
const a=[]
if(o.length>0){const e=new YY(dq)
e.items=o,a.push(e),r.highestOrdinal=i}const c=new Uee(null,null,null,a)
return c.nextPage=r,c})}function vv(e,t,n,r,o){return Bv.context(eT,()=>Ad(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:n6.LockupIconSmall}))}function mv(e,t){const n=Is(e,[t])
if(i(t.contents)){const r=As(e,"todayWidget",t.contents,!0,n)
t.contents=r.personalizedData}return t}function yv(e,t,n,r,s,a){const c=[]
let l=0,u=0,d=0
for(const a of t.contents){if(z(a)){l++
continue}const t=we(a,wH),f=Cv(e,a,n,r),h=null===f?bv(e,t):[],p=Pv(a),w=[null==f?void 0:f.backgroundColor,1===h.length&&null!==h[0]?h[0].backgroundColor:void 0,ye("1C68E2")].find(e=>void 0!==e)
if(0===h.length&&null===f){u++
continue}const g=Av(e,a,r)
let v=null,m=null,y=null
if(t.length>0&&t[0].type===Vq){const e=j(t[0],Yx)
if(o(e)){d++
continue}y=j(t[0],Kx),v=new Date(e)
const n=j(t[0],Jx)
m=i(n)?new Date(n):null}const A=Io(a)
c.push(new Yee(a.id,g,p,w,be(w),h,Tv(e,a,n,g,s),A===q_,f,y,v,m))}return null!==a&&t.contents.length===l+u+d&&a(`All ${t.contents.length} cards in this ${r?"primary":"secondary"} module were filtered due to being unhydrated (${l}), missing artwork (${u}) or missing metadata (${d})`),c}function Av(e,t,n){let r=j(t,$H)
if(!n){const n=Io(t)
switch(n){case wm.AppOfTheDay:case wm.GameOfTheDay:r=vo(e,t,n,null)}}return r.replace(/\n/g," ")}function Tv(e,t,n,r,i){let a
switch(n){case MN:a=0
break
case yI:a=1
break
case A_:a=2
break
default:a=-1}const c={widgetId:i,size:a,targetId:t.id,name:r},l=encodeURIComponent(JSON.stringify(c))
switch(Ld(0,t)){case e6:const n=we(t,aH),r=s(n)&&1===n.length?n[0]:we(t,wH)[0],i=pe(e,r,Mq)
if(o(i))break
return`${hW}:/${yW.product}/${DW.id}${i.id}?${DW.appEventId}=${r.id}${DW.invalidateWidgetsOnFailure}=true&${DW.metrics}=${l}`
case X5:const a=we(t,wH)[0]
return`${hW}:/${yW.product}/${DW.id}${a.id}?${DW.invalidateWidgetsOnFailure}=true&${DW.metrics}=${l}`
case Z5:return f(B(t,yq),Rq)}return`${hW}:/${yW.story}/${DW.id}${t.id}?${DW.invalidateWidgetsOnFailure}=true&${DW.metrics}=${l}`}function bv(e,t){return t.map(t=>{if(t.type===FH)return null
if(Zd(e,t)){const n=function(e,t){switch(Fr(e,t)){case lz:return mT
case uz:return null
default:return sH}}(e,t)
if((0,Nv.isSome)(n)){const r=Sv(e,t,n)
if((0,Nv.isSome)(r))return qd(e,r,{cropCode:"bb",useCase:n6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}}const n=function(e,t){switch(Fr(e,t)){case lz:return tE
case uz:return nE
default:return Hq}}(e,t),r=Sv(e,t,n),o=function(e,t){const n=Fr(e,t),r=Kd(e)
let o
switch(n){case lz:o=r?"ic":"bb"
break
case uz:o="bb"
break
default:o=r?"ia":"bb"}return o}(e,t)
return qd(e,r,{cropCode:o,useCase:n6.WidgetLockupIcon,allowingTransparency:!0,withJoeColorPlaceholder:!0})}).filter(e=>null!==e)}function Sv(e,t,n){return ot(e,t,Ge(e,t),n)}function Pv(e){var t
const n=B(e,dV)
let r=null
s(n)&&(r=f(n,Zq))
let o=null
const i=we(e,wH)
switch(i.length>0&&(o=j(i[0],Zq)),j(e,dH)){case wm.AppOfTheDay:case wm.GameOfTheDay:return null!==(t=null!=o?o:r)&&void 0!==t?t:""
default:return null!=r?r:""}}function Cv(e,t,n,r,o){let i=null
Io(t)===q_&&(i=function(e,t,n,r){let o=null,i=null
const s=["editorialVideo.storyCardMotion16x9.previewFrame","editorialVideo.storyCenteredMotion16x9.previewFrame","editorialVideo.storeFrontVideo4x3.previewFrame"]
for(const e of s)if(i=B(t,e),(0,Nv.isSome)(i))break
return i&&(o=qd(e,i,{withJoeColorPlaceholder:!0,useCase:n6.WidgetEditorial}),r||(o.crop="sr")),o}(e,t,0,r))
const s=[{artworkKeyPath:gI,crop:"sr"},{artworkKeyPath:Ax,crop:"sr"}]
switch(Io(t)){case wm.AppOfTheDay:case wm.GameOfTheDay:const e=n===MN?AI:"nr"
s.push({artworkKeyPath:u_,crop:r?e:"fn"})
break
case wm.Video:case wm.FullBleedImage:const t=n===MN?TI:bI
s.push({artworkKeyPath:sM,crop:r?t:"fn"})
break
case wm.AppEventCard:const o=n===MN?AI:"nr"
s.push({artworkKeyPath:d_,crop:r?o:"fn"})
break
default:const i=n===MN?TI:bI
s.push({artworkKeyPath:f_,crop:r?i:"fn"})}let a=null
for(const n of s)if(a=qd(e,B(t,n.artworkKeyPath),{cropCode:n.crop,useCase:n6.WidgetEditorial,withJoeColorPlaceholder:!0}),(0,Nv.isSome)(a))break
return null!=a?a:i}async function Iv(e,t){let n
switch(t.family){case 1:n=yI
break
case 2:n=A_
break
default:n=MN}let a=null
return typeof t.originalResponseHash!==wU&&null!==t.originalResponseHash&&""!==t.originalResponseHash&&typeof t.originalResponseDate!==wU&&null!==t.originalResponseDate&&""!==t.originalResponseDate&&(a={hash:t.originalResponseHash,creationDate:t.originalResponseDate}),await async function(e,t,n,a,c){return await new Promise((n,l)=>{if(!function(e,t,n,r){return!r||ar(e,e.bag.todayWidgetLivePreviewRolloutRate)}(e,0,0,a))return void l("No live preview will be shown due to losing the todayWidgetLivePreviewRolloutRate lottery.")
const u=new Kee,d=e=>l(e)
Ln(e,u.make(e)).then(a=>{const l=h(a,fm.contentMaxAge),u=function(e,t){return r(e)||r(e.results)||o(e.results.data)?(t("Unable to create primary module; no results or data."),null):o(e.results.data[0].contents)?(t("Unable to create primary module; no contents."),null):e.results.data[0].contents.length===e.results.data[0].contents.filter(e=>z(e)).length?(t("Unable to create primary module; none of the cards are hydrated."),null):{label:"",title:"",meta:{},contents:e.results.data[0].contents}}(a,d)
if(null===u)return
const f=function(e){const t={label:"",title:"",meta:{},contents:[]}
if(r(e)||r(e.results)||o(e.results.data))return t
const n=e.results.data.slice(1)
return 0===n.length?t:{label:"",title:"",meta:{},contents:n.map(e=>e.contents).reduce((e,t)=>e.concat(t))}}(a),p=function(t,n,r,o,i){const a=(c=JSON.stringify(t.contents.concat(n.contents).map(e=>e.id))+(null!==r?r.toString():""),e.cryptography.hash("sha256",c))
var c
return null!==i&&s(i.hash)&&s(i.creationDate)&&i.hash===a?i:{hash:a,creationDate:(new Date).toUTCString()}}(u,f,l,0,c),w=function(e,t,n){null===n&&e.console.error("No TTL value was found--deferring to JS client for refresh time.")
const r=new Date(t.creationDate)
return r.setSeconds(r.getSeconds()+n),e.console.info(`Media API provided TTL: ${n} so timeline refresh date will be ${r}`),r}(e,p,l),g=mv(e,u),v=mv(e,f),m=function(e,t,n,s,a,c,l,u,d){if(r(t))return d("Unable to create a TodayWidgetContainer; primaryModule is null."),null
const f=yv(e,t,s,!0,u,d)
if(0===f.length)return null
const h=yv(e,n,s,!1,u,null),p=function(e,t,n,r,s,a){const c=De(t),l=Le(c,n),u={}
for(let e=0;e<r.length;e++){const t=e%r.length*2
u[r[e].storyId]=a===A_?s.slice(t,t+2):[]}const d=function(e,t,n){return function(e,r){const o=[],i=[]
return e.forEach(e=>{return void 0!==(r=e).eventStartDate&&null!==r.eventStartDate&&t<De(r.eventStartDate)&&De(r.eventStartDate)<=n?o.push(e):i.push(e)
var r}),[o,i]}(e)}(r,c,n),f=d[0]
let h=d[1]
const p=[...Array(l)].map(()=>[]),w=[...Array(l)].map((e,t)=>new Date(c.getTime()+60*t*60*1e3)),g=new Map
r.concat(s).forEach(t=>{if(i(t.eventStartDate)){const n=gi(t.eventBadgeKind,t.eventStartDate,t.eventEndDate)
g[t.storyId]=vi(e,n,t.eventStartDate,t.eventEndDate)}}),f.forEach(e=>{var t
for(let n=((Le(c,e.eventStartDate)-1)%(t=r.length)+t)%t;n<p.length&&!(e.eventEndDate<=w[n]);n+=r.length)for(let t=0;t<r.length&&!(p.length<=n+t);t++)if(0===p[n+t].length){p[n+t].push(S(e))
for(const r of u[e.storyId])p[n+t].push(S(r))
break}})
for(let e=0;e<p.length;e++){if(p[e].length>0)continue
const t=w[e]
if(h=h.filter(e=>void 0===e.eventEndDate||null===e.eventEndDate||e.eventEndDate>t),0===h.length)break
const n=h.shift()
h.push(n),p[e].push(S(n))
for(const t of u[n.storyId])p[e].push(S(t))}return p.map((e,t)=>{const n=w[t],r=e.map(e=>{const n=g[e.storyId],r=function(e,t){if(o(t))return null
const n=t.filter(t=>null===t.displayFromDate||t.displayFromDate<=e)
return 0===n.length?null:n.pop()}(w[t],n)
return null!==r?(e.heading=r.displayText,e.eventStartDate=r.countdownToDate):e.eventStartDate=null,e})
return new zee(r,n)})}(e,new Date(c.creationDate),l,f,h,s)
return new Wee(p,l,c.creationDate,c.hash)}(e,g,v,t,0,p,w,mI,d)
null!==m&&n(m)}).catch(e=>{l(e)})})}(e,n,t.isSnapshot,t.isPreview,a)}var kv,Ov,Ev,Rv,Dv,_v,Lv,Mv,xv,$v,Fv,Nv,Bv,Uv,Gv,jv,Vv,Hv,qv,Wv,zv,Yv,Jv,Kv,Zv,Qv,Xv,em,tm,nm,rm,om,im,sm,am,cm,lm,um,dm,fm,hm,pm,wm,gm,vm,mm,ym,Am,Tm,bm,Sm,Pm,Cm,Im,km,Om,Em,Rm,Dm,_m,Lm,Mm,xm,$m,Fm,Nm,Bm,Um,Gm,jm,Vm,Hm,qm,Wm,zm,Ym,Jm,Km,Zm,Qm={}
e.r(Qm),e.d(Qm,{downloadingOrdering:()=>K0,downloadingOrderingCompact:()=>Z0,notPurchasedOrdering:()=>Y0,notPurchasedOrderingCompact:()=>J0,notPurchasedSpotlightIndex:()=>q0,purchasedOrdering:()=>W0,purchasedOrderingCompact:()=>z0,purchasedSpotlightIndex:()=>H0}),kv={},e.r(kv),e.d(kv,{downloadingOrdering:()=>o1,downloadingOrderingCompact:()=>i1,notPurchasedOrdering:()=>n1,notPurchasedOrderingCompact:()=>r1,notPurchasedSpotlightIndex:()=>X0,purchasedOrdering:()=>e1,purchasedOrderingCompact:()=>t1,purchasedSpotlightIndex:()=>Q0}),Ov={},e.r(Ov),e.d(Ov,{notPurchasedOrdering:()=>l1,notPurchasedSpotlightIndex:()=>a1,purchasedOrdering:()=>c1,purchasedSpotlightIndex:()=>s1}),Ev={},e.r(Ev),e.d(Ev,{notPurchasedOrdering:()=>h1,notPurchasedSpotlightIndex:()=>d1,purchasedOrdering:()=>f1,purchasedSpotlightIndex:()=>u1}),Rv={},e.r(Rv),e.d(Rv,{notPurchasedOrdering:()=>v1,notPurchasedSpotlightIndex:()=>w1,purchasedOrdering:()=>g1,purchasedSpotlightIndex:()=>p1}),Dv={},e.r(Dv),e.d(Dv,{notPurchasedOrdering:()=>T1,notPurchasedSpotlightIndex:()=>y1,purchasedOrdering:()=>A1,purchasedSpotlightIndex:()=>m1}),_v={},e.r(_v),e.d(_v,{notPurchasedOrdering:()=>C1,notPurchasedSpotlightIndex:()=>S1,purchasedOrdering:()=>P1,purchasedSpotlightIndex:()=>b1}),Lv={},e.r(Lv),e.d(Lv,{notPurchasedOrdering:()=>E1,notPurchasedSpotlightIndex:()=>k1,purchasedOrdering:()=>O1,purchasedSpotlightIndex:()=>I1}),Mv={},e.r(Mv),e.d(Mv,{notPurchasedOrdering:()=>L1,notPurchasedSpotlightIndex:()=>D1,purchasedOrdering:()=>_1,purchasedSpotlightIndex:()=>R1}),xv={},e.r(xv),e.d(xv,{downloadingOrdering:()=>U1,downloadingOrderingCompact:()=>G1,notPurchasedOrdering:()=>N1,notPurchasedOrderingCompact:()=>B1,notPurchasedSpotlightIndex:()=>x1,purchasedOrdering:()=>$1,purchasedOrderingCompact:()=>F1,purchasedSpotlightIndex:()=>M1}),$v={},e.r($v),e.d($v,{downloadingOrdering:()=>Y1,downloadingOrderingCompact:()=>J1,notPurchasedOrdering:()=>W1,notPurchasedOrderingCompact:()=>z1,notPurchasedSpotlightIndex:()=>V1,purchasedOrdering:()=>H1,purchasedOrderingCompact:()=>q1,purchasedSpotlightIndex:()=>j1})
const Xm="AppEventSearchResult",ey="AppSearchResult",ty="com.apple.MobileSMS",ny="com.apple.TVAppStore",ry="com.apple.Arcade",oy="com.apple.AppStore.ProductPageExtension",iy="com.apple.appstorecomponentsd",sy="ContingentOfferDetailPage",ay="ShelfBasedProductPage",cy="EditorialSearchResult",ly="arcadeGroupingLockup",uy="Lockup",dy="arcadeGeneric",fy="OfferItemDetailPage",hy="Screenshots",py="tapToRate",wy="lockupList",gy="TodayCardLockupOverlay",vy="TodayCardMarketingLockupOverlay",my="TodayCardMediaArtwork",yy="TodayCardMediaBrandedSingleApp",Ay="TodayCardMediaList",Ty="TodayCardMediaVideo",by="TodayCardMediaRiver",Sy="TodayCardParagraphOverlay",Py="TodayCardThreeLineOverlay",Cy="TopChartsPage",Iy="ArcadeAction",ky="CompoundAction",Oy="ExternalUrlAction",Ey="OfferAction",Ry="OfferAlertAction",Dy="OfferConfirmationAction",_y="ProductPageScrollAction",Ly="SearchAdAction",My="ShelfBasedPageScrollAction",xy="flowAction",$y="expanded",Fy="continuation",Ny="signup",By="purchases",Uy="donate",Gy="is32bitOnly",jy="requires32bit",Vy="is.workflow.my.app",Hy="com.apple.mobileme.fmf1",qy="iPhone",Wy="iPad",zy="com.apple.NanoCompass.watchkitapp",Yy="com.apple.DeepBreathing",Jy="com.apple.Depth",Ky="com.apple.Mandrake",Zy="SCS.ApDPCS01",Qy="ACTION_SETTINGS",Xy="shareSheet",eA="com.apple.InstallAssistant.",tA="Send Gift",nA="initiate",rA="additionalAdsInfo",oA="EDITORIALTAKEOVER",iA="SLPLOAD",sA="iad.format.text",aA="adsLocaleMetadata",cA="mapiFetchFail",lA="localizationNotAvailable",uA="SHARE_APP_EVENT_SUBTITLE",dA="j:mm",fA="inAppEvent",hA="systemimage://bell.fill",pA="appPromotionTitle",wA="OfferItems.FormattedDate.RedemptionDate.DateFormat",gA="OfferItems.Available.Now",vA="@@date@@",mA="arcade-see-all-games-button",yA="GAME_CENTER",AA="marketingArtwork",TA="seed",bA="upsell",SA="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",PA="PAGE_FACETS_FILTERS_COMING_SOON",CA="PAGE_FACETS_SORT_BY_TITLE",IA="controllerSupport",kA="PAGE_FACETS_INCLUDE_TITLE",OA="000000",EA="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",RA="displayBreakoutMaterial",DA="material",_A="textGradient",LA="plusLight",MA="MMMM d, y",xA="x-as3-internal:/today/test",$A="notificationSettings",FA="invalidateWidgetsOnFailure",NA="PageData",BA="ProductBuilder",UA="contingent-items:branch",GA="contingentItemOffer",jA="contingent-items:association.trunks",VA="trunks",HA="offer-items:salables",qA="discountOffer",WA="fileSizeByDevice",zA="promotionalText",YA="backgroundAssetsInfo",JA="backgroundAssetsInfoWithOptional",KA="installSizeByDeviceInBytes",ZA="editorial-item-shelves",QA="viewEditorialItem",XA="preview",eT="lockupFromApiChartItem",tT="contentRatingsBySystem.appsApple.name",nT="ageRating.value",rT="ageRating.contentLevels",oT="br.l.official",iT="br.l",sT="br.10.official",aT="br.10",cT="br.12.official",lT="br.12",uT="br.14.official",dT="br.14",fT="br.16.official",hT="br.16",pT="br.18.official",wT="br.18",gT="impressionableAppIconFromData",vT="SCB.ApSCBL01",mT="circularIconArtwork",yT="appBinaryTraits",AT="requiresRosetta",TT="iphone5",bT="iphone6",ST="iphone6+",PT="maxEssentialInstallSizeInBytes",CT="maxDownloadSizeInBytes",IT="maxInstallSizeInBytes",kT="editorialArtwork.contentLogoTrimmed",OT="posterCardVideo16x9",ET="enabled",RT="concerns",DT="ACTION_REVIEW_REPORT",_T="TOAST_CONCERN_REPORTED_TITLE",LT="TOAST_CONCERN_REPORTED_DESCRIPTION",MT="systemimage://square.and.pencil",xT="userReviewId",$T="systemimage://hand.thumbsup",FT="systemimage://hand.thumbsdown",NT="guid",BT="formBody",UT="CONTROLLER_RECOMMENDED",GT="NOT_SUPPORTED",jT="CAPABILITY_GAME_CENTER_TITLE",VT="resource://ProductCapabilityGameCenter",HT="safariExtensions",qT="above",WT="hasApps",zT="hasGames",YT="DEVELOPER_APPS_AND_GAMES",JT="DEVELOPER_GAMES",KT="DEVELOPER_APPS",ZT="associations.apps.data",QT="prefersHiddenPageTitle",XT="enrichedEditorialNotes.name",eb="enrichedEditorialNotes.tagline",tb="enrichedEditorialNotes.callToAction",nb="shelf_id",rb="arcadeSeeAllGamesFooter",ob="footer",ib="three",sb="ARCADE_PREORDER_COMING_SOON",ab="REPORT_A_PROBLEM",cb="Shelves.Accessibility.Label",lb="Shelves.Accessibility.RoleDescription",ub="featuredCategories",db="editorialCard",fb="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_GAME",hb="breakoutTall",pb="renderGroupingPage",wb="noPersonalizationAvailable",gb="groupingAppEvent",vb="suppressText",mb="layoutStyle.layoutSize",yb="link.url",Ab="GameCenter.ContinuePlayingShelf.Title",Tb="videoCard",bb="impressionIndex",Sb="Achievements Hero",Pb="inprogress",Cb="gameCenterFriendingViaPush",Ib="legacy",kb="FRIEND_SUGGESTION",Ob="smallContactCard",Eb="INVITE",Rb="FROM_CONTACTS",Db="inviteFriend",_b="removeFriendSuggestion",Lb="friendSuggestion",Mb="redownloadButtonTintUsingOfferTheme",xb="parentShelfItems",$b="displayDeviceDrivenContent",Fb="CategoryGrouping",Nb="null",Bb="smallBreakout",Ub="tagBrick",Gb="advertPressed",jb="offerButtonPress",Vb="insetAd",Hb="MEDRIVER_",qb="iAdIsSpecifiedCreativeUsed",Wb="promotedContent",zb="editorialContext",Yb="Watch",Jb="Messages",Kb="developerName",Zb="firstVersionSupportingInAppPurchaseApi",Qb="widthConstrainedLockup",Xb="OfferButton.Title.Subscribe",eS="descending",tS="editorialItemActionFromData",nS="displaySubStyle",rS="iad.lineItem",oS="clientIdentifierOverride",iS="targetId",sS="contentRestrictionReasons",aS="clientCorrelationKey",cS="media",lS="viewedInfo",uS="viewedInfoDetailed",dS="cookie",fS="ownerDsid",hS="pageExit",pS="trampoline",wS="trampolineContext",gS="widgetContext",vS="iAdOdmlSuccess",mS="ODP_NOAD",yS="APPSTORE_SEARCH_LANDING_PAGE",AS="APPSTORE_TODAY_TAB",TS="APPSTORE_PRODUCT_PAGE",bS="APPSTORE_PRODUCT_PAGE_DOWNLOAD",SS="iAdPageCustomId",PS="contingentItemId",CS="browserChoice",IS="browserChoiceScreenBuy",kS="clip",OS="Today",ES="buttonName",RS="actionContext",DS="selectedPageFacets",_S="Apps",LS="searchGhostHint",MS="didYouMean",xS="displaysArcadeUpsell",$S="franchise",FS="isOnboardingCard",NS="optimizationEntityId",BS="optimizationId",US="iAdEligible",GS="macSoftware",jS="iosSoftware",VS="artist",HS="pending",qS="channelPartner",WS="eligibilityType",zS="upsellScenario",YS="modeType",JS="FreeTrial",KS="PayUpFront",ZS="PayAsYouGo",QS="test",XS="rebuy=true",eP="OfferButton.FlowPreview.Get",tP="OfferButton.FlowPreview.Preorder",nP="preorderedSubscribed",rP="productPageBrowserChoiceSelect",oP="preorderSubscribed",iP="INTRO_PRICE_OFFER_SUBTITLE",sP="Offer.InlineInAppPurchases",aP="OfferButton.ExternalPurchases.Subtitle",cP="weight_parameter",lP="meta.personalizationData.isPinned",uP="meta.personalizationData.segId",dP="OnDeviceRecommendationsPageController",fP="fetchRecommendations",hP="candidates",pP="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",wP="<br><br>",gP="privacyPolicy",vP="PRODUCT_PRIVACY_DEFINITIONS_LINK",mP="privacyDefinitions",yP="ACTION_SEE_DETAILS",AP="USAGE_DATA",TP="systemimage://person.circle",bP="NOT_COMPATIBLE_BANNER",SP="UNSUPPORTED_CAPABILITIES",PP="UNSUPPORTED_WATCHOS_VERSION",CP="experimentLocale",IP="pageCustomId",kP="ProductPage.Section.ScreenshotsPreview.Title",OP="user",EP="reviewsContainer",RP="displayable-kind",DP="urlQuery",_P="editorsChoiceItem",LP="ratingCount",MP="APP_SUPPORT",xP="REVIEWS_MOST_HELPFUL",$P="REVIEWS_MOST_FAVORABLE",FP="REVIEWS_MOST_CRITICAL",NP="recent",BP="REVIEWS_MOST_RECENT",UP="reviewsPageActionFromReviewsData",GP="genreName",jP="BADGE_AGE_RATING_YEARS",VP="BADGE_AGE_RATING",HP="BADGE_PLAYERS_HEADING",qP="{maxPlayers}",WP="BADGE_NO_RATINGS_CAPTION",zP="storefrontContentRating",YP="{subtitle}",JP="webBrowserFlowType",KP="marker",ZP="accessibilityParagraph",QP="prefersReadableContentAlignedTitle",XP="VOICE_CONTROL",eC="AccessibilityDetails.Header.NoLearnMoreLink",tC="AccessibilityDetails.Header.NoLearnMoreLink.NoDeveloperName",nC="ProductPage.Accessibility.Header.NoSupportedFeatures.NoLearnMoreLink",rC="ProductPage.Accessibility.Header.NoReportedFeatures.NoLearnMoreLink",oC="gameCenterPlayerGameAchievementSummary",iC="ProductPage.Section.EditorsNotes.Title",sC="ProductPage.Section.FeaturedIn.Title",aC="largeGameCenterPlayer",cC="hasEula",lC="productMediaItem",uC="createTapToRateProductReviewAction",dC="ProductPage.RatingsAndReviews.Footer.LearnMore",fC="ProductPage.Section.MostRecentVersion.Title",hC="overview",pC="titledParagraph",wC="detail",gC="releaseNotes",vC="ProductPage.Section.Videos.Title",mC="textPair",yC="product-page-info-section",AC="deviceFamily",TC="InfoList.AgeRating.LearnMore",bC="advisories",SC="seventeenPlus",PC="gracRegistrationNumber",CC="twelvePlus",IC="Seller",kC="isTrader",OC="Search.Facets.iPadAndIPhone",EC="Search.Facets.iPhoneOnly",RC="SEARCH_FACET_FREE",DC="SEARCH_FACET_",_C="filter[price]",LC="filter[genre]",MC="filter[ages]",xC="terms",$C="naturalLanguage",FC="results.contents",NC="timeSinceOnScreen",BC="recentSearches",UC="midScrollGuidedSearch",GC="SEARCH_TRANSPARENCY_LINK",jC="rewrite",VC="EDITORIAL_SEARCH_RESULT_TYPE_DEVELOPER_TITLE_CASE",HC="whenInstalled",qC="mixed",WC="guidedLabel",zC="search-revisions",YC="singleColumnList",JC="@@chartPosition@@",KC="developerInfo",ZC="divider",QC="scrollablePill",XC="displayType",eI="appMarkerType",tI="Acquisition",nI="InlineImage",rI="AppLockup",oI="InlineVideo",iI="quote",sI="Small",aI="Medium",cI="Large",lI="itunes.apple.com",uI="meta.personalizationData.optimizationId",dI="meta.personalizationData.optimizationEntityId",fI="meta.personalizationData.replaceIfAdPresent",hI="editorialBackground",pI="MC.ApSCFB01",wI="LCS.ApLCXW01",gI="editorialArtwork.storyCardStatic16x9",vI="UAS.ApXWC01",mI="com.apple.AppStore.Widgets.Today",yI="systemMedium",AI="DCEC.AppWS01",TI="MCGC.AppWS01",bI="MCGC.AppWL01",SI="PersonalizedRecommendations.Toggle.Title",PI="PersonalizedRecommendations.Toggle.Footer",CI="PERSONALIZATION_PURCHASES",II="RECOMMENDATIONS",kI="engagement-data",OI="ArcadeOnboarding",EI="extend",RI="ALL_ARCADE_GAMES",DI="arcadeSubscribePage",_I="release",LI="nonnull",MI="token.pageInformation",xI="token.pageInformation.adPageInfo",$I="token.excludeAttribution",FI="isAppInstalled",NI="token.targetType",BI="token.metricsKind",UI="systemInformation",GI="token.productVariantData",jI="token.inAppEventId",VI="Purchases",HI="gameCenterProfile",qI="OnDeviceRecommendationsPageController:handleShelf not implemented",WI="ProductData",zI="Product page preloading is disabled",YI="lookup",JI="app-bundle",KI="search-recommendation-sections",ZI="trending-contents",QI="TodayData",XI="TodayForApps",ek="Arcade.DownloadPack.Suggestions.GetAllButtonTitle",tk="asString",nk="asNumber",rk="asBoolean",ok="asJSONValue",ik="catalog",sk="engagement",ak="view/see-all",ck="its_qt",lk="adId",uk="prefix",dk="username",fk="password",hk="port",pk="-caseInsensitive",wk="signatureResumption",gk="checkForLongUrl",vk="getPass",mk="certId",yk="hsb",Ak="metrics-identifiers",Tk="advp",bk="itsct",Sk="itscg",Pk="itcCt",Ck="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/accountSummary",Ik="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/redeemLandingPage",kk="IPHONE_BRAND_NAME",Ok="IPAD_BRAND_NAME",Ek="APPLE_TV_BRAND_NAME",Rk="APPLE_WATCH_BRAND_NAME",Dk="MAC_BRAND_NAME",_k="SearchResultsPageIntent",Lk="AppEvent",Mk="ContingentOffer",xk="existing",$k="bundle",Fk="com.apple.visionproapp",Nk="editorial",Bk="InAppPurchaseLockup",Uk="MixedMediaLockup",Gk="PosterLockup",jk="ProductPage",Vk="ScreenshotsLockup",Hk="TrailersLockup",qk="arcadeTabNavBar",Wk="textFollowsTintColor",zk="person.crop.square",Yk="magnifyingglass",Jk="list",Kk="OfferStateAction",Zk="TabChangeAction",Qk="timer",Xk="primaryTerm",eO="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard",tO="isStandaloneWithCompanionForWatchOS",nO="isDeliveredInIOSAppForWatchOS",rO="isXROSCompatible",oO="free",iO="Mac",sO="systemimage://square.and.arrow.up",aO="results.data",cO="accountDetails",lO="createAccount",uO="sendGift",dO="addFunds",fO="Redeem",hO="cppAssetsMissing",pO="customers-also-bought-apps-download",wO="past",gO="module",vO="appPromotion",mO="trunk-app",yO="useTrunkArtwork",AO="editorialArtwork.brandLogo",TO="systemimage://questionmark.circle",bO="comingSoonApps",SO="marketingVideo",PO="supportsSharePlay",CO="filter[ageRating]",IO="filter[supportsGameController]",kO="filter[isMultiplayer]",OO="subscribe",EO="custom",RO="Arcade.Welcome.Family.Button.ExploreArcade",DO="breakoutTextAlignment",_O="left",LO="right",MO="black",xO="arcadeSubscribe",$O="hiddenPurchases",FO="isViewOnly",NO="action.kind",BO="action.url",UO="Goto",GO="standalone-merchandised-in-apps",jO="see-all-contents",VO="requirementsByDeviceFamily",HO="licenses",qO="internetContentProviderInfo",WO="review-summary",zO="categorizations",YO="redownload",JO="future",KO="ageBandId",ZO="customAttributes",QO="appShowcase",XO="placeholderBackground",eE="checksum",tE="circularArtwork",nE="ovalArtwork",rE="iphone_6_5",oE="iphone_d73",iE="iphone_d74",sE="editorialArtwork.splashFullScreen",aE="editorialArtwork.topShelf",cE="customVideoPreviewsByTypeForAd",lE="BreakoutLarge",uE="textColor3",dE="Alert.GenericError.Title",fE="Alert.GenericError.Message",hE="version",pE="decimalPad",wE="siri",gE="hasInAppPurchases",vE="systemGreen",mE="jpeg",yE="DEVELOPER_WATCH",AE="DEVELOPER_LATEST_RELEASE",TE="DEVELOPER_BUNDLES",bE="DEVELOPER_APPLE_ARCADE",SE="arcadeFooter",PE="ignoreITunesShortNotes",CE="editorialNotes.short",IE="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_VIEW",kE="collectionIcons",OE="shelf_page_header",EE="navigationBar",RE="TermsAndConditions.Title",DE="two",_E="ribbonBar",LE="onDevicePersonalization",ME="Genre",xE="collectionModule",$E="collectionLockup",FE="breakoutFullScreen",NE="Browse Categories",BE="hasSeeAll",UE="designTag",GE="editorialStoryCard",jE="nonarcade",VE="isArcade",HE="date",qE="contentGraphicTrimmed",WE="Lockup.Heading.Arcade",zE="userRating.ratingCount",YE="userRating.value",JE="discounts",KE="inAppPurchaseInstall",ZE="item.offer.buyParams",QE="offerId",XE="isVerifiedForAppleSiliconMac",eR="genreNames",tR="data-metrics-impressions-low-latency",nR="exit",rR="hasiAdData",oR="APPSTORE_SEARCH_RESULT_PAGE",iR="overridePageContext",sR="userId",aR="dsId",cR="refAppType",lR="widget",uR="iAdImpressionIndex",dR="iAdRotationCount",fR="metadata",hR="context",pR="BrowserChoice",wR="com.apple.AppStore.clipOverlay",gR="paymentTopicFromBag",vR="overlayClip",mR="offerReleaseDate",yR="buyInitiate",AR="See All",TR="searchOriginatingTerm",bR="recents",SR="undoSpellCorrection",PR="applySpellCorrection",CR="userTypedHint",IR="submit",kR="impressionOptions",OR="impressionParentId",ER="searchGhostHintPrefix",RR="searchGhostHintTermPhase",DR="searchGhostHintTerm",_R="input",LR="meta.metrics",MR="dsid",xR="@@durationCount@@",$R="@@postTrialPriceDuration@@",FR="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",NR="arcade-preorder",BR="preorderedNotSubscribed",UR="confirmation",GR="preorderNotSubscribed",jR="OfferButton.IntroPrice.FreeTrial",VR="discountOwnedParent",HR="discountUnownedParent",qR="use_signals",WR="meta.personalizationData.grpId",zR="editorialItemGroup",YR="DATA_NOT_PROVIDED",JR="PRODUCT_PRIVACY_LEARN_MORE_LINK",KR="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",ZR="privacyDetail",QR="privacyCard",XR="experimentId",eD="helpful",tD="mostHelpfulReviews",nD="wasReset",rD="ratingsDetails",oD="RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS",iD="supportUrl",sD="chartPositions",aD="highMotion",cD="{minPlayers}",lD="{releaseDate}",uD="value",dD="{count}",fD="deviceCompatibility",hD="Offer.Expanded.Title.ComingSoon",pD="externalVersionId",wD="supportsClickEventsOnSwiftUIHostingCell",gD="AccessibilityDetails.Title",vD="ProductPage.Section.Information.Title",mD="ProductPage.Section.Supports.Title",yD="safetyAndComplianceUrl",AD="darkOverlay",TD="productReviewAction",bD="ProductPage.Section.Reviews.MostHelpfulReviews.Title",SD="productRatingsAndReviewsComponent",PD="versionDisplay",CD="standardInformationShelf",ID="InfoList.AgeRating.Title",kD="Install.Size.String",OD="{fileSize}",ED="dataSetId",RD="SEARCH_FACET_ANY_PRICE",DD="SEARCH_FACET_ANY_CATEGORY",_D="SEARCH_FACET_RELEVANCE",LD="kinds",MD="macOSCompatibleIOSApps",xD="clusterId",$D="landing:new-protocol",FD="lastNLSQueryDate",ND="top-apps",BD="showLabelInSearch",UD="guidedToken",GD="secondaryGenreShortDisplayNames",jD="SearchRevisions",VD="{searchTerm}",HD="no-results",qD="ads-result",WD="searchChartsAndCategories",zD="alternateLabel",YD="contentIds",JD="associations.app-events.data",KD="associations.app-events.attributes.forceAppEvent",ZD="mediumAdLockupWithScreenshotsBackground",QD="adItem",XD="condensedAdLockupWithIconBackground",e_="displayTerm",t_="supportsGameController",n_="rankedSecondaryGenre",r_="onDeviceSearchHistory",o_="editorialLink",i_="upsellForNonacquisitionCanvas",s_="arcadeIcons",a_="AppMarker",c_="framedArtwork",l_="isAcquisition",u_="editorialArtwork.dayCard",d_="editorialArtwork.eventCard",f_="editorialArtwork.generalCard",h_="ignoreEditorialArt",p_="headerName",w_="headerBadge",g_="headerTagline",v_="meta.associations.recommendations.data",m_="associations.recommendations.data",y_="todaySection",A_="systemLarge",T_="personalization-data",b_="ACCOUNT_SETTINGS",S_="upsellRecovery",P_="token.metricsPlatformDisplayStyle",C_="https",I_="channel-apps",k_="done",O_="chin",E_="Arcade.DownloadPack.Suggestions.PrimaryButtonTitle",R_="strict",D_="customIconArtwork",__="ratings",L_="suffix",M_="language",x_="OfferItem",$_="com.apple.AppStore",F_="arcadeProductPage",N_="UpdatesLockup",B_="askToBuy",U_="launchRepair",G_="editorialItemCanvas",j_="blue",V_="applewatch",H_="river",q_="Video",W_="FlowAction",z_="pageChange",Y_="originalUrl",J_="updates",K_="checkForPreorders",Z_="meta.discountOffer",Q_="isIOSBinaryMacOSCompatible",X_="presentModal",eL="viewGenre",tL="CONTROLLER_OPTIONAL",nL="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",rL="SIRI_REMOTE_REQUIRED",oL="purchaseHistory",iL="familySharing",sL="manageSubscriptions",aL="push",cL="deepLink",lL="png",uL="events-and-offers",dL="close",fL="redemptionExpirationDate",hL="details",pL="systemBlue",wL="with",gL="personal-recommendations",vL="comingSoon",mL="wordmark",yL="external",AL="Action.OK",TL="messagesScreenshots",bL="supportsFunCamera",SL="supportURLForLanguage",PL="websiteUrl",CL="top-in-app-purchasables",IL="unlistedApps",kL="cabAdSupport",OL="merchandised-in-apps",EL="textColor1",RL="670",DL="roundPrerendered",_L="tvRect",LL="appleWatch_2021",ML="appleWatch_2018",xL="appleWatch",$L="iphone_5_8",FL="editorialArtwork.bannerUber",NL="splashVideo4x3",BL="arcadeShowcase",UL="StoryMedium",GL="systemimage://exclamationmark.circle",jL="application/json",VL="prefersNonStandardBackButton",HL="textOnly",qL="subscriptionHero",WL="interactive",zL="pageHeader",YL="hasChevron",JL="textLightensOnHighlight",KL="hasSeparator",ZL="TwoUp",QL="Asymmetrical",XL="cppData",eM="contingentItems",tM="prefersLargeTitleWhenRoot",nM="singleModule",rM="materialText",oM="arcadeDownloadPackCard",iM="displayCount",sM="editorialArtwork.mediaCard",aM="nonArcade",cM="locked",lM="friendingViaPush",uM="inAppPurchaseTiledLockup",dM="standardApp",fM="platformAttributes.ios.bundleId",hM="abExperiment",pM="editorialBadgeType",wM="editorialPriority",gM="isSubscription",vM="appExtVrsId",mM="parentId",yM="multiple-system-operators",AM="targetType",TM="pageReferrer",bM="crossfireReferral",SM="advertDeviceWindow",PM="cardType",CM="iAdMetadata",IM="SearchFocus",kM="Focus",OM="position",EM="SoftwareBundle",RM="iAdAppStoreClientRequestId",DM="METADATA",_M="iAdMissedOpportunityReason",LM="iAdSlotInfo",MM="customProductPage",xM="prevPage",$M="platformDisplayStyle",FM="application/x-www-form-urlencoded",NM="iAdDuplicateLayoutType",BM="hintsEntity",UM="hint",GM="idType",jM="update",VM="complete",HM="OfferButton.Title.Get",qM="{appName}",WM="notSubscribed",zM="OfferButton.IntroPrice.Trial",YM="size",JM="meta.personalizationData.score",KM="PRODUCT_PRIVACY_TITLE",ZM="{developerName}",QM="privacyType",XM="identifier",ex="systemimage://exclamationmark.triangle",tx="webBrowser",nx="install",rx="text/markdown",ox="chartPosition",ix="BADGE_MFI_HEADING",sx="systemimage://person.crop.square",ax="MMM d, yyyy",cx="watchOS",lx="xrOS",ux="prefersIndirectTouch",dx="PRIVACY_POLICY",fx="ProductPage.Section.SafetyAndCompliance.Title",hx="componentBackgroundStandout",px="APP_STORE_EDITORS_NOTES",wx="framedVideo",gx="search-hints",vx="slp",mx="searchResult",yx="imageWithLabel",Ax="editorialArtwork.storyCenteredStatic16x9",Tx="header-contents",bx="materialGradient",Sx="fractionalWidth",Px="de7bbd8e",Cx="multiplex",Ix="customers-also-bought-apps-with-download-intent",kx="user-reviews",Ox="searchLanding:see-all",Ex="customArtwork",Rx="hash",Dx="dynamic",_x="apps-media-api-edge-host",Lx="guidedSearch",Mx="groupingLockup",xx="actionLinks",$x="message",Fx="productReview",Nx="multiApp",Bx="singleLockup",Ux="purchased",Gx="fields",jx="requiresGameController",Vx="CONTROLLER_REQUIRED",Hx="webView",qx="Account",Wx="search-results",zx="lockupArtwork",Yx="startDate",Jx="endDate",Kx="badgeKind",Zx="eventModule",Qx="inAppEventId",Xx="topic",e$="branch-app",t$="<b>",n$="</b>",r$="<br>",o$="winback",i$="Arcade.SeeAllGames.Button.Title",s$="buy",a$="breakoutCallToActionLabel",c$="target",l$="mixedMediaLockup",u$="personalizationTransparency",d$="editorial-elements",f$="alternate-apps",h$="related-editorial-items",p$="privacy",w$="accessibility",g$="supportedGameCenterFeatures",v$="privacyDetails",m$="round",y$="appleWatch_2022",A$="appleWatch_2024",T$="textColor2",b$="heic",S$="shortEditorialNotes",P$="largeHeroBreakout",C$="mediaPageHeader",I$="editorialNotes.callToAction",k$="ThreeUp",O$="largeImageLockup",E$="personalizationData",R$="systemimage://magnifyingglass",D$="categoryBrick",_$="Lockup.Footer.GamesApp",L$="searchLandingTrendingSection",M$="doNotFilter",x$="onDevicePersonalizationUseCase",$$="customDeepLink",F$="tag",N$="iAdImpressionId",B$="hints",U$="pageContext",G$="refApp",j$="impressionId",V$="NOAD",H$="ad_container",q$="extRefApp2",W$="extRefUrl2",z$="iAdSlotId",Y$="offerType",J$="searchPrefix",K$="ARCADE_PREORDER_LOCKUP_COMING_SOON",Z$="{price}",Q$="checkmark",X$="trial",eF="miniTodayCard",tF="intermediateDetailPage",nF="ProductPage.ReviewSummary.Body.Title",rF="languages",oF="controller",iF="select",sF="allProductReviewActions",aF="productReviewsHeader",cF="LICENSE_AGREEMENT",lF="landing",uF="R8802",dF="genreShortDisplayName",fF="multirooms",hF="textLabel",pF="FullWidth",wF="work",gF="play",vF="develop",mF="app-distribution",yF="ArcadeData",AF="SearchData",TF="attributes",bF="many",SF="developer-other-apps",PF="boolean",CF="textLinksShelf",IF="arcadeComingSoon",kF="false",OF="four-screenshots",EF="appstore",RF="redeem",DF="gift",_F="meta.contingentItemOffer",LF="minimumWatchOSVersion",MF="price",xF="dynamicUI",$F="search-landing",FF="supportsStreamlinedBuy",NF="additionalTerms",BF="secondaryText",UF="toggle",GF="appTrailerLockup",jF="privacyPolicyUrl",VF="charts",HF="types",qF="ipod",WF="inAppPurchaseLockup",zF="pill",YF="unadorned",JF="multiplayer-activities",KF="splashVideo16x9",ZF="splashVideo3x4",QF="screenshotsLockup",XF="EditorialLockupLargeVariant",eN="EditorialLockupMediumVariant",tN="Action.LearnMore",nN="mac-os-compatible-ios-apps",rN="system-apps",oN="xros-apps",iN="prefersOverlayedPageHeader",sN="largeBreakout",aN="canvas",cN="canonicalId",lN="layoutDirection",uN="AllGames",dN="placeholder",fN="rowCount",hN="mediumStoryCard",pN="mso",wN="listItem",gN="com.apple.games",vN="links",mN="genres",yN="named",AN="cardDisplayStyle",TN="actionUrl",bN="impressionQueue",SN="eventVersion",PN="advertRotation",CN="impressionType",IN="softwareType",kN="PREORDER_NOTIFY_MESSAGE",ON="NOT_COMPATIBLE_BANNER_TEMPLATE",EN="{linkTitle}",RN="systemimage://gamecontroller.fill",DN="spacer",_N="rooms",LN="targetPlatform",MN="systemSmall",xN="navigation",$N="few",FN="appEvent",NN="new",BN="appIcon",UN="GET",GN="code",jN="externalUrl",VN="categories",HN="ages",qN="share",WN="minPlayers",zN="maxPlayers",YN="customScreenshotsByTypeForAd",JN="productVideo",KN="EventDetails",ZN="textColor4",QN="toast",XN="roundedRect",eB="singleSelection",tB="arcadeDownloadPackCategories",nB="pageMetrics",rB="sellerInfo",oB="accessibilityDetails",iB="largeLockup",sB="roundedRectPrerendered",aB="ipadPro",cB="ipad_10_5",lB="enrichedEditorialNotes",uB="EditorialLockupLarge",dB="EditorialLockupMedium",fB="isGameCenterEnabled",hB="imessage-apps",pB="lockupSmall",wB="editorial-shelves-collection:contents",gB="posterLockup",vB="editorial-elements:contents",mB="offerItems",yB="largeStoryCard",AB="suggested",TB="arcadeApp",bB="ARCADE_ACTION_TITLE_EXPLORE",SB="EXPLORE",PB="extRefUrl",CB="refUrl",IB="iAdContainerId",kB="trending",OB="BADGE_MFI_SUPPORTED",EB="userRating",RB="arcadeProductPageInlineMessage",DB="productPageInlineMessage",_B="rank",LB="iads",MB="Search Results",xB="coercedValue",$B="appletv",FB="arcadeTabHeader",NB="disabled",BB="always",UB="menuItem",GB="actionType",jB="location",VB="back",HB="LearnMore",qB="badge",WB="branch",zB="salables",YB="releaseDate",JB="Games",KB="comingSoonGrouping",ZB="isCanvasAvailable",QB="versionHistory",XB="ipadPro_2018",eU="ipad_11",tU="expectedReleaseDate",nU="watch-apps",rU="atv-apps",oU="editorial-shelves-header",iU="primary-contents",sU="badge-content",aU="Horizontal",cU="lightOverArtwork",lU="mediumImageLockup",uU="editorial_id",dU="meta.personalizationData.appId",fU="achievement",hU="todayBrick",pU="medium",wU="undefined",gU="subscribed",vU="click",mU="pageFields",yU="pageUrl",AU="contentRating",TU="hostApp",bU="pageDetails",SU="{title}",PU="NOT_COMPATIBLE_BANNER_LINK_TITLE",CU="compatibilityAnnotation",IU="ppid",kU="relationship",OU="allProductReviews",EU="tapToRateProductReviewAction",RU="writeAReviewProductReviewAction",DU="notPurchasedRatingsAndReviews",_U="purchasedRatingsAndReviews",LU="Any",MU="apps.apple.com",xU="apps-and-games",$U="eula",FU="host",NU="inAppPurchase",BU="hero",UU="story",GU="NO_BADGE",jU="term",VU="isFirstPartyHideableApp",HU="iap",qU="remoteControllerRequirement",WU="internal",zU="APPLOCKUP",YU="productArtwork",JU="recurringSubscriptionPeriod",KU="numOfPeriods",ZU="@@count@@",QU="arcadeSeeAllGames",XU="upsellBreakout",eG="topCharts",tG="width",nG="Hero",rG="POST",oG="mac-apps",iG="ios-apps",sG="brick",aG="showExpectedReleaseDate",cG="editorialNotes.badge",lG="editorialCopy",uG="href",dG="editorialBadgeInfo",fG="iAdPlacementId",hG="iAdId",pG="SearchLanding",wG="userProductReviews",gG="discover",vG="customers-also-bought-apps",mG="bundleParents",yG="textCards",AG="isStandaloneForWatchOS",TG="chartHref",bG="description.standard",SG="annotation",PG="number",CG="iad",IG="contexts",kG="clear",OG="height",EG="previewFrame",RG="debug",DG="supportsArcade",_G="one",LG="tvOS",MG="pageId",xG="actionDetails",$G="{osVersion}",FG="editorsChoiceProductReviews",NG="bundleChildren",BG="tvos",UG="tabs",GG="dismiss",jG="priceFormatted",VG="offerName",HG="bgColor",qG="deviceFamilies",WG="prefersLargeTitle",zG="editorialClientParams",YG="heroCarousel",JG="facet",KG="query",ZG="iAdTemplateType",QG="offers",XG="create",ej="detailPage",tj="rating",nj="Achievements",rj="linkableText",oj="notPurchasedLinks",ij="generic",sj="editorialItem",aj="brandedSingleApp",cj="finance",lj="buyParams",uj="transparent",dj="upsellMarketingItem",fj="metrics",hj="videoPreviewsByType",pj="{learnMoreLink}",wj="colored",gj="tagline",vj="editorial-item-groups",mj="renderPage",yj="cancel",Aj="other",Tj="inAppPurchases",bj="subscriptions",Sj="trailing",Pj="paragraph",Cj="todayCard",Ij="protocol",kj="data",Oj="latest-release-app",Ej="tile",Rj="eventType",Dj="pageType",_j="productReviewsFooter",Lj="category",Mj="presentModalFormSheet",xj="editorialElementKind",$j="screenshotsByType",Fj="grouping",Nj="reviewSummary",Bj="SearchResults",Uj="short",Gj="appletvos",jj="flowPreview",Vj="editorialNotes.name",Hj="editorialNotes.tagline",qj="editorial-cards",Wj="token",zj="genreDisplayName",Yj="image",Jj="purchasedLinks",Kj="iOS",Zj="object",Qj="developers",Xj="its_contentId",eV="pathname",tV="meta",nV="view",rV="No page routes specified",oV="searchLanding",iV="contingent-items",sV="text/x-apple-as3-nqml",aV="marketing-items",cV="color",lV="tags",uV="expectedReleaseDateDisplayFormat",dV="editorialNotes",fV="type",hV="gameCenter",pV="smallStoryCard",wV="Search",gV="completed",vV="card",mV="Software",yV="overlay",AV="web",TV="groupings",bV="rgb",SV="adamId",PV="collections",CV="collection",IV="fractionalHeight",kV="text/plain",OV="macOS",EV="offer-items",RV="challenges",DV="open",_V="editorialQuote",LV="mostRecentVersion",MV="platform",xV="sort",$V="artistName",FV="arcade-apps",NV="preorder",BV="impressions",UV="text",GV="realityDevice",jV="productPage",VV="preorderDisclaimer",HV="xros",qV="never",WV="children",zV="isAppleWatchSupported",YV="multiplayer",JV="requiredCapabilities",KV="ACTION_SEE_ALL",ZV="osx",QV="recommendations",XV="absolute",eH="grid",tH="featuredIn",nH="account",rH="productPageYMALDuringDownload",oH="product",iH="compatibilityControllerRequirement",sH="iconArtwork",aH="primary-content",cH="ignoredValue",lH="genre",uH="minimumOSVersion",dH="displayStyle",fH="kind",hH="macRequiredCapabilities",pH="leaderboards",wH="card-contents",gH="productRatings",vH="subtitle",mH="searchTerm",yH="defaultValue",AH="editorsChoice",TH="infer",bH="accessibilityDeveloperLink",SH="accessibilityHeader",PH="developer",CH="coercible",IH="accessibilityFeatures",kH="moreByDeveloper",OH="privacyFooter",EH="videos",RH="hasMacIpaPackage",DH="Room",_H="games",LH="small",MH="appEvents",xH="informationRibbon",$H="label",FH="in-apps",NH="productPageYMAL",BH="editorial-pages",UH="action",GH="privacyTypes",jH="video",VH="mediumLockup",HH="similarItems",qH="messages",WH="chart",zH="searchResults",YH="privacyHeader",JH="white",KH="swoosh",ZH="capabilities",QH="light",XH="true",eq="isPreorder",tq="friendsPlaying",nq="Arcade",rq="none",oq="bundleId",iq="ageRating",sq="sequential",aq="search",cq="article",lq="its_id",uq="large",dq="smallLockup",fq="center",hq="description",pq="ios",wq="editorialVideo",gq="ipad",vq="default",mq="iphone",yq="link",Aq="information",Tq="editorialArtwork",bq="reviews",Sq="string",Pq="title",Cq="achievements",Iq="topLockup",kq="dark",Oq="header",Eq="inline",Rq="url",Dq="unknown",_q="today",Lq="screenshots",Mq="app",xq="app-bundles",$q="pad",Fq="vision",Nq="editorial-items",Bq="lockup",Uq="leading",Gq="static",jq="phone",Vq="app-events",Hq="artwork",qq="arcade",Wq="standard",zq="watch",Yq="mac",Jq="contents",Kq="apps",Zq="name",Qq="button",Xq="navigate",eW="page",tW="$kind",nW="shelf"
Fv=e(8706),Nv=e(5542),Bv=e(4172),Uv=e(2450)
const rW={}
class oW{static createSharedMetricsReferralContext(e){oW.shared||(oW.shared=new oW(e))}constructor(e){this.currentReferral=null,this.isMetricsReferralContextRequired=!0,this.isEventDetailClickEventOverrideNecessary=!e.host.isOSAtLeast(16,2,0)}get shouldUseJSReferralData(){return this.isMetricsReferralContextRequired&&i(this.currentReferral)}get activeReferralData(){return this.shouldUseJSReferralData&&null!==this.currentReferral&&this.currentReferral.isActive?this.currentReferral.data:null}setReferralDataForProduct(e,t){var n,o,i
if(!this.isMetricsReferralContextRequired||r(t))return
const s=null!==(n=f(t,Mq))&&void 0!==n?n:null,a=null!==(o=f(t,jN))&&void 0!==o?o:null,c=null!==(i=g(t,fH))&&void 0!==i?i:null
this.currentReferral={id:`${e}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,kind:c,refUrl:null},isActive:!1,productPageExtensionInfo:null}}setReferralDataForProductPageExtensionIfNecessary(e){var t,o
if(!this.isMetricsReferralContextRequired)return
const i=f(e,MG),s=f(e,G$)
if(!iW.isProductPageExtension(e)||!iW.isValidPageEvent(e)||r(i)||r(s))return
const a=null!==(t=f(e,PB))&&void 0!==t?t:null,c=f(e,cR)
let l
switch(c){case pS:l=y(n(e,wS))
break
case lR:l=y(n(e,gS))
break
default:l={}}const u=null!==(o=f(e,CB))&&void 0!==o?o:null
this.currentReferral={id:`${i}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,refUrl:u,kind:{name:c,context:l}},isActive:!1,productPageExtensionInfo:{productId:i}},this.addReferralContextToMetricsFieldsIfNecessary(e)}beginReferralContextForPageIfNecessary(e){this.isMetricsReferralContextRequired&&iW.isValidPageEvent(e)&&iW.isReferralForEvent(this.currentReferral,e)&&null!==this.currentReferral&&(this.currentReferral.isActive=!0)}endReferralContextIfNecessaryForPageEvent(e){this.isMetricsReferralContextRequired&&iW.isValidPageEvent(e)&&iW.isReferralForEvent(this.currentReferral,e)&&(this.currentReferral=null)}addReferralContextToMetricsFieldsIfNecessary(e){var t
this.isMetricsReferralContextRequired&&(e[oW.referralContextEventField]=null===(t=this.currentReferral)||void 0===t?void 0:t.id)}removeReferralContextInfoFromMetricsEvent(e){this.isMetricsReferralContextRequired&&delete e[oW.referralContextEventField]}addReferralDataToEventIfNecessary(e){if(!r(this.activeReferralData)&&iW.shouldAddReferralDataToEvent(e)&&(!iW.isEventDetailsClickEvent(e)||this.isEventDetailClickEventOverrideNecessary)&&(iW.isEventDetailsClickEvent(e)&&(e[Dj]=KN),e[G$]=this.activeReferralData.extRefApp2,e[PB]=this.activeReferralData.extRefUrl2,s(this.activeReferralData.refUrl)&&(e[CB]=this.activeReferralData.refUrl),null!==this.activeReferralData&&null!==this.activeReferralData.kind))switch(e[cR]=this.activeReferralData.kind.name,e[cR]){case pS:e[wS]=this.activeReferralData.kind.context
break
case lR:e[gS]=this.activeReferralData.kind.context}}}oW.referralContextEventField="referralContextId"
class iW{static isProductPageExtension(e){return f(e,Mq)===iW.productPageExtensionAppId}static isValidPageEvent(e){const t=f(e,Dj)
return!(0,Nv.isNothing)(t)&&iW.validPageEventTypes.has(t)}static isReferralForEvent(e,t){var n
if(r(e))return!1
const o=t[oW.referralContextEventField],s=f(t,MG)
return i(o)?o===e.id:!(!iW.isProductPageExtension(t)||!i(s))&&s===(null===(n=null==e?void 0:e.productPageExtensionInfo)||void 0===n?void 0:n.productId)}static shouldAddReferralDataToEvent(e){return e.eventType!==vU||this.isEventDetailsClickEvent(e)}static isEventDetailsClickEvent(e){if(e.eventType!==vU)return!1
const t=e.location,n=null==t?void 0:t[0]
return i(n)&&n.locationType===KN}}iW.productPageExtensionAppId=oy,iW.eventDetailsPageType=KN,iW.validPageEventTypes=new Set([mV,EM,iW.eventDetailsPageType]),Gv=e(900)
class sW{constructor(e){this.$kind="ActionMetrics",this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}const aW={AdInteractionAction:"AdInteractionAction",AdTransparencyAction:"AdTransparencyAction",AlertAction:"AlertAction",AppLaunchTrampolineAction:"AppLaunchTrampolineAction",ArcadeAction:Iy,ArcadeLaunchAttributionAction:"ArcadeLaunchAttributionAction",ArcadePackOfferAction:"ArcadePackOfferAction",ArcadeSeeAllGamesPageSegmentChangeAction:"ArcadeSeeAllGamesPageSegmentChangeAction",ArcadeSubscriptionStateAction:"ArcadeSubscriptionStateAction",BlankAction:"BlankAction",CancelPreorderAction:"CancelPreorderAction",ClearAppUsageDataAction:"ClearAppUsageDataAction",ClearSearchHistoryAction:"ClearSearchHistoryAction",CompoundAction:ky,CopyTextAction:"CopyTextAction",CreateCalendarEventAction:"CreateCalendarEventAction",CrossfireReferralAction:"CrossfireReferralAction",EngagementToggleAction:"EngagementToggleAction",ExternalUrlAction:Oy,FamilyCircleAction:"FamilyCircleAction",FlowAction:W_,FlowBackAction:"FlowBackAction",GameCenterAchievementsAction:"GameCenterAchievementsAction",GameCenterDashboardAction:"GameCenterDashboardAction",GameCenterDenylistPlayerAction:"GameCenterDenylistPlayerAction",GameCenterInvitePlayerAction:"GameCenterInvitePlayerAction",GameCenterPlayerProfileAction:"GameCenterPlayerProfileAction",GSKWrappedAction:"GSKWrappedAction",GuidedSearchTokenToggleAction:"GuidedSearchTokenToggleAction",HttpAction:"HttpAction",HttpTemplateAction:"HttpTemplateAction",InAppPurchaseAction:"InAppPurchaseAction",InvalidateAllWidgetsAction:"InvalidateAllWidgetsAction",LegacyGameCenterInvitePlayerAction:"LegacyGameCenterInvitePlayerAction",OfferAction:Ey,OfferAlertAction:Ry,OfferConfirmationAction:Dy,OfferStateAction:Kk,OpenAppAction:"OpenAppAction",OpenGamesUIAction:"OpenGamesUIAction",PageFacetsChangeAction:"PageFacetsChangeAction",PageTabChangeAction:"PageTabChangeAction",ProductPageScrollAction:_y,RateLimitedAction:"RateLimitedAction",ReportConcernAction:"ReportConcernAction",ReviewSummaryReportConcernAction:"ReviewSummaryReportConcernAction",ScrollingAlertAction:"ScrollingAlertAction",SearchAction:"SearchAction",SearchAdAction:Ly,SearchEntityChangeAction:"SearchEntityChangeAction",SearchSegmentChangeAction:"SearchSegmentChangeAction",SelectAppAction:"SelectAppAction",ShareSheetAction:"ShareSheetAction",SheetAction:"SheetAction",ShelfBasedPageScrollAction:My,ShowSettingsAction:"ShowSettingsAction",TabBadgeAction:"TabBadgeAction",TabChangeAction:Zk,WriteReviewAction:"WriteReviewAction"},{FlowAction:cW,...lW}=aW,uW={...lW,flowAction:xy}
class dW{constructor(){this.title=void 0,this.artwork=void 0,this.presentationStyle=[],this.actionMetrics=new sW}}class fW extends dW{constructor(){super(...arguments),this.$kind="BlankAction",this.actionClass="BlankAction"}}const hW="x-as3-internal",pW=C_,wW="itms-apps",gW=ny,vW=ry,mW="appstore-ui",yW={shelf:nW,store:"WebObjects/MZStore.woa/wa",storeElements:"WebObjects/MZStoreElements.woa/wa",lookup:YI,docTypeLookup:"docTypeLookup",install:nx,grouping:"viewGrouping",viewArtist:"viewArtist",viewSoftware:"viewSoftware",today:_q,arcade:qq,arcadeUpsellPreview:"arcadeUpsellPreview",arcadeSeeAllGames:QU,arcadeSeeAllGamesLoadMore:"arcadeSeeAllGamesLoadMore",genre:lH,viewGenre:eL,recommendationsSeeAll:"recommendationsSeeAll",screenshots:Lq,room:"viewRoom",multiRoom:"viewMultiRoom",charts:VF,product:Mq,game:"game",siri:wE,productBundle:JI,developer:PH,artist:VS,ratings:__,reviews:bq,viewReviews:"viewContentsUserReviews",personalizedReviews:"personalizedReviews",article:cq,story:UU,editorialItem:sj,viewEditorialItem:QA,todayCardPreview:"todayCardPreview",mso:pN,resetAndRedirect:"resetAndRedirect",account:nH,personalizationTransparency:u$,href:uG,eula:$U,tvEula:"tv-eula",privacyPolicy:gP,safetyCompliance:"safety-compliance",appsForYou:"apps-for-you",storeFront:"storeFront",tab:"tab",searchLandingPage:"searchLandingPage",searchTrendingApps:"searchTrendingApps",privacyDetail:ZR,privacyDefinitions:mP,reportAProblem:"reportaproblem.apple.com/store",gameCenterProfile:HI,onDeviceRecommendations:"onDeviceRecommendations",editorialPage:"editorialPage",accessibilityDetails:oB,test:QS,shelfTypes:"shelfTypes",groupingTest:Fj,builtIn:"builtIn",shelfTextTest:"shelfText",shelfLockupsTest:"shelfLockups",shelfMiscTest:"shelfMisc",lockupTest:"lockupTest",articleTestArtwork:"articleArtworkTest",articleTestSingleAppIcon:"articleSingleAppIconTest",articleTestSingleAppIconHeroArt:"articleSingleAppIconHeroArtTest",articleTestBrandedApp:"articleBrandedAppTest",articleTestMultiAppTwo:"articleMultiAppTwoTest",articleTestMultiAppThree:"articleMultiAppThreeTest",articleTestGrid:"articleGridTest",articleTestInAppPurchase:"articleInAppPurchaseTest"},AW="storepreview.apple.com",TW=oH,bW=DI,SW=QU,PW="familyCircle",CW="spamBlockingExtensions",IW=HT,kW="launchApp",OW="sharePlayApps",EW="buddyOnboarding",RW=new Set([AW,"preview.apps.apple.com"]),DW={id:"id",ids:"ids",productVariantID:IU,countryCode:"cc",language:"l",featuredContentId:"fcId",fetchData:"fetchData",isTodaySection:"isTodaySection",isTodayFeedPreview:"isTodayFeedPreview",genre:lH,bundleIdentifier:"bundleIdentifier",bundleId:oq,offerName:VG,charts:VF,ages:HN,chart:WH,types:HF,v0:"v0",action:UH,type:fV,context:hR,isArcade:VE,isSubscribed:"isSubscribed",isTrialAvailable:"isTrialAvailable",isTrialEnrolled:"isTrialEnrolled",groupingFeaturedContentId:"groupingFeaturedContentId",editorialPageShelfType:"editorialPageShelfType",nativeGroupingShelfId:"nativeGroupingShelfId",isArcadeSeeAllGamesShelf:"isArcadeSeeAllGamesShelf",isGameCenterActivityFeedShelf:"isGameCenterActivityFeedShelf",isGameCenterPlayerShelf:"isGameCenterPlayerShelf",isGameCenterPlayerRibbonItem:"isGameCenterPlayerRibbonItem",isGameCenterAchievementsShelf:"isGameCenterAchievementsShelf",isGameCenterContinuePlayingShelf:"isGameCenterContinuePlayingShelf",isGameCenterPopularWithYourFriendsShelf:"isGameCenterPopularWithYourFriendsShelf",isGameCenterSuggestedFriendsShelf:"isGameCenterSuggestedFriendsShelf",isGameCenterReengagementShelf:"isGameCenterReengagementShelf",isOnDeviceRecommendationsShelf:"isOnDeviceRecommendationsShelf",isOnDeviceSearchHistoryShelf:"isOnDeviceSearchHistoryShelf",isSearchFocusHeaderShelf:"isSearchFocusHeaderShelf",isArcadeDownloadPackShelfPlaceholder:"isArcadeDownloadPackShelfPlaceholder",onDeviceRecommendationsUseCase:"onDeviceRecommendationsUseCase",onDevicePersonalizationUseCase:x$,isPurchasesApp:"isPurchasesApp",isViewOnly:FO,includeUnlistedApps:"includeUnlistedApps",enabled:ET,href:uG,recoMetrics:"recoMetrics",showingFallbackMedia:"showingFallbackMedia",path:"path",useReleaseId:"useReleaseId",clientIdentifierOverride:oS,subscribePageMessage:$x,editorialItem:sj,askToBuyId:"askToBuyId",appId:"appId",isPPT:"isPPT",sort:xV,grouping:Fj,code:GN,includePostSubscribeAttribution:"includePostSubscribeAttribution",campaignToken:"ct",providerToken:"pt",qToken:ck,advertisementId:lk,token:Wj,parseContext:"parseContext",privacyTypeId:"privacyTypeId",requestDescriptor:"requestDescriptor",ageRating:iq,controllerSupport:IA,multiplayerSupport:"multiplayerSupport",comingSoon:vL,binCompatGames:"binCompatGames",gamePreviews:"gamePreviews",offerHints:"offerHints",invalidateWidgetsOnFailure:FA,metrics:fj,appEventId:"eventid",offerItemId:"offerItemId",appEventDeepLink:cL,useCaseShort:"uc",collectionId:"collection-id",seedId:"seed-id",isShelfWithAd:"isShelfWithAd",shelfWithAdPlacementType:"shelfWithAdPlacementType",shelfRefreshType:"refreshType",isPreloading:"isPreloading",name:Zq,shelfType:"shelfType",shelfId:"shelfId",onbaordingCardIds:"onboardingCardIds",preview:XA,todayCardConfig:"todayCardConfig",experimentId:XR,shortEditorialNotes:S$,arcadeSubscriptionStatus:"subscriptionStatus",webBrowser:tx,webBrowserFlowType:JP,editorialPageId:"editorialPageId",editorialCardId:"filter[canvas:cardId]",filterRecommendable:"filter[recommendable]",deviceFamily:AC},_W="inAppPurchaseId",LW="productUrl",MW=gM,xW="minExternalVersionId",$W=SV,FW=xV,NW="availableAdamIds",BW=Mq,UW=bq,GW="productPageSimilarItems",jW=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,VW=/([^=?&]+)=?([^&]*)/g,HW=[Rx,KG,eV,FU]
class qW{constructor(e){if(this.query={},!e)return
let t=e
const n=jW.exec(e)
if(n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:void 0}
for(const e of HW){if(!r.remainder)break
switch(e){case Rx:r=b(r.remainder,"#",L_),this.hash=r.result
break
case KG:r=b(r.remainder,"?",L_),r.result&&(this.query=qW.queryFromString(r.result))
break
case eV:r=b(r.remainder,"/",L_),r.result&&(this.pathname="/"+r.result)
break
case FU:if(r.remainder){const e=b(r.remainder,"@",uk),t=e.result,n=e.remainder
if(t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this
switch(e===KG&&typeof t===Sq&&(t=qW.queryFromString(t)),e){case Ij:this.protocol=t
break
case dk:this.username=t
break
case fk:this.password=t
break
case hk:this.port=t
break
case eV:this.pathname=t
break
case KG:this.query=t
break
case Rx:this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case Ij:return this.protocol
case dk:return this.username
case fk:return this.password
case hk:return this.port
case eV:return this.pathname
case KG:return this.query
case Rx:return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if(e===KG)typeof t===Sq&&(t=qW.queryFromString(t)),r=typeof n===Sq?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if(e===eV){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(eV,e)}pathExtension(){var e
if((0,Uv.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}popPathComponent(){if(!this.pathname)return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),this.query&&Object.keys(this.query).length&&(e+="?"+qW.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=VW.exec(e)
for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=VW.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new qW(e)}static fromComponents(e,t,n,r,o){const i=new qW
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}const WW=[pW,wW,"itms-appss","itms-messages","itms-messagess","itms-watch","itms-watchs","macappstore","macappstores","com.apple.tvappstore",gW,vW]
class zW{constructor(e){var t
this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={}
return e.forEach((e,n)=>{I(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[]
if(!e)return t
for(const n of e){const e=n.split("=")
let r=e[0]
const o=-1!==r.indexOf("?")
r=r.replace("?","")
const i=-1!==r.indexOf(pk)
r=r.replace(pk,"")
let s=null
e.length>1&&(s=decodeURIComponent(e[1])),t.push({key:r,value:s,optional:o,caseInsensitive:i})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map(function(e){return new zW(e)}):this._exclusions=null}matches(e){var t,n
if(this._regex){if(!this._regex.length)return!1
let t=!1
for(const n of this._regex)if(n.test(e.toString())){t=!0
break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1
if(this._hostName&&e.host!==this._hostName)return!1
if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents()
if(t.length!==n.length)return!1
const r=t.length
for(let e=0;e<r;e++){const r=t[e]
if(!I(r)&&r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1
if(this._query)for(const r of this._query){let o
if(r.caseInsensitive)for(const[n,i]of Object.entries(null!==(t=e.query)&&void 0!==t?t:{}))r.key.toLocaleLowerCase()===n.toLocaleLowerCase()&&(o=i)
else o=null===(n=e.query)||void 0===n?void 0:n[r.key]
if(!o&&!r.optional)return!1
if(r.value&&r.value!==o)return!1}if(this._hash&&e.hash!==this._hash)return!1
if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?")
if(t.matches(e))return!1}return!0}extractParameters(e){var t,n
const r={}
if(null!==this._pathComponents&&null!==this._pathParameterMap){const t=e.pathComponents()
for(const e of Object.keys(this._pathParameterMap)){const n=k(e),o=O(t[this._pathParameterMap[e]],e)
r[n]=decodeURIComponent(o)}}if(this._query)for(const o of this._query)r[o.key]=null!==(n=null===(t=e.query)||void 0===t?void 0:t[o.key])&&void 0!==n?n:void 0
return r}}class YW{constructor(){this._routeMappings=[]}associate(e,t){const n=[]
for(const t of e)n.push(new zW(t))
this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===Sq?new qW(e):e
t=function(e){let t=typeof e===Sq?new qW(e):e
if(!C(t))return t
const n=t.query,r=null==n?void 0:n[Rq]
return(!t.host||0===t.host.length)&&null!=r&&(t=new qW(r),(null==n?void 0:n[MR])&&(t=t.append(KG,{dsid:n[MR]})),(null==n?void 0:n[wk])&&(t=t.append(KG,{signatureResumption:n[wk]}))),qW.fromComponents(pW,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){var t,n,r
const o=typeof e===Sq?new qW(e):e
if(!C(o))return o
const i=o.build()
let s,a=(0,Uv.isNothing)(o.query)?void 0:S(o.query)
const c={},l=[{key:"MZSearch.woa",action:aq},{key:aq,action:aq},{key:"buyLandingPage",action:DF},{key:"buyCharityGiftWizard",action:Uy},{key:"longUrlHandler",action:gk},{key:K_,action:K_}],u={"accessory-lookup":"accessoryLookup","finance-app":nH,viewEula:$U,software:Kq,primaryTerm:aq}
let d=!1
for(const e of Object.keys(c))if(o.host&&-1!==o.host.indexOf(e)){d=!0,s=c[e]
break}let f=!1
for(const e of l){const t=e.key
if(o.pathname&&-1!==o.pathComponents().indexOf(t)){f=!0,s=e.action,void 0!==(null==a?void 0:a[t])&&delete a[t]
break}}for(const e of Object.keys(u)){const r=void 0!==(null===(t=o.query)||void 0===t?void 0:t[e])&&null!==o.query[e],i=(null===(n=o.query)||void 0===n?void 0:n[UH])&&-1!==o.query[UH].indexOf(e)
if(r||i){s=u[e],void 0!==(null==a?void 0:a[e])&&delete a[e]
break}}if(s===nH&&-1!==i.indexOf(vk)&&(s="addToPassbook",void 0!==a&&delete a[vk]),s){const e=null,t=null,n={action:s}
s===RF&&void 0!==a&&(a[GN]||a[mk])?n[GN]=a[GN]||a[mk]:s!==nH&&s!==K_&&s!==gk||!f&&!d||(n[Y_]=o.toString())
const i=null===(r=o.query)||void 0===r?void 0:r[Xk]
return s===aq&&void 0!==i&&void 0!==a&&(a[Xk]=i),a={...a,...n},qW.fromComponents(o.protocol,t,e,a,o.hash)}return o}(t)
for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier}
return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}const JW=Symbol("PromiseResult")
class KW extends Error{constructor(e){super(function(e){return e.map(e=>e instanceof Error?e.message:JSON.stringify(e)).join("")}(e)),this.reasons=e,this.reasons=e}}class ZW extends Error{constructor(e){super(e.message),this.reason=e,this.reason=e}}jv=e(4876)
class QW{constructor(e,t,n,r,o,i){this.$kind="Artwork",this.checksum=null,this.backgroundColor=null,this.textColor=null,this.style=null,this.crop="bb",this.contentMode=null,this.imageScale=null,this.template=e,this.width=t,this.height=n,this.variants=r,this.backgroundColor=o,this.textColor=i}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return""!==this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class XW{constructor(e){this.$kind="ImpressionableArtwork",this.art=e}}!function(e){e.Density1="density_1",e.Density2="density_2",e.Density3="density_3"}(Vv||(Vv={})),function(e){e[e.scaleToFill=0]="scaleToFill",e[e.scaleAspectFit=1]="scaleAspectFit",e[e.scaleAspectFill=2]="scaleAspectFill",e[e.redraw=3]="redraw",e[e.center=4]="center",e[e.top=5]="top",e[e.bottom=6]="bottom",e[e.left=7]="left",e[e.right=8]="right",e[e.topLeft=9]="topLeft",e[e.topRight=10]="topRight",e[e.bottomLeft=11]="bottomLeft",e[e.bottomRight=12]="bottomRight"}(Hv||(Hv={}))
class ez{constructor(e,t,n,r,o,i,s){this.$kind="MediaPlatform",this.appPlatform=e,this.supplementaryAppPlatforms=r||[],this.deviceCornerRadiusFactor=o,this.mediaType=t,this.systemImageName=n,this.deviceBorderThickness=i,this.outerDeviceCornerRadiusFactor=s}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort()
const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",")
return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&e.systemImageName===this.systemImageName&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class tz{constructor(e,t){this.$kind="Trailers",e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0}}class nz{constructor(e,t,n){this.$kind="Video",this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class rz{constructor(){this.$kind="ProductMediaItem"}}class oz{constructor(e,t,n,r,o,i){this.$kind="ProductMedia",this.items=e,this.mediaPlatform=t,this.allPlatforms=n,this.platformDescription=r,this.allPlatformsDescription=o,this.allPlatformsDescriptionPlacement=i}}class iz{constructor(e,t){this.$kind="Screenshots",this.artwork=e,this.mediaPlatform=t}}class sz{constructor(e,t,n,r){this.fileSizeByDevice=e,this.maxDownloadSizeInBytes=t,this.maxInstallSizeInBytes=n,this.maxEssentialInstallSizeInBytes=r}}class az{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new az(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}const cz=$_,lz="com.apple.AppStore.BridgeStoreExtension",uz=ty,dz=ny,fz=ry,hz="com.apple.TVAppStore.AppStoreTopShelfExtension",pz="com.apple.Arcade.ArcadeTopShelfExtension",wz=oy,gz=iy,vz="com.apple.AppStore.Widgets",mz=Fk,yz="VisionAppStore",Az=(0,Gv.makeMetatype)("app-store:storeMetrics"),Tz=(0,Gv.makeMetatype)("app-store:amsEngagement"),bz=(0,Gv.makeMetatype)("app-store:device"),Sz=(0,Gv.makeMetatype)("app-store:user"),Pz=(0,Gv.makeMetatype)("games:player"),Cz=(0,Gv.makeMetatype)("app-store:metricsIdentifiers"),Iz=(0,Gv.makeMetatype)("app-store:arcade"),kz=(0,Gv.makeMetatype)("app-store:gameCenter"),Oz=(0,Gv.makeMetatype)("app-store:resilientDeepLinks"),Ez=(0,Gv.makeMetatype)("app-store:ads"),Rz=(0,Gv.makeMetatype)("app-store:onDeviceRecommendationsManager"),Dz=(0,Gv.makeMetatype)("app-store:onDeviceSearchHistoryManager"),_z=(0,Gv.makeMetatype)("app-store:mediaTokenService"),Lz=(0,Gv.makeMetatype)("app-store:adsLocalizer"),Mz=(0,Gv.makeMetatype)("app-store:appDistribution"),xz=(0,Gv.makeMetatype)("app-store:timeoutManager"),$z=(0,Gv.makeMetatype)("app-store:treatmentStore"),Fz=(0,Gv.makeMetatype)("app-store:userDefaults"),Nz="_jet-internal:derived-data",Bz={artwork:Ex,iconArtwork:D_,screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:YN,customVideoPreviewsByTypeForAd:cE,customDeepLink:$$}
class Uz{constructor(e){this.implementation=e}}class Gz{constructor(){this.clearCache=()=>{this.cache={}},this.cache={}}get(e,t){return t()}}const jz=cz,Vz=lz,Hz=uz,qz=fz,Wz=dz,zz=wz
class Yz extends Uz{get buildType(){return Yz.cache.get("buildType",()=>this.implementation.buildType)}get buildVersion(){return this.implementation.buildVersion}get deviceType(){return Yz.cache.get("deviceType",()=>this.implementation.deviceType)}get guid(){return this.implementation.guid}get isActivityAvailable(){return this.implementation.isActivityAvailable}get isElectrocardiogramInstallationAllowed(){return this.implementation.isElectrocardiogramInstallationAllowed}get isScandiumInstallationAllowed(){return this.implementation.isScandiumInstallationAllowed}get isSidepackingEnabled(){return this.implementation.isSidepackingEnabled}get isTinkerWatch(){return Yz.cache.get("isTinkerWatch",()=>this.implementation.isTinkerWatch)}get screenCornerRadius(){return Yz.cache.get("screenCornerRadius",()=>this.implementation.screenCornerRadius)}get screenSize(){return Yz.cache.get("screenSize",()=>az.fromNativeSize(this.implementation.screenSize))}get storefrontIdentifier(){return this.implementation.storefrontIdentifier}get supportsHEIF(){return Yz.cache.get("supportsHEIF",()=>this.implementation.supportsHEIF)}get thinnedApplicationVariantIdentifier(){return Yz.cache.get("thinnedApplicationVariantIdentifier",()=>this.implementation.thinnedApplicationVariantIdentifier)}get isMandrakeSupported(){return this.implementation.isMandrakeSupported}get isCharonSupported(){return this.implementation.isCharonSupported}get maxAppContentRating(){return this.implementation.maxAppContentRating}get hostBundleId(){return Yz.cache.get("hostBundleId",()=>this.implementation.hostBundleId)}isPairedSystemVersionAtLeast(e){var t,n,r
return null!==(r=null===(n=(t=this.implementation).isPairedSystemVersionAtLeast)||void 0===n?void 0:n.call(t,e))&&void 0!==r&&r}deletableSystemAppCanBeInstalledOnWatchWithBundleID(e){return this.implementation.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}deviceHasCapabilities(e){return this.implementation.deviceHasCapabilities(e)}deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t){return(!this.isPad||!e.includes("healthkit"))&&this.implementation.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t)}hasEligibilityDomain(e){return this.implementation.hasEligibilityDomain(e)}contextForEligibilityDomain(e){return this.implementation.contextForEligibilityDomain(e)}isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n){return this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}canDevicePerformAppActionWithAppCapabilities(e,t){return this.implementation.canDevicePerformAppActionWithAppCapabilities(e,t)}isAutomaticDownloadingEnabled(){return this.implementation.isAutomaticDownloadingEnabled()}isAuthorizedForUserNotifications(){return this.implementation.isAuthorizedForUserNotifications()}isActivePairedWatchSystemVersionBelow(e){const t=e.split("."),n=h(t[0])||0,r=h(t[1])||0,o=h(t[2])||0
return!this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(n,r,o)}get isPhone(){return this.deviceType===jq}get isPad(){return this.deviceType===$q}get isiOS(){return this.isPhone||this.isPad}get isMac(){return this.deviceType===Yq}get isTV(){return"tv"===this.deviceType}get isWatch(){return this.deviceType===zq}get isVision(){return this.deviceType===Fq}get isWeb(){return this.deviceType===AV}get isCompanionVisionApp(){return this.hostBundleId===Fk}get remoteDownloadIdentifiers(){return this.implementation.remoteDownloadIdentifiers}}Yz.type=(0,Gv.makeMetatype)("app-store:client-wrapper"),Yz.cache=new Gz
class Jz{constructor(e,t,n,r){var i
this.contentsResourceTypes=new Set,this.ids=new Set,this.idsByResourceType=new Map,this.originalOrdering=[],this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.supplementaryMetadataAssociations=[],this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.countryCodeOverride=void 0,this.objectGraph=e,this.platform=K(e),this.isMixedMediaRequest=null!=n&&n,this.supplementaryMetadataAssociations=null!=r?r:[],this.includeAppBinaryTraitsAttribute=!0,(null===(i=e.activeIntent)||void 0===i?void 0:i.platform)&&(this.platform=e.activeIntent.platform),o(t)||(typeof t===Sq?this.href=t:Array.isArray(t)&&this.withDataItems(t,r,n))}addDataToIDsByResourceType(e){const t=e.type,n=e.id
let r=this.idsByResourceType.get(t);(0,Uv.isNothing)(r)&&(r=new Set),r.add(n),this.idsByResourceType.set(t,r)}forType(e){return this.resourceType=e,this}withDataItems(e,t,n){if(0===e.length)return this
this.isMixedMediaRequest=this.isMixedMediaRequest||null!=n&&n
for(const r of e)if(this.ids.add(r.id),this.addDataToIDsByResourceType(r),(0,Uv.isSome)(n)&&n&&(0,Uv.isSome)(t)&&t.length>0)for(const e of t){const t=re(e,r);(0,Uv.isSome)(t)&&t.length>0&&t.forEach(e=>{this.addDataToIDsByResourceType(e)})}return 1===this.idsByResourceType.size?(this.resourceType=this.idsByResourceType.keys().next().value,this.isMixedMediaRequest=!1):this.idsByResourceType.size>1&&!this.isMixedMediaRequest&&(this.resourceType=Jq,this.contentsResourceTypes=new Set(Array.from(this.idsByResourceType.keys()))),this.originalOrdering.push(...e),this}withIdOfType(e,t){return this.withDataItems([{id:e,type:t}])}withIdsOfType(e,t){return this.withDataItems(e.map(e=>({id:e,type:t})))}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingViews(e){this.viewsIncludes||(this.viewsIncludes=new Set)
for(const t of e)this.viewsIncludes.add(t)
return this}includingKindsKeys(e,t){this.kindIncludes||(this.kindIncludes=new Map)
let n=this.kindIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.kindIncludes.set(e,n),this}includingAssociateKeys(e,t){this.associateIncludes||(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t=aV
if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get(Nq)
e||(e=new Set),e.add(t),this.scopedRelationshipIncludes.set(Nq,e)}else this.relationshipIncludes.add(t)
{this.metaIncludes||(this.metaIncludes=new Map)
let e=this.metaIncludes.get(aV)
e||(e=new Set),e.add(fj),this.metaIncludes.set(aV,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAgeRestrictions(){const e=this.objectGraph.client.maxAppContentRating
return e<1e3&&(this.ageRestriction=e),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){this.scopedAvailableInIncludes||(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return this.scopedSparseLimit||(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return(0,Uv.isSome)(t)?this.additionalQuery[e]=t:delete this.addingQuery[e],this}addingQueryValues(e){return this.additionalQuery={...this.addingQuery,...e},this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return this.objectGraph.appleSilicon.isSupportEnabled&&(e||this.enablingFeature(MD),this.includingScopedAttributes(Kq,[XE])),this}includingAppBinaryTraitsAttribute(e=!0){return this.includeAppBinaryTraitsAttribute=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!i(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}withCountryCodeOverride(e){return this.countryCodeOverride=e,this}}const Kz=(e,t)=>e||t,Zz=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])?"),Qz=Ae(0,0,0),Xz=Ae(1,1,1),eY="FBEF7E28-E3DF-4484-A7D7-2FE19E43D2B8",tY="21FD31A2-0631-4100-9942-D368B43F00C5",nY="9C29E652-9774-4219-9BEB-9414597AD175";(Ym=qv||(qv={})).ArcadeDownloadPackOnboarding="Tf5Kjqz",Ym.CondensedTodayAds="tBc9hUt",Ym.ProductPagePreloading="m0henFo",Ym.ProductPageVariants="fNPb5Km",Ym.ProductPageYMALRowCount="isj11bm",Ym.SearchLandingPage="WqjkRLH"
class rY{constructor(){this.cachedTreatments={},this.cachedRawTreatments={}}async loadTreatments(e){const t=this.experimentAreasForPlatform(e)
if(t.length>0)try{this.cachedRawTreatments=await e.treatmentStore.treatmentsForAreas(t)
for(const[e,t]of Object.entries(this.cachedRawTreatments)){const n=t.identifier
this.cachedTreatments[e]={...t,identifier:n.split(":")[0]}}}catch(t){e.console.error("Failed to load treatments",t)}}currentTreatmentForExperiment(e){return this.cachedTreatments[e]}createAb2Data(){const e=[]
for(const[t,n]of Object.entries(this.cachedRawTreatments))e.push({areaId:t,bucket:-2,treatmentId:n.identifier})
return e}experimentAreasForPlatform(e){const t=[]
switch(e.client.deviceType){case jq:case $q:t.push(qv.ArcadeDownloadPackOnboarding,qv.CondensedTodayAds,qv.ProductPagePreloading,qv.ProductPageVariants,qv.ProductPageYMALRowCount,qv.SearchLandingPage)}return t}}rY.metatype=(0,Gv.makeMetatype)("app-store:experimentCache")
const oY="3NepyQj01",iY=vq
let sY=null
!function(e){e[e.None=0]="None",e[e.ThirtyTwoBit=2]="ThirtyTwoBit",e[e.UnsupportedSystemDeletableApps=4]="UnsupportedSystemDeletableApps",e[e.UnsupportedWatchAppOnWatchClient=8]="UnsupportedWatchAppOnWatchClient",e[e.DisabledMerchandisableIAPs=16]="DisabledMerchandisableIAPs",e[e.LegacyApps=32]="LegacyApps",e[e.LegacyProductionMacOSInstaller=64]="LegacyProductionMacOSInstaller",e[e.UnsupportedPlatform=128]="UnsupportedPlatform",e[e.UnsupportedPreorders=256]="UnsupportedPreorders",e[e.MinimumOSRequirement=512]="MinimumOSRequirement",e[e.SADWatchApps=1024]="SADWatchApps",e[e.MinimumCompanionOSRequirement=2048]="MinimumCompanionOSRequirement",e[e.MacOSCompatibleIOSBinary=4096]="MacOSCompatibleIOSBinary",e[e.MacOSRosetta=8192]="MacOSRosetta",e[e.UnsupportedPlatformForMacCharts=16384]="UnsupportedPlatformForMacCharts",e[e.VisionOSCompatibility=32768]="VisionOSCompatibility",e[e.SADMinimumOSRequirement=65536]="SADMinimumOSRequirement",e[e.DeveloperPage=76532]="DeveloperPage",e[e.Offers=77238]="Offers",e[e.TodayCard=76670]="TodayCard",e[e.Search=10750]="Search",e[e.Bundles=76286]="Bundles",e[e.Charts=68606]="Charts",e[e.ChartsMac=84862]="ChartsMac",e[e.All=80894]="All"}(Wv||(Wv={}))
const aY=[mq,gq,Yq,Fq,zq,"tv"]
class cY{constructor(){this.$kind="LockupContextMenuData"}}const lY={Lockup:uy,InAppPurchaseLockup:Bk,MixedMediaLockup:Uk,PosterLockup:Gk,ProductPage:jk,ScreenshotsLockup:Vk,TrailersLockup:Hk,UpdatesLockup:N_}
class uY{constructor(e){this.$kind=null!=e?e:uy}isValid(){return!!this.title&&!(!this.icon||!this.icon.isValid())}}class dY extends uY{constructor(){super(Bk)}}class fY extends dW{constructor(e,t){super(),this.$kind="flowAction",this.actionClass="FlowAction",this.page=e,this.pageUrl=t,this.pageData=null,this.referrerData=void 0,this.presentationContext=TH,this.animationBehavior=TH,this.origin="inapp"}}class hY{constructor(){this.$kind="PageMetrics",this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n={data:e,invocationPoints:t}
this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class pY{constructor(){this.$kind="InAppPurchaseInstallPage",this.pageMetrics=new hY,this.pageRenderMetrics={}}}class wY extends dW{constructor(e,t,n,r,o){super(),this.$kind="InAppPurchaseAction",this.actionClass="InAppPurchaseAction",this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class gY extends dW{constructor(e){super(),this.$kind="AlertAction",this.actionClass="AlertAction",this.style=e,this.title=void 0,this.message=null,this.isCancelable=!1,this.cancelTitle=null,this.cancelAction=null,this.buttonActions=[],this.buttonTitles=[],this.destructiveActionIndex=null,this.imageName=null}}class vY extends uY{constructor(){super(Vk),this.screenshots=[],this.screenshotsDisplayStyle=OF}isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class mY extends uY{constructor(){super(Gk)}isValid(){const e=this.posterArtwork,t=this.posterVideo
return!(!e&&!t)&&super.isValid()}}class yY extends uY{constructor(){super(Hk)}isValid(){return!(!this.trailers||!this.trailers.isValid())&&!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid()}}class AY extends uY{constructor(){super(Uk),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null,this.screenshotsDisplayStyle="control",this.metadataRibbonItems=[],this.showMetadataInformationInLockup=!1,this.alignedRegionArtwork=null,this.alignedRegionVideo=null}}class TY{constructor(e,t,n,r,o=!1){this.$kind="ImageLockup",this.isDark=!1,this.artwork=e,this.lockup=t,this.caption=n,this.title=r,this.isDark=o}isValid(){return this.lockup.isValid()&&this.artwork.isValid()}}class bY{constructor(){this.$kind="ArcadeLockup"}}class SY{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S=!1,P=!1,C=!1){this.$kind="OfferDisplayProperties",this.offerType=e,this.adamId=t,this.bundleId=n,this.parentAdamId=o,this.style=null==r?TH:r,this.environment=null==i?QH:i,this.offerTint=null==s?{type:j_}:s,this.titles=null==a?{}:a,this.titleSymbolNames=null==c?{}:c,this.subtitles=null==l?{}:l,this.hasInAppPurchases=u,this.hasExternalPurchases=d,this.isDeletableSystemApp=f,this.isFree=h,this.isPreorder=p,this.offerLabelStyle=null==w?rq:w,this.hasDiscount=g,this.contentRating=v,this.subscriptionFamilyId=m,this.useAdsLocale=y,this.priceFormatted=A,this.isStreamlinedBuy=T,this.appCapabilities=b,this.ignoresContentRestrictions=S,this.isRedownloadDisallowed=P,this.isOpenBundleAllowed=C}newOfferDisplayPropertiesChangingAppearance(e,t,n,r){return new SY(this.offerType,this.adamId,this.bundleId,null==t||!e&&this.style===NB?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.offerTint:r,this.titles,this.titleSymbolNames,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId,this.useAdsLocale,this.priceFormatted,this.isStreamlinedBuy,this.appCapabilities,this.ignoresContentRestrictions,this.isRedownloadDisallowed,this.isOpenBundleAllowed)}}class PY extends dW{constructor(e,t=!0,n=new sW){super(),this.$kind="ExternalUrlAction",this.actionClass="ExternalUrlAction",this.url=e,this.isSensitive=t,this.actionMetrics=n}}class CY{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class IY extends dW{constructor(e,t){super(),this.$kind="OfferStateAction",this.actionClass="OfferStateAction",this.title=t.title,this.adamId=e,this.defaultAction=t,this.includeBetaApps=!1}}class kY{constructor(e,t,n,r,o,i,s){this.$kind="AdvertActionMetrics",this.instanceId=e,this.adamId=t,this.bundleId=n,this.advertType=r,this.invocation=o,this.purchaseType=i,this.reportingDestination=s}}class OY extends dW{constructor(e){super(),this.$kind="HttpTemplateAction",this.actionClass="HttpTemplateAction",this.message=null,this.url=e,this.method=UN,this.headers={},this.body=null,this.bodyDictionary={},this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class EY extends OY{}class RY{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class DY{constructor(){this.$kind="ProductReview",this.componentType=Fx}}class _Y{constructor(){this.$kind="Review"}}class LY{constructor(){this.$kind="Response"}}class MY{constructor(e){this.$kind=null!=e?e:"Ratings"}}class xY{constructor(e,t,n,r,o,i,s){this.$kind="ReviewSummary",this.body=e,this.bodyNoTitle=t,this.subtitle=n,this.subtitleArtwork=r,this.subtitleArtworkAlignment=o,this.bodyMediaType=i,this.flowPreviewActionsConfiguration=s}}class $Y extends MY{constructor(){super("ProductStarRatings"),this.$kind="ProductStarRatings",this.componentType="starRatings"}}class FY extends MY{constructor(){super("ProductStarRatingsHistogram"),this.$kind="ProductStarRatingsHistogram",this.componentType="starRatingsHistogram"}}class NY extends MY{constructor(){super("ProductNoRatings"),this.$kind="ProductNoRatings",this.componentType="noRatings"}}class BY{constructor(){this.$kind="TapToRate",this.componentType=py}}class UY extends dW{constructor(e,t){super(),this.$kind="WriteReviewAction",this.actionClass="WriteReviewAction",this.adamId=e,this.url=t}}class GY extends uY{constructor(){super(jk),this.pageMetrics=new hY,this.pageRenderMetrics={}}}const jY={DynamicGenericPage:"DynamicGenericPage",SearchChartsAndCategoriesPage:"SearchChartsAndCategoriesPage",ShelfBasedProductPage:ay}
class VY{constructor(){this.shelfOrderings={},this.shelfMapping={},this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class HY extends VY{constructor(){super(...arguments),this.$kind="ShelfBasedProductPage",this.appPlatforms=[]}}class qY extends dW{constructor(e,t,n,r,o,i){super(),this.$kind="ShelfBasedPageScrollAction",this.actionClass="ShelfBasedPageScrollAction",this.shelfId=e,this.notPurchasedShelfId=t,this.purchasedShelfId=n,this.adamId=r,this.index=o,this.clicksOnScroll=i}}class WY extends dW{constructor(e,t){super(),this.$kind="ProductPageScrollAction",this.actionClass="ProductPageScrollAction",this.section=e,this.clicksOnScroll=t}}class zY{constructor(e,t){this.$kind="ProductPageSection",this.type=e,this.shelfId=t}}!function(e){e.OnPageLoad="onPageLoad",e.OnShelfWillAppear="onShelfWillAppear"}(zv||(zv={}))
class YY{constructor(e,t=null,n=null){this.$kind="Shelf",this.impressionMetrics=null,this.contentType=e,this.marker=t,this.items=n||[],this.header=void 0,this.url=null,this.mergeWhenFetched=!1,this.fetchStrategy=zv.OnPageLoad,this.batchGroup=null,this.seeAllAction=null,this.footerTitle=null,this.footerAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.footerStyle=null,this.title=void 0,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.rowsPerColumn=null,this.background={type:rq},this.contentsMetadata={type:rq},this.isPersonalized=!1,this.shouldFilterApps=!1}}class JY{constructor(){this.$kind="ReviewsContainer"}}class KY{constructor(e,t,n,r){this.$kind="ReviewsPageSortOption",this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class ZY{constructor(e,t){this.shelves=e,this.title=void 0,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new hY,this.$kind=null!=t?t:"GenericPage"}}class QY extends ZY{constructor(){super([],"ReviewsPage")}}const XY="5BB5F361-F7CA-4BE5-90D4-92A973A38B03",eJ="B77D6B43-8357-42AC-9455-0BC985A4CC20",tJ="3A904FFE-6C7A-43F3-A014-CF750E1CBF5D",nJ="ACEB64F5-C210-4A63-9E78-1FA652ACE3B8",rJ="68BBAC6D-7741-47E0-99CE-5BA3B62E88A7",oJ="DA1A9665-5984-4AB6-B886-100A648F430F",iJ="3263D5D9-4A36-4C59-9B78-1EC9B7E78A1C",sJ="3771A729-28D2-498B-8128-36F745619ED2",aJ="CF3F5A4B-4F69-48AB-8FF9-CD6AA8D54A1C",cJ="DADF37D0-D667-4249-BA19-7C4A08E08281",lJ="33A25C07-53BB-4278-8C07-E6D00BE78609",uJ="3E45DDEC-6028-42C5-BA4C-7644C8E9316B",dJ="A77D5208-7747-467B-864F-76AC0E8E0DCE",fJ="979360BA-DDB0-4698-BE4F-16072F3BFB9B",hJ="564053BF-441A-44D5-B37C-2D6E112E4956",pJ="9AC2B085-5CE6-45CC-87B5-61F6E1E64541",wJ="C2F1E751-7AC6-4368-917B-52900BA17FE8",gJ="5C63792A-E02C-4266-81BB-5B14330B1477",vJ="61FC0A9A-814D-46FF-AFE2-5D1907893829",mJ="7D0F61A1-4E25-40DF-A258-E028C4DCC5A1",yJ=Px,AJ="A134C61B-1BB0-45BE-B1C8-342ABE5DAACC",TJ=Px,bJ=Px,SJ=Px
class PJ{constructor(e,t,n){this.$kind="ArtworkVariant",this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class CJ{constructor(e,t=null,n=null){this.$kind="FlowPreviewActionsConfiguration",this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class IJ{constructor(e,t,n){this.$kind="ReportConcernReason",this.reasonId=e,this.name=t,this.uppercaseName=n}}class kJ extends dW{constructor(e,t,n,r){super(),this.$kind="ReviewSummaryReportConcernAction",this.actionClass="ReviewSummaryReportConcernAction",this.concerns=e,this.title=t,this.explanation=n,this.sendAction=r}}class OJ extends dW{constructor(e){super(),this.$kind="HttpAction",this.actionClass="HttpAction",this.url=e,this.method=UN,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class EJ extends dW{constructor(e){super(),this.$kind="ReportConcernAction",this.actionClass="ReportConcernAction",this.reasons=e}}class RJ extends dW{constructor(e){super(),this.$kind="CopyTextAction",this.actionClass="CopyTextAction",this.text=e}}class DJ{static get contentType(){return FM}constructor(){this._params=""}param(e,t){if(e&&t){const n=this._params.length>0?"&":""
this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}class _J extends dW{constructor(e,t=Mq){super(),this.$kind="OpenAppAction",this.actionClass="OpenAppAction",this.adamId=e,this.destination=t}}class LJ extends dW{constructor(e,t,n){super(),this.$kind="AppLaunchTrampolineAction",this.actionClass="AppLaunchTrampolineAction",this.bundleId=e,this.payloadUrl=t,this.fallbackAction=n}}class MJ extends dW{constructor(e){super(),this.$kind="CompoundAction",this.actionClass="CompoundAction"
const t=[]
for(const n of e)(0,Nv.isSome)(n.actionMetrics)&&(this.actionMetrics.addManyMetricsData(n.actionMetrics.data),Object.assign(this.actionMetrics.custom,n.actionMetrics.custom),n.actionMetrics.clearAll()),t.push(n)
this.actions=t}}const xJ="jet_adamId",$J="X-AppStore-iAdClickToken",FJ="X-AppStore-iAdLineItem",NJ="X-AppStore-iAdDismissAdActionMetrics"
class BJ{constructor(e={}){this.baseFields=e}}class UJ{constructor(e){this.$kind="LintedMetricsEvent",this.fields=e}}class GJ{constructor(e){if(this._values={},(0,Uv.isSome)(e)&&e.length>0){const t=e.split("&")
for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=(0,Uv.isNothing)(n)?"":decodeURIComponent(n)
this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length")
return(0,Uv.isNothing)(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t)
return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n)
return(0,Uv.isNothing)(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e=""
for(const t of Object.keys(this._values)){const n=this._values[t]
e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={}
for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n)
e[r]=o}return e}toRawMap(){return{...this._values}}}!function(e){e.client="clientId",e.user="userId",e.canonical="canonicalAccountIdentifierOverride"}(Yv||(Yv={})),function(e){e.client="APPSTORE_ENGAGEMENT_CLIENT",e.user="APPSTORE_ENGAGEMENT"}(Jv||(Jv={})),function(e){e.client="APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT",e.user="APPSTORE_PAYMENTS_ENGAGEMENT"}(Kv||(Kv={})),function(e){e.user="APPSTORE_PERSONALIZATION"}(Zv||(Zv={}))
const jJ={[Yv.client]:{keyType:Yv.client,bagNamespace:Kv.client,crossSyncDevice:!1},[Yv.user]:{keyType:Yv.user,bagNamespace:Kv.user,crossSyncDevice:!0}},VJ={[Yv.client]:{keyType:Yv.client,bagNamespace:Jv.client,crossSyncDevice:!1},[Yv.user]:{keyType:Yv.user,bagNamespace:Jv.user,crossSyncDevice:!0}},HJ={[Yv.user]:{keyType:Yv.user,bagNamespace:Zv.user,crossSyncDevice:!0}}
class qJ{constructor(e=VJ){this.cachedMetricsIds={},this.cachedMetricsFields={},this.shouldAddDsIdFallbackField=!1,this.userDsId=null,this.identifierContextMapping=e}async loadValues(e,t){e.bag.isMetricsUserIdFallbackEnabled&&!e.user.isUnderThirteen?(this.shouldAddDsIdFallbackField=!0,this.userDsId=e.user.dsid):(this.shouldAddDsIdFallbackField=!1,this.userDsId=null)
const n=[]
for(const r of t){const t=await this.loadValuesForIdType(e,r)
n.push(t)}for(const{idType:e,id:t,fields:r}of n)t&&(this.cachedMetricsIds[e]=t),r&&(this.cachedMetricsFields[e]=r)}async loadValuesForIdType(e,t){const n={idType:t},r=this.identifierContextMapping[t]
if(r){try{const o=await Bv.context("MetricsIdentifiersCache:loadValues:metricsFields",async()=>await e.metricsIdentifiers.getMetricsFieldsForContexts([r]))
if((0,Nv.isSome)(o)){n[Gx]=o
const e=o[t];(0,Nv.isSome)(e)&&typeof e===Sq&&e.length>0&&(n.id=e)}}catch(n){e.console.error(`Unable to fetch metrics fields for idType ${t}`,n)}if((0,Nv.isNothing)(n.id))try{const t=await Bv.context("MetricsIdentifiersCache:loadValues:metricsIdentifier",async()=>await e.metricsIdentifiers.getIdentifierForContext(r));(0,Nv.isSome)(t)&&(n.id=t)}catch(n){e.console.error(`Unable to fetch metrics identifier for idType ${t}`,n)}}return n}getMetricsIdForType(e){return this.cachedMetricsIds[e]}getMetricsFieldsForTypes(e){const t=e.map(e=>{var t
return null!==(t=this.cachedMetricsFields[e])&&void 0!==t?t:{}}),n=Object.assign({},...t)
return this.shouldAddDsIdFallbackField&&-1!==e.indexOf(Yv.user)&&this.addDsIdFallbackFieldIfNecessary(n),n}addDsIdFallbackFieldIfNecessary(e){const t=e[Yv.user];((0,Nv.isNothing)(t)||typeof t!==Sq||0===t.length||t.length===qJ.clientGeneratedUserIdLength)&&(0,Nv.isSome)(this.userDsId)&&this.userDsId.length>0&&(e[aR]=this.userDsId)}setCanonicalAccountIdentifierOverride(e){e.length>=0&&(this.cachedMetricsFields[Yv.canonical]={[Yv.canonical]:e})}}qJ.defaultMetatype=(0,Gv.makeMetatype)("app-store:metricsIdentifiersCache"),qJ.paymentMetatype=(0,Gv.makeMetatype)("app-store:paymentMetricsIdentifiersCache"),qJ.personalizationMetatype=(0,Gv.makeMetatype)("app-store:personalizationMetricsIdentifiersCache"),qJ.clientGeneratedUserIdLength=24
class WJ{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=f(n,"fieldName")
if(r(t))continue
const o=h(e,t)
if(r(o))continue
let i=h(n,"magnitude")
r(i)&&(i=1048576)
let s=h(n,"significantDigits")
if(r(s)&&(s=2),i<=0||s<0){e[t]=Number.NaN
continue}const a=o/i
e[t]=Rt(a,s)}}_urlScrubbingAdParameters(e){const t=new qW(e)
return t.removeParam($J),t.removeParam(FJ),t.removeParam(NJ),t.build()}_urlScrubbingExtRefUrl(e){const t=new qW(e)
return t.username="",t.password="",t.pathname=void 0,t.query=void 0,t.hash=void 0,t.build()}_derezFastImpressions(e){const t=f(e,bN),n=h(e,SN)
if(t===tR){if(4===n){const t=l(e,BV)
e[BV]=t.map(e=>{if((0,Uv.isNothing)(e))return e
const t=l(e,lS)
return 0===t.length||(e[lS]=t.map(e=>{if((0,Uv.isNothing)(e))return e
const t=h(e,"d")
return e.s=0,(0,Uv.isSome)(t)&&(e.d=Rt(t,2)),e})),e})}if(5===n){const t=l(e,BV)
e[BV]=t.map(e=>{if((0,Uv.isNothing)(e))return e
delete e[PM],f(e,CN)!==F$&&(o(f(e,CM))||o(f(e,N$)))&&delete e.id
const t=p(e,uS)
if((0,Uv.isNothing)(t)||o(t))return e
const n=f(e,fG)
return Object.entries(t).forEach(([e,r])=>{const o=l(r)
t[e]=o.map(e=>{if((0,Uv.isNothing)(e))return e
if(n===oR){const t=h(e,"s");(0,Uv.isSome)(t)&&(e.s=Rt(t,3))}else e.s=0
const t=h(e,"d")
return(0,Uv.isSome)(t)&&(e.d=Rt(t,2)),e})}),e[uS]=t,e})}}}_stripContentRatingImpressionFields(e){const t=l(e,BV)
e[BV]=t.map(e=>((0,Uv.isSome)(e)&&(delete e[AU],delete e[oq]),e))}_decorateSearchResultImpressions(e){const t=f(e,Dj),n=f(e,MG)
t===wV&&n!==B$&&function(e){const t=l(e,BV)
let n
for(const e of t){const t=f(e,CN)
if((0,Uv.isSome)(e)&&t===Bj){n=e[j$]
break}}n&&(e[BV]=t.map(e=>{const t=f(e,CN),r=t===vV||t===Zx
return(0,Uv.isSome)(e)&&r&&(e[OR]=n),e}))}(e)}_decorateSearchFocusImpressions(e){const t=f(e,Dj),n=f(e,MG)
t===IM&&n===kM&&function(e){var t
const n=l(e,BV)
let r
for(const e of n)if("R8804"===f(e,cN)){r=null!==(t=f(e,j$))&&void 0!==t?t:void 0
break}r&&(e[BV]=n.map(e=>{const t=f(e,cN),n=f(e,CN)
return o(t)&&n===yq&&null!=e&&null==f(e,OR)&&(e[OR]=r),e}))}(e)}_decorateAll(e,t,n){var o,i,s
const a=this._options.bagProvider,c=a("metricsBase",n)
r(c)||typeof c!==Zj||Object.assign(t,c),t.clientBuildType=this._options.buildType,t.resourceRevNum=this._options.jsVersion,t.xpSendMethod="jet-js",this._options.buyDecorator.useApp(f(t,Mq)),delete t[xJ]
const u=function*(e){if((0,Uv.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}}(f(t,dS))
for(const e of u)if("xp_ci"===e.key){this._options.buyDecorator.useClientId(e.value)
break}delete t[dS]
const d=null!==(i=null===(o=e.metricsIdentifiersCache)||void 0===o?void 0:o.getMetricsFieldsForTypes([Yv.client]))&&void 0!==i?i:{}
Object.assign(t,d),delete t.clientGeneratedId
const h=f(t,Dj),p=f(t,MG)
if(!r(h)&&!r(p)){const e=f(a("compoundSeparator",n))||"_"
t[eW]=`${h}${e}${p}`}const w=l(a("deResFields",n))
this._reduceFieldAccuracy(t,w)
const g=[yU,TN,PB,CB,Rq,"parentPageUrl"]
for(const e of g){const n=f(t,e);(0,Uv.isSome)(n)&&n.length>0&&(t[e]=e===PB?this._urlScrubbingExtRefUrl(n):this._urlScrubbingAdParameters(n))}const v=f(t,iR)
if((0,Uv.isSome)(v)&&(delete t[iR],t[U$]=v),e.bag.isMetricsUserIdFallbackEnabled){const n=f(t,sR)
let r=null;((0,Uv.isNothing)(n)||0===n.length||n.length===WJ.clientGeneratedUserIdLength)&&(r=null!==(s=e.user.dsid)&&void 0!==s?s:null),(0,Uv.isSome)(r)&&r.length>0&&(t[aR]=r)}}_decorateClick(e){!function(e){const t=f(e,J$),n=f(e,ER)
r(t)&&(0,Nv.isSome)(n)&&(null==n?void 0:n.length)>0&&(e[J$]=n),f(e,RR)===HS&&delete e[DR]}(e),this._decorateSearchResultImpressions(e),this._decorateSearchFocusImpressions(e),oW.shared.addReferralDataToEventIfNecessary(e),this._filterBuyParams(e)
const t=f(e,Dj)
!(0,Uv.isNothing)(t)&&t.toLowerCase().includes(aq)||delete e[BV],Fh(e)}_decorateImpressions(e,t){if(o(t[BV]))return!1
this._derezFastImpressions(t),this._decorateSearchResultImpressions(t),this._stripContentRatingImpressionFields(t)
const n=f(t,CB)
return(0,Uv.isSome)(n)&&n.length>0&&(t[mH]=uh(n),delete t[CB]),Fh(t),delete t[bN],!0}_decorateMedia(e){const t=h(e,OM)
r(t)||(e[OM]=Math.round(t))}_filterBuyParams(e){const t=f(e,"actionDetails.buyParams")
if((0,Uv.isSome)(t)&&t.length>0){const n=new GJ(t);[fS].forEach(e=>{n.set(e,null,null)}),(0,Uv.isSome)(e[xG])&&(e[xG][lj]=n.toString())}}_decoratePage(e,t){const n=f(t,eW)
r(n)||(t.pageHistory=this._options.buyDecorator.getPageHistoryFor(n)),oW.shared.setReferralDataForProductPageExtensionIfNecessary(t),oW.shared.beginReferralContextForPageIfNecessary(t),oW.shared.addReferralDataToEventIfNecessary(t)
const o=f(t,CB)
if(!r(o)){const e=ah(o),n=uh(o)
null!==e&&e.length>0&&(t[G$]=e),null!==n&&n.length>0&&(t[mH]=n)}}_decoratePageChange(e,t){this._decoratePage(e,t)}_decorateSearch(e){e[SN]=3,function(e){var t
const n=null!==(t=e[xG])&&void 0!==t?t:{},o=n[J$],i=f(e,ER)
r(o)&&(0,Nv.isSome)(i)&&(null==i?void 0:i.length)>0&&(n[J$]=i,e[xG]=n),f(e,RR)===HS&&delete e[DR],e[GB]===_R&&delete e[DR]}(e)}_decoratePageExit(e){oW.shared.endReferralContextIfNecessaryForPageEvent(e)}_filterExtraneous(e){!function(e){delete e[ER],delete e[RR],delete e.searchGhostHintTermLastDisplayed}(e),oW.shared.removeReferralContextInfoFromMetricsEvent(e)}makeEvent(e,t){const n=f(t,Rj)
if(this._options.isLoggingEnabled&&e.console.log(`Building event for topic: ${n}`),t[Mq]===iy)return new UJ({})
const r=f(t,Xx)||this._options.defaultTopic
let o
this._decorateAll(e,t,r),o=e.user.isUnderThirteen,o&&(delete t[aR],delete t[sR],delete t.canonicalAccountIdentifierOverride)
const i=t[PB]
switch(i&&""===i&&delete t[PB],n){case vU:this._decorateClick(t)
break
case nR:break
case BV:if(!this._decorateImpressions(e,t))return new UJ({})
break
case cS:this._decorateMedia(t)
break
case eW:this._decoratePage(e,t)
break
case z_:this._decoratePageChange(e,t)
break
case hS:this._decoratePageExit(t)
break
case aq:this._decorateSearch(t)}return this._filterExtraneous(t),e.bag.metricsIdMigrationEnabled&&function(e){delete e[MR],delete e.DSID}(t),new UJ(t)}}WJ.clientGeneratedUserIdLength=24,WJ.hasIAdData=rR
class zJ{constructor(e,t,n,r,o=!1){this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class YJ{constructor(){this.$kind="TodayCard",this.heading=void 0,this.title=void 0,this.shortTitle=void 0,this.titleArtwork=void 0,this.media=void 0,this.heroMedia=void 0,this.overlay=void 0,this.style=void 0,this.clickAction=void 0,this.backgroundColor=void 0,this.inlineDescription=void 0,this.collapsedHeading=void 0,this.editorialDisplayOptions=void 0,this.supportsMediaMirroring=void 0}}const JJ="5pdfhju01"
class KJ{constructor(e,t,n){this.$kind="SearchAdOpportunity",this.instanceId=e,this.eventPayloads=t,this.searchAd=n}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}setMissedOpportunityReason(e){this.eventPayloads.placed.missedOpportunityReason=e}}class ZJ extends dW{constructor(e){super(),this.$kind="AdTransparencyAction",this.actionClass="AdTransparencyAction",this.adTransparencyData=e}}class QJ{constructor(e,t,n,r,o){this.$kind="SearchAd",this.instanceId=e,this.iAd=t,this.eventPayloads=n,this.impressionId=r,this.transparencyAction=o}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}}class XJ extends dW{constructor(e){super(),this.$kind="AdInteractionAction",this.actionClass="AdInteractionAction",this.adActionMetrics=e}}class eK{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[hG],this.requestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=(0,Nv.isSome)(this.requestData)&&this.requestData.length>0,t=(0,Nv.isSome)(this.routingInfo)&&this.routingInfo.length>0
return e&&t}}const tK="PI4",nK="PI3",rK="PI2",oK="PI1",iK="PV4",sK="PV3",aK="PV2",cK="PV1",lK="LV1",uK="LI1",dK="UV1_3x2",fK="UI1_3x2",hK="TEXT",pK=[fK],wK=[[hK],[lK,uK],[tK,nK,rK,oK,iK,sK,aK,cK],pK]
let gK=null
const vK="jet_native_advert_instanceid"
!function(e){e.Grid="grid",e.Hero="hero",e.Standard="standard"}(Qv||(Qv={})),function(e){e.insertIntoShelf="insertIntoShelf",e.replaceOrganic="replaceOrganic",e.dropAd="dropAd"}(Xv||(Xv={})),function(e){e.Icon="icon",e.Category="category"}(em||(em={})),function(e){e.TopLeading="topLeading",e.Top="top",e.TopTrailing="topTrailing",e.Trailing="trailing",e.BottomTrailing="bottomTrailing",e.Bottom="bottom",e.BottomLeading="bottomLeading",e.Leading="leading"}(tm||(tm={})),nm=e(172)
const mK="appStore.getEngagementEvents",yK=0,AK=1,TK=2
class bK{constructor(e){this.$kind="CategoryList",this.categories=e}}class SK{constructor(e,t,n,r,o){this.$kind="Category",this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}const PK={Apps:36,MacApps:39,Games:6014,Discover:39},CK=["284417353","1464590764","314638464","284993479","1351056256"];(Zm=rm||(rm={})).ArcadeSeeAllGames="editorial-shelves-arcade-see-all-games",Zm.Collection="editorial-shelves-collection",Zm.Chart="editorial-shelves-chart",Zm.Tag="editorial-shelves-tag",Zm.Engagement="editorial-shelves-engagement",Zm.Text="editorial-shelves-text",Zm.Image="editorial-shelves-image",Zm.VideoClip="editorial-shelves-video-clip",Zm.Header="editorial-shelves-header",Zm.Recommendations="editorial-shelves-recommendation",Zm.GameCenter="editorial-shelves-game-center",Zm.Upsell="editorial-shelves-upsell",Zm.Marker="editorial-shelves-marker",(Km=om||(om={})).Hero="Hero",Km.TextOnly="TextOnly",Km.TextWithArtwork="TextWithArtwork",Km.BrickSmall="BrickSmall",Km.BrickMedium="BrickMedium",Km.BrickLarge="BrickLarge",Km.Charts="Charts",Km.EditorialLockupHierarchicalPortrait="EditorialLockupHierarchicalPortrait",Km.EditorialLockupHierarchicalRows="EditorialLockupHierarchicalRows",Km.EditorialLockupMedium="EditorialLockupMedium",Km.EditorialLockupMediumVariant="EditorialLockupMediumVariant",Km.EditorialLockupLarge="EditorialLockupLarge",Km.EditorialLockupLargeVariant="EditorialLockupLargeVariant",Km.LockupMedium="LockupMedium",Km.Lockup4Up="Lockup4Up",Km.Poster="Poster",Km.StorySmall="StorySmall",Km.StoryMedium="StoryMedium",Km.LockupSmall="LockupSmall",Km.LockupLarge="LockupLarge",Km.BreakoutLarge="BreakoutLarge",function(e){e.QuickLinks="QuickLinks"}(im||(im={})),(Jm=sm||(sm={})).Vertical="Vertical",Jm.Horizontal="Horizontal",Jm.Condensed="Condensed",function(e){e.ShowInstalled="ShowInstalled",e.ShowAllPlatforms="ShowAllPlatforms",e.ShowOnlyPreorder="ShowOnlyPreorder"}(am||(am={})),function(e){e.AllGames="AllGames",e.ArcadeGames="ArcadeGames"}(cm||(cm={})),function(e){e.FriendsArePlaying="FriendsArePlaying",e.ContinuePlaying="ContinuePlaying"}(lm||(lm={})),function(e){e.ArcadeTabHeader="ArcadeTabHeader"}(um||(um={})),function(e){e.Arcade="Arcade"}(dm||(dm={})),function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(fm||(fm={}))
const IK="X-Apple-AppStore-UserId-Secondary"
class kK extends Error{}class OK extends Error{}const EK="x-apple-application-instance",RK="x-apple-application-site",DK=[hq,YU,JN]
!function(e){e.AppEvent="appEvent",e.ContingentOffer="contingentOffer",e.OfferItem="offerItem"}(hm||(hm={}))
class _K{constructor(e,t,n,r,o,i){this.$kind="AppEventDetailPage",this.appEvent=e,this.artwork=t,this.video=n,this.shareAction=r,this.mediaOverlayStyle=o,this.includeBorderInDarkMode=i,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class LK extends dW{constructor(e,t,n=$y){super(),this.$kind="ShareSheetAction",this.actionClass="ShareSheetAction",this.data=e,this.activities=t,this.shareSheetStyle=n}}pm=e(447)
class MK{constructor(){this.pageMetrics=new hY,this.pageRenderMetrics={}}}class xK extends MK{constructor(){super(...arguments),this.$kind="SearchResults"}}class $K{constructor(e){this.promotionType=e}}class FK extends $K{constructor(e,t,n){super(hm.ContingentOffer),this.$kind=sy,this.contingentOffer=e,this.artwork=t,this.mediaOverlayStyle=n,this.pageMetrics=new hY,this.pageRenderMetrics={},this.learnMoreActionMetrics=new sW,this.backButtonActionMetrics=new sW,this.closeButtonActionMetrics=new sW}}class NK extends $K{constructor(e,t,n,r,o,i,s){super(hm.OfferItem),this.$kind=fy,this.offerItem=e,this.artwork=t,this.learnMoreTitle=i,this.video=n,this.mediaOverlayStyle=r,this.pageMetrics=new hY,this.additionalInfo=s,this.pageRenderMetrics={},this.learnMoreActionMetrics=new sW,this.backButtonActionMetrics=new sW,this.closeButtonActionMetrics=new sW}}class BK extends dW{constructor(e,t,n,r){super(),this.$kind="OfferAction",this.actionClass="OfferAction",this.title=e,this.adamId=t,this.parentAdamId=r,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem),this.includeBetaApps=!1}}class UK extends dW{constructor(e,t){super(),this.$kind="OfferConfirmationAction",this.actionClass="OfferConfirmationAction",this.buyAction=e,this.confirmationInitiationAction=t}}class GK extends dW{constructor(){super(),this.$kind="OfferAlertAction",this.actionClass="OfferAlertAction",this.title=void 0,this.message=null,this.footerMessage=null,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=GU,this.spatialControllerRequirement=null,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class jK{constructor(e,t,n,r,o){this.$kind="MarketingItemRequestInfo",this.serviceType=e,this.placement=t,this.seed=r,this.clientOptions=o,this.metricsOverlay={topic:n}}}const VK="data.search.dataSetId",HK=ED,qK=pm.PageInvocationPoint
qK[aq]=aq,qK[Qk]=Qk,qK[qV]=qV,qK[z_]=z_
const WK=new Set([RM,hG,LM,vS,US,IB,N$,CM,SV,"iAd",fG,_M,rR,ZG,Rj,bN])
class zK{constructor(e,t,n,r,o,i){this.$kind="ShareSheetNotesMetadata",this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class YK{constructor(e,t){this.$kind="ShareSheetActivity",this.activityType=e,this.action=t}}class JK{constructor(e,t,n,r){this.$kind="ShareSheetArticleMetadata",this.context=cq,this.id=e,this.text=t,this.subtitle=n,this.artwork=r}}class KK{constructor(e,t,n){this.$kind="ShareSheetData",this.metadata=e,this.url=t,this.shortUrl=n}}class ZK{constructor(e,t,n){this.$kind="ShareSheetAppEventMetadata",this.context=FN,this.text=e,this.subtitle=t,this.artwork=n}}class QK extends dW{constructor(e,t,n,r,o,i,s,a,c){super(),this.$kind="CreateCalendarEventAction",this.actionClass="CreateCalendarEventAction",this.startDate=e,this.endDate=t,this.isAllDay=n,this.name=r,this.location=o,this.notes=i,this.url=s,this.notAuthorizedAction=a,this.availability=c}}class XK{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="ShareSheetProductMetadata",this.context=oH,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class eZ extends dW{constructor(e){super(),this.$kind="SheetAction",this.actionClass="SheetAction",this.actions=e,this.isCancelable=!1,this.cancelTitle=null,this.message=null,this.style=vq,this.isCustom=!1,this.destructiveActionIndex=null}}class tZ{constructor(e,t,n){this.$kind="ShareSheetGenericMetadata",this.context=ij,this.text=e,this.subtitle=t,this.artwork=n}}class nZ{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b){this.$kind="PurchaseConfiguration",this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=f,this.supportsVisionOSCompatibleIOSBinary=h,this.inAppEventId=p,this.extRefApp2=w,this.extRefUrl2=g,this.additionalHeaders=v,this.appCapabilities=m,this.isDefaultBrowser=y,this.remoteDownloadIdentifiers=A,this.hasMacIPAPackage=T,this.contentRating=b}}class rZ extends dW{constructor(e,t,n,r){super(),this.$kind="ArcadeSubscriptionStateAction",this.actionClass="ArcadeSubscriptionStateAction",this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class oZ extends dW{constructor(e,t){super(),this.$kind="CancelPreorderAction",this.actionClass="CancelPreorderAction",this.preorderAdamId=e,this.isArcade=t}}class iZ extends dW{constructor(e,t){super(),this.$kind="RateLimitedAction",this.actionClass="RateLimitedAction",this.actionKey=e,this.primaryAction=t}}const sZ=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase()
return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||r(e)||(this._app=e)}useClientId(e){r(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0
for(const t of e){const e=f(t)
r(e)||this._pages.push(e)}}}useNativeValues(e){const t=f(e,"nativeApp")
this.useApp(t)
const n=f(e,"nativeClientId")
this.useClientId(n)
const r=l(e,"nativePageHistory")
this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice()
return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}}
let aZ=null
const cZ={containerId:"mtContainerId",placementId:"mtIadPlacementId",templateType:"mtIadTemplateType"},lZ={TodayCardMediaAppEvent:"TodayCardMediaAppEvent",TodayCardMediaArtwork:my,TodayCardMediaBrandedSingleApp:yy,TodayCardMediaHero:"TodayCardMediaHero",TodayCardMediaList:Ay,TodayCardMediaVideo:Ty},uZ={TodayCardInAppPurchase:"TodayCardInAppPurchase",TodayCardMediaAppIcon:"TodayCardMediaAppIcon",TodayCardMediaGrid:"TodayCardMediaGrid",TodayCardMediaMediumLockupWithAlignedRegion:"TodayCardMediaMediumLockupWithAlignedRegion",TodayCardMediaMediumLockupWithScreenshots:"TodayCardMediaMediumLockupWithScreenshots",TodayCardMediaMultiApp:"TodayCardMediaMultiApp",TodayCardMediaRiver:by,TodayCardMediaSingleLockup:"TodayCardMediaSingleLockup",...lZ}
class dZ{constructor(e){this.impressionMetrics=null,this.kind=e}bestBackgroundColor(){}get searchAdOpportunity(){}}class fZ extends dZ{constructor(e,t,n,r){super(e),this.artworks=t,this.videos=n,this.artworkLayoutsWithMetrics=r}bestBackgroundColor(){var e,t,n
return null!==(t=null===(e=this.videos[0])||void 0===e?void 0:e.preview.backgroundColor)&&void 0!==t?t:null===(n=this.artworks[0])||void 0===n?void 0:n.backgroundColor}}class hZ extends fZ{constructor(e,t,n,r){super(Hq,e,t,n),this.$kind="TodayCardMediaArtwork",this.titleBackingGradient=r}}class pZ extends dZ{constructor(e,t){super(Nx),this.$kind="TodayCardMediaMultiApp",this.lockups=e,this.additionalText=t}}class wZ extends fZ{constructor(e,t){super(BU,e,t,[]),this.$kind="TodayCardMediaHero"}isValid(){const e=this.artworks.every(e=>e.isValid())&&this.artworks.length>0,t=this.videos.length>0
return e||t}}const gZ={TodayCardActionOverlay:"TodayCardActionOverlay",TodayCardAppEventLockupOverlay:"TodayCardAppEventLockupOverlay",TodayCardArcadeLockupOverlay:"TodayCardArcadeLockupOverlay",TodayCardLockupListOverlay:"TodayCardLockupListOverlay",TodayCardLockupOverlay:gy,TodayCardMarketingLockupOverlay:vy,TodayCardParagraphOverlay:Sy,TodayCardThreeLineOverlay:Py}
class vZ{constructor(e){this.kind=e}}class mZ extends vZ{constructor(e){super(UH),this.$kind="TodayCardActionOverlay",this.action=e}}class yZ extends fZ{constructor(e,t,n,r,o,i,s){super(FN,r,o,i),this.$kind="TodayCardMediaAppEvent",this.formattedDates=e,this.startDate=t,this.tintColor=n,this.blurStyle=s}}class AZ extends vZ{constructor(e){super(Bq),this.$kind="TodayCardLockupOverlay",this.lockup=e,this.displaysIcon=!0}}class TZ{constructor(e,t,n,r,o=!1,i=!1){this.$kind="PageRefreshPolicy",this.strategy=e,this.updateDelayInterval=t,this.timeSinceOnScreenInterval=n,this.timeToLiveEndDate=r,this.refreshWhileVisible=o,this.refreshForDeviceDrivenContentChange=i}}class bZ{constructor(e,t,n){this.locationTracker={rootPosition:0,locationStack:[]},this.parsedCardCount=0,this.currentRowIndex=0,this.pageInformation=e,this.locationTracker=null!=t?t:{rootPosition:0,locationStack:[]},this.refreshController=n}}class SZ extends bZ{constructor(e,t,n,r,o){super(t,n,r),this.pageHasDisplayedContent=!1,this.remainingContent=e,this.adPlacementBehavior=Xv.insertIntoShelf,this.recoImpressionData=o}}!function(e){e.AppEventCard="AppEventCard",e.AppOfTheDay="AppOfTheDay",e.FullBleedImage="FullBleedImage",e.GameOfTheDay="GameOfTheDay",e.Grid="Grid",e.InAppPurchase="InAppPurchase",e.List="List",e.NumberedList="NumberedList",e.River="River",e.ShortImage="ShortImage",e.SingleApp="SingleApp",e.Video="Video"}(wm||(wm={})),function(e){e.SmallCard="smallCard",e.MediumCard="mediumCard"}(gm||(gm={})),function(e){e.NoArtwork="no-artwork",e.ContentArtworkWithTitle="content-artwork-with-title",e.CategoryArtworkWithTitle="category-artwork-with-title",e.CategoryArtworkWithBadge="category-artwork-with-badge"}(vm||(vm={})),function(e){e.AppOfTheDay="app-of-the-day",e.GameOfTheDay="game-of-the-day"}(mm||(mm={})),function(e){e.Eyebrow="eyebrow",e.Title="title"}(ym||(ym={})),function(e){e.LinearGradient="linear-gradient"}(Am||(Am={})),function(e){e.Inline="inline",e.Article="article"}(Tm||(Tm={}))
const PZ={top:0,left:0,bottom:0,right:0}
!function(e){e.Mini="mini",e.ExtraWide="extraWide",e.None="none"}(bm||(bm={}))
const CZ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},IZ={collapsedContentMode:Hv.top,expandedContentMode:Hv.top,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},kZ={objectPath:"editorialVideo.categoryDetailMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:CZ,rtl:CZ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},{ltr:IZ,rtl:IZ,collapsedSize:{type:IV,height:1}}],sourceWidth:800,sourceHeight:450,type:jH,crops:["sr"]},OZ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},EZ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},RZ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},DZ={objectPath:"editorialArtwork.categoryDetailStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:OZ,rtl:OZ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},{maxWidth:704,ltr:EZ,rtl:EZ,collapsedSize:{type:IV,height:1.08}},{ltr:RZ,rtl:RZ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:Yj},_Z={collapsedContentMode:Hv.bottomLeft,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:PZ},LZ={collapsedContentMode:Hv.bottomLeft,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},MZ={collapsedContentMode:Hv.topLeft,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},xZ={maxWidth:250,ltr:_Z,rtl:_Z,collapsedSize:{type:IV,height:1},priority:bm.Mini},$Z={objectPath:u_,cardArtLayoutMetrics:[xZ,{maxWidth:704,ltr:LZ,rtl:LZ,collapsedSize:{type:IV,height:1.062}},{ltr:MZ,rtl:MZ,collapsedSize:{type:Sx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:Yj},FZ={collapsedContentMode:Hv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Hv.bottomLeft,expandedLayoutInsets:PZ},NZ={collapsedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedContentMode:Hv.bottomLeft,expandedLayoutInsets:PZ},BZ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},UZ={maxWidth:250,ltr:FZ,rtl:FZ,collapsedSize:{type:IV,height:1},priority:bm.Mini},GZ={objectPath:d_,cardArtLayoutMetrics:[UZ,{maxWidth:704,ltr:NZ,rtl:NZ,collapsedSize:{type:IV,height:1.062}},{ltr:BZ,rtl:BZ,collapsedSize:{type:Sx,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:Yj},jZ={collapsedContentMode:Hv.bottomLeft,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:PZ},VZ={collapsedContentMode:Hv.bottomLeft,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},HZ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},qZ={maxWidth:250,ltr:jZ,rtl:jZ,collapsedSize:{type:IV,height:1},priority:bm.Mini},WZ={objectPath:f_,cardArtLayoutMetrics:[qZ,{maxWidth:704,ltr:VZ,rtl:VZ,collapsedSize:{type:IV,height:1.062}},{ltr:HZ,rtl:HZ,collapsedSize:{type:Sx,width:1}}],crops:[pI],sourceWidth:800,sourceHeight:490,type:Yj},zZ=Hv.topRight,YZ={top:-108,left:495,bottom:0,right:0},JZ=Hv.topLeft,KZ={top:-108,left:-495,bottom:0,right:0},ZZ={type:XV,width:1124,height:482},QZ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:zZ,expandedLayoutInsets:YZ},XZ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:JZ,expandedLayoutInsets:KZ},eQ={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:-165,left:524,bottom:0,right:0},expandedContentMode:zZ,expandedLayoutInsets:YZ},tQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:-165,left:-524,bottom:0,right:0},expandedContentMode:JZ,expandedLayoutInsets:KZ},nQ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:zZ,expandedLayoutInsets:YZ},rQ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:JZ,expandedLayoutInsets:KZ},oQ={objectPath:"editorialVideo.listCardMotion21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:QZ,rtl:XZ,collapsedSize:{type:XV,width:914,height:392},expandedSize:ZZ,priority:bm.Mini},{ltr:eQ,rtl:tQ,collapsedSize:{type:XV,width:1188,height:509},expandedSize:ZZ},{ltr:nQ,rtl:rQ,collapsedSize:{type:XV,width:1456,height:624},expandedSize:ZZ,priority:bm.ExtraWide}],crops:[],sourceWidth:1208,sourceHeight:518,type:jH},iQ={collapsedContentMode:Hv.bottomRight,collapsedLayoutInsets:PZ,expandedContentMode:Hv.topRight,expandedLayoutInsets:PZ},sQ={collapsedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedContentMode:Hv.topLeft,expandedLayoutInsets:PZ},aQ={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Hv.right,expandedLayoutInsets:PZ},cQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Hv.left,expandedLayoutInsets:PZ},lQ={collapsedContentMode:Hv.scaleAspectFill,collapsedLayoutInsets:PZ,expandedContentMode:Hv.bottomRight,expandedLayoutInsets:{top:50,left:495,bottom:0,right:0}},uQ={collapsedContentMode:Hv.scaleAspectFill,collapsedLayoutInsets:PZ,expandedContentMode:Hv.bottomRight,expandedLayoutInsets:{top:50,left:-495,bottom:0,right:0}},dQ={objectPath:"editorialArtwork.listCardStatic21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:iQ,rtl:sQ,sourceCropOverrideLTR:"LCS.ApLCS01",sourceCropOverrideRTL:"LCS.ApLCS02",sourceSizeOverride:new az(550,264),priority:bm.Mini},{ltr:aQ,rtl:cQ,collapsedSize:{type:XV,width:672,height:279}},{ltr:lQ,rtl:uQ,expandedSize:{type:XV,width:1124,height:482},sourceCropOverrideLTR:wI,sourceCropOverrideRTL:wI,priority:bm.ExtraWide}],crops:["LCS.ApLCL01","LCS.ApLCL02"],sourceWidth:688,sourceHeight:286,type:Yj},fQ={collapsedContentMode:Hv.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Hv.bottomLeft,expandedLayoutInsets:PZ},hQ={collapsedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedContentMode:Hv.bottomLeft,expandedLayoutInsets:PZ},pQ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottomLeft,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},wQ={maxWidth:250,ltr:fQ,rtl:fQ,collapsedSize:{type:IV,height:1},priority:bm.Mini},gQ={objectPath:sM,cardArtLayoutMetrics:[wQ,{maxWidth:704,ltr:hQ,rtl:hQ,collapsedSize:{type:IV,height:1.062}},{ltr:pQ,rtl:pQ,collapsedSize:{type:Sx,width:1}}],crops:[pI],sourceWidth:800,sourceHeight:490,type:Yj},vQ={collapsedContentMode:Hv.center,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},mQ={objectPath:"editorialVideo.storeFrontVideo",cardArtLayoutMetrics:[{ltr:vQ,rtl:vQ,collapsedSize:{type:IV,height:1},expandedSize:{type:IV,height:1}}],crops:[],sourceWidth:875,sourceHeight:492,type:jH},yQ={collapsedContentMode:Hv.center,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},AQ={objectPath:"editorialVideo.storeFrontVideo4x3",cardArtLayoutMetrics:[{ltr:yQ,rtl:yQ,collapsedSize:{type:IV,height:1},expandedSize:{type:IV,height:1}}],crops:[],sourceWidth:656,sourceHeight:492,type:jH},TQ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},bQ={collapsedContentMode:Hv.top,expandedContentMode:Hv.top,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},SQ={objectPath:"editorialVideo.storyCardMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:TQ,rtl:TQ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},{ltr:bQ,rtl:bQ,collapsedSize:{type:IV,height:1}}],sourceWidth:800,sourceHeight:450,type:jH,crops:["sr"]},PQ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},CQ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},IQ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},kQ={maxWidth:250,ltr:PQ,rtl:PQ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},OQ={objectPath:gI,cardArtLayoutMetrics:[kQ,{maxWidth:704,ltr:CQ,rtl:CQ,collapsedSize:{type:IV,height:1.08}},{ltr:IQ,rtl:IQ}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:Yj},EQ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},RQ={collapsedContentMode:Hv.top,expandedContentMode:Hv.top,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},DQ={objectPath:"editorialVideo.storyCenteredMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:EQ,rtl:EQ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},{ltr:RQ,rtl:RQ,collapsedSize:{type:IV,height:1}}],sourceWidth:800,sourceHeight:450,type:jH,crops:["sr"]},_Q={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},LQ={collapsedContentMode:Hv.bottom,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},MQ={collapsedContentMode:Hv.scaleAspectFill,expandedContentMode:Hv.bottom,collapsedLayoutInsets:PZ,expandedLayoutInsets:PZ},xQ={maxWidth:250,ltr:_Q,rtl:_Q,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},$Q={maxWidth:704,ltr:LQ,rtl:LQ,collapsedSize:{type:IV,height:1.08}},FQ={ltr:MQ,rtl:MQ},NQ={objectPath:Ax,cardArtLayoutMetrics:[xQ,$Q,FQ],crops:["sr"],sourceWidth:800,sourceHeight:450,type:Yj},BQ={objectPath:Ax,cardArtLayoutMetrics:[xQ,$Q,FQ],crops:["nr"],sourceWidth:1280,sourceHeight:586,type:Yj},UQ={type:XV,width:1200,height:675},GQ={top:-130,left:0,bottom:0,right:0},jQ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-16,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},VQ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:-116,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},HQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:-116,left:-70,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},qQ={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:-116,left:70,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},WQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},zQ={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},YQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},JQ={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:GQ},KQ={objectPath:"editorialVideo.universalAMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:jQ,rtl:jQ,collapsedSize:{type:XV,width:455,height:256},expandedSize:UQ,priority:bm.Mini},{maxWidth:699,ltr:VQ,rtl:VQ,collapsedSize:{type:XV,width:1094,height:614},expandedSize:UQ},{maxWidth:899,ltr:HQ,rtl:qQ,collapsedSize:{type:XV,width:1092,height:614},expandedSize:UQ},{maxWidth:1090,ltr:WQ,rtl:zQ,collapsedSize:{type:XV,width:1392,height:783},expandedSize:UQ},{ltr:YQ,rtl:JQ,collapsedSize:{type:XV,width:1600,height:900},expandedSize:UQ}],crops:[vI],sourceWidth:1600,sourceHeight:900,type:jH},ZQ={collapsedContentMode:Hv.top,collapsedLayoutInsets:{top:16,left:0,bottom:0,right:0},expandedContentMode:Hv.top,expandedLayoutInsets:PZ},QQ={collapsedContentMode:Hv.scaleAspectFill,collapsedLayoutInsets:PZ,expandedContentMode:Hv.scaleAspectFill,expandedLayoutInsets:PZ},XQ={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:{top:0,left:-70,bottom:0,right:0},expandedContentMode:Hv.center,expandedLayoutInsets:PZ},eX={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:{top:0,left:70,bottom:0,right:0},expandedContentMode:Hv.center,expandedLayoutInsets:PZ},tX={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},nX={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},rX={collapsedContentMode:Hv.topLeft,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},oX={collapsedContentMode:Hv.topRight,collapsedLayoutInsets:PZ,expandedContentMode:Hv.center,expandedLayoutInsets:PZ},iX={objectPath:"editorialArtwork.universalAStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:ZQ,rtl:ZQ,collapsedSize:{type:XV,width:455,height:256},priority:bm.Mini},{maxWidth:699,ltr:QQ,rtl:QQ},{maxWidth:899,ltr:XQ,rtl:eX},{maxWidth:1090,ltr:tX,rtl:nX,collapsedSize:{type:XV,width:1400,height:527}},{ltr:rX,rtl:oX,collapsedSize:{type:XV,width:1600,height:604}}],crops:[vI],sourceWidth:1600,sourceHeight:604,type:Yj}
class sX extends vZ{constructor(e){super(wy),this.$kind="TodayCardLockupListOverlay",this.lockups=e}}class aX extends vZ{constructor(e){super("arcadeLockup"),this.$kind="TodayCardArcadeLockupOverlay",this.arcadeLockup=e}}class cX extends dW{constructor(e){super(),this.$kind="TabChangeAction",this.actionClass="TabChangeAction",this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class lX extends dW{constructor(e){super(),this.$kind="OpenGamesUIAction",this.actionClass="OpenGamesUIAction",this.target=e}}Nv.Color.fromRGB(1,90/255,80/255)
const uX="isOnBoardingCard"
class dX extends fZ{constructor(e,t,n,r,o){super(aj,t,n,r),this.$kind="TodayCardMediaBrandedSingleApp",this.icon=e,this.titleBackingGradient=o}bestBackgroundColor(){var e
return null!==(e=super.bestBackgroundColor())&&void 0!==e?e:this.icon.backgroundColor}}class fX extends dZ{constructor(e){super(BN),this.$kind="TodayCardMediaAppIcon",this.icon=e}bestBackgroundColor(){return this.icon.backgroundColor}}class hX extends dZ{constructor(e){super(NU),this.$kind="TodayCardInAppPurchase",this.lockup=e}bestBackgroundColor(){return this.lockup.icon.backgroundColor}}class pX extends fZ{constructor(e,t,n,r,o,i){super(Jk,t,n,r),this.$kind="TodayCardMediaList",this.lockups=e,this.marketingText=o,this.isMediaDark=i}}class wX extends dZ{constructor(e){super(H_),this.$kind="TodayCardMediaRiver",this.lockups=e,this.lockupImpressionLimit=10}}const gX=new Set([wm.Grid,wm.List,wm.NumberedList,wm.River]),vX={AppEvent:Lk,ContingentOffer:Mk,OfferItem:x_}
class mX{constructor(e){this.promotionType=e}}class yX extends mX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(hm.ContingentOffer),this.$kind=Mk,this.backgroundArtwork=e,this.isStreamlinedBuy=n,this.mediaOverlayStyle=t,this.titleFormatted=o,this.subtitle=i,this.additionalInfo=l,this.description=s,this.label=a,this.badge=c,this.offerLockup=d,this.trunkAppIcon=u,this.learnMoreTitle=r,this.clickAction=null}}class AX{constructor(e,t,n){this.$kind="Paragraph",this.text=e,this.mediaType=t||kV,this.style=n||Wq,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class TX{constructor(e,t,n){this.periodDuration=e,this.periodCount=t,this.type=n}isEqualTo(e){return e.periodDuration===this.periodDuration&&e.periodCount===this.periodCount&&e.type===this.type}}class bX extends mX{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(hm.OfferItem),this.$kind=x_,this.moduleArtwork=e,this.moduleVideo=t,this.isStreamlinedBuy=r,this.mediaOverlayStyle=n,this.titleFormatted=o,this.description=a,this.badge=c,this.offerLockup=d,this.subtitle=s,this.endDate=l,this.expiryDateFormatted=i,this.iapArtwork=u,this.clickAction=null}}class SX{constructor(e,t,n,r,o,i,s,a,c,l,u){this.$kind="AppEventNotificationConfig",this.appEventId=e,this.title=t,this.detail=n,this.artworkUrl=r,this.displayTime=o,this.scheduledAction=i,this.notAuthorizedAction=s,this.failureAction=a,this.destinationUrl=c,this.scheduleClickEvent=l,this.cancelScheduleClickEvent=u}}class PX extends mX{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w){super(hm.AppEvent),this.$kind=Lk,this.appEventId=e,this.moduleArtwork=t,this.moduleVideo=n,this.title=r,this.subtitle=o,this.detail=i,this.startDate=s,this.endDate=a,this.appEventBadgeKind=c,this.kind=l,this.requirements=u,this.lockup=d,this.hideLockupWhenNotInstalled=f,this.formattedDates=h,this.mediaOverlayStyle=p,this.includeBorderInDarkMode=w,this.clickAction=null}}!function(e){e.available="available",e.happening="happening",e.live="live"}(Sm||(Sm={}))
class CX{constructor(e,t,n,r,o){this.$kind="AppEventFormattedDate",this.showLiveIndicator=e,this.displayFromDate=t,this.displayText=n,this.countdownToDate=r,this.countdownStringKey=o}}const IX="RoutableArticlePageIntent"
let kX=null
const OX=[Oj,rN,FV,xq,iG,hB,nU,rU],EX=[Oj,oN,FV,iG],RX=[Oj,FV,xq,oG],DX=[Oj,rN,FV,xq,iG,hB,nU,rU,oN,oG],_X=nU
let LX=null
const MX=[hq,WA,TL,uH,jF,zA,$j,bL,SL,QB,hj,PL,uV,VO,qU,YA,JA,PO,KA,"miniGamesDeepLink","gameDisplayName"],xX=/id([0-9]+)\/?$/i,$X={915249334:"1462947752"},FX=258,NX=261,BX=265,UX=304,GX=305,jX=311,VX=312,HX=414,qX=415,WX=416,zX=417,YX=418,JX=420,KX=421,ZX=422,QX=423,XX=424,e0=425,t0=429,n0=430,r0=431,o0=437,i0=476,s0=495,a0=496,c0=497,l0=500,u0=501,d0=518,f0=548,h0=557,p0=584,w0=587,g0=566,v0=new Set([117,122,118,195,194,197,369,370,371,372,373,374,375,376,377,378,379,380,395,396,397,398,399,400,491,492,493,504,505,506,520,521,522,523,524,525,530,531,532,533,567,571]),m0=new Set([491,492,493]),y0=new Set([530,531,532,533]),A0=new Set([567,571]),T0=new Set([jX,VX,i0]),b0=new Set([...T0,d0]),S0=new Set([h0,YX,r0,t0,n0,JX,UX,GX,260,c0]),P0=new Set([413,HX,254,255,256,266,271,436])
class C0{}class I0 extends Error{}class k0 extends C0{constructor(e){super(),this.rawData=e,this.appId=null,this.groupId=null,this.score=0,this.segScores=new Map,this.modifiedScore=0,this.onDeviceScore=0}}class O0 extends C0{constructor(e){super(),this.rawData=e,this.isExactMatch=!1,this.isWildcardMatch=!1,this.isUnpersonalizedMatch=!1,this.isFallbackMatch=!1,this.appId=null,this.groupId=null,this.score=0,this.modifiedScore=0,this.onDeviceScore=0}}const E0="-1",R0={contentsNotChanged:0,contentsFiltered:1,contentsSorted:2}
class D0{constructor(e,t){this.$kind="CondensedAdLockupWithIconBackground",this.lockup=e,this.backgroundArtwork=t}}class _0 extends dZ{constructor(e){super(Bx),this.$kind="TodayCardMediaSingleLockup",this.condensedAdLockupWithIconBackground=e}bestBackgroundColor(){var e
return null===(e=this.condensedAdLockupWithIconBackground)||void 0===e?void 0:e.backgroundArtwork.backgroundColor}get searchAdOpportunity(){return this.condensedAdLockupWithIconBackground.lockup.searchAdOpportunity}}class L0{constructor(e,t,n,r,o,i){this.$kind="MediumAdLockupWithScreenshotsBackground",this.lockup=e,this.screenshots=t,this.isAnimated=n,this.secondaryTextColor=r,this.backgroundColor=o,this.riverSpeed=i}}class M0 extends dZ{constructor(e){super("mediumLockupWithScreenshots"),this.$kind="TodayCardMediaMediumLockupWithScreenshots",this.mediumAdLockupWithScreenshotsBackground=e}get searchAdOpportunity(){return this.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity}}!function(e){e.EditorialItem="editorialItem",e.EditorialItemGroup="editorialItemGroup"}(Pm||(Pm={}))
class x0{constructor(e,t,n,r,o,s,a){this.missedOpportunityReasons={},this.placementType=t,this.placementId=null===t?null:this.placementIdFromType(t),this.pageFields={},this.clickFields={},this.impressionsFields={},this.sharedImpressionsArrayFields={},this._adApplied=!1,this._adAdamId=void 0,this.positionInfo=a,this.slotInfo=n,this.setInitialAdData(e,r,o),i(s)&&(this.pageFields[vS]=s)}static from(e,t){var n,r,o,i
const s=new x0(e,f(t.placementType),l(t.slotInfo),null!==(n=f(t.iAdId))&&void 0!==n?n:void 0,null!==(r=f(t.appStoreClientRequestId))&&void 0!==r?r:void 0,null!==(o=v(t.wasOdmlSuccessful))&&void 0!==o?o:void 0,g(t.positionInfo))
return s._adApplied=u(t._adApplied),s._adAdamId=null!==(i=f(t._adAdamId))&&void 0!==i?i:void 0,Object.assign(s.pageFields,t.pageFields),Object.assign(s.clickFields,t.clickFields),Object.assign(s.impressionsFields,t.impressionsFields),Object.assign(s.sharedImpressionsArrayFields,t.sharedImpressionsArrayFields),s.updateContainerId(e,f(t.containerId)),s}static createInitialPageSlotInfos(e,t,n,r,o){var i
const s=an(e,t,!0),a=(0,Nv.isNothing)(s)?[]:s.map(e=>e.slot),c=x0.containerIdFromType(e,t)
switch(t){case NH:case rH:const t=null!==(i=null==n?void 0:n.slot)&&void 0!==i?i:0
return[{containerId:c,slots:[{slotId:`${c}_${t}`,slotIndex:t,hasAdData:!1}]}]
case zH:if(!nn(e))return null
const s=[...new Set([...null!=o?o:[],...a])]
0===s.length&&s.push(0)
const l=s.map(e=>({slotId:`${c}_${e}`,slotIndex:e,hasAdData:!1}))
return[{containerId:c,slots:l}]
case _q:const u={},d=(0,Nv.isSome)(n)?n.slot-1:null
let f=!1
return a.forEach(e=>{var t
const n=f?e-1:e,o=null==r?void 0:r.find(e=>e.containedAdSlots.includes(n)),i=d===e,s=function(e,t,n){return(0,Nv.isNothing)(n)?"0":n.type===Pm.EditorialItemGroup?(!(n.containedAdSlots.length>1)||e===n.containedAdSlots[0]||n.containedAdSlots[n.containedAdSlots.length-1],"0"):"0"}(n,0,o),a=null!==(t=u[s])&&void 0!==t?t:{containerId:s,slots:[]}
u[s]=a
const c={slotId:`${s}_${e}`,slotIndex:e,hasAdData:!1}
a.slots.push(c),f=f||i}),Object.values(u)
default:return null}}get adIsPresent(){return this._adApplied}get adAdamId(){return this._adAdamId}updateForAdResponse(e,t){var n
r(t)||(this.placementType=t.placementType,this.placementId=this.placementIdFromType(this.placementType),this.positionInfo=null===(n=t.onDeviceAd)||void 0===n?void 0:n.positionInfo,this.setInitialAdData(e,t.iAdId,t.clientRequestId))}setInitialAdData(e,t,n){if((0,Nv.isNothing)(n))return
const r=(0,Nv.isNothing)(t)?"-1":t
switch(this.pageFields[WJ.hasIAdData]=!0,this.placementType){case _q:case NH:case rH:case zH:if(on(e,this.placementType))break
this.impressionsFields[WJ.hasIAdData]=!0,this.clickFields[RM]=n,this.impressionsFields[RM]=n}if(rn(e,this.placementType)&&(this.pageFields[uR]=null,this.pageFields[dR]=null,this.pageFields[ZG]=null,this.clickFields[uR]=null,this.clickFields[dR]=null,this.impressionsFields[N$]=null,this.impressionsFields[uR]=null,this.impressionsFields[dR]=null,this.impressionsFields[ZG]=null),this.pageFields[RM]=n,this.pageFields[hG]=r,this.impressionsFields[hG]=r,this.clickFields[hG]=r,this.updateContainerId(e,null),this.updateSlotInfo(),(0,Nv.isSome)(this.placementId)&&this.placementId.length>0)switch(this.pageFields[fG]=this.placementId,this.clickFields[fG]=this.placementId,this.impressionsFields[fG]=this.placementId,this.placementType){case _q:case NH:case rH:case zH:if(on(e,this.placementType))break
this.sharedImpressionsArrayFields[fG]=this.placementId}}updateContainerId(e,t){this.placementType===_q?(this.containerId=null!=t?t:null,i(this.containerId)&&(this.clickFields[IB]=this.containerId,this.sharedImpressionsArrayFields[IB]=this.containerId)):(this.containerId=x0.containerIdFromType(e,this.placementType),i(this.containerId)&&(this.pageFields[IB]=this.containerId,this.clickFields[IB]=this.containerId))}containerIdForSlotIndex(e){if((0,Nv.isNothing)(e)||(0,Nv.isNothing)(this.slotInfo))return null
for(const t of this.slotInfo)for(const n of t.slots)if(n.slotIndex===e)return t.containerId
return this.containerId}apply(e,t){if((0,Nv.isNothing)(t)||o(t))return
const n=t.id,r=B(t,CG)
if(this._adAdamId=n,r){this.impressionsFields[WJ.hasIAdData]=!0,this.clickFields[WJ.hasIAdData]=!0
const o=sh(r[j$])
this.clickFields[N$]=o
const i=sh(r[fR])
this.clickFields[CM]=i,this.pageFields[SV]=n,this.pageFields.iAd={iAdFormat:ch(g(m(r),"format")),iAdAlgoId:sh(r.algoId),iAdImpressionId:sh(r[j$]),iAdMetadata:sh(r[fR])}
const s=Ge(e,t)
this.updateIAdMetricsFieldsForProductVariantData(s,this.clickFields),this._adApplied=!0}this.updateSlotInfo()}applyClickFieldsFromPageRequest(e,t){this._adApplied=!0,this._adAdamId=e,Object.assign(this.clickFields,t),Object.keys(this.pageFields).forEach(e=>delete this.pageFields[e])}setSpecifiedCreativeUsed(e){this.clickFields[qb]=e}setTemplateType(e,t){this.placementType===zH&&nn(e)?this.sharedImpressionsArrayFields[ZG]=t:(this.pageFields[ZG]=t,this.impressionsFields[ZG]=t),this.clickFields[ZG]=t}recordLockupFromDataFailed(e,t,n){this.setMissedOpportunity(e,DM,t,n)}recordAdResponseEventsIfNeeded(e,t,n,r){if(!(0,Nv.isNothing)(null==t?void 0:t.failureReason)&&0!==(null==t?void 0:t.failureReason.length))switch(null==t?void 0:t.failureReason){case cA:case hO:case"insufficientAssets":this.setMissedOpportunity(e,DM,n,r)
break
case"noAdAvailable":this.setMissedOpportunity(e,V$,n,r)
break
case"timeout":this.setMissedOpportunity(e,"APSLA",n,r)
break
case lA:this.setMissedOpportunity(e,"NOLOC",n,r)
break
case"policyAdDrop":this.setMissedOpportunity(e,mS,n,r)}}setMissedOpportunity(e,t,n,r){var o,i
switch(null!==(o=(i=this.missedOpportunityReasons)[n])&&void 0!==o||(i[n]={}),this.missedOpportunityReasons[n][r]=t,this.clickFields[_M]=t,this.placementType){case _q:case NH:case rH:break
default:if(rn(e,this.placementType))break
this.pageFields[_M]=t,this.impressionsFields[_M]=t}this.updateSlotInfo()}missedOpportunityReason(e,t){var n
return null===(n=this.missedOpportunityReasons[e])||void 0===n?void 0:n[t]}placementIdFromType(e){switch(e){case oV:return yS
case zH:return oR
case _q:return AS
case NH:return TS
case rH:return bS
default:throw new Error(`This method should never be called with value: ${e}`)}}static placementTypeFromPlacementId(e,t){switch(t){case yS:return oV
case oR:return zH
case AS:return _q
case TS:return NH
case bS:return rH
default:return e.console.log(`Failed to get placementType from placementId ${t}. Defaulting to searchResults`),zH}}static containerIdFromType(e,t){switch(t){case NH:return vG
case rH:return pO
case _q:return null
case zH:return nn(e)?"0":null
default:return null}}impressionsArrayFieldsForCurrentItem(e,t,n){if(this.placementType!==_q)return{}
const r=zs(t,n)
return{iAdSlotId:`${this.containerIdForSlotIndex(r)}_${r}`}}get adjustedSlotIndex(){var e
const t=null===(e=this.positionInfo)||void 0===e?void 0:e.slot
return i(t)?t-1:null}updateSlotInfo(){var e,t
if(!(0,Nv.isNothing)(this.slotInfo)){switch(this.placementType){case NH:case rH:case zH:for(const t of this.slotInfo)for(const n of t.slots){if((0,Nv.isSome)(t.containerId)){const r=null===(e=this.missedOpportunityReasons[t.containerId])||void 0===e?void 0:e[n.slotIndex];(0,Nv.isSome)(r)&&(n.missedOpportunityReason=r)}n.hasAdData=this.adIsPresent&&(0,Nv.isNothing)(n.missedOpportunityReason)}break
case _q:const n=this.adjustedSlotIndex
for(const e of this.slotInfo)for(const r of e.slots){const o=n===r.slotIndex,s=this.adIsPresent&&o
let a;(0,Nv.isSome)(e.containerId)&&(a=null===(t=this.missedOpportunityReasons[e.containerId])||void 0===t?void 0:t[r.slotIndex],(0,Nv.isSome)(a)&&(r.missedOpportunityReason=a)),!o&&i(n)&&(a=V$),r.hasAdData=s,(0,Nv.isSome)(a)&&(r.missedOpportunityReason=a)}}(0,Nv.isSome)(this.slotInfo)&&this.slotInfo.length>0&&(this.pageFields[LM]=this.slotInfo,this.clickFields[LM]=this.slotInfo,this.impressionsFields[LM]=this.slotInfo)}}updateIAdMetricsFieldsForProductVariantData(e,t){(0,Nv.isSome)(e)&&Ye(e,MM)?t[SS]=e.productPageId:delete t[SS]}updateIAdMetricsFieldsForAlignedRegion(e,t){}fastImpressionsEventVersion(e){switch(this.placementType){case NH:case rH:case _q:return 5
case zH:return nn(e)?5:4
default:return 4}}shouldIncludeAdRotationFields(e){switch(this.placementType){case NH:case rH:case _q:return!1
case oV:return!0
case zH:return!nn(e)
default:return!0}}shouldIncludeAdFieldsForPad(e){return!!e.client.isPad&&0===Object.keys(this.missedOpportunityReasons).length}}const $0="externalDeepLinkUrl",F0="isCppDeepLinkDisabled"
class N0{constructor(e){this.$kind="EditorsChoice",this.showsBadge=!1,this.title=void 0,this.notes=e,this.isCollapsed=!0}}const B0={11:"43",30:"44"},U0=eD,G0="ReviewsPage.ShelfId",j0=new Set([Oq,Iq,Lq])
class V0{constructor(e,t,n){this.sectionType=e,this.shelfId=t,this.shelfBasedMappedIds=n}createProductPageSection(e){return j0.has(this.sectionType)?new zY(this.sectionType,null):new zY(this.sectionType,this.shelfId)}createShelfIdList(){return this.shelfBasedMappedIds||[this.shelfId]}}const H0=5,q0=5,W0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(nW,MH),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,OU,sF,_j]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],z0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(nW,MH),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,Nj,wG,FG,_j,EU,RU]),new V0(nW,EU),new V0(nW,wG),new V0(nW,FG),new V0(nW,RU),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],Y0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,MH),new V0(nW,_V),new V0(nW,EH),new V0(nW,AH),new V0(nW,bq,[gH,OU,_j]),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],J0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,MH),new V0(nW,_V),new V0(nW,EH),new V0(nW,AH),new V0(nW,bq,[gH,Nj,wG,FG,_j]),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],K0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,HH),new V0(nW,NG),new V0(nW,mG),new V0(nW,MH),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,OU,sF,_j]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH)],Z0=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,DB),new V0(nW,VV),new V0(nW,HH),new V0(nW,NG),new V0(nW,mG),new V0(nW,MH),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,Nj,wG,FG,_j,EU,RU]),new V0(nW,EU),new V0(nW,wG),new V0(nW,FG),new V0(nW,RU),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH)],Q0=5,X0=5,e1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(nW,MH),new V0(nW,LV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,OU,sF,_j]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],t1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(nW,MH),new V0(nW,LV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,Nj,wG,FG,_j,EU,RU]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],n1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,EH),new V0(nW,AH),new V0(nW,bq,[gH,OU,_j]),new V0(nW,MH),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],r1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,EH),new V0(nW,AH),new V0(nW,bq,[gH,Nj,wG,FG,_j]),new V0(nW,MH),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],o1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(nW,HH),new V0(nW,MH),new V0(nW,LV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,sF,OU,_j]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH)],i1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,RB),new V0(nW,VV),new V0(nW,HH),new V0(nW,MH),new V0(nW,LV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,AH),new V0(nW,bq,[gH,EU,Nj,wG,FG,_j,RU]),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH)],s1=5,a1=5,c1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(nW,MH),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,bq),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],l1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,VV),new V0(nW,NG),new V0(nW,mG),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,MH),new V0(nW,_V),new V0(nW,EH),new V0(nW,bq),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,bj),new V0(nW,Tj),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,kH),new V0(nW,HH)],u1=5,d1=5,f1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,VV),new V0(nW,MH),new V0(nW,LV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,bq),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],h1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,xH),new V0(nW,VV),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,_V),new V0(nW,EH),new V0(nW,bq),new V0(nW,MH),new V0(nW,Cq),new V0(nW,tq),new V0(nW,LV),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,tH),new V0(nW,HH),new V0(nW,kH)],p1=5,w1=5,g1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,Cq),new V0(nW,tq),new V0(nW,_U),new V0(nW,kH),new V0(nW,HH),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,CF)],v1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,EH),new V0(nW,DU),new V0(nW,Cq),new V0(nW,tq),new V0(nW,kH),new V0(nW,HH),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,CF)],m1=5,y1=5,A1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,Cq),new V0(nW,tq),new V0(nW,_U),new V0(nW,HH),new V0(nW,kH),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,CF)],T1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,EH),new V0(nW,DU),new V0(nW,Cq),new V0(nW,tq),new V0(nW,HH),new V0(nW,kH),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,CF)],b1=5,S1=5,P1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,VV),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,aF),new V0(nW,_U),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,kH),new V0(nW,HH)],C1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,VV),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,EH),new V0(nW,aF),new V0(nW,DU),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,kH),new V0(nW,HH)],I1=5,k1=5,O1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,VV),new V0(nW,Cq),new V0(nW,tq),new V0(nW,EH),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,aF),new V0(nW,_U),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,Jj),new V0(nW,ZH),new V0(nW,HH),new V0(nW,kH)],E1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,VV),new V0(Lq,Lq),new V0(nW,yG),new V0(nW,EH),new V0(nW,aF),new V0(nW,DU),new V0(nW,Cq),new V0(nW,tq),new V0(nW,YH),new V0(nW,GH),new V0(nW,OH),new V0(nW,SH),new V0(nW,IH),new V0(nW,bH),new V0(nW,Aq),new V0(nW,oj),new V0(nW,ZH),new V0(nW,HH),new V0(nW,kH)],R1=3,D1=3,_1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(nW,LV),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,YH),new V0(nW,GH),new V0(nW,xx)],L1=[new V0(Oq,Oq),new V0(Iq,Iq),new V0(Lq,Lq),new V0(nW,hq),new V0(nW,LV),new V0(nW,YH),new V0(nW,GH),new V0(nW,xx)],M1=H0,x1=q0,$1=[...W0],F1=[...z0],N1=[...Y0],B1=[...J0],U1=[...K0],G1=[...Z0],j1=Q0,V1=X0,H1=[...e1],q1=[...t1],W1=[...n1],z1=[...r1],Y1=[...o1],J1=[...i1]
class K1{constructor(e,t,n=kV,r=null,o=null,i=null){this.$kind="FramedVideo",this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===PF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class Z1{constructor(e){this.$kind="ProductMediaGalleryPage",this.productMedia=e,this.pageMetrics=new hY,this.pageRenderMetrics={}}}const Q1="product_media",X1=new Set([bH,IH,SH,Cq,xx,MH,NG,mG,ZH,hq,_V,tH,tq,Tj,Aq,xH,oj,Jj,kH,LV,VV,OH,YH,GH,bq,HH,bj,yG,CF,EH])
class e2{constructor(e,t){this.$kind="ProductPageExpandedOfferDetails",this.title=e,this.subtitle=t}}class t2{constructor(e,t,n,r,o,i,s,a,c){this.$kind="Banner",this.message=e,this.focusedMessage=t,this.action=n,this.fullProductAction=r,this.leadingArtwork=o,this.leadingArtworkTintColor=i,this.includeBackgroundBorder=s,this.kind=a,this.hideCriteria=c}}class n2{constructor(e,t,n,r,o){this.$kind="AppStateBanner",this.unknownBanner=e,this.buyBanner=t,this.downloadBanner=n,this.updateBanner=r,this.openBanner=o}}const r2="notPurchasedOrdering"
class o2{constructor(e){this.$kind="Uber",this.style=e}isValidUber(e,t){function n(e){return null!=e&&0!==Object.keys(e).length}return n(this.artwork)||n(this.compactArtwork)||n(this.video)||n(this.compactVideo)||(e||t)&&n(this.iconArtwork)}}class i2 extends dW{constructor(e){super(),this.$kind="SelectAppAction",this.actionClass="SelectAppAction",this.adamId=e}}class s2{constructor(e,t){this.$kind="DynamicUIRequestInfo",this.clientOptions=t,this.metricsOverlay={topic:e}}}class a2{constructor(){this.$kind="ArcadeDownloadPackCard"}}class c2{constructor(){this.$kind="Placeholder"}}const l2={shelfIdentifier:"first",slot:0},u2="SLPPage",d2=VH,f2="RoomPageIntent"
Cm=e(8836)
class h2{constructor(e){this.builderClass=e}async handleShelf(e,t,n,r){throw new Error(`${this.builderClass} does not implement handleShelf`)}async handlePagination(e,t,n,r,o){throw new Error(`${this.builderClass} does not implement handlePagination`)}shelfRoute(e){return[{protocol:hW,path:`${this.shelfPath}{data}`}]}paginationRoute(e){return[{protocol:hW,path:`${this.paginationPath}`}]}shelfUrl(e){return`${hW}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${yW.shelf}/`}get paginationUrl(){return`${hW}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${yW.lookup}/`}static createFlowAction(e,t,n){const r=new fY(t)
return r.pageUrl=n.build(),r.pageData=e,r}}!function(e){e.Page="page",e.Shelf="shelf",e.Pagination="pagination"}(Im||(Im={}))
class p2 extends h2{defaultAttributes(e){return[]}defaultTab(e){return null}prepareRequest(e,t,n,r,o){t.includingAdditionalPlatforms(this.defaultPlatforms(e)),t.includingAttributes(this.defaultAttributes(e)),t.usingCustomAttributes(Ue(e))}defaultAction(e,t,n,r){return p2.createFlowAction(t,this.pageType(),r)}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{var r
let i
const s=t.build()
if($i(e,t)?i=new Jz(e,s):((0,Nv.isSome)(o)&&(n[DW.includeUnlistedApps]="1"),i=this.generatePageRequest(e,t,n)),!i)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,i,Im.Page,t,n),i.attributingTo(s)
const a=null!==(r=e.fetchTimingMetricsBuilder)&&void 0!==r?r:new Cm.FetchTimingMetricsBuilder,c=void 0===e.fetchTimingMetricsBuilder?e.addingFetchTimingMetricsBuilder(a):e
let l
l=_(Ln(c,i)),l.then(t=>{ac(e,e.user.dsid,t)})
const u=this.generateAdditionalPageRequirements(e,t,n),d=await ic(e,l,u)
let f={originalData:d.primaryPageData}
this.supportsDataAugmenting()&&(f=await this.augmentData(c,t,n,d.primaryPageData))
const h=await a.measureModelConstructionAsync(async()=>await this.renderPage(c,f.originalData,n,d.additionalData,f.additionalData,o)),p=this.defaultTab(h),w=this.defaultAction(e,h,n,t),g=n[DW.isPPT]
if(t.removeParam(DW.isPPT),null===p||g)return w
{const e=new cX(p)
return e.actions=[w],e}},async e=>await this.handlePageError(e,t,n))}async handlePageError(e,t,n){throw e}async handleShelf(e,t,n,r){return await Va(`${this.builderClass}.handleShelf`,async()=>{let r
const o=t.build()
if(r=$i(e,t)?new Jz(e,o):this.generateShelfRequest(e,t,n),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,Im.Shelf,t,n),r.attributingTo(t.build())
const i=await Ln(e,r),s=await this.renderShelf(e,i,n)
return this.shelfRequiresAdditionalModification(s,n)?await this.performAdditionalShelfModifications(e,s,n):s},async e=>await this.handleShelfError(e,n))}async performAdditionalShelfModifications(e,t,n){return t}shelfRequiresAdditionalModification(e,t){return!1}async handleShelfError(e,t){throw e}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>{let r
const i=t.build()
if(r=$i(e,t)?new Jz(e,i):this.generatePaginationRequest(e,t,n,o),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,Im.Pagination,t,n),r.attributingTo(t.build())
const s=await Ln(e,r)
return await this.renderPaginatedPage(e,s,o)},async e=>await this.handlePaginationError(e,n,o))}async handlePaginationError(e,t,n){throw e}generateAdditionalPageRequirements(e,t,n){return{}}generateShelfRequest(e,t,n){throw new Error(`generateShelfRequest is not supported on: ${this.builderClass}`)}generatePaginationRequest(e,t,n,r){throw new Error(`generatePaginationRequest is not supported on: ${this.builderClass}`)}supportsDataAugmenting(){return!1}async augmentData(e,t,n,r){const o={url:t,parameters:n}
return await sc(e,r,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,o)}additionalDataKeysNeededForData(e,t,n){return null}fetchAdditionalDataForKey(e,t){return null}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async renderPaginatedPage(e,t,n){throw new Error(`renderPaginatedPage is not supported on: ${this.builderClass}`)}}km=e(1974)
class w2{constructor(){this.profile=Bq,this.maxPerPage=20}}class g2 extends p2{defaultAttributes(e){return rc(e)}defaultPlatforms(e){return ee(e)}pageType(){return eW}generatePaginationRequest(e,t,n,r){return new Jz(e,r.remainingContent)}async renderPaginatedPage(e,t,n){const r=n
return await this.pageWithContent(e,t,r)}async pageWithContent(e,t,n,r=!0){return await Va("pageWithContent",async()=>function(e,t,n,r=!0){var o
const i=n.preferredShelfContentType||d2,s=new YY(i),a={id:null,kind:null,softwareType:null,targetType:KH,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:Xj,recoMetricsData:null!==(o=St(t))&&void 0!==o?o:{}}
Oh(e,s,a),gh(0,a,n.title),s.isHorizontal=!1,s.shouldFilterApps=n.shouldFilter
const c=At(t)
r&&(n.remainingContent=[]),s.items=Rd(e,c,{contentUnavailable:(e,t)=>(r&&(n.remainingContent=It(0,c,e)),!0),lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:Hd(0,i)}})
const l=new ZY([s])
return n.remainingContent.length&&(l.nextPage=n),l}(e,t,n,r))}}class v2 extends g2{requestWithFilter(e,t,n){return new Jz(e).forType(Kq).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(t,n)}async renderPage(e,t,n,r){return await Va(mj,async()=>{const r=new w2
r.url=this.paginationUrl,r.metricsPageInformation=this.pageInformation(e,t,n),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const o=await this.pageWithContent(e,t,r)
return jn(e,o,r.metricsPageInformation),o})}}const{routes:m2,makeCanonicalUrl:y2}=uc(oc,"/room/{id}"),{routes:A2,makeCanonicalUrl:T2}=uc(oc,"/{platform}/room/{id}"),b2="top-paid",S2="top-free",P2="top-free-safari-extensions",C2="top-paid-safari-extensions",I2="top-trending-free",k2="top-trending-paid",O2="top-emerging-free",E2="top-emerging-paid"
class R2{constructor(e,t,n,r){this.$kind="GameCenterGameplayHistory",this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class D2{constructor(e,t){this.$kind="GameCenterGameplayHistoryRecord",this.playerId=e,this.timestamp=t}}class _2 extends dW{constructor(e){super(),this.$kind="CrossfireReferralAction",this.actionClass="CrossfireReferralAction",this.referrerData=e}}class L2{supports(e,t,n,r){return this._supports(e,t,n,r)}_supports(e,t,n,r){const o=this.supportedFeaturedContentIds.has(n)
let s
return s=!i(r)||this.supportedNativeGroupingShelfIds.has(r),o&&s}createShelf(e,t,n,o,a){var c,l,u
const d=t,f=this.initialShelfDataFromGroupingMediaApiData(e,d),h=this.shelfTokenFromBaseTokenAndMediaApiData(e,d,o,n),p=this.shelfMetricsOptionsFromBaseMetricsOptions(e,h,a),w=s(p)
w&&this.shouldImpressShelf()&&gh(0,p,h.title),s(f.shelfContents)&&(f.shelfContents=wn(f.shelfContents,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(l=null==a?void 0:a.recoMetricsData)&&void 0!==l?l:{}))
const g=this._createShelf(e,h,f,n)
if(w&&this.shouldImpressShelf()&&(mh(p.locationTracker),i(g)&&(Oh(e,g,p),(null===(u=g.url)||void 0===u?void 0:u.length)>0&&s(g.impressionMetrics)&&h.showingPlaceholders))){const e=g.url
try{const t=qW.from(e).pathComponents().pop(),n=JSON.parse(decodeURIComponent(t))
n.originalPlaceholderShelfImpressionMetrics=g.impressionMetrics,function(e,t,n){const o=qW.from(t.url),i=qW.from(Ki(0,t,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,g,n)}catch{g.url=e}}return this.finalizeInitialShelfForDisplay(e,g,h,f,n),w&&this.shouldPrepareLocationTrackerForNextPosition()&&bh(n.metricsLocationTracker),g}constructor(e){this.supportedFeaturedContentIds=new Set([]),this.supportedNativeGroupingShelfIds=new Set([]),this.builderClass=e}incompleteShelfFetchStrategy(e){return zv.OnShelfWillAppear}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return n}shouldImpressShelf(){return!0}shouldPrepareLocationTrackerForNextPosition(){return!0}finalizeInitialShelfForDisplay(e,t,n,r,i){var a,c
if(o(t))return
n.isSearchLandingPage&&as(0,t,n),(null===(a=t.url)||void 0===a?void 0:a.length)>0&&s(i.additionalShelfParameters)&&(t.url=qW.from(t.url).append(KG,i.additionalShelfParameters).build()),t.fetchStrategy=this.incompleteShelfFetchStrategy(e)
const l=(0,Nv.isSome)(t)&&(null===(c=t.url)||void 0===c?void 0:c.length)>0
o(t.items)&&!l&&(t.isHidden=!0),t.accessibilityMetadata=wc(e,t)}finalizeSecondaryShelfForDisplay(e,t,n,i){if(!o(t)){if(n.remainingItems.length){const t=n.remainingItems.map(e=>e.id)
e.console.warn("Could not load items for: "+t.join(","))}var a,c
if(t&&(t.mergeWhenFetched=((c=n).shelfStyle,!(c.showingPlaceholders||c.shelfStyle===oM||c.shelfStyle===_E&&(0,Nv.isSome)(c.initialHydratedItems)&&c.initialHydratedItems.length>0)),t.networkTimingMetrics=i.responseTimingValues,t.nextPreferredContentRefreshDate=null==(a={timeToLive:null,nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:!1})?void 0:a.nextPreferredContentRefreshDate),s(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])
!n.hasExistingContent&&o(t.items)&&(t.isHidden=!0),n.isSearchLandingPage&&as(0,t,n),t.accessibilityMetadata=wc(e,t)}}async handleShelf(e,t,n,r){const o=n[Wj],i=JSON.parse(o)
i.isFirstRender=!1
try{const r=await this.secondaryShelfDataForShelfUrl(e,t,i,n),o=this._createShelf(e,i,r,null)
return this.finalizeSecondaryShelfForDisplay(e,o,i,r),o}catch(e){if(i&&!i.hasExistingContent){const e=new YY(i.shelfStyle)
return e.isHidden=!0,e}throw e}}shelfRoute(e){return s(this.supportedNativeGroupingShelfIds)?function(e,t){const n=[]
for(const t of e)n.push(gc(-1,t,void 0))
return n}(this.supportedNativeGroupingShelfIds):vc(this.supportedFeaturedContentIds)}static async secondaryGroupingShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const r=function(e,t,n){var r
const o=(null===(r=t.relationshipToFetch)||void 0===r?void 0:r.length)>0
let i=At(n)
if(o){const r={}
for(const e of n.data)r[e.id]=e
i=[]
for(const n of t.remainingItems){const o=pe(e,n,t.relationshipToFetch)
s(o)&&(n.relationships[t.relationshipToFetch].data=[r[o.id]]),i.push(n)}}return i}(e,n,t)
return{shelfContents:r,responseTimingValues:t[fm.timingValues]}})}static async secondaryGroupingShelfMediaApiData(e,t,n,r){const o=t.build()
let i
return i=$i(e,t)?new Jz(e,o):Qi(e,n),i?(i.includingAdditionalPlatforms(function(e){return ee(e)}(e)),i.includingAttributes(function(e){const t=[Tq,zV,JV,sU]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}(e)),i.usingCustomAttributes(Ue(e)),i.attributingTo(t.build()),await Ln(e,i).then(e=>(Zi(n,i.ids),e))):await Promise.reject(new Error(`Could not construct media API request for: ${t}`))}}class M2 extends L2{constructor(){super("GroupingGameCenterPopularWithYourFriendsController"),this.batchGroupKey=hV,this.supportedFeaturedContentIds=new Set([s0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isGameCenterPopularWithYourFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.gameCenter.fetchGamesPopularWithFriends(this.gameCategoryFilter(n.gamesFilter),30)
return await o.then(async t=>{const n=t.map(e=>this.gameplayHistoryFromData(e)).sort((e,t)=>t.records.length-e.records.length).filter(t=>this.isCompatibleGameCenterPlatform(e,t.platformId)).map(e=>e.adamId)
if(0===n.length){const e={shelfContents:[]}
return await Promise.resolve(e)}const r=new Jz(e).withIdsOfType(n.slice(0,100),Kq).includingAgeRestrictions()
return Xi(e,r),await Ln(e,r,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[fm.timingValues]}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return zv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingPopularWithFriendsShelfForGrouping(e,n,t):this.popularWithFriendsShelfForGrouping(e,n,t)}pendingPopularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelfForGrouping(e,t,n),o=qW.from(Ji(n))
return r.url=o.param(DW.isGameCenterPopularWithYourFriendsShelf,XH).build(),r}popularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelf(e,t.shelfContents,n)
return r.mergeWhenFetched=!0,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header.title=n.title,r.header.subtitle=n.subtitle,r}popularWithFriendsShelf(e,t,n){const r=n.shelfStyle||VH,o=new YY(r)
o.isHorizontal=!0
const s=[]
for(let o=0;o<t.length;o++){const a=t[o],c={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(a),anonymizationOptions:{anonymizationString:`"GAME"${o+1}`}},artworkUseCase:Hd(0,r),canDisplayArcadeOfferButton:Yf(0,r),shouldHideArcadeHeader:e.featureFlags.isEnabled(nJ)&&n.isArcadePage,shouldShowFriendsPlayingShowcase:!0},l=et(e,a,fB)
if(H(a,eq)||!l)continue
const u=Ad(e,a,c)
u.clickAction=mc(e,u.clickAction),i(u)&&(s.push(u),bh(c.metricsOptions.locationTracker))}let a
switch(e.client.deviceType){case jq:a=2
break
case $q:case Yq:case"tv":a=6
break
default:a=0}if(o.header=oo(e),s.length<a)return o.isHidden=!0,o
if(o.items=s.slice(0,12),o.isHidden=!1,o.batchGroup=hV,s.length>12){const t=new YY(VH)
t.items=s,t.rowsPerColumn=1
const r=new ZY([t])
r.title=n.title
const i=new fY(eW)
i.title=e.loc.string(KV),i.pageData=r,Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),fs(e,o,i)}return o.footerTitle=e.loc.string(_$),o.footerAction=ro({objectGraph:e,metricsLocationTracker:n.metricsLocationTracker,metricsPageInformation:n.metricsPageInformation}),o.footerStyle={$kind:_H,bundleID:gN,width:16,height:16},o}isCompatibleGameCenterPlatform(e,t){return 1===t}gameplayHistoryFromData(e){const t=f(e,SV),n=h(e,"platformId"),r=u(e,VE),o=this.gameplayHistoryRecordFromData(l(e,"records"))
return new R2(t,n,r,o)}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=f(e,"playerId"),n=h(e,"timestamp")
return new D2(t,n)})}gameCategoryFilter(e){return e===aM?jE:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:Xj}}}class x2 extends L2{constructor(){super("ArcadeDownloadPackShelfController"),this.shelfId="arcadeDownloadPackShelf",this.supportedFeaturedContentIds=new Set([g0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isArcadeDownloadPackShelfPlaceholder]}]}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return yc(e,t,n,r)}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],categoriesContents:[],apps:[],title:""}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Uv.isNothing)(o)||0===o.apps.length)return{shelfContents:[],categoriesContents:[],apps:[],title:""}
const i=o.apps,s=this.shelfTitle(e,za(o.subscriptionStatus))
if((0,Uv.isSome)(t.query[DW.isArcadeDownloadPackShelfPlaceholder]))return{shelfContents:[],categoriesContents:[],apps:i,title:s}
const a=i.map(e=>e.adamId),c=i.map(e=>e.categoryId),l=Kq,u=Nq,d=new Jz(e).addingQuery(`ids[${l}]`,Array.from(a).join(",")).addingQuery(`ids[${u}]`,Array.from(c).join(",")).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e))
return await Ln(e,d).then(async e=>({shelfContents:e.data.filter(e=>e.type===l),categoriesContents:e.data.filter(e=>e.type===u),apps:i,title:s,responseTimingValues:e[fm.timingValues]}))}_createShelf(e,t,n,r){if(t.isFirstRender){const n=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Uv.isNothing)(n)||0===n.apps.length){const n=this.emptyShelfWithRefreshUrl(e)
return n.refreshUrl=this.shelfRefreshURL(t),bh(r.metricsLocationTracker),n}{const o=this.placeholderShelf(e,t,n.apps,this.shelfTitle(e,za(n.subscriptionStatus)))
return bh(r.metricsLocationTracker),o}}if(n.apps.length>0&&((0,Uv.isNothing)(n.shelfContents)||0===n.shelfContents.length))return this.placeholderShelf(e,t,n.apps,n.title)
{const r=this.shelfMetrics(n.title,t)
gh(0,r,n.title)
const o=this.downloadPackShelf(e,t,n)
return o.refreshUrl=this.shelfRefreshURL(t),mh(t.metricsLocationTracker),Oh(e,o,r),o}}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return null}emptyShelfWithRefreshUrl(e){const t=new YY(this.useCustomDownloadPackCardShelf(e)?oM:dq)
return t.id=this.shelfId,t.isHidden=!0,t}placeholderShelf(e,t,n,r){const o=this.useCustomDownloadPackCardShelf(e)?this.downloadPackCardPlaceholderShelf(e,t,n.length):this.smallLockupsPlaceholderShelf(e,t,n)
return o.url=qW.from(Ji(t)).build(),o.title=r,o}downloadPackCardPlaceholderShelf(e,t,n){const r=new YY(oM)
r.id=this.shelfId
const o=new a2
return o.numberOfPlaceholders=n,r.items=[o],t.shelfStyle=r.contentType,r}smallLockupsPlaceholderShelf(e,t,n){const r=new YY(dq)
return r.id=this.shelfId,r.items=[],r.isHorizontal=!0,r.rowsPerColumn=2,r.items=Array(n.length).fill(new c2),r.placeholderContentType=r.contentType,r.contentType=dN,t.showingPlaceholders=!0,t.remainingItems=n.map(e=>({id:e.adamId,type:Kq})),r}downloadPackShelf(e,t,n){const r=this.categoriesMapFromResponse(e,n.categoriesContents,n.apps),o=this.useCustomDownloadPackCardShelf(e),i=o?oM:dq,s=this.lockupsFromResponse(e,t,r,o,o,Hd(0,i),(0,Uv.isSome)(n.shelfContents)?n.shelfContents:[],n.apps),a=new YY(i)
if(a.id=this.shelfId,a.title=n.title,o){const e=new a2
e.lockups=s,a.items=[e]}else a.items=s,a.isHorizontal=!0,a.rowsPerColumn=2
return a.isHidden=0===s.length,a}useCustomDownloadPackCardShelf(e){return e.client.isPhone}shelfRefreshURL(e){return qW.from(Ji(e)).param(DW.isArcadeDownloadPackShelfPlaceholder,XH).build()}lockupsFromResponse(e,t,n,r,o,i,s,a){return Bv.context("lockupsFromResponse",()=>{const c=new Map
for(const e of s)c.set(e.id,e)
const l=t.metricsLocationTracker,u=t.metricsPageInformation,d=[]
for(const t of a){const s=c.get(t.adamId)
if((0,Uv.isNothing)(s))continue
const a=Ad(e,s,{offerStyle:o?uj:void 0,offerEnvironment:o?kq:void 0,metricsOptions:{pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},metricsClickOptions:{id:s.id,pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},artworkUseCase:i,shouldHideArcadeHeader:!0,isSubtitleHidden:r});(0,Uv.isNothing)(a)||(Vd(a,e),bh(l),r?a.heading=n.get(a.adamId):a.subtitle=n.get(a.adamId),d.push(a))}return d})}categoriesMapFromResponse(e,t,n){const r=new Map
for(const o of n){const n=t.find(e=>e.id===o.categoryId)
if(!n)continue
const i=Gf(e,n,Zq)
r.set(o.adamId,i)}return r}shelfTitle(e,t){return e.loc.string(t===NN?"Arcade.DownloadPack.ShelfTitle.NewUser":"Arcade.DownloadPack.ShelfTitle")}shelfMetrics(e,t){return{id:t.id,kind:null,softwareType:nq,targetType:KH,title:e,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:Xj,fcKind:t.featuredContentId}}}class $2 extends L2{constructor(){super("GroupingAppEventShelfController"),this.supportedFeaturedContentIds=new Set([519,d0])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
if(!((null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0)){const t=[],r=[],o=[]
for(const e of n.remainingItems)switch(e.type){case iV:r.push(e)
break
case EV:o.push(e)
break
case Vq:t.push(e)}const i=new Jz(e,t)
Je(e,i,t)
const s=new Jz(e,r)
Je(e,s,r)
const a=new Jz(e,o)
Je(e,a,o)
const c=await Promise.all([this.fetchRemainingItems(e,i),this.fetchRemainingItems(e,s),this.fetchRemainingItems(e,a)]),l={...c[0],...c[1],...c[2]},u=[]
for(const e of n.remainingItems){const t=l[e.id];(0,Nv.isSome)(t)&&u.push(t)}return Zi(n,new Set([...a.ids,...s.ids,...i.ids])),{shelfContents:u}}try{const o=await L2.secondaryGroupingShelfMediaApiData(e,t,n,r),s=yt(e,o),a=this.initialShelfDataFromGroupingMediaApiData(e,s)
a.responseTimingValues=o[fm.timingValues]
const c=j(s,Yi(0,n.featuredContentId))
return i(c)&&(null==c?void 0:c.length)>0&&(a.shelfTitle=c),a}catch{return{shelfContents:[]}}}async fetchRemainingItems(e,t){const n={}
if(t.ids.size>0){Xi(e,t)
try{await Ln(e,t).then(e=>{(e=>{for(const t of e.data)n[t.id]=t})(e)})}catch(n){e.console.error("Error fetching remaining items",t.ids)}}return n}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=n.featuredContentId===d0
let i=null
const a=this.initialShelfDataFromGroupingMediaApiData(e,t)
o&&s(a.shelfContents)&&(i=this.personalizedDataResultFromDataItems(e,a.shelfContents))
const c={...n,shouldPersonalizeData:o,personalizedDataResult:i},l=s(a.shelfContents),u=!H(t,wb)
return!l&&u?(c.recommendationsHref=t.href,c.isValidRecommendationsShelf=!0):c.isValidRecommendationsShelf=l,c}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(s(t.personalizedDataResult)){const e=hh(n.recoMetricsData,t.personalizedDataResult.processingType,null)
r.recoMetricsData=e}return r}_createShelf(e,t,n,i){var a
if(!oi(e))return null
if(!t.isValidRecommendationsShelf)return null
const c={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:t.metricsPageInformation.recoMetricsData}
let l=n.shelfContents
s(t.personalizedDataResult)&&t.isFirstRender&&(l=t.personalizedDataResult.personalizedData)
const u=[]
for(const e of l)r(e.attributes)||zi(t)?(t.isDeferring=!0,t.remainingItems.push(e)):u.push(e)
const d=hi(e,u,null,!1,!1,c,!1,!0,t.isArcadePage,!1)
Br(d.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const f=d.appPromotions,h=new YY(vO)
return h.isHorizontal=!0,h.title=null!==(a=n.shelfTitle)&&void 0!==a?a:t.title,h.items=f,o(h.items)&&t.isFirstRender&&ec(e,h,t,t.featuredContentId),h.url=Ki(0,h,t),o(h.items)&&o(h.url)?t.isFirstRender?null:$2.makeHiddenShelf(t):h}personalizedDataResultFromDataItems(e,t){const n=new Set
for(const e of t){const t=f(e,dU);(null==t?void 0:t.length)>0&&n.add(t)}const r=bs(e,n)
return As(e,gb,t,!1,r,null,null,null,!0)}static makeHiddenShelf(e){const t=new YY(e.shelfStyle)
return t.isHidden=!0,t}}class F2{constructor(){this.$kind="ArcadeFooter"}}class N2{constructor(e){this.$kind="Footnote",this.text=e,this.presentationStyle=[],this.clickAction=null}}class B2 extends L2{constructor(){super("GroupingArcadeFooterShelfController"),this.supportedFeaturedContentIds=new Set([-1]),this.supportedNativeGroupingShelfIds=new Set([1])}shouldImpressShelf(){return!1}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:bt(t),responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=so(e,this.numberOfIconsForArcadeAppGrid(e.client.deviceType))
return await Ln(e,o).then(t=>{const n=this.initialShelfDataFromGroupingMediaApiData(e,t)
return n.responseTimingValues=t[fm.timingValues],n})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldIncludeShelfUrl:n.isFirstRender}
return o.showingPlaceholders=n.isFirstRender,o}_createShelf(e,t,n,o){const i=new F2,a=new YY(SE)
a.items=[i]
const c={targetType:rb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(i$),id:t.id,kind:ob,softwareType:nq}
Oh(e,i,c),gh(0,c,c.title),i.buttonAction=eo(e,YB,t.metricsPageInformation,t.metricsLocationTracker)
const l={targetType:Qq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:i.buttonAction.title,id:mA,kind:Qq,softwareType:nq}
Oh(e,i.buttonAction,l),mh(c.locationTracker)
const u=e.bag.termsAndConditionsURL
if(!r(u)&&"tv"!==e.client.deviceType){const t=e.loc.string(RE),n=new PY(u),r=new N2(t)
r.clickAction=n,r.presentationStyle=[YL,JL,KL],i.footnote=r}if(a.background={type:cV,color:Se(XO)},s(n.shelfContents)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
i.icons=zd(e,n.shelfContents,r,{useCase:n6.LockupIconMedium})}else i.icons=[]
return t.shouldIncludeShelfUrl&&(a.url=Ji(t)),a}numberOfIconsForArcadeAppGrid(e){return e===jq?9:20}}class U2{constructor(){this.$kind="Brick",this.artworks=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=rq,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null,this.editorialDisplayOptions={},this.artworkSafeArea=null,this.textSafeArea=null}isValid(){var e,t,n,r
const o=null!==(t=null===(e=this.artworks)||void 0===e?void 0:e.every((e,t)=>(0,Nv.isSome)(e)&&e.isValid()))&&void 0!==t&&t,i=(null!==(r=null===(n=this.collectionIcons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0,s=(0,Nv.isSome)(this.backgroundColor)
return(0,Nv.isSome)(this.clickAction)&&(o||i||s)}}!function(e){e.TopRight="topRight",e.TopLeft="topLeft",e.MiddleLeft="middleLeft"}(Om||(Om={})),function(e){e.SquareByWidth="squareByWidth",e.SquareByHeight="squareByHeight",e.FreeForm="freeForm"}(Em||(Em={}))
class G2{constructor(e,t,n,r,o){this.width=e,this.height=t,this.asRatioOfSize=null!=n&&n,this.location=r,this.constraint=o}}G2.defaultTileArtworkSafeArea={width:.4,height:.4,asRatioOfSize:!0,constraint:Em.SquareByWidth,location:{relativeLocation:Om.TopRight}},G2.defaultPillArtworkSafeArea={width:.28,height:1,asRatioOfSize:!0,constraint:Em.FreeForm,location:{relativeLocation:Om.MiddleLeft}},G2.defaultTileTextSafeArea={width:.15,height:0,asRatioOfSize:!0},G2.defaultPillTextSafeArea={width:.28,height:0,asRatioOfSize:!0}
class j2 extends L2{constructor(){super("GroupingBrickShelfController"),this.supportedFeaturedContentIds=new Set([KX,ZX,QX,NX])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,WV)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(e=>({shelfContents:ss(e.shelfContents,we(n.featuredContentData,WV))}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,vb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Fr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,dH)===LH
let d
if(l){d=new YY(D$)
const n=h(t.featuredContentData.attributes,mb)
d.rowsPerColumn=null!=n?n:Z(e),Ah(t.metricsLocationTracker).name=NE}else d=new YY(sG)
d.isHorizontal=!0
for(const n of r.shelfContents){const r=j2.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s)
r?(a.push(r),bh(t.metricsLocationTracker)):c.push(n)}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[WV].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,iM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const p=u(t.featuredContentData.attributes,BE)
if(l&&p){const n=new YY(D$)
n.items=this.sortCategories(e,a),n.presentationHints={isSeeAllContext:!0}
const r=new ZY([n])
r.title=t.title
const o=new fY(eW)
o.title=e.loc.string(KV),o.pageData=r,d.seeAllAction=o,Xs(e,o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}const w=d&&o(d.items)&&t.isFirstRender
if(w&&ec(e,d,t,t.featuredContentId),!w&&j2.shouldDisplayChooseYourFavoritesBrick(e,t,l,s)){const n=j2.createChooseYourFavoritesBrick(e,t.metricsPageInformation,t.metricsLocationTracker)
d.items.splice(0,0,n)}return t.presentationHints=d.presentationHints,d.url=Ki(0,d,t),d}static shouldDisplayChooseYourFavoritesBrick(e,t,n,r){return t.isArcadePage&&n&&e.featureFlags.isEnabled(dJ)&&(0,Nv.isSome)(null==r?void 0:r.additionalShelfParameters)&&((null==r?void 0:r.additionalShelfParameters.isSubscribed)===XH||(null==r?void 0:r.additionalShelfParameters.isTrialEnrolled)===XH)}static createBrick(e,t,n,r,o,s,a){const c={targetType:n?Ej:sG,pageInformation:r,locationTracker:o,recoMetricsData:St(t)},l=os(e,t,s,!1,null,c,a)
if(!l)return null
const u=new U2,d={useCase:n6.GroupingBrick}
if(n){const t=Yd(e,l.content,_m.categoryBreakout,Vv.Density1)
u.artworks=t}else if(l.artwork&&(null==s?void 0:s.featuredContentId)!==NX){let t=p(l.artwork,qL)
t||(t=p(l.artwork,"originalFlowcaseBrick"))
const n=ts(e,t,d)
u.artworks=[n]}else{const n=ns(e,t,1060,520,d)
u.artworks=[n]}u.accessibilityLabel=l.title,u.shortEditorialDescription=l.title,u.clickAction=l.action,435===q(t,xj)&&(u.personalizationStyle=pN)
const f=pe(e,t,Jq)
if(i(f)){const n=Js(e,f,c)
u.flowPreviewActionsConfiguration=oa(e,t,!0,null==s?void 0:s.clientIdentifierOverride,u.clickAction,c,n)}return Oh(e,u,Lh(e,t,l.title,c)),u.artworkSafeArea=G2.defaultTileArtworkSafeArea,u.textSafeArea=G2.defaultTileTextSafeArea,u.isValid()?u:null}static createChooseYourFavoritesBrick(e,t,n){const r=new U2,o=new QW("",1060,520,[],ye("efac78"))
r.artworks=[o]
const i=e.loc.string("ARCADE_CHOOSE_YOUR_FAVORITES_BRICK_TITLE")
r.accessibilityLabel=i,r.shortEditorialDescription=i
const s=new fY(tB)
var a
return s.presentationContext=Mj,s.pageData=Dq,r.clickAction=s,Oh(e,r,(a={targetType:sG,pageInformation:t,locationTracker:n,recoMetricsData:null},Bv.context("impressionOptionsForArcadeChooseYourFavoritesBrick",()=>({...a,id:"",kind:null,softwareType:null,title:"choose_your_games_brick"})))),r.artworkSafeArea=G2.defaultTileArtworkSafeArea,r.textSafeArea=G2.defaultTileTextSafeArea,r}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,dH)===LH&&(r.title=NE),r}sortCategories(e,t){return t.sort((t,n)=>{try{return t.shortEditorialDescription.localeCompare(n.shortEditorialDescription,e.loc.safeIdentifier,{usage:xV})}catch(e){return 0}})}}class V2 extends L2{constructor(){super("GroupingCategoryShelfController"),this.supportedFeaturedContentIds=new Set([e0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=pe(e,t,WV)
return n?{shelfContents:we(n,WV)}:{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(t=>{const r=pe(e,n.featuredContentData,WV)
return r?{shelfContents:ss(t.shelfContents,we(r,WV))}:{shelfContents:[]}})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,i){var a
if(o(n.shelfContents))return null
const c=[]
let l=!1
for(const o of n.shelfContents){const n=pe(e,o,Fj)
if(r(n))continue
const a=ls(0,n)
if(r(o.attributes)||r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const d={targetType:wN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)},f=Dd(e,n,{...d,id:a},t.clientIdentifierOverride)
Oh(e,f,{...d,kind:yq,softwareType:u(null==i?void 0:i.isArcadePage)?nq:null,title:f.title,id:a})
const h=B(n,Hq)
h.width>h.height&&(l=!0),s(h)&&(f.artwork=qd(e,h,{allowingTransparency:!0,useCase:n6.CategoryIcon})),c.push(f),bh(t.metricsLocationTracker)}const d=this.shelfForCategoryActions(e,c,t)
if(d.title=t.title,d.subtitle=t.subtitle,d.url=Ki(0,d,t),l){const e=null!==(a=d.presentationHints)&&void 0!==a?a:{}
d.presentationHints={...e,itemsHaveRectangularArtwork:!0}}return d}shelfForCategoryActions(e,t,n){const r=new YY(UH)
let o
switch(e.client.deviceType){case"tv":r.isHorizontal=!0,o=8
break
case Yq:r.isHorizontal=!1,o=null
break
case AV:r.isHorizontal=!0,r.rowsPerColumn=3,o=24
break
default:r.isHorizontal=!1,o=6}if(null!==o&&t.length>o){r.items=t.slice(0,o)
const i=new fY(eW)
i.title=e.loc.string(KV),Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),r.seeAllAction=i
const s=new YY(UH)
s.isHorizontal=!1,this.sortCategories(e,t),s.items=t
const a=new ZY([s])
a.title=e.loc.string("PAGE_TITLE_CATEGORIES"),i.pageData=a}else r.items=t
return r}sortCategories(e,t){t.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:xV})}catch(e){return 0}})}}class H2{constructor(){this.$kind="EditorialCard",this.adamId=void 0,this.caption=null,this.title=void 0,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.decorations=[],this.flowPreviewActionsConfiguration=null,this.appEventFormattedDates=null,this.mediaOverlayStyle=null}isValid(){return!!(this.clickAction&&this.artwork&&this.artwork.isValid()&&this.caption&&this.title)}}class q2 extends L2{constructor(){super("GroupingEditorialCardShelfController"),this.supportedFeaturedContentIds=new Set([qX,WX,u0,zX,FX])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,WV)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){const i=new YY(db)
i.isHorizontal=!0
const s=this.personalizationDataContainerForEditorialCardItemsDataArray(e,n.shelfContents),a=[]
for(const i of n.shelfContents){const n=q2.makeEditorialCard(e,i,s,r,t)
!o(n)&&n.isValid()&&(a.push(n),bh(t.metricsLocationTracker))}return delete t.maxItemCount,i.items=a,i.url=Ki(0,i,t),i}static makeEditorialCard(e,t,n,o,s){var a,c,l
const u={targetType:BU,pageInformation:null==s?void 0:s.metricsPageInformation,locationTracker:null==s?void 0:s.metricsLocationTracker,recoMetricsData:St(t),id:t.id,idType:uU},d=q(t,xj),h=os(e,t,s,d===u0,n,u,o,()=>{null==s||s.remainingItems.push(t)})
if(!h)return null;(null===(c=null===(a=h.content)||void 0===a?void 0:a.id)||void 0===c?void 0:c.length)>0&&(u.id=h.content.id,u.idType=lq,u.adamId=h.content.id)
const w=new H2
let g=j(t,"designBadge")
g||(g=h.caption),w.caption=g
let v=j(t,Pq)
v||(v=h.title),w.title=v
let m=us(j(t,UE))
m||(m=h.subtitle),w.subtitle=m
const y={useCase:n6.GroupingHero,withJoeColorPlaceholder:!0}
if(h.artwork&&(null==s?void 0:s.featuredContentId)!==FX){let t=p(h.artwork,qL)
r(t)&&i(h.appEvent)&&(t=p(h.artwork,"eventCard")),w.artwork=ts(e,t,y)}else w.artwork=ns(e,t,416,204,y)
if(w.clickAction=h.action,i(h.appEvent)&&(w.appEventFormattedDates=h.appEvent.formattedDates),w.lockup=h.lockup,i(w.artwork)&&i(w.artwork.backgroundColor)){const e=be(w.artwork.backgroundColor)
if(w.mediaOverlayStyle=e?kq:QH,i(w.lockup)&&i(w.lockup.offerDisplayProperties)){const t=e?kq:QH
w.lockup.offerDisplayProperties=w.lockup.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,uj,t)}}w.adamId=f(h.content,"id")
const A=pe(e,t,Jq)
if(i(A)){const n=Js(e,A,u)
n.targetType=u.targetType,w.flowPreviewActionsConfiguration=oa(e,t,!1,null==s?void 0:s.clientIdentifierOverride,w.clickAction,u,n)}const T=Lh(e,null!==(l=h.content)&&void 0!==l?l:t,h.title,u)
if(i(h.onDevicePersonalizationDataProcessingType)){const e=hh(T.recoMetricsData,h.onDevicePersonalizationDataProcessingType,null)
T.recoMetricsData=e}return i(h.appEvent)&&(T.inAppEventId=h.appEvent.appEventId,i(h.appEvent.lockup)&&(T.relatedSubjectIds=[h.appEvent.lockup.adamId])),i(s)&&Oh(e,w,T),w}personalizationDataContainerForEditorialCardItemsDataArray(e,t){var n,r
if(!Ts(e))return null
const o=new Set
for(const e of t){const t=q(e,xj)===u0,i=(null===(n=f(e,Rq))||void 0===n?void 0:n.length)>0,s=(null===(r=j(e,yb))||void 0===r?void 0:r.length)>0,a=de(e,Jq,!1)
if(t&&!i&&!s&&a){const t=we(e,Jq)
for(const e of t){const t=f(e,dU);(null==t?void 0:t.length)>0&&o.add(t)}}}return bs(e,o)}}class W2{constructor(e,t,n,r,o,i,s){this.$kind="EditorialStoryCard",this.title=e,this.artwork=t,this.video=n,this.heading=r,this.badge=o,this.description=i,this.clickAction=s,this.shelfBackground=null,this.collectionIcons=null,this.editorialDisplayOptions={}}}class z2 extends L2{constructor(){super("GroupingEditorialStoryCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}shelfRoute(e){return vc(this.supportedFeaturedContentIds,["shelfContentType=editorialStoryCard"])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&cs(0,j(t,dH))===GE}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,WV)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,dH)
return o.shelfStyle=cs(0,i),o}_createShelf(e,t,n,r){const i=[]
for(const r of n.shelfContents){if(!W(r)||zi(t)){t.remainingItems.push(r),t.isDeferring=!0
continue}const n=z2.makeStoryCard(e,r,t)
o(n)||(i.push(n),bh(t.metricsLocationTracker))}const s=new YY(t.shelfStyle)
return s.title=t.title,s.items=i,s.isHorizontal=!0,s.background={type:WL},s.url=Ki(0,s,t),s.isHorizontal=!0,s}static makeStoryCard(e,t,n){let s=B(t,"editorialArtwork.subscriptionHero")
o(s)&&(s=B(t,sM))
const a=qd(e,s,{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:n6.TodaySmallStoryCard})
if(r(a))return null
const c=j(t,Vj),l=j(t,$H),u=j(t,CE),d=new W2(c,a,null,l,{type:UV,title:l},u),f=go(e,t,null,new bZ(null==n?void 0:n.metricsPageInformation,null==n?void 0:n.metricsLocationTracker))
i(f)&&(d.clickAction=f.clickAction)
const h=be(a.backgroundColor)?kq:QH
return d.shelfBackground={type:Hq,artwork:a,style:h},d}}class Y2 extends dW{constructor(){super(...arguments),this.$kind="GameCenterDashboardAction",this.actionClass="GameCenterDashboardAction"}}class J2 extends L2{constructor(){super("GroupingGameCenterActivityFeedController"),this.batchGroupKey=hV,this.supportedFeaturedContentIds=new Set([f0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isGameCenterActivityFeedShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],activities:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=this.gameCategoryFilter(n.gamesFilter)
return await e.gameCenter.fetchActivityFeedCards(o,20).then(e=>({shelfContents:[],activities:e}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return zv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingActivityFeedShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.activityFeedShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingActivityFeedShelfForGrouping(e,t,n){if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const r=this.activityFeedShelfForGrouping(e,{shelfContents:[],activities:[]},t,n),o=qW.from(Ji(t))
return r.url=o.param(DW.isGameCenterActivityFeedShelf,XH).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}activityFeedShelfForGrouping(e,t,n,r){if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const o=this.activityFeedShelf(e,t.activities,n,r),i=e.loc.string("Arcade.ActivityFeed.RecentActivity")
return o.header=oo(e,i),fs(e,o,o.seeAllAction),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o}activityFeedShelf(e,t,n,r=!1){const o=new YY("gameCenterActivityFeedCard")
let i
return o.isHorizontal=!0,o.mergeWhenFetched=!0,o.batchGroup=this.batchGroupKey,o.items=t,o.isHidden=0===o.items.length,t.forEach((t,o)=>{const i={id:"friendActivity",idType:Gq,targetType:"chiclet",kind:null,softwareType:r?nq:null,title:"",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}
Oh(e,t,i)
const s=new sW,a=new sW,c=new sW,l=new sW,u=new sW;[{targetId:"playerName",metrics:s},{targetId:"profileImage",metrics:a},{targetId:"leaderboardAchievement",metrics:c},{targetId:fU,metrics:l},{targetId:t.adamID||"gameIcon",metrics:u}].forEach(t=>function(e,t,n,r,o){const i={actionType:Xq,id:r,idType:Gq,location:wh(0,o,n)},s=_t(e,r,yq,i)
t.addMetricsData(s)}(e,t.metrics,n.title,t.targetId,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),t.profileActionMetrics=s,t.profileAvatarActionMetrics=a,t.leaderboardActionMetrics=c,t.achievementActionMetrics=l,t.appActionMetrics=u,bh(n.metricsLocationTracker)}),e.featureFlags.isGSEUIEnabled(yJ)||(i=new Y2,i.title=e.loc.string("Arcade.ActivityFeed.AllActivity",e.loc.string(KV)),Xs(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),o.seeAllAction=i,o}gameCategoryFilter(e){return e===aM?jE:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,title:"Friend Activity",badges:{gameCenter:!0},idType:nb}}}class K2{constructor(){this.$kind="VideoCard",this.flowPreviewActionsConfiguration=null}}class Z2 extends L2{constructor(){super("GroupingGameCenterContinuePlayingShelfController"),this.batchGroupKey="gameCenterContinuePlaying",this.supportedFeaturedContentIds=new Set([l0])}_supports(e,t,n,r){return super._supports(e,t,n,r)&&this.supportsVideoCardShelf(e,e.host.platform)}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isGameCenterContinuePlayingShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=Date.now(),i=this.maximumNumberOfRecentGamesToRequest(),s=e.gameCenter.fetchRecentlyPlayedGamesWithinSeconds(this.gameCategoryFilter(n.gamesFilter),i,e.bag.recentlyPlayedGamesWindowInSeconds)
return await s.then(async t=>{const n=Date.now()
let r
if(e.console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-o).toString(10)+" milliseconds."),0===t.length){const e={shelfContents:[]}
return await Promise.resolve(e)}{const n=new Jz(e).withIdsOfType(t.slice(0,this.maximumNumberOfRecentGamesToShow()),Kq).includingAgeRestrictions()
Xi(e,n),r=Ln(e,n,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[fm.timingValues]}))}return await r})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return zv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingContinuePlayingForGrouping(e,t):this.continuePlayingShelfForGrouping(e,n.shelfContents,t)}pendingContinuePlayingForGrouping(e,t){const n=this.continuePlayingShelfForGrouping(e,[],t)
if(!n)return null
const r=qW.from(Ji(t))
return n.url=r.param(DW.isGameCenterContinuePlayingShelf,XH).build(),n.batchGroup=this.batchGroupKey,n}continuePlayingShelfForGrouping(e,t,n){return Bv.context("continuePlayingShelfForGrouping",()=>{const r=this.videoCardContinuePlayingShelf(e,t,n)
return r.mergeWhenFetched=!1,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header=oo(e,e.loc.string(Ab),n.subtitle),r})}supportsVideoCardShelf(e,t){switch(t){case Kj:case LG:case OV:return!0
default:return!1}}videoCardContinuePlayingShelf(e,t,n){return Bv.context("videoCardContinuePlayingShelf",()=>{const r=new YY(Tb)
r.isHorizontal=!0,r.batchGroup=this.batchGroupKey
const o=[]
for(const r of t){if(at(e,r))continue
const t=this.editorialSplashVideoCardForContinuePlaying(e,r,n)
t&&o.push(t)}return r.items=o,r})}editorialSplashVideoCardForContinuePlaying(e,t,n){return Bv.context("editorialSplashVideoCardForContinuePlaying",()=>{var r
const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:Bq},i=e.featureFlags.isEnabled(nJ)&&u(n.isArcadePage),s=Bf(e,t),a={metricsOptions:o,artworkUseCase:n6.LockupIconSmall,offerEnvironment:kq,offerStyle:JH,canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:i,isSubtitleHidden:s&&!i},c=this.editorialSplashVideoWithTopShelfStill(e,t)
if(!c||!c.preview)return null
const l=Ad(e,t,a)
if(!l)return null
l.clickAction=mc(e,l.clickAction)
const d=this.clickActionForVideoCard(e,t,e.host.platform,o,n.clientIdentifierOverride)
if(!d)return null
const f=new K2
f.video=c,f.lockup=l,f.overlayStyle=kq,f.clickAction=d
const h=Js(e,t,o)
f.flowPreviewActionsConfiguration=oa(e,t,!0,n.clientIdentifierOverride,f.clickAction,o,h)
const p=Lh(e,t,l.title,o)
return Oh(e,f,p),null===(r=f.impressionMetrics)||void 0===r||delete r.fields[bb],f})}editorialSplashVideoWithTopShelfStill(e,t){return Bv.context("editorialSplashVideoWithTopShelfStill",()=>{let n=null
const r=Ke(e,t,aE)
return i(r)&&(n=qd(e,r,{withJoeColorPlaceholder:!0,useCase:n6.VideoCardStill,cropCode:"sr"})),kf(e,t,n)})}clickActionForVideoCard(e,t,n,r,o){let i=Dd(e,t,Js(e,t,r),o)
if(i=mc(e,i),n===LG){const n=new _J(t.id,Mq)
Qs(e,n,{actionType:DV,id:t.id,contextualAdamId:t.id,anonymizationOptions:r.anonymizationOptions,pageInformation:r.pageInformation,locationTracker:r.locationTracker})
const o=new IY(t.id,i)
return o.openAction=n,o.cancelAction=i,o}return i}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}gameCategoryFilter(e){return e===aM?jE:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:Xj,title:e.loc.string(Ab)}}}class Q2 extends dW{constructor(e){super(),this.$kind="GameCenterAchievementsAction",this.actionClass="GameCenterAchievementsAction",this.bundleId=e}}class X2{constructor(e,t,n,r,o,i,s,a,c){this.$kind="GameCenterReengagement",this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class e4{constructor(e){this.$kind="GameCenterAchievementStatus",this.type=e}}class t4{constructor(e,t,n,r){this.$kind="GameCenterAchievement",this.id=e,this.title=t,this.subtitle=n,this.status=r}}class n4 extends L2{constructor(){super("GroupingGameCenterReengagementShelfController"),this.batchGroupKey=hV,this.supportedFeaturedContentIds=new Set([494])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isGameCenterReengagementShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],achievementData:null,achievementSummaryData:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchRengagementDataForLocalPlayer().then(async t=>{const n=f(t,SV),r=y(t[fU]),i=y(t.achievementSummary)
if(o(n)){const e={shelfContents:[],responseTimingValues:null,achievementData:null,achievementSummaryData:null}
return await Promise.resolve(e)}const s=new Jz(e).withIdOfType(n,Kq).includingAgeRestrictions()
return Xi(e,s),await Ln(e,s,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[fm.timingValues],achievementData:r,achievementSummaryData:i}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingGameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage):this.gameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage)}pendingGameCenterReengagementShelf(e,t,n,r){const o=this.gameCenterReengagementShelf(e,t,n,r)
if(!o)return null
const i=qW.from(Ji(n))
return o.url=i.param(DW.isGameCenterReengagementShelf,XH).build(),o.batchGroup=this.batchGroupKey,o}gameCenterReengagementShelf(e,t,n,r=!1){return Bv.context("gameCenterReengagementShelf",()=>{if(!s(t.shelfContents))return null
const o=new YY("gameCenterReengagement")
o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=this.batchGroupKey
const i={id:n.id,kind:null,softwareType:r?nq:null,targetType:Cq,title:Sb,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:Xj,fcKind:n.featuredContentId,badges:{gameCenter:!0}},a=If(e,t.shelfContents[0],n6.Uber)
let c=Se("componentBackground"),l=null
s(a)&&(l=a.preview,c=l.backgroundColor)
const u={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},offerStyle:JH,artworkUseCase:Hd(0,dq),isSubtitleHidden:!0}}
gh(0,i,i.title)
const d=Rd(e,t.shelfContents,u)[0]
d.clickAction=mc(e,d.clickAction),mh(n.metricsLocationTracker)
let f=null
s(d)&&(f=new Q2(d.bundleId),f.title=Sb,Qs(e,f,i))
const h=e.loc.string("GameCenter.Reengagement.Badge.GameCenter"),p=this.achievementFromData(e,t.achievementData),w=this.achievementCountsFromData(e,t.achievementSummaryData),g=this.shelfMetadataForAchievement(e,p,w),v=new X2("gamecenter.fill",h,g.title,g.subtitle,p,d,c,l,f)
return o.items=[v],Oh(e,v,i),o})}achievementStatusFromData(e,t){const n=f(t,fV),r=new e4(n)
return r.percent=h(t,"percent"),r.date=f(t,HE),r.artwork=new QW(f(t,"artwork.template"),h(t,"artwork.width"),h(t,"artwork.height"),[]),r}achievementFromData(e,t){const n=f(t,"id"),r=f(t,Pq),o=f(t,vH),i=this.achievementStatusFromData(e,p(t,"status"))
return new t4(n,r,o,i)}achievementCountsFromData(e,t){return{completed:h(t,"completedAchievements"),total:h(t,"totalAchievements")}}shelfMetadataForAchievement(e,t,n){if(!i(t))return{title:"",subtitle:null}
if(0===n.completed)return{title:e.loc.string("GameCenter.Reengagement.Achievement.First.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.First.Subtitle")}
switch(t.status.type){case cM:case"hidden":case Pb:return{title:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Subtitle")}
case gV:const t=e.loc.stringWithCount("GameCenter.AchievementSummary.TotalToCompleteCount",n.total),r=e.loc.stringWithCount("GameCenter.AchievementSummary.NumberCompletedCount",n.completed),o=e.loc.string("GameCenter.AchievementSummary.CompletedCount.Subtitle").replace("@@completedCount@@",r).replace("@@totalCount@@",t)
return{title:e.loc.string("GameCenter.Reengagement.Achievement.CompletedCount.Title"),subtitle:o}
default:return{title:"",subtitle:null}}}}class r4 extends dW{constructor(e){super(),this.$kind="GameCenterInvitePlayerAction",this.actionClass="GameCenterInvitePlayerAction",this.invitationType=e}}class o4 extends dW{constructor(e){super(),this.$kind="GameCenterDenylistPlayerAction",this.actionClass="GameCenterDenylistPlayerAction",this.contactId=e}}class i4{constructor(e,t,n,r,o,i,s,a){this.$kind="SmallContactCard",this.id=e,this.title=t,this.subtitle=n,this.buttonText=r,this.contactId=o,this.buttonAction=i,this.removeButtonAction=s,this.shouldShowMessagesBadge=a}}class s4 extends dW{constructor(e){super(),this.$kind="LegacyGameCenterInvitePlayerAction",this.actionClass="LegacyGameCenterInvitePlayerAction",this.contactId=e}}class a4 extends L2{constructor(){super("GroupingGameCenterSuggestedFriendsController"),this.batchGroupKey=hV,this.supportedFeaturedContentIds=new Set([a0])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:hW,path:`/${yW.grouping}/${yW.shelf}/{token}`,query:[DW.isGameCenterSuggestedFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{$kind:lM,shelfContents:[],suggestedFriends:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchSuggestedFriends(10).then(t=>e.clientCapabilities.isEnabled(Cb)?{$kind:lM,shelfContents:[],suggestedFriends:t}:{$kind:Ib,shelfContents:[],suggestedFriends:t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return zv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingSuggestedFriendsShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.suggestedFriendsShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingSuggestedFriendsShelfForGrouping(e,t,n){if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const r=this.suggestedFriendsShelfForGrouping(e,{$kind:e.clientCapabilities.isEnabled(Cb)?lM:Ib,shelfContents:[],suggestedFriends:[]},t,n),o=qW.from(Ji(t))
return r.url=o.param(DW.isGameCenterSuggestedFriendsShelf,XH).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}suggestedFriendsShelfForGrouping(e,t,n,r){if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
let o
return o=t.$kind===lM?this.suggestedFriendsShelf(e,t.suggestedFriends,n,r):this.legacySuggestedFriendsShelf(e,t.suggestedFriends,n,r),o.header=oo(e,n.title,n.subtitle),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o.footerTitle=e.loc.string(_$),o.footerAction=ro({objectGraph:e,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker}),o.footerStyle={$kind:_H,bundleID:gN,width:16,height:16},o}suggestedFriendsShelf(e,t,n,r=!1){const o=kb
if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const i=new YY(Ob)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=hV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i],l=e.loc.string(Eb),u=e.loc.string(Rb),d={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
let f,h
c.supportsFriendingViaPush&&c.contactAssociationID?(f={contact:{contactID:c.contactID,contactAssociationID:c.contactAssociationID}},h=!1):(f={messages:{contactID:c.contactID}},h=!0)
const p=new r4(f)
Qs(e,p,{...d,actionType:Db})
const w=new o4(c.contactID)
Qs(e,w,{...d,actionType:_b})
const g={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Lb,softwareType:r?nq:null,anonymizationOptions:{anonymizationString:a}},v=new i4(c.contactID,c.fullName,u,l,c.contactID,p,w,h)
Oh(e,v,g),s.push(v),bh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}legacySuggestedFriendsShelf(e,t,n,r=!1){const o=kb
if(e.client.deviceType!==jq&&e.client.deviceType!==$q)return null
const i=new YY(Ob)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=hV
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i]
c.buttonText=e.loc.string(Eb),c.subtitle=e.loc.string(Rb)
const l={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
c.buttonAction=new s4(c.contactId),Qs(e,c.buttonAction,{...l,actionType:Db}),c.removeButtonAction=new o4(c.contactId),Qs(e,c.removeButtonAction,{...l,actionType:_b}),Oh(e,c,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:Lb,softwareType:r?nq:null,anonymizationOptions:{anonymizationString:a}}),s.push(c),bh(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:Xj}}}class c4{constructor(){this.$kind="HeroCarousel",this.items=[],this.rtlItems=[]}}class l4{constructor(){this.$kind="HeroCarouselItem"}isValid(){const e=(0,Nv.isSome)(this.collectionIcons)&&this.collectionIcons.length>0,t=(0,Nv.isSome)(this.artwork)&&this.artwork.isValid(),n=(0,Nv.isSome)(this.video),r=t||n||e,o=(0,Nv.isSome)(this.overlay)&&this.overlay.isValid()
return r&&o}}class u4{constructor(e){this.$kind="TitleEffect",this.isFallbackStyle=!1,this.type=e}}class d4{constructor(e,t,n){this.$kind="ArticlePage",this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class f4{constructor(e,t,n,r){this.$kind="RoundedButton",this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class h4{constructor(e,t,n=kV,r=null,o=null,i=null){this.$kind="FramedArtwork",this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===PF?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class p4{constructor(e,t,n,r){this.$kind="Quote",this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class w4{constructor(e,t,n){this.$kind="HorizontalRule",this.style=e,this.color=t,this.isFullWidth=n}}class g4{constructor(e,t){this.$kind="AppShowcase",this.type=e,this.lockup=t}}class v4{constructor(e){this.$kind="InAppPurchaseShowcase",this.lockup=e}}class m4{constructor(e,t,n,r=!0){this.$kind="EditorialLink",this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class y4{constructor(e,t){this.$kind="ClientControlButton",this.title=e,this.buttonAction=t}}class A4{constructor(e,t){this.$kind="ArcadeShowcase",this.unsubscribedAction=e,this.subscribedAction=t}}class T4{constructor(e,t,n,r,o,i,s){this.$kind="UpsellBreakout",this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s}}class b4{constructor(e,t,n,r,o,i){this.$kind="BreakoutDetails",this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class S4 extends dW{constructor(e,t,n,r,o){super(),this.$kind="ArcadeAction",this.actionClass="ArcadeAction",this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n,this.paymentMetricsOverlay=o}}class P4{constructor(e){this.$kind="InlineTodayCards",this.cards=e}}new Set([Hq,BN,eH,Nx,jH])
const C4=new Set([aj,Hq,BN,eH,Nx,jH]),I4=new Set([aj,Hq,BN,eH,Nx,jH]),k4=new Set([aj,Hq,eH,jH]),O4=(new Set([aj,Hq,H_,BN,jH]),Se(hx)),E4=Se(hx),R4=Se(hx)
class D4{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1,this.allowUnpublishedAppEventPreviews=!1}}const _4=[rI,nI,oI,a_]
class L4{constructor(){this.$kind="HeroCarouselItemOverlay"}isValid(){const e=void 0!==this.callToActionText&&null!==this.callToActionText&&void 0!==this.clickAction&&null!==this.clickAction,t=void 0!==this.titleText&&null!==this.titleText,n=void 0!==this.lockup&&null!==this.lockup,r=void 0!==this.collectionIcons&&null!==this.collectionIcons
return t&&(n||r||e)}}class M4 extends L2{constructor(){super("GroupingHeroCarouselShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,dH)===BU}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,i){if(0!==i.shelves.length)return null
const a=new YY(YG),c=t.featuredContentData,l={targetType:KH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(c)},u=new c4
u.autoScrollConfiguration={isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}
const d=Lh(e,c,YG,l)
d.autoAdvanceInterval=u.autoScrollConfiguration.autoScrollInterval,Oh(e,a,d),gh(0,d,YG)
for(const i of n.shelfContents){if(r(i.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}const n=Zf(e,i)
if(Dc(0,i)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(i),t.relationshipToFetch=aH
continue}const s={targetType:sN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i)},a=Sc(e,i),c=bc(e,i)
if(o(a.video)&&o(c.artwork))continue
const l=new l4,d=Kc(0,i),f=nl(e,i),h=Lh(e,i,f,s)
h.isPreorder=et(e,d,eq),Oh(e,l,h),gh(0,h,f)
const p=a.artworkData||c.artworkData,w=a.backgroundColor||c.backgroundColor,g={metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,canDisplayArcadeOfferButton:Yf(0,t.shelfStyle),lockupArtworkUseCase:Hd(0,t.shelfStyle),isContainedInPreorderExclusiveShelf:t.featuredContentId===c0}
l.overlay=el(e,i,g),l.backgroundColor=w,l.titleEffect=Lc(0,p),l.artwork=c.artwork,l.video=a.video
const v=_c(e,i),m={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(i),targetType:sN,id:i.id}
v&&(Qs(e,v,m),l.clickAction=v),u.items.push(l),mh(h.locationTracker),bh(h.locationTracker)}return s(u.items)&&(a.items=[u],i.pageTitleEffect=u.items[0].titleEffect),a.url=Ki(0,a,t),mh(d.locationTracker),bh(d.locationTracker),a}}class x4 extends L2{constructor(){super("GroupingHorizontalCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&cs(0,j(t,dH))!==GE}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=j(t,dH)
return o.shelfStyle=cs(0,i),o}_createShelf(e,t,n,r){var o
const i=function(e){return t.remainingItems.push(e),!1}
let s
if(e.featureFlags.isEnabled(fJ)){const r=new bZ(t.metricsPageInformation,t.metricsLocationTracker)
s=Vc(e,null!==(o=n.shelfContents)&&void 0!==o?o:[],t.title,t.subtitle,r)}else{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation}
let o
if(t.shelfStyle===pV)o=t.shelfStyle
else switch(e.client.deviceType){case Yq:case"tv":case AV:o=t.shelfStyle
break
case zq:o=Cj
break
default:o=hU}s=jc(e,n.shelfContents,o,t.title,t.subtitle,r,i),s.contentType===pV&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!Bt(e)||Uc(0,e.media.kind,pV)))}return s.url=Ki(0,s,t),s.isHorizontal=!0,s}}class $4{constructor(e,t,n,r,o,i,s){this.$kind="LargeHeroBreakout",this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.collectionIcons=i,this.backgroundColor=s,this.editorialDisplayOptions={}}}class F4 extends L2{constructor(e=null){super(e||"GroupingLargeBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,dH)===uq}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}isInHeroPosition(){return!1}_createShelf(e,t,n,i){const a=s(i)&&o(i.pageTitleEffect)&&0===i.shelves.length,c=s(n.shelfContents)?[n.shelfContents[0]]:[],l=[]
for(const n of c){if(r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const s={targetType:this.isInHeroPosition()?"heroBreakout":sN,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(n)},c=Sc(e,n),u=bc(e,n),d=c.artworkData||u.artworkData,f=F4.createLargeBreakout(e,n,t,this.isInHeroPosition(),a,s)
o(f)||(l.push(f),a&&(i.pageTitleEffect=Lc(0,d)))}const u=new YY(P$)
return u.isHorizontal=!1,u.items=l,u.url=Ki(0,u,t),0===i.shelves.length&&(u.presentationHints={isFirstShelf:!0}),u}static createLargeBreakout(e,t,n,r,i,s){const a=Zf(e,t)
if(Dc(0,t)&&!W(a))return n.isDeferring=!0,n.remainingItems.push(t),n.relationshipToFetch=aH,null
const c=Sc(e,t),l=bc(e,t)
if(o(c.video)&&o(l.artwork))return null
const u=c.backgroundColor||l.backgroundColor,d=r?null:j(t,"breakoutBadge")
let f
const h=j(t,$H)
f=et(e,t,aG)?e.loc.uppercased(Kf(e,a,h)):h
let p={type:rq};(null==f?void 0:f.length)>0&&(p={type:UV,title:f})
const w=Gf(e,t,Zq)||Qe(e,a,Zq),g=Gf(e,t,Uj)||Qe(e,a,gj),v=Pc(e,t,!0,0,!1),m=Ic(e,t,0,!1),y=new b4(w,g,p,null,v,kc(0,m,t)),A=new $4(y,{position:m||Uq},d,l.artwork,c.video,null,u),T=Lh(e,t,A.details.title,s),b=et(e,Kc(0,t),eq)
T.isPreorder=b,Oh(e,A,T),gh(0,T,A.details.title)
const S=_c(e,t),P={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:St(t),targetType:Qq,id:t.id}
return Qs(e,S,P),A.details.callToActionButtonAction=S,A.clickAction=S,mh(s.locationTracker),A.flowPreviewActionsConfiguration=oa(e,t,!0,n.clientIdentifierOverride,S,s,P),A}}class N4 extends dW{constructor(e){super(),this.$kind="SearchAdAction",this.actionClass="SearchAdAction",this.action=e}}class B4 extends dW{constructor(e,t,n,r,o,i,s,a){super(),this.$kind="SearchAction",this.actionClass="SearchAction",this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.source=i,this.presentationStyle=null!=s?s:[Wk],this.referrerData=a}}class U4 extends L2{constructor(){super("GroupingLinkShelfController"),this.supportedFeaturedContentIds=new Set([o0,BX])}initialShelfDataFromGroupingMediaApiData(e,t){let n=we(t,WV)
return o(n)&&(n=G(t,vN)),{shelfContents:n}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldHideShelf:H(t,"hide"),areContentLinks:s(we(t,WV))}
return o.clientIdentifierOverride=Fr(e,t),o}_createShelf(e,t,n,i){if(t.shouldHideShelf)return null
const s=[]
for(let a=0;a<n.shelfContents.length;a++){const c=n.shelfContents[a],l={targetType:yq,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
t.areContentLinks&&(l.recoMetricsData=St(c))
let d=null
if(t.isSearchLandingPage){const n=this.trendingSearchLinkFromData(e,c,t.metricsLocationTracker)
if(r(n)||r(n.action))continue
Oh(e,null==n?void 0:n.action,{...l,kind:yq,softwareType:u(null==i?void 0:i.isArcadePage)?nq:null,title:n.action.title,id:`${a}`,idType:sq}),d=n}else{const n=os(e,c,t,!1,null,l,null)
if(o(n)||o(n.action.title))continue
d=n.action
const r=ls(0,c)
r&&Oh(e,d,{...l,kind:yq,softwareType:u(null==i?void 0:i.isArcadePage)?nq:null,title:d.title,id:r})}o(d)||(s.push(d),bh(t.metricsLocationTracker))}if(o(s))return null
if(t.isSearchLandingPage&&e.client.isPhone&&s.length>=6)for(const t of s)T(a=t)&&a[tW]===Ly&&(t.action.artwork=Ot(e,R$))
var a
const c=new YY(UH)
return c.isHorizontal=!1,c.items=s,c.title=t.title,c.subtitle=t.subtitle,c.presentationHints={isWidthConstrained:!0},c.url=Ki(0,c,t),t.isSearchLandingPage&&(e.client.isPhone||e.client.isPad)&&(c.contentsMetadata={type:L$,numberOfColumns:s.length>=6?2:1}),c}trendingSearchLinkFromData(e,t,n){const r=f(t,$H)
if((0,Nv.isNothing)(r)||0===r.length)return null
const o=new B4(r,r,null,AB)
return ta(e,o,Qq,n),bh(n),new N4(o)}}class G4 extends L2{constructor(e=null){super(e||"GroupingLockupShelfController"),this.supportedFeaturedContentIds=new Set([...v0,...S0])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,Jq)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,WV)),{shelfContents:r}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return yc(e,t,n,r)}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(r.displayStyle=t.shelfStyle,t.featuredContentId===h0){const n=f(B(pe(e,t.featuredContentData,jO),dV),Zq)
r.title=n,r.idType=Xj,r.badges={forYou:!0},r.targetType="swooshBreakout"}return r}_createShelf(e,t,n,r){if(t.featuredContentId===h0){const t=!s(n.shelfContents),r=e.client.isPad
if(t||r)return null}return Ac(e,t,n,r)}}class j4 extends L2{constructor(){super("GroupingPersonalizedLockupShelfController"),this.supportedFeaturedContentIds=T0}shelfRoute(e){return vc(this.supportedFeaturedContentIds,[`${DW.isOnDeviceRecommendationsShelf}?`,`${DW.onDeviceRecommendationsUseCase}?`])}initialShelfDataFromGroupingMediaApiData(e,t){const n=fe(t,Jq)
let r=n?n.data:null
return r&&0!==r.length||(r=we(t,WV)),{shelfContents:r||[],containsODPShelfContents:!1,recoMetrics:St(n),candidates:null,isHiddenShelf:!1,responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
const i=r[DW.onDeviceRecommendationsUseCase]
return(null==i?void 0:i.length)>0?await hs(e,i,nW).then(e=>({shelfContents:At(e.dataContainer),containsODPShelfContents:!0,recoMetrics:e.recoMetrics,candidates:e.candidates,isHiddenShelf:!1})).catch(async o=>o instanceof I0?await j4.fetchODPFallbackContent(e,t,n,r).catch(e=>j4.makeHiddenShelfData(n)):j4.makeHiddenShelfData(n)):(null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0?await L2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const n=yt(e,t),r=this.initialShelfDataFromGroupingMediaApiData(e,n)
return r.responseTimingValues=t[fm.timingValues],r.shelfTitle=j(n,Zq),r}):await L2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>{const t={shelfContents:At(e)||[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!1,responseTimingValues:e[fm.timingValues]}
return t.shelfTitle=n.title,t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=yc(e,t,n,r)
return this.addPersonalizationValuesToShelfToken(e,o,t,r),o}_createShelf(e,t,n,r){var s,a
if(!t.isValidRecommendationsShelf)return null
let c=null
if((0,Nv.isNothing)(t.title)&&(t.title=n.shelfTitle),n.containsODPShelfContents){c=this.personalizedShelf(e,n,t,r)
const o=(new qW).set(Ij,hW).path(`${yW.onDeviceRecommendations}`).param(DW.onDeviceRecommendationsUseCase,t.onDeviceRecommendationsUseCase).param(DW.token,JSON.stringify(t)).build(),i=new fY(eW,o)
i.title=e.loc.string(KV),i.pageData=this.odpSeeAllPage(e,n.shelfTitle,d2),fs(e,c,i),c.mergeWhenFetched=!1}else n.isHiddenShelf?c=j4.makeHiddenShelf(t):i(t.recommendationsHref)?(c=this.personalizedShelf(e,n,t,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t)):(c=Ac(e,t,n,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t))
const l=(0,Nv.isSome)(c.header),u=l&&o(null===(s=c.header)||void 0===s?void 0:s.title),d=!l&&o(c.title),f=(null===(a=n.shelfTitle)||void 0===a?void 0:a.length)>0
return u&&f?c.header.title=n.shelfTitle:d&&f&&(c.title=n.shelfTitle),c}personalizedShelf(e,t,n,r){const o=Ah(n.metricsLocationTracker)
o&&o.fcKind===n.featuredContentId&&mh(n.metricsLocationTracker)
const i={id:n.id,kind:null,softwareType:u(null==r?void 0:r.isArcadePage)?nq:null,targetType:KH,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:Xj,fcKind:n.featuredContentId,recoMetricsData:t.recoMetrics,displayStyle:n.shelfStyle}
gh(0,i,n.title)
const s=Ac(e,n,t,r)
return mh(n.metricsLocationTracker),Oh(e,s,i),s}addPersonalizationValuesToShelfToken(e,t,n,r){const o=t.featuredContentId===i0
if(!r.hasAuthenticatedUser&&!t.isSearchLandingPage&&!o)return void e.console.log(`Skipping recommendations shelf with fcID ${t.featuredContentId}: No user logged-in`)
const i=j(n,x$)
if((null==i?void 0:i.length)>0)return t.onDeviceRecommendationsUseCase=i,t.recommendationsHref=n.href,void(t.isValidRecommendationsShelf=!0)
const a=s(we(n,Jq)),c=!H(n,wb)
!a&&c?(t.recommendationsHref=n.href,t.isValidRecommendationsShelf=!0):t.isValidRecommendationsShelf=a}addOnDeviceQueryParamsIfNecessary(e,t,n){var r
if(o(t))return null
if((null===(r=n.onDeviceRecommendationsUseCase)||void 0===r?void 0:r.length)>0){const e=new qW(t)
return e.param(DW.isOnDeviceRecommendationsShelf,XH),e.param(DW.onDeviceRecommendationsUseCase,n.onDeviceRecommendationsUseCase),e.build()}return t}odpSeeAllPage(e,t,n){const r=new YY(n||d2)
r.isHorizontal=!1,r.items=xb
const o=new ZY([r])
return o.isIncomplete=!0,o.title=t,o}static async fetchODPFallbackContent(e,t,n,r){return await new Promise((r,o)=>{const i=Qi(e,n)
if(!i){const e=`OnDeviceRecommendationsShelfController: Could not construct media API request for: ${t}`
return Bv.unexpectedType(yH,e,null),void o(new Error(e))}Xi(e,i),i.attributingTo(t.build()),Ln(e,i).then(t=>{const n=fe(yt(e,t),Jq),o=St(n),i={shelfContents:At(n),containsODPShelfContents:!1,recoMetrics:o,candidates:null,responseTimingValues:t[fm.timingValues]}
r(i)}).catch(e=>{const n=`OnDeviceRecommendationsShelfController: Failed to fetch fallback shelf contents: ${t}`
Bv.unexpectedType(yH,n,null),o(e)})})}static makeHiddenShelfData(e){return{shelfContents:[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!0}}static makeHiddenShelf(e){const t=new YY(e.shelfStyle)
return t.isHidden=!0,t}}class V4{constructor(e,t){this.$kind="RibbonBarItem",this.title=e,this.clickAction=t,this.artwork=null,this.accessibilityLabel=null}}class H4 extends L2{constructor(){super("GroupingRibbonBarShelfController"),this.supportedFeaturedContentIds=new Set([556])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,o){var i
const s=[],a=new YY(_E)
a.isHorizontal=!0
const c=ar(e,e.bag.arcadeCategoryBarSAGUpliftDisplayRate)
if(t.isArcadePage&&t.isFirstRender&&c){const n=H4.createSeeAllGamesRibbonItem(e,t.metricsPageInformation,t.metricsLocationTracker)
s.push(n),bh(t.metricsLocationTracker)}let l=null!==(i=n.shelfContents)&&void 0!==i?i:[];(0,Nv.isSome)(t.initialHydratedItems)&&t.initialHydratedItems.length>0&&(l=t.initialHydratedItems.concat(l))
const u=[]
let d=!1
for(const n of l){if(r(n.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(n),H4.shouldPriorizeItemWithData(e,n)&&(d=!0)
continue}let i=!1;(0,Nv.isSome)(t.featuredContentData)&&(i=(0,jv.attributeAsString)(t.featuredContentData,dH)===HL)
const a=H4.createRibbonItem(e,n,t.metricsPageInformation,t.metricsLocationTracker,i,t,o);(0,Nv.isSome)(a)&&(H4.shouldPriorizeItemWithData(e,n)?s.unshift(a):s.push(a),u.push(n)),bh(t.metricsLocationTracker)}return a.items=s,d&&u.length>0&&(t.initialHydratedItems=u),a.url=Ki(0,a,t),a}static createRibbonItem(e,t,n,r,o,i,s){var a,c,l
const u={targetType:JG,pageInformation:n,locationTracker:r,recoMetricsData:St(t)}
let d
if(t.type===lV){if(!Gi(e,Fj))return null
d=is(e,t)}else d=os(e,t,i,!1,null,u,s)
const f=Js(e,t,u)
f.targetType=u.targetType
const h=Dd(e,t,f,null==i?void 0:i.clientIdentifierOverride),p=null!==(a=null==d?void 0:d.action)&&void 0!==a?a:h,w=null!==(c=Gf(e,t,Zq))&&void 0!==c?c:(0,jv.attributeAsString)(t,Zq),g=null!==(l=null==d?void 0:d.title)&&void 0!==l?l:w,v=new V4(g,p),m=Sn(e,t)
let y
if(o)y=null
else if((0,Nv.isSome)(m))y=qd(e,m,{useCase:n6.RibbonBarFacet})
else{let t
t=i.isArcadePage?"resource://arcade-ribbon-bar-fallback-icon":"resource://appstore-ribbon-bar-fallback-icon",y=Ot(e,t,36,36)}return v.artwork=y,v.accessibilityLabel=g,Oh(e,v,Lh(e,t,g,u)),v}static createSeeAllGamesRibbonItem(e,t,n){const r=e.loc.string("Arcade.CategoryBar.AllGames.Title"),o=eo(e,YB,t,n,r,uN,rq,JG),i=new V4(r,o),s=Ot(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACACAYAAADHy7H2AAABdWlDQ1BrQ0dDb2xvclNwYWNlRGlzcGxheVAzAAAokXWQvUvDUBTFT6tS0DqIDh0cMolD1NIKdnFoKxRFMFQFq1OafgltfCQpUnETVyn4H1jBWXCwiFRwcXAQRAcR3Zw6KbhoeN6XVNoi3sfl/Ticc7lcwBtQGSv2AijplpFMxKS11Lrke4OHnlOqZrKooiwK/v276/PR9d5PiFlNu3YQ2U9cl84ul3aeAlN//V3Vn8maGv3f1EGNGRbgkYmVbYsJ3iUeMWgp4qrgvMvHgtMunzuelWSc+JZY0gpqhrhJLKc79HwHl4plrbWD2N6f1VeXxRzqUcxhEyYYilBRgQQF4X/8044/ji1yV2BQLo8CLMpESRETssTz0KFhEjJxCEHqkLhz634PrfvJbW3vFZhtcM4v2tpCAzidoZPV29p4BBgaAG7qTDVUR+qh9uZywPsJMJgChu8os2HmwiF3e38M6Hvh/GMM8B0CdpXzryPO7RqFn4Er/QcXKWq8UwZBywAAAARjSUNQDA0AAW4D4+8AAAB4ZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAASAAAAAEAAABIAAAAAQACoAIABAAAAAEAAACCoAMABAAAAAEAAACAAAAAACBAcQEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIGaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yMTk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIxNjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KIUPY5gAAGmtJREFUeAHtXXuMJMV5r+qZ2Qe7h299bA7O3B0GGwOXBwEsbMXCC1H+QJjHgpbHEcyBEiLl4cgJxLKElIkUS4DtQCCSpZOSEAx3hjW+YwmclAfa4MQScfBL2Tg5ED5uyfFYw0Lu9nZvHl35/b7qmu3Z65numZ3dndnpupvt7np+31e/+qq6uuorpVKXSiCVQCqBVAKpBFIJpBJIJZBKIJVAKoF6EtD1ApcbZpRa0fxJHwpAMe3hVprfleS1ZRVlRkayqr8/ozbPa7Wh36gTW3118KBRw8NG7djR2sqamrJ0D73mqdmztRqY8QQKc8M+yirpfN5fSWgYA/zdOJarKnfoNQNabLkrwe/MjFbnnqvV9LRXkfGm+bLOT5ZaweuygWCuvLKXhOgDB060gqDl5mHyylNTY6SpoMfHy8vNL5ze5PPIe2pF8g6X08i9GRvrUacf0/qR5cm/aSCIUA5N9uhHJxcc4ebma7aoTHabMmYLNPZpaDcbAJE+hGfg13RZLn939Y0xnucVlPGPI/9ZlPUO7t9Qpb7XUfnHXDyza6QvTJ/zb+YqgD9woAAmRLuhAvpVdmG70t6ZyujTkecQaBnwld/jad0yXgNayyjjBCB+FGX8HH5vqkJxWo8/e9jxIoCYmfH1ZHMaoimCTR7dgJr0dV755o6xYVUo3YiKvgJEfgJyolAAANWjPKuxhdimSnJsLrm6jgY6GuVSHc/jbhbiP4xq+gGENqH37vtHpjK7dgEMj1bAuiSnRI8EgdN45pbRzyDX6wDyS5D4LFw/jDIHlNYefja/leCVOVt+i7gj2N/B7xXw+qLKZZ/Uj40LKAgINIYCwhpyDZNs7rorp3fvJjHK3Dx6p9LmbuXp86XSSajvs5oYTrXMSqIvZcRLSxwydCIH0lABymThw58UpMrl4xDQ8ypT/rJ+fOLV5WgGJ1gzduWwyvU+AAauA68bAQBwB5aMKYOeEoq2/LaQz4qwOCYBZ/ixZWVQak5D7Qjrvoj4Z/B/WD+x/yFcVRi4fE7imHlixwGhUz1m57V/CUK+IML3/XmQeYI1LjVkQDDIRNVL/ga1whsE0xvRws8n+yMWo8KFuxP6uWcXbiPhr0iDCRApi7JOUdlMRpXK00iyC9rhhWbA4Pg1t157AYh/Gt3eeQAZKxxdklQ8LsIjKygkS0un47eaboYt5WWRLysbKyOXOa+ShhLlP2SIH3lmmTkIfQCNERSZx1Qx+9vUCA7ACE/kyEAiZzgI4xsAnNl53UMqm/0CxF6EBkAfrUogrQe13YP7HpCHrgPjAotgkEgcoOO0fad9to8MQqDghF2rPCM9gYSfe+YVz4xHvyDfIF4GVwhDyu1FIHk6BhB8gJa7FTL/trn1+k9xrMBuAmGJHMdABL0Zu3obyj2gvAxB8AESUy2TPvLJH8smDSw3+JFGchPQKtfwPdPjORwuz6xOGw+PEkF4DvyQP8uB5pMye3GlvAENM6vK/hy6iM/72eJfw08JGKQL51O8o1ATOSCsH5nPm1tHb0eCR1E4+6HjATEWo4lyWoVI5Mq2nKKocd9Mqb7yp/XfTBwNd21JKDE7R19QWe9yAOs9xOcbAytbGkSS9Csex/JKFcOBbAYNdFCVS3ejm/g6/LTK53WS12kyFesCNTNvdl6FkbH5kiTQAQgokvYRi5DG/gEioIiyxi/PoZ3tUAven0hg4SA1VV1n7ro4xwgCeguC9/FIbWLFzsB2cVb27FuoHU5Aa6HT0F80O2/4OPyMOnIkll+ykggIiGcz0z03Ievz8eMoPFEBLGS1HWsrACdVbRndFwcPNxLI0kXw3bue2/2ynaQx5nehCRiTKjnIsl7CNQ0jJPqkm8hlPoLX6RtIDQf28qofQ1osEKANMuwSmA9e1H5d3g6UKUCwmBuIyX2tgwUR0oqL6HC3o9FcJiQtLHAME+lkgAhWzW2jv4gIv4IfB4bCq80uMlm7eLI+MYhExWhzBTW5JWwytp5jIyAjafnm86ObIMxz2bTg7LDfltK+fy1Q2UkUMd5C/24uFmLPss08kvDhYSuTkvokQM8xgaiEyLjt6ekFWuw8lfPPFBKPHI3FcDwQBgZsnEIZo2ezOQBCe4ogmiq+dPky8DbqYxJl06Xx6tIzO6Kza2NfO4eBhmvYdaOu/K1CrfsGUof0eCDMzVk0efoM5DOIH/vPWITVKXO1g0gr1CWclqlgJaPoyRrqkh+P6Hy9XUDfSZxaylGnmm9LPZiXxlQ/3FPjnPqqy0k8EAYGbPZKnYYsOXKmqqybKcLbz0mXZjaaO6/h9LfCnEg071uutl2BNsMSL5gUk/vO+MO6KXNGIqPVJpKMLt2+TNehP1oY4QRvv22BoD0KkGqns0RTBVnTr+Yx60h37FhVCL3YakLv3IP4tkXvTnPkCxqQF3Nqhfg/y5/EbyUMN/FAGBwMpGH6pJ/l9GhnQYH8BjzoHIa5diRtRwthWSiVt5qOb0pIgVlKbbuU6ljt/WSrO6gh+fKbiN54ICxmY+cN7IBk0bez7sCvtnxE0p23vjuwCESmjIl59x0gMkGbe9bjtZr0RoBQnbJLnoCIjuwfpHoaWAOSAiEW0J2sEWKZq0RIgVARRfRN56qDaH5q+aZAqCEZ+25Ud6BdI2VneqdAqFtv3aIPkrw+1hVUGrheJJBqhPVSk8vkIwXCMgW4XpKnQFgvNblMPlIgLFOA6yV5CoT1UpPL5CMFwjIFuF6Sp0BYLzW5TD5SICxTgOsleQqE9VKTy+Sju4DQPZ8OGoZFdwGhgU8Hss4P4uwW7HQXEBpuJ0zQwQtTGuA3BUIDwlrPUZMDwV8XLQOWG7z4DmKSVe747eAVSl7yxbfxQKgs+4YtBDqsjxVJxotTorfJH9fVl1WxYDe4vhpBWT5vuZqcxN4QE2zkcYCIiN++XpZf2q9I6OKB4JZ9e3oOwuFSf2ydIBwSlrDW0cKAhdE/1Z+z9pQqy/SrCUR0jBMF7tz42ylcLjJh+Q3Wmpu5xYD6d/FAOLrZCsMo2ggoQEpMExZv/RLaKVTDKtnMAi2ewAba0Ek8CADGxgKZwFobIdF5jnx5sl1PLM5JZdFgxkn8hlmLB4Lb+6j020jIVsJ9AXUzDRfQJvdYlS6V+q6zjqZmZ2ttXrH7HgxM2DFNJ+3jIIta9nlmxWCGljrDxp08OalbZ/FAGJgJMtBv4IatJD5Nm9R+QAbpB8286NfpJxZRxsejgRCMiXxP2VFEwD3TdYTjzm+Y+AHZ7wMM/ys019rwG2IovlJ7zrWbQgc3TQNVh4OWFYOvUAlrfSstBDt+YKUT28T/S8iZPZuW16KrOBg7QDA/oqUVOETtEGdHbtgA62UxxH0dw/ppofzcVthH2L27tGiASv8gkF8WBUS3qDaTmd3Harjf8V2A+HtC3uIO75OphS1n8SzkXkI/+xbQwrTRoDk59Zr5hAiELRvAWOvv673P0kor9HhgI7oOdbEaQVrO7CwrHq68Hy3r/3DD7fEwPkG/tnacBOD4gHz+u96z/0cQmFZnnVXTMil3Q7PrgLmg95DuOZ3xepCmRF5Dwm47pjkIgCOd/apYQgdRfpYeYgoogU3qWCAwM1g8PyF2B/dMvIiCngPiOKBKsOteUq/lH2qtHrRsvE+bB4WQsbG+0Nb3aNoqLShzP/rZBcgYecB0RnTs9vC13cIJmNfjtv/n1HkX/b0QNpKMvERAEMG99JKYnINhx7vxO4TZBNpLoBptx4ZCmggCDxZYqdof0Xue+SdnJhDPdR20QVmMiO15+hXg/R4YsuxHAlgdsR1N3cSrHCjCtwiF9Vt9GrTBDOrmXtFstMuc0Ix/IiCQN752iRnbb00cwSBqDGJBgd6HQIgTOgXPe6GNaVbRuXJJQ0AHbDNnswOqWN6LLuGPA1rswDcBYQQDoyHtX6lS8avI61T0MZQX8hdArDG/jgZcjRgLg3FwQwOot+vH9/04eDNKPLPYsLZzBp/NTaPnm4x5XGcyF0F9oiJgRl7DAB/JWn0wOD5YUbCJCGMYtNquzdf1E8+IoU1p4Qn6SqSvODKFjMmPglX2P4KQv4IfbRlyjEGgIIwVsurT0MAk/uG0AvQIOdRBBlr6FYwM7szt3fevYj0/P1l2tJP+OOcEGBevKjxQsbS1qNXO0buN9u+EMM6B9WDbfTC2AJaCopDwv6WOZBtmbMdIwUjJ1gnen43C24F/v+aYhjGtrcjE2iBMKsvgM4UK49y/hLt7UfTleMR5FEHBlldGY3T88L+lzvKLLDnwreSM+X5W9mF471XHyvfpCZgYXi0z/Y6KxVdKsE3DjtnSZyGDSxF+Pn4fAXE018uBC8HBltpqh/GJwakx+igynsH1Z3j+iSrr7+on9/2UhQld4+NFCGtZNYPEWo2N8U1C3jbMbVd/VJUzn0URF+J3NkJ/AddTUQrMC0Ej2YEbvFrmSD/VPFU/p/rfRBn/A2h+X/WbSdqYZknNgoBpF+HFpwadPcXlEE5xOflgDDnxZMg7RRVP6VWZEx5U17LKqiItA42Yy5RUrjyvtl00t/QtgK9MPF+qMp1clbj5BwEWvlG48yrCOSGMpgf7wWuupbyykIH+sppTBTUwcDxS1jipRs0NF924JkxX0vuWVA6EkAGROcXvEkNDpShBJSWomXgCyHfxVvPWIDVPWbVAC9SjQwDBsQin35dZAfXKqRUmA0HMjkr4zEzRnaFRK34S/5YAYWlBUjGc3+apZLOzK1KGfD3cglPkpnCGBL4boJBlqf+lPCR9DroNT9EA15EV5pen5o2M+PySuFb8JpVLGi+VQCqBVAKpBFIJpBJYHxJYkYFcOlhcAXBwaV0wWFz6utyK0loChPT1sbVHD8dVbNu9Pq7phFJ/L05lObGgtk1gQkk+NFXkl04oVUSR+KZpjVA1xcyDwjf2XYYp5k+h5PPwSzLFzLL57i9Xvo/jxj3DuzIv4OLRT1wQKXKKuYAp5t6VnmLeecPZmLe6DMQ0MsXs+JAvVHwIXBXPITm4cF4Zp/2mmDmzxnl30QgHf3gPiNyFejwHVdnAR6eKXAI+cRHn/Gs9O3/5umM/wbgPMfbjz/uQ2ve0b+7T33rmu4zNrqvZ6VdWDPPAH2NuueaX8SX6Xjxejt+m6I9OFQAzWcg5vsJXBrOOnV8oetWthPNP1UcnUMT1INOQxB5V6LkPPB5zdVOVPMEDM2/IVT5D3zZ6Po6gfVy182doo76m9+7/EhlsBgwEAQTEmsJn6Ou4puErWPTRiwoIfYaWcInDeKvkKp+hQWIOdYDP0OVXcLzEHfqJiX9b8c/Q7nxlc/M1l+CI3OchlGHj++GjUByw3HWV5FJphaEK4cKUTB9W7OwFGHaSkGbAIOluvfYBlcndo0ol7uvA52xZCsmyHJ/uyuir4Ryf0IE8cE9jraL+EACKownNGFZjPS8DSpxfCcJc3Lp0Jf48LJqA5yv/5vVnYGXSU/iwPIyVSh+gIAqB+fDHe/5W27lyQ3RAbZZKOC85cwuO9f2LgCCutUzkCBpGxGmwv6eyAgIu2uWaBpQhfVGb8Esc4FO/MVxsewq+gP8dzu6+UO9+uchP5+QhiSMzsU7GAoOD7I+w3sP/GhavfhRL1fgNnF/A1qLiSUk9R5rIm48zEKnGfx8rjH5DxjU447peQoY5zWFuuu4cCPirqljkfknml0hezGO1nAjftvl+0PpznctywcyfBzxgHIdP8glcMsampno52IIwP4M8P4fv7XaZFrHY3o78FaTFaPNFIXV8fEGAXY/uodesXDycg53JADhchqcS7Kevl+kKh9mteb3Qgsexcukq1Vu+SkqcTFZuLBAANlljINlpM4pxAU8Osy0kUe+TjJAVikWgYo8T1i8q9UmMbX4VHkYdOsSVzZGOIKFalQPRtQboRaNkk/W0kVmuimewWi6L67zOZqG4/WtYMNcquG6uHiGxQFB3XZyVg6a56kepi4OegN1EfNp6Ja9WGLUWV/na171PS7GVjb0RRLjT1U0Pl93x0FN2LaL52ln9OdpwxSY/n+rrEnPL1TyrEzu/Aw0nD9F/4iuzsMEOsLZs2oYstqIfsjm5kqPzbR9f2nPQ2H/Bv0rbY36HXsOCX1u5JxE6Pe1kciEGxQxuf73nmLDdA/Z5+iW812zHC8VWCTq4IZYHx7TL6uTr3HBQ5cUzEci181SzneRIP2gmDhTBrIIRdTTvFQMa5uOdxGSFVmu/4gS43YjxDWZ44bCqqSbwg4TRwggC5VLZMJrZjMy4KpkDxQAc4YhtfY/XbTYKc5osqiWpQ0O1eCd/5PCMQPt1Dq/ConTZJYAA7OJQd7oYIxmMUksYDLNugzsSWG2ERPBeqjsRCJYXowfVcB9XG2OH8MlrKaXVVOwmmKEACDZt5/wlcLG5hxfwAIc7Q2MZvK/l4oHwapDUNwPInHmybdneqFau7eQvUggI0qpXzRe5kzvybGh6C4PCn+Z8A9tYZzlb3cHOCj2QlPh4IFT6zOCDEiAgZdkCk5azpvFYuQEBGZXrsRMsH4sgybWakRFum2M8gN6yGxG7nb0sv+GPgDHUxgPBZeB1pEAc9e7KV6t4CI8wusO7fDV26Tvr6pvE9Zs4YmdJIKW2UQmkQIiV2LrQhLFcdhcQ4juFisAwOJDYbnBRCVinN90FhG6p1SbA2l1AaEJA3ZIkBUK31HQMnykQYgTULcEpELqlpmP4TIEQI6BuCU6B0C01HcNnCoQYAXVLcAqEbqnpGD5TIMQIqFuCUyB0S03H8JkCIUZA3RKcAqFGTWMtVld9mUiBUAMIzruBD5YuSUdeUyDEVlsHr1CK5W0xQgqERVlE3nXomkXLi04O4uRA8GU/A5eBdrK2xEYXY/ctRFZ73vrSrK8cm8f9csmFGZnlmnrW47WasHgguLOhPb1g1/lj6VbnDaQC8OJsJy3WTlRwqmO1NPJ2gChmdjSOD1bJF39WZ7SGT8H6ZcuJsccfJyAnHgib3ZHAPu0hYPNrh42nq8b+eh6G9GFVBK6yTF+e5A/QYipb5nl8sGwSWQzvkDtyjHrlRdO4h3V/mq+ShPN213ggLO4c5hmC3BnMTbF1M3WZt9VVKlW/7w65UDMz0Xs4jzxrN/362p6Z2Hnaj3XDA09xsTzI+suYDj0eCG7vo2/eRM7OSkonAYG0Cp8wlPAW7pW0epq7j3KzZ1uRaWNPve0kTi3l4AubkXy/gObKOlPqxjGP2i6KXednd/24p6jr3JwVWE/msCqZd6AuN9uxQlTktvTj8Naenq6DkQEO+dCPHMAYoI7TeqpOaHsG2YE8BsOG2/pgds+bFkKtfYQ6g+Qkm2Dt7melH9v3LiB1MOg3NTdAtr2zLYRvADQ2hfOE9MtC86GsVf9RDLguwy//ByzGua4wKmZb+qFafFiTI20/VUXvDSFySwvsI4jtpMAAFeT6z7TGAcT14L7c9i+SFqz8S+tih1SP+RcRTF8fLb5EOncsjt478RPw+GNEsqYA8NABjvv50A2SWPMCjYdZmmt0gyGG4scINrJVK8Xckyjkv6FyqHrqqppQGat+K/VvK46nt2YCyydP6Uf3vy+2IisCiiaN5oUlxJhv4OBP3pbr97DR+ayyLzlegMYegkGtN2A752mWL6aScd51HC2JgEBkmV27+nB9Txn/gSDTUyAcWiyzAIwraRXD5QWBHQJed7WXGQDN/6mKOUt3z9FYALvDyfTeZ/4WBjsnoWo3gkm+k7NHtBBbRX7qFmWp4V+2fpyoh27B6Af14xOvCq1btsTyy/wTAYERFU5YF9t9FI5RD0M4tEwGIWPixQTawYHCXSVh6I8l2nq4OLX8wuHuninj4kMM+EfjWbCb5G1EPz+L1vFbAPEx0QY0RJnAVeYTcrnbYatxGjaYPsw8UTwFbodlji53XZqvo9VdGe7uw2ncvQtbGs/lG4onlcxnmQEVK3dZlcsNQht8U+/dZw2M5kcySc92CBftiqt5lSPoYa6NEWDd8yGooT+UwaPv44BqAQRbDF9VZG42EBdjyzytna519+TBysVeOf6kOVk6N60b3oDqwl2YROQfJpeBS3DPkdIAgJqRCjR6FwTzgjMfjLDEzvGLE2AvAE3fhtlh2J8uc2x0HKW6lkaS2aBCsnQ8ktZqHuxz2H/pPcljGscvnwOeOafBf4s8s8wc6mBApF72vwnNR9Cz0YrhdKZO4kLEJ4kOCtB/OtVpbrn2DhBxN34XSD9MGPgyk8FWR0HZCmrxpAyKCQAjAyNUgsnChz/IDL9ymbOHBzCv8mWNE9/NH1zZG/u6WIN9J1AxVedl7kc1wNakNyTVTlZxLC/oKaFYxy8hwcpqnVvUPwRcBuXhPGiUyDPLOXg35hAKfVjv2fcgC3WG03mf1DUMBGZszbqO+FQ7ENSw6indCGKuADGfQCgNONEoZ08wSGMSCqd1zomZwBPVaOaROWwR493ZmB8CDBP6if3/wAJlbBNxUm0jxISBZG69/tcg/FGUdQnyOAtXWJqDBtKoFYKQbiV4Zb7CL76XwPAPfu/g9wqUx4so9ym95zuv45nmgxvSBExD1zTJ0ocemsRxwJOVDxuwbLpFZbLbQPAWkASbwGoDiuAbBs5LDqtIKbv5P2LGycNA1UfL17Mo6x0MCN9Qpb7XORZwGTfTHbi0S69ije3SA0WdFy1Hgfer7MJ2tMozURmnIz4MV0FFa8M3DrbcVjq8tcAMsIeZXaPeRcUfUYXitB5/9rArhADgtLl7/XX+Sa9NA8EV4MzVtfocZpd/o1c0Go0pVYKvAFC4frzRbCLjC/hhl3ol8o4sMIGnAOD0Y7rZrs8VsWwguIzcOUpq8zz0QD/eJbb6cirZML7t0+3Y4RS6S9L8dWrK0s2pU34bGJixLXBu2Ec5paQj5WYJELD9zl1ZVThoZyhZ7tBrBrTY9/VW8koiye8MjhzmEcu0DOtkvGm+rPN28N4sLy5dy4DgMgxfUfMrmj/LQgGtA1iY+CbuV5rfduK1CfGkSVIJpBJIJZBKIJVAKoFUAqkEUgmkEuhoCfw/vJfHMO4YqncAAAAASUVORK5CYII=",36,36)
var a
return i.artwork=s,i.accessibilityLabel=r,Oh(e,i,(a={targetType:JG,pageInformation:t,locationTracker:n,recoMetricsData:null},Bv.context("impressionOptionsForArcadeSeeAllGamesRibbonItem",()=>({...a,id:uN,idType:rq,kind:null,softwareType:null,title:"All Games"})))),i}static createTagsRibbonShelf(e,t){const n=ge(t,zO),r=new YY("ribbonFlow"),o=[]
for(const t of n){const n=(0,jv.attributeAsString)(t,Zq)
let r=null
switch(t.type){case mN:r=(0,jv.attributeAsString)(t,Rq)
break
case lV:r=Fi(e,f(t,uG))}if((0,Nv.isNothing)(r))continue
const i=e.required(n3).fetchFlowPage(r),s=new fY(i)
if(s.pageUrl=r,(0,Nv.isSome)(n)){const e=new V4(n,s)
o.push(e)}}return r.items=o,r.isHorizontal=!0,r}static shouldPriorizeItemWithData(e,t){var n,r
return null!==(r=null===(n=e.userDefaults)||void 0===n?void 0:n.bool($b))&&void 0!==r&&r&&e.bag.ribbonBarVisionEditorialItemIds.includes(t.id)&&e.bag.enableDeviceDrivenDiscoveryContent}}class q4{constructor(e,t,n){this.$kind="SmallBreakout",this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class W4 extends L2{constructor(){super("GroupingSmallBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&j(t,dH)===LH}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,o){const i=[]
for(const o of n.shelfContents){if(r(o.attributes)||zi(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}const n=Zf(e,o)
if(Dc(0,o)&&!W(n)){t.isDeferring=!0,t.remainingItems.push(o),t.relationshipToFetch=aH
continue}const s={targetType:Bb,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o)}
let a
const c=j(o,$H)
a=et(e,o,aG)?e.loc.uppercased(Kf(e,n,c)):c
let l={type:rq};(null==a?void 0:a.length)>0&&(l={type:UV,title:a})
const u=Gf(e,o,Zq)||Qe(e,n,Zq),d=Gf(e,o,Uj)||Qe(e,n,gj),h=Jd(e,n,{useCase:n6.ArcadeSmallBreakout,withJoeColorPlaceholder:!0}),p=ye(f(se(n,nt(e,o),Hq),ZN))||(null==h?void 0:h.backgroundColor),w=new b4(u,d,l,null,Cc(0,p),null),g=new q4(w,h,p),v=Lh(e,o,g.details.title,s),m=et(e,Kc(0,o),eq)
v.isPreorder=m,Oh(e,g,v),gh(0,v,g.details.title)
const y=_c(e,o),A={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:St(o),targetType:Qq,id:o.id}
Qs(e,y,A),g.details.callToActionButtonAction=y,g.clickAction=y,mh(s.locationTracker),g.flowPreviewActionsConfiguration=oa(e,o,!0,null==t?void 0:t.clientIdentifierOverride,y,s,A),i.push(g)}const s=new YY(Bb)
return s.isHorizontal=!1,s.items=i,s.url=Ki(0,s,t),0===o.shelves.length&&(s.presentationHints={isFirstShelf:!0}),s}}class z4 extends L2{constructor(){super("GroupingTagBrickShelfController"),this.supportedFeaturedContentIds=new Set([p0,w0])}initialShelfDataFromGroupingMediaApiData(e,t){var n
return(0,Nv.isSome)(t)?{shelfContents:null!==(n=we(t,Jq))&&void 0!==n?n:null}:{shelfContents:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>({shelfContents:e.data}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=V(t,vb)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=Fr(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,dH)===LH,d=new YY(Ub),p=h(t.featuredContentData.attributes,mb)
if(d.rowsPerColumn=null!=p?p:Z(e),d.isHorizontal=!0,(0,Nv.isSome)(r.shelfContents))for(const n of r.shelfContents){const r=z4.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s);(0,Nv.isSome)(null==r?void 0:r.shortEditorialDescription)?((0,Nv.isSome)(r)&&a.push(r),bh(t.metricsLocationTracker)):(t.remainingItems.push(n),c.push(n))}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.contents.data"))&&(0,Nv.isSome)(t.featuredContentData.relationships)&&(t.featuredContentData.relationships[Jq].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=h(t.featuredContentData.attributes,iM)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const w=u(t.featuredContentData.attributes,BE)
if(l&&w){const n=new YY(D$)
n.items=a,n.presentationHints={isSeeAllContext:!0}
const r=new ZY([n])
r.title=t.title
const o=new fY(eW)
o.title=e.loc.string(KV),o.pageData=r,d.seeAllAction=o,Xs(e,o,"",{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}return d&&o(d.items)&&t.isFirstRender&&ec(e,d,t,t.featuredContentId),t.presentationHints=d.presentationHints,d.url=Ki(0,d,t),d}static createBrick(e,t,n,r,o,s,a){var c,l,u
const d=null!==(c=St(t))&&void 0!==c?c:void 0,f={targetType:n?Ej:sG,pageInformation:r,locationTracker:o,recoMetricsData:d},h=is(e,t)
if(!h){const e=new U2
return e.shortEditorialDescription=j(t,Zq),e}const p=new U2,w=(n6.GroupingBrick,rs(e,t,0,0,0,f))
if(w.length>0){const e=w[0].backgroundColor
p.collectionIcons=w,(0,Nv.isSome)(e)&&(null==e?void 0:e.type)===bV&&(p.backgroundColor=null!==(l=Qf(e))&&void 0!==l?l:void 0)}p.accessibilityLabel=h.title,p.shortEditorialDescription=h.shortEditorialDescription,p.clickAction=h.action,435===q(t,xj)&&(p.personalizationStyle=pN)
const g=pe(e,t,Jq)
if(i(g)){const n=Js(e,g,f),r=null!==(u=null==s?void 0:s.clientIdentifierOverride)&&void 0!==u?u:null
p.flowPreviewActionsConfiguration=oa(e,t,!0,r,p.clickAction,f,n)}return Oh(e,p,Lh(e,t,h.title,f)),p.artworkSafeArea=G2.defaultTileArtworkSafeArea,p.textSafeArea=G2.defaultTileTextSafeArea,p.isValid()?p:null}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,dH)===LH&&(r.title=NE),r}}class Y4{constructor(e,t,n,r){this.impressionMetrics=null,this.badge=e,this.title=t,this.subtitle=n,this.$kind=null!=r?r:"PageHeader"}}class J4 extends Y4{constructor(e,t,n,r,o,i,s,a,c,l){super(e,t,n,"MediaPageHeader"),this.artwork=r,this.video=o,this.collectionIcons=i,this.useGeneratedBackgroundGradient=s,this.backgroundColor=a,this.style=c,this.backgroundStyle=l}}class K4{constructor(e,t){this.$kind="TitledButton",this.title=e,this.action=t}}class Z4{constructor(e){this.$kind="TitledButtonStack",this.buttons=e}}class Q4{constructor(e,t,n){this.$kind="UnifiedMessage",this.placement=e,this.context=t,this.deliveryMethod=null!=n?n:"pushAndPull"}}const X4=[new $2,new B2,new j2,new H4,new V2,new q2,new z2,new Z2,new M2,new n4,new a4,new J2,new M4,new x4,new F4,new U4,new G4,new j4,new W4,new x2,new class extends L2{constructor(){super("GroupingMediaPageHeaderShelfController"),this.supportedFeaturedContentIds=new Set([585])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:we(t,Jq)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await L2.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){var o
if(!Gi(e,Fj))return null
const i=n.shelfContents[0]
let s
if((0,Nv.isSome)(i)){s=null!==(o=f((0,jv.attributeAsDictionary)(i,dV),Zq))&&void 0!==o?o:null
const t=qd(e,p(Ec(e,i),"categoryDetailStatic16x9"),{withJoeColorPlaceholder:!0,useCase:n6.Default,cropCode:"CDS.ApTCHM01"})
if((0,Nv.isSome)(s)&&(0,Nv.isSome)(t)){const e=be(t.backgroundColor),n=new J4(null,s,null,t,null,null,!1,null,null,e?kq:QH),r=new YY(C$)
return r.items=[n],r}return null}return null}},new z4]
class e5{constructor(e,t,n,r,o,i,s,a){this.$kind="PrivacyType",this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class t5{constructor(e,t,n,r,o=[]){this.$kind="PrivacyCategory",this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}class n5{constructor(e,t,n){this.$kind="PrivacyPurpose",this.identifier=e,this.title=t,this.categories=n}}class r5{constructor(e,t){this.$kind="PrivacyHeaderSupplementaryItem",this.bodyText=e,this.action=t}}class o5{constructor(e,t,n,r,o,i){this.$kind="PrivacyHeader",this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class i5{constructor(e,t=kV){this.$kind="StyledText",this.rawText=e,this.rawTextType=t}}class s5{constructor(e,t){this.$kind="LinkableText",this.styledText=e,this.linkedSubstrings=t}}class a5{constructor(e,t,n){this.$kind="PrivacyFooter",this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class c5{setShelfId(e,t){this.shelfId=e,this.index=t,X1.has(e)&&(this.section=new zY(nW,e))}}class l5{constructor(e,t){this.$kind="AccessibilityParagraph",this.text=e,this.actions=t}}class u5{constructor(e,t,n){this.$kind="AccessibilityFeatures",this.title=e,this.artwork=t,this.features=n}}class d5{constructor(e,t,n){this.$kind="AccessibilityFeature",this.title=e,this.description=t,this.artwork=n}}class f5{constructor(e,t={}){this.$kind="AnnotationItem",this.text=e,this.heading=t.heading,this.headingArtworks=t.headingArtworks,this.listText=t.listText,this.textPairs=t.textPairs}}class h5{constructor(e,t,n,r){this.$kind="Annotation",this.title=e,this.summary=n,this.items=t,this.items_V3=[],this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class p5{constructor(e,t,n,r,o,i,s){this.$kind="ProductCapability",this.type=e,this.title=t,this.caption=n,this.captionTrailingArtwork=r,this.linkAction=o,this.artwork=i,this.artworkTintColor=s}}const{routes:w5,makeCanonicalUrl:g5}=uc(bi,"/{platform}/story/{id}"),{routes:v5,makeCanonicalUrl:m5}=uc(bi,"/story/{id}")
class y5{constructor(e,t,n){this.$kind="AnnotationGroup",this.title=e,this.annotations=t,this.forceExpanded=n}}class A5{constructor(e){this.$kind="InformationContainer",this.annotationGroups=e}}const T5=[lu,du,Ml,Gl,fu,xl,Vl,Zl,Kl,Jl,Nl,hu,Hl,ql,jl],b5=[du,Ml,Gl,fu,xl,Vl,Zl,Kl,Jl,Nl,hu,Hl,lu,ql,jl],S5=[lu,Ml,function(e,t,n,r,o,i){const s=Ze(e,t,QB)
if(0===s.length)return null
const a=s[0]
let c=null
const l=f(a,YB)
if(l){const t=e.loc.string("ProductPage.VersionAnnotation.Value.DateFormat")
c=e.loc.formatDate(t,new Date(l))}const u=f(a,PD)
if(0===s.length)return null
let d
if(u&&c)d=e.loc.string("ProductPage.VersionAnnotation.Value").replace("@@version@@",u).replace(vA,c)
else{if(!u)return null
d=u}const h=new f5(d),p=o?"":e.loc.string("ProductPage.VersionAnnotation.Title"),w=new h5(p,[h])
return w&&!r?w:null},du,ql,jl],P5=[xl,Kl,Nl,function(e,t,n,r,o,i){const s=[],a=Fl(e,t);(0,Nv.isSome)(a)&&s.push(a)
const c=Ul(e,t)
if((0,Nv.isSome)(c)&&s.push(c),0===s.length)return null
const l=e.loc.string("InfoList.AgeRating.Title.KR"),u=new h5(l,s)
return u.shouldAlwaysPresentExpanded=!0,u}]
class C5{constructor(e,t,n,r){this.$kind="ProductDescription",this.paragraph=e,this.developerAction=r,this.tags=n,this.developerLinks=t}}class I5{constructor(e,t,n,r){this.$kind="ProductPageLink",this.text=e,this.clickAction=t,this.systemImageName=n,this.adamIdForPurchaseHistoryFilter=r}}const k5="safari",O5="hand.raised.fill",E5="doc.plaintext",R5="questionmark.circle",D5="exclamationmark.triangle",_5="checkmark.seal"
class L5{constructor(e,t){this.$kind="EditorialQuote",this.text=e,this.attribution=t}}class M5 extends dW{constructor(e){super(),this.$kind="GameCenterPlayerProfileAction",this.actionClass="GameCenterPlayerProfileAction",this.playerId=e}}class x5{constructor(e,t,n,r,o){this.$kind="InformationRibbon",this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class $5{constructor(e,t,n,r,o,i,s,a,c,l=TH){this.$kind="Badge",this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r,this.isMonochrome=!0}}const F5="DeveloperPageIntent",N5=[bu,Mu,Au,Ru,ku,function(e,t,n,r){var o
return null!==(o=Su(e,t))&&void 0!==o?o:Pu(e,t)},Eu],B5=[Lu,Ou,Tu,bu,Mu],U5=[Lu,bu,Mu,Su,function(e,t,n,r){if(!et(e,t,fB))return null
const o=e.loc.string("BADGE_FRIENDS_HEADING","Friends"),i=Wq,s=tq,a=tq,c={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:t.id}
return new $5(s,a,c,i,o,"",null,"",o,TH)},Tu,Au,Ru,ku,Pu,Eu,function(e,t,n,o){if(st(e).isSystemAppFromData(t))return null
const i=Pf(e,t)
if(r(i)||r(i.fileSizeByDevice))return null
const s=function(e,t){let n
if(n=(0,Uv.isSome)(t.maxEssentialInstallSizeInBytes)?t.fileSizeByDevice+t.maxEssentialInstallSizeInBytes:(0,Uv.isSome)(t.maxInstallSizeInBytes)?t.fileSizeByDevice+t.maxInstallSizeInBytes:t.fileSizeByDevice,n<=0)return null
const r=e.loc.fileSize(n).trim().split(/\s+/)
return 2!==r.length?null:{size:r[0],unit:r[1]}}(e,i)
if(!s)return null
const a={paragraphText:s.size},c=s.unit,l=e.loc.string("BADGE_SIZE_HEADING")
return new $5(Pj,YM,a,Wq,l,c,null,null,c,nV)}]
class G5{constructor(e){this.componentType=$x,this.$kind="ProductRatingsAndReviewsMessage",this.messageText=e}}class j5{constructor(){this.$kind="ProductReviewAction"}}class V5{constructor(){this.$kind="ProductWriteAReview"}}class H5{constructor(){this.$kind="ProductReviewActions",this.componentType="productReviewActions"}}class q5{constructor(e,t,n){this.$kind="TitledParagraph",this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}!function(e){e.StoryCenteredMotion16x9="storyCenteredMotion16x9",e.StoryCenteredStatic16x9="storyCenteredStatic16x9",e.StoryDetailMotion3x4="storyDetailMotion3x4",e.StoryDetailStatic3x4="storyDetailStatic3x4",e.HeroMotion16x9="heroMotion16x9",e.HeroStatic16x9="heroStatic16x9",e.HeroMotionRTL16x9="heroMotionRTL16x9",e.HeroStaticRTL16x9="heroStaticRTL16x9",e.LargeBreakoutMotion16x9="largeBreakoutMotion16x9",e.LargeBreakoutStatic16x9="largeBreakoutStatic16x9",e.LargeBreakoutRTLMotion16x9="largeBreakoutRTLMotion16x9",e.LargeBreakoutRTLStatic16x9="largeBreakoutRTLStatic16x9",e.StoryCardMotion3x4="storyCardMotion3x4",e.StoryCardStatic3x4="storyCardStatic3x4",e.StorySearchStatic16x9="storySearchStatic16x9",e.SubscriptionHero="subscriptionHero",e.UniversalAMotion16x9="universalAMotion16x9",e.UniversalAStatic16x9="universalAStatic16x9",e.BrickStatic16x9="brickStatic16x9",e.BrickStaticRTL16x9="brickStaticRTL16x9",e.SearchCategoryBrick="searchCategoryBrick"}(Rm||(Rm={})),function(e){e.Hero="hero",e.LargeBreakout="largeBreakout",e.StoryCard="storyCard",e.StoryDetail="storyDetail",e.StoryDetailLandscape="storyDetailLandscape",e.Search="search",e.Brick="brick",e.EditorialLockup="editorialLockup",e.EditorialPage="editorialPage"}(Dm||(Dm={}))
const W5={hero:[Rm.HeroMotion16x9,Rm.HeroStatic16x9,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],largeBreakout:[Rm.LargeBreakoutMotion16x9,Rm.LargeBreakoutStatic16x9,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyCard:[Rm.StoryCardMotion3x4,Rm.StoryCardStatic3x4,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyDetail:[Rm.StoryDetailMotion3x4,Rm.StoryDetailStatic3x4,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyDetailLandscape:[Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9,Rm.StoryDetailMotion3x4,Rm.StoryDetailStatic3x4],search:[Rm.StorySearchStatic16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAStatic16x9],brick:[Rm.BrickStatic16x9,Rm.HeroStatic16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAStatic16x9,Rm.SearchCategoryBrick],editorialLockup:[Rm.SubscriptionHero],editorialPage:[Rm.StoryCardStatic3x4,Rm.HeroStatic16x9,Rm.StoryCenteredStatic16x9,Rm.SubscriptionHero]},z5={hero:[Rm.HeroMotionRTL16x9,Rm.HeroStaticRTL16x9,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],largeBreakout:[Rm.LargeBreakoutRTLMotion16x9,Rm.LargeBreakoutRTLStatic16x9,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyCard:[Rm.StoryCardMotion3x4,Rm.StoryCardStatic3x4,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyDetail:[Rm.StoryDetailMotion3x4,Rm.StoryDetailStatic3x4,Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9],storyDetailLandscape:[Rm.StoryCenteredMotion16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAMotion16x9,Rm.UniversalAStatic16x9,Rm.StoryDetailMotion3x4,Rm.StoryDetailStatic3x4],search:[Rm.StorySearchStatic16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAStatic16x9],brick:[Rm.BrickStaticRTL16x9,Rm.HeroStatic16x9,Rm.StoryCenteredStatic16x9,Rm.UniversalAStatic16x9,Rm.SearchCategoryBrick],editorialLockup:[Rm.SubscriptionHero],editorialPage:[Rm.StoryCardStatic3x4,Rm.HeroStatic16x9,Rm.StoryCenteredStatic16x9,Rm.SubscriptionHero]}
class Y5{constructor(e){this.$kind="MetadataRibbonItem",this.viewType=e,this.moduleType=null,this.labelText=null,this.borderedText=null,this.highlightedText=null,this.starRating=null,this.secondaryViewPlacement=Uq,this.artwork=null,this.maxCharacterCount=null,this.truncationLegibilityCharacterCountThreshold=null,this.allowsTruncation=null}}const J5={chartPositions:function(e,t,n,r,i){var s,a
const c=function(e,t){const n=Ke(e,t,sD)
if(o(n))return null
const r=Rf(0,e.host.clientIdentifier)
return o(r)?null:p(n,r)}(e,t)
if(o(c))return null
const l=h(c,OM)
if((0,Uv.isNothing)(l)||l>50)return null
const u=null!==(s=f(c,"genreShortName"))&&void 0!==s?s:f(c,GP)
if(null!=u){if(r.has(u))return null
r.add(u)}let d
d=e.bag.isLLMSearchTagsEnabled?new Y5("highlightedText"):new Y5("borderedTextLabel"),d.moduleType=sD
const w=(0,Uv.isSome)(null===(a=n.searchAdOpportunity)||void 0===a?void 0:a.searchAd)||(0,Uv.isSome)(n.searchAd)?e.bag.adsOverrideLanguage:null,g=(0,Uv.isSome)(w)?e.adsLoc:e.loc
{const t=g.string("MetadataRibbon.ChartPosition").replace(JC,e.loc.formattedCountForPreferredLocale(e,l,w))
e.bag.isLLMSearchTagsEnabled?(d.highlightedText=t,d.labelText=g.string("MetadataRibbon.ChartPositionAndCategory.Tags").replace(JC,e.loc.formattedCountForPreferredLocale(e,l,w)).replace("@@category@@",u)):(d.labelText=u,d.borderedText=t)}return d.secondaryViewPlacement=Uq,Eh(e,d,xh(i,ox,d.labelText,Gq)),[d]},genreDisplayName:function(e,t,n,r,i){const s=Sn(e,t,!0),a=(0,Nv.isSome)(s),c=yd(e,t)
if(o(c))return null
if(null!=c){if(r.has(c))return null
r.add(c)}const l=new Y5(a?yx:hF)
if(l.moduleType=zj,l.labelText=c,a){const t=qd(e,s,{useCase:n6.CategoryIcon})
t.crop="sr",l.artwork=t}return Eh(e,l,xh(i,zj,l.labelText,Gq)),[l]},genreShortDisplayName:function(e,t,n,r,o){const i=Sn(e,t,!0),s=(0,Nv.isSome)(i),a=j(t,dF)
if(null!=a){if(r.has(a))return null
r.add(a)}if((0,Nv.isNothing)(a)||0===a.length)return null
const c=new Y5(s?yx:hF)
return c.moduleType=dF,c.labelText=a,s&&(c.artwork=qd(e,i,{useCase:n6.CategoryIcon,cropCode:"sr"})),Eh(e,c,xh(o,zj,c.labelText,Gq)),[c]},secondaryGenreShortDisplayNames:function(e,t,n,r,i){const s=G(t,GD)
return o(s)?null:s.map(t=>{const n=new Y5(hF)
n.moduleType=dF,n.labelText=t
const r=xh(i,zj,n.labelText,Gq)
return Eh(e,n,r),bh(i.locationTracker),n}).filter(e=>null!=e.labelText&&!r.has(e.labelText))},developerInfo:function(e,t,n,r,o){var i
let s=n.developerName
if((0,Nv.isNothing)(s)&&(s=null!==(i=j(t,$V))&&void 0!==i?i:j(t,Kb)),null!=s){if(r.has(s))return null
r.add(s)}if((0,Nv.isSome)(s)&&s.length>0){const t=new Y5(yx)
t.moduleType=KC,t.labelText=s,t.artwork=Ot(e,sx)
const n=6
return t.maxCharacterCount=16,t.truncationLegibilityCharacterCountThreshold=Math.min(n,s.length),t.allowsTruncation=s.length>=n,Eh(e,t,xh(o,KC,t.labelText,Gq)),[t]}return null},editorialBadgeInfo:function(e,t,n,r,o){var i
if(n.isEditorsChoice){const t=new Y5(AH)
return t.moduleType=dG,t.useAdsLocale=((0,Uv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd)||(0,Uv.isSome)(n.searchAd))&&(0,Uv.isSome)(e.bag.adsOverrideLanguage),Eh(e,t,xh(o,dG,"Editors Choice",Gq)),[t]}return null},userRating:function(e,t,n,r,o){const s=et(e,t,eq)
if(i(n.ratingCount)&&i(n.rating)&&!s){const t=new Y5("starRating")
return t.moduleType=EB,t.starRating=n.rating,t.labelText=n.ratingCount,Eh(e,t,xh(o,EB,"User Rating",Gq)),[t]}return null},supportsGameController:function(e,t,n,r,o){var i
let s=!1
switch(Qe(e,t,qU)){case Vx:case tL:s=!0}if(et(e,t,t_)&&(s=!0),!s)return null
const a=new Y5(yx)
a.moduleType=t_
const c=((0,Uv.isSome)(n.searchAd)||(0,Uv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd))&&(0,Uv.isSome)(e.bag.adsOverrideLanguage)
return a.labelText=c?e.adsLoc.string(OB):e.loc.string(OB),a.artwork=Ot(e,RN),Eh(e,a,xh(o,t_,"Supports Game Controller",Gq)),[a]},tag:function(e,t,n,r,o){const i=t,s=new Y5(hF)
return s.moduleType=F$,s.labelText=j(i,Zq),(0,Nv.isNothing)(s.labelText)||0===s.labelText.length||r.has(s.labelText)?null:(Eh(e,s,xh(o,i.id,s.labelText,"tag_id")),r.add(s.labelText),[s])},divider:function(e,t,n,r,o){const i=new Y5(ZC)
return i.moduleType=ZC,i.labelText="|",[i]}},K5=0,Z5=1,Q5=2,X5=3,e6=4,t6=5,n6={Default:0,LockupIconSmall:1,LockupIconMedium:2,LockupIconLarge:3,LockupScreenshots:4,ArcadeSmallBreakout:5,ArcadeLargeBreakout:6,ArcadeContextualUpsell:7,SearchIcon:8,SearchEditorialResult:9,ProductPageIcon:10,ProductPageScreenshots:11,ProductPageBadge:12,ArticleImage:13,ArticleScreenshots:14,TodayCardMedia:15,TodaySmallStoryCard:16,TodayCardBrandedTitle:17,GroupingBrick:18,GroupingHero:19,CategoryIcon:20,Uber:21,TVTopShelf:22,VideoCardStill:23,ArcadeWelcomeSheet:24,WidgetLockupIcon:25,WidgetEditorial:26,ImageLockup:27,CategoryBreakoutShelf:28,RibbonBarFacet:29,MediaPageHeader:30}
class r6{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}!function(e){e[e.seeAllPage=0]="seeAllPage",e[e.categoryBreakout=1]="categoryBreakout",e[e.other=2]="other"}(_m||(_m={}))
class o6{constructor(e,t){this.videos=e,this.mediaPlatform=t}}const i6=new az(414,896),s6=new az(375,812),a6=new az(414,736),c6=new az(375,667),l6=new az(320,568),u6=new az(320,480),d6=(new az(768,1024),new az(810,1080)),f6=new az(834,1112),h6=new az(834,1194),p6=new az(1194,834),w6=new az(1024,1366),g6=new az(1024,1366),v6=new az(1366,1024),m6=new az(744,1133),y6=new az(1133,744),A6=new az(1032,1376),T6=new az(1376,1032),b6=new az(834,1210),S6=new az(1210,834),P6=new az(312,390),C6=new az(368,448),I6=new az(396,484),k6=new az(410,502),O6=new az(416,496),E6=new az(410,502),R6=new az(820,1180),D6=new az(360,780),_6=new az(390,844),L6=new az(428,926),M6=new az(393,852),x6=new az(430,932),$6=new az(402,874),F6=new az(440,956),N6=new az(420,912),B6=new az(422,514),U6=[iE,rE,oE,$L,ST,bT,TT,mq],G6=112.5,j6=4.5,V6="#9BA9BD",H6={colorHex:V6,maxSaturation:4,maxBrightness:9},q6=[H6],W6=[{colorHex:"#F7816F",minHue:0,maxHue:16},{colorHex:"#FF9034",minHue:17,maxHue:33},{colorHex:"#E3B059",minHue:34,maxHue:59},{colorHex:"#74BD66",minHue:60,maxHue:129},{colorHex:"#72C792",minHue:130,maxHue:169},{colorHex:"#61BFE2",minHue:170,maxHue:209},{colorHex:"#6EA3E9",minHue:210,maxHue:239},{colorHex:"#7D69FA",minHue:240,maxHue:259},{colorHex:"#B363F7",minHue:260,maxHue:289},{colorHex:"#EE7CBD",minHue:290,maxHue:360}]
class z6{constructor(){this.position=0}}class Y6 extends CY{constructor(e,t){super(e.fields,e.id,e.custom||{}),void 0!==this.custom&&(this.custom.isFast=t),this.isFast=t}}const J6="::"
class K6{constructor(e,t,n=0){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t,this.sequenceId=n}addImpressionsToShelf(e,t,n,r,o,i,s){Oh(e,t,{id:null!=r?r:`${this.sequenceId}`,idType:null!=o?o:sq,kind:null,softwareType:null,targetType:n,title:null!=s?s:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,recoMetricsData:i}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n,r){t&&(Oh(e,t,{id:K6.similarItemsShelfId,kind:null,softwareType:null,targetType:n,title:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:r}),this.sequenceId++)}static resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,t){const n=t.sourceLocationTracker
Th(n,0),Ah(n).id=K6.similarItemsDuringDownloadShelfId}static addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,t,n){t&&Oh(e,t,{id:K6.similarItemsDuringDownloadShelfId,kind:null,softwareType:null,targetType:HH,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:kU})}}K6.similarItemsShelfId=vG,K6.similarItemsDuringDownloadShelfId=pO
const Z6="write-review",Q6=bq,X6="appPromotionRequirementKey"
Pe(ye("F0F0F8"),ye("303031")),function(e){e.MoreByDeveloper="moreByDeveloper",e.SimilarItems="similarItems",e.SmallStory="smallStory"}(Lm||(Lm={})),function(e){e.SelectionOnly="selectionOnly",e.PurchaseAndOpen="purchaseAndOpen"}(Mm||(Mm={}))
class e3{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.isFirstRender=!0,this.isBundleShelf=!1,this.showingPlaceholders=!1,this.productId=e,this.onDemandShelfType=d,this.remainingItems=t,this.title=n,this.shouldInferSeeAllFromFetchesItems=r,this.capabilities=o,this.contentType=i,this.offerStyle=s,this.spotlightInAppProductIdentifier=a,this.refreshUrl=c,this.recoMetricsData=l,this.supportsArcade=u}static fromJSON(e,t){if((0,Uv.isNothing)(t))throw new Error("tokenJson is required")
const n=JSON.parse(t,(t,n)=>typeof n===Zj&&"adPageInfo"===t&&s(n)&&(0,Uv.isSome)(e)?x0.from(e,n):n)
return n}}const t3=[aj,eH,Hq,jH],n3=(0,Gv.makeMetatype)("app-store:page-router")
class r3{constructor(){this.registeredBuilders=new Set,this.pageRouter=new YW,this.shelfRouter=new YW,this.paginationRouter=new YW}registerPageBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.pageRouter.associate(t.pageRoute(e),t),this.shelfRouter.associate(t.shelfRoute(e),t),this.paginationRouter.associate(t.paginationRoute(e),t)}registerShelfBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.shelfRouter.associate(t.shelfRoute(e),t)}registerPaginationBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.paginationRouter.associate(t.paginationRoute(e),t)}fetchFlowPage(e){const t=this.pageRouter.routedObjectForUrl(e)
if(!t.object)return"unknown"
const n=t.object
return n.builderClass===BA&&t.parameters[DW.action]!==Q6&&t.parameters[DW.action]!==Z6?oH:n.pageType()}async fetchPage(e,t,n){return await this.fetchAction(e,t,null).then(async r=>await new Promise((o,i)=>{if(!r)throw new Error(`Promise resolved to null action for: ${t}`)
if(r.actionClass!==W_){if(r.actionClass===Zk){const e=r
if(1===e.actions.length&&e.actions[0].actionClass===W_){const t=e.actions[0].pageData
return P(t,n)?void o(t):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(t)}`))}}i(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const s=r.pageData
if(!P(s,n)){const a=r.pageUrl
return a&&a!==t?void this.fetchPage(e,a,n).then(e=>{o(e)}).catch(e=>{i(e)}):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(s)}`))}o(s)}}))}async fetchAction(e,t,n,r=new Set){var o
const i=this.pageRouter.routedObjectForUrl(t)
if(!i.object)return await this.redirectAndRefetchActionIfPossible(e,i.normalizedUrl,r)
const s=i.object
return await s.handlePage(e,i.normalizedUrl,null!==(o=i.parameters)&&void 0!==o?o:{},i.matchedRuleIdentifier,n)}async fetchMoreOfPage(e,t){const n=t.url
if(!n)throw new Error("Page token missing required `url` property")
const r=this.paginationRouter.routedObjectForUrl(n)
if(!r.object)throw new Error(`fetchMoreOfPage: Unhandled pagination url: ${n}`)
const o=r.object
return await o.handlePagination(e,r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t)}async fetchShelves(e,t){const n=Object.keys(t),r=n.map(e=>t[e]),o=await L(r.map(async t=>{if((0,Nv.isNothing)(t))throw new Error("fetchShelves: Null shelf url")
const n=this.shelfRouter.routedObjectForUrl(t)
if((0,Nv.isNothing)(n.object))throw new Error(`fetchShelves: Unhandled shelf url: ${t}`)
const r=n.object
return await r.handleShelf(e,n.normalizedUrl,n.parameters,n.matchedRuleIdentifier)})),i={shelves:{},errors:{}}
for(const[e,t]of o.entries()){const r=n[e];(0,Nv.isNothing)(r)||(t.success?i.shelves[r]=t.value:i.errors[r]=t.error)}if(Object.keys(i.shelves).length>0)return i
{const e=Object.keys(i.errors).map(e=>i.errors[e].message)
throw 0===e.length?new Error(`Could not load any shelves: ${JSON.stringify(t)}`):new Error(e.join("\n"))}}async redirectAndRefetchActionIfPossible(e,t,n=new Set){const r=t.toString()
if(n.has(r))throw new Error(`redirectAndRefetchActionIfPossible: Redirect cycle detected for URL: ${r}`)
n.add(r)
const o=await M(e.network.fetch({url:r,method:UN}))
if(!o.success)throw new Error(`redirectAndRefetchActionIfPossible: Failed to fetch page at url: ${t}`)
const i=o.value
if(this.hasGotoURLInResponse(e,i))return new fW
if(200===i.status&&i.redirected&&i.url)return await this.fetchAction(e,i.url,null,n)
throw new Error(`redirectAndRefetchActionIfPossible: Unhandled page url: ${t}`)}hasGotoURLInResponse(e,t){if(o(t.body))return!1
try{const n=m(e.plist.parse(t.body)),r=f(n,NO),o=f(n,BO)
return!(r!==UO||!(0,Nv.isSome)(o))}catch{return!1}}fetchBuilder(e){const t=this.pageRouter.routedObjectForUrl(e)||this.shelfRouter.routedObjectForUrl(e)||this.paginationRouter.routedObjectForUrl(e)
return t?t.object:null}}xm=e(9100)
const o3={bag:($m=e(1222)).bag,dispatcher:(0,Gv.makeMetatype)("dispatcher"),host:$m.host,localizer:$m.localizer,network:$m.net,plist:$m.plist,platform:$m.platform,router:(0,Gv.makeMetatype)("router"),client:(0,Gv.makeMetatype)("client"),debugSettings:(0,Gv.makeMetatype)("debugSettings"),nativeIntentDispatcher:(0,Gv.makeMetatype)("nativeIntentDispatcher"),personNameComponentsFormatter:(0,Gv.makeMetatype)("personNameComponentsFormatter")},i3=(0,Gv.makeMetatype)("app-store:active-intent")
class s3{constructor(e){this.implementation=e,this.inferredPreviewPlatform=void 0}setInferredPreviewPlatform(e){this.inferredPreviewPlatform=e}get previewPlatform(){var e
return null!==(e=this.inferredPreviewPlatform)&&void 0!==e?e:this.implementation.previewPlatform}get platform(){if((0,Uv.isSome)(this.previewPlatform))switch(this.previewPlatform){case gq:case mq:case Yq:case zq:return this.previewPlatform
case"tv":return $B
case Fq:return GV
default:x(this.previewPlatform)}}get attributePlatform(){if((0,Uv.isSome)(this.previewPlatform))switch(this.previewPlatform){case mq:case gq:return pq
case Yq:return ZV
case"tv":return Gj
case Fq:return HV
case zq:return zq
default:x(this.previewPlatform)}}get appPlatform(){if((0,Uv.isSome)(this.previewPlatform))switch(this.previewPlatform){case gq:return $q
case mq:return jq
case Yq:return Yq
case"tv":return"tv"
case Fq:return Fq
case zq:return zq
default:x(this.previewPlatform)}}}const a3=(0,Gv.makeMetatype)("app-store:locale")
class c3{constructor(e){this.objectGraph=e}get activeStorefront(){return this.objectGraph.bag.mediaCountryCode}get activeLanguage(){return this.objectGraph.bag.language}setActiveLocale(e){}normalize(e){return{storefront:this.activeStorefront,language:this.activeLanguage}}deriveLocaleForUrl(e){return e}}const l3=(0,Gv.makeMetatype)("app-store:seo")
class u3 extends Uz{get isSupportEnabled(){return u3.cache.get("isSupportEnabled",()=>i(this.implementation)&&this.implementation.isSupportEnabled)}get isRosettaAvailable(){return u3.cache.get("isRosettaAvailable",()=>i(this.implementation)&&this.implementation.isRosettaAvailable)}}u3.type=(0,Gv.makeMetatype)("app-store:as-wrapper"),u3.cache=new Gz
class d3 extends Uz{constructor(){super(...arguments),this.cache={}}registerBagKeys(e){this.implementation.registerBagKeys(e)}string(e,t=!1){return this.fromCache(e,t,()=>this.implementation.string(e))}double(e,t=!1){return this.fromCache(e,t,()=>this.implementation.double(e))}integer(e,t=!1){return this.fromCache(e,t,()=>this.implementation.integer(e))}boolean(e,t=!1){return this.fromCache(e,t,()=>this.implementation.boolean(e))}array(e,t=!1){return this.fromCache(e,t,()=>this.implementation.array(e))}dictionary(e,t=!1){return this.fromCache(e,t,()=>this.implementation.dictionary(e))}url(e,t=!1){return this.fromCache(e,t,()=>this.implementation.url(e))}fromCache(e,t=!1,n){if(t)return n()
{const t=this.cache[e]
if((0,Nv.isSome)(t))return t.value
{const t=n()
return this.cache[e]={value:t},t}}}}class f3 extends Uz{constructor(e){super(new d3(e)),this.underlyingBag=e}get todayAdMediumLockupScreenshotEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-enabled"))&&void 0!==e&&e}get todayAdMediumLockupScreenshotAnimationEnabled(){var e
return null===(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-animation-enabled"))||void 0===e||e}get trendingSearchesURL(){return this.implementation.url("trending-searches")}get userRateURL(){return this.implementation.url("p2-application-user-rate-content")}get saveUserReviewURL(){return this.implementation.url("save-user-review")}get writeReviewURL(){return this.implementation.url("p2-application-user-write-review")}get passbookMainURL(){return this.implementation.url("passbook")}get metricsConfiguration(){return y(this.implementation.dictionary(fj))}get metricsPaymentNamespaceEnabled(){if(o(this.metricsPaymentTopic))return!1
const e=y(this.implementation.dictionary(Ak)),t=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT"),n=p(e,"APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT")
return(0,Nv.isSome)(t)&&0!==t.length&&(0,Nv.isSome)(n)&&0!==n.length}get metricsPaymentTopic(){var e
return null!==(e=f(this.metricsConfiguration,"topics.APPSTORE_PAYMENTS_ENGAGEMENT_TOPIC"))&&void 0!==e?e:null}get personalizationUserIdEnabled(){const e=p(y(this.implementation.dictionary(Ak)),"APPSTORE_PERSONALIZATION")
return(0,Nv.isSome)(e)&&0!==Object.keys(e).length}get language(){return this.implementation.string(M_)}get mediaApiLanguage(){return this.implementation.string("language-tag")||this.implementation.string(M_)}get termsAndConditionsURL(){return this.implementation.url("p2-service-terms-url")}get isMonetaryGiftingEnabled(){return this.implementation.boolean("isBuyingScheduledGiftCertificateEnabled")}get accountTopUpURL(){return this.implementation.url("AddFundsUrl")}get accountTopUpTitle(){return this.implementation.string("account-top-up-title")}get isContentGiftingEnabled(){return this.implementation.boolean("isScheduledGiftingEnabled")}get buyButtonMetadataURL(){return this.implementation.url("personalized-buy-buttons/software")}get isTVAppEnabled(){return this.implementation.boolean("uvSearch/nowplaying-enabled")}get emailSupportLinkURL(){return this.implementation.url("supportLinkUrl")}get voteUrl(){return this.implementation.url("voteUrl")}get enableReviewSummarization(){return this.implementation.boolean("enable-review-summarization")}get reviewSummaryReportConcernData(){return y(this.implementation.dictionary("review-summarization-report-concern"))}get reportConcernUrl(){return this.implementation.url("reportConcernUrl")}get reportConcernExplanation(){return this.implementation.string("reportConcernExplanation")}get reportConcernReasons(){return l(m(this.implementation.array("reportConcernReasons")))}get reportProblemEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-report-problem-enabled"))&&void 0!==e&&e}get productPageReportProblemURL(){return this.implementation.string("product-page-report-problem-url")}get productPageReportProblemSADSubscriptionArray(){return l(m(this.implementation.array("product-page-report-problem-sad-subscriptions")))}get productPageReportProblemSecondPartyAppArray(){const e=l(m(this.implementation.array("product-page-report-problem-second-party-apps")))
return o(e)?["1473505534","1416238567","640199958","1529498570","915061776","1130498044","1070072560"]:e}get createAccountUrl(){var e
return null!==(e=this.implementation.url("createAccountUrl"))&&void 0!==e?e:eO}get mediaCountryCode(){return this.implementation.string("countryCode")}get mediaHost(){return this.implementation.url("apps-media-api-host")}mediaEdgeHost(e){return e.host.clientIdentifier===gz?this.implementation.url(_x):this.implementation.string(_x)}get mediaAPICatalogMixedShouldUseEdge(){var e
return null!==(e=this.implementation.boolean("apps-media-api-catalog-mixed-should-use-edge"))&&void 0!==e&&e}get mediaEdgeSearchHost(){return this.implementation.string("apps-media-api-search-edge-host")}get mediaPreviewHost(){return this.implementation.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.implementation.string("notification-settings-media-api-host")}get edgeEndpoints(){return l(m(this.implementation.array("apps-media-api-edge-end-points")))}get mediaAdvertRequestLimit(){var e
return null!==(e=this.implementation.double("apps-media-api-search-ads-limit"))&&void 0!==e?e:4}get searchSortOptions(){return l(m(this.implementation.array("searchSortOptions")))}get ageBands(){return l(m(this.implementation.array("ageBands")))}get redirectUrlWhitelistedQueryParams(){let e=l(m(this.implementation.array("processRedirectUrl/whitelistedQueryParams")))
return o(e)&&(e=["affC",lk,Tk,"at","ct",bk,Sk,"itscc",Pk,ck,"ls","partnerId","pt","qtkid","uo"]),e}get redirectUrlEndpoint(){var e
return null!==(e=this.implementation.string("processRedirectUrl/endpoint"))&&void 0!==e?e:"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"}get aristotleParentAppAdamId(){var e
return null!==(e=this.implementation.string("aristotle-app-id"))&&void 0!==e?e:"383941000"}get arcadeAppAdamId(){return this.implementation.string("app-store-app-id")}get arcadeProductFamilyId(){var e
return null!==(e=this.implementation.string("arcade-iap-family-id"))&&void 0!==e?e:this.implementation.string("ocelot-iap-family-id")}get arcadeProductId(){var e
return null!==(e=this.implementation.string("arcade-iap-offer-name"))&&void 0!==e?e:this.implementation.string("ocelot-iap-offer-name")}get arcadeCategoryBarSAGUpliftDisplayRate(){var e
return null!==(e=this.implementation.double("arcade-category-bar-see-all-games-display-rate"))&&void 0!==e?e:0}get isArcadeEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-enabled"))&&void 0!==e&&e}get isAppsGroupingTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-groupings-tags-enabled"))&&void 0!==e&&e}get isAppsProductPageTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-product-page-tags-enabled"))&&void 0!==e&&e}get isAppsSlpTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-slp-tags-enabled"))&&void 0!==e&&e}get searchResultsLearnMoreEditorialId(){return this.implementation.string("transparencyLawEditorialItemId")}get systemApps(){return l(m(this.implementation.array("hideableSystemApps")))}get nonDeletableSystemApps(){const e=m(this.implementation.array("nonDeletableSystemApps"))
return s(e)?l(e):[{id:1635387927,"bundle-id":Jy},{id:1635862301,"bundle-id":Ky},{id:1584216343,"bundle-id":"com.apple.findmy.finddevices"},{id:1584215960,"bundle-id":"com.apple.NanoWorldClock"},{id:1584215812,"bundle-id":"com.apple.HeartRate"},{id:1584215851,"bundle-id":"com.apple.SessionTrackerApp"},{id:1146562108,"bundle-id":"com.apple.NanoPhone"},{id:1146560473,"bundle-id":ty},{id:1584215428,"bundle-id":"com.apple.NanoPhotos"},{id:1459455352,"bundle-id":Yy},{id:1067456176,"bundle-id":zy}]}get tabsStandard(){return l(m(this.implementation.array("tabs/standard")))}get watchAppsGroupingURL(){var e
return null!==(e=this.implementation.url("watchAppsGrouping"))&&void 0!==e?e:"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"}get requireAgeVerification(){return this.implementation.boolean("requireAgeVerification")}get ageRatingLearnMoreEditorialItemId(){return this.implementation.string("ageRatingLearnMoreEditorialItemId")}get appleSiliconMacUnverifiedBadgeEditorialItemId(){return this.implementation.string("appleSiliconMacUnverifiedBadgeEditorialItemId")}get safariExtensionsGroupingURL(){return this.implementation.url("safariExtensionsGrouping")}get familySubscriptionsLearnMoreEditorialItemId(){return this.implementation.string("familySubscriptionsLearnMoreEditorialItemId")}get dynamicUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/dynamic-url-patterns")))}get financeUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/url-patterns")))}get webViewRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/v2-url-patterns")))}get arcadePreOrderUpsellLimitSeconds(){var e
return null!==(e=this.implementation.double("arcadePreOrderUpsellLimitSeconds"))&&void 0!==e?e:86400}get recentlyPlayedGamesWindowInSeconds(){var e
return null!==(e=this.implementation.double("recentlyPlayedGamesWindowInSeconds"))&&void 0!==e?e:7776e3}get gamesFriendsPlayedWindowInSeconds(){var e
return null!==(e=this.implementation.integer("games-friends-played-window-in-seconds"))&&void 0!==e?e:15778800}get enableComingSoonToggle(){return this.implementation.boolean("enableComingSoonToggle")}get enableAppAccessibilityLabels(){var e
return null!==(e=this.implementation.boolean("enable-app-accessibility-labels"))&&void 0!==e&&e}get enablePrivacyNutritionLabels(){var e
return null!==(e=this.implementation.boolean("enable-privacy-nutrition-labels"))&&void 0!==e&&e}get enableSellerInfo(){var e
return null!==(e=this.implementation.boolean("enable-seller-info"))&&void 0!==e&&e}get enableSellerICPAnnotation(){var e
return null!==(e=this.implementation.boolean("enable-seller-icp"))&&void 0!==e&&e}get enableFeaturedCategoriesOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-featured-categories-on-groupings"))&&void 0!==e&&e}get enableCategoryBricksOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-category-bricks-on-groupings"))&&void 0!==e&&e}get sponsoredSearchODMLTimeout(){var e
return null!==(e=this.implementation.double("sponsored-search-odml-timeout"))&&void 0!==e?e:3}get isSearchLandingAdsEnabled(){var e
return null!==(e=this.implementation.boolean("isSearchLandingAdsEnabled"))&&void 0!==e&&e}get isLLMSearchTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-tags-enabled"))&&void 0!==e&&e}get searchLandingAdFetchTimeout(){var e
return null!==(e=this.implementation.double("search-landing-ad-fetch-timeout"))&&void 0!==e?e:.175}get searchLandingPageOffscreenRefreshInterval(){var e
return null!==(e=this.implementation.double("search-landing-offscreen-refresh-interval-in-seconds"))&&void 0!==e?e:60}get searchLandingPageRefreshUpdateDelayInterval(){var e
return null!==(e=this.implementation.double("search-landing-page-update-delay-interval-in-seconds"))&&void 0!==e?e:.3}get appPrivacyLearnMoreEditorialItemId(){return this.implementation.string("appPrivacyLearnMoreEditorialItemId")}get ratingsAndReviewsLearnMoreEditorialId(){return this.implementation.string("ratings-and-reviews-learn-more-editorial-item-id")}get reviewSummarizationLearnMoreEditorialItemId(){return this.implementation.string("review-summarization-learn-more-editorial-item-id")}get suppressedPrivacyAppIds(){return l(m(this.implementation.array("suppressedPrivacyLabels")))}get suppressedAccessibilityAppIds(){return l(m(this.implementation.array("suppressed-accessibility-labels")))}get appPrivacyDefinitionsEditorialItemId(){return this.implementation.string("appPrivacyDefinitionsEditorialItemId")}get webNavigationCategoryTabsEditorialItemId(){return this.implementation.string("web-navigation-category-tabs-editorial-item-id")}get todayWidgetLivePreviewRolloutRate(){var e
return null!==(e=this.implementation.double("todayWidgetLivePreviewRolloutRate"))&&void 0!==e?e:1}get hero3RolloutRate(){var e
return null!==(e=this.implementation.double("arcade-hero-shelf-tagline-style-rollout-rate"))&&void 0!==e?e:1}get arcadeTrialEnrolledStateRate(){var e
return null!==(e=this.implementation.double("arcade-trial-enrolled-state-rate"))&&void 0!==e?e:0}get marketingItemSelectionTimeout(){var e
return null!==(e=this.implementation.double("marketing-item-selection-timeout"))&&void 0!==e?e:1}get enableAppEvents(){var e
return null!==(e=this.implementation.boolean("enableAppEvents"))&&void 0!==e&&e}get enableProductPageVariants(){var e
return null!==(e=this.implementation.boolean("enableProductPageVariants"))&&void 0!==e&&e}get enableArcadeTrialEligibleBadging(){return this.implementation.boolean("enable-arcade-trial-eligible-badging")}get heroCarouselAutoScrollDuration(){var e
return null!==(e=this.implementation.double("heroCarouselAutoScrollDuration"))&&void 0!==e?e:7}get enableAdditionalLoggingForPPV(){var e
return null!==(e=this.implementation.boolean("enableAdditionalLoggingForPPV"))&&void 0!==e&&e}get enableOnDevicePersonalization(){const e=this.implementation.boolean("enable-on-device-personalization")
return!!r(e)||e}get enableAutomaticPageRefresh(){var e
return null===(e=this.implementation.boolean("enable-automatic-page-refresh"))||void 0===e||e}get enableSystemAppReviews(){var e
return null!==(e=this.implementation.boolean("enable-system-app-reviews"))&&void 0!==e&&e}get enableCPPInSearchAds(){return this.implementation.boolean("enableCPPsInSearchAds")||!1}get cancelPreorderItemSrv(){return this.implementation.url("cancelPreorderItemSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancel"}get getCancellablePreorderItemsSrv(){return this.implementation.url("getCancellablePreorderItemsSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancellable"}get enabledAdPlacements(){return l(m(this.implementation.array("enabled-ad-placements")))}get adPlacementTimeouts(){return p(y(this.implementation.dictionary("ad-placement-timeouts")))}get inAppPurchasesLearnMoreEditorialItemId(){return this.implementation.string("in-app-purchases-learn-more-editorial-item-id")}get enableExternalPurchases(){var e
return null!==(e=this.implementation.boolean("enable-external-purchase"))&&void 0!==e&&e}get enabledExternalPurchasesPlacements(){return l(m(this.implementation.array("enabled-external-purchase-placements")))}get externalPurchasesLearnMoreEditorialItemId(){return this.implementation.string("external-purchase-learn-more-editorial-item-id")}get externalBrowserLearnMoreEditorialItemId(){return this.implementation.string("external-browser-learn-more-editorial-item-id")}get sharePlayAppsEditorialItemId(){return this.implementation.string("share-play-apps-editorial-item-id")}get externalPurchasesIncludeProductPageBannerIcon(){var e
return null!==(e=this.implementation.boolean("external-purchase-product-page-banner-include-icon"))&&void 0!==e&&e}get externalPurchasesProductPageAnnotationVariant(){return this.implementation.string("external-purchase-product-page-annotation-variant")}get newEventsForODJAreEnabled(){var e
return null!==(e=this.implementation.boolean("new-events-for-odj-are-enabled"))&&void 0!==e&&e}get defaultChart(){return y(this.implementation.dictionary("default-chart"))}get accountUrl(){var e
return null!==(e=this.implementation.url("accountUrl"))&&void 0!==e?e:Ck}get redeemUrl(){var e
return null!==(e=this.implementation.url("redeemUrl"))&&void 0!==e?e:Ik}get manageSubscriptionsUrl(){var e
return null!==(e=this.implementation.url("manageSubscriptionsUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink"}get manageSubscriptionsV2Url(){var e
return null!==(e=this.implementation.url("manageSubscriptionsV2Url"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/"}get adsOverrideLanguage(){return this.implementation.string("ads-override-language")}get gameControllerRecommendedRolloutRate(){var e
return null!==(e=this.implementation.double("game-controller-recommended-rollout-rate"))&&void 0!==e?e:0}get gameControllerLearnMoreEditorialItemId(){return this.implementation.string("game-controller-learn-more-editorial-item-id")}get spatialControlsLearnMoreEditorialItemId(){return this.implementation.string("spatial-controllers-learn-more-editorial-item-id")}get mediaAPISearchFocusEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-focus-suggestions-enabled"))&&void 0!==e&&e}get supportsSearchLandingPageV2(){var e
return null!==(e=this.implementation.boolean("supports-apps-slp-v2"))&&void 0!==e&&e}get searchLandingPageV2RolloutRate(){var e
return null!==(e=this.implementation.double("apps-slp-v2-rollout-rate"))&&void 0!==e?e:0}get todayTabArcadePersonalizationRate(){var e
return null!==(e=this.implementation.double("today-tab-arcade-personalization-rate"))&&void 0!==e?e:0}get gameCenterExtendSupportedFeatures(){var e
return null!==(e=this.implementation.boolean("game-center-extend-supported-features"))&&void 0!==e&&e}get adPlacementEligibleSlotPositions(){const e=y(this.implementation.dictionary("ad-placement-eligible-slot-positions"))
return s(e)?e:{today:[{shelfIdentifier:"0",slot:0},{shelfIdentifier:"0",slot:1}],"product-page-ymal":[{shelfIdentifier:vG,slot:0}]}}get managePreordersUrl(){var e
return null!==(e=this.implementation.url("preordersUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/preorders"}get modifyAccount(){var e
return null!==(e=this.implementation.url("modifyAccount"))&&void 0!==e?e:Ck}get purchaseHistoryUrl(){return this.implementation.url("purchaseHistoryUrl")}get ratingsReviewsUrl(){var e
return null!==(e=this.implementation.url("ratingsReviewsUrl"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/ratings-reviews"}get signup(){var e
return null!==(e=this.implementation.url(Ny))&&void 0!==e?e:eO}get redeemCodeLanding(){var e
return null!==(e=this.implementation.url("redeemCodeLanding"))&&void 0!==e?e:Ik}get reportProblemUrl(){return this.implementation.string("reportProblemUrl")}get unrestrictedServerSideTabBadging(){var e
return null!==(e=this.implementation.boolean("unrestricted-server-side-tab-badging"))&&void 0!==e&&e}get todayAdCondensedEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-condensed-enabled"))&&void 0!==e&&e}get safariExtensionsEditorialPageId(){return this.implementation.url("safari-extensions-editorial-page-id")}get buddyOnboardingEditorialItemId(){return this.implementation.string("buddy-onboarding-editorial-item-id")}get productPageFriendsPlayingClickEventsEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-friends-playing-click-events-enabled"))&&void 0!==e&&e}get highMotionLearnMoreEditorialItemId(){return this.implementation.string("high-motion-learn-more-editorial-item-id")}get todayAdMediumLockupScreenshotsRiverSpeed(){return this.implementation.double("today-ad-medium-lockup-screenshots-river-speed")}get arcadeDownloadPackCategoriesCollectionId(){return this.implementation.string("arcade-download-packs-onboarding-collection-id")}get arcadeDownloadPackShelfTTLInSeconds(){var e
return null!==(e=this.implementation.integer("arcade-starter-pack-ttl-in-seconds"))&&void 0!==e?e:0}get enableOfferItems(){var e
return null!==(e=this.implementation.boolean("enable-winback-offers"))&&void 0!==e&&e}get appDistributionMediaAPIHost(){return this.implementation.string("app-distribution-media-api-host")}get appDistributionLanguageTag(){return this.implementation.string("app-distribution-language-tag")}get arcadeDownloadPackPostSubscribeTrigger(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-post-subscribe-trigger"))||void 0===e||e}get enableContingentOffers(){var e
return null!==(e=this.implementation.boolean("enable-contingent-offers"))&&void 0!==e&&e}get arcadeDownloadPackRolloutRate(){var e
return null!==(e=this.implementation.double("arcade-download-packs-rollout-rate"))&&void 0!==e?e:0}get enableVisionPlatform(){var e
return null!==(e=this.implementation.boolean("enable-vision-platform"))&&void 0!==e&&e}get supportedMixedMediaRequestUsecases(){var e
return null!==(e=p(y(this.implementation.dictionary("supported-mixed-media-request-usecases"))))&&void 0!==e?e:{}}get arcadeDownloadPacksMetricsEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-metrics-events-enabled"))||void 0===e||e}get arcadeDownloadPacksImpressionEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-impression-events-enabled"))||void 0===e||e}get visionOnlyAppLearnMoreEditorialItemId(){return this.implementation.string("vision-only-app-learn-more-editorial-item-id")}get arcadeDownloadPacksCIPDeeplinkIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-cip-deeplink-trigger"))&&void 0!==e&&e}get arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-hw-tabbadge-trigger"))&&void 0!==e&&e}get aboutAppStoreUrl(){return this.implementation.string("about-app-store-url")}get aboutInAppPurchasesEditorialItemId(){return this.implementation.string("about-in-app-purchases-editorial-item-id")}get requestARefundUrl(){return this.implementation.string("request-a-refund-url")}get personalizedRecommendationsToggleEnabled(){var e
return null!==(e=this.implementation.boolean("enable-personalized-recommendations-toggle"))&&void 0!==e&&e}get metricsIdMigrationEnabled(){var e
return null===(e=this.implementation.boolean("metrics-id-migration-enabled"))||void 0===e||e}get isNaturalLanguageSearchEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-enabled"))&&void 0!==e&&e}get isNaturalLanguageSearchResultsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-results-enabled"))&&void 0!==e&&e}get changePaymentMethodUrl(){return this.implementation.string("change-payment-method-url")}get aboutFrenchAppStoreEditorialItemId(){return this.implementation.string("about-app-store-editorial-item-id")}get isOnDemandShelfFetchingEnabled(){var e
return null===(e=this.implementation.boolean("on-demand-product-shelf-fetching-enabled"))||void 0===e||e}get isMetricsUserIdFallbackEnabled(){var e
return null!==(e=this.implementation.boolean("metrics-user-id-fallback-enabled"))&&void 0!==e&&e}get isMetricsAb2DataFallbackEnabled(){var e
return null===(e=this.implementation.boolean("metrics-ab2data-fallback-enabled"))||void 0===e||e}get enableRecoOnDeviceReordering(){var e
return null!==(e=this.implementation.boolean("enable-on-device-reco-reordering"))&&void 0!==e&&e}get ribbonBarVisionEditorialItemIds(){return l(m(this.implementation.array("ribbon-bar-vision-editorial-item-ids")))}get searchFilterEditorialItemIds(){const e=l(m(this.implementation.array("search-filter-editorial-item-ids")))
return new Set(e)}get accessibilityLearnMoreEditorialItemId(){return this.implementation.string("accessibility-learn-more-editorial-item-id")}get enableDeviceDrivenDiscoveryContent(){var e
return null!==(e=this.implementation.boolean("enable-device-driven-discovery-content"))&&void 0!==e&&e}get enableProductPageInstallSize(){var e
return null!==(e=this.implementation.boolean("enable-product-page-install-size"))&&void 0!==e&&e}get enableIconArtwork(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork"))&&void 0!==e&&e}get iconArtworkRolloutRate(){var e
return null!==(e=this.implementation.double("icon-artwork-rollout-rate"))&&void 0!==e?e:0}get enableUpdatedAgeRatings(){var e
return null!==(e=this.implementation.boolean("enable-app-store-age-ratings"))&&void 0!==e&&e}get enableAgeRatingFilter(){var e
return null!==(e=this.implementation.boolean("enable-age-rating-filter"))&&void 0!==e&&e}get enableTwoPhaseOfferConfirmation(){var e
return null!==(e=this.implementation.boolean("enable-two-phase-offer-confirmation"))&&void 0!==e&&e}get externalPurchasesProductPageBannerTextVariant(){return this.implementation.string("external-purchase-product-page-banner-text-variant")}get externalPurchasesProductPageBannerIconVariant(){return this.implementation.string("external-purchase-product-page-banner-icon-variant")}get maxGamesForFetchingEvents(){var e
return null!==(e=this.implementation.integer("max-games-for-fetching-events"))&&void 0!==e?e:30}get mockHomeFeedURL(){return this.implementation.string("mock-home-feed-url")}get metricsTopic(){var e
{const t="xp_ase_appstore_ue"
return null!==(e=this.implementation.string("metrics_topic"))&&void 0!==e?e:t}}get playTogetherGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("play-together-arcade-game-recommendations"))&&void 0!==e?e:"1803255513"}get playTogetherGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("play-together-non-arcade-game-recommendations"))&&void 0!==e?e:"1804480915"}get multiplayerActivityGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-arcade-game-recommendations"))&&void 0!==e?e:"1821553042"}get multiplayerActivityGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-non-arcade-game-recommendations"))&&void 0!==e?e:"1821553152"}get showArcadeSubscriberAccessBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-subscriber-access-badge"))&&void 0!==e&&e}get gamesCrossUseConsentLearnMoreURL(){return this.implementation.string("games-crossuse-consent-learn-more-url")}get gamesPlayNowHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesPlayNowHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get gamesEditorialHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesEditorialHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get completedChallengesInActiveShelfTimeThreshold(){var e
return null!==(e=this.implementation.integer("completed-challenges-in-active-shelf-time-threshold"))&&void 0!==e?e:86400}get requestReviewEnabled(){var e
return null===(e=this.implementation.boolean("request-review-enabled"))||void 0===e||e}get requestReviewMinAppLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-app-launch-count"))&&void 0!==e?e:15}get requestReviewMinGameLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-game-launch-count"))&&void 0!==e?e:5}get enableLicenses(){var e
return null!==(e=this.implementation.boolean("enable-licenses"))&&void 0!==e&&e}get chartDetailPageItemCount(){var e
return null!==(e=this.implementation.integer("chart-detail-page-item-count"))&&void 0!==e?e:25}get enableSRPNextSlot(){var e
return null!==(e=this.implementation.boolean("enable-srp-next-slot"))&&void 0!==e&&e}get enableSRPV5Impressions(){var e
return null!==(e=this.implementation.boolean("enable-srp-v5-impressions"))&&void 0!==e&&e}get enableSRPOnDeviceAdsRanker(){var e
return null!==(e=this.implementation.boolean("enable-srp-on-device-ads-ranker"))&&void 0!==e&&e}get srpAdBackground(){return this.implementation.string("srp-ad-background")}get editorialShelvesCollectionContentsLimit(){var e
return null!==(e=this.implementation.integer("editorial-shelves-collection-contents-limit"))&&void 0!==e?e:75}get metricsAllowedListURLParams(){let e=l(m(this.implementation.array("metrics-allowed-list-url-params")))
return o(e)&&(e=[bk,Sk,Pk,"ct","pt",Tk,"mttn3pid","mttnagencyid","mttncc","mttnpid","mttnsiteid","mttnsub1","mttnsub2","mttnsubad","mttnsubkw","mttnsubplmnt","id",jU,"salableAdamId","ign-itscg","ign-itsct","utm_campaign",xD]),e}get enableIPadOnlyFallbackIcons(){var e
return null!==(e=this.implementation.boolean("enable-ipad-only-fallback-icons"))&&void 0!==e&&e}get disablePaginatedGameLibraryShelf(){var e
return null!==(e=this.implementation.boolean("disable-paginated-game-library-shelf"))&&void 0!==e&&e}get gameLibraryNumberOfItemsFromBelowToFetchNextPage(){var e
return null!==(e=this.implementation.integer("game-library-number-of-items-from-below-to-fetch-next-page"))&&void 0!==e?e:24}get disabledRichLinkPresentationEditorialItemIds(){var e
return l(m(null!==(e=this.implementation.array("disabled-rich-link-presentation-editorial-item-ids"))&&void 0!==e?e:["1842906680"]))}}f3.type=(0,Gv.makeMetatype)("app-store:bag-wrapper")
class h3 extends Uz{constructor(e,t){super(e),this.cache={},this.packageProperties=t}isEnabled(e){return this.fromCache(e,()=>{var t,n
return!(!(0,Nv.isSome)(this.implementation)||!this.implementation.isEnabled(e))||!!(0,Nv.isSome)(null===(t=this.packageProperties)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.packageProperties)||void 0===n?void 0:n.clientFeatures[e])})}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Nv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}}h3.type=(0,Gv.makeMetatype)("app-store:client-capabilities-wrapper")
class p3 extends Uz{async orderedVisibleIAPs(e,t,n,r){return await new Promise((o,i)=>{const s=t.filter(e=>null!=e),a=n.filter(e=>null!=e)
this.implementation.orderedVisibleIAPs(e,s,a,r,(e,t)=>{t?i(t):o(e)})})}async visibilityForIAPs(e){return await new Promise((t,n)=>{this.implementation.visibilityForIAPs(e,(e,n)=>{t(n?{}:e)})})}}p3.type=(0,Gv.makeMetatype)("app-store:client-ordering-wrapper")
class w3 extends Uz{info(...e){return this.implementation.info(...e)}error(...e){return this.implementation.error(...e)}log(...e){return this.implementation.log(...e)}warn(...e){return this.implementation.warn(...e)}}w3.type=(0,Gv.makeMetatype)("app-store:console-wrapper")
class g3 extends Uz{constructor(){super(...arguments),this.cache={}}isEnabled(e){return this.fromCache(e,()=>{if(this.implementation.isEnabled(e))return!0
const t=this.legacyFeatureFlagFromModernFeatureFlag(e)
return!!(0,Nv.isSome)(t)&&this.implementation.isEnabled(t)})}isGSEUIEnabled(e){return Boolean(this.implementation.isGSEUIEnabled(e))}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,Nv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}legacyFeatureFlagFromModernFeatureFlag(e){switch(e){case XY:return"open_in_story_share_sheet"
case eJ:return"product_accessibility_support_2025A"
case tJ:return"AppleAccount.AABranding"
case"FA3FF1EE-3B29-4131-8A33-31C764E6B6DC":return"aligned_region_artwork_2025A"
case nJ:return"hide_arcade_header_on_arcade_tab"
case rJ:return"shelf_header"
case oJ:return"game_center_shelf_header"
case iJ:return"arcade_see_all_games_menu_uplift"
case sJ:return"see_all_games_segmented_nav_2024A"
case aJ:return"shelves_2_0_top_charts"
case"D4105739-EE9B-4C2E-AEE6-5F5744B016B1":return"shelves_2_0_arcade"
case"FF4FF053-4635-431B-A32C-19921296CD83":return"shelves_2_0_generic"
case cJ:return"shelves_2_0_search"
case lJ:return"shelves_2_0_product"
case"75A39BC1-112E-473B-8CB8-83D5D155982F":return"shelves_2_0_privacy_detail_page_2025C"
case uJ:return"force_display_lockup_ordinals"
case dJ:return"arcade_choose_your_favorites_brick_Future"
case fJ:return"mini_today_cards_grouping"
case hJ:return"mini_today_cards_product"
case pJ:return"mini_today_cards_article"
case wJ:return"contingent_offers_personalization"
case gJ:return"voyager_bundles_2025A"
case vJ:return"tv_product_page_2024E"
case mJ:return"app_genome_2025A"
case yJ:return TJ
case"0027F7B8-F19A-4C57-8F1C-17DF011F98DA":return"spatial_controllers_2025A"
case"6707A833-E8E1-4C9E-9B83-19564F590B5D":return bJ
case"336CC1B2-6AD8-45EC-AF22-B23023110241":return SJ
case"BE3D1F90-21C1-4161-B2B9-88FA3B6CE4AF":return"5pqn2upm"
case"9EB5A10B-BE28-449D-AFE9-706A5ACF043B":return"ma1h52"
case"A50E8778-88AD-45BC-993A-B5BF157633DF":return"now_playing_feature_entry_points"
case"46669451-9170-4764-8534-348007111CDB":return"arcade_dashboard"
case AJ:return null
default:x(e)}}}g3.type=(0,Gv.makeMetatype)("app-store:feature-flags-wrapper")
class v3 extends Uz{get clientIdentifier(){return v3.cache.get("clientIdentifier",()=>this.implementation.clientIdentifier)}get clientVersion(){return v3.cache.get("clientVersion",()=>this.implementation.clientVersion)}get deviceLocalizedModel(){return this.implementation.deviceLocalizedModel}get deviceModel(){return v3.cache.get("deviceModel",()=>this.implementation.deviceModel)}get deviceModelFamily(){return v3.cache.get("deviceModelFamily",()=>this.implementation.deviceModelFamily)}get devicePhysicalModel(){return v3.cache.get("devicePhysicalModel",()=>this.implementation.devicePhysicalModel)}get deviceMarketingFamilyName(){return v3.cache.get("deviceMarketingFamilyName",()=>this.implementation.deviceMarketingFamilyName)}get osBuild(){return v3.cache.get("osBuild",()=>this.implementation.osBuild)}get platform(){return this.implementation.platform}isOSAtLeast(e,t,n){return this.implementation.isOSAtLeast(e,t,n)}get isiOS(){return this.platform===Kj}get isMac(){return this.platform===OV}get isTV(){return this.platform===LG}get isWatch(){return this.platform===cx}get isWeb(){return this.platform===AV}get isWindows(){return"Windows"===this.platform}get isVision(){return this.platform===lx}}v3.type=(0,Gv.makeMetatype)("app-store:host-wrapper"),v3.cache=new Gz
class m3{constructor(){this.locData={},this.language="en"}updateLocalizationData(e,t){this.locData=e,this.language=t}localize(e,t){let n=this.locData[e]
return void 0!==n&&typeof n===Sq||(n=e),t&&(n=this.replaceTokens(n,t)),n=this.replaceMarkupTokens(n,t),n}localizeWithCount(e,t,n,r){let o,i,s=null
return 0===n&&(o=`${t}.zero`,this.isLocalized(e,o)&&(s=o)),null===s&&(s=t,i=this.pluralCategory(e,n),i!==Aj&&(o=`${t}.${i}`,this.isLocalized(e,o)&&(s=o))),r||(r={}),void 0===r.count&&(r.count=this.formatNumber(n.toString())),void 0===r.number&&(r.number=this.formatNumber(n.toString())),this.localize(null!=s?s:t,r)}replaceTokens(e,t){return Object.entries(t).forEach(([t,n])=>{const r="@@"+t+"@@"
e=this.replaceSubstring(e,r,n)}),e}replaceMarkupTokens(e,t){if(e.indexOf("##")<=-1)return e
let n
return t?(n={...m3.MARKUP_PARAMS},Object.entries(t).forEach(([e,t])=>{n[e]=t})):n=m3.MARKUP_PARAMS,Object.entries(n).forEach(([t,n])=>{const r="##"+t+"##"
e=e.replace(new RegExp(r,"gi"),n)}),e=e.replace(/##([^##]+)##/gi,"<$1>")}replaceSubstring(e,t,n){return e.split(t).join(n)}formatNumber(e){let t=this.locData._decimalSeparator
void 0!==t&&typeof t===Sq||(t=".")
let n=this.locData._thousandsSeparator
void 0!==n&&typeof n===Sq||(n=".")
const r=parseFloat(e).toString().split("."),o=r[0].split("")
for(let e=o.length-3;e>0;e-=3)o.splice(e,0,n)
return r[0]=o.join(""),r.join(t)}isLocalized(e,t){const n=this.locData[t]
return void 0!==n&&typeof n===Sq&&(-1===t.indexOf(".")||n!==t&&(0!==n.indexOf("**")||n.lastIndexOf("**")!==n.length-2)||(e.console.error("Unlocalized key in keys dictionary",t),!1))}pluralCategory(e,t){const n=m3.pluralCategoryFnByLanguage[this.language]
return void 0!==n?n(t):(e.console.warn("Missing plural category function for: "+this.language),Aj)}}m3.MARKUP_PARAMS={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},m3.pluralCategoryDefault=function(e){return Aj},m3.pluralCategoryOne=function(e){return 1===e?_G:Aj},m3.pluralCategoryArabic=function(e){const t=e>>0
if(t!==e)return Aj
if(0===t)return"zero"
if(1===t)return _G
if(2===t)return DE
const n=t%100
return n>=11?bF:n>=3?$N:Aj},m3.pluralCategoryFrench=function(e){return e<2&&e>=0?_G:Aj},m3.pluralCategoryHebrew=function(e){const t=e>>0
return t!==e?Aj:1===t?_G:2===t?DE:0==t%10&&t>10?bF:Aj},m3.pluralCategoryPolish=function(e){const t=e>>0
if(t!==e)return Aj
if(1===t)return _G
const n=t%10
if(n<=4&&n>=2){const e=t%100
if(e>14||e<12)return $N}return bF},m3.pluralCategoryRomanian=function(e){const t=e>>0
if(t!==e)return $N
if(0===t)return $N
if(1===t)return _G
const n=e%100
return n<=19&&n>=1?$N:Aj},m3.pluralCategoryRussian=function(e){const t=e>>0
if(t!==e)return Aj
const n=t%10
if(n>=5||0===n)return bF
const r=t%100
return r<=14&&r>=11?bF:1===n?_G:$N},m3.pluralCategoryFnByLanguage={zh:m3.pluralCategoryDefault,id:m3.pluralCategoryDefault,ja:m3.pluralCategoryDefault,ko:m3.pluralCategoryDefault,ms:m3.pluralCategoryDefault,th:m3.pluralCategoryDefault,vi:m3.pluralCategoryDefault,en:m3.pluralCategoryOne,ca:m3.pluralCategoryOne,da:m3.pluralCategoryOne,nl:m3.pluralCategoryOne,de:m3.pluralCategoryOne,el:m3.pluralCategoryOne,fi:m3.pluralCategoryOne,hu:m3.pluralCategoryOne,it:m3.pluralCategoryOne,nb:m3.pluralCategoryOne,no:m3.pluralCategoryOne,pt:m3.pluralCategoryOne,es:m3.pluralCategoryOne,sv:m3.pluralCategoryOne,tr:m3.pluralCategoryOne,ar:m3.pluralCategoryArabic,fr:m3.pluralCategoryFrench,iw:m3.pluralCategoryHebrew,pl:m3.pluralCategoryPolish,ro:m3.pluralCategoryRomanian,ru:m3.pluralCategoryRussian}
class y3 extends Uz{constructor(e,t){super(e),this.locFile=null,this.ampLoc=new m3,this.LOC_STRING_CACHE={},this.objectGraph=t}get identifier(){return this.implementation.identifier}get safeIdentifier(){return this.implementation.identifier.split("_")[0]}string(e,t){return this.implementation.string(e)}tryString(e){const t=this.implementation.string(e)
if(t===e||t===`**${e}**`)throw Bv.context("tryString",()=>{Bv.unexpectedType(xB,"Localization key",e,null)}),new Error(`No value exists for localization key '${e}'`)
return t}stringWithFallback(e,t){const n=this.implementation.string(e)
return n===`**AppStore.${e}**`?t:n}stringForPreferredLocale(e,t,n,r){if(o(n))return this.string(t,r)
const i=`${t}_${n}`
let s=this.LOC_STRING_CACHE[i]
if(!s)if(s=this.implementation.stringForPreferredLocale(t,n),s&&s!==t)this.LOC_STRING_CACHE[i]=s
else{const e=this.ampLoc.localize(t)
s=e!==t?e:r||t}return s}stringWithCount(e,t,n){let r=this.implementation.stringWithCount(e,t)
if(!r||r===e){const o=this.ampLoc.localizeWithCount(this.objectGraph,e,t,n)
o&&(r=o)}return r}stringWithCounts(e,t,n){return this.implementation.stringWithCounts(e,t)}uppercased(e){return e?e.toLocaleUpperCase(this.safeIdentifier):null}decimal(e,t){let n=this.implementation.decimal(e,t)
return n||(n=typeof e===PG?`* ${e.toString()} *`:this.nullString()),n}fileSize(e){let t=this.implementation.fileSize(e)
return t||(t=this.nullString()),t}formattedCount(e){let t=this.implementation.formattedCount(e)
return t||(t=this.nullString()),t}formattedCountForPreferredLocale(e,t,n){if(o(n))return this.formattedCount(t)
let r=this.implementation.formattedCountForPreferredLocale(t,n)
return r||(r=this.nullString()),r}timeAgoWithContext(e,t){let n=this.implementation.timeAgoWithContext(e,t)
return n||(n=this.nullString()),n}formatDate(e,t){let n=this.implementation.formatDate(e,t)
return n||(n=this.nullString()),n}formatDateWithContext(e,t,n){let r=this.implementation.formatDateWithContext(e,t,n)
return r||(r=this.nullString()),r}formatDateInSentence(e,t,n){let r=this.implementation.formatDateInSentence(e,t,n)
return r||(r=this.nullString()),r}relativeDate(e){let t=this.implementation.relativeDate(e)
return t||(t=this.nullString()),t}formatDuration(e,t){let n=this.implementation.formatDuration(e,t)
return n||(n=this.nullString()),n}applyLocalizations(e,t,n){this.isLocFileLoaded(e)||(this.locFile=e,this.ampLoc.updateLocalizationData(t,n.slice(0,2)))}isLocFileLoaded(e){return this.locFile===e}normalizedLocale(e,t,n){if("yue-hant"===(t=t.toLowerCase())){const t=e.packageProperties.asString("macauStorefrontIdentifier")
return typeof n===Sq&&typeof t===Sq&&-1!==n.indexOf(t)?"zh-ma":"zh-hk"}return t}nullString(){return"* null *"}load(e){if(void 0===e.bag.language||null===e.bag.language)throw new Error("Bag language is not available. Unable to load localizations.")
const t=this.normalizedLocale(e,e.bag.language,e.client.storefrontIdentifier),n=`local/${t}`
if(!this.isLocFileLoaded(n)){const r=e.packageProperties.asDictionary(`localizations.${t}`)
if(null!=r)this.applyLocalizations(n,r,t)
else{const r=e.packageProperties.asDictionary("localizations.en-us")
null!=r&&this.applyLocalizations(n,r,t)}}}deviceDisplayName(e){if(e.host.deviceLocalizedModel)return e.host.deviceLocalizedModel
switch(e.client.deviceType){case jq:const e=this.string(kk)
return e===kk?qy:e
case $q:const t=this.string(Ok)
return t===Ok?Wy:t
case"tv":const n=this.string(Ek)
return n===Ek?"Apple\xa0TV":n
case zq:const r=this.string(Rk)
return r===Rk?"Apple\xa0Watch":r
case Yq:const o=this.string(Dk)
return o===Dk?iO:o
default:return null}}}y3.type=(0,Gv.makeMetatype)("app-store:loc-wrapper")
class A3 extends Uz{value(e){return n(this.implementation,e)}enabled(e){var t,n
const r=this.value(e)
return typeof r!==wU?Boolean(r):!!(0,Uv.isSome)(null===(t=this.implementation)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.implementation)||void 0===n?void 0:n.clientFeatures[e])}isEnabled(e){return this.enabled(e)}isNotEnabled(e){return!this.enabled(e)}asDictionary(e){return p(this.implementation,e)}asString(e){return f(this.implementation,e)}asNumber(e){return h(this.implementation,e)}asArray(e){return l(this.implementation,e)}}A3.type=(0,Gv.makeMetatype)("app-store:package-properties-wrapper")
class T3 extends Uz{retrieveString(e){const t=this.implementation.retrieveString(e)
return(null==t?void 0:t.length)>0&&"<null>"!==t?t:null}storeString(e,t){this.implementation.storeString(t,e)}}T3.type=(0,Gv.makeMetatype)("app-store:storage-wrapper")
class b3 extends xm.ObjectGraph{configureDefaults(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,C,I,k,O,E,R,D,_,L,M,x){let $=this.addingCryptography(t).addingHost(n).addingNetwork(r).addingPlatform(o).addingPlist(i).addingRandom(s).addingServices(a).addingCookieProvider(c).addingBag(e).addingConsole(l).addingStoreMetrics(u).addingAMSEngagement(d).addingLoc(f).addingAdsLoc(h).addingDevice(p).addingClient(w).addingPackageProperties(g).addingUser(v).addingPlayer(m).addingMetricsIdentifiers(y).addingClientOrdering(A).addingArcade(T).addingGameCenter(b).addingDeepLinks(S).addingAppleSilicon(P).addingStorage(C).addingAds(I).addingOnDeviceRecommendationsManager(k).addingOnDeviceSearchHistoryManager(O).addingFeatureFlags(E).addingClientCapabilities(R,g).addingMediaToken(D).addingAppDistribution(_).addingTimeoutManager(L).addingAdsLoc(h).addingTreatmentStore(M).addingUserDefaults(x)
return $.loc.load($),$=$.addingLocale(new c3($)),$}get bag(){return this.required(f3.type)}addingBag(e){return this.addingBagWrapper(new f3(e)).adding($m.bag,e)}addingBagWrapper(e){return this.adding(f3.type,e)}get console(){return this.required(w3.type)}addingConsole(e){return this.addingConsoleWrapper(new w3(e))}addingConsoleWrapper(e){return this.adding(w3.type,e)}get cryptography(){return this.required($m.cryptography)}addingCryptography(e){return this.adding($m.cryptography,e)}get host(){return this.required(v3.type)}addingHost(e){return this.addingHostWrapper(new v3(e))}addingHostWrapper(e){return this.adding(v3.type,e)}get locale(){return this.required(a3)}addingLocale(e){return this.adding(a3,e)}get network(){return this.required($m.net)}addingNetwork(e){return this.adding($m.net,e)}get platform(){return this.required($m.platform)}addingPlatform(e){return this.adding($m.platform,e)}get plist(){return this.required($m.plist)}addingPlist(e){return this.adding($m.plist,e)}get random(){return this.required($m.random)}addingRandom(e){return this.adding($m.random,e)}get services(){return this.required($m.services)}addingServices(e){return this.adding($m.services,e)}get cookieProvider(){return this.required($m.cookieProvider)}addingCookieProvider(e){return this.adding($m.cookieProvider,e)}get fetchTimingMetricsBuilder(){return this.optional(Cm.fetchTimingMetricsBuilderType)}addingFetchTimingMetricsBuilder(e){return this.adding(Cm.fetchTimingMetricsBuilderType,e)}get storeMetrics(){return this.required(Az)}addingStoreMetrics(e){return this.adding(Az,e)}get amsEngagement(){return this.optional(Tz)}addingAMSEngagement(e){return this.adding(Tz,e)}get loc(){return this.required(y3.type)}addingLoc(e){return this.addingLocWrapper(new y3(e,this))}addingLocWrapper(e){return this.adding(y3.type,e)}get adsLoc(){return this.required(Lz)}addingAdsLoc(e){return this.adding(Lz,e)}get device(){return this.required(bz)}addingDevice(e){return this.adding(bz,e)}get client(){return this.required(Yz.type)}addingClient(e){return this.addingClientWrapper(new Yz(e))}addingClientWrapper(e){return this.adding(Yz.type,e)}get packageProperties(){return this.required(A3.type)}addingPackageProperties(e){return this.addingPackagePropertiesWrapper(new A3(e))}addingPackagePropertiesWrapper(e){return this.adding(A3.type,e)}get clientCapabilities(){return this.required(h3.type)}addingClientCapabilities(e,t){return this.addingClientCapabilitiesWrapper(new h3(e,t))}addingClientCapabilitiesWrapper(e){return this.adding(h3.type,e)}get user(){return this.required(Sz)}addingUser(e){return this.adding(Sz,e)}get player(){}addingPlayer(e){return this.adding(Pz,e)}get metricsIdentifiers(){return this.required(Cz)}addingMetricsIdentifiers(e){return this.adding(Cz,e)}get clientOrdering(){return this.required(p3.type)}addingClientOrdering(e){return this.addingClientOrderingWrapper(new p3(e))}addingClientOrderingWrapper(e){return this.adding(p3.type,e)}get arcade(){return this.required(Iz)}addingArcade(e){return this.adding(Iz,e)}get gameCenter(){return this.required(kz)}addingGameCenter(e){return this.adding(kz,e)}get deepLinks(){return this.required(Oz)}addingDeepLinks(e){return this.adding(Oz,e)}get appleSilicon(){return this.required(u3.type)}addingAppleSilicon(e){return this.addingAppleSiliconWrapper(new u3(e))}addingAppleSiliconWrapper(e){return this.adding(u3.type,e)}get storage(){return this.required(T3.type)}addingStorage(e){return this.addingStorageWrapper(new T3(e))}addingStorageWrapper(e){return this.adding(T3.type,e)}get ads(){return this.required(Ez)}addingAds(e){return this.adding(Ez,e)}get onDeviceRecommendationsManager(){return this.required(Rz)}addingOnDeviceRecommendationsManager(e){return this.adding(Rz,e)}get onDeviceSearchHistoryManager(){return this.required(Dz)}addingOnDeviceSearchHistoryManager(e){return this.adding(Dz,e)}get featureFlags(){return this.required(g3.type)}addingFeatureFlags(e){return this.addingFeatureFlagsWrapper(new g3(e))}addingFeatureFlagsWrapper(e){return this.adding(g3.type,e)}get mediaToken(){return this.required(_z)}addingMediaToken(e){return this.adding(_z,e)}get appDistribution(){return this.required(Mz)}addingAppDistribution(e){return this.adding(Mz,e)}get timeoutManager(){return this.required(xz)}addingTimeoutManager(e){return this.adding(xz,e)}get treatmentStore(){return this.required($z)}addingTreatmentStore(e){return this.adding($z,e)}get experimentCache(){return this.optional(rY.metatype)}get metricsIdentifiersCache(){return this.optional(qJ.defaultMetatype)}get paymentMetricsIdentifiersCache(){return this.optional(qJ.paymentMetatype)}get personalizationMetricsIdentifiersCache(){return this.optional(qJ.personalizationMetatype)}get userDefaults(){if(this.client.isiOS)return this.required(Fz)}addingUserDefaults(e){return this.adding(Fz,e)}isAvailable(e){return i(this.optional(e))}get activeIntent(){return this.optional(i3)}addingActiveIntent(e){return this.adding(i3,new s3(e))}get seo(){return this.optional(l3)}addingSEO(e){return this.adding(l3,e)}get dispatcher(){return this.required(o3.dispatcher)}get nativeIntentDispatcher(){return this.required(o3.nativeIntentDispatcher)}get debugSettings(){return this.required(o3.debugSettings)}get router(){return this.required(o3.router)}get localizer(){return this.required(o3.localizer)}get personNameComponentsFormatter(){return this.required(o3.personNameComponentsFormatter)}}class S3 extends dW{constructor(){super(...arguments),this.$kind="InvalidateAllWidgetsAction",this.actionClass="InvalidateAllWidgetsAction"}}class P3{constructor(){this.$intentKind="GenericPageIntent"}async perform(e,t){const n=t.required(n3)
return await n.fetchPage(t,e.url,ZY)}}class C3{constructor(){this.$intentKind="GenericPageMoreIntent"}async perform(e,t){const n=t.required(n3)
return await n.fetchMoreOfPage(t,e.pageToken)}}class I3{constructor(){this.$intentKind="ShelvesIntent"}async perform(e,t){const n=t.required(n3)
return await n.fetchShelves(t,e.requests)}}class k3{constructor(){this.$intentKind="ActionIntent"}async perform(e,t){return await Kh(t,e)}}class O3{constructor(){this.$kind="AccountLinks",this.links={},this.pageMetrics=new hY,this.pageRenderMetrics=null}}class E3 extends dW{constructor(e,t,n){super(),this.$kind="FamilyCircleAction",this.actionClass="FamilyCircleAction",this.clientName=e,this.eventType=t,this.additionalParameters=n}}class R3{constructor(){this.$intentKind="AccountLinksIntent"}async perform(e,t){return Qh(t)}}class D3 extends h2{constructor(e,t){super("AccountController"),t.exportingService("AccountData",{fetchAccountLinks:async t=>Qh(e)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class _3 extends h2{constructor(){super("DynamicUIBuilder")}pageType(){return xF}async handlePage(e,t,n,r,o){const i=new fY(xF)
i.pageUrl=t.toString(),i.referrerUrl=t.build()
const s=new s2(e.bag.metricsTopic)
if(e.bag.arcadeDownloadPacksCIPDeeplinkIntegrationEnabled&&ar(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new fY(tB),t=NN
e.pageData=t,e.presentationContext=Mj,s.carrierLinkSuccessAction=e}return i.pageData=s,i}pageRoute(e){const t=e.bag.dynamicUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class L3 extends h2{constructor(){super("FinancePageBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=new fY(cj)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.financeUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class M3{constructor(e,t){this.$kind="GenericAccountPage",this.title=e,this.sections=t||[],this.pageMetrics=new hY,this.pageRenderMetrics={}}}class x3{constructor(e,t){this.$kind="PersonalizationTransparencyPage",this.personalizationEnabledPage=e,this.personalizationDisabledPage=t}}class $3{constructor(e,t){this.$kind="AccountSection",this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class F3{constructor(e){this.type=e}}class N3 extends F3{constructor(e){super(UV),this.$kind="AccountSectionText",this.text=e}}class B3 extends F3{constructor(e,t){super("personalizedRecommendationsToggle"),this.$kind="AccountSectionPersonalizedRecommendationsToggle",this.title=e,this.defaultValue=t}}class U3 extends F3{constructor(e,t,n){super(yq),this.$kind="AccountSectionLink",this.title=e,this.action=t,this.displayType=n||UH}}class G3 extends F3{constructor(e,t){super("infoListItem"),this.$kind="AccountSectionInfoListItem",this.title=e,this.value=t}}class j3 extends dW{constructor(){super(...arguments),this.$kind="ClearAppUsageDataAction",this.actionClass="ClearAppUsageDataAction"}}class V3{constructor(){this.$intentKind="GenericAccountPageIntent"}async perform(e,t){return await Xh(t,e.url)}}class H3{constructor(){this.$intentKind="PersonalizationTransparencyPageIntent"}async perform(e,t){return await async function(e){const t=e.required(n3),n=`${hW}:///${yW.account}/${yW.personalizationTransparency}`
return await t.fetchPage(e,n,x3)}(t)}}class q3 extends h2{constructor(e,t){super("PersonalizationTransparencyBuilder"),t.exportingService(NA,{fetchGenericAccount:async t=>await Xh(e,t.url)})}async handlePage(e,t,n,r,o){return await async function(e,t,n){let r,o
if(e.bag.personalizedRecommendationsToggleEnabled){o=u$
const t=await ep(e),n=tp(e)
r=new x3(t,n)}else o=nH,r=v(n[DW.enabled])?await ep(e):tp(e)
return h2.createFlowAction(r,o,t)}(e,t,n)}pageRoute(e){return e.bag.personalizedRecommendationsToggleEnabled?[{protocol:hW,path:`/${yW.account}/${yW.personalizationTransparency}`},{path:`${yW.personalizationTransparency}`}]:[{protocol:hW,path:`/${yW.account}/${yW.personalizationTransparency}`,query:[DW.enabled]},{path:`${yW.personalizationTransparency}`,query:[DW.enabled]}]}pageType(){return nH}}class W3 extends h2{constructor(){super("ShowAccountPageBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){let i,s=[]
{i=J_
const e=new fY(nH)
e.presentationContext=Mj,e.animationBehavior=qV,s=[e]}const a=new cX(i)
return a.actions=s,a}pageRoute(e){return[{hostName:"showAccountPage"},{hostName:"showPurchasesPage"}]}}class z3 extends h2{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){return new fY(cj,e.bag.manageSubscriptionsUrl)}pageRoute(e){return[{hostName:"showSubscriptionsPage"}]}}class Y3 extends h2{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=new cX(J_)
if(e.client.deviceType!==Yq){const e=new fY(nH)
e.presentationContext=Mj,e.animationBehavior=qV,i.actions=[e]}return i}pageRoute(e){return[{hostName:"showUpdatesPage"},{path:"updates"},{path:"{countryCode}/updates"},{query:[`${DW.action}=updates`]}]}}class J3 extends h2{constructor(){super("StorefrontChangeController")}async handlePage(e,t,n,r,o){const i={url:t.toString(),signingStyle:MV}
return await e.network.fetch(i),null}pageRoute(e){return[{protocol:pW,path:`/${yW.store}/${yW.resetAndRedirect}`}]}pageType(){return Dq}}class K3 extends h2{constructor(){super("WebUIPageBuilder")}pageType(){return Hx}async handlePage(e,t,n,r,o){const i=new fY(Hx)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.webViewRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class Z3{constructor(){this.$intentKind="UpdateAppEventNotificationIntent"}async perform(e,t){return await op(t,e)}}class Q3 extends h2{constructor(e,t){super("AppEventsController"),t.exportingService("AppEvents",{updateAppEventNotification:async t=>await op(e,t)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class X3 extends h2{constructor(){super("AppClipSubscribeBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const s=f(n[DW.appId])
if(!i(s))throw new Error(`No adamId supplied in appClipSubscribe url: ${t}`)
const a=new Jz(e).withIdOfType(s,Kq).includingAdditionalPlatforms(ee(e)),c=Ad(e,yt(e,await Ln(e,a)),{metricsOptions:{pageInformation:new BJ({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),l=(new qW).set(Ij,wW).set(FU,MU).path(yW.product).path(s).build(),u=new fY(oH)
u.pageUrl=l
const d=to(e,pt(ij),s,c.buttonAction),h=new cX(qq)
return h.actions=[u,d],h}pageRoute(e){return[{hostName:"appClipSubscribe",query:[DW.appId,DW.context]}]}}class e9{constructor(e,t,n,r,o){this.$kind="ArcadeDownloadPackCategory",this.id=e,this.title=t,this.artwork=n,this.gradientStartColor=r,this.gradientEndColor=o,this.selectActionMetrics=new sW,this.deselectActionMetrics=new sW}}class t9{constructor(e,t){this.$kind="ArcadeDownloadPackSuggestion",this.lockup=e,this.categoryId=t}}class n9 extends dW{constructor(e){super(),this.$kind="ArcadePackOfferAction",this.actionClass="ArcadePackOfferAction",this.offerActions=e}}class r9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackCategoriesPage",this.title=e,this.categories=t,this.maxNumberOfCategoriesToChoose=n,this.maxNumberOfCategoriesToChooseTemplate=r,this.numberOfChosenCategoriesTemplate=o,this.primaryAction=i,this.dismissAction=s,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class o9{constructor(e,t,n,r,o,i,s){this.$kind="ArcadeDownloadPackSuggestionsPage",this.title=e,this.suggestions=t,this.getAllAction=n,this.getAllButtonStyle=r,this.primaryAction=o,this.primaryActionKind=i,this.primaryActionSecondaryTitle=s,this.pageMetrics=new hY,this.pageRenderMetrics={}}}!function(e){e.Control="Tf5Kjqz00",e.LayoutA="Tf5Kjqz01",e.LayoutB="Tf5Kjqz02"}(Fm||(Fm={}))
class i9{constructor(){this.$intentKind="ArcadeDownloadPackCategoriesPageIntent",this.maxNumberOfCategoriesToChoose=4}async perform(e,t){return await this.fetchDownloadPackPage(t,za(e.subscriptionStatus))}async fetchDownloadPackPage(e,t){const n=new fW
n.title=e.loc.string("Arcade.DownloadPack.CategorySelection.PrimaryButtonTitle")
const r=new fW
r.title=e.loc.string("Arcade.DownloadPack.CategorySelection.SecondaryButtonTitle")
const o=await this.fetchCategories(e),i=new r9(e.loc.string(t===xk?"Arcade.DownloadPack.CategorySelection.Title.CurrentUser":"Arcade.DownloadPack.CategorySelection.Title"),o,this.maxNumberOfCategoriesToChoose,"Arcade.DownloadPack.CategorySelection.MaxCount","Arcade.DownloadPack.CategorySelection.Selected.Full",n,r),s=new BJ({pageId:"SelectCategories",pageType:OI}),a={rootPosition:0,locationStack:[]}
return e.bag.arcadeDownloadPacksMetricsEventsEnabled&&(n.actionMetrics.addMetricsData(_t(e,"Ok",Qq,{actionType:Xq})),r.actionMetrics.addMetricsData(_t(e,"Skip",Qq,{actionType:GG})),o.forEach(t=>{t.selectActionMetrics.addMetricsData(_t(e,t.id,JG,{actionType:iF})),t.deselectActionMetrics.addMetricsData(_t(e,t.id,JG,{actionType:"remove"}))}),jn(e,i,s)),e.bag.arcadeDownloadPacksImpressionEventsEnabled&&o.forEach(t=>{const n={id:t.id,idType:lq,kind:Qq,locationTracker:a,pageInformation:s,softwareType:nq,targetType:JG,title:t.title}
Oh(e,t,n),bh(a)}),i}async fetchCategories(e){const t=e.bag.arcadeDownloadPackCategoriesCollectionId,n=new Jz(e).withIdOfType(t,PV).addingQuery(EI,hI).includingAdditionalPlatforms(ee(e))
return await Ln(e,n).then(t=>this.categoriesFromResponse(e,t))}categoriesFromResponse(e,t){return Bv.context("categoriesFromResponse",()=>{const n=At(t),r=[]
for(const t of n){const n=t.id,o=Gf(e,t,Zq),i=p(Ke(e,t,Tq),qE)
if((0,Nv.isNothing)(i))continue
const s=qd(e,i,{useCase:n6.CategoryIcon}),a=Ze(e,t,"editorialBackground.stops").map(e=>ye(f(e,cV))).filter(e=>(0,Nv.isSome)(e))
if(0===a.length){e.console.log(`Empty gradient for category: ${n}`)
continue}const c=a[0],l=1===a.length?a[0]:a[1],u=new e9(n,o,s,c,l)
r.push(u)}return r.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:xV})}catch(e){return 0}})})}}class s9{constructor(){this.$intentKind="ArcadeDownloadPackSuggestionsPageIntent",this.maxGamesCount=4}async perform(e,t){const n={rootPosition:0,locationStack:[]},r=new BJ({pageId:"DownloadStarterPack",pageType:OI})
return await this.fetchSuggestedGames(t,e.categories,this.maxGamesCount,r,n).then(o=>this.createSuggestionsPage(o,t,za(e.subscriptionStatus),r,n))}async fetchSuggestedGames(e,t,n,r,o){const i=new Jz(e).forType(gL).addingQuery("include[personal-recommendations]",Jq).addingQuery("associate[apps]",Lj).addingQuery("limit[personal-recommendations:contents]",`${n}`).addingQuery("omit[resource:apps]","autos").addingQuery("sparseLimit[apps:association.category]","0").addingQuery("sparseLimit[personal-recommendations:contents]",`${n}`).addingQuery(UH,"arcade-onboarding").includingAdditionalPlatforms(ee(e)),s=this.fetchOptions(t,Nq)
return await Ln(e,i,s).then(n=>this.suggestionFromResponse(e,t,n,r,o))}suggestionFromResponse(e,t,n,r,o){return Bv.context("suggestionFromResponse",()=>{const i={}
for(const e of t)i[e.id]=e
const s=At(fe(yt(e,n),Jq)),a=[]
for(const t of s){const n=l(t.meta,"associations.category.data")[0].id,s=Ad(e,t,{offerStyle:uj,offerEnvironment:kq,metricsOptions:{pageInformation:r,locationTracker:o,badges:{categoryId:n}},metricsClickOptions:{id:t.id,pageInformation:r,locationTracker:o,badges:{categoryId:n}},artworkUseCase:n6.LockupIconSmall,isSubtitleHidden:!0});(0,Nv.isNothing)(s)||(s.heading=i[n].title,bh(o),Vd(s,e),a.push(new t9(s,n)))}return a})}createSuggestionsPage(e,t,n,r,o){const i=e.map(e=>this.offerAction(e.lockup.buttonAction)).filter(e=>(0,Nv.isSome)(e)),s=new n9(i)
s.title=function(e){switch(ip(e)){case Fm.Control:return e.loc.string(ek)
case Fm.LayoutA:case Fm.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.DownloadAllButtonTitle")
default:return e.loc.string(ek)}}(t)
const a=i.map(e=>e.adamId),c=new fW
c.title=function(e){switch(ip(e)){case Fm.Control:return e.loc.string(E_)
case Fm.LayoutA:case Fm.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.NotNowButtonTitle")
default:return e.loc.string(E_)}}(t)
const l=new o9(t.loc.string(n===NN?"Arcade.DownloadPack.Suggestions.Title.NewUser":"Arcade.DownloadPack.Suggestions.Title"),e,s,function(e){switch(ip(e)){case Fm.Control:return O_
case Fm.LayoutA:return"withinLockups"
case Fm.LayoutB:default:return O_}}(t),c,function(e){switch(ip(e)){case Fm.Control:case Fm.LayoutA:return k_
case Fm.LayoutB:return"getAll"
default:return k_}}(t),function(e){switch(ip(e)){case Fm.Control:return null
case Fm.LayoutA:case Fm.LayoutB:return e.loc.string(E_)
default:return null}}(t))
return t.bag.arcadeDownloadPacksMetricsEventsEnabled&&(Qs(t,s,{id:"GetAll",actionType:s$,subjectIds:a,actionDetails:{subjectIds:a},pageInformation:r,locationTracker:o,targetType:Qq}),c.actionMetrics.addMetricsData(_t(t,"Done",Qq,{actionType:Xq})),jn(t,l,r)),l}offerAction(e){return Nn(e)?e:gt(e)?Nn(e.defaultAction)?e.defaultAction:Nn(e.buyAction)?e.buyAction:null:null}fetchOptions(e,t){const n={selected:e.map(e=>({id:e.id,type:t}))}
return{method:rG,headers:{"Content-Type":jL},requestBodyString:JSON.stringify(n)}}}class a9 extends h2{constructor(e,t){super("ArcadeDownloadPackBuilder")}pageRoute(e){return ar(e,e.bag.arcadeDownloadPackRolloutRate)?[{hostName:"arcadeDownloadPack",query:[`${DW.arcadeSubscriptionStatus}?`]}]:[]}async handlePage(e,t,n,r,o){const i=new fY(tB),s=f(n,DW.arcadeSubscriptionStatus)
return i.pageData=za(s),i}pageType(){return tB}}class c9 extends h2{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return cq}defaultTab(e){return qq}pageRoute(e){return[{path:"arcade/offers",query:[`${DW.offerHints}?`]},{path:"/{countryCode}/arcade/offers",query:[`${DW.offerHints}?`]}]}async handlePage(e,t,n,r,o){var i
const s=null!==(i=n[DW.offerHints])&&void 0!==i?i:"deeplink_hardware_firstchance",a={offerHints:s},c=new jK(qq,pt(ij),e.bag.metricsTopic,null,a)
c.offerHints=s
const l=new fY(dj)
return l.pageData=c,l.referrerUrl=t.build(),l}}class l9 extends ZY{constructor(e){super(e,"ArcadeSeeAllGamesPage"),this.pageSegments=[]}}class u9{constructor(e,t,n=null,r){this.$kind="PageFacetOption",this.title=e,this.value=t,this.systemImageName=r,this.metricsValue=n}}u9.defaultValue="pageFacetsDefaultValue",u9.trueValue=new u9(XH,kF),u9.falseValue=new u9(kF,kF)
class d9{constructor(e,t,n,r,o=[],i=null,s=null,a=null,c=!1,l=!1,u=!1){this.$kind="PageFacetsFacet",this.id=e,this.parameterName=t,this.title=n,this.displayType=r,this.defaultOptions=i,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l,this.isHiddenFromMenu=u}}class f9{constructor(e,t,n){this.$kind="PageFacets",this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return(0,Nv.isSome)(e)&&0!==Object.keys(e).length}}f9.requestValuesForSelectedFacetOptions=function(e){if(f9.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>f9.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={}
for(const e of r){const t=e.split("=")
2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null}
class h9{constructor(e=[],t=null){this.$kind="PageFacetsGroup",this.title=t,this.facets=e}}const p9="-releaseDateByDay&sort=name",w9="-lastUpdatedByDay&sort=name",g9="alphabet&sort=name",v9="category&sort=-releaseDate",m9="groupBy",y9=wL,A9=bO,T9=KB,b9="filter[platform]",S9={}
let P9=!1,C9=null,I9=null,k9=null,O9=null,E9=null,R9=null,D9=null,_9=null,L9=null,M9=null,x9=null
const $9={}
$9[DW.sort]=m9,$9[DW.ageRating]=CO,$9[DW.controllerSupport]=IO,$9[DW.multiplayerSupport]=kO,$9[DW.comingSoon]=y9,$9[DW.binCompatGames]=b9
const F9=xA
class N9{constructor(){this.$intentKind="ArcadeSeeAllGamesPageIntent"}async perform(e,t){return await pp(t,e.requestDescriptor)}}class B9{constructor(){this.$intentKind="ArcadeSeeAllGamesPageMoreIntent"}async perform(e,t){return await wp(t,e.pageToken)}}class U9 extends p2{constructor(e,t){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,t.exportingService(yF,{fetchArcadeSeeAllGames:async t=>await pp(e,t),fetchMoreArcadeSeeAllGames:async t=>await wp(e,t.pageToken)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Tq,wq,zV,JV,hj,$j,uV]
return e.bag.enableUpdatedAgeRatings&&t.push(iq),e.appleSilicon.isSupportEnabled&&t.push(hH),t}defaultTab(e){return qq}pageType(){return QU}pageRoute(e){return[{identifier:QU,path:`/${yW.arcadeSeeAllGames}`,query:[`${DW.requestDescriptor}?`,`${DW.sort}?`,`${DW.ageRating}?`,`${DW.controllerSupport}?`,`${DW.multiplayerSupport}?`,`${DW.comingSoon}?`]},{identifier:QU,hostName:`${SW}`,query:[`${DW.requestDescriptor}?`,`${DW.sort}?`,`${DW.ageRating}?`,`${DW.controllerSupport}?`,`${DW.multiplayerSupport}?`,`${DW.comingSoon}?`]},{path:"/{countryCode}/{platform}/arcade/see-all",query:[`${DW.requestDescriptor}?`,`${DW.sort}?`,`${DW.ageRating}?`,`${DW.controllerSupport}?`,`${DW.multiplayerSupport}?`,`${DW.comingSoon}?`]}]}paginationRoute(e){return[{identifier:QU,protocol:hW,path:`/${yW.arcadeSeeAllGames}/${yW.arcadeSeeAllGamesLoadMore}`}]}shelfRoute(e){return[{protocol:hW,path:`/${yW.arcadeSeeAllGames}/${yW.shelf}/`,query:[`${DW.token}`]}]}generatePageRequest(e,t,n){return Bv.context("generatePageRequest",()=>{const t=gp(e,n),r=io(e).includingAdditionalPlatforms(ee(e)).includingRelationships([]).withSparseLimit(10).includingAttributes(lp(e)).usingCustomAttributes(Ue(e))
return function(e,t){let n=!1
for(const e of Object.keys(t)){if(e===y9&&s(t[e])){const r=t[m9]
if(s(r))switch(r[0].value){case p9:case w9:t[e][0].value=T9
break
case g9:t[e][0].value=A9
break
case v9:t[e][0].value=A9,n=!0}}e===b9&&o(t[e])&&(t[e]=S9[DW.binCompatGames].false)}n&&e.withSparseCount(4)
for(const n of Object.keys(t)){const r=f9.requestValuesForSelectedFacetOptions(t[n])
if(s(r)){s(r.value)&&e.addingQuery(n,r.value)
for(const t of Object.keys(r.additionalKeyValuePairs))e.addingQuery(t,r.additionalKeyValuePairs[t])}}}(r,s(t.selectedFacetOptions)?t.selectedFacetOptions:ap(e)),r})}async renderPage(e,t,n,o){return await Va(mj,async()=>{const o=g(t),i=gp(e,n),a=Un(e,DH,QU,o),c=function(e,t,n){return{url:qW.fromComponents(hW,null,`/${yW.arcadeSeeAllGames}/${yW.arcadeSeeAllGamesLoadMore}`).build(),metricsPageInformation:n,metricsLocationTracker:{rootPosition:0,locationStack:[]},remainingGroups:[],lastShelfIndex:0,isCompactMode:t.isCompactMode}}(0,i,a),u=new l9(up(e,l(o,"results.groups"),c))
u.title=e.loc.string(RI),u.pageFacets=function(e){sp(e),e.featureFlags.isEnabled(sJ)
const t=e.loc.string("PAGE_FACETS_FILTERS_AGE_RATINGS"),n=new d9(DW.ageRating,CO,t,eB,[E9,R9,D9,_9],[E9],"age",cp(e,xV)),r=e.featureFlags.isEnabled(iJ)||!1,o=new d9(DW.sort,m9,e.loc.string(CA),eB,[C9,I9,k9,O9],r?[C9]:null,xV,cp(e,xV)),i=e.loc.string(SA),s=new d9(DW.controllerSupport,IO,i,UF,[L9],null,IA,cp(e,xV)),a=e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),c=new d9(DW.multiplayerSupport,kO,a,UF,[M9],null,YV,cp(e,xV)),l=new d9(DW.comingSoon,y9,e.loc.string(PA),UF,[x9],[x9],vL,cp(e,vL))
l.isHiddenFromMenu=r
const u=new f9([],!1,null)
switch(e.client.deviceType){case Yq:u.facetGroups.push(new h9([n])),e.bag.enableComingSoonToggle&&u.facetGroups.push(new h9([l],e.loc.string(kA))),u.facetGroups.push(new h9([s,c],e.loc.string("PAGE_FACETS_SUPPORTS_TITLE"))),u.facetGroups.push(new h9([o]))
break
case"tv":u.facetGroups.push(new h9([n],e.loc.string("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")))
const t=[s,c]
e.bag.enableComingSoonToggle&&t.push(l),u.facetGroups.push(new h9(t,e.loc.string("PAGE_FACETS_FILTERS_TITLE"))),u.facetGroups.push(new h9([o],e.loc.string("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")))
break
default:o.displayOptionsInline=!0,u.facetGroups.push(new h9([o],e.loc.string(CA))),n.showsSelectedOptions=!0,u.facetGroups.push(new h9([s,c,n],e.loc.string("PAGE_FACETS_FILTER_BY_TITLE"))),e.bag.enableComingSoonToggle&&u.facetGroups.push(new h9([l],e.loc.string(kA)))}return u}(e),u.selectedFacetOptions=s(i.selectedFacetOptions)?i.selectedFacetOptions:ap(e),u.pageSegments=[],jn(e,u,a)
const d=u.pageMetrics.instructions
if(!r(d))for(const e of d)e.data.includingFields.push(DS)
return c.remainingGroups.length>0&&(u.nextPage=c),u})}generatePaginationRequest(e,t,n,r){const o=g(r)
let i=[],s=20,a=!0
for(const e of o.remainingGroups)a=a&&(e.data.length<s||0===i.length),a&&(i=i.concat(e.data),s-=e.data.length)
return new Jz(e,i).includingAdditionalPlatforms(ee(e)).includingAttributes(lp(e)).usingCustomAttributes(Ue(e))}async renderPaginatedPage(e,t,n){const r=g(n),o=[]
let i=20
const a={}
for(const e of t.data)a[e.id]=e
let c=!0
for(const e of r.remainingGroups){if(c=c&&(e.data.length<i||0===o.length),c){for(let t=0;t<e.data.length;t++){const n=a[e.data[t].id]
s(n)&&(e.data[t]=n)}i-=e.data.length}o.push(e)}r.remainingGroups=[]
const l=up(e,o,r),u=new l9(l)
return u.title=e.loc.string(RI),r.remainingGroups.length>0&&(u.nextPage=r),u}generateShelfRequest(e,t,n){const r=g(JSON.parse(n[Wj])).remainingContent.slice(0,20),o=new Jz(e,r).includingAdditionalPlatforms(ee(e)).includingAttributes(lp(e)).usingCustomAttributes(Ue(e))
return Je(e,o,r),o}async renderShelf(e,t,n){const r=g(JSON.parse(n[Wj]))
return r.remainingContent=t.data.concat(r.remainingContent.slice(20,r.remainingContent.length)),r.isFirstRender=!1,dp(e,r)}}class G9{constructor(e,t,n,r){this.$kind="ArcadeSubscribePage",this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class j9{constructor(){this.$intentKind="ArcadeSubscribePageIntent"}async perform(e,t){return await vp(t,e.url)}}class V9 extends p2{constructor(e,t){super("ArcadeSubscribeBuilder"),t.exportingService(yF,{fetchSubscribePage:async t=>await vp(e,t.url)})}defaultPlatforms(e){return ee(e)}defaultTab(e){return qq}defaultAttributes(e){const t=[Tq,zV,JV]
return e.appleSilicon.isSupportEnabled&&t.push(hH),t}pageType(){return xO}pageRoute(e){return[{hostName:"arcadeSubscribePageCustomContext",query:[`${DW.appId}?`,`${DW.context}?`,`${DW.subscribePageMessage}?`,`${DW.askToBuyId}?`,`${DW.editorialItem}?`,`${DW.includePostSubscribeAttribution}?`]},{hostName:`${bW}`,query:[`${DW.appId}?`,`${DW.context}?`,`${DW.subscribePageMessage}?`,`${DW.askToBuyId}?`,`${DW.editorialItem}?`,`${DW.includePostSubscribeAttribution}?`]},{path:"arcade/subscribe",query:[`${DW.appId}?`,`${DW.context}?`,`${DW.subscribePageMessage}?`,`${DW.askToBuyId}?`,`${DW.editorialItem}?`,`${DW.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${DW.appId}?`,`${DW.context}?`,`${DW.subscribePageMessage}?`,`${DW.askToBuyId}?`,`${DW.editorialItem}?`,`${DW.includePostSubscribeAttribution}?`]}]}generatePageRequest(e,t,n){return ao(e,this.marketingItemContextFromParameters(n),f(n,DW.appId)).attributingTo(t.build())}async renderPage(e,t,n,o){var a,c
const u=o[V9.contextualAppRequirementKey]
let d=null
s(u)&&(d=yt(e,u))
const h=l(t,aO).map(e=>y(e)),p=e.arcade.getMarketingItemFromMarketingItems(h),w=p,g=Fc(e,w,0,!1,!1,mL),m=this.marketingItemContextFromParameters(n),A=e.client.isPhone,b=m===pt(U_),S=new SY(qq,e.bag.arcadeAppAdamId,null,wj,null,b&&A?"arcadeLaunchRepairCompactSheet":DI,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
S.titles[gU]=e.loc.string(bB,SB)
const P=f(n,DW.appId),C=function(e,t,n,r){var o
const s=Un(e,"Upsell",n,r)
return i(r)&&(s.mercuryMetricsData=null!==(o=fh(0,r))&&void 0!==o?o:void 0),s}(e,0,w.id,w)
C.offerType=OO,C.baseFields.upsellType=this.metricsUpsellType(m),C.baseFields.subscriptionSKU=e.bag.arcadeProductId
const I={pageInformation:C,locationTracker:{rootPosition:0,locationStack:[]}},k=Bc(e,{marketingItemData:p},xc(0,w),I,!1)
if(!T(c=k)||c[tW]!==Iy)throw new Error("Only buy actions are supported on the upsell page")
const O=new G9(g,e.loc.string(EA),k,S)
let E
O.askToBuyMessage=f(n,DW.subscribePageMessage),O.askToBuyId=f(n,DW.askToBuyId),jn(e,O,C)
let R=!1
if(s(d)){O.primaryIcon=Wd(e,d,I,{useCase:n6.LockupIconLarge})
const t=V(d,eq),r=Js(e,d,I)
r.excludeAttribution=!v(n[DW.includePostSubscribeAttribution]),E=Sr(e,d,vq,m,t,r),R=!0}if(!v(n[DW.includePostSubscribeAttribution])){const e=O.pageMetrics.instructions
if(!r(e))for(const t of e)t.data.includingFields.push(bM)}let D=[]
const _=o[V9.contextualIconsRequirementKey]
if(s(_)&&(D=bt(_)),i(p)&&(D=we(p,Jq)),s(D)){const t=[]
for(const n of D)if(n.id===P){if(!R){O.primaryIcon=Wd(e,n,I,{useCase:n6.LockupIconLarge})
const t=V(d,eq),r=Js(e,n,I)
E=Sr(e,n,vq,m,t,r)}}else t.push(Wd(e,n,I,{useCase:n6.LockupIconMedium}))
O.icons=t}return i(E)&&(k.postSubscribeAction=E),b&&i(P)&&(O.openAppAction=new _J(P)),s(O.icons)||i(O.primaryIcon)||(O.artwork=this.genericArtworkFromData(e,w)),b&&(O.singleIcon=O.primaryIcon,(null===(a=O.singleIcon)||void 0===a?void 0:a.art)&&(O.singleIcon.art.contentMode=Hv.scaleAspectFit)),O.subscribedOfferButtonAction=new cX(qq),O}genericArtworkFromData(e,t){if(!i(t))return null
const n=e.client.isPhone,r=function(e,t,n){const r=function(e,t){return Ec(e,t)}(e,t)
return p(r,n)}(e,t,n?hb:FE)
if(!s(r))return null
let o=null,a=h(r,OG)
return n?(o="of",a=a-296-1602):(o="og",a=a-344-772),qd(e,r,{cropCode:o,allowingTransparency:!0,useCase:n6.ArcadeContextualUpsell,overrideHeight:a})}metricsUpsellType(e){return i(e)?e:pt(ij)}marketingItemContextFromParameters(e){let t=f(e,DW.context)
const n=f(e,DW.askToBuyId)
switch(o(t)&&s(n)&&(t=B_),t){case U_:return pt(U_)
case B_:return pt(B_)
default:return t}}}V9.contextualIconsRequirementKey="contextualIconsRequirement",V9.contextualAppRequirementKey="contextualPrimaryIconRequirement"
class H9 extends ZY{constructor(e){super(e,"ArcadePage")}}const q9="amdImpressionData"
class W9 extends p2{constructor(e=null){super(e||"AbstractGroupingPageController")}generateAdditionalPageRequirements(e,t,n){var r
const o=super.generateAdditionalPageRequirements(e,t,n),i=e.amsEngagement
if(!i||!vn(e))return o
const s=[_H,Kq,qq],a=null===(r=e.bag.tabsStandard.find(e=>e.url===t.toString()))||void 0===r?void 0:r.id
if(!s.includes(a))return o
const c={timeout:1e3,eventType:mK,tab:a}
return o[q9]=D(i.performRequest(c)),o}async renderPage(e,t,n,r,o,s){return await Va(pb,async()=>{const a=function(e,t){const n=yt(e,t)
return n&&de(n,UG)?ll(e,n):null}(e,t),c=function(e,t,n){const r=yt(e,t)
if((0,Uv.isNothing)(r))return null
const o=Un(e,ME,r.id,t),s=Ss(e)
return o.recoMetricsData=hh(o.recoMetricsData,null,s),{shelves:[],metricsPageInformation:o,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:j(r,"id"),pageGenreId:null,hasAuthenticatedUser:i(e.user.dsid),refreshController:Nr(t),recoImpressionData:gn(0,null==n?void 0:n[q9])}}(e,t,r)
return(0,Uv.isNothing)(a)||(0,Uv.isNothing)(c)?null:this.renderGroupingPage(e,a,c,n,r,o,s)})}}class z9{constructor(){this.$intentKind="ArcadePageIntent"}async perform(e,t){return await yp(t,e)}}class Y9 extends W9{constructor(e,t){super("ArcadePageBuilder"),t.exportingService(yF,{fetchPage:async t=>await yp(e,t)})}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Tq,zV,JV,sU]
return e.bag.enableUpdatedAgeRatings&&t.push(iq),e.appleSilicon.isSupportEnabled&&t.push(hH),t}pageType(){return qq}pageRoute(e){return[{protocol:pW,path:`/${yW.store}/${yW.grouping}`,query:[DW.isArcade,`${DW.isTrialAvailable}?`,`${DW.isTrialEnrolled}?`,`${DW.isSubscribed}?`,DW.id]},{hostName:AW,path:`/WebObjects/{storePreviewInstance}/wa/${yW.grouping}`,query:[DW.isArcade,`${DW.isTrialAvailable}?`,`${DW.isTrialEnrolled}?`,`${DW.isSubscribed}?`,DW.id,`${DW.useReleaseId}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[DW.isArcade,`${DW.isTrialAvailable}?`,`${DW.isTrialEnrolled}?`,`${DW.isSubscribed}?`]},{protocol:pW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[DW.isArcade,`${DW.isTrialAvailable}?`,`${DW.isTrialEnrolled}?`,`${DW.isSubscribed}?`]},{protocol:pW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[DW.isArcade,`${DW.isTrialAvailable}?`,`${DW.isTrialEnrolled}?`,`${DW.isSubscribed}?`]}]}generatePageRequest(e,t,n){const r=n[DW.id],o=v(n[DW.isSubscribed]),s=v(n[DW.isTrialEnrolled])
if(!a(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
const c=[Tq,wq,zV,JV,uV,aG]
e.appleSilicon.isSupportEnabled&&c.push(hH),e.bag.enableUpdatedAgeRatings&&c.push(iq),Kd(e)&&c.push(sH)
let l=new Jz(e).includingAgeRestrictions().includingAttributes(c).includingMacOSCompatibleIOSAppsWhenSupported()
oi(e)&&(l.enablingFeature(MH),l.includingScopedAttributes(Vq,DK),l.includingScopedRelationships(Vq,[Mq])),ii(e)&&(l.enablingFeature(eM),yi(l)),si(e)&&(l.enablingFeature(mB),Ti(l))
const u=ne(e)
if(i(u)&&l.addingQuery(IG,u),o){const t=!0,n=ar(e,e.bag.arcadeTrialEnrolledStateRate)
t&&s&&n?l.addingQuery(UG,"trial-enrolled"):l.addingQuery(UG,"subscriber")}else l.addingQuery(UG,"nonsubscriber"),l.includingRelationshipsForUpsell(!1)
l.withIdOfType(r,TV)
const d=t.query[DW.useReleaseId]
return RW.has(t.host)&&(null==d?void 0:d.length)>0&&(l=l.addingQuery(_I,d),l.isStorePreviewRequest=!0),l.enablingFeature(LE),l.enablingFeature(ub),l.withSparseCount(Q(e)),l.includingScopedSparseLimit(vB,X(e)),l.attributingTo(t.build())}renderGroupingPage(e,t,n,r,i,a,c){return Bv.context(mj,()=>{const i=v(r[DW.isSubscribed]),c=v(r[DW.isTrialAvailable]),l=v(r[DW.isTrialEnrolled]),u={}
u[DW.isArcade]="true",u[DW.isSubscribed]=`${i}`,u[DW.isTrialAvailable]=`${c}`,u[DW.isTrialEnrolled]=`${l}`,n.additionalShelfParameters=u,n.isArcadePage=!0,n.metricsPageInformation.isCrossfireReferralCandidate=!0
let d=null,f=null
if(!i){const r=co(e,t.originalGroupingData)
if(r)d=r.marketingItemData
else if(a){Bv.unexpectedNull(yH,LI,"relationships.upsell")
const e=lo(0,a.get(S_))
e&&(d=e.marketingItemData)}if(s(d)&&s(d.attributes)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,mercuryMetricsData:fh(0,d)}
f=Mc(e,d,t),s(n)&&o(n.pageTitleEffect)&&0===n.shelves.length&&(n.pageTitleEffect=function(e,t){const n=Sc(e,t,!0),r=bc(e,t)
return Lc(0,n.artworkData||r.artworkData,!0)}(e,d)),bh(n.metricsLocationTracker)}}const h=Y9.insertUpsellBreakoutShelfIntoParseContextIfNecessary(f,i,n)
al(e,t,n)
const p=new H9(n.shelves)
jn(e,p,n.metricsPageInformation),p.tabTitle=j(t.originalGroupingData,Zq)
const w=j(t.originalGroupingData,Zq)
e.host.clientIdentifier,h||(p.title=w)
const g=new u4(cV)
g.color=Se("primaryText"),g.isFallbackStyle=!0,e.clientCapabilities.isEnabled("arcadeStandardLargeTitle")?p.presentationOptions=[tM]:p.presentationOptions=[]
let m=!1
if(n.shelves.length>0){const e=n.shelves[0].contentType===P$,t=n.shelves[0].contentType===XU,r=n.shelves[0].contentType===YG
m=e||t||r}if(m&&(p.presentationOptions.push(iN),p.titleEffect=n.pageTitleEffect||g),!i&&s(f)){p.subscriptionOfferAction=Y9.createSubscribeAction(e,f,{id:null,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:Qq}),p.subscriptionOfferDisplayProperties=new SY(qq,e.bag.arcadeAppAdamId,null,wj,null,qq,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r={marketingItemData:d}
p.subscriptionLockup=Od(e,r,t,pt(FB),wj,EE)}const y={id:"arcade-see-all-games-footer",presentationHints:{},featuredContentId:-1,featuredContentData:null,nativeGroupingShelfId:1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
if(this.insertUnifiedMessageShelves(e,p),p.shelves.length>0){const t=Y9.groupingArcadeFooterShelfController.createShelf(e,null,n,y,null)
p.shelves.push(t)}if(0===p.shelves.length)throw new Error(`Missing content for Arcade grouping ${JSON.stringify(r)}`)
return p.autoUpsellAction=to(e,pt(ij),null,null),mp(p),p})}static insertUpsellBreakoutShelfIntoParseContextIfNecessary(e,t,n){return Bv.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(o(e))return t||Bv.unexpectedNull(cH,LI,XU),!1
const r=new YY(XU)
return r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t,n){if(o(t))return null
{const r=to(e,pt(qk),null,null,n)
return r.title=t.offerButtonAction.title,r}}createTermsAndConditionsShelf(e){return!r(e.bag.termsAndConditionsURL)&&e.client.deviceType,null}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t,n){if(r(n))return null
const o=yt(e,t),i=v(n.parameters[DW.isSubscribed]),s=co(e,o)
return!i&&r(s)?new Set([S_]):null}fetchAdditionalDataForKey(e,t){return Bv.context("fetchAdditionalDataForKey",async()=>{let n
return t===S_&&(n=ao(e,pt(FB)),Bv.unexpectedNull(cH,aV,"upsellRecovery.marketingItem")),r(n)?null:await Ln(e,n).catch(()=>null)})}insertUnifiedMessageShelves(e,t){t.shelves.length<=0||(t.shelves.splice(1,0,fl(0,"arcadePageHeader")),t.shelves.splice(6,0,fl(0,"arcadePageMid")),t.shelves.push(fl(0,"arcadePageFooter")))}}Y9.groupingArcadeFooterShelfController=new B2
class J9{constructor(e,t){this.$kind="ArcadeWelcomePage",this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class K9{constructor(e,t,n,r,o){this.$kind="ArcadeWelcomeContent",this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class Z9{constructor(e,t,n){this.$kind="ArcadeWelcomeItem",this.headline=e,this.body=t,this.artwork=n}}const Q9={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:OA,textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},X9={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:OA,textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"}
class e8{constructor(){this.$intentKind="ArcadeWelcomePageIntent"}async perform(e,t){return await Tp(t,e.url)}}class t8 extends h2{constructor(e,t){super("ArcadeWelcomeBuilder"),t.exportingService(yF,{fetchArcadeWelcomePage:async t=>await Tp(e,t.url)})}pageType(){return"arcadeWelcome"}async handlePage(e,t,n,r,o){const i=await this.generatePage(e,n,r)
return h2.createFlowAction(i,this.pageType(),t)}pageRoute(e){return[{hostName:"arcadeWelcomePage",query:[`${DW.context}?`]}]}async generatePage(e,t,n){return function(e,t){return function(e,t){const n={rootPosition:0,locationStack:[]},r=function(e,t){if(rr(t)){const t=new fW
return t.title=e.loc.string("ARCADE_WELCOME_TV_CONTINUE_BUTTON"),t}return Ap(0,e.loc.string("ARCADE_WELCOME_CONTINUE_BUTTON"))}(e,t)
Qs(e,r,{id:"arcade-welcome-continue",actionType:Xq,pageInformation:new BJ,locationTracker:n,targetType:Qq})
const o=function(e,t){return rr(t)?Ap(0,e.loc.string(RO)):null}(e,t)
o&&Qs(e,o,{id:"arcade-welcome-create-family",actionType:Xq,pageInformation:new BJ,locationTracker:n,targetType:Qq})
let i=Q9,s="oe"
e.client.isPad&&(i=X9,s="og")
const a=new K9(e.loc.string("ARCADE_WELCOME_INDIVIDUAL_TITLE"),e.loc.string("Arcade.Welcome.Family.Description"),[new Z9(null,null,qd(e,i,{useCase:n6.ArcadeWelcomeSheet,cropCode:s}))],r,o)
if(rr(t)){a.nonDismissingContinueAction=Ap(0,e.loc.string(RO)),r.title=a.nonDismissingContinueAction.title
const t=new fW
t.title=e.loc.string(EA),a.dismissingFamilyAction=t,o.title=a.dismissingFamilyAction.title}else a.nonDismissingContinueAction=Ap(0,e.loc.string(RO)),r.title=a.nonDismissingContinueAction.title
return new J9(a,a)}(e,t)}(e,t[DW.context])}}class n8 extends h2{constructor(){super("FamilyCircleBuilder")}pageType(){return Dq}defaultTab(e){return qq}async handlePage(e,t,n,r,o){var i
const s=new cX(qq),a=null!==(i=t.query[Rj])&&void 0!==i?i:nA,c=new E3(nq,a,t.query)
return s.actions.push(c),s}pageRoute(e){return[{hostName:`${PW}`},{path:`${PW}`}]}}class r8{constructor(e,t){this.$kind="UpsellGridContent",this.primaryIcon=e,this.icons=t}}class o8{constructor(){this.$intentKind="ArcadeUpsellGridIntent"}async perform(e,t){return await bp(t,e.contentDictionary)}}class i8 extends h2{constructor(e,t){super("MarketingItemUpsellBuilder"),t.exportingService(yF,{fetchUpsellGrid:async t=>await bp(e,t.contentDictionary)})}pageType(){return dj}pageRoute(e){return[{hostName:`${bW}`,query:[`${DW.appId}?`,`${DW.context}?`,`${DW.includePostSubscribeAttribution}?`],exclusions:[{query:[`${DW.askToBuyId}`]}]},{path:"arcade/subscribe",query:[`${DW.appId}?`,`${DW.context}?`,`${DW.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${DW.appId}?`,`${DW.context}?`,`${DW.includePostSubscribeAttribution}?`]}]}async handlePage(e,t,n,r,o){var i
const s=pt(f(n,DW.context)),a=f(n,DW.appId),c=new jK(qq,s,e.bag.metricsTopic,a),l=new fY(dj),u=null===(i=e.metricsIdentifiersCache)||void 0===i?void 0:i.getMetricsFieldsForTypes([Yv.user,Yv.client,Yv.canonical])
return(0,Nv.isSome)(u)&&(c.metricsOverlay={...c.metricsOverlay,...u}),l.pageData=c,l}}class s8{constructor(){this.$intentKind="ArcadeSubscriptionDecorationIntent"}async perform(e,t){return await Sp(t,e.json)}}class a8 extends h2{constructor(e,t){super("ArcadePurchaseDecorationController"),t.exportingService(VI,{decorateArcadePurchase:async t=>await Sp(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class c8{constructor(e,t,n){this.$kind="PersonalizedOfferContext",this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}class l8{constructor(){this.$intentKind="PersonalizedOfferContextIntent"}async perform(e,t){return await Pp(t,e.offerToken)}}class u8 extends h2{constructor(e,t){super("CompleteCollectionController"),t.exportingService("CMCPersonalizationData",{fetchPersonalizedOfferContext:async t=>await Pp(e,t.offerToken)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class d8{constructor(e,t){this.purchase=e,this.buyParams=t}}class f8{constructor(e,t){this.items=e,this.commonBuyParams=t}}class h8{constructor(){this.$intentKind="PurchaseDecorationIntent"}async perform(e,t){return await Cp(t,e.json)}}class p8{constructor(){this.$intentKind="PurchasesDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await Cp(t,r))
return n}}class w8{constructor(){this.$intentKind="BatchPurchaseDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await Cp(t,r))
const r=n.map(e=>e.buyParams),[o,i]=function(e){const t=[]
for(const n of e)t.push(new GJ(n).toRawMap())
const n=function(e){if(0===e.length)return{}
const t={},n=e[0]
for(const r of Object.keys(n)){let o=!0
for(let t=1;t<e.length;t++)if(e[t][r]!==n[r]){o=!1
break}o&&(t[r]=n[r])}return t}(t)
for(const e of t)for(const t of Object.keys(n))delete e[t]
return[t,n]}(r),s=[]
for(let e=0;e<n.length;e++)s.push(new d8(n[e],o[e]))
return new f8(s,i)}}class g8 extends h2{constructor(e,t){super("PurchaseDecorationController"),t.exportingService(VI,{decoratePurchase:async t=>await Cp(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class v8{constructor(){this.$intentKind="IconArtworkIntent"}async perform(e,t){return await Ip(t,e.adamIds)}}class m8 extends h2{constructor(e,t){super("IconLookupController"),t.exportingService("ContentData",{fetchIconArtwork:async t=>await Ip(e,t.adamIds)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class y8 extends h2{constructor(){super("ContentLink")}pageType(){return eW}async handlePage(e,t,n,o,s){if(r(f(n,DW.path)))throw new Error(`Unhandled search url: ${t}`)
const a=await M(e.network.fetch({url:t.build(),method:UN}))
if(!a.success)throw new Error(`Unhandled search url: ${t}`)
const c=a.value
if(this.hasGotoURLInResponse(e,c))return new fW
if(i(c.url))return await e.required(n3).fetchAction(e,c.url,s)
throw new Error(`Unhandled search url: ${t}`)}pageRoute(e){return[{hostName:"search.itunes.apple.com",path:"WebObjects/MZContentLink.woa/wa/link",query:[DW.path]}]}hasGotoURLInResponse(e,t){const n=t.body
if((0,Nv.isNothing)(n)||0===n.length)return!1
try{const t=m(e.plist.parse(n)),r=f(t,NO),o=f(t,BO)
return!!(r===UO&&(0,Nv.isSome)(o)&&o.length>0)}catch{return!1}}}class A8 extends h2{constructor(){super("ExperimentLink")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i={url:t.toString()},s=await M(e.network.fetch(i))
if(!s.success)throw s.error
const a=s.value
if(a.status>=200&&a.status<300){const e=new gY(vq)
return e.title="You have been enrolled in the AB test",e.message=`Test ${t.query.ab2} is now active on your device.`,e.buttonTitles=["OK"],e.buttonActions=[new cX(TH)],e}throw new Error(`unexpected response status: ${a.status} from ${a.url}`)}pageRoute(e){return[{protocol:pW,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}const T8=[Kq,ND]
class b8 extends h2{constructor(){super("FallbackActionBuilder")}async handlePage(e,t,n,i,s){return await async function(e,t,n,i){var s
const a=t.query[UH]
switch(a){case nH:const n=new fY(cj)
n.presentationContext=Mj,n.animationBehavior=BB
const c=t.query[Y_]
return c?n.pageUrl=c:t.query[Fy]?n.pageUrl=qW.fromComponents(null,a,null,{continuation:t.query[Fy]}).toString():n.pageUrl=a,await Promise.resolve(n)
case Ny:const l=new fY(cj)
return l.presentationContext=Mj,l.animationBehavior=BB,l.pageUrl=function(e){let t=e.bag.createAccountUrl
return(r(t)||typeof t!==Sq)&&(t=eO),new qW(t)}(e).build(),await Promise.resolve(l)
case Ux:let u,d=[]
{u=J_
const e=new fY(nH)
e.presentationContext=Mj,e.animationBehavior=qV
const t=new fY(By)
t.animationBehavior=qV,d=[e,t]}const f=new cX(u)
return f.actions=d,await Promise.resolve(f)
case K_:const h=t.query[Y_]
if(h.length>0){const t={url:h,signingStyle:MV}
return e.network.fetch(t),await Promise.resolve(new fW)}return await Promise.reject(new Error("Original url is missing when creating deep-link for checkForPreorders."))
case RF:const p=new fY(cj)
p.presentationContext=Mj,p.animationBehavior=BB
const w=new qW(a)
return t.query[GN]&&t.query[GN].length>0&&w.param(DW.code,t.query[GN]),p.pageUrl=w.build(),await Promise.resolve(p)
case DF:const g=new fY(cj)
return g.presentationContext=Mj,g.animationBehavior=BB,g.pageUrl=a,await Promise.resolve(g)
case Uy:const v=new fY(cj)
return v.presentationContext=Mj,v.animationBehavior=BB,v.pageUrl="charity",await Promise.resolve(v)
case aq:let m=t.query[jU]
if(m||(m=null!==(s=t.query.q)&&void 0!==s?s:t.query[Xk]),m&&m.length>0){const t=m
if(m=m.replace(/\+/g," ").trim(),t.endsWith("+")&&m.length>0&&(m+="+"),o(m))return await Promise.reject(new Error("Empty search term."))
const n=ve(e,Ep(e,{term:m,origin:jN})).toString(),r=new B4(m,m,n,jN,null,null,null,i)
ta(e,r,Qq,{rootPosition:0,locationStack:[]})
{const e=new fY(aq)
return e.pageData=r,await Promise.resolve(e)}}{const e=new cX(aq)
return await Promise.resolve(e)}}return await Promise.reject(new Error(`FlowAction was not able to be created for this action URL: ${t}`))}(e,t,0,s)}pageRoute(e){return[{query:[`${DW.action}=account`]},{query:[`${DW.action}=signup`]},{query:[`${DW.action}=purchased`]},{query:[`${DW.action}=checkForPreorders`]},{query:[`${DW.action}=redeem`]},{query:[`${DW.action}=gift`]},{query:[`${DW.action}=donate`]},{query:[`${DW.action}=search`]}]}pageType(){return Dq}}class S8 extends h2{constructor(){super("GameCenterProfileLinkController")}defaultTab(e){return qq}pageType(){return Dq}async handlePage(e,t,n,r,o){let i=!1
if(e.host.clientIdentifier===qz)i=!0
else for(const t of e.bag.tabsStandard)if("ocelot"===f(t,"id")){i=!0
break}const s=new cX(i?qq:_H),a=n[DW.id]||"GameCenter.localPlayer"
return s.actions.push(new M5(a)),s}pageRoute(e){return[{identifier:HI,path:`/${yW.gameCenterProfile}`,query:[`${DW.id}?`]}]}}class P8 extends h2{constructor(){super("HiddenPurchasesLinkController")}pageType(){return $O}async handlePage(e,t,n,r,o){const i=new fY($O)
return i.presentationContext=X_,i}pageRoute(e){const t=[]
return t.push({hostName:"showHiddenPurchases"}),t}}class C8 extends h2{constructor(){super("LibraryLink")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${t.query.g}&mt=8`
return await e.required(n3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${DW.action}=library-link`]}]}}class I8 extends h2{constructor(){super("LongUrlBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const a=t.query[Y_]
if((0,Nv.isNothing)(a)||0===a.length)throw new Error("Original url is missing when creating deep-link for checkForLongUrl.")
const c=await M(e.network.fetch({url:a,method:UN,signingStyle:MV}))
if(!c.success)throw new Error(`Unable to fetch long url: ${a}`)
const l=c.value
let u
const d=l.headers["Content-Type"]
if(l.ok&&l.redirected&&i(l.url))u=l.url
else{if(l.ok&&a!==l.url)return e.console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${a}. Redirected url: ${l.url}`),new fW
if(l.ok&&s(d)&&-1!==d.toLowerCase().indexOf("text/xml")){const t=m(e.plist.parse(l.body)),n=f(t,NO),r=f(t,BO)
n===UO&&r&&(u=r)}}if((null==u?void 0:u.length)>0)return await e.required(n3).fetchAction(e,u,o)
throw new Error(`Unable to map long url for: ${a}`)}pageRoute(e){return[{query:[`${DW.action}=checkForLongUrl`]}]}}class k8 extends h2{constructor(){super("MultiplexingBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=new Jz(e).withIdOfType(n.id,Cx)
return await Ln(e,i).then(async t=>await this.actionFromMultiplexResponse(e,t))}pageRoute(e){return[{protocol:pW,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[DW.id]}]}async actionFromMultiplexResponse(e,t){const n=p(t,"results.target"),r=p(t,"results.target-link")
return n?await this.targetDataToAction(e,n):r?await this.targetLinkDataToAction(r):null}async targetDataToAction(e,t){const n=f(t,uG)
if(!n)return null
const r=Fi(e,n)
return await e.required(n3).fetchAction(e,r,null)}async targetLinkDataToAction(e){const t=f(e,Rq),n=new qW(t),r=this.addProtocolToURLIfNeeded(n).toString()
return await Promise.resolve(new PY(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol=C_),e}}class O8 extends h2{constructor(){super("NotificationSettingsLinkController")}pageType(){return Dq}async handlePage(e,t,n,r,o){return new fY($A)}pageRoute(e){const t=[]
return t.push({path:"notifications/settings"}),t}}class E8 extends h2{constructor(){super("TabSelectionBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=t.pathComponents(),s=i.length-1
let a,c
return a=s>=0?i[s]:t.query[UH],null!=a&&this.currentDeviceSupportsUrlAction(e,a)&&(c=new cX(a),c.popToRoot=t.query.popToRoot===XH),void 0===c&&(c=new cX(_q)),c}pageRoute(e){const t=[_q,"home",_H,Kq,gG,XG,wF,gF,vF,VN,qq,xU],n=[]
for(const e of t){const t=`${DW.action}=${e}`,r=`${e}`
n.push({query:[t]}),n.push({path:r}),n.push({path:`{countryCode}/${r}`})}return n.push({path:"{countryCode}/ipad"}),n.push({path:"{countryCode}/iphone"}),E8.supportedIOSTabs.forEach(e=>{n.push({path:`{countryCode}/ipad/${e}`}),n.push({path:`{countryCode}/iphone/${e}`})}),n}currentDeviceSupportsUrlAction(e,t){return!!E8.supportedIOSTabs.includes(t)}}E8.supportedMacTabs=[gG,qq,XG,wF,gF,vF,VN,aq],E8.supportedIOSTabs=[_q,Kq,_H,qq,aq],E8.supportedTvTabs=[gG,Kq,_H,qq,aq],E8.supportedVisionOSTabs=[xU,qq,aq]
class R8 extends h2{constructor(){super("PassbookBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){const i=this.assemblePassbookRoomURL(e,t).build()
return await e.required(n3).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${DW.action}=passbook`]}]}assemblePassbookRoomURL(e,t){let n=e.bag.passbookMainURL
return null!=n&&typeof n===Sq||(n="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new qW(n)}}class D8 extends h2{constructor(){super("WatchCategoryBuilder")}pageType(){return Dq}async handlePage(e,t,n,r,o){if(e.client.deviceType!==jq)throw new Error(`Unsupported url for current platform: ${t}`)
const i=e.bag.watchAppsGroupingURL,s=await M(e.required(n3).fetchAction(e,i,o))
if(!s.success)throw s.error
const a=s.value,c=new cX(Kq)
return c.actions=[a],c}pageRoute(e){return[{query:[`${DW.action}=watchCategory`]}]}}class _8 extends w2{}const L8=[Oj,FV,xq,oG,nN],M8=[Oj,FV,rN,xq,iG,hB,nU,rU],x8=[Oj,oN,FV,iG],$8=[Oj,rN,xq,iG,oG,FV,oN,rU,nU,hB]
class F8{}class N8 extends h2{constructor(){super("DeveloperBuilder")}async handlePage(e,t,n,r,o){const i=function(e,t){const n=Ni(t)
if(!a(n))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return Ri(e,new Jz(e).withIdOfType(t,Qj))}(e,n)}(e,t)
return await Ln(e,i).then(t=>Dp(e,t)).then(e=>h2.createFlowAction(e,eW,t))}pageRoute(e){return[{protocol:pW,path:`/${yW.developer}/{id}`},{protocol:pW,path:`/${yW.developer}/{developerName}/{id}`},{protocol:pW,path:`/{countryCode}/${yW.developer}/{developerName}/{id}`},{protocol:pW,path:`/{countryCode}/${yW.artist}/{developerName}/{id}`},{protocol:pW,path:`/${yW.store}/${yW.viewArtist}`,query:[DW.id,`${DW.v0}?`]}]}async handleShelf(e,t,n,r){const i=n[Wj],s=JSON.parse(i),a=new Jz(e,s.remainingData).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e)).includingMacOSCompatibleIOSAppsWhenSupported()
return function(e,t,n){const r=xp(e,n.title,n.developerId,At(t),n.relationship,n.contentType,n.lockupListOptions,n.lockupListOptions.lockupOptions.metricsOptions.pageInformation,n.lockupListOptions.lockupOptions.metricsOptions.locationTracker,n.roomUrl,(0,Nv.isSome)(n.roomUrl))
return r.mergeWhenFetched=!0,!n.hasExistingContent&&o(r.items)&&(r.isHidden=!0),r}(e,await Ln(e,a),s)}shelfRoute(e){return[{protocol:hW,path:`/${yW.developer}/${yW.shelf}/{token}`}]}pageType(){return eW}}class B8 extends h2{constructor(){super("DeveloperHrefBuilder")}async handlePage(e,t,n,r,o){const i=n[DW.href],s=function(e,t){return Ri(e,new Jz(e,t))}(e,i)
return await Ln(e,s).then(t=>Dp(e,t)).then(e=>h2.createFlowAction(e,eW,t))}pageRoute(e){return[{protocol:hW,path:`/${yW.developer}/${yW.href}`,query:[DW.href]}]}pageType(){return eW}}class U8 extends g2{constructor(){super("DeveloperRoomBuilder")}pageRoute(e){return[{protocol:hW,path:`/${yW.developer}/${yW.room}/{token}`}]}paginationRoute(e){return[{protocol:hW,path:`${this.paginationPath}`,query:[`${DW.token}`]}]}generatePageRequest(e,t,n){const o=n[Wj],i=JSON.parse(o)
if(r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new Jz(e,i.url).withSparseLimit(i.maxPerPage).includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e))}async renderPage(e,t,n,r){return await Va(mj,async()=>{const r=n[Wj],o=JSON.parse(r),i=Un(e,DH,`${o.developerId}_${o.relationshipId}`,t)
o.metricsPageInformation=i,o.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=await this.pageWithContent(e,t,o)
return s.title=o.title,this.configurePaginationForPage(s,o,t.next),jn(e,s,i),s})}generatePaginationRequest(e,t,n,r){var o
const i=r,a=Pt(0,i)
let c
return s(a)?c=new Jz(e,a):(null===(o=i.nextHref)||void 0===o?void 0:o.length)>0&&(c=new Jz(e,i.nextHref).withSparseLimit(i.maxPerPage)),c.includingAdditionalPlatforms(ee(e)).includingAttributes(Ei(e)),c}async renderPaginatedPage(e,t,n){const r=n,o=s(r.remainingContent),i=await this.pageWithContent(e,t,r,!o),a=Ct(0,r)
return this.configurePaginationForPage(i,a,o?r.nextHref:t.next),i}configurePaginationForPage(e,t,n){const r=(null==n?void 0:n.length)>0,o=s(t.remainingContent)
r||o?(t.nextHref=n,t.url=`${this.paginationUrl}?${DW.token}=${JSON.stringify(t)}`,e.nextPage=t):e.nextPage=null}}!function(e){e.ViewAligned="viewAligned",e.CenterAligned="centerAligned"}(Nm||(Nm={}))
class G8 extends p2{constructor(){super("EditorialPageController")}defaultPlatforms(e){return ee(e)}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o)
const s=r.pathname===`/${yW.editorialPage}/${yW.shelf}`
let a
t.includingScopedRelationships("editorial-shelves",[Jq]).includingScopedRelationships(BH,[iU]),s?t.includingAssociateKeys(Kq,[qj]).includingAssociateKeys(Nq,[qj]):(t.includingRelationships([aN]).withSparseCount(5).withSparseLimit(12).includingAssociateKeys(wB,[qj]),t.includingAssociateKeys(lV,[Kq])),gw(e,t),a=r.query[DW.context]||ne(e),i(a)&&t.addingQuery(IG,a)}generatePageRequest(e,t,n){var r
let i
i=t.host===IW?e.bag.safariExtensionsEditorialPageId:t.query[DW.id]||n[DW.id]
const s=n[DW.name]
if(o(i)&&o(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
const a=new Jz(e)
let c=!1
return(null===(r=t.pathname)||void 0===r?void 0:r.includes(lV))&&(a.forType(lV),c=!0),c||a.forType(BH),(null==i?void 0:i.length)>0&&(c?a.withIdOfType(i,lV):a.withIdOfType(i,BH)),(null==s?void 0:s.length)>0&&a.addingQuery(DW.name,s),a.attributingTo(t.build())}pageRoute(e){return[{protocol:hW,path:`${yW.editorialPage}`,query:[`${DW.name}`,`${DW.isArcade}?`]},{protocol:hW,path:`${yW.editorialPage}`,query:[`${DW.id}`,`${DW.isArcade}?`]},{protocol:pW,path:"/{countryCode}/editorial-page/id{id}"},{protocol:pW,path:"/editorial-page/id{id}"},{protocol:pW,path:"/{countryCode}/{platform}/editorial/{id}"},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{path:"{apiVersion}/editorial/{countryCode}/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{path:"{apiVersion}/editorial/editorial-pages/{id}",query:[`${DW.name}?`,`${DW.isArcade}?`]},{path:"{apiVersion}/catalog/{countryCode}/tags/{id}",query:[`${DW.deviceFamily}?`]}]}pageType(){return eW}async renderPage(e,t,n,a,c,l){return await Va("renderEditorialPage",async()=>await async function(e,t,n){var a,c
const l=yt(e,t)
if(!s(l))return null
const u=we(l,aN)
if(!s(u))return null
let d="Editorial"
f(l,fV)===lV&&(d="TagRoom")
const h=Un(e,d,l.id,t),p={rootPosition:0,locationStack:[]},w=Ss(e)
h.recoMetricsData=hh(h.recoMetricsData,null,w)
const g=Nr(t),{isArcadePage:v}=n,m=[]
let y=null,A=null
if(!i(l.attributes))return null
y={id:l.id,type:l.type,attributes:l.attributes,relationships:l.relationships,meta:l.meta}
let T=!1
for(const t of u){const n=m.length,o=aw(e,y.id,t,v,n,h,p),i=pw(e,y,o)
if(!r(i)){if(0===m.length){const e=i.presentationHints
i.presentationHints={...e,isFirstShelf:!0}}o.type===rm.Upsell&&(T=!0),i.contentType===XU&&(A=ww(e,o)),m.push(i)}}const b=v?new H9(m):new ZY(m)
b.title=T?null:null!==(a=j(l,Vj))&&void 0!==a?a:j(l,Zq),b.canonicalURL=j(l,Rq),b.shareAction=function(e,t){var n
const s=j(t,Rq),a=j(t,Vj)
if(r(s)||r(a))return null
const c=function(e,t,n,r,i,s){return Bv.context("shareSheetDataForGenericPage",()=>{if(o(n))return null
const e=new tZ(t,r,null!=s?s:void 0)
return new KK(e,n,null)})}(0,a,s,e.loc.string("SHARE_EDITORIAL_PAGE_SUBTITLE"),0,null===(n=Zu(e,t,Dm.EditorialPage))||void 0===n?void 0:n.artwork)
if((0,Nv.isNothing)(c))return null
const l=function(e,t){const n=[]
if((null==t?void 0:t.length)>0){const r=Go(e,t)
i&&n.push(r)}return n}(e,s)
return new LK(c,l)}(e,l),b.pageRefreshPolicy=Ur(e,g),v&&i(A)&&(b.subscriptionLockup=A),v&&(h.isCrossfireReferralCandidate=!0),jn(e,b,h)
const S=(null===(c=m[m.length-1])||void 0===c?void 0:c.contentType)===SE
if(e.client.deviceType!==zq&&"tv"!==e.client.deviceType&&!S){const t=e.bag.termsAndConditionsURL
if(!r(t)){const n=dl(e,t)
m.push(n)}}if(m.length>0){const e=m[0].contentType===P$,t=m[0].contentType===XU,n=m[0].contentType===YG,r=m[0].contentType===C$;(e||t||n||r)&&b.presentationOptions.push(iN),r&&(b.presentationOptions.push(VL),b.presentationOptions.push(QT))}return mp(b),b}(e,t,{isArcadePage:v(n,DW.isArcade)}))}shelfRoute(e){return[{protocol:hW,path:`/${yW.editorialPage}/${yW.shelf}/`,query:[`${DW.token}`]}]}generateShelfRequest(e,t,n){const r=n[DW.token],o=JSON.parse(decodeURIComponent(r)),i=s(o.remainingItems),a=!i&&(0,Uv.isSome)(o.recommendationsHref)&&o.recommendationsHref.length>0
if(i){const t=o.remainingItems,n=new Jz(e,t,!0,[qj])
return Je(e,n,t),n}if(a){const t=new Jz(e,o.recommendationsHref)
return oi(e)&&(t.enablingFeature(MH),t.includingMetaKeys(vB,[E$,XL]),t.includingScopedAttributes(Vq,[hq,YU,JN]),t.includingScopedRelationships(Vq,[Mq])),si(e)&&(t.enablingFeature(mB),Ti(t)),t}return null}async renderShelf(e,t,n){var i
const a=n[DW.token],c=JSON.parse(decodeURIComponent(a)),l=s(c.remainingItems),u=!l&&(null===(i=c.recommendationsHref)||void 0===i?void 0:i.length)>0
if(c.isFirstRender=!1,l)c.remainingItems=this.buildHydratedShelfItems(e,c.remainingItems,t)
else if(u){c.data={...c.data,...yt(e,t)}
const n=we(c.data,Jq)
c.remainingItems=s(n)?n:[],cw(e,c.data,c)}const d=pw(e,void 0,c)
return o(d)&&!c.hasExistingContent?this.makeHiddenShelf():(function(e,t,n){if(!o(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])}(0,d,c),!c.hasExistingContent&&o(d.items)&&(d.isHidden=!0),d)}buildHydratedShelfItems(e,t,n){var r,o,i,s
const a=new Map,c=At(n)
for(const t of c)a[this.dataMapKey(e,t.type,t.id)]=t
const l=[]
for(const n of t){const t=a[this.dataMapKey(e,n.type,n.id)]
if((0,Uv.isSome)(t)){const c=kn(0,n)
if((0,Uv.isSome)(c)){const n=a[this.dataMapKey(e,qj,c.id)]
if((0,Uv.isSome)(n)){const e=null!==(r=t.meta)&&void 0!==r?r:{},a=null!==(o=y(e.associations))&&void 0!==o?o:{},c=null!==(i=y(a[qj]))&&void 0!==i?i:{},l=null!==(s=y(n))&&void 0!==s?s:{}
c.data=[l],a[qj]=c,e.associations=a,t.meta=e}}l.push(t)}}return l}dataMapKey(e,t,n){return`${t}_${n}`}makeHiddenShelf(){const e=new YY(dN)
return e.isHidden=!0,e}}const j8="EditorialShelfCollectionPageIntent",{routes:V8,makeCanonicalUrl:H8}=uc(vw,"/collections/{id}"),{routes:q8,makeCanonicalUrl:W8}=uc(vw,"/{platform}/collections/{id}")
class z8 extends p2{constructor(){super("EditorialShelfCollectionPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){return function(e){const t=[Tq,wq,zV,JV,uV,aG,sU,iH]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH),t}(e)}pageType(){return eW}pageRoute(e){return[{protocol:pW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${DW.shelfId}}`},{protocol:pW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${DW.shelfId}}`},{protocol:pW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-collection/{${DW.shelfId}}`}]}generatePageRequest(e,t,n){if(o(n[DW.shelfId]))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new Jz(e).forType("editorial-shelves-collection").attributingTo(t.build())}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([Jq]).includingScopedRelationships(BH,[iU]).includingAssociateKeys(wB,[qj]),gw(e,t)}async renderPage(e,t,n,r,o,i){return await Va("renderEditorialShelfCollectionPage",async()=>function(e,t){const n=yt(e,t)
if(!s(n))return null
const r=Un(e,DH,n.id,t),o=Nr(t),i=(_n(0,n),aw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=[],c=(0,Uv.unwrapOptional)(pw(e,void 0,i))
c.title=null,c.eyebrow=null,c.isHorizontal=!1
const l=j(n,Vj)
if((0,Uv.isSome)(l)){const e=new YY(zL)
let t
e.id=OE,t=new Y4(null,l,j(n,Hj)),e.items=[t],a.push(e)}a.push(c)
const u=new ZY(a)
return u.pageRefreshPolicy=Ur(e,o),jn(e,u,r),u}(e,t))}}class Y8 extends p2{constructor(){super("EditorialShelfRecommendationPageController")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Tq,wq,zV,JV,uV,aG,sU,iH]
return e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),t}pageType(){return eW}pageRoute(e){return[{protocol:pW,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${DW.shelfId}}`,query:[`${DW.editorialPageId}?`]},{protocol:pW,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${DW.shelfId}}`,query:[`${DW.editorialPageId}?`]},{protocol:pW,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-recommendation/{${DW.shelfId}}`,query:[`${DW.editorialPageId}?`]}]}generatePageRequest(e,t,n){const r=n[DW.shelfId],o=n[DW.editorialPageId]
if((0,Nv.isNothing)(r)||0===r.length||(0,Nv.isNothing)(o)||0===o.length)throw new Error(`Unable to map ${t.build()} to a media api url`)
const i=new Jz(e,t.toString())
return i.addingQuery(DW.editorialPageId,o),i}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([Jq]),gw(e,t)}async renderPage(e,t,n,r,o,i){return await Va("renderEditorialShelfRecommendationPage",async()=>{const n=yt(e,t)
if(!s(n))return null
const r=Un(e,DH,n.id,t),o=Nr(t),i=(_n(0,n),aw(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=pw(e,void 0,i)
let c
a.title=null,a.eyebrow=null,a.isHorizontal=!1,c=new Y4(null,j(n,Vj),j(n,Hj))
const l=new YY(zL)
l.id=OE,l.items=[c]
const u=new ZY([l,a])
return u.pageRefreshPolicy=Ur(e,o),jn(e,u,r),u})}}class J8{constructor(e){this.$kind="AppStoreEngagementTask",this.action=e}}class K8 extends dW{constructor(e,t){super(),this.$kind="EngagementToggleAction",this.actionClass="EngagementToggleAction",this.identifier=e,this.value=t}}class Z8 extends dW{constructor(e,t){super(),this.$kind="TabBadgeAction",this.actionClass="TabBadgeAction",this.navigationTab=e,this.text=t}}const Q8="com.apple.Arcade.ArcadeHardware1",X8="com.apple.Arcade.TrialEligible1",e7=[Q8,X8]
class t7{constructor(){this.$intentKind="EngagementEventIntent"}async perform(e,t){return await yw(t,e)}}class n7{constructor(){this.$intentKind="BadgingEventIntent"}async perform(e,t){return await Aw(t,e)}}class r7 extends h2{constructor(e,t){super("UserEngagementController"),t.exportingService("AppStoreEngagement",{fetchEngagementTask:async t=>await yw(e,t),fetchBadgingTask:async t=>await Aw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class o7 extends W9{constructor(){super("GroupingPageBuilder")}defaultPlatforms(e){return ee(e)}defaultAttributes(e){const t=[Tq,zV,JV,sU]
return e.bag.enableUpdatedAgeRatings&&t.push(iq),e.appleSilicon.isSupportEnabled&&t.push(hH),t}prepareRequest(e,t,n,r,o){if(function(e,t){t.includingAdditionalPlatforms(ee(e)),t.includingAgeRestrictions(),t.usingCustomAttributes(Ue(e)),t.includingMacOSCompatibleIOSAppsWhenSupported(),oi(e)&&(t.enablingFeature(MH),t.includingMetaKeys(vB,[E$,XL]),t.includingScopedAttributes(Vq,DK),t.includingScopedRelationships(Vq,[Mq])),Gi(e,Fj)&&Ai(t),ii(e)&&(t.enablingFeature(eM),yi(t)),si(e)&&(t.enablingFeature(mB),Ti(t)),t.enablingFeature("categoryHeaders"),t.enablingFeature(LE),e.bag.enableUpdatedAgeRatings&&t.includingAttributes([iq]),e.bag.enableFeaturedCategoriesOnGroupings&&t.enablingFeature(ub),e.bag.enableCategoryBricksOnGroupings&&t.enablingFeature("categoryBricks")}(e,t),n===Im.Page){const n=r.query.id
let o,i
const s=r.pathComponents();-1!==s.indexOf(eL)?o=n:-1!==s.indexOf(lH)?o=Ni(r):i=n,a(i)?t=t.withIdOfType(i,TV):a(o)&&(t=t.addingQuery(lH,o)),t.withSparseCount(Q(e)),t.includingScopedSparseLimit(vB,X(e))}const s=r.query[DW.context]||ne(e)
i(s)&&t.addingQuery(IG,s)
const c=r.query[DW.useReleaseId]
r.host===AW&&(null==c?void 0:c.length)>0&&(t.isStorePreviewRequest=!0,t=t.addingQuery(_I,c))}pageType(){return eW}pageRoute(e){return[{protocol:pW,path:`/${yW.store}/${yW.grouping}`,query:[DW.id,`${DW.context}?`]},{hostName:AW,path:`/WebObjects/{storePreviewInstance}/wa/${yW.grouping}`,query:[DW.id,`${DW.useReleaseId}?`]},{protocol:pW,path:`/{countryCode}/${yW.genre}/{genreName}/{id}`},{protocol:pW,path:`/{countryCode}/${yW.genre}/{id}`},{protocol:pW,path:`/{countryCode}/{platform}/${yW.grouping}/{id}`},{protocol:pW,path:`/${yW.store}/${yW.viewGenre}`,query:[DW.id]},{hostName:AW,path:`/WebObjects/{storePreviewInstance}/wa/${yW.viewGenre}`,query:[DW.id,`${DW.useReleaseId}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:pW,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:pW,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:pW,hostName:`${IW}`}]}generatePageRequest(e,t,n){var r
let o,s,c=t.query.id
if(t.host===IW&&(null===(r=e.bag.safariExtensionsGroupingURL)||void 0===r?void 0:r.length)>0){const n=qW.from(e.bag.safariExtensionsGroupingURL)
i(n)&&(c=Ni(n),t.query.id=c)}const l=t.pathComponents()
if(-1!==l.indexOf(eL)?o=c:-1!==l.indexOf(lH)?o=Ni(t):s=c,!a(s)&&!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
const u=function(e){const t=[Tq,wq,zV,JV,uV,aG,sU]
e.appleSilicon.isSupportEnabled&&t.push(hH),e.bag.enableUpdatedAgeRatings&&t.push(iq),Kd(e)&&t.push(sH)
const n=new Jz(e).forType(TV).includingAgeRestrictions().includingAttributes(t).includingRelationshipsForUpsell(!0)
return Gi(e,Fj)&&Ai(n),n}(e)
return u.attributingTo(t.build())}renderGroupingPage(e,t,n,o,i,s,a){return Bv.context(pb,()=>function(e,t,n){var o
if(n.pageGenreId=q(t.originalGroupingData,lH)||(r(o=j(t.originalGroupingData,"chartUrl"))?null:h(qW.from(o).query,lH)),al(e,t,n),"tv"!==e.client.deviceType&&e.client.deviceType!==AV){const t=ul(e,n.metricsPageInformation,n.metricsLocationTracker)
t&&n.shelves.push(t)}if(e.client.deviceType!==zq&&"tv"!==e.client.deviceType){const t=e.bag.termsAndConditionsURL
if(!r(t)){const r=dl(e,t)
n.shelves.push(r)}}const i=function(e,t,n){let r=null
switch(n){case PK.Apps:r=e.host.clientIdentifier===jz?e.loc.string("GROUPING_APPS"):e.loc.string("GROUPING_APP_STORE","App Store")
break
case PK.Discover:r=e.loc.string("GROUPING_DISCOVER")
break
default:r=Nd(0,t)}return r}(e,t.originalGroupingData,n.pageGenreId),s=new ZY(n.shelves)
switch(e.client.deviceType){case"tv":s.title=i
break
case zq:s.title=i,s.presentationOptions=[tM]
break
case AV:s.title=i,s.presentationOptions=[tM]
const e=s.shelves[0].contentType;[YG,db,yB].includes(e)&&s.presentationOptions.push(iN)
break
default:s.title=i,s.presentationOptions=[tM]}return n.shelves[0].contentType===C$&&(s.presentationOptions.push(VL),s.presentationOptions.push(QT),s.presentationOptions.push(iN)),s.pageRefreshPolicy=Ur(e,null==n?void 0:n.refreshController),jn(e,s,n.metricsPageInformation),function(e,t,n){if(!(t.shelves.length<=0))switch(n){case PK.Apps:t.shelves.splice(0,0,fl(0,"appsPageHeader")),t.shelves.splice(6,0,fl(0,"appsPageMid")),t.shelves.push(fl(0,"appsPageFooter"))
break
case PK.Games:t.shelves.splice(0,0,fl(0,"gamesPageHeader")),t.shelves.splice(6,0,fl(0,"gamesPageMid")),t.shelves.push(fl(0,"gamesPageFooter"))}}(0,s,n.pageGenreId),mp(s),s}(e,t,n))}}class i7 extends h2{constructor(){super(dP)}pageRoute(e){return[{protocol:hW,path:`${yW.onDeviceRecommendations}`,query:[DW.onDeviceRecommendationsUseCase,DW.token]}]}async handlePage(e,t,n,r,o){const i=n[DW.onDeviceRecommendationsUseCase]
return await hs(e,i,nW).then(r=>{const o=JSON.parse(n[DW.token]),i=new w2
i.title=o.title
const s=this.makePage(e,r.dataContainer,r.recoMetrics,i),a=new fY(eW,t.build())
return a.pageData=s,a})}makePage(e,t,n,r){const o=Ss(e)
r.url=this.paginationUrl,r.metricsPageInformation=Un(e,DH,"onDevicePersonalizationSeeAll",t),r.metricsPageInformation.recoMetricsData=hh(n,null,o),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const i=new YY(d2),s={id:null,kind:null,softwareType:null,targetType:KH,title:r.title,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:Xj,recoMetricsData:n}
Oh(e,i,s),gh(0,s,r.title),i.isHorizontal=!1,i.shouldFilterApps=r.shouldFilter
const a=At(t)
r.remainingContent=[],i.items=Rd(e,a,{contentUnavailable:(e,t)=>(r.remainingContent=It(0,a,e),!0),lockupOptions:{metricsOptions:{pageInformation:s.pageInformation,locationTracker:s.locationTracker},clientIdentifierOverride:r.clientIdentifierOverride,artworkUseCase:Hd(0,i.contentType)}})
const c=new ZY([i])
return c.title=r.title,r.remainingContent.length&&(c.nextPage=r),jn(e,c,r.metricsPageInformation),c}async handleShelf(e,t,n,r){throw new Error(qI)}shelfRoute(e){return[]}pageType(){return eW}}class s7{constructor(){this.$intentKind="InAppPurchaseInstallPageIntent"}async perform(e,t){return await Tw(t,e.url)}}class a7 extends h2{constructor(e,t){super("InAppPurchaseInstallController"),t.exportingService(WI,{fetchInstallPage:async t=>await Tw(e,t.url)})}async handlePage(e,t,n,r,o){const i=n[DW.id],s=n[_W],a=new Jz(e).withIdOfType(s,FH),c=await Ln(e,a,{}),l=function(e,t,n){const r={pageId:n||"",pageType:"IAPInstallPage",parentId:sh(t)}
return new BJ(r)}(0,i,s),u=yt(e,c)
let d
const f={metricsOptions:{pageInformation:l,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:n6.LockupIconSmall}
s&&u&&(d=Td(e,u,f),d.theme=kq)
const h=pe(e,u,Mq)
let p
i&&h&&(p=Ad(e,h,f))
const w=new pY
w.isComplete=!0,w.lockup=d,w.parentLockup=p
const g=wr(e,u)
return w.preInstallOfferDescription=qo(e,g),function(e,t,n){jn(e,t,n)}(e,w,l),h2.createFlowAction(w,KE,t)}pageRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.install}`,query:[`${DW.id}`,`${_W}?`]}]}pageType(){return KE}}class c7 extends h2{constructor(e,t){super("MetricsLinterController"),t.exportingService("Metrics",{async lintEvent(t){const n=hr(e).makeEvent(e,t.fields)
return await Promise.resolve(n)}})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class l7{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class u7{constructor(e,t){this.$kind="MSOAppsResponse",this.apps=e,this.appsToAlwaysShow=t}}class d7{constructor(){this.$intentKind="MSOProviderDataIntent"}async perform(e,t){return await bw(t,e.providerAdamId)}}class f7{constructor(){this.$intentKind="MSOPageIntent"}async perform(e,t){return await Sw(t,e)}}class h7 extends h2{constructor(e,t){super("MSOBuilder"),t.exportingService("MSOData",{fetchProviderData:async t=>await bw(e,t.providerAdamId),fetchPage:async t=>await Sw(e,t)})}async handlePage(e,t,n,r,o){const i=function(e){const t=e[NW]
return t?t.split(","):[]}(n),s=function(e,t){return Pw(e,Ni(t))}(e,t.removeParam(NW)),a=Cw(e,await Ln(e,s),i)
return h2.createFlowAction(a,pN,t)}pageRoute(e){return[{protocol:pW,path:`/{countryCode}/${yW.mso}/{appName}/{id}`,query:[`${NW}?`]},{protocol:pW,path:`/${yW.mso}/{providerName}/{id}`,query:[`${NW}?`]},{protocol:pW,path:`/{countryCode}/${yW.mso}/{id}`,query:[`${NW}?`]},{protocol:pW,path:`/${yW.mso}/{id}`,query:[`${NW}?`]},{protocol:pW,path:`/${yW.mso}`,query:[DW.id,`${NW}?`]},{protocol:pW,path:`{countryCode}/${yW.mso}`,query:[DW.id,`${NW}?`]}]}async handleShelf(e,t,n,r){const o=n[Wj],i=JSON.parse(o),s=new Jz(e,i.remainingContent).includingAdditionalPlatforms(ee(e)).includingAttributes([Tq,wq,uH])
return function(e,t,n){const r=At(t),o=n
o.remainingContent=[]
const i={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},artworkUseCase:Hd(0,n.preferredShelfContentType)},contentUnavailable:function(e,t){return o.remainingContent=It(0,o.remainingContent,e),o.remainingContent.push(r[e]),!1}},s=new YY(n.preferredShelfContentType)
return s.shouldFilterApps=n.shouldFilter,s.items=Rd(e,r,i),s.mergeWhenFetched=!0,s.url=Iw(o),s}(e,await Ln(e,s),i)}shelfRoute(e){return[{protocol:hW,path:`/${yW.mso}/${yW.shelf}/{token}`}]}pageType(){return pN}}class p7{constructor(){this.$intentKind="CancelPreorderIntent"}async perform(e,t){return await kw(t,e)}}class w7 extends h2{constructor(e,t){super("CancelPreorderController"),t.exportingService("Preorder",{cancelPreorder:async t=>await kw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class g7 extends p2{constructor(){super("AccessibilityDetailsBuilder")}defaultPlatforms(e){return[]}pageType(){return oB}pageRoute(e){return[{protocol:hW,path:`${yW.accessibilityDetails}/${yW.product}/{id}`,query:[`${DW.deviceFamily}`]},{protocol:hW,path:`${yW.accessibilityDetails}/${yW.productBundle}/{id}`,query:[`${DW.deviceFamily}`]}]}generatePageRequest(e,t,n){const r=Ni(t)
if((0,Uv.isNothing)(r)||Si(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
const o=function(e){switch(e[DW.deviceFamily]){case mq:return mq
case gq:return gq
case Yq:return Yq
case BG:return $B
case GV:return GV
case zq:return zq
default:return null}}(n)
if((0,Uv.isNothing)(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing required platform.`)
let i=Kq;(0,Uv.isSome)(t.pathname)&&-1!==t.pathname.indexOf(yW.productBundle)&&(i=xq)
const s=new Jz(e).withIdOfType(r,i).includingAttributes([oB,$V])
return s.platform=o,s}async renderPage(e,t,n,r){return await Va(mj,async()=>{const r=yt(e,t)
if((0,Uv.isNothing)(r))return null
const o=n[DW.deviceFamily]
if((0,Uv.isNothing)(o))return null
const i=Un(e,"AppAccessibilityDetails",r.id,t),s={rootPosition:0,locationStack:[]},a=[]
{const t=El(e,r,o,!0,null,i,s)
a.push(t)
const n=Dl(e,r,!0,i,s);(0,Uv.isSome)(n)&&a.push(n)
const c=Rl(e,r,o,!0,null,i,s);(0,Uv.isSome)(c)&&a.push(c)}const c=new ZY(a)
return c.title=e.loc.string(gD),c.presentationOptions=[WG,ux,QP],jn(e,c,i),c})}}class v7 extends p2{constructor(){super("EulaBuilder")}defaultPlatforms(e){return ee(e)}generatePageRequest(e,t,n){const o=t.query.resourceId,i=t.query.resourceType
if(r(o)||r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
const s=new Jz(e).withIdOfType(o,$U)
return s.targetResourceType=i,s}pageRoute(e){return[{protocol:hW,path:`${yW.eula}`}]}pageType(){return eW}async renderPage(e,t,n,r){return await Va(mj,async()=>{const n=f(t,"results.eula.text").split(/\n{1,2}/),r=[]
for(const e of n){const t=new AX(e)
t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,r.push(t)}const o=new YY(Pj)
o.isHorizontal=!1,o.items=r
const i=new ZY([o])
return i.title=e.loc.string(cF),i})}}class m7 extends h2{constructor(){super("PersonalizedReviewsBuilder")}async handlePage(e,t,n,r,o){throw new Error("PersonalizedReviewsBuilder:handlePage not implemented")}pageRoute(e){return[]}async handleShelf(e,t,n,r){const o=n[Wj],i=JSON.parse(o),s=new Jz(e).withIdOfType(i.adamId,bq)
try{const t=await Ln(e,s)
return ka(e,e.client.guid,i,t)}catch{return ka(e,e.client.guid,i)}}shelfRoute(e){return[{protocol:hW,path:`/${yW.personalizedReviews}/${yW.shelf}/{token}`}]}pageType(){return Dq}}class y7 extends p2{constructor(){super("PrivacyDetailBuilder")}defaultPlatforms(e){return ee(e)}pageType(){return ZR}pageRoute(e){return[{protocol:hW,path:`${yW.privacyDetail}/${yW.product}/{id}`,query:[`${DW.privacyTypeId}?`]},{protocol:hW,path:`${yW.privacyDetail}/${yW.productBundle}/{id}`,query:[`${DW.privacyTypeId}?`]}]}generatePageRequest(e,t,n){const r=Ni(t)
if((0,Uv.isNothing)(r)||0===r.length)throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
let o=Kq
const i=[v$,$V,jF]
return-1!==t.pathname.indexOf(yW.productBundle)&&(o=xq),new Jz(e).withIdOfType(r,o).addingQuery(Gx,i.join(","))}async renderPage(e,t,n,s){return await Va(mj,async()=>{const s=n[DW.privacyTypeId]
return function(e,t,n){return Bv.context("privacyDetailPageFromResponse",()=>{const s=yt(e,t)
if(o(s))return null
const a=Un(e,"PrivacyDetails",s.id,t),c={rootPosition:0,locationStack:[]}
let l=[]
if(!Al(e)){const t=function(e,t,n,r){const o=new YY(YH)
o.isHorizontal=!1
const i=Tl(e,t,!0,!0,n,r)
return o.items=[i],o.presentationHints={isFirstShelf:!0},o}(e,s,a,c)
i(t)&&l.push(t)}const u=function(e,t,n,s,a){const c=B(t,v$)
if(o(c))return[]
const l=hl(e,c,t,ej,!0,n,s)
if(0===l.length)return[]
const u=[]
for(const t of l)if(r(a)||t.identifier===a||e.client.deviceType!==zq){const e=new YY(QM)
i(t.identifier)&&t.identifier===a?(t.wantsScrollFocus=!0,e.id="privacyTypeShelf_"+t.identifier):t.wantsScrollFocus=!1,e.items=[t],e.presentationHints={isSingleDensity:!0},u.push(e)
for(const e of t.purposes){const t=new YY("privacyCategory")
t.title=e.title,t.items=e.categories,u.push(t)}}return u}(e,s,a,c,n)
l=l.concat(u)
const d=new ZY(l)
d.title=e.loc.string(KM)
for(const e of u)if((0,Uv.isSome)(e.id)){d.loadCompletedAction=new qY(e.id)
break}return jn(e,d,a),d})}(e,t,s)})}}class A7 extends h2{constructor(){super("ProductInAppPurchaseBuilder")}async handlePage(e,t,n,r,o){const i=n[LW],s=Bi(e,new qW(i)),a={},c=n[MW]===XH
a.spotlightSection=Fa(c),a.spotlightInAppProductIdentifier=n[DW.offerName]
const l=await Ln(e,s),u=await Yu(e,l,a)
return h2.createFlowAction(u,oH,t)}pageRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.lookup}`,query:[LW,DW.offerName,MW]}]}pageType(){return oH}}class T7{constructor(){this.$intentKind="ShelfBasedProductPageIntent"}async perform(e,t){return await Ow(t,e)}}class b7 extends p2{constructor(e,t){super(BA),t.exportingService(WI,{fetchPage:async t=>await async function(e,t){if(t.preloading&&Be(e))return await Promise.reject(new Error(zI))
if(0!==Mn(e,new qW(t.url)).length&&Jh(e,t.url),t.preloading){const e=new qW(t.url)
e.param(DW.isPreloading,XH),t.url=e.build()}const n=b7.generateProductPageOptions(e,void 0,new qW(t.url)),r=e.required(n3).fetchPage(e,t.url,GY)
if(!r){const r=new Jz(e,t.url),o=await Ln(e,r)
return await Yu(e,o,n,{},null,t.preloading)}return await r.then(n=>(e.host.clientIdentifier===zz?n&&nB in n&&zn(0,n):i(t.referrerData)&&n&&nB in n&&zn(0,n),n))}(e,t),fetchShelfBasedPage:async t=>await Ow(e,t)})}defaultPlatforms(e){return ee(e)}pageType(){return oH}defaultTab(e){return b7.representsArcadeApp(e)?qq:super.defaultTab(e)}defaultAction(e,t,n,r){if(ht(t))return t
const o=super.defaultAction(e,t,n,r)
if(!vt(t)&&!mt(t))return o
const i=1===t.appPlatforms.length&&"tv"===t.appPlatforms[0]
if(n[DW.action]!==Z6||i){if(n[DW.action]!==Q6||i)return o
{const e=t.shelfMapping[bq]||t.shelfMapping[gH]
let n=null
return e&&e.seeAllAction&&(n=e.seeAllAction,n.animationBehavior=qV),o.animationBehavior=qV,new MJ([o,n])}}{const n=b7.representsBundle(t)
let r=null,i=null,s=null,a=null
vt(t)?(r=t.adamId,i=t.icon,s=t.title,a=t.subtitle):mt(t)&&(r=t.lockup.adamId,i=t.lockup.icon,s=t.lockup.title,a=t.lockup.subtitle)
const c=Pa(e,r,n,i,!1,a,s)
return o.animationBehavior=qV,new MJ([o,c])}}static generateProductPageOptions(e,t,n){const r={clientIdentifierOverride:n.query[DW.clientIdentifierOverride]},o=null==t?void 0:t[DW.offerName]
if(o){const e=t[MW]===XH
r.spotlightSection=Fa(e),r.spotlightInAppProductIdentifier=o}const s=n.query[$J]
s&&(r.iAdClickFields=JSON.parse(s))
const a=n.query[FJ]
a&&(r.iAdLineItem=a)
const c=n.query[NJ];(0,Nv.isSome)(c)&&(r.iAdDismissAdActionMetrics=JSON.parse(c))
const l=n.query[$0]
i(l)&&(r.externalDeepLinkUrl=l)
const u=n.query[F0]
i(u)&&(r.isCppDeepLinkDisabled=JSON.parse(u))
const d=null==t?void 0:t[DW.webBrowser];(0,Nv.isSome)(d)&&(r.webBrowser="1"===d)
const f=null==t?void 0:t[DW.webBrowserFlowType]
return(0,Nv.isSome)(f)&&(r.webBrowserFlowType=f),e.client.isCompanionVisionApp&&(r.clientIdentifierOverride=mz),r}pageRoute(e){return qh()}generatePageRequest(e,t,n){var o
const i=n[DW.bundleIdentifier],s=n[DW.ids],a=n[DW.productVariantID],c="1"===n[DW.includeUnlistedApps]||"1"===n[DW.isViewOnly]
let l=null
if(i){const t=st(e).adamIdFromSystemBundleId(i)
l=(0,Nv.isSome)(t)?Ui(e,t,!1,void 0,!1,c):function(e,t,n,r){const o=MX
e.bag.enablePrivacyNutritionLabels&&!xi(e,t)&&o.push(p$),Ii(e)&&!Oi(e,t)&&o.push(w$),e.appleSilicon.isSupportEnabled&&o.push(hH),e.bag.enableUpdatedAgeRatings&&o.push(iq),Kd(e)&&o.push(sH),e.bag.enableLicenses&&o.push(HO)
const i=new Jz(e).forType(Kq).withFilter(oq,t).includingAdditionalPlatforms(ee(e)).includingRelationships([PH,vG,SF,bq,xq,h$,f$]).includingAttributes(o).addingRelationshipLimit(bq,te(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Uv.isSome)(n)&&i.addingQuery(DW.productVariantID,n),Kt(e,NH)&&i.enablingFeature(kL),r&&i.enablingFeature(IL),ii(e)?i.includingViews([GO]):i.includingRelationships([OL]),i}(e,i,a,c)}else if(n[DW.action]===YI&&s){const r=(null===(o=t.pathname)||void 0===o?void 0:o.length)>0&&-1!==t.pathname.indexOf(JI)
l=Ui(e,s,v(n,DW.isPurchasesApp),a,r,c)}else l=Bi(e,t,c)
if(r(l))throw new Error(`Unable to map ${t.build()} to a media api url`)
return l}generateAdditionalPageRequirements(e,t,n){const r=super.generateAdditionalPageRequirements(e,t,n),o=function(e){for(const[t,n]of Object.entries(e))if(t.toLocaleLowerCase()===DW.appEventId.toLocaleLowerCase())return n
return null}(n),i=n[DW.offerItemId]
if((null==o?void 0:o.length)>0&&oi(e)){const t=new Jz(e).withIdOfType(o,Vq).includingAdditionalPlatforms(ee(e)).includingScopedAttributes(Vq,DK).includingScopedAvailableIn(Vq,[wO,JO])
r[X6]=D(Ln(e,t))}else if(s(i)&&si(e)){const t=new Jz(e).withIdOfType(i,EV).includingAdditionalPlatforms(ee(e))
Ti(t),r[X6]=D(Ln(e,t))}return r}async renderPage(e,t,n,r,o,i){return await Va(mj,async()=>{const o=Un(e,mV,"",t),a=b7.generateProductPageOptions(e,n,new qW(o.pageUrl)),c=yt(e,t),l=b7.alternativeAppForPlatform(e,c,rt(e))
if(null!==l)return l
const u="1"===n[DW.isViewOnly]
s(i)&&oW.shared.setReferralDataForProduct(c.id,i)
const d=await Yu(e,t,a,r,i,v(n[DW.isPreloading]),u),f=e.fetchTimingMetricsBuilder
return(0,Nv.isSome)(f)&&f.decorate(d),d})}shelfRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.shelf}/{token}`}]}generateShelfRequest(e,t,n){return Wh(e,0,n)}async renderShelf(e,t,n){return await zh(e,t,n)}shelfRequiresAdditionalModification(e,t){return!0}async performAdditionalShelfModifications(e,t,n){const r=n[Wj],o=e3.fromJSON(e,r)
return new Set([pV,hU,eF]).has(t.contentType)&&0===t.items.length&&!o.isFirstRender&&(t.isHidden=!0),t}async handleShelfError(e,t){const n=t[Wj],r=e3.fromJSON(null,n)
if(r&&!r.hasExistingContent){const e=new YY(r.contentType)
return e.isHidden=!0,e}return await super.handleShelfError(e,t)}static alternativeAppForPlatform(e,t,n){if(!ie(t,n)){const r=we(t,f$)
if(s(r))for(const t of r){const r=Qe(e,t,Rq)
if(ie(t,n)&&(null==r?void 0:r.length)>0)return new fY(Dq,r)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Dj in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[Dj]===EM}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&Dj in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[IN]===nq}}class S7{constructor(e,t,n,r,o,i){this.$kind="GameCenterPlayerGameAchievementSummary",this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.completedText=r,this.action=o,this.achievements=i}}class P7 extends h2{async handlePage(e,t,n,r,o){throw new Error(`handlePage is not supported on: ${this.builderClass}`)}async renderPage(e,t,n){throw new Error(`renderPage is not supported on: ${this.builderClass}`)}async handleShelf(e,t,n,r){const o=await M(this.renderShelf(e,t,n))
return o.success?o.value:await this.handleShelfError(o.error,n)}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async handleShelfError(e,t){throw e}}class C7 extends P7{constructor(){super("ProductBuilderNative")}pageType(){return oH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.shelf}`,query:[DW.isGameCenterPlayerShelf,DW.token]},{protocol:hW,path:`/${yW.product}/${yW.shelf}`,query:[DW.isGameCenterPlayerRibbonItem]},{protocol:hW,path:`/${yW.product}/${yW.shelf}`,query:[DW.isGameCenterAchievementsShelf,DW.token]}]}async renderShelf(e,t,n){if(t.query[DW.isGameCenterPlayerShelf]){const r=t.query[DW.id],o=await e.gameCenter.fetchFriendsThatPlayGame(r),i=n[DW.token]
return vu(e,o,!0,e3.fromJSON(e,i))}if(t.query[DW.isGameCenterPlayerRibbonItem]){const n=t.query[DW.id],r=await e.gameCenter.fetchFriendsThatPlayGame(n)
return vu(e,r,!1)}if(t.query[DW.isGameCenterAchievementsShelf]){const r=t.query[DW.bundleId],o=await e.gameCenter.fetchAchievementSummaryForGame(r),i=n[DW.token],s=e3.fromJSON(e,i)
let a=null
if(o.length>0){const t=ro({objectGraph:e,target:{achievements:{bundleID:r}},metricsPageInformation:s.sourcePageInformation,metricsLocationTracker:s.sourceLocationTracker}),n=e.loc.string("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed"),i=o[0].achievements
let c=null
const l=i.filter(e=>e.status.type===gV)
if(l.length>0&&(c=l[0]),null===c){const e=i.filter(e=>e.status.type===Pb||e.status.type===cM)
e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(c=e[0])}null!==c&&(a=new S7(o[0].bundleId,o[0].completedAchievements,o[0].totalAchievements,n,t,[c]))}const c=function(e,t,n){const r=new YY(oC)
if(r.isHorizontal=!0,t){const o={pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:Cq,title:nj,id:"achievements_summary",idType:lq,softwareType:null,targetType:Cq,badges:{gameCenter:!0}}
Oh(e,r,o),Qs(e,t.action,o),r.items=[t]}return r.mergeWhenFetched=!0,r.batchGroup=hV,r.isHidden=0===r.items.length,r}(e,a,s)
return c}return await super.renderShelf(e,t,n)}}const I7="todayTabPersonalization",k7="OnDeviceRecommendationsTodayShelfController"
class O7{constructor(e){this.recommendations=e}storyData(e){var t
const n=this.recommendationForUseCase(e),r=null==n?void 0:n.candidate(Nq)
if(!(0,Nv.isNothing)(n)&&!(0,Nv.isNothing)(r))return null===(t=null==n?void 0:n.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===r.id)}storyGroupData(e){var t,n
const r=this.recommendationForUseCase(e),o=null==r?void 0:r.candidate(vj)
if((0,Nv.isNothing)(r)||(0,Nv.isNothing)(o))return
const i=null===(t=null==r?void 0:r.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===(null==o?void 0:o.id)),s=null===(n=null==r?void 0:r.dataContainer)||void 0===n?void 0:n.data.filter(e=>o.candidateIDs.includes(e.id))
return(0,Nv.isNothing)(i)||(0,Nv.isNothing)(s)?void 0:(i[tV]={associations:{recommendations:{data:s}}},i)}recommendationForUseCase(e){return this.recommendations.find(t=>t.useCase===e)}}class E7{constructor(e,t,n,r){this.useCase=e,this.candidates=t,this.recoMetrics=n,this.dataContainer=r}candidate(e){return this.candidates.find(t=>t.type===e)}}class R7{constructor(e,t,n,r){this.id=e,this.type=t,this.candidateIDs=n,this.data=r}}class D7 extends P7{constructor(){super("ProductPageShelfWithAdController")}pageType(){return oH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.shelf}/{token}`,query:[DW.isShelfWithAd,DW.shelfWithAdPlacementType]}]}async renderShelf(e,t,n){const r=n[DW.shelfWithAdPlacementType],o=t.query[DW.id],i=Ew(e,r,o).catch(()=>null),s=Wh(e,0,n)
s.attributingTo(t.build())
const a=Ln(e,s)
return await Promise.all([a,i]).then(async([t,r])=>await zh(e,t,n,r,!0))}}class _7 extends P7{constructor(){super("ProductPageSimilarItemsShelfRefreshController")}pageType(){return oH}pageRoute(e){return[]}shelfRoute(e){return[{protocol:hW,path:`/${yW.product}/${yW.shelf}/{token}`,query:[`${DW.shelfRefreshType}=${GW}`]}]}async renderShelf(e,t,n){const r=t.query[DW.id]
let o=Promise.resolve(null),i=!1
i=Kt(e,rH),i&&(o=Ew(e,rH,r).catch(()=>null))
const s=function(e,t){const n=[Tq,wq,uH]
return e.bag.enableUpdatedAgeRatings&&n.push(iq),Kd(e)&&n.push(sH),new Jz(e).withIdOfType(t,Ix).enablingFeature(tV).includingAdditionalPlatforms(ee(e)).includingAttributes(n).enablingFeature(kL)}(e,r)
s.attributingTo(t.build())
const a=Ln(e,s).catch(async()=>{const r=Wh(e,0,n)
return r.attributingTo(t.build()),await Ln(e,r)})
return await Promise.all([a,o]).then(async([t,r])=>await zh(e,t,n,r,i))}}class L7 extends h2{constructor(){super("ReviewsAdapterBuilder")}async handlePage(e,t,n,r,o){const i=Bi(e,t),s=await Ln(e,i),a=await Yu(e,s)
let c,l
if(zu(e)){const e=a
c=e.shelfMapping[gH],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}else{const e=a
c=e.shelfMapping[bq],l=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}const u=h2.createFlowAction(a,oH,t)
let d=null
return c&&c.seeAllAction&&!l&&(d=c.seeAllAction,d.animationBehavior=qV),d?(u.animationBehavior=qV,new MJ([u,d])):u}pageRoute(e){return[{protocol:pW,path:`/{countryCode}/${yW.product}/{appName}/{id}`,hash:UW},{protocol:pW,path:`/${yW.store}/${yW.viewReviews}`,query:[DW.id]}]}async handlePagination(e,t,n,r,o){const i=n[$W],s=n[FW],a=l(o.remainingContent),c=new Jz(e,o.nextHref).includingAdditionalPlatforms(ee(e)).addingQuery(xV,s),u=await Ln(e,c,{})
return _a(e,e.client.guid,i,a,u,!1,s)}paginationRoute(e){return[{protocol:hW,path:`/${yW.reviews}/${yW.shelf}/{adamId}/{sort}`}]}pageType(){return oH}}class M7 extends h2{constructor(){super("SortedReviewsBuilder")}async handlePage(e,t,n,r,o){const a=n[$W],c=n[FW],l=new Jz(e).withIdOfType(a,kx).includingAdditionalPlatforms(ee(e)).addingQuery(xV,c),u=await Ln(e,l,{}),d=n[DW.token]
let f=null
if(s(d))try{f=JSON.parse(d)}catch(e){}const h=_a(e,e.client.guid,a,[],u,!0,c,f)
return i(null==f?void 0:f.reviewActionsShelf)&&h.shelves.unshift(f.reviewActionsShelf),i(null==f?void 0:f.reviewSummaryShelf)&&h.shelves.unshift(f.reviewSummaryShelf),i(null==f?void 0:f.ratingsShelf)&&h.shelves.unshift(f.ratingsShelf),h2.createFlowAction(h,bq,t)}pageRoute(e){return[{protocol:hW,path:`/${yW.reviews}/{adamId}/{sort}`,query:[`${DW.token}?`]}]}pageType(){return bq}}class x7 extends v2{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t,n){return Vn(0,"accessory")}generatePageRequest(e,t,n){const r=[]
for(const e of Object.keys(t.query))e.startsWith("id")&&r.push(t.query[e])
return this.requestWithFilter(e,"deviceProtocol",r.join(","))}pageRoute(e){return[{query:[`${DW.action}=accessoryLookup`]}]}}class $7 extends h2{constructor(){super("CollectionDeepLinkingController")}pageType(){return eW}pageRoute(e){return[{protocol:pW,path:"{countryCode}/{tab}/recommendations",query:[`${DW.useCaseShort}`,`${DW.collectionId}?`,`${DW.seedId}?`]}]}async handlePage(e,t,n,r,o){const i=n[yW.tab],s=n[DW.useCaseShort],a=n[DW.collectionId],c=n[DW.seedId]
let l=new Jz(e).forType(gL).addingQuery(Zq,i).addingQuery("filter[recoUseCase]",s).includingRelationships([Jq]).includingAdditionalPlatforms(ee(e))
l.enablingFeature(LE),(null==a?void 0:a.length)>0&&(l=l.addingQuery(CV,a)),(null==c?void 0:c.length)>0&&(l=l.addingQuery(TA,c))
const u=await M(Ln(e,l))
if(!u.success)throw new Error(`CollectionDeeplinkingController: Failed to fetch Media API data for useCase: ${s}`)
const d=u.value,f=j(yt(e,d),x$),h=await((null==f?void 0:f.length)>0?this.makeODPPage(e,s,f,d):this.makeCollectionPage(e,s,d))
let p
const w=this.createTabChangeActionForRequest(i),g=new fY(eW,t.build())
return g.pageData=h,null!=w?(w.actions=[g],p=w):p=g,p}async makeODPPage(e,t,n,r){const o=new Promise((o,i)=>{hs(e,n,eW).then(n=>{const i=yt(e,r),s=new w2
s.title=j(i,Pq),s.metricsPageInformation=Un(e,DH,t,r),s.metricsPageInformation.recoMetricsData=hh(St(r),null,n.recoMetrics),s.shouldFilter=!1,s.metricsLocationTracker={rootPosition:0,locationStack:[]}
const a=this.makePage(e,s,n.dataContainer)
o(a)}).catch(e=>{i(e)})})
return await o}async makeCollectionPage(e,t,n){const r=yt(e,n),o=fe(r,Jq),i=new w2
return i.url=this.paginationUrl,i.title=j(r,Pq),i.metricsPageInformation=Un(e,DH,t,n),i.metricsPageInformation.recoMetricsData=St(n),i.shouldFilter=!1,i.metricsLocationTracker={rootPosition:0,locationStack:[]},await Promise.resolve(this.makePage(e,i,o))}makePage(e,t,n){return Bv.context("makePage",()=>{const r=t.preferredShelfContentType||d2,o=new YY(r),i={id:null,kind:null,softwareType:null,targetType:KH,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:Xj,recoMetricsData:St(n)}
Oh(e,o,i),gh(0,i,t.title),o.isHorizontal=!1,o.shouldFilterApps=t.shouldFilter
const s=At(n)
t.remainingContent=[],o.items=Rd(e,s,{contentUnavailable:(e,n)=>(t.remainingContent=It(0,s,e),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:Hd(0,r)}})
const a=new ZY([o])
return a.title=t.title,t.remainingContent.length&&(a.nextPage=t),a})}createTabChangeActionForRequest(e){const t=e
return new Set([_q,Kq,_H,aq,J_,qq,gG,XG,wF,gF,vF,VN,nH,xU]).has(t)?new cX(t):null}async handleShelf(e,t,n,r){throw new Error(qI)}shelfRoute(e){return[]}paginationRoute(e){return[{protocol:hW,path:`${this.paginationPath}`}]}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>{const n=o,r=new Jz(e,n.remainingContent)
if(!r)throw new Error(`Could not construct media API request for: ${t}`)
r.includingAdditionalPlatforms(ee(e))
const i=[Tq,wq,zV,JV]
e.appleSilicon.isSupportEnabled&&i.push(hH),e.bag.enableUpdatedAgeRatings&&i.push(iq),Kd(e)&&i.push(sH),r.includingAttributes(i),r.usingCustomAttributes(Ue(e)),r.attributingTo(t.build())
const s=await Ln(e,r)
return this.makePage(e,n,s)})}}class F7 extends g2{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t,n){const r=Ni(t),o=n[DW.grouping]
if(!this.isValidId(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
if(!this.isValidId(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing grouping.`)
return new Jz(e).withIdOfType(r,d$).addingQuery(Fj,o).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}async renderPage(e,t,n){return await Va(mj,async()=>{const r=yt(e,t),o=fe(r,Jq),i=n[DW.grouping],s=Un(e,DH,`${r.id}-${i}`,t),a=new w2
a.remainingContent=o.data,a.url=this.paginationUrl,a.shouldFilter=!H(r,M$),a.metricsPageInformation=s,a.metricsLocationTracker={rootPosition:0,locationStack:[]},a.title=j(r,Zq)
const c=await this.pageWithContent(e,o,a)
return c.title=a.title,jn(e,c,s),c})}pageRoute(e){return[{protocol:pW,path:`/{countryCode}/${yW.appsForYou}/{title}/{id}`,query:[DW.grouping]},{protocol:pW,path:`/{countryCode}/${yW.appsForYou}/{id}`,query:[DW.grouping]},{protocol:pW,path:`/${yW.appsForYou}/{title}/{id}`,query:[DW.grouping]},{protocol:pW,path:`/${yW.appsForYou}/{id}`,query:[DW.grouping]}]}isValidId(e){return!(r(e)||isNaN(e))}}class N7 extends g2{constructor(){super("RoomBuilder")}generatePageRequest(e,t,n){let r=t.query[DW.featuredContentId]
if(this.isValidRoomId(r)||(r=n.id),!this.isValidRoomId(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return new Jz(e).withIdOfType(t,_N).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,r)}prepareRequest(e,t,n,r,o){!function(e,t){t.includingAdditionalPlatforms(ee(e)).includingAttributes(rc(e)).usingCustomAttributes(Ue(e)).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,t)}async renderPage(e,t,n,r){return await Va(mj,async()=>{const n=yt(e,t),r=fe(n,Jq),o=Un(e,DH,n.id,t),i=new w2
i.remainingContent=r.data,i.url=this.paginationUrl,i.shouldFilter=!H(n,M$),i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=j(n,xj)
var a
i.preferredShelfContentType=null==(a=Number(s))?null:a===r0?uM:null,i.clientIdentifierOverride=Fr(e,n),i.title=j(n,Pq)
const c=await this.pageWithContent(e,r,i)
return c.title=i.title,jn(e,c,o),c})}pageRoute(e){return[{protocol:pW,path:`/${yW.store}/${yW.room}`,query:[DW.featuredContentId]},{protocol:pW,path:`/${yW.storeElements}/${yW.recommendationsSeeAll}`},{protocol:pW,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:pW,path:"/{countryCode}/collection/today-view-widgets",query:[DW.featuredContentId]},{protocol:pW,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return a(e)}}!function(e){e[e.Default=0]="Default",e[e.CategoriesAndCharts=1]="CategoriesAndCharts"}(Bm||(Bm={}))
class B7{constructor(e,t,n,r,o,i,s=null,a){this.id=e,this.title=t,this.searchLandingItemDisplayStyle=s,this.displayStyle=n,this.displayCount=r,this.hasSeeAll=o,this.seeAllLink=i,this.searchShelfKind=a}}!function(e){e[e.Landing=0]="Landing",e[e.Results=1]="Results",e[e.ChartsAndCategories=2]="ChartsAndCategories",e[e.Focus=3]="Focus"}(Um||(Um={})),function(e){e.Suggestion="Query",e.CategoriesAndCharts="EditorialLink",e.Apps="AppsLockup",e.EditorialCollection="EditorialCollection"}(Gm||(Gm={}))
class U7{constructor(){this.$kind="PageTab"}}class G7 extends dW{constructor(e,t,n){super(),this.$kind="PageTabChangeAction",this.actionClass="PageTabChangeAction",this.selectedTabId=e,this.title=t}}class j7 extends VY{constructor(){super(...arguments),this.$kind="SearchChartsAndCategoriesPage"}}class V7{constructor(){this.$kind="PageTabs",this.id=random.nextUUID()}}class H7{constructor(e,t,n,r,o,i,s,a,c){this.$kind="SearchChartOrCategory",this.title=e,this.artwork=t,this.collectionIcons=n,this.backgroundColor=r,this.badge=o,this.action=i,this.density=s,this.artworkSafeArea=a,this.textSafeArea=c}}class q7{constructor(){this.$intentKind="SearchChartsAndCategoriesPageIntent"}async perform(e,t){return await Uw(e,t)}}class W7 extends h2{constructor(e,t){super("SearchChartsAndCategoriesPageBuilder"),t.exportingService(AF,{fetchSearchChartsAndCategoriesPage:async t=>await Uw(t,e)})}pageType(){return WD}pageRoute(e){return[{path:"/{apiVersion}/recommendations/{countryCode}/search-recommendations/{search-recommendations-id}"}]}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{const n=new Jz(e,t.toString()).forType(Ox).includingAgeRestrictions().includingScopedRelationships(KI,[Jq]).enablingFeature(tV).enablingFeature(TF).addingQuery(DW.name,$F)
Gi(e,vx)&&Ai(n)
const r=await this.fetchCategoriesAndChartsPage(e,n)
return h2.createFlowAction(r,this.pageType(),t)})}async fetchCategoriesAndChartsPage(e,t){const n=Ln(e,t)
return await n.then(t=>$w(e,t))}}class z7 extends dW{constructor(e,t){super(),this.$kind="GuidedSearchTokenToggleAction",this.actionClass="GuidedSearchTokenToggleAction",this.targetToken=e,this.searchOrigin=t}}class Y7{constructor(e,t,n,r,o){this.$kind="GuidedSearchToken",this.value=e,this.isSelected=t,this.leadingIcon=n,this.displayName=r,this.clickAction=o}}class J7{constructor(e,t,n){this.$kind="GuidedSearchQuery",this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class K7 extends dW{constructor(e,t){super(),this.$kind="SearchEntityChangeAction",this.actionClass="SearchEntityChangeAction",this.entity=e,this.searchOrigin=t}}class Z7{constructor(e,t){this.$kind="SearchFacetSet",this.type=e,this.values=t}}class Q7{constructor(e,t,n=null){this.$kind="SearchFacetValue",this.name=e,this.value=t,this.isSelected=t===n}}const X7={AdvertsSearchResult:"AdvertsSearchResult",AppEventSearchResult:Xm,AppSearchResult:ey,BundleSearchResult:"BundleSearchResult",EditorialSearchResult:cy,GuidedSearchResult:"GuidedSearchResult",InAppPurchaseSearchResult:"InAppPurchaseSearchResult",SearchLockupCollection:"SearchLockupCollection"}
class eee{constructor(e){this.impressionMetrics=null,this.resultType=e,this.clickAction=void 0}}class tee extends eee{constructor(e,t){super(Lx),this.$kind="GuidedSearchResult",this.title=e,this.tokens=t}}class nee extends eee{constructor(e,t,n,r,o){super("lockupCollection"),this.$kind="SearchLockupCollection",this.heading=e,this.headingArtwork=o,this.title=t,this.items=n,this.detailAction=r}}const ree=0,oee=1
class iee extends eee{constructor(e){super(NU),this.$kind="InAppPurchaseSearchResult",this.lockup=e}}class see extends eee{constructor(e){super($k),this.$kind="BundleSearchResult",this.lockup=e}}class aee extends eee{constructor(e){super("content"),this.$kind="AppSearchResult",this.lockup=e}}class cee extends eee{constructor(e){super(Nk),this.$kind="EditorialSearchResult",this.title=e}}class lee extends eee{constructor(){super(FN),this.$kind="AppEventSearchResult"}}class uee extends eee{constructor(){super("advert"),this.$kind="AdvertsSearchResult",this.lockups=[],this.displaysScreenshots=!0,this.itemBackground="ad"}}const dee=[new class{canDisplay(e){return(0,Nv.isSome)(e.alignedRegionArtwork)||(0,Nv.isSome)(e.alignedRegionVideo)}get representativeDisplayStyle(){return fK}displayStyle(e,t,n){return(0,Nv.isSome)(t.alignedRegionArtwork)?fK:dK}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isLandscape())&&void 0!==r&&r}get representativeDisplayStyle(){return lK}displayStyle(e,t,n){return lK}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isPortrait())&&void 0!==r&&r}get representativeDisplayStyle(){return iK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=mg(e,n)
return 4===o&&r>=3?iK:3===o&&r>=2?sK:r>=1?aK:cK}},new class{canDisplay(e){return e.landscapeScreenshots.length>0}get representativeDisplayStyle(){return uK}displayStyle(e,t,n){return uK}},new class{canDisplay(e){return e.portraitScreenshots.length>0}get representativeDisplayStyle(){return tK}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=mg(e,n)
return 4===o&&r>=3?tK:3===o&&r>=2?nK:r>=1?rK:oK}},new class{canDisplay(e){return!0}get representativeDisplayStyle(){return hK}displayStyle(e,t,n){return hK}}],fee={NO_ORGANIC_RESULTS:"NOORGANIC",NORMAL:"NORMAL",DUPE_AD:"DUP"},hee=(e,t)=>{const n=e.isLandscape()
return n===t.isLandscape()?0:n?-1:1}
class pee{constructor(e,t,n=null){this.$kind="SearchResultsMessage",this.primaryText=e,this.secondaryText=t,this.messageClickAction=n}}class wee{constructor(e,t){this.$kind="SearchHintSet",this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new hY,this.pageRenderMetrics={}}}!function(e){e.visionOS="xros",e.iOS="ios"}(jm||(jm={}))
class gee extends MK{constructor(e=[]){super(),this.$kind="SearchResultsPage",this.shelves=[],this.shelves=e}}class vee{constructor(e,t){this.$kind="SearchResultsContextCard",this.message=e,this.action=t}}class mee{constructor(e){this.$kind="SearchResultsLearnMoreNotice",this.linkableText=e}}!function(e){e[e.EmptyResults=0]="EmptyResults",e[e.Picker=1]="Picker",e[e.NonNative=2]="NonNative"}(Vm||(Vm={}))
class yee{constructor(){this.$intentKind="SearchHintsIntent"}async perform(e,t){return await xg(t,e.term)}}class Aee extends h2{constructor(e,t){super("SearchHintsBuilder"),t.exportingService(AF,{fetchHints:async t=>await xg(e,t.term)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class Tee extends ZY{constructor(e){super(e,"SearchLandingPage")}}class bee extends ZY{constructor(e){super(e,"SearchFocusPage")}}!function(e){e.Chiclet="chiclet",e.App="app",e.Symbol="symbol"}(Hm||(Hm={}))
const See="word_cloud",Pee="horizontal"
class Cee extends dW{constructor(){super(...arguments),this.$kind="ClearSearchHistoryAction",this.actionClass="ClearSearchHistoryAction"}}class Iee{constructor(e,t,n,r){this.title=e,this.maxItems=t,this.shelfDisplayStyle=n,this.itemDisplayStyle=r}}class kee extends h2{constructor(){super("SearchLandingPageBuilder")}pageRoute(e){return[{protocol:hW,path:`${yW.searchLandingPage}`}]}shelfRoute(e){return[{protocol:hW,path:`${yW.searchLandingPage}/${yW.shelf}`,query:[DW.isOnDeviceSearchHistoryShelf]},{protocol:hW,path:`${yW.searchLandingPage}/${yW.shelf}`,query:[DW.isSearchFocusHeaderShelf]}]}pageType(){return eW}async handlePage(e,t,n,r,o){return await Va(`${this.builderClass}.handlePage`,async()=>{const n=await this.fetchPage(e)
return h2.createFlowAction(n,this.pageType(),t)})}async handleShelf(e,t,n,r){return await Va(`${this.builderClass}.handleShelf`,async()=>{var o,s,a
const c=v(null!==(o=n[DW.isOnDeviceSearchHistoryShelf])&&void 0!==o?o:t.query[DW.isOnDeviceSearchHistoryShelf]),l=c?function(e){if(!(0,Uv.isNothing)(e))return JSON.parse(decodeURIComponent(e))}(null!==(s=n[DW.token])&&void 0!==s?s:t.query[DW.token]):void 0,u=v(null!==(a=n[DW.isSearchFocusHeaderShelf])&&void 0!==a?a:t.query[DW.isSearchFocusHeaderShelf])
return c&&i(l)?await this.handleSearchHistoryShelfAsync(e,l):u?Jg(e):await super.handleShelf(e,t,n,r)})}handleSearchHistoryShelf(e,t,n,r){e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems).then(n=>{const r=Gn(e,IM,kM," ")
return gh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:r_,pageInformation:r},t.title),$g(e,t,r,{rootPosition:0,locationStack:[]},n)}).then(n,r)}async handleSearchHistoryShelfAsync(e,t){const n=await e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems),r=Gn(e,IM,kM," ")
return gh(0,{locationTracker:{rootPosition:0,locationStack:[]},id:r_,pageInformation:r},t.title),$g(e,t,r,{rootPosition:0,locationStack:[]},n)}async fetchPage(e){return await async function(e){const t=Kt(e,oV)?Ew(e,oV).catch(()=>null):null
return await async function(e,t){return function(e){return!e.bag.supportsSearchLandingPageV2||!ar(e,e.bag.searchLandingPageV2RolloutRate)}(e)?await async function(e,t){const n=new Jz(e).forType(lF).includingAgeRestrictions().includingAdditionalPlatforms(ee(e)).usingCustomAttributes(Ue(e))
n.targetResourceType=TV
const r=cc(e,e.user.dsid);(null==r?void 0:r.length)>0&&n.addingQuery(xD,r)
const s=new Cm.FetchTimingMetricsBuilder,a=e.addingFetchTimingMetricsBuilder(s),c=Ln(a,n)
return await Promise.all([c,t]).then(([e,t])=>s.measureModelConstruction(()=>function(e,t,n){var r
const s=l(t,FC)[0]
if(o(s))return null
if(!de(s,UG))return null
const a=j(s,"id"),c=Un(e,ME,s.id,t),u=Ss(e)
c.recoMetricsData=hh(c.recoMetricsData,null,u),c.adPageInfo=dn(e,oV,n),null===(r=c.adPageInfo)||void 0===r||r.recordAdResponseEventsIfNeeded(e,n,uF,0)
const d={shelves:[],metricsPageInformation:c,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:a,pageGenreId:q(s,lH),hasAuthenticatedUser:i(e.user.dsid),isSearchLandingPage:!0,adStitcher:Ka(e,n)}
al(e,ll(e,s),d)
const f=new Tee(d.shelves),h=new TZ(NC,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null)
return f.pageRefreshPolicy=h,jn(e,f,d.metricsPageInformation),f}(a,e,t)))}(e,t):e.bag.mediaAPISearchFocusEnabled?await async function(e,t){const n=zg(e).enablingFeature("search-focus-suggestions"),r=new Cm.FetchTimingMetricsBuilder,i=e.addingFetchTimingMetricsBuilder(r),s=Ln(i,n),a=e.amsEngagement
let c=null
if(a&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:mK,tab:aq}
c=a.performRequest(e)}return await Promise.all([s,t,c]).then(async([e,t,n])=>await r.measureModelConstructionAsync(async()=>await async function(e,t,n,r){const i=Yg(e,t,n,r)
return await async function(e,t){var n
if(o(t.data))return null
const r=Un(e,IM,kM,t," "),i=Ss(e)
r.recoMetricsData=hh(r.recoMetricsData,null,i)
const s={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:r,pageType:Um.Focus},a=function(e,t,n){const r=e.data
if(o(r))return null
for(const e of r){if(o(e))continue
const r=p(e,tV)
if(Bg(null==r?void 0:r.category)===t.pageType&&n===j(e,x$))return e}return null}(t,s,BC)
if((0,Uv.isNothing)(a))return Kg(e,t,s)
const c=null!==(n=q(a,iM))&&void 0!==n?n:0,l=e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(c)
return await l.then(n=>(s.searchHistory=n,Kg(e,t,s)))}(e,t).then(e=>(i.searchFocusPage=e,i))}(i,e,t,n)))}(e,t):await async function(e,t){const n=zg(e),r=new Cm.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r),i=Ln(o,n),s=e.amsEngagement
let a
if(s&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:mK,tab:aq}
a=s.performRequest(e)}return await Promise.all([i,t,a]).then(([e,t,n])=>r.measureModelConstruction(()=>Yg(o,e,t,n)))}(e,t)}(e,t).catch(async n=>{if((0,Uv.isSome)(e.bag.trendingSearchesURL))return await async function(e,t){const n={url:e.bag.trendingSearchesURL},r=e.network.fetch(n).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${n.url}`)
return JSON.parse(e.body)})
return await Promise.all([r,t]).then(([t,n])=>{var r
const o=new Tee(function(e,t){return Bv.context("trendingSearchesShelfForResponse",()=>{const n={rootPosition:0,locationStack:[]},r=l(t,"trendingSearches").map(t=>{const r=f(t,$H),o=new B4(r,r,f(t,Rq),kB)
return e.client.isPhone&&(o.artwork=Ot(e,R$)),ta(e,o,Qq,n),bh(n),o})
let o=0
switch(e.client.deviceType){case $q:o=10
break
case jq:o=7}const i=new YY(UH)
return i.title=r.length>0?f(t,"header.label"):null,i.isHorizontal=!1,i.items=r.slice(0,o),[i]})}(e,t)),i=Gn(e,pG,kB,"")
return i.adPageInfo=dn(e,oV,n),null===(r=i.adPageInfo)||void 0===r||r.setMissedOpportunity(e,iA,uF,0),jn(e,o,i),o})}(e,t)
throw n})}(e)}}const{routes:Oee,makeCanonicalUrl:Eee}=uc(function(e){return function(e){const{platform:t,...n}=e
return{...n,platform:ut(t),$kind:_k}}({...e,origin:"userText"})},"/{platform}/search",[jU])
class Ree{constructor(){this.$intentKind=_k,this.routes=Oee}async perform(e,t){return t.client.isWeb&&!e.platform&&(e.platform=mq),await function(e,t,n){return n(e.addingActiveIntent({previewPlatform:t.platform}))}(t,e,async t=>{const n=await Zg(t,e)
return(0,Nv.isNothing)(n.canonicalURL)&&(n.canonicalURL=Eee(t,e)),n})}actionFor(e,t){const n=new fY(aq)
return n.destination=e,n.pageUrl=Eee(t,e),n}}class Dee{constructor(){this.$intentKind="SearchResultsPageMoreIntent"}async perform(e,t){return await Qg(t,e.pageToken)}}class _ee extends h2{constructor(e,t){super("SearchResultsBuilder"),t.exportingService(AF,{fetchResults:async t=>await async function(e,t){const n=new Cm.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await kp(r,t)
return null===o?Rg(r,t.facets):await async function(e,t){return await _g(e,t)}(r,o)}(e,t),fetchMoreResults:async t=>await async function(e,t){return await async function(e,t){return await Bv.context("paginatedSearchResultsWithToken",async()=>{const n=Ig(0,t),r=kg(0,t)
return 0===n.length?await Promise.resolve(Rg(e)):await Op(e,n).then(async n=>{const o=At(n)
return await Sg(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(e=>{const t=new xK
return t.results=e.builtSearchResults,t.nextPage=r,t})})})}(e,t)}(e,t.pageToken),fetchSearchResultsPage:async t=>await Zg(e,t),fetchMoreOfSearchResultsPage:async t=>await Qg(e,t.pageToken)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class Lee{constructor(){this.$intentKind="ArticlePageIntent"}async perform(e,t){return await t.required(n3).fetchPage(t,e.url,d4)}}class Mee extends h2{constructor(e,t){super("ArticleBuilder"),t.exportingService(QI,{fetchArticle:async t=>await e.required(n3).fetchPage(e,t.url,d4)})}async handlePage(e,t,n,c,l){const u=new Cm.FetchTimingMetricsBuilder,d=e.addingFetchTimingMetricsBuilder(u),h=JSON.parse(f(t.query,DW.recoMetrics)),p=function(e,t,n){const r=t.pathComponents()
if(r.indexOf(UU)<0&&r.indexOf(sj)<0&&r.indexOf(QA)<0&&t.host!==CW&&t.host!==OW&&t.host!==EW)throw new Error(`Unable to map ${t.build()} to a media api url`)
let o
if(o=t.host===CW?e.packageProperties.asString("spamBlockingExtensionsEditorialItemID"):t.host===OW?e.bag.sharePlayAppsEditorialItemId:t.host===EW?e.bag.buddyOnboardingEditorialItemId:Ni(t),!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
if(!a(o))throw new Error(`Unable to map ${t} to a media api url`)
const i=function(e,t,n){const r=new Jz(e).withIdOfType(t.id,Nq).includingAdditionalPlatforms(ee(e)).includingAttributes(function(e){const t=[$j,hj,JV,uH,Tq,wq,zG,S$,lB]
return e.bag.enableUpdatedAgeRatings&&t.push(iq),e.appleSilicon.isSupportEnabled&&t.push(hH),Kd(e)&&t.push(sH),t}(e)).includingRelationships([aN]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ue(e))
return(0,Nv.isNothing)(n)&&r.includingAgeRestrictions(),oi(e)&&(r.enablingFeature(MH),r.includingScopedAttributes(Vq,DK),r.includingScopedRelationships(Vq,[Mq]),r.includingScopedRelationships(ZA,[Vq]),r.includingScopedAvailableIn(Vq,[wO])),si(e)&&(r.enablingFeature(mB),r.includingScopedRelationships(EV,[zB]),r.includingAssociateKeys(Nq,[qj]),r.includingMetaKeys(HA,[qA]),r.includingScopedAttributes(EV,[Pq,vH,NF,fL])),r}(e,bi({...Di(e),id:o}),n),c=t.query[DW.editorialCardId]
s(c)&&i.withFilter("canvas:cardId",c)
const l=t.query[DW.preview]
return RW.has(t.host)&&(null==l?void 0:l.length)>0&&(i.addingQuery(XA,l),i.isStorePreviewRequest=!0),i.attributingTo(t.build())}(e,t,l),w=await Ln(d,p),g=await async function(e,t){return await sc(e,t,Wc,zc)}(e,w),v=new D4
v.todayShelfRecoMetricsData=h,v.showingFallbackMediaInline=Boolean(n[DW.showingFallbackMedia]),v.additionalData=g.additionalData
const y=f(t.query,DW.todayCardConfig);(null==y?void 0:y.length)>0&&(v.todayCardConfig=JSON.parse(y)),v.allowUnpublishedAppEventPreviews=(0,Nv.isSome)(n[DW.preview]),v.isResilientDeepLink=e.deepLinks.hasResilientDeepLinks(),e.client.isCompanionVisionApp&&(v.clientIdentifierOverride=mz)
const T=u.measureModelConstruction(()=>function(e,t,n){return Bv.context("articlePageWithResponse",()=>{var s
const a=yt(e,t)
n.metricsPageInformation=Un(e,sj,a.id,t),n.metricsLocationTracker={rootPosition:0,locationStack:[]},n.pageId=a.id
const c=new bZ(n.metricsPageInformation,n.metricsLocationTracker,n.refreshController),l=function(e,t){if(!i(t))return null
if((0,Nv.isSome)(t.todayCardConfig))return t.todayCardConfig
const n={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!1,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
switch(n.clientIdentifierOverride=t.clientIdentifierOverride,n.useOTDTextStyle=!1,n.allowUnpublishedAppEventPreviews=t.allowUnpublishedAppEventPreviews,n.currentRowIndex=void 0,e.client.deviceType){case Yq:n.prevailingCropCodes={defaultCrop:"en"},n.coercedCollectionTodayCardDisplayStyle=wm.Grid,n.heroDisplayContext=Tm.Article
break
case"tv":n.prevailingCropCodes={defaultCrop:"ek","editorialArtwork.storyCenteredStatic16x9":"SCS.ApDHXL01"},n.coercedCollectionTodayCardDisplayStyle=wm.Grid,n.heroDisplayContext=Tm.Article
break
case AV:n.coercedCollectionTodayCardDisplayStyle=wm.River,n.prevailingCropCodes={defaultCrop:"sr","editorialArtwork.dayCard":"grav.west"}}return n}(e,n)
let u=bo(e,a,l,c)
const d=null==u?void 0:u.media;(0,Nv.isNothing)(u)&&(u=null)
const h=null!==(s=null==u?void 0:u.title)&&void 0!==s?s:void 0,p=j(a,fH)
n.crossLinkSubtitle=Bo(e,a),n.clientIdentifierOverride=l.clientIdentifierOverride,gh(0,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:cq,id:n.pageId,idType:lq},h)
const w=function(e,t,n,r){return Bv.context("renderArticle",()=>{var o
const s=[],a=null!==(o=we(t,aN))&&void 0!==o?o:[]
for(const n of a){r.module=j(n,XC),r.subStyle=null,s.length
const o=Jc(e,n,t,r)
if(o.length>0)for(const e of o)e.title=r.titleForNextShelf,s.push(e),r.titleForNextShelf=null
r.index++,bh(r.metricsLocationTracker)}if(r.showingFallbackMediaInline&&0===s.length){const e=function(e,t){if(A(n=t)&&n[tW]===Ay||function(e){return A(e)&&e[tW]===by}(t)){const e=new YY(dq)
return e.items=t.lockups,e}var n
return null}(0,n)
i(e)&&s.push(e)}return s})}(e,a,d,n),g=w[w.length-1],v=n.isResilientDeepLink||p===x_?null:function(e,t,n){const s=Kc(0,t)
let a=null
const c=Uf(e,t,Zq),l=Uf(e,t,Uj)
if(c&&l&&(a=e.loc.string("ShareSheet.TitleSubtitle.Format","{title}: {subtitle}").replace(SU,c).replace(YP,l)),!a&&c&&(a=c),!a&&l&&(a=l),!a&&s){const n=j(s,Zq),r=j(t,AN)
switch(r){case wm.GameOfTheDay:a=e.loc.string("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(SU,n)
break
case wm.AppOfTheDay:a=e.loc.string("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(SU,n)
break
default:e.console.log(`No title for article with unknown style: ${r}`)}}const u=j(t,Rq)
let d
switch(j(t,AN)){case wm.Grid:case wm.List:case wm.River:d=Ot(e,"resource://ShareCollectionThumbnail",40,40)
break
default:d=null}const f=function(e,t,n,o,s,a){return r(a)?null:Bv.context("shareSheetDataForArticle",()=>{let r=s;(0,Nv.isNothing)(r)&&(0,Nv.isSome)(a)&&(r=function(e,t){const n=Io(t)
{const r=No(e,t,Tm.Article,n)
if(i(r))return r}return Do(e,B(t,Ro(0,n)),void 0)}(e,a))
const o=e.loc.string("ShareSheet.Story.Subtitle"),c=new JK(a.id,t,o,r)
return new KK(c,n,null)})}(e,a,u,0,d,t)
if(!i(f))return null
const h=function(e,t,n,r){const s=[]
if((null==t?void 0:t.length)>0){const n=Go(e,t)
i(n)&&s.push(n)}if((null==n?void 0:n.length)>0){const t=Go(e,n,"Copy Card Preview Link")
i(t)&&s.push(t)}if((0,Nv.isSome)(r)){let t
e.featureFlags.isGSEUIEnabled(yJ)&&e.featureFlags.isEnabled(XY)&&(t=function(e,t){if(o(e))return
const n=new PY(e)
return n.title=t,new YK("com.apple.AppStore.openInGameCenterActivity",n)}(`games:///story/id${r}`,e.loc.string("ShareSheet.OpenInGameCenter.Title"))),i(t)&&s.push(t)}return s}(e,u,function(e,t,n){if((0,Nv.isNothing)(t))return null
switch(e.client.buildType){case RG:case WU:const e=new qW
return e.protocol=pW,e.host=MU,e.pathname=`/${yW.todayCardPreview}`,e.param(DW.ids,`${t}`),e.param(DW.isTodayFeedPreview,XH),e.param(DW.isTodaySection,n.useOTDTextStyle?XH:kF),decodeURIComponent(e.build())
default:return null}}(e,t.id,n),t.id)
return new LK(f,h)}(e,a,l)
if(i(v)){Qs(e,v,{targetType:Qq,id:n.pageId,actionType:qN,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})
const t=function(e,t,n){if(t&&n){const e=t.items.length
if(e>0&&-1!==_4.indexOf(n)){const n=t.items[e-1]
switch(t.contentType){case c_:case wx:return n&&n.isFullWidth
default:return!0}}}return!1}(0,g,n.module),r=function(e,t,n,r){if(!i(t)||e.client.isCompanionVisionApp)return null
const o=new f4(qN,e.loc.string("SHARE_STORY"),!r,t),s=new YY("roundedButton")
return s.items=[o],s}(e,v,0,t)
r&&w.push(r)}const y=new d4(u,w,v)
if(y.editorialStoryCard=null,y.title=null==u?void 0:u.title,y.subtitle=null==u?void 0:u.inlineDescription,function(e,t,n,r){const o=Kc(0,n)
if(o){const i=na(0,n)
return void(t.footerLockup=function(e,t,n,r){return Ad(e,t,{offerStyle:Zc(e),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:r,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:n6.Default,canDisplayArcadeOfferButton:Yf(0,dq)})}(e,o,r,i))}const s=H(n,l_)
if(i(r.additionalData)&&s){const o=co(e,n)
t.arcadeFooterLockup=function(e,t,n){return Od(e,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},pt(sj),TH,null)}(e,o,r)}}(e,y,a,n),y.shouldTerminateOnClose=n.isResilientDeepLink,jn(e,y,n.metricsPageInformation,e=>{let t=h
var n
if(A(n=null==u?void 0:u.media)&&n[tW]===yy&&function(e){return $r(e)&&e[tW]===gy}(null==u?void 0:u.overlay)&&(t=(null==u?void 0:u.overlay).lockup.title),!t)return
let r=f(m(e[bU]),CH)
r=r||f(m(e[MG])),e[bU]=r?`${r}_${t}`:`unknown_${t}`}),y.canonicalURL=j(a,Rq),(0,Nv.isSome)(a)){const e=j(a,Rq);(0,Nv.isSome)(e)&&(y.viewArticleAction=new PY(e,!0))}return y})}(d,g.originalData,v)),b=h2.createFlowAction(T,cq,t)
{const e=new cX(_q)
return e.actions=[b],e}}pageRoute(e){return[{protocol:pW,path:`/{countryCode}/${yW.editorialItem}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/{countryCode}/${yW.editorialItem}/{seoSlug}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/{countryCode}/${yW.story}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/{countryCode}/{platform}/${yW.story}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/{countryCode}/${yW.story}/{seoSlug}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/${yW.story}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/${yW.story}/{seoSlug}/{id}`,query:[`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:`/${yW.store}/${yW.viewEditorialItem}`,query:[DW.id,`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[DW.id,`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[DW.id,`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[DW.id,`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[DW.id,`${DW.showingFallbackMedia}?`,`${DW.preview}?`,`${DW.todayCardConfig}?`]},{protocol:pW,hostName:`${CW}`},{protocol:hW,path:`/${yW.story}/{id}`,query:[`${DW.metrics}?`,`${DW.invalidateWidgetsOnFailure}?`]},{protocol:pW,hostName:`${OW}`},{protocol:pW,hostName:`${EW}`}]}pageType(){return cq}}qm=e(1415)
class xee{constructor(e,t,n,r,o,i){this.$kind="TodayPage",this.shelves=e,this.title=n,this.titleDetail=o,this.shortTitleDetail=i,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new hY,this.pageRenderMetrics={}}}!function(e){e.OnboardingCards="onboardingCards",e.Ads="ads",e.ODP="ODP",e.AMDData="amdData"}(Wm||(Wm={}))
class $ee extends h2{constructor(){super("TodayCardPreviewBuilder")}pageType(){return _q}pageRoute(e){return[{protocol:pW,path:`/${yW.todayCardPreview}`,query:[`${DW.ids}?`,`${DW.isTodaySection}?`,`${DW.isTodayFeedPreview}?`,`${DW.preview}?`,`${DW.experimentId}?`,`${DW.fetchData}?`]}]}async handlePage(e,t,n,r,i){return await Va(`${this.builderClass}.pageHandler`,async()=>{var r
const i=new fY(this.pageType())
if(i.pageUrl=t.build(),!v(n[DW.fetchData]))return i
const a=null===(r=n[DW.experimentId])||void 0===r?void 0:r.split(","),c=n[DW.ids]
if(s(a)&&o(c)){const t={}
for(const e of a){const n=e.split(":")[0],r=e.split(":")[1]
t[n]=r}const n=s(t)?JSON.stringify(t):void 0,r=await nv(e,{experimentIdHeader:n,url:"",onboardingCardIds:[]})
return i.pageData=r,i}{const n=rv(e,this.createFlattenedTodayItemsFromUrl(t),$ee.emptyTodayPageResponse,null,null)
return i.pageData=n,i}})}createFlattenedTodayItemsFromUrl(e){const t=[],n=f(e.query[DW.ids]),r=(0,Nv.isSome)(e.query[DW.isTodayFeedPreview])&&v(e.query[DW.isTodayFeedPreview]),o=(0,Nv.isSome)(e.query[DW.isTodaySection])&&v(e.query[DW.isTodaySection])
if(!s(n))return t
const i=n.match(/([a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?:\[[^\]]+\]|[a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?)/g)
let a=r,c=0
for(const e of i){const n=e.split(":")[0],r=$ee.storyGroupIdRegex.exec(e)
if((0,Nv.isSome)(r)){const e=r[1].split(",").map(e=>this.createUnhydratedEditorialItemFromId(e,o))
t.push({type:Pm.EditorialItemGroup,data:{id:n,type:vj,relationships:{},meta:{associations:{recommendations:{data:e}}}},isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...$ee.previewModuleData},containedAdSlots:Array.from({length:e.length},(e,t)=>t+c)}),a=!1,c+=e.length}else t.push({type:Pm.EditorialItem,data:this.createUnhydratedEditorialItemFromId(e,o),isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...$ee.previewModuleData},containedAdSlots:[c]}),a=!1,c+=1}return t}createUnhydratedEditorialItemFromId(e,t){const n=e.split(":")[0],r=e.split(":")[1],o=(0,Nv.isSome)(r)?{"editorial-cards":{data:[{id:`${n}-${r}`,type:qj}]}}:{}
return{id:n,type:Nq,relationships:{},meta:{personalizationData:{isOfTheDay:t},associations:o}}}}$ee.storyGroupIdRegex=/\[(.*)\]/,$ee.previewModuleData={label:XI,title:"Today Preview",meta:{},isTodayForAppsModule:!1},$ee.emptyTodayPageResponse={results:{data:[]}}
class Fee{constructor(){this.$intentKind="TodayPageIntent"}async perform(e,t){const n=e.isRunningPPTs?JSON.stringify({NyCxKBD:"client-perf"}):void 0
return await nv(t,{url:e.url,onboardingCardIds:e.onboardingCardIds,experimentIdHeader:n})}}class Nee{constructor(){this.$intentKind="TodayPageMoreIntent"}async perform(e,t){const n=e.pageToken
return cv(t,n.pageInformation),await iv(t,n),ov(t,n)}}class Bee extends h2{constructor(e,t){super("TodayPageBuilder"),t.exportingService(QI,{fetchPage:async t=>await nv(e,{url:t.url,onboardingCardIds:t.onboardingCardIds}),async fetchMoreOfPage(t){const n=t.pageToken
return cv(e,n.pageInformation),await iv(e,n),ov(e,n)}})}defaultTab(e){return _q}pageType(){return _q}pageRoute(e){return[]}async handlePage(e,t,n,r,o){throw new Error("handlePage not implemented for TodayBuilder")}}class Uee{constructor(e,t,n,r){this.$kind="TopChartSegment",this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new hY,this.pageRenderMetrics={}}}class Gee{constructor(e,t,n,r,o,i,s){this.genreId=e,this.ageBandId=t,this.title=n,this.segments=r,this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0,this.$kind=null!=s?s:Cy}}class jee extends SK{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.$kind="TopChartCategory",this.shortName=this.name,this.longName=this.name,this.url=t}}class Vee{constructor(){this.$intentKind="TopChartsPageIntent"}async perform(e,t){return await hv(t,e.url)}}class Hee{constructor(){this.$intentKind="TopChartsPageMoreIntent"}async perform(e,t){return await pv(t,e.pageToken)}}class qee extends h2{constructor(e,t){super("TopChartsBuilder"),t.exportingService("TopChartData",{fetchPage:async t=>await hv(e,t.url),fetchMoreOfSegment:async t=>await pv(e,t.pageToken)})}pageRoute(e){return wv()}async handlePage(e,t,n,i,a){const c=n[DW.isPPT]
t.removeParam(DW.isPPT)
let l=t.query[DW.chart],u=n[DW.genre]
o(u)&&(u=f(e.bag.defaultChart,"genre-id"),o(l)&&(l=f(e.bag.defaultChart,"chart-id")))
let d=n[DW.charts]
if(o(d)){const e=fc(0,l)
d=void 0!==e?`${l},${e}`:l}else d.includes(l)||(d+=`,${l}`)
const h=hc(e,u,d,n[DW.ages])
let p
p=pc(e,d,u)
const[w,g]=await Promise.all([h,p]),v=Tn(e,g)
let m,y
if(m=uv(e,w,u,v,l,r(v)?mn(u):yn(v)),y=eG,c&&s(m.segments)){const t=m.segments[0],n=t.nextPage,r=Pt(0,n)
if(s(r)){const o=new Jz(e,r),i=await Ln(e,o),s=Ct(0,n)
s.remainingContent=[],s.maxPerPage=0
const a=gv(e,i,n,s),c=t.shelves.concat(a.shelves),l=new Uee(t.shortName,t.longName,t.chart,c)
l.pageMetrics=t.pageMetrics,l.nextPage=null,m.segments[0]=l}}return h2.createFlowAction(m,y,t)}pageType(){return eG}async handlePagination(e,t,n,r,o){return await Va(`${this.builderClass}.handlePagination`,async()=>function(e){var t,n
const r=new ZY(e.shelves)
return r.title=null!==(t=e.longName)&&void 0!==t?t:e.shortName,r.pageMetrics=e.pageMetrics,r.pageRenderMetrics=e.pageRenderMetrics,s(null===(n=null==e?void 0:e.nextPage)||void 0===n?void 0:n.remainingContent)&&(r.nextPage=e.nextPage),r}(await pv(e,o)))}}class Wee{constructor(e,t,n,r){this.$kind="TodayWidgetContainerTemplate",this.collections=e,this.refreshDate=t,this.originalResponseDate=n,this.originalResponseHash=r}}class zee{constructor(e,t){this.$kind="TodayWidgetCardCollectionTemplate",this.cards=e,this.displayDate=t}}class Yee{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.$kind="WidgetTodayCardTemplate",this.storyId=e,this.heading=t,this.title=n,this.backgroundColor=r,this.isDark=o,this.iconArtwork=i,this.url=s,this.eventBadgeKind=l,this.editorialArtwork=c,this.isVideoArtwork=a,this.eventStartDate=u,this.eventEndDate=d}}class Jee{make(e){const t=new Jz(e).forType(this.typeForUseCase()).withIdsOfType(this.ids(),this.typeForUseCase()).addingContext(this.context()).includingAttributes(this.attributesForUseCase()).asPartialResponseLimitedToFields(this.fieldsForRequest()).withSparseCount(this.sparseCountForUseCase()).withSparseLimit(this.sparseLimitForUseCase()).enablingFeature(this.enablingFeature(e)).usingCustomAttributes(this.shouldUseCustomAttributes(e)),n=this.addingQuery()
if(null!==n)for(const e of n)t.addingQuery(e.key,e.value)
return t}}class Kee extends Jee{context(){return lR}typeForUseCase(){return _q}attributesForUseCase(){return[Tq,wq,uH]}sparseCountForUseCase(){return null}sparseLimitForUseCase(){return null}addingQuery(){return null}ids(){return[]}fieldsForRequest(){return[zD,Hq,Kx,AN,tE,dH,nS,Tq,zb,dV,wq,Jx,"id",ZB,fH,$H,yq,uH,Zq,nE,Yx]}enablingFeature(e){return oi(e)?MH:null}shouldUseCustomAttributes(e){return Ue(e)}}class Zee{constructor(){this.$intentKind="WidgetIntent"}async perform(e,t){const n=e.widgetKind
if(n===mI)return await Iv(t,e)
throw Error(`Invalid widgetKind of '${n}'`)}}class Qee extends h2{constructor(e,t){super("WidgetController"),t.exportingService("WidgetData",{fetchTodayWidget:async t=>await Iv(e,t)})}async handlePage(e,t,n,r,o){throw new Error(rV)}pageRoute(e){return[]}pageType(){return Dq}}class Xee{constructor(){this.$intentKind="MetricsFieldLintingIntent"}async perform(e,t){const n=hr(t).makeEvent(t,y(e.fields))
return await Promise.resolve(n)}}class ete{constructor(){this.$intentKind="AppUpdateLockupsIntent"}async perform(e,t){const n=this.createUpdateLockups(t,e.appUpdateMetadata)
return await Promise.resolve(n)}createUpdateLockups(e,t){const n={lockupOptions:{metricsOptions:{pageInformation:Gn(e,qx,"Updates",""),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:n6.LockupIconSmall}}
return this.updatesLockupsFromData(e,t,n)}updatesLockupsFromData(e,t,n){return Bv.context("updatesLockupsFromData",()=>{const a=[]
return null==t||t.forEach((t,c)=>{var l
const u=t.updateMetadata
if(r(u.attributes))return void(n.contentUnavailable&&n.contentUnavailable(c,u))
const d=n.lockupOptions
let h=Wv.All
if(i(n.filter)&&(h=n.filter),at(e,u,h))return
const p=function(e){return e?{...e,isValid:e.isValid,$kind:N_}:null}(Ad(e,u,d))
if(r(p)||!p.isValid())return
const w=se(u,nt(e,u),"latestVersionInfo"),g=f(w,PD),v=f(w,YB)
p.releaseDate=new Date(v),p.installDate=t.updateInstallDate
const m=t.isUpdateAvailable||t.isUpdating?p.releaseDate:p.installDate
let y=this.timeAgoStringForDate(e,m)
o(y)&&(y=e.loc.string("UPDATES_VERSION_FORMAT").replace("{updateVersion}",g)),s(y)&&(p.subtitle=y)
const A=f(w,gC);(0,Nv.isSome)(A)&&(p.whatsNew=new AX(A.trim())),p.version=g,p.size=null===(l=Pf(e,u))||void 0===l?void 0:l.fileSizeByDevice,p.externalVersionId=tt(e,u,pD),a.push(p),bh(n.lockupOptions.metricsOptions.locationTracker)}),a})}timeAgoStringForDate(e,t){if((0,Nv.isNothing)(t))return
const n=(new Date).getTime()-t.getTime(),r=Math.floor(n/864e5)
switch(r){case 0:return e.loc.string("LOCKUPS_TODAY")
case 1:return e.loc.string("LOCKUPS_YESTERDAY")
case 2:case 3:return e.loc.string("LOCKUPS_DAYS_AGO_FORMAT").replace("{daysAgo}",r.toString())
default:const n=ax
return e.loc.formatDate(n,t)}}}zm=e(5881)
class tte{constructor(){this.dispatcher=new zm.IntentDispatcher}register(e){this.dispatcher.register(e)}async dispatch(e,t){const n=await this.createIntentObjectGraphWithAsyncValues(t)
return await this.dispatcher.dispatch(e,n)}controller(e){return this.dispatcher.controller(e)}get registeredControllers(){return this.dispatcher.registeredControllers}async createIntentObjectGraphWithAsyncValues(e){const t=new rY,n=new qJ,r=new qJ(HJ)
let o
if(e instanceof b3){let i=e
i=i.addingBag(i.bag.underlyingBag),await t.loadTreatments(i),await n.loadValues(i,[Yv.client,Yv.user]),e.bag.personalizationUserIdEnabled&&await r.loadValues(e,[Yv.user]),i.clientCapabilities.isEnabled(gR)&&i.bag.metricsPaymentNamespaceEnabled&&(o=new qJ(jJ),await o.loadValues(i,[Yv.client,Yv.user])),e=i}return e.adding(rY.metatype,t).adding(qJ.defaultMetatype,n).adding(qJ.paymentMetatype,o||n).adding(qJ.personalizationMetatype,r)}}class nte extends Fv.LegacyRuntime{constructor(e,t){super(e,t,{})}exportingService(e,t){this.wrapServiceInValidation(t)
const n={...this.serviceWithName(e)||{},...t}
return super.exportingService(e,n)}exportingServiceName(e,t,n){const r={}
r[t]=n,this.exportingService(e,r)}wrapServiceInValidation(e){for(const t of Object.keys(e)){const n=e[t]
n instanceof Function&&(e[t]=function(...e){const t=n.apply(this,e)
return t instanceof Promise?t.then(e=>(Bv.recordValidationIncidents(e),e)):(Bv.recordValidationIncidents(t),t)})}}}(0,Fv.exportBootstrap)(function(e){const[t,n]=function(){const e=new r3,t=function(e,t,n){var r,o
const i=function(e,t,n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,C,I,k,O,E,R,D,_,L,M,x,$,F){return e.configureDefaults(n,r,o,i,s,a,c,l,u,d,f,h,p,w,g,v,m,y,A,T,b,S,P,C,I,k,O,E,R,D,_,L,M,x,$,F).adding(n3,t)}(new b3("app-store"),e,bag,cryptography,host,net,platform,plist,random,services,cookieProvider,console,ask.storeMetrics,ask.amsEngagement,ask.loc,ask.adsLoc,ask.device,ask.client,ask.props,ask.user,ask.player,ask.metricsIdentifiers,ask.clientOrdering,ask.arcade,ask.gameCenter,ask.resilientDeepLinks,ask.appleSilicon,ask.storage,ask.ads,ask.onDeviceRecommendationsManager,ask.onDeviceSearchHistoryManager,null!==(r=ask.featureFlags)&&void 0!==r?r:{isEnabled:()=>!1,isGSEUIEnabled:()=>!1},null!==(o=ask.clientCapabilities)&&void 0!==o?o:{isEnabled:()=>!1},mediaToken,ask.appDistribution,ask.timeoutManager,ask.treatmentStore,ask.userDefaults)
return oW.createSharedMetricsReferralContext(i),i}(e),n=new tte,r=new nte(n,t)
return function(e,t){const n=e.required(n3)
t.exportingService(NA,{fetchGeneric:async t=>await n.fetchPage(e,t.url,ZY),fetchMoreOfGeneric:async t=>await n.fetchMoreOfPage(e,t.pageToken),fetchShelves:async t=>await n.fetchShelves(e,t.requests),fetchAction:async t=>await Kh(e,t)})}(t,r),e.registerPageBuilder(t,new Bee(t,r)),e.registerPageBuilder(t,new Mee(t,r)),e.registerPageBuilder(t,new $ee),e.registerPageBuilder(t,new qee(t,r)),e.registerShelfBuilder(t,new $2),e.registerShelfBuilder(t,new B2),e.registerShelfBuilder(t,new j2),e.registerShelfBuilder(t,new z4),e.registerShelfBuilder(t,new V2),e.registerShelfBuilder(t,new H4),e.registerShelfBuilder(t,new q2),e.registerShelfBuilder(t,new z2),e.registerShelfBuilder(t,new J2),e.registerShelfBuilder(t,new Z2),e.registerShelfBuilder(t,new M2),e.registerShelfBuilder(t,new n4),e.registerShelfBuilder(t,new a4),e.registerShelfBuilder(t,new M4),e.registerShelfBuilder(t,new x4),e.registerShelfBuilder(t,new F4),e.registerShelfBuilder(t,new U4),e.registerShelfBuilder(t,new G4),e.registerShelfBuilder(t,new j4),e.registerShelfBuilder(t,new W4),e.registerPageBuilder(t,new i7),e.registerPageBuilder(t,new Y9(t,r)),e.registerPageBuilder(t,new U9(t,r)),e.registerPageBuilder(t,new i8(t,r)),e.registerPageBuilder(t,new c9),e.registerPageBuilder(t,new V9(t,r)),e.registerPageBuilder(t,new t8(t,r)),e.registerPageBuilder(t,new n8),e.registerPageBuilder(t,new X3),e.registerPageBuilder(t,new a9(t,r)),e.registerShelfBuilder(t,new x2),e.registerPageBuilder(t,new G8),e.registerPageBuilder(t,new z8),e.registerPageBuilder(t,new Y8),e.registerPageBuilder(t,new o7),e.registerPageBuilder(t,new C7),e.registerPageBuilder(t,new D7),e.registerPageBuilder(t,new _7),e.registerPageBuilder(t,new b7(t,r)),e.registerPageBuilder(t,new A7),e.registerPageBuilder(t,new L7),e.registerPageBuilder(t,new M7),e.registerPageBuilder(t,new m7),e.registerPageBuilder(t,new v7),e.registerPageBuilder(t,new y7),e.registerPageBuilder(t,new g7),e.registerPageBuilder(t,new kee),e.registerPageBuilder(t,new W7(t,r)),e.registerPageBuilder(t,new _ee(t,r)),e.registerPageBuilder(t,new Aee(t,r)),e.registerPageBuilder(t,new N8),e.registerPageBuilder(t,new B8),e.registerPageBuilder(t,new U8),e.registerPageBuilder(t,new D3(t,r)),e.registerPageBuilder(t,new q3(t,r)),e.registerPageBuilder(t,new _3),e.registerPageBuilder(t,new K3),e.registerPageBuilder(t,new L3),e.registerPageBuilder(t,new J3),e.registerPageBuilder(t,new W3),e.registerPageBuilder(t,new z3),e.registerPageBuilder(t,new Y3),e.registerPageBuilder(t,new E8),e.registerPageBuilder(t,new R8),e.registerPageBuilder(t,new C8),e.registerPageBuilder(t,new P8),e.registerPageBuilder(t,new y8),e.registerPageBuilder(t,new I8),e.registerPageBuilder(t,new D8),e.registerPageBuilder(t,new A8),e.registerPageBuilder(t,new b8),e.registerPageBuilder(t,new k8),e.registerPageBuilder(t,new S8),e.registerPageBuilder(t,new O8),e.registerPageBuilder(t,new h7(t,r)),e.registerPageBuilder(t,new a7(t,r)),e.registerPageBuilder(t,new N7),e.registerPageBuilder(t,new F7),e.registerPageBuilder(t,new x7),e.registerPageBuilder(t,new $7),e.registerPageBuilder(t,new r7(t,r)),e.registerPageBuilder(t,new Qee(t,r)),e.registerPageBuilder(t,new Q3(t,r)),e.registerPageBuilder(t,new c7(t,r)),e.registerPageBuilder(t,new u8(t,r)),e.registerPageBuilder(t,new g8(t,r)),e.registerPageBuilder(t,new a8(t,r)),e.registerPageBuilder(t,new w7(t,r)),e.registerPageBuilder(t,new m8(t,r)),[n,r]}()
return t.register(new R3),t.register(new k3),t.register(new ete),t.register(new z9),t.register(new N9),t.register(new B9),t.register(new j9),t.register(new s8),t.register(new o8),t.register(new e8),t.register(new i9),t.register(new s9),t.register(new Lee),t.register(new n7),t.register(new w8),t.register(new p7),t.register(new t7),t.register(new V3),t.register(new P3),t.register(new C3),t.register(new v8),t.register(new s7),t.register(new Xee),t.register(new f7),t.register(new d7),t.register(new H3),t.register(new l8),t.register(new h8),t.register(new p8),t.register(new yee),t.register(new Ree),t.register(new Dee),t.register(new q7),t.register(new T7),t.register(new I3),t.register(new Fee),t.register(new Nee),t.register(new Vee),t.register(new Hee),t.register(new Z3),t.register(new Zee),n})})()})()

//# sourceMappingURL=main.js.map