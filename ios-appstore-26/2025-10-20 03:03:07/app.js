(()=>{function e(r){var o,i=n[r]
return void 0!==i?i.exports:(o=n[r]={exports:{}},t[r].call(o.exports,o,o.exports,e),o.exports)}var t={172:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7691),t)},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.demoteByEngagements=void 0,t.demoteByEngagements=function(e,t){return[...e]}},2305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3756:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3745:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2305),t),o(n(3756),t)},7691:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3745),t),o(n(230),t)},9100:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4908),t)},6451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LazyProxyFactory=void 0,t.LazyProxyFactory=class{static makeProxy(e,t){const r=new n(t),o={get:(t,n,o)=>{if(void 0===r.createRealObjectIfNeeded(e))return
const i=r.realObject[n]
return"function"==typeof i?i.bind(r.realObject):i},set:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.set(r.realObject,n,o,r.realObject),has:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.has(r.realObject,n),deleteProperty:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.deleteProperty(r.realObject,n),ownKeys:t=>void 0===r.createRealObjectIfNeeded(e)?[]:Reflect.ownKeys(r.realObject),getOwnPropertyDescriptor:(t,n)=>{if(void 0!==r.createRealObjectIfNeeded(e))return Reflect.getOwnPropertyDescriptor(r.realObject,n)},defineProperty:(t,n,o)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.defineProperty(r.realObject,n,o),preventExtensions:t=>void 0!==r.createRealObjectIfNeeded(e)&&(Reflect.preventExtensions(r),Reflect.preventExtensions(r.realObject)),isExtensible:t=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.isExtensible(r.realObject),getPrototypeOf:t=>void 0===r.createRealObjectIfNeeded(e)?null:Reflect.getPrototypeOf(r.realObject),setPrototypeOf:(t,n)=>void 0!==r.createRealObjectIfNeeded(e)&&Reflect.setPrototypeOf(r.realObject,n)}
return new Proxy(r,o)}}
class n{constructor(e){this.lazyProvider=e}createRealObjectIfNeeded(e){return void 0===this.realObject&&(this.realObject=this.lazyProvider.lazyDependencyFor(e)),this.realObject}}},4908:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.ObjectGraph=void 0
const r=n(2450)
t.ObjectGraph=class{constructor(e){this._members={},this.name=e}adding(e,t){const n=this.clone()
return n._members[e.name]=t,n}removing(e){const t=this.clone()
return delete t._members[e.name],t}optional(e){return this._members[e.name]}required(e){const t=this._members[e.name]
if((0,r.isNothing)(t)){const t=Object.keys(this._members).sort().join(", ")
throw new Error(`No member with type ${e.name} found in ${this.name}. Candidates ${t}`)}return t}clone(){const e=new(0,this.constructor)(this.name)
for(const[t,n]of Object.entries(this._members))e._members[t]=n
return e}},t.inject=function(e,t){return t.required(e)}},9089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBaseActionProvider=void 0
const r=n(2450)
t.isBaseActionProvider=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.actionFor)}},129:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(9089),t)},8770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntentDispatcher=void 0
const r=n(2450),o=n(4395),i=n(3907),s=n(1222)
t.IntentDispatcher=class{constructor(){this.dispatchableMap={}}register(e){if((0,r.isNothing)(e.$intentKind))throw new Error("Dispatcher cannot register a controller without an $intentKind")
if(e.$intentKind in this.dispatchableMap)throw new Error(`Dispatcher already has a controller registered for ${e.$intentKind}`)
this.dispatchableMap[e.$intentKind]=e}async dispatch(e,t){if("$static"===e.$kind){const t=Reflect.get(e,"$data")
if((0,r.isNothing)(t))throw new Error("StaticIntent<R> contains no data")
return t}const n=this.dispatchableMap[e.$kind]
if((0,r.isNothing)(n)||!(0,o.isIntentController)(n))throw new Error(`No controller registered to handle ${e.$kind}`)
const a=e.$pageIntentInstrumentation,c=t.optional(s.net)
if((0,r.isSome)(a)&&(0,r.isSome)(c)){const r=new i.ProxiedNetwork(c,a),o=t.adding(s.net,r)
return await n.perform(e,o)}return await n.perform(e,t)}controller(e){return this.dispatchableMap[e.$kind]}get registeredControllers(){return Object.values(this.dispatchableMap)}}},8346:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4395),t),o(n(3421),t),o(n(8770),t),o(n(867),t)},4395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIntentController=void 0
const r=n(2450)
t.isIntentController=function(e){return"object"==typeof e&&(0,r.isSome)(null==e?void 0:e.perform)}},867:(e,t)=>{function n(e){return{$kind:"$static",$data:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Continuous=t.makeSidepackedIntent=t.makeStaticContinuousIntentsOf=t.makeStaticIntent=void 0,t.makeStaticIntent=n,t.makeStaticContinuousIntentsOf=function(e){const t=new Array
for(const o of e)t.push(n(r.of(o)))
return t},t.makeSidepackedIntent=function(e,t){return{$kind:"$sidepacked",$initial:e,$intent:t}}
class r{static of(e){return new r(new o(e))}static contentsOf(e){return new r(e)}constructor(e){this.base=e,this.$wrappedField="base"}toJSON(){if(this.base instanceof o)return this.base.toJSON()
throw new TypeError("Continuous was not created with a single element")}async*[Symbol.asyncIterator](){yield*this.base}}t.Continuous=r
class o{constructor(e){this.element=e,this.$wrappedField="element"}toJSON(){return this.element}async*[Symbol.asyncIterator](){yield this.element}}},5881:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(8346),t),o(n(129),t)},5542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(5827),t),o(n(8037),t),o(n(1777),t),o(n(1415),t),o(n(7312),t)},1777:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1077),t),o(n(4172),t)},6418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.valueAsNumber=t.valueAsString=t.valueAsBoolean=void 0
const r=n(2450),o=n(4172)
t.valueAsBoolean=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("boolean"==typeof e)return e
if("string"==typeof e){if("true"===e)return!0
if("false"===e)return!1}const i=Boolean(e)
switch(t){case"strict":o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)})
break
case"coercible":if((0,r.isNothing)(i))return o.context("asBoolean",()=>{o.unexpectedType("coercedValue","boolean",e,n)}),null}return i},t.valueAsString=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("string"==typeof e)return e
const i="object"==typeof e?null:String(e)
switch(t){case"strict":o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})
break
case"coercible":(0,r.isNothing)(i)&&o.context("asString",()=>{o.unexpectedType("coercedValue","string",e,n)})}return i},t.valueAsNumber=function(e,t="coercible",n){if(!(0,r.isSome)(e))return e
if("number"==typeof e)return e
const i=Number(e)
switch(t){case"strict":o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)})
break
case"coercible":if(isNaN(i))return o.context("asNumber",()=>{o.unexpectedType("coercedValue","number",e,n)}),null}return i}},1077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4409),t),o(n(2506),t),o(n(6418),t)},2506:(e,t,n)=>{function r(e){if(Array.isArray(e))return e
switch(typeof e){case"string":{const t=i[e]
if((0,o.isSome)(t))return t
{const t=Object.freeze(e.split("."))
return i[e]=t,t}}case"number":case"symbol":return[e]
default:throw new TypeError(`${e.toString()} is not a KeyPath`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.keyPathContains=t.keyPathEndsWith=t.keyPathStartsWith=t.keyPathsEqual=t.isKeyPathThis=t.thisKeyPath=t.keysOf=void 0
const o=n(2450),i={}
t.keysOf=r,t.thisKeyPath=Object.freeze([]),t.isKeyPathThis=function(e){return Array.isArray(e)&&0===e.length},t.keyPathsEqual=function(e,t){if(e===t)return!0
const n=r(e),o=r(t)
if(n.length!==o.length)return!1
for(let e=0,t=n.length;e<t;e+=1)if(n[e]!==o[e])return!1
return!0},t.keyPathStartsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[0]===t}},t.keyPathEndsWith=function(e,t){if(e===t)return!0
{const n=r(e)
return 0!==n.length&&n[n.length-1]===t}},t.keyPathContains=function(e,t){return e===t||r(e).includes(t)}},6853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectCursor=void 0
const r=n(2450),o=n(2879),i=n(2506),s=n(7454)
t.ObjectCursor=class{constructor(e){this.values=[e],this.keyPaths=[i.thisKeyPath],this.savedDepths=[]}get currentValue(){return this.values[this.values.length-1]}get currentKeyPath(){return this.keyPaths[this.keyPaths.length-1]}interject(e,t){this.values.push(e),this.keyPaths.push(t)}reuse(e,t=i.thisKeyPath){this.values.length=0,this.values.push(e),this.keyPaths.length=0,this.keyPaths.push(t),this.savedDepths.length=0}moveTo(e){const t=(0,s.traverse)(this.currentValue,e)
return this.values.push(t),this.keyPaths.push(e),t}moveBack(){const e=this.values.length
if(1===e)throw new Error("Cannot move back past the root of a cursor")
const t=this.savedDepths.length
if(t>0&&e<=this.savedDepths[t-1])throw new Error("Cannot move back past the most recent saved state")
this.values.pop(),this.keyPaths.pop()}saveState(){this.savedDepths.push(this.values.length)}restoreState(){const e=this.savedDepths.pop()
if((0,r.isNothing)(e))throw new Error("Calls to restoreState must balance previous calls to saveState")
this.values.length=e,this.keyPaths.length=e}clone(){const e=(0,o.shallowCloneOf)(this)
return e.values=this.values.slice(),e.keyPaths=this.keyPaths.slice(),e.savedDepths=this.savedDepths.slice(),e}}},4409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectReader=void 0
const r=n(2450),o=n(2879),i=n(6418),s=n(2506),a=n(6853),c=n(7454),l=new Map
class u{constructor(e){this._cursor=new a.ObjectCursor(e)}get currentKeyPath(){return this._cursor.currentKeyPath}has(e){return(0,s.keyPathEndsWith)(this._cursor.currentKeyPath,e)||(0,r.isSome)(this.get(e))}select(e,t=!1){return!t&&(0,s.keyPathsEqual)(this._cursor.currentKeyPath,e)||this._cursor.moveTo(e),this}deselect(){return this._cursor.moveBack(),this}saveSelection(){return this._cursor.saveState(),this}restoreSelection(){return this._cursor.restoreState(),this}get(e=s.thisKeyPath){return(0,s.isKeyPathThis)(e)?this._cursor.currentValue:(0,c.traverse)(this._cursor.currentValue,e)}asBoolean(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsBoolean)(this.get(e),t,String(e))}asNumber(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsNumber)(this.get(e),t,String(e))}asString(e=s.thisKeyPath,t="coercible"){return(0,i.valueAsString)(this.get(e),t,String(e))}*[Symbol.iterator](){const e=this.get()
if((0,r.isNothing)(e))return
const t=u._clone(this)
if(Array.isArray(e)){let n=0
for(const r of e)t.saveSelection(),t._cursor.interject(r,n),yield t,t.restoreSelection(),n+=1}else yield t
u._recycle(t)}reduce(e,t){const n=this.get()
if((0,r.isNothing)(n))return e
if(!Array.isArray(n))return t(e,this)
try{let r=e
for(let e=0,o=n.length;e<o;e+=1)this.saveSelection(),this._cursor.interject(n[e],e),r=t(r,this),this.restoreSelection()
return r}catch(e){throw this.restoreSelection(),e}}map(e){return this.reduce(new Array,(t,n)=>(t.push(e(n)),t))}compactMap(e){return this.reduce(new Array,(t,n)=>{const o=e(n)
return(0,r.isSome)(o)&&t.push(o),t})}applyTo(e,...t){this.saveSelection()
try{const n=e(this,...t)
return this.restoreSelection(),n}catch(e){throw this.restoreSelection(),e}}callOn(e,t,...n){this.saveSelection()
try{const r=e.call(t,this,...n)
return this.restoreSelection(),r}catch(e){throw this.restoreSelection(),e}}clone(){const e=(0,o.shallowCloneOf)(this)
return e._cursor=this._cursor.clone(),e}static optimizeIterationUpToDepth(e){for(let t=0;t<e;t+=1)u._recycle(new u(void 0))}static _clone(e){const t=l.get(e.constructor)
if((0,r.isSome)(t)){const n=t.pop()
if((0,r.isSome)(n))return n.onReuseToIterate(e),n}return e.clone()}onReuseToIterate(e){const t=e._cursor
this._cursor.reuse(t.currentValue,t.currentKeyPath)}static _recycle(e){const t=e.constructor,n=l.get(t)
if((0,r.isSome)(n)){if(n.length>=5)return
e.onRecycleForIteration(),n.push(e)}else e.onRecycleForIteration(),l.set(t,[e])}onRecycleForIteration(){this._cursor.reuse(void 0)}}t.ObjectReader=u},7454:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.traverse=void 0
const r=n(2450),o=n(2506)
t.traverse=function(e,t){if("object"!=typeof e)return e
if(!(0,r.isSome)(e))return e
const n=(0,o.keysOf)(t)
switch(n.length){case 0:return e
case 1:return e[n[0]]
default:let t=e
for(const e of n){const n=t[e]
if("object"!=typeof n)return n
if(!(0,r.isSome)(n))return n
t=n}return t}}},4172:(e,t,n)=>{function r(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function o(e,t,n,o){u({type:"badType",expected:t,actual:`${r(n)} (${n})`,objectPath:(0,d.isSome)(o)&&o.length>0?o:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}function i(e){return!(0,d.isNothing)(e)&&(Object.prototype.hasOwnProperty.call(e,"$incidents")||Object.isExtensible(e))}function s(e){f.nameStack.push(e)}function a(){return 0===f.nameStack.length?["<empty stack>"]:f.nameStack.slice(0)}function c(){f.nameStack.length,f.nameStack.pop()}function l(e,t,n){let r,i=null;(0,d.isSome)(n)&&n.length>0&&(i=e,f.suppressedIncidentPaths.push(n))
try{s(e),r=t()}catch(e){throw e.hasThrown||(o("defaultValue","no exception",e.message),e.hasThrown=!0),e}finally{e===i&&f.suppressedIncidentPaths.pop(),c()}return r}function u(e){f.suppressedIncidentPaths.includes(e.objectPath)||f.incidents.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unexpectedNull=t.catchingContext=t.context=t.recordValidationIncidents=t.endContext=t.getContextNames=t.beginContext=t.messageForRecoveryAction=t.isValidatable=t.unexpectedType=t.extendedTypeof=void 0
const d=n(2450)
t.extendedTypeof=r,t.unexpectedType=o,t.isValidatable=i,t.messageForRecoveryAction=function(e){switch(e){case"coercedValue":return"Coerced format"
case"defaultValue":return"Default value used"
case"ignoredValue":return"Ignored value"
default:return"Unknown"}}
const f={nameStack:Array(),incidents:Array(),suppressedIncidentPaths:Array()}
t.beginContext=s,t.getContextNames=a,t.endContext=c,t.recordValidationIncidents=function(e){i(e)&&(e.$incidents=f.incidents),f.incidents=[],f.nameStack=[],f.suppressedIncidentPaths=[]},t.context=l,t.catchingContext=function(e,t,n){let r=null
try{r=l(e,t)}catch(e){r=null,(0,d.isSome)(n)&&(r=n(e))}return r},t.unexpectedNull=function(e,t,n){u({type:"nullValue",expected:t,actual:"null",objectPath:(0,d.isSome)(n)&&n.length>0?n:"<this>",contextNames:a(),recoveryAction:e,stack:(new Error).stack})}},3647:(e,t,n)=>{function r(e,t,n,r){const o="click"
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function o(e,t){return r("back","button",{...e,actionType:"back"},t)}function i(e,t,n){const r="page"
return u({...e,eventType:r,...t},n,r)}function s(e,t,n,r,o,i){const s="search",a={...o,eventType:s,term:e,targetType:t,actionType:n}
return(0,f.isSome)(r)&&(a.actionUrl=r),u(a,i,s)}function a(e,t,n=4){const r="impressions"
return u({...e,eventType:r,impressionQueue:"data-metrics",eventVersion:n},t,r)}function c(e,t){const n="media"
return u({...e,eventType:n},t,n)}function l(e,t,n,r){const o="click"
return u({...n,eventType:o,targetType:t,targetId:e},r,o)}function u(e,t,n){return{fields:e,includingFields:t.defaultIncludeRequests[n],excludingFields:t.defaultExcludeRequests[n],topic:d(e,t.defaultTopic),shouldFlush:!!(0,f.isSome)(t.shouldFlush)&&t.shouldFlush(e)}}function d(e,t){const n=e.topic
return(0,f.isSome)(n)?n:t}Object.defineProperty(t,"__esModule",{value:!0}),t.createMetricsMediaClickData=t.createMetricsMediaData=t.createMetricsImpressionsData=t.createMetricsSearchData=t.createMetricsPageData=t.createMetricsBackClickData=t.createMetricsClickData=t.MediaClickEventBuilder=t.MediaEventBuilder=t.ImpressionsEventBuilder=t.SearchEventBuilder=t.PageEventBuilder=t.BackClickEventBuilder=t.ClickEventBuilder=t.EventBuilder=void 0
const f=n(2450)
class p{constructor(e){this.configuration=e,this.eventFields={}}withEventFields(e){return this.eventFields=e,this}withConfiguration(e){return this.configuration=e,this}withDefaultTopic(e){return this.configuration={...this.configuration,defaultTopic:e},this}withDefaultIncludeRequests(e){return this.configuration={...this.configuration,defaultIncludeRequests:e},this}withDefaultExcludeRequests(e){return this.configuration={...this.configuration,defaultExcludeRequests:e},this}withShouldFlush(e){return this.configuration={...this.configuration,shouldFlush:e},this}}t.EventBuilder=p,t.ClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return r(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.BackClickEventBuilder=class extends p{build(){return o(this.eventFields,this.configuration)}},t.PageEventBuilder=class extends p{constructor(e){super(e),this.timingMetrics={}}withTimingMetrics(e){return this.timingMetrics=e,this}build(){return i(this.eventFields,this.timingMetrics,this.configuration)}},t.SearchEventBuilder=class extends p{constructor(e){super(e.configuration),this.term=e.term,this.targetType=e.targetType,this.actionType=e.actionType,this.actionUrl=null}withTerm(e){return this.term=e,this}withTargetType(e){return this.targetType=e,this}withActionType(e){return this.actionType=e,this}withActionUrl(e){return this.actionUrl=e,this}build(){return s(this.term,this.targetType,this.actionType,this.actionUrl,this.eventFields,this.configuration)}},t.ImpressionsEventBuilder=class extends p{constructor(){super(...arguments),this.impressionsEventVersion=4}withImpressionsEventVersion(e){return this.impressionsEventVersion=e,this}build(){return a(this.eventFields,this.configuration,this.impressionsEventVersion)}},t.MediaEventBuilder=class extends p{build(){return c(this.eventFields,this.configuration)}},t.MediaClickEventBuilder=class extends p{constructor(e){super(e.configuration),this.targetId=e.targetId,this.targetType=e.targetType}withTargetId(e){return this.targetId=e,this}withTargetType(e){return this.targetType=e,this}build(){return l(this.targetId,this.targetType,this.eventFields,this.configuration)}},t.createMetricsClickData=r,t.createMetricsBackClickData=o,t.createMetricsPageData=i,t.createMetricsSearchData=s,t.createMetricsImpressionsData=a,t.createMetricsMediaData=c,t.createMetricsMediaClickData=l},4927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cookieValueForKey=t.cookiesOf=void 0
const r=n(2450)
t.cookiesOf=function*(e){if((0,r.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}},t.cookieValueForKey=function(e,t){for(const n of e)if(n.key===t)return n.value
return null}},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLinter=void 0
const r=n(4409),o=n(2450),i=n(7771)
t.EventLinter=class{constructor(e){this.options=Object.freeze(e)}get defaultTopic(){return this.options.defaultTopic}applyDeResolutionRules(e,t){const n=new r.ObjectReader(e)
for(const r of t){const t=n.asNumber(r.fieldName)
if((0,o.isNothing)(t))continue
let s=r.magnitude;(0,o.isNothing)(s)&&(s=1048576)
let a=r.significantDigits
if((0,o.isNothing)(a)&&(a=2),s<=0||a<0){e[r.fieldName]=Number.NaN
continue}const c=t/s
e[r.fieldName]=i.reduceSignificantDigits(c,a)}}decorateCommonEventFields(e,t){const n=new r.ObjectReader(e),i=this.options.configuration,s=i.baseFields(t);(0,o.isSome)(s)&&Object.assign(e,s),e.clientBuildType=this.options.environment.buildType,e.resourceRevNum=this.options.environment.jsVersion,e.xpSendMethod="jet-js"
const a=n.asString("pageType"),c=n.asString("pageId")
if((0,o.isSome)(a)&&(0,o.isSome)(c)&&(0,o.isNothing)(e.page)){const n=i.compoundSeparator(t),r=(0,o.isSome)(n)?(0,o.unwrapOptional)(n):"_"
e.page=`${a}${r}${c}`}const l=i.deResolutionRules(t)
this.applyDeResolutionRules(e,l)}decorateMediaEventEvents(e){const t=new r.ObjectReader(e).asNumber("position");(0,o.isSome)(t)&&(e.position=Math.round(t))}lint(e,t={}){const n=new r.ObjectReader(e),i=n.asString("eventType")
this.options.isLoggingEnabled
const s=JSON.parse(JSON.stringify(e)),a=n.asString("topic"),c=(0,o.isSome)(a)?(0,o.unwrapOptional)(a):this.options.defaultTopic
this.decorateCommonEventFields(s,c),"media"===i&&this.decorateMediaEventEvents(s)
for(const e of this.options.rules)e.apply(s,t)
return{fields:s}}}},8836:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchTimingMetricsBuilderType=t.FetchTimingMetricsBuilder=void 0
const r=n(2450),o=n(900),i=n(2366)
t.FetchTimingMetricsBuilder=class{constructor(){this.metrics=[]}measureParsing(e,t){const n=e.metrics.length>0?[...e.metrics]:[],r=Date.now(),o=t(e),i=Date.now()
return n.length>0&&(n[0].parseStartTime=r,n[0].parseEndTime=i),this.metrics.push(...n),o}measureModelConstruction(e){const t=Date.now(),n=e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}async measureModelConstructionAsync(e){const t=Date.now(),n=await e(),r=Date.now()
return this.saveModelConstructionTimes(t,r),n}saveModelConstructionTimes(e,t){this.metrics.length>0?(this.metrics[0].modelConstructionStartTime=e,this.metrics[0].modelConstructionEndTime=t):this.metrics.push({modelConstructionStartTime:e,modelConstructionEndTime:t})}decorate(e){if((0,r.isNothing)(e))throw new Error("Cannot decorate null or undefined")
if("object"!=typeof e)throw new Error("View model to decorate must be an object")
if((0,i.isPromise)(e))throw new Error("Cannot decorate a Promise object")
this.metrics.length>0&&(e.$networkPerformance=this.metrics)}},t.fetchTimingMetricsBuilderType=(0,o.makeMetatype)("jet-engine:fetchTimingMetricsBuilder")},8267:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(7581),t),o(n(7764),t),o(n(7771),t),o(n(4698),t)},7581:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsLocationTracker=void 0
const r=n(4172),o=n(2450),i=n(4698)
class s{constructor(e=0,t=[]){this.rootPosition=e,this.locationStack=t.map(e=>new a(e))}get isEmpty(){return 0===this.locationStack.length}pushLocation(e){this.locationStack.push(new a(e))}popLocation(){var e
return 0===this.locationStack.length?(r.unexpectedType("ignoredValue","non-empty location stack","empty location stack"),null):null===(e=this.locationStack.pop())||void 0===e?void 0:e.location}get currentPosition(){const e=this.lastStackItem
return(0,o.isSome)(e)?e.position:this.rootPosition}setCurrentPosition(e){const t=this.lastStackItem;(0,o.isSome)(t)?t.position=e:this.rootPosition=e}nextPosition(){const e=this.lastStackItem;(0,o.isSome)(e)?e.position+=1:this.rootPosition+=1}get stackItemsToLocations(){return this.locationStack.map(e=>e.location)}get lastStackItem(){const e=this.locationStack.length
return 0===e?null:this.locationStack[e-1]}static locationsByAddingBasicLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildBasicLocation(e,t)),n}static locationsByAddingContentLocation(e,t){const n=e.locationTracker.stackItemsToLocations
return n.push(s.buildContentLocation(e,t)),n}static pushBasicLocation(e,t){e.locationTracker.pushLocation(s.buildBasicLocation(e,t))}static pushContentLocation(e,t){e.locationTracker.pushLocation(s.buildContentLocation(e,t))}static popLocation(e){return e.locationTracker.popLocation()}static buildBasicLocation(e,t){let n=t;(0,o.isSome)(e.anonymizationOptions)&&(n=e.anonymizationOptions.anonymizationString)
const r={locationPosition:e.locationTracker.currentPosition,locationType:i.targetTypeForMetricsOptions(e),name:n}
return(0,o.isSome)(e.recoMetricsData)&&Object.assign(r,e.recoMetricsData),r}static buildContentLocation(e,t){const n=s.buildBasicLocation(e,t)
if((0,o.isNothing)(e.id))n.idType="sequential",n.id=e.locationTracker.currentPosition.toString()
else{n.idType=i.idTypeForMetricsOptions(e)
let t=e.id;(0,o.isSome)(e.anonymizationOptions)&&(t=e.anonymizationOptions.anonymizationString),n.id=t}return(0,o.isSome)(e.fcKind)&&(n.fcKind=e.fcKind),(0,o.isSome)(e.displayStyle)&&(n.displayStyle=e.displayStyle),n}}t.MetricsLocationTracker=s
class a{constructor(e,t=0){this.location=e,this.position=t}}},7764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceSignificantDigits=void 0,t.reduceSignificantDigits=function(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}},4698:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchTermFromRefURL=t.extractSiriRefAppFromRefURL=t.idTypeForMetricsOptions=t.targetTypeForMetricsOptions=void 0
const r=n(2450),o=n(1974)
t.targetTypeForMetricsOptions=function(e){let t=e.targetType
return(0,r.isNothing)(t)&&(t="lockup"),t},t.idTypeForMetricsOptions=function(e){let t=e.idType
return(0,r.isNothing)(t)&&(t="its_id"),t},t.extractSiriRefAppFromRefURL=function(e){const t=new o.URL(e)
if((0,r.isNothing)(t.query))return null
let n=null
for(const e of Object.keys(t.query))if("referrer"===e){"siri"===t.query[e]&&(n="com.apple.siri")
break}return n},t.searchTermFromRefURL=function(e){const t=new o.URL(e),n=t.query
if((0,r.isNothing)(n))return null
const i=n.term,s=t.pathname
return(0,r.isNothing)(i)||(0,r.isNothing)(s)?null:s.endsWith("/search")?i:null}},1415:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(3647),t),o(n(4927),t),o(n(8535),t),o(n(8836),t),o(n(8267),t),o(n(6094),t)},6094:(e,t,n)=>{function r(e,t){const n=e.optional(a.fetchTimingMetricsBuilderType)
if((0,s.isSome)(n))return e
if(t)throw new Error("Could not find FetchTimingMetricsBuilder in the object graph")
return e.adding(a.fetchTimingMetricsBuilderType,new a.FetchTimingMetricsBuilder)}async function o(e,t,n){const r=(0,i.inject)(a.fetchTimingMetricsBuilderType,t),o=await r.measureModelConstructionAsync(async()=>{const r=n(e,t)
return await Promise.resolve(r)})
if((0,s.isNothing)(o))throw new Error("model builder function returned null or undefined")
return r.decorate(o),o}Object.defineProperty(t,"__esModule",{value:!0}),t.parseAndBuildModel=t.requestAndBuildModel=void 0
const i=n(9100),s=n(2450),a=n(8836)
t.requestAndBuildModel=async function(e,t,n,i){const s=r(t,!0),a=await n(e,s)
return await o(a,s,i)},t.parseAndBuildModel=async function(e,t,n,c){const l=r(t,!1),u=(0,i.inject)(a.fetchTimingMetricsBuilderType,l).measureParsing(e,()=>n(e,l))
if((0,s.isNothing)(u))throw new Error("parser function returned null or undefined")
return await o(u,l,c)}},4789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompoundAction=t.isCompoundAction=void 0,t.isCompoundAction=function(e){return"compoundAction"===(null==e?void 0:e.$kind)},t.makeCompoundAction=function(e,t){return{$kind:"compoundAction",subactions:t,actionMetrics:e}}},9120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyAction=t.isEmptyAction=void 0,t.isEmptyAction=function(e){return"emptyAction"===(null==e?void 0:e.$kind)},t.makeEmptyAction=function(e){return{$kind:"emptyAction",actionMetrics:e}}},9634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6158:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1235:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(4789),t),o(n(573),t),o(n(9120),t),o(n(9634),t),o(n(5599),t),o(n(2170),t),o(n(6158),t),o(n(9400),t),o(n(4362),t)},4362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},998:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeArtworkURLTemplate=void 0
const r=n(4172),o=n(2450),i=n(1974),s=new RegExp("^({w}|[0-9]+(?:.[0-9]*)?)x({h}|[0-9]+(?:.[0-9]*)?)({c}|[a-z]{2}).({f}|[a-z]+)$")
t.makeArtworkURLTemplate=function(e){if(void 0===new i.URL(e).pathname)return r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid URL string",e)}),null
const t=e.substring(e.lastIndexOf("/")+1),n=s.exec(t)
return(0,o.isNothing)(n)||5!==n.length?(r.context("makeArtworkURLTemplate",()=>{r.unexpectedType("ignoredValue","A valid artwork URL template ending with {w}x{h}{c}.{f} format",t)}),null):e}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areEqual=t.luminanceFrom=t.dynamicWith=t.named=t.rgbWith=t.htmlWith=t.Color=void 0
const r=n(2450)
t.Color={fromHex:e=>(0,r.isNothing)(e)?null:{$kind:"html",value:e},fromRGB:(e,t,n,r=1)=>({$kind:"rgb",red:e,green:t,blue:n,alpha:r}),named:e=>({$kind:"named",name:e}),dynamicWith:(e,t,n,r)=>({$kind:"dynamic",lightColor:e,lightHighContrastColor:t,darkColor:n,darkHighContrastColor:r}),luminanceFrom:e=>.2126*e.red+.7152*e.green+.0722*e.blue,areEqual(e,n){if((0,r.isNothing)(e))return(0,r.isNothing)(n)
if((0,r.isNothing)(n))return(0,r.isNothing)(e)
const o=e.$kind,i=n.$kind
if("named"===o&&"named"===i){const t=n
return e.name===t.name}if("rgb"===o&&"rgb"===i){const t=e,r=n
return t.red===r.red&&t.green===r.green&&t.blue===r.blue&&t.alpha===r.alpha}if("dynamic"===o&&"dynamic"===i){const r=e,o=n
return t.Color.areEqual(r.lightColor,o.lightColor)&&t.Color.areEqual(r.lightHighContrastColor,o.lightHighContrastColor)&&t.Color.areEqual(r.darkColor,o.darkColor)&&t.Color.areEqual(r.darkHighContrastColor,o.darkHighContrastColor)}return!1}}
const o=t.Color.fromHex
t.htmlWith=o
const i=t.Color.fromRGB
t.rgbWith=i
const s=t.Color.named
t.named=s
const a=t.Color.dynamicWith
t.dynamicWith=a
const c=t.Color.luminanceFrom
t.luminanceFrom=c
const l=t.Color.areEqual
t.areEqual=l},5827:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1235),t),o(n(998),t),o(n(7615),t),o(n(6301),t),o(n(8681),t),o(n(9184),t),o(n(7129),t),o(n(2359),t)},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.menuSeparatorID=void 0,t.menuSeparatorID="com.apple.JetEngine.separator"},9184:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2359:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6882:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportBootstrap=void 0
const r=n(6451)
t.exportBootstrap=function(e){"undefined"!=typeof $exportBootstrap&&$exportBootstrap(t=>(function(e){const t=e.$lazyDependencyNames,n=new Set(null!=t?t:[]),o=globalThis.$lazyGlobalNames,i=new Set(null!=o?o:[]),s=new Set([...n,...i]),a=new Map,c=globalThis.$lazyProvider
for(const e of s)a.set(e,r.LazyProxyFactory.makeProxy(e,c))
for(const t of n)e[t]=a.get(t)
for(const e of i)globalThis[e]=a.get(e)}(t),e(t)))},globalThis.has_lazy_support=!0},8706:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6882),t),o(n(4816),t)},4816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyRuntime=t.Runtime=void 0
const n="function"==typeof exportService
class r{constructor(e,t){this.dispatcher=e,this.objectGraph=t}async dispatch(e){return await this.dispatcher.dispatch(e,this.objectGraph)}}t.Runtime=r,t.LegacyRuntime=class extends r{constructor(e,t,n){super(e,t),this.services=n}serviceWithName(e){return this.services[e]}exportingService(e,t){return n&&function(e,t){exportService(e,t)}(e,t),this.services[e]=t,this}}},1219:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8045:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3922:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9891:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1121:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1721:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof preprocessor&&(globalThis.preprocessor={PRODUCTION_BUILD:!1,CARRY_BUILD:!1,DEBUG_BUILD:!1,INTERNAL_BUILD:!1}),"undefined"==typeof testContent&&(globalThis.testContent={INCLUDE_TEST_CONTENT:!1}),o(n(1219),t),o(n(8045),t),o(n(3922),t),o(n(9891),t),o(n(1121),t),o(n(9247),t),o(n(3907),t),o(n(6534),t),o(n(5817),t),o(n(3043),t),o(n(5037),t),o(n(5937),t),o(n(1222),t)},9247:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3907:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxiedNetwork=void 0,t.ProxiedNetwork=class{constructor(e,t){this.original=e,this.pageIntentInstrumentation=t}async fetch(e){return e.$pageIntentInstrumentation=this.pageIntentInstrumentation,await this.original.fetch(e)}}},6534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5817:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.services=t.random=t.plist=t.platform=t.net=t.localizer=t.host=t.cryptography=t.cookieProvider=t.bundle=t.bag=void 0
const r=n(900)
t.bag=(0,r.makeMetatype)("jet-engine:bag"),t.bundle=(0,r.makeMetatype)("jet-engine:bundle"),t.cookieProvider=(0,r.makeMetatype)("jet-engine:cookieProvider"),t.cryptography=(0,r.makeMetatype)("jet-engine:cryptography"),t.host=(0,r.makeMetatype)("jet-engine:host"),t.localizer=(0,r.makeMetatype)("jet-engine:localizer"),t.net=(0,r.makeMetatype)("jet-engine:net"),t.platform=(0,r.makeMetatype)("jet-engine:platform"),t.plist=(0,r.makeMetatype)("jet-engine:plist"),t.random=(0,r.makeMetatype)("jet-engine:random"),t.services=(0,r.makeMetatype)("jet-engine:services")},8037:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(1721),t),o(n(9031),t),o(n(447),t),o(n(2024),t),o(n(2450),t)},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9031:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2490),t)},447:(e,t)=>{var n
Object.defineProperty(t,"__esModule",{value:!0}),t.notInstrumented=t.PageInvocationPoint=t.EMPTY_LINTED_METRICS_EVENT=void 0,t.EMPTY_LINTED_METRICS_EVENT={fields:{},issues:[]},(n=t.PageInvocationPoint||(t.PageInvocationPoint={})).pageEnter="pageEnter",n.pageExit="pageExit",n.appExit="appExit",n.appEnter="appEnter",n.backButton="backButton",t.notInstrumented=function(e){switch(e){case 0:return{data:[],custom:{}}
case 1:default:return{}
case 2:return{instructions:[],custom:{}}
case 3:return{id:{id:"",impressionIndex:-1},fields:{},custom:{}}}}},2024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2450:(e,t)=>{function n(e){return null==e}function r(e){return null!=e}Object.defineProperty(t,"__esModule",{value:!0}),t.flatMapOptional=t.mapOptional=t.unsafeUnwrapOptional=t.unwrapOptional=t.isSome=t.isNothing=t.unsafeUninitialized=void 0,t.unsafeUninitialized=function(){},t.isNothing=n,t.isSome=r,t.unwrapOptional=function(e){if(n(e))throw new ReferenceError
return e},t.unsafeUnwrapOptional=function(e){return e},t.mapOptional=function(e,t){return r(e)?t(e):e},t.flatMapOptional=function(e,t){return r(e)?t(e):e}},2879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shallowCloneOf=void 0,t.shallowCloneOf=function(e){const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e)}},6151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0,t.ExpiringValue=class{constructor(e,t){this._value=e,this._maxAge=t}isValid(){return Date.now()<this._maxAge}get value(){return this.isValid()?this._value:null}}},7312:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(2879),t),o(n(6151),t),o(n(900),t),o(n(2366),t),o(n(4805),t),o(n(3087),t),o(n(1974),t)},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeMetatype=void 0,t.makeMetatype=function(e){return{name:e}}},2366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0,t.isPromise=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}},4805:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RewindableValue=void 0
const r=n(2879)
t.RewindableValue=class{constructor(e){this._values=[e]}get(){return this._values[this._values.length-1]}set(e){this._values[this._values.length-1]=e}save(){this._values.push(this._values[this._values.length-1])}restore(){if(1===this._values.length)throw new RangeError("Calls to restore must balance previous calls to save")
this._values.pop()}clone(){const e=(0,r.shallowCloneOf)(this)
return e._values=this._values.slice(),e}}},3087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.difference=t.symmetricDifference=t.intersection=t.union=t.isSuperset=void 0,t.isSuperset=function(e,t){for(const n of t)if(!e.has(n))return!1
return!0},t.union=function(e,t){const n=new Set(e)
for(const e of t)n.add(e)
return n},t.intersection=function(e,t){const n=new Set
for(const r of t)e.has(r)&&n.add(r)
return n},t.symmetricDifference=function(e,t){const n=new Set(e)
for(const e of t)n.has(e)?n.delete(e):n.add(e)
return n},t.difference=function(e,t){const n=new Set(e)
for(const e of t)n.delete(e)
return n}},1974:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,s=/([^=?&]+)=?([^&]*)/g,a=["hash","query","pathname","host"]
class c{constructor(e){var t
if(this.query={},(0,o.isNothing)(e))return
let n=e
const s=i.exec(e)
if((0,o.isSome)(s)){let e=s[1]
null!=e&&(e=e.split(":")[0]),this.protocol=null!=e?e:void 0,n=null!==(t=s[3])&&void 0!==t?t:void 0}let l={remainder:n,result:void 0}
for(const e of a){if(void 0===l||void 0===l.remainder)break
switch(e){case"hash":l=r(l.remainder,"#","suffix"),this.hash=null==l?void 0:l.result
break
case"query":l=r(l.remainder,"?","suffix"),void 0!==(null==l?void 0:l.result)&&(this.query=c.queryFromString(l.result))
break
case"pathname":l=r(l.remainder,"/","suffix"),void 0!==(null==l?void 0:l.result)&&(this.pathname="/"+l.result)
break
case"host":{const e=r(l.remainder,"@","prefix"),t=null==e?void 0:e.result,n=null==e?void 0:e.remainder
if(void 0!==t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(void 0!==n){const e=n.split(":")
this.host=e[0],this.port=e[1]}break}default:throw new Error("Unhandled case!")}}}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}set(e,t){if(void 0===t)return this
switch("query"===e&&"string"==typeof t&&(t=c.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}append(e,t){let n,r=this.get(e)
if("query"===e)void 0===r&&(r={}),"string"==typeof t&&(t=c.queryFromString(t)),n="string"==typeof r?{existingValue:r,...t}:{...r,...t}
else{void 0===r&&(r="")
let o=r
void 0===o&&(o="")
let i=o
if("pathname"===e){const e=o.length
0!==e&&"/"===r[e-1]||(i+="/")}i+=t,n=i}return this.set(e,n)}param(e,t){return null===e||(void 0===this.query&&(this.query={}),void 0===t?delete this.query[e]:this.query[e]=t),this}removeParam(e){return void 0===e||void 0===this.query||e in this.query&&delete this.query[e],this}path(e){return this.append("pathname",e)}pathExtension(){var e,t
if(void 0===this.pathname)return
const n=null!==(t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split("."))&&void 0!==t?t:[]
return n.filter(function(e){return""!==e}).length<2?void 0:n.pop()}pathComponents(){return void 0===this.pathname?[]:this.pathname.split("/").filter(e=>e.length>0)}build(){return this.toString()}toString(){let e=""
return void 0!==this.protocol&&(e+=this.protocol+"://"),void 0!==this.username&&(e+=encodeURIComponent(this.username),void 0!==this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),void 0!==this.host&&(e+=this.host,void 0!==this.port&&(e+=":"+this.port)),void 0!==this.pathname&&(e+=this.pathname),void 0!==this.query&&0!==Object.keys(this.query).length&&(e+="?"+c.toQueryString(this.query)),void 0!==this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=s.exec(e)
for(;null!==n&&n.length>=3;){const r=decodeURIComponent(n[1].replace(/\+/g," ")),o=decodeURIComponent(n[2].replace(/\+/g," "))
t[r]=o,n=s.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
null!==o&&o.length>0&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new c(e)}static fromComponents(e,t,n,r,o){const i=new c
return i.protocol=e,i.host=t,i.pathname=n,i.query=null!=r?r:{},i.hash=o,i}}t.URL=c},6034:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAugmentedData=void 0
const s=i(n(581))
t.fetchAugmentedData=async function(e,t,n,r,o){const i=n(e,t,o)
if(null==i)return await Promise.resolve({originalData:t,additionalData:null})
const a=Array.from(i),c=[]
for(const t of a){const n=r(e,t)
if(s.isNull(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}},8371:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(6762),t),o(n(6034),t),o(n(264),t),o(n(5917),t),o(n(5658),t),o(n(4625),t),o(n(695),t)},377:function(e,t,n){function r(e,t,n){return p.isNull(e)?null:p.asDictionary(e.attributes,t,n)}function o(e,t,n="coercible"){return p.isNull(e)?null:p.asString(e.attributes,t,n)}function i(e,t,n="coercible"){if(p.isNull(e))return null
const r=p.asString(e.attributes,t,n)
return(0,f.isNothing)(r)?null:new Date(r)}function s(e){return!p.isNull(p.asDictionary(e,"attributes"))}function a(e){const t=p.asDictionary(e,"meta")
if((0,f.isNothing)(t))throw new h.MissingFieldError(e,"meta")
return t}function c(e,t){let n
return n=Array.isArray(e)?e:[e],Array.isArray(t)?n.push(...t):n.push(t),n}var l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n)
return u(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.concatObjectPaths=t.requiredMetaAttributeAsNumber=t.requiredMetaAttributeAsString=t.requiredMeta=t.requiredAttributeAsDictionary=t.requiredAttributeAsDate=t.requiredAttributeAsString=t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=t.attributeKeyAsCustomAttributeKey=t.isNotHydrated=t.hasAttributes=t.attributeAsNumber=t.attributeAsBooleanOrFalse=t.attributeAsBoolean=t.attributeAsDate=t.metaAsString=t.attributeAsString=t.attributeAsArrayOrEmpty=t.attributeAsInterface=t.attributeAsDictionary=void 0
const f=n(2450),p=d(n(581)),h=d(n(1636))
t.attributeAsDictionary=r,t.attributeAsInterface=function(e,t,n){return r(e,t,n)},t.attributeAsArrayOrEmpty=function(e,t){return p.isNull(e)?[]:p.asArrayOrEmpty(e.attributes,t)},t.attributeAsString=o,t.metaAsString=function(e,t,n="coercible"){return p.isNull(e)?null:p.asString(e.meta,t,n)},t.attributeAsDate=i,t.attributeAsBoolean=function(e,t,n="coercible"){return p.isNull(e)?null:p.asBoolean(e.attributes,t,n)},t.attributeAsBooleanOrFalse=function(e,t){return!p.isNull(e)&&p.asBooleanOrFalse(e.attributes,t)},t.attributeAsNumber=function(e,t,n="coercible"){return p.isNull(e)?null:p.asNumber(e.attributes,t,n)},t.hasAttributes=s,t.isNotHydrated=function(e){return!s(e)},t.attributeKeyAsCustomAttributeKey=function(e){return w[e]},t.attributeAllowsNonDefaultTreatmentInNonDefaultPage=function(e){return"customArtwork"===e||"customIconArtwork"===e}
const w={artwork:"customArtwork",iconArtwork:"customIconArtwork",screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:"customScreenshotsByTypeForAd",customVideoPreviewsByTypeForAd:"customVideoPreviewsByTypeForAd"}
t.requiredAttributeAsString=function(e,t){const n=o(e,t)
if((0,f.isNothing)(n))throw new h.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDate=function(e,t){const n=i(e,t)
if((0,f.isNothing)(n))throw new h.MissingFieldError(e,c("attributes",t))
return n},t.requiredAttributeAsDictionary=function(e,t){const n=r(e,t)
if((0,f.isNothing)(n))throw new h.MissingFieldError(e,c("attributes",t))
return n},t.requiredMeta=a,t.requiredMetaAttributeAsString=function(e,t){const n=a(e),r=p.asString(n,t)
if((0,f.isNothing)(r))throw new h.MissingFieldError(e,c("meta",t))
return r},t.requiredMetaAttributeAsNumber=function(e,t){const n=a(e),r=p.asNumber(n,t)
if((0,f.isNothing)(r))throw new h.MissingFieldError(e,c("meta",t))
return r},t.concatObjectPaths=c},1180:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n)
return o(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.BagWrapper=void 0
const s=n(5542),a=i(n(1222)),c=n(581)
t.BagWrapper=class{constructor(e){this.bag=e.required(a.bag)}get language(){return this.bag.string("language")}get mediaCountryCode(){return this.bag.string("countryCode")}get mediaHost(){return this.bag.url("apps-media-api-host")}get mediaPreviewHost(){return this.bag.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.bag.string("notification-settings-media-api-host")}get mediaApiLanguage(){const e=this.bag.string("language-tag")
return(0,s.isSome)(e)?e:this.bag.string("language")}get edgeEndpoints(){const e=this.bag.array("apps-media-api-edge-end-points")
return void 0===e?[]:(0,c.asArrayOrEmpty)((0,c.asJSONValue)(e))}get mediaEdgeSearchHost(){return this.bag.string("apps-media-api-search-edge-host")}get redirectUrlWhitelistedQueryParams(){let e=(0,c.asArrayOrEmpty)((0,c.asJSONValue)(this.bag.array("processRedirectUrl/whitelistedQueryParams")))
return(0,c.isNullOrEmpty)(e)&&(e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"]),e}}},8172:function(e,t,n){function r(e){return c.isDefinedNonNull(e.attributes)}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.metricsFromMediaApiObject=t.dataCollectionFromResultsListContainer=t.isDataCollectionPartiallyHydrated=t.isDataCollectionHydrated=t.isDataHydrated=t.dataCollectionFromDataContainer=t.dataFromDataContainer=t.requiredStringID=void 0
const a=n(2450),c=s(n(581))
n(5917),t.requiredStringID=function(e){const t=c.asString(e,"id")
if((0,a.isNothing)(t))throw new Error(`Data.id '${e.id}' is not a string.`)
return t},t.dataFromDataContainer=function(e){const t=c.asArrayOrEmpty(e,"data")
return t.length,1!==t.length?null:t[0]},t.dataCollectionFromDataContainer=function(e){return c.asArrayOrEmpty(e,"data")},t.isDataHydrated=r,t.isDataCollectionHydrated=function(e){for(let t=e.length-1;t>=0;t-=1)if(!r(e[t]))return!1
return!0},t.isDataCollectionPartiallyHydrated=function(e){for(const t of e)if(r(t))return!0
return!1},t.dataCollectionFromResultsListContainer=function(e){return c.asArrayOrEmpty(e,"results.contents")},t.metricsFromMediaApiObject=function(e){return c.asDictionary(e,"meta.metrics")}},1636:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MissingFieldError=void 0
class n extends Error{constructor(e,t){super(),this.dataId=e.id,this.dataType=e.type,this.attributePath=t}}t.MissingFieldError=n},6762:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)}
Object.defineProperty(t,"__esModule",{value:!0}),o(n(377),t),o(n(1180),t),o(n(8172),t),o(n(4285),t),o(n(1289),t),o(n(264),t),o(n(581),t),o(n(4030),t),o(n(1636),t)},4285:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1289:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},264:function(e,t,n){function r(e){switch(host.platform){case"iOS":return"iPad"===host.deviceModelFamily?"ipad":"iphone"
case"macOS":return"mac"
case"tvOS":return"appletv"
case"watchOS":return"watch"
case"xrOS":return"realityDevice"
default:return null}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.defaultPlatformForClient=void 0
const a=s(n(581))
t.defaultPlatformForClient=r,t.Request=class{constructor(e,t){if(this.contentsResourceTypes=new Set,this.ids=new Set,this.seeds=new Set,this.relationshipIncludes=new Set,this.relationshipIncludesOnly=new Set,this.attributeIncludes=new Set,this.platform=null,this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.shouldOmitAutomaticRelationship=!1,this.objectGraph=e,this.platform=r(),!a.isNullOrEmpty(t))if("string"==typeof t)this.href=t
else if(Array.isArray(t)){const e=new Set
for(const n of t)e.add(n.type),this.ids.add(n.id)
1===e.size?this.resourceType=e.values().next().value:e.size>1&&(this.resourceType="contents",this.contentsResourceTypes=e)}}forType(e){return this.resourceType=e,this}withIds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.ids.add(t)
return this}withSeeds(e){for(const t of e)a.isDefinedNonNullNonEmpty(t)&&this.seeds.add(t)
return this}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingOnlyRelationships(e){for(const t of e)this.relationshipIncludesOnly.add(t)
return this}includingScopedRelationships(e,t){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){null==this.metaIncludes&&(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingAssociateKeys(e,t){null==this.associateIncludes&&(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t="marketing-items"
if(e){null==this.scopedRelationshipIncludes&&(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get("editorial-items")
null==e&&(e=new Set),e.add(t),this.scopedRelationshipIncludes.set("editorial-items",e)}else this.relationshipIncludes.add(t)
{null==this.metaIncludes&&(this.metaIncludes=new Map)
let e=this.metaIncludes.get("marketing-items")
null==e&&(e=new Set),e.add("metrics"),this.metaIncludes.set("marketing-items",e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){null==this.scopedAttributeIncludes&&(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){null==this.scopedAvailableInIncludes&&(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
null==n&&(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return null==this.scopedSparseLimit&&(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return this.additionalQuery[e]=t,this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}format(e){return this.responseFormat=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return null==this.enabledFeatures&&(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!a.isDefinedNonNull(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}}},581:function(e,t,n){function r(e){return i(e)?null:Array.isArray(e)?e.join("."):e}function o(e,t,n){if(null==e)return n
if(s(t))return e
let r
if("string"==typeof t){if(r=w[t],s(r)){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),w[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function i(e){return null==e}function s(e){return i(e)||0===Object.keys(e).length}function a(e){return null!=e}function c(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return s
if("string"==typeof s)return s
{const e="object"==typeof s?null:String(s)
switch(n){case"strict":p.context("asString",()=>{p.unexpectedType("coercedValue","string",s,r(t))})
break
case"coercible":i(e)&&p.context("asString",()=>{p.unexpectedType("coercedValue","string",s,r(t))})}return e}}function l(e,t,n){const s=o(e,t,null)
return s instanceof Object&&!Array.isArray(s)?s:(i(s)||p.context("asDictionary",()=>{p.unexpectedType("defaultValue","object",s,r(t))}),a(n)?n:null)}var u=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&u(t,e,n)
return d(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.asJSONData=t.asJSONValue=t.asBoolean=t.asInterface=t.asDictionary=t.asNumber=t.asDate=t.asString=t.asBooleanOrFalse=t.asArrayOrEmpty=t.isArrayDefinedNonNullAndEmpty=t.isNumber=t.isDefinedNonNullNonEmpty=t.isDefinedNonNull=t.isNullOrEmpty=t.isNull=t.traverse=t.objectPathToString=void 0
const p=f(n(4172)),h=n(2450)
t.objectPathToString=r
const w={}
t.traverse=o,t.isNull=i,t.isNullOrEmpty=s,t.isDefinedNonNull=a,t.isDefinedNonNullNonEmpty=function(e){return a(e)&&0!==Object.keys(e).length},t.isNumber=function(e){if(i(e))return!1
let t
return t="string"==typeof e?parseInt(e):e,!Number.isNaN(t)},t.isArrayDefinedNonNullAndEmpty=function(e){return a(e)&&0===e.length},t.asArrayOrEmpty=function(e,t){const n=o(e,t,null)
return Array.isArray(n)?n:(i(n)||p.context("asArrayOrEmpty",()=>{p.unexpectedType("defaultValue","array",n,r(t))}),[])},t.asBooleanOrFalse=function(e,t){const n=o(e,t,null)
return"boolean"==typeof n?n:(i(n)||p.context("asBooleanOrFalse",()=>{p.unexpectedType("defaultValue","boolean",n,r(t))}),!1)},t.asString=c,t.asDate=function(e,t,n="coercible"){const r=c(e,t,n)
return(0,h.isNothing)(r)?null:new Date(r)},t.asNumber=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s)||"number"==typeof s)return s
{const e=Number(s)
switch(n){case"strict":p.context("asNumber",()=>{p.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(isNaN(e))return p.context("asNumber",()=>{p.unexpectedType("coercedValue","number",s,r(t))}),null}return e}},t.asDictionary=l,t.asInterface=function(e,t,n){return l(e,t,n)},t.asBoolean=function(e,t,n="coercible"){const s=o(e,t,null)
if(i(s))return null
if("boolean"==typeof s)return s
if("string"==typeof s){if("true"===s)return!0
if("false"===s)return!1}const a=Boolean(s)
switch(n){case"strict":p.context("asBoolean",()=>{p.unexpectedType("coercedValue","number",s,r(t))})
break
case"coercible":if(i(a))return p.context("asBoolean",()=>{p.unexpectedType("coercedValue","number",s,r(t))}),null}return a},t.asJSONValue=function(e){if(null==e)return null
switch(typeof e){case"string":case"number":case"boolean":return e
case"object":return Array.isArray(e),e
default:return p.context("asJSONValue",()=>{p.unexpectedType("defaultValue","JSONValue",typeof e)}),null}},t.asJSONData=function(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(p.context("asJSONValue",()=>{p.unexpectedType("defaultValue","object",typeof e)}),null)}},4030:(e,t,n)=>{function r(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
"prefix"===n?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.URL=void 0
const o=n(2450),i=n(581),s=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,a=/([^=?&]+)=?([^&]*)/g,c=["hash","query","pathname","host"]
class l{constructor(e){if(this.query={},(0,i.isNullOrEmpty)(e))return
let t=e
const n=s.exec(e)
if(null!=n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let o={remainder:t,result:void 0}
for(const e of c){if(!o.remainder)break
switch(e){case"hash":o=r(o.remainder,"#","suffix"),this.hash=o.result
break
case"query":o=r(o.remainder,"?","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.query=l.queryFromString(o.result))
break
case"pathname":o=r(o.remainder,"/","suffix"),(0,i.isDefinedNonNullNonEmpty)(o.result)&&(this.pathname="/"+o.result)
break
case"host":if(o.remainder){const e=r(o.remainder,"@","prefix"),t=e.result,n=e.remainder
if((0,i.isDefinedNonNullNonEmpty)(t)){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if((0,i.isNullOrEmpty)(t))return this
switch("query"===e&&"string"==typeof t&&(t=l.queryFromString(t)),e){case"protocol":this.protocol=t
break
case"username":this.username=t
break
case"password":this.password=t
break
case"port":this.port=t
break
case"pathname":this.pathname=t
break
case"query":this.query=t
break
case"hash":this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case"protocol":return this.protocol
case"username":return this.username
case"password":return this.password
case"port":return this.port
case"pathname":return this.pathname
case"query":return this.query
case"hash":return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if("query"===e)"string"==typeof t&&(t=l.queryFromString(t)),r="string"==typeof n?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if("pathname"===e){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(null==this.query&&(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&null!=this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append("pathname",e)}pathExtension(){var e
if((0,o.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return(0,i.isNullOrEmpty)(this.pathname)?[]:this.pathname.split("/").filter(e=>e.length>0)}popPathComponent(){if((0,i.isNullOrEmpty)(this.pathname))return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return(0,i.isDefinedNonNullNonEmpty)(this.protocol)&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),(0,i.isDefinedNonNullNonEmpty)(this.host)&&(e+=this.host,this.port&&(e+=":"+this.port)),(0,i.isDefinedNonNullNonEmpty)(this.pathname)&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),null!=this.query&&Object.keys(this.query).length>0&&(e+="?"+l.toQueryString(this.query)),(0,i.isDefinedNonNullNonEmpty)(this.hash)&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=a.exec(e)
for(;null!=n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=a.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r];(0,i.isDefinedNonNullNonEmpty)(o)&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new l(e)}static fromComponents(e,t,n,r,o){const i=new l
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}t.URL=l},5917:function(e,t,n){async function r(e,t,n){const r=await e.network.fetch(t)
if(!r.ok)throw Error(`Bad Status code ${r.status} for ${t.url}`)
const o=Date.now(),i=n(r.body),s=Date.now(),c=function(e,t,n){return f.isNull(e)||0===e.length?null:{...e[0],parseStartTime:t,parseEndTime:n}}(r.metrics,o,s)
return f.isDefinedNonNull(c)&&(i[a.timingValues]=c),i[a.requestedUrl]=t.url.toString(),i}function o(e,t){return e.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return f.isDefinedNonNull(null===(n=t.query)||void 0===n?void 0:n[e])})}async function i(e,t,n,r,c={},l=!1,u){var h,m,y,A
const T=new p.URL(n),b=o(e,T)
for(const e of b)T.removeParam(e)
const S=T.toString()
let P=c.headers
null==P&&(P={}),P.Authorization="Bearer "+r
const I={url:S,excludeIdentifierHeadersForAccount:null!==(h=c.excludeIdentifierHeadersForAccount)&&void 0!==h&&h,alwaysIncludeAuthKitHeaders:null===(m=c.alwaysIncludeAuthKitHeaders)||void 0===m||m,alwaysIncludeMMeClientInfoAndDeviceHeaders:null===(y=c.alwaysIncludeMMeClientInfoAndDeviceHeaders)||void 0===y||y,headers:P,method:c.method,body:c.requestBodyString,timeout:c.timeout},C=await e.network.fetch(I)
try{if(401===C.status||403===C.status){if(l)throw Error("We refreshed the token but we still get 401 from the API")
return t.resetToken(),await t.refreshToken().then(async r=>await i(e,t,n,r,c,!0,u))}if(404===C.status)throw s()
if(!C.ok){const e=null!==(A=C.headers["x-apple-jingle-correlation-key"])&&void 0!==A?A:"N/A",t=new w(`Bad Status code ${C.status} (correlationKey: ${e}) for ${S}, original ${n}`)
throw t.statusCode=C.status,t}const r=t=>{const r=Date.now()
let o
if(f.isNull(t.body)||""===t.body){if(204!==t.status)throw s()
o={}}else o=JSON.parse(t.body)
const i=Date.now()
if(o[a.pageInformation]=f.asJSONData(function(e,t){const n=e.storefrontIdentifier
let r=null
if(f.isDefinedNonNullNonEmpty(n)){const e=n.split("-")
f.isDefinedNonNullNonEmpty(e)&&(r=e[0])}return{serverInstance:t.headers[g],storeFrontHeader:n,language:e.bagLanguage,storeFront:r,environmentDataCenter:t.headers[v]}}(e,t)),t.metrics.length>0){const e={...t.metrics[0],parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}else{const e={pageURL:t.url,parseStartTime:r,parseEndTime:i}
o[a.timingValues]=e}if(o[a.contentMaxAge]=function(e){const t=Object.keys(e.headers).find(e=>"cache-control"===e.toLowerCase())
if(f.isNull(t)||""===t)return null
const n=e.headers[t]
if(f.isNullOrEmpty(n))return null
const r=n.match(/max-age=(\d+)/)
return f.isNull(r)||r.length<2?null:f.asNumber(r[1])}(t),Array.isArray(o.data)&&f.isArrayDefinedNonNullAndEmpty(o.data)&&!f.asBooleanOrFalse(c.allowEmptyDataResponse))throw s()
return o[a.requestedUrl]=n,o}
return(0,d.isSome)(u)?u.measureParsing(C,r):r(C)}catch(e){if(e instanceof w)throw e
throw new Error(`Error Fetching - filtered: ${S}, original: ${n}, ${e.name}, ${e.message}`)}}function s(){const e=new w("No content")
return e.statusCode=204,e}var a,c=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&c(t,e,n)
return l(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.redirectParametersInUrl=t.fetchData=t.fetchPlist=t.fetchJSON=t.fetch=t.ResponseMetadata=void 0
const d=n(2450),f=u(n(581)),p=u(n(4030)),h=u(n(695))
!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(a=t.ResponseMetadata||(t.ResponseMetadata={})),t.fetch=r,t.fetchJSON=async function(e,t){return await r(e,t,e=>(0,d.isSome)(e)?JSON.parse(e):{})},t.fetchPlist=async function(e,t){return await r(e,t,n=>{if((0,d.isSome)(n))return e.plist.parse(n)
throw new Error(`Could not fetch Plist, response body was not defined for ${t.url}`)})},t.fetchData=async function(e,t,n,r){const o=h.buildURLFromRequest(e,n).toString(),s=(Date.now(),await t.refreshToken()),c=await i(e,t,o,s,r,!1,e.fetchTimingMetricsBuilder)
return Date.now(),n.canonicalUrl&&(c[a.requestedUrl]=n.canonicalUrl),c},t.redirectParametersInUrl=o
class w extends Error{}t.NetworkError=w
const g="x-apple-application-instance",v="x-apple-application-site"},5658:function(e,t,n){function r(e,t){const n=d.attributeAsDictionary(e,"platformAttributes")
return u.traverse(n,t)}function o(e,t,n){const o=r(e,t)
return u.isNull(o)?null:u.asDictionary(o,n)}function i(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asString(i,n,o)}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredPlatformAttributeAsDictionary=t.requiredPlatformAttributeAsString=t.platformAttributeAsNumber=t.platformAttributeAsBooleanOrFalse=t.platformAttributeAsBoolean=t.platformAttributeAsString=t.platformAttributeAsArrayOrEmpty=t.platformAttributeAsDictionary=t.hasPlatformAttribute=void 0
const l=n(2450),u=c(n(581)),d=c(n(377)),f=c(n(1636))
t.hasPlatformAttribute=function(e,t){const n=r(e,t)
return u.isDefinedNonNullNonEmpty(n)},t.platformAttributeAsDictionary=o,t.platformAttributeAsArrayOrEmpty=function(e,t,n){const o=r(e,t)
return u.isNull(o)?[]:u.asArrayOrEmpty(o,n)},t.platformAttributeAsString=i,t.platformAttributeAsBoolean=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asBoolean(i,n,o)},t.platformAttributeAsBooleanOrFalse=function(e,t,n){const o=r(e,t)
return!u.isNull(o)&&u.asBooleanOrFalse(o,n)},t.platformAttributeAsNumber=function(e,t,n,o="coercible"){const i=r(e,t)
return u.isNull(i)?null:u.asNumber(i,n,o)},t.requiredPlatformAttributeAsString=function(e,t,n){const r=i(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r},t.requiredPlatformAttributeAsDictionary=function(e,t,n){const r=o(e,t,n)
if((0,l.isNothing)(r))throw new f.MissingFieldError(e,d.concatObjectPaths(["attributes","platformAttribute",t],n))
return r}},4625:function(e,t,n){function r(e,t){return l.asInterface(e.relationships,t)}function o(e,t){const n=l.asArrayOrEmpty(e.relationships,[t,"data"])
return 0===n.length?null:(n.length,n[0])}function i(e,t){return l.asArrayOrEmpty(e.relationships,[t,"data"])}var s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n)
return a(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.requiredRelationshipCollectionNonEmpty=t.requiredRelationshipData=t.relationshipViewsCollection=t.relationshipCollection=t.relationshipData=t.relationship=t.hasRelationship=void 0
const l=c(n(581)),u=n(2450),d=c(n(1636))
t.hasRelationship=function(e,t,n=!0){const o=r(e,t)
return!((0,u.isNothing)(o)||n&&0===o.data.length)},t.relationship=r,t.relationshipData=o,t.relationshipCollection=i,t.relationshipViewsCollection=function(e,t){return l.asArrayOrEmpty(e.views,[t,"data"])},t.requiredRelationshipData=function(e,t){const n=o(e,t)
if((0,u.isNothing)(n))throw new d.MissingFieldError(e,["relationships",t,"data"])
return n},t.requiredRelationshipCollectionNonEmpty=function(e,t){const n=i(e,t)
if(0===n.length)throw new d.MissingFieldError(e,["relationships",t,"data"])
return n}},695:function(e,t,n){function r(e){switch(e){case"apps":case"app-events":case"activities":case"arcade-apps":case"app-bundles":case"charts":case"contents":case"developers":case"eula":case"in-apps":case"multiple-system-operators":case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"chart-list":default:return"catalog"
case"games/recommendations":return"games/recommendations"
case"categories":case"editorial-items":case"editorial-item-groups":case"editorial-elements":case"groupings":case"multiplex":case"multirooms":case"rooms":case"today":case"collections":return"editorial"
case"ratings":return"ratings"
case"personalization-data":case"reviews":return"me"
case"upsellMarketingItem":case"landing":case"engagement-data":return"engagement"
case"landing:new-protocol":case"recommendations":case"personal-recommendations":return"recommendations"}}var o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n)
var o=Object.getOwnPropertyDescriptor(t,n)
o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){var t,n
if(e&&e.__esModule)return e
if(t={},null!=e)for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n)
return i(t,e),t}
Object.defineProperty(t,"__esModule",{value:!0}),t.buildURLFromRequest=void 0
const a=n(2450),c=s(n(581)),l=s(n(4030)),u=s(n(377))
t.buildURLFromRequest=function(e,t){var n,o
const i=c.isDefinedNonNullNonEmpty(t.href)?t.href:function(e,t){switch(t){case"games/search":case"games/search-suggestions":return`/v1/games/${r(t)}/${e.mediaCountryCode}`
case"personalization-data":case"reviews":return`/v1/${r(t)}/`
default:return`/v1/${r(t)}/${e.mediaCountryCode}/`}}(e,t.resourceType),s=new l.URL(i)
if(c.isDefinedNonNullNonEmpty(t.resourceType))for(const e of function(e,t){switch(e){case"eula":return void 0===t?[e]:[e,t]
case"landing:new-protocol":case"recommendations":case"searchLanding:see-all":case"search-hints":case"games/recommendations":return[]
case"landing":return void 0===t?["search",e]:["search",e,t]
case"user-reviews":case"customers-also-bought-apps-with-download-intent":case"game-highlights":return["apps"]
case"reviews":return["reviews","apps"]
case"multiplex":return["multiplex"]
case"upsellMarketingItem":return["upsell","marketing-items"]
case"trending-contents":return["search",e]
case"player-highlights":return["players"]
case"search-suggestions":case"games/search":case"games/search-suggestions":case"search-groups":return["search"]
case"chart-list":return["charts"]
default:return[e]}}(t.resourceType,t.targetResourceType))s.append("pathname",e)
if(t.ids.size>1||(0,a.isSome)(t.useIdsAsQueryParam))s.param("ids",Array.from(t.ids).join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
s.append("pathname",encodeURIComponent(e))}if(t.seeds.size>0&&s.param("seeds",Array.from(t.seeds).join(",")),void 0!==t.resourceType){const e=function(e){switch(e){case"user-reviews":return"reviews"
case"customers-also-bought-apps-with-download-intent":return"view/customers-also-bought-apps-with-download-intent"
case"collections":default:return null
case"searchLanding:see-all":return"view/see-all"
case"search-hints":return"search/suggestions"
case"game-highlights":case"player-highlights":return"view/highlights"
case"games/search":case"search-groups":return"groups"
case"games/search-suggestions":case"search-suggestions":return"suggestions"}}(t.resourceType)
c.isDefinedNonNullNonEmpty(e)&&s.append("pathname",e)}if(s.param("platform",null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&s.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t.push("customArtwork"),t}(e)),e.sort(),s.param("extend",e.join(","))}if(c.isDefinedNonNull(t.ageRestriction)&&s.param("restrict[ageRestriction]",t.ageRestriction.toString()),c.isDefinedNonNull(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())s.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludesOnly.size>0?s.param("includeOnly",Array.from(t.relationshipIncludesOnly).sort().join(",")):t.relationshipIncludes.size>0&&s.param("include",Array.from(t.relationshipIncludes).sort().join(",")),t.shouldOmitAutomaticRelationship&&s.param("omit[resource]","autos"),c.isDefinedNonNull(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())s.param(`include[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())s.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())s.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNull(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())s.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(c.isDefinedNonNullNonEmpty(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=u.attributeKeyAsCustomAttributeKey(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),s.param("fields",e.join(","))}if(c.isDefinedNonNull(t.limit)&&t.limit>0&&s.param("limit",`${t.limit}`),c.isDefinedNonNull(t.sparseLimit)&&s.param("sparseLimit",`${t.sparseLimit}`),c.isDefinedNonNull(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())s.param(`sparseLimit[${e}]`,String(n))
c.isDefinedNonNull(t.sparseCount)&&s.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
s.param(`limit[${e}]`,`${n}`)}c.isDefinedNonNullNonEmpty(t.additionalQuery)&&s.append("query",t.additionalQuery),c.isDefinedNonNullNonEmpty(t.searchTerm)&&(((0,a.isNothing)(t.resourceType)||"search-hints"!==t.resourceType)&&(s.append("pathname","search"),s.param("bubble[search]",t.searchTypes.join(","))),s.param("term",t.searchTerm)),c.isDefinedNonNullNonEmpty(t.enabledFeatures)&&s.param("with",t.enabledFeatures.join(",")),c.isDefinedNonNullNonEmpty(t.context)&&s.param("contexts",t.context),c.isDefinedNonNullNonEmpty(t.filterType)&&c.isDefinedNonNullNonEmpty(t.filterValue)&&s.param(`filter[${t.filterType}]`,t.filterValue)
const f=e.mediaApiLanguage
return c.isDefinedNonNull(f)&&c.isNull(t.additionalQuery.l)&&s.param("l",f),c.isDefinedNonNullNonEmpty(t.responseFormat)&&s.param("format[resources]",t.responseFormat),s.host=null!==(o=function(e,t,n){var r
const o=null!==(r=t.pathname)&&void 0!==r?r:""
let i=null
return i=n.isStorePreviewRequest?e.mediaPreviewHost:n.isMediaRealmRequest?e.mediaRealmHost:o.includes("search/landing")?-1!==e.edgeEndpoints.indexOf("landing")?e.mediaEdgeHost:e.mediaHost:e.edgeEndpoints.map(e=>o.includes(e)).reduce(d,!1)?o.includes("search")&&!o.includes("view/see-all")?e.mediaEdgeSearchHost:e.mediaEdgeHost:e.mediaHost,c.isNull(i)&&(i="api.apps.apple.com"),i}(e,s,t))&&void 0!==o?o:void 0,s.protocol="https",s}
const d=(e,t)=>e||t}},n={}
e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{function t(e){return r(e)?null:Array.isArray(e)?e.join("."):e}function n(e,t,n){if(null==e)return n
if(!t)return e
let r
if(typeof t===gH){if(r=lq[t],!r){if(!t.includes(".")){const r=e[t]
return null!=r?r:n}r=t.split("."),lq[t]=r}}else r=t
let o=e
for(const e of r)if(o=o[e],null==o)return n
return o}function r(e){return null==e}function o(e){return r(e)||0===Object.keys(e).length}function i(e){return typeof e!==rB&&null!==e}function s(e){return!(0,Cv.isNothing)(e)&&(typeof e===gH||Array.isArray(e)?e.length>0:0!==Object.keys(e).length)}function a(e){if(r(e))return!1
let t
return t=typeof e===gH?parseInt(e):e,!Number.isNaN(t)}function c(e){return!(0,Cv.isNothing)(e)&&typeof e===gH}function l(e,t){var n
return null!==(n=w(e,t,[]))&&void 0!==n?n:[]}function u(e,t){return d(e,!1,t)}function d(e,o,i){const s=n(e,i,null)
return typeof s===A$?s:(r(s)||Iv.context("asBooleanWithDefault",()=>{Iv.unexpectedType(dV,A$,s,t(i))}),o)}function f(e,o,i=gV){const s=n(e,o,null)
if(r(s))return s
if(typeof s===gH)return s
{const e=typeof s===EG?null:String(s)
switch(i){case bD:Iv.context(rC,()=>{Iv.unexpectedType(IN,gH,s,t(o))})
break
case gV:r(e)&&Iv.context(rC,()=>{Iv.unexpectedType(IN,gH,s,t(o))})}return e}}function p(e,o,i=gV){const s=n(e,o,null)
if(r(s)||typeof s===aU)return s
{const e=Number(s)
switch(i){case bD:Iv.context(oC,()=>{Iv.unexpectedType(IN,aU,s,t(o))})
break
case gV:if(isNaN(e))return Iv.context(oC,()=>{Iv.unexpectedType(IN,aU,s,t(o))}),null}return e}}function h(e,o,s){const a=n(e,o,null)
return a instanceof Object&&!Array.isArray(a)?a:(r(a)||Iv.context("asDictionary",()=>{Iv.unexpectedType(dV,EG,a,t(o))}),i(s)?s:null)}function w(e,o,s){const a=n(e,o,null)
return Array.isArray(a)?a:(r(a)||Iv.context("asArray",()=>{Iv.unexpectedType(dV,"array",a,t(o))}),i(s)?s:null)}function g(e,t,n){return h(e,t,n)}function v(e,o,i=gV){const s=n(e,o,null)
if(r(s))return null
if(typeof s===A$)return s
if(typeof s===gH){if(s===FV)return!0
if(s===v$)return!1}const a=Boolean(s)
switch(i){case bD:Iv.context(iC,()=>{Iv.unexpectedType(IN,aU,s,t(o))})
break
case gV:if(r(a))return Iv.context(iC,()=>{Iv.unexpectedType(IN,aU,s,t(o))}),null}return a}function m(e){if(null==e)return null
switch(typeof e){case gH:case aU:case A$:return e
case EG:return Array.isArray(e),e
default:return Iv.context(sC,()=>{Iv.unexpectedType(dV,"JSONValue",typeof e)}),null}}function y(e){return null==e?null:e instanceof Object&&!Array.isArray(e)?e:(Iv.context(sC,()=>{Iv.unexpectedType(dV,EG,typeof e)}),null)}function A(e){throw new Error(`This method should never be called with value: ${e}`)}function T(e,t,n){const r=e.indexOf(t)
let o,i=e
if(-1!==r){const s=e.slice(0,r),a=e.slice(r+t.length,e.length)
n===fC?(o=s,i=a):(o=a,i=s)}return{result:o,remainder:i}}function b(e){if(null==e)return e
const t=Object.create(Object.getPrototypeOf(e))
return Object.assign(t,e),t}function S(e,t){return e instanceof t}function P(e){return!(!(0,Cv.isSome)(e.protocol)||-1===iY.indexOf(e.protocol))}function I(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t+1}function C(e){const t=e.indexOf("{"),n=e.indexOf("}")
return t>=0&&n>t?e.substring(t+1,n):e}function k(e,t){const n=t.indexOf("{"),r=e.length-(t.length-(t.indexOf("}")+1))
return n>=0&&r>n?e.substring(n,r):e}function O(e){return{success:!0,value:e,error:null,[cY]:!0}}function E(e){return{success:!1,value:null,error:e instanceof Error?e:new Error(String(e)),[cY]:!0}}async function R(e){return await x(e)}async function D(e){return await e}async function _(e){return await Promise.all(e.map(R))}async function x(e){try{const t="function"==typeof e?e():e
return O(await t)}catch(e){return E(e)}}function L(e){if(e.client.isCompanionVisionApp)return xj
switch(e.client.deviceType){case RH:return aH
case CH:return iH
case"tv":return ON
case $H:return $H
case MH:return MH
case kH:return xj
case JG:return JG
default:return null}}function M(e){return e.client.isPhone?2:1}function $(e){switch(e.client.deviceType){case RH:return 4
case CH:return 5
case"tv":return 6
case $H:return 5
case MH:return 10
default:return null}}function F(e){switch(e.client.deviceType){case RH:return 9
case CH:return 12
case"tv":case $H:return 15
case MH:return 3
case JG:return 12
default:return null}}function N(e){switch(e.host.clientIdentifier){case FD:case xL:case jC:return[]
default:{const t=L(e)
return function(e,t){const n=new Set
if(n.add(aH),n.add(iH),n.add(ON),n.add($H),n.add(MH),e.bag.enableVisionPlatform&&n.add(xj),(0,Cv.isSome)(t))for(const e of t)n.delete(e)
return Array.from(n)}(e,(0,Cv.isSome)(t)?new Set([t]):void 0)}}}function B(e){switch(e.client.deviceType){case RH:return 6
case CH:return 10
case $H:return 12
case kH:return 10
default:return 8}}function U(e){let t=null
return e.host.clientIdentifier===Qq?t=_V:e.host.clientIdentifier===Zq&&(t=MH),t}function G(e,t){if(o(t))return null
const n=l(t,`meta.associations.${e}.data`)
return(0,Cv.isNothing)(n)?null:[...n]}function j(e,t){const n=l(t,wG)
return n.length>1&&e.console.warn("tried to extract data from container but more than one member present"),1!==n.length?null:n[0]}function V(e){return l(e,wG)}function H(e){const t=tC,r=n(e,MO)
return e.label===t||i(r)}function q(e){return l(e,UP)}function W(e){return h(e,bE)}function z(e){if((0,Cv.isNothing)(e)||""===e)return null
const t=gJ.exec(e)
return null===t||4!==t.length&&5!==t.length?null:{red:parseInt(t[1],16)/255,green:parseInt(t[2],16)/255,blue:parseInt(t[3],16)/255,alpha:(0,Cv.isSome)(t[4])?parseInt(t[4],16)/255:void 0,type:hj}}function Y(e,t,n,r){return{red:e,green:t,blue:n,alpha:r,type:hj}}function J(e){return.2126*e.red+.7152*e.green+.0722*e.blue}function K(e,t=84){if((0,Cv.isNothing)(e))return!1
switch(e.type){case hj:return 100*J(e)<t
case lF:return e.name===Ck
default:return!1}}function Z(e){return{name:e,type:lF}}function Q(e,t){return{lightColor:e,darkColor:t,type:SL}}function X(e,t){return!(0,Cv.isNothing)(e)&&!(0,Cv.isNothing)(t)&&(e.type===hj&&t.type===hj?e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha:e.type===lF&&t.type===lF?e.name===t.name:e.type===SL&&t.type===SL&&X(e.lightColor,t.lightColor)&&X(e.darkColor,t.darkColor))}function ee(e,t){if((0,Cv.isNothing)(e))return!1
const n=function(e){return typeof e===EG&&null!==e&&(oj in e&&e.type===TC)}(e)?e:te(e)
return function(e){if(typeof e!==EG||null===e)return!1
const t=e
return"colorHex"in t&&typeof t.colorHex===gH&&"maxSaturation"in t&&typeof t.maxSaturation===aU&&"maxBrightness"in t&&typeof t.maxBrightness===aU}(t)?n.saturation<=t.maxSaturation||n.brightness<=t.maxBrightness:n.hue>=t.minHue&&n.hue<=t.maxHue}function te(e){const t=e.red,n=e.green,r=e.blue,o=Math.max(t,n,r),i=o-Math.min(t,n,r),s=100*o,a=0===o?0:i/o*100
let c=0
if(0!==i)switch(o){case t:c=60*((n-r)/i+(n<r?6:0))
break
case n:c=60*((r-t)/i+2)
break
case r:c=60*((t-n)/i+4)}return c=(c+360)%360,{type:TC,hue:c,saturation:a,brightness:s}}function ne(e,t,n){return(0,Cv.isNothing)(e)?null:h(e.attributes,t,n)}function re(e,t){return r(e)?[]:w(e.attributes,t)}function oe(e,t){var n
return null!==(n=re(e,t))&&void 0!==n?n:[]}function ie(e,t,n=gV){return r(e)?null:f(e.attributes,t,n)}function se(e,t,n=gV){return r(e)?null:v(e.attributes,t,n)}function ae(e,t){return!r(e)&&u(e.attributes,t)}function ce(e,t,n=gV){return r(e)?null:p(e.attributes,t,n)}function le(e){return!r(h(e,p$))}function ue(e){return!le(e)}function de(e){return qJ[e]}function fe(e){return e===TL||e===SD}function pe(e){var t
switch(e){case kD:return"arcadeAskToBuy"
case WU:return xm
case IL:return Lm
case OD:return"arcadeLaunchRepair"
case _j:return ED
case"topShelfATV":return"arcadeTopShelfATV"
case"topShelfATVClickThrough":return"arcadeTopShelfATVClickThrough"
case zU:return"arcadeTodayCard"
case RD:return"arcadeStoryCanvas"
case w$:return w$
case CN:return CN
case DC:return DC
default:return null!==(t=e)&&void 0!==t?t:xm}}function he(e){switch(e){case Lm:case ED:case _j:case IL:return!0
default:return!1}}function we(e){switch(e){case kF:return kF
case _C:return _C
default:return TH}}function ge(e,t,n=!0){const r=ve(e,t)
return!!r&&!(!r.data||n&&0===r.data.length)}function ve(e,t){return i(e)?g(e.relationships,t):null}function me(e,t){return g(e.views,t)}function ye(e,t,n){const r=l(t.relationships,[n,wG])
return 0===r.length?null:(r.length>1&&e.console.warn(`there was an array of relationships when only the first was asked for in relationship ${n}`),r[0])}function Ae(e,t,n=!1){return!ge(e,t,!1)&&n?null:l(e.relationships,[t,wG])}function Te(e,t){return l(e.views,[t,wG])}function be(e,t=!1,n=!1,r=0){const o=function(e,t){let n
switch(e.host.clientIdentifier){case FD:case xL:case jC:n=!1
break
default:n=e.client.supportsHEIF}return t?n?mM:n_:n?mM:lO}(e,t)
return function(e,t,n=!1,r=0){return new yq(t,t===mM?60:70,n)}(0,o,n,r)}function Se(e,t,n=0,r=0,o=null,i=null,s=null){const a=new Aq(t,n,r,[be(e,!1,!1,0)])
return a.backgroundColor=o,a.textColor=i,a.checksum=s,a}function Pe(e){return`resource://${e}`}function Ie(e,t){const n=Math.pow(10,t)
return(e>0?Math.floor:Math.ceil)(e/n)*n}function Ce(e,t,r){return e?Iv.context(t,()=>{let o=e[cK],i=null
return o?(i=n(o,t),i||(i=ke(o,t,r))):(o={},e[cK]=o,i=ke(o,t,r)),i}):null}function ke(e,t,n){const r=n()
return e[t]=r,r}function Oe(e,t){return n(ne(e,"platformAttributes"),null!=t?t:void 0)}function Ee(e,t){return s(Oe(e,t))}function Re(e,t,n){const o=Oe(e,t)
return r(o)?null:h(o,n)}function De(e,t,n){const o=Oe(e,t)
return r(o)?[]:l(o,n)}function _e(e,t,n,o=gV){const i=Oe(e,t)
return r(i)?null:f(i,n,o)}function xe(e,t,n,o=gV){const i=Oe(e,t)
return r(i)?null:v(i,n,o)}function Le(e,t,n){const o=Oe(e,t)
return!r(o)&&u(o,n)}function Me(e,t,n,r=!1){return Ce(t,`dataHasDeviceFamily.${n}`,()=>!(!t||!n)&&-1!==Ne(e,t,r).indexOf(n))}function $e(e,t,n,r=!1){var o
return null!==(o=Me(e,t,n,r))&&void 0!==o&&o&&1===Ne(e,t,r).length}function Fe(e,t,n,r=!1){const o=new Set(Ne(e,t,r))
return n.length===o.size&&n.every(e=>o.has(e))}function Ne(e,t,n=!1){const r=oe(t,MU)
if(0===r.length&&n){const r=Ae(t,BH)
if((0,Cv.isSome)(r))for(const t of r){const r=Ne(e,t,n)
if(s(r))return r}}return r}function Be(e,t,n,r,o){if(r||(r=qe(e,t)),(0,Cv.isNothing)(r))return null
let i=Re(t,r,n)
return i||(i=ne(t,n,o)),i}function Ue(e,t,n,r){const i=null!=r?r:qe(e,t)
if((0,Cv.isNothing)(i))return[]
let s=De(t,i,n)
return o(s)&&(s=oe(t,n)),s}function Ge(e,t,n,r,o=gV){let i
const s=null!=r?r:qe(e,t)
return(0,Cv.isSome)(s)&&(i=_e(t,s,n,o)),i||(i=ie(t,n,o)),i}function je(e,t,n,o,i=gV){if(o||(o=qe(e,t)),(0,Cv.isNothing)(o))return null
let s=xe(t,o,n,i)
return r(s)&&(s=se(t,n,i)),s}function Ve(e,t,n,o){if(o||(o=qe(e,t)),(0,Cv.isNothing)(o))return!1
let i=xe(t,o,n)
return r(i)&&(i=ae(t,n)),i}function He(e,t,n,o=gV){const i=qe(e,t)
if((0,Cv.isNothing)(i))return null
let s=function(e,t,n,o=gV){const i=Oe(e,t)
return r(i)?null:p(i,n,o)}(t,i,n,o)
return r(s)&&(s=ce(t,n)),s}function qe(e,t,n){const o="bestAttributePlatformFromData",i=(0,Cv.isSome)(n)?`${o}.${n}`:o
return Ce(t,i,()=>{const o=Fe(e,t,[aH,iH,$$],!0),i=$e(e,t,EU),s=$e(e,t,$H),a=$e(e,t,MH),c=$e(e,t,xj)
let l=null
if(i?l=RG:s?l=Gj:o?l=rH:a?l=MH:c&&(l=$j),!r(l))return l
const u=function(e,t){const n=We(e)
if(null===n)return[]
switch(n){case rH:return"VisionAppStore"===t||"com.apple.visionproapp"===t?[$j,rH,RG,Gj]:[rH,RG,Gj,$j]
case Gj:return[Gj,rH,RG,$j]
case RG:return[RG,rH,Gj,$j]
case MH:return[rH,MH,Gj,$j]
case $j:return[$j,rH,RG,Gj]
default:return[n]}}(e,n)
for(const e of u)if(Ee(t,e))return e
return We(e)})}function We(e){var t
if(null===(t=e.activeIntent)||void 0===t?void 0:t.attributePlatform)return e.activeIntent.attributePlatform
switch(e.client.deviceType){case RH:case CH:return rH
case"tv":return RG
case $H:return Gj
case MH:return MH
case kH:return $j
default:return null}}function ze(e,t,n,r,o){const i=de(r)
if((0,Cv.isNothing)(i))return null
const a=Xe(0,Be(e,t,jk,o),n,i,fe(i))
return s(a)?h(a):Be(e,t,r,o)}function Ye(e,t,n,r,o){const i=de(r)
if((0,Cv.isNothing)(i))return null
const a=Xe(0,Be(e,t,jk,o),n,i,fe(i))
return s(a)?f(a):Ge(e,t,r)}function Je(e,t){var n
const r=e.optional(dW.metatype)
return null===(n=null==r?void 0:r.currentTreatmentForExperiment(t))||void 0===n?void 0:n.identifier}function Ke(e){return"3NepyQj01"===Je(e,_v.ProductPagePreloading)}function Ze(e){return e.bag.enableProductPageVariants}function Qe(e,t,r){if(void 0===r&&(r=function(e){const t=function(e){return Je(e,_v.ProductPageVariants)}(e)
return t}(e)),o(t.id))return
const i={adamID:t.id,productPageId:lK,treatmentPageIdMap:{[lK]:lK},experimentIdMap:{},experimentLocaleMap:{}}
return o(n(t,WG,null))||(function(e,t,r){const i=n(r,"meta.cppData",null)
if(o(i))return
const a=f(i,wB)
s(a)&&(t.productPageId=a)}(0,i,t),function(e,t,r,i,a){const c=n(a,"meta.experimentData",null)
if(o(c))return
const l=n(c,r,null)
if(o(l))return
const u=f(l,VE),d=f(l,OS)
let p=null
const h=n(l,"trafficAllocation",null)
p=s(h)?function(e,t,n){if(void 0===n||o(n))return lK
for(const[e,r]of Object.entries(t))if(s(r)&&-1!==r.indexOf(n))return e
return lK}(0,h,i):function(e,t,n){const r=Be(e,t,`customAttributes.${n}`)
if(o(r))return lK
const i=Object.keys(r)[0]
return o(i)?lK:i}(e,a,r),s(p)&&s(u)&&(t.treatmentPageIdMap[r]=p,t.experimentIdMap[r]=u,s(d)&&(t.experimentLocaleMap[r]=d))}(e,i,lK,r,t)),i}function Xe(e,t,r,s,a){if(o(t))return null
let c
if(r.productPageId!==lK){const e=r.treatmentPageIdMap[lK]
c=a?[`${r.productPageId}.${lK}.${s}`,`${lK}.${e}.${s}`,`${lK}.${lK}.${s}`]:[`${r.productPageId}.${lK}.${s}`,`${lK}.${lK}.${s}`]}else{const e=r.treatmentPageIdMap[lK]
c=[`${lK}.${e}.${s}`,`${lK}.${lK}.${s}`]}for(const e of c){const r=n(t,e)
if(i(r))return r}return null}function et(e){return(0,Cv.isNothing)(e)||e.productPageId===lK?null:e.productPageId}function tt(e,t){return et(Qe(e,t))}function nt(e,t){const n=Be(e,t,jk)
return null===n||o(n)?null:Object.keys(n).filter(e=>e!==lK)}function rt(e){const t={}
it(e,xx)&&(t[ES]=e.productPageId)
const n=e.treatmentPageIdMap[lK],r=e.experimentIdMap[lK],o=e.experimentLocaleMap[lK]
return it(e,ax)&&(t.pageVariantId=n,t.pageExperimentId=r,t.pageExperimentLocale=o),t}function ot(e){const t={}
it(e,xx)&&(t[ES]=e.productPageId)
const n=e.treatmentPageIdMap[lK],r=e.experimentIdMap[lK],o=e.experimentLocaleMap[lK]
return it(e,ax)&&(t.variantId=n,t[VE]=r,t[OS]=o),t}function it(e,t){if(r(e))return!1
switch(t){case xx:return s(e.productPageId)&&e.productPageId!==lK
case ax:return s(e.experimentIdMap)
default:A(t)}}function st(e,t,n){for(const r of n){const n=tt(e,r)
i(n)&&t.addingQuery(`ppid[apps:${r.id}]`,`${n}`)}}function at(e,t){var n,o,a
const c=t.href&&t.href.length>0?t.href:function(e,t,n,r){switch(n){case pD:case pH:case u$:return`/v1/${ct(n)}/`
default:const o=(0,Cv.isSome)(r)&&r.length>0?r:e.bag.mediaCountryCode,i=`/v1/${ct(n)}/${o}`
return t?i:`${i}/`}}(e,t.isMixedMediaRequest,t.resourceType,t.countryCodeOverride),l=new oY(c)
if(s(t.resourceType))for(const e of function(e,t){switch(e){case IB:return void 0===t?[e]:[e,t]
case OR:return[]
case cL:return void 0===t?[JV,e]:[JV,e,t]
case yL:return[BH]
case pH:return[pH,BH]
case vL:return[vL]
case XU:return[Iy,XG]
case XI:return[JV,e]
case mL:return[BH]
case AL:case aL:return[]
case u$:return[BH]
default:return[e]}}(t.resourceType,t.targetResourceType))l.append(jG,e)
if(t.isMixedMediaRequest)for(const[e,n]of t.idsByResourceType.entries())l.param(`ids[${e}]`,Array.from(n).sort().join(","))
else if(t.ids.size>1||t.useIdsAsQueryParam)l.param("ids",Array.from(t.ids).sort().join(","))
else if(1===t.ids.size){const e=t.ids.values().next().value
l.append(jG,e)}if(void 0!==t.resourceType){const e=function(e){switch(e){case yL:return pH
case mL:return"view/customers-also-bought-apps-with-download-intent"
case cj:return FH
case AL:return lC
case aL:return"search/suggestions"
default:return null}}(t.resourceType)
s(e)&&l.append(jG,e)}if(l.param(KG,null!==(n=t.platform)&&void 0!==n?n:void 0),t.additionalPlatforms.size>0&&l.param("additionalPlatforms",Array.from(t.additionalPlatforms).sort().join(",")),t.attributeIncludes.size>0||t.useCustomAttributes){let e=Array.from(t.attributeIncludes)
t.useCustomAttributes&&(e=function(e,t){const n=t.map(e=>{var t
return null!==(t=de(e))&&void 0!==t?t:e})
return n.push(TL),t.includes(Zj)&&n.push(Zj),n.push(xM),n}(0,e)),e.sort(),l.param(_I,e.join(","))}if(i(t.ageRestriction)&&e.bag.enableAgeRatingFilter&&l.param("restrict[ageRestriction]",t.ageRestriction.toString()),t.includeAppBinaryTraitsAttribute&&t.includingScopedAttributes(BH,[bA]),i(t.scopedAttributeIncludes))for(const[e,n]of t.scopedAttributeIncludes.entries())l.param(`extend[${e}]`,Array.from(n).sort().join(","))
if(t.relationshipIncludes.size>0&&l.param("include",Array.from(t.relationshipIncludes).sort().join(",")),i(t.scopedRelationshipIncludes))for(const[e,n]of t.scopedRelationshipIncludes.entries())l.param(`include[${e}]`,Array.from(n).sort().join(","))
if(i(t.metaIncludes))for(const[e,n]of t.metaIncludes.entries())l.param(`meta[${e}]`,Array.from(n).sort().join(","))
if(i(a=t.viewsIncludes)&&a.size>0&&l.param("views",Array.from(t.viewsIncludes).sort().join(",")),i(t.kindIncludes))for(const[e,n]of t.kindIncludes.entries())l.param(`kinds[${e}]`,Array.from(n).sort().join(","))
if(i(t.associateIncludes))for(const[e,n]of t.associateIncludes.entries())l.param(`associate[${e}]`,Array.from(n).sort().join(","))
if(i(t.scopedAvailableInIncludes))for(const[e,n]of t.scopedAvailableInIncludes.entries())l.param(`availableIn[${e}]`,Array.from(n).sort().join(","))
if(s(t.fields)){let e=Array.from(t.fields)
t.useCustomAttributes&&(e=function(e){const t=e.map(e=>{var t
return null!==(t=de(e))&&void 0!==t?t:e})
return t}(e)),t.fields.sort(),l.param(ML,e.join(","))}if(i(t.limit)&&t.limit>0&&l.param("limit",`${t.limit}`),i(t.sparseLimit)&&l.param("sparseLimit",`${t.sparseLimit}`),i(t.scopedSparseLimit))for(const[e,n]of t.scopedSparseLimit.entries())l.param(`sparseLimit[${e}]`,String(n))
i(t.sparseCount)&&l.param("sparseCount",`${t.sparseCount}`)
for(const e of Object.keys(t.relationshipLimits).sort()){const n=t.relationshipLimits[e]
l.param(`limit[${e}]`,`${n}`)}s(t.additionalQuery)&&l.append(UU,t.additionalQuery),s(t.searchTerm)&&(((0,Cv.isNothing)(t.resourceType)||t.resourceType!==aL)&&(l.append(jG,JV),l.param("bubble[search]",t.searchTypes.join(","))),l.param(RN,t.searchTerm)),s(t.enabledFeatures)&&l.param(l_,t.enabledFeatures.join(",")),s(t.context)&&l.param(hU,t.context),s(t.filterType)&&s(t.filterValue)&&l.param(`filter[${t.filterType}]`,t.filterValue)
const u=e.bag.mediaApiLanguage
return i(u)&&r(t.additionalQuery.l)&&l.param("l",u),l.host=null!==(o=function(e,t,n){var o
const i=null!==(o=t.pathname)&&void 0!==o?o:""
let s=null
return s=n.isStorePreviewRequest?e.bag.mediaPreviewHost:n.isMediaRealmRequest?e.bag.mediaRealmHost:i.includes("search/landing")?-1!==e.bag.edgeEndpoints.indexOf(cL)?e.bag.mediaEdgeHost(e):e.bag.mediaHost:n.resourceType===u$&&(0,Cv.isSome)(e.bag.appDistributionMediaAPIHost)?e.bag.appDistributionMediaAPIHost:n.isMixedMediaRequest&&e.bag.mediaAPICatalogMixedShouldUseEdge?e.bag.mediaEdgeHost(e):e.bag.edgeEndpoints.map(e=>i.includes(e)).reduce(gK,!1)?i.includes(JV)&&!i.includes(lC)?e.bag.mediaEdgeSearchHost:e.bag.mediaEdgeHost(e):e.bag.mediaHost,r(s)&&(s="api.apps.apple.com"),s}(e,l,t))&&void 0!==o?o:void 0,l.protocol=vD,l}function ct(e){switch(e){case BH:case DH:case kj:case IH:case L$:case FH:case _G:case IB:case kV:case px:case yL:case mL:return aC
case _F:case vV:case OH:case sG:case sM:case pj:case vL:case o$:case TF:case PH:case cj:return UC
case PD:return PD
case pD:case pH:return"me"
case XU:case cL:return cC
case OR:case u_:return jj
case RI:return cC
case u$:return"listing"
default:return aC}}function lt(e){return r(e)||""===e?null:(-1!==e.indexOf("T")&&(e=e.split("T")[0]),new Date(e.replace(/-/g,"/")))}function ut(e){if(r(e))return null
const t=function(e){return r(e)?null:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))}(e)
return r(t)?null:t.getTime()}function dt(e){if(r(e))return null
const t=new Date(e)
return t.setHours(0,0,0,0),t}function ft(e){return r(e)?null:pt(e)}function pt(e){const t=new Date(e.getTime())
return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function ht(e,t){return r(e)||r(t)?null:Math.ceil((t.getTime()-pt(e).getTime())/36e5)}function wt(e){return g(function(e){return l(e,"meta.associations.editorial-cards.data")}(e)[0])}function gt(e){return null!==vK||(vK={bundleIdFromData:t=>Ge(e,t,zV),isSystemAppFromData:e=>ae(e,DB),isUnsupportedDeletableSystemAppFromData:e=>!1,adamIdFromSystemBundleId(e){}}),vK}function vt(e,t,n=80894){let o=!1
return 2&n&&(o=o||function(e,t){return Ve(e,t,Hm)||Ve(e,t,qm)}(e,t)),4&n&&(o=o||function(e,t){return Ce(t,"shouldFilterDeletableSystemApp",()=>{const n=gt(e)
if(!n.isSystemAppFromData(t))return!1
const r=n.bundleIdFromData(t),o=e.host.deviceModel,s=o.startsWith(WC),a=o.startsWith(Ym)
let c
switch(c=!!nf(e,"12.3")||e.bag.isTVAppEnabled,r){case"com.apple.Bridge":case"com.apple.Passbook":return!s
case"com.apple.Photo-Booth":return!a
case"com.apple.tv":return!c
case"com.apple.videos":return c
case"com.apple.iCloudDriveApp":return!0
case"com.apple.facetime":case"com.apple.mobilephone":return!yt(e,"any-telephony")||!yt(e,"venice")
case"com.apple.Fitness":if(a||s){let t=!1
return i(e.user.isFitnessAppInstallationAllowed)&&(t=e.user.isFitnessAppInstallationAllowed),!t}return!0
case"com.apple.measure":return!yt(e,"arkit")
case"com.apple.Jellyfish":return!yt(e,"front-depth-camera")
case Wm:case zm:return!0
case"com.apple.NanoHeartRhythm":return!e.client.isElectrocardiogramInstallationAllowed
case Jm:return!yt(e,"magnetometer")
case"com.apple.NanoOxygenSaturation.watchkitapp":return!e.client.isScandiumInstallationAllowed
case Km:case"com.apple.NanoRadio":return!0
case Zm:return!e.client.isCharonSupported
case Qm:return!e.client.isMandrakeSupported
case"com.apple.GenerativePlaygroundApp":return!yt(e,"generative-model-systems")
case VC:const t=a&&e.clientCapabilities.isEnabled("FBEF7E28-E3DF-4484-A7D7-2FE19E43D2B8")
return!(s||t)}return!1})}(e,t)),8&n&&(o=o||function(e,t){return Ce(t,"shouldFilterUnsupportedWatchAppOnWatchClient",()=>{const n=Ve(e,t,Nj),r=t.type===IH
return e.host.clientIdentifier===Zq&&!n&&!r})}(e,t)),16&n&&(o=o||function(e,t){return t.type===kV&&!s(h(t,S$))&&!s(h(t,GD))&&!ae(t,"isMerchandisedEnabled")}(0,t)),32&n&&(o=o||function(e,t){return Ce(t,"shouldFilterLegacyApps",()=>{switch(Ge(e,t,zV)){case"com.apple.mobileme.fmip1":case Wm:return!0}return!1})}(e,t)),64&n&&(o=o||function(e,t){return Ce(t,"isLegacyMacOSInstaller",()=>(Ge(e,t,zV),!1))}(e,t)),128&n&&(o=o||function(e,t){return Ce(t,"shouldFilterUnsupportedPlatform",()=>{if(t.type!==BH&&t.type!==IH)return!1
const n=md(e,t),r=Pd(0,t,e.appleSilicon.isSupportEnabled)
return!Ed(e,t,n,e.client.deviceType,r,!1)})}(e,t)),16384&n&&(o=o||function(e,t){return Ce(t,"shouldFilterUnsupportedPlatformForCharts",()=>{if(t.type!==BH&&t.type!==IH)return!1
const n=md(e,t),r=Pd(0,t,!0)
return!Ed(e,t,n,e.client.deviceType,r,!1)})}(e,t)),256&n&&(o=o||function(e,t){return Ce(t,"shouldFilterUnsupportedPreordersOnPlatform",()=>{if(!ae(t,VV))return!1
if(t.type!==BH)return!1
const n=md(e,t),r=Pd(0,t,e.appleSilicon.isSupportEnabled)
return!_d(0,n,e.client.deviceType,r,!1)})}(e,t)),512&n&&(o=o||mt(e,t)),1024&n&&(o=o||function(e,t){const n=ae(t,DB),r=!Ve(e,t,YC)&&Ve(e,t,uU)
return n&&r}(e,t)),2048&n&&(o=o||function(e,t){return e.client.deviceType===MH&&(!Ve(e,t,uU)&&!Ve(e,t,zC)&&!function(e,t){return!(!r(t)&&0!==t.length)||e.client.isPairedSystemVersionAtLeast(t)}(e,_e(t,qe(e,t),eV)))}(e,t)),4096&n&&(o=o||function(e,t){return e.client.deviceType===$H&&(Ve(e,t,jD,We(e))&&!e.appleSilicon.isSupportEnabled)}(e,t)),8192&n&&(o=o||function(e,t){const n=md(e,t)
return!(e.client.deviceType!==$H||!n.includes($H))&&!Dd(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable)}(e,t)),32768&n&&(o=o||function(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=Le(t,rH,JC)
return!(md(e,t).indexOf(kH)>-1||n)}(e,t)),65536&n&&(o=o||function(e,t){return!!gt(e).isSystemAppFromData(t)&&mt(e,t)}(e,t)),o}function mt(e,t){return!(!e.client.isPhone||!Ve(e,t,uU)||function(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=p(n[0])||0,i=p(n[1])||0,s=p(n[2])||0
return e.client.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(o,i,s)}(e,Ge(e,t,P$)))||!nf(e,Cd(e,t,e.appleSilicon.isSupportEnabled))}function yt(e,t,n){return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp([t],!1)}function At(e){return e.startsWith("id")?e.substring(2):e}function Tt(e){if((0,Cv.isNothing)(e))return
const t=e.toLocaleLowerCase()
return function(e){return mK.includes(e)}(t)?t:void 0}function bt(e,t){return t&&t.remainingContent?t.remainingContent.slice(0,t.maxPerPage):[]}function St(e,t,n){const r={...t}
if(t&&t.remainingContent){const e=Pt(0,t.remainingContent,t.maxPerPage,n)
r.remainingContent=e}return r}function Pt(e,t,n,r){return t.slice(n,null!=r?r:t.length)}function It(e,t){return i(t)?ie(t,"customUrl"):null}function Ct(e,t,n,r,o,i,a){if(!s(o)&&e.client.deviceType!==$H)return t
let c
{const e=new VW(n,SH)
c=new Tz(r,o,e)}const l=b(a)
if(l.actionType=qG,l.actionDetails={actionUrl:o},sp(e,c,l,!0,NH),t instanceof jW)return t.openAction=c,t.includeBetaApps=i,t
{const e=new jW(n,t)
return e.openAction=c,e.includeBetaApps=i,e}}function kt(e,t,n=!1){const r=ie(t,"ageRating.name")
return(0,kv.isSome)(r)?r:n?ie(t,iA):void 0}function Ot(e,t,n=!1){const r=ce(t,sA)
return(0,kv.isSome)(r)?r:n?ce(t,"contentRatingsBySystem.appsApple.value"):void 0}function Et(e,t){const n=new Map([["br.100.official",cA],["br.100",lA],["br.210.official",uA],["br.210",dA],["br.300.official",fA],["br.300",pA],["br.314.official",hA],["br.314",wA],["br.416.official",gA],["br.416",vA],["br.618.official",mA],["br.618",yA]]),r=e.locale.activeStorefront+"."+ie(t,sA)+(ae(t,"ageRating.isOfficial")?".official":"")
return n.get(r)}function Rt(e,t){var n
if(t<=0)return!1
if(t>=1)return!0
const r=null===(n=e.metricsIdentifiersCache)||void 0===n?void 0:n.getMetricsIdForType(xv.user)
return!(0,kv.isNothing)(r)&&0!==r.length&&!(r.length<2)&&function(e){function t(e){const t=e.charCodeAt(0)
return t>=48&&t<=57?52+t-48:t>=65&&t<=90?26+t-65:t>=97&&t<=122?t-97:t}const n=e.slice(-2)
return(62*t(n[0])+t(n[1]))/3843}(r)<t}function Dt(e,t){switch(xt(e,t)){case WD:case FL:case YD:case zD:case VA:return!0
default:return!1}}function _t(e,t){return Rt(e,e.bag.gameControllerRecommendedRolloutRate)&&xt(e,t)===VA}function xt(e,t){const n=We(e)
if(null===n)return EB
if(!Ee(t,n)){const r=Be(e,t,Kj)
if(null===r||o(r))return EB
const i=r[n]
return o(i)?EB:i}const r=Ge(e,t,xB)
return s(r)?r:EB}function Lt(e,t){return We(e),HA}function Mt(e,t=null){return e===$H?function(e){let t="x-apple.systempreferences:com.apple.preferences.softwareupdate?client=AppStore&variant=CUSTOMER"
return e&&(t+=`&installMajorOSBundle=${e}`),t}(t):null}function $t(e){var t
return null===JK&&(JK=new _4({defaultTopic:e.bag.metricsTopic,buildType:e.client.buildType,jsVersion:null!==(t=e.packageProperties.asString("version"))&&void 0!==t?t:TH,buyDecorator:YK,isLoggingEnabled:!0,bagProvider:(t,o)=>{const i=e.bag.metricsConfiguration
if(!r(o)){const e=n(i,[o,t])
if(!r(e))return e}return n(i,t)}})),JK}function Ft(e){var t
const n={}
if(!e)return n
Object.assign(n,e.baseFields),e.pageUrl?n[wN]=e.pageUrl:e.timingMetrics&&e.timingMetrics.pageURL&&(n[wN]=e.timingMetrics.pageURL),e.recoMetricsData&&Object.assign(n,e.recoMetricsData),e.mercuryMetricsData&&Object.assign(n,e.mercuryMetricsData),e.productVariantData&&Object.assign(n,rt(e.productVariantData)),e.iAdInfo&&i(e.iAdInfo.pageFields[_4.hasIAdData])&&(n[_4.hasIAdData]=e.iAdInfo.pageFields[_4.hasIAdData])
const r=null===(t=e.iAdInfo)||void 0===t?void 0:t.pageFields[oU]
return i(r)&&(n[oU]=r),yf(n)}function Nt(e,t,n,a,c,l,u,d,p,h,w,g,v,m,A){const T=function(e,t){const n=new sK(t),r=f(e.bag.metricsConfiguration,"metricsBase.language")
return n.set("languageId",r),n.toString()}(e,n)
return function(e,t,n,o,s,a,c){const l=new sK(t)
return function(e,t,n,o,s,a,c){var l,u
const d=f(a,MM)
t.set(MM,d)
const p=e.clientCapabilities.isEnabled(rE)?e.bag.metricsPaymentTopic:void 0
t.set(zL,null!=p?p:e.bag.metricsTopic),YK.useNativeValues(a)
const h=YK.params
for(const e of Object.keys(h)){if(e===Px&&(0,Cv.isSome)(t.get(Px)))continue
const n=f(h,e)
t.set(e,n)}if(!r(c))for(const e of Object.keys(c)){const n=f(c,e)
t.set(e,n),t.set(e,n,null)}if(!a)return t.set(oV,null),void t.set(Ix,null)
const w=f(a,lB);(0,Cv.isSome)(w)&&w.length>0&&t.set(lB,w)
const g=(null===(l=t.get(Tb,null))||void 0===l?void 0:l.length)>0,v=f(a,SH)
if(g?t.set(SH,e.host.clientIdentifier):(0,Cv.isSome)(v)&&v.length>0&&t.set(SH,v),!o&&!SW.shared.shouldUseJSReferralData){const e=f(a,BM),n=mf(e)
e&&n&&(a[$M]=n)
const r=f(a,"usageContext")
if((0,Cv.isSome)(r)){switch(r){case dj:t.set(lB,"com.apple.AppStore.overlay")
break
case oE:t.set(lB,nE)}t.set(NM,w,null)}else{const e=f(a,NM)
t.set(NM,e,null)
const n=f(a,BM)
t.set(BM,n,null),f(a,"extRefAppType")===Pb&&t.set(lB,nE)}}const m=t.get(rU),y=t.get(iG),A=(null!==(u=null==m?void 0:m.split("_"))&&void 0!==u?u:[]).includes(n)
if(y!==uj||A){const e=Tf(f(a,vN))
i(e)&&t.set(oV,e)}t.set(gb,null,null)}(e,l,n,o,0,a,c),l.toString()}(e,function(e,t,n,a,c,l,u,d,p,h,w,g){const v=new sK(t)
return function(e,t,n,s,a,c,l,u,d,p,h,w){var g,v,m
const A=Ft(s)
a&&t.set(FM,a),c&&t.set(rV,c)
const T=f(y(A),rU)
t.set(rU,T)
const b=f(y(A),iG)
t.set(iG,b)
const S=f(y(A),cB);(0,Cv.isSome)(S)&&S.length>0&&t.set(KK.containerId,S,null)
const P=(null!==(g=null==T?void 0:T.split("_"))&&void 0!==g?g:[]).includes(n),I=b===uj,C=(null===(v=t.get(Tb,null))||void 0===v?void 0:v.length)>0
if(!I||P||C){let e=f(y(s),"searchTermContext.resultsTerm")
o(e)&&(e=function(e){if((0,kv.isNothing)(e))return null
const t=new oY(e),n=t.query,r=null==n?void 0:n[oV],o=t.pathname
return(0,kv.isNothing)(r)||(0,kv.isNothing)(o)?null:o.includes("/app")?r:null}(null==s?void 0:s.pageUrl)),r(e)||t.set(oV,e)}if(I&&(0,Cv.isSome)(s)&&(0,Cv.isSome)(s.pageUrl)&&(null===(m=new oY(s.pageUrl).query)||void 0===m?void 0:m[eE])===bb&&(t.set(Px,tE),t.set(Sb,"1",null)),function(e,t,n,r){const o=i(n)&&n.adamID===t,s=i(r)&&r.adamID===t&&!o
if(o&&i(n)){const t=rt(n)
for(const n of Object.keys(t)){const r=f(t,n);(0,Cv.isSome)(r)&&e.set(n,r)}}if(s&&i(r)){const t=ot(r)
for(const n of Object.keys(t)){const r=f(t,n);(0,Cv.isSome)(r)&&e.set(n,r)}}}(t,n,null==s?void 0:s.productVariantData,null!=u?u:void 0),!r(l)&&l.length>0&&t.set(Ix,l),t.set(WL,d),!p)if(i(SW.shared.activeReferralData)){if(t.set(NM,SW.shared.activeReferralData.extRefApp2,null),t.set(BM,SW.shared.activeReferralData.extRefUrl2,null),(0,Cv.isSome)(SW.shared.activeReferralData.kind)){const e=SW.shared.activeReferralData.kind.name
e!==Pb&&"appClip"!==e||t.set(lB,nE)}}else t.set(NM,h,null),t.set(BM,w,null)}(0,v,n,a,c,l,u,d,p,h,w,g),function(e,t,n){var r
if((0,Cv.isNothing)(n))return
const o=[]
if(s(o)){const n=o.map(e=>`${e.key}=${e.value}`).join(";"),i=null===(r=e.cryptography)||void 0===r?void 0:r.base64Encode(n);(0,Cv.isSome)(i)&&t.set("extraInfo",i)}}(e,v,a),v.toString()}(e,T,t,a,u,d,p,g,v,c,m,A),t,c,0,h,w)}function Bt(e,t){const n=Ve(e,t,"usesExternalPurchase"),r=Ve(e,t,"usesExternalLinkPurchase")
return n||r}function Ut(e,t){return e.bag.enableExternalPurchases&&e.bag.enabledExternalPurchasesPlacements.includes(t)}function Gt(e,t,n,r){const i=e.bag.externalPurchasesLearnMoreEditorialItemId
if(o(i)||!e.bag.enableExternalPurchases)return null
const s=new dY(XV)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,sp(e,s,{id:LN,targetType:uH,actionType:UH,pageInformation:n,locationTracker:r}),s}function jt(e,t,n){return Iv.context("offerDataFromData",()=>{const r=Ue(e,t,GU,n)
return 0===r.length?null:r[0]})}function Vt(e,t){const n=oe(t,GU)
return 0===n.length?null:n[0]}function Ht(e,t,n,o,a,c,l,u=sH,d,p,h){return Iv.context(`offerActionFromOfferData: ${n.id}`,()=>{var w,g,v,m,y,A,T
let b=f(t,ZU)
if(r(b))return Iv.unexpectedNull(Qj,gH,jO),null
if(n.type===IH&&(b.indexOf("rebuy")>=0?b=b.replace("rebuy=false",nS):(b.length>0&&(b+="&"),b+=nS)),s(l.inAppEventId)&&(b.length>0&&(b+="&"),b+=`mtInAppEventId=${l.inAppEventId}`),l.isAdvert){const e=null===(g=null===(w=l.pageInformation)||void 0===w?void 0:w.iAdInfo)||void 0===g?void 0:g.placementId
i(e)&&(b.length>0&&(b+="&"),b+=`${KK.placementId}=${e}`)
const t=null===(m=null===(v=l.pageInformation)||void 0===v?void 0:v.iAdInfo)||void 0===m?void 0:m.containerId
i(t)&&(b.length>0&&(b+="&"),b+=`${KK.containerId}=${t}`)
const n=null===(A=null===(y=l.pageInformation)||void 0===y?void 0:y.iAdInfo)||void 0===A?void 0:A.clickFields[jM]
i(n)&&(b.length>0&&(b+="&"),b+=`${KK.templateType}=${n}`)}const S=n.id
if(r(S))return Iv.unexpectedNull(Qj,gH,"item.offer.id"),null
const P=function(e,t,n,r,o,i,s,a,c,l){return Iv.context("purchaseConfigurationFromProduct",()=>{const u=ie(t,GH)
let d=ie(t,Cj)
d||(d=CE)
const p=gt(e).bundleIdFromData(t),h=md(e,t),w=ie(t,ib),g=Ge(e,t,"preflightPackageUrl"),v=Jd(e,t),m=Pd(0,t,e.appleSilicon.isSupportEnabled),y=f(c,SH),A=f(c,DF),T=sn(e,t)?e.client.remoteDownloadIdentifiers:[],b=function(e,t){return Ve(e,t,SV)}(e,t),S=Ot(0,t,!0),P=new gq(n,d,u,p,h,r,o,s,w,!1,g,v,m,!1,a.inAppEventId,y,A,void 0,Id(e,t),l,T,b,S)
return P.pageInformation={...i},P.productVariantData=Qe(e,t),P.targetType=a.targetType,P.metricsKind=a.kind,P})}(e,n,b,o,l.excludeAttribution,l.pageInformation,c,l,d,p),I=Yt(e,t,S,P,a,u,null!==(T=l.isAdvert)&&void 0!==T&&T,h)
return function(e,t,n,r,o){var i,s,a,c,l
const u=n.pageInformation,d=If(e,{...n,targetType:NH},null!==(i=t.title)&&void 0!==i?i:"")
let f=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:t.adamId;(0,Cv.isSome)(n.targetId)&&(null===(c=n.targetId)||void 0===c?void 0:c.length)>0&&(f=n.targetId),op(e,t,f,r,u,d,null!==(l=n.isAdvert)&&void 0!==l&&l,n.recoMetricsData,o)}(e,I,l,o,p),I})}function qt(e,t){return r(t)||r(t.price)||0===t.price}function Wt(e,t){return Iv.context("expectedReleaseDateFromData",()=>lt(ie(t,"offers.0.expectedReleaseDate")))}function zt(e,t){const n=f(t,oj)
return n===eM||n===Mx||n===Ej?p(t,I$):null}function Yt(e,t,n,r,o,i=sH,s=!1,a){return Iv.context("offerActionFromOfferData",()=>{const c=f(t,oj),l=s&&i===sH&&(0,Cv.isSome)(e.bag.adsOverrideLanguage)?e.adsLoc:e.loc
let u
switch(c){case"get":if(i===DG)u=e.loc.string(rS,"Get")
else{const e=$x
u=l.string(e)}break
case Ej:u=i===DG?e.loc.string(oS,"Pre-Order"):l.string($x)
break
default:u=c}let d=null,p=null
const h=zt(0,t)
h>0&&(d=h,p=f(t,_U))
const w=lt(f(t,HN)),g=new FW(u,n,r,a)
return g.price=d,g.priceFormatted=p,g.expectedReleaseDate=w,g.includeBetaApps=o,g})}function Jt(e,t,n,o,i,a=sH,c=null,l=!1){if((0,Cv.isNothing)(t))return null
if(Qd(0,n)){if(a===DG)return null
if(a===sH)return ju(e,n,i,null)
const r=Ge(e,n,zV)
if(s(r)){const e=Mt($H,r)
if((0,Cv.isSome)(e)){const n=new MW(e)
return new jW(t.adamId,n)}}}if(a===sH&&(n.type===IH||Xd(e,n)||l))return ju(e,n,i,null)
if(o&&"tv"!==e.client.deviceType&&!Jd(e,n)){const o=function(e,t,n,o,i){if(r(t))return null
const s=Zt(e,n,t,!1,o)
return s.buyAction=t,s}(e,t,n,i)
if(null!==o)return o}const u=$e(e,n,xj),d=e.client.isCompanionVisionApp
if(!Jd(e,n)&&(d||u&&e.client.deviceType!==kH))return function(e,t,n,r,o){const i=rn(e,t,n,r,o),s=new jW(t.adamId,i)
return s.title=t.title,s}(e,t,n,qt(0,t),Jd(e,n))
if($e(e,n,EU)&&"tv"!==e.client.deviceType)return function(e,t,n){const r=new tz(sH)
r.title=e.loc.string("Alert.Buy.TvOnly.Title"),r.message=e.loc.string("Alert.Buy.TvOnly.Message"),r.isCancelable=!0,r.buttonActions=n?[cn(e,t)]:[t],r.buttonTitles=[e.loc.string("Alert.Buy.TvOnly.ButtonTitle")]
const o=new jW(t.adamId,r)
return o.title=t.title,o}(e,t,Ve(e,n,$L))
if(!Ve(e,n,YC)&&Ve(e,n,uU)&&e.client.deviceType!==MH)return function(e,t){const n=new tz(sH)
n.title=e.loc.string("Alert.Buy.WatchOnly.Title"),n.message=e.loc.string("Alert.Buy.WatchOnly.Message"),n.isCancelable=!0,n.buttonActions=[t],n.buttonTitles=[e.loc.string("Alert.Buy.WatchOnly.ButtonTitle")]
const r=new jW(t.adamId,n)
return r.title=t.title,r}(e,t)
const f=Ge(e,n,P$)
if(s(c)&&c===Zq&&(0,Cv.isSome)(f)&&rf(e,f))return function(e,t,n){const r=new tz(sH)
r.title=e.loc.string("ProductPage.WatchOSUpdateRequired.Title").replace(PU,n),r.message=e.loc.string("ProductPage.WatchOSUpdateRequired.Message").replace(PU,n),r.buttonActions=[t],r.buttonTitles=[e.loc.string(h_)]
const o=new jW(t.adamId,t)
return o.buyAction=r,o}(e,t,f)
if(function(e,t){return!!Jd(e,t)}(e,n)){if(Jd(e,n))return function(e,t,n,r,o,i,s){if(!Jd(e,n))return t
switch(e.client.deviceType){case"tv":return function(e,t,n,r,o,i){var s,a,c,l
const u=en(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,p=he(o),h=new KJ(xH,o,e.bag.metricsTopic,n.id);(0,Cv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(h.metricsOverlay[oV]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical]);(0,Cv.isSome)(w)&&(h.metricsOverlay={...h.metricsOverlay,...w}),p&&(h.purchaseSuccessAction=f,h.carrierLinkSuccessAction=f)
const g=new dY(XU)
if(g.pageData=h,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),d instanceof FW&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),ip(e,g,i),r){const t=Zt(e,n,f,!0,i)
t.buyAction=d
const r=Zt(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=null,t}{const o=new jW(n.id,d),i=en(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
case kH:return function(e,t,n,r,o,i){var s,a,c,l
const u=tn(e,t,null,n,r),d=u.startAction,f=u.underlyingOfferAction,p=he(o),h=new KJ(xH,o,e.bag.metricsTopic,n.id);(0,Cv.isSome)(null===(a=null===(s=i.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(h.metricsOverlay[oV]=null===(c=i.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const w=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical]);(0,Cv.isSome)(w)&&(h.metricsOverlay={...h.metricsOverlay,...w}),p&&(h.purchaseSuccessAction=f,h.carrierLinkSuccessAction=f)
const g=new dY(XU)
if(g.pageData=h,i&&i.pageInformation&&(g.referrerUrl=i.pageInformation.pageUrl),d instanceof FW&&(i.actionDetails={buyParams:d.purchaseConfiguration.buyParams,...i.actionDetails}),ip(e,g,i),r&&null!==f){const t=Zt(e,n,f,!0,i)
t.buyAction=d
const r=Zt(e,n,f,!0,i)
return r.buyAction=d,t.subscribePageAction=r,f.buyCompletedAction=Xt(e,g),t}{const o=new jW(n.id,d),i=tn(e,t,g,n,r).startAction
return o.subscribePageAction=i,o}}(e,t,n,r,i,s)
default:return function(e,t,n,r,o,i,s){var a,c,l,u
const d=he(i),f=new KJ(xH,i,e.bag.metricsTopic,n.id);(0,Cv.isSome)(null===(c=null===(a=s.pageInformation)||void 0===a?void 0:a.searchTermContext)||void 0===c?void 0:c.term)&&(f.metricsOverlay[oV]=null===(l=s.pageInformation.searchTermContext)||void 0===l?void 0:l.term)
const p=null===(u=e.metricsIdentifiersCache)||void 0===u?void 0:u.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical]);(0,Cv.isSome)(p)&&(f.metricsOverlay={...f.metricsOverlay,...p}),e.client.isCompanionVisionApp&&(0,Cv.isNothing)(f.metricsOverlay[lB])&&(f.metricsOverlay[lB]="com.apple.visionproapp"),d&&(f.purchaseSuccessAction=t,f.carrierLinkSuccessAction=t)
const h=new dY(XU)
if(h.pageData=f,s&&s.pageInformation&&(h.referrerUrl=s.pageInformation.pageUrl),s.actionDetails={buyParams:t.purchaseConfiguration.buyParams,...s.actionDetails},ip(e,h,s),r&&t instanceof FW){const r=Zt(e,n,t,!0,s)
r.buyAction=t
const o=Zt(e,n,t,!0,s)
return o.buyAction=t,r.subscribePageAction=o,t.buyCompletedAction=Xt(e,h),r}const w=$e(e,n,xj)
if(sn(e,n)||w&&e.client.deviceType!==kH){const r=rn(e,t,n,!0,!0),o=rn(e,h,n,!0,!0),i=new jW(n.id,r)
return i.subscribePageAction=new jW(n.id,o),i}const g=new jW(n.id,t)
return g.subscribePageAction=h,g}(e,t,n,r,0,i,s)}}(e,t,n,o,0,function(e,t,n){if(n)return pe(w$)
switch(t){case _j:return pe(_j)
case sH:case DG:return pe(IL)
default:return pe(WU)}}(0,a,o),i)
const s=function(e,t,n,o,i){return"tv"===e.client.deviceType?en(e,t,null,n,o):{startAction:r(t)?null:t,underlyingOfferAction:null}}(e,t,n,o),c=s.startAction
if(o){const t=Zt(e,n,s.underlyingOfferAction,!1,i)
return t.buyAction=c,t}return c}return nn(e,t,o,i)}function Kt(e,t,n,r,o,i,s=null){switch(r){case pe(_j):case pe(IL):const r=sd(e,t,{useCase:3}),a=rp(e,t,i)
return Ht(e,jt(e,t),t,o,!1,bf(e,t,r,s),a,n)
default:return null}}function Zt(e,t,n,r,o){let i
if(r){const s=Qt(e,t,n.purchaseConfiguration.appName,r,!0,o),a=Qt(e,t,n.purchaseConfiguration.appName,r,!1,o)
i=new fz(a,a,s,a)}else i=Qt(e,t,n.purchaseConfiguration.appName,!1,!1,o)
return new jW(t.id,i)}function Qt(e,t,n,r,o,i){const s=new UW(t.id,r)
let a,c,l,u
if(a=e.loc.string("CANCEL_COMING_SOON_TITLE"),e.client.isAutomaticDownloadingEnabled()&&(r&&o||!r)?(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON_DOWNLOAD"),l=e.loc.string("COMING_SOON_BODY_DOWNLOAD").replace(Fx,n)):(s.title=e.loc.string("CANCEL_COMING_SOON_BUTTON"),l=e.loc.string("COMING_SOON_BODY").replace(Fx,n)),c=e.loc.string("CANCEL_COMING_SOON_CANCEL"),e.client.deviceType===$H||"tv"===e.client.deviceType){const e=new tz(sH)
e.title=a,e.message=l,e.buttonActions=[s],e.isCancelable=!0,e.cancelTitle=c,e.destructiveActionIndex=0,u=e}else if(e.client.deviceType===kH){const t=new tz(sH)
t.title=a,t.artwork=Se(e,"systemimage://bell.slash.fill",95,90),t.message=l,t.buttonActions=[s],t.isCancelable=!0,t.cancelTitle=c,u=t}else{const e=new ez([s])
e.title=a,e.message=l,e.isCancelable=!0,e.cancelTitle=c,e.isCustom=!1,e.destructiveActionIndex=0,u=e}sp(e,s,{...i,actionType:"cancelPreorder"})
const d=new VW(t.id,SH),f=new jW(t.id,u)
return f.openAction=d,f}function Xt(e,t){const n=Se(e,"systemimage://checkmark",95,90),r=Se(e,gy,95,90)
let o,i
o=new tz(GF),o.title="",o.artwork=n,e.client.isAutomaticDownloadingEnabled()?(o.message=e.loc.string(kE),o.toastDuration=2.5):(o.message=e.loc.string(gF),o.toastDuration=1.5)
{const n=new tz(GF)
n.title="",n.artwork=r,n.message=e.loc.string(gF),n.toastDuration=1.5
const o=new dz(OE,new $W([t,n]))
o.rateLimit=e.bag.arcadePreOrderUpsellLimitSeconds,o.fallbackAction=n,i=o}const s=!e.client.isAuthorizedForUserNotifications()
return e.bag.newEventsForODJAreEnabled&&s?new fz(new lz,new lz,new lz,new lz):new fz(i,o,o,o)}function en(e,t,n,o,s,a){if(r(t))return{startAction:null,underlyingOfferAction:null}
const c=new BW,l=qt(0,t),u=t.purchaseConfiguration.appName
c.shouldCheckForAvailableDiskSpace=!s,c.remoteControllerRequirement=EB,c.shouldCheckForGameController=Ve(e,o,$L)
const d=Ot(0,o,!0)
if(i(d)&&(c.checkRestrictionsForContentRating=d),l){const t=s?e.loc.string("OfferAlert.TV.Title.PredorderFree"):e.loc.string("OfferAlert.TV.Title.Free")
c.title=t.replace(fB,u)}else{const n=s?e.loc.string("OfferAlert.TV.Title.PreorderPaid"):e.loc.string("OfferAlert.TV.Title.Paid")
c.title=n.replace(fB,u).replace(HM,t.priceFormatted)}const f=b(t)
f.title=s?e.loc.string("OfferButton.Title.Preorder"):l?e.loc.string($x):e.loc.string("OfferButton.Title.Buy")
const p=(0,Cv.isNothing)(n)?f:n
c.completionAction=p,c.shouldIncludeActiveAccountInFooterMessage=!0
const h=[]
Ve(e,o,aO)&&h.push(e.loc.string("OFFERS_IN_APP_PURCHASES","Offers In-App Purchases")),h.length>0&&(c.footerMessage=h.join(e.loc.string("TV_OFFER_ALERT_FOOTER_LINE_BREAK"))),c.impressionMetrics=f.impressionMetrics
const w=b(c)
w.shouldPromptForConfirmation=!1,w.title=null,w.footerMessage=null
const g=new jW(t.adamId,w)
return Jd(e,o)||(g.buyAction=c),g.openAction=t,{startAction:g,underlyingOfferAction:f}}function tn(e,t,n,o,i,s){if(r(t))return{startAction:null,underlyingOfferAction:null}
const a=new BW,c=qt(0,t)
a.remoteControllerRequirement=xt(e,o),a.spatialControllerRequirement=Lt(e)
const l=b(t)
l.title=i?e.loc.string("OFFER_BUTTON_TITLE_PREORDER"):c?e.loc.string("OFFER_BUTTON_TITLE_GET"):e.loc.string("OFFER_BUTTON_TITLE_BUY")
const u=(0,Cv.isNothing)(n)?l:n
a.completionAction=u,a.impressionMetrics=l.impressionMetrics
const d=b(a)
d.shouldPromptForConfirmation=!1,d.title=null,d.footerMessage=null
const f=new jW(t.adamId,d)
return f.buyAction=a,f.cancelAction=l,f.openAction=l,{startAction:f,underlyingOfferAction:l}}function nn(e,t,n,o){if(r(t))return null
if(!e.bag.enableTwoPhaseOfferConfirmation||n)return t
const i=new lz
i.impressionMetrics=t.impressionMetrics
const s=b(o)
r(s)||(s.actionType=sE,s.targetType=NH,sp(e,i,s))
const a=new NW(t,i)
return a.confirmationAccessibilityAction=function(e,t){if(r(t))return null
const n=new tz(sH)
r(t.priceFormatted)?(n.title=e.loc.string(EF),n.message="Are you sure you want to get "+t.purchaseConfiguration.appName):(n.title="Buy App",n.message=`Are you sure you want to buy ${t.purchaseConfiguration.appName} for ${t.priceFormatted}`),n.isCancelable=!0,n.buttonActions=[t]
const o=new jW(t.adamId,t)
return o.buyAction=n,o}(e,t),a}function rn(e,t,n,r,o){const i=new tz(sH)
return i.isCancelable=!0,i.buttonActions=[t],i.imageName="vision.pro",sn(e,n)?r?(i.title=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Free.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Title"),i.message=e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.Paid.RemoteDownloads.ButtonTitle")]):(i.title=e.loc.string("Alert.Buy.VisionOnly.Title"),i.message=o?e.loc.string("Alert.Buy.VisionOnly.Message.Arcade"):e.loc.string("Alert.Buy.VisionOnly.Message"),i.buttonTitles=[e.loc.string("Alert.Buy.VisionOnly.ButtonTitle")]),i}function on(e,t){if(!e.client.isCompanionVisionApp)return!1
const n=md(e,t).includes(kH)||function(e){return Le(e,rH,JC)}(t)
return!!n}function sn(e,t){return!!on(e,t)&&an(e)}function an(e){return!((0,Cv.isNothing)(e.client.remoteDownloadIdentifiers)||0===e.client.remoteDownloadIdentifiers.length)}function cn(e,t){const n=new tz(sH)
return n.title=e.loc.string("Alert.Buy.TvGameControllerRequired.Title"),n.message=e.loc.string("Alert.Buy.TvGameControllerRequired.Message"),n.buttonTitles=[e.loc.string("Alert.Buy.TvGameControllerRequired.ButtonTitle")],n.isCancelable=!0,n.buttonActions=[t],n}function ln(e,t,n,o,s,a,c,l,u,d,p=sH,h=!1,w=!1,g,v,m=!1){return r(t)?null:Iv.context("displayPropertiesFromOfferAction",()=>{var r
let a=c
!m&&vt(e,o,77238)&&(a=kN),m||Ku(e,o)||(a=kN),m||!e.client.isCompanionVisionApp||sn(e,o)||(a=kN)
const g=null!==(r=Xu(e,o))&&void 0!==r?r:v
let y
g&&(y=g.id)
let A=new vq(n,t.adamId,t.bundleId,a,y,l)
A.isPreorder=s
const T=w&&p===sH&&(0,Cv.isSome)(e.bag.adsOverrideLanguage),S=T?e.adsLoc:e.loc
if(A.useAdsLocale=T,s)if(Jd(e,o))A.offerLabelStyle=w$,A.subtitles[HN]=af(e,o,e.loc.string(VM)),A.titleSymbolNames[iS]=qM,A.titleSymbolNames[EE]="bell.fill",A.subtitles[HN]===e.loc.string(uT)&&(A.subtitles[HN]=e.loc.string(VM))
else{A.offerLabelStyle=Ej,A.titleSymbolNames[LH]=qM
const t=af(e,o,"");(0,Cv.isSome)(t)&&(A.subtitles[HN]=t)}const P=qt(0,t)
A.isFree=P
let I=null
if(p===sH&&(o.type===IH||Qd(0,o)||Xd(e,o)||h))I=e.loc.string("OfferButton.Title.View")
else{if(p===DG&&(o.type===IH||Qd(0,o)||Xd(e,o)))return null
I=p===sS?e.loc.string("OfferButton.Title.Select"):P?p===DG?s?e.loc.string(oS):e.loc.string(rS):t.title:p===DG?s?e.loc.string("OfferButton.FlowPreview.PreorderWithPrice").replace(HM,t.priceFormatted):e.loc.string("OfferButton.FlowPreview.BuyWithPrice").replace(HM,t.priceFormatted):t.priceFormatted}if(A.titles[LH]=I,A.priceFormatted=t.priceFormatted,e.bag.enableTwoPhaseOfferConfirmation&&p!==DG&&(A.titles[RE]=P?e.loc.string("OfferButton.Title.ConfirmGet"):e.loc.string("OfferButton.Title.ConfirmBuy")),Jd(e,o))if(p===DG){const t=e.loc.string("OfferButton.FlowPreview.Arcade.Standard")
A.titles[LH]=t,A.titles[WM]=t,A.titles[qG]=e.loc.string("OfferButton.FlowPreview.Arcade.Open"),A.titles[Nx]=t,s&&(A.titles[aS]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderSubscribed"),A.titles[DE]=e.loc.string("OfferButton.FlowPreview.Arcade.PreorderNotSubscribed"))}else{const e=S.string("OfferButton.Arcade.Title.Standard")
A.titles[LH]=e,A.titles[WM]=e,A.titles[qG]=S.string("OfferButton.Arcade.Title.Open"),A.titles[Nx]=e,s&&(A.titles[aS]=S.string("OfferButton.Arcade.Title.PreorderSubscribed"),A.titles[DE]=S.string("OfferButton.Arcade.Title.PreorderNotSubscribed"),A.titles[iS]=S.string("OfferButton.Arcade.Title.PreorderedSubscribed"),A.titles[EE]=S.string("OfferButton.Arcade.Title.PreorderedNotSubscribed"))}if(u&&p!==DG){const t=f(u,Qb),n=f(u,_U)
if(i(n)&&i(t)){let r=null,o=null
switch(t){case Xb:d?(r=e.loc.string(_E),o=e.loc.string(_E)):(r=e.loc.string(_E),o=e.loc.string(Bx))
break
case eS:const t=e.loc.string("OfferButton.IntroPrice.PaidUpfront.Trial").replace(HM,n)
d?(r=t,o=t):(r=t,o=e.loc.string(Bx))
break
case tS:r=e.loc.string(Bx),o=e.loc.string(Bx)}A.titles[xE]=r,A.titles[LE]=o,A.subtitles[xE]=e.loc.string(cS),A.subtitles[LE]=e.loc.string(cS)
const i=10
let s=!1
for(const e of Object.keys(A.titles))if(A.titles[e].length>i){s=!0
break}s&&(A=A.newOfferDisplayPropertiesChangingAppearance(!1,null,eb))}}const C=Ve(e,o,aO),k=Bt(e,o),O=Ut(e,cH),E=k&&O
if(A.hasInAppPurchases=C,A.hasExternalPurchases=E,C||E){const t=E?uS:lS,n=S.string(t)
A.subtitles[LH]=n,e.bag.enableTwoPhaseOfferConfirmation&&p!==DG&&(A.subtitles[RE]=n)}A.isDeletableSystemApp=gt(e).isSystemAppFromData(o)&&!Xd(e,o)
const R=Ot(0,o,!0)
return A.contentRating=null!=R?R:void 0,A.appCapabilities=t.purchaseConfiguration.appCapabilities,o.type===IH&&p!==DG&&(A.offerToken={offerAction:t,offerDisplayProperties:b(A)}),A})}function un(e){const t=ie(e.data,eF)
return t===Qv.Horizontal?Qv.Horizontal:t===Qv.Condensed?Qv.Condensed:Qv.Vertical}function dn(e,t){if(!t.isFirstRender)return s(t.remainingItems)?t.remainingItems:[]
const n=Ae(t.data,FH)
return s(n)?n:[]}function fn(e,t){let n=null
switch(t.type){case OH:case vV:case zN:n=ye(e,t,Yj)||ye(e,t,sV)||ye(e,t,FH)||ye(e,t,SH)
break
case BH:case kV:case IH:n=t}return n}function pn(e,t){if(o(t))return null
const n=l(t.meta,"associations.editorial-cards.data")
return o(n)?null:n[0]}function hn(e,t){return g({...ne(t,NU,{}),...ne(pn(0,t),NU,{})})}function wn(e){return{showAppIcon:d(e.showAppIcon,!1),suppressLockup:d(e.suppressLockup,!1),useGeneratedBackground:d(e.useGeneratedBackground,!1),useMaterialBlur:d(e.useMaterialBlur,!0),useTextProtectionColor:d(e.useTextProtectionColor,!1)}}function gn(e,t){if(!le(t))return null
let n
return n=t.type===OH?cf(e,t):t,le(n)?n:null}function vn(e,t){const n=s(ne(t,uH)),r=ae(t,UN)
return!n&&!r}function mn(e,t){const n=t.type
return n!==Jv.Collection&&n!==Jv.Recommendations?null:ie(t,tV)}function yn(e,t){switch(ie(t,JT)){case KT:return"com.apple.AppStore.BridgeStoreExtension"
case ZT:return"com.apple.MobileSMS"
case"RealityDevice":return e.bag.enableDeviceDrivenDiscoveryContent?"VisionAppStore":null
default:return null}}function An(e,t){return s(ne(t,FB))}function Tn(e,t,n,o,i=!0){if(!o.isAdvert)return void Sn(e,t,n,o)
n.searchAdOpportunity=function(e,t,n){const o=function(e,t,n){let o=Bn(0,t);(r(o)||0===o.length)&&(o=e.random.nextUUID(),_n(e,`Error: instanceId was null or empty. Assigned ${o}`))
const i=ne(t,FB),s=ie(t,"iad.impressionId"),a=ie(t,"iad.privacy"),c=ie(t,sx),l=new wZ(a)
l.title=e.adsLoc.string("IAD_PRIVACY_MARKER_BUTTON_TITLE")
const u=Jd(e,t)?fN:ix,d=ae(t,VV)?Ej:LH,f=En(0,n),p=new yK(o,t.id,c,u,"markerPress",d,f),h=kn(o,n),w=On(0,l,p)
return new hZ(o,i,h,s,w)}(e,t,n),i=kn(o.instanceId,n)
return new pZ(o.instanceId,i,o)}(e,t,o.pageInformation)
const s=n.searchAdOpportunity.searchAd,a=Jd(e,t)?fN:ix,c=En(0,o.pageInformation),l=ie(t,sx),u=ae(t,VV)?Ej:LH,d=new yK(s.instanceId,t.id,l,a,qT,u,c)
n.clickAction=On(0,n.clickAction,d)
const f=new yK(s.instanceId,t.id,l,a,WT,u,c)
n.buttonAction=On(0,n.buttonAction,f),n.itemBackground=e.clientCapabilities.isEnabled("insetAdItemBackground")?"insetAd":"ad",n.offerDisplayProperties&&i&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,rG,"ad")),ae(t,"iad.format.userRating")||(n.rating=null,n.ratingCount=null),Sn(e,t,n,o)}function bn(e){const t=u(ne(e,FB),"passthroughAdInfo.deepLinkEligible"),n=u(e,"meta.passthroughAdInfo.deepLinkEligible")
return t||n}function Sn(e,t,n,o){const i=Vf(e,t,n,bf(e,t,n.icon,null),o,!0)
!function(e,t,n){var o,i,s,a,c
const l=null!==(i=null===(o=t.searchAdOpportunity)||void 0===o?void 0:o.searchAd)&&void 0!==i?i:t.searchAd
if(r(l))return
null===(s=t.clickAction)||void 0===s||s.actionMetrics.clearAll(),t.clickAction&&sp(e,t.clickAction,n,!0)
const u=n.pageInformation,d={actionType:"ad_transparency"};(null==u?void 0:u.iAdInfo)&&Object.assign(d,u.iAdInfo.clickFields)
const f=Zf(e,t.adamId,NH,d)
null!==(c=null===(a=null==u?void 0:u.iAdInfo)||void 0===a?void 0:a.shouldIncludeAdRotationFields)&&void 0!==c&&c&&f.includingFields.push(hF),l.transparencyAction.actionMetrics.addMetricsData(f)}(e,n,i),jf(e,n,i,i.pageInformation.iAdInfo)}function Pn(e){var t
return[zT,"U","I",(null!==(t=null==e?void 0:e.artwork)&&void 0!==t?t:[]).length].join("")}function In(){return[zT,"U","I",1,"_2x1"].join("")}function Cn(e,t){let n
const r=null==t?void 0:t.iAdInfo.placementType
if((0,kv.isSome)(r))try{n=e.ads.getIdentifierForMissedOpportunity(r)}catch{n=e.random.nextUUID(),_n(e,`Error: getIdentifierForMissedOpportunity threw exception. Assigned ${n}`)}else n=e.random.nextUUID(),_n(e,`Error: placementType was null or empty. Assigned ${n}`)
const o=kn(n,t)
return new pZ(n,o)}function kn(e,t){const n=null==t?void 0:t.baseFields.pageId,r=typeof n===gH?n:TH
return{placed:{adInstanceId:e,pageIdentifier:r},pageEnter:{pageIdentifier:r},pageExit:{pageIdentifier:r},onScreen:{adInstanceId:e},offScreen:{adInstanceId:e},visible:{adInstanceId:e},completed:{adInstanceId:e}}}function On(e,t,n){const r=new Cz(n),o=new $W([r,t])
return o.title=t.title,o}function En(e,t){const n=null==t?void 0:t.iAdInfo
if(r(n))return rB
const o=n.placementType
switch(o){case UG:return YT
case OG:return"searchAds"
case PH:case xV:case nV:return YT
default:throw new Error(`This method should never be called with value: ${o}`)}}function Rn(e){return!!function(e){return e.host.clientIdentifier===Kq||e.host.clientIdentifier===tW}(e)||e.host.platform===TH}function Dn(e,t){if(!Rn(e))return!1
switch(t){case UG:const n=Mn(t)
return(0,kv.isSome)(n)?e.bag.isSearchLandingAdsEnabled||e.bag.enabledAdPlacements.includes(n):e.bag.isSearchLandingAdsEnabled
case OG:return!0
case PH:const o=Mn(t)
return!r(o)&&e.bag.enabledAdPlacements.includes(o)&&(0,kv.isSome)(xn(e))
case xV:case nV:const i=Mn(t)
return!r(i)&&e.bag.enabledAdPlacements.includes(i)
default:return!1}}function _n(e,t){e.console.log(`[Ads] ${t}`),e.client.buildType===LB&&e.isAvailable(XH)&&i(e.ads.debugLog)&&((0,kv.isNothing)(EZ)&&(0,kv.isSome)(e.ads.isNativeAdLoggingEnabled)&&(EZ=e.ads.isNativeAdLoggingEnabled()),EZ&&e.ads.debugLog(t))}function xn(e){if(e.bag.todayAdMediumLockupScreenshotEnabled)return LV
if(e.bag.todayAdCondensedEnabled){if(!e.client.isPhone)return
return DL}return function(e){return!!e.client.isPhone&&"5pdfhju01"===Je(e,_v.CondensedTodayAds)}(e)?DL:void 0}function Ln(e,t,n){var r,o,i,s,a
const c=e.bag.adPlacementTimeouts,l=.3
switch(t){case OG:return n?null:null!==(r=null==c?void 0:c["search-results-in-seconds"])&&void 0!==r?r:l
case UG:return n?null:null!==(o=e.bag.searchLandingAdFetchTimeout)&&void 0!==o?o:l
case PH:return n?null!==(i=null==c?void 0:c["today-in-seconds"])&&void 0!==i?i:l:null
case xV:return n?null:null!==(s=null==c?void 0:c["product-page-ymal-in-seconds"])&&void 0!==s?s:l
case nV:return n?null:null!==(a=null==c?void 0:c["product-page-ymal-during-download-in-seconds"])&&void 0!==a?a:l
default:return l}}function Mn(e){switch(e){case OG:return C$
case UG:return k$
case PH:return PH
case xV:return"product-page-ymal"
case nV:return"product-page-ymal-during-download"
default:return}}function $n(e,t,n,o,s){var a,c,l
if(!Rn(e)||r(s.iAdInfo))return
const u=Fn(n,o)
if((0,kv.isNothing)(u))return
let d=null
if(typeof s.iAdInfo.pageFields.iAdMissedOpportunityReason===gH&&(d=s.iAdInfo.pageFields.iAdMissedOpportunityReason),(0,kv.isNothing)(d)||0===d.length||d===sy||d===ay)return
const f=[]
for(const e of t){if(e.contentType!==eH&&e.contentType!==pG)continue
const t=e.items
i(t)&&t.length>0&&f.push(...t)}if(f.length<=u)return
const p=f[u],h=p instanceof PY,w=p instanceof jJ?p.media:null,g=i(w)&&w instanceof _J,v=i(w)&&w instanceof DJ,m=i(w)&&w instanceof xJ&&i(w.condensedAdLockupWithIconBackground.lockup.searchAdOpportunity),y=g&&i(w.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity),A=v&&i(w.mediumAdLockupWithAlignedRegionBackground.lockup.searchAdOpportunity),T=h&&i(p.searchAdOpportunity)
m||y||A||T||(p.searchAdOpportunity=Cn(e,s),null===(a=p.searchAdOpportunity)||void 0===a||a.setMissedOpportunityReason(null!=d?d:XD),g?null===(c=p.searchAdOpportunity)||void 0===c||c.setTemplateType(Pn(w.mediumAdLockupWithScreenshotsBackground.screenshots[0])):v?p.searchAdOpportunity.setTemplateType(In()):null===(l=p.searchAdOpportunity)||void 0===l||l.setTemplateType(MB))}function Fn(e,t){var n
const r=(null!==(n={today:[{shelfIdentifier:PH,adEligibleIndex:1}],productPageYMAL:[{shelfIdentifier:$B,adEligibleIndex:0}],searchLanding:[{shelfIdentifier:"R8802",adEligibleIndex:0}],searchResults:[{shelfIdentifier:C$,adEligibleIndex:0}]}[e])&&void 0!==n?n:[]).find(e=>e.shelfIdentifier===t)
return s(r)&&i(r.adEligibleIndex)?r.adEligibleIndex:void 0}function Nn(e,t,n,o=null){var i,s
return!Rn(e)||r(n)?null:new QX(e,t,QX.createInitialSlotInfos(e,t,null===(i=null==n?void 0:n.onDeviceAd)||void 0===i?void 0:i.positionInfo,o),n.iAdId,n.clientRequestId,void 0,null===(s=n.onDeviceAd)||void 0===s?void 0:s.positionInfo)}function Bn(e,t){return ie(t,RZ)}function Un(e,t,n){s(null==t?void 0:t.attributes)&&(t.attributes[RZ]=n)}function Gn(e,t,n,r){var i,a,c,l,u
const d=e.bag.adsOverrideLanguage
if(o(d)||o(t))return!0
let f=null===(i=t.meta)||void 0===i?void 0:i.resource
if(o(f)&&s(n)&&(f=null===(u=null===(l=null===(c=null===(a=null==n?void 0:n.appMetadata)||void 0===a?void 0:a.data)||void 0===c?void 0:c[0])||void 0===l?void 0:l.meta)||void 0===u?void 0:u.resource),o(f))return!1
if(ie(f,"name.locale")!==d)return!1
const p=Ge(e,t,lV),h=Ge(e,f,"subtitle.locale")
if(s(p)&&h!==d)return!1
if("TEXT"===r){const n=ie(t,cy)
if((0,kv.isSome)(n)&&n!==qV){let r
const o=n
r=n===nH?fU:n
const i=Ge(e,t,r),a=Ge(e,f,o.concat(".locale"))
if(s(i)&&a!==d)return!1}}return!0}function jn(e,t){if((0,kv.isNothing)(t))return
const n=Mn(t)
return(0,kv.isNothing)(n)?void 0:e.bag.adPlacementEligibleSlotPositions[n]}function Vn(e){return e===36..toString()?1:e===6014..toString()?2:0}function Hn(e){const t=e.categories
if(s(t)){const e=t[0].genreId
if(e===6014..toString())return 2
if(e===36..toString())return 1}return 0}function qn(e,t,n=e.host.clientIdentifier,r=[]){t||(t=36)
const o=new wJ(e).forType(_F).includingAdditionalPlatforms(r).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAgeRestrictions().addingQuery(Xj,`${t}`)
return n===Zq?o.addingContext(MH):n===Qq&&o.addingContext(_V),o}function Wn(e,t,n=!0){return Iv.context("categoryListFromApiResponse",()=>{const r=l(t,"results.categories"),o=zn(e,h(r,"0"),n)
return o?new _Z(o.children):null})}function zn(e,t,n=!0){return Iv.context("categoryFromApiResponse",()=>{if(!t)return null
const r=f(t,GH),o=f(t,Xj),s=f(t,xF),a=nd(e,h(t,_H),{allowingTransparency:!0,useCase:20}),c=l(t,Fj).map(t=>zn(e,h(t),n)).filter(e=>i(e)),u=function(e,t){return t.sort((t,n)=>{try{return t.name.localeCompare(n.name,e.loc.safeIdentifier,{usage:Ij})}catch(e){return 0}})}(e,c),d=f(t,CV)
return d&&n&&u.unshift(new DZ(d,o,a,s,[])),new DZ(r,o,a,s,u)})}function Yn(e,t,n=!1,r=!1,o=!0){const i=n?"contentIconTrimmedMonochrome":"contentIconTrimmed",s="brandLogo",a=Be(e,t,lH)
if(r)return h(a,s)
{let e=h(a,i)
return o&&(0,kv.isNothing)(e)&&(e=h(a,s)),e}}async function Jn(e,t,n){var r
const o=Date.now(),i=await e.mediaToken.refreshToken(),s=e.fetchTimingMetricsBuilder,a=null!=n?n:{},c=null===(r=e.personalizationMetricsIdentifiersCache)||void 0===r?void 0:r.getMetricsIdForType(xv.user);(0,Cv.isSome)(c)&&((0,Cv.isSome)(null==a?void 0:a.headers)?a.headers[xZ]=c:a.headers={[xZ]:c})
const l=await Zn(e,t,i,a,!1,s),u=Date.now()
t.canonicalUrl&&(l[sm.requestedUrl]=t.canonicalUrl)
const d=u-o
if(d>500){const n=at(e,t).toString()
e.console.warn("Fetch took too long ("+d.toString()+"ms) "+n)}return l}function Kn(e,t){return e.bag.redirectUrlWhitelistedQueryParams.filter(e=>{var n
return i(null===(n=t.query)||void 0===n?void 0:n[e])})}async function Zn(e,t,n,a={},c=!1,l){var d,f
const h=at(e,t).toString(),w=new oY(h),g=Kn(e,w)
for(const e of g)w.removeParam(e)
const v=w.toString()
let m=a.headers
m||(m={}),m.Authorization="Bearer "+n
const A=await e.network.fetch({url:v,headers:m,method:a.method,body:a.requestBodyString,timeout:a.timeout})
try{if(401===A.status||403===A.status){if(c)throw Error("We refreshed the token but we still get 401 from the API")
return e.mediaToken.resetToken(),await e.mediaToken.refreshToken().then(async n=>await Zn(e,t,n,a,!0,l))}if(404===A.status)throw Qn()
if(!A.ok){const e=new LZ(`Bad Status code ${A.status} for ${v}, original ${h}`)
throw e.statusCode=A.status,e}const n=n=>{var c,l
const d=Date.now()
let f
if(r(n.body)||""===n.body){if(204!==n.status)throw Qn()
f={}}else try{f=JSON.parse(n.body)}catch(t){let r=t.message
throw[$U,LB].includes(e.client.buildType)&&(r=`${t.message}, body: ${n.body}`),new MZ(r)}const w=Date.now()
if(f){if(f[sm.pageInformation]=y(function(e,t){const n=e.client.storefrontIdentifier
let r=null
if((null==n?void 0:n.length)>0){const e=n.split("-")
s(e)&&(r=e[0])}return{serverInstance:t.headers[$Z],storeFrontHeader:n,language:e.bag.language,storeFront:r,environmentDataCenter:t.headers[FZ]}}(e,n)),n.metrics.length>0){const e={...n.metrics[0],parseStartTime:d,parseEndTime:w}
f[sm.timingValues]=e}else{const e={pageURL:n.url,parseStartTime:d,parseEndTime:w}
f[sm.timingValues]=e}if(f[sm.contentMaxAge]=function(e,t){const n=Object.keys(t.headers).find(e=>"cache-control"===e.toLowerCase())
if(r(n)||""===n)return null
const i=t.headers[n]
if(o(i))return null
const s=i.match(/max-age=(\d+)/)
return r(s)||s.length<2?null:p(s[1])}(0,n),Array.isArray(f.data)&&i(l=f.data)&&0===l.length&&!u(a.allowEmptyDataResponse))throw Qn()
Array.isArray(f.data)&&t.originalOrdering.length>1&&(f.data=function(e,t,n,r=[]){const o={}
for(const e of n)o[Xn(0,e.type,e.id)]=e
const i=[]
for(const e of t){const t=o[Xn(0,e.type,e.id)]
if((0,Cv.isSome)(t)){if(s(r)){t.meta={...e.meta}
for(const n of r)er(0,n,t,e,o)}i.push(t)}}return i}(0,t.originalOrdering,null!==(c=f.data)&&void 0!==c?c:[],t.supplementaryMetadataAssociations)),f[sm.requestedUrl]=h}return f}
return(0,Cv.isSome)(l)?l.measureParsing(A,n):n(A)}catch(e){if(e instanceof LZ)throw e
const t=null!==(d=A.headers["x-apple-jingle-correlation-key"])&&void 0!==d?d:null===(f=A.metrics[0])||void 0===f?void 0:f.clientCorrelationKey
throw new Error(`Error Fetching - filtered: ${v}, original: ${h}, correlationKey: ${null!=t?t:"N/A"}, ${e.name}, ${e.message}`)}}function Qn(){const e=new LZ("No content")
return e.statusCode=204,e}function Xn(e,t,n){return`${t}_${n}`}function er(e,t,n,r,o){var i;(0,Cv.isNothing)(n.meta)?n.meta={associations:{}}:(0,Cv.isNothing)(n.meta.associations)&&(n.meta.associations={})
const a=G(t,r)
if(s(a)){const e=[]
for(const t of a){const n=o[Xn(0,t.type,t.id)];(0,Cv.isSome)(n)&&e.push(n)}(null!==(i=h(n.meta.associations))&&void 0!==i?i:{})[t]={data:e}}}function tr(e,t=!1){return{timeToLive:or(e),nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:t}}function nr(e,t){r(t)||r(e)||(r(t.nextPreferredContentRefreshDate)||e.getTime()<t.nextPreferredContentRefreshDate.getTime())&&e.getTime()>(new Date).getTime()&&(t.nextPreferredContentRefreshDate=e)}function rr(e,t){if(!function(e){return e.bag.enableAutomaticPageRefresh}(e))return null
if(r(t))return null
let n,o=!1
if(i(t.timeToLive)&&i(t.nextPreferredContentRefreshDate)){const e=ir(t.timeToLive)
e.getTime()<t.nextPreferredContentRefreshDate.getTime()&&e.getTime()>(new Date).getTime()?n=e:(n=t.nextPreferredContentRefreshDate,o=!0)}else if(i(t.timeToLive))n=ir(t.timeToLive)
else{if(!i(t.nextPreferredContentRefreshDate))return null
n=t.nextPreferredContentRefreshDate,o=!0}if(n.getTime()<=(new Date).getTime())return null
const s=o&&t.refreshWhileVisibleForNextPreferredContentRefreshDate
return new NZ("timeToLive",0,null,n,s)}function or(e){return e[sm.contentMaxAge]}function ir(e){const t=new Date
return t.setSeconds(t.getSeconds()+e),t}function sr(e){e.includingScopedRelationships(ZG,[uk,YL,$N]),e.includingViews([r_,xk]),e.includingScopedAttributes(ZG,[GH,lV,R$]),e.includingMetaKeys(Vy,[Hy]),e.includingMetaKeys(qy,[dk]),e.includingAssociateKeys(ZG,[Wy])}function ar(e){e.includingScopedRelationships(ZG,[uk,YL,$N]),e.includingScopedAttributes(ZG,[GH,lV,R$]),e.includingMetaKeys(Vy,[Hy]),e.includingMetaKeys(qy,[dk]),e.includingAssociateKeys(ZG,[Wy])}function cr(e){e.enablingFeature(tj),e.includingScopedAttributes(tj,[lH]),e.addingQuery("associate[tags]",BH),e.includingScopedRelationships(sM,[FH,Lk])}function lr(e){e.includingScopedRelationships(Aj,[FN]),e.includingScopedAttributes(Aj,[hH,lV,R$,i_]),e.includingMetaKeys(zy,[Yy]),e.includingKindsKeys(Aj,[QL])}function ur(e){return HZ.has(e)}function dr(e){return BZ.has(e)}function fr(e){return jZ.has(e)}function pr(e){return GZ.has(e)}function hr(e){if(null===zZ){zZ=new Set
for(const t of e.bag.suppressedPrivacyAppIds)zZ.add(t)}}function wr(e,t){return hr(e),!(0,Cv.isNothing)(zZ)&&!o(t)&&zZ.has(t)}function gr(e,t){return hr(e),!(0,Cv.isNothing)(zZ)&&!o(t)&&(!(!zZ.has("com.apple.InstallAssistant.*")||!t.startsWith(ny))||zZ.has(t))}function vr(e){const t=[lH,oH,Uj,eV]
return t.push(Nj),e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}function mr(e,t){return t.includingAdditionalPlatforms(N(e)).includingRelationships(function(e){let t=[]
switch(e.client.deviceType){case $H:t=t.concat(KZ),e.appleSilicon.isSupportEnabled&&t.push(W$)
break
case MH:t.push(QZ)
break
case kH:t=t.concat(JZ)
break
case JG:t=t.concat(ZZ)
break
default:t=t.concat(YZ)}return t}(e)).includingAttributes(vr(e)).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ze(e)),t}function yr(e){return 0===e.length}function Ar(e){return!yr(e)}function Tr(e){if(null===XZ){XZ=new Set
for(const t of e.bag.suppressedAccessibilityAppIds)XZ.add(t)}}function br(e){return e.featureFlags.isEnabled("product_accessibility_support_2025A")&&e.bag.enableAppAccessibilityLabels}function Sr(e,t){return Tr(e),(0,kv.isSome)(XZ)&&Ar(t)&&XZ.has(t)}function Pr(e,t){return Tr(e),!!t.startsWith(ny)||(0,kv.isSome)(XZ)&&Ar(t)&&XZ.has(t)}function Ir(e){const{id:t,platform:n,...r}=e
return{...r,id:At(t),platform:Tt(n),$kind:tQ}}function Cr(e){return{storefront:e.locale.activeStorefront,language:e.locale.activeLanguage}}function kr(e,t){return e.locale.normalize(t)}function Or(e,t){const n=t.host
if(r(n))return!1
const o=[e.bag.mediaHost,e.bag.mediaEdgeHost(e),e.bag.mediaEdgeSearchHost]
for(const e of o)if(!r(e)&&-1!==n.indexOf(e))return!0
return!1}function Er(e,t,n){if(!(0,Cv.isNothing)(t))return at(e,new wJ(e,t).addingQueryValues(n)).toString()}function Rr(e){let t=e.query.id
const n=e.pathname
if(r(t)&&(null==n?void 0:n.length)>0){const e=rQ.exec(n)
e&&e.length>1&&(t=e[1])}if(!a(t)){const n=e.pathComponents()
s(n)&&(t=n[n.length-1])}return t}function Dr(e,t,n=!1){var r,o
let s=Rr(t)
if(!a(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
s in oQ&&(s=oQ[s])
let c=BH,l=nQ,u=[]
u=[$B,pH,IH,y_,cM,aM]
const d=null===(r=t.pathname)||void 0===r?void 0:r.split("/"),f=(0,Cv.isSome)(d)&&d.includes(_z.productBundle)
f&&(c=IH,l=[SG,tG,eV,Mk,xB],u=[BH,pH,cM]),u.push(lM),e.bag.enablePrivacyNutritionLabels&&!wr(e,s)&&l.push(uM),br(e)&&!Sr(e,s)&&l.push(dM),e.appleSilicon.isSupportEnabled&&l.push(iV),e.bag.enableUpdatedAgeRatings&&l.push(zj),ad(e)&&l.push(Zj),e.bag.enableLicenses&&l.push($k)
const p=v(t.query[Hz.isArcade]);(null===p||p)&&(l.push(MF,$F,oH),u.push(cV)),e.bag.enableSellerInfo&&l.push(zF),e.bag.enableSellerICPAnnotation&&l.push(Fk),e.bag.gameCenterExtendSupportedFeatures&&l.push(fM),Ms(e)&&u.push(Nk)
const h=new wJ(e).withIdOfType(s,c).includingAdditionalPlatforms(N(e)).includingAgeRestrictions().includingRelationships(u).includingAttributes(l).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ze(e)).includingViews([Bk,y_])
h.addingRelationshipLimit(pH,B(e)),(null===(o=t.query[Hz.productVariantID])||void 0===o?void 0:o.length)>0&&h.addingQuery(Hz.productVariantID,t.query[Hz.productVariantID])
const w=t.query[Yz]
return i(w)&&h.addingQuery(Yz,w),$i(e)&&!f&&(Fi(e)||h.includingScopedRelationships(BH,[DH]),h.includingScopedAttributes(DH,eQ),h.includingScopedAvailableIn(DH,[Uk])),Fi(e)&&sr(h),Ni(e)&&lr(h),Dn(e,xV)&&h.enablingFeature(T_),n&&h.enablingFeature(A_),Fi(e)||h.includingRelationships([b_]),h.attributingTo(t.build())}function _r(e,t,n,r,o,i){const s=nQ
e.bag.enablePrivacyNutritionLabels&&!wr(e,t)&&s.push(uM),br(e)&&!Sr(e,t)&&s.push(dM),e.appleSilicon.isSupportEnabled&&s.push(iV),e.bag.enableUpdatedAgeRatings&&s.push(zj),ad(e)&&s.push(Zj),e.bag.enableLicenses&&s.push($k),e.bag.gameCenterExtendSupportedFeatures&&s.push(fM)
const a=new wJ(e).withIdOfType(t,BH).includingAdditionalPlatforms(N(e)).includingAttributes(s).includingRelationships([cV,$B,lM,pH,IH,cM,aM]).addingRelationshipLimit(pH,B(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingViews([y_]).usingCustomAttributes(Ze(e))
return n&&a.addingQuery("availability",rA),(0,Cv.isSome)(r)&&a.addingQuery(Hz.productVariantID,r),i&&a.enablingFeature(A_),$i(e)&&!o&&(Fi(e)||a.includingScopedRelationships(BH,[DH]),a.includingScopedAttributes(DH,eQ),a.includingScopedAvailableIn(DH,[Uk])),Fi(e)&&sr(a),Ni(e)&&lr(a),Fi(e)||a.includingRelationships([b_]),Ms(e)&&a.includingRelationships([Nk]),Dn(e,xV)&&a.enablingFeature(T_),a}function xr(e,t){if(!e.client.isPhone||!e.featureFlags.isEnabled("app_genome_2025A"))return!1
if((0,kv.isNothing)(t))return!0
switch(t){case PG:return e.bag.isAppsGroupingTagsEnabled
case Jj:return e.bag.isAppsProductPageTagsEnabled
case lL:return e.bag.isAppsSlpTagsEnabled
default:return!1}}function Lr(e,t,n){const r=ce(t,bG)
let o=null
const i=ie(t,"gamesFilter")
switch(i){case xH:case tx:case"all":o=i
break
default:495!==r&&500!==r||(o=xH)}let a=null,c=ie(t,$r(0,r)),l=null,d=null,p=ie(t,oG)
const h={}
let w=!1
const g=Ae(t,JN)[0]
if(476===r&&s(g))if(a=e.loc.uppercased(ie(t,$r(0,r))),p=null,g.type===cj){c=Kd(e,g,GH)
const t=Yn(e,g,!1)
if((0,kv.isSome)(t)){l=nd(e,t,{useCase:1,style:N$})
const n={type:lF,name:XL}
h.eyebrowColor=n}d={forYou:!0}}else w=!0,c=ie(g,$r(0,r)),l=sd(e,g,{useCase:1})
const v={featuredContentId:r,id:f(t,"id"),presentationHints:{},metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,featuredContentData:t,title:c,subtitle:p,eyebrow:a,titleArtwork:l,shelfHeaderConfiguration:h,shouldFilter:!1,gamesFilter:o,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
return{shelfToken:v,metricsOptions:{id:v.id,kind:null,softwareType:u(null==n?void 0:n.isArcadePage)?HV:null,targetType:jV,title:w?v.eyebrow:v.title,badges:d,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:GG,fcKind:r,recoMetricsData:jr(e,t)}}}function Mr(e){return e&&e.isDeferring&&e.isFirstRender}function $r(e,t){switch(t){case 548:case 495:case 496:return hH
default:return GH}}function Fr(e){let t=(new oY).set(hG,Oz).append(jG,_z.grouping).append(jG,_z.shelf).append(jG,encodeURIComponent(JSON.stringify(e))).param(Hz.groupingFeaturedContentId,`${e.featuredContentId}`)
return(0,kv.isSome)(e.nativeGroupingShelfId)&&(t=t.param(Hz.nativeGroupingShelfId,`${e.nativeGroupingShelfId}`)),t.build()}function Nr(e,t,n){if(o(n))return null
r(n.shelfStyle)&&(n.shelfStyle=t.contentType)
const i=t.contentType!==tF&&s(t.items)
return n.hasExistingContent=n.hasExistingContent||i&&n.isFirstRender,(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?Fr(n):null}function Br(e,t){e.remainingItems=e.remainingItems.filter(e=>!t.has(e.id))}function Ur(e,t,n){var r
const o=s(t.remainingItems),i=!o&&(null===(r=t.recommendationsHref)||void 0===r?void 0:r.length)>0
if(o){const n=function(e,t){var n
const r=(null===(n=t.relationshipToFetch)||void 0===n?void 0:n.length)>0
let o=t.remainingItems
return r&&(o=t.remainingItems.map(n=>ye(e,n,t.relationshipToFetch))),o}(e,t),r=new wJ(e,n,!0)
return st(e,r,n),Gr(e,r),r}if(i){const n=new wJ(e,t.recommendationsHref).includingAgeRestrictions()
return Gr(e,n),$i(e)&&(n.enablingFeature(PV),n.includingMetaKeys(aN,[CM,z_]),n.includingScopedAttributes(DH,eQ),n.includingScopedRelationships(DH,[SH])),Fi(e)&&(n.enablingFeature(Y_),ar(n)),Ni(e)&&(n.enablingFeature(cN),lr(n)),xr(e,PG)&&cr(n),n}return null}function Gr(e,t){t.includingAdditionalPlatforms(N(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ze(e))
let n=[lH,oH,eV]
t.includesResourceType(DH)&&$i(e)&&(t.enablingFeature(PV),t.includingMetaKeys(aN,[CM,z_]),t.includingScopedAttributes(DH,eQ),t.includingScopedRelationships(DH,[SH])),t.includesResourceType(ZG)&&Fi(e)&&(t.enablingFeature(Y_),ar(t),n=[]),t.includesResourceType(Aj)&&Ni(e)&&(t.enablingFeature(cN),lr(t),n=[]),(t.includesResourceType(BH)||t.includesResourceType(DH))&&(n=n.concat(SG,tG,nj)),xr(e,PG)&&cr(t),t.includingAttributes(n)}function jr(e,t){const n=ce(t,bG)
switch(n){case 425:case 415:case 416:case 417:case 501:case 258:case 421:case 422:case 423:case 261:case 584:case 587:return W(ve(t,Fj))
case 437:case 265:{const e=ve(t,Fj),n=oe(t,aF)
return s(e)?W(e):s(n)?W(t):null}case 414:case 424:case 566:return null
default:if(function(e){return dr(e)||ur(e)||qZ.has(e)||518===e}(n)){let e=ve(t,FH)
if(r(e))return null
const n=e.data
return n&&0!==n.length||(e=ve(t,Fj)),W(e)}return e.console.warn("Unknown featured content ID:",n),null}}function Vr(e,t,n){const r=nd(e,t,n)
return r&&(r.crop="sr"),r}function Hr(e,t,n,r,o){const i=ne(t,_H)
if(i instanceof Array){const t=function(e,t,n,r){const o=n/r
let i=0,s=null
for(const e of t){const t=p(e,qB),r=t/p(e,gU);(r===o||Math.abs(o-r)<=Math.abs(o-i))&&(!s||t<=n&&t>s.width||s.width>n&&t<s.width&&t>s.width)&&(s=e,i=r)}return s?Se(e,f(s,AH),p(s,qB),p(s,gU),null,null,f(s,qk)):null}(e,i,n,r)
return t.crop="bb",t}return null!=i?Vr(e,i,o):null}function qr(e,t,n,r,o,i){const s=l(t.meta,eT),a=[]
if((0,kv.isSome)(s))for(const t of s){const n=Du(e,t,{artworkUseCase:1,metricsOptions:i,useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:ff}),r=null==n?void 0:n.icon;(0,kv.isSome)(r)&&a.push(r)}return a}function Wr(e,t,n,a,c,l,u,d){var p,h,w
const g=(null===(p=f(t,AH))||void 0===p?void 0:p.length)>0,v=(null===(h=ie(t,ST))||void 0===h?void 0:h.length)>0,m=ge(t,Yj,!1),y=ge(t,FH,!1)||m
let A=ie(t,rV)===GT
if(v||g)return function(e,t,n,o,s){const a=i(f(t,AH))?t:ne(t,uH)
if(r(a)||Mr(n))return c=t,s?s():null==n||n.remainingItems.push(c),null
var c
const l=f(a,nM),u=f(a,AH),d=f(a,CV),p=Qr(ie(t,DO))||d
let h=null
if(l===p_)h=new MW(u),h.title=p
else{const t=e.required(G4).fetchFlowPage(u),n=new dY(t)
n.pageUrl=u,n.title=p,h=n}return h.presentationStyle=[NC],sp(e,h,{...o,id:""}),{action:h,caption:null,title:p,subtitle:null,artwork:null,shortEditorialDescription:null}}(e,t,n,l,d)
if(y){let p,h,g
if(a&&!m){g=co(e,"groupingCommon",Ae(t,FH),!0,c,!1,1)
const n=g.personalizedData
if(0===n.length)return null
p=n[0]}else p=ye(e,t,m?Yj:FH)
if(ie(p,rV)===GT&&(h=p,p=ye(e,p,Yj),A=!0),r(p))return null
if(r(p.attributes)||Mr(n))return s(n)&&(n.isDeferring=!0),function(e){d?d():null==n||n.remainingItems.push(e)}(p),null
let v=Kd(e,p,oG)||Cu(e,p)
const y=rp(e,t,l)
y.targetType=l.targetType
let T=ju(e,p,y,null==n?void 0:n.clientIdentifierOverride)
const b=ae(p,UN)
let S,P=null,I=null,C=null
const k=ie(p,"itunesNotes.short"),O=(null===(w=p.id)||void 0===w?void 0:w.length)>0,E={...l,id:O?p.id:t.id,idType:O?ZV:XN}
switch(p.type){case pj:P=ne(p,_H),A&&(p=null!=h?h:t)
break
case OH:{const t=ye(e,p,sV)
if(s(t)){const r={...E,inAppEventId:t.id},s=ye(e,t,SH)
i(s)&&(r.relatedSubjectIds=[s.id])
const a=zi(e,t,null,!1,!0,mH,BV,!1,r,!1,!0,null,n.isArcadePage,!1)
if("AppEventCard"===ie(p,uF)){if(a instanceof Date)return nr(a,u.refreshController),null
if((0,kv.isNothing)(a))return null
S=a,b||(T=S.clickAction),o(v)&&(v=Kd(e,t,kG))}}I=ie(p,CV),I&&(I=I.replace(/\n/g," "))
const a=ye(e,p,FH),c=f(p,LG)
o(v)&&(c?v=c:a&&(v=Kd(e,a,kG))),o(v)&&i(S)&&(v=S.subtitle)
let d=ie(p,gO);((0,kv.isNothing)(d)||0===d.length)&&(d=v)
const h={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
if(r(S)&&It(0,p),h.clientIdentifierOverride=yn(e,p),i(S))C=S.lockup
else{const t=null,r=null
{kf(e,E,null==n?void 0:n.title)
const o=ss(e,Ae(p,sV),h,l.pageInformation,l.locationTracker,t,r,It(0,p))
1===o.length&&(C=o[0]),Ef(E.locationTracker)}}}default:{const t=[BH,kj,IH,kV]
if(r(C)&&t.indexOf(p.type)>-1){kf(e,E,null==n?void 0:n.title)
const t={metricsOptions:{pageInformation:l.pageInformation,locationTracker:l.locationTracker,recoMetricsData:W(p)},clientIdentifierOverride:null==n?void 0:n.clientIdentifierOverride,artworkUseCase:td(0,null==n?void 0:n.shelfStyle),canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:e.featureFlags.isEnabled(BF)&&n.isArcadePage}
C=Du(e,p,t),Ef(E.locationTracker)}P=Be(e,p,lH)||ne(p,lH),o(v)&&i(C)&&(v=C.subtitle)
break}}if(i(T)&&(T.presentationStyle=[NC],!A)){const n=Qr(ie(t,DO)),r=Kd(e,p,GH)
T.title=n||r||T.title||v||I}return{action:T,caption:I,title:null==T?void 0:T.title,subtitle:v,artwork:P,shortEditorialDescription:k,content:p,lockup:C,appEvent:S,onDevicePersonalizationDataProcessingType:null==g?void 0:g.processingType}}return null}function zr(e,t,n,r){const o=ie(t,GH),i=Er(e,f(t,eU)),s=e.required(G4).fetchFlowPage(i),a=new dY(s)
return a.pageUrl=i,{action:a,caption:jT,title:o,subtitle:jT,artwork:null,shortEditorialDescription:o}}function Yr(e,t){const n={}
for(const t of e)n[t.id]=t
const r=[FH,PG],o=[]
for(const e of t){let t=!0
for(const o of r){const r=Ae(e,o)
if(i(r)){const i=[]
for(const e of r){const t=n[e.id]
s(t)&&i.push(t)}i.length===r.length?e.relationships[o]={data:i}:t=!1}}t&&o.push(e)}return o}function Jr(e,t,n){t.seeAllAction=null,t.isHorizontal=!1,t.shouldFilterApps&&(t.filteredItemsMinimumCount=0,t.filteringExcludedItems=n.includedAdAdamIds)}function Kr(e,t){switch(t){case OV:return sj
case dN:return rF
case KV:return lN
case lj:return _O
default:return null}}function Zr(e,t){let n=ie(t,wj)
return n||(n=ie(t,"contentId")),n||(n=ie(t,"id")),n}function Qr(e){if(r(e))return null
const t=e.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#96;/g,"`").replace(/\r\n/g," ").replace(/&nbsp;/g," ").replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g," ").replace(/\u23ce/g,"").replace(/<i>/g,"").replace(/<\/i>/g,"").replace(/<b>/g,"").replace(/<\/b>/g,"")
return t.match(/^\s*$/)?null:t}function Xr(e,t,n){e.featureFlags.isEnabled(HF)?t.titleAction=n:t.accessoryAction=n}function eo(e,t,n){e.featureFlags.isEnabled(HF)?(0,kv.isSome)(t.header)?Xr(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}async function to(e,t,n){const r=n===VH?"OnDeviceRecommendationsShelfController":hS
return await new Promise((n,i)=>{if(o(e.user.dsid)){const e=`${r}: User is currently not signed in.`
return Iv.unexpectedType(dV,e,null),void i(new Error(e))}if(o(t)){const e=`${r}: Missing valid useCase for ODP: ${t}`
return Iv.unexpectedType(dV,e,null),void i(new Error(e))}e.onDeviceRecommendationsManager.performRequest({type:wS,dsId:e.user.dsid,useCase:t}).then(a=>{const c=l(a[gS]),u=y(a[eG])
if(o(c)){const e=`${r}: ODP returned no candidate ids for useCase: ${t}`
return Iv.unexpectedType(dV,e,null),void i(new sQ(e))}if(o(u)){const e=`${r}: ODP returned no metrics for useCase: ${t}`
return Iv.unexpectedType(dV,e,null),void i(new Error(e))}const d=[]
for(const e of c)s(e)&&d.push({id:e,type:BH})
const f=new wJ(e,d).withFilter("apps:recommendable",FV).addingQuery(Hz.onDevicePersonalizationUseCase,t)
Gr(e,f),Jn(e,f).then(e=>{n({candidates:c,recoMetrics:u,dataContainer:e})}).catch(e=>{const t=`${r}: Failed to fetch Media API data for candidates: ${c}`
Iv.unexpectedType(dV,t,null),i(new Error(t))})}).catch(e=>{const n=`${r}: Failed to perform ODP for useCase: ${t}, ${e}`
Iv.unexpectedType(dV,n,null),i(new Error(n))})})}function no(e){const t=new Set,n=[]
return e.forEach((e,r)=>{t.has(e.appId)||(n.push(e.appId),t.add(e.appId))}),n}function ro(e,t){var n
const r=Number(null!==(n=t[dS])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.onDeviceScore
t.modifiedScore=r*n+(1-r)*e}return e.sort((e,t)=>t.modifiedScore-e.modifiedScore),e}function oo(e,t){const n=e.filter(e=>i(e.pinnedPosition))
e=e.filter(e=>r(e.pinnedPosition))
const o=new Map
e.reverse(),e.forEach((e,t)=>{e.appId in o?o[e.appId].push(e):o[e.appId]=[e]})
const s=[],a=Math.max(...Object.values(o).map(e=>e.length))
for(let e=0;e<a;e++){const e=[]
t.forEach(t=>{t in o&&o[t].length>0&&(s.push(o[t].pop()),0!==o[t].length&&e.push(t))}),t=e}const c=new Array(n.length+s.length)
n.sort((e,t)=>e.pinnedPosition-t.pinnedPosition)
for(const e of n)e.pinnedPosition<c.length?c[e.pinnedPosition]=e:s.push(e)
s.reverse()
for(const[e,t]of c.entries())r(t)&&s.length&&(c[e]=s.pop())
return c}function io(e){const t=new Map
return s(e)&&e.split(",").forEach(e=>{const n=e.split("=")
2===n.length&&t.set(n[0],Number(n[1]))}),t}function so(e,t,n,s,a,c,l,u){var d
let h={sortedDataItems:[],processingType:0}
if(null!==(d=null==n?void 0:n.metricsData[ME])&&void 0!==d&&d){const e=function(e,t,n,r,o){const s=[]
for(const e of t){const t=new cQ(e),a=p(e,Gx)
let c=f(e,eB)
if(((0,kv.isNothing)(c)||0===c.length)&&(null==o?void 0:o.length)>0&&(c=o),(0,kv.isNothing)(c)||0===c.length)r&&(t.isUnpersonalizedMatch=!0,s.push(t))
else{if(i(n)){const e=n[c]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=c,t.score=null!=a?a:0,s.push(t)}}return s}(0,t,null==n?void 0:n.personalizationData,s,l),r=ro(e,null==n?void 0:n.metricsData),o=e.every((e,t)=>e===r[t])
h={sortedDataItems:r,processingType:o?0:2},i(c)&&h.sortedDataItems.length>=c&&(h.sortedDataItems=h.sortedDataItems.slice(0,c))}else{const d=function(e,t,n,r,s){const a=[]
for(const c of t){const t=new cQ(c),l=f(c,pS)
let u=f(c,eB),d=f(c,$E)
if(((0,kv.isNothing)(u)||0===u.length)&&(null==s?void 0:s.length)>0&&(u=s,d=e.random.nextUUID()),o(l)||o(u)||o(d)){r&&(t.isUnpersonalizedMatch=!0,a.push(t))
continue}const p=l.split(",")
if(p.includes(lQ)&&(t.isWildcardMatch=!0),i(n)){const e=n[u]
if(i(e))for(const n of p)if(e.userSegments.includes(n)){t.isExactMatch=!0
break}}t.appId=u,t.groupId=d,a.push(t)}return a}(e,t,null==n?void 0:n.personalizationData,s,l),p=no(d),w=function(e,t){var n
const r=new Set,i=[],s=t.filter(e=>e.isExactMatch).map(e=>e.groupId),a=new Set(s)
t.forEach((e,t)=>{if(o(e.groupId))i.push(e)
else if(!r.has(e.groupId))if(e.isUnpersonalizedMatch)i.push(e)
else{if(e.isExactMatch)return r.add(e.groupId),void i.push(e)
if(!a.has(e.groupId)){if(e.isWildcardMatch)return r.add(e.groupId),void i.push(e)
e.isFallbackMatch=!0,i.push(e)}}})
const c=[],l=i.slice().reverse()
for(const e of l)e.isFallbackMatch&&r.has(e.groupId)||(c.push(e),(null===(n=e.groupId)||void 0===n?void 0:n.length)>0&&r.add(e.groupId))
return c.reverse(),c}(0,d)
h=function(e,t,n,o,i,s){let a
const c=t.filter(e=>e.isExactMatch||e.isWildcardMatch||e.isUnpersonalizedMatch||r(e.groupId))
return r(i)?a=ao(c,o,s):c.length>=i||!n?(a=ao(c,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)):(a=ao(t,o,s),a.sortedDataItems=a.sortedDataItems.slice(0,i)),a}(0,w,a,p,c,u)}const w=h.sortedDataItems.map(e=>e.rawData)
return{personalizedData:w,processingType:(t.length!==w.length?1:0)+h.processingType}}function ao(e,t,n){const r=e.filter(e=>e.isExactMatch)
let o=e.filter(e=>!e.isExactMatch)
i(n)&&n&&(o=oo(o,t))
const s=r.concat(o),a=e.every((e,t)=>e===s[t])
return{sortedDataItems:s,processingType:a?0:2}}function co(e,t,n,r,a,c=!1,l,u,d){return lo(e)?t===AT?function(e,t,n,r,o){var a,c
let l=t,u=!1
const d=[]
e.featureFlags.isEnabled("contingent_offers_personalization")||(l=t.filter((e,t)=>!s(e.type)||e.type===DH||(d.push(t),!1)),u=l.length!==t.length)
const h=null==r?void 0:r.metricsData,w=null!==(a=h.use_segment_scores)&&void 0!==a&&a,g=null!==(c=h[ME])&&void 0!==c&&c
let m
if(m=w||g?function(e,t,n,r){var o
let s=[],a=[]
null!==(o=null==n?void 0:n.metricsData[ME])&&void 0!==o&&o?(s=function(e,t,n){const r=[]
for(const[e,o]of t.entries()){const t=new aQ(o),s=v(o,fS),a=f(o,eB),c=p(o,Gx)
if(i(n)){const e=n[a]
i(e)&&i(e.onDeviceSignals)&&(t.onDeviceScore=+e.onDeviceSignals)}t.appId=a,t.score=null!=c?c:0,s&&(t.pinnedPosition=e),r.push(t)}return r}(0,t,null==n?void 0:n.personalizationData),a=ro(s,null==n?void 0:n.metricsData)):(s=function(e,t){const n=[]
for(const[e,r]of t.entries()){const t=new aQ(r),o=f(r,eB),i=f(r,$E),s=p(r,Gx),a=f(r,"meta.personalizationData.segScores"),c=v(r,fS),l=io(a)
t.appId=o,t.groupId=i,t.score=null!=s?s:0,t.segScores=l,c&&(t.pinnedPosition=e),n.push(t)}return n}(0,t),a=function(e,t){const n=function(e,t){var n
for(const r of e){const e=r.appId,o=r.segScores,s=r.score
if(i(t)){const a=t[e]
if(i(a)){let e=0,t=0
for(const n of a.userSegments)o.has(n)&&(t+=o.get(n),e+=1)
if(e){const n=t/e
r.modifiedScore=s*n}}else{const e=null!==(n=o.get("0"))&&void 0!==n?n:0
r.modifiedScore=s*e}}else r.modifiedScore=s}return e}(e,null==t?void 0:t.personalizationData),r=function(e,t){var n
const r=Number(null!==(n=t[dS])&&void 0!==n?n:0)
for(const t of e){const e=t.score,n=t.modifiedScore
t.modifiedScore=r*n+(1-r)*e}return e}(n,null==t?void 0:t.metricsData)
return r.sort((e,t)=>t.modifiedScore-e.modifiedScore),r}(s,n),i(r)&&r&&(a=oo(a,no(a))))
const c=a.map(e=>e.rawData),l=a.every((e,t)=>e===s[t])?0:2
return{personalizedData:c,processingType:(t.length!==c.length?1:0)+l}}(0,l,r,o):so(e,l,r,n,null,null,null,o),u){const e=m.personalizedData
d.forEach(n=>{const r=t[n]
n<e.length?e.splice(n,0,r):e.push(r)}),m={personalizedData:e,processingType:m.processingType}}return m}(e,n,r,a,d):so(e,n,a,r,c,l,u,d):function(e,t,n){let r=[]
const s=new Set
for(const e of t){const t=f(e,pS),n=f(e,eB),i=f(e,$E)
o(t)||o(n)||o(i)?r.push(e):s.has(i)||t.split(",").includes(lQ)&&(r.push(e),s.add(i))}return i(n)&&r.length>n&&(r=r.slice(0,n)),{personalizedData:r,processingType:null}}(0,n,l)}function lo(e){return e.user.isOnDevicePersonalizationEnabled&&e.bag.enableOnDevicePersonalization}function uo(e,t){return lo(e)?e.host.platform===fj?e.user.onDevicePersonalizationDataContainerForAppIds(Array.from(t)):{personalizationData:{},metricsData:null}:null}function fo(e){return lo(e)&&e.host.platform===fj?e.user.onDevicePersonalizationDataContainerForAppIds([]).metricsData:null}function po(e,t){return{incidents:[],iAdInfo:t}}function ho(e,t){return(0,kv.isNothing)(t)||(0,kv.isNothing)(t.incidents)||0===t.incidents.length?null:t.incidents}function wo(e,t,n){var r,o
null===(r=null==t?void 0:t.iAdInfo)||void 0===r||r.setMissedOpportunity(e,e_,null===(o=null==t?void 0:t.iAdInfo)||void 0===o?void 0:o.placementType)}function go(e,t,n){var r,o,i,s,a,c,l,u
if((0,kv.isNothing)(n)||(0,kv.isNothing)(n.failureReason)||0===n.failureReason.length)return
const d=null===(r=null==t?void 0:t.iAdInfo)||void 0===r?void 0:r.placementType
switch(null==n?void 0:n.failureReason){case ly:null===(o=null==t?void 0:t.iAdInfo)||void 0===o||o.setMissedOpportunity(e,e_,d)
break
case ik:null===(i=null==t?void 0:t.iAdInfo)||void 0===i||i.setMissedOpportunity(e,e_,d)
break
case"insufficientAssets":null===(s=null==t?void 0:t.iAdInfo)||void 0===s||s.setMissedOpportunity(e,e_,d)
break
case"noAdAvailable":null===(a=null==t?void 0:t.iAdInfo)||void 0===a||a.setMissedOpportunity(e,XD,d)
break
case"timeout":null===(c=null==t?void 0:t.iAdInfo)||void 0===c||c.setMissedOpportunity(e,"APSLA",d)
break
case uy:null===(l=null==t?void 0:t.iAdInfo)||void 0===l||l.setMissedOpportunity(e,"NOLOC",d)
break
case"policyAdDrop":null===(u=null==t?void 0:t.iAdInfo)||void 0===u||u.setMissedOpportunity(e,dy,d)}}function vo(e,t,n){if((0,kv.isNothing)(t))return
const r=Ft(n.pageInformation)
if(null===r)return
r.id=vf(n.id)
const o=hf(n);(0,kv.isSome)(o)&&(r[Ex]=o),r[oj]=DV,r.typeDetails="iTunesStoreContent",r[jF]=If(e,n,""),n.actionDetails&&(r[bU]=n.actionDetails),t.templateMediaEvent=function(e,t){const n={}
return Object.assign(n,t),n[vG]=db,np(e,n),Kf(0,new CW(n,[],[],tp(e,n),ep(e,n)))}(e,r)
const i=b(r)
i[dF]=t.videoUrl,t.templateClickEvent=function(e,t,n,r){const o={}
Object.assign(o,r),o[vG]=iB,o[hx]=n,o[ab]=null
const i=[sB]
return np(e,o),Kf(0,new CW(o,i,[],tp(e,o),ep(e,o)))}(e,0,NH,i)}function mo(e,t){return t?[RX,BX]:[]}function yo(e,t){return ko(CQ,t)}function Ao(e,t){return ko(KQ,t)}function To(e){return QQ}function bo(e){return eX}function So(e){return rX}function Po(e){return cX}function Io(e){return dX}function Co(e,t){return e.client.isCompanionVisionApp?yX:ko(mX,t)}function ko(e,t){const n={...e}
return(0,kv.isSome)(t)&&(n.crops=t),n}function Oo(e,t,n){const r=is(t,n.coercedCollectionTodayCardDisplayStyle),o=n.isHorizontalShelfContext?function(e,t){const n=[]
return n.push(Co(e,[Xm])),t.horizontalCardContentType===lN&&n.push(To()),n.push(Ao(0,["sr"]),yo(0,["sr"])),n}(e,n):function(e,t,n){const r=new Set([am.List,am.NumberedList])
if(e.client.isPad&&n.isHeroCard&&!r.has(t))return mo(0,n.isHeroCard)
switch(t){case am.AppEventCard:return[So(),Po(),Io(),Co(e),...mo(0,n.isHeroCard),TQ]
case am.AppOfTheDay:case am.GameOfTheDay:return[So(),Po(),Io(),Co(e),...mo(0,n.isHeroCard),gQ]
case am.List:case am.NumberedList:return[NQ,qQ]
case am.ShortImage:return n.isSearchContext?[yo(),So(),Po(),Io(),Co(e),...mo(0,n.isHeroCard),To(),bo(),Ao()]:[So(),Po(),Io(),Co(e),...mo(0,n.isHeroCard),To(),bo(),yo(),Ao()]
case am.FullBleedImage:return[So(),Po(),jX,ko(WX,undefined),Io(),Co(e),...mo(0,n.isHeroCard),To(),bo(),Ao(),yo()]
case am.SingleApp:case am.Video:default:return[So(),Po(),Io(),Co(e),...mo(0,n.isHeroCard),To(),bo(),Ao(),yo()]}}(e,r,n)
let i,s=!1
const a=wt(t)
if(le(a)&&(i=o.find(e=>(0,kv.isSome)(ne(a,e.objectPath))),s=(0,kv.isSome)(i)),(0,kv.isNothing)(i)&&(i=o.find(e=>(0,kv.isSome)(ne(t,e.objectPath)))),!i)return
const c=ne(s?a:t,i.objectPath)
if(i.type===NG){const t=i.crops.map(t=>{let r=t
return n.isSearchContext&&(0,kv.isSome)(n.prevailingCropCodes)?r=n.prevailingCropCodes.defaultCrop:(0,kv.isSome)(n.prevailingCropCodes)&&(0,kv.isSome)(n.prevailingCropCodes[i.objectPath])&&(r=n.prevailingCropCodes[i.objectPath]),nd(e,c,{withJoeColorPlaceholder:!0,cropCode:r,useCase:15,overrideHeight:i.sourceHeight,overrideWidth:i.sourceWidth})}),r=df(c)
return{artworks:t,videos:[],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:r}}{const t=h(c,vU),r=p(t,qB),o=p(t,gU)>=r
let s=i.sourceHeight,a=i.sourceWidth
o&&([s,a]=[a,s])
const l=nd(e,t,{withJoeColorPlaceholder:!0,cropCode:i.crops[0],useCase:15,overrideHeight:s,overrideWidth:a})
if((0,kv.isNothing)(l))return
let u={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0};(0,kv.isSome)(n.videoPlaybackControls)&&(u=n.videoPlaybackControls)
let d={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0};(0,kv.isSome)(n.videoPlaybackControls)&&(d=n.videoAutoplayPlaybackControls)
const w=f(c,DV)
if((0,kv.isNothing)(w))return
const g=new Vq(w,l,{playbackControls:u,autoPlayPlaybackControls:d,canPlayFullScreen:n.enableFullScreenVideo}),v=df(t)
return{artworks:[],videos:[g],artworkLayoutsWithMetrics:i.cardArtLayoutMetrics,joeColors:v}}}function Eo(e,t){return u(t,zX)}function Ro(e,t,n,r,o){return Iv.context("createTodayBaseCard",()=>{const i=new jJ,s=is(t,null==n?void 0:n.coercedCollectionTodayCardDisplayStyle),a=Do(e,t,s,n)
i.heading=a
const c=function(e,t,n){var r
let o=null
if((null==n?void 0:n.useOTDTextStyle)&&(o=null!==(r=ie(t,"ofTheDayLabel"))&&void 0!==r?r:ie(t,CV),(0,Cv.isSome)(o)&&(o=o.replace(/\n/g,ZL))),(0,Cv.isNothing)(o)&&(o=Kd(e,t,GH,!0)),(0,Cv.isNothing)(o)){const e=_o(0,t)
o=(0,Cv.isSome)(e)?ie(e,GH):null}return o}(e,t,n)
i.title=c
const l=Ge(e,t,[yM,GH])
i.shortTitle=l
const u=function(e,t){return nd(e,ne(t,RA),{contentMode:Ov.scaleAspectFit,allowingTransparency:!0,useCase:17})}(e,t)
i.titleArtwork=u
const d=function(e,t){var n
const r=hn(0,t)
if(ae(t,wO)||r.suppressNoteShort)return null
let o=Kd(e,t,kG,!0)
if((0,Cv.isNothing)(o)&&!r.suppressNoteTagline){const r=_o(0,t);(0,Cv.isSome)(r)&&(o=null!==(n=Kd(e,r,oG))&&void 0!==n?n:Cu(e,r))}return o}(e,t)
i.inlineDescription=d
const f=rs(e,t,n,r,c)
return f.adSlotOverride=r.parsedCardCount,i.clickAction=function(e,t,n,r,o,i,s){var a
const c=i,l={cardType:n,franchise:ie(t,CV)},u=Eo(0,t)
return u&&(l[xb]=u),c[bU]=l,(0,Cv.isSome)(s)&&s(c),qu(e,t,c,null!==(a=null==r?void 0:r.clientIdentifierOverride)&&void 0!==a?a:e.host.clientIdentifier,ii(o.currentTodayItem),r)}(e,t,s,n,r,f,o),Gf(e,i,f,a,s,Eo(0,t)),i.editorialDisplayOptions=function(e,t,n){var r
const o=hn(0,t),i=e.client.isPad&&(null==n?void 0:n.isHeroCard)
return{suppressTagline:se(t,wO),suppressLockup:v(o.suppressLockup),showBadgeInSmallCards:null!==(r=n.alwaysShowBadgeInSmallCards)&&void 0!==r?r:v(o.showBadgeInSmallCards),useMaterialBlur:n.alwaysUseMaterialBlur||i||v(o.useMaterialBlur)}}(e,t,n),i})}function Do(e,t,n,o){var i,s
let a=null
if(null==o?void 0:o.useOTDTextStyle)a=o.isHorizontalShelfContext?ie(t,CV):null
else if(function(e,t){let n=ie(e,"ofTheDayIntent")
if((0,kv.isNothing)(n))switch(is(e,null==t?void 0:t.coercedCollectionTodayCardDisplayStyle)){case am.AppOfTheDay:n=um.AppOfTheDay
break
case am.GameOfTheDay:n=um.GameOfTheDay}return n===um.AppOfTheDay||n===um.GameOfTheDay}(t,o))a=null!==(i=ie(t,NR))&&void 0!==i?i:ie(t,CV),r(a)&&n===am.AppOfTheDay?a="FEATURED APP":r(a)&&n===am.GameOfTheDay&&(a="FEATURED GAME")
else if(n===am.AppEventCard){const n=_o(0,t);(0,Cv.isSome)(n)&&(a=null!==(s=Zd(e,t,MN,!0))&&void 0!==s?s:ie(n,rV))}else a=ie(t,CV)
return a}function _o(e,t){const n=Ae(t,Yj)
if(1===(null==n?void 0:n.length))return n[0]
const r=as(0,t)
return 1===r.length?r[0]:null}function xo(e,t,n,r,o){return Iv.context("addArtworkMediaToBaseCard",()=>{if(ae(t,oD))return!1
const i=Oo(e,t,r)
return!(0,Cv.isNothing)(i)&&((0,Cv.isSome)(o)&&vo(e,null==i?void 0:i.videos[0],{pageInformation:o.pageInformation,locationTracker:o.locationTracker,id:t.id}),n.media=new bJ(i.artworks,i.videos,i.artworkLayoutsWithMetrics,ds(0,t,r)),n.style=ps(i.joeColors,LU),n.clickAction instanceof MW&&(n.overlay=new BJ(n.clickAction),n.style=BV),!0)})}function Lo(e,t,n,r){return Nu(e,t,{offerEnvironment:"ad",offerStyle:QU,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdvert:!0,adSlotOverride:r.parsedCardCount,disableFastImpressionsForAds:!0},clientIdentifierOverride:n.clientIdentifierOverride,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:1,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton},{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{}},null,!1)}function Mo(e,t,n){const r=n.reco_algoId
if(o(r)||o(e)||o(t[r]))return e
const i=e.map(e=>{var t
return{identifier:p(e.id),score:null!==(t=p(e,Gx))&&void 0!==t?t:0}}),s=t[r],a=(0,hm.demoteByEngagements)(i,s),c=e.reduce((e,t)=>({...e,[t.id]:t}),{})
return a.map(e=>c[e.identifier.toString()])}function $o(e,t){if(!s(t))return{}
const n=h(t,"data.engagementEvents.impression"),r={}
for(const e in n)if(s(e)){const t=l(n,e)
r[e]=t.map(e=>({adamIdentifier:p(e[wj]),timestamp:p(e.eventTimeMillis)}))}return r}function Fo(e){return e.bag.enableRecoOnDeviceReordering}function No(e){for(const t of e)switch(t.type){case wm.EditorialItem:case wm.EditorialItemGroup:return le(t.data)}return!1}function Bo(e,t){if(!lo(e))return null
const n=new Set
for(const e of t){if(r(e.contents))continue
const t=e=>f(e,eB)
for(const r of e.contents)if(r.type===sG){const e=l(r.meta,lD)
for(const r of e){const e=t(r)
s(e)&&n.add(e.toString())}}else{const e=t(r)
s(e)&&n.add(e.toString())}}return uo(e,n)}function Uo(e,t,n,r,o,i){var s
const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
return a.useOTDTextStyle=null!==(s=v(t,"meta.personalizationData.isOfTheDay"))&&void 0!==s&&s,a.replaceIfAdPresent=v(t,gI),a.isAdEligible=n,a.currentRowIndex=r,a.metricsDisplayStyle=o,a.isHeroCard=i,a}function Go(e,t){if(e.client.isPhone)return t.currentRowIndex}function jo(e,t,n){switch(t){case Gv.Grid:n%2==1&&e.currentRowIndex++
break
case Gv.Hero:0!==n&&(n-1)%2!=1||e.currentRowIndex++
break
case Gv.Standard:e.currentRowIndex++}}function Vo(e,t,n,r){if(e.client.isPad)t.currentRowMetricsDisplayStyle=cm.MediumCard
else switch(n){case Gv.Grid:t.currentRowMetricsDisplayStyle=cm.SmallCard
break
case Gv.Hero:t.currentRowMetricsDisplayStyle=0===r?cm.MediumCard:cm.SmallCard
break
case Gv.Standard:t.currentRowMetricsDisplayStyle=cm.MediumCard}}function Ho(e,t){var n
if(t.type===OH)return Gv.Standard
let r
const o=wt(t)
return le(o)&&(r=ie(o,"editorialItemGroupDisplayStyle")),(0,kv.isNothing)(r)&&(r=null!==(n=ie(t,tV))&&void 0!==n?n:Gv.Standard),function(e,t){return!(0,kv.isNothing)(t)&&(t!==Gv.Grid||e.client.isPhone)}(e,r)?r:Gv.Standard}function qo(e){return e.adLocation===e.parsedCardCount||!(0,kv.isNothing)(e.eligibleAdLocations)&&e.eligibleAdLocations.includes(e.parsedCardCount)}function Wo(e,t,n){var r
const o=Yo(e,t,n,()=>{var r,o,i
const s=[]
null===(r=n.pageInformation.iAdInfo)||void 0===r||r.updateContainerId(null===(o=n.pageInformation.iAdInfo)||void 0===o?void 0:o.containerIdForSlotIndex(null!==(i=n.parsedCardCount)&&void 0!==i?i:0))
const a=Ho(e,t.data)
Vo(e,n,a,0)
const c=Uo(0,t.data,qo(n),Go(e,n),n.currentRowMetricsDisplayStyle,!1)
c.baseMetricsOptions={recoMetricsData:ii(t)}
const l=Jo(e,n,c,t.data)
return(0,kv.isNothing)(l)||(s.push(l),xf(n.locationTracker),n.parsedCardCount++,jo(n,a,0)),s})
if(o.contentsMetadata={type:uD,debugSectionTypeIndicatorColor:t.type===wm.EditorialItemGroup?Z(cO):Z(c_),groupDisplayStyle:Gv.Standard},!t.isFirstItemInModule){const e=oi(0,t);(0,kv.isSome)(e)&&(o.background=e.shelfBackground,(0,kv.isSome)(null===(r=o.header)||void 0===r?void 0:r.configuration)&&(o.header.configuration.eyebrowColor=e.eyebrowColor,o.header.configuration.titleColor=e.titleColor,o.header.configuration.subtitleColor=e.subtitleColor))}return o}function zo(e,t,n){var r
let o=!0
const i=Yo(e,t,n,()=>{var r,i,s,a,c,u,d
const f=[],p=Fo(e)&&null!==(r=(0,Yv.asNumber)(t.data,"meta.personalizationData.displayEICount"))&&void 0!==r?r:100
let h=l(t.data.meta,lD);(0,kv.isSome)(n.recoImpressionData)&&(h=Mo(h,n.recoImpressionData,null!==(i=n.pageInformation.recoMetricsData)&&void 0!==i?i:{}))
const w=Ho(e,t.data)
let g=0
for(const[r,i]of h.entries()){null===(s=n.pageInformation.iAdInfo)||void 0===s||s.updateContainerId(null===(a=n.pageInformation.iAdInfo)||void 0===a?void 0:a.containerIdForSlotIndex(null!==(c=n.parsedCardCount)&&void 0!==c?c:0)),Vo(e,n,w,g)
const l=Uo(0,i,qo(n),Go(e,n),n.currentRowMetricsDisplayStyle,w===Gv.Hero&&0===r),d=Jo(e,n,l,i)
if((0,kv.isSome)(d)&&(f.push(d),xf(n.locationTracker),n.parsedCardCount++,jo(n,w,g),g++),l.isHeroCard&&(0,kv.isNothing)(d)&&([$U,LB].includes(e.client.buildType)&&Iv.unexpectedType(dV,`Hero story group ${null===(u=t.data)||void 0===u?void 0:u.id} must contain a valid hero card at index ${r}. Unable to parse card ${i.id}.`,null),o=!1),r<h.length-1&&n.adPlacementBehavior===Vv.insertIntoShelf){const t=Zo(e,n,Uo(0,n.adData,qo(n),Go(e,n),void 0,!1));(0,kv.isSome)(t)&&(n.parsedCardCount++,jo(n,Gv.Standard,0),xf(n.locationTracker),f.push(t))}if(f.length===p)break}if(o){const n=3
f.length!==n&&([$U,LB].includes(e.client.buildType)&&Iv.unexpectedType(dV,`Hero story group ${null===(d=t.data)||void 0===d?void 0:d.id} must contain exactly ${n} items but only found ${f.length} items.`,null),o=!1)}return f})
let s=Ho(e,t.data)
if(s!==Gv.Hero||o||(s=Gv.Standard),i.contentsMetadata={type:uD,debugSectionTypeIndicatorColor:Z(cO),groupDisplayStyle:s},!t.isFirstItemInModule){const e=oi(0,t);(0,kv.isSome)(e)?(i.background=e.shelfBackground,(0,kv.isSome)(null===(r=i.header)||void 0===r?void 0:r.configuration)&&(i.header.configuration.eyebrowColor=e.eyebrowColor,i.header.configuration.titleColor=e.titleColor,i.header.configuration.subtitleColor=e.subtitleColor)):s===Gv.Hero&&Array.isArray(i.items)&&(i.background=function(e){const t=e.map(e=>e.media.bestBackgroundColor()).filter(e=>(0,kv.isSome)(e))
let n=null
if(t.length>0&&t.length<=4&&t.length===e.length)switch(t.length){case 1:n={type:wL,colors:{colorCount:"oneColor",color:t[0]}}
break
case 2:n={type:wL,colors:{colorCount:"twoColor",top:t[0],bottom:t[1]}}
break
case 3:n={type:wL,colors:{colorCount:"threeColor",top:t[0],bottomLeading:t[1],bottomTrailing:t[2]}}
break
case 4:n={type:wL,colors:{colorCount:"fourColor",topLeading:t[0],topTrailing:t[1],bottomLeading:t[2],bottomTrailing:t[3]}}}else n={type:ej,color:Z("secondarySystemBackground")}
return n}(i.items))}return i}function Yo(e,t,n,r){const i=t.type===wm.EditorialItemGroup,s=new oJ(pG)
if(s.id=t.data.id,s.isHorizontal=!1,s.header=function(e,t,n){var r
if(null!==(r=v(t.data,"meta.personalizationData.suppressHeader"))&&void 0!==r&&r)return null
const o={eyebrow:Qo(0,t),eyebrowArtwork:ti(e,t,dm.Eyebrow),eyebrowArtworkType:ni(e,t,dm.Eyebrow),title:Xo(0,t),titleArtwork:ti(e,t,dm.Title),titleArtworkType:ni(e,t,dm.Title),subtitle:ei(0,t),configuration:{eyebrowImageColor:null,titleImageColor:null,includeSeparator:!1}}
return(0,kv.isSome)(o.eyebrow)||(0,kv.isSome)(o.title)||(0,kv.isSome)(o.subtitle)?o:null}(e,t),i){const r={id:s.id,kind:FE,softwareType:null,targetType:jV,title:Xo(0,t,!0),pageInformation:n.pageInformation,locationTracker:n.locationTracker,idType:ZV,recoMetricsData:ii(t)}
t.type===wm.EditorialItemGroup&&(r[Mb]=f(t.data,hI),r[Lb]=f(t.data,wI)),Bf(e,s,r),kf(e,r,r.title)}return s.items=r(),s.isHidden=o(s.items),i&&(Ef(n.locationTracker),xf(n.locationTracker)),s}function Jo(e,t,n,r){var o,a
let c
if(t.adPlacementBehavior===Vv.replaceOrganic&&i(n.replaceIfAdPresent)&&v(n.replaceIfAdPresent)){const o=Zo(e,t,n)
c=s(o)?o:ts(e,r,n,t)}else if(t.adPlacementBehavior===Vv.dropAd&&i(n.replaceIfAdPresent)&&!v(n.replaceIfAdPresent)){if(c=ts(e,r,n,t),s(t.adData)){const n=t.adIncidentRecorder
null===(o=null==n?void 0:n.iAdInfo)||void 0===o||o.setMissedOpportunity(e,sy,null===(a=null==n?void 0:n.iAdInfo)||void 0===a?void 0:a.placementType)}}else c=ts(e,r,n,t)
return c}function Ko(e,t){let n=null
if(!Dn(e,PH)||(0,kv.isNothing)(t.adData)||t.adPlacementBehavior!==Vv.insertIntoShelf)return n
if(t.adLocation!==t.parsedCardCount)return n
n=new oJ(pG),n.id=t.adData.id,n.isHorizontal=!1,n.contentsMetadata={type:uD,debugSectionTypeIndicatorColor:Z(c_),groupDisplayStyle:Gv.Standard}
const r=[],o=Zo(e,t,Uo(0,t.adData,qo(t),Go(e,t),void 0,!1))
return(0,kv.isSome)(o)&&(t.parsedCardCount++,jo(t,Gv.Standard,0),xf(t.locationTracker),r.push(o)),n.items=r,s(n.items)?n:null}function Zo(e,t,n){var o,s,a
if(!Dn(e,PH))return null
if(t.adLocation!==t.parsedCardCount&&t.adPlacementBehavior!==Vv.replaceOrganic)return null
null===(o=t.pageInformation.iAdInfo)||void 0===o||o.updateContainerId(null===(s=t.pageInformation.iAdInfo)||void 0===s?void 0:s.containerIdForSlotIndex(null!==(a=t.parsedCardCount)&&void 0!==a?a:0))
const c=function(e,t,n,o,s){return Iv.context("createTodayAdCard",()=>{var a,c,l
if(r(t))return null
const u=Ro(e,t,o,s)
ns(e,t,o,s,f(t.attributes.name))
const d=Hf(e,t,f(t.attributes.name),{targetType:pG,pageInformation:s.pageInformation,locationTracker:s.locationTracker,isAdvert:!0,rowIndex:o.currentRowIndex,displayStyle:o.metricsDisplayStyle}),p=Qe(e,t)
d.productVariantData=p,d.adSlotOverride=s.parsedCardCount,d.kind=VR
const h=d
let w
d.pageInformation.iAdInfo.apply(e,t),i(o)&&(w=o.clientIdentifierOverride)
const g=(0,kv.isSome)(null)
switch(u.style=mH,xn(e)){case DL:null===(a=d.pageInformation.iAdInfo)||void 0===a||a.setTemplateType(MB)
break
case LV:g&&(null===(c=d.pageInformation.iAdInfo)||void 0===c||c.setTemplateType(In()))}let v=Lo(e,t,o,s)
if(r(v))return wo(e,n),os(s),Gf(e,u,d,null,null,!1,!1),null
switch(null===(l=v.searchAdOpportunity)||void 0===l||l.setTemplateType(MB),xn(e)){case DL:const n=new hK(v,v.icon)
u.media=new xJ(n),u.media.impressionMetrics=v.impressionMetrics
break
case LV:u.media=function(e,t,n,o,i,s,a){return e.media=function(e,t,n,r,o){var i,s
const a=t.screenshots[0],c=Pn(a)
null===(i=r.iAdInfo)||void 0===i||i.setTemplateType(c),null===(s=t.searchAdOpportunity)||void 0===s||s.setTemplateType(c)
const l=sd(e,o,{useCase:0,withJoeColorPlaceholder:!0,overrideTextColorKey:vM})
let u=l.backgroundColor,d=l.textColor
const f={type:hj,red:1,green:1,blue:1}
X(f,u)?(u=d,d=void 0):X(f,d)&&(d=void 0)
const p=new pK(t,[a],n,d,u,8)
return new _J(p)}(t,n,t.bag.todayAdMediumLockupScreenshotAnimationEnabled,a.pageInformation,o),r(n=Lo(t,o,i,s))?null:(n.searchAdOpportunity=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAdOpportunity,n.searchAd=e.media.mediumAdLockupWithScreenshotsBackground.lockup.searchAd,e.media.mediumAdLockupWithScreenshotsBackground.lockup=n,e.media.impressionMetrics=n.impressionMetrics,e.media)}(u,e,v,t,o,s,d)
break
default:return null}os(s)
const m=bn(t)
return u.clickAction=ju(e,t,h,w,void 0,m),function(e,t,n,o){let i=Bn(0,t);(r(i)||0===i.length)&&(i=e.random.nextUUID(),_n(e,`Error: instanceId was null or empty. Assigned ${i}`))
const s=Jd(e,t)?fN:ix,a=En(0,o.pageInformation),c=ie(t,sx),l=ae(t,VV)?Ej:LH,u=new yK(i,t.id,c,s,qT,l,a)
n.clickAction=On(0,n.clickAction,u)}(e,t,u,d),Gf(e,u,d,null,null,!1,!1),u})}(e,t.adData,t.adIncidentRecorder,n,t)
return(0,kv.isSome)(c)?c:null}function Qo(e,t){const n=hn(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderBadge)return null
let r
const o=wt(t.data)
if(le(o)&&(r=ie(o,sD)),(0,kv.isSome)(r))return r
switch(t.data.type){case OH:r=ie(t.data,sD)
break
case sG:r=ie(t.data,[rj,MN])}return r}function Xo(e,t,n=!1){const r=hn(0,t.data)
if((t.isFirstItemInModule||r.suppressHeaderName)&&!n)return null
let o
const i=wt(t.data)
if(le(i)&&(o=ie(i,iD)),(0,kv.isSome)(o))return o
switch(t.data.type){case OH:o=ie(t.data,iD)
break
case sG:o=ie(t.data,[rj,GH])}return o}function ei(e,t){const n=hn(0,t.data)
if(t.isFirstItemInModule||n.suppressHeaderTagline)return null
let r
const o=wt(t.data)
if(le(o)&&(r=ie(o,aD)),(0,kv.isSome)(r))return r
switch(t.data.type){case OH:r=ie(t.data,aD)
break
case sG:r=ie(t.data,[rj,oG])}return r}function ti(e,t,n){var r
const o=hn(0,t.data),i=ye(e,t.data,hL),s=null!==(r=o.headerArtworkBehavior)&&void 0!==r?r:lm.NoArtwork
switch(n){case dm.Eyebrow:return s===lm.CategoryArtworkWithBadge?ri(e,i):null
case dm.Title:switch(s){case lm.CategoryArtworkWithTitle:return ri(e,i)
case lm.ContentArtworkWithTitle:return sd(e,i,{useCase:1})
default:return null}default:return null}}function ni(e,t,n){const r=ye(e,t.data,hL),o=ie(t.data,[NU,"headerArtworkBehavior"])
switch(n){case dm.Eyebrow:return o===lm.CategoryArtworkWithBadge&&(0,kv.isSome)(ri(e,r))?jv.Category:null
case dm.Title:switch(o){case lm.CategoryArtworkWithTitle:return(0,kv.isSome)(ri(e,r))?jv.Category:null
case lm.ContentArtworkWithTitle:return(0,kv.isSome)(ri(e,r))?jv.Icon:null
default:return null}default:return null}}function ri(e,t){const n=Yn(e,t,!1,!1,!1)
return(0,kv.isNothing)(n)?null:nd(e,n,{useCase:20,allowingTransparency:!0,cropCode:"sr"})}function oi(e,t){const n=ne(t.data,vI,null),r=null==n?void 0:n[oj]
if((0,kv.isNothing)(r))return null
let o=null
if(r===fm.LinearGradient){const e=g(n).stops.map(e=>z(e.color)),t={type:"gradient",colors:e,start:Uv.Top,end:Uv.Bottom},r=K(e[0]),i={type:hj,red:60/255,green:60/255,blue:67/255,alpha:.6},s={type:hj,red:235/255,green:235/255,blue:245/255,alpha:.6}
o={shelfBackground:t,eyebrowColor:r?s:i,titleColor:Z(r?BV:Ck),subtitleColor:r?s:i}}else o=null
return o}function ii(e){var t,n
return(0,kv.isNothing)(e)?{}:null!==(n=Pf(null!==(t=h(e.moduleMetadata,bE))&&void 0!==t?t:{},e.moduleMetadata.onDevicePersonalizationProcessingType,null))&&void 0!==n?n:{}}function si(e,t,n,r=null,o=null){var i
const s=f(n,JX)
if((0,Cv.isNothing)(s))return null
const a=JSON.parse(s),c=QX.placementTypeFromPlacementId(e,f(a,nU)),l=new QX(e,c,QX.createInitialSlotInfos(e,c,r,o),null!==(i=f(a,oU))&&void 0!==i?i:void 0,void 0,void 0,r)
return l.applyClickFieldsFromPageRequest(null!=t?t:void 0,a),l}function ai(e,t,n,r){const o=Rf(r.locationTracker),i={impressionIndex:o,id:o.toString(),idType:YV,name:t.displayName,impressionType:n,parentId:ZP}
t.impressionMetrics=new RW(i)}function ci(e,t,n,r,o,s){var a,c,l
const u=null!==(a=g(r,sm.pageInformation,{}))&&void 0!==a?a:{},d=g(r,sm.timingValues),p=f(r,sm.requestedUrl)
let h
const w=u
if(w.pageType=t,w.pageId=n,o&&(w[uB]=o),t===uj){const t=j(e,r)
if((0,Cv.isSome)(t)){const n=ie(t,GH),r=ie(t,Cj)
w[uB]=`${r}_${n}`,Jd(e,t)&&(w[wF]=HV),h=Qe(e,t)}}else t===IO?w[uB]=`${t}_${n}`:t===VG?w[uB]=Ob:t===dB&&n===dB&&(w[uB]=`${t}_${n}`)
const v=new XX(null!==(c=yf(w))&&void 0!==c?c:{})
null!==d&&(v.timingMetrics=d,(0,Cv.isSome)(p)&&(v.pageUrl=p)),i(h)&&(v.productVariantData=h)
const m=null!=s?s:si(e,n,r)
return(0,Cv.isSome)(m)&&(v.iAdInfo=m),v.recoMetricsData=null!==(l=W(r))&&void 0!==l?l:void 0,v}function li(e,t,n,r,o){var i
const s=new XX({pageType:t,pageId:n,page:`${t}_${n}`,pageDetails:r})
if(o){const t=QX.placementTypeFromPlacementId(e,f(o,nU))
s.iAdInfo=new QX(e,t,QX.createInitialSlotInfos(e,t,null,null),null!==(i=f(o,oU))&&void 0!==i?i:void 0),s.iAdInfo.applyClickFieldsFromPageRequest(n,o)}return s}function ui(e,t,n,o,i){if(r(n))return
t.pageMetrics.pageFields=Ft(n),t.pageMetrics.addManyInstructions(Ai(e,n,o)),t.pageMetrics.addData(vi(e,n,o,i),[Fv.PageInvocationPoint.pageEnter]),t.pageMetrics.addData(function(e,t,n){const r=vi(e,t,n)
return r.fields[vG]=vb,r}(e,n,o),[Fv.PageInvocationPoint.pageExit]),t.pageMetrics.pageRenderFields=yi(e,n,o),t.pageRenderMetrics=yi(e,n,o),function(e){return!(e instanceof cZ||e instanceof oZ||e instanceof sZ)}(t)&&t.pageMetrics.addData(mi(e,n,o),[Fv.PageInvocationPoint.backButton])
const s=e.fetchTimingMetricsBuilder;(0,Cv.isSome)(s)&&s.decorate(t)}function di(e,t){return new XX({pageType:uV,pageId:t,page:`${uV}_${t}`})}function fi(e,t,n,r){const o={pageId:LM,pageType:VG}
r&&(o[e0]=r)
const i=new XX(o)
return i.pageUrl=n,i}function pi(e,t,n,r,i,a,c,l,u){const d=ci(e,VG,a,n)
return d.searchTermContext=r,d.pageUrl=i,u&&(d.guidedSearch=function(e,t,n){const r={}
if(s(t.guidedSearchTokens)&&(r.searchSelectedGuidedFacets=t.guidedSearchTokens),n&&n.finalTerm&&(r.searchGuidedFinalQuery=n.finalTerm),!o(r))return r}(0,t,u)),Rn(e)&&(0,Cv.isSome)(c)&&(d.iAdInfo=new QX(e,OG,QX.createInitialSlotInfos(e,OG,null,null),c.iAdId,c.appStoreClientRequestId,l)),d}function hi(e,t,n,r,o,s){let a="",c=""
switch(t){case om.AppEvent:a=`${n}_${r}`,c=O$
break
case om.ContingentOffer:case om.OfferItem:a=`${n}`,c="OfferDetails"}const l={pageId:a,pageType:c}
i(o)&&(l[$M]=o[SH],l[gN]=o[DF])
const u=new XX(l)
return u.recoMetricsData=null!=s?s:void 0,u}function wi(e,t){if(r(t)||r(t.pageMetrics))return
const n=t.pageMetrics.instructions
if(!r(n))for(const e of n)e.data.fields[vG]===jH&&e.data.includingFields.push(gx)
let o=null
if(t instanceof SK?o=t:t instanceof HK&&(o=t.lockup),o){const e=[]
if(o.buttonAction instanceof FW)e.push(o.buttonAction)
else if(o.buttonAction instanceof NW&&o.buttonAction.buyAction instanceof FW)e.push(o.buttonAction.buyAction)
else if(o.buttonAction instanceof BW&&o.buttonAction.completionAction instanceof FW)e.push(o.buttonAction.completionAction)
else if(o.buttonAction instanceof jW){if(o.buttonAction.buyAction instanceof FW&&e.push(o.buttonAction.buyAction),o.buttonAction.defaultAction instanceof FW&&e.push(o.buttonAction.defaultAction),o.buttonAction.openAction instanceof FW&&e.push(o.buttonAction.openAction),o.buttonAction.subscribePageAction instanceof dY&&o.buttonAction.subscribePageAction.page===kk&&(0,Cv.isSome)(o.buttonAction.subscribePageAction.pageUrl)&&o.buttonAction.subscribePageAction.pageUrl.length>0){const e=oY.from(o.buttonAction.subscribePageAction.pageUrl)
e.param(Hz.includePostSubscribeAttribution,FV),o.buttonAction.subscribePageAction.pageUrl=e.build()}o.buttonAction.subscribePageAction instanceof dY&&o.buttonAction.subscribePageAction.pageData instanceof KJ&&o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction instanceof FW&&e.push(o.buttonAction.subscribePageAction.pageData.purchaseSuccessAction)}for(const t of e)t.purchaseConfiguration&&(t.purchaseConfiguration.excludeAttribution=!1)}}function gi(e){Object.keys(e).filter(e=>!n0.has(e)).forEach(t=>delete e[t])}function vi(e,t,n,r){var o,s,a,c,l
const u=Ti(t,n)
t.iAdInfo&&Object.assign(u,t.iAdInfo.pageFields),i(t.offerReleaseDate)&&(u[iE]=ut(t.offerReleaseDate))
const d=t.searchTermContext
d&&(u[oV]=d.term,d.suggestedTerm&&(u.searchSuggestedTerm=d.suggestedTerm),d.correctedTerm&&(u.searchCorrectedTerm=d.correctedTerm),d.originatingTerm&&(u[cE]=d.originatingTerm)),t.guidedSearch&&Object.assign(u,t.guidedSearch)
const f=function(e,t,n,r,o,i){const s={}
Object.assign(s,o),s[vG]=jH,r&&(s[lb]=r.clientCorrelationKey,s.requestStartTime=r.requestStartTime,s.responseStartTime=r.responseStartTime,s.responseEndTime=r.responseEndTime)
const a=[sB,wx]
return a.push("userContentRestriction"),n&&a.push(ub),np(e,s),Kf(0,new CW(s,a,[],tp(e,s),ep(e,s,null,i)))}(e,0,null!==(o=t.isCrossfireReferralCandidate)&&void 0!==o&&o,t.timingMetrics,u,r),p=null!==(a=null===(s=t.iAdInfo)||void 0===s?void 0:s.iAdIsPresent)&&void 0!==a&&a,h=null!==(l=null===(c=t.iAdInfo)||void 0===c?void 0:c.shouldIncludeAdRotationFields)&&void 0!==l&&l
return p&&h&&f.includingFields.push(hF),f}function mi(e,t,n){return function(e,t){const n={}
return Object.assign(n,t),n[_N]=xN,Zf(e,xN,NH,n)}(e,Ti(t,n))}function yi(e,t,n){const r=Ti(t,n)
return t.searchTermContext&&(r[oV]=t.searchTermContext.term),t.baseFields&&Object.assign(r,t.baseFields),function(e,t,n){const r={}
return Object.assign(r,n),r[vG]="pageRender",t&&(r[wN]||(r[wN]=t.pageURL),r[lb]=t.clientCorrelationKey,r.platformRequestStartTime=t.requestStartTime,r.platformResponseStartTime=t.responseStartTime,r.platformResponseEndTime=t.responseEndTime,r.platformResponseWasCached=t.responseWasCached,r.platformJsonParseStartTime=t.parseStartTime,r.platformJsonParseEndTime=t.parseEndTime),np(e,r),r}(e,t.timingMetrics,r)}function Ai(e,t,n){var r,s,a
const c=Ti(t,n)
t.searchTermContext&&(c[oV]=t.searchTermContext.term)
const l=b(c)
t.iAdInfo&&Object.assign(l,t.iAdInfo.impressionsFields),t.guidedSearch&&Object.assign(l,t.guidedSearch)
const u=i(t.iAdInfo),d=o(null===(r=t.iAdInfo)||void 0===r?void 0:r.missedOpportunityReason)&&e.client.isPad,f=[{data:Xf(e,l,u&&d,null!==(a=null===(s=t.iAdInfo)||void 0===s?void 0:s.shouldIncludeAdRotationFields)&&void 0!==a&&a,!0),invocationPoints:[Fv.PageInvocationPoint.appExit,Fv.PageInvocationPoint.pageExit]}]
if(u){const n=function(e,t,n){var r,o
const s=i(n.iAdInfo)&&e.client.isPad&&((0,Cv.isNothing)(n.iAdInfo.missedOpportunityReason)||0===n.iAdInfo.missedOpportunityReason.length),a=null!==(o=null===(r=n.iAdInfo)||void 0===r?void 0:r.shouldIncludeAdRotationFields)&&void 0!==o&&o,c=[],l=Xf(e,t,s,a,!1).fields
if(l[fF]=WO,null!==n&&i(n.iAdInfo)){const e=n.iAdInfo.fastImpressionsEventVersion
l[pF]=e,c.push(pF),5===e&&(l.viewableArea="excludingTabBar",delete l[nU])}const u=["fastImpressions",sB,wx]
return s&&u.push(vx),a&&u.push(hF),Kf(0,new CW(l,u,c,tp(e,l),ep(e,l,n)))}(e,l,t)
f.push({data:n,invocationPoints:[Fv.PageInvocationPoint.appExit,Fv.PageInvocationPoint.pageExit,Fv.PageInvocationPoint.timer]})}return f}function Ti(e,t){const n={}
return i(e.offerType)&&(n[UM]=e.offerType),void 0!==t&&n&&t(n),n}function bi(e,t,n,r,o){let i
switch(t){case LN:i=UH
break
case xN:i=xN
break
case o_:i=DU}const s={targetType:NH,actionType:i,targetId:t,idType:void 0,location:If(e,{pageInformation:n,locationTracker:r,targetType:NH,id:t},null!=o?o:t)}
return Zf(e,t,NH,s)}function Si(e,t,n,r,o){let i
switch(t){case LN:i=UH
break
case xN:i=xN
break
case o_:i=DU}const s={targetType:NH,actionType:i,targetId:t,idType:void 0,location:If(e,{pageInformation:n,locationTracker:r,targetType:NH,id:t},null!=o?o:t)}
return Zf(e,t,NH,s)}function Pi(e,t,n){if((0,kv.isNothing)(t))return null
const r=t.match(/P(\d+)([A-Z]+)/)
if(!r||3!==r.length)return null
let o=p(r[1]),i=r[2]
return o&&i?("D"===i&&o>0&&o%7==0&&(i="W",o/=7),new r0(o,null!=n?n:1,i)):null}function Ii(e,t){const n=l(t,UO)[0]
if(!n)return null
const r=f(n,BB),o=p(n,UB),i=f(t,BB),s=p(t,UB)
if(!r||!i)return null
const a=f(n,Qb),c=Pi(0,r,o),u=Pi(0,i,s),d=f(n,_U).replace(/ /g,"\xa0"),h=f(t,_U).replace(/ /g,"\xa0")
let w=Ci(e,u.type,u.periodDuration,h)
switch(w=w.replace(/\//g,"\u2060/\u2060"),a){case Xb:const t=ki(e,c.type,c.periodDuration*c.periodCount)
if(t&&w)return e.loc.string("InAppOfferPage.Description.FreeTrialTemplate").replace(PE,t).replace(IE,w)
break
case eS:const n=ki(e,c.type,c.periodDuration*c.periodCount)
if(n&&w)return e.loc.string("InAppOfferPage.Description.PaidUpFrontTemplate").replace(PE,n).replace("@@trialPrice@@",d).replace(IE,w)
break
case tS:const r=Ci(e,c.type,c.periodDuration,d),o=ki(e,c.type,c.periodDuration*c.periodCount)
if(o&&w)return e.loc.string("InAppOfferPage.Description.PaidTrialTemplate").replace("@@trialPriceDuration@@",r).replace(PE,o).replace(IE,w)
break
default:return null}return null}function Ci(e,t,n,r){let o
switch(t){case"D":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Days.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Days",n)
break
case"W":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Weeks.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Weeks",n)
break
case"M":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Months.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Months",n)
break
case"Y":o=1===n?e.loc.string("InAppOfferPage.Description.PriceDuration.Years.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.PriceDuration.Years",n)}return o.replace("@@price@@",r)}function ki(e,t,n){switch(t){case"D":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Days.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Days",n)
case"W":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Weeks.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Weeks",n)
case"M":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Months.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Months",n)
case"Y":return 1===n?e.loc.string("InAppOfferPage.Description.DurationCount.Years.one").replace(GB,e.loc.formattedCount(n)):e.loc.stringWithCount("InAppOfferPage.Description.DurationCount.Years",n)}return null}function Oi(e,t){var n,r,i
const s=ye(e,t,$N)
if((0,Cv.isNothing)(s))return
const a=jt(e,s),c=h(s,S$)
if(o(a)||o(c))return
const l=null===(n=Ei(e,f(a,BB),p(a,UB),f(a,_U)))||void 0===n?void 0:n.replace("/","/\u2060"),u=null===(r=Ei(e,f(c,BB),p(c,UB),f(c,_U)))||void 0===r?void 0:r.replace("/","/\u2060")
if(o(l)||o(u))return null
const d=ie(t,GH),w={"@@discountedPrice@@/@@recurringSubscriptionPeriod@@":u,"@@regularPrice@@/@@recurringSubscriptionPeriod@@":l,"@@discountedPricePerRecurringSubscriptionPeriod@@":u,"@@regularPricePerRecurringSubscriptionPeriod@@":l}
let g=null!=d?d:""
Object.keys(w).forEach(e=>{g=g.replace(e,w[e])})
const v=g.replace(/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>/g,""),m=new _q(g,QG,vy),y=null!==(i=ie(t,fU))&&void 0!==i?i:"",A=e.loc.string("ContingentOffer.Description.Format"),T={"@@BranchName@@":ie(s,GH),"@@RegularPrice@@":l,"@@DiscountedPrice@@":u}
let b=A
return Object.keys(T).forEach(e=>{b=b.replace(e,T[e])}),{title:m,rawTitle:v,description:[b,y].join(" ")}}function Ei(e,t,n,r){const o=Pi(0,t,n)
if(!(0,Cv.isNothing)(o)&&!(0,Cv.isNothing)(r))return Ci(e,o.type,o.periodDuration,r)}function Ri(e,t,n,r){const o=Pi(0,t,n)
return(0,Cv.isNothing)(o)||(0,Cv.isNothing)(r)?null:Ci(e,null==o?void 0:o.type,null==o?void 0:o.periodDuration,r)}function Di(e){switch(e.type){case DH:return om.AppEvent
case ZG:return om.ContingentOffer
case Aj:return om.OfferItem
default:return null}}function _i(e){switch(e.type){case DH:return qL
case ZG:case Aj:return ck
default:return null}}function xi(e){switch(e.type){case DH:return wy
case ZG:return"contingentPriceOffer"
case Aj:return"winbackPriceOffer"
default:return null}}function Li(e,t,n,s,a,c,l,u,d,w,v,m,y,A){const T=Di(t),b={...d,targetType:_i(t)}
switch(T){case om.AppEvent:return zi(e,t,n,s,a,c,l,u,b,w,v,m,y,A)
case om.ContingentOffer:return function(e,t,n,s,a,c,l,u){var d,f,p
if(t.type!==ZG)return null
const w=Ui(e,t,GL)
if(r(w))return null
const v=K(w.backgroundColor)?mH:UV,m=ie(t,MN),y=ie(t,lV),A=ie(t,CV),T=e.loc.string("ContingentOffer.AdditionalInfoButton.Title")
if((0,Cv.isNothing)(m)||(0,Cv.isNothing)(A))return null
const b=ye(e,t,$N)
if((0,Cv.isNothing)(b)||o(h(b,S$)))return null
const S=Oi(e,t)
if((0,Cv.isNothing)(S)||(0,Cv.isNothing)(null==S?void 0:S.title))return null
const P=ye(e,t,YL),I=ae(P,E$),C=ji(e,t,P,"",s,a,!1,c,l,null,u,!0)
if((0,Cv.isNothing)(C))return null
const k=ye(e,t,uk)
let O;(0,Cv.isSome)(k)&&(0,Cv.isSome)(y)&&(null==y?void 0:y.length)>0&&(O=null!==(d=Ui(e,k,_H))&&void 0!==d?d:Bi(e,k,_H)),(0,Cv.isSome)(y)&&(null==y?void 0:y.length)>0&&(O=null!==(f=function(e,t){var n,r
const o=g(t,"meta.associations.trunks")
if((0,Cv.isNothing)(o))return null
const i=o.data[0]
if(null!==(r=null===(n=null==i?void 0:i.meta)||void 0===n?void 0:n[dk])&&void 0!==r&&r){const t=Be(e,i,fk)
return(0,Cv.isNothing)(t)?null:nd(e,t,{useCase:1,style:VF})}return null}(e,t))&&void 0!==f?f:O)
const E=function(e,t,n){const r=JL+ie(n,GH)+KL,o=ie(n,fU)+ZL,i=JL+e.loc.string("ContingentOffer.Terms.Title")+KL,s=ie(t,R$)
return new _q([r,o,i,s].join(ZL),QG)}(e,t,b),R=new nZ(w,v,I,T,S.title,null!=y?y:void 0,null!==(p=S.description)&&void 0!==p?p:void 0,A,m,E,null!=O?O:void 0,C)
return R.title=S.rawTitle,i(P)&&(R.clickAction=Hi(e,t,P,R,c,l)),R}(e,t,0,c,l,b,v,y)
case om.OfferItem:return function(e,t,n,s,a,c,l,u){var d,w,g,v,m,y
if(t.type!==Aj)return null
const A=ie(t,rV)
if("resubscription"!==A&&A!==QL)return null
const T=UV,b=ye(e,t,FN)
if((0,Cv.isNothing)(b))return null
const S=h(b,GD),P=jt(e,b)
if((0,Cv.isNothing)(S))return null
const I=null!==(d=null!=n?n:ye(e,t,SH))&&void 0!==d?d:ye(e,b,SH),C=ae(I,E$),k=ie(t,i_)
if((0,Cv.isNothing)(k)||!function(e){if((0,Cv.isNothing)(e)||o(e))return!1
const t=new Date(e)
if(r(t))return!1
const n=new Date
return!(t.getTime()<=n.getTime())}(k))return null
const O=new Date(k)
let E=function(e,t){if((0,Cv.isNothing)(t))return null
const n=dt(t),o=new Date,i=(a=n,r(s=o)||r(a)?null:Math.floor((a.getTime()-s.getTime())/864e5))
var s,a
if((0,Cv.isNothing)(i))return null
const c=function(e,t){var n,r
return(null===(n=dt(e))||void 0===n?void 0:n.getTime())===(null===(r=dt(t))||void 0===r?void 0:r.getTime())}(o,t)
if(i>90)return e.loc.string(yy)
if(i>5){const n=o.getFullYear()!==t.getFullYear()?e.loc.string("OfferItems.FormattedDate.NextYear.DateFormat"):e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.DateFormat"),r=e.loc.uppercased(e.loc.formatDate(n,t))
return(0,Cv.isNothing)(r)?null:e.loc.string("OfferItems.FormattedDate.FiveDaysOrMore.Title").replace(Ay,r)}return i>1?e.loc.string("OfferItems.FormattedDate.FiveDaysOrLess.Title").replace(GB,e.loc.formattedCount(i)):1!==i||c?e.loc.string("OfferItems.FormattedDate.Today.Title"):e.loc.string("OfferItems.FormattedDate.Tomorrow.Title")}(e,O);(0,Cv.isNothing)(E)&&(E=e.loc.string(yy))
let R=sd(e,b,{useCase:3,withJoeColorPlaceholder:!0,overrideTextColorKey:UF})
o(R)&&(R=Se(e,pk,200,200,{type:hj,red:0,green:0,blue:0,alpha:1}),R.style=_B)
const D=Pi(0,f(S,BB),p(S,UB)),_=(0,Cv.isSome)(D)?ki(e,D.type,D.periodDuration*D.periodCount):void 0,x=null===(w=Ri(e,f(P,BB),p(P,UB),f(P,_U)))||void 0===w?void 0:w.replace("/","/\u2060"),L=null===(g=Ri(e,f(S,BB),p(S,UB),f(S,_U)))||void 0===g?void 0:g.replace("/","/\u2060"),M=e.loc.string(my),$={"@@redemptionDate@@":e.loc.formatDate(M,O),"@@skuName@@":null!==(v=ie(b,GH))&&void 0!==v?v:"@@skuName@@","@@discountedPrice@@":null!=L?L:"@@discountedPrice@@","@@regularPricePerDuration@@":null!=x?x:"@@regularPricePerDuration@@","@@discountDuration@@":null!=_?_:"@@discountDuration@@","@@payUpfrontPrice@@":null!==(m=f(S,_U))&&void 0!==m?m:"@@payUpfrontPrice@@"},F=ie(t,MN)
if((0,Cv.isNothing)(F))return null
const N=Wi(ie(t,hH),$),B=new _q(N,QG,vy),U=Wi(ie(t,lV),$),G=Wi(null!==(y=ie(t,s_))&&void 0!==y?y:"",$)
let j
if(i(I)&&(j=ji(e,t,I,"",s,a,!1,c,l,null,u,!0)),(0,Cv.isNothing)(j))return null
const V=new iZ(null,null,T,C,B,E,U,G,F,O,R,j)
return V.title=N,i(I)&&(V.clickAction=Hi(e,t,I,V,c,l)),V}(e,t,n,c,l,b,v,y)
default:return null}}function Mi(e,t,n,o,a,c,l,u){const d=Di(t),f={...a,targetType:_i(t)}
switch(d){case om.AppEvent:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const p=Bi(e,t,NB),h=Gi(e,t,NF,!0,!0),w=b(o),g=null!==(d=null==h?void 0:h.preview)&&void 0!==d?d:p
let v=mH,m=!0,y=!1
i(g)&&(m=K(g.backgroundColor),y=K(g.backgroundColor,10),v=m?mH:UV)
const A=hi(0,om.AppEvent,t.id,n.id,l,null!==(f=a.recoMetricsData)&&void 0!==f?f:null),T={...a,pageInformation:A,locationTracker:{rootPosition:0,locationStack:[]},targetType:O$},S={...T,id:n.id,inAppEventId:t.id,relatedSubjectIds:[n.id]}
w.notificationConfig=Vi(e,t,o,S,!1)
const P=function(e,t,n,r){var o,s
const a=ie(t,AH)
if((0,kv.isNothing)(a)||0===a.length)return null
const c=null!==(o=n.moduleArtwork)&&void 0!==o?o:null===(s=n.moduleVideo)||void 0===s?void 0:s.preview
let l=e.loc.string(py)
l===py&&(l=n.subtitle)
const u=function(e,t,n,r,o,i){return Iv.context("shareSheetDataForAppEvent",()=>{const e=new Cq(t,n,i)
return new Eq(e,r,void 0)})}(0,n.title,l,a,0,c)
if(!i(u))return null
const d=function(e,t,n){var r
const o=[]
if((null==n?void 0:n.length)>0){const t=As(e,n)
i&&o.push(t)}if(t.startDate.getTime()<=Date.now())return o
if(e.host.clientIdentifier===tW)return o
const s=new tz(sH)
s.title=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_TITLE"),s.message=e.loc.string("APP_EVENTS_CALENDAR_NOT_AUTHORIZED_DETAIL"),s.isCancelable=!0,s.buttonTitles=[e.loc.string(ey)],s.buttonActions=[new MW("prefs:root=Privacy&path=CALENDARS",!0)]
let a=!1
if(i(t.endDate)){const e=dt(t.startDate),n=dt(t.endDate),r=t.endDate.getTime()-t.startDate.getTime(),o=216e5
n.getTime()>e.getTime()&&r>o&&(a=!0)
const i=8634e4
e.getTime()===n.getTime()&&r>=i&&(a=!0)}const c=new bz(t.startDate,t.endDate,a,t.title,null===(r=t.lockup)||void 0===r?void 0:r.title,t.detail,n,s,KC)
c.title=e.loc.string("SHARE_SHEET_ADD_TO_CALENDAR"),c.artwork=Se(e,"systemimage://calendar.circle")
const l=new nz("com.apple.AppStore.createCalendarEventActivity",c)
return o.unshift(l),o}(e,n,a),f=new rz(u,d)
return sp(e,f,{...r,targetType:cH,actionType:LF,idType:ZV}),f}(e,t,o,S),I=m?mH:UV,C=ji(e,t,n,w.title,I,QU,!1,T,c,l,!1,!1)
if(r(C))return null
w.lockup=C
const k=new eZ(w,p,h,P,v,y)
return ui(e,k,A,e=>{s(l)&&SW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),k}(e,t,n,o,a,l,u),f=new dY("appEventDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case om.ContingentOffer:return function(e,t,n,o,a,c,l,u){const d=function(e,t,n,o,a,c,l,u){var d,f
const p=Ui(e,t,NB),h=b(o)
let w=mH,g=!0
i(p)&&(g=K(p.backgroundColor),w=g?mH:UV)
const v=hi(0,om.ContingentOffer,t.id,n.id,l,null!==(d=a.recoMetricsData)&&void 0!==d?d:null),m={...a,pageInformation:v,locationTracker:{rootPosition:0,locationStack:[]}},y=g?mH:UV,A=ji(e,t,n,null!==(f=h.title)&&void 0!==f?f:void 0,y,QU,!1,m,c,l,!1,!1)
if(r(A))return null
h.offerLockup=A,h.trunkAppIcon=o.trunkAppIcon
const T=new oZ(h,null!=p?p:void 0,w)
return T.backButtonActionMetrics.addMetricsData(bi(e,xN,v,m.locationTracker)),T.learnMoreActionMetrics.addMetricsData(bi(e,LN,v,m.locationTracker,o.learnMoreTitle)),T.closeButtonActionMetrics.addMetricsData(bi(e,o_,v,m.locationTracker)),ui(e,T,v,e=>{s(l)&&SW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),T}(e,t,n,o,a,l,u),f=new dY("contingentOfferDetail")
return f.title=o.title,f.pageData=d,f.animationBehavior=c,a&&a.pageInformation&&(f.referrerUrl=a.pageInformation.pageUrl),f}(e,t,n,o,f,c,l,u)
case om.OfferItem:return function(e,t,n,o,i,a,c,l){const u=function(e,t,n,o,i,a,c,l){var u,d
let f=Ui(e,t,NB)
f=null
const p=mH,h=b(o),w=hi(0,om.OfferItem,t.id,n.id,c,null!==(u=i.recoMetricsData)&&void 0!==u?u:null),g={...i,pageInformation:w,locationTracker:{rootPosition:0,locationStack:[]}},v=mH,m=ji(e,t,n,null!==(d=h.title)&&void 0!==d?d:void 0,v,QU,!1,g,a,c,!1,!1)
if(r(m))return null
h.offerLockup=m
const y=e.loc.string("Winback.AdditionalInfoButton.Title"),A=ye(e,t,FN),T=ie(t,i_)
let S;(0,Cv.isSome)(T)&&(0,Cv.isSome)(A)&&(S=function(e,t,n,r){if((0,Cv.isNothing)(n))return
const o=ie(n,GH),i=(0,Cv.isSome)(o)?JL+o+KL:void 0,s=ie(n,fU),a=(0,Cv.isSome)(s)?s+ZL:void 0,c=JL+e.loc.string("Promotion.Terms.Title")+KL
let l
const u=e.loc.string(my)
if((0,Cv.isSome)(o)&&(0,Cv.isSome)(r)){const n={"@@redemptionDate@@":e.loc.formatDate(u,r),"@@skuName@@":o}
l=Wi(ie(t,R$),n)}const d=[i,a,c,l].filter(Cv.isSome).join(ZL)
return new _q(d,QG)}(e,t,A,new Date(T)))
const P=new sZ(h,void 0,void 0,p,!1,y,S)
return P.backButtonActionMetrics.addMetricsData(Si(e,xN,w,g.locationTracker)),P.learnMoreActionMetrics.addMetricsData(Si(e,LN,w,g.locationTracker,y)),P.closeButtonActionMetrics.addMetricsData(Si(e,o_,w,g.locationTracker)),ui(e,P,w,e=>{s(c)&&SW.shared.addReferralContextToMetricsFieldsIfNecessary(e)}),P}(e,t,n,o,i,c,l),d=new dY("offerItemDetail")
return d.title=o.title,d.pageData=u,d.animationBehavior=a,i&&i.pageInformation&&(d.referrerUrl=i.pageInformation.pageUrl),d}(e,t,n,o,f,c,l,u)
default:return null}}function $i(e){return e.bag.enableAppEvents&&!0}function Fi(e){return e.bag.enableContingentOffers&&!0}function Ni(e){return e.bag.enableOfferItems&&!0}function Bi(e,t,n){const r=ne(t,n)
return(0,kv.isNothing)(r)?null:nd(e,r,{useCase:0,withJoeColorPlaceholder:!0,cropCode:"sr"})}function Ui(e,t,n){const r=qe(e,t)
if((0,kv.isNothing)(r))return null
const o=Re(t,r,n)
return(0,kv.isNothing)(o)?null:nd(e,o,{useCase:0,withJoeColorPlaceholder:!0,cropCode:"sr"})}function Gi(e,t,n,o,i){const s=Bi(e,t,`${n}.previewFrame`)
if(r(s))return null
const a=ie(t,`${n}.video`)
if(r(a))return null
const c=new Vq(a,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:o,playbackControls:i?{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}:{},autoPlayPlaybackControls:i?{muteUnmute:!0}:{}})
return c.canPlayFullScreen=o,c.allowsAutoPlay=!0,c.looping=!0,c}function ji(e,t,n,i,s,a,c,l,u,d,f,p){var h,w,g,v
if((0,kv.isNothing)(t)||(0,kv.isNothing)(n))return null
const m=Di(t),y={...l,id:t.id,relatedSubjectIds:[n.id],idType:ZV},A={...l,id:n.id,relatedSubjectIds:[n.id],targetType:cH,idType:ZV,kind:null,softwareType:null,title:null!==(h=ie(n,GH))&&void 0!==h?h:"",excludeAttribution:o(d)}
if(m===om.AppEvent&&(y[WL]=t.id,A[WL]=t.id),(v=l)&&Object.prototype.hasOwnProperty.call(v,"id")&&(y.id=l.id,y.idType=l.idType),p){const n=m===om.ContingentOffer?null===(w=Oi(e,t))||void 0===w?void 0:w.rawTitle:ie(t,GH)
kf(e,y,null!=n?n:"")}const T=ie(t,t_),b={metricsOptions:A,artworkUseCase:1,externalDeepLinkUrl:null!=T?T:void 0,crossLinkSubtitle:c?i:void 0,offerEnvironment:s,offerStyle:a,skipDefaultClickAction:!u,includeBetaApps:!0,referrerData:null!=d?d:void 0,shouldHideArcadeHeader:e.featureFlags.isEnabled(BF)&&f,parentAppData:n,useJoeColorIconPlaceholder:!0,overrideArtworkTextColorKey:UF},S=Du(e,m===om.AppEvent?n:t,b)
return p&&Ef(l.locationTracker),r(S)?null:(c&&(S.crossLinkTitle=null!==(g=e.loc.uppercased(S.title))&&void 0!==g?g:void 0),S)}function Vi(e,t,n,r,o){if(n.startDate.getTime()<=Date.now())return null
if((0,kv.isNothing)(n.lockup))return null
const i=e.loc.string("APP_EVENTS_NOTIFICATION_TITLE").replace("{appTitle}",n.lockup.title),s=e.loc.string("APP_EVENTS_NOTIFICATION_DETAIL").replace("{eventTitle}",n.title),a=n.startDate,c=n.lockup.icon,l=n.lockup.icon.template.replace("{w}",`${c.width}`).replace("{h}",`${c.height}`).replace("{c}","wd").replace("{f}",n_)
let u,d
if(o&&(u=new tz(GF),u.title=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_TITLE"),u.message=e.loc.string("APP_EVENTS_NOTIFICATION_TOAST_DETAIL"),u.artwork=Se(e,gy)),e.bag.newEventsForODJAreEnabled){const o=new lz,i=Ft(r.pageInformation)
i[_N]="notifyActivateNotificationsDisabled",i[jF]=If(e,{...r,id:t.id},""),i[zL]=""
const s=Zf(e,n.lockup.adamId,cH,i)
o.actionMetrics.addMetricsData(s),d=o}else{const t=new tz(sH)
t.title=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_TITLE"),t.message=e.loc.string("APP_EVENTS_NOTIFICATION_NOT_AUTHORIZED_DETAIL"),t.isCancelable=!0,t.buttonTitles=[e.loc.string(ey)],t.buttonActions=[new MW("prefs:root=NOTIFICATIONS_ID&path=com.apple.AppStore",!0)],d=t}const f=new tz(sH)
f.title=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_TITLE"),f.message=e.loc.string("APP_EVENTS_NOTIFICATION_FAILURE_DETAIL"),f.isCancelable=!0
const p=(new oY).set(hG,Dz).param(Hz.appId,n.lockup.adamId).param(Hz.bundleId,n.lockup.bundleId).param(Hz.appEventId,n.appEventId)
p.host=Uz
const h=ie(t,t_);(0,kv.isSome)(h)&&(null==h?void 0:h.length)>0&&p.param(Hz.appEventDeepLink,encodeURIComponent(h))
const w=Ft(r.pageInformation)
w[_N]="notifyActivate",w[jF]=If(e,{...r,id:t.id},"")
const g=Zf(e,n.lockup.adamId,cH,w),v=b(w)
v[_N]="notifyDeactivate"
const m=Zf(e,n.lockup.adamId,cH,v)
return new tZ(t.id,i,s,l,a,u,d,f,p.build(),g,m)}function Hi(e,t,n,r,o,i){const s=Mi(e,t,n,r,o,pV,i,null)
if((0,kv.isNothing)(s))return
const a={id:t.id,actionDetails:{action:"Open",contentType:_i(t)},relatedSubjectIds:[n.id],...o}
return Di(t)===om.AppEvent&&(a[WL]=t.id),sp(e,s,a),s}function qi(e,t,n=null,o,s,a,c,l,u,d){var f
const p=[]
let h
for(const w of t){const t=Li(e,w,n,o,!0,UV,pV,s,a,c,l,null,u,d)
if(r(t))continue
if(t instanceof Date){((0,kv.isNothing)(h)||t.getTime()<h.getTime())&&(h=t)
continue}const g=t,v={...a,id:w.id,kind:xi(w),targetType:_i(w),title:null!==(f=g.title)&&void 0!==f?f:"",softwareType:null},m=null!=n?n:ye(e,w,SH)
i(m)&&(v.relatedSubjectIds=[m.id]),Bf(e,g,v),xf(v.locationTracker),p.push(g)}return{appPromotions:p,nextAppEventPromotionStartDate:h}}function Wi(e,t){let n=null!=e?e:""
return Object.keys(t).forEach(e=>{n=n.replace(e,t[e])}),n}function zi(e,t,n,r,a,c,l,u,d,f,p,h,w,g){var v,m,y
if(t.type!==DH)return null
const A=ie(t,"promotionStartDate")
if((0,kv.isNothing)(A)||0===A.length)return null
const T=new Date(A)
if((0,kv.isNothing)(T))return null
const b=new Date
if(T.getTime()>b.getTime()&&!g)return T
const S=Bi(e,t,GL),P=Gi(e,t,"lockupVideo",!1,!1)
if((0,kv.isNothing)(S)&&o(P))return null
const I=null!==(v=null==P?void 0:P.preview)&&void 0!==v?v:S,C=K(null==I?void 0:I.backgroundColor)?mH:UV,k=K(null==I?void 0:I.backgroundColor,10),O=ie(t,GH)
let E=ie(t,rV)
s(h)&&(E=h)
const R=ie(t,jL)
if((0,kv.isNothing)(O)||0===O.length||(0,kv.isNothing)(E)||0===E.length||(0,kv.isNothing)(R)||0===R.length)return null
const D=new Date(R)
if((0,kv.isNothing)(D))return null
const _=null!==(m=ie(t,fU))&&void 0!==m?m:"",x=null!=n?n:ye(e,t,SH)
let L=null
if((0,kv.isSome)(x)&&(L=ji(e,t,x,O,c,l,u,d,p,null,w,!0)),(0,kv.isNothing)(L))return e.console.warn(`Parent app for event ${t.id} is missing, returning null.`),null
const M=ie(t,"requirement"),$=ie(t,lV),F=ie(t,VL)
let N
if((0,kv.isSome)(F)&&F.length>0&&(N=new Date(F)),void 0!==N&&N.getTime()<=b.getTime()&&!f)return null
const B=Ji(e,Yi(null!==(y=ie(t,HL))&&void 0!==y?y:void 0,D,N),D,N),U=new XK(t.id,null!=S?S:void 0,null!=P?P:void 0,O,null!=$?$:void 0,_,D,N,E,null!=M?M:void 0,L,r,B,C,k)
if(i(x)){const n={...d,id:x.id,inAppEventId:t.id,relatedSubjectIds:[x.id]}
U.notificationConfig=Vi(e,t,U,n,!0)}return a&&i(x)&&(U.clickAction=Hi(e,t,x,U,d,p)),U}function Yi(e,t,n){let r=null!=e?e:"live"
return"live"===r&&i(n)&&n.getTime()-t.getTime()>216e5&&(r="happening"),r}function Ji(e,t,n,r){const o=[],i=dt(n)
if((0,kv.isNothing)(i))return[]
const s=e.loc.string("AppEvents.FormattedDate.SevenDaysOrMore.DateFormat"),a=e.loc.uppercased(e.loc.formatDate(s,n)),c=new ZK(!1,void 0,null!=a?a:void 0,void 0,void 0)
o.push(c)
const l=new Date(i)
l.setDate(l.getDate()-6)
const u=e.loc.string("AppEvents.FormattedDate.SixDaysOrLess.DateFormat"),d=e.loc.formatDate(u,n),f=e.loc.uppercased(d),p=new ZK(!1,l,null!=f?f:void 0,void 0,void 0)
o.push(p)
const h=new Date(i)
h.setDate(h.getDate()-1)
const w=e.loc.string("AppEvents.FormattedDate.Tomorrow"),g=e.loc.formatDateInSentence(w,hy,n),v=e.loc.uppercased(g),m=new ZK(!1,h,null!=v?v:void 0,void 0,void 0)
if(o.push(m),n.getHours()>1||1===n.getHours()&&n.getMinutes()>0){let t
t=n.getHours()>=19?e.loc.string("AppEvents.FormattedDate.Tonight"):e.loc.string("AppEvents.FormattedDate.Today")
const r=e.loc.formatDateInSentence(t,hy,n),s=e.loc.uppercased(r),a=new ZK(!1,null!=i?i:void 0,null!=s?s:void 0,void 0,void 0)
o.push(a)}const y=new Date(n)
let A
y.setHours(y.getHours()-1),A="available"===t?"AppEvents.FormattedDate.AvailableIn.MinutesCountdown":"AppEvents.FormattedDate.StartsIn.MinutesCountdown"
const T=new ZK(!1,y,void 0,n,A)
let b,S
switch(o.push(T),t){case"available":b=e.loc.string("AppEvents.FormattedDate.NowAvailable"),S=!1
break
case"happening":b=e.loc.string("AppEvents.FormattedDate.HappeningNow"),S=!1
break
default:b=e.loc.string("AppEvents.FormattedDate.Live"),S=!0}const P=new ZK(S,n,b,void 0,void 0)
if(o.push(P),null!==r){const t=new ZK(!1,r,e.loc.string("AppEvents.FormattedDate.EventEnded"),void 0,void 0)
o.push(t)}return o}function Ki(e,t,n,r,o){const i=hn(0,r)
if((0,kv.isSome)(i.suppressLockup)&&i.suppressLockup)return null
let s=null
const a=(0,kv.isSome)(o)&&1===o.length,c=(0,kv.isSome)(o)&&o.length>1
return a?s=new MJ(o[0]):c&&(s=new FJ(o)),s}function Zi(e,t,n,r,o,i,s){if(!ae(o,eD))return
let a=mp(e,o);(0,Cv.isNothing)(a)&&(0,kv.isSome)(i)&&(a=yp(0,i.arcadeUpsellEditorialResponse))
const c=function(e,t,n,r,o,i,s){if(!function(e){const t=e.host.platform
return t===fj||t===yj}(e))return null
Qi(e,t,n,r)
const a=ws(),c=Bu(e,i,s,pe(zU),a,pG)
return new GJ(c)}(e,o,t,n,0,a,s)
if(c){t.overlay=c,t.impressionMetrics.fields[Db]=!0
const r=Qi(e,o,t,n)
t.style!==r&&(t.style=r)}}function Qi(e,t,n,r){const o=!r.enableListCardToMultiAppFallback,i=Oo(e,t,r),s=ps(null==i?void 0:i.joeColors)
return o?n.style:s}function Xi(e,t,n,r,o){return Iv.context("createTodaySingleAppCard",()=>{const s=Ro(e,t,n,r)
ns(e,t,n,r)
const a=xo(e,t,s,n,r),c=as(0,t),l=ss(e,c,n,r.pageInformation,r.locationTracker,pG,null,It(0,t)),u=Ki(0,0,0,t,l)
return i(u)&&u instanceof NJ&&(u.style=BV),s.overlay=u,a||1!==c.length||es(e,t,s,c,n,r)?(Zi(e,s,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),s):(os(r),null)})}function es(e,t,n,r,o,i){if(1!==r.length)return!1
o.useJoeColorIconPlaceholder=!0,n.style=mH
const s=ws(0,n.style),a=ss(e,r,o,i.pageInformation,i.locationTracker,gs(n.style),s,It(0,t))
if(1!==a.length)return!1
const c=a[0]
return n.media=new SJ(c.icon),!0}function ts(e,t,n,a,c){return Iv.catchingContext("todayCardFromData",()=>{const l=is(t,n.coercedCollectionTodayCardDisplayStyle),d=yn(e,t);(0,kv.isSome)(d)&&(function(e,t,n,r){var o
if("com.apple.visionproapp"===n||"VisionAppStore"===n)return!0
const i=as(0,t),s=is(t,r.coercedCollectionTodayCardDisplayStyle)
if(!new Set([am.AppEventCard,am.Grid,am.InAppPurchase,am.List,am.NumberedList,am.River,am.ShortImage,am.SingleApp]).has(s))return!1
if(i.length>=6&&s===am.Grid)return!1
const a=ls(0,s)
return!(!ae(t,oD)&&us(e,ne(t,a),null===(o=r.prevailingCropCodes)||void 0===o?void 0:o.defaultCrop)||function(e,t){if(1===t.length){const e=t[0]
if(e.type===kV)return e}return null}(0,i))}(e,t,d,n)?n.clientIdentifierOverride=d:n.clientIdentifierOverride=null),n.crossLinkSubtitle=ms(e,t)
let f=null
switch(l){case am.AppOfTheDay:case am.GameOfTheDay:f=function(e,t,n,r,i){return Iv.context("createTodayBrandedCard",()=>{const s=Ro(e,t,n,r)
ns(e,t,n,r)
const a=Oo(e,t,n)
if(!((0,Cv.isSome)(a)&&(0,Cv.isSome)(a.joeColors.bgColor)&&(a.artworks.length>0||a.videos.length>0)))return os(r),Xi(e,t,n,r)
s.style=ps(null==a?void 0:a.joeColors,LU)
const c=ws(0,s.style),l=as(0,t),u=ss(e,l,n,r.pageInformation,r.locationTracker,gs(s.style),c,It(0,t),!0)
if(o(u)||1!==u.length)return os(r),null
n.isHorizontalShelfContext||(s.overlay=Ki(0,0,0,t,u))
const d=u[0]
return s.media=new PJ(d.icon,a.artworks,a.videos,a.artworkLayoutsWithMetrics,ds(0,t,n)),s.media.impressionMetrics=d.impressionMetrics,Zi(e,s,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),os(r),s})}(e,t,n,a,c)
break
case am.Video:f=function(e,t,n,r,o){return Iv.context("createTodayVideoCard",()=>{const i=Ro(e,t,n,r)
xo(e,t,i,n,r),ns(e,t,n,r)
const s=ws(0,i.style),a=as(0,t),c=ss(e,a,n,r.pageInformation,r.locationTracker,pG,s,It(0,t)),l=Ki(0,0,0,t,c)
return i.overlay=l,Zi(e,i,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),i})}(e,t,n,a,c)
break
case am.FullBleedImage:f=function(e,t,n,r,o){return Iv.context("createTodayFullBleedImageCard",()=>{const i=Ro(e,t,n,r)
if(ns(e,t,n,r),!xo(e,t,i,n,r))return os(r),null
const s=as(0,t),a=ws(0,i.style),c=ss(e,s,n,r.pageInformation,r.locationTracker,gs(i.style),a,It(0,t)),l=Ki(0,0,0,t,c)
return i.overlay=l,Zi(e,i,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),i})}(e,t,n,a,c)
break
case am.InAppPurchase:f=function(e,t,n,r,i){return Iv.context("createTodayInAppPurchaseCard",()=>{const s=Ro(e,t,n,r)
ns(e,t,n,r)
const a=function(e,t){if(1===t.length){const e=t[0]
if(e.type===kV)return e}return null}(0,as(0,t))
if(o(a))return os(r),null
const c=_u(e,a,{offerStyle:rG,metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker},artworkUseCase:1})
return o(c)?(os(r),null):(c.theme=pV,s.media=new kJ(c),s.media.impressionMetrics=c.impressionMetrics,s.media.impressionMetrics.fields[fx]=s.impressionMetrics.fields.id,s.style=BV,Zi(e,s,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,i,r),os(r),s)})}(e,t,n,a,c)
break
case am.AppEventCard:f=function(e,t,n,r,o){return Iv.context("createTodayAppEventCard",()=>{var i,s,a,c,l
if(!$i(e))return null
const d=function(e,t){let n
const r=Ae(t,Yj)
if(r.length>0)n=r[0]
else{const e=Ae(t,sV)
if(0===e.length)return null
n=e[0]}return n}(0,t)
if((0,Cv.isNothing)(d))return null
const f=Ro(e,t,n,r,t=>{t.inAppEventId=d.id
const n=ye(e,d,SH);(0,kv.isSome)(n)&&(t.relatedSubjectIds=[n.id])});(0,kv.isSome)(f.editorialDisplayOptions)&&(f.editorialDisplayOptions.useMaterialBlur=!0),ns(e,t,n,r)
const p=Oo(e,t,n)
if((0,Cv.isNothing)(p))return os(r),null
const h=null!==(s=null===(i=p.joeColors)||void 0===i?void 0:i.textColor4)&&void 0!==s?s:vJ,w=K(null!==(c=null===(a=p.joeColors)||void 0===a?void 0:a.bgColor)&&void 0!==c?c:vJ)?mH:UV,g={pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:qL}
f.style=null!==(l=fs(p.joeColors,UF))&&void 0!==l?l:K(h)?mH:UV
const v=ws(0,f.style),m=ie(t,CV),y=zi(e,d,null,!1,!1,gs(f.style),v,!0,g,!0,!0,m,!1,u(n.allowUnpublishedAppEventPreviews))
if((0,Cv.isNothing)(y)||y instanceof Date)return nr(y,r.refreshController),os(r),null
const A=y
return f.media=new RJ(A.formattedDates,A.startDate,h,p.artworks,p.videos,p.artworkLayoutsWithMetrics,w),(0,kv.isSome)(A.lockup)&&(f.overlay=new MJ(A.lockup)),Zi(e,f,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),f})}(e,t,n,a,c)
break
case am.List:case am.NumberedList:f=function(e,t,n,r,o){return Iv.context("createTodayListCard",()=>{var i,s,a
const c=Ro(e,t,n,r)
ns(e,t,n,r),n.useJoeColorIconPlaceholder=!0
let l=as(0,t)
const u=ss(e,l,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0)
if(0===u.length)return os(r),null
if(n.canDisplayArcadeOfferButton=!1,u.length<function(e){return"tv"===e.client.deviceType?3:4}(e)&&n.enableListCardToMultiAppFallback)cs(e,t,u,c)
else{if(is(t,n.coercedCollectionTodayCardDisplayStyle)===am.NumberedList){let e=1
for(const t of u)t.ordinal=`${e}`,e++}const r=Oo(e,t,n),o=fs(null==r?void 0:r.joeColors,LU),l=!0
null==r||r.videos.forEach(e=>{e.canPlayFullScreen=!1,e.playbackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},e.autoPlayPlaybackControls={prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}}),c.style=l?void 0:BV,c.media=new IJ(u,null!==(i=null==r?void 0:r.artworks)&&void 0!==i?i:[],null!==(s=null==r?void 0:r.videos)&&void 0!==s?s:[],null!==(a=null==r?void 0:r.artworkLayoutsWithMetrics)&&void 0!==a?a:[],void 0,l?o!==BV:o===mH)}return Zi(e,c,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),c})}(e,t,n,a,c)
break
case am.River:case am.Grid:f=function(e,t,n,r,o){return Iv.context("createTodayRiverCard",()=>{const i=Ro(e,t,n,r)
n.useJoeColorIconPlaceholder=!0,ns(e,t,n,r)
const s=function(e,t,n,r,o){const i=as(0,t).filter(t=>{const n=Wd(e,t)
return!Hd(e,t)||!n})
return ss(e,i,n,r.pageInformation,r.locationTracker,void 0,void 0,void 0,!1)}(e,t,n,r)
return 0===s.length?(os(r),null):(n.canDisplayArcadeOfferButton=!1,s.length<function(e){return"tv"===e.client.deviceType?2:4}(e)?cs(e,t,s,i):(i.style=mH,function(e){for(const t of e)K(t.icon.backgroundColor,90)||(t.icon.backgroundColor=Y(.8,.8,.8))}(s),i.media=new OJ(s)),Zi(e,i,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),i)})}(e,t,n,a,c)
break
case am.SingleApp:f=Xi(e,t,n,a,c)
break
case am.ShortImage:f=function(e,t,n,r,o){return Iv.context("createTodayShortImageCard",()=>{const i=Ro(e,t,n,r)
ns(e,t,n,r)
const s=xo(e,t,i,n,r)
let a=!1
const c=as(0,t),l=ws(0,i.style),u=ss(e,c,n,r.pageInformation,r.locationTracker,gs(i.style),l,It(0,t)),d=Ki(0,0,0,t,u)
return i.overlay=d,s||1!==c.length||(a=es(e,t,i,c,n,r)),s||a?(Zi(e,i,n,is(t,n.coercedCollectionTodayCardDisplayStyle),t,o,r),os(r),i):(os(r),null)})}(e,t,n,a,c)
break
default:f=null}return r(f)?(e.console.log(`Unknown style: ${l}`),f):(function(e,t,n,r){const o=is(r,n.coercedCollectionTodayCardDisplayStyle),s=vs(e,r,n.heroDisplayContext,o,n.prevailingCropCodes)
let a=[],c=[]
i(s)&&(a=[s]),i(t.media)&&(t.media instanceof EJ||t.media instanceof bJ)&&(c=t.media.videos),new TJ(a,c)}(e,f,n,t),function(e){e.clickAction instanceof MW&&(e.overlay=new BJ(e.clickAction),e.style=BV)}(f),function(e,t){(0,kv.isNothing)(e.media)||(e.media.otdTextStyle=t.useOTDTextStyle)}(f,n),function(e,t){const n=t.media
if(!(n instanceof AJ))return
const r=s(n.videos)
t.supportsMediaMirroring=r}(0,f),(0,kv.isNothing)(f.media)&&(e.console.log(`Missing required media: ${l}`),f=null),f)},t=>(e.console.log(t),null))}function ns(e,t,n,r,i){const a=s(i)?i:function(e,t,n){let r=Kd(e,t,GH)
if(o(r))switch(n){case am.AppOfTheDay:case am.GameOfTheDay:r=ie(t,CV)}return r}(e,t,is(t,n.coercedCollectionTodayCardDisplayStyle))
kf(e,rs(e,t,n,r,a),null!=a?a:"")}function rs(e,t,n,r,o){var i
return Hf(e,t,null!=o?o:"",{...null==n?void 0:n.baseMetricsOptions,targetType:pG,pageInformation:r.pageInformation,locationTracker:r.locationTracker,isAdEligible:null!==(i=null==n?void 0:n.isAdEligible)&&void 0!==i&&i,optimizationId:f(t,hI),optimizationEntityId:f(t,wI),rowIndex:null==n?void 0:n.currentRowIndex,displayStyle:null==n?void 0:n.metricsDisplayStyle})}function os(e){Ef(e.locationTracker)}function is(e,t){const n=ie(e,uF)
return o0.has(n)&&(0,kv.isSome)(t)?t:n}function ss(e,t,n,r,i,a,c,l,u=!0){return o(t)?[]:Gu(e,t.filter(e=>!s(e.attributes)||e.type!==kV),{lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},offerEnvironment:a,offerStyle:c,clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:l,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:1,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,useJoeColorIconPlaceholder:n.useJoeColorIconPlaceholder,skipDefaultClickAction:!u},filter:76670})}function as(e,t){return Ae(t,sV)}function cs(e,t,n,r){const o=Kd(e,t,kG)
if(r.media=new CJ(n,o),r.style=mH,r.clickAction instanceof dY){const e=oY.from(r.clickAction.pageUrl)
e.param(Hz.showingFallbackMedia,FV),r.clickAction.pageUrl=e.build()}}function ls(e,t){switch(t){case am.AppOfTheDay:case am.GameOfTheDay:return tD
case am.AppEventCard:return nD
case am.Video:case am.FullBleedImage:return ex
default:return rD}}function us(e,t,n){if(o(t))return null
const r=nd(e,t,{withJoeColorPlaceholder:!0,useCase:15})
return r.crop=n||"sr",r}function ds(e,t,n){const r=ne(t,ls(0,is(t,n.coercedCollectionTodayCardDisplayStyle)))
return i(r)?f(r,"bgGradientKind"):null}function fs(e,t=LU){if((0,kv.isNothing)(e))return
if((0,kv.isSome)(null==e?void 0:e.textGradient)&&2===e.textGradient.length)return K(e.textGradient[0])?BV:mH
const n=e[t]
if((0,kv.isNothing)(n))return
const r=J(n)
return r<=.1?mH:r>=.84?BV:UV}function ps(e,t=LU){var n
return null!==(n=fs(e,t))&&void 0!==n?n:UV}function hs(e,t){return i(t.heading)?t.heading.replace(/\n/g," "):t.collapsedHeading}function ws(e,t){return QU}function gs(e){return e===BV?UV:pG}function vs(e,n,r,o,i){const s=function(e,t,n,r){return t===XV?ls(0,n):"editorialArtwork.crossoverCard"}(0,r,o,Object.keys(ne(n,lH)))
return us(e,ne(n,s),function(e,t,n,r){return pm.Article,pm.Article,null==r?void 0:r.defaultCrop}(0,0,t(s),i))}function ms(e,t){let n=Zd(e,t,kG)
if(s(n)||(n=Kd(e,t,GH)),!s(n)){const e=ie(t,tV)
e!==am.AppOfTheDay&&e!==am.GameOfTheDay||(n=ie(t,CV))}return n}function ys(e,t,n){const r=ie(t,n)
if(o(r))return null
const s=new oY(r)
let a=null
switch(e.host.clientIdentifier){case Qq:a=_V
break
case Zq:a=MH}a&&s.param(Qz,a)
const c=et(Qe(e,t))
return i(c)&&s.param(Hz.productVariantID,c),s.toString()}function As(e,t,n){if(o(t))return null
const r=new Sz(t)
return r.title=null!=n?n:e.loc.string("ShareSheet.CopyLink.Title"),r.artwork=Se(e,"systemimage://link"),new nz("com.apple.AppStore.copyLinkActivity",r)}function Ts(e,t,n){return Iv.context("shareSheetDataForProductFromProductData",()=>{if(r(t))return null
const o=ys(e,t,AH),s=ie(t,GH),a=ie(t,Cj),c=t.id,l=e.client.storefrontIdentifier
if(!(o&&s&&a&&c))return null
const u=ys(e,t,"shortUrl")
let d=null,f=null
const p=hd(e,t,4),h=pd(e,t),w=Ge(e,t,lV)||a
let g
const v=$e(e,t,$H)
Me(e,t,$H),g=v?ZC:fj,i(t)&&ie(t,AH)&&(d=sd(e,t,{useCase:1},n),f=function(e,t){return Iv.context("notesMetadataFromProductData",()=>{var n
if(r(t))return null
const o=ie(t,GH)
if((0,kv.isNothing)(o)||0===o.length)return null
const i=ys(e,t,AH),s=ie(t,Cj),a=ie(t,"genreNames.0"),c=null===(n=Ld(e,t))||void 0===n?void 0:n.fileSizeByDevice
let l
switch(t.type){case BH:l=SH
break
case IH:l=BC
break
case kV:l=_B
break
default:l=null}return new Pq(o,i,s,a,c,l)})}(e,t))
const m=new kq(c,l,s,g,d,p,h,!1,w,null,null,f)
return new Eq(m,o,u)})}function bs(e,t,n,o,s){return Iv.context(`shareActionFromData: ${t.type}`,()=>{var a
const c=t.id
switch(e.client.deviceType){case $H:{const r=Ts(e,t)
if(r){const t=new rz(r,[])
return sp(e,t,{targetType:NH,id:c,actionType:LF,pageInformation:n,locationTracker:o}),t}break}case RH:case CH:case kH:{const l=Ts(e,t,s),u=[]
if((null===(a=null==l?void 0:l.url)||void 0===a?void 0:a.length)>0){const t=As(e,l.url)
i&&u.push(t)}const d=function(e,t){if(!e.bag.isContentGiftingEnabled)return null
if(r(t))return null
const n=jt(e,t)
return r(n)||se(t,VV)?null:p(n,I$)>0?t.id:null}(e,t)
if(d){const t=new dY(KU)
t.presentationContext=HD,t.title=e.loc.string("SHARE_GIFT_APP"),t.artwork=Se(e,"systemimage://app.gift"),t.pageUrl=`gift/${d}`,sp(e,t,{targetType:NH,id:c,actionType:b$,actionContext:ty,pageInformation:n,locationTracker:o})
const r=new nz("com.apple.AppStore.giftActivity",t)
u.push(r)}if(l){const t=new rz(l,u,Nm)
return t.title=e.loc.string("SHARE_APP"),t.artwork=Se(e,QC),sp(e,t,{targetType:NH,id:c,actionType:LF,actionContext:ty,pageInformation:n,locationTracker:o}),t}if(u.length>0){const t=u.map(e=>e.action),r=new ez(t)
return r.isCancelable=!0,r.isCustom=!0,sp(e,r,{targetType:NH,id:c,actionType:"actionSheet",pageInformation:n,locationTracker:o}),r}break}}return null})}function Ss(e,t,n,o,a,c,l,u,d,f){return Iv.context("flowPreviewActionsConfigurationForProductFromData",()=>{if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const p=Ps(e,t)
if(!s(p))return null
const h=[]
let w=null,g=null
const v=ae(p,VV)
if(n){const t=Jd(e,p),n=Tu(0,p.type,t),s=function(e,t,n,o,i,s,a){return r(t)||t.type!==BH?null:Ht(e,jt(e,t),t,n,!1,bf(e,t,sd(e,t,null,s),s),a,DG)}(e,p,v,0,0,o,l)
g=ln(e,s,n,p,v,0,null,null,null,null,DG)
const a=function(e,t,n,o,i,s,a,c){if(r(n))return null
let l=Jt(e,n,t,o,s,DG,i)
return(null==c?void 0:c.length)>0&&(l=Ct(e,l,n.adamId,null,c,!1,s)),l}(e,p,s,v,o,l,0,u)
i(a)&&i(g)&&(w=h.length,a.artwork=Se(e,"systemimage://arrow.down.circle"),h.push(a))}const m=function(e,t,n){const r=bs(e,t,n.pageInformation,n.locationTracker)
return i(r)?(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SHARE"),r.artwork=Se(e,QC),r):r}(e,p,c)
i(m)&&h.push(m)
const y=Os(e,p)
if(!v&&!y){if(i(a)&&a instanceof dY&&(a.pageData instanceof SK||a.pageData instanceof HK)){const t=function(e,t,n){const r=function(e,t,n){return Iv.context("seeRatingsAndReviewsActionFromData",()=>{const t=b(n)
if(n.pageData instanceof SK||n.pageData instanceof HK){let r
r=new yz(aV)
const o=ou(e)?r:new sz(new TK(VH,pH)),i=b(n.pageData)
i.fullProductFetchedAction=o,t.pageData=i}return t})}(e,t.id,n)
return i(r)&&(r.title=e.loc.string("FLOW_PREVIEW_ACTION_SEE_RATINGS_AND_REVIEWS"),r.artwork=Se(e,"systemimage://star"),r.animationBehavior=Mj),r}(e,p,a)
i(t)&&h.push(t)}if(!$e(e,t,EU)){const t=function(e,t,n,r){const o=Vs(e,t,n,r)
return i(o)&&(o.title=e.loc.string("FLOW_PREVIEW_ACTION_WRITE_REVIEW"),o.artwork=Se(e,FA)),o}(e,p,d,f)
i(t)&&h.push(t)}}return new xq(h,g,w)})}function Ps(e,t){return Iv.context(`productDataFromData: ${t.type}`,()=>{switch(t.type){case BH:case IH:return t
case OH:{const n=Ae(t,sV)
if(s(n)&&1===n.length){const t=n[0]
return Ps(e,t)}break}case sM:{const n=Ae(t,FH)
if(s(n)&&1===n.length){const t=n[0]
return Ps(e,t)}break}default:return null}return null})}function Is(e,t,n,r){const o=e.bag.voteUrl,i=f(t,"id",gV),s=new oY(o).param(NA,i),a=new zW(s.build()),c=new tz(GF)
return r?(a.title=e.loc.string("ACTION_REVIEW_HELPFUL"),c.title=e.loc.string("TOAST_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_HELPFUL_DESCRIPTION"),a.artwork=Se(e,BA),c.artwork=Se(e,BA)):(a.title=e.loc.string("ACTION_REVIEW_NOT_HELPFUL"),c.title=e.loc.string("TOAST_NOT_HELPFUL_TITLE"),c.message=e.loc.string("TOAST_NOT_HELPFUL_DESCRIPTION"),a.artwork=Se(e,UA),c.artwork=Se(e,UA)),a.method=zB,a.isStoreRequest=!0,a.disableCache=!0,a.headers={"Content-Type":qK.contentType},a.body=(new qK).param("vote",r?"1":"0").param(GA,n).build(),a.successAction=c,a}function Cs(e,t,n){return Iv.context("reportConcernActionFromApiRow",()=>{const r=f(t,"id",gV),i=e.bag.reportConcernUrl,s=new JW(i)
s.method=zB,s.isStoreRequest=!0,s.disableCache=!0,s.needsAuthentication=!0,s.headers={"Content-Type":qK.contentType},s.body=(new qK).param(NA,r).param(GA,n).build()
const a=new YW("selectedReason",jA,iO),c=new YW("explanation",jA,Dj)
s.parameters=[a,c]
{const t=new tz(GF)
t.title=e.loc.string(MA),t.message=e.loc.string($A),t.artwork=Se(e,M_),s.successAction=t}const l=new tz(sH)
l.title=e.loc.string(rO),l.message=e.loc.string(oO),l.isCancelable=!0,s.failureAction=l
let u=e.bag.reportConcernReasons
o(u)&&(u=[{reasonId:"1",name:"It contains offensive material",upperCaseName:"IT CONTAINS OFFENSIVE MATERIAL"},{reasonId:"8",name:"It's off-topic",upperCaseName:"IT\u2019S OFF-TOPIC"},{reasonId:"111003",name:"It looks like spam",upperCaseName:"IT LOOKS LIKE SPAM"},{reasonId:"7",name:"Something else",upperCaseName:"SOMETHING ELSE"}])
const d=u.map(e=>new Rq(f(e,"reasonId"),f(e,GH),f(e,"upperCaseName"))),p=new oz(d)
return p.title=e.loc.string(LA),p.explanation=e.bag.reportConcernExplanation,o(p.explanation)&&(p.explanation="Tell us a little more (Optional)"),p.artwork=Se(e,M_),p.sendAction=s,p})}function ks(e,t,n){return`${Oz}:/${_z.reviews}/${_z.shelf}/${t}/${n}`}function Os(e,t){return!(!i(t)||Es(e,t)||!ae(t,DB)&&!ae(t,"reviewsRestricted"))}function Es(e,t){return!(o(t)||!e.bag.enableSystemAppReviews)&&gt(e).isSystemAppFromData(t)}function Rs(e,t){const n=oY.from(e),r=f(n.query,xS)
return t&&(null==r?void 0:r.length)>0&&(n.query[xS]=i0[r]||r),n}function Ds(e,t,n,r=!1,o,a,c){return Iv.context("createProductReviewsList",()=>{const l=[]
if(s(a)){if((0,kv.isSome)(c)){const t={id:`${c.getSequenceId()}`,kind:null,softwareType:null,targetType:CG,title:e.loc.string(JM),pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,idType:YV}
kf(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:CG,id:`${c.getSequenceId()}`,idType:YV},e.loc.string(JM)),Bf(e,a,t),Ef(c.locationTracker),xf(c.locationTracker)}l.push(a)}if(s(o),i(n)&&n.length>0){const o=!1,i=!o,s=o?n.slice(0,1):n,a=!1,u=_s(e,e.client.guid,t,s,r&&i,a&&i,i,c);(0,kv.isSome)(c)&&kf(e,{pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:qE,id:`${c.getSequenceId()}`,idType:YV},null),u.forEach((t,n)=>{const r=new jK
if(r.sourceType=DS,r.review=t,l.push(r),(0,kv.isSome)(c)){const t={id:r.id,idType:ZV,kind:null,softwareType:null,title:null,pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:"helpfulReview"}
Bf(e,r,t),xf(c.locationTracker)}}),(0,kv.isSome)(c)&&(Ef(c.locationTracker),xf(c.locationTracker))}return l})}function _s(e,t,n,r,i=!1,s=!1,a=!0,c){return Iv.context("createReviewItems",()=>{const l=function(t,n){return n?1e3*((new Date).getTime()-t.getTime())<3600?e.loc.string("TimeAgo.Edited.JustNow"):e.loc.string("TimeAgo.Edited.Time").replace("{time}",e.loc.timeAgoWithContext(t,"standalone")):e.loc.timeAgoWithContext(t,"standalone")}
return r.map(r=>{var u
const d=new EK
d.id=f(r,"id",gV),d.title=ie(r,hH)
const p=ie(r,MO)
p&&(d.date=new Date(p),d.dateText=l(d.date,ae(r,"isEdited"))),d.contents=ie(r,"review"),d.rating=ce(r,HU),d.reviewerName=ie(r,"userName"),d.dateAuthorText=e.loc.string("ProductPage.Section.Reviews.DateAuthor").replace("{date}",d.dateText).replace("{author}",d.reviewerName)
let h=null
const w=ie(r,"developerResponse.id")
if((null==w?void 0:w.length)>0){const e=new RK
e.id=w,e.contents=ie(r,"developerResponse.body")
const t=ie(r,"developerResponse.modified")
t&&(e.date=new Date(t),e.dateText=l(e.date,!1)),d.response=e,h=d.response.contents}if(a&&(f(n,wj),d.flowPreviewActionsConfiguration=function(e,t,n,r,i){var s
if(o(t)||e.client.deviceType!==RH&&e.client.deviceType!==CH&&e.client.deviceType!==$H)return null
const a=[Is(e,t,n,!0),Is(e,t,n,!1)]
return(null===(s=e.bag.reportConcernUrl)||void 0===s?void 0:s.length)>0&&a.push(Cs(e,t,n)),(null==i?void 0:i.length)>0&&a.push(function(e,t){const n=new Sz(t)
return n.title=e.loc.string("ACTION_REVIEW_COPY"),n.artwork=Se(e,"systemimage://doc.on.doc"),n}(e,i)),new xq(a)}(e,r,t,0,h)),s){const n=[Is(e,r,t,!0),Is(e,r,t,!1)];(null===(u=e.bag.reportConcernUrl)||void 0===u?void 0:u.length)>0&&n.push(Cs(e,r,t)),d.voteActions=n}return i&&(d.moreAction=function(e,t,n,r,o){return r?Iv.context("singleReviewActionFromReviewData",()=>{const t=Hs(e,0,n,[r],null,null,null,o),i=new kK
i.adamId=f(n,wj),i.targetReviewId=f(r,"id",gV),i.shelves=[t]
const s=new dY(pH)
return s.pageData=i,s.title=Qs(e),s}):null}(e,0,n,r,c)),d})})}function xs(e,t,n,r){return r?Iv.context("ratingsFromApiResponses",()=>{const t=new OK
t.productId=f(r,wj,gV),t.ratingAverage=p(r,"ratingAverage"),t.totalNumberOfRatings=p(r,$S),t.totalNumberOfReviews=p(r,"totalNumberOfReviews"),t.context=n
const o=l(r,"ratingCountList").slice().reverse(),i=o.reduce((e,t)=>e+t,0)
if(t.ratingCounts=i>0?o.map(e=>e/i*t.totalNumberOfRatings):o,!(t.ratingAverage>0&&t.ratingCounts)){const n=u(r,WE)
t.status=n?e.loc.string("RATINGS_STATUS_DEVELOPER_RESET"):e.loc.string("RATINGS_STATUS_NOT_ENOUGH_RATINGS")}return t}):null}function Ls(e,t,n){if(!Ms(e))return null
const r=ve(t,Nk)
if((0,kv.isNothing)(r))return null
const i=r.data
if(o(i))return null
const s=i[0],a=f(s,"id",gV),c=$s(e,s,!0),u=$s(e,s,!1),d=e.loc.string("ProductPage.ReviewSummary.Subtitle"),p=e.bag.reviewSummaryReportConcernData
if((0,kv.isNothing)(u)||(0,kv.isNothing)(c))return null
const h=ie(t,GH),w=Ge(e,s,Dj),g=Se(e,"systemimage://text.line.2.summary"),m=new GK(c,u,d,g,EH,Yx,function(e,t,n,r,o,i,s){const a=[],c=function(e,t,n,r){return Iv.context("reviewSummaryReportConcernActionFromApiRow",()=>{if(!v(t,_A))return null
const r=function(e,t){const n=new wJ(e)
n.includeAppBinaryTraitsAttribute=!1,n.resourceType=xA
const r=at(e,n),o=new JW(r.toString())
o.method=zB,o.disableCache=!0,o.needsMediaToken=!0,o.headers={"Content-Type":nO},o.bodyDictionary={report:{contentId:t,contentKind:"review-summaries",concerns:null}}
const i=new tz(GF)
i.title=e.loc.string(MA),i.message=e.loc.string($A),i.artwork=Se(e,M_),o.successAction=i
const s=new tz(sH)
return s.title=e.loc.string(rO),s.message=e.loc.string(oO),s.isCancelable=!0,o.failureAction=s,o}(e,n),o=l(t,xA).map(t=>{let n,r
const o=f(t,rV)
switch(o){case"OFFENSIVE":case"OFFENSIVE_OR_HARMFUL":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Offensive.UppercaseName")
break
case"MISREPRESENTING_THE_APP":case"MISREPRESENT":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Misrepresent.UppercaseName")
break
case"SOMETHING_ELSE":n=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.Name"),r=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.SomethingElse.UppercaseName")}return new Rq(o,n,r)})
if(0===o.length)return null
const i=e.loc.string(LA),s=e.loc.string("ProductPage.ReviewSummary.ReportAConcern.Explanation"),a=new iz(o,i,s,r)
return a.artwork=Se(e,M_),a})}(e,t,o);(0,kv.isSome)(c)&&a.push(c)
const u=zs(e);(0,kv.isSome)(u)&&a.push(u)
const d=function(e,t,n,r,o){if(![$U,LB].includes(e.client.buildType))return null
const i=new MW(`tap-to-radar://new/problem?componentid=999915&title=Review Summary Feedback: ${n}&description=App ID: ${t}\nApp name: ${n}\nReview summary ID: ${r}\nReview summary: ${o}\n\nFeedback: `,!0)
return i.title=e.loc.string("Action.ProvideFeedback"),i.artwork=Se(e,"systemimage://ant.circle"),i}(e,n,r,o,i)
return(0,kv.isSome)(d)&&a.push(d),new xq(a)}(e,p,t.id,h,a,w,e.client.guid)),y={id:`${n.getSequenceId()}`,kind:null,softwareType:null,targetType:CG,title:e.loc.string(JM),pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,idType:YV}
return kf(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:CG,id:`${n.getSequenceId()}`,idType:YV},m.title),Bf(e,m,y),Ef(n.locationTracker),xf(n.locationTracker),m}function Ms(e){return e.bag.enableReviewSummarization}function $s(e,t,n){const r=Ge(e,t,Dj)
if((0,kv.isNothing)(r))return null
const o=`^[${e.loc.string(JM)}](jetFont: 'reviewSummaryTitle')`,i=`^[${r}](jetFont: 'reviewSummaryText')`
return n?e.loc.string("ProductPage.ReviewSummary.Body").replace("{styledTitle}",o).replace("{reviewSummary}",i):i}function Fs(e){if(!e)return null
const t=new FK
return Us(e,t),t}function Ns(e){if(!e)return null
const t=new NK
return Us(e,t),t}function Bs(e){if(!e)return null
const t=new BK
return Us(e,t),t}function Us(e,t){t.ratingAverage=e.ratingAverage,t.ratingCounts=e.ratingCounts,t.totalNumberOfRatings=e.totalNumberOfRatings,t.totalNumberOfReviews=e.totalNumberOfReviews,t.status=e.status,t.reviews=e.reviews,t.actions=e.actions,t.nextPage=e.nextPage}function Gs(e,t,n,r=null,o=null){const i=new DK
switch(e.client.deviceType){case"tv":i.title=e.loc.string("TV_SELECT_TO_RATE")
break
case $H:i.title=e.loc.string("CLICK_TO_RATE")
break
default:i.title=e.loc.string("TAP_TO_RATE")}return i.rating=o,i.rateAction=function(e,t,n,r=null){const o=new tz(GF)
o.title=e.loc.string("TOAST_TAP_TO_RATE_TITLE"),o.message=e.loc.string("TOAST_TAP_TO_RATE_DESCRIPTION"),o.artwork=Se(e,"resource://ToastStar.png",95,90)
const i=new KW(function(e,t,n){return Rs(e.bag.userRateURL,n).param("id",t).build()}(e,t,n))
i.adamId=t,i.method=zB,i.isStoreRequest=!0,i.disableCache=!0,i.successAction=o
const s=new YW(HU,LS,iO),a=new YW("version-to-review",LS,iO)
return i.parameters=[s,a],i}(e,t,n,r),i}function js(e,t,n,r,o=!1,i,s){return Iv.context("createWriteReviewAction",()=>{const a=o?e.loc.string("EDIT_REVIEW"):e.loc.string("WRITE_A_REVIEW"),c=function(e,t,n){return Rs(e.bag.writeReviewURL,n).param("id",t).build()}(e,t,n)
let l,u
if((0,kv.isSome)(r)){const t=be(e,!0,!1,1),n=r.template.replace("{c}",`${r.crop}-${t.quality}`).replace("{f}",t.format)
l=new Aq(n,r.width,r.height,r.variants),l.backgroundColor=r.backgroundColor,l.textColor=r.textColor,l.checksum=r.checksum,l.style=r.style,l.crop=r.crop,l.contentMode=r.contentMode,l.imageScale=r.imageScale}switch(e.client.deviceType){case $H:{const e=new ZW(t,c)
e.title=a,e.appIcon=l,e.itemDescription=i,e.appName=s,u=e
break}default:{const n=new ZW(t,c)
n.title=a,n.appName=s,n.itemDescription=i,n.appIcon=l,n.artwork=Se(e,FA),u=n
break}}return u})}function Vs(e,t,n,r,o){return Iv.context("writeReviewActionFromData",()=>{const s=t.id
if((null==s?void 0:s.length)>0){const a=t.type===IH,c=ce(t,HU),l=i(c)&&c>0
return js(e,s,a,o,l,n,r)}return null})}function Hs(e,t,n,r,o=!1,i=!1,s=!0,a){return Iv.context("reviewsShelfForReviewsData",()=>{{const t=new oJ(EL)
return null==a||a.addImpressionsToShelf(e,t,zE),t.items=Ds(e,n,r,o,null,null,a),t}})}function qs(e,t,n,o){return Iv.context("personalizedReviewsContainerShelf",()=>{const s=j(e,o),a=ce(s,HU)
return function(e,t,n,o,s,a,c,l,d,p,h=!1,w=!0,g=null,v=!1){return Iv.context("reviewsContainerShelfForReviewsData",()=>{const w=function(e,t,n,o,s,a,c,l,d,p=null,h=!1){return Iv.context("reviewsContainerForReviewsData",()=>{const w=new LK,g=f(n,wj),v=u(n,"isBundle")
w.adamId=g,w.ratings=xs(e,0,s_,n)
{const t=Ls(e,s,d)
i(t)&&(w.reviewSummary=t)}if(h||(w.tapToRate=Gs(e,g,v,a,p)),i(o)&&o.length>0){const r=!1,i=!r,s=r?o.slice(0,1):o
w.reviews=_s(e,t,n,s,i,!1,i,d)}if(r(w.reviews)||0===w.reviews.length){const t=w.ratings.ratingAverage>0&&w.ratings.ratingCounts,r=u(n,WE)
t||r||(w.ratings.status=e.loc.string(YE))}if(r(l)||(w.editorsChoice=l),!h){const t=i(p)&&p>0
w.writeReviewAction=js(e,g,v,c,t,Cu(e,s),a)}const m=f(n,JE)
if(m){const t=new MW(m,!1)
t.title=e.loc.string(FS),w.supportAction=t}let y=!1
for(const t of o)if(Es(e,t)){y=!0
break}return w.alwaysAllowReviews=y,w})}(e,t,n,o,a,s,c,l,d,g,v),m=new oJ(_S)
return m.title=Qs(e),m.items=[w],null==d||d.addImpressionsToShelf(e,m,zE),h&&i(w.reviews)&&w.reviews.length>0&&(m.seeAllAction=Zs(e,0,n,o,p,s,c,!1,!1)),m})}(e,t,n.ratingsData,n.reviewItems,n.appName,s,n.appIcon,n.editorsChoice,n.shelfMetrics,n.nextPageHref,n.includeSeeAllAction,!1,a)})}function Ws(e,t,n,r,o,i=null){const a=function(e,t,n,r=null){let o=`${Oz}:/${_z.reviews}/${t}/${n}`
return s(r)&&(o=`${o}/?${Hz.token}=${encodeURIComponent(JSON.stringify(r))}`),o}(0,t,n,i)
return new CK(n,r,o,a)}function zs(e){const t=e.bag.reviewSummarizationLearnMoreEditorialItemId
if(o(t))return null
const n=e.loc.string(q$),r=new dY(XV)
return r.title=n,r.pageUrl=`https://apps.apple.com/story/id${t}`,r.artwork=Se(e,pk),r}function Ys(e,t,n,o,i,s=null,a=null,c,l=null,u,d,p=!1,h=!1,w=s0,g=null){const v=new kK
return v.shelves=[],Iv.context("reviewsPageForReviewsData",()=>{const t=r(a)?f(n,wj):a
i&&r(n)
const c=Js(e,0,t,n,o,s,p,h,w,g,d)
return c.reviewsShelf.presentationHints={...c.reviewsShelf.presentationHints,isSortable:i&&c.reviewsShelf.presentationHints.isSortable},v.adamId=t,v.shelves.push(c.reviewsShelf),v.nextPage=c.paginationToken,v.initialSortOptionIdentifier=c.initialSortId,v.sortActionSheetTitle=c.sortActionSheetTitle,v.sortOptions=c.sorts,v.alwaysAllowReviews=Es(e,u),v})}function Js(e,t,n,r,i,a=null,c=!1,l=!1,u=s0,d=null,f){const p=(null==a?void 0:a.length)>0&&s(i)&&i.length%2>0,h=p?i.slice(0,i.length-1):i,w=p?i.slice(i.length-1):[],g=Hs(e,0,r,h,c,l,!0,f)
var v
g.id=o(v=u)?a0:`${a0}.${v}`
const m={reviewsShelf:g}
return g.presentationHints={isSortable:i.length>0||(null==a?void 0:a.length)>0,isSeeAllContext:!0},m.initialSortId=u,m.sortActionSheetTitle=e.loc.string("REVIEWS_SORT_BY"),m.sorts=[Ws(0,n,HE,e.loc.string(NS),e.loc.string(NS),d),Ws(0,n,"favorable",e.loc.string(BS),e.loc.string(BS),d),Ws(0,n,"critical",e.loc.string(US),e.loc.string(US),d),Ws(0,n,GS,e.loc.string(jS),e.loc.string(jS),d)],(null==a?void 0:a.length)>0&&(m.paginationToken=function(e,t,n,r,o){return{url:ks(0,t,r),remainingContent:o,nextHref:n,profile:cH,maxPerPage:20,highestOrdinal:0,metricsPageInformation:null,metricsLocationTracker:null}}(0,n,a,u,w)),m}function Ks(e,t,n,r,o,i,a,c,l){return Iv.context("reviewsPageForReviewsMediaContainer",()=>{let t
return t=s(o.data)?r.concat(o.data):r,Ys(e,0,null,t,i,o.next,n,0,null,null,l,!1,!1,a,c)})}function Zs(e,t,n,r,o=null,i=null,s=null,a,c,l,u){return n?Iv.context(VS,()=>{const t=Ys(e,0,n,r,!0,o,null,0,s,l,u,a,c)
t.title=null
const i=new dY(pH)
return i.pageData=t,i.title=e.loc.string(Oj),i}):null}function Qs(e){switch(e.client.deviceType){case"tv":return e.loc.string("TV_PRODUCT_SECTION_RATINGS")
case MH:return null
default:return e.loc.string("PRODUCT_SECTION_REVIEWS")}}function Xs(e,t){return t.map(t=>t.createProductPageSection(e))}function ea(e,t,n,r,o,i,s){const a=function(e,t,n){switch(t){case AU:return n?hv:pv
case Xx:return wv
case fj:return n?uv:_m
case yj:return n?fv:dv
case eL:return n?vv:gv
case JG:return n?yv:mv
default:return _m}}(0,n,r)
let c=[]
c=t?o&&a.purchasedOrderingCompact?a.purchasedOrderingCompact.slice():a.purchasedOrdering.slice():i&&a.downloadingOrdering?o&&a.downloadingOrderingCompact?a.downloadingOrderingCompact.slice():a.downloadingOrdering.slice():o&&a.notPurchasedOrderingCompact?a.notPurchasedOrderingCompact.slice():a.notPurchasedOrdering.slice()
const l=t?a.purchasedSpotlightIndex:a.notPurchasedSpotlightIndex
if(s&&s.spotlightSection){const e=function(e,t){for(let n=0;n<t.length;n++){const r=t[n]
if(e.sectionType===r.sectionType&&e.shelfId===r.shelfId&&JSON.stringify(e.shelfBasedMappedIds)===JSON.stringify(r.shelfBasedMappedIds))return n}return-1}(s.spotlightSection,c);-1!==e&&(c.splice(e,1),c.splice(l,0,s.spotlightSection))}return c}function ta(e){return new c0(VH,e?dG:uG)}function na(e){var t
return(0,kv.isSome)(e)&&(null===(t=e.id)||void 0===t?void 0:t.indexOf(g1))>-1}function ra(e,t,n){if(!e.featureFlags.isEnabled(n$))return null
const r=new w1(t)
ui(e,r,li(e,"ProductMediaGallery",n,""))
const o=new dY("productMediaGallery")
return o.pageData=r,o}function oa(e,t){var n
return r(t)?1:i(null===(n=t.video)||void 0===n?void 0:n.preview)&&t.video.preview.height>0?t.video.preview.width/t.video.preview.height:i(t.screenshot)&&t.screenshot.height>0?t.screenshot.width/t.screenshot.height:1}function ia(e,t,n,r){return Iv.context("createProductPageFromShelfBasedProductPage",()=>{var o,a,c,l
const u=new SK
return u.adamId=t.lockup.adamId,u.bundleId=t.lockup.bundleId,u.icon=t.lockup.icon,u.isEditorsChoice=t.lockup.isEditorsChoice,u.ordinal=t.lockup.ordinal,u.title=t.lockup.title,u.subtitle=t.lockup.subtitle,u.developerTagline=t.lockup.developerTagline,u.editorialTagline=t.lockup.editorialTagline,u.editorialDescription=t.lockup.editorialDescription,u.shortEditorialDescription=t.lockup.shortEditorialDescription,u.rating=t.lockup.rating,u.ratingCount=t.lockup.ratingCount,u.ageRating=t.lockup.ageRating,u.buttonAction=t.lockup.buttonAction,u.offerDisplayProperties=t.lockup.offerDisplayProperties,u.titleOfferDisplayProperties=t.titleOfferDisplayProperties,u.clickAction=t.lockup.clickAction,u.children=t.lockup.children,u.contextMenuData=t.lockup.contextMenuData,u.shelfBackground=t.lockup.shelfBackground,u.searchAd=t.lockup.searchAd,u.searchAdOpportunity=t.lockup.searchAdOpportunity,u.crossLinkTitle=t.lockup.crossLinkTitle,u.crossLinkSubtitle=t.lockup.crossLinkSubtitle,u.tertiaryTitle=t.lockup.tertiaryTitle,u.tertiaryTitleAction=t.lockup.tertiaryTitleAction,u.tertiaryTitleArtwork=t.lockup.tertiaryTitleArtwork,u.flowPreviewActionsConfiguration=t.lockup.flowPreviewActionsConfiguration,u.productDescription=t.lockup.productDescription,u.itemBackground=t.lockup.itemBackground,u.developerAction=t.developerAction,u.ageRatingAction=t.ageRatingAction,u.logoArtwork=t.logoArtwork,u.navigationBarIconArtwork=t.navigationBarIconArtwork,u.uberArtwork=null===(o=t.uber)||void 0===o?void 0:o.artwork,u.uberArtworkForCompactDisplay=null===(a=t.uber)||void 0===a?void 0:a.compactArtwork,u.uberVideo=null===(c=t.uber)||void 0===c?void 0:c.video,u.uberStyle=null===(l=t.uber)||void 0===l?void 0:l.style,u.media=function(e){const t=[]
for(const n of Object.values(e.shelfMapping))if(na(n)){const e=n.contentsMetadata,r=n.items
t.push(new yY(r,e.platform,e.allPlatforms,e.platformDescription,e.allPlatformsDescription,e.allPlatformsDescriptionPlacement))}return t}(t),i(t.shelfMapping[IV])&&(u.badges=au(e,t.shelfMapping[IV])),u.shareAction=t.shareAction,u.pageMetrics=t.pageMetrics,u.pageRenderMetrics=t.pageRenderMetrics,u.isComplete=!t.isIncomplete,u.hasDarkUserInterfaceStyle=t.hasDarkUserInterfaceStyle,u.mediaSectionTitle=e.loc.string(RS),u.expandedOfferDetails=t.expandedOfferDetails,u.regularPriceFormatted=t.regularPriceFormatted,u.theme=t.theme,u.externalVersionIdentifier=t.externalVersionIdentifier,u.updateBuyParams=t.updateBuyParams,u.appPlatforms=t.appPlatforms,u.descriptionHeader=t.descriptionHeader,u.description=t.description,u.banner=t.banner,u.secondaryBanner=t.secondaryBanner,u.fullProductFetchedAction=t.fullProductFetchedAction,u.appPromotionDetailPageFlowAction=t.appPromotionDetailPageFlowAction,u.pageRefreshPolicy=t.pageRefreshPolicy,u.purchasedOrdering=Xs(e,ea(0,!0,e.host.platform,n,!1,!1,r)),u.notPurchasedOrdering=Xs(e,ea(0,!1,e.host.platform,n,!1,!1,r)),u.shelfMapping=function(e,t){const n={}
for(const r of IK){let o
o=r===pH?sa(e,t):t.shelfMapping[r],s(o)&&(n[r]=o)}return n}(e,t),u.alwaysAllowReviews=t.alwaysAllowReviews,u})}function sa(e,t){const n=t.shelfMapping[aV],r=t.shelfMapping[vB],i=t.shelfMapping[fV],a=t.shelfMapping[mB],c=t.shelfMapping[yB]
if(o(n)&&o(r)&&o(i)&&o(a)&&o(c))return null
let l=null,u=[],d=null,f=null,p=null,h=null,w=null
if(s(null==r?void 0:r.items))for(const e of r.items){const t=e
switch(t.sourceType){case fV:l=t.review
break
case DS:u.push(t.review)}}else u=null
if(s(null==i?void 0:i.items)&&(l=i.items[0]),s(null==a?void 0:a.items)&&(f=a.items[0].action),s(null==c?void 0:c.items)){const e=c.items[0].action
p=e.writeReviewAction,h=e.supportAction}s(null==n?void 0:n.items)&&(d=n.items[0],w=null==n?void 0:n.seeAllAction)
const g=new LK
g.adamId=t.lockup.adamId,g.ratings=d,g.tapToRate=f,g.editorsChoice=l,g.reviews=u,g.supportAction=h,g.writeReviewAction=p,g.alwaysAllowReviews=t.alwaysAllowReviews
const v=new oJ(_S)
return v.title=Qs(e),v.items=[g],v.seeAllAction=w,v}function aa(e,t,n,r,i){if(!$i(e))return null
if(o(t))return null
const s={pageInformation:n,locationTracker:r},a=qi(e,t,null,!1,!1,s,!0,!0,!1,i.allowUnpublishedAppEventPreviews);(0,kv.isSome)(a.nextAppEventPromotionStartDate)&&(0,kv.isSome)(null==i?void 0:i.refreshController)&&nr(a.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const c=a.appPromotions
if(0===c.length)return null
const l=ca(0,c,void 0)
return l.isHorizontal=!1,Bf(e,l,{...s,id:"",kind:null,softwareType:null,targetType:jV,title:""}),l}function ca(e,t,n){const r=new oJ(lk)
return r.isHorizontal=!0,r.title=n,r.items=t,r}function la(e,t,n){e.bag.isOnDemandShelfFetchingEnabled&&(0,Cv.isSome)(t)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=fa(e,t,n.remainingItems.length))}function ua(e,t,n,r,i){(0,Cv.isSome)(t)&&(0,Cv.isSome)(t.url)&&o(t.items)&&n.isFirstRender&&(n.showingPlaceholders=fa(e,t,null!=r?r:n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,i))}function da(e,t,n,r){n.showingPlaceholders=fa(e,t,n.remainingItems.length,n.isSearchLandingPage,n.isArcadePage,r)}function fa(e,t,n,r=!1,i=!1,a=null){if(s(t.items))return!1
if(!function(e,t){switch(t){case eH:case LV:case KF:case KB:case OM:case IT:case sN:case _$:case j$:case lk:case CF:case sj:case HT:case zM:return!0
default:return!1}}(0,t.contentType)||r)return!1
const c=function(e,t,n){return t>0?t:(0,Cv.isSome)(n)&&!ur(n)?0:e.client.isPad?15:6}(e,n,a),l=new Array(c)
for(let e=0;e<c;e+=1)l[e]=new eJ
if(o(l))return!1
const u=function(e,t){if((0,Cv.isSome)(t.rowsPerColumn))return t.rowsPerColumn
switch(t.contentType){case eH:return 3
case LV:return 2
case KF:return 1
case OM:return null
default:return 1}}(0,t)
return(0,Cv.isSome)(u)&&(t.rowsPerColumn=u),t.placeholderContentType=t.contentType,t.contentType=tF,t.items=l,s(i)&&(t.presentationHints={...t.presentationHints,isAppleArcadeContext:i}),t.isHidden=!1,!0}function pa(e){return e.contentType===tF}function ha(e,t){var n
let r=e.loc.string(fT)
return(0,kv.isSome)(t.title)?r=`${t.title}, ${r}`:(0,kv.isSome)(null===(n=t.header)||void 0===n?void 0:n.title)&&(r=`${t.header.title}, ${r}`),{label:r,roleDescription:e.loc.string(pT)}}function wa(e,t,n){const r=s(n)?[...n]:[]
return r.push(`${Hz.groupingFeaturedContentId}=${e}`),s(t)&&r.push(`${Hz.nativeGroupingShelfId}=${t}`),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:r}}function ga(e,t){const n=[]
for(const r of e)n.push(wa(r,null,t))
return n}function va(e,t){if([fj,yj,AU].includes(e.host.platform)&&t instanceof dY){const e={app:"com.apple.gamecenter.from.browse",kind:{name:ij}}
return t.referrerData=e,new $W([new kz(e),t])}return t}function ma(e,t,n=!1){const r=Ia(e,t),o=e.client.isPhone
let i=o?vT:OO
n&&(i="topShelf")
const a=h(r,i)
let c=null,l=null
return s(a)&&(c=nd(e,a,{withJoeColorPlaceholder:!0,useCase:6}),s(c)&&(c.crop=o?"oa":n?"ta":"ob",l=c.backgroundColor)),{artwork:c,artworkData:a,backgroundColor:l}}function ya(e,t,n=!1,r=!1){const o=function(e,t){switch(t.type){case OH:return ne(t,oH)
case XG:return ne(t,wk)
default:return Re(t,qe(e,t),wk)}}(e,t),i=e.client.isPhone||r,a=i?"breakoutVideo9x16":"breakoutVideo16x9",c=h(o,i?"sizzleVideo9x16":"sizzleVideo16x9")||h(o,a)
let l=null,u=null,d=null
if(s(c)){d=h(c,vU)
const t=nd(e,d,{withJoeColorPlaceholder:!0,useCase:6})
s(t)&&(t.crop="sr",u=t.backgroundColor)
const r=f(c,DV)
s(t)&&(null==r?void 0:r.length)>0&&(l=new Vq(r,t,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:{prominentPlay:n},autoPlayPlaybackControls:{}}))}return{video:l,artworkData:d,backgroundColor:u}}function Aa(e,t,n=!0,r,o){const i=ya(e,t),s=ma(e,t),a=i.backgroundColor||s.backgroundColor
return ba(e,t,0,o),(t.type===XG?u(Pa(0,t),"displayMaterial"):ae(t,xy))&&n?Ly:Ta(0,a)}function Ta(e,t){return t?K(t,50)?mH:UV:mH}function ba(e,t,n,r){if(e.client.isPhone||r)return tH
const o=t.type===XG?f(Pa(0,t),"textPosition"):ie(t,Sk)
if((0,kv.isNothing)(o)||0===o.length)return EH
switch(o.toLowerCase()){case Pk:return EH
case tH:return tH
case Ik:return OU
default:return EH}}function Sa(e,t,n,r=!1){switch(t){case EH:case OU:return EH
case tH:return r||n.type===XG?tH:function(e,t){var n
switch((null!==(n=ie(t,Sk))&&void 0!==n?n:"").toLowerCase()){case Pk:return EH
case tH:return tH
case Ik:return OU
default:return EH}}(0,n)
default:return EH}}function Pa(e,t){return t.type!==XG?null:ne(t,"display.templateParameters")}function Ia(e,t){switch(t.type){case OH:return ne(t,lH)
case XG:return ne(t,Sy)
default:return Re(t,qe(e,t),lH)}}function Ca(e,t){return t.type===XG?f(Vt(0,t),"callToActionLabel"):ie(t,tM)}function ka(e,t){const n=s(ne(t,uH)),r=ae(t,UN)
return!n&&!r}function Oa(e,t){const n=ne(t,uH),o=s(n),i=(ie(t,rV),ae(t,UN)),a=ye(e,t,Yj)
if(!o&&!i&&!le(a))return null
let c=null
if(c=o?f(n,AH):ie(i?t:a,AH),r(c))return null
let l=null
if(o&&f(n,nM)===p_)l=new MW(c)
else if(e.isAvailable(G4)){const t=e.required(G4).fetchFlowPage(c),n=new dY(t)
n.pageUrl=c,t===Jj&&(n.pageData=su(e,a)),l=n}return l&&(l.title=Ca(0,t)),l}function Ea(e,t,n=!1){if(o(t))return null
let r=null
const i=Z(BV),s=Z(Ck),a=z(f(t,LU)),c=l(t,My).map(e=>z(e)),u=Ta(0,a)
if(2===c.length){r=new $q("horizontalGradient")
const e=c[0],t=c[1]
r.gradientStartColor=Q(e,e),r.gradientEndColor=Q(t,t),r.filter=$y,n||(r.accessoryColor=r.gradientEndColor)}else r=new $q(ej),r.color=u===mH?i:s,n||(r.accessoryColor=r.color),r.isFallbackStyle=!0
return r}async function Ra(e,t,n,o,i){const s=n(e,t,i)
if(!s)return await Promise.resolve({originalData:t})
const a=Array.from(s),c=[]
for(const t of a){const n=o(e,t)
if(r(n)){const e=a.indexOf(t)
a.splice(e,1)}else c.push(n)}return await Promise.all(c).then(e=>{const n=new Map
for(const[t,r]of a.entries()){const o=e[t]
n.set(r,o)}return{originalData:t,additionalData:n}})}function Da(e,t,n,r=BV){if(o(t)||o(t.attributes))return null
const s=ya(e,t,!0),a=ma(e,t),c=s.backgroundColor||a.backgroundColor,l=ba(e,t,0,!0),u=Aa(e,t,!1,0,!0)!==Ly&&!0,d=La(e,t,0,!1,u,f_)
let p=null
"tv"!==e.client.deviceType&&(p=d.description,d.description=null)
const h=function(e,t){const n=Pa(0,t),r=f(n,"ctaButtonBackgroundColor"),o=f(n,"ctaButtonTextColor")
return i(r)&&i(o)?{type:Tk,fillColor:z(r),textColor:z(o)}:{type:DD,fillColor:null,textColor:null}}(0,t),w=new vq(xH,e.bag.arcadeAppAdamId,null,r,null,xH,h,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId),g=new M1(d,w,{backgroundColor:c,wantsMaterialDetailBackground:!1,wantsBlur:u,badgeColor:null,titleColor:null,descriptionColor:null,callToActionColor:null,textAlignment:null,detailsPosition:l},null,p,a.artwork,s.video),v=Hf(e,t,g.details.title,{...n,targetType:VB})
return v.displaysArcadeUpsell=!0,Bf(e,g,v),kf(e,v,g.details.title),g.offerButtonAction=Ma(e,t,pe(CN),n),Ef(n.locationTracker),g}function _a(e,t){return Ca(0,t)}function xa(e,t){return ie(t,lV)}function La(e,t,n,r,o,i){let s=null
switch(i){case f_:s={type:f_}
break
case Dj:const e=ie(t,MN)
s=(null==e?void 0:e.length)>0?{type:Dj,title:e}:{type:qV}
break
default:s={type:qV}}let a=Aa(e,t,r,0,!0)
const c=ba(e,t,0,!0)
return o&&(a=mH),new ZY(function(e,t){return ie(t,hH)}(0,t),xa(0,t),s,null,a,Sa(0,c,t,!0))}function Ma(e,t,n,r){const o={marketingItemData:t},i=n===pe(CN)&&e.bag.arcadeDownloadPackPostSubscribeTrigger&&Rt(e,e.bag.arcadeDownloadPackRolloutRate)
return $a(e,o,_a(0,t),r,i)}function $a(e,t,n,r,o){const s=t.marketingItemData
if(!i(s))return null
const a=Vt(0,s),c=f(a,rV)===uH,u=f(a,AH)
if(c&&u){const t=function(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n)if(new RegExp(r).test(t)){const n=new dY(NL,t)
return n.pageData=new ZJ(e.bag.metricsTopic),n}const r=e.bag.financeUIRegexStrings
for(const e of r)if(new RegExp(e).test(t))return new dY(KU,t)
const o=e.bag.webViewRegexStrings
for(const e of o)if(new RegExp(e).test(t))return new dY(BL,t)
return new MW(t,!1)}(e,u),o={id:e.bag.arcadeAppAdamId,actionType:eM,actionContext:HV,contextualAdamId:e.bag.arcadeAppAdamId,offerType:Ak,targetType:NH,mercuryMetricsData:Sf(0,s),...r}
return t.title=n,sp(e,t,o),t}{const t=function(e,t,n,r){const o=Vt(0,t),s=f(o,xU),a=f(o,ZU)
if(!i(s)||!i(a))return null
const c=l(o,"serviceTypes").length>1&&e.bag.aristotleParentAppAdamId?e.bag.aristotleParentAppAdamId:e.bag.arcadeAppAdamId,u=new az(s,c,{buyParams:a,productIdentifier:s,pageInformation:r.pageInformation}),d={id:c,actionType:eM,targetType:NH,subscriptionSKU:s,actionContext:HV,contextualAdamId:c,actionDetails:{buyParams:a},offerType:Ak,mercuryMetricsData:Sf(0,t),...r}
return u.title=n,sp(e,u,d),u}(e,s,n,r)
if(o){const e=new dY(WF),r=kF
e.pageData=r,e.presentationContext=TG
const o=new fz(void 0,void 0,e,void 0),i=new $W([t,o])
return i.title=n,i}return t}}function Fa(e,t){const n=new Set,r=j(e,t),o=Ae(r,Q$)
for(const t of o){const o=Ba(e,t,r)
if(s(o))for(const e of o)n.add(e)}return n}function Na(e,t){let n
return t===KR&&(n=vp(e,pe(RD))),t===ZR&&(n=gp(e,10)),r(n)?null:Jn(e,n).catch(()=>null)}function Ba(e,t,n){if(ie(t,rI)!==QR)return null
const o=ie(t,oI),i=r(mp(e,n)),s=[]
return o===iI&&(s.push(ZR),i&&s.push(KR)),s}function Ua(e,t,n,a,c){return Iv.catchingContext(`module: ${a.module}`,()=>{var c
const l=[]
switch(a.module){case"Header":a.titleForNextShelf=ie(t,XB)
break
case"TextBlock":{const e=function(e,t,n){const r=ie(t,XB)
if(!r)return null
const o=new _q(r,QG,XV)
Ha(0,o,n)
const i=new oJ(fG)
return i.items=[o],i}(0,t,a);(0,kv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"CollectionLockup":{const n=function(e,t,n){const r=ae(t,"showOrdinals"),o="OrdinalDesc"===ie(t,"collectionLockupDisplayType")?nb:"ascending",i=ie(t,"collectionLockupSize")
let s
if(n.subStyle=i,i)switch(i){case fI:s=KF
break
case dI:s=LV
break
default:s=eH}const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:td(0,s),canDisplayArcadeOfferButton:of(0,s)},c=Ae(t,FH)
if((0,kv.isNothing)(c))return null
let l=[]
if(l=Gu(e,c,{includeOrdinals:r,ordinalDirection:o,lockupOptions:a}),!l||0===l.length)return null
const u=new oJ(s)
return u.items=l,u}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case sI:{const n=function(e,t,n){const r=ie(t,"inlineImageDisplayType"),o=nd(e,ne(t,_H),{useCase:13,allowingTransparency:r===s$&&!0,withJoeColorPlaceholder:!1})
if(!o)return null
const i=new VY(o,!1,QG)
i.caption=ie(t,XB),n.subStyle=r,r&&("BoundingBox"===r?(i.isFullWidth=!1,i.hasRoundedCorners=!0):(i.isFullWidth=!0,i.hasRoundedCorners=!1)),Ha(0,i,n)
const s=new oJ(XR)
return s.items=[i],s}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case aI:{const n=function(e,t,n){const r=Va(e,t)
if(!r)return null
let o=null
const a=Ae(t,DH)
if(s(a)&&(o=aa(e,a,n.metricsPageInformation,n.metricsLocationTracker,n),i(o)))return o
const c=ie(t,"appLockupSize")
let l
n.subStyle=c
let u=!1
if(c)switch(c){case uI:l=eH,u=!0
break
case dI:l=LV,u=!0
break
default:l=Vk}const d=It(0,t)
if(u){const t=new oJ(l)
let i
if(i=Du(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:d,artworkUseCase:td(0,l)}),(0,kv.isNothing)(i))return null
t.items=[i],o=t}else o=function(e,t,n){const r=new oJ(Vk),o="tv"!==e.client.deviceType,i=Va(e,t),s=It(0,t),a=Du(e,i,{offerStyle:rG,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:s,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:1}),c=new hY(KV,a)
c.description=Cu(e,i)
let l=null
switch(ie(t,"appLockupVideo")){case"AppTrailer":{const t=pd(e,i)
t&&t.length>0&&(l=t[0])
break}}return l&&(vo(e,l,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId}),c.video=l),o&&(r.background={type:ej,color:F1}),r.items=[c],r}(e,t,n)
return o}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TipBlock":{const n=function(e,t,n){const r=nd(e,ne(t,_H),{useCase:13})
if(!r)return null
const o=ie(t,XB),i=ie(t,"tipNumber"),s=new VY(r,!1,QG)
s.isFullWidth=!1,s.hasRoundedCorners=!0,s.caption=o,s.ordinal=i,Ha(0,s,n)
const a=new oJ(XR)
return a.items=[s],a}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"PullQuote":{const n=function(e,t,n){const r=ie(t,lI),o=ie(t,"quoteAttribution"),i=nd(e,ne(t,_H),{useCase:13}),s=ie(t,"pullQuoteDisplayType")===s$,a=new WY(r,o,i,s)
Ha(0,a,n)
const c=new oJ(lI)
return c.items=[a],c}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasNonFocusableElements=!0)
break}case"HorizontalRule":{const e=function(e,t,n){const r=ie(t,"lineStyle"),i=ie(t,tV)===s$
let s=Z("defaultLine")
const a=ne(t,"customColor"),c=z(f(a,"lightMode")),l=z(f(a,"darkMode"))
o(c)||o(l)||(s=Q(c,l))
const u=new YY(r,s,i),d=new oJ("horizontalRule")
return d.items=[u],d}(0,t);(0,kv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case cI:{const n=function(e,t,n){const r=nd(e,ne(t,"video.previewFrame"),{useCase:13})
if(!r)return null
const o=ie(t,"video.video")
if(!o)return null
const i=ie(t,"inlineVideoDisplayType")===s$,s=new Vq(o,r,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
vo(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const a=new HY(s,i,QG)
a.caption=ie(t,XB),Ha(0,a,n)
const c=new oJ(sL)
return c.items=[a],c}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppMedia":{const n=function(e,t,n){const o=Va(e,t)
if(!o)return null
const s=ie(t,"appMediaOption"),a=ie(t,"appMediaPlatform")
switch(n.subStyle=s,s){case"Screenshots":{let t=null
if(t=new oJ(bH),r(a)){const n=hd(e,o,14)
n&&n.length>0&&(t.items=[n[0]])}else{const n=function(e,t){switch(t){case KT:return MH
case fj:return e.client.isPad?CH:RH
case AU:return"tv"
case ZT:return _V
case"visionOS":return kH
default:return null}}(e,a)
if(n){const r=hd(e,o,14,[n])
r&&r.length&&(t.items=[r[0]])}}return i(t)&&0===t.items.length?null:t}case"AppTrailers":const t=new oJ(sL),s=pd(e,o)
if(s&&s.length>0){const r=s[0]
vo(e,r,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:n.pageId})
const o=new HY(r,!1,mj,null,null,!0)
return t.items=[o],t}return null
default:return null}}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"LinkBlock":{const n=function(e,t,n){const r=ie(t,AH)
if(!r)return null
const o=new oY(r),i=ie(t,"urlTitle")
let s=ie(t,XB)
s||(s=o.host)
const a=[pI,SB,"music.apple.com","books.apple.com","podcasts.apple.com","watch-app.cdn-apple.com","tv.apple.com"]
let c=!1
for(const e of a)o.host.endsWith(e)&&(c=!0)
const l=e.required(G4).fetchFlowPage(r);(0,kv.isSome)(l)&&l===XV&&(o.protocol="itms-appss://")
const u=new MW(o.build())
sp(e,u,{targetType:uH,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const d=new NY(i,s,u,c)
Ha(0,d,n)
const f=new oJ(JR)
return f.items=[d],f}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"TextList":{const e=function(e,t,n){const r=oe(t,XB)
if(!r.length)return null
const o=ie(t,"textListDisplayType")
n.subStyle=o
let i,s=!1
s="Bulleted"===o,i=s?"<ul>":"<ol>"
for(const e of r){const t=JSON.stringify(e)
i=`${i}<li>${JSON.parse(t)}</li>`}i=s?`${i}</ul>`:`${i}</ol>`
const a=new _q(i,QG,XV)
Ha(0,a,n)
const c=new oJ(fG)
return c.items=[a],c}(0,t,a);(0,kv.isSome)(e)&&(l.push(e),a.hasNonFocusableElements=!0)
break}case"IAPLockup":{const n=function(e,t,n){const r=Va(e,t)
if(!r)return null
const o=_u(e,r,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:1})
if(!o)return null
const i=new vY(o),s=new oJ("inAppPurchaseShowcase")
return s.background={type:ej,color:$1},s.items=[i],s}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case QR:{const o=function(e,t,n,o){const a=ie(t,oI)
o.subStyle=a
let c=null
switch(a){case"OSUpgrade":c=function(e,t,n){const r=e.client.deviceType
if(r!==$H)return null
const o=Mt(r)
if(null===o)return null
const i=new MW(o)
sp(e,i,{targetType:uH,pageInformation:n.metricsPageInformation,id:`${n.index}`,locationTracker:n.metricsLocationTracker})
const s=e.loc.string("CLIENT_CONTROL_OS_UPGRADE_TITLE","CHECK FOR UPDATE"),a=new KY(s,i)
Ha(0,a,n)
const c=new oJ("clientControlButton")
return c.items=[a],c}(e,0,o)
break
case iI:c=function(e,t,n,o){let a=mp(e,n)
if(!a&&o.additionalData&&(a=yp(0,o.additionalData.get(KR))),!i(a))return null
const c={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},l=fp(0,o.metricsPageInformation,o.metricsLocationTracker,!1)
let u
l.title=e.loc.string(pN,hN)
const d=Ca(0,a.marketingItemData)
s(d)?(u=Ma(e,a.marketingItemData,pe(RD),c),i(u)&&(u.title=d)):(u=fp(0,o.metricsPageInformation,o.metricsLocationTracker,!1),u.title=e.loc.string(pN,hN))
const f=new tJ(u,l),p=xa(0,a.marketingItemData)
f.unsubscribedDescription=p
const h=new vq(xH,e.bag.arcadeAppAdamId,null,rG,null,mH,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
h.titles[oB]=e.loc.string(pN,hN),f.offerDisplayProperties=h,Bf(e,f,{...c,targetType:x_,title:d,id:t.id,kind:x_,softwareType:null,displaysArcadeUpsell:!0})
{if(r(o.additionalData))return null
const t=o.additionalData.get(ZR)
if(s(t)){const n={pageInformation:o.metricsPageInformation,locationTracker:o.metricsLocationTracker},r=q(t)
f.iconArtworks=od(e,r,n,{useCase:2})}}const w=new oJ(x_)
return w.items=[f],w.background={type:ej,color:N1},w}(e,t,n,o)}return c}(e,t,n,a);(0,kv.isSome)(o)&&(l.push(o),a.hasFocusableElements=!0)
break}case"StoryList":{const n=function(e,t,n,r){const o=Ae(t,FH)
if(!o)return null
const i=ie(t,GH),s=ie(t,oG)
let a=null
if(e.featureFlags.isEnabled("mini_today_cards_article")){a=Sp(e,o,i,s,new uQ(n.metricsPageInformation,n.metricsLocationTracker))}else{const t=!0,r=t?sj:nB
a=bp(e,o,r,i,s,n,null),t&&Array.isArray(a.items)&&(a.items=a.items.filter(e=>!(e instanceof jJ)||Ap(0,e.media.kind,r)))}return a}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"AppEventLockup":{const n=function(e,t,n){const r=Va(e,t)
return r?aa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n):null}(e,t,a);(0,kv.isSome)(n)&&(l.push(n),a.hasFocusableElements=!0)
break}case"OfferItemLockup":{const n=function(e,t,n){const r=ye(e,t,FH)
if(o(r))return null
const i=ie(t,XB),s=new _q(i,QG,XV),a=new oJ(fG)
return a.items=[s],[a,aa(e,[r],n.metricsPageInformation,n.metricsLocationTracker,n)]}(e,t,a);(0,kv.isSome)(n)&&(l.push(...n),a.hasFocusableElements=!0)
break}default:e.console.log(`Unknown module: ${a.module}`)}for(const e of l){const t=null!==(c=e.presentationHints)&&void 0!==c?c:{}
e.presentationHints={...t,isArticleContext:!0}}return l})}function Ga(e,t){const n=Ae(t,sV)
if(1!==n.length)return null
const r=n[0]
if(!r)return null
switch(r.type){case BH:case IH:return r
default:return null}}function ja(e){return e.client.deviceType===$H?BV:pV}function Va(e,t,n){return ye(e,t,FH)||null}function Ha(e,t,n,o){if(!t)return
let i=n.module
n.subStyle&&(i=i+"_"+n.subStyle),r(o)&&(o={id:`${n.index}`,impressionIndex:n.index,idType:YV,impressionType:i,kind:"iosModule"}),t.impressionMetrics=new RW(yf(o))}function qa(e,t,n){const r=new D1
r.overlayType=Wa(e,t),r.displayOptions={horizontalPlacement:Ka(e,t),textAlignment:Za(e,t),isOverDarkContent:Ja(e,t)}
const a=cf(e,t),c=ie(t,CV)
if(Ve(e,t,ZB)?r.badgeText=e.loc.uppercased(af(e,a,c)):r.badgeText=c,r.titleText=Zd(e,t,GH)||Ge(e,a,GH),r.overlayType===K_||r.overlayType===CO?r.descriptionText=Zd(e,t,oG):r.descriptionText=Zd(e,t,kG)||Ge(e,a,oG),r.callToActionText=ie(t,tM),r.buttonTitle=Ya(e,t),r.overlayType!==cH&&r.overlayType!==K_||(r.lockup=function(e,t,n){let r=ye(e,t,Yj)
const i=Ae(t,sV)
if(o(r)&&s(i)&&(r=i[0]),o(r))return null
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t)},artworkUseCase:n.lockupArtworkUseCase,offerStyle:QU,offerEnvironment:mH,canDisplayArcadeOfferButton:n.canDisplayArcadeOfferButton,shouldHideArcadeHeader:e.featureFlags.isEnabled(BF),isContainedInPreorderExclusiveShelf:n.isContainedInPreorderExclusiveShelf},c=Du(e,r,a),l=cf(e,t),u=Zd(e,t,kG)||Ge(e,l,oG)
return(null==u?void 0:u.length)>0&&(c.subtitle=u),c}(e,t,n)),(null==c?void 0:c.length)>0&&i(r.lockup)&&(r.lockup.heading=c),r.collectionIcons=function(e,t){const n=Ae(t,sV)
if(o(n))return null
const r=[]
for(const t of n){const n=sd(e,t,{useCase:1,withJoeColorPlaceholder:!0})
s(n)&&r.push(n)}return s(r)?r:null}(e,t),s(r.lockup))r.clickAction=r.lockup.clickAction,r.impressionMetrics=r.lockup.impressionMetrics
else{const o={targetType:cH,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t)},i=za(e,t),s=Oa(e,t)
s.title=i,sp(e,s,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),targetType:cH,id:t.id}),r.clickAction=s,Bf(e,r,Hf(e,t,i,o))}return r}function Wa(e,t){const n=ae(t,xy),r=ie(t,rV),a=Ae(t,sV),c=Zd(e,t,oG),l=function(e){return Rt(e,e.bag.hero3RolloutRate)}(e)&&(null==c?void 0:c.length)>0
let u=ye(e,t,Yj)
return o(u)&&s(a)&&(u=a[0]),i(u)&&"App"===r?l?K_:cH:s(a)&&"Collection"===r?l?CO:kO:n?Z_:Dj}function za(e,t){const n=Wa(e,t),r=ye(e,t,Yj)
switch(n){case cH:case K_:return ie(r,GH)
case Z_:case Dj:case kO:case CO:return Zd(e,t,GH)||Ge(e,r,GH)
default:return null}}function Ya(e,t){if("tv"!==e.client.deviceType)return null
switch(Wa(e,t)){case cH:return e.loc.string(gT)
case Z_:case Dj:let t=e.loc.string(vO)
return t===vO&&(t=e.loc.string(gT)),t
case kO:return e.loc.string("HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_COLLECTION")
default:return null}}function Ja(e,t){const n=ya(e,t),r=ma(e,t),o=n.backgroundColor||r.backgroundColor
return!o||K(o,50)}function Ka(e,t){if(e.client.isPhone)return tH
const n=ie(t,Sk)
if(!s(n))return EH
switch(n.toLowerCase()){case Pk:return EH
case tH:return tH
case Ik:return OU
default:return EH}}function Za(e,t){return Ka(e,t),EH}function Qa(e){return`${e.shelfIdentifier}.${e.slot}`}function Xa(e,t){if(r(e))return null
const n=Qa(t),o=e.tasks[n]
return r(o)?null:(delete e.tasks[n],o)}function ec(e,t,n){var r
const o=(null==n?void 0:n.meta)||null,i=null===(r=null==o?void 0:o.adDisplayStyle)||void 0===r?void 0:r.slot
return(0,kv.isSome)(i)?tc(e,t,{shelfIdentifier:W1,slot:i}):tc(e,t,q1)}function tc(e,t,n){const o=null==t?void 0:t.mediaResponse
if((0,kv.isNothing)(o)||(0,kv.isSome)(null==t?void 0:t.failureReason))return null
const i={tasks:{}}
return function(e,t){if(r(e))return
const n=Qa(t.positionInfo)
e.tasks[n]=t}(i,{data:j(e,o),positionInfo:n}),i}function nc(e){const{platform:t,id:n,...r}=e
return{...r,platform:Tt(t),id:At(n),$kind:z1}}async function rc(e,t,n){Iv.beginContext(e)
let r=await x(t())
if(!r.success&&(0,kv.isSome)(n)&&(r=await x(n(r.error))),Iv.endContext(),r.success)return r.value
throw r.error}function oc(e,t,n){if(o(t))return
const r=function(e){return f(e,"meta.metrics.clusterId")}(n)
o(r)||function(e,t,n){const r=sc(t)
e.storage.storeString(r,n)}(e,t,r)}function ic(e,t){return o(t)?null:function(e,t){const n=sc(t)
return e.storage.retrieveString(n)}(e,t)}function sc(e){return e+"-cohort-id"}async function ac(e,t,n){var r
const o=Object.keys(n),i=o.map(async e=>await n[e]),s=await async function(e){const t=await Promise.all(e.map(async e=>{try{const t=await e
return function(e){return null!==e&&typeof e===EG&&cY in e}(t)?t:O(t)}catch(e){return E(e instanceof Error?e:new Error(String(e)))}})),n=[]
if(t.forEach(e=>{e.success||n.push(e.error)}),n.length>0)throw 1===n.length?n[0]:new lY(n)
return t}([t,...i]),a=s[0],c=a.value
if(!a.success||(0,kv.isNothing)(c))throw null!==(r=a.error)&&void 0!==r?r:new Error("Unknown primaryPageData error")
const l={},u=s.slice(1)
for(const[t,n]of u.entries()){const r=o[t]
n.success?l[r]=n.value:(l[r]=null,e.console.log(`Builder - failed to fetch additionalPageRequirement ${r}, reason: ${n.error}`))}return{primaryPageData:c,additionalData:l}}function cc(e,t,n=[],r){const o={exclusions:null==r?void 0:r.exclusions},i=n.slice()
return(null==r?void 0:r.optionalQuery)&&i.push(...r.optionalQuery.map(e=>`${e}?`)),{routes(n){var s
return[{rules:[{...o,path:t,query:[`${Hz.language}?`,...i]},{...o,path:`/{${_z.storeFront}}${t}`,query:[`${Hz.language}?`,...i]},...null!==(s=null==r?void 0:r.extraRules)&&void 0!==s?s:[]],handler(t,r){const{[_z.storeFront]:o,[Hz.language]:i,...s}=r
return e({...s,...kr(n,{storefront:o,language:i})})}}]},makeCanonicalUrl(e,o){const i=function(e,t,n){const r=new vm.URL("https://apps.apple.com"),{storefront:o,language:i}=function(e,t){return e.locale.deriveLocaleForUrl(t)}(e,n)
return r.path(o),r.path(t.substr(1)),(0,kv.isSome)(i)&&r.param("l",i),r}(e,t,o),s=i.pathComponents()
for(const[e,t]of s.entries())if(t.startsWith("{")&&t.endsWith("}")){const n=t.substring(1,t.length-1)
s[e]=o[n]}i.set(jG,"/"+s.join("/"))
const a=n.slice()
a.sort((e,t)=>e.localeCompare(t))
for(const e of a){if(!(e in o))throw new Error(`expected queryParmeters to contain: ${e}`)
const t=o[e]
i.param(e,t)}if(null==r?void 0:r.optionalQuery){const e=r.optionalQuery.slice()
e.sort((e,t)=>e.localeCompare(t)),e.forEach(e=>{const t=o[e]
t&&i.param(e,t)})}return i.toString()}}}function lc(e){const t=[lH,oH,Nj,Uj]
return e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}function uc(e,t,n){const r=new oJ(n||K1)
r.isHorizontal=!1,r.items=BT
const o=new lJ([r])
return o.isIncomplete=!0,o.title=t,o}function dc(e,t){if(!(0,Cv.isNothing)(t))switch(t){case"top-free":return"top-paid"
case"top-paid":return"top-free"
default:return}}async function fc(e,t,n,r=null){const o=function(e,t,n,r=null,o=e.host.clientIdentifier){const i=[Nj,Uj,eV]
e.appleSilicon.isSupportEnabled&&i.push(iV)
const a=new wJ(e).forType(L$).addingQuery(Xj,t).includingAttributes(i).addingQuery(M$,BH).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(N(e)).usingCustomAttributes(Ze(e))
return s(n)&&a.addingQuery(Hz.charts,n),o===Zq?a.addingContext(MH):o===Qq&&a.addingContext(_V),e.appleSilicon.isSupportEnabled&&a.includingAdditionalPlatforms([aH,iH]),(0,Cv.isSome)(r)&&a.addingQuery(Hz.ages,r),a}(e,t,n,r)
return o.withLimit(200),o.enablingFeature("newChartsElements"),await Jn(e,o)}async function pc(e,t,n){let r
return r=e.host.clientIdentifier===Qq||function(e){return s(e)&&(-1!==e.indexOf("top-free-safari-extensions")||-1!==e.indexOf("top-paid-safari-extensions"))}(t)?Promise.resolve({}):Jn(e,qn(e,n)).catch(()=>{}),await r}function hc(e,t,n,r){const o={...n,shouldFilter:!ae(t,DM),chartUrl:ie(t,dU),chartIdentifier:ie(t,$V),roomRelationshipData:ye(e,t,"room")}
return dr(o.featuredContentId)?(o.seeAllUrl=function(e,t,n){const r=ie(t,dU),o=new oY(r),i=ie(t,$V)
s(i)&&o.param(Hz.chart,i)
const a=function(e,t,n){var r
const o=null!==(r=(null==n?void 0:n.editorialCharts.length)>1)&&void 0!==r&&r,i=null==n?void 0:n.editorialCharts.map(e=>e.type.toString()).join(",")
if((0,Cv.isSome)(i)&&i.includes(t)&&o)return i
const s=dc(0,t)
return void 0===s?t:[t,s].join(",")}(0,i,n)
return s(a)&&o.param(Hz.charts,a),o.toString()}(0,t,r.chartSet),o.showOrdinals=!0,o.shouldFilter=!1):s(o.roomRelationshipData)&&(o.seeAllUrl=Er(e,o.roomRelationshipData.href)),o.shelfStyle=function(e,t,n,r){const o=n.featuredContentId
if(557===o||418===o||495===o||function(e){return VZ.has(e)}(o)){let e=ie(t,tV)
return e||(e=311===o||312===o?KV:495===o||557===o?dN:OV),`${e}Lockup`}if(431===o)return ox
if(429===o)return j$
if(304===o||305===o||430===o||420===o)return _$
if(dr(o))return eH
if(497===o)return sN
switch(r.shelves.length%3){case 0:return eH
case 1:return LV
default:return KF}}(0,t,o,r),o.clientIdentifierOverride=yn(e,t),o}function wc(e,t,n,a){const c=(l=t.featuredContentId,UZ.has(l)?84862:80894)
var l
let u,d,p=[]
if(s(n.shelfContents)){const o=function(e,t,n,o,s){const a=Xa(t,o)
if(r(a))return null
const c=a.data,l=gc(e,c,s)
return i(l)?s.includedAdAdamIds=[c.id]:wo(e,n),l}(e,null==a?void 0:a.adStitcher,null==a?void 0:a.adIncidentRecorder,q1,t)
o&&o instanceof PY&&(p.push(o),xf(t.metricsLocationTracker),t.ordinalIndex++,n.shelfContents=n.shelfContents.filter(e=>e.id!==o.adamId))}for(const o of n.shelfContents){if(o.type===DH)return null
if(557===t.featuredContentId&&o.type===OH){u=o
continue}if(r(o.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}if(vt(e,o,c))continue
const n=gc(e,o,t)
n&&(p.push(n),xf(t.metricsLocationTracker),t.ordinalIndex++)}!dr(t.featuredContentId)||pr(t.featuredContentId)||fr(t.featuredContentId)||(p=function(e,t){if(!e)return null
const n=e.length,r=n%3
return n>=3?e.slice(0,n-r):e}(p)),delete t.maxItemCount,d=fr(t.featuredContentId)?hp(e,t.title):{eyebrow:t.eyebrow,eyebrowArtwork:t.eyebrowArtwork,title:t.title,titleArtwork:t.titleArtwork,subtitle:t.subtitle,configuration:t.shelfHeaderConfiguration}
const w=new oJ(t.shelfStyle)
let g
if(w.isHorizontal=!0,w.items=p,w.shouldFilterApps=t.shouldFilter,fr(t.featuredContentId)&&(w.footerTitle=e.loc.string(EM),w.footerAction=pp(),w.footerStyle={$kind:mV,bundleID:sF,width:16,height:16},w.items.forEach((t,n)=>{(0,Cv.isSome)(t)&&t instanceof PY&&(t.clickAction=va(e,t.clickAction))})),557===t.featuredContentId?function(e,t,n,r,o,i,a){if((0,Cv.isNothing)(i)&&(i=ye(e,t.featuredContentData,Lk)),r.configuration.includeTrailingArtwork=!0,!le(i)){const e=ie(t.featuredContentData,GH)
return r.eyebrow=e,r.title="",n.footerTitle="",t.isDeferring=!0,void t.remainingItems.push(i)}const c=ie(t.featuredContentData,GH)
r.eyebrow=c
const l=ne(i,rj),u=f(l,GH)
r.title=u,Df(t.metricsLocationTracker).name=u,s(t.originalPlaceholderShelfImpressionMetrics)&&(t.originalPlaceholderShelfImpressionMetrics.fields.name=u)
const d=ne(i,lH)
if((0,Cv.isNothing)(d))return void(n.isHidden=!0)
const p=h(d,"storyBackgroundStatic16x9"),w=Vr(e,p,{useCase:28,withJoeColorPlaceholder:!0}),g=K(w.backgroundColor)?mH:UV
n.background={type:_H,artwork:w,style:g},o.forEach((t,n)=>{(0,Cv.isSome)(t)&&t instanceof PY&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,QU,g),t.subtitleTextFilter=$y,e.clientCapabilities.isNotEnabled(NT)&&(t.redownloadButtonTint=Z(BV)))})
const v=h(d,$O)
if((0,Cv.isNothing)(v))return void(n.isHidden=!0)
const m={contentMode:Ov.scaleAspectFit,useCase:18},y=Vr(e,v,m)
r.trailingArtwork=y
const A=f(i.attributes,AH),T=f(i.attributes,tM),b={id:i.id,idType:ZV,targetType:NH,actionType:UH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
if((0,Cv.isSome)(A)){n.footerTitle=T
const t=e.required(G4).fetchFlowPage(A),r=new dY(t)
r.title=T,r.pageUrl=A,sp(e,r,b),n.footerAction=r}else{const r={targetType:NH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(i)},o=Wr(e,i,t,!1,null,r,a);(0,Cv.isSome)(o.action)&&(o.action.actionMetrics.clearAll(),o.action.title=null!=T?T:f(l,"callToAction"),sp(e,o.action,b),n.footerAction=o.action,n.footerTitle=o.action.title)}}(e,t,w,d,p,u,a):e.clientCapabilities.isNotEnabled(NT)&&w.items.forEach((e,t)=>{(0,Cv.isSome)(e)&&e instanceof PY&&(e.redownloadButtonTint=Z(c_))}),w&&o(w.items)&&t.isFirstRender&&da(e,w,t,t.featuredContentId),dr(t.featuredContentId))g=new dY(HB)
else if(g=new dY(jH),!pa(w)){const e=function(e,t){if(!t)return null
switch(t){case JF:case ox:return t
default:return null}}(0,t.shelfStyle)
g.pageData=uc(0,t.title,e)}g.pageUrl=t.seeAllUrl,g.title=e.loc.string(Oj),g.referrerUrl=t.metricsPageInformation.pageUrl,ap(e,g,t.seeAllUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})
const v=function(e,t,n){return 557!==n.featuredContentId&&!pr(n.featuredContentId)&&!fr(n.featuredContentId)&&497!==n.featuredContentId}(0,w.items,t),m=i(g.pageUrl)||i(g.pageData)
if(v&&m&&Xr(e,d,g),t.shelfStyle===j$||t.shelfStyle===_$){const e=ie(t.featuredContentData,"suppressTagline")!==FV
r(w.presentationHints)?w.presentationHints={showSupplementaryText:e}:w.presentationHints={...w.presentationHints,showSupplementaryText:e}}return t.shelfStyle,w.header=d,w.url=Nr(0,w,t),w}function gc(e,t,n){if(o(t))return null
let a
n.showOrdinals&&(a=e.loc.decimal(n.ordinalIndex))
let c,l=null
!i(n.shelfBackground)||n.shelfBackground.type!==ej&&n.shelfBackground.type!==B_||(l=BV),s(n)&&(c=n.clientIdentifierOverride)
const u={ordinal:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),isAdvert:An(0,t)},clientIdentifierOverride:c,artworkUseCase:td(0,n.shelfStyle),offerStyle:l,canDisplayArcadeOfferButton:of(0,n.shelfStyle),isContainedInPreorderExclusiveShelf:497===n.featuredContentId,shouldHideArcadeHeader:e.featureFlags.isEnabled(BF)&&n.isArcadePage}
let d
switch(n.shelfStyle){case _$:d=function(e,t,n,r){return Iv.context("trailersLockupFromData",()=>{const o=new OY
return function(e,t,n,r,o){t&&Iv.context("copyDataIntoTrailersLockup",()=>{Su(e,t,n,o),n.trailers=dd(e,t,r,o.metricsOptions,n.adamId)})}(e,t,o,r,n),o})}(e,t,u,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
break
case j$:d=xu(e,t,u)
break
case sN:d=Lu(e,t,u)
break
case JF:case ox:d=_u(e,t,u)
break
case"smallImageLockup":case QN:case IM:d=$u(e,t,u,Kv.EditorialLockupLarge)
break
default:d=Du(e,t,u)}return r(d)||!d.isValid()?null:d}function vc(e,t){const n=e.bag.dynamicUIRegexStrings
for(const r of n){const n=r.replace(/\//g,"\\/")
if(new RegExp(n).test(t)){const n=new dY(NL,t)
return n.pageData=new ZJ(e.bag.metricsTopic),n}}const r=e.bag.webViewRegexStrings
for(const e of r){const n=e.replace(/\//g,"\\/")
if(new RegExp(n).test(t))return new dY(BL,t)}return new dY(KU,t)}function mc(e,t,n){Iv.catchingContext("parseGrouping",()=>{for(const r of t.data){const o=ce(r,bG)
if(dr(o)){const e=f(r,"id")
n.chartSet=yc(e,t.editorialChartSets)}else n.chartSet=null
const s=Lr(e,r,n),a=s.shelfToken,c=s.metricsOptions
let l
for(const t of l2)if(t.supports(e,r,o)){l=Iv.catchingContext("parseGroupingShelf",()=>t.createShelf(e,r,n,a,c))
break}i(l)&&(n.shelves.push(l),$n(e,n.shelves,UG,c.id,n.metricsPageInformation))}})}function yc(e,t){for(const n of t){if(n.id===e)return n
for(const t of n.editorialCharts)if(t.id===e)return n}return null}function Ac(e,t){const n=[],r=[]
return function t(o){const s=ce(o,bG)
Iv.catchingContext(`flattenGroupingTree.addMediaApiDataToGroupingData: ${s}`,()=>{const a=ye(e,o,RU)
if(i(a))t(a)
else if(function(e){return WZ.has(e)}(s)){const e=Ae(o,Fj)
for(const n of e)t(n)}else if(424===s){const e=424!==ce(c=o,bG)?null:{id:f(c,"id"),name:ie(c,GH),editorialCharts:Ae(c,Fj).map(e=>function(e){return dr(ce(e,bG))?{id:f(e,"id"),href:ie(e,dU),name:ie(e,GH),type:ie(e,$V)}:null}(e)).filter(e=>(0,kv.isSome)(e))};(0,kv.isSome)(e)&&r.push(e)
const n=Ae(o,Fj)
for(const e of n)t(e)}else n.push(o)
var c})}(t),{data:n,editorialChartSets:r,originalGroupingData:t}}function Tc(e,t,n){var r,o,i,s,a,c
if(e.user&&e.user.isManagedAppleID)return null
{const t=[],n=e.loc.string("FOOTER_REDEEM",ok),l=vc(e,e.bag.redeemUrl),u=new jY(n,l)
if(u.id=T$,t.push(u),e.bag.isMonetaryGiftingEnabled){const n=e.loc.string("FOOTER_SEND_GIFT",oy),r=vc(e,b$),o=new jY(n,r)
o.id=b$,t.push(o)}const d=e.bag.accountTopUpURL
if((0,kv.isSome)(d)){const n=null!==(r=e.bag.accountTopUpTitle)&&void 0!==r?r:e.loc.string("FOOTER_ADD_MONEY"),o=vc(e,d),i=new jY(n,o)
i.id="topUp",t.push(i)}let f
{f=new oJ("titledButtonStack")
const n=new GY(t)
n.compactLineBreaks=n.buttons.map((e,t)=>t),f.items=[n]
const r=e.loc.string(fT),l=e.loc.string(pT)
f.accessibilityMetadata={label:null!==(s=null!==(o=f.title)&&void 0!==o?o:null===(i=f.header)||void 0===i?void 0:i.title)&&void 0!==s?s:r,roleDescription:l.replace("%d",`${null!==(c=null===(a=n.buttons)||void 0===a?void 0:a.length)&&void 0!==c?c:0}`)}}return f}}function bc(e,t,n=!0){const r=new MW(t),o=e.loc.string(TO),i=new bY(o)
i.clickAction=r,i.presentationStyle=[G_,j_],n&&i.presentationStyle.push(V_)
const s=new oJ("footnote")
if(s.items=[i],e.bag.emailSupportLinkURL){const t=new MW(e.bag.emailSupportLinkURL),r=new bY("Email Support")
r.clickAction=t,r.presentationStyle=[G_,j_],n&&r.presentationStyle.push(V_),s.items.push(r)}return s}function Sc(e,t,n,r){const o=new oJ("unifiedMessage")
return o.id=t,o.items=[new rJ(t,n,r)],o.isHidden=!0,o}function Pc(e,t,n,r,o,a,c){const u=l(t,RV),d=[]
for(const t of u){const l=y(t)
if(s(l)){const t=Ic(e,l,n,r,o,a,c)
i(t)&&d.push(t)}}if(0===d.length){const t=function(e,t,n,r,o){const i=NE,s=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_TITLE"),a=e.loc.string("PRODUCT_PRIVACY_NO_DETAILS_PROVIDED_BODY"),c=Se(e,Wx),l=Cc(e,t,i,n,r,o)
return new p2(i,s,a,c,n,[],[],l)}(e,n,r,a,c)
d.push(t)}for(const t of d)Bf(e,t,{id:null,kind:null,softwareType:null,title:t.title,pageInformation:a,locationTracker:c,targetType:jE}),xf(c)
return d}function Ic(e,t,n,r,a,c,u){const d=f(t,qx),p=f(t,Hx),h=f(t,nH)
if((0,Cv.isNothing)(d)||o(d)||(0,Cv.isNothing)(p)||o(p)||(0,Cv.isNothing)(h)||o(h))return null
const w=Rc(e,t,function(e,t){switch(t){case"DATA_NOT_LINKED_TO_YOU":return"resource://person.circle.slash"
case"DATA_USED_TO_TRACK_YOU":return"systemimage://person.fill.viewfinder"
case"DATA_NOT_COLLECTED":return"systemimage://checkmark.circle"
case"DATA_LINKED_TO_YOU":return PS
default:return null}}(0,d)),g=a?kc(e,t,r):[],v=function(e,t,n){const r=l(t,"purposes"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Ec(e,r,n)
i(t)&&o.push(t)}}return o}(e,t,r),m=Cc(e,n,d,r,c,u)
return new p2(d,p,h,w,r,v,g,m)}function Cc(e,t,n,r,o,i){let s=null
return r!==_j&&r!==YM||(s=$c(e,t,Dc(e)&&r===_j?YM:VU,o,i,n)),s}function kc(e,t,n){const r=l(t,"dataCategories"),o=[]
for(const t of r){const r=y(t)
if(s(r)){const t=Oc(e,r,n===_j?_j:VU)
i(t)&&o.push(t)}}return o}function Oc(e,t,n){const i=f(t,qx),s=f(t,"dataCategory")
if((0,Cv.isNothing)(i)||o(i)||(0,Cv.isNothing)(s)||o(s))return null
const a=Rc(e,t,function(e,t){switch(t){case"FINANCIAL_INFO":return"systemimage://creditcard.fill"
case"CONTACT_INFO":return"systemimage://info.circle.fill"
case"OTHER":return"systemimage://ellipsis.circle.fill"
case"SENSITIVE_INFO":return"systemimage://eye.fill"
case SS:return"systemimage://chart.bar.fill"
case"CONTACTS":return PS
case"PURCHASES":return"systemimage://bag.fill"
case"LOCATION":return"systemimage://location.fill"
case"HEALTH_AND_FITNESS":return"systemimage://heart.circle.fill"
case"IDENTIFIERS":return"resource://person.crop.rectangle.line.fill"
case"USER_CONTENT":return"systemimage://photo.fill.on.rectangle.fill"
case"BROWSING_HISTORY":return"systemimage://clock.fill"
case"DIAGNOSTICS":return"systemimage://gearshape.fill"
case"SEARCH_HISTORY":return"systemimage://magnifyingglass.circle.fill"
case"BODY":return"systemimage://figure"
case"SURROUNDING":return"systemimage://arkit"
default:return null}}(0,i))
if(r(a))return null
let c=[]
n===VU&&(c=l(t,"dataTypes"))
const u=new w2(i,s,a,n,c)
return i===SS&&(u.prefersSmallArtwork=!0),u}function Ec(e,t,n){const r=f(t,qx),i=f(t,"purpose"),s=kc(e,t,n)
return(0,Cv.isNothing)(r)||o(r)||(0,Cv.isNothing)(i)||o(i)||0===s.length?null:new h2(r,i,s)}function Rc(e,t,n){let o=null
if((0,Cv.isSome)(n)&&(null==n?void 0:n.length)>0&&(o=Se(e,n)),r(o)){const n=h(t,_H)
i(n)&&(o=nd(e,n,{useCase:0,allowingTransparency:!0}))}return o}function Dc(e){return e.client.deviceType===MH}function _c(e,t,n,a,c,l){return Iv.context("createPrivacyHeaderFromData",()=>{const u=function(e,t,n,r,a,c){let l,u=QG
const d=ye(e,t,cV),p=s(d)&&g2.indexOf(d.id)>-1
l=n&&!p?e.loc.string("PRODUCT_PRIVACY_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_HEADER_TEMPLATE")
const h=Mc(e,t,r,VU,a,c),w=1===h.length&&h[0].identifier===NE||0===h.length
w&&(l=e.loc.string("PRODUCT_PRIVACY_HEADER_NO_DETAILS_TEMPLATE"))
const g=ie(t,Cj)
i(g)?l=l.replace(Vx,JL+g+KL):(l=w?e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_NO_DETAILS_TEMPLATE"):n?e.loc.string("PRODUCT_PRIVACY_FALLBACK_DETAIL_HEADER_TEMPLATE"):e.loc.string("PRODUCT_PRIVACY_FALLBACK_HEADER_TEMPLATE"),u=mj)
const v=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_LINK")
l=l.replace("{privacyPolicyLink}",v)
const m=function(e,t,n,r){let i
{const n=Ge(e,t,x$)
if((0,Cv.isNothing)(n)||o(n))return null
i=new MW(n,!1)}return i.title=e.loc.string("PRODUCT_PRIVACY_SUMMARY_PRIVACY_POLICY_BUTTON_TITLE"),sp(e,i,{targetType:uH,id:yS,pageInformation:n,locationTracker:r}),i}(e,t,a,c),y={}
if(i(m)&&(y[v]=m),n){const n=function(e,t,n,r){const i=f(ne(t,pM),"managePrivacyChoicesUrl")
if((0,Cv.isNothing)(i)||o(i))return null
const s=new MW(i,!1)
return sp(e,s,{targetType:uH,id:"managePrivacyChoices",pageInformation:n,locationTracker:r}),s}(e,t,a,c)
if(i(n)){const t=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_LINK")
l+=mS,l+=e.loc.string("PRODUCT_PRIVACY_MANAGE_CHOICES_TEMPLATE").replace("{manageChoicesLink}",t),n.title=t,y[t]=n}}const A=new Dq(l,u)
return new BY(A,y)}(e,t,n,a,c,l),d=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(AS),a=e.loc.string("PRODUCT_PRIVACY_DEFINITIONS_LINK_TEMPLATE").replace("{privacyDefinitionsLink}",s),c=Lc(e,o,i)
if(r(c))return null
c.title=s
const l={}
l[s]=c
const u=new Dq(a,mj)
return new BY(u,l)}(e,0,n,c,l)
let p,h
n&&(p=function(e,t,n,o,i){if(!n)return null
const s=e.loc.string(BE),a=xc(e,o,i)
let c
const l={}
r(a)?c=e.loc.string(UE):(c=e.loc.string(vS).replace(nG,s),a.title=s,l[s]=a)
const u=new Dq(c,mj)
return new BY(u,l)}(e,0,n,c,l),s(p)&&(h=xc(e,c,l)))
const w=[]
if(i(d)){const e=new d2(d,void 0)
w.push(e)}if(i(p)){const e=new d2(p,h)
w.push(e)}return new u2(u,n,[],[],w,void 0)})}function xc(e,t,n){const r=e.bag.appPrivacyLearnMoreEditorialItemId
if((0,Cv.isNothing)(r)||0===r.length)return null
const o=new dY(XV)
return o.title=e.loc.string(BE),o.pageUrl=`https://apps.apple.com/story/id${r}`,sp(e,o,{targetType:NH,id:"privacyLearnMore",pageInformation:t,locationTracker:n}),o}function Lc(e,t,n){const r=e.bag.appPrivacyDefinitionsEditorialItemId
if((0,Cv.isNothing)(r)||0===r.length)return null
const o=new dY(XV)
return o.title=e.loc.string(AS),o.pageUrl=`https://apps.apple.com/story/id${r}`,sp(e,o,{targetType:NH,id:TS,pageInformation:t,locationTracker:n}),o}function Mc(e,t,n,r,o,i){var a
let c=[]
const l=ne(t,n?pM:uM)
return s(l)&&(c=null!==(a=Pc(e,l,t,r,e.client.deviceType!==MH||r===YM,o,i))&&void 0!==a?a:[],1===c.length&&0===c[0].categories.length&&(c[0].style=_j)),c}function $c(e,t,n,o,a,c){if(r(t.id))return null
const l=new dY(GE)
l.title=e.loc.string(bS),l.pageData=function(e,t,n,r,o){const i=[]
if(e.client.deviceType!==MH||n!==VU){const n=new oJ(NV),s=_c(e,t,!0,!1,r,o)
n.items=[s],n.presentationHints={isFirstShelf:!0},i.push(n)}const s=new lJ(i)
return e.client.deviceType===MH&&n!==VU||(s.isIncomplete=!0),s.title=e.loc.string(jx),s}(e,t,n,o,a)
const u=t.type===IH?_z.productBundle:_z.product
let d
s(c)&&(d={privacyTypeId:c})
const f=oY.fromComponents(Oz,null,`/${_z.privacyDetail}/${u}/${t.id}`,d)
l.pageUrl=f.build()
const p={targetType:NH,id:"seeDetails",pageInformation:o,locationTracker:a}
return i(c)&&(p.targetType=jE,p.id=c),sp(e,l,p),l}function Fc(e,t,n){if(!s(t))return null
let r=null
r=(0,Cv.isNothing)(n)?"sr":n
const i=nd(e,t,{cropCode:r,useCase:12,allowingTransparency:!0})
return o(i)?null:i}function Nc(e,t,n,r){let o=0
for(const i of t){const t=n[i.key]
if(t){let n
if(ou(e))n=new yz(t.shelfId,null,null,null,t.index,!0)
else if((0,Cv.isSome)(t.section)){const e=new sz(t.section,!0)
e.index=t.index,n=e}i.clickAction=n}let s
switch(i.key){case aB:case fV:case HU:case KM:case Ux:case ZM:case AG:s=QM
break
default:s=UH}i.clickAction&&sp(e,i.clickAction,{targetType:MN,id:i.key,idType:YV,actionType:s,actionDetails:{position:o},pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o+=1}}function Bc(e,t,n){return new wY(n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,{type:"canPerformAppAction",appAction:e,appCapabilities:t})}function Uc(e,t,n,r,o,i,s){return Iv.context("createHeaderShelf",()=>{const a=new oJ(XS)
a.presentationHints={isSeeAllContext:r}
const c=e.loc.string("ProductPage.Accessibility.Shelf.Title")
if(!r){a.title=c
const o=Vc(t,n,r)
if((0,kv.isSome)(o)&&Ar(o)){const r=Hc(e,t,n,NH,i,s)
a.seeAllAction=r}}const l=function(e,t,n,r,o,i){const s=Vc(t,n,r),a=function(e,t,n){const r=e.bag.accessibilityLearnMoreEditorialItemId
if((0,kv.isNothing)(r))return null
const o=new dY(XV)
return o.title=e.loc.string(q$),o.pageUrl=`https://apps.apple.com/story/id${r}`,e.clientCapabilities.isEnabled(sR)&&sp(e,o,{id:LN,targetType:NH,pageInformation:t,locationTracker:n}),o}(e,o,i),c=(0,Yv.attributeAsString)(t,Cj),l=(0,kv.isSome)(c)&&Ar(c)
let u
u=function(e,t,n,r){if(e)return(0,kv.isSome)(n)&&r?"AccessibilityDetails.Header":r?nP:(0,kv.isSome)(n)?"AccessibilityDetails.Header.NoDeveloperName":rP
{const e=(0,kv.isSome)(t)
return e&&Ar(t)?(0,kv.isSome)(n)?"ProductPage.Accessibility.Header.SupportedFeatures":"ProductPage.Accessibility.Header.SupportedFeatures.NoLearnMoreLink":e?(0,kv.isSome)(n)?"ProductPage.Accessibility.Header.NoSupportedFeatures":oP:(0,kv.isSome)(n)?"ProductPage.Accessibility.Header.NoReportedFeatures":iP}}(r,s,a,l)
let d=e.loc.string(u),f=mj
const p={}
if((0,kv.isSome)(a)){const t=e.loc.string(q$)
d=d.replace(nG,t),p[t]=a}l&&(d=d.replace(Vx,`<b>${c}</b>`),f=QG)
const h=new Dq(d,f)
return new BY(h,p)}(e,t,n,r,i,s),u=new T2(l,[])
return(0,kv.isSome)(o)&&!r&&(o.addImpressionsToShelf(e,a,"accessibilityOverview"),xf(o.locationTracker)),a.items=[u],a})}function Gc(e,t,n,r,o=null,i,s){return Iv.context("createFeaturesShelf",()=>{const a=function(e,t,n,r){const o=Vc(t,n,r)
return(0,kv.isNothing)(o)?[]:o.reduce((t,n)=>{const r=f(n,qx),o=f(n,hH),i=f(n,nH)
if((0,kv.isNothing)(r)||0===r.length||(0,kv.isNothing)(o)||0===o.length)return t
const s=function(e){switch(e){case"VOICEOVER":return"voiceover"
case tP:return"voice.control"
case"LARGER_TEXT":return"textformat.size"
case"SUFFICIENT_CONTRAST":return"circle.lefthalf.filled.inverse"
case"DARK_INTERFACE":return"appearance.darkmode"
case"DIFFERENTIATE_WITHOUT_COLOR_ALONE":return"xmark.triangle.circle.square.fill"
case"REDUCED_MOTION":return"circle.dotted.and.circle"
case"CAPTIONS":return"captions.bubble.fill"
case"AUDIO_DESCRIPTIONS":return"quote.bubble.fill"
default:return null}}(r)
if((0,kv.isNothing)(s))return t
const a=Se(e,`systemimage://${s}`)
return a.imageScale=function(e){return e===tP?OV:null}(r),t.push(new y2(o,null!=i?i:null,a)),t},[])}(e,t,n,r)
if(yr(a))return null
const c=new oJ(yV)
c.presentationHints={isSeeAllContext:r}
const l=e.loc.string("ProductPage.Accessibility.Card.SupportedFeaturesTitle"),u=new A2(l,Se(e,"systemimage://accessibility"),a)
return r||((0,kv.isSome)(o)&&(o.addImpressionsToShelf(e,c,"supportedFeaturesCard",void 0,void 0,null,l),xf(o.locationTracker)),u.clickAction=Hc(e,t,n,lj,i,s)),c.items=[u],c})}function jc(e,t,n,r,o){return Iv.context("createDeveloperLinkShelf",()=>{const i=function(e,t,n,r,o){const i=function(e,t,n,r,o){const i=function(e,t){const n=t?YF:dM
return(0,Yv.attributeAsString)(e,`${n}.developerUrl`)}(t,n)
if((0,kv.isNothing)(i)||yr(i))return null
const s=new MW(i,!1)
return s.title=e.loc.string("Accessibility.DeveloperUrlLinkActionTitle"),e.clientCapabilities.isEnabled(sR)&&sp(e,s,{id:"AccessibilitySite",targetType:uH,pageInformation:r,locationTracker:o}),s}(e,t,n,r,o)
if((0,kv.isNothing)(i))return null
const s=e.loc.string("Accessibility.DeveloperUrlLinkTitle"),a=e.loc.string("Accessibility.DeveloperUrlText").replace("{accessibilitySite}",s),c={}
c[s]=i
const l=new Dq(a,mj)
return new BY(l,c)}(e,t,n,r,o)
if((0,kv.isNothing)(i))return null
const s=new oJ(XS)
return s.items=[new T2(i,[])],s.presentationHints={isSeeAllContext:n},s})}function Vc(e,t,n){return re(e,`${n?YF:dM}.${t}.supportedCategories`)}function Hc(e,t,n,r,o,i){const s=new dY(YF)
s.title=e.loc.string(bS),s.pageData=function(e,t,n,r,o){const i=[],s=Uc(e,t,n,!0,null,r,o)
i.push(s)
const a=jc(e,t,!0,r,o);(0,kv.isSome)(a)&&i.push(a)
const c=new lJ(i)
return c.title=e.loc.string(aR),c.isIncomplete=!0,c.presentationOptions=[FU,tL,eP],c}(e,t,n,o,i)
const a=t.type===IH?_z.productBundle:_z.product,c=Yv.URL.fromComponents(Oz,null,`/${_z.accessibilityDetails}/${a}/${t.id}`,{deviceFamily:n})
return s.pageUrl=c.build(),e.clientCapabilities.isEnabled(sR)&&sp(e,s,{id:"AccessibilityDetails",targetType:r,pageInformation:o,locationTracker:i}),s}function qc(e,t,n,r,o,i){if(r)return null
const s=Ru(e,t)
if((0,kv.isNothing)(s))return null
const a=new S2(s),c=o?"":e.loc.string("InfoList.Category.Title")
return new b2(c,[a],void 0)}function Wc(e,t,n,a,c,l){const u=ne(t,Mk)
let d=[],f=function(e,t){let n
if(Ku(e,t)){const r=Pd(0,t,e.appleSilicon.isSupportEnabled),o=!1,i=md(e,t),s=Dd(e,t,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),a=function(e,t,n,r,o,i=!0){return!!kd(0,n,r,o).some(e=>Od(t,e))}(0,i,e.client.deviceType,r,o,s),c=e.loc.deviceDisplayName(e)
a&&c&&(n=e.loc.string("InfoList.Requirements.Summary").replace("{deviceName}",c))}return n}(e,t)
const p=Ve(e,t,SA,We(e))
if(s(u)){const t=function(e){const t=[aH,iH,$$,$H,xj,EU,MH],n=function(e,t,n){let r=null
switch(t){case RH:r=aH
break
case CH:r=iH
break
case $H:r=$H
break
case"tv":r=EU
break
case MH:r=MH
break
case kH:r=xj}return i(n)&&n===$$&&(r=$$),r}(0,e.client.deviceType,e.host.deviceModel)
if(i(n)){const e=t.indexOf(n)
e>0&&(t.splice(e,1),t.unshift(n))}return t}(e)
for(const n of t){const t=h(u,n)
if(s(t)){const r=zc(0,t,e.appleSilicon.isSupportEnabled&&n===$H&&p&&!e.appleSilicon.isRosettaAvailable)
i(r)&&d.push(r)}}!i(f)&&d.length>0&&(f=d[0].text)}else{const n=function(e,t){const n=Ge(e,t,"requirementsString")
return r(n)?null:new S2(n)}(e,t)
i(n)&&(d=[n])}if(o(d))return null
const w=c?"":e.loc.string("Requirements"),g=new b2(w,d,f)
return 0===g.items_V3.length&&(g.items_V3=Cl(0,g)),g}function zc(e,t,n){var r
const o=null!==(r=f(t,bP))&&void 0!==r?r:void 0
let i=f(t,"requirementString")
const a=l(t,"devices")
if(n){const e=f(t,"rosettaUnavailableRequirementString")
s(e)&&(i=e)}if((0,kv.isNothing)(i))return null
const c=[]
for(const e of a)c.push("\u2022\t\u2068"+e+"\u2069")
const u=c.length>0?c.join("\n"):void 0
return new S2(i,{heading:o,listText:u})}function Yc(e,t){const n=ne(t,"contentRatingsBySystem.appsKorea")
if((0,kv.isNothing)(n))return null
const r=p(n,SN)
if((0,kv.isNothing)(r))return null
const o=l(n,PP)[0]
if((0,kv.isNothing)(o))return null
const i=Vd(0,r),s=[]
return(0,kv.isSome)(i)&&s.push(Se(e,`resource://${i}`)),new S2(o,{headingArtworks:s})}function Jc(e,t,n,o,s,a){var c
return null!==(c=function(e,t,n,r,o,i){const s=kt(0,t)
if((0,kv.isNothing)(s))return null
const a=e.loc.string(SP),c=Kc(e,a)
let u,d
u=e.loc.string(mR),d=s
const p=new b2(u,[],d,c),h=Et(e,t)
if((0,kv.isSome)(h)){const t=Se(e,Pe(h),30,30)
p.items_V3.push({$kind:_H,artwork:t})}else p.items_V3.push({$kind:"textEncapsulation",text:s})
const w=function(e,t){return ie(t,"ageRating.description")}(0,t)
let g="";(0,kv.isSome)(w)&&(g+=w)
const v={};(0,kv.isSome)(c)&&(v[a]=c,g.length>0&&(g+="\n"),g+=a)
const m=new BY(new Dq(g,Yx),v)
p.items_V3.push({$kind:qU,linkableText:m})
const y=function(e,t){const n=oe(t,aA)
let r=""
for(const e of n){const t=f(e,"level"),n=l(e,"contentDescriptors")
if(0!==n.length){r.length>0&&(r+="\n\n"),r+=`**${t}**`
for(const e of n){const t=f(e,nH);(0,kv.isSome)(t)&&(r+="\n",r+=t)}}}if(0===r.length)return
const o=new BY(new Dq(r,Yx))
return{$kind:qU,linkableText:o}}(0,t);(0,kv.isSome)(y)&&(p.items_V3.push({$kind:AF}),p.items_V3.push(y))
const A=function(e,t){return ie(t,"ageRating.ageGuidanceUrl")}(0,t)
if((0,kv.isSome)(A)){const t=new MW(A)
t.title=e.loc.string("InfoList.AgeRating.DeveloperInfo"),p.items_V3.push({$kind:AF}),p.items_V3.push({$kind:NH,action:t})}return p}(e,t))&&void 0!==c?c:function(e,t,n,o,s,a){const c=ne(t,"contentRatingsBySystem.appsApple")
if(r(c))return null
const u=f(c,GH)
if(r(u))return null
if(99===p(c,SN))return null
const d=l(c,PP)
let h
const w=Re(t,qe(e,t),"ageBand"),g=p(w,"minAge"),v=p(w,"maxAge")
h=i(g)&&i(v)?e.loc.string("InfoList.AgeRating.Summary").replace("{ageRating}",u).replace("{minAgeRating}",e.loc.decimal(g)).replace("{maxAgeRating}",e.loc.decimal(v)):u
const m=[]
let y,A="";(0,kv.isSome)(h)&&(A+=h)
for(const e of d)A+="\n",A+=e
m.push(new S2(A))
{const n=Yc(e,t);(0,kv.isSome)(n)&&m.push(n)
const r=Zc(e,t);(0,kv.isSome)(r)&&m.push(r)}(m.length>1||m[0].text!==h)&&(y=h)
const T=s?"":e.loc.string(mR),b=e.loc.string(SP),S=Kc(e,b)
return new b2(T,m,y,S)}(e,t,0,0,s)}function Kc(e,t){let n
if((0,kv.isSome)(e.bag.ageRatingLearnMoreEditorialItemId)&&e.bag.ageRatingLearnMoreEditorialItemId.length>0){const r=new dY(XV)
r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.ageRatingLearnMoreEditorialItemId}`
const o=Ir({...Cr(e),id:e.bag.ageRatingLearnMoreEditorialItemId})
r.destination=o,n=r}return n}function Zc(e,t){if(e.bag.requireAgeVerification&&function(e,t,n){const r=ce(t,"contentRatingsBySystem.appsApple.rank")
if((0,kv.isNothing)(r))return!1
let o
switch(n){case kP:o=3
break
case IP:o=4
break
case"adultOnly":o=5
break
default:o=1}return r>=o}(0,t,IP)&&function(e,t){var n
const r=null!==(n=Ae(t,cF))&&void 0!==n?n:[]
for(const e of r)if(f(e,"id")===6014..toString())return!0
return!1}(0,t)){let n
if(t.type===IH){const r=ve(t,BH)
if(i(r))for(const t of r.data)if(i(ie(t,CP))){n=e.loc.string("AgeVerification.ProductPage.Rating.BundleUnsuitableForJuveniles")
break}}else i(ie(t,CP))&&(n=e.loc.string("AgeVerification.ProductPage.Rating.UnsuitableForJuveniles"))
return(0,kv.isNothing)(n)?null:new S2(n)}return null}function Qc(e,t,n,r,o,i){const s=Rt(e,e.bag.gameControllerRecommendedRolloutRate),a=_t(e,t)
if(s&&a){const n=o?"":e.loc.string("ProductPage.Info.GameController.Title")
let r
r=a?"ProductPage.Info.GameController.Recommended":"ProductPage.Info.GameController.Required"
const i=e.loc.string(r),s=ie(t,Cj),c=a?"ProductPage.Info.GameController.Recommended.Summary.v2":"ProductPage.Info.GameController.Required.Summary.v2",l=e.loc.string(c).replace(Vx,s),u=[new S2(l)]
let d
const f=e.bag.gameControllerLearnMoreEditorialItemId
if((0,kv.isSome)(f)&&f.length>0){const t=new dY(XV),n=a?"ProductPage.Info.GameController.Recommended.LearnMore":"ProductPage.Info.GameController.Required.LearnMore"
t.title=e.loc.string(n),t.pageUrl=`https://apps.apple.com/story/id${f}`,d=t}return new b2(n,u,i,d)}return null}function Xc(e,t,n,r,o,i){const s=Ge(e,t,"copyright")
if((0,kv.isNothing)(s))return null
const a=new S2(s),c=o?"":e.loc.string("InfoList.Copyright")
return new b2(c,[a])}function el(e,t,n,r,o,i){const s=Bt(e,t),a=Ut(e,TP)
if(!s||!a)return null
const c=o?"":e.loc.string("Annotations.ExternalPurchases.Title"),l=e.loc.string("YES")
let u
if((0,Cv.isSome)(e.bag.externalPurchasesProductPageAnnotationVariant)){const t=`Annotations.ExternalPurchases.Expanded.Variant${e.bag.externalPurchasesProductPageAnnotationVariant}`
u=e.loc.string(t)}else u=e.loc.string("Annotations.ExternalPurchases.Expanded")
const d=new S2(u),f=e.loc.string("Annotations.ExternalPurchases.Expanded.LearnMore")
let p=Gt(e,f,i.metricsPageInformation,i.locationTracker)
return new b2(c,[d],l,null!=p?p:void 0)}function tl(e,t,n,r,i,s){var a
if(!function(e,t){var n
const r=Id(e,t),o=new Set(["uses-non-webkit-browser-engine","is-custom-browser-engine-app"])
return null!==(n=null==r?void 0:r.some(e=>o.has(e)))&&void 0!==n&&n}(e,t))return null
const c=null!==(a=function(e,t,n){const r=e.bag.externalBrowserLearnMoreEditorialItemId
if(o(r))return null
const i=new dY(XV)
return i.title=e.loc.string(q$),i.pageUrl=`https://apps.apple.com/story/id${r}`,sp(e,i,{id:LN,targetType:uH,actionType:UH,pageInformation:t,locationTracker:n}),i}(e,s.metricsPageInformation,s.locationTracker))&&void 0!==a?a:void 0
let l=c
const u=i?"":e.loc.string("Annotations.ExternalBrowser.Title"),d=e.loc.string("Annotations.ExternalBrowser.Value.Summary"),f=e.loc.string("Annotations.ExternalBrowser.Value.Expanded"),p=[new S2(f)]
return new b2(u,p,d,l)}function nl(e,t,n,r,o,i){const s=(0,Yv.attributeAsDictionary)(t,"licenses.gameLicenseVietnam"),a=[il(e.loc.string("InfoList.GameLicense.Disclaimer"))],c=(0,Yv.asString)(s,"licenseId")
if(!(0,kv.isSome)(c)||!Ar(c))return null
a.push(rl(),ol(e.loc.string("InfoList.GameLicense.Id.Title")),il(c))
const l=(0,Yv.asString)(s,"licenseUrl");(0,kv.isSome)(l)&&Ar(l)&&a.push(rl(),ol(e.loc.string("InfoList.GameLicense.Url.Title")),function(e){const t={}
return t[e]=new MW(e,!1),{$kind:qU,linkableText:new BY(new Dq(e),t)}}(l))
const u=o?"":e.loc.string("InfoList.GameLicense.Title"),d=new b2(u,[],c)
return d.items_V3=a,d}function rl(){return{$kind:AF}}function ol(e){return{$kind:qU,linkableText:new BY(new Dq(`**${e}**`))}}function il(e){return{$kind:qU,linkableText:new BY(new Dq(e))}}function sl(e,t,n,r,o,i){return null}function al(e,t,n,r,s,a){var c
const l=Ue(e,t,"languageList")
if(o(l))return null
const u=l.length
if(u<1)return null
let d,f
switch(u){case 0:break
case 1:f=l[0]
break
case 2:f=e.loc.string("InfoList.Two.Languages.Summary").replace("{first}",l[0]).replace("{second}",l[1])
break
default:const t=u-1
d=e.loc.string("InfoList.More.Languages.Summary").replace("{language}",l[0]).replace(tR,e.loc.formattedCount(t)),f=null!==(c=function(e,t){if(null==e||null==t)return null
if(0===e.length)return""
let n=e.length,r=""
return e.forEach((e,o)=>{null===e?n-=1:(r+=e,o<n-1&&(r+=t))}),r}(l,e.loc.string("Conjunction.Separator")))&&void 0!==c?c:void 0}if(!i(f))return null
const p=new S2(f),h=s?"":e.loc.string("Supported.Languages")
return new b2(h,[p],d)}function cl(e,t,n,r,o,i){if(!ae(t,"usesLocationBackgroundMode"))return null
const s=o?"":e.loc.string("InfoList.Location.Title"),a=e.loc.string("InfoList.Location.Description"),c=new S2(a)
return new b2(s,[c])}function ll(e,t){const n={...t,id:`id${t.id}`}
return t.platform?C2(e,n):O2(e,n)}function ul(e){var t
return{platform:null===(t=e.activeIntent)||void 0===t?void 0:t.previewPlatform}}function dl(e,t){var n
return(null===(n=e.activeIntent)||void 0===n?void 0:n.previewPlatform)?t.addingQuery("previewPlatform",e.activeIntent.platform).addingQuery(KG,JG):t}function fl(e,t,n){return Iv.context("capabilitiesFromData",()=>[pl(e,t),hl(e,t),yl(e,t),wl(e,t),gl(e,t),vl(e,t,n),null,ml(e,t)].filter(e=>e))}function pl(e,t){if(!(0,kv.isSome)(t)||!Ve(e,t,rN))return null
if(e.bag.gameCenterExtendSupportedFeatures){const n=function(e){var t
if(!(0,Cv.isNothing)(e))return null!==(t=Ce(e,"supportedGameCenterFeaturesFromData",()=>{const t=[],n=l(e,"attributes.supportedGameCenterFeatures")
return n.includes(fH)&&t.push(fH),n.includes(Tj)&&t.push(Tj),n.includes(bj)&&t.push(bj),n.includes(B$)&&t.push(B$),t}))&&void 0!==t?t:void 0}(t),r=null==n?void 0:n.includes(bj),o=null==n?void 0:n.includes(fH)
let i
i=r&&o?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ALL_FEATURES"):r?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_LEADERBOARDS"):o?e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_ONLY_ACHIEVEMENTS"):e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION_NO_FEATURES")
const s=e.loc.string(qA),a=Se(e,WA,46,45)
if(e.featureFlags.isGSEUIEnabled(VD)){let n
n=(0,kv.isSome)(t)&&e.clientCapabilities.isEnabled("gameProductIdOpenGamesUIAction")?pp(0,{gamePage:{productID:t.id}}):pp()
const r=e.loc.string("ProductPage.Capability.GameCenter.ActionTitle")
i=`${i}\n${r}`
const o=new Dq(i),c={}
c[r]=n
const l=new BY(o,c),u=Se(e,"systemimage://arrow.up.forward.square.fill",16,16)
return new AY(ij,s,l,u,void 0,a)}{const e=new Dq(i),t=new BY(e)
return new AY(ij,s,t,null,null,a)}}{const t=e.loc.string(qA),n=new Dq(e.loc.string("CAPABILITY_GAME_CENTER_EXPLANATION")),r=new BY(n),o=Se(e,WA,46,45)
return new AY(ij,t,r,void 0,null,o)}}function hl(e,t){if(!Ve(e,t,"isSiriSupported"))return null
const n=e.loc.string("CAPABILITY_SIRI_TITLE"),r=new Dq(e.loc.string("CAPABILITY_SIRI_EXPLANATION")),o=new BY(r),i=Se(e,"resource://ProductCapabilitySiri",46,45)
return new AY(sO,n,o,void 0,null,i)}function wl(e,t){if(!Ve(e,t,"supportsPassbook"))return null
const n=e.loc.string("CAPABILITY_WALLET_TITLE"),r=new Dq(e.loc.string("CAPABILITY_WALLET_EXPLANATION")),o=new BY(r),i=Se(e,"resource://ProductCapabilityWallet",46,45)
return new AY("wallet",n,o,void 0,null,i)}function gl(e,t){if(!Dt(e,t))return null
const n=e.loc.string("CAPABILITY_MFI_CONTROLLERS_TITLE")
let r=null
const o=e.bag.gameControllerLearnMoreEditorialItemId
if(Rt(e,e.bag.gameControllerRecommendedRolloutRate)&&(0,kv.isSome)(o)&&(null==o?void 0:o.length)>0){const t=Ir({...Cr(e),...ul(e),id:o})
r=new dY(XV),r.title=e.loc.string("ProductPage.Capability.GameController.ActionTitle"),r.pageUrl=ll(e,t)}let i=r?e.loc.string("ProductPage.Capability.GameController.Explanation.v2.WithNewlineActionTemplate"):e.loc.string("ProductPage.Capability.GameController.Explanation.v2")
const s={};(null==r?void 0:r.title)&&(i=i.replace(nG,r.title),s[r.title]=r)
const a=new Dq(i),c=new BY(a,s),l=Se(e,"resource://ProductCapabilityController",46,45)
return new AY("controllers",n,c,void 0,null,l)}function vl(e,t,n){const r=ie(t,"familyShareEnabledDate")
if(!r||ae(t,DB))return null
const o=new Date(r),i=new Date
if(!o||o>i)return null
const s=Ve(e,t,aO),a=s&&Ve(e,t,"hasFamilyShareableInAppPurchases")
let c=null
const l=e.bag.familySubscriptionsLearnMoreEditorialItemId
if((0,kv.isSome)(l)&&(null==l?void 0:l.length)>0&&a){const t=Ir({...Cr(e),...ul(e),id:l})
c=new dY(XV),c.title=e.loc.string("CAPABILITY_FAMILY_SHARING_ACTION_TITLE"),c.pageUrl=ll(e,t)}const u=e.loc.string("CAPABILITY_FAMILY_SHARING_TITLE")
let d
if(a?d=c?"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_SOME_SHAREABLE_IAPS_EXPLANATION":s||n||(d=c?"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION_WITH_ACTION_TEMPLATE":"CAPABILITY_FAMILY_SHARING_PAID_APP_NO_IAPS_EXPLANATION"),!d)return null
let f=e.loc.string(d)
const p={};(null==c?void 0:c.title)&&(f=f.replace(nG,c.title),p[c.title]=c)
const h=new Dq(f),w=new BY(h,p),g=Se(e,"resource://ProductCapabilityFamilySharing",46,45)
return new AY(KD,u,w,void 0,c,g)}function ml(e,t){if(!Ve(e,t,"hasSafariExtension"))return null
const n=e.loc.string("CAPABILITY_SAFARI_EXTENSION_TITLE"),r=new Dq(e.loc.string("CAPABILITY_SAFARI_EXTENSION_EXPLANATION")),o=new BY(r),i=Se(e,"resource://ProductCapabilitySafariExtension",129,129)
return new AY(zA,n,o,void 0,null,i)}function yl(e,t){if(!Ve(e,t,gk))return null
const n=e.loc.string("CAPABILITY_SHAREPLAY_TITLE"),r=new Dq(e.loc.string("CAPABILITY_SHAREPLAY_EXPLANATION")),o=new BY(r),i=Se(e,"systemimage://shareplay"),s=Z(cO)
return new AY("sharePlay",n,o,void 0,null,i,s)}function Al(e,t,n,r,o,i){if(r)return null
const s=Ge(e,t,"seller"),a=Be(e,t,zF),c=Be(e,t,Fk),l=e.bag.enableSellerICPAnnotation&&!0
if((0,kv.isNothing)(s))return null
const u=Ge(e,t,"sellerLabel")||e.loc.string(OP)
let d,p=[]
const h=f(a,GH),w=(0,kv.isSome)(h)&&(null==h?void 0:h.length)>0?h:s,g=o?"":u
let m=null
if((0,kv.isSome)(a)){const[t,n]=function(e,t){const n=[],r={name:"ProductPage.SellerInfo.Name.Title",dunsNumber:"ProductPage.SellerInfo.DunsNumber.Title",address:"ProductPage.SellerInfo.Address.Title",brn:"ProductPage.SellerInfo.BusinessRegistrationNumber.Title",phoneNumber:"ProductPage.SellerInfo.PhoneNumber.Title",email:"ProductPage.SellerInfo.Email.Title",usci:"ProductPage.SellerInfo.UnifiedSocialCreditIdentifier.Title"},o=f(t,GH),i=(0,kv.isSome)(o)&&(null==o?void 0:o.length)>0?o:e.loc.string(OP),s=(0,kv.isSome)(f(t,EP))
if(s){const r=v(t,EP),o=r?"ProductPage.SellerInfo.VerifiedSeller.Subtitle":"ProductPage.SellerInfo.UnverifiedSeller.Subtitle"
if(n.push(new S2(e.loc.string(o).replace("{seller}",i))),!r)return[n,i]}let a=null
1!==Object.keys(t).length||Object.keys(t).includes(GH)||(a=e.loc.string("ProductPage.SellerInfo.SeeDetails.Title"))
for(const[o,i]of Object.entries(r)){if(o===GH&&s)continue
const r=Tl(e,o,e.loc.string(i),t);(0,kv.isSome)(r)&&n.push(r)}return[n,a]}(e,a)
m=n,p=p.concat(t)}if(l&&(0,kv.isSome)(c)){const t=Tl(e,"filingNumber",e.loc.string("ProductPage.Info.ICPNumber.Title"),c)
if(0===p.length){const e=new S2(w)
p.push(e)}(0,kv.isSome)(t)&&p.push(t)}if(p.length>0)(0,kv.isNothing)(m)&&(m=p.length>1?w:void 0),d=new b2(g,p,m,void 0)
else{const e=new S2(s)
d=new b2(g,[e])}return(0,kv.isSome)(d),d}function Tl(e,t,n,r){let o=f(r,t)
return(0,kv.isSome)(o)?("brn"===t&&(o=o+"\n"+e.loc.string("ProductPage.SellerInfo.BusinessRegistrationNumber.Subtitle")),new S2(o,{heading:n})):null}function bl(e,t,n,o,s,a){const c=Ld(e,t)
if(n||r(c)||r(c.fileSizeByDevice))return null
const l=e.loc.fileSize(c.fileSizeByDevice),u=s?"":e.loc.string("File.Size")
let d,f=c.fileSizeByDevice
if(i(c.maxEssentialInstallSizeInBytes)){const t=c.fileSizeByDevice+c.maxEssentialInstallSizeInBytes,n=e.loc.string(yR).replace(AR,e.loc.fileSize(t)),r=new S2(n)
d=new b2(u,[r],void 0)}else if(i(c.maxInstallSizeInBytes)){const t=[],n=new S2(l,{heading:e.loc.string("Initial.App.Size")})
t.push(n)
const r=e.loc.string(yR).replace(AR,e.loc.fileSize(c.maxInstallSizeInBytes)),o=new S2(r,{heading:e.loc.string("Additional.Content.After.App.Install")})
t.push(o),f+=c.maxInstallSizeInBytes
const i=e.loc.string(yR).replace(AR,e.loc.fileSize(f))
d=new b2(u,t,i)}else{const e=new S2(l)
d=new b2(u,[e],void 0)}return d}function Sl(e,t,n,r,o,i){return null}function Pl(e,t,n,r,o,i){const s=Te(t,y_)
if((0,kv.isNothing)(s)||yr(s))return null
const a=[],c=[]
for(const t of s){const n=ie(t,GH)
if((0,kv.isNothing)(n))continue
const r=jt(e,t)
if((0,kv.isNothing)(r))continue
const o=f(r,_U)
if((0,kv.isNothing)(o))continue
const i=f(r,BB),s=p(r,UB)
let l=e.loc.string("InfoList.IAP.Duration")
if((0,kv.isSome)(i)){l=l.replace("{name}",n)
const t=Pi(0,i,s)
let r
switch(null==t?void 0:t.type){case"D":r="days"
break
case"W":r="weeks"
break
case"M":r="months"
break
case"Y":r="years"
break
default:l=`${n}`}if((0,kv.isSome)(r)&&(0,kv.isSome)(t)){const n=e.loc.formatDuration(t.periodDuration,r);(0,kv.isSome)(n)&&(l=l.replace("{duration}",n))}}else l=`${n}`
a.push([l,o]),c.push({$kind:AP,leadingText:l,trailingText:o})}const l=e.loc.string("ProductPage.Info.InAppPurchases.LearnMore"),u=function(e,t){const n=e.bag.inAppPurchasesLearnMoreEditorialItemId
if((0,kv.isNothing)(n)||yr(n))return null
const r=new dY(XV)
return r.title=t,r.pageUrl=`https://apps.apple.com/story/id${e.bag.inAppPurchasesLearnMoreEditorialItemId}`,r}(e,l)
if((0,kv.isSome)(u)){c.push({$kind:AF,size:OV})
const e={}
e[l]=u,c.push({$kind:qU,linkableText:new BY(new Dq(l),e)})}const d=o?"":e.loc.string("InfoList.InAppPurchases"),h=[new S2(void 0,{textPairs:a})],w=new b2(d,h,e.loc.string("YES"))
return w.items_V3=c,w}function Il(e,t,n,r,o,i,s,a){const c=[]
for(const l of t){const t=l(e,n,r,o,i,s);(0,kv.isSome)(t)&&(0===t.items_V3.length&&(t.items_V3=Cl(0,t)),t.expandAction=void 0,c.push(t),a&&a(l,t,c.length-1))}return c}function Cl(e,t){const n=[]
for(const e of t.items){if(n.length>0&&n.push({$kind:AF}),(0,kv.isSome)(e.headingArtworks))for(const t of e.headingArtworks)n.push({$kind:_H,artwork:t})
let t=""
if((0,kv.isSome)(e.heading)&&(t+=`**${e.heading}**`),(0,kv.isSome)(e.text)&&(t.length>0&&(t+="\n"),t+=e.text),(0,kv.isSome)(e.listText)&&(t.length>0&&(t+="\n"),t+=e.listText),t.length>0&&n.push({$kind:qU,linkableText:new BY(new Dq(t,Yx))}),(0,kv.isSome)(e.textPairs))for(const t of e.textPairs)n.push({$kind:AP,leadingText:t[0],trailingText:t[1]})}return(0,kv.isSome)(t.linkAction)&&n.push({$kind:NH,action:t.linkAction}),n}function kl(e,t){const n=Be(e,t,Fk),r=e.bag.enableSellerICPAnnotation&&(0,kv.isSome)(n),o=Be(e,t,zF),i=e.bag.enableSellerInfo&&(0,kv.isSome)(o)
return r||i}function Ol(e,t,n,r){const o=new oJ(lP)
o.isHorizontal=!0
let i=null
i=n?t.slice(0,8):t
const a=[]
for(let t=0;t<i.length;t++){const n=i[t]
if(n.action=new HW({player:{playerID:n.playerId}}),s(r)){const o="friendPlayer",i={pageInformation:r.destinationPageInformation,locationTracker:r.sourceLocationTracker,id:"",idType:YV,anonymizationOptions:{anonymizationString:`FRIEND${t+1}`}}
if(Bf(e,n,{...i,kind:o,title:"",softwareType:null}),e.bag.productPageFriendsPlayingClickEventsEnabled){const t={...i,kind:o,targetType:cH,actionType:UH,softwareType:null}
sp(e,n.action,t)}}a.push(n),s(r)&&xf(r.sourceLocationTracker)}if(o.items=a,o.mergeWhenFetched=!0,o.isHidden=0===o.items.length,o.batchGroup=ij,n&&t.length>8){const n=new oJ("smallGameCenterPlayer")
n.title=e.loc.stringWithCount("ProductPage.FriendsPlaying.SeeAllTitle",t.length),n.items=t.map(e=>(e.action=new pz(e.playerId),e)),n.rowsPerColumn=1
const i=new lJ([n])
i.title=null==r?void 0:r.title
const s=new dY(jH)
s.title=e.loc.string(Oj),s.pageData=i,o.seeAllAction=s}return s(r)&&Bf(e,o,{id:"",kind:null,softwareType:null,targetType:jV,title:r.title,pageInformation:r.sourcePageInformation,locationTracker:r.sourceLocationTracker,idType:YV,badges:{gameCenter:!0}}),o.footerTitle=e.loc.string(EM),o.footerAction=pp(0,{friends:{}}),o.footerStyle={$kind:mV,bundleID:sF,width:16,height:16},o}function El(e,t,n,i){return Iv.context("inAppPurchasesShelf",()=>{if(!function(e,t){return t!==yj&&!e.client.isCompanionVisionApp}(e,e.host.platform))return null
if(o(t))return null
let a
if(a=Fi(e)?me(t,xk):ve(t,b_),!a||!a.data.length)return null
if(!a.data.filter(function(e){return ae(e,ux)===i.isForSubscriptions}).length)return null
const c={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:jV,id:`${n.getSequenceId()}`,idType:YV},l=se(t,VV)
let u=pV
l&&(u=kN)
const d=JF,f=new oJ(d)
let p=null
i.options&&(p=i.options.spotlightInAppProductIdentifier),function(e,t,n){const o=SH
for(const e of n.data){let n=ve(e,o)
n||(n={data:[t]}),r(e.relationships)&&(e.relationships={}),e.relationships[o]=n}}(0,t,a)
const h=[],w=function(e,t,n,r,o,i){const s=Gu(e,t,{lockupOptions:{metricsOptions:r,offerStyle:n,skipDefaultClickAction:!0,artworkUseCase:1},contentUnavailable:function(e,t){return h.push(t),!1}})
return o&&Rp(0,o,s),s}(e,a.data,u,c,p).filter(function(e){return e.productIdentifier===p&&(i.options.spotlightSection=new c0(VH,i.isForSubscriptions?dG:uG)),e.isSubscription===i.isForSubscriptions})
if(0===w.length&&0===h.length)return null
if(f.items=w,s(h)){const r=new B4(t.id,h,f.title,!1,void 0,d,u,null)
r.appBundleId=Ge(e,t,zV),r.iapShelfContext=i,i.isForSubscriptions?r.inAppShelfId=dG:r.inAppShelfId=uG,f.url=Cp(0,r,n)}let g
return i.isForSubscriptions?(f.title=e.loc.string("ProductPage.Section.Subscriptions.Title","Subscriptions"),g="subscription"):(f.title=e.loc.string("ProductPage.Section.InAppPurchases.Title"),g="iAP"),kf(e,c,f.title),Ef(n.locationTracker),xf(n.locationTracker),f.isHorizontal=!0,n.addImpressionsToShelf(e,f,g),f})}function Rl(e,t,n,r,s,a){return Iv.context(jU,()=>o(t)?null:function(e,t,n,r,o){return Iv.context("standardLinksShelf",()=>{const s=new oJ("productPageLink"),{metricsPageInformation:a,locationTracker:c}=n,l=[]
if(e.client.deviceType!==$H){const n=Ge(e,t,m_)
if(n){const t=new MW(n,!1),r=e.loc.string("DEVELOPER_WEBSITE")
l.push(new UY(r,t,"safari"))}}const u=Ge(e,t,x$)
if(u){const t=new MW(u,!1),n=e.loc.string(nL)
l.push(new UY(n,t,"hand.raised.fill"))}if(se(t,uP)){const n=function(e,t){const n=t.id,r=t.type
return i(t)&&i(n)&&i(r)?`${Oz}:/${_z.eula}?resourceType=${r}&resourceId=${n}`:null}(0,t)
if(n){const t=new dY(jH)
t.pageUrl=n
const r=e.loc.string(t$)
l.push(new UY(r,t,"doc.plaintext"))}}const d=f(Be(e,t,zF),uR)
if((null==d?void 0:d.length)>0){const t=new MW(d,!1),n=e.loc.string(rL)
l.push(new UY(n,t,"checkmark.seal"))}const p=e.bag.productPageReportProblemSADSubscriptionArray,h=t.id,w=p.includes(h),g=gt(e).isSystemAppFromData(t),v=t.type===IH,m=r&&!g,y=e.bag.productPageReportProblemSecondPartyAppArray.includes(h)
if(!v&&!y&&!o&&e.bag.reportProblemEnabled&&(w||m)){const n=function(e,t){const n=t.id,r=e.bag.productPageReportProblemURL
return i(n)&&i(r)?r.replace("{productId}",n):null}(e,t)
if((null==n?void 0:n.length)>0){const t=new MW(n,!1),r=e.loc.string(dT),o=new UY(r,t,"exclamationmark.triangle",w?null:h)
l.push(o)}}return l&&l.length>0&&(s.items=l),n.addImpressionsToShelf(e,s,aF),s})}(e,t,n,r,a))}function Dl(e,t,n,i){const s=Ru(e,t)
if(o(s))return null
const a=e.loc.string("BADGE_CATEGORY_HEADING"),c=new AK(_H,AG,{},LH,a,s,null,s,a,pV)
if(new dY(jH).title=ie(t,Cj),n&&"tv"!==e.client.deviceType){const n=Yn(e,t,!0)
if(r(n))return null
c.artwork=Fc(e,n,"bb")}return c}function _l(e,t,n,r){const o=Be(e,t,KE)
if(o){const t=Ud(0,e.host.clientIdentifier)
if(t){const n=h(o,t)
if(n){const t=p(n,Sx),r=f(n,HS),o=f(n,Xj),i=f(n,$V),s=e.loc.string("BADGE_CHART_POSITION_HEADING"),a=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_CHART_POSITION_TITLE").replace("{chartPosition}",t.toString()),c=new AK(Jx,Jx,{position:e.loc.decimal(t)},LH,s,r,null,a,r,zG),l=Bd(e,o,i)
if((0,Cv.isSome)(l)){const e=new dY(HB)
e.pageUrl=l,c.clickAction=e}return c}}}return null}function xl(e,t,n,r){var o
return null!==(o=function(e,t,n,r){const o=kt(0,t)
if((0,kv.isNothing)(o))return null
let i
i=n?function(e,t){const n=oe(t,aA)
for(const e of n)if("IAC"===f(e,rV))return!0
return!1}(0,t)?e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon.InAppControls"):e.loc.string("ProductPage.Badge.AgeRating.Caption.Ribbon"):e.loc.string("ProductPage.Badge.AgeRating.Caption")
const s=e.loc.string("ProductPage.Badge.AgeRating.Heading"),a=e.loc.string("ProductPage.Badge.AgeRating.AX.Caption"),c=Et(e,t),l=(0,kv.isSome)(c)?_H:aB,u=new AK(l,aB,{contentRating:o},LH,s,i,void 0,o,a,zG)
return(0,kv.isSome)(c)&&(u.isMonochrome=!1,u.artwork=Se(e,Pe(c),26,26)),u}(e,t,n))&&void 0!==o?o:function(e,t,n,r){const o=ie(t,iA)
if((0,kv.isNothing)(o))return null
const i={contentRating:o},s=ce(t,"contentRatingsBySystem.appsBrazil.rank"),a=Vd(0,null!=s?s:void 0)
let c
a&&(i.contentRatingResource=a),c=n?e.loc.string(qS):e.loc.string(WS)
const l=e.loc.string("BADGE_AGE_RATING_HEADING"),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_AGE_RATING_TITLE")
return new AK(aB,aB,i,LH,l,c,void 0,o,u,zG)}(e,t,n)}function Ll(e,t,n,r){return function(e,t,n,r){if(_t(e,t)){let t,n
t=e.loc.string(Kx),n=e.loc.string("ProductPage.Badge.GameController.Recommended")
const r=new AK($l(e),ZM,{},LH,t,n,void 0,void 0,n,zG)
return r.artwork=Fl(e),r.clickAction=ou(e)?new yz(GV):new sz(new TK(VH,GV)),r}return null}(e,t)}function Ml(e,t,n,r){return function(e,t,n,r){if(!Dt(e,t)||function(e,t){switch(xt(e,t)){case FL:case YD:case zD:return!0
default:return!1}}(e,t)||_t(e,t)||function(e,t){return"REQUIRED"===Lt(e)}(e))return null
{let t,n
t=e.loc.string(Kx),n=e.loc.string(yN)
const r=new AK($l(e),ZM,{},LH,t,n,void 0,void 0,n,zG)
return r.artwork=Fl(e),r.clickAction=ou(e)?new yz(GV):new sz(new TK(VH,GV)),r}}(e,t)}function $l(e){return e.clientCapabilities.isEnabled("artworkControllerBadge")?_H:ZM}function Fl(e){const t=Se(e,yF)
return t.imageScale=OV,t}function Nl(e,t,n,o){const s=ye(e,t,cV),a=e.loc.string("BADGE_DEVELOPER_HEADING"),c=ie(t,Cj),l=new AK(_H,cV,{},LH,a,c,null,c,a,pV)
if(n&&"tv"!==e.client.deviceType){const t=Yn(e,s,!0)
r(t)?l.artwork=Se(e,Zx,26,26):l.artwork=Fc(e,t)}const u=Nd(0,s)
if(i(u)){const n=new dY(jH)
n.title=ie(t,Cj),n.pageUrl=u,s&&(n.destination=function({id:e,...t}){return{...t,id:At(e),$kind:x2}}({...Cr(e),id:s.id})),sp(e,n,{targetType:IV,id:s.id,actionType:UH,pageInformation:o.pageInformation,locationTracker:o.locationTracker}),l.clickAction=n}return l}function Bl(e,t,n,r){const o=Be(e,t,tU)
if(o){const r=f(o,cx)
if(r&&r===lx){let r,o
r="Games"===oe(t,qO)[0]?e.loc.string("EDITORIAL_BADGE_GAMES"):e.loc.string("EDITORIAL_BADGE_APPS"),o=n?e.loc.string("EDITORS_CHOICE_RIBBON_HEADING"):e.loc.string("EDITORS_CHOICE_SINGLE_LINE")
const i=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_EDITORS_CHOICE"),s=new AK(fV,fV,{},LH,o,r,null,i,r)
return ou(e)?s.clickAction=new yz(fV):s.clickAction=new sz(new TK(VH,pH)),s}}return null}function Ul(e,t,r,o){const i=Ue(e,t,"supportedLocales"),s=(a=i).length<=0?null:{tag:f(n(a,"0.tag")).split("-")[0].toUpperCase(),name:f(n(a,"0.name"))}
var a
if(!s)return null
const c={paragraphText:s.tag}
let l
const u=i.length-1
l=u>0?e.loc.stringWithCount("ProductPage.Badge.Language.Caption",u).replace("{number_other_languages}",e.loc.formattedCount(u)):s.name
const d=e.loc.string("BADGE_LANGUAGE_HEADING")
return new AK(fG,KM,c,LH,d,l,null,null,l,zG)}function Gl(e,t,n,r){const o=He(e,t,MF),s=He(e,t,$F)
if(!i(o)||!i(s))return null
if(o<=0||s<=0||o>s)return null
const a=e.loc.string(zS),c=Vl(e,o,s,!1),l=Vl(e,o,s,!0),u=e.loc.string(zS),d={paragraphText:jl(e,o,s)}
return new AK(fG,Bj,d,LH,a,c,null,l,u,zG)}function jl(e,t,n){return t===n?t<=32?e.loc.formattedCount(t):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MIN_AND_MAX_LIMIT").replace(QE,e.loc.formattedCount(32)):n<=32?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_DEFINITE_LIMIT").replace(QE,e.loc.formattedCount(t)).replace(YS,e.loc.formattedCount(n)):e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER_INDEFINITE_MAX_LIMIT").replace(QE,e.loc.formattedCount(t)).replace(YS,e.loc.formattedCount(32))}function Vl(e,t,n,r){return 1===t&&1===n?e.loc.string("BADGE_PLAYERS_CAPTION_SINGLE"):1===t||r?e.loc.string("BADGE_PLAYERS_CAPTION_MULTIPLAYER"):e.loc.string("BADGE_PLAYERS_CAPTION_REQUIRED")}function Hl(e,t,n,r){const o=ne(t,AN)
let i=null
const s=Os(e,t)
if(!s&&o&&o.value&&o.ratingCount){const t=p(o,eR),n=Math.round(10*t)/10,r=e.loc.decimal(n,1),s=p(o,$S),a=e.loc.formattedCount(s)
let c
c=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.ShortTemplate",s).replace(tR,a)
const l=e.loc.stringWithCount("ProductPage.BadgeRating.Caption.LongTemplate",s).replace(tR,a).replace("{rating}",r),u=e.loc.string("PRODUCT_ACCESSIBILITY_BADGE_STAR_RATING").replace("{starCount}",r)
i=new AK(HU,HU,{rating:n,ratingFormatted:r},LH,c,c,l,u,c)}else{if(n)return null
const t=e.loc.string(JS)
if(s&&t!==JS)i=new AK(HU,HU,{},LH,null,t,null,t)
else if(!s){const t=e.loc.string("BADGE_NOT_ENOUGH_RATINGS_CAPTION")
i=new AK(HU,HU,{},LH,null,t,null,t)}}if(i){let t
return t=new yz(aV),i.clickAction=ou(e)?t:new sz(new TK(VH,pH)),i}return null}function ql(e,t,n,r){if((0,kv.isSome)(ne(t,zj)))return null
const o=ce(t,"contentRatingsBySystem.appsAustralia.rank"),i=ie(t,"contentRatingsBySystem.appsAustralia.name")
if((0,kv.isSome)(o)&&(0,kv.isSome)(i))return Wl(e,n,"AU",o,i,!1)
const s=ce(t,"contentRatingsBySystem.appsFrance.rank"),a=ie(t,"contentRatingsBySystem.appsFrance.name")
if((0,kv.isSome)(s)&&(0,kv.isSome)(a))return Wl(e,n,"FR",s,a,!1)
const c=ce(t,"contentRatingsBySystem.appsKorea.rank"),l=ie(t,"contentRatingsBySystem.appsKorea.name")
return(0,kv.isSome)(c)&&(0,kv.isSome)(l)?Wl(e,n,"KR",c,l,!0):null}function Wl(e,t,n,r,o,i){const s=null===(c=Gd(0,r))||void 0===c?void 0:c[0],a=Vd(0,r)
var c
if((0,kv.isNothing)(a)||(0,kv.isNothing)(s))return null
const l=_H,u=KS,d={contentRating:s},f=LH,p=e.loc.string(`ProductPage.Badge.AgeRating.${n}.Heading`)
let h,w
h=t?e.loc.string(qS):e.loc.string(WS),w=o
const g=e.loc.string(`ProductPage.Badge.AgeRating.${n}.AX.Caption`),v=new AK(l,u,d,f,p,h,void 0,w,g,zG)
return v.isMonochrome=!i,v.artwork=Se(e,`resource://${a}`,26,26),v}function zl(e,t,n,r){return t?Iv.context("badgesFromLookupResponse",()=>{let o,i=!1
return ae(t,VV)?o=L2:n?(o=$2,-1===o.indexOf(Bl)&&o.splice(1,0,Bl),i=!0):o=M2,function(e,t,n,r,o,i){const s=[]
for(const o of t){const t=o(e,n,r,i)
t&&s.push(t)}if(o&&s.some(e=>e.key===Jx)){const e=s.findIndex(e=>e.key===AG)
e>=0&&s.splice(e,1)}return s}(e,o,t,n,i,r)}):[]}function Yl(e,t,n,r,o,i){return Iv.context(fP,()=>i?null:Gs(e,t.id,o,n,null))}function Jl(e,t){const n=f(t,JE)
if(n){const t=new MW(n,!1)
return t.title=e.loc.string(FS),t.artwork=Se(e,pk),t}return null}function Kl(e){var t
if((0,kv.isSome)(e)){const n=null!==(t=e.presentationHints)&&void 0!==t?t:{}
e.presentationHints={...n,isSeeAllContext:!0}}}function Zl(e,t,n,r,o){const i=`${Oz}:/${_z.product}/${_z.shelf}/`+kp(n,r,o),s=new oY(i)
return s.param(Hz.shelfRefreshType,eY),s.param(Hz.id,t),s.build()}function Ql(e){return e.featureFlags.isEnabled("mini_today_cards_product")}function Xl(e,t){return t?t.map(t=>eu(e,t,vP)):[]}function eu(e,t,n){return Iv.context("titledParagraphFromVersionHistoryEntry",()=>{let r=f(t,mP);(0,kv.isSome)(r)&&(r=r.trim())
const o=new xY(r,n),i=f(t,gR),s=e.loc.string("VERSION_STRING_TEMPLATE")
o.primarySubtitle=n===vP?i:s.replace("{version}",i)
const a=f(t,"releaseTimestamp")
if(a){const t=new Date(a)
o.secondarySubtitle=e.loc.relativeDate(t)}return o})}function tu(e,t,n,a,c,l=!1){return Iv.context("createProductPageFromResponse",()=>{var d
const h=j(e,t)
if(o(h))return null
h.type
const w=null==a?void 0:a[N4],g=j(e,w),v=s(g)?c:null,m=s(g)?null:c,y=function(e,t,n){var r
const o=j(e,t),s=o.type===IH
i(n)&&(n.iAdClickFields&&(t[JX]=JSON.stringify(n.iAdClickFields)),n.iAdLineItem&&(t[KX]=n.iAdLineItem))
const a=ci(e,s?XO:uj,o.id,t),c=new oY(a.pageUrl)
return null!==(r=null==n?void 0:n.webBrowser)&&void 0!==r&&r&&(c.param(eE,bb),c.removeParam(iR),a.pageUrl=c.build()),new m2(a,{rootPosition:0,locationStack:[]})}(e,t,n),T=nu(e,h,y,n,g,m,v,l)
y.metricsPageInformation.baseFields[Ix]=bf(e,h,T.lockup.icon,null==n?void 0:n.clientIdentifierOverride),(Dn(e,xV)||Dn(e,nV))&&(y.metricsPageInformation.iAdInfo=new QX(e,xV,QX.createInitialSlotInfos(e,xV,null,null)))
const S=md(e,h),P=null!==(d=null==n?void 0:n.webBrowser)&&void 0!==d&&d
P||ui(e,T,y.metricsPageInformation,t=>{const n=Pd(0,h,e.appleSilicon.isSupportEnabled),r=Dd(e,h,e.appleSilicon.isSupportEnabled,e.appleSilicon.isRosettaAvailable),o=Ed(e,h,S,e.client.deviceType,n,!1,r),i=_d(0,S,e.client.deviceType,n,!1),a=S&&(o||i),c=function(e,t,n,r){if(!Ku(e,t))return!1
if(vt(e,t,8838))return!1
const o=kd(0,n,Pd(0,t,r),!1),i=md(e,t)
return o.some(e=>Od(i,e))}(e,h,e.client.deviceType,e.appleSilicon.isSupportEnabled)
t[nR]=a&&c?"runnable":a?"purchasable":qV,s(m)&&SW.shared.addReferralContextToMetricsFieldsIfNecessary(t)},P)
const I=tr(t,!0)
return function(e,t,n,a,c,l,d){var h,w
const g=md(e,n),v=n.type===IH,m=se(n,VV),y=!(1===g.length&&g[0]===$H),T=Os(e,n),S=!!y&&!m&&!T,P=s(c)?c.clientIdentifierOverride:null,I=ae(n,DB),C=t.lockup.offerDisplayProperties,k=!i(C)||C.isFree
let O
if(v){const t=ve(n,BH)
O=function(e,t,n,r){return n?Iv.context("bundleChildrenShelf",()=>{const o=eH,i=new oJ(o)
i.isHorizontal=!0
const s=n.data.length
if(!s)return null
i.title=e.loc.stringWithCount("ProductPage.AppsInBundleShelf.Title",s)
const a=Op(e,n,r,1,o,null,76286,null,e.featureFlags.isEnabled(dR))
if(a.remainingItems.length){const e=new B4(t.id,a.remainingItems,i.title,!1,void 0,eH,pV,null)
e.isBundleShelf=!0,i.url=Cp(0,e,r)}return kf(e,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:jV,id:`${r.getSequenceId()}`,idType:YV},i.title),i.items=a.items,Ef(r.locationTracker),r.addImpressionsToShelf(e,i,kU),xf(r.locationTracker),i.rowsPerColumn=s<2?1:2,i}):null}(e,n,t,a)}O&&(t.shelfMapping[kU]=O)
const E=ve(n,IH),R=function(e,t,n,r){return n?Iv.context("bundleParentsShelf",()=>{const o=n.data.length
if(!o)return null
const i=eH,a=new oJ(i)
a.isHorizontal=!0,a.title=e.loc.string("ProductPage.Section.IncludedInBundles.Title")
const c=Op(e,n,r,1,i)
if(0===c.remainingItems.length&&0===c.items.length)return null
if(a.items=c.items,s(c.remainingItems)){const e=new B4(t.id,c.remainingItems,a.title,!1,void 0,i,pV,null)
e.isBundleShelf=!0,a.url=Cp(0,e,r)}return a.rowsPerColumn=o<2?1:2,r.addImpressionsToShelf(e,a,"bundleParent"),a}):null}(e,n,E,a)
R&&(t.shelfMapping[cU]=R)
const D={productTitle:t.title,shouldShowRatingsAndReviews:S,isFirstPartyHideableApp:I,isBundle:v,isPreorder:m},_=function(e,t,n,r,i){return Iv.context("createReviewsShelves",()=>{const a={}
if(o(t))return a
const c=function(e,t){if(ou(e))return!0
if(o(t))return!1
let n
return n=gt(e).isSystemAppFromData(t),!n||e.bag.enableSystemAppReviews}(e,t),l=md(e,t),d=ve(t,pH),h=V(d),w=ne(t,AN)
w.ratingAverage=p(w,eR),w.adamId=t.id,w.isBundle=r.isBundle,w.supportUrl=Ge(e,t,v_)
const g=sd(e,t,{useCase:2}),v=1===l.length&&"tv"===l[0],m=Qs(e),y=u(w,WE),A=function(e,t,n,r){return Iv.context("createProductRatings",()=>{const n=xs(e,e.client.guid,_j,t)
return n.ratingAverage>0&&n.ratingCounts||r||(n.status=e.loc.string(YE)),n})}(e,w,h.length,y),T=function(e,t,n,r,o,i){return Iv.context(fP,()=>{const r=Yl(e,t,n,0,o,i)
if(r){const e=new MK
return e.actionType=Mm,e.action=r,e.id="ProductReviewAction.TapToRate",e}return null})}(e,t,r.productTitle,0,r.isBundle,v),S=function(e,t,n,r,o,i,s){return Iv.context("createWriteAReview",()=>{if(r)return null
{const r=new $K
r.writeReviewAction=Vs(e,t,i,s,o),r.supportAction=Jl(e,n)
const a=new MK
return a.actionType="writeAReview",a.action=r,a}})}(e,t,w,v,g,i,r.productTitle),P=Iv.context(MS,()=>null),I=function(e,t,n){return Iv.context("createReviewSummaryProductReview",()=>{const r=Ls(e,t,n)
if((0,kv.isNothing)(r))return null
const o=new jK
return o.review=r,o.sourceType=CG,o})}(e,t,n),C=Ls(e,t,n),k=Ds(e,w,h,!0,P,I,n),O=Ds(e,w,h,!0,null,null,n)
if(function(e,t,n,r,o,i,s,a){Iv.context("createProductReviewActions",()=>{const c=new _K
return c.tapToRate=Yl(e,t,n,0,o,i),c.writeReviewAction=Vs(e,t,a,n,s),c.supportAction=Jl(e,r),c})}(e,t,r.productTitle,w,r.isBundle,v,g,i),v||0===h.length||Zs(e,e.client.guid,w,h,d.next,r.productTitle,g,!1,!1,t,n),r.shouldShowRatingsAndReviews){const o=new oJ(aV)
o.title=m,o.items=[A],a.ratingsShelf=o,n.addImpressionsToShelf(e,o,"ratingsOverview",null,null,null,e.loc.string("ProductPage.Section.Reviews.Title"))
const i=[]
if(s(T)&&c&&i.push(T),s(S)&&c&&i.push(S),s(i)){const e=new oJ(pR)
e.items=i,a.allReviewActionsShelf=e}if(s(C)){const e=new oJ(CG)
e.items=[C],a.reviewSummaryShelf=e}let l=null
s(T)&&c&&(l=new oJ(pR),l.items=[T],a.tapToRateActionsShelf=l)
let u=null
s(S)&&c&&(u=new oJ(pR),u.items=[S],a.writeAReviewActionsShelf=u)
const p=e.loc.string(hR),g=e.loc.string(JM),y=(0,kv.isSome)(O)&&O.length>0
let E,R
if((0,kv.isSome)(k)&&k.length>0&&(E=new oJ(EL),E.items=k,E.isHorizontal=!0,y?(E.title=p,E.contentsMetadata={type:"productReviewsSection",hasReviewSummary:(0,kv.isSome)(I),reviewSummaryTitle:g},n.addImpressionsToShelf(e,E,qE,null,null,null,e.loc.string(hR))):E.title=g,a.allProductReviewsShelf=E),y&&(R=new oJ(EL),R.items=O,R.isHorizontal=!0,R.title=p,n.addImpressionsToShelf(e,R,qE,null,null,null,e.loc.string(hR)),a.userProductReviewsShelf=R),"tv"===e.client.deviceType){const t=new oJ(wR)
t.title=m
const n=[]
s(T)&&T.action instanceof DK&&c&&n.push(T.action),s(A.status)?e.featureFlags.isEnabled(n$)?n.push(new UK(A.status)):n.push(Bs(A)):(n.push(Fs(A)),n.push(Ns(A))),t.items=n,a.purchasedRatingsAndReviewsComponentShelf=t}if("tv"===e.client.deviceType){const t=new oJ(wR)
t.title=m
const n=[]
s(A.status)?e.featureFlags.isEnabled(n$)?n.push(new UK(A.status)):n.push(Bs(A)):(n.push(Fs(A)),n.push(Ns(A))),t.items=n,a.notPurchasedRatingsAndReviewsComponentShelf=t}let D=null
s(P)&&(D=new oJ(EL),D.items=[P],r.shouldShowRatingsAndReviews?P.review.showsBadge||(D.title=e.loc.string(aP)):D.title=m,a.editorsChoiceProductReviewsShelf=D)
!v&&!(r.isBundle&&!1)&&h.length>0&&(a.ratingsShelf.seeAllAction=function(e,t,n,r,o,i=null,s,a,c){return r?Iv.context(VS,()=>{var t
const l=new kK
let u,d,p
if((0,kv.isSome)(null==c?void 0:c.allReviewActionsShelf)){u=b(c.allReviewActionsShelf)
const e=null!==(t=u.presentationHints)&&void 0!==t?t:{}
u.presentationHints={...e,displayIfReviewable:!0},Kl(u)}if((0,kv.isSome)(null==c?void 0:c.ratingsShelf)){d=b(c.ratingsShelf)
const e=d.items[0]
if((0,kv.isSome)(e)&&1===d.items.length){const t=b(e)
t.context=s_,d.items=[t]}d.seeAllAction=null,d.title=null,Kl(d)}(0,kv.isSome)(null==c?void 0:c.reviewSummaryShelf)&&(p=b(c.reviewSummaryShelf),Kl(p))
const h=Js(e,0,n,r,o,i,s,a,HE,{ratingsShelf:d,reviewSummaryShelf:p,reviewActionsShelf:u})
l.title=null,l.adamId=f(r,wj),l.nextPage=h.paginationToken,l.initialSortOptionIdentifier=h.initialSortId,l.sortActionSheetTitle=h.sortActionSheetTitle,l.sortOptions=h.sorts,(0,kv.isSome)(d)&&l.shelves.push(d),(0,kv.isSome)(p)&&l.shelves.push(p),(0,kv.isSome)(u)&&l.shelves.push(u),l.shelves.push(h.reviewsShelf)
const w=zs(e);(0,kv.isSome)(w)&&(l.trailingNavBarAction=w)
const g=new dY(pH)
return g.pageData=l,g.title=e.loc.string(Oj),g}):null}(e,e.client.guid,t.id,w,h,d.next,!1,!1,a))}return a})}(e,n,a,D,t.lockup.subtitle)
s(_)&&(t.shelfMapping[TB]=_.purchasedRatingsAndReviewsComponentShelf,t.shelfMapping[AB]=_.notPurchasedRatingsAndReviewsComponentShelf,t.shelfMapping[aV]=_.ratingsShelf,t.shelfMapping[XM]=_.allReviewActionsShelf,t.shelfMapping[vB]=_.allProductReviewsShelf,t.shelfMapping[iU]=_.userProductReviewsShelf,t.shelfMapping[fV]=function(e,t){const n=function(e,t){return Iv.context(MS,()=>{const n=f(Be(e,t,rj),LH)
if(n){const r=new xK(n),o=Be(e,t,tU)
if(o){const e=f(o,cx)
r.showsBadge=e&&e===lx}return r.showsBadge||(r.title=e.loc.string(iL)),r}return null})}(e,t)
if((0,Cv.isNothing)(n))return null
const r=new oJ(fV)
return r.items=[n],n.showsBadge?r.background={type:fV}:r.title=e.loc.string(aP),r}(e,n),t.shelfMapping[mB]=_.tapToRateActionsShelf,t.shelfMapping[yB]=_.writeAReviewActionsShelf,t.shelfMapping[e$]=_.productReviewsHeader)
{const n=function(e){if(o(e.bag.ratingsAndReviewsLearnMoreEditorialId))return null
const t=new oJ(qU),n=function(e){const t=e.loc.string(pP),n={},r=function(e){const t=e.bag.ratingsAndReviewsLearnMoreEditorialId
if(o(t))return null
const n=new dY(XV)
return n.title=e.loc.string(pP),n.pageUrl=`https://apps.apple.com/story/id${t}`,n}(e)
if((0,kv.isNothing)(r))return null
n[t]=r
let i=e.loc.string("ProductPage.RatingsAndReviews.Footer")
i=i.replace(nG,t)
const s=new Dq(i,mj)
return new BY(s,n)}(e)
return(0,kv.isNothing)(n)?null:(t.items=[n],t)}(e);(0,kv.isSome)(n)&&(t.shelfMapping[yG]=n)}const x=function(e,t,n){const r=Ls(e,t,n)
if((0,kv.isNothing)(r))return null
const o=new oJ(CG)
return o.items=[r],o}(e,n,a);(0,kv.isSome)(x)&&(t.shelfMapping[CG]=x)
const L=function(e,t,n,r){return Iv.context(jU,()=>function(e,t,n,r,o,i){return Iv.context("standardMostRecentVersionShelf",()=>{if(!n&&!r&&!o){const n=Ue(e,t,GN)
if(n.length>1&&Xl(e,n).length>0){const r=new oJ(gP)
r.title=e.loc.string(hP)
const o=eu(e,n[0],wP)
if(r.items=[o],i.addImpressionsToShelf(e,r,GN),r)return e.client.deviceType!==MH&&(r.seeAllAction=function(e,t,n,r){return Iv.context("versionHistorySeeAllAction",()=>{const o=function(e,t,n){return Iv.context("versionHistoryPageAction",()=>{const r=Xl(e,t)
let o
if(r.length>0){const t=new oJ(gP)
t.items=r
const i=new lJ([t])
i.title=e.loc.string("VERSION_HISTORY_PAGE_TITLE","Version History"),e.client.deviceType!==MH&&(i.presentationOptions=[FU])
const s=li(e,"VersionHistory",n,"")
ui(e,i,s)
const a=new dY(GN)
a.title=e.loc.string("ACTION_VERSION_HISTORY_SEE_ALL"),a.pageData=i,o=a}return o})}(e,t,n)
return ap(e,o,null,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),o})}(e,n,t.id,i)),r}}return null})}(e,t,r.isFirstPartyHideableApp,r.isBundle,r.isPreorder,n))}(e,n,a,{isFirstPartyHideableApp:I,isBundle:v,isPreorder:m})
L&&(t.shelfMapping[Pj]=L),t.shelfMapping[lU]=function(e,t,n){return Iv.context("textCardShelfFromResponse",()=>(o(t),null))}(0,n)
const M=Ge(e,n,zV)
if(e.bag.enablePrivacyNutritionLabels&&!wr(e,n.id)&&!gr(e,M)){const s=function(e,t,n,r){return Iv.context("privacyShelf",()=>{if(o(t))return null
const i=new oJ(NV)
i.title=e.loc.string(jx)
const s=_c(e,t,!1,!1,n,r)
return i.items=[s],e.client.deviceType!==MH&&"tv"!==e.client.deviceType&&(i.seeAllAction=$c(e,t,VU,n,r,null)),i})}(e,n,a.metricsPageInformation,a.locationTracker),c=function(e,t,n){return Iv.context(jU,()=>{if(o(t))return null
const r=ne(t,uM)
if((0,Cv.isNothing)(r)||o(r))return null
const i=new oJ(Hx),s=e.loc.string(jx)
kf(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:jE,id:`${n.getSequenceId()}`,idType:YV},s)
const a=Pc(e,r,t,_j,!0,n.metricsPageInformation,n.locationTracker)
return null===a||0===a.length?null:(i.items=a,a.length<=2&&(i.presentationHints={isLowDensity:!0}),i.title=s,n.addImpressionsToShelf(e,i,"appPrivacy"),Ef(n.locationTracker),xf(n.locationTracker),i.title=null,i)})}(e,n,a)
if(i(s)&&i(c)){t.shelfMapping[NV]=s,i(c)&&(t.shelfMapping[RV]=c)
const l=function(e,t,n,s){return Iv.context(jU,()=>{if(o(t))return null
const a=Mc(e,t,!1,VU,n,s)
if((1===a.length&&a[0].identifier===NE||0===a.length)&&"tv"!==e.client.deviceType)return null
const c=new oJ(TV),l=function(e,t,n,o){return Iv.context("privacyFooterFromData",()=>{const t=function(e,t,n,o){let i
const s=e.loc.string(BE),a={},c=xc(e,n,o)
r(c)?i=e.loc.string(UE):(i=e.loc.string(vS),i=i.replace(nG,s),r(c)?i=e.loc.string(UE):a[s]=c)
const l=new Dq(i,mj)
return new BY(l,a)}(e,0,n,o),s=function(e,t,n,r){if("tv"!==e.client.deviceType)return[]
const o=[],s=xc(e,n,r)
i(s)&&o.push(s)
const a=Lc(e,n,r)
return i(a)&&o.push(a),o}(e,0,n,o)
return new f2(t,s,[].length)})}(e,0,n,s)
return c.items=[l],c})}(e,n,a.metricsPageInformation,a.locationTracker)
i(l)&&(t.shelfMapping[TV]=l)}}const $=new v2,F=new v2,N=new v2,B=new v2,U=new v2,G=Jd(e,n),j=function(e,t,n,o,i,s,a,c){return Iv.context(jU,()=>{let l
switch(e.client.deviceType){case MH:l=function(e,t,n,o){return Iv.context(vR,()=>{let i
const s=kl(e,t)?R2:E2,a=Il(e,s,t,n,!1,!1,o,void 0)
return a.length>0&&(i=new oJ(pU),i.items=a,r(o)||o.addImpressionsToShelf(e,i,dH)),i})}(e,t,n,o)
break
case"tv":l=function(e,t,n,o,i,s,a){return Iv.context("tvInformationShelf",()=>{let c
const l=Il(e,D2,t,n,!1,!1,o,a),u=function(e,t,n){return Iv.context("productCapabilitiesAsAnnotations",()=>{const r=[],o=fl(e,t,n)
for(const e of o){const t=e.title,n=e.caption.styledText.rawText
if((null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0){const e=new S2(n),o=new b2(t,[e])
0===o.items_V3.length&&(o.items_V3=Cl(0,o)),r.push(o)}}return r})}(e,t,s).concat(Il(e,_2,t,n,!1,!1,o,a)),d=Ut(e,TP),f=Il(e,d?[el]:[Pl],t,n,!1,!0,o,a),p=[]
if(l.length>0){const t=new P2(e.loc.string(cR),l,i)
p.push(t)}if(u.length>0){const t=new P2(e.loc.string(lR),u,i)
p.push(t)}if(f.length>0){const t=d?e.loc.string("ProductPage.Section.ExternalPurchases.Title"):e.loc.string("ProductPage.Section.TopInAppPurchases.Title"),n=new P2(t,f,!0)
p.push(n)}return p.length>0&&(ou(e)?(c=new oJ("annotationGroup"),c.items=p,c.background={type:fR},r(o)||o.addImpressionsToShelf(e,c,dH)):(c=new oJ("informationContainer"),c.items=[new fY(p)],r(o)||o.addImpressionsToShelf(e,c,dH))),c})}(e,t,n,o,c,a,i)
break
default:l=function(e,t,n,o,i,s){return Iv.context(vR,()=>{let a
const c=kl(e,t)?R2:E2,l=Il(e,c,t,n,i,!1,o,s)
return l.length>0&&(a=new oJ(pU),a.title=e.loc.string(cR),a.items=l,r(o)||o.addImpressionsToShelf(e,a,dH)),a})}(e,t,n,o,s,i)}return l})}(e,n,I,a,(n,r,o)=>{var s,a
if(n===Jc&&($.setShelfId(dH,o),$.annotation=r,t.ageRatingAction=new yz(dH,null,null,null,o,!0),t.ageRatingAction.title=e.loc.string("ProductPage.Banner.AskForException.Review.ViewAgeRatingLink")),n===Wc&&i(t.banner)){i(t.banner.fullProductAction)&&(t.banner.action=t.banner.fullProductAction)
const n=t.banner.action
i(n)&&(ou(e)?n instanceof yz&&(null===(s=n.shelfId)||void 0===s?void 0:s.length)>0&&n.shelfId===dH&&n.indexId===hB&&(n.index=o):n instanceof sz&&(null===(a=n.section.shelfId)||void 0===a?void 0:a.length)>0&&n.section.shelfId===dH&&n.indexId===hB&&(n.index=o))}n===al&&(F.setShelfId(dH,o),F.annotation=r),n===bl&&(N.setShelfId(dH,o),N.annotation=r),n===qc&&(B.setShelfId(dH,o),B.annotation=r),n===sl&&(U.setShelfId(dH,o),U.annotation=r)},G,k,!1)
j&&(t.shelfMapping[dH]=j)
const H=function(e,t,n,r){var o
if(!$i(e))return null
let i=Te(t,r_)
if(((0,kv.isNothing)(i)||0===i.length)&&(i=Ae(t,DH)),(0,kv.isNothing)(i)||0===i.length)return null
const s=me(t,r_),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:null!==(o=W(s))&&void 0!==o?o:void 0},c=i.some(e=>e.type!==DH),l=c?"ProductPage.Section.AppEventsAndOffers.Title":"ProductPage.Section.AppEvents.Title",u=e.loc.string(l),d=c?"EventsAndOffers":"Events"
kf(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:a.recoMetricsData,targetType:jV,id:d,idType:qV},u)
const f=qi(e,i,t,!c,!1,a,!1,!1,!1,!1);(0,kv.isSome)(f.nextAppEventPromotionStartDate)&&nr(f.nextAppEventPromotionStartDate,r)
const p=f.appPromotions
if(0===p.length)return Ef(a.locationTracker),null
const h=ca(0,p,u)
return n.addImpressionsToShelf(e,h,jV,d,qV,a.recoMetricsData),Ef(a.locationTracker),xf(a.locationTracker),h}(e,n,a,l)
if(i(H)&&(t.shelfMapping[PV]=H),G){const r=function(e,t,n){if(o(t))return null
const r=f(Be(e,t,rj),LH)
if(r){const t=e.loc.string("APP_STORE_EDITORS_ATTRIBUTION"),o=new zY(r,t),i=new oJ(Sj)
return i.items=[o],n.addImpressionsToShelf(e,i,Sj),i.background={type:ej,color:Z(oL)},i}return null}(e,n,a)
r&&(t.shelfMapping[Sj]=r)}t.shelfMapping[YU]=Rl(e,n,a,!1,0,G),t.shelfMapping[BG]=Rl(e,n,a,!0,0,G),t.shelfMapping[m$]=function(e,t,n){return Iv.context(jU,()=>{if("tv"!==e.client.deviceType)return null
if(o(t))return null
const r=new oJ(fG)
r.isHorizontal=!1
const i=function(e,t){return t?Iv.context("externalProductLinksAsParagraphsFromData",()=>{const n=[],r=Ge(e,t,m_)
if(r){const t=e.loc.string("DEVELOPER_WEBSITE_WITH_URL").replace("{URL}",r),o=new _q(t)
e.featureFlags.isEnabled(n$)&&(o.style=N$),o.alignment=tH,n.push(o)}return n}):null}(e,t)
return i&&i.length>0&&(r.items=i),ou(e)&&(r.background={type:fR}),n.addImpressionsToShelf(e,r,aF),r})}(e,n,a)
const q=function(e,t,n,r){return Iv.context("capabilitiesShelf",()=>{if(o(t))return null
const i=qe(e,t)
if(o(_e(t,i,zV)))return null
const s=fl(e,t,n)
if(o(s))return null
const a=new oJ("productCapability")
return a.title=e.loc.string(lR),a.items=s,a.mergeWhenFetched=!0,a.batchGroup=ij,r.addImpressionsToShelf(e,a,"supports"),a})}(e,n,k,a)
q&&(t.shelfMapping[GV]=q)
const z=null!==(h=null==c?void 0:c.webBrowser)&&void 0!==h&&h
if(!z){const r=ve(n,cM)
if(s(r)){const i=function(e,t,n,r){return Iv.context("smallStoryShelf",()=>{var i
if(o(n))return null
const a={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:jV,id:`${r.getSequenceId()}`,idType:YV},c=e.loc.string(cP)
kf(e,a,c)
const l=[],u=function(e){return l.push(e),!1}
let d
if(Ql(e)){const t=new uQ(a.pageInformation,a.locationTracker)
d=Sp(e,n,c,null,t,u)}else{const t={metricsLocationTracker:a.locationTracker,metricsPageInformation:a.pageInformation,filterOutMediaCardKinds:new Set([OF])}
d=bp(e,n,sj,c,null,t,u),Array.isArray(d.items)&&(d.items=d.items.filter(e=>!(e instanceof jJ)||Ap(0,e.media.kind,sj)))}if(d.isHorizontal=!0,!(null===(i=d.items)||void 0===i?void 0:i.length)&&0===l.length)return null
if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=Nv.OnShelfWillAppear),s(l)){Ef(r.locationTracker),r.addImpressionsToShelf(e,d,Hj),xf(r.locationTracker)
const n=new B4(t.id,l,d.title,!1,void 0,d.contentType,null,null,null,null,null,Tm.SmallStory)
la(e,d,n),d.url=Cp(0,n,r)}else Ef(r.locationTracker),r.addImpressionsToShelf(e,d,Hj),xf(r.locationTracker)
return d})}(e,n,r.data,a)
i&&(t.shelfMapping[Hj]=i)}}const Y={isPreorder:m},J=new v2,K=function(e,t,n,r){return Iv.context("friendsPlayingShelf",()=>{if(o(t))return null
const i=t.id
if(o(i))return null
if(!Ve(e,t,rN))return null
if(r.isPreorder)return null
const s=e.loc.string("ProductPage.Section.FriendsPlaying.Title","Playing This Game"),a={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:jV,id:`${n.getSequenceId()}`,idType:YV}
kf(e,a,s)
const c=new oJ(lP)
c.header=hp(e,s),c.isHidden=!0,c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new B4(t.id,[],c.title,!1,void 0,null,null,null)
c.url=`${Oz}:/${_z.product}/${_z.shelf}/?${Hz.isGameCenterPlayerShelf}=true&${Hz.id}=${i}&${Hz.token}=${kp(l,n,n.metricsPageInformation)}`,c.batchGroup=ij,n.addImpressionsToShelf(e,c,WV),Ef(n.locationTracker),xf(n.locationTracker)
const u=new dY(jH)
return ap(e,u,null,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),c})}(e,n,a,Y)
K&&(t.shelfMapping[WV]=K,J.setShelfId(WV))
const Q=function(e,t,n,r){return Iv.context("achievementsShelf",()=>{if(o(t))return null
if(r.isPreorder)return null
if(!Ve(e,t,rN))return null
const i=qe(e,t),s=_e(t,i,zV)
if(o(s))return null
const a=e.loc.string("ProductPage.Section.Achievements.Title",CU),c=new oJ(sP)
c.header=hp(e,a),c.isHorizontal=!0,c.items=[],c.mergeWhenFetched=!0
const l=new B4(t.id,[],c.title,!1,void 0,null,null,null)
return l.sourceLocationTracker=n.locationTracker,l.destinationPageInformation=n.metricsPageInformation,c.url=`${Oz}:/${_z.product}/${_z.shelf}/?${Hz.isGameCenterAchievementsShelf}=true&${Hz.bundleId}=${s}&${Hz.token}=${kp(l,n,n.metricsPageInformation)}`,c.batchGroup=ij,xf(n.locationTracker),c.footerTitle=e.loc.string(EM),c.footerAction=pp(0,{pageAchievements:{}}),c.footerStyle={$kind:mV,bundleID:sF,width:16,height:16},c})}(e,n,a,{isPreorder:m})
if(Q&&(t.shelfMapping[fH]=Q),!d&&!z){const r=function(e,t,n){return Iv.context("moreByDeveloperShelf",()=>{if(o(t))return null
const r=Nd(0,ye(e,t,cV)),i=ie(t,Cj)
let a,c
if(a=ve(t,lM),!a||0===a.data.length)return null
c=a.data
const l=e.loc.string("ProductPage.Section.MoreByDeveloper.TitleTemplate").replace("{developer}",i)
let u
switch(kf(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:jV,id:`${n.getSequenceId()}`,idType:YV},l),e.client.deviceType){case $H:case"tv":u=LV
break
default:u=eH}const d=new oJ(u)
d.title=l
const f=null,p=e.client.isCompanionVisionApp?32768:void 0
let h
if((0,kv.isSome)(a)?h=Op(e,a,n,td(0,u),u,f,p):(0,kv.isSome)(c)&&(h=Ep(e,c,n,td(0,u),u,f,p)),!h)return null
d.items=h.items,d.isHorizontal=!0,c.length<2?d.rowsPerColumn=1:d.rowsPerColumn=2
{const t=new dY(jH)
t.pageUrl=r,t.title=e.loc.string(Oj),ap(e,t,t.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker}),d.seeAllAction=t}if(e.bag.isOnDemandShelfFetchingEnabled&&(d.fetchStrategy=Nv.OnShelfWillAppear),s(h.remainingItems)){Ef(n.locationTracker),n.addImpressionsToShelf(e,d,cV),xf(n.locationTracker)
const o=new B4(t.id,h.remainingItems,d.title,!1,void 0,u,f,null,null,null,null,Tm.MoreByDeveloper)
o.developerUrl=r,la(e,d,o),d.url=Cp(0,o,n)}else Ef(n.locationTracker),n.addImpressionsToShelf(e,d,cV),xf(n.locationTracker)
return d})}(e,n,a);(0,kv.isSome)(r)&&(t.shelfMapping[AV]=r)}if(!d&&!z){const r=function(e,t,n){return Iv.context("similarItemsShelf",()=>{var r
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const i=ve(t,$B)
if(o(i))return null
const a=Jd(e,t),c=a?e.loc.string("Arcade.ProductPage.MoreFromAppleArcade"):e.loc.string("ProductPage.Section.SimilarItems.Title"),l=MV,u=gB
let d,f
switch(kf(e,{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,targetType:l,id:m2.similarItemsShelfId,idType:u},c),e.client.deviceType){case"tv":d=LV,f=!1
break
case $H:d=LV,f=!0
break
default:d=eH,f=!0}const p=new oJ(d)
p.title=c
const h=W(i),w=Op(e,i,n,td(0,d),d,null,null,h)
if(!w)return null
p.items=w.items
const g=Dn(e,xV),v=li(e,"SimilarItems",t.id,""),m=new B4(t.id,i.data,p.title,f,void 0,d,null,null,null,null,null,Tm.SimilarItems),y=Zl(0,t.id,m,n,v)
if(p.refreshUrl=y,p.isHorizontal=!0,i.data.length<2?p.rowsPerColumn=1:p.rowsPerColumn=a?2:3,e.bag.isOnDemandShelfFetchingEnabled&&(p.fetchStrategy=Nv.OnShelfWillAppear),s(w.remainingItems)||g){Ef(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,p,l,u),xf(n.locationTracker)
const o=new B4(t.id,null!==(r=w.remainingItems)&&void 0!==r?r:[],p.title,f,void 0,d,null,null,p.refreshUrl,h,a,Tm.SimilarItems)
if(la(e,p,o),p.url=Cp(0,o,n,v),g){const e=new oY(p.url)
e.param(Hz.isShelfWithAd,FV),e.param(Hz.shelfWithAdPlacementType,xV),e.param(Hz.id,t.id),p.url=e.build()}}else Ef(n.locationTracker),n.addImpressionsFieldsToSimilarItemsShelf(e,p,l,u),xf(n.locationTracker)
return p})}(e,n,a);(0,kv.isSome)(r)&&(t.shelfMapping[MV]=r)}const X=El(e,n,a,{isForSubscriptions:!0,options:c})
X&&(t.shelfMapping[dG]=X)
const ee=El(e,n,a,{isForSubscriptions:!1,options:c})
ee&&(t.shelfMapping[uG]=ee)
const te=function(e,t,n,r){return Iv.context("productMediaShelves",()=>{if(o(t))return null
const i=(e.client.deviceType,null),a=(e.client.deviceType,null),c=Qe(e,t),l=wd(e,t,11,i,c,n),u=fd(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},a)
let d=null
if(u)for(const e of l)if(e.mediaPlatform.isEqualTo(u.mediaPlatform)){d=e
break}let f=null
if(d){const e=d.mediaPlatform.appPlatform
if(e===RH||e===_V)for(const e of d.items){const t=e.screenshot
if(f=t.width/t.height,f<1)break}}const p=[],h=[]
if(d&&u&&u.videos)for(const n of u.videos){const o=new mY
o.video=n
const i=n.preview.width/n.preview.height,s=null===f||Math.abs(i-f)<.01,a=d.mediaPlatform.isEqualTo(u.mediaPlatform)
s&&a?p.push(o):h.push(n)
const c={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,id:t.id,isAdvert:!!r.metricsPageInformation.iAdInfo&&r.metricsPageInformation.iAdInfo.iAdIsPresent}
vo(e,n,c)}d&&(d.items=p.concat(d.items))
let w=[],g={}
for(let n=0;n<l.length;n++){const o=l[n],i=`${g1}_${o.mediaPlatform.appPlatform}_${o.mediaPlatform.supplementaryAppPlatforms.join("_")}`
w.push(new c0(VH,i))
const a=new oJ(dP,null,o.items)
a.isHorizontal=!0
let c=!1,u=oa(0,o.items[0])
for(const e of o.items)if(s(e.screenshot)&&e.screenshot.isPortrait()||s(e.video)&&e.video.preview.isPortrait()){u=oa(0,e),c=!0
break}a.contentsMetadata={type:"productMedia",platform:o.mediaPlatform,allPlatforms:o.allPlatforms,platformDescription:o.platformDescription,allPlatformsDescription:o.allPlatformsDescription,allPlatformsDescriptionPlacement:o.allPlatformsDescriptionPlacement,hasPortraitMedia:c,expandProductMediaAction:null,viewProductMediaGalleryAction:ra(e,o,t.id),aspectRatio:u},r.addImpressionsToShelf(e,a,bH),0===n&&"tv"!==e.client.deviceType&&(a.title=e.loc.string(RS)),g[i]=a}return h.length>0&&(g[bV]=function(e,t,n){return Iv.context("videoShelf",()=>{if(!t||0===t.length)return null
let r
return ou(e)?(r=new oJ(dP),r.title=e.loc.string(yP),r.items=t.map(e=>{const t=new mY
return t.video=e,t})):(r=new oJ(sL),r.title=e.loc.string(yP),r.items=t.map(e=>new HY(e,!0,mj,null,null,!0))),r.isHorizontal=!0,n.addImpressionsToShelf(e,r,bV),r})}(e,h,r)),{sectionMappings:w,shelfMapping:g,allProductMedia:l}})}(e,n,P,a)
t.shelfMapping={...t.shelfMapping,...te.shelfMapping}
const re=function(e){if((0,kv.isNothing)(e))return null
switch(e){case RH:return aH
case CH:return iH
case $H:return $H
case"tv":return EU
case kH:return xj
case MH:return MH
case _V:return null
default:A(e)}}(null===(w=null==te?void 0:te.allProductMedia[0])||void 0===w?void 0:w.mediaPlatform.appPlatform),oe=(t.title,function(e,t,n,r){return Iv.context("createActionLinks",()=>(o(t),null))}(0,n))
if(oe&&(t.shelfMapping[kL]=oe),(0,kv.isSome)(re)&&function(e,t,n){var r
const o=(0,Yv.attributeAsDictionary)(t,`accessibility.${n}`),i=null!==(r=Ge(e,t,zV))&&void 0!==r?r:""
return br(e)&&!Sr(e,t.id)&&!Pr(e,i)&&(0,kv.isSome)(o)}(e,n,re)){const r=Uc(e,n,re,!1,a,a.metricsPageInformation,a.locationTracker)
t.shelfMapping[wV]=r
const o=Gc(e,n,re,!1,a,a.metricsPageInformation,a.locationTracker);(0,kv.isSome)(o)&&(t.shelfMapping[yV]=o)
const i=jc(e,n,!1,a.metricsPageInformation,a.locationTracker);(0,kv.isSome)(i)&&(t.shelfMapping[hV]=i)}{const e=G?TN:bN,n=Sc(0,e)
t.shelfMapping[e]=n}!function(e,t,n){if(t&&t.spotlightSection){const e=t.spotlightInAppProductIdentifier
if(e&&t.spotlightSection){const r=n.shelfMapping[t.spotlightSection.shelfId]
if(!r)return
if(r.presentationHints={isInProductPageSpotlight:!0},Rp(0,e,r.items),r.url){const t=new oY(r.url)
t&&(r.url=t.param(Hz.offerName,e).build())}}}}(0,c,t)
const ce={},le=KS,ue=KM,de=Ux,fe=AG,pe=WV,he=ZE
ce[aB]=$,ce[le]=$,ce[ue]=F,ce[de]=N,ce[fe]=B,ce[pe]=J,ce[he]=U,t.badges&&Nc(e,t.badges,ce,a),null!=t.shelfMapping[IV]&&Nc(e,au(e,t.shelfMapping[IV]),ce,a),ru(e,t,te.sectionMappings,G,c)}(e,T,h,y,n,I,l),T.pageRefreshPolicy=rr(e,I),T.isIncomplete=!1,T.alwaysAllowReviews=Es(e,h),T.canonicalURL=ie(h,AH),l&&(T.shareAction=null,T.titleOfferDisplayProperties=null,T.expandedOfferDetails=null,T.lockup.offerDisplayProperties=null,T.banner=null),T})}function nu(e,t,n,a,c,l,d,p=!1){return Iv.context("createProductPageSidePack",()=>{var p
let h
i(a)&&(h=a.clientIdentifierOverride)
const w=t.id,g=ie(t,GH),v=ae(t,DB),m=Os(e,t),y=Jd(e,t),A={pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,id:w,isAdvert:!!n.metricsPageInformation.iAdInfo&&n.metricsPageInformation.iAdInfo.iAdIsPresent},T=new HK,b=new PY,S=se(t,VV)
S&&i(n)&&i(n.metricsPageInformation)&&(n.metricsPageInformation.offerType=Ej,n.metricsPageInformation.offerReleaseDate=Wt(0,t)),b.adamId=w,b.bundleId=Ge(e,t,zV),T.uber=function(e,t,n){ld(e,t,n)
const r=Jd(e,t),s=function(e,t){return t&&!0}(0,r)?wH:YA,a=new v1(s)
if(a.artwork=Md(e,t,{supportsArcade:r}),a.compactArtwork=Md(e,t,{supportsArcade:r,prefersCompactVariant:!0}),a.video=$d(e,t,21),i(a.video)&&(a.video.playbackId=function(e){return`ProductPage.${e.id}.productUberVideoPlaybackId`}(t)),r&&o(a.video)&&o(a.artwork)){const r=wd(e,t,11,(e.client.deviceType,null),Qe(e,t),n)
if(r.length>0&&r[0].items.length>0){const e=r[0].items[0]
a.video=e.video,a.artwork=e.screenshot}}return o(a.compactArtwork)&&(a.compactArtwork=a.artwork),a.isValidUber(!1,!1)?a:null}(e,t,h)
const P=T.uber&&T.uber.style===wH
b.icon=sd(e,t,{useCase:10,withJoeColorPlaceholder:void 0},h),T.title=g,T.isIncomplete=!0,b.title=g,b.subtitle=Cu(e,t),b.developerTagline=Ge(e,t,lV),T.regularPriceFormatted=ie(t,"regularPriceFormatted"),T.logoArtwork=function(e,t){let n=null,r=null
if("tv"!==e.client.deviceType)return null
n=RA,r="bb"
const o=Be(e,t,n)
return i(o)&&i("bb")?nd(e,o,{cropCode:"bb",useCase:0,withJoeColorPlaceholder:!0}):null}(e,t),T.navigationBarIconArtwork=null,m||(b.rating=ce(t,BO)),b.children=Pu(e,t,{metricsOptions:A,artworkUseCase:1})
const I=function(e,t,n,r,o,a,c){var l
const d=jt(e,t),f=Ge(e,t,zV),p=se(t,VV),h=Ht(e,d,t,p,!1,bf(e,t,n,null==a?void 0:a.clientIdentifierOverride),o,_j,c,null==a?void 0:a.webBrowser)
if(null!==(l=null==a?void 0:a.webBrowser)&&void 0!==l&&l)return{buttonAction:new WW(t.id),offerAction:h}
let w
if(s(h)){i(a)&&(h.lineItem=a.iAdLineItem)
const n=s(a)?a.clientIdentifierOverride:null
if(w=Jt(e,h,t,p,o,_j,n),i(a)&&s(w)){const n=We(e),r=Ye(e,t,Qe(e,t),xM,n),i=s(r)&&!u(a.isCppDeepLinkDisabled),c=s(a.externalDeepLinkUrl)
let l;(i||c)&&(l=i?r:a.externalDeepLinkUrl,w=Ct(e,w,h.adamId,f,l,!1,o))}}return{buttonAction:w,offerAction:h}}(e,t,b.icon,0,A,a,l)
if(b.buttonAction=I.buttonAction,S){let n
T.theme=DD
let r=null
if(y)n="",r=e.loc.uppercased(af(e,t,e.loc.string(rR)))
else if(n=e.loc.string(rR),i(I.offerAction.expectedReleaseDate)){const n=Qx,o=e.loc.formatDate(n,I.offerAction.expectedReleaseDate),i=e.loc.string("PREORDER_EXPANDED_OFFER_SUBTITLE").replace(XE,o)
r=af(e,t,i)}T.expandedOfferDetails=new bK(n,r)}let C,k
P&&y&&(T.theme=BV),P&&y?(C=BV,k=ED):(C=rG,k=_j)
const O=AO,E=rG,R=y?fN:SH,D=null!==(p=null==a?void 0:a.webBrowser)&&void 0!==p&&p?sS:_j
let _
b.offerDisplayProperties=ln(e,I.offerAction,R,t,S,0,C,k,null,null,D,!1,!1),T.titleOfferDisplayProperties=ln(e,I.offerAction,R,t,S,0,E,O,null,null,D)
const x=ye(e,t,cV),L=Nd(0,x)
i(L)&&(_=new dY(jH),_.title=ie(t,Cj),_.pageUrl=L,sp(e,_,{targetType:NH,id:x.id,actionType:UH,pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker})),T.developerAction=_,T.shareAction=bs(e,t,n.metricsPageInformation,n.locationTracker,h),b.tertiaryTitle=ku(e,t),b.tertiaryTitleAction=Ou(e,t),b.tertiaryTitleArtwork=null
const M={appPlatforms:md(e,t),clientIdentifierOverride:h,offerButtonShouldBeDisabled:!1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.locationTracker,webBrowser:null==a?void 0:a.webBrowser},$=function(e,t,n){let r=null,i=null,a=null,c=null,l=null,u=!1
const d=Ve(e,t,Hm),f=Ve(e,t,qm)
if((d||f)&&(r=e.loc.string("ProductPage.Banner.UpdateRequired.iOS"),n.offerButtonShouldBeDisabled=!0),null===r&&vt(e,t,1024)&&(r=e.loc.string("OFFER_WATCH_ONLY_BANNER"),n.offerButtonShouldBeDisabled=!0),null===r&&!Ku(e,t)){if(r=e.loc.string(IS),ou(e)){const t=new yz(dH)
t.title=e.loc.string(pB),t.indexId=hB,a=t}else{const t=new TK(VH,dH),n=new sz(t)
n.title=e.loc.string(pB),n.indexId=hB,a=n}r=e.loc.string(vF).replace(mF,a.title),n.offerButtonShouldBeDisabled=!0}if(null===r&&vt(e,t,36)&&(r=e.loc.string(CS),n.offerButtonShouldBeDisabled=!0),vt(e,t,512)){const n=Cd(e,t,e.appleSilicon.isSupportEnabled)
switch(e.client.deviceType){case $H:r=e.loc.string("UNSUPPORTED_MACOS_VERSION").replace(PU,n)
break
case RH:case CH:r=e.loc.string("UNSUPPORTED_IOS_VERSION").replace(PU,n)
break
case"tv":r=e.loc.string("UNSUPPORTED_TVOS_VERSION").replace(PU,n)
break
case MH:const o=Ge(e,t,P$)
r=e.loc.string(kS).replace(PU,o)
break
case kH:r=e.loc.string("UNSUPPORTED_VISIONOS_VERSION").replace(PU,n)
break
default:r=e.loc.string(CS)}if(e.client.isPhone&&Ve(e,t,uU)){const n=Ge(e,t,P$)
r=e.loc.string(kS).replace(PU,n)}}if(vt(e,t,128))if(n.offerButtonShouldBeDisabled=!0,r=e.loc.string(IS),ou(e)){const t=new yz(dH)
t.title=e.loc.string(pB),t.indexId=hB,a=t,r=e.loc.string(vF).replace(mF,t.title)}else{const t=new TK(VH,dH),n=new sz(t)
n.title=e.loc.string(pB),n.indexId=hB,a=n,r=e.loc.string(vF).replace(mF,n.title)}if(vt(e,t,8192)){if(ou(e)){const t=new yz(dH)
t.title=e.loc.string(pB),t.indexId=hB,a=t}else{const t=new TK(VH,dH),n=new sz(t)
n.title=e.loc.string(pB),n.indexId=hB,a=n}r=e.loc.string(vF).replace(mF,a.title)}const p=ae(t,VV)
Xd(e,t)&&(r=p?e.loc.string("ProductPage.WatchOS.PreOrderRequiresiPhone"):e.loc.string("UNSUPPORTED_COMPANION_CONFIGURATION","Requires iPhone"),n.offerButtonShouldBeDisabled=!0)
const h=Ge(e,t,P$)
if(null===r&&n.clientIdentifierOverride===Zq&&rf(e,h)&&(r=e.loc.string("ProductPage.Banner.PairedWatchOSVersionBelowMinimum").replace(PU,h)),$e(e,t,xj)&&!e.client.isCompanionVisionApp){const t=e.loc.string("BANNER_VISION_ONLY_APP_LEARN_MORE_LINK")
i=function(e,t,n,r){const i=e.bag.visionOnlyAppLearnMoreEditorialItemId
if(o(i))return null
const s=new dY(XV)
return s.title=t,s.pageUrl=`https://apps.apple.com/story/id${i}`,sp(e,s,{id:LN,targetType:uH,actionType:UH,pageInformation:n,locationTracker:r}),s}(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){return t&&n?e.loc.string("BANNER_VISION_ONLY_APP_WITH_LINK").replace(nG,t):e.loc.string("BANNER_VISION_ONLY_APP_NO_LINK")}(e,t,i),a=null,c=Se(e,"systemimage://visionpro"),l=Z(XL),u=!0}on(e,t)&&!an(e)?(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.VisionDeviceRequired")):e.client.isCompanionVisionApp&&!on(e,t)&&(n.offerButtonShouldBeDisabled=!0,r=e.loc.string("ProductPage.Banner.Companion.RemoteDownloadUnavailable"))
const w=Bt(e,t),g=Ut(e,"product-page-banner")
if((null===r||!n.offerButtonShouldBeDisabled)&&w&&g){const t=e.loc.string("ProductPage.ExternalPurchasesBanner.LearnMore")
i=Gt(e,t,n.metricsPageInformation,n.metricsLocationTracker),r=function(e,t,n){if(t&&n){if((0,Cv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const n=`ProductPage.ExternalPurchasesBanner.WithLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(n).replace(nG,t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.WithLink").replace(nG,t)}if((0,Cv.isSome)(e.bag.externalPurchasesProductPageBannerTextVariant)){const t=`ProductPage.ExternalPurchasesBanner.NoLink.Variant${e.bag.externalPurchasesProductPageBannerTextVariant}`
return e.loc.string(t)}return e.loc.string("ProductPage.ExternalPurchasesBanner.NoLink")}(e,t,i),a=null,e.bag.externalPurchasesIncludeProductPageBannerIcon?"secondaryInfoCircle"===e.bag.externalPurchasesProductPageBannerIconVariant?(c=Se(e,"systemimage://info.circle"),l=Z(XL)):(c=Se(e,Wx),l=Z("systemRed")):(c=null,l=null),u=!0}if((null==r?void 0:r.length)>0)return new wY(r,null,i,a,c,l,u,null)
if(!n.offerButtonShouldBeDisabled){const n=Id(e,t)
if(s(n))return function(e,t){const n=e.loc.string("ProductPage.Banner.ExternalBrowser.Message")
let r=n,o=n,i=n,s=n,a=n
return[$U].includes(e.client.buildType)&&(r+="\n(Internal: unknown)",o+="\n(Internal: buyOrGet)",i+="\n(Internal: redownload)",s+="\n(Internal: update)",a+="\n(Internal: open)"),new gY(Bc(zx,t,r),Bc(zx,t,o),Bc(zx,t,i),Bc(Lx,t,s),Bc("launch",t,a))}(e,n)}return null}(e,t,M)
$ instanceof wY?T.banner=$:$ instanceof gY&&(T.appStateBanner=$)
const F=b.offerDisplayProperties
M.offerButtonShouldBeDisabled&&s(F)&&(b.offerDisplayProperties=F.newOfferDisplayPropertiesChangingAppearance(!1,kN))
const N=!vt(e,t,512)
if(!v&&!M.offerButtonShouldBeDisabled&&N){const n=function(e,t){return Iv.context("updateOfferDataFromData",()=>{const n=Ue(e,t,GU)
if(0===n.length)return null
for(const e of n)if(f(e,oj)===Lx)return e
return null})}(e,t)
T.updateBuyParams=f(n,ZU),T.externalVersionIdentifier=He(e,t,oR)}if(y&&(b.editorialTagline=e.loc.string("APPLE_ARCADE")),T.lockup=b,T.appPlatforms=md(e,t),i(c)){const n=Li(e,c,t,!1,!1,mH,BV,!0,A,!0,!1,null,!1,!1)
if(i(c)&&n instanceof QK){const r=n
T.appPromotionDetailPageFlowAction=Mi(e,c,t,r,A,Mj,!1,d)}}!function(e,t,n,i,s,a){if(t.shelfMapping[vH]=new oJ(QS,"productTopLockup"),"tv"!==e.client.deviceType){const s={developerAction:t.developerAction}
t.shelfMapping[nH]=function(e,t,n,i){return Iv.context("descriptionShelf",()=>{if(o(t))return null
const s=new oJ("productDescription"),a=function(e,t){return t?Iv.context("productDescriptionLinksFromData",()=>{const n=[],r=Ge(e,t,m_)
if(r){const t=new MW(r,!1),o=e.loc.string("PRODUCT_DEVELOPER_WEBSITE")
n.push(new UY(o,t,"safari"))}const o=Ge(e,t,v_)
if(o){const t=new MW(o,!1),r=e.loc.string("DEVELOPER_SUPPORT")
n.push(new UY(r,t,"questionmark.circle"))}return n}):null}(e,t),c=function(e,t,n,r){const o=Te(t,Bk),i=[]
for(const s of o){const o=(0,Yv.attributeAsString)(s,GH)
if((0,kv.isSome)(o)){let a=null
switch(s.type){case cF:a=(0,Yv.attributeAsString)(s,AH)
break
case tj:const t=f(s,eU)
t&&(a=Er(e,t))}if((0,kv.isNothing)(a))continue
const c=e.required(G4).fetchFlowPage(a),l=new dY(c)
l.pageUrl=a,l.title=o
const u=new $Y(o,l),d={targetType:TU,pageInformation:n,locationTracker:r,recoMetricsData:null}
Bf(e,u,qf(e,s,o,d))
const p=rp(e,t,d)
p.targetType=d.targetType,sp(e,l,p),i.push(u),xf(d.locationTracker)}}return i}(e,t,n.metricsPageInformation,n.locationTracker),l=function(e,t,n=null){return Iv.context("descriptionFromData",()=>{r(n)&&(n=Qe(e,t))
let o=function(e,t,n){return Ye(e,t,n,Ky)}(e,t,n)
o||(o="")
let i=Ge(e,t,fU)
i||(i="")
let s=""
o.length>0&&i.length>0&&(s="\n\n")
const a=o+s+i
if(a.length>0){const e=new _q(a)
return e.isCollapsed=!0,e}return null})}(e,t)
if(null===l)return null
const u=new TY(l,a,c,i.developerAction)
return s.items=[u],n.addImpressionsToShelf(e,s,nH),s})}(e,n,i,s)}{const r={useInlineUberStyle:t.uber&&t.uber.style===wH}
t.shelfMapping[IV]=function(e,t,n,r){if(ou(e)){const r=new oJ("productBadge"),o=zl(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation})
return r.items=o,r.isHorizontal=!0,n.addImpressionsToShelf(e,r,IV),r}{const o=new oJ(IV),i=zl(e,t,!0,{locationTracker:n.locationTracker,pageInformation:n.metricsPageInformation}),s=!r.useInlineUberStyle,a=!1,c=r.useInlineUberStyle,l=new JY(i,s,a,c,"justified")
return o.items=[l],o.isHorizontal=!0,n.addImpressionsToShelf(e,o,IV),o}}(e,n,i,r)}ru(e,t,[],Jd(e,n),s)}(e,T,t,n,a),T.uber&&(T.presentationOptions.push(J$),T.presentationOptions.push($_)),T.alwaysAllowReviews=Es(e,t)
const B=null==a?void 0:a.iAdDismissAdActionMetrics
if((0,kv.isSome)(B)){const e=new yK(f(B.instanceId),f(B.adamId),f(B.bundleId),f(B.advertType),f(B.invocation),f(B.purchaseType),f(B.reportingDestination)),t=new Cz(e)
T.pageDisappearedAction=t
const n=new yK(f(B.instanceId),f(B.adamId),f(B.bundleId),f(B.advertType),WT,f(B.purchaseType),f(B.reportingDestination))
T.lockup.buttonAction=On(0,T.lockup.buttonAction,n)}return T})}function ru(e,t,n,r,o){const i=function(e,t,r){return e.map(e=>e.shelfId===bH&&r?n:e.shelfId===bH?n[0]?[n[0]]:[]:[e]).reduce((e,t)=>e.concat(t)).map(e=>e.createShelfIdList()).reduce((e,t)=>e.concat(t))},a=ea(0,!0,e.host.platform,r,!1,!1,o),c=ea(0,!1,e.host.platform,r,!1,!1,o),l=ea(0,!0,e.host.platform,r,!0,!1,o),u=ea(0,!1,e.host.platform,r,!0,!1,o),d=ea(0,!1,e.host.platform,r,!1,!0,o),f=ea(0,!1,e.host.platform,r,!0,!0,o)
t.shelfOrderings.purchasedOrdering=i(a,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia=i(a,0,!0),t.shelfOrderings[VK]=i(c,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia=i(c,0,!0),t.shelfOrderings.purchasedOrdering_Compact=i(l,0,!1),t.shelfOrderings.purchasedOrdering_ExpandedMedia_Compact=i(l,0,!0),t.shelfOrderings.notPurchasedOrdering_Compact=i(u,0,!1),t.shelfOrderings.notPurchasedOrdering_ExpandedMedia_Compact=i(u,0,!0),t.shelfOrderings.downloadingOrdering=i(d,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia=i(d,0,!0),t.shelfOrderings.downloadingOrdering_Compact=i(f,0,!1),t.shelfOrderings.downloadingOrdering_ExpandedMedia_Compact=i(f,0,!0),t.defaultShelfOrdering=VK
for(const e of Object.keys(t.shelfMapping))s(t.shelfMapping[e])&&(t.shelfMapping[e].id=e)}function ou(e){return e.featureFlags.isEnabled("shelves_2_0_product")||!0}function iu(e,t,n={},r={},o=null,i=!1,s=!1){const a=Jd(e,j(e,t)),c=tu(e,t,n,r,o,s)
return ou(e)&&!i?c:ia(e,c,a,n)}function su(e,t,n={}){if(!e.client.isSidepackingEnabled)return null
const o=Jd(e,t),i=function(e,t,n){return Iv.context("createProductPageSidePackFromResponse",()=>{if(!e.client.isSidepackingEnabled)return null
const o=function(e,t,n){const r=ie(t,AH),o=ie(t,GH),i=ie(t,Cj)
let s=null
n&&(s=n.iAdClickFields)
const a=li(e,uj,t.id,`${i}_${o}`,s)
return a.pageUrl=r,new m2(a,{rootPosition:0,locationStack:[]})}(e,t,n),i=nu(e,t,o,n)
return function(e,t,n){r(n)||(t.pageMetrics.addData(mi(e,n,void 0),[Fv.PageInvocationPoint.backButton]),r(t.pageMetrics.pageFields)&&(t.pageMetrics.pageFields={}))}(e,i,o.metricsPageInformation),i})}(e,t,n)
return ou(e)?i:ia(e,i,o,n)}function au(e,t){if(o(null==t?void 0:t.items))return[]
if(ou(e))return t.items
{const e=t.items
return e.length>0?e[0].badges:[]}}function cu(e,t,n){const r=pn(0,t),o=lu(e,t,r,n,F2[n],!1),i=lu(e,t,r,n,N2[n],!0)
return o.rtlArtwork=i.rtlArtwork,o.rtlArtworkData=i.rtlArtworkData,o.rtlVideo=i.rtlVideo,o.rtlBackgroundColor=i.rtlBackgroundColor,o.rtlTextColorOverride=i.rtlTextColorOverride,o}function lu(e,t,n,r,o,a){let c={}
for(const l of o){if(i(n)&&(c=du(e,n,r,l,a)||uu(e,n,r,l,a),s(c)))break
if(c=du(e,t,r,l,a)||uu(e,t,r,l,a),s(c))break}return(0,Cv.isNothing)(c)&&(c={}),c}function uu(e,t,n,o,i){let a=null,c=null,l=null
const u=`editorialArtwork.${o}`,d=qe(e,t)
if(r(d))return null
if(c=ne(t,u)||Re(t,d,u),!s(c))return null
if(a=nd(e,c,{withJoeColorPlaceholder:!0,useCase:fu(n),cropCode:pu(n,o,i)}),r(a))return null
l=a.backgroundColor
const f=wu(0,c,a)
return i?{rtlArtwork:a,rtlArtworkData:c,rtlBackgroundColor:l,rtlTextColorOverride:f}:{artwork:a,artworkData:c,backgroundColor:l,textColorOverride:f}}function du(e,t,n,r,i){let a=null,c=null,l=null,u=null
const d=`editorialVideo.${r}`,p=qe(e,t)
if((0,Cv.isNothing)(p))return null
if(l=ne(t,d)||Re(t,p,d),o(l))return null
const w=h(l,vU)
s(w)&&(c=nd(e,w,{withJoeColorPlaceholder:!0,useCase:fu(n),cropCode:"sr"})),s(c)&&(c.crop="sr",u=c.backgroundColor)
const g=f(l,DV)
if(s(c)&&(0,Cv.isSome)(g)&&g.length>0&&(a=new Vq(g,c,{canPlayFullScreen:!1,allowsAutoPlay:!0,looping:!0,playbackControls:gu(0,n),autoPlayPlaybackControls:{}}),a.editorialMediaFlavor=r,a.editorialMediaPlacement=n),(0,Cv.isNothing)(w)||(0,Cv.isNothing)(c))return null
const v=wu(0,w,c)
return i?{rtlVideo:a,rtlArtwork:c,rtlArtworkData:w,rtlBackgroundColor:u,rtlTextColorOverride:v}:{video:a,artwork:c,artworkData:w,backgroundColor:u,textColorOverride:v}}function fu(e){switch(e){case ym.Hero:return 19
case ym.LargeBreakout:return 6
case ym.StoryCard:return 15
case ym.StoryDetail:case ym.StoryDetailLandscape:return 13
case ym.Search:return 9
default:return 0}}function pu(e,t,n){switch(e){case ym.Hero:switch(t){case mm.HeroStatic16x9:if(!n)return"gd"
break
case mm.HeroStaticRTL16x9:if(n)return"gg"
break
case mm.StoryCenteredStatic16x9:return n?"gh":"ge"
case mm.UniversalAStatic16x9:return n?"gj":"gi"}break
case ym.LargeBreakout:switch(t){case mm.StoryCenteredStatic16x9:return n?"gk":"gf"
case mm.UniversalAStatic16x9:return n?"gl":"gm"}break
case ym.StoryCard:case ym.StoryDetail:case ym.StoryDetailLandscape:case ym.Search:if(t===mm.UniversalAStatic16x9)return"gn"}return"sr"}function hu(e,t,n=!1){if((0,Cv.isNothing)(t))return null
const r=n?t.rtlTextColorOverride:t.textColorOverride,o=n?t.rtlBackgroundColor:t.backgroundColor
return(0,Cv.isSome)(r)?X(r,mJ):(0,Cv.isSome)(o)?K(o):null}function wu(e,t,n){const r=null==n?void 0:n.textColor
if((0,Cv.isNothing)(r))return null
const o=u(t,"useCustomTextColor"),i=X(r,vJ)||X(r,mJ)
return o&&i?r:null}function gu(e,t){switch(t){case ym.Hero:case ym.StoryDetail:case ym.StoryDetailLandscape:return{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}
default:return{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0}}}function vu(e,t,n){switch(n){case nN:case tN:case H$:case V$:return cu(e,t,ym.EditorialLockup)
case"BrickSmall":case"BrickMedium":case"BrickLarge":return cu(e,t,ym.Brick)
case L_:case"StorySmall":return cu(e,t,ym.StoryCard)
case WB:return cu(e,t,ym.Hero)
case eO:return cu(e,t,ym.LargeBreakout)
default:return{}}}function mu(e,t,n){const r=function(e,t,n){const r=function(e,t){let n=null
switch(t.type){case OH:case vV:case zN:n=Ae(t,YN,!0)||Ae(t,sV,!0)||Ae(t,FH,!0)
break
case tj:n=w(t.meta,eT)
break
default:n=null}return n}(0,t)
return o(r)?null:Gu(e,r,n)}(e,t,{lockupOptions:n})
if(!o(r))return null==r?void 0:r.map(e=>e.icon)}function yu(e,t,n){const r=fn(e,t)
return o(r)?null:Du(e,r,n)}function Au(e,t,n,r,o){if((0,kv.isNothing)(t)||0===t.length||r.has(t))return null
const i=new kY(i$)
return i.moduleType=zR,(0,kv.isSome)(t)&&(i.labelText=t,Uf(e,i,Wf(o,zR,i.labelText,QV))),r.add(t),[i]}function Tu(e,t,n){return t===kV?n?xH:kB:n?fN:SH}function bu(e,t,n,s,a){var c,u,d,f,p,w,g,v,m,y,A
if(o(t))return
if(n.showMetadataInformationInLockup=e.bag.isLLMSearchTagsEnabled||e.client.isPad,!e.client.isPhone)return
const T=h(t,WG),b=null!==(u=null===(c=null==T?void 0:T.displayStyle)||void 0===c?void 0:c.metadataRibbon)&&void 0!==u?u:null===(d=null==s?void 0:s.displayStyle)||void 0===d?void 0:d.metadataRibbon
let S=[]
S=e.bag.isLLMSearchTagsEnabled?null!==(g=null!==(p=null===(f=null==T?void 0:T.displayStyle)||void 0===f?void 0:f.llmRibbon)&&void 0!==p?p:null===(w=null==T?void 0:T.displayStyle)||void 0===w?void 0:w.metadataRibbon)&&void 0!==g?g:null===(v=null==s?void 0:s.displayStyle)||void 0===v?void 0:v.metadataRibbon:null!==(y=null===(m=null==T?void 0:T.displayStyle)||void 0===m?void 0:m.metadataRibbon)&&void 0!==y?y:null===(A=null==s?void 0:s.displayStyle)||void 0===A?void 0:A.metadataRibbon
const P=function(e,t,n,s,a,c=B2){if(o(s))return[]
const l=[],u=new Set
for(const d of s)if(!o(d))for(const o of d){const s=c[o]
if(r(s))continue
const d=s(e,t,n,u,a.metricsOptions)
if(i(d)){l.push(...d)
break}}return l}(e,t,n,b,a),I=function(e,t,n,s,a,c=B2){if(o(s))return[]
const u=l(t.meta,"associations.tags.data"),d=[]
let f=0,p=0
const w=new Set
for(const l of s){const s=Array.isArray(l)?l:[l]
if(!o(s))for(const o of s){const s=o===wE
let l,g=t,v=""
if(o===zR){const n=h(t,WG);(0,kv.isSome)(null==n?void 0:n.rankedSecondaryGenreShortDisplayNames)&&(v=null==n?void 0:n.rankedSecondaryGenreShortDisplayNames[p]),(0,kv.isSome)(v)?(l=Au(e,v,0,w,a.metricsOptions),p+=1):l=[]}else{const i=c[o]
if(r(i))continue
g=s?u[f]:t,l=i(e,g,n,w,a.metricsOptions),f=s?f+1:f}if(i(l)){d.push(...l)
for(const e of l)(0,kv.isSome)(e.impressionMetrics)&&xf(a.metricsOptions.locationTracker)
break}}}return d}(e,t,n,S,a)
n.metadataRibbonItems=P,n.searchTagRibbonItems=I,n.shouldEvenlyDistributeRibbonItems=!e.bag.isLLMSearchTagsEnabled}function Su(e,t,n,r,o,i){t&&Iv.context("copyDataIntoLockup",()=>{var s,a,c,u,d,p
const h=ae(t,VV)
if(r.isContainedInPreorderExclusiveShelf&&!h)return null
const w=null!==(s=null==r?void 0:r.attributePlatformOverride)&&void 0!==s?s:We(e),g=Qe(e,t)
n.productVariantID=et(g),r.metricsOptions.productVariantData=g,n.adamId=t.id
const v=Ge(e,t,zV,null==r?void 0:r.attributePlatformOverride)
n.bundleId=v,n.decorations=[]
let m=null
r&&r.clientIdentifierOverride&&(m=r.clientIdentifierOverride),n.icon=sd(e,t,{useCase:r.artworkUseCase,withJoeColorPlaceholder:r.useJoeColorIconPlaceholder,joeColorPlaceholderSelectionLogic:r.joeColorPlaceholderSelectionLogic,overrideTextColorKey:r.overrideArtworkTextColorKey},m,g,r.attributePlatformOverride),r&&r.titleObjectPath?n.title=Ge(e,t,r.titleObjectPath,null==r?void 0:r.attributePlatformOverride):n.title=ie(t,GH),n.useAdsLocale=r.metricsOptions.isAdvert&&(0,Cv.isSome)(e.bag.adsOverrideLanguage)
const y=Jd(e,t,null==r?void 0:r.attributePlatformOverride)
y&&!r.shouldHideArcadeHeader&&(n.heading=r.metricsOptions.isAdvert?e.adsLoc.string(FO):e.loc.string(FO)),r.shouldShowFriendsPlayingShowcase&&n.decorations.push("showcaseFriendsPlaying")
const A=!y&&!h&&(null===(a=r.isMultilineTertiaryTitleAllowed)||void 0===a||a)
if(r.isSubtitleHidden||function(e,t,n){return Iv.context("isBadgeMultilineFromData",()=>{if(!n)return!1
if(!Pd(0,t,!1))return!1
if(Eu(e,t))return!1
const r=md(e,t)
return Od(r,CH)||Od(r,RH)})}(e,t,A)||(n.subtitle=Cu(e,t,r)),n.tertiaryTitle=ku(e,t,A,r.hideCompatibilityBadge),n.tertiaryTitleAction=Ou(e,t),n.tertiaryTitleArtwork=null,n.developerTagline=Ge(e,t,lV,null==r?void 0:r.attributePlatformOverride),n.editorialTagline=Kd(e,t,oG,!1,null==r?void 0:r.attributePlatformOverride),n.editorialDescription=Kd(e,t,LH,!1,null==r?void 0:r.attributePlatformOverride),n.shortEditorialDescription=Kd(e,t,kG,!1,null==r?void 0:r.attributePlatformOverride),n.ageRating=kt(0,t,!0),n.productDescription=Ge(e,t,fU,null==r?void 0:r.attributePlatformOverride),null!==(c=null==r?void 0:r.shouldShowSupportedPlatformLabel)&&void 0!==c&&c&&function(e,t,n,r){const o=md(e,t),i=Pd(0,t,!1)
if(Ed(e,t,o,e.client.deviceType,i,!1))return
const s=o.filter(t=>t!==e.client.deviceType)
if(0!==s.length)if(n.tertiaryTitleIcons=s.map(e=>ef(e)),1===s.length){const t=jd(e,s[0])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.OnlyAvailable.Message").replace("@@platform@@",t)}else{const t=jd(e,s[0]),r=jd(e,s[1])
n.tertiaryTitle=e.loc.string("AppStore.Bundles.ProductPage.AvailableOnTwo.Message").replace("@@platform1@@",t).replace("@@platform2@@",r)}}(e,t,n),!Os(e,t)&&(ce(t,NO)>0||!r||!r.hideZeroRatings)){n.rating=ce(t,BO)
const o=ce(t,NO),i=r.metricsOptions.isAdvert?e.bag.adsOverrideLanguage:null
n.ratingCount=e.loc.formattedCountForPreferredLocale(e,o,i)}const T=rp(e,t,r.metricsOptions,r.metricsClickOptions)
kf(e,T,n.title)
const S=jt(e,t,null==r?void 0:r.attributePlatformOverride),P=null!==(u=null==r?void 0:r.includeBetaApps)&&void 0!==u&&u,I=bf(e,t,n.icon,m),C=b(T),k=Ht(e,S,t,h,P,I,C,sH,null==r?void 0:r.referrerData),O=l(S,UO)
let E=Jt(e,k,t,h,C,sH,m,r.shouldNavigateToProductPage)
const R=Ye(e,t,g,xM,w),D=An(0,t),_=!D||bn(t),x=_&&(null==R?void 0:R.length)>0,L=(null===(d=null==r?void 0:r.externalDeepLinkUrl)||void 0===d?void 0:d.length)>0
let M;(x||L)&&(M=x?R:r.externalDeepLinkUrl),(0,Cv.isSome)(M)&&(E=Ct(e,E,k.adamId,v,M,P,C),(null===(p=r.crossLinkSubtitle)||void 0===p?void 0:p.length)>0&&(n.crossLinkTitle=e.loc.uppercased(ie(t,GH)),n.crossLinkSubtitle=r.crossLinkSubtitle)),n.buttonAction=E,n.includeBetaApps=P,n.developerName=ie(t,Cj),(0,Cv.isNothing)(n.developerName)&&(n.developerName=ie(t,QT)),n.children=Pu(e,t,r),(0,Cv.isSome)(i)&&i(),Ef(r.metricsOptions.locationTracker)
const $=Ts(e,t,m)
if($){const t=new lz,r=b(T)
r.actionType=LF,r.targetType=cH,sp(e,t,r)
const o=new SY
o.shareAction=t,o.shareSheetData=$,n.contextMenuData=o}const F=null!=o?o:Xu(e,t)
let N=!1
F&&(N=!(zt(0,jt(e,F))>0))
const B=Tu(0,t.type,y)
n.offerDisplayProperties=r?ln(e,k,B,t,h,r.isContainedInPreorderExclusiveShelf,r.offerStyle,r.offerEnvironment,O[0],N,sH,r.shouldNavigateToProductPage,r.metricsOptions.isAdvert,0,r.parentAppData,r.isBuyDisallowed):ln(e,k,B,t,h,r.isContainedInPreorderExclusiveShelf,null,null,O[0],N,sH),r&&r.skipDefaultClickAction||(n.clickAction=Wu(e,t,T,{clientIdentifierOverride:m,productVariantData:g,isCppDeepLinkEligible:_})),r&&r.ordinal&&(n.ordinal=r.ordinal)
const U=Be(e,t,tU,null==r?void 0:r.attributePlatformOverride)
if(U){const e=f(U,cx),t=e&&e===lx
n.isEditorsChoice=t}D||(n.flowPreviewActionsConfiguration=Ss(e,t,!1,m,n.clickAction,r.metricsOptions,T,r.externalDeepLinkUrl,n.subtitle,n.title))
const G=Vf(e,t,n,I,r.metricsOptions,r.canDisplayArcadeOfferButton)
Bf(e,n,G)})}function Pu(e,t,n){const r=ve(t,BH)
return r?Uu(e,r,{lockupOptions:{...n,shouldCreateScreenshotsLockup:null==n?void 0:n.shouldIncludeScreenshotsForChildren},filter:0}):null}function Iu(e,t,n,r,s,a){var c
if(!t)return
if(s.isNetworkConstrained)return
const l=null!==(c=s.metricsOptions.isAdvert)&&void 0!==c&&c
Iv.context("copyMediaIntoMixedMediaLockup",()=>{n.screenshots=hd(e,t,4,null,s.clientIdentifierOverride,null,l,a)
const c=n.screenshots[0]
n.trailers=[]
const u=dd(e,t,r,s.metricsOptions,n.adamId,l,a)
i(u)&&(o(c)||u.mediaPlatform.isEqualTo(c.mediaPlatform))&&n.trailers.push(u)})}function Cu(e,t,n=null){return(0,Cv.isNothing)(t)?null:Iv.context("subtitleFromData",()=>{let r
return n&&n.subtitleObjectPath&&(r=Ge(e,t,n.subtitleObjectPath,null==n?void 0:n.attributePlatformOverride)),o(r)&&(r=Ge(e,t,lV,null==n?void 0:n.attributePlatformOverride)),r||Ru(e,t,n)})}function ku(e,t,n=!1,r){return Iv.context("badgeFromData",()=>{if(r)return null
const o=Pd(0,t,!1)
if(o){let r=""
const i=md(e,t)
if(Od(i,CH)?r="Platform.DesignedForPad":Od(i,RH)&&(r="Platform.DesignedForPhone"),(null==r?void 0:r.length)>0)return o&&(Eu(e,t)||(r+=".NotVerified",n&&(r+=".Expanded"))),e.loc.string(r)}return null})}function Ou(e,t){return Iv.context("badgeActionFromData",()=>{if(!Pd(0,t,!1))return null
if(Eu(e,t))return null
const n=md(e,t)
if(!Od(n,CH)&&!Od(n,RH))return null
const r=new dY(XV)
return r.pageUrl=`https://apps.apple.com/story/id${e.bag.appleSiliconMacUnverifiedBadgeEditorialItemId}`,r})}function Eu(e,t){if(!e.appleSilicon.isSupportEnabled)return!0
const n=je(e,t,HO,rH)
return!!i(n)&&n}function Ru(e,t,n=null){return Iv.context("categoryFromData",()=>{const r=Ge(e,t,FG,null==n?void 0:n.attributePlatformOverride)
if((null==r?void 0:r.length)>0)return r
const o=Ae(t,cF)
if(o.length>0){let e=o[0]
const t=6014..toString()
if(e.id===t)for(const n of o){const r=ie(n,fx)
if(n.id!==t&&r===t){e=n
break}}return ie(e,GH)}{const e=oe(t,qO)
return e.length>0?e[0]:null}})}function Du(e,t,n){return Iv.context("lockupFromData",()=>{var r,i,s,a,c,l,u,d
if(!t)return Iv.unexpectedNull(Qj,wG),null
const p=An(0,t)
n.metricsOptions.isAdvert=p
const h=function(e,t){var n
if((0,kv.isNothing)(t)||(0,kv.isNothing)(e))return!1
const r=null===(n=Df(t))||void 0===n?void 0:n.id
if((0,kv.isNothing)(r))return!1
const o=Fn(e,r)
return!(0,kv.isNothing)(o)&&Rf(t)===o}(null===(i=null===(r=n.metricsOptions.pageInformation)||void 0===r?void 0:r.iAdInfo)||void 0===i?void 0:i.placementType,n.metricsOptions.locationTracker)
if(n.metricsOptions.isAdEligible=h,(p||h)&&(null===(a=null===(s=n.metricsOptions.pageInformation)||void 0===s?void 0:s.iAdInfo)||void 0===a||a.apply(e,t)),p&&(null===(l=null===(c=n.metricsOptions.pageInformation)||void 0===c?void 0:c.iAdInfo)||void 0===l||l.setTemplateType(MB)),!le(t))return null
switch(t.type){case kV:return n.offerEnvironment=eb,_u(e,t,n)
case DH:const r=ye(e,t,SH)
if(o(r))return null
const i=new PY
return Su(e,r,i,n),i
case ZG:case Aj:return function(e,t,n){return Iv.context("appPromotionOfferLockupFromData",()=>{var r,o,i
const s=null!==(r=Xu(e,t))&&void 0!==r?r:n.parentAppData,a=Zu(e,t)
if(ae(s,E$)){const r=_u(e,t,n)
if((0,Cv.isNothing)(r))return null
r.offerDisplayProperties.titles[LH]=e.loc.string(tb),r.offerDisplayProperties.isStreamlinedBuy=!0,r.offerDisplayProperties.hasDiscount=!1
const o=ne(a,_H),i=Ui(e,s,_H),c=nd(e,o,{useCase:n.artworkUseCase,withJoeColorPlaceholder:n.useJoeColorIconPlaceholder,style:_B,overrideTextColorKey:n.overrideArtworkTextColorKey})
return r.icon=null!=c?c:i,r}{const r=new PY
Su(e,s,r,n)
const c=rp(e,t,n.metricsOptions,n.metricsClickOptions)
kf(e,c,r.title)
const l=Ge(e,s,zV),u=ie(a,xU),d=ie(s,XT),p=new GW(u,s.id,l,r.buttonAction,d)
if(p.appTitle=null!==(o=ie(s,GH))&&void 0!==o?o:"",p.productTitle=null!==(i=ie(a,GH))&&void 0!==i?i:"",t.type===Aj){const e=f(Qu(a),VO);(0,Cv.isSome)(e)&&e.length>0&&(p.additionalBuyParams="adHocOfferId="+e)}else p.additionalBuyParams="contingentItemId="+t.id
return r.buttonAction=p,Ef(n.metricsOptions.locationTracker),r}})}(e,t,n)
default:const s=new PY
return Su(e,t,s,n),(0,Cv.isSome)(null===(u=n.metricsOptions.pageInformation)||void 0===u?void 0:u.iAdInfo)&&((p||h)&&Tn(e,t,s,n.metricsOptions),p&&(null===(d=s.searchAdOpportunity)||void 0===d||d.setTemplateType(MB))),s}})}function _u(e,t,n){return Iv.context("inAppPurchaseLockupFromData",()=>function(e,t,n){return t?Iv.context("makeInAppPurchaseLockup",()=>{var r
const o=null!==(r=Xu(e,t))&&void 0!==r?r:n.parentAppData
if((0,Cv.isNothing)(o))return null
const i=ae(o,E$),a=Zu(e,t)
if((0,Cv.isNothing)(a))return null
t=a
const c=new RY
Su(e,t,c,n,o),c.productIdentifier=ie(t,xU),c.parent=Du(e,o,n),c.description=ie(t,fU),c.isVisibleByDefault=ae(t,"isMerchandisedVisibleByDefault"),c.isSubscription=ae(t,ux)
const u=jt(e,t),d=l(u,UO)
c.offerDisplayProperties&&(c.offerDisplayProperties.hasDiscount=d.length>0,c.offerDisplayProperties.subscriptionFamilyId=ie(t,"subscriptionFamilyId"))
const p=new dY(GO)
p.presentationContext=TG
const h=function(e,t,n){const r=(new qK).param(Hz.id,n).param(qz,t).build()
return`${Oz}:/${_z.product}/${_z.install}/?${r}`}(0,c.adamId,o.id)
p.pageUrl=h
const w=new uJ
w.parentLockup=b(c.parent),w.lockup=b(c),w.preInstallOfferDescription=Ii(e,u),p.pageData=w
const g=ie(t,xU),v=Ge(e,o,zV),m=ie(o,XT),y=s(Qu(t)),A=Vf(e,t,c,_B,n.metricsOptions,n.canDisplayArcadeOfferButton)
if(kf(e,A,c.title),i&&y){const r=new GW(g,o.id,v,c.parent.buttonAction)
c.parent&&(r.appTitle=c.parent.title),r.productTitle=c.title,r.streamlineBuyAction=function(e,t,n,r,o){var i
const a={...o.metricsOptions,id:n.id,targetId:n.id,idType:ZV,actionDetails:{parentAdamId:n.id}},c=bf(e,t,r.icon,o.clientIdentifierOverride),l=b(a),u=Qu(t),d=jt(e,t),p=jt(e,n),h=new sK(f(p,ZU))
let w=null!==(i=f(u,ZU))&&void 0!==i?i:f(d,ZU)
w+=`&appAdamId=${f(n,"id")}`,w+=`&appExtVrsId=${h.get(dx,"")}`,w+=`&bid=${Ge(e,n,zV)}`,w+="&bvrs=1.0",w+=`&offerName=${Ge(e,t,xU)}`
const g=f(u,VO)
return s(g)&&(w+=`&adHocOfferId=${g}`),d[ZU]=w,Ht(e,d,t,!1,!1,c,l,sH,null==o?void 0:o.referrerData,!1,n.id)}(e,t,o,c,n),c.buttonAction=r,c.subtitle=ie(o,GH)}else if(m){const t=new GW(g,o.id,v,p,m)
c.parent&&(t.appTitle=c.parent.title),t.productTitle=c.title
const r={...n.metricsOptions,id:c.adamId,idType:ZV,actionDetails:{parentAdamId:o.id}}
sp(e,t,r),c.buttonAction=t}else{const t=new tz(sH)
t.title=e.loc.string("SEED_IN_APP_UNSUPPORTED_MESSAGE_OPTION_1"),t.message="",t.isCancelable=!0,c.buttonAction=t}if(Ef(n.metricsOptions.locationTracker),!n||!n.skipDefaultClickAction){const n=Vu(e,t,A)
c.clickAction=n,c.productAction=n}return function(e,t,n){t&&(t.impressionMetrics||Bf(e,t,n),t.parent&&t.parent.adamId&&(0,kv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields.parentAdamId=vf(t.parent.adamId)))}(e,c,A),c},jO):null}(e,t,n))}function xu(e,t,n){return Iv.context("screenshotsLockupFromData",()=>{const r=new IY
return function(e,t,n,r){t&&Iv.context("copyDataIntoScreenshotsLockup",()=>{Su(e,t,n,r),n.screenshots=hd(e,t,4,null,r.clientIdentifierOverride)})}(e,t,r,n),r})}function Lu(e,t,n){return Iv.context("posterLockupFromData",()=>{const o=new sJ
return function(e,t,n,o){t&&Iv.context("copyDataIntoPosterLockup",()=>{Su(e,t,n,o),n.epicHeading=function(e,t){const n=Be(e,t,"editorialArtwork.epicHeading")
return i(n)&&i("bb")?nd(e,n,{cropCode:"bb",useCase:0}):null}(e,t),n.posterArtwork=function(e,t){const n=Be(e,t,"editorialArtwork.postCard")
return i(n)?nd(e,n,{cropCode:"sr",useCase:0,withJoeColorPlaceholder:!0}):null}(e,t),n.posterVideo=function(e,t,n){const o=Be(e,t,[oH,DA]),s=nd(e,Be(e,t,[oH,DA,vU]),{useCase:19,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(o)){const e=f(o,DV)
return r(e)?null:new Vq(e,s,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1},autoPlayPlaybackControls:{prominentPlay:!1,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!1}})}return null}(e,t),n.offerDisplayProperties&&(n.offerDisplayProperties=n.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,BV,ZN)),n.posterVideo?n.isDark=K(n.posterVideo.preview.backgroundColor):n.posterArtwork?n.isDark=K(n.posterArtwork.backgroundColor):n.isDark=!1
const s=Ve(e,t,mU)
if(Ve(e,t,VV)){const r=s?e.loc.string("Offer.Label.ComingSoon"):null
let o
o=e.loc.uppercased(af(e,t,r)),(0,Cv.isSome)(o)&&(n.footerText=o)}})}(e,t,o,n),o})}function Mu(e,t,n,r,o=null,i){return Iv.context("mixedMediaLockupFromData",()=>{const s=new CY
return Su(e,t,s,n,null,()=>{bu(e,t,s,o,n),Iu(e,t,s,r,n,i),Fu(e,t,s,o)}),s})}function $u(e,t,n,r){const o=t.type===OH?ye(e,t,Yj):t,i=Du(e,o,n),s=qe(e,o),a=vu(e,o,r),c=vu(e,t,r),l=null==a?void 0:a.artwork,u=null==c?void 0:c.artwork
let d,f
if((0,Cv.isSome)(u),(0,Cv.isSome)(l)&&(f=hu(0,a),d=l),(0,Cv.isSome)(d)&&(0,Cv.isSome)(i)){const e=new _Y(d,i,null,null,f)
return e.caption=_e(o,s,QB),(0,Cv.isSome)(e.caption),e.title=_e(o,s,LG)||ie(o,FG),e.impressionMetrics=i.impressionMetrics,e}return null}function Fu(e,t,n,r){var o
if(!e.client.isPhone)return
const s=f(t.meta,"imageLockupFromData")
i(s)?n.screenshotsDisplayStyle=s:i(null===(o=null==r?void 0:r.displayStyle)||void 0===o?void 0:o.screenshots)&&(n.screenshotsDisplayStyle=r.displayStyle.screenshots)}function Nu(e,t,n,r,o,i=!0){return Iv.context("mixedMediaAdLockupFromData",()=>{const s=new CY
return ae(t,"iad.format.images")?(Iu(e,t,s,r,n),function(e,t,n,r){if(!function(e,t){const n=function(e,t,n){const r=Qe(e,t)
return(0,Cv.isNothing)(r)?null:it(r,n)}(e,t,ax)
return!n}(e,t))return
const o=oe(t,"iad.assetOverride")
o.length&&(function(e,t,n){const r=new Set(n),o=[],i=[],s=function(e,t){if(0===r.size)return!1
for(const o of n)if(o===t||-1!==e.indexOf(o))return r.delete(o),!0
return!1}
if(n.length&&(t.screenshots.length||t.trailers.length)){if(t.trailers.length)for(const e of t.trailers[0].videos)s(e.videoUrl,e.preview.checksum)&&o.push(e)
if(t.screenshots.length)for(const e of t.screenshots[0].artwork)s(e.template,e.checksum)&&i.push(e)}0===r.size&&(o.length||i.length)&&(t.trailers.length&&(t.trailers[0].videos=o),t.screenshots.length&&(t.screenshots[0]=new Tq(i,t.screenshots[0].mediaPlatform)))}(0,n,o),r.pageInformation.iAdInfo&&r.pageInformation.iAdInfo.iAdIsPresent)}(e,t,s,n.metricsOptions),Su(e,t,s,n,null,()=>{Fu(e,t,s,o),bu(e,t,s,o,n)})):(Su(e,t,s,n,null,()=>{bu(e,t,s,o,n)}),s.screenshots=[]),Tn(e,t,s,n.metricsOptions,i),s})}function Bu(e,t,n,r,i,s){return Iv.context("arcadeLockupFromData",()=>{const a=t.marketingItemData,c=new DY
c.title=e.loc.string("ARCADE_LOCKUP_TITLE","Apple Arcade")
const l=t.marketingItemData
n={...n,mercuryMetricsData:Sf(0,l)}
let u,d=xa(0,a);(null==d?void 0:d.length)>0&&(d=d.replace(/\n/g," "),c.nonsubscribedSubtitle=d,c.subscribedSubtitle=d)
const f=_a(0,a)
u=Ma(e,t.marketingItemData,r,n),u.title=f,c.unsubscribedButtonAction=u
const p=fp(0,n.pageInformation,n.locationTracker)
p.title=e.loc.string(pN,hN),c.subscribedButtonAction=p
const h=Hf(e,t.marketingItemData,c.title,n)
h.displaysArcadeUpsell=!0,o(h.targetType)&&(h.targetType=cH),Bf(e,c,h)
const w=new vq(xH,e.bag.arcadeAppAdamId,null,i,null,s,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
return w.titles[oB]=e.loc.string(pN,hN),c.offerDisplayProperties=w,c})}function Uu(e,t,n){return r(t)?[]:Gu(e,t.data,n)}function Gu(e,t,n){return Iv.context("lockupsFromData",()=>{var o
if(!t)return[]
const s=[]
let a=!1
for(let c=0;c<t.length&&!a;c++){const l=t[c]
if(!le(l)){n.contentUnavailable&&(a=n.contentUnavailable(c,l))
continue}const u=n.lockupOptions
let d=80894
if(n.includeOrdinals){const r=n.ordinalDirection===nb?t.length-c:c+1
u.ordinal=e.loc.decimal(r).toString()}if(i(n.filter)&&(d=n.filter),vt(e,l,d)&&!n.shouldShowOnUnsupportedPlatform)continue
const f=null!==(o=n.lockupOptions.shouldCreateScreenshotsLockup)&&void 0!==o&&o?xu(e,l,u):Du(e,l,u)
!r(f)&&f.isValid()&&(s.push(f),xf(n.lockupOptions.metricsOptions.locationTracker))}return s})}function ju(e,t,n,r,s=null,a){return Iv.context(`actionFromData: ${t.type}`,()=>{switch(t.type){case BH:case IH:return Wu(e,t,n,{clientIdentifierOverride:r,externalDeepLinkUrl:s,isCppDeepLinkEligible:a})
case kV:return Vu(e,t,n)
case OH:return qu(e,t,n,r)
case tj:case vV:return function(e,t,n){return t?Iv.context("editorialPageActionFromData",()=>{const r=new dY(jH)
{const n=t.href
if(o(n))return Iv.unexpectedNull(Qj,gH,eU),null
r.pageUrl=Er(e,n)}return r.title=Zd(e,t,GH),o(r.title)&&(r.title=ie(t,GH)),sp(e,r,n),r}):null}(e,t,n)
case px:return function(e,t,n){return t?Iv.context("msoActionFromPlatformData",()=>{const r=ie(t,AH)
if(!r)return Iv.unexpectedNull(Qj,gH,AH),null
const o=new dY(oF)
return o.pageUrl=r,o.title=ie(t,GH),sp(e,o,n),o}):null}(e,t,n)
case pj:return function(e,t,n){return t?Iv.context("groupingActionFromData",()=>{if(!t.href)return Iv.unexpectedNull(Qj,gH,eU),null
const r=new dY(jH)
return r.pageUrl=at(e,function(e,t){const n=[lH,oH,Nj,Uj,eV,nj]
e.appleSilicon.isSupportEnabled&&n.push(iV),e.bag.enableUpdatedAgeRatings&&n.push(zj),ad(e)&&n.push(Zj)
const r=new wJ(e,t).includingAttributes(n).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported()
$i(e)&&(r.enablingFeature(PV),r.includingScopedAttributes(DH,eQ),r.includingScopedRelationships(DH,[SH]),r.includingScopedRelationships(eA,[DH]))
const o=U(e)
return i(o)&&r.addingQuery(hU,o),r}(e,t.href)).toString(),r.title=Ju(0,t),sp(e,r,n),r}):null}(e,t,n)
default:return function(e,t,n){return t?Iv.context("genericActionFromData",()=>{const r=f(t,oj),o=ie(t,AH)
if(!o)return Iv.unexpectedNull(Qj,gH,AH),null
const i=new dY(jH)
return i.pageUrl=o,i.title=r===pj?Ju(0,t):ie(t,GH),sp(e,i,n),i}):null}(e,t,n)}})}function Vu(e,t,n){return Iv.context("iAPActionFromData",()=>{var r
const o=Xu(e,t)
if(!o)return null
const s=new dY(Jj),a=oY.from(ie(o,AH)),c=et(null!==(r=n.productVariantData)&&void 0!==r?r:Qe(e,o))
i(c)&&a.param(Hz.productVariantID,c)
const l=a.toString(),u=ie(t,xU),d=ae(t,ux)
return s.pageUrl=function(e,t,n,r){const o=(new qK).param(Wz,t).param(Hz.offerName,n).param(zz,r.toString()).build()
return`${Oz}:/${_z.product}/${_z.lookup}/?${o}`}(0,l,u,d),s.title=ie(t,GH),sp(e,s,n),s})}function Hu(e,t){return o(t)?0:Iv.context(rb,()=>{if(function(e){const t=f(e,nM)
return t&&t===p_}(ne(t,uH)))return 1
const e=ie(t,ob),n="List"===e||"NumberedList"===e
if(ae(t,UN)||n)return 2
const r=Ae(t,Yj),o=Ae(t,sV),i=s(r)&&1===r.length,a=s(o)&&1===o.length
return a&&o[0].type===DH||i&&r[0].type===DH?4:a?3:0})}function qu(e,t,n,a,c,l){return o(t)?null:Iv.context(rb,()=>{var u
let d,p,h
switch(Hu(0,t)){case 1:return function(e,t,n){return Iv.context("editorialItemExternalLinkActionFromData",()=>{const r=f(ne(t,uH),AH),o=new MW(r),i=Kd(e,t,kG)
if(i)o.title=i
else{const e=new oY(r)
o.title=e.host}return sp(e,o,n),o})}(e,t,n)
case 2:d=XV
const h=oY.from(ie(t,AH))
i(c)&&h.param(Hz.recoMetrics,JSON.stringify(c)),(0,Cv.isSome)(l)&&!l.isHorizontalShelfContext&&h.param(Hz.todayCardConfig,JSON.stringify(l))
const w=null===(u=wt(t))||void 0===u?void 0:u.id;(0,Cv.isSome)(w)&&h.param(Hz.editorialCardId,w),p=h.build()
break
case 3:const g=Ae(t,sV)[0]
return ju(e,g,n,a)
case 4:const v=Ae(t,Yj),m=s(v)&&1===v.length?v[0]:Ae(t,sV)[0],y=ye(e,m,SH)
if(o(y))return null
const A=zi(e,m,y,!1,!1,mH,pV,!1,n,!1,!0,null,!1,!1)
return r(A)||A instanceof Date?null:Hi(e,m,y,A,n,!0)
case 5:d=jH,p=Er(e,t.href)
break
default:d=TH,p=f(ne(t,uH),AH)}if((0,Cv.isNothing)(p))return null
const w=new dY(d)
w.pageUrl=p,(0,Cv.isSome)(h)&&(w.presentation=h)
let g=Kd(e,t,GH)
return r(g)&&(g=f(t,CV)),w.title=g,sp(e,w,n),w})}function Wu(e,t,n,r){var o,s,a,c
if(!t)return null
const l=null!==(o=r.clientIdentifierOverride)&&void 0!==o?o:null,u=null!==(s=r.externalDeepLinkUrl)&&void 0!==s?s:null,d=!(null!==(a=r.isCppDeepLinkEligible)&&void 0!==a&&a),p=null!==(c=r.productVariantData)&&void 0!==c?c:Qe(e,t)
return Iv.context("productActionFromData",()=>{var r,o,s
let a=ie(t,AH)
if(!a)return Iv.unexpectedNull(Qj,gH,AH),null
let c={}
const h=new oY(a)
if(n.isAdvert){const o=f(t,ib)
null!==o&&o.length>0&&h.param(KX,o)
const i=null===(r=n.pageInformation.iAdInfo)||void 0===r?void 0:r.clickFields
h.param(JX,JSON.stringify(i)),c={iAdClickFields:y(i),iAdLineItem:o}
const s=Bn(0,t)
if((0,Cv.isSome)(s)){const r=Jd(e,t)?fN:ix,o=En(0,n.pageInformation),i=ie(t,sx),a=ae(t,VV)?Ej:LH,l=new yK(s,t.id,i,r,"productPageDismissed",a,o)
h.param(ZX,JSON.stringify(l)),c.iAdDismissAdActionMetrics=y(l)}}const w=et(p)
i(w)&&h.param(Hz.productVariantID,w),c.externalDeepLinkUrl=u,i(u)&&h.param(WK,u),ul(e).platform,zu(e,t)
{c.isCppDeepLinkDisabled=d,h.param(zK,d.toString())
const e=null===(s=null===(o=n.pageInformation)||void 0===o?void 0:o.searchTermContext)||void 0===s?void 0:s.term;(0,Cv.isSome)(e)&&h.param(oV,e),c.clientIdentifierOverride=l,(null==l?void 0:l.length)>0&&h.param(sb,l)}a=h.toString()
const g=new dY(Jj)
g.pageUrl=a,g.pageData=su(e,t,c),g.title=ie(t,GH),n&&n.pageInformation&&(g.referrerUrl=n.pageInformation.pageUrl)
const v=ae(t,VV)
sp(e,g,v?{...n,offerType:Ej,offerReleaseDate:Wt(0,t)}:n,!0)
const m=f(t,"id")
return(0,Cv.isSome)(m)&&(g.destination=t.type===IH?function(e){const{id:t,platform:n,...r}=e
return{$kind:"BundlePageIntent",id:At(t),platform:Tt(n),...r}}({...Cr(e),id:m}):function(e){const{id:t,platform:n,ppid:r,...o}=e
return{...o,$kind:"ProductPageIntent",id:At(t),platform:Tt(n),ppid:r}}({...Cr(e),platform:Yu(e,t),id:m})),g})}function zu(e,t){try{return function(e,t){const n=(0,Cv.unwrapOptional)(j(e,t)),r=new Set(Ne(e,n,!0))
if(r.has(aH))return aH
if(r.has(iH))return iH
if(r.has($H))return $H
if(r.has(xj))return kH
if(r.has(EU))return"tv"
if(r.has(MH))return MH
throw new Error("Could not infer platform from device families")}(e,{data:[t]})}catch(t){return void e.console.error(`Error inferring preview platform from data: ${t}`)}}function Yu(e,t){return ul(e).platform||zu(e,t)}function Ju(e,t){const n=oe(t,qO)
return s(n)?n[0]:ie(t,GH)}function Ku(e,t){if(!t)return!1
if(e.client.isCompanionVisionApp)return!0
const n=function(e,t,n){return Ge(e,t,Pd(0,t,n)?iV:Uj)}(e,t,e.appleSilicon.isSupportEnabled)
if(o(n))return!0
const r=n.split(" ")
return e.client.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(r,!1)}function Zu(e,t){if(!t)return null
switch(t.type){case ZG:return ye(e,t,$N)
case Aj:return ye(e,t,FN)}return t}function Qu(e){if(!e)return null
const t=h(e,S$)
if(s(t))return t
const n=h(e,GD)
return s(n)?n:null}function Xu(e,t){if(!t)return null
switch(t.type){case ZG:return ye(e,t,YL)
case Aj:const n=ye(e,t,FN)
return ye(e,n,SH)}return ye(e,t,SH)}function ed(e,t){t.bag.arcadeDownloadPacksMetricsEventsEnabled||(e.clickAction.actionMetrics.clearAll(),e.buttonAction.actionMetrics.clearAll(),e.buttonAction instanceof jW&&e.buttonAction.defaultAction.actionMetrics.clearAll()),t.bag.arcadeDownloadPacksImpressionEventsEnabled||(e.impressionMetrics=null)}function td(e,t){switch(t){case JF:case Vk:case eH:return 1
case LV:return 2
case KF:return 3
default:return 0}}function nd(e,t,n){return Iv.context("artworkFromApiArtwork",()=>{var o,s,a
const c=!!i(n.allowingTransparency)&&n.allowingTransparency,l=!!i(n.withJoeColorPlaceholder)&&n.withJoeColorPlaceholder,d=f(t,AH)
if(r(d))return null
const h=u(t,"hasP3"),w=[be(e,c,h,n.useCase)]
u(t,"supportsLayeredImage")
let g=null
if(c)g=Z(wU)
else if(l){const e=uf(t),i=z(null!==(s=null===(o=n.joeColorPlaceholderSelectionLogic)||void 0===o?void 0:o.call(n,e))&&void 0!==s?s:f(t,LU))
r(i)||(g=i)}r(g)&&(g=Z(Hk))
const v=null!==(a=n.overrideTextColorKey)&&void 0!==a?a:S_,m=z(f(t,v)),y=new Aq(d,n.overrideWidth||p(t,qB),n.overrideHeight||p(t,gU),w)
return y.backgroundColor=g,y.checksum=f(t,qk),i(m)&&(y.textColor=m),i(n.style)&&(y.style=n.style),i(n.cropCode)&&(y.crop=n.cropCode),i(n.contentMode)&&(y.contentMode=n.contentMode),y})}function rd(e,t,n,r){return Iv.context(AA,()=>{const o=sd(e,t,r)
if(!i(o))return null
const s=new pY(o),a=ie(t,GH),c=Hf(e,t,a,n)
return Bf(e,s,c),s})}function od(e,t,n,r){return Iv.context(AA,()=>{const i=[]
o(n.targetType)&&(n.targetType=_H)
for(const o of t){const t=rd(e,o,n,r)
t&&(i.push(t),xf(n.locationTracker))}return i})}function id(e,t,n,r){const i=Be(e,t,"editorialArtwork.searchCategoryBrick")
if(o(i))return null
let s=r
n===Am.seeAllPage&&(s=Wv.Density1)
let a=[],c=[]
switch(s){case Wv.Density1:const e=n===Am.categoryBreakout?"1191":"2350"
i[qB]=e,i[gU]=P_,a=["SCB.ApSCBL01","SCB.ApSCBL03"],c=[Ov.right,Ov.left]
break
case Wv.Density2:i[qB]="2482",i[gU]=P_,a=["SCB.ApSCBS01","SCB.ApSCBS02"],c=[Ov.left,Ov.right]
break
case Wv.Density3:i[qB]=P_,i[gU]=P_,a=["cc"],c=[Ov.scaleAspectFit]}return a.map((t,n)=>nd(e,i,{cropCode:t,contentMode:n<c.length?c[n]:null,useCase:0,withJoeColorPlaceholder:!0}))}function sd(e,t,n,o,s,a){return Iv.context("iconFromData",()=>{if(!t)return Iv.unexpectedNull(Qj,wG),null
const c=null!=a?a:ld(e,t,o),l=cd(e,t),u=o||e.host.clientIdentifier,d=function(e,t,n,r,o,i){if(r!==Zq&&!Ve(e,t,uU))return null
if(o){const r=Re(t,i,TA)
if((0,Cv.isSome)(r))return nd(e,r,{...n,style:I_,cropCode:"bb",withJoeColorPlaceholder:!0})}const s=Re(t,i,Wk)
if((0,Cv.isSome)(s)){const t=o?I_:hM,r=o?"ic":void 0
return nd(e,s,{...n,style:t,cropCode:r,withJoeColorPlaceholder:!0})}return null}(e,t,n,u,l,c)
if((0,Cv.isSome)(d))return d
const f=function(e,t,n,r,o){const s=Wd(e,t),a=Hd(e,t)&&(r===Qq||s),c=Re(t,o,zk)
return a&&i(c)?nd(e,c,{...n,style:F$}):null}(e,t,n,u,c)
if((0,Cv.isSome)(f))return f
const p=function(e,t,n){if(t.type!==kV)return null
const r=ne(t,_H)
return(0,Cv.isSome)(r)?nd(e,r,{...n,style:_B}):null}(e,t,n)
if((0,Cv.isSome)(p))return p
const h=function(e,t,n,r){if(t.type!==IH)return null
if(r){const r=ne(t,Zj)
if((0,Cv.isSome)(r))return nd(e,r,{...n,style:ZF,cropCode:"bb"})}const o=ne(t,_H)
if((0,Cv.isSome)(o)){const t=r?ZF:VF,i=r?"ia":void 0
return nd(e,o,{...n,style:t,cropCode:i,allowingTransparency:!0})}return null}(e,t,n,l)
if((0,Cv.isSome)(h))return h
r(s)&&(s=Qe(e,t))
const w=ze(e,t,s,_H,c),g=function(e,t,n,r,o){return o!==RG&&r!==eW?null:nd(e,t,{...n,style:C_})}(e,w,n,u,c)
if((0,Cv.isSome)(g))return g
const v=function(e,t,n,r,o){return o!==$j&&"VisionAppStore"!==r?null:nd(e,t,{...n,style:hM})}(e,w,n,u,c)
return(0,Cv.isSome)(v)?v:function(e,t,n,r,o,i,s){const a=s===Gj,c=a&&!0
if(o){const n=ze(e,t,i,Zj,s)
if((0,Cv.isSome)(n))return nd(e,n,{...r,style:ZF,cropCode:"bb",allowingTransparency:c})}let l,u
return o?(l=ZF,u=a?"ib":"ia"):(l=a?N$:VF,u="bb"),nd(e,n,{...r,style:l,cropCode:u,allowingTransparency:c})}(e,t,w,n,l,s,c)})}function ad(e){return Rt(e,e.bag.iconArtworkRolloutRate)&&e.bag.enableIconArtwork&&!0}function cd(e,t){const n=md(e,t),r=e.bag.enableIPadOnlyFallbackIcons&&-1!==n.indexOf(CH)&&-1===n.indexOf(RH)
return ad(e)&&!r}function ld(e,t,n){switch(n){case Zq:case Qq:return rH
case eW:return RG
case"VisionAppStore":return $j
default:return qe(e,t,n)}}function ud(e,t,n,r){if(!t)return null
const o=ef(t),i=tf(0,n),s=function(e,t){switch(t){case E_:return 13/a4.width
case O_:return 11/c4.width
case k_:return 5.5/l4.width
case wM:return I4/u4.width
case gM:return I4/d4.width
default:return null}}(0,n),a=function(e,t){switch(t){case E_:return 30/a4.width
case wM:return P4/u4.width
case gM:return P4/d4.width
default:return tf(0,t)}}(0,n)
return new bq(t,n,o,r,i,s,a)}function dd(e,t,n,r,o,i=!1,s){const a=fd(e,t,n,null,null,i,s)
if(!a)return null
const c=a.videos,l=[]
if(c&&c.length>0)for(const t of c)vo(e,t,{...r,id:o}),l.push(t)
let u=null
return l.length>0&&(u=new EY,u.videos=l,u.mediaPlatform=a.mediaPlatform),u}function fd(e,t,n,o=null,s=null,a=!1,c){return Iv.context("platformVideoPreviewFromData",()=>{r(s)&&(s=Qe(e,t))
const u=function(e,t,n,r,o){return ze(e,t,n,r?Xk:tG,void 0)}(e,t,s,a),d={}
if(!u)return null
let w=vd(e,t,e.host.clientIdentifier,e.client.deviceType)
if(i(o)){const e=[]
for(const t of w)o.includes(t)&&e.push(t)
w=e}if(0===w.length)return null
for(const t of w){const r=xd(e,t,e.client.screenSize)
for(const t of Object.keys(u)){const r=l(u,t),o=[]
for(const s of r){const r=h(s,vU)
if(!r){Iv.unexpectedNull(Qj,EG,`videoPreviewsByType.${t}.previewFrame`)
continue}const a=f(s,DV)
if(!a){Iv.unexpectedNull(Qj,gH,`videoPreviewsByType.${t}.video`)
continue}const l=Se(e,f(r,AH),p(r,qB),p(r,gU),null,null,f(r,qk))
i(c)&&(l.crop=c),o.push(new Vq(a,l,n))}d[t]=o}for(const e of r)if(d[e])return new G2(d[e],ud(0,t,e))}return null})}function pd(e,t){return Iv.context("videoPreviewsFromApiPlatformData",()=>{const n=fd(e,t,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}})
return n?n.videos:[]})}function hd(e,t,n,o=null,i,s,a=!1,c){return Iv.context("screenshotsFromData",()=>{const l=[]
r(s)&&(s=Qe(e,t))
let u=o
if(!u||0===u.length){const n=i||e.host.clientIdentifier
let r=e.client.deviceType
n===Zq&&(r=MH),"VisionAppStore"!==i&&"com.apple.visionproapp"!==i||(r=kH),u=vd(e,t,n,r)}for(const r of u){const o=[]
let i
if(r===_V?(i=zd(e,t,rH),qd(e,t,rH)&&o.push("faceTime")):i="tv"===r?Yd(e,t,s,a,RG):r===kH?Yd(e,t,s,a,$j):r===$H?Yd(e,t,s,a,Gj):Yd(e,t,s,a),!i)continue
const u=gd(e,i,r,n,o,c)
u&&l.push(u)}return l})}function wd(e,t,n,r=null,o=null,i){return function(e,t,n){const r=[]
if(n&&n.length>0){const o=n.map(e=>e.mediaPlatform)
for(const i of n){const n=[]
for(const e of i.artwork){const t=new mY
t.screenshot=e,n.push(t)}const s=i.mediaPlatform,a=new yY(n,s,o,bd(e,s),yd(e,t,o),Ad(e,t,o))
r.push(a)}}return r}(e,t,hd(e,t,n,r,i,o))}function gd(e,t,n,r,o,i){const a=function(e,t){return t===_V?e.client.deviceType===CH?CH:RH:t}(e,n),c=xd(e,a,e.client.screenSize)
let u,d=null
for(let e=0;e<c.length&&!s(d);e++)d=l(t,c[e]),u=c[e]
if(s(d)){const t=d.map(function(t){return nd(e,t,{useCase:r,cropCode:i})}),s=ud(0,n,u,o)
return new Tq(t,s)}return null}function vd(e,t,n,r){return Ce(t,`sortedAppPlatformsFromData.${n}.${r}`,()=>{var o
const i=md(e,t),s=[]
let a=[]
const c=function(e,t){-1===a.indexOf(e)&&-1===s.indexOf(e)&&-1!==i.indexOf(e)&&(a.push(e),t&&s.push(t))}
switch((null===(o=e.activeIntent)||void 0===o?void 0:o.appPlatform)&&c(e.activeIntent.appPlatform),"VisionAppStore"!==n&&"com.apple.visionproapp"!==n||c(kH),n){case Zq:c(MH)
break
case Qq:c(_V)}switch(r){case RH:c(RH)
break
case CH:c(CH)
break
case"tv":c("tv")
break
case MH:c(MH)
break
case $H:c($H)
break
case kH:c(kH)}return"VisionAppStore"!==n&&"com.apple.visionproapp"!==n||(c(CH),c(RH)),e.appleSilicon.isSupportEnabled?(c(CH),c(RH)):(c(RH),c(CH)),c($H),c(kH),c("tv"),c(MH),c(_V),a=a.filter(function(e){return-1===s.indexOf(e)}),a})}function md(e,t){return t?Ce(t,"supportedAppPlatformsFromData",()=>{const n=Hd(e,t,rH),r=Wd(e,t),o=function(e,t){return Ve(e,t,Nj)}(e,t),i=oe(t,MU),s=[]
for(const e of i)switch(e){case aH:r||s.push(RH)
break
case iH:r||s.push(CH)
break
case EU:s.push("tv")
break
case MH:s.push(MH)
break
case xj:s.push(kH)}return n&&s.push(_V),o&&s.push(MH),Me(e,t,$H)&&s.push($H),s}):null}function yd(e,t,n){if(Td(e,t,n)){const t=n[0].appPlatform.toUpperCase()
return e.loc.string(`ONLY_FOR_${t}_APP`)}let r=n.reduce((e,t)=>e.concat(Sd(t)),[])
try{return e.loc.tryString(`PLATFORMS_${r.join("_")}`)}catch(t){return r=["PHONE","PAD","MAC","VISION","TV","WATCH","MESSAGES","FACETIME"].filter(e=>r.includes(e)),e.loc.string(`PLATFORMS_${r.join("_")}`)}}function Ad(e,t,n){return Td(e,t,n)?"top":"bottom"}function Td(e,t,n){if(1===n.length){const r=n[0],o=Pd(0,t,e.appleSilicon.isSupportEnabled),i=!1,s=Od(kd(0,e.client.deviceType,o,i),r.appPlatform),a=0===r.supplementaryAppPlatforms.length,c=r.appPlatform!==e.client.deviceType
if(a&&c&&!s)return!0}return!1}function bd(e,t){const n=Sd(t)
return e.loc.string(`PLATFORMS_${n.join("_")}`)}function Sd(e){const t=e.appPlatform.toUpperCase(),n=e.supplementaryAppPlatforms.map(e=>e.toUpperCase())
return[t].concat(n)}function Pd(e,t,n){let r=ae(t,jD)
return n&&r}function Id(e,t){let n
return e.isAvailable(XH)&&[$U,LB].includes(e.client.buildType)&&(0,Cv.isSome)(e.ads.fetchAppBinaryTraitsOverride)&&(n=e.ads.fetchAppBinaryTraitsOverride()),(0,Cv.isNothing)(n)&&(n=De(t,rH,bA)),n}function Cd(e,t,n){if(Pd(0,t,n)){const n=Ge(e,t,"minimumMacOSVersion")
if(s(n))return n}return _e(t,qe(e,t),eV)}function kd(e,t,n,r){switch(t){case RH:return[RH,_V]
case CH:return[RH,CH,_V]
case"tv":return["tv"]
case MH:return[MH]
case $H:return n?[$H,RH,CH]:[$H]
case kH:return r?[kH,RH,CH]:[kH]
default:return[]}}function Od(e,t){return-1!==e.indexOf(t)}function Ed(e,t,n,r,o,i,s=!0){const a=function(e,t,n,r,o){let i
switch(n){case RH:return i=gt(e),(0,Cv.isSome)(t)&&i.isSystemAppFromData(t)?[RH,MH,_V]:[RH,MH,_V,"tv",kH]
case CH:return i=gt(e),(0,Cv.isSome)(t)&&i.isSystemAppFromData(t)?[RH,CH,_V]:[RH,CH,_V,"tv",kH]
case"tv":return["tv"]
case MH:return[MH]
case $H:return r?[$H,RH,CH]:[$H]
case kH:return o?[kH,RH,CH]:[kH]
default:return[]}}(e,t,r,o,i)
return!!a.some(e=>Od(n,e))}function Rd(e,t){var n
const o=new U2
if(e.client.deviceType!==$H)return o
if(t.type!==IH)return o.runsOnIntel=null===(n=je(e,t,"runsOnIntel",We(e)))||void 0===n||n,o.runsOnAppleSilicon=Ve(e,t,"runsOnAppleSilicon",We(e)),o.requiresRosetta=Ve(e,t,SA,We(e)),o
const i=Ae(t,BH)
if(0===i.length)return o
for(const t of i){if(r(t.attributes))continue
const n=Rd(e,t)
o.runsOnIntel=o.runsOnIntel&&n.runsOnIntel,o.runsOnAppleSilicon=o.runsOnAppleSilicon&&n.runsOnAppleSilicon,o.requiresRosetta=o.requiresRosetta||n.requiresRosetta}return o}function Dd(e,t,n,r){const o=Rd(e,t)
return n?o.runsOnAppleSilicon&&(!o.requiresRosetta||o.requiresRosetta&&r):o.runsOnIntel}function _d(e,t,n,r,o){const i=function(e,t,n,r){switch(t){case RH:return[RH,MH,_V]
case CH:return[RH,CH,_V]
case"tv":return["tv"]
case MH:return[MH]
case $H:return n?[$H,RH,CH]:[$H]
case kH:return r?[kH,RH,CH]:[kH]
default:return[]}}(0,n,r,o)
return i.some(e=>Od(t,e))}function xd(e,t,n){switch(t){case $H:return[$H]
case MH:return n.isEqualTo(f4)||n.isEqualTo(b4)?[wM,gM,k_,O_,E_]:[gM,wM,k_,O_,E_]
case"tv":return["appleTV"]
case kH:return["appleVisionPro"]
case CH:{const t=[]
return(n.isEqualTo(X2)||n.isEqualTo(e4)||n.isEqualTo(r4)||n.isEqualTo(o4))&&e.client.screenCornerRadius>0?(t.push(jN),t.push(VN),t.push(QF),t.push(XF),t.push(iH)):n.isEqualTo(Q2)?(t.push(QF),t.push(jN),t.push(VN),t.push(XF),t.push(iH)):n.isEqualTo(K2)||n.isEqualTo(Z2)||n.isEqualTo(t4)||n.isEqualTo(n4)||n.isEqualTo(i4)||n.isEqualTo(s4)?(t.push(VN),t.push(jN),t.push(QF),t.push(XF),t.push(iH)):n.isEqualTo(J2)?(t.push(XF),t.push(iH),t.push(VN),t.push(QF),t.push(jN)):n.isEqualTo(p4)?(t.push(VN),t.push(QF),t.push(jN),t.push(XF),t.push(iH)):n.isEqualTo(Y2)?(t.push(iH),t.push(XF),t.push(VN),t.push(QF),t.push(jN)):(t.push(jN),t.push(VN),t.push(iH),t.push(XF),t.push(QF)),t}case RH:{let e
e=n.isEqualTo(j2)||n.isEqualTo(g4)?Yk:n.isEqualTo(V2)||n.isEqualTo(h4)||n.isEqualTo(w4)?R_:n.isEqualTo(z2)?aH:n.isEqualTo(W2)?PA:n.isEqualTo(q2)?IA:n.isEqualTo(H2)?CA:n.isEqualTo(v4)||n.isEqualTo(y4)?Jk:n.isEqualTo(m4)||n.isEqualTo(A4)||n.isEqualTo(T4)?Kk:R_
const t=S4.indexOf(e),r=S4.slice(0,t)
r.reverse()
const o=S4.slice(t+1)
return[e].concat(r,o)}default:return[]}}function Ld(e,t){if(r(t))return null
const n=Be(e,t,Zy),o=Be(e,t,Qy),i=Pd(0,t,!0)
if($e(e,t,$H)&&!i){const i=e.bag.enableProductPageInstallSize?function(e,t){const n=Re(t,Gj,Xy)
if((0,Cv.isNothing)(n))return null
const r=n[ZC]
return(0,Cv.isNothing)(r)?null:p(r)}(0,t):function(e,t){const n=jt(e,t)
if(r(n))return null
const o=l(n,"assets")
if(!o.length)return null
for(const e of o)if(f(e,"flavor")===Wb)return p(e,Ux)
return null}(e,t)
if(s(o)){const e=p(o,kA)
return new Hq(i,null,null,e)}if(s(n)){const e=p(n,OA),t=p(n,EA)
return new Hq(i,e,t,null)}return new Hq(i,null,null,null)}{const r=ne(t,Jy)
if(r){let t=[]
e.client.thinnedApplicationVariantIdentifier&&(t=e.client.thinnedApplicationVariantIdentifier.split(" ")),t=t.concat([e.host.deviceModel,"universal"])
for(const e of t){const t=p(r[e])
if(t){if(s(o)){const e=p(o,kA)
return new Hq(t,null,null,e)}if(s(n)){const e=p(n,OA),r=p(n,EA)
return new Hq(t,e,r,null)}return new Hq(t,null,null,null)}}}}return null}function Md(e,t,n){let r,s=null,a=null,c=null,l=null
switch(e.client.deviceType){case $H:n.supportsArcade?(s=Zk,c="sr"):(s="editorialArtwork.centeredFullscreenBackground",c="ep")
break
case"tv":n.presentedInTopShelf?(s=Qk,c="sr"):(s=Zk,c="ta",a="editorialArtwork.fullscreenBackground",l="sr")
break
case kH:s="editorialArtwork.productUberStatic16x9",c="sr"
break
default:n.supportsArcade?n.prefersCompactVariant||e.client.isPhone?(s="editorialArtwork.splashTall",c="oc"):(s=Zk,c="oh"):(s=D_,c="sr")}return r=Be(e,t,s),null!==a&&o(r)&&(r=Be(e,t,a),null!==l&&(c=l)),i(r)&&i(c)?nd(e,r,{cropCode:c,useCase:21,withJoeColorPlaceholder:!0,overrideHeight:null,overrideWidth:null}):null}function $d(e,t,n,o,a){let c=[]
if(s(o))c=o
else switch(e.client.deviceType){case $H:case"tv":c=[U$]
break
case CH:c=[__]
break
case kH:c=["productUberMotion16x9"]
break
default:c=[G$]}let l=null,u=null
for(const n of c)if(l=Be(e,t,[oH,n]),u=Be(e,t,[oH,n,vU]),s(l))break
const d=null!=a?a:nd(e,u,{useCase:n,withJoeColorPlaceholder:!0,cropCode:"sr"})
if(i(l)){const e=f(l,DV)
if(r(e))return null
let t,n
return t={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},n={muteUnmute:!0},new Vq(e,d,{allowsAutoPlay:!0,looping:!0,canPlayFullScreen:!1,playbackControls:t,autoPlayPlaybackControls:n})}return null}function Fd(e,t,n){let r=null
switch(e.client.deviceType){case $H:case"tv":case RH:case kH:r=[U$,__,G$]
break
default:r=[__,U$,G$]}return $d(e,t,21,r,n)}function Nd(e,t){return i(t)?`${Oz}:/${_z.developer}/${_z.href}?${Hz.href}=${t.href}`:null}function Bd(e,t,n){return at(e,new wJ(e).forType(L$).addingQuery(M$,BH).addingQuery($V,n).addingQuery(Xj,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)).toString()}function Ud(e,t){switch(t){case Kq:case tW:return"appStore"
case Zq:return MH
case Qq:return _V
case eW:return ON
default:return null}}function Gd(e,t){switch(t){case 6:return["L",lA]
case 7:return["10",dA]
case 8:return["12",pA]
case 9:return["14",wA]
case 10:return["16",vA]
case 11:return["18",yA]
case 12:return["AL",cA]
case 13:return["A10",uA]
case 14:return["A12",fA]
case 15:return["A14",hA]
case 16:return["A16",gA]
case 17:return["A18",mA]
case 20:return["All","kr.all"]
case 21:return["12","kr.12"]
case 22:return["15","kr.15"]
case 31:return["15+","AgeRating-AU-15"]
case 32:return["R 18+","AgeRating-AU-18"]
case 47:return["18+","AgeRating-FR-18"]
default:return}}function jd(e,t){switch(t){case RH:return e.loc.string("AppPlatform.Phone")
case CH:return e.loc.string("AppPlatform.Pad")
case kH:return e.loc.string("AppPlatform.Vision")
case"tv":return e.loc.string("AppPlatform.TV")
case MH:return e.loc.string("AppPlatform.Watch")
case _V:return e.loc.string("AppPlatform.Messages")
case $H:return e.loc.string("AppPlatform.Mac")
default:return""}}function Vd(e,t){var n
return null===(n=Gd(0,t))||void 0===n?void 0:n[1]}function Hd(e,t,n){return Ve(e,t,"hasMessagesExtension",n)}function qd(e,t,n){return Ve(e,t,g_,n)}function Wd(e,t){return Ve(e,t,"isHiddenFromSpringboard")}function zd(e,t,n){return Be(e,t,w_,n)}function Yd(e,t,n,r,o){return ze(e,t,n,r?FF:SG,o)}function Jd(e,t,n){return Ve(e,t,mU,n)}function Kd(e,t,n,r=!1,o){var i,s
if((0,Cv.isNothing)(t))return null
let a
if(r){const r=wt(t)
le(r)&&(a=Ge(e,r,[rj,n],o))}return a=null!==(s=null!==(i=null!=a?a:Ge(e,t,[eN,n],o))&&void 0!==i?i:Ge(e,t,[rj,n],o))&&void 0!==s?s:Ge(e,t,["itunesNotes",n],o),a}function Zd(e,t,n,r=!1){var o
let i
if(r){const r=wt(t)
le(r)&&(i=Ge(e,r,[rj,n]))}return i=null!==(o=null!=i?i:Ge(e,t,[eN,n]))&&void 0!==o?o:Ge(e,t,[rj,n]),i}function Qd(e,t){return Ce(t,"isMacOSInstaller",()=>!1)}function Xd(e,t){const n=gt(e)
return!(!function(e,t,n){if(n&&gt(e).isSystemAppFromData(t)){const e=ie(t,"watchBundleId")
if(s(e))switch(e){case"com.apple.mobilemail.watchkitapp":case"com.apple.news.watchkitapp":case"com.apple.iBooks.watchkitapp":return!0
default:return!1}}return!1}(e,t,e.client.isTinkerWatch)&&(!e.client.isTinkerWatch||(n.isSystemAppFromData(t)?Ve(e,t,YC)||Ve(e,t,uU):Ve(e,t,zC)||Ve(e,t,uU))))}function ef(e){switch(e){case RH:return aH
case CH:return iH
case"tv":return"tv"
case MH:return _D
case $H:return"macbook"
case _V:return OL
case kH:return MC
default:A(e)}}function tf(e,t){switch(t){case jN:return 18/X2.width
case VN:return 18/K2.width
case Yk:return 41.5/j2.width
case R_:return 39/V2.width
case Jk:return 55/v4.width
case Kk:return 55/m4.width
case O_:return 34/c4.width
case k_:return 55/l4.width
case wM:return 108/u4.width
case gM:return 108/d4.width
default:return null}}function nf(e,t){if(r(t)||0===t.length)return!0
const n=t.split("."),o=p(n[0])||0,i=p(n[1])||0,s=p(n[2])||0
return e.host.isOSAtLeast(o,i,s)}function rf(e,t){return!r(t)&&0!==t.length&&e.client.isActivePairedWatchSystemVersionBelow(t)}function of(e,t){switch(t){case eH:case LV:case _$:case j$:case rM:case VB:case x_:return!0
default:return!1}}function sf(e,t){switch(t){case"LockupSmall":case"LockupLarge":case eO:case WB:case tN:case V$:case nN:case H$:case L_:return!0
default:return!1}}function af(e,t,n){const r=jt(e,t)
if(f(r,oj)===Ej){const n=f(r,HN),o=Ge(e,t,nj)
if(s(o)){if(s(n)){const t=lt(n),r={"@@expectedDateMY@@":e.loc.string("PreOrder.Date.MonthYear"),"@@expectedDateMDY@@":e.loc.string("PreOrder.Date.MonthDayYear")}
for(const[n,i]of Object.entries(r))if(o.includes(n)){let r=e.loc.formatDateWithContext(i,t,"middleOfSentence")
return o.replace(n,r)}}return o}}return n}function cf(e,t){const n=ye(e,t,Yj)
return s(n)?n:Ve(e,t,UN)?ye(e,t,sV):null}function lf(e){var t
return null!==(t=function(e,t,n){if((0,Cv.isNothing)(e)||0===t.length&&0===n.length)return null
const r=e
if((0,Cv.isNothing)(r))return null
const o=te(r)
for(const e of t)if(ee(o,e))return z(e.colorHex)
for(const e of n)if(ee(o,e))return z(e.colorHex)
return null}(e,O4,E4))&&void 0!==t?t:z(C4)}function uf(e){var t,n,r,o,i
const s=[]
for(const t of l(e,My))(0,Cv.isSome)(t)&&c(t)&&s.push(t)
return{bgColor:null!==(t=f(e,LU))&&void 0!==t?t:void 0,textColor1:null!==(n=f(e,S_))&&void 0!==n?n:void 0,textColor2:null!==(r=f(e,vM))&&void 0!==r?r:void 0,textColor3:null!==(o=f(e,tO))&&void 0!==o?o:void 0,textColor4:null!==(i=f(e,UF))&&void 0!==i?i:void 0,textGradient:(0,Yv.isDefinedNonNullNonEmpty)(s)?s:void 0}}function df(e){var t,n,r,o,i,s
const a=uf(e),c=[]
for(const e of null!==(t=a.textGradient)&&void 0!==t?t:[]){const t=z(e);(0,Cv.isSome)(t)&&c.push(t)}return{bgColor:null!==(n=z(a.bgColor))&&void 0!==n?n:void 0,textColor1:null!==(r=z(a.textColor1))&&void 0!==r?r:void 0,textColor2:null!==(o=z(a.textColor2))&&void 0!==o?o:void 0,textColor3:null!==(i=z(a.textColor3))&&void 0!==i?i:void 0,textColor4:null!==(s=z(a.textColor4))&&void 0!==s?s:void 0,textGradient:(0,Yv.isDefinedNonNullNonEmpty)(c)?c:void 0}}function ff(e){const t=[LU,S_,vM,tO,UF]
for(const n of t){const t=e[n]
if(c(t)&&!ee(z(t),k4))return t}return null}function pf(e,t){let n=t.targetType
return n||(n=cH),n}function hf(e){let t=e.idType
return t===qV?t=null:t||(t=ZV),t}function wf(e,t){return Jd(e,t)?HV:null}function gf(e,t,n){const r=f(t,oj),o=Me(e,t,$H,!0),i=$e(e,t,$H,!0),s=function(e,t,n,r=!1){const o=new Set(Ne(e,t,r))
for(const e of n)if(o.has(e))return!0
return!1}(e,t,[aH,iH,$$,EU,MH],!0),a=Fe(e,t,[aH,iH,$$,EU,MH],!0),c=Me(e,t,xj,!0),l=$e(e,t,xj,!0)
if(i||o&&n===Gj)switch(r){case BH:return Wb
case IH:return"macSoftwareBundle"}if((l||c&&n===$j)&&r===BH)return"visionSoftware"
if(a||s||s&&n===rH||s&&n===MH||s&&n===RG)switch(r){case BH:return zb
case IH:return"mobileSoftwareBundle"}switch(r){case kV:return"softwareAddOn"
case pj:return PG
case sM:case OH:return zU
default:return null}}function vf(e){return null==e?"":e}function mf(e){if(!e)return null
let t=null
const n=new oY(e).query
if((0,kv.isSome)(n))for(const e of Object.keys(n))if("referrer"===e){n[e]===sO&&(t="com.apple.siri")
break}return t}function yf(e){var t
return(0,kv.isNothing)(e)?{}:null!==(t=g(Af(y(e))))&&void 0!==t?t:{}}function Af(e){if(r(e))return null
if(e instanceof Array){const t=[]
for(const n of e){const e=Af(n)
i(e)&&t.push(e)}return t}if(e instanceof Object){const t={}
return Object.keys(e).forEach((n,r,o)=>{const s=Af(e[n])
i(s)&&(t[n]=s)}),t}return e}function Tf(e){if(!e)return null
const t=new oY(e),n=t.query,o=null==n?void 0:n[RN],i=t.pathname
return r(o)||r(i)?null:i.endsWith("/search")?o:null}function bf(e,t,n,r){if(!t||!n)return TH
if(t.type===IH)return BC
const o=n.style
if((0,kv.isNothing)(o))return TH
switch(o){case VF:case ZF:return rH
case N$:return $H
case C_:return"tv"
case hM:case I_:return ld(e,t,null!=r?r:void 0)===$j?kH:MH
case F$:return _V
case _B:return _B
default:return A(o),TH}}function Sf(e,t){if(!i(t))return null
const n={},r=h(t,bE)
if(!s(r))return null
const o=f(r,Jb);(0,kv.isSome)(o)&&(null==o?void 0:o.length)>0&&(n[Jb]=o)
const a=f(r,Kb);(0,kv.isSome)(a)&&(null==a?void 0:a.length)>0&&(n[Kb]=a)
const c=f(r,Zb)
return(0,kv.isSome)(c)&&(null==c?void 0:c.length)>0&&(n[Zb]=c),n.marketing={marketingItemId:t.id},n}function Pf(e,t,n){let o=null
return i(e)&&(o=b(e)),i(t)&&(r(o)&&(o={}),o.odpModuleUpdate=t.toString()),s(n)&&(r(o)&&(o={}),o.userSegment=n),o}function If(e,t,n){const r=$f(t.locationTracker)
return[Lf(0,t,n),...r]}function Cf(e,t,n){const r=$f(t.locationTracker)
return[Mf(0,t,n),...r]}function kf(e,t,n){const r=new R4
r.location=Lf(0,t,n),t.locationTracker.locationStack.unshift(r)}function Of(e,t,n){const r=new R4
r.location=Mf(0,t,n),t.locationTracker.locationStack.unshift(r)}function Ef(e){0!==e.locationStack.length?e.locationStack.shift():Iv.unexpectedType(Qj,"non-empty location stack","empty location stack")}function Rf(e){const t=Ff(e)
return t?t.position:e.rootPosition}function Df(e){const t=Ff(e)
return t?t.location:null}function _f(e,t){const n=Ff(e)
n?n.position=t:e.rootPosition=t}function xf(e){const t=Ff(e)
t?t.position++:e.rootPosition++}function Lf(e,t,n){var r
const o=Mf(0,t,n)
if(!t.id&&t.locationTracker)o.idType=YV,o.id=Rf(t.locationTracker).toString()
else{const e=hf(t);(0,Cv.isSome)(e)&&(o.idType=e)
let n=t.id;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(n=t.anonymizationOptions.anonymizationString),o.id=(0,Cv.isNothing)(n)?"":n}return t.fcKind&&(o.fcKind=t.fcKind),t.displayStyle&&(o.displayStyle=t.displayStyle),t.inAppEventId&&(o.inAppEventId=t.inAppEventId),t.relatedSubjectIds&&(o.relatedSubjectIds=t.relatedSubjectIds),t.canonicalId&&(o.canonicalId=t.canonicalId),t.optimizationEntityId&&(o.optimizationEntityId=t.optimizationEntityId),t.optimizationId&&(o.optimizationId=t.optimizationId),(0,Cv.isSome)(t.rowIndex)&&(o.rowIndex=t.rowIndex),t.productVariantData&&Object.assign(o,ot(t.productVariantData)),o}function Mf(e,t,n){var r,o
let i=n;(null===(r=t.anonymizationOptions)||void 0===r?void 0:r.anonymizationString)&&(i=t.anonymizationOptions.anonymizationString)
const s={locationPosition:Rf(t.locationTracker),locationType:pf(0,t),name:(0,Cv.isNothing)(i)?"":i}
return(0,Cv.isSome)(t.badges)&&(s.badges=null!==(o=y(t.badges))&&void 0!==o?o:void 0),t.recoMetricsData&&Object.assign(s,t.recoMetricsData),s}function $f(e){return e.locationStack.map(e=>e.location)}function Ff(e){return 0===e.locationStack.length?null:e.locationStack[0]}function Nf(e,t){var n,r,a,c
let l=t.id,u=t.title
if(s(t.anonymizationOptions)){const e=null!==(r=null===(n=t.anonymizationOptions)||void 0===n?void 0:n.anonymizationString)&&void 0!==r?r:"ANONYMOUS"
l=e,u=e}else l&&t.createUniqueImpressionId&&(l=function(e,t){return`${t}${D4}${e.random.nextUUID()}`}(e,l))
const d={id:vf(l),name:vf(u),impressionType:pf(0,t)},f=hf(t);(0,kv.isSome)(f)&&(d[Ex]=f),t&&t.kind&&(d[rV]=t.kind),t&&t.softwareType&&(d[wF]=t.softwareType),t&&t.recoMetricsData&&Object.assign(d,t.recoMetricsData),t&&t.mercuryMetricsData&&Object.assign(d,t.mercuryMetricsData),t&&t.lockupDisplayStyle&&(d[Ix]=t.lockupDisplayStyle)
const p=null!==(a=t.shouldOmitImpressionIndex)&&void 0!==a&&a
if(t&&t.locationTracker&&!p){const e=Rf(t.locationTracker)
d[CT]=e,""===d.id&&(d.id=e.toString(),d[Ex]=YV)}return t&&t.modelSource&&(d.modelSource=t.modelSource),i(t.offerType)&&(d[UM]=t.offerType),t&&i(t.displaysArcadeUpsell)&&(d[Db]=t.displaysArcadeUpsell),t&&i(t.isPreorder)&&(d[VV]=t.isPreorder),i(t.adamId)&&o(t.anonymizationOptions)&&(d[wj]=t.adamId),t&&i(t.badges)&&(d.badges=t.badges),t&&i(t.inAppEventId)&&(d[WL]=t.inAppEventId),t&&i(t.relatedSubjectIds)&&(d.relatedSubjectIds=t.relatedSubjectIds),(null===(c=null==t?void 0:t.hintsEntity)||void 0===c?void 0:c.length)&&(d[kx]=t.hintsEntity),t&&i(t.autoAdvanceInterval)&&(d.autoAdvanceInterval=t.autoAdvanceInterval),i(null==t?void 0:t.fcKind)&&(d.fcKind=t.fcKind),i(null==t?void 0:t.canonicalId)&&(d[X$]=t.canonicalId),i(null==t?void 0:t.displayStyle)&&(d[tV]=t.displayStyle),i(t.productVariantData)&&Object.assign(d,ot(t.productVariantData)),(0,kv.isSome)(t.contentRating)&&(d[aB]=t.contentRating),(0,kv.isSome)(t.bundleId)&&(d[zV]=t.bundleId),""===d.id&&e.console.log(`impressionId missing. Tracking broken for ${d.name} of ${d.impressionType}`),d}function Bf(e,t,n){t&&(t.impressionMetrics=new RW(Nf(e,n)))}function Uf(e,t,n){var r
t&&(Bf(e,t,n),(n.isAdvert||n.isAdEligible)&&(null===(r=n.pageInformation)||void 0===r?void 0:r.iAdInfo)&&t.impressionMetrics&&(t.impressionMetrics=new DW(t.impressionMetrics,!0)))}function Gf(e,t,n,r,o,i,s=!0){var a,c,l,u,d,f
if(!t)return
const p=Nf(e,n)
if(s?(p[_b]=vf(r),p[mx]=vf(o)):(r&&(p[_b]=r),o&&(p[mx]=o)),i&&(p[xb]=i),(null!==(c=null===(a=null==n?void 0:n.optimizationEntityId)||void 0===a?void 0:a.length)&&void 0!==c?c:0)>0&&(p[Lb]=n.optimizationEntityId),(null!==(u=null===(l=null==n?void 0:n.optimizationId)||void 0===l?void 0:l.length)&&void 0!==u?u:0)>0&&(p[Mb]=n.optimizationId),(0,kv.isSome)(null==n?void 0:n.rowIndex)&&(p.rowIndex=n.rowIndex),t.impressionMetrics=new RW(p),(n.isAdvert||n.isAdEligible)&&(null===(d=n.pageInformation)||void 0===d?void 0:d.iAdInfo)){const e=yf(n.pageInformation.iAdInfo.fastImpressionsFieldsForCurrentItem(n.locationTracker,n.adSlotOverride))
Object.assign(t.impressionMetrics.fields,e),t.impressionMetrics=new DW(t.impressionMetrics,!0),n.isAdvert&&(null===(f=t.impressionMetrics)||void 0===f||delete f.fields[mx])}}function jf(e,t,n,r){if(!t||!r)return
Bf(e,t,n)
const o=yf(r.fastImpressionsFieldsForCurrentItem(n.locationTracker,n.adSlotOverride))
if((0,kv.isSome)(t.impressionMetrics)){Object.assign(t.impressionMetrics.fields,o)
const e=u(n.disableFastImpressionsForAds)
t.impressionMetrics=new DW(t.impressionMetrics,!e)}(0,kv.isSome)(t.impressionMetrics)&&(t.impressionMetrics.fields[fx]=Rx)}function Vf(e,t,n,r,a,c,l){var u
const d=Hf(e,t,n.title,a)
d.lockupDisplayStyle=r,d.contentRating=null===(u=n.offerDisplayProperties)||void 0===u?void 0:u.contentRating,d.bundleId=n.bundleId,o(d.targetType)&&(d.targetType=cH),c&&Jd(e,t)&&(d.displaysArcadeUpsell=!0)
const f=a.id
return s(Qu(t))&&i(f)&&f.length>0&&(d.id=f),d}function Hf(e,t,n,r,o){return Iv.context(hE,()=>{const i=gf(e,t),s=wf(e,t),a={...r,kind:i,softwareType:s,title:n,id:t.id}
return Ve(e,t,VV,o)&&(a.offerType=Ej),a})}function qf(e,t,n,r){return Iv.context(hE,()=>{const o=gf(e,t),i=wf(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:ZV,displayStyle:F_}})}function Wf(e,t,n,r){return Iv.context("impressionOptionsForMetadataRibbonItem",()=>({...e,id:t,kind:null,softwareType:null,title:n,idType:r,targetType:wE}))}function zf(e,t,n){var r,o,i,s
const a=Nf(e,(r=t.term,o=n,i=t.entity,s=t.source,Iv.context("impressionOptionsForSearchHint",()=>({...o,id:"",kind:null,softwareType:null,title:r,hintsEntity:i,modelSource:s}))))
t.impressionMetrics=new RW(a)}function Yf(e){const t=l(e,Rj)
for(const e of t){const t=f(e,"id");(0,kv.isNothing)(t)||(e.id=Jf(t))}}function Jf(e){return e.includes(D4)?e.split(D4)[0]:e}function Kf(e,t){var n
const r=null!==(n=t.excludingFields)&&void 0!==n?n:[]
return r.push("amsMetricsID"),new CW(t.fields,t.includingFields,r,t.topic,t.shouldFlush)}function Zf(e,t,n,r,o,i){const s={}
Object.assign(s,r),s[vG]=iB,s[hx]=n,s[ab]=t
const a=["impressionsSnapshot",sB]
return a.push(cb),o&&a.push(...o),np(e,s),Kf(0,new CW(s,a,[],tp(e,s),ep(e,s,null,i)))}function Qf(e,t,n,r,o,i,s){const a={}
Object.assign(a,i),a[RN]=t,a[hx]=n,a[_N]=r,o&&(a[dF]=o),a[vG]=JV
const c=[wx]
return s&&c.push(...s),np(e,a),Kf(0,new CW(a,c,[],tp(e,a),ep(e,a)))}function Xf(e,t,n,r,o){const i={}
Object.assign(i,t),i[vG]=Rj,i[fF]="data-metrics",i[pF]=4
const s=[Rj,sB,wx]
return s.push(cb),n&&s.push(vx),r&&s.push(hF),o&&s.push("impressionsAppendix"),np(e,i),Kf(0,new CW(i,s,[pF],tp(e,i),ep(e,i)))}function ep(e,t,n=null,r){var o,i
const a=t[vG]
let c=!1
if(!s(a))return c
const l=null!=r&&r
switch(a){case iB:c=u(t,_4.hasIAdData)||l
break
case zO:c=!0
break
case Rj:c=u(t,_4.hasIAdData),t[fF]!==WO||(null===(o=null==n?void 0:n.iAdInfo)||void 0===o?void 0:o.placementType)!==xV&&(null===(i=null==n?void 0:n.iAdInfo)||void 0===i?void 0:i.placementType)!==nV||(c=!0)
break
case jH:c=e.host.clientIdentifier===tW&&(u(t,_4.hasIAdData)||l)}return e.host.clientIdentifier,c}function tp(e,t){return t[zL]||e.bag.metricsTopic}function np(e,t){e.bag.isMetricsAb2DataFallbackEnabled&&(0,kv.isSome)(e.experimentCache)&&(t.alt_ab2_data=JSON.stringify(e.experimentCache.createAb2Data()))}function rp(e,t,n,i){return Iv.context("clickOptionsForLockup",()=>{const s=t.id.slice()
let a=t.id
void 0!==n.anonymizationOptions&&n.anonymizationOptions.anonymizationString.length>0&&(a=n.anonymizationOptions.anonymizationString)
const c={...n,...i,id:a,contextualAdamId:s,softwareType:wf(e,t)}
return o(c.targetType)&&(c.targetType=cH),r(c.kind)&&(c.kind=gf(e,t)),se(t,VV)&&(c.offerType=Ej),c})}function op(e,t,n,r,o,a,c,l,u){var d,f,p,h,w
const g={}
if(o){const e=o
c&&(null!==(p=null===(f=null===(d=e.iAdInfo)||void 0===d?void 0:d.iAdAdamId)||void 0===f?void 0:f.length)&&void 0!==p?p:0)>0&&(0,Cv.isSome)(e.iAdInfo)&&e.iAdInfo.iAdAdamId===t.adamId&&Object.assign(g,e.iAdInfo.clickFields),s(e.searchTermContext)&&(g[oV]=e.searchTermContext.term)}(0,Cv.isSome)(l)&&Object.assign(g,l),g[bU]={buyParams:t.purchaseConfiguration.buyParams},void 0!==a&&(g[jF]=a),g[aK]=t.adamId,t.actionMetrics.custom[aK]=t.adamId,r&&(g[UM]=Ej,i(t.expectedReleaseDate)&&(g[iE]=ut(t.expectedReleaseDate)))
const v=Zf(e,n,NH,g,void 0,u)
g[aK]=t.adamId,t.actionMetrics.custom[aK]=t.adamId,v.includingFields.push("appState"),t.purchaseConfiguration.isArcadeApp&&v.includingFields.push(Ib)
const m=null!==(w=null===(h=null==o?void 0:o.iAdInfo)||void 0===h?void 0:h.shouldIncludeAdRotationFields)&&void 0!==w&&w
c&&m&&v.includingFields.push(hF),c&&e.client.isPad&&v.includingFields.push(vx),t.actionMetrics.addMetricsData(v)}function ip(e,t,n){var r
sp(e,t,{...n,actionType:sE,subscriptionSKU:null!==(r=e.bag.arcadeProductId)&&void 0!==r?r:void 0,actionContext:HV,targetType:NH})}function sp(e,t,n,r=!1,o){var s,a,c,l,u,d,f
let p=n.actionType
p||(p=UH)
const h={actionType:p}
let w
w=t instanceof $W?t.actions:[t],w.forEach(e=>{if(e instanceof dY){const t=e
h[dF]=t.pageUrl}else if(e instanceof MW){const t=e
h[dF]=t.url}}),n.actionDetails&&(h[bU]=n.actionDetails),n.actionContext&&(h[Cb]=n.actionContext),i(n.offerType)&&(h[UM]=n.offerType),i(n.offerReleaseDate)&&(h[iE]=ut(n.offerReleaseDate))
const g=null!==(c=null!==(a=null===(s=n.anonymizationOptions)||void 0===s?void 0:s.anonymizationString)&&void 0!==a?a:null==t?void 0:t.title)&&void 0!==c?c:""
let v
h[jF]=If(0,n,g),n.pageInformation&&n.pageInformation.searchTermContext&&(h[oV]=n.pageInformation.searchTermContext.term),i(n.softwareType)&&(h[wF]=n.softwareType),(n.isAdvert||n.isAdEligible)&&r&&(null===(l=n.pageInformation)||void 0===l?void 0:l.iAdInfo)&&(Object.assign(h,n.pageInformation.iAdInfo.clickFields),e.client.isPad&&(v=[vx])),n.mercuryMetricsData&&Object.assign(h,n.mercuryMetricsData),(0,Cv.isSome)(n.subjectIds)&&(h.subjectIds=n.subjectIds)
const m=Zf(e,n.id,null!=o?o:pf(0,n),h,v)
n.actionContext===HV&&(n.actionType===eM||n.actionType===sE)&&(m.includingFields.push(Ib),m.fields[aK]=n.contextualAdamId,(0,Cv.isSome)(t.adamId)&&(t.actionMetrics.custom[aK]=t.adamId))
const y=null!==(f=null===(d=null===(u=n.pageInformation)||void 0===u?void 0:u.iAdInfo)||void 0===d?void 0:d.shouldIncludeAdRotationFields)&&void 0!==f&&f
n.isAdvert&&y&&m.includingFields.push(hF),t.actionMetrics.addMetricsData(m)}function ap(e,t,n,r){const o={}
i(n)&&(o[dF]=n),r.targetType||(r.targetType=NH),o[jF]=Cf(0,r,t.title),o[_N]=UH,o[nM]="button_See All"
const s=Zf(e,aE,NH,o)
t.actionMetrics.addMetricsData(s)}function cp(e,t,n){const r={}
r[_N]="filter"
const o=Zf(e,`filter_${n}`,NH,r)
o.includingFields.push(kb),t.actionMetrics.addMetricsData(o)}function lp(e,t,n,r,o){var i,a,c,l
const u=function(e){switch(e){case mN:return mN
case uN:return uN
case lE:return"recentQuery"
case LM:return Ox
case uE:return"searchInsteadFor"
case dE:return Rb
case fE:return fE
default:return pE}}(t.origin);(0,Cv.isNothing)(o)&&(o=new XX({page:VG,pageType:VG,pageId:VG,pageDetails:Ob}))
const d={pageInformation:o,locationTracker:r,targetType:n},f={...Ft(o),actionType:u,actionUrl:vf(t.url),location:Cf(0,d,t.term),searchTerm:t.term},p={targetId:t.term},h={};(null===(i=t.prefixTerm)||void 0===i?void 0:i.length)&&(h[GM]=t.prefixTerm),(null===(a=t.entity)||void 0===a?void 0:a.length)&&(h[kx]=t.entity),s(h)&&(p[bU]=h),(null===(c=t.originatingTerm)||void 0===c?void 0:c.length)&&(f[cE]=t.originatingTerm,p[cE]=t.originatingTerm)
const w=Zf(e,t.term,n,f,[Eb])
t.actionMetrics.addMetricsData(w)
const g=Qf(e,t.term,n,u,null!==(l=t.url)&&void 0!==l?l:null,p,[Eb])
t.actionMetrics.addMetricsData(g)}function up(e,t=NN,n,r,o,i,s,a=NH){const c=oY.fromComponents(Oz,null,`/${_z.arcadeSeeAllGames}`,{sort:t}),l=new dY(jB,c.build())
return l.title=null!=o?o:e.loc.string(a_),sp(e,l,{id:null!=i?i:Ty,idType:s,targetType:a,actionType:UH,actionContext:HV,pageInformation:n,locationTracker:r}),l}function dp(e,t,n,r,o){var s,a,c,l
const u=new KJ(xH,t,e.bag.metricsTopic,n)
u.purchaseSuccessAction=r,u.carrierLinkSuccessAction=r
const d=new dY(XU);(0,kv.isSome)(null===(a=null===(s=null==o?void 0:o.pageInformation)||void 0===s?void 0:s.searchTermContext)||void 0===a?void 0:a.term)&&(u.metricsOverlay[oV]=null===(c=o.pageInformation.searchTermContext)||void 0===c?void 0:c.term)
const f=null===(l=e.metricsIdentifiersCache)||void 0===l?void 0:l.getMetricsFieldsForTypes([xv.user,xv.client])
return(0,kv.isSome)(f)&&(u.metricsOverlay={...u.metricsOverlay,...f}),d.pageData=u,i(o)&&ip(e,d,o),d}function fp(e,t,n,r){{const e=new xW(xH)
return i(r)&&(e.popToRoot=r),new $W([e])}}function pp(e,t={playNow:{}}){return new HW(t)}function hp(e,t,n,r){let o
o=Se(e,"resource://GameCenterEyebrow",16,16)
const i=e.featureFlags.isEnabled(HF),s=e.featureFlags.isEnabled("game_center_shelf_header"),a=e.featureFlags.isGSEUIEnabled(VD)
if(a){const r={eyebrowColor:Z(XL),includeSeparator:!i,prefersShelfHeader:s}
return{eyebrow:e.loc.string(by),eyebrowArtwork:o,eyebrowArtworkType:jv.Icon,title:t,subtitle:n,configuration:r}}{const c={eyebrowColor:a?Z(c_):void 0,includeSeparator:!i,prefersShelfHeader:s}
return(0,kv.isSome)(r)&&r?{title:t,titleArtwork:o,titleArtworkType:jv.Icon,subtitle:n,configuration:c}:{eyebrow:e.loc.uppercased(e.loc.string(by)),eyebrowArtwork:o,eyebrowArtworkType:jv.Icon,title:t,subtitle:n,configuration:c}}}function wp(e,t=!1){let n=new wJ(e).forType(kj).includingAgeRestrictions()
return t&&(n=n.addingQuery(l_,hk)),n}function gp(e,t){return wp(e).withSparseLimit(t).asPartialResponseLimitedToFields([_H]).usingCustomAttributes(Ze(e))}function vp(e,t,n){return function(e,t,n){o(t)&&(t=pe(WU))
const r=new wJ(e).forType(XU).addingQuery("serviceType",xH).addingQuery("placement",t).includingMetaKeys(XG,[eG]).includingRelationships([FH]).includingAttributes([Sy,wk]).includingAgeRestrictions()
return i(n)&&r.addingQuery(Py,n),r}(e,t,n)}function mp(e,t){let n=null
const s=ve(t,Iy)||ve(t,XG)
if(o(s)||o(s.data))return null
const a=s.data.map(e=>e.type===XG?e:null).filter(e=>i(e))
if(o(a))return null
const c=e.bag.marketingItemSelectionTimeout
if(1===a.length||0===c)n=a[0]
else try{n=e.arcade.getMarketingItemWithTimeout(a,c)}catch{n=a[0]}return r(n)?null:{marketingItemData:n}}function yp(e,t){if(!t)return null
let n=null
const r=l(t,XC)
return r.length>0&&(n=r[0]),i(n)?{marketingItemData:n}:null}function Ap(e,t,n){switch(n){case sj:return M4.has(t)
case rF:return x4.has(t)
case lN:return L4.has(t)
default:return!1}}function Tp(e,t,n,o,s,a){const c=new uQ(o.metricsPageInformation,o.metricsLocationTracker)
null==a&&((a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}).isHorizontalShelfContext=!0),e.client.deviceType!==MH&&(a.coercedCollectionTodayCardDisplayStyle=am.Grid)
const l=is(t,a.coercedCollectionTodayCardDisplayStyle)
if(a.prevailingCropCodes=function(e,t,n){switch(t){case sj:return null
case rF:return{defaultCrop:"el"}
case lN:return n===am.Video?{defaultCrop:"sr"}:{defaultCrop:"ek"}
default:return null}}(0,n,l),a.horizontalCardContentType=n,!i(t.attributes))return s&&s(t),null
const u=ts(e,t,a,c,o.augmentingData)
if(r(u))return null
{u.collapsedHeading=hs(0,u),u.inlineDescription=Pp(e,u,t),u.inlineDescription===u.collapsedHeading&&(u.inlineDescription=null)
const n=u.media
n&&n.kind===JU&&(u.title=null)}if(n===lN){const e=u.heroMedia
if(!i(e)||0===e.artworks.length&&0===e.videos.length)return null}return Ap(0,u.media.kind,n)&&i(o.filterOutMediaCardKinds)&&o.filterOutMediaCardKinds.has(u.media.kind)?null:(function(e,t,n){if("tv"!==e.client.deviceType||!ae(n,eD))return
const r=new MW("com.apple.Arcade://")
t.clickAction=r}(e,u,t),u)}function bp(e,t,n,r,s,a,c){if(!i(n))return null
const l=new oJ(n)
return r&&(l.title=r),l.subtitle=s,l.isHorizontal=!0,l.items=n===nB?[Ip(e,t,a.metricsPageInformation,a.metricsLocationTracker,()=>!0,c)]:function(e,t,n,r,i,s){const a=[]
for(const s of t){const t=Tp(e,s,n,r,i,void 0)
o(t)||(a.push(t),xf(r.metricsLocationTracker))}return a}(e,t,n,a,c),l}function Sp(e,t,n,r,s,a){const c=new oJ(zM)
n&&(c.title=n),c.subtitle=r,c.isHorizontal=!0
const l=[],u={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
u.metricsDisplayStyle=cm.SmallCard,u.alwaysShowBadgeInSmallCards=!0,u.alwaysUseMaterialBlur=!0
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=ts(e,n,u,s)
o(t)||(l.push(t),xf(s.locationTracker))}return c.items=l,c}function Pp(e,t,n){{let r=Zd(e,n,GH)
return i(r)&&(r=r.replace(/\n/g," ")),t.media.kind===JU&&t.overlay instanceof $J&&i(t.overlay.lockup)?t.overlay.lockup.title:r}}function Ip(e,t,n,o,s,a){return Iv.context("todayCardsFromPlatformData",()=>{if(!t)return null
const c={useOTDTextStyle:!1,enableFullScreenVideo:!1,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
c.coercedCollectionTodayCardDisplayStyle=am.Grid,c.prevailingCropCodes={defaultCrop:"fo"},c.isHorizontalShelfContext=!0
const l=new uQ(n,o),u=[]
for(const n of t){if(!i(n.attributes)){a&&a(n)
continue}const t=ts(e,n,c,l)
if(!r(t)&&s(t)){t.collapsedHeading=hs(0,t),t.inlineDescription=Pp(e,t,n),t.inlineDescription===t.collapsedHeading&&(t.inlineDescription=null)
const r=t.media
r&&r.kind===JU&&(t.title=null),u.push(t)}}return u.length?new VJ(u):null})}function Cp(e,t,n,r){return o(t.remainingItems)?null:`${Oz}:/${_z.product}/${_z.shelf}/`+kp(t,n,r)}function kp(e,t,n){return e.sourceSequenceId=t.getSequenceId(),e.sourcePageInformation=t.metricsPageInformation,e.sourceLocationTracker=t.locationTracker,e.destinationPageInformation=n,encodeURIComponent(JSON.stringify(e))}function Op(e,t,n,r,o,i,s,a,c){return Ep(e,t.data,n,r,o,i,s,a,c)}function Ep(e,t,n,i,s,a,c,l,u){if(o(t))return null
const d=[],f={shouldShowSupportedPlatformLabel:null!=u&&u}
return{items:Gu(e,t,{shouldShowOnUnsupportedPlatform:null!=u&&u,lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.locationTracker,recoMetricsData:l},artworkUseCase:i,canDisplayArcadeOfferButton:of(0,s),...r(a)?{}:{offerStyle:a},...f},shouldConsiderDataPastLastAvailable:!0,contentUnavailable:(e,t)=>(d.push(t),!1),filter:c}),remainingItems:d}}function Rp(e,t,n){if(!n)return
let r=-1,o=null
n.forEach((e,n)=>{const i=e,s=i,a=i&&i.adamId===t,c=s&&s.productIdentifier===t;(a||c)&&(r=n,o=i,s&&(s.theme="spotlight",s.offerDisplayProperties=s.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,rG,"ad",{type:DD})))}),-1!==r&&(n.splice(r,1),n.splice(0,0,o))}function Dp(e){if(-1===U4.indexOf(e.media.kind))return!1
const t=e.clickAction
if(!t)return!0
const n=t.pageUrl
if(!n)return!0
const r=new oY(n),o=_p()
for(const e of o)if(new sY(e).matches(r))return!1
return!0}function _p(){return[{protocol:Ez,path:`/{countryCode}/${_z.product}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPPT}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,path:`/{countryCode}/${_z.productBundle}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:`/{countryCode}/${_z.product}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,path:`/{countryCode}/${_z.productBundle}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:`/${_z.product}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,path:`/${_z.productBundle}/{appName}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:`/${_z.product}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.appEventId}?-caseInsensitive`,`${Hz.offerItemId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,path:`/${_z.product}/{id}`,query:[`${Hz.v0}?`,`${Hz.metrics}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,path:`/${_z.productBundle}/{id}`,query:[`${Hz.action}?`,`${Hz.offerName}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,query:[Hz.bundleIdentifier,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]},{protocol:Ez,query:[Hz.action,Hz.ids,`${Hz.isPurchasesApp}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/apps/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/catalog/{countryCode}/app-bundles/{id}",query:[]},{protocol:Ez,path:"{apiVersion}/catalog/{countryCode}/apps/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.offerItemId}?`]},{protocol:Ez,path:"{apiVersion}/catalog/{countryCode}/app-bundles/{id}",query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,hostName:`${Lz}`,path:`/${_z.siri}/{id}`,query:[`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Ez,path:`/${_z.store}/${_z.viewSoftware}`,query:[Hz.id,`${Hz.v0}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`]},{protocol:Oz,path:`/${_z.product}/{id}`,query:[Hz.invalidateWidgetsOnFailure,`${Hz.metrics}?`,`${Hz.offerItemId}?`,`${Hz.appEventId}?`,`${Hz.isPreloading}?`,`${Hz.isViewOnly}?`,`${Hz.includeUnlistedApps}?`,`${Hz.webBrowser}?`]}]}function xp(e,t,n){const r=n[$G],o=JSON.parse(r)
let i
if(o.isBundleShelf)i=IH
else switch(o.contentType){case sj:case nB:case zM:i=OH
break
case JF:i=kV
break
default:i=BH}const s=[lH,oH,eV]
return e.appleSilicon.isSupportEnabled&&s.push(iV),e.bag.enableUpdatedAgeRatings&&s.push(zj),ad(e)&&s.push(Zj),new wJ(e).withIdsOfType(o.remainingItems.map(e=>e.id),i).includingAdditionalPlatforms(N(e)).includingAttributes(i===kV?[]:s)}async function Lp(e,t,n,a,c=!1){const l=n[$G],u=JSON.parse(l,(t,n)=>typeof n===EG&&"iAdInfo"===t&&s(n)?QX.from(e,n):n)
u.isFirstRender=!1
const d=W(t)
u.recoMetricsData=null!=d?d:u.recoMetricsData,n[Hz.shelfRefreshType]===eY&&m2.resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,u)
const f=function(e,t,n,s){return Iv.context("shelfFromLookupResponse",()=>{switch(n.onDemandShelfType){case Tm.SimilarItems:return function(e,t,n,i){return Iv.context("similarItemsSecondaryShelf",()=>{var s,a
if(o(t))return null
if(e.client.isCompanionVisionApp)return null
const c=new m2(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),l=MV,u=gB,d={pageInformation:c.metricsPageInformation,locationTracker:c.locationTracker,targetType:l,id:m2.similarItemsShelfId,idType:u,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
kf(0,d,n.title)
const f=new oJ(n.contentType)
let p
if(Dn(e,xV)||Dn(e,nV)){p=po(0,n.sourcePageInformation.iAdInfo),go(e,p,i)
const o=function(e,t){var n
const r=null===(n=null==t?void 0:t.onDeviceAd)||void 0===n?void 0:n.positionInfo
if((0,kv.isNothing)(r)||(0,kv.isNothing)(t))return null
let o
switch(t.placementType){case xV:o=$B
break
case nV:o=sk}return(0,kv.isNothing)(o)?null:tc(e,t,{shelfIdentifier:o,slot:r.slot-1})}(e,i)
null===(s=c.metricsPageInformation.iAdInfo)||void 0===s||s.updateForAdResponse(e,i)
const l=function(e,t){if(r(e))return[]
const n=[]
return Object.entries(e.tasks).forEach(([r,o])=>{r.startsWith(t)&&(n.push(o),delete e.tasks[r])}),n}(o,null===(a=Df(c.locationTracker))||void 0===a?void 0:a.id)
l.forEach(e=>{(t=t.filter(t=>t.id!==e.data.id)).splice(e.positionInfo.slot,0,e.data)}),f.adIncidents=ho(0,p)}const h=Ep(e,t,c,td(0,n.contentType),n.contentType,n.offerStyle,null,n.recoMetricsData)
if(o(h))return null
f.title=n.title,f.items=h.items,f.isHorizontal=!0
const w=new B4(n.productId,t,n.title,n.shouldInferSeeAllFromFetchesItems,void 0,n.contentType,null,null,null,null,null,Tm.SimilarItems),g=Zl(0,n.productId,w,c,n.destinationPageInformation)
return f.refreshUrl=g,t.length<2?f.rowsPerColumn=1:n.supportsArcade?f.rowsPerColumn=2:f.rowsPerColumn=3,c.addImpressionsFieldsToSimilarItemsShelf(e,f,l,u),$n(e,[f],xV,d.id,d.pageInformation),Ef(c.locationTracker),xf(c.locationTracker),f})}(e,t.data,n,s)
case Tm.MoreByDeveloper:return function(e,t,n){return Iv.context("moreByDeveloperSecondaryShelf",()=>{if(o(t))return null
const r=new m2(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId)
kf(0,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:jV,id:`${r.getSequenceId()}`,idType:YV,excludeAttribution:!0,recoMetricsData:n.recoMetricsData},n.title)
const i=new oJ(n.contentType)
i.title=n.title
const s=e.client.isCompanionVisionApp?32768:void 0,a=Ep(e,t,r,td(0,n.contentType),n.contentType,n.offerStyle,s)
if(o(a))return null
if(i.items=a.items,i.isHorizontal=!0,t.length<2?i.rowsPerColumn=1:i.rowsPerColumn=2,(0,kv.isSome)(n.developerUrl)){const t=new dY(jH)
t.pageUrl=n.developerUrl,t.title=e.loc.string(Oj),ap(e,t,t.pageUrl,{pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker}),i.seeAllAction=t}return r.addImpressionsToShelf(e,i,cV),Ef(r.locationTracker),xf(r.locationTracker),i})}(e,t.data,n)
case Tm.SmallStory:return function(e,t,n){return Iv.context("smallStorySecondaryShelf",()=>{if(o(t))return null
const r=new m2(n.sourcePageInformation,n.sourceLocationTracker,n.sourceSequenceId),i={pageInformation:r.metricsPageInformation,locationTracker:r.locationTracker,targetType:jV,id:`${r.getSequenceId()}`,idType:YV,excludeAttribution:!0,recoMetricsData:n.recoMetricsData}
let s
if(kf(0,i,n.title),Ql(e)){const r=new uQ(i.pageInformation,i.locationTracker)
s=Sp(e,null!=t?t:[],n.title,null,r)}else{const r={metricsLocationTracker:i.locationTracker,metricsPageInformation:i.pageInformation,filterOutMediaCardKinds:Mp(e.host.platform)}
s=bp(e,t,sj,n.title,null,r),Array.isArray(null==s?void 0:s.items)&&(s.items=s.items.filter(e=>!(e instanceof jJ)||Ap(0,e.media.kind,sj)))}return s.isHorizontal=!0,r.addImpressionsToShelf(e,s,Hj),Ef(r.locationTracker),xf(r.locationTracker),s})}(e,t.data,n)}const a=new oJ(n.contentType),c=W(t),l={pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,excludeAttribution:!0,recoMetricsData:null!=c?c:n.recoMetricsData}
let u
if(n.contentType===nB){const n=Ip(e,t.data,l.pageInformation,l.locationTracker,Dp)
i(n)&&(u=[n])}else{const r={metricsOptions:l,offerStyle:n.offerStyle,artworkUseCase:td(0,n.contentType),canDisplayArcadeOfferButton:of(0,n.contentType)}
n.contentType===JF&&(r.skipDefaultClickAction=!0)
const o={lockupOptions:r}
n.isBundleShelf&&(o.filter=0)
const i=Uu(e,t,o),s={[Zq]:hM,[Qq]:F$}[e.host.clientIdentifier]
s&&i.sort((e,t)=>{const n=e.icon.style===s,r=t.icon.style===s
return n&&r?0:n&&!r?-1:1})
const a=n.spotlightInAppProductIdentifier
a&&Rp(0,a,i),u=i}return a.items=u,a.mergeWhenFetched=!0,a})}(e,t,u,a)
if(c&&function(e,t,n,o){if(r(n))return
let i=[]
const s=Ft(n),a=vi(e,n,o)
i.push(a)
const c=Ai(e,n,o).map(e=>e.data)
i=i.concat(c),gi(s),i.forEach(e=>gi(e.fields)),t.pageChangeMetrics={pageFields:s,updatedEvents:i}}(e,f,u.sourcePageInformation),f.refreshUrl=u.refreshUrl,n[Hz.shelfRefreshType]===eY&&m2.addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,f,u),u.shouldInferSeeAllFromFetchesItems){const t=new dY(jH)
t.title=e.loc.string(Oj)
const n=new oJ(f.contentType)
n.items=function(e,t,n,r=!1){var o,s
if(!t)return null
let a=0
const c=[]
for(const e of t){if(r&&i(null!==(o=e.searchAd)&&void 0!==o?o:null===(s=e.searchAdOpportunity)||void 0===s?void 0:s.searchAd)){a+=1
continue}const t=b(e)
if(n&&t.offerDisplayProperties&&(t.offerDisplayProperties=t.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,n)),a>0){const e=b(t.impressionMetrics.fields),n=p(e.impressionIndex);(0,Cv.isSome)(n)&&(e.impressionIndex=n-a,t.impressionMetrics=new RW(e,t.impressionMetrics.id,t.impressionMetrics.custom))}c.push(t)}return c}(0,f.items,pV,!0)
const r=new lJ([n])
ui(e,r,u.destinationPageInformation),r.title=u.title,t.pageData=r,ap(e,t,null,{pageInformation:u.sourcePageInformation,locationTracker:u.sourceLocationTracker}),f.seeAllAction=t}return o(f.items)&&!u.hasExistingContent&&(f.isHidden=!0),f}function Mp(e){const t=new Set([OF])
return e===yj&&(t.add(JU),t.add($C),t.add(kB),t.add(xD)),t}async function $p(e,t){return typeof campaignAttribution!==rB?await campaignAttribution.processRedirectURL(t):await e.network.fetch({url:e.bag.redirectUrlEndpoint,method:zB,headers:{"Content-Type":Cx},body:`url=${encodeURIComponent(t)}`}).then(e=>e.ok)}async function Fp(e,t){const n=e.required(G4)
0!==Kn(e,new oY(t.url)).length&&$p(e,t.url),t.url=function(e,t){const n=new oY(t.url)
if(Ek in n.query){const r="com.apple.appstorecomponentsd"===f(t.referrerData,SH),o="com.apple.AppStore.ProductPageExtension"===e.host.clientIdentifier
return r||o||delete n.query[Ek],n.toString()}return t.url}(e,t)
const r=new bv.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r)
return await n.fetchAction(o,t.url,t.referrerData).then(n=>{if(!n)throw new Error(`Promise resolved to null action for: ${t.url}`)
if(t.isIncomingURL){const e=[n]
if(n instanceof xW)for(const t of n.actions)e.push(t)
for(const t of e){const e=t.pageData
e&&typeof e===EG&&oM in e&&wi(0,e)}}if(n.actionClass===LD){const e=n
e.page===KU||e.page===XV||e.page===kk||e.page===XU||e.page===NL||e.page===BL||e.page===Wj||e.page===iM||e.page===Ok?e.presentationContext=pV:e.page===By?e.presentationContext=HD:e.page===WF?e.presentationContext=TG:t.isIncomingURL?e.presentationContext=QD:(e.presentationContext="replace",e.animationBehavior=Mj)}return t.isIncomingURL&&(e.deepLinks.hasResilientDeepLinks()||e.deepLinks.removeDeepLink(t.url)),r.decorate(n),n}).catch(n=>{let r=[]
n instanceof lY?r=n.reasons.filter(e=>e instanceof LZ):n instanceof LZ&&r.push(n)
for(const n of r)if(204===n.statusCode){const n=new tz(sH)
n.title=e.loc.string("APP_NOT_AVAILABLE_TITLE"),n.message=e.loc.string("APP_NOT_AVAILABLE_MESSAGE"),n.isCancelable=!0
{const r=new xW(PH)
if(r.title=e.loc.string(h_),v(new oY(t.url).query[Uy])){const e=new Az
r.actions=[n,e]}else r.actions=[n]
return r}}throw Error(n.message)})}function Np(e,t,n){switch(t){case ek:return function(e,t){const n=vc(e,e.bag.accountUrl)
return n.title=e.loc.string("VIEW_ACCOUNT_INFO",UL),sp(e,n,{...t,id:Wj,actionType:UH},!1,DN),n}(e,n)
case tk:return function(e,t){const n=e.bag.signup
if((0,Cv.isNothing)(n))return null
const r=vc(e,n)
return e.featureFlags.isEnabled(ry)?r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID_REBRAND"):r.title=e.loc.string("ACCOUNT_CREATE_APPLE_ID"),sp(e,r,{...t,id:Wj,actionType:UH},!1,DN),r}(e,n)
case JD:return function(e,t){if((0,Cv.isNothing)(e.bag.purchaseHistoryUrl))return null
const n=vc(e,e.bag.purchaseHistoryUrl)
return n.title=e.loc.string("ACCOUNT_PURCHASE_HISTORY"),n.presentationContext=QD,sp(e,n,{...t,id:JD,actionType:UH},!1,DN),n}(e,n)
case T$:return function(e,t){if(e.user&&e.user.isManagedAppleID)return null
const n=vc(e,e.bag.redeemUrl)
return n.title=e.loc.string("ACCOUNT_REDEEM",ok),sp(e,n,{...t,id:"redeemGiftCardOrCode",actionType:UH},!1,DN),n}(e,n)
case nk:return function(e,t){if(!e.bag.isMonetaryGiftingEnabled)return null
const n=vc(e,b$)
return n.title=e.loc.string("ACCOUNT_SEND_GIFT",oy),sp(e,n,{...t,id:"sendGiftCardByEmail",actionType:UH},!1,DN),n}(e,n)
case rk:return function(e,t){var n
const r=e.bag.accountTopUpURL
if((0,Cv.isNothing)(r)||o(r))return null
const i=vc(e,r)
return i.title=null!==(n=e.bag.accountTopUpTitle)&&void 0!==n?n:e.loc.string("ACCOUNT_TOP_UP"),sp(e,i,{...t,id:"addFundsToAppleId",actionType:UH},!1,DN),i}(e,n)
case KD:return function(e,t){const n=new cz(HV,iy)
return n.title=e.loc.string("ACCOUNT_SETUP_FAMILY_SHARING"),sp(e,n,{...t,id:"setUpFamilySharing",actionType:UH},!1,DN),n}(e,n)
case ZD:return function(e,t){const n=vc(e,e.bag.manageSubscriptionsV2Url)
return n.title=e.loc.string("ACCOUNT_SUBSCRIPTIONS"),n.presentationContext=QD,sp(e,n,{...t,id:ZD,actionType:UH},!1,DN),n}(e,n)
default:return null}}function Bp(e){const t=new bv.FetchTimingMetricsBuilder,n=e.addingFetchTimingMetricsBuilder(t),r={pageInformation:li(e,UL,Wj,""),locationTracker:{rootPosition:0,locationStack:[]},targetType:uH},o=t.measureModelConstruction(()=>{const t=new n5
return t.links[ek]=Np(e,ek,r),t.links[tk]=Np(e,tk,r),t.links[T$]=Np(e,T$,r),t.links[nk]=Np(e,nk,r),t.links[rk]=Np(e,rk,r),t.links[KD]=Np(e,KD,r),t.links[ZD]=Np(e,ZD,r),t.links[JD]=Np(e,JD,r),t})
return ui(n,o,r.pageInformation),o}async function Up(e,t){return await e.required(G4).fetchPage(e,t,J4)}async function Gp(e){let t
try{t=await Jn(e,function(e){return new wJ(e).forType(pD)}(e))}catch{t=void 0}return function(e,t){const r=[],o=new Z4,i=new _q(e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_IN"),mj,iM)
o.addContentItem(new t5(i))
const a=e.bag.personalizedRecommendationsToggleEnabled
if(!a){const t={}
t[e.loc.string(hD)]=Hp(e)
const n=new Dq(e.loc.string("PERSONALIZATION_DESCRIPTION_FOOTER_OPTED_IN").replace("{account_settings}",e.loc.string(hD)))
o.footer=new BY(n,t)}if(r.push(o),a){const t=new Z4
t.addContentItem(new r5(e.loc.string(CI),!1))
const n=new Dq(e.loc.string(kI))
t.footer=new BY(n),r.push(t)}{const t=new Z4(e.loc.string("PERSONALIZATION_SECTION_USAGE_HEADER")),n=new Dq(e.loc.string("PERSONALIZATION_SECTION_USAGE_FOOTER"))
t.footer=new BY(n),t.addContentItem(new X4(e.loc.string("PERSONALIZATION_SECTION_USAGE_CLEAR_DATA"),function(e){const t=new Pz
t.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_TITLE")
const n=new ez([t])
return n.title=e.loc.string("PERSONALIZATION_CLEAR_USAGE_DATA_CONFIRMATION_HEADER"),n.isCancelable=!0,n.destructiveActionIndex=0,n}(e))),r.push(t)}const c=new Z4(e.loc.string("PERSONALIZATION_INTERACTIONS")),l=new Dq(e.loc.string("PERSONALIZATION_INTERACTIONS_FOOTER"))
c.footer=new BY(l)
const u=e.bag.purchaseHistoryUrl;(0,kv.isSome)(u)?c.addContentItem(new X4(e.loc.string(OI),Vp(e,KU,u,!0),PF)):c.addContentItem(new X4(e.loc.string(OI),Vp(e,jm,null,!0),PF)),c.addContentItem(new X4(e.loc.string("PERSONALIZATION_SUBSCRIPTIONS"),Vp(e,null,e.bag.manageSubscriptionsV2Url,!1),PF)),c.addContentItem(new X4(e.loc.string("PERSONALIZATION_PREORDERS"),Vp(e,null,e.bag.managePreordersUrl,!0),PF)),c.addContentItem(new X4(e.loc.string("PERSONALIZATION_RATINGS"),Vp(e,null,c5,!0),PF)),r.push(c)
const d=new Z4(e.loc.string("PERSONALIZATION_ADDITIONAL_INFO")),p=[e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_1"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_2"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_3"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_4"),e.loc.string("PERSONALIZATION_ADDITIONAL_INFO_ITEM_5")].join("\n"),h=new _q(p,mj,iM)
d.addContentItem(new t5(h)),r.push(d)
const w=n(t,"results.derived-user-info")
if(s(w)){const t=new Z4(e.loc.string("ACCOUNT_INFO")),n=["gender","birthyear"]
for(const e of n){const n=f(w,`${e}.label`),r=f(w,`${e}.value`);(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0&&t.addContentItem(new e5(n,r))}const o=e.featureFlags.isEnabled(ry)?"PERSONALIZATION_ACCOUNT_INFO_FOOTER_REBRAND":"PERSONALIZATION_ACCOUNT_INFO_FOOTER",i=new Dq(e.loc.string(o))
t.footer=new BY(i),r.push(t)}return new J4(e.loc.string(EI),r)}(e,t)}function jp(e){const t=[],n=e.bag.personalizedRecommendationsToggleEnabled,r=new Z4,o=n?e.loc.string("PersonalizedRecommendations.OptedOut.Description"):e.loc.string("PERSONALIZATION_DESCRIPTION_OPTED_OUT"),i=new _q(o)
if(r.addContentItem(new t5(i)),t.push(r),n){const n=new Z4
n.addContentItem(new r5(e.loc.string(CI),!1))
const r=new Dq(e.loc.string(kI))
n.footer=new BY(r),t.push(n)}else{const n=new Z4
n.addContentItem(new X4(e.loc.string(hD),Hp(e),PF)),t.push(n)}return new J4(e.loc.string(EI),t)}function Vp(e,t,n,r){let o
if((0,kv.isSome)(t))o=new dY(t,n)
else{if((0,kv.isNothing)(n))return null
o=vc(e,n)}return r&&(o.presentationContext=QD),o}function Hp(e){return Vp(e,void 0,e.bag.accountUrl,!1)}async function qp(e,t){const n=new wJ(e).forType(RI).addingQuery(CR,"events-reminders").addingQuery("service",$D).addingQuery(EV,"explicit")
n.isMediaRealmRequest=!0
const r=function(e,t){const n={"events-reminders":{"com.apple.AppStore":{contents:[{id:e,type:DH,notify:t}]}}}
return{method:"PATCH",headers:{"Content-Type":nO},requestBodyString:JSON.stringify(n)}}(t.appEventId,t.shouldSchedule)
return await new Promise((t,o)=>{Jn(e,n,r).then(e=>{t(!0)}).catch(e=>{o(e)})})}function Wp(e){M5||(M5=!0,$5=new T5(e.loc.string("PAGE_FACETS_SORTS_RELEASE_DATE"),I5,NN),F5=new T5(e.loc.string("PAGE_FACETS_SORTS_LAST_UPDATED"),C5,"lastUpdated"),N5=new T5(e.loc.string("PAGE_FACETS_SORTS_NAME"),k5,GH),B5=new T5(e.loc.string("PAGE_FACETS_SORTS_CATEGORY"),O5,AG),U5=new T5(e.loc.string("PAGE_FACETS_DEFAULT_ALL"),null),G5=new T5(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_4PLUS"),"4Plus"),j5=new T5(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_9PLUS"),"9Plus"),V5=new T5(e.loc.string("PAGE_FACETS_FILTERS_AGE_VALUE_12PLUS"),"12Plus"),H5=new T5(e.loc.string(Cy),FV,null,"gamecontroller"),q5=new T5(e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER"),FV,null,"person.2"),W5=new T5(e.loc.string(ky),FV),L5[Hz.sort]={releaseDate:[$5],lastUpdated:[F5],name:[N5],category:[B5]},L5[Hz.ageRating]={"4plus":[G5],"9plus":[j5],"12plus":[V5]},L5[Hz.controllerSupport]={true:[H5],false:[]},L5[Hz.multiplayerSupport]={true:[q5],false:[]},L5[Hz.comingSoon]={true:[W5],false:[]})}function zp(e,t={}){Wp(e)
const n={"filter[ageRating]":[U5]}
n[E5]=[$5],n[R5]=[W5]
const r=[Hz.sort,Hz.ageRating,Hz.controllerSupport,Hz.multiplayerSupport,Hz.comingSoon]
for(const e of r){const r=t[e]
if(o(r))continue
const a=L5[e][r],c=z5[e]
i(a)&&s(c)&&(n[`${c}`]=a)}return n}function Yp(e,t){const n=new lz
return cp(e,n,t),n}function Jp(e){const t=[lH,oH,Nj,Uj,tG,SG]
return e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}function Kp(e,t,n){return Iv.context("createShelves",()=>{const r=[]
if(0===t.length)return r
let o=!1
for(const s of t)if(o=o||!le(s.data[0]),o)n.remainingGroups.push(s)
else{const t={index:n.lastShelfIndex,title:Qp(e,s),contentType:(i=n.isCompactMode,i?eH:_$),shouldFilter:!1,remainingContent:s.data,groupKind:s.kind,isCompactMode:n.isCompactMode,hasExistingContent:!1,isFirstRender:!0,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker},o=Zp(e,t)
r.push(o),n.lastShelfIndex++}var i
return r})}function Zp(e,t){const n=[],r=new oJ(t.contentType)
r.title=t.title,r.presentationHints={showSupplementaryText:!1},r.isHorizontal=t.groupKind===BN||t.groupKind===AG
const i={id:`${t.index}`,kind:null,softwareType:null,targetType:jV,title:r.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:YV}
for(Bf(e,r,i),kf(0,i,r.title);s(t.remainingContent)&&le(t.remainingContent[0]);){const r=t.remainingContent.shift(),o={metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(r)},artworkUseCase:1,canDisplayArcadeOfferButton:of(0,t.contentType),shouldHideArcadeHeader:e.featureFlags.isEnabled(BF),isContainedInPreorderExclusiveShelf:t.groupKind===BN},i=Mu(e,r,o,{playbackControls:{prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},autoPlayPlaybackControls:{prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0}},null,null)
Xp(e,i,r)&&(i.editorialTagline=null,i.developerTagline=null,n.push(i),xf(t.metricsLocationTracker))}return r.mergeWhenFetched=t.hasExistingContent,t.hasExistingContent=t.hasExistingContent||n.length>0,r.items=n,s(t.remainingContent)?r.url=function(e){return o(e.remainingContent)?null:`${Oz}:/${_z.arcadeSeeAllGames}/${_z.shelf}/?${Hz.token}=${encodeURIComponent(JSON.stringify(e))}`}(t):"tv"!==e.client.deviceType&&t.isCompactMode&&r.items.length<3&&(r.rowsPerColumn=r.items.length),Ef(t.metricsLocationTracker),r}function Qp(e,t){let n,r,o=null,i=null
if((!t.name||0===t.name.length)&&t.kind!==BN)return""
switch(t.kind){case"releaseDateByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_RELEASE_DATE_SENTENCE"),n=e.loc.formatDateInSentence(r,Fy,i)
break
case"lastUpdatedByDay":o=t.name.split("-"),i=new Date(parseInt(o[0]),parseInt(o[1])-1,parseInt(o[2])),r=e.loc.string("ALL_GAMES_SECTION_TITLE_LAST_UPDATED_SENTENCE"),n=e.loc.formatDateInSentence(r,Fy,i)
break
case BN:n=e.loc.string("Arcade.SeeAllGames.ComingSoonShelf.Title")
break
default:n=t.name}return n}function Xp(e,t,n){if(o(t.trailers)){const r=Fd(e,n)
if(s(r)){const e=new EY
r.playbackControls={prominentPlay:!0,fullScreenToggle:!0,inlinePlayPause:!0,muteUnmute:!0},r.autoPlayPlaybackControls={prominentPlay:!0,fullScreenToggle:!1,inlinePlayPause:!1,muteUnmute:!0},r.canPlayFullScreen=!0,e.videos=[r],t.trailers=[e]}}return o(t.trailers)&&function(e){const t=e.screenshots[0]
if(o(t))return
const n=t.artwork[0],r=new Vq(Y5,n,{allowsAutoPlay:!1,looping:!1,canPlayFullScreen:!1,autoPlayPlaybackControls:{},playbackControls:{}}),i=new EY
i.videos=[r],e.trailers=[i]}(t),s(t.trailers)}async function eh(e,t){const n=e.required(G4),r=oY.from(t.url)
return r.param(Hz.requestDescriptor,JSON.stringify(t)),await n.fetchPage(e,r.build(),hJ)}async function th(e,t){const n=e.required(G4)
return await n.fetchMoreOfPage(e,t).then(function(e){return e})}function nh(e,t){const n=zp(e,t),r={}
for(const e of Object.keys(n))r[e]=n[e].map(e=>({value:e.value,title:e.title,metricsValue:e.metricsValue,systemImageName:e.systemImageName}))
const o={url:`${Oz}:/${_z.arcadeSeeAllGames}`,isCompactMode:!1,selectedFacetOptions:r},i=t[Hz.requestDescriptor]
if(s(i)){const e=g(JSON.parse(i))
o.isCompactMode=e.isCompactMode,Object.assign(o.selectedFacetOptions,e.selectedFacetOptions)}return o}async function rh(e,t){const n=oY.from(t)
return await e.required(G4).fetchPage(e,n.build(),WJ)}function oh(e){let t=0,n=0
for(const r of e.shelves)(0,kv.isSome)(r.batchGroup)&&r.batchGroup.length>0||(r.batchGroup=`shelfBatchGroup_${t}`,n++,5===n&&(n=0,t++))}async function ih(e,t){const n=oY.from(t.url)
return n.param(Hz.isArcade,"true"),n.param(Hz.isSubscribed,`${t.isSubscribed}`),n.param(Hz.isTrialAvailable,`${t.isTrialAvailable}`),n.param(Hz.isTrialEnrolled,`${t.isTrialEnrolled}`),await e.required(G4).fetchPage(e,n.build(),pJ)}function sh(e,t){const n=new xW(xH)
n.popToRoot=!0
const r=new $W([n])
return r.title=t,r}async function ah(e,t){return await e.required(G4).fetchPage(e,t,JJ)}async function ch(e,t){const n=new Promise((n,r)=>{const o=t
s(o)||r(new Error("fetchUpsellGrid called with malformed contentDictionary"))
const i=Ae(o,FH),a={pageInformation:new XX({}),locationTracker:{rootPosition:0,locationStack:[]}},c=od(e,i,a,{useCase:2}),l=c.shift()
n(new QJ(l,c))})
return await n}async function lh(e,t){const n=g(t,$G)
let r=n.buyParams
r=Nt(e,f(t,wj),r,g(t,FI),u(t,NI),u(t,BI),f(t,UI),f(t,GI),f(t,gD),h(t,eG),h(t,jI),g(t,VI),f(t,HI),f(t,"token.extRefApp2"),f(t,"token.extRefUrl2"))
const o=new sK(r),i={product:f(t,Jj)||n.productIdentifier,adamId:f(t,wj),buyParams:o.toEncodedMap()}
return await Promise.resolve(i)}async function uh(e,t){const n=t.offerAction,o=t.offerDisplayProperties
if(!n||!o)return await Promise.reject(new Error("Invalid offerToken for personalized offer fetch."))
const i=n.adamId,s={"Content-Type":Cx},a={url:e.bag.buyButtonMetadataURL,method:zB,headers:s,body:"ids="+i,signingStyle:KG},c=e.network.fetch(a)
return await c.then(t=>{if(!t.ok)throw Error(`Bad Status code ${t.status} for ${a.url}`)
const s=h(JSON.parse(t.body),i)
let c=null,u=null
const d=function(e,t){return Iv.context("personalizedOfferTypeFromBuyButtonMetadata",()=>{const e=l(t,GU)
if(0===e.length)return null
for(const t of e){const e=f(t,oj)
if(e)return e}return qV})}(0,s)
if(r(d))throw new Error("fetchPersonalizedOfferContext: Failed to determine offer type from buyButtonMetadata")
if(d!==qV){let t=rG
c=function(e,t,n,o){return Iv.context("personalizedCMCOfferActionFromBuyButtonMetadata",()=>{const o=l(t,GU)
if(0===o.length)return null
let i,s=null
for(const e of o)switch(i=f(e,oj),i){case Mx:case LL:s=e
break
default:s=null}if(!s)return null
let a=f(s,ZU)
if(i===Mx&&r(a))return Iv.unexpectedNull(Qj,gH,jO),null
a||(a="")
const c=n.purchaseConfiguration,u=new gq(a,c.vendor,c.appName,c.bundleId,c.appPlatforms,c.isPreorder,c.excludeAttribution,c.metricsPlatformDisplayStyle,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.appCapabilities,c.isDefaultBrowser,c.remoteDownloadIdentifiers,c.hasMacIPAPackage,c.contentRating)
u.pageInformation=c.pageInformation
const d=Yt(e,s,n.adamId,u,!1)
return function(e,t,n,r){const o=n.purchaseConfiguration.pageInformation
let i
if((0,Cv.isSome)(n.actionMetrics))for(const e of n.actionMetrics.data)if(i=l(m(e.fields),jF),i)break
op(e,t,t.adamId,false,o,i,!1)}(e,d,n),d})}(e,s,n)
let i=null
switch(d){case LL:t=kN,i=e.loc.string("OfferButton.Title.BundlePurchased")
break
case Mx:(r(c.price)||0===c.price)&&(i=e.loc.string($x))}u=function(e,t,n,o,i){return r(t)?null:Iv.context("personalizedCMCDisplayPropertiesFromBuyButtonMetadata",()=>{const r=new vq(n,t.adamId,t.bundleId,i),s=qt(0,t)
r.isFree=s
let a=null
a=s?t.title:t.priceFormatted,r.titles[LH]=a,r.priceFormatted=t.priceFormatted
const c=o.hasInAppPurchases,l=o.hasExternalPurchases
if(r.hasInAppPurchases=c,r.hasExternalPurchases=l,l){const t=e.loc.string(uS)
r.subtitles[LH]=t}else if(c){const t=e.loc.string(lS)
r.subtitles[LH]=t}return r.contentRating=o.contentRating,r.appCapabilities=t.purchaseConfiguration.appCapabilities,r})}(e,c,SH,o,t),i&&(u.titles[LH]=i)}const p=nn(e,c,!1)
return new mq(d,p,u)})}async function dh(e,t){var n
let r=f(t,"token.buyParams")
const s=f(t,"overrideBuyParams")
i(s)&&(r=function(e,t){const n=new sK(e),r=new sK(t),i=n.get(KK.placementId,null);(null==i?void 0:i.length)>0&&o(r.get(KK.placementId,null))&&r.set(KK.placementId,i,null)
const s=n.get(KK.containerId,null);(null==s?void 0:s.length)>0&&o(r.get(KK.containerId,null))&&r.set(KK.containerId,s,null)
const a=n.get(KK.templateType,null)
return(null==a?void 0:a.length)>0&&o(r.get(KK.templateType,null))&&r.set(KK.templateType,a,null),r.toString()}(r,s)),r=Nt(e,f(t,wj),r,g(t,FI),u(t,NI),u(t,BI),f(t,UI),f(t,GI),f(t,gD),h(t,eG),h(t,jI),g(t,VI),f(t,HI),f(t,"metrics.extRefApp2"),f(t,"metrics.extRefUrl2"))
const a=l(t,"token.appPlatforms"),c=a&&a.length&&a.length>0&&a.indexOf("tv")>=0,d=a&&a.length&&a.length>0&&a.indexOf(kH)>=0,w=u(t,"token.isHalva")||u(t,"token.isMacOSCompatibleIOSApp"),m=u(t,"token.supportsVisionOSCompatibleIOSBinary"),y=kd(0,e.client.deviceType,w,m).some(e=>-1!==a.indexOf(e)),A=w&&!1,T=(a.indexOf(kH),m&&!1),b=f(t,"instalationType"),S=b===Lx,P=b===rA,I=u(t,"token.isPreorder"),C=!(I||(c||d)&&!y),k=f(t,gD)===MH&&e.client.deviceType!==MH,O=f(t,"token.preflightPackageUrl"),E={...h(t,"token.additionalHeaders",{}),...h(t,"additionalHeaders",{})}
let R={}
const D=null===(n=e.paymentMetricsIdentifiersCache)||void 0===n?void 0:n.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical])
return(0,kv.isSome)(D)&&(R={...D}),{adamId:f(t,wj),buyParams:r,vendor:f(t,"token.vendor"),appName:f(t,"token.appName"),bundleId:f(t,"token.bundleId"),appPlatforms:a,additionalHeaders:E,isUpdate:S,isRedownload:P,isPreorder:I,createsJobs:C,preflightPackageUrl:O,isArcadeApp:v(t,"token.isArcadeApp"),forceWatchInstall:k,isMacOSCompatibleIOSApp:A,isVisionOSCompatibleIOSApp:T,presentingSceneIdentifier:f(t,"presentingSceneIdentifier"),appCapabilities:l(t,"token.appCapabilities"),isDefaultBrowser:v(t,"token.isDefaultBrowser"),requiresExceptionRequest:v(t,"requiresExceptionRequest"),forceAskToBuyReason:f(t,"forceAskToBuyReason"),contentRating:p(t,"token.contentRating"),metricsOverlay:R,remoteDownloadIdentifiers:l(t,"token.remoteDownloadIdentifiers"),hasMacIPAPackage:v(t,"token.hasMacIPAPackage")}}async function fh(e,t){const n=new wJ(e).withIdsOfType(t,BH).includingMacOSCompatibleIOSAppsWhenSupported(!0).includingAdditionalPlatforms(N(e))
return await Jn(e,n).then(t=>{const n=V(t),r={}
for(const t of n)r[t.id]=sd(e,t,{useCase:3})
return r})}async function ph(e,t){const n=new S6(t.targetingData,e.random.nextUUID()),r=wh(e,t)
if(null===r)return null
const o=Jn(e,r,function(e,t){const n={}
return(0,Cv.isSome)(t)&&t.validAdRequest()&&(n["X-Apple-App-Store-Client-Request-Id"]=t.appStoreClientRequestId,n["X-Apple-iAd-Request-Data"]=t.requestData,n["X-Apple-iAd-Env-Name"]=t.routingInfo),{headers:n}}(0,n))
if(e.bag.mediaAPISearchFocusEnabled){const n={term:t.term.trim(),entity:t.searchEntity}
e.onDeviceSearchHistoryManager.saveRecentSearchWithLimit(n,30)}const s=async function(e,t,n,r){var o
if(!t.validAdRequest())return _n(e,"ODML fetch skipped - Malformed request"),{adverts:[],odmlSuccess:!1}
const i=await r,s=function(e,t){const n=t.results[WP]
if((0,kv.isNothing)(n))return[]
const r=V(n),o=[]
for(const t of r){const n=f(t,"id"),r=ne(t,TR)
if((0,kv.isNothing)(n)||0===n.length||(0,kv.isNothing)(r))continue
let i=null,s=null
e.bag.enableCPPInSearchAds&&(i=et(Qe(e,t)),s=nt(e,t)),o.push({instanceId:e.random.nextUUID(),adamId:n,assetInformation:{},adData:r,cppIds:s,serverCppId:i,selectedCppId:i,appBinaryTraits:Id(e,t)})}return o}(e,i),a=function(e,t,n){const r=V(t.results.search),o=[]
for(const e of r){const t=f(e,"id");(0,kv.isNothing)(t)||0===t.length||o.push({adamId:t,assetInformation:{}})}return o}(0,i)
try{if(e.isAvailable(XH)){const t=await e.ads.processAdvertsForSponsoredSearch(s,a,n,e.bag.sponsoredSearchODMLTimeout,e.client.isPhone||e.client.isPad)
return t.odmlSuccess?_n(e,"ODML processing completed"):_n(e,"ODML processing failed"),{adverts:null!==(o=t.adverts)&&void 0!==o?o:s,odmlSuccess:t.odmlSuccess,installedStates:t.installedStates,appliedPolicy:t.appliedPolicy,appStates:t.appStates}}return _n(e,"ODML fetch skipped - Unsupported client"),{adverts:s,odmlSuccess:!1}}catch(t){return _n(e,`ODML fetch failed - ${t}`),{adverts:s,odmlSuccess:!1}}}(e,n,t.term,o),a=async function(e){if(function(e){switch(e){case CH:case $H:return!0
default:return!1}}(e.client.deviceType)){const t=qn(e,null,null,N(e))
if(t)return await Jn(e,t).catch(()=>null)}return null}(e)
return await Promise.all([o,s,a]).then(([o,s,a])=>{var c,l,u,d
if(function(e){var t
const n=W(e),r=bR
i(n)&&i(e.meta)&&i(null===(t=e.meta)||void 0===t?void 0:t.metrics)&&(e.meta.metrics[e0]=f(n,r),delete e.meta.metrics[r])}(o),null===(u=null===(l=null===(c=o.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.naturalLanguage){const t=e.storage.retrieveString(ER),n=pt(new Date).getTime().toString()
e.storage.storeString(ER,n),null===(d=e.amsEngagement)||void 0===d||d.enqueueData({eventType:"lastNLSQueryDateChange",app:$D,oldState:t,newState:n})}return{catalogResponse:o,categoriesFilterData:a,searchResultsAdsRequestData:n,searchResultsAdData:s,requestMetadata:{requestDescriptor:t,searchRequestUrl:at(e,r).toString()}}})}async function hh(e,t){const n=function(e,t){const n=e.bag.isLLMSearchTagsEnabled||u(e.bag.supportedMixedMediaRequestUsecases[JV]),r=new wJ(e,t,n,[tj]).includingAdditionalPlatforms(N(e)).includingScopedAttributes(OH,[DR]).includingAttributes(gh(e)).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ze(e))
return st(e,r,t),r.includingRelationships(C6),$i(e)&&(r.includingAssociateKeys(BH,[DH]),r.includingScopedAttributes(DH,eQ),r.includingScopedRelationships(OH,[Yj])),r}(e,t)
return await Jn(e,n)}function wh(e,t){var n
const r=null===(n=t.term)||void 0===n?void 0:n.trim()
if(o(r))return null
const i=t.origin,a=t.source,c=t.searchEntity,l=t.facets,d=t.selectedFacetOptions,f=t.spellCheckEnabled,p=t.excludedTerms,h=e.host.clientIdentifier,w=new wJ(e).withSearchTerm(r).includingAdditionalPlatforms(N(e)).includingAttributes(gh(e)).includingScopedAttributes(OH,[DR]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported().usingCustomAttributes(Ze(e))
if(dl(e,w),w.includingRelationships(C6),$i(e)&&(w.includingAssociateKeys(BH,[DH]),w.includingScopedAttributes(DH,eQ),w.includingScopedRelationships(OH,[Yj])),u(e.client.isTinkerWatch)&&w.withFilter(hU,"tinker"),w.enablingFeature(_L),w.enablingFeature(VP),s(t.guidedSearchTokens)&&w.addingQuery("selectedFacets",t.guidedSearchTokens.join(",")),s(t.guidedSearchOptimizationTerm)&&w.addingQuery("finalTerm",t.guidedSearchOptimizationTerm),e.bag.isLLMSearchTagsEnabled&&w.includingAssociateKeys("results:apps",[tj]),e.featureFlags.isEnabled(dR)&&w.includingScopedAttributes(BH,[SG]),c===RB?w.searchingOverTypes([OH]):c===cV?w.searchingOverTypes([_G]):c===MH||c===xH?w.searchingOverTypes([BH]).withFilter(hU,c):w.searchingOverTypes([BH,_G,pj,OH,IH,kV]),e.appleSilicon.isSupportEnabled&&!e.appleSilicon.isRosettaAvailable&&w.addingQuery("restrict","!requiresRosetta"),l)for(const e of Object.keys(l))w.addingQuery(e,l[e])
if(d)for(const e of Object.keys(d)){const t=P5.requestValuesForSelectedFacetOptions(d[e])
if(s(t)){w.addingQuery(e,t.value)
for(const e of Object.keys(t.additionalKeyValuePairs))w.addingQuery(e,t.additionalKeyValuePairs[e])}}const g=e.bag.isNaturalLanguageSearchEnabled||e.bag.isNaturalLanguageSearchResultsEnabled,v=g?"source":"src"
if(i===LM){const e=g&&(null==a?void 0:a.length)?"hint:".concat(a):Ox
w.addingQuery(v,e)}else i===lE?w.addingQuery(v,GS):i===mN?w.addingQuery(v,mN):i===uE?w.addingQuery(v,"searchInstead"):i===dE?w.addingQuery(v,Rb):i===_R&&w.addingQuery(v,TU)
switch(h){case Zq:w.addingContext(MH)
break
case Qq:w.addingContext(_V)
break
case Xq:w.addingContext(xH)}return w.addingQuery("limit[ads-result]",e.bag.mediaAdvertRequestLimit.toString()),s(e.bag.adsOverrideLanguage)&&w.enablingFeature(fy),f&&w.enablingFeature("spellCheck"),g&&w.enablingFeature(NP),w.enablingFeature("searchResultCpps"),p&&w.addingQuery("excludeTerms",p.join(",")),w}function gh(e){const t=[SG,w_,tG,Uj,tU,g_,eV,FF,Xk,xR,r$,oH]
return e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),e.host.isOSAtLeast(15,5,0)&&t.push(xB),t}function vh(e,t){return Iv.context("developerPageFromResponse",()=>{const n=t.data.length?t.data[0]:null
if(!n)return null
const r=ci(e,"Artist",n.id,t),i=function(e,t,n,r){switch(e.client.deviceType){case $H:return function(e,t,n,r){var i
e.appleSilicon.isSupportEnabled?(bh(t,kj,[YB,W$]),bh(t,YB,[W$])):bh(t,kj,[YB])
const a=eH
let c=0
const u=[]
for(const d of N6){const f=ve(t,d),p=l(f,wG),h=p.length
if(0===h)continue
if(d===gG&&0===h)continue
const w=Ah(e,d,t)
kf(0,{pageInformation:n,locationTracker:r,idType:YV,id:`${c}`,targetType:jV},w)
const g={lockupOptions:{metricsOptions:{pageInformation:n,locationTracker:r},artworkUseCase:1},filter:76532},v=p.filter(e=>o(e.attributes)),m=(null===(i=f.next)||void 0===i?void 0:i.length)>0||h>=8,y=Th(e,w,t.id,p,d,a,g,n,r,f.href,m),A=y.items.length+v.length
A<3&&(y.rowsPerColumn=A)
const T={id:null,kind:null,softwareType:null,targetType:jV,title:y.title,pageInformation:n,locationTracker:r,idType:null}
if(Ef(r),Bf(e,y,T),xf(r),v.length){const e=new j6
e.title=w,e.developerId=t.id,e.contentType=eH,e.remainingData=v,e.lockupListOptions=g,e.relationship=d,e.roomUrl=f.href,e.shouldShowSeeAll=m,e.hasExistingContent=s(y.items),y.url=`${Oz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}y.items.length>0&&(u.push(y),c++)}return u}(e,t,n,r)
case MH:return function(e,t,n,r,i,a,c){const l=Ae(n,r),u={lockupOptions:{metricsOptions:{pageInformation:a,locationTracker:c},artworkUseCase:1},filter:76532}
kf(0,{pageInformation:a,locationTracker:c,idType:YV,id:"0",targetType:jV},i)
const d=Th(e,i,n.id,l,r,t,u,a,c,null,!1),f=l.filter(e=>o(e.attributes)),p={id:null,kind:null,softwareType:null,targetType:jV,title:i,pageInformation:a,locationTracker:c,idType:null}
if(Ef(c),Bf(e,d,p),xf(c),f.length){const e=new j6
e.title=i,e.developerId=n.id,e.contentType=t,e.remainingData=f,e.lockupListOptions=u,e.hasExistingContent=s(d.items),d.url=`${Oz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}return[d]}(e,eH,t,QZ,e.loc.string(uO),n,r)
case kH:return yh(e,t,U6,n,r)
case JG:return yh(e,t,G6,n,r)
default:return yh(e,t,B6,n,r)}}(e,n,r,{rootPosition:0,locationStack:[]})
1===i.length&&(i[0].isHorizontal=!1)
const a=Kd(e,n,LH)
if(a){const e=new _q(a,QG),t=new oJ(fG)
t.items=[e],i.unshift(t)}const c=new lJ(i)
c.title=ie(n,GH),e.client.deviceType!==MH&&(c.presentationOptions=[FU]),c.canonicalURL=ie(n,AH),ui(e,c,r)
const u=ne(n,D_)
if(u){const t=nd(e,u,{cropCode:"sr",useCase:21})
c.uber=t
{const e=new oJ("uber"),n=new v1(YA)
n.artwork=t,e.items=[n],n.title=c.title,i.unshift(e),c.presentationOptions.push($_),c.presentationOptions.push(J$)}}return c})}function mh(e,t,n){switch(t){case gG:return e.loc.string(dO)
case z$:return e.loc.string("DEVELOPER_SYSTEM_APPS")
case oN:return e.loc.string("DEVELOPER_IMESSAGE")
case qN:return e.loc.string(uO)
case WN:return e.loc.string("DEVELOPER_TV")
case IH:return e.loc.string(fO)
case Y$:return e.loc.string("DEVELOPER_VISION")
case JB:const t=ae(n,JA),r=ae(n,KA)
return t&&r?e.loc.string(ZA):r?e.loc.string(QA):e.loc.string(XA)
case kj:return e.loc.string(pO)
default:return null}}function yh(e,t,n,r,i){var a,c
let u,d
switch(bh(t,kj,[JB,WN]),e.client.deviceType){case"tv":case JG:u=LV,d=2
break
default:u=eH,d=1}let f=0
const p=[]
for(const h of n){const n=ve(t,h),w=l(n,wG),g=w.length
if(0===g)continue
if(h===gG&&0===g)continue
let v,m
v=h===oN?Qq:h===qN?Zq:h===WN?eW:Kq,m=mh(e,h,t),kf(0,{pageInformation:r,locationTracker:i,idType:YV,id:`${f}`,targetType:jV},m)
const y={lockupOptions:{metricsOptions:{pageInformation:r,locationTracker:i},clientIdentifierOverride:v,artworkUseCase:d},filter:76532},A=w.filter(e=>o(e.attributes)),T=((null===(a=n.next)||void 0===a?void 0:a.length)>0||g>=8)&&!0,b=Th(e,m,t.id,w,h,u,y,r,i,n.href,T),S=b.items.length+A.length
S<3&&(b.rowsPerColumn=S)
const P={id:null,kind:null,softwareType:null,targetType:jV,title:b.title,pageInformation:r,locationTracker:i,idType:null}
if(Ef(i),Bf(e,b,P),xf(i),A.length){const e=new j6
e.title=m,e.developerId=t.id,e.contentType=u,e.remainingData=A,e.lockupListOptions=y,e.relationship=h,e.roomUrl=n.href,e.shouldShowSeeAll=T,e.hasExistingContent=s(b.items),b.url=`${Oz}:/${_z.developer}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e))}(b.items.length>0||(null===(c=b.url)||void 0===c?void 0:c.length)>0)&&(p.push(b),f++)}return p}function Ah(e,t,n){switch(t){case gG:return e.loc.string(dO)
case IH:return e.loc.string(fO)
case YB:if(e.appleSilicon.isSupportEnabled)return e.loc.string("DEVELOPER_MAC_APPS")
{const t=ae(n,JA),r=ae(n,KA)
return t&&r?e.loc.string(ZA):r?e.loc.string(QA):e.loc.string(XA)}case W$:return e.loc.string("DEVELOPER_PHONE_PAD_APPS")
case kj:return e.loc.string(pO)
default:return null}}function Th(e,t,n,o,s,a,c,l,u,d,f){const p=new oJ(a)
if(p.title=t,a===j$?(p.items=function(e,t,n){return Iv.context("screenshotsLockupsFromData",()=>{if(!t)return[]
const o=[]
for(let s=0;s<t.length;s++){const a=t[s]
if(r(a.attributes)){n.contentUnavailable&&n.contentUnavailable(s,a)
continue}const c=n.lockupOptions
let l=80894
if(i(n.filter)&&(l=n.filter),vt(e,a,l))continue
const u=xu(e,a,c)
u.isValid()&&(o.push(u),xf(n.lockupOptions.metricsOptions.locationTracker))}return o})}(e,o,c),p.isHorizontal=!1,p.presentationHints={showSupplementaryText:!1}):(p.items=Gu(e,o,c),p.isHorizontal=e.client.deviceType!==MH),f){const r=new F6
r.title=t,r.url=d,r.developerId=n,r.relationshipId=s,r.clientIdentifierOverride=c.lockupOptions.clientIdentifierOverride
const o=new dY(jH)
o.pageUrl=i(h=r)?`${Oz}:/${_z.developer}/${_z.room}/`+encodeURIComponent(JSON.stringify(h)):null,o.title=e.loc.string(Oj),o.pageData=uc(0,t),ap(e,o,o.pageUrl,{pageInformation:l,locationTracker:u}),p.seeAllAction=o}var h
return p}function bh(e,t,n){const o=ve(e,t)
if(r(o))return
const i=V(o)
if(r(i))return
const s=i.map(e=>e.id)
for(const t of n){const n=ve(e,t)
if(r(n))continue
const o=V(n)
r(n)||(e.relationships[t].data=o.filter(e=>!s.includes(e.id)))}}function Sh(e,t,n,r){const o=function(e,t,n,r){const o=Ph(0,n.collectionDisplayStyle)
return{...n.metricsImpressionOptions,...r,id:t.id,targetType:o}}(0,t,n,r)
return ju(e,t,o,n.clientIdentifierOverride)}function Ph(e,t){switch(t){case Kv.Hero:return OB
case Kv.TextOnly:return F_
case Kv.TextWithArtwork:return"textWithArtwork"
case Kv.BrickSmall:return"brickSmall"
case Kv.BrickMedium:return"brickMedium"
case Kv.BrickLarge:return"brickLarge"
case Kv.EditorialLockupMedium:case Kv.EditorialLockupMediumVariant:return"editorialLockupMedium"
case Kv.EditorialLockupLarge:case Kv.EditorialLockupLargeVariant:return"editorialLockupLarge"
case Kv.LockupSmall:return iN
case Kv.LockupLarge:return"lockupLarge"
case Kv.StorySmall:return"storySmall"
case Kv.StoryMedium:return"storyMedium"
case Kv.BreakoutLarge:return K$
default:return cH}}function Ih(e,t,n){let r=null,s=null,a=[]
const c=pn(0,t)
switch(t.type){case OH:case vV:case zN:a=["enrichedEditorialNotes.badge",QB,CV],r=Dh(e,t,a,!1),s=Dh(e,c,a,!1)
break
case BH:case kV:case IH:a=[QB],r=Dh(e,t,a,!0),s=Dh(e,c,a,!0)}const l=i(s)?s:r
return o(l)?null:l}function Ch(e,t,n){let r=null,s=[]
switch(n){case H$:case V$:switch(t.type){case OH:case vV:case zN:s=[nT,xG],r=Eh(t,s)
break
case BH:case kV:case IH:s=[LG],r=Dh(e,t,s,!0)}break
default:switch(t.type){case OH:case vV:case zN:s=[nT,xG],r=Dh(e,t,s,!1)
break
case tj:case BH:case kV:case IH:s=[GH],r=Dh(e,t,s,!1)}}const a=Dh(e,pn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function kh(e,t,n=!1){let r=null,s=[]
switch(t.type){case OH:n?s=[rT,LG]:ae(t,wO)||(s=["enrichedEditorialNotes.short",gO]),r=Dh(e,t,s,!1)
break
case vV:case zN:s=[rT,LG],r=Dh(e,t,s,!1)
break
case BH:case kV:case IH:s=[LG],r=Dh(e,t,s,!0)}const a=Dh(e,pn(0,t),s,!1),c=i(a)?a:r
return o(c)?null:c}function Oh(e,t){let n=null,r=[]
switch(t.type){case OH:case vV:case zN:r=[oT,bM],n=Dh(e,t,r,!1)
break
case BH:case kV:case IH:r=[oT,bM],n=Dh(e,t,r,!0)}const o=Dh(e,pn(0,t),r,!1)
let i=null
return i=(null==o?void 0:o.length)>0?o:s(n)?n:e.loc.string(vO),i}function Eh(e,t){return o(e)?null:ie(e,t)}function Rh(e,t,n){return o(e)?null:_e(e,t,n)}function Dh(e,t,n,r){if(o(t))return null
const i=qe(e,t)
for(const e of n){const n=r?Rh(t,i,e):Eh(t,e)
if(s(n))return n}return null}function _h(e,t,n){const r={}
Of(0,n.metricsOptions,mO)
const a=mu(e,t,n)
Ef(n.metricsOptions.locationTracker)
const c=yu(e,t,n)
return s(a)&&(a.length>1||o(c))?r.collectionIcons=a:i(c)&&(r.lockup=c,r.collectionIcons=[c.icon]),r}function xh(e,t,n,a,c){if(o(t))return null
let l
n.showOrdinals&&(l=e.loc.decimal(n.ordinalIndex))
let u,d=null
!i(n.shelfBackground)||n.shelfBackground.type!==ej&&n.shelfBackground.type!==B_||(d=BV),s(n)&&(u=n.clientIdentifierOverride)
const f={ordinal:l,metricsOptions:{...{...n.metricsImpressionOptions,id:t.id,idType:ZV},recoMetricsData:W(t),isAdvert:An(0,t),targetType:Ph(0,c)},clientIdentifierOverride:u,artworkUseCase:0,offerStyle:d,canDisplayArcadeOfferButton:sf(0,c),isContainedInPreorderExclusiveShelf:n.filterOverrides.includes(Xv.ShowOnlyPreorder)}
let p
switch(c){case H$:case nN:case V$:case tN:f.offerEnvironment=UV,p=$u(e,t,f,c)
break
case"Poster":p=Lu(e,t,f)
break
default:p=Du(e,t,f)}return r(p)||!p.isValid()?null:(p.id=function(e,t,n){return(0,Cv.isNothing)(n)?null:`${e.id}_${t}_${n}`}(n,a,p.adamId),p)}function Lh(e,t){return Nh(e,t,Kv.EditorialLockupHierarchicalPortrait,QN,!0,Qv.Vertical)}function Mh(e,t){return Nh(e,t,Kv.EditorialLockupLarge,IM)}function $h(e,t,n=!0,r){return e.featureFlags.isEnabled("force_display_lockup_ordinals")&&(t.showOrdinals=!0),Nh(e,t,Kv.LockupSmall,eH,n,r)}function Fh(e,t,n=!0){return Nh(e,t,Kv.LockupLarge,KF,n)}function Nh(e,t,n,o,i=!0,s){const a=[],c=new oJ(o),l=null!=s?s:un(t)
c.isHorizontal=l===Qv.Horizontal
const u=dn(0,t),d=void 0
for(const[o,i]of u.entries()){if(i.type===DH)return null
if(r(i.attributes)||jh(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}if(vt(e,i,80894))continue
let o=null
if(o=xh(e,i,t,a.length,n),o&&(a.push(o),xf(t.metricsImpressionOptions.locationTracker),t.ordinalIndex++,a.length===d))break}if(n!==Kv.EditorialLockupMediumVariant&&n!==Kv.EditorialLockupLargeVariant||(r(c.presentationHints)?c.presentationHints={showSupplementaryText:!0}:c.presentationHints={...c.presentationHints,showSupplementaryText:!0}),delete t.maxItemCount,c.eyebrow=t.eyebrow,c.eyebrowArtwork=t.eyebrowArtwork,c.title=t.title,c.subtitle=t.subtitle,c.items=a,c.rowsPerColumn=ce(t.data,nF),c.shouldFilterApps=!t.filterOverrides.includes(Xv.ShowInstalled),c.url=Vh(0,0,t),i){let n=d;(0,kv.isSome)(d),ua(e,c,t,n)}return c}function Bh(e,t,n,r){const o=new D1
o.overlayType=Wa(e,t),o.displayOptions={horizontalPlacement:EH,textAlignment:EH,isOverDarkContent:Ja(e,t)},o.badgeText=Ih(e,t,Kv.Hero),o.titleText=Ch(e,t,Kv.Hero),r.suppressTagline||(o.descriptionText=kh(e,t,!0)),o.callToActionText=Oh(e,t),o.buttonTitle=Ya(e,t)
const a={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:iN,recoMetricsData:W(t)},metricsClickOptions:{id:t.id,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,actionDetails:{franchise:o.badgeText}},artworkUseCase:1,offerEnvironment:mH,canDisplayArcadeOfferButton:sf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:It(0,t)},c=yu(e,t,a),l=_h(e,t,a)
o.lockup=l.lockup,o.collectionIcons=l.collectionIcons
const u=ie(t,CV)
s(u)&&i(c)&&(c.heading=u)
const d=(0,Cv.isSome)(r.suppressLockup)&&r.suppressLockup
if(s(o.lockup)&&!d)o.clickAction=o.lockup.clickAction,o.impressionMetrics=o.lockup.impressionMetrics
else{const r={targetType:OB,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t)},i={...r,id:t.id,actionDetails:{franchise:o.badgeText}}
o.clickAction=qu(e,t,i,n.clientIdentifierOverride),Bf(e,o,Hf(e,t,o.titleText,r))}return o}function Uh(e,t,n,r,o){n||(t.backgroundColor=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor,t.artwork=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork,t.video=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video),t.isMediaDark=hu(0,r,o)}function Gh(e,t,n){let a=null
switch(n.isFirstRender&&kf(0,n.metricsImpressionOptions,n.title),n.type){case Jv.ArcadeSeeAllGames:a=function(e,t){const n=new Lq,o=new oJ(hO)
o.items=[n]
const i={targetType:sT,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(a_),id:t.id,kind:aT,softwareType:HV}
Bf(e,n,i),kf(0,i,i.title),n.buttonAction=up(e,NN,t.metricsPageInformation,t.metricsLocationTracker)
const a={targetType:NH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:n.buttonAction.title,id:"SeeAllGames",kind:NH,softwareType:HV}
Bf(e,n.buttonAction,a),Ef(i.locationTracker)
const c=e.bag.termsAndConditionsURL
if(!r(c)&&"tv"!==e.client.deviceType){const t=e.loc.string(TO),r=new MW(c),o=new bY(t)
o.clickAction=r,o.presentationStyle=[G_,j_,V_],n.footnote=o}o.background={type:ej,color:Z(Hk)}
const l=dn(0,t)
if(s(l)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
n.icons=od(e,l,r,{useCase:2})}else n.icons=[]
return o}(e,n)
break
case Jv.Collection:a=function(e,t){let n=ie(t.data,tV)
if(o(n))return null
let a=null
switch(n){case Kv.Hero:a=function(e,t){if(0!==t.shelfIndex)return null
const n=new oJ(BU),r=new x1
r.autoScrollConfiguration=Yh(e)
const o=dn(0,t)
for(const n of o){const o=gn(e,n)
if(vn(0,n)&&!le(o)||jh(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i={...t.metricsImpressionOptions,idType:GG,targetType:OB,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(n)},s=cu(e,n,ym.Hero),a=_h(e,n,{metricsOptions:i,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:0,offerEnvironment:ZN,canDisplayArcadeOfferButton:!0}),c=new _1,l=Ga(0,n),d=Ch(e,n,Kv.Hero),f=Hf(e,n,d,i)
f.isPreorder=Ve(e,l,VV),Bf(e,c,f),kf(0,f,d)
const p=hn(0,n),h=u(p.hideEditorialMedia)
c.overlay=Bh(e,n,t,p),c.collectionIcons=a.collectionIcons,c.editorialDisplayOptions=wn(p),zh(0,c,h,s,!1),c.isValid()&&r.items.push(c)
const w=b(c)
zh(0,w,h,s,!0),w.isValid()&&r.rtlItems.push(w),Ef(f.locationTracker),xf(f.locationTracker)}return delete t.maxItemCount,n.isHorizontal=!1,n.eyebrow=t.eyebrow,n.eyebrowArtwork=t.eyebrowArtwork,n.title=t.title,n.subtitle=t.subtitle,n.items=[r],n.url=Vh(0,0,t),n}(e,t)
break
case Kv.TextOnly:a=function(e,t){var n
const o=[],i=new oJ(EV)
i.isHorizontal=ie(t.data,eF)===Qv.Horizontal
const s=dn(0,t)
for(const n of s){if(r(n.attributes)||jh(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Sh(e,n,t)
i.title=Ch(e,n,t.collectionDisplayStyle)
const s={...t.metricsImpressionOptions,id:n.id,idType:XN,targetType:F_}
Bf(e,i,Hf(e,n,i.title,s)),i.isValid()&&(o.push(i),xf(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=ce(t.data,nF))&&void 0!==n?n:1,i.url=Vh(0,0,t),ua(e,i,t),i}(e,t)
break
case Kv.TextWithArtwork:a=function(e,t){var n
const o=[],i=new oJ(EV)
i.isHorizontal=ie(t.data,eF)===Qv.Horizontal
const a=dn(0,t)
for(const n of a){if(r(n.attributes)||jh(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const i=Sh(e,n,t)
let a
i.title=Ch(e,n,t.collectionDisplayStyle),a=ne(n,_H),s(a)&&(i.artwork=nd(e,a,{allowingTransparency:!0,useCase:20})),i.isValid()&&(o.push(i),xf(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,i.eyebrow=t.eyebrow,i.eyebrowArtwork=t.eyebrowArtwork,i.title=t.title,i.subtitle=t.subtitle,i.items=o,i.rowsPerColumn=null!==(n=ce(t.data,nF))&&void 0!==n?n:1,i.url=Vh(0,0,t),ua(e,i,t),i}(e,t)
break
case Kv.BrickSmall:a=function(e,t){return qh(e,t,Kv.BrickSmall,W_)}(e,t)
break
case Kv.BrickMedium:a=function(e,t){return qh(e,t,Kv.BrickMedium,KB)}(e,t)
break
case Kv.BrickLarge:a=function(e,t){return qh(e,t,Kv.BrickLarge,lT)}(e,t)
break
case Kv.EditorialLockupHierarchicalPortrait:a=Lh(e,t)
break
case Kv.EditorialLockupHierarchicalRows:a=function(e,t){return Nh(e,t,Kv.EditorialLockupHierarchicalRows,QN,!0,Qv.Vertical)}(e,t)
break
case Kv.EditorialLockupMedium:a=function(e,t){return Nh(e,t,Kv.EditorialLockupMedium,QN)}(e,t)
break
case Kv.EditorialLockupMediumVariant:a=function(e,t){return Nh(e,t,Kv.EditorialLockupMediumVariant,QN)}(e,t)
break
case Kv.EditorialLockupLarge:a=Mh(e,t)
break
case Kv.EditorialLockupLargeVariant:a=function(e,t){return Nh(e,t,Kv.EditorialLockupLargeVariant,IM)}(e,t)
break
case Kv.LockupMedium:a=function(e,t){return t.metricsImpressionOptions.shouldOmitImpressionIndex=!0,Nh(e,t,Kv.LockupMedium,LV)}(e,t)
break
case Kv.Poster:a=function(e,t){const n=Nh(e,t,Kv.Poster,sN)
return(0,kv.isSome)(n)&&(n.horizontalScrollTargetBehavior=Bv.CenterAligned),n}(e,t)
break
case Kv.StorySmall:a=function(e,t){return Kh(e,t,Kv.StorySmall,sj)}(e,t)
break
case Kv.StoryMedium:a=function(e,t){return Kh(e,t,Kv.StoryMedium,rF)}(e,t)
break
case Kv.LockupSmall:a=$h(e,t)
break
case Kv.LockupLarge:a=Fh(e,t)
break
case Kv.BreakoutLarge:a=function(e,t){const n=[],r=new oJ(AM)
r.isHorizontal=ie(t.data,eF)===KN
const s=dn(0,t)
for(const r of s){const s=gn(e,r)
if(vn(0,r)&&!le(s)||jh(t)){t.isDeferring=!0,t.remainingItems.push(r)
continue}const a={targetType:K$,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(r)},c=hn(0,r),l=u(c.hideEditorialMedia)?null:vu(e,r,t.collectionDisplayStyle),d=_h(e,r,{metricsOptions:a,clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:0,offerEnvironment:ZN,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:It(0,r)})
if(o(l)&&o(d.collectionIcons))continue
const f=Ih(e,r,t.collectionDisplayStyle),p=i(f)?{type:Dj,title:f}:{type:qV,title:null},h=new ZY(Ch(e,r,t.collectionDisplayStyle),kh(e,r,!0),p,null),w=new QY(h,{position:EH,wantsBlur:!0},null,null==l?void 0:l.artwork,null==l?void 0:l.video,d.collectionIcons,null==l?void 0:l.backgroundColor)
w.rtlArtwork=null==l?void 0:l.rtlArtwork,w.rtlVideo=null==l?void 0:l.rtlVideo,w.rtlBackgroundColor=null==l?void 0:l.rtlBackgroundColor
const g={...a,id:r.id,idType:GG}
Bf(e,w,Hf(e,r,w.details.title,g))
const v=Sh(e,r,t)
i(v)&&(v.title=Oh(e,r)),w.details.callToActionButtonAction=v,w.clickAction=v,w.editorialDisplayOptions=wn(c),w.lockup=d.lockup,w.isMediaDark=hu(0,l),w.isRTLMediaDark=hu(0,l,!0),n.push(w)}return delete t.maxItemCount,r.eyebrow=t.eyebrow,r.eyebrowArtwork=t.eyebrowArtwork,r.title=t.title,r.subtitle=t.subtitle,r.items=n,r.rowsPerColumn=ce(t.data,nF),r.url=Vh(0,0,t),ua(e,r,t),r}(e,t)}return s(a)&&(a.seeAllAction=Hh(e,a,t),a.id=`shelf_${t.id}`),a}(e,n)
break
case Jv.Chart:a=function(e,t){let n
if(t.showOrdinals=!0,n=$h(e,t,!1,Qv.Horizontal),!(0,kv.isNothing)(n))return n.url=Vh(0,0,t),ua(e,n,t),function(e,t,n){e.featureFlags.isEnabled(HF)?(0,kv.isSome)(t.header)?function(e,t,n){e.featureFlags.isEnabled(HF)?t.titleAction=n:t.accessoryAction=n}(e,t.header,n):t.header={titleAction:n}:t.seeAllAction=n}(e,n,function(e,t){const n=ie(t.data,Xj),r=ie(t.data,$V),o=new dY(jH)
return o.pageUrl=Bd(e,n,r),o.title=e.loc.string(Oj),o.referrerUrl=t.metricsPageInformation.pageUrl,ap(e,o,o.pageUrl,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}),o}(e,t)),n}(e,n)
break
case Jv.Tag:case Jv.Engagement:case Jv.Text:case Jv.Image:case Jv.VideoClip:a=null
break
case Jv.Header:a=function(e,t,n){var r,o,i
const a=s(ne(n.data,rj))?n.data:t
if(!a)return null
if(s(ne(a,lH))){const t=new x1,r=new _1,o=hn(0,a),i=Bh(e,a,n,o)
i.overlayType=Dj,i.callToActionText=null,r.clickAction=null,i.collectionIcons=null,i.lockup=null,i.callToActionText=null,r.overlay=i
const s={artworkUseCase:1,offerStyle:QU,offerEnvironment:mH,canDisplayArcadeOfferButton:sf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(a)},externalDeepLinkUrl:It(0,a)}
Of(0,s.metricsOptions,mO)
const c=mu(e,a,s)
Ef(s.metricsOptions.locationTracker),r.collectionIcons=c
const l=cu(e,a,ym.Hero),d=u(o.hideEditorialMedia)
Uh(0,r,d,l,!1),r.editorialDisplayOptions=wn(o),t.items=[r]
const f=b(r)
Uh(0,f,d,l,!0),t.rtlItems=[f]
const p=new oJ(BU)
return p.items=[t],p}{const t=(0,Yv.attributeAsString)(a,GH)
if(s(t)&&xr(e,null)){const s=new oJ(TM)
s.id=TM
const c=null!==(r=(0,Yv.attributeAsString)(a,QB))&&void 0!==r?r:null,l={artworkUseCase:1,offerStyle:QU,offerEnvironment:mH,canDisplayArcadeOfferButton:sf(0,n.collectionDisplayStyle),isContainedInPreorderExclusiveShelf:!1,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(a)},externalDeepLinkUrl:It(0,a),useJoeColorIconPlaceholder:!0,joeColorPlaceholderSelectionLogic:ff}
let u,d=null!==(o=mu(e,n.data,l))&&void 0!==o?o:void 0
if((0,Cv.isSome)(d)&&(null==d?void 0:d.length)>=3){d=d.slice(0,3)
const r=d[0].backgroundColor;(0,Cv.isSome)(r)&&(null==r?void 0:r.type)===hj&&(u=lf(r))
const o=K(u),l=hn(0,n.data),f=new Wq(c,t,null,void 0,void 0,d,!1,null!=u?u:void 0,function(e,t){if(2===t)return H_
switch(e){case yU:return PM
case bO:return"Fan"
case cT:return q_
default:return PM}}(null!==(i=l.fallbackDisplayStyleHint)&&void 0!==i?i:yU,null==d?void 0:d.length),o?mH:UV),p=function(e,t,n,r){return Iv.context(hE,()=>{const o=gf(e,t),i=wf(e,t)
return{...r,kind:o,softwareType:i,title:n,id:t.id,idType:GG,targetType:"tagHeader"}})}(e,a,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(a)})
return function(e,t,n){if(!t)return
const r=new RW(Nf(e,n))
delete r.fields.impressionIndex,t.impressionMetrics=r}(e,f,p),s.items=[f],s}return null}return null}}(e,t,n)
break
case Jv.Recommendations:a=function(e,t){let n=null
switch(ie(t.data,tV)){case Kv.LockupSmall:n=$h(e,t,!1)
break
case Kv.LockupLarge:n=Fh(e,t,!1)
break
case Kv.EditorialLockupHierarchicalPortrait:n=Lh(e,t)
break
case Kv.EditorialLockupLarge:n=Mh(e,t)
break
default:n=t.isFirstRender?function(){const e=new oJ(tF)
return e.isHidden=!0,e}():null}return(0,kv.isNothing)(n)?null:(n.id=`shelf_${t.id}`,function(e,t){const n=s(Ae(t.data,FH))||s(t.remainingItems),r=ae(t.data,"isPersonalizationAvailable"),o=t.data.href
if(!r||n||!s(o))return
const i=at(e,new wJ(e,t.data.href).addingQuery(Hz.editorialPageId,t.pageId).includingRelationships([FH]))
t.recommendationsHref=i.toString()}(e,t),n.url=Vh(0,0,t),ua(e,n,t),n.seeAllAction=Hh(e,n,t),n)}(e,n)
break
case Jv.GameCenter:a=null
break
case Jv.Upsell:a=function(e,t){const n=mp(e,t.data)
if(o(n))return null
const r=n.marketingItemData
if(o(r)||o(r.attributes))return null
const i=Da(e,r,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,mercuryMetricsData:Sf(0,r)})
xf(t.metricsLocationTracker)
const s=new oJ(VB)
return s.items=[i],s}(e,n)
break
case Jv.Marker:a=function(e,t){const n=ie(t.data,rV)
if(o(n))return null
let r=null
return n===Zv.QuickLinks&&(r=function(e,t){if(e.user&&e.user.isManagedAppleID)return null
{const n=[]
if((0,Cv.isSome)(e.bag.aboutAppStoreUrl)){const t=new MW(e.bag.aboutAppStoreUrl)
t.title=e.loc.string("QuickLinks.AboutTheAppStore.Title"),n.push(t)}if((0,Cv.isSome)(e.bag.aboutInAppPurchasesEditorialItemId)){const t=new dY(XV)
t.title=e.loc.string("QuickLinks.AboutInAppPurchases.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutInAppPurchasesEditorialItemId}`,n.push(t)}if((0,Cv.isSome)(e.bag.reportProblemUrl)){const t=new MW(e.bag.reportProblemUrl)
t.title=e.loc.string(dT,"Report a Problem"),n.push(t)}if((0,Cv.isSome)(e.bag.requestARefundUrl)){const t=new MW(e.bag.requestARefundUrl)
t.title=e.loc.string("QuickLinks.RequestARefund.Title"),n.push(t)}if((0,Cv.isSome)(e.bag.changePaymentMethodUrl)){const t=new MW(e.bag.changePaymentMethodUrl)
t.title=e.loc.string("QuickLinks.ChangePaymentMethod.Title"),n.push(t)}if((0,Cv.isSome)(e.bag.aboutFrenchAppStoreEditorialItemId)){const t=new dY(XV)
t.title=e.loc.string("QuickLinks.AboutFrenchAppStore.Title"),t.pageUrl=`https://apps.apple.com/story/id${e.bag.aboutFrenchAppStoreEditorialItemId}`,n.push(t)}const r=new oJ(EV)
return r.title=e.loc.string("QuickLinks.Title"),r.items=n,r.isHorizontal=!0,r.rowsPerColumn=1,t.metricsImpressionOptions.title=r.title,r}}(e,t)),r}(e,n)}return o(null==a?void 0:a.items)&&o(null==a?void 0:a.url)&&(a=null),n.isFirstRender&&Ef(n.metricsImpressionOptions.locationTracker),Bf(e,a,n.metricsImpressionOptions),n.isFirstRender&&xf(n.metricsImpressionOptions.locationTracker),(0,Cv.isSome)(a)&&function(e,t,n){if((0,kv.isNothing)(t.url)||(0,kv.isNothing)(t.impressionMetrics)||!n.showingPlaceholders)return
const o=t.url
try{const e=oY.from(o).query[Hz.token],n=JSON.parse(decodeURIComponent(e))
n.originalPlaceholderShelfImpressionMetrics=t.impressionMetrics,function(e,t,n){const o=oY.from(t.url),i=oY.from(Vh(0,0,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,t,n)}catch{t.url=o}}(0,a,n),a}function jh(e){return e&&e.isDeferring&&e.isFirstRender}function Vh(e,t,n){return o(n)?null:(n.remainingItems.length||n.recommendationsHref||n.onDeviceRecommendationsUseCase)&&n.isFirstRender?function(e){return(new oY).set(hG,Oz).append(jG,_z.editorialPage).append(jG,_z.shelf).param(Hz.token,encodeURIComponent(JSON.stringify(e))).build()}(n):null}function Hh(e,t,n){if(o(n)||o(t))return null
if(function(e){if(e.isSeeAll)return!1
switch(e.collectionDisplayStyle){case Kv.BreakoutLarge:case Kv.Poster:return!1}return!e.filterOverrides.includes(Xv.ShowOnlyPreorder)||!1}(n)){const r=new dY(jH)
if(!pa(t)){const o=`shelf_${n.id}`
r.pageData=function(e,t,n,r,o){const i=Gh(e,void 0,(mn(0,t.data),Qh(e,t.pageId,t.data,t.isArcadePage,t.shelfIndex,t.metricsPageInformation,{rootPosition:0,locationStack:[]},!0,null)))
if(null===i)return null
let s
i.title=null,i.eyebrow=null,i.isHorizontal=!1,i.id=r,s=new qq(null,t.title,null)
const a=new oJ(U_)
a.id=yO,a.items=[s]
const c=new lJ([a,i])
return c.isIncomplete=!(null!=o&&o),(0,kv.isNothing)(c.pageMetrics.pageFields)&&(c.pageMetrics.pageFields={}),c}(e,n,t.contentType,o,(0,kv.isSome)(n.recommendationsHref))}const o={}
n.type===Jv.Recommendations&&(o[Hz.editorialPageId]=n.pageId),r.pageUrl=Er(e,n.data.href,o),r.title=e.loc.string(Oj),r.referrerUrl=n.metricsPageInformation.pageUrl
const i=function(e){const t=[]
for(const n of e.locationStack)t.push({...n})
return{rootPosition:e.rootPosition,locationStack:t}}(n.metricsLocationTracker)
return _f(i,0),ap(e,r,n.seeAllUrl,{pageInformation:n.metricsPageInformation,locationTracker:i}),r}return null}function qh(e,t,n,r){const o=[],s=new oJ(r)
s.isHorizontal=ie(t.data,eF)===KN
const a=dn(0,t)
for(const r of a){const i={...t.metricsImpressionOptions,targetType:Ph(0,n),recoMetricsData:W(r)}
if(r.attributes&&!jh(t)){{const n=Wh(e,r,t.collectionDisplayStyle,i,i,t.clientIdentifierOverride)
if(n.clickAction=Sh(e,r,t),!n.isValid())continue
o.push(n)}xf(t.metricsImpressionOptions.locationTracker)}else t.remainingItems.push(r),t.isDeferring=!0}return i(t.presentationHints)&&(s.presentationHints=t.presentationHints),delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=o,s.rowsPerColumn=ce(t.data,nF),s.url=Vh(0,0,t),ua(e,s,t),s}function Wh(e,t,n,r,i,a){const c=new FY,l=hn(0,t)
if(!u(l.hideEditorialMedia)){const r=vu(e,t,n);(0,Cv.isSome)(null==r?void 0:r.artwork)&&(c.artworks=[r.artwork],c.isMediaDark=hu(0,r)),(0,Cv.isSome)(null==r?void 0:r.rtlArtwork)&&(c.rtlArtwork=null==r?void 0:r.rtlArtwork,c.isRTLMediaDark=hu(0,r,!0))}const d={metricsOptions:i,clientIdentifierOverride:a,artworkUseCase:0,canDisplayArcadeOfferButton:!0,externalDeepLinkUrl:It(0,t)}
if(Of(0,d.metricsOptions,mO),c.collectionIcons=mu(e,t,d),Ef(d.metricsOptions.locationTracker),o(c.collectionIcons)){const n=sd(e,t,{useCase:0})
s(n)&&(c.collectionIcons=[n])}c.caption=Ih(e,t),c.title=Ch(e,t,n),c.subtitle=kh(e,t),c.accessibilityLabel=c.title,c.editorialDisplayOptions=wn(l)
const f=s(c.artworks)?GG:"collection_id",p={...r,id:t.id,idType:f}
return Bf(e,c,Hf(e,t,c.title,p)),c.artworkSafeArea=Yq.defaultTileArtworkSafeArea,c.textSafeArea=Yq.defaultTileTextSafeArea,c}function zh(e,t,n,r,o){if(!n){const e=o?null==r?void 0:r.rtlBackgroundColor:null==r?void 0:r.backgroundColor
t.backgroundColor=e
const n=o?null==r?void 0:r.rtlArtworkData:null==r?void 0:r.artworkData
t.titleEffect=Ea(0,n)
const i=o?null==r?void 0:r.rtlArtwork:null==r?void 0:r.artwork
t.artwork=i
const s=o?null==r?void 0:r.rtlVideo:null==r?void 0:r.video
t.video=s}t.isMediaDark=hu(0,r,o)}function Yh(e){return{isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}}function Jh(e,t,n,r,o,a,c){var l,d
const f=hn(0,t),p=new iJ
if(p.title=Ch(e,t,o),f.suppressShort||(p.description=kh(e,t)),!u(f.hideEditorialMedia)){const r=cu(e,t,n)
if(p.artwork=null==r?void 0:r.artwork,p.video=null==r?void 0:r.video,p.isMediaDark=null!==(l=hu(0,r))&&void 0!==l?l:void 0,n===ym.StoryDetail){const n=cu(e,t,ym.StoryDetailLandscape)
p.landscapeArtwork=null==n?void 0:n.artwork,p.landscapeVideo=null==n?void 0:n.video,p.isLandscapeMediaDark=null!==(d=hu(0,n))&&void 0!==d?d:void 0}}const h=_h(e,t,{metricsOptions:{pageInformation:r.pageInformation,locationTracker:r.locationTracker,recoMetricsData:W(t)},artworkUseCase:1,offerEnvironment:f.useMaterialBlur?UV:ZN,canDisplayArcadeOfferButton:sf(0,o),isContainedInPreorderExclusiveShelf:!1,externalDeepLinkUrl:It(0,t),useJoeColorIconPlaceholder:!1}),w=a&&u(f.suppressLockup)
w||(p.lockup=h.lockup)
const g=fn(e,t)
if(ae(g,VV),Jd(e,g),s(g)&&!w&&vt(e,g,80894)&&n!==ym.StoryDetail)return null
let v
if(v=Ih(e,t),p.badge={type:Dj,title:v},p.collectionIcons=h.collectionIcons,i(c)){const n={id:t.id,pageInformation:c.metricsPageInformation,locationTracker:c.metricsLocationTracker,actionDetails:{franchise:p.badge.title},idType:XN}
p.clickAction=Sh(e,t,c,n)}p.editorialDisplayOptions=wn(f)
const m={...r,id:t.id,idType:XN}
return Bf(e,p,Hf(e,t,p.title,m)),p.isValid()?p:null}function Kh(e,t,n,o){const i=[],s=new oJ(o),a=un(t)
s.isHorizontal=a===KN
const c=dn(0,t)
for(const o of c){const s={...t.metricsImpressionOptions,targetType:Ph(0,n),recoMetricsData:W(o)}
if(!le(o)||jh(t)){t.remainingItems.push(o),t.isDeferring=!0
continue}let a=null
a=Jh(e,o,ym.StoryCard,s,t.collectionDisplayStyle,!0,t),r(a)||(i.push(a),xf(t.metricsImpressionOptions.locationTracker))}return delete t.maxItemCount,s.eyebrow=t.eyebrow,s.eyebrowArtwork=t.eyebrowArtwork,s.title=t.title,s.subtitle=t.subtitle,s.items=i,s.rowsPerColumn=ce(t.data,nF),s.url=Vh(0,0,t),ua(e,s,t),s}function Zh(e,t,n){const r=mn(0,t)
o(r)||(n.displayStyle=r)}function Qh(e,t,n,r,o,i,s,a=!1,c=null){const l={id:f(n,"id"),type:n.type,collectionDisplayStyle:null!=c?c:mn(0,n),filterOverrides:oe(n,"filterOverrides"),pageId:t,data:n,presentationHints:{},clientIdentifierOverride:null,isFirstRender:!0,shouldFilter:!0,gamesFilter:ew(n),hasExistingContent:!1,title:null,subtitle:null,eyebrow:null,titleArtwork:null,remainingItems:[],metricsImpressionOptions:null,metricsPageInformation:i,metricsLocationTracker:s,recoMetricsData:jr(e,n),isDeferring:!1,showOrdinals:!1,ordinalIndex:1,isSearchLandingPage:!1,isArcadePage:r,shelfIndex:o,isSeeAll:a}
return Xh(e,n,l),l}function Xh(e,t,n){let r=ie(t,xG),o=ie(t,LG),i=ie(t,QB),a=null,c=!1
const l=ye(e,t,JN)
s(l)&&(i=e.loc.uppercased(ie(t,xG)),r=ie(l,xG),a=sd(e,l,{useCase:1}),o=null,c=!0)
const u=function(e,t,n,r,o){const i=t.type,s=mn(0,t),a={id:f(t,"id"),kind:null,softwareType:null,targetType:jV,title:n,pageInformation:r,locationTracker:o,idType:iT,shelfType:i,recoMetricsData:W(t),canonicalId:f(t.meta,X$)}
switch(i){case Jv.Collection:Zh(0,t,a),s===Kv.Hero&&function(e,t){t.title=BU
const n=Yh(e)
t.autoAdvanceInterval=n.autoScrollInterval}(e,a)
break
case Jv.Recommendations:Zh(0,t,a)}return a}(e,t,c?i:r,n.metricsPageInformation,n.metricsLocationTracker)
n.title=r,n.subtitle=o,n.eyebrow=i,n.titleArtwork=a,n.metricsImpressionOptions=u}function ew(e){let t=null
switch(ie(e,"clientFilter")){case em.ArcadeGames:t=xH
break
case em.AllGames:t="all"}return t}function tw(e,t){const n={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},r=mp(e,t.data)
return o(r)?null:Bu(e,r,n,pe(CN),rG,AO)}function nw(e,t){const n=[lH,oH,NU],r=[...n,ZB,nj,eN,yM],o=[...n,eN],i=[...n,eV,SG,tG,nj,Nj,eV,Kj]
e.appleSilicon.isSupportEnabled&&i.push(iV)
const s=[...i]
t.includingAgeRestrictions().includingAdditionalPlatforms(N(e)).enablingFeatures(["personalization","supportsCustomTextColor"]).includingRelationshipsForUpsell(!0).includingScopedAttributes(OH,r).includingScopedAttributes(vV,o).includingScopedAttributes(BH,s)}function rw(e){const{platform:t,...n}=e
return{...n,$kind:z6,platform:Tt(t)}}function ow(e,t,n){var r
const o=function(e,t){switch(t){case X6:return"badge_hardware"
case e3:return"badge_trial_eligible"
default:return null}}(0,t),i={offerHints:o},s=new KJ(xH,pe(WU),e.bag.metricsTopic,null,i)
s.metricsOverlay={...s.metricsOverlay,...n}
const a=null===(r=e.metricsIdentifiersCache)||void 0===r?void 0:r.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical])
if((0,kv.isSome)(a)&&(s.metricsOverlay={...s.metricsOverlay,...a}),e.bag.arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled&&Rt(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new dY(WF),t=kF
e.pageData=t,e.presentationContext=TG,s.purchaseSuccessAction=e}const c=new dY(XU)
return c.pageData=s,c}async function iw(e,t){const n=t.eventString,r=t.featuresDictionary
if(!i(r))return await Promise.reject("Received non-defined engagement features.")
const o=function(e,t,n,r){switch(t){case"arcadeTabDidComeOnScreen":case"arcadePageDidAppear":return function(e,t,n){const r=[]
for(const e of t3)if(e in t){const t=new mz(e,!1)
r.push(t)}for(const o of t3){if(n.includes(o)&&!e.bag.unrestrictedServerSideTabBadging)continue
const s=t[o]
if(i(s)){const t=ow(e,o,s)
r.push(t)
break}}if(r.length>0)return new XJ(new $W(r))
{const e=new lz
return new XJ(e)}}(e,n,r)
case"didBecomeArcadeTrialEligible":if(!e.bag.enableArcadeTrialEligibleBadging)return e.console.log(`Bag prohibits badging for identifier ${e3}`),new XJ(new lz)
if(r.includes(e3))return e.console.log(`Badging identifier ${e3} was previously invalidated.`),new XJ(new lz)
const t=new mz(e3,!0),o=new LW(xH,e.loc.decimal(1)),s=new $W([t,o])
return new XJ(s)
case"didSubscribeToArcade":return function(e){const t=[]
for(const e of t3){const n=new mz(e,!1)
t.push(n)}const n=new $W(t)
return new XJ(n)}()
case"didBecomeSubscribed":if(!i(n[e3]))return new XJ(new lz)
const a=new mz(e3,!1)
return new XJ(a)
case"didBecomeNonSubscribed":return new XJ(new lz)
default:return null}}(e,n,r,i(t.previouslyDisabledFeatures)?t.previouslyDisabledFeatures:[])
return i(o)?await Promise.resolve(o):await Promise.reject("Did not receive a valid engagement event.")}async function sw(e,t){var n
const r=function(e,t,n,r){if(!t3.includes(t))return null
let o=null
if(n&&e.bag.unrestrictedServerSideTabBadging){const t=e.loc.decimal(1)
o=new LW(xH,t)}else if(n&&!r.includes(t)){const t=e.loc.decimal(1)
o=new LW(xH,t)}else n||(o=new LW(xH,null))
return new XJ(o)}(e,t.identifier,t.isEnabled,null!==(n=t.previouslyDisabledFeatures)&&void 0!==n?n:[])
return i(r)?await Promise.resolve(r):await Promise.reject(new Error(`fetchBadgingTask called with unsupported identifier: ${t.identifier}, featuresDictionary: ${JSON.stringify(t.featuresDictionary)}, previouslyDisabledFeatures: ${t.previouslyDisabledFeatures}`))}async function aw(e,t){return await e.required(G4).fetchPage(e,t,uJ)}async function cw(e,t){const n=new wJ(e).withIdOfType(t,px),r=Jn(e,n)
return await r.then(t=>function(e,t){return Iv.context("msoProviderDataFromData",()=>{const n=j(e,t),r=ie(n,GH),o=ie(n,AH),i=function(e,t){return Iv.context("msoProviderArtworkFromData",()=>{const n=ne(t,"editorialArtwork.storeFlowcase")
if(n)return nd(e,n,{useCase:3})
const r=ne(t,_H)
return nd(e,r,{useCase:3})})}(e,n)
i&&(i.crop="sr")
const s=function(e,t){const n=ne(t,D_)
return n?nd(e,n,{useCase:21}):null}(e,n)
return new u3(r,o,i,s)})}(e,t))}async function lw(e,t){if(r(t.providerAdamId)||r(t.subscribedChannelIds))return await e.required(G4).fetchPage(e,t.url,lJ)
{const n=uw(e,t.providerAdamId),r=Jn(e,n)
return await r.then(n=>{const r=function(e,t){return Iv.context("msoAppsFromResponse",()=>{const n=j(e,t),r=Ae(n,mD),o={}
for(const t of r)o[ye(e,t,SH).id]=oe(t,"channelNames")
const i=Ae(n,BH).map(e=>e.id)
return new d3(o,i)})}(e,n),o=function(e,t){const n=e.appsToAlwaysShow
for(const r of Object.keys(e.apps)){const o=e.apps[r]
for(const e of o)if(-1!==t.indexOf(e)){n.push(r)
break}}return n}(r,t.subscribedChannelIds)
return dw(e,n,o)})}}function uw(e,t){return new wJ(e).withIdOfType(t,px).includingRelationships([BH,mD]).addingQuery("limit[channel-apps]","100")}function dw(e,t,n){return Iv.context("msoRoomPageWithResponse",()=>{const r=j(e,t),o=ci(e,uV,r.id,t),i=Ae(r,BH),a=Ae(r,mD)
for(const t of a){const n=ye(e,t,SH)
s(n)&&i.push(n)}const c=new Z1
c.ids=i.map(e=>e.id),c.shouldFilter=!1,c.metricsPageInformation=o
const l=function(e,t,n,r,o=[]){return Iv.context("msoRoomPageWithContext",()=>{const i=[],s=[]
for(const e of t)-1!==n.indexOf(e.id)?i.push(e):s.push(e)
const a={rootPosition:0,locationStack:[]},c={lockupOptions:{metricsOptions:{pageInformation:r.metricsPageInformation,locationTracker:a},artworkUseCase:2}},l=[],u={pageInformation:r.metricsPageInformation,locationTracker:a,targetType:jV,idType:YV,id:"0"}
if(i.length>0){const t=e.loc.string("MSO_INCLUDED_IN_SUBSCRIPTION"),n=new Z1
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=LV,u.id="0",kf(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(i[e]),!1}
const o=new oJ(LV)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Gu(e,i,c),o.url=fw(n),Ef(a),o.items.length>0&&(xf(a),l.push(o))}if(i.length>0&&s.length>0){const t=e.loc.string("MSO_AVAILABLE_WITH_UPGRADED_SUBSCRIPTION"),n=new Z1
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=LV,u.id="1",kf(0,u,t),c.contentUnavailable=function(e,t){return n.remainingContent.push(s[e]),!1}
const o=new oJ(LV)
o.title=t,o.shouldFilterApps=r.shouldFilter,o.items=Gu(e,s,c),o.url=fw(n),Ef(a),o.items.length>0&&(xf(a),l.push(o))}if(0===l.length){const n=new Z1
n.remainingContent=[],n.metricsPageInformation=r.metricsPageInformation,n.metricsLocationTracker=a,n.preferredShelfContentType=eH,u.id="0",kf(0,u,null),c.contentUnavailable=function(e,r){return n.remainingContent.push(t[e]),!1}
const o=new oJ(LV)
o.shouldFilterApps=r.shouldFilter,o.items=Gu(e,t,c),o.url=fw(n),Ef(a),xf(a),l.push(o)}for(const e of l)e.isHorizontal=l.length>1
const d=o.concat(l)
return new lJ(d)})}(e,i,n,c)
return l.title=ie(r,GH),l.isIncomplete=!1,ui(e,l,o),l})}function fw(e){return e.remainingContent.length?`${Oz}:/${_z.mso}/${_z.shelf}/`+encodeURIComponent(JSON.stringify(e)):null}async function pw(e,t){const n={url:`${e.bag.getCancellablePreorderItemsSrv}?&includeAllLockups=false&includeNonBookCancellablePreorderItems=true${t.isArcade?"&preorderItemType=ArcadeApp":""}`,signingStyle:KG}
return await e.network.fetch(n).then(async n=>{const r=JSON.parse(n.body)
if(0!==r.status)return await Promise.resolve("noAuthorization")
const o=r.cancellablePreorderItems.filter(e=>e.preorderAdamId.toString()===t.adamId)
if(null===o||0===o.length)return await Promise.reject("Expected AdamID was missing. This AdamId might have not been preordered before, or the isArcade flag may be incorrect.")
if(o.length>1)return await Promise.reject(`Multiple matches for adamId ${t.adamId}, when only one is expected.`)
const i=o[0].preorderId,s={url:e.bag.cancelPreorderItemSrv,method:zB,signingStyle:KG}
return s.body=`preorderId=${i}`,await e.network.fetch(s).then(async e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${s.url}`)
return 0!==JSON.parse(e.body).status?await Promise.resolve("unableToCancel"):await Promise.resolve("canceled")}).catch(async e=>await Promise.reject(e))}).catch(async e=>await Promise.reject(e))}async function hw(e,t){if(t.preloading&&Ke(e))return await Promise.reject(new Error(JI))
0!==Kn(e,new oY(t.url)).length&&$p(e,t.url)
const n=S3.generateProductPageOptions(e,void 0,new oY(t.url))
let r=e.required(G4).fetchPage(e,t.url,HK)
if(!r){const o=new wJ(e,t.url)
r=Jn(e,o).then(r=>tu(e,r,n,void 0,t.referrerData))}return await r.then(n=>(e.host.clientIdentifier===tW?n&&oM in n&&wi(0,n):i(t.referrerData)&&n&&oM in n&&wi(0,n),n))}async function ww(e,t,n){const a=Ln(e,t,!1),c=new wJ(e)
switch(t){case PH:c.usingCustomAttributes(Ze(e)),xn(e)===LV&&c.includingAttributes([FF])
break
case xV:case nV:c.usingCustomAttributes(Ze(e))}const l=e.bag.adsOverrideLanguage
s(l)&&c.enablingFeature(fy).addingQuery("l",l)
const u=at(e,c).query
try{const c=await e.ads.fetchOnDeviceAdPlacement(t,a,u,n)
return await async function(e,t,n){var a,c,l,u,d,f
o(t.clientRequestId)&&(t.clientRequestId=e.random.nextUUID(),_n(e,`clientRequestId was nil. Assigned ${t.clientRequestId}`))
const p={clientRequestId:t.clientRequestId,iAdId:t.iAdId,placementType:null!==(c=null===(a=null==t?void 0:t.ad)||void 0===a?void 0:a.placementType)&&void 0!==c?c:n}
if(t.failureReason)return p.failureReason=t.failureReason,p
p.onDeviceAd=t.ad
let h=null===(l=t.ad)||void 0===l?void 0:l.appMetadata
const w=j(e,h)
if(o(null===(u=null==w?void 0:w.attributes)||void 0===u?void 0:u.name)||o(null===(d=null==w?void 0:w.attributes)||void 0===d?void 0:d.platformAttributes)||o(jt(e,w)))try{const n=function(e,t){const n=new wJ(e).withIdOfType(t.adamId,BH).usingCustomAttributes(Ze(e)).includingAttributes([FF])
s(t.cppIds)&&n.addingQuery(Hz.productVariantID,t.cppIds[0])
const r=e.bag.adsOverrideLanguage
return s(r)&&n.addingQuery("l",r),n}(e,t.ad)
h=await Jn(e,n)}catch(t){_n(e,`fetchAds request failed - ${t}`),p.failureReason=ly}if(s(null===(f=j(e,h))||void 0===f?void 0:f.attributes)){p.mediaResponse=function(e,t,n){const i=j(e,t)
if(o(i)||r(i.attributes))return _n(e,"decorateiAdAttributeFromOnDeviceAd cannot decorate for malformed response"),null
const a=n.ad,c=`${a.adamId}|${a.metadata}`,l={clientRequestId:n.clientRequestId,impressionId:a.impressionId,metadata:a.metadata,privacy:a.privacy,lineItem:c},u=j(e,a.appMetadata)
switch(s(i.meta)&&s(u)&&s(u.meta)&&(i.meta.passthroughAdInfo=u.meta.passthroughAdInfo,(0,kv.isSome)(null==a?void 0:a.alignedRegionDetails)&&(i.meta.alignedRegionDetails=null==a?void 0:a.alignedRegionDetails[0])),a.placementType){case PH:const t=xn(e)===LV
l.format={images:t,text:"",userRating:!1}
break
case UG:l.format={images:!0,text:"",userRating:!1}}return i.attributes[FB]=l,Un(0,i,a.instanceId),t}(e,h,t),Gn(e,j(e,h),p.onDeviceAd)||(_n(e,"fetchAds request failed - localization not available"),p.failureReason=uy)
const a=function(e,t,n){return n===PH?function(e,t){var n,r
const o=Qe(e,j(e,t.mediaResponse))
return(null===(r=null===(n=t.onDeviceAd)||void 0===n?void 0:n.cppIds)||void 0===r?void 0:r.includes(o.productPageId))?null:ik}(e,t):null}(e,p,n)
i(a)&&(_n(e,`fetchAds request failed - ${a}`),p.failureReason=a)}return p}(e,c,t)}catch{return null}}function gw(e,t,n,r=qv.Default){var o,i,s
const a=null!==(o=ie(t,hH))&&void 0!==o?o:void 0
let c=null!==(i=function(e,t,n){return ne(e,t,void 0)}(t,tV))&&void 0!==i?i:void 0;(0,kv.isNothing)(c)&&r===qv.CategoriesAndCharts&&(c={layoutDensity:Wv.Density1,layout:void 0,layoutSize:void 0})
const l=g(ne(t,"itemDisplayStyle")),u=ae(t,RO),d=null!==(s=ce(t,X_))&&void 0!==s?s:void 0,f=u?t.href:void 0
return new wK(t.id,a,c,d,u,f,l,n)}function vw(e,t,n,r){return{metricsOptions:mw(0,t,n,r)}}function mw(e,t,n,r){var o,i,s
const a=ve(t,FH),c=null===a?void 0:null!==(o=W(a))&&void 0!==o?o:void 0
let l=GG
return r.pageType===bm.ChartsAndCategories&&(l=QV),{id:n.id,kind:null,softwareType:null,targetType:jV,title:null!==(i=n.title)&&void 0!==i?i:"",pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:l,fcKind:void 0,canonicalId:null!==(s=f(t.meta,X$))&&void 0!==s?s:void 0,recoMetricsData:c}}function yw(e,t,n,r){var o
return{...r.metricsOptions,...Hf(e,n,t.title,r.metricsOptions),recoMetricsData:null!==(o=W(n))&&void 0!==o?o:void 0,targetType:Tw(t.density),idType:ZV}}function Aw(e,t,n,r){var o
return{pageInformation:r.metricsOptions.pageInformation,locationTracker:r.metricsOptions.locationTracker,recoMetricsData:null!==(o=W(n))&&void 0!==o?o:void 0,targetType:Tw(t),id:n.id}}function Tw(e){if((0,Cv.isNothing)(e))return HG
switch(e){case Wv.Density1:return HG
case Wv.Density2:return F$
default:return HG}}function bw(e,t){var n,r
const o=ie(t,hH),i=f(t,"meta.autoSelectedTabId"),a=f(t,"meta.sourceShelfCanonicalId"),c=ci(e,dB,a,t),u=fo(e)
c.recoMetricsData=Pf(c.recoMetricsData,null,u)
const d={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:c,adStitcher:null,adIncidentRecorder:null,pageType:bm.ChartsAndCategories},p=l(t,wG),h={},w=[],g=[],v={rootPosition:0,locationStack:[]}
for(const t of p){const o=gw(0,t,Hv.CategoriesAndCharts,qv.CategoriesAndCharts),i=vw(0,t,o,{...d,metricsLocationTracker:{rootPosition:0,locationStack:[]}})
kf(0,i.metricsOptions,o.title)
const s=Sw(e,t,!0,o,0,i)
if(Ef(i.metricsOptions.locationTracker),(0,kv.isNothing)(s))continue
h[s.id]=s,w.push(s.id)
const a=new aJ,c=new QW(t.id,o.title)
sp(e,c,{id:o.title,canonicalId:null!==(n=f(t.meta,X$))&&void 0!==n?n:void 0,actionType:UH,targetType:NH,pageInformation:d.metricsPageInformation,locationTracker:v}),a.action=c,a.id=s.id,a.title=`${null!==(r=s.title)&&void 0!==r?r:""}`,g.push(a),xf(v)}if(!s(w))return new dK
const m=new cJ
m.id=e.random.nextUUID()
const y=new oJ("pageTabs")
y.items=[m],h[m.id]=y
const A=new dK
A.shelfMapping=h
const T={}
for(const e of w)g.length>1?T[e]=[m.id,e]:T[e]=[e]
for(const e of Object.values(h))e.title=void 0
return A.title=o,A.pageTabs=m,A.columnCount=2,A.shelfOrderings=T,A.defaultShelfOrdering=w.includes(i)?i:w[0],m.tabs=g,m.selectedTabId=A.defaultShelfOrdering,ui(e,A,d.metricsPageInformation),A}function Sw(e,t,n,r,i,c){var l,u,d,p,h,w,g,v,m,y,A
const T=[],b=Ae(t,FH),S=new oJ(FR)
if(S.isHorizontal=!1,S.id=t.id,S.title=r.title,S.presentationHints={isWidthConstrained:!0},a(null===(l=r.displayStyle)||void 0===l?void 0:l.layoutSize)&&(S.contentsMetadata={type:"searchLandingChartsAndCategoriesSection",numberOfColumns:r.displayStyle.layoutSize}),r.hasSeeAll){const t=new dY(FR)
t.pageUrl=r.seeAllLink,t.title=e.loc.string(Oj)
const n={...c.metricsOptions,targetType:NH}
ap(e,t,t.pageUrl,n),S.seeAllAction=t}Bf(e,S,c.metricsOptions)
const P=n?Am.seeAllPage:Am.other
for(const t of b){let n=null,i=null
if(t.type===tj)n=null!==(u=ie(t,GH))&&void 0!==u?u:"tagbrick"
else{const e=ne(t,rj)
s(e)&&(n=f(e,GH),i=f(e,MN))}const a=id(e,t,P,null===(d=null==r?void 0:r.displayStyle)||void 0===d?void 0:d.layoutDensity),l=ie(t,rV),b=ne(t,uH),S=f(b,AH),I=Ae(t,Yj)
let C=!0,k=null
if(t.type===tj){const r=Er(e,f(t,eU)),o=e.required(G4).fetchFlowPage(r),i=new dY(o)
i.pageUrl=r,i.title=n,k=i}else if((0,kv.isSome)(S))switch(l){case"CategoryChart":const t=new dY(HB)
t.pageUrl=S,t.title=n,k=t
break
case"External":if(C=!1,f(b,nM)===p_)k=new MW(S),k.title=null!=n?n:""
else{const t=e.required(G4).fetchFlowPage(S),r=new dY(t)
r.pageUrl=S,r.title=null!=n?n:"",k=r}}else{if(!s(I))continue
{const t=Er(e,I[0].href)
if(!((null==t?void 0:t.length)>0))continue
{const e=new dY(jH)
e.pageUrl=t,e.title=n,k=e}}}if(sp(e,k,Aw(0,null===(p=null==r?void 0:r.displayStyle)||void 0===p?void 0:p.layoutDensity,t,c)),C&&o(n))continue
let O=new fK(n,a,null,null,i,k,null===(h=null==r?void 0:r.displayStyle)||void 0===h?void 0:h.layoutDensity,Pw(null===(w=null==r?void 0:r.displayStyle)||void 0===w?void 0:w.layoutDensity),Iw(null===(g=null==r?void 0:r.displayStyle)||void 0===g?void 0:g.layoutDensity)),E=yw(e,O,t,c)
const R=qr(e,t,0,0,0,E)
if((0,kv.isSome)(R)&&R.length>0){const o=R[0].backgroundColor;(0,kv.isSome)(o)&&(null==o?void 0:o.type)===hj&&(O=new fK(n,null,R,null!==(v=lf(o))&&void 0!==v?v:void 0,i,k,null===(m=null==r?void 0:r.displayStyle)||void 0===m?void 0:m.layoutDensity,Pw(null===(y=null==r?void 0:r.displayStyle)||void 0===y?void 0:y.layoutDensity),Iw(null===(A=null==r?void 0:r.displayStyle)||void 0===A?void 0:A.layoutDensity)),E=yw(e,O,t,c))}Bf(e,O,E),T.push(O),xf(c.metricsOptions.locationTracker)}return o(T)?null:(S.items=T,S)}function Pw(e){switch(e){case Wv.Density1:return Yq.defaultTileArtworkSafeArea
case Wv.Density2:return Yq.defaultPillArtworkSafeArea
case Wv.Density3:default:return}}function Iw(e){switch(e){case Wv.Density1:return Yq.defaultTileTextSafeArea
case Wv.Density2:return Yq.defaultPillTextSafeArea
default:return}}async function Cw(e,t){const n=new wJ(t,e.url).forType(AL).includingAgeRestrictions().includingScopedRelationships(QI,[FH]).enablingFeatures([WG,p$]).addingQuery(Hz.name,k$)
xr(t,lL)&&cr(n)
const r=Jn(t,n)
return await r.then(e=>bw(t,e))}function kw(e){switch(e){case cV:return LC
case RB:return g$
case MH:return _D
case xH:return CL
default:return}}function Ow(e,t,n,r,i){if(o(r))return null
const s=_R,a=n.term,c=r.displayLabel,l=t===qP?new gZ(c,r.finalTerm,null,s):new V3(c,s)
!function(e,t,n,r,o){const i=_L,s=KP,a={targetId:n},c=Zf(e,n,s,{actionType:i,location:Cf(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},n),searchTerm:r},[_L])
t.actionMetrics.addMetricsData(c)
const l=Qf(e,r,s,i,null,a,[_L])
t.actionMetrics.addMetricsData(l)}(e,l,c,a,i)
const u=new G3(c,r.isSelected,void 0,c,l)
return ai(0,u,KP,i),u}function Ew(e,t,n){const r=b(t),i=b(t.attributes)
return i[TR]=n.adData,r.attributes=i,function(e,t,n){var r
const i=et(Qe(e,t))
if(n.selectedCppId===i||o(null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.cppData))return
const s=b(t.meta)
s.cppData[wB]=n.selectedCppId,t.meta=s}(e,r,n),Un(0,r,n.instanceId),r}function Rw(e,t,n){const r=t||{},o=[]
e.client.deviceType!==$H&&o.push(new dZ(bF,[new fZ(e.loc.string(RP),null,r[bF]),new fZ(e.loc.string(DP),aH,r[bF])])),o.push(new dZ(I$,[new fZ(e.loc.string(SR,bB),null,r[I$]),new fZ(e.loc.string(_P,bB),KC,r[I$])]))
const s=Wn(e,n,!1)
if(s){const t=s.categories
if(t.length){const n=t.filter(e=>i(e.genreId)).map(e=>new fZ(e.name,e.genreId,r[Xj]))
n.unshift(new fZ(e.loc.string(PR,bB),null,r[Xj])),o.push(new dZ(Xj,n))}}const a=e.bag.searchSortOptions,c=[]
c.push(new fZ(e.loc.string(IR),null,r[Ij]))
for(const t of a)c.push(new fZ(e.loc.string(xP+t),t,r[Ij]))
c.length>1&&o.push(new dZ(Ij,c))
const l=e.bag.ageBands.map(e=>new fZ(f(e,GH),f(e,Gk),r[xF]))
return l.length>0&&e.client.deviceType!==$H&&o.push(new dZ(xF,l)),o}function Dw(e,t){let n=null,r=null,o=null
const s=new b5(bF,bF,e.loc.string("SEARCH_FACET_TYPE_TITLE_DEVICE_TYPE"),qF,[new T5(e.loc.string(RP),null),new T5(e.loc.string(DP),aH)],null,null,xw(e,bF)),a=new b5(LP,LP,e.loc.string("SEARCH_FACET_TYPE_TITLE_PRICE"),qF,[new T5(e.loc.string(SR,bB),null),new T5(e.loc.string(_P,bB),KC)],null,null,xw(e,I$)),c=Wn(e,t,!1)
if(c){const t=c.categories
if(t.length){const r=t.filter(e=>i(e.genreId))
n=new b5(MP,MP,e.loc.string("SEARCH_FACET_TYPE_TITLE_CATEGORY"),qF,[new T5(e.loc.string(PR,bB),null)],null,null,xw(e,Xj))
for(const e of r)n.options.push(new T5(e.name,e.genreId))}}const l=e.bag.searchSortOptions
r=new b5(Ij,Ij,e.loc.string("SEARCH_FACET_TYPE_TITLE_SORT"),qF,[new T5(e.loc.string(IR),null)],null,null,xw(e,Ij))
for(const t of l)r.options.push(new T5(e.loc.string(xP+t),t))
const u=e.bag.ageBands.map(e=>new T5(f(e,GH),f(e,Gk)))
u.length>0&&e.client.deviceType!==$H&&(o=new b5($P,$P,e.loc.string("SEARCH_FACET_TYPE_TITLE_AGE_BAND"),qF,u,null,null,xw(e,xF)))
const d=new P5([],!1,null)
{const e=[s,a]
i(n)&&e.push(n),e.push(r),i(o)&&e.push(o)
for(const t of e)t.showsSelectedOptions=!0
d.facetGroups.push(new S5(e))}return d}function _w(e){return{targetPlatform:[new T5(e.loc.string("SEARCH_FACET_IPAD_ONLY"),null)],"filter[price]":[new T5(e.loc.string(SR,bB),null)],sort:[new T5(e.loc.string(IR),null)],"filter[genre]":[new T5(e.loc.string(PR,bB),null)]}}function xw(e,t){const n=new lz
return cp(e,n,t),n}function Lw(e,t){const n=e.bag.searchResultsLearnMoreEditorialId
if((0,kv.isNothing)(n)||0===(null==n?void 0:n.length))return
const r={kind:zU,softwareType:null,title:e.loc.string(HP),id:n,targetType:uH,pageInformation:t.pageInformation,locationTracker:t.locationTracker},o=e.loc.string("SEARCH_TRANSPARENCY_TEXT"),i=new dY(XV)
i.title=o,i.pageUrl=`https://apps.apple.com/story/id${n}`,sp(e,i,r)
const s={}
s[`${e.loc.string(HP)}`]=i
const a=new Dq(o,mj)
return new BY(a,s)}function Mw(e,t){if(!ae(t,DR))return null
const n=ie(t,NR)
if(s(n))return n
const r=ie(t,CV)
return s(r)?r.replace(/\n/g," "):null}function $w(e,t,n,a,c,l,d,f){return Iv.context("searchResultFromData",()=>{let p=null
const h=t.type,w={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:lj,createUniqueImpressionId:!0},hideZeroRatings:!0,artworkUseCase:8,isNetworkConstrained:l,canDisplayArcadeOfferButton:of(0,rM),clientIdentifierOverride:Gw(0,d),isMultilineTertiaryTitleAllowed:!1},g=function(e,t,n){var r,o
if(!function(e){return e.client.deviceType===RH}(e))return Mj
const s=t.meta,a=null===(r=null==s?void 0:s.displayStyle)||void 0===r?void 0:r.condensed
if(i(a))return Nw(e,a)
const c=null===(o=null==n?void 0:n.displayStyle)||void 0===o?void 0:o.condensed
return i(c)?Nw(e,c):Bw(e)}(e,t,f)
switch(h){case TF:case o$:case _G:case OH:case pj:const l=ts(e,t,{useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0},new uQ(c.pageInformation,c.locationTracker))
if(l&&l.media&&l.media.kind===kB){const e=l.media.lockup
e.theme=mH,p=new TZ(e)}else if(function(e,t,n){if(1!=(u(n,"experiments.showGridCard")?0:1))return!1
switch(t.type){case pj:return s(oe(t,BR))
case TF:case o$:return!0
case OH:switch(is(t)){case am.List:case am.NumberedList:case am.Grid:case am.River:return!0
default:return!1}default:return!1}}(0,t,n)){const n=function(e,t,n){const r=function(e,t){if(t.type===_G)return e.loc.string(zP)
const n=Mw(0,t)
return s(n)?n:e.loc.string("Search.EditorialSearchResultType.Heading.Collection")}(e,t),i=function(e,t){return t.type===_G?ie(t,GH):Kd(e,t,GH)}(e,t),a=Hf(e,t,i,{targetType:lj,pageInformation:n.pageInformation,locationTracker:n.locationTracker})
kf(0,a,i)
const c=ju(e,t,{actionType:UH,targetType:NH,pageInformation:n.pageInformation,locationTracker:n.locationTracker,id:aE,idType:YV},e.host.clientIdentifier)
c.title=e.loc.string(Oj)
const l={lockupOptions:{metricsOptions:{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:cH},skipDefaultClickAction:!1,artworkUseCase:8,hideCompatibilityBadge:!1},filter:128}
let u=Ae(t,sV)
o(u)&&(u=Ae(t,RR))
const d=Gu(e,u,l)
Ef(n.locationTracker)
const f=new CZ(r,i,d,c,null)
return Bf(e,f,a),o(d)?null:f}(e,t,c)
n&&(p=n)}else{const n=function(e,t,n,o){return Iv.context("editorialSearchResultFromData",()=>{let a
const c=ie(t,GH)
switch(t.type){case pj:{const n=new IZ(c),r=oe(t,BR)
if(s(r))n.collectionAdamIds=r
else{const r=nd(e,ne(t,_H),{useCase:9,allowingTransparency:!0})
n.iconArtwork=r}n.type=AG,a=n
break}case TF:case o$:{const n=new IZ(c)
n.artwork=nd(e,ne(t,_H),{useCase:9,cropCode:"sr"}),n.collectionAdamIds=oe(t,BR),n.type=gj,a=n
break}case OH:{if(e.bag.searchFilterEditorialItemIds.has(t.id))return null
const c=new uQ(n.pageInformation,n.locationTracker),l=function(e,t,n,o){const a={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!0,canDisplayArcadeOfferButton:!0,isHeroCard:!1,isSearchContext:!0}
a.prevailingCropCodes=o&&e.client.isPhone?{defaultCrop:"DMGE.AppST01"}:{defaultCrop:"fo"}
const c=ts(e,t,a,n)
if(!c)return null
const l=new IZ(c.title)
l.type=RB,l.clickAction=c.clickAction
let u=null
if(c.media)switch(c.media.kind){case JU:const n=c.media
switch(l.artwork=n.artworks[0],r(l.artwork)&&(l.iconArtwork=n.icon),ie(t,uF)){case am.AppOfTheDay:case am.GameOfTheDay:const n=ye(e,t,sV)
n&&(l.title=ie(n,GH)||l.title)}break
case $C:case xD:u=c.media.lockups
break
case _H:const o=c.media
l.artwork=o.artworks[0]
break
case qj:case RL:u=c.media.lockups
break
case DV:const s=c.media
if(l.artwork=s.videos[0].preview,l.video=s.videos[0],c.overlay instanceof UJ){const e=c.overlay
l.title=e.title,l.subtitle=e.description}else l.subtitle=s.description
break
case CF:const a=c.media
if(l.artwork=a.artworks[0],l.appEventFormattedDates=a.formattedDates,l.subtitle=c.inlineDescription,l.tintColor=a.tintColor,l.type="appEventStory",i(c.style))switch(c.style){case UV:case BV:l.mediaOverlayStyle=UV
break
case mH:l.mediaOverlayStyle=mH
break
default:A(c.style)}}if(c.overlay)switch(c.overlay.kind){case cH:const e=c.overlay
l.artwork||(u=[e.lockup])
break
case $m:u=c.overlay.lockups
break
case fG:const t=c.overlay
l.subtitle=t.paragraph.text}if(i(u)){l.collectionAdamIds=[],l.collectionAppIcons=[]
for(const e of u)l.collectionAdamIds.push(e.adamId),l.collectionAppIcons.push(e.icon)
1===u.length&&(l.lockup=u[0])}const d=hn(0,t)
l.editorialDisplayOptions=wn(d)
const f=Mw(0,t);(null==f?void 0:f.length)>0&&f!==l.title&&(l.tagline=f)
const p=c.heroMedia
return s(p)&&(s(p.artworks[0])?(l.artwork=p.artworks[0],l.artwork.crop="em"):s(p.videos[0])&&(l.video=p.videos[0])),l.video&&(l.video.canPlayFullScreen=!1,l.video.playbackControls={}),l.collectionAdamIds||l.artwork||l.iconArtwork?l:null}(e,t,c,o===EN)
a=l
break}case _G:{const n=new IZ(c)
if(n.artwork=nd(e,ne(t,D_),{useCase:9,cropCode:"sr"}),n.type=cV,(0,Cv.isSome)(n.artwork))a=n
else{let r=Ae(t,RR)
r=r.filter(t=>!vt(e,t,76532))
const o=[],s=[]
r.forEach(t=>{o.push(t.id)
const n=sd(e,t,{useCase:9})
i(n)&&s.push(n)}),n.collectionAdamIds=o,n.collectionAppIcons=s,a=n}break}}if(r(a))return null
if(a instanceof IZ&&null!=a.collectionAdamIds&&a.collectionAdamIds.length){const e=a.collectionAdamIds.length
a.artworkGridType=e<=5?"extraLarge":e<=8?KV:e<=16?JP:OV}const l=Hf(e,t,a.title,n)
return a.clickAction=ju(e,t,l,null),Bf(e,a,l),a})}(e,t,w.metricsOptions,g)
n&&(n.title&&(n.title=n.title.replace(/\n/g," ")),n instanceof IZ&&n.subtitle&&(n.subtitle=n.subtitle.replace(/\n/g," ")),p=n)}break
case kV:if(o(Xu(e,t)))return null
const d=_u(e,t,w)
d.theme=mH,Uw(e,d,f),p=new TZ(d)
break
default:if(delete t.attributes[FB],h===IH){w.shouldIncludeScreenshotsForChildren=e.featureFlags.isEnabled(dR)
const n=Du(e,t,w)
n.showMetadataInformationInLockup=!0,Uw(e,n,f),p=new bZ(n)}else{const n=Mu(e,t,w,{canPlayFullScreen:!1,playbackControls:{}},f)
Uw(e,n,f)
const o=function(e,t,n,o,s,a){return Iv.context("appEventSearchResultFromData",()=>{if(!jw(e,t))return null
const{dataItems:c,personalizationData:l}=Vw(e,t,s)
let d,f
for(const n of c){const r=Hw(e,n,t,a,o.offerEnvironment,o.offerStyle)
if(i(r)){d=r,f=null!=t?t:ye(e,n,SH)
break}}if(r(d))return null
const p=u(t.meta,GR),h=new PZ
h.lockup=n,h.appEvent=d,h.alwaysShowAppEvent=p,h.clickAction=n.clickAction
const w=Pf(null,null==l?void 0:l.processingType,null),g={...a,id:d.appEventId,kind:wy,targetType:qL,title:d.title,softwareType:null,recoMetricsData:w}
return i(f)&&(g.relatedSubjectIds=[f.id]),Bf(e,h,g),h})}(e,t,n,w,a,c)
i(o)?(p=o,p.condensedBehavior=Mj):p=new AZ(n)}}return i(p)&&r(p.condensedBehavior)&&(p.condensedBehavior=g),p})}function Fw(e,t,n,r,o,s){if(!jw(e,t))return!1
const{dataItems:a}=Vw(e,t,s)
let c
for(const n of a)if(c=Hw(e,n,t,o,void 0,void 0),i(c))break
const l=!(!i(n)||!i(n[t.id]))&&n[t.id],u=!(!i(r)||!i(r[t.id]))&&["downloadable"].includes(r[t.id])
return(l||u)&&i(c)}function Nw(e,t){switch(t){case EN:return EN
case Mj:return Mj
case"when-installed":return YP
default:return Bw(e)}}function Bw(e){return e.client.deviceType===RH?YP:Mj}function Uw(e,t,n){const o=function(e,t,n,o){var i
if(r(t)||!e.client.isPhone)return null
const a=null===(i=null==t?void 0:t.displayStyle)||void 0===i?void 0:i.metadataPrecedenceOrder
if(!s(a))return null
const c=a.indexOf(n),l=a.indexOf(o)
return-1===c&&-1===l?null:-1!==c&&(-1===l||c<l)}(e,n,tU,AN)
i(o)&&(t.isEditorsChoice=t.isEditorsChoice&&o)}function Gw(e,t){return t===MH?Zq:null}function jw(e,t){if(!$i(e)||r(t.meta))return!1
const n=l(t.meta,UR).length>0
return![TF,o$,_G,OH,pj,kV,IH].includes(t.type)&&n}function Vw(e,t,n){const r=u(t.meta,GR),o=l(t.meta,UR)
if(r)return{dataItems:[o[0]]}
const i=co(e,JV,o,!1,n,!1,void 0,t.id),s=i.personalizedData
return s.length<=0?{dataItems:[]}:{dataItems:s,personalizationData:i}}function Hw(e,t,n,o,i,s){const a=zi(e,t,n,!1,!0,i,s,!1,{...o,targetType:qL},!1,!0,null,!1,!1)
return r(a)||a instanceof Date?null:a}function qw(e,t,n){var r
if((0,kv.isNothing)(t))return!1
const o=null!==(r=null==n?void 0:n[t])&&void 0!==r&&r
return e===t&&!o}function Ww(e,t){const n=e.findIndex(e=>e.id===t)
return-1===n?null:n}function zw(e,t,n,r,i,s,a,c,l,u,d,f){const p=Yw(e,t,n,i,s,a)
if((0,kv.isNothing)(p))return null
const h={platform:t.mediaPlatformUsedForDisplayStyle,style:p}
return _n(e,`[${n}] tentatively resolved to: ${tg(h)}`),"DUP"===r?function(e,t,n,r,i,s,a,c,l,u,d,f){const p=f.style
if(function(e,t){var n,r,o,i
switch(e){case"PI4":t.portraitScreenshots.length<=5&&t.portraitScreenshots.splice(0,4)
break
case"PI3":t.portraitScreenshots.splice(0,3)
break
case"PI2":t.portraitScreenshots.splice(0,2)
break
case"PI1":t.portraitScreenshots.splice(0,1)
break
case"PV4":null===(n=t.videos)||void 0===n||n.splice(0,1),t.portraitScreenshots.length<=4&&t.portraitScreenshots.splice(0,3)
break
case"PV3":null===(r=t.videos)||void 0===r||r.splice(0,1),t.portraitScreenshots.splice(0,2)
break
case"PV2":null===(o=t.videos)||void 0===o||o.splice(0,1),t.portraitScreenshots.splice(0,1)
break
case"LI1":t.landscapeScreenshots.splice(0,1)
break
case"PV1":case"LV1":null===(i=t.videos)||void 0===i||i.splice(0,1)}}(p,t),P6.includes(p))return _n(e,`[${n}] tentative style is unrestricted. No dupe logic applied.`),f
const h=o(i),w=Yw(e,t,n,r,null,s),g=function(e,t,n){switch(t){case"PV4":case"PI4":case"LI1":case"LV1":return!0
case"PV3":case"PI3":return 3===eg(e,n)
case"PV2":case"PI2":return 2===eg(e)
default:return!1}}(e,w,s),v=Fw(e,a,c,l,u,d)
return(g||v)&&h?(_n(e,`[${n}] Organic Dupe would be full creative as ${w} so choosing tentative style for ad`),f):g&&!h?(_n(e,`[${n}] Organic Dupe would be a full creative, but ad is not the first so returning compatible style with first ${p}`),f):Jw("TEXT",i)?(_n(e,`[${n}] tentative style would not yield full creative for organic result so returning TEXT`),{style:"TEXT"}):(_n(e,`[${n}] tentative style would not yield full creative for organic result and first style is not compatible with TEXT so skipping ad`),null)}(e,t,n,i,s,a,c,l,u,d,f,h):"TEXT"===(null==s?void 0:s.style)?(_n(e,`[${n}] tentative style would be filtered since the first ad has style: ${tg(s)}, so returning TEXT`),{style:"TEXT"}):h}function Yw(e,t,n,r,o,i){if(!r)return _n(e,`[${n}] is not allowed to display media because of iAd configuration.`),"TEXT"
const s=null==o?void 0:o.mediaPlatform
if((0,kv.isSome)(t.mediaPlatformUsedForDisplayStyle)&&(0,kv.isSome)(s)&&!t.mediaPlatformUsedForDisplayStyle.isEqualTo(s))return _n(e,`[${n}] filtered because media is derived from: ${t.mediaPlatformUsedForDisplayStyle.mediaType}, but first ad media is derived from: ${s.mediaType}`),null
for(const n of q3){const r=n.canDisplay(t),s=Jw(n.representativeDisplayStyle,o)
if(r&&s)return n.displayStyle(e,t,i)}return _n(e,`[${n}] filtered because we could not create a compatible style for the first style of: ${tg(o)}`),null}function Jw(e,t){if((0,kv.isNothing)(t))return!0
let n=[]
for(const t of I6)if(t.includes(e)){n=t
break}return n.includes(t.style)}function Kw(e){var t
let n
const r=null===(t=e.trailers)||void 0===t?void 0:t[0]
let o
s(r)&&(r.videos.sort((e,t)=>W3(e.preview,t.preview)),o=r.videos,n=r.mediaPlatform)
const i=e.screenshots[0],a=[],c=[]
return s(i)&&(i.artwork.forEach(e=>{e.isPortrait()?a.push(e):c.push(e)}),n=i.mediaPlatform),{portraitScreenshots:a,landscapeScreenshots:c,alignedRegionArtwork:e.alignedRegionArtwork,alignedRegionVideo:e.alignedRegionVideo,videos:o,mediaPlatformUsedForDisplayStyle:n}}function Zw(e,t){let n
const r=f(ne(e,TR),t)
return(0,kv.isSome)(r)&&r.length>0&&(n=JSON.parse(r)),n}function Qw(e,t){return o(e)?"NOORGANIC":t?"DUP":"NORMAL"}function Xw(e,t,n,r){var o,i,a,c,l,u,d,f,p,h
const w=s(null===(i=null===(o=e.impressionMetrics)||void 0===o?void 0:o.fields)||void 0===i?void 0:i.pageCustomId),g=n&&!r&&!w
if(s(e.trailers)){const t=e.trailers.shift()
null==t||t.videos.sort((e,t)=>W3(e.preview,t.preview)),(0,kv.isSome)(t)&&e.trailers.unshift(t)}let v,m=[],y=[]
if(s(e.screenshots)){const t=e.screenshots.shift()
null==t||t.artwork.forEach(e=>{e.isPortrait()?null==m||m.push(e):null==y||y.push(e)}),v=null==t?void 0:t.mediaPlatform}if((0,kv.isNothing)(v))return e
switch(t.style){case"PI4":if(e.trailers=null,y=null,e.screenshotsDisplayStyle=y$,g)if(m.length>5&&m.length<8){const e=m.splice(0,4),t=4-m.length,n=e.splice(e.length-t)
m.unshift(...n)}else m.splice(0,4)
else m.splice(4)
break
case"PI3":e.trailers=null,y=null,g?m.splice(0,3):m.splice(3)
break
case"PI2":e.trailers=null,y=null,g?m.splice(0,2):m.splice(2)
break
case"PI1":e.trailers=null,y=null,g?m.splice(0,1):m.splice(1)
break
case"LI1":e.trailers=null,m=null,g?y.splice(0,1):y.splice(1)
break
case"PV4":if(y=null,e.screenshotsDisplayStyle=y$,g)if(null===(a=e.trailers)||void 0===a||a[0].videos.splice(0,1),m.length>4&&m.length<7){const e=m.splice(0,3),t=3-m.length,n=e.splice(e.length-t)
m.unshift(...n)}else m.splice(0,3)
else null===(c=e.trailers)||void 0===c||c[0].videos.splice(1),m.splice(3)
break
case"PV3":y=null,g?(null===(l=e.trailers)||void 0===l||l[0].videos.splice(0,1),m.splice(0,2)):(null===(u=e.trailers)||void 0===u||u[0].videos.splice(1),m.splice(2))
break
case"PV2":y=null,g?(null===(d=e.trailers)||void 0===d||d[0].videos.splice(0,1),m.splice(0,1)):(null===(f=e.trailers)||void 0===f||f[0].videos.splice(1),m.splice(1))
break
case"LV1":case"PV1":g?null===(p=e.trailers)||void 0===p||p[0].videos.splice(0,1):null===(h=e.trailers)||void 0===h||h[0].videos.splice(1),y=null,m=null
break
case"TEXT":e.trailers=null,y=null,m=null}if(s(e.trailers)){const t=e.trailers.shift()
e.trailers=[t].filter(kv.isSome)}const A=(null!=y?y:[]).concat(null!=m?m:[])
if(s(A)){const t=new Tq(A,v)
e.screenshots=[t]}else e.screenshots=[]
return e}function eg(e,t=null){if(e.client.isPhone){const e=3
return(0,kv.isNothing)(t)?e:t===y$?4:3}return 2}function tg(e){if((0,kv.isNothing)(e))return""
let t=""
return(0,kv.isSome)(e.mediaPlatform)&&(t=` derived from ${e.mediaPlatform.mediaType} media`),`${e.style}${t}`}function ng(e,t,n,r,o){var i
if(!(n instanceof AZ||n instanceof PZ))return
const s=n.lockup,a=t.lockups[0]
if(a.adamId!==s.adamId)return
const c=new Set
if((0,kv.isSome)(a.screenshots)&&a.screenshots.length>0)for(const e of a.screenshots[0].artwork)c.add(e.template)
if((0,kv.isSome)(a.trailers)&&a.trailers.length>0)for(const e of a.trailers[0].videos)c.add(e.preview.template)
if((0,kv.isSome)(s.screenshots)&&s.screenshots.length>0){const e=s.screenshots[0].artwork.filter(e=>!c.has(e.template))
s.screenshots[0]=new Tq(e,s.screenshots[0].mediaPlatform)}if((0,kv.isSome)(s.trailers)&&s.trailers.length>0){const e=s.trailers[0].videos.filter(e=>!c.has(e.preview.template))
s.trailers[0]=new EY(e,s.trailers[0].mediaPlatform)}if((null===(i=null==r?void 0:r.displayStyle)||void 0===i?void 0:i.screenshots)===y$)switch(o){case"PV4":case"PI4":(e=>{const t=s.screenshots[0].artwork
if(t.length>=4)return
let n=4-t.length
const r=a.screenshots[0].artwork.slice().reverse()
for(const e of r){if(n<=0)return
s.screenshots[0].artwork.unshift(e),n-=1}})()}}function rg(e,t,n,r,o,i,s,a){var c,l
const u=n.lockups[0]
if(u.adamId!==r.id)return
const d=t.find(e=>e.id===u.adamId)
Fw(e,r,o,i,s,a)||function(e,t){var n
let r
r=(0,kv.isSome)(null==t?void 0:t.meta)?b(t.meta):{},(0,kv.isNothing)(e)?null===(n=r.cppData)||void 0===n||delete n[wB]:((0,kv.isNothing)(r.cppData)&&(r.cppData={}),r.cppData[wB]=e),t.meta=r}(null===(l=null===(c=null==d?void 0:d.meta)||void 0===c?void 0:c.cppData)||void 0===l?void 0:l[wB],r)}function og(e,t){var n,r,o
const i=null===(n=t.userDefaults)||void 0===n?void 0:n.integer("GuidedSearchOverrides.position")
return a(i)&&i>1?i:null===(o=null===(r=null==e?void 0:e.displayStyle)||void 0===r?void 0:r.guidedSearch)||void 0===o?void 0:o.position}async function ig(e,t,n,a,c,l,d,f,p){var h,w,g,v,m,y
const A=[],T=[],b=n||null,S=c.filter(e=>e.type===BH).map(e=>e.id),P=uo(e,new Set(S))
let I,C
if(Rn(e)&&s(l)){const n=function(e,t,n,a,c,l,d,f,p){var h,w,g,v,m,y,A,T,b,S,P,I,C,k
const O=new SZ,E=null!==(h=a.requestDescriptor.isNetworkConstrained)&&void 0!==h&&h,R={canPlayFullScreen:!1,playbackControls:{}}
if(kf(0,{id:Rx,kind:zb,softwareType:null,targetType:null,title:Rx,pageInformation:c.pageInformation,locationTracker:c.locationTracker,idType:YV},Rx),o(t))return{result:O}
const D=n[0]
let _
_n(e,`Adverts received from ad server: ${t.filter(i).map(e=>`[${e.id}]`).join(", ")}`)
let x=!0
for(const a of t){if((0,kv.isNothing)(null==a?void 0:a.attributes))continue
if(vt(e,a)){_n(e,`[${a.id}] filtered by shouldFilter() - app probably not supported on current os or device`)
continue}const t=qw(a.id,null==D?void 0:D.id,l),h=Qw(D,t)
if(a.attributes[FB]=Zw(a,h),o(a.attributes[FB])){_n(e,`[${a.id}] filtered because no appropriate iAd dictionary was found. (Probably a server issue if hitting this)`)
continue}const S={metricsOptions:{pageInformation:c.pageInformation,locationTracker:c.locationTracker,targetType:lj,isAdvert:!0},hideZeroRatings:!0,artworkUseCase:8,isNetworkConstrained:E,canDisplayArcadeOfferButton:of(0,rM)},P=u(Be(e,a,FB),"format.images")
let I=!1
const C=o(_),k=Kw(Nu(e,a,S,R,f)),L=I?y$:null===(w=null==f?void 0:f.displayStyle)||void 0===w?void 0:w.screenshots,M=zw(e,k,a.id,h,P,_,L,D,l,d,c,p)
if(r(M)){_n(e,`[${a.id}] will not be displayed because we could not create an ad style compatible with ${tg(_)}`)
continue}if(!Gn(e,a,null,M.style)){_n(e,`[${a.id}] filtered because localization is not available`)
continue}C?(_n(e,`[${a.id}] first ad dictates ad display style of: ${tg(M)}`),_=M):_n(e,`[${a.id}] will be displayed because it is compatible with the display style of: ${tg(M)}, which is the same height as display style: ${tg(_)}`),null===(g=c.pageInformation)||void 0===g||g.iAdInfo.apply(e,a),null===(m=null===(v=c.pageInformation)||void 0===v?void 0:v.iAdInfo)||void 0===m||m.setTemplateType(M.style)
let $=Nu(e,a,S,R,f)
if($=Xw($,M,t,x),null===(y=$.searchAdOpportunity)||void 0===y||y.setTemplateType(M.style),"TEXT"===M.style){const t=ie(a,cy)
if(t!==qV){let n
n=Ge(e,a,t===nH?fU:null!=t?t:void 0)
const r=null!==(A=$.searchAd)&&void 0!==A?A:null===(T=$.searchAdOpportunity)||void 0===T?void 0:T.searchAd
i(r)&&i(n)&&(r.advertisingText=n)}O.displaysScreenshots=!1}if(s($)){const e=Ww(n,$.adamId);(0,kv.isSome)(e)&&!I&&(null===(b=$.searchAdOpportunity)||void 0===b||b.setDuplicatePosition(e)),O.lockups.push($),xf(c.locationTracker),x=!1}}if(Ef(c.locationTracker),s(O.lockups)){const n=t[0]
null===(S=c.pageInformation)||void 0===S||S.iAdInfo.apply(e,n),xf(c.locationTracker)}return(0,kv.isSome)(_)?null===(I=null===(P=c.pageInformation)||void 0===P?void 0:P.iAdInfo)||void 0===I||I.setTemplateType(_.style):null===(k=null===(C=c.pageInformation)||void 0===C?void 0:C.iAdInfo)||void 0===k||k.setTemplateType(null),O.condensedBehavior=Mj,{result:O,displayStyle:null==_?void 0:_.style}}(e,l,c,t,a,null!=f?f:null,null!=p?p:null,b,P)
I=n.result,C=n.displayStyle,s(null==I?void 0:I.lockups)&&(I.searchAdOpportunity=I.lockups[0].searchAdOpportunity,A.push(I))}let k=!0
const O=og(n,e)
for(const[u,S]of c.entries()){if(u===O){const r=sg(e,t.requestDescriptor,d,a)
if(r.length>0){const t=null!==(g=null===(w=null===(h=null==n?void 0:n.displayStyle)||void 0===h?void 0:h.guidedSearch)||void 0===w?void 0:w.title)&&void 0!==g?g:e.loc.string("Search.Guided.Title.ExploreMore"),o=new kZ(t,r)
Bf(e,o,{...a,id:VP,kind:PG,targetType:ck,title:t,softwareType:null}),A.push(o),xf(a.locationTracker)}}if(!i(S.attributes)){T.push(...c.slice(u))
break}if(vt(e,S,10750))continue
k&&s(null==I?void 0:I.lockups)&&rg(e,null!=l?l:[],I,S,null!=f?f:null,null!=p?p:null,a,P)
const E=$w(e,S,n,P,a,t.requestDescriptor.isNetworkConstrained,t.requestDescriptor.searchEntity,b)
E&&(k&&s(I)&&s(I.lockups)&&ng(0,I,E,b,C),k&&Rn(e)&&i(null===(v=a.pageInformation)||void 0===v?void 0:v.iAdInfo)&&(r(I)||o(null==I?void 0:I.lockups))&&(E.searchAdOpportunity=Cn(e,a.pageInformation),null===(m=E.searchAdOpportunity)||void 0===m||m.setMissedOpportunityReason(XD),null===(y=E.searchAdOpportunity)||void 0===y||y.setTemplateType(MB)),A.push(E),k=!1,xf(a.locationTracker))}return await async function(e,t){return await Iv.context("applyClientFilteringToIAPs",async()=>{const n={}
for(const e of t)if(e.resultType===kB){const t=e.lockup
t.parent&&t.productIdentifier&&t.parent.bundleId?n[t.productIdentifier]=t.parent.bundleId:Iv.unexpectedNull(Qj,gH,`required fields for ${t.adamId}`)}return 0===Object.keys(n).length?await Promise.resolve(t):await e.clientOrdering.visibilityForIAPs(n).then(e=>t.filter(t=>{if(t.resultType!==kB)return!0
const n=t.lockup
return!(!n.productIdentifier||!e[n.productIdentifier])||n.isVisibleByDefault}))})}(e,A).then(e=>({builtSearchResults:e,deferredSearchResults:T}))}function sg(e,t,n,r){if((0,Cv.isNothing)(n)||0===n.length)return[]
Of(0,{pageInformation:r.pageInformation,locationTracker:r.locationTracker,targetType:LR},"")
const o=[]
for(const i of n){const n=Ow(e,qP,t,i,r)
n&&(o.push(n),xf(r.locationTracker))}return Ef(r.locationTracker),o}function ag(e,t,n,r){const o=new gZ(t,t,null,r)
return o.spellCheckEnabled=!1,o.excludedTerms=[n],o.originatingTerm=n,o}function cg(e,t){return t&&t.results?t.results.slice(0,t.maxPerPage):[]}function lg(e,t){let n=[]
if(t&&t.results&&(n=t.results.slice(t.maxPerPage,t.results.length)),o(n))return null
const r={...t}
return r.results=n,r}function ug(e){return(0,kv.isSome)(e)&&0!==e.length?`SearchResults.${e}.shelfId`:"SearchResults.shelfId"}function dg(e){switch(e){case im.iOS:return rH
case im.visionOS:return"visionos"
default:return"SearchTopResults"}}function fg(e,t){const n=new cZ
return i(t)&&(n.facets=Rw(e,t),n.pageFacets=Dw(e),n.selectedFacetOptions=_w(e)),n.results=[],n}function pg(e,t){const n=new uZ([])
return i(t)&&(n.facets=Rw(e,t),n.pageFacets=Dw(e),n.selectedFacetOptions=_w(e)),n}async function hg(e,t){return await Iv.context("searchResultsFromResponse",async()=>{var n
const a=null!==(n=e.fetchTimingMetricsBuilder)&&void 0!==n?n:new bv.FetchTimingMetricsBuilder,c=await a.measureModelConstructionAsync(async()=>{var n,a,c,l,u,d,f,p,h,w,g,v,m,y,T,b,S,P,I,C,k,O
const E=t.catalogResponse,R=t.requestMetadata,D=R.searchRequestUrl,_=t.searchResultsAdsRequestData,x=E.results.guidedSearch,L=function(e,t,n){var r,o,i,s,a,c,l
return{term:t.term,suggestedTerm:null===(o=null===(r=n.results)||void 0===r?void 0:r.spellCheck)||void 0===o?void 0:o.suggestedTerm,correctedTerm:null===(s=null===(i=n.results)||void 0===i?void 0:i.spellCheck)||void 0===s?void 0:s.correctedTerm,resultsTerm:null!==(l=null===(c=null===(a=n.results)||void 0===a?void 0:a.spellCheck)||void 0===c?void 0:c.correctedTerm)&&void 0!==l?l:t.term,originatingTerm:t.originatingTerm}}(0,R.requestDescriptor,E),M=(k=t.searchResultsAdData,(0,kv.isSome)(k)&&k.odmlSuccess),$={locationTracker:{rootPosition:0,locationStack:[]},pageInformation:pi(e,R.requestDescriptor,E,L,D,dg(),_,M,x),createUniqueImpressionId:!0},F=e.featureFlags.isEnabled("shelves_2_0_search")||!0,N=F?new uZ:new cZ,B=og(E.meta,e);(0,kv.isNothing)(B)&&function(e,t,n,r,i){const a=n.requestDescriptor
Of(0,{pageInformation:i.pageInformation,locationTracker:i.locationTracker,targetType:LR},"")
const c=[]
if(s(r))for(const t of r){const n=Ow(e,D$,a,t,i)
n&&(c.push(n),xf(i.locationTracker))}if(o(c)&&n.requestDescriptor.searchEntity){const t=function(e,t,n){var r
const o=t.searchEntity
if(!o)return null
const i=new H3(null,_R)
let s
switch(function(e,t,n,r,o){const i=Ox,s=kx,a={targetId:r},c=Zf(e,r,s,{actionType:i,location:Cf(0,{pageInformation:null,locationTracker:o.locationTracker,targetType:s},r),searchTerm:n})
t.actionMetrics.addMetricsData(c)
const l=Qf(e,n,s,i,null,a)
t.actionMetrics.addMetricsData(l)}(e,i,t.term,o,n),o){case xH:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_ARCADE")
break
case cV:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_DEVELOPERS")
break
case RB:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_STORIES")
break
case MH:s=e.loc.string("GUIDED_SEARCH_TOKEN_ENTITY_APPLEWATCH")
break
default:A(o)}const a=new G3(s,!0,null!==(r=kw(o))&&void 0!==r?r:xC,s,i)
return ai(0,a,kx,n),a}(e,n.requestDescriptor,i)
c.push(t),xf(i.locationTracker)}const l=function(e,t,n){var r
if(o(n))return null
const i=t.term,s=null!==(r=t.guidedSearchTokens)&&void 0!==r?r:[],a=[]
for(const e of n){const t=e.displayLabel,n=Array.from(s)
if(e.isSelected){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}else n.push(t)
const r=new j3(i,n,e.finalTerm)
a.push(r)}return a}(0,n.requestDescriptor,r)
Ef(i.locationTracker),s(c)&&(t.guidedSearchTokens=c,t.guidedSearchQueries=l,function(e,t,n){const r=Rf(n.locationTracker)
t.guidedSearchTokensParentImpressionMetrics=new RW({impressionIndex:r,impressionType:LR,idType:gB,id:ZP,name:"Search Revisions"})}(0,t,i),xf(i.locationTracker))}(e,N,R,null==x?void 0:x.facets,$)
const U={id:C$,kind:null,softwareType:null,targetType:IG,title:PN,pageInformation:$.pageInformation,locationTracker:$.locationTracker,idType:gB}
let G
F&&(G=new oJ(uL),G.id=ug(),G.isHorizontal=!1,Bf(e,G,U),kf(0,U,PN))
let j=function(e,t){return function(e,t,n){if(r(n))return t
const i=[],s=t.reduce((e,t)=>({...e,[t.id]:t}),{})
for(const t of n.adverts){const n=s[t.adamId]
if(o(n)){_n(e,`[${t.adamId}] skipped - Data was not part of original response`)
continue}if(o(n.attributes)){_n(e,`[${n.id}] skipped - Data is missing attributes`)
continue}const r=Ew(e,n,t)
i.push(r)}return i}(e,V(t.catalogResponse.results[WP]),t.searchResultsAdData)}(e,t)
const H=null===(n=t.searchResultsAdData)||void 0===n?void 0:n.appliedPolicy;(0,kv.isSome)(H)&&(j=[],"ageRestricted"===H&&(null===(a=$.pageInformation)||void 0===a||a.iAdInfo.setMissedOpportunity(e,dy,OG)))
const q=null!==(d=null===(u=null===(l=null===(c=E.meta)||void 0===c?void 0:c.results)||void 0===l?void 0:l.search)||void 0===u?void 0:u.searchSafety)&&void 0!==d&&d,W=(null===(w=null===(h=null===(p=null===(f=E.meta)||void 0===f?void 0:f.results)||void 0===p?void 0:p.search)||void 0===h?void 0:h.reason)||void 0===w?void 0:w.kind)===$R?"NLS_NORESULTS":"NLS_NOAD"
q&&(j=[],null===(g=$.pageInformation)||void 0===g||g.iAdInfo.setMissedOpportunity(e,W,OG))
const z=await ig(e,R,E.meta,$,function(e,t){return V(t.catalogResponse.results.search)}(0,t),j,null==x?void 0:x.facets,function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.installedStates)&&void 0!==n?n:{}}(t),function(e){var t,n
return null!==(n=null===(t=e.searchResultsAdData)||void 0===t?void 0:t.appStates)&&void 0!==n?n:{}}(t))
if(q&&0!==z.builtSearchResults.length){const e=z.builtSearchResults[0].lockup.searchAdOpportunity
null==e||e.setMissedOpportunityReason(W),null==e||e.setTemplateType(MB)}if(F&&G){const t=N
G.items=z.builtSearchResults,t.resultsParentImpressionMetrics=G.impressionMetrics,t.shelves.push(G)
const n=function(e,t){return Iv.context("createSearchResultsContextCard",()=>{var n,r
if((0,kv.isNothing)(e)||![fj,yj].includes(t.host.platform))return
const o=null===(n=e.links)||void 0===n?void 0:n.map(wg),i=null==o?void 0:o.reduce((e,t)=>{var n
return(null===(n=t.title)||void 0===n?void 0:n.length)&&(e[t.title]=t),e},{})
let s=e.text
1===(null==o?void 0:o.length)&&(null===(r=o[0].title)||void 0===r?void 0:r.length)?s+=" "+o[0].title:o&&o.length>1&&(s.length>0&&(s+="\n"),s+=o.map(e=>e.title).filter(e=>null==e?void 0:e.length).join("\n"))
const a=new Dq(s),c=new BY(a,i)
return new lZ(c)})}(E.results.queryContext,e),r=null===(y=null===(m=null===(v=E.meta)||void 0===v?void 0:v.results)||void 0===m?void 0:m.search)||void 0===y?void 0:y.reason
if((null==r?void 0:r.kind)===$R)t.unavailableReason={title:e.loc.stringWithFallback("Search.Results.Empty.Title","No results"),message:r.text,action:(O=r.links,Iv.context("actionFromSearchResultsLinks",()=>{const e=null==O?void 0:O.find(e=>e.url.length>0)
return e?wg(e):void 0})),contextCard:n}
else if(n){const e=new oJ("searchResultsContextCard")
e.items=[n]
const r=null!==(P=null===(S=null===(b=null===(T=E.meta)||void 0===T?void 0:T.displayStyle)||void 0===b?void 0:b.queryContext)||void 0===S?void 0:S.position)&&void 0!==P?P:0
if(r>0){const n=G.items.splice(r),o={...G,id:"searchResults2",items:n,isValid:G.isValid}
t.shelves.push(e),t.shelves.push(o)}else t.shelves.unshift(e)}q&&0===z.builtSearchResults.length&&(null===(C=(I=e.onDeviceSearchHistoryManager).removeRecentSearchTerm)||void 0===C||C.call(I,L.term))}else{const e=N
e.results=z.builtSearchResults,function(e,t,n){const r=Rf(n.locationTracker)
t.resultsParentImpressionMetrics=new RW({impressionIndex:r,impressionType:IG,idType:gB,id:C$,name:PN})}(0,e,$)}return z.deferredSearchResults.length>0&&(N.nextPage=function(e,t,n,r,i){return o(t)?null:{results:t,maxPerPage:30,requestMetadata:n,metricsOptions:i,responseMetadata:null!=r?r:{},contentOffsetWithinResultsShelf:Rf(i.locationTracker)}}(0,z.deferredSearchResults,R,E.meta,$)),F&&Ef(U.locationTracker),N.message=function(e,t,n){const r=i(t.correctedTerm),o=i(t.suggestedTerm)
return Of(0,{pageInformation:n.pageInformation,locationTracker:n.locationTracker,targetType:uH},"spellCorrection"),r?function(e,t,n){const r=t.term,o=ag(0,r,t.resultsTerm,uE)
lp(e,o,NH,n.locationTracker)
const i=`<i>${t.correctedTerm}</i>`,s=e.loc.string("SEARCH_SHOWING_RESULTS_FOR_TEMPLATE").replace(MR,i),a=new BY(new Dq(s,QG),{}),c=e.loc.string("SEARCH_SEARCH_INSTEAD_FOR_TEMPLATE").replace(MR,r),l={}
l[`${c}`]=o
const u=new BY(new Dq(c),l)
return new mZ(a,u,o)}(e,t,n):o?function(e,t,n){const r=t.suggestedTerm,o=ag(0,r,t.resultsTerm,dE)
lp(e,o,NH,n.locationTracker)
const i=`<i>${r}</i>`,s=e.loc.string("SEARCH_DID_YOU_MEAN_TEMPLATE").replace(MR,i),a={}
a[`${r}`]=o,a[`${r}?`]=o
const c=new BY(new Dq(s,QG),a)
return new mZ(c,null,o)}(e,t,n):(Ef(n.locationTracker),null)}(e,L,$),!o(R.requestDescriptor.searchEntity)||(N.facets=Rw(e,R.requestDescriptor.facets,t.categoriesFilterData),N.pageFacets=Dw(e,t.categoriesFilterData),N.selectedFacetOptions=s(t.requestMetadata.requestDescriptor.selectedFacetOptions)?t.requestMetadata.requestDescriptor.selectedFacetOptions:_w(e)),N.searchTermContext=L,N.isAutoPlayEnabled="tv"!==e.client.deviceType,N.isCondensedSearchLockupsEnabled=e.client.isPhone,N.transparencyLink=Lw(e,$),ui(e,N,$.pageInformation),N.searchClearAction=gg(e,wU,$.pageInformation,$.locationTracker,L.term),N.searchCancelAction=gg(e,cG,$.pageInformation,$.locationTracker,L.term),N})
return c})}function wg(e){return Iv.context("actionFromSearchResultsLink",()=>{var t
const n=new MW(e.url,!1)
return n.title=null===(t=e.label)||void 0===t?void 0:t.replace(" ","\xa0"),n.artwork=new Aq("systemimage://arrow.up.forward",0,0,[]),n})}function gg(e,t,n,r,o){const s=new lz
let a,c
switch(t){case cG:a=DU,c=cG
break
case wU:a="delete",c=wU}return function(e,t,n,r,o){const s={searchTerm:o,actionType:n.actionType}
n.actionDetails&&(s[bU]=n.actionDetails),n.actionContext&&(s[Cb]=n.actionContext),o&&(s[oV]=o),i(n.softwareType)&&(s[wF]=n.softwareType),n.mercuryMetricsData&&Object.assign(s,n.mercuryMetricsData)
const a=Zf(e,n.id,null!=r?r:pf(0,n),s)
t.actionMetrics.addMetricsData(a)}(e,s,{targetType:NH,id:c,idType:void 0,actionType:a,pageInformation:n,locationTracker:r},NH,o),s}async function vg(e,t){return function(e,t,n){return Iv.context("searchHintsFromApiResponse",()=>{var r,o,i,s
const a={targetType:iF,pageInformation:fi(0,0,n.hintsRequestUrl,n.dataSetId),locationTracker:{rootPosition:0,locationStack:[]}}
let c=null;(null===(r=n.userTypedTerm)||void 0===r?void 0:r.length)&&(c=new gZ(n.userTypedTerm,n.userTypedTerm,null,fE),c.spellCheckEnabled=!0,c.prefixTerm=t,zf(e,c,a),lp(e,c,a.targetType,a.locationTracker,a.pageInformation),xf(a.locationTracker))
const l=null!==(i=null===(o=n.rawHints)||void 0===o?void 0:o.map(n=>function(e,t,n,r){var o,i,s,a,c
const l=null!==(o=function(e){switch(e.entity){case BH:return e.context
case _G:return cV
case OH:return RB
default:return null}}(t))&&void 0!==o?o:void 0,u=new gZ(null!==(i=t.displayTerm)&&void 0!==i?i:"",null!==(s=t.searchTerm)&&void 0!==s?s:"",null,LM,l,t.source)
return u.artwork=function(e,t){return Se(e,`systemimage://${t}`)}(e,null!==(a=kw(l))&&void 0!==a?a:xC),u.spellCheckEnabled=!0,u.prefixTerm=n,zf(e,u,r),lp(e,u,r.targetType,r.locationTracker,null!==(c=r.pageInformation)&&void 0!==c?c:void 0),xf(r.locationTracker),u}(e,n,t,a)))&&void 0!==i?i:[]
null!=c&&l.unshift(c)
const u=new vZ(l,null!==(s=n.ghostHintsTerm)&&void 0!==s?s:null),d=Qf(e,t,"key",TE,n.hintsRequestUrl,{...Ft(a.pageInformation)})
return u.pageMetrics.pageFields=Ft(a.pageInformation),u.pageMetrics.addData(d,[Fv.PageInvocationPoint.pageEnter]),u.searchClearAction=gg(e,wU,a.pageInformation,a.locationTracker,t),u.searchCancelAction=gg(e,cG,a.pageInformation,a.locationTracker,t),u})}(e,t,await async function(e,t){const n=function(e,t){const n=new wJ(e).includingAppBinaryTraitsAttribute(!1).forType(aL).withLimit(10).withSearchTerm(t).addingQuery(CR,FP)
e.host.clientIdentifier===Qq&&n.addingQuery(hU,_V)
const r=[]
return e.appleSilicon.isSupportEnabled&&r.push(kR),$i(e)&&r.push(PV),e.bag.isNaturalLanguageSearchEnabled&&r.push(NP),r.length>0&&n.enablingFeatures(r),n}(e,t)
return await Jn(e,n).then(t=>{var r
return{hintsRequestUrl:at(e,n).toString(),userTypedTerm:f(t,"userTyped"),rawHints:l(t,"results.suggestions"),ghostHintsTerm:f(t,"ghosting"),dataSetId:f(null===(r=t.meta)||void 0===r?void 0:r.metrics,t0)}})}(e,t))}function mg(e,t,n){var r
const i=t.data
if(o(i))return
let s=0
const a=e.bag.mediaAPISearchFocusEnabled&&(0,Cv.isSome)(n.pageType)
for(const c of i){if(o(c))continue
if(a){const e=h(c,WG),t=yg(null==e?void 0:e.category)
if((0,Cv.isSome)(t)&&t!==n.pageType)continue}const i=Ig(e,n,s,t.meta||null);(0,Cv.isSome)(i)&&(n.shelves.push(i),xf(n.metricsLocationTracker))
const l=ie(c,"contentKind"),u=gw(0,c,l),d=Cg(0,c,u,n,l)
kf(0,d.metricsOptions,null!==(r=u.title)&&void 0!==r?r:"")
const f=Ag(e,c,n,d,u,l)
Ef(n.metricsLocationTracker),o(f)||(Bf(e,f,d.metricsOptions),$n(e,[f],UG,d.metricsOptions.id,n.metricsPageInformation),n.shelves.push(f),s+=1,xf(n.metricsLocationTracker))}}function yg(e){switch(e){case k$:return bm.Landing
case"search-focus":return bm.Focus
default:return}}function Ag(e,t,n,c,l,u){switch(u){case Hv.Suggestion:return n.pageType===bm.Focus?function(e,t,n,r,i){var s,a,c
const l=Ae(t,FH)
if((0,Cv.isNothing)(l))return null
const u=[],d=new oJ(QP)
d.isHorizontal=!1,d.title=r.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,i]of l.entries()){const l=ie(i,oV)
if((0,Cv.isNothing)(l)||0===l.length)continue
const d=null!==(s=ie(i,qR))&&void 0!==s?s:l,f=bg(e,null!=d?d:"",null!=l?l:"",void 0,n.metricsLocationTracker,uN,void 0,n.metricsPageInformation,null!==(a=r.searchLandingItemDisplayStyle)&&void 0!==a?a:void 0);(0,Cv.isNothing)(f)||o(f)||(Bf(e,f,{targetType:uH,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,kind:uH,softwareType:null,title:null!==(c=f.title)&&void 0!==c?c:"",id:`${t}`,idType:YV}),u.push(f),xf(n.metricsLocationTracker))}return o(u)?null:(d.items=u,d)}(e,t,n,l):function(e,t,n,i,s){var c
const l=Ae(t,FH),u=[],d=new oJ(EV)
d.isHorizontal=!1,d.title=i.title,d.presentationHints={isWidthConstrained:!0}
for(const[t,o]of l.entries()){const s={targetType:uH,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},a=Tg(e,o,n,i)
r(a)||r(a.action)||(Bf(e,a.action,{...s,kind:uH,softwareType:null,title:a.action.title,id:`${t}`,idType:YV}),u.push(a),xf(n.metricsLocationTracker))}return o(u)?null:(d.items=u,a(null===(c=i.displayStyle)||void 0===c?void 0:c.layoutSize)?d.contentsMetadata={type:RM,numberOfColumns:i.displayStyle.layoutSize}:(e.client.isPhone||e.client.isPad)&&(d.contentsMetadata={type:RM,numberOfColumns:u.length>=6?2:1}),d)}(e,t,n,l)
case Hv.CategoriesAndCharts:return Sw(e,t,!1,l,0,c)
case Hv.Apps:return function(e,t,n,o,a){var c,l,u,d,f
const p=[]
let h=!1,w=function(e){const t=ve(e,FH)
return null==t?void 0:t.data}(t)
const g=new oJ(a.shelfStyle)
if(g.isHorizontal=!1,g.title=o.title,g.shouldFilterApps=!1,g.filteringExcludedItems=a.filteringExcludedItems,s(w)){const t=function(e,t,n){const o=Xa(t.adStitcher,n.adPositionInfo)
if(r(o))return null
const s=o.data
try{const r=Pg(e,s,t,n)
return i(r)?n.filteringExcludedItems=[s.id]:wo(e,t.adIncidentRecorder),r}catch(n){return _n(e,`Failed to create SLP ad lockup: ${n}`),wo(e,t.adIncidentRecorder),null}}(e,n,a)
t&&t instanceof PY&&(h=!0,p.push(t),xf(n.metricsLocationTracker),w=w.filter(e=>e.id!==t.adamId))}const v=(0,Cv.isSome)(o.displayCount)
s(w)&&(w=Mo(w,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(u=null===(l=a.metricsOptions)||void 0===l?void 0:l.recoMetricsData)&&void 0!==u?u:{}))
for(const t of w){if(t.type===DH)return null
if(r(t.attributes))continue
if(vt(e,t,80894))continue
const o=Pg(e,t,n,a)
o&&(p.push(o),xf(n.metricsLocationTracker))}if(v){const e=o.displayCount
g.items=p.slice(0,e)}else g.items=p
if(v){const r=new oJ(a.shelfStyle)
r.items=h?p.splice(1,p.length-1):p
const i=new lJ([r])
i.title=g.title
const s=new dY(jH)
s.pageUrl=o.seeAllLink,s.title=e.loc.string(Oj),s.pageData=i,g.seeAllAction=s,ap(e,s,s.pageUrl,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),ui(e,i,di(0,t.id))}return"horizontal"===(null===(d=o.displayStyle)||void 0===d?void 0:d.layout)&&(g.isHorizontal=!0,g.rowsPerColumn=null===(f=o.displayStyle)||void 0===f?void 0:f.layoutSize),g}(e,t,n,l,c)
case Hv.EditorialCollection:return null
default:return function(e,t,n,r,o){return"search-recommendations-marker"!==t.type?null:ie(t,_M)===jP?function(e,t,n){return kg(e,new J3(n.title,n.displayCount,n.displayStyle,n.searchLandingItemDisplayStyle),t.metricsPageInformation,t.metricsLocationTracker,t.searchHistory)}(e,n,o):null}(e,t,n,0,l)}}function Tg(e,t,n,r){var o,i
const s=ie(t,oV)
if((0,Cv.isNothing)(s)||0===s.length)return null
const a=null!==(o=ie(t,qR))&&void 0!==o?o:s,c=new gZ(a,s,null,uN,void 0,void 0)
return c.artwork=Sg(null!==(i=r.searchLandingItemDisplayStyle)&&void 0!==i?i:void 0,e),lp(e,c,NH,n.metricsLocationTracker),(0,Cv.isSome)(c)?new uz(c):null}function bg(e,t,n,r,i,s,a,c,l){if(o(n))return null
const u=new gZ(t,n,null,s,null!=r?r:void 0,a,[])
return u.artwork=Sg(l,e),lp(e,u,NH,i,c),u}function Sg(e,t){var n
return(null==e?void 0:e.iconKind)===zv.Symbol&&(null===(n=null==e?void 0:e.iconKind)||void 0===n?void 0:n.length)?Se(t,`systemimage://${e.iconSymbol}`):t.client.isPhone?Se(t,kM):void 0}function Pg(e,t,n,s){if(o(t))return null
if(s.shelfStyle!==eH)return null
let a=null
!i(s.shelfBackground)||s.shelfBackground.type!==ej&&s.shelfBackground.type!==B_||(a=BV)
const c=Du(e,t,{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),isAdvert:An(0,t)},artworkUseCase:td(0,s.shelfStyle),offerStyle:a,canDisplayArcadeOfferButton:of(0,s.shelfStyle),isContainedInPreorderExclusiveShelf:!1,shouldHideArcadeHeader:!1})
return r(c)||!c.isValid()?null:c}function Ig(e,t,n,o){var i
const s=Xa(t.adStitcher,{shelfIdentifier:W1,slot:n})
if(r(s))return null
const a=s.data
try{switch(null===(i=null==o?void 0:o.adDisplayStyle)||void 0===i?void 0:i.format){case dN:return function(e,t,n){var r,o
const i=new oJ(jR)
i.isHorizontal=!1
const s=mH,a=BV,c=Hf(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:lj,recoMetricsData:W(t),isAdvert:An(0,t)})
c.kind=VR,c.pageInformation.iAdInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),isAdvert:An(0,t),disableFastImpressionsForAds:!0},artworkUseCase:td(0,jR),canDisplayArcadeOfferButton:of(0,jR)},u={canPlayFullScreen:!1,playbackControls:{}}
let d=Nu(e,t,l,u,null,!1)
const p=d.screenshots[0],h=Pn(p)
n.metricsPageInformation.iAdInfo.setTemplateType(h)
const w=sd(e,t,{useCase:0,withJoeColorPlaceholder:!0,overrideTextColorKey:vM})
d=Nu(e,t,l,u,null,!1),null===(r=d.searchAdOpportunity)||void 0===r||r.setTemplateType(h)
const g=w.backgroundColor,v=w.textColor,m=new pK(d,[p],!0,v,g,null!==(o=e.bag.todayAdMediumLockupScreenshotsRiverSpeed)&&void 0!==o?o:8)
return jf(e,m,c,c.pageInformation.iAdInfo),m.clickAction=ju(e,t,c,null),i.items=[m],i}(e,a,t)
case"condensed":return function(e,t,n){var r,o
const i=new oJ(HR)
i.isHorizontal=!1
const s=mH,a=BV,c=Hf(e,t,f(t.attributes.name),{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:lj,recoMetricsData:W(t),isAdvert:An(0,t)})
c.kind=VR,c.pageInformation.iAdInfo.apply(e,t)
const l={offerEnvironment:s,offerStyle:a,metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),isAdvert:An(0,t),disableFastImpressionsForAds:!0},artworkUseCase:td(0,HR),canDisplayArcadeOfferButton:of(0,HR)}
null===(r=n.metricsPageInformation.iAdInfo)||void 0===r||r.setTemplateType(MB)
const u=Nu(e,t,l,{canPlayFullScreen:!1,playbackControls:{}},null,!1)
null===(o=u.searchAdOpportunity)||void 0===o||o.setTemplateType(MB)
const d=new hK(u,u.icon)
return jf(e,d,c,c.pageInformation.iAdInfo),i.items=[d],i}(e,a,t)
default:return wo(e,t.adIncidentRecorder),null}}catch(n){return _n(e,`Failed to create SLP ad shelf: ${n}`),wo(e,t.adIncidentRecorder),null}}function Cg(e,t,n,r,o=null){const i=vw(0,t,n,r)
return o===Hv.Apps?{...i,shelfStyle:eH,adPositionInfo:q1}:i}function kg(e,t,n,r,i){const s=function(e,t,n,r,i){if(o(i))return[]
const s=[]
for(const[a,c]of i.entries()){const i=Og(e,c,a,t,n,r)
o(i)||(s.push(i),xf(n))}return s}(e,n,r,t.itemDisplayStyle,i),a=new Iz
a.title=e.loc.string("Action.ClearSearches"),function(e,t){const n=Zf(e,"Clear Searches",NH,{actionType:"confirm"})
t.actionMetrics.addMetricsData(n)}(e,a)
const c=new ez([a])
c.title=e.loc.string("Sheet.ClearSearches.Title"),c.message=e.loc.string("Sheet.ClearSearches.Message"),c.destructiveActionIndex=0,c.isCancelable=!0
const l=new $W([c])
l.title=e.loc.string("Action.Clear")
const u="word_cloud"===(f=t.shelfDisplayStyle).layout?nI:2===f.layoutSize?"twoColumnList":QP,d=new oJ(u)
var f
return d.id=YR,d.presentationHints={isWidthConstrained:!0},d.header={title:t.title,accessoryAction:l},d.contentType===nI&&(d.isHorizontal=!0,d.rowsPerColumn=t.shelfDisplayStyle.layoutSize),d.contentsMetadata={type:"searchFocusTwoColumnList",numberOfColumns:s.length>1?t.shelfDisplayStyle.layoutSize:1},d.items=s,d.isHidden=o(s),d.refreshUrl=function(e){return`${Oz}:/${_z.searchLandingPage}/${_z.shelf}/?${Hz.isOnDeviceSearchHistoryShelf}=true&${Hz.token}=${function(e){return encodeURIComponent(JSON.stringify(e))}(e)}`}(t),d}function Og(e,t,n,r,o,i){const s=t.term,a=t.entity,c=bg(e,function(e,t,n){if((0,Cv.isNothing)(n))return t
let r
return n===cV?r="Search.ResultsTitle.InDevelopers":n===RB?r="Search.ResultsTitle.InStories":n===MH?r="Search.ResultsTitle.InWatch":n===xH&&(r="Search.ResultsTitle.InArcade"),(0,Cv.isNothing)(r)?t:e.loc.string(r).replace("@@search_term@@",t)}(e,s,a),s,a,o,lE,void 0,r,i)
return(0,Cv.isNothing)(c)?null:(c.id=t.id,Bf(e,c,{targetType:uH,pageInformation:r,locationTracker:o,kind:uH,softwareType:null,title:t.term,hintsEntity:t.entity,id:`${n}`,idType:YV}),c)}function Eg(e,t){const n=new wJ(e).forType(OR).includingAgeRestrictions().includingAdditionalPlatforms(N(e)).usingCustomAttributes(Ze(e)).includingScopedRelationships("search-recommendations",[FH]).addingQuery(GH,k$)
xr(e,lL)&&cr(n)
const r=ic(e,e.user.dsid)
return(null==r?void 0:r.length)>0&&n.addingQuery(BP,r),n.addingQuery(WG,"adDisplayStyle"),n}function Rg(e,t,n,r){if(o(t.data))return null
const i=ci(e,dB,dB,t),s=fo(e)
i.recoMetricsData=Pf(i.recoMetricsData,null,s),i.iAdInfo=Nn(e,UG,n)
const a=po(0,i.iAdInfo)
go(e,a,n)
const c={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:i,adStitcher:ec(e,n,t),adIncidentRecorder:a,pageType:bm.Landing,recoImpressionData:$o(0,r)}
mg(e,t,c)
const l=Dg(e)
l&&c.shelves.unshift(l)
const u=new fJ(c.shelves)
return u.pageRefreshPolicy=new NZ(GP,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null),u.adIncidents=ho(0,c.adIncidentRecorder),ui(e,u,c.metricsPageInformation),u}function Dg(e){var t
if(!e.bag.isNaturalLanguageSearchEnabled&&!e.bag.isNaturalLanguageSearchResultsEnabled)return
const n=Sc(0,"searchFocusHeader",{signal:{lastNLSQueryDate:e.storage.retrieveString(ER),treatmentId:null!==(t=Je(e,_v.SearchLandingPage))&&void 0!==t?t:null}},"pullOnly")
return n.refreshUrl=`${Oz}:/${_z.searchLandingPage}/${_z.shelf}/?${Hz.isSearchFocusHeaderShelf}=true`,n}function _g(e,t,n){mg(e,t,n)
const r=new dJ(n.shelves)
return o(r.shelves)?null:(ui(e,r,n.metricsPageInformation),r)}async function xg(e,t){const n=new bv.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await ph(r,t)
return null===o?pg(e,t.facets):await async function(e,t){return await hg(e,t)}(r,o)}async function Lg(e,t){return await async function(e,t){return await Iv.context("paginatedSearchResultsPageWithToken",async()=>{const n=cg(0,t),r=lg(0,t)
return 0===n.length?await Promise.resolve(pg(e)):await hh(e,n).then(async n=>{const o=V(n),s={id:C$,kind:null,softwareType:null,targetType:IG,title:PN,pageInformation:t.metricsOptions.pageInformation,locationTracker:t.metricsOptions.locationTracker,idType:gB},a=new oJ(uL)
return a.id=ug(),a.isHorizontal=!1,Bf(e,a,s),kf(0,s,PN),_f(s.locationTracker,t.contentOffsetWithinResultsShelf),await ig(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(n=>{const o=Lw(e,s),c=function(e,t,n,r,o=0){let i=function(e){const t=e.bag.searchResultsLearnMoreEditorialId
!(0,kv.isNothing)(t)&&(null==t||t.length)}(e)
const s=n.builtSearchResults.length,a=n.deferredSearchResults.length>0,c=o+s
if(void 0===i||void 0===t||o>=i||a&&c<i||0===c&&!a)return r.items=n.builtSearchResults,[r]
i-=o,r.items=n.builtSearchResults.slice(0,i)
const l=new oJ("searchResultsLearnMoreNotice")
l.isHorizontal=!1
const u=new OZ(t)
l.items=[u]
const d=[r,l],f=n.builtSearchResults.slice(i)
if(f.length>0){const e=new oJ(uL)
e.impressionMetrics=r.impressionMetrics,e.isHorizontal=!1,e.items=f,d.push(e)}return d}(e,o,n,a,t.contentOffsetWithinResultsShelf),l=new uZ(c)
return i(r)&&(r.contentOffsetWithinResultsShelf=Rf(s.locationTracker),l.nextPage=r),l.isCondensedSearchLockupsEnabled=e.client.isPhone,l.resultsParentImpressionMetrics=a.impressionMetrics,Ef(t.metricsOptions.locationTracker),l.searchClearAction=gg(e,wU,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l.searchCancelAction=gg(e,cG,t.metricsOptions.pageInformation,t.metricsOptions.locationTracker,t.requestMetadata.requestDescriptor.term),l})})})}(e,t)}function Mg(e){return N(e)}function $g(e){const t=[lH,oH,eN,eV,iD,sD,aD,NU,Uj,yM]
return e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}function Fg(e,t,n){var r,o
t.includingAgeRestrictions().includingAdditionalPlatforms(Mg(e)).includingAttributes($g(e)).includingScopedAttributes(sG,[NU]).includingScopedRelationships(OH,[Yj,hL]).includingScopedRelationships(sG,[hL]).enablingFeature("editorialItemGroups").usingCustomAttributes(Ze(e)).includingRelationshipsForUpsell(!0),n&&(t.includingAssociateKeys(sG,[jj,MG]),t.includingAssociateKeys(OH,[MG])),$i(e)&&(t.enablingFeature(PV),t.addingQuery(WG,CM),t.includingScopedRelationships(DH,[SH]),t.includingScopedAttributes(DH,eQ)),Ni(e)&&(t.enablingFeature(cN),n&&t.includingKindsKeys(Aj,[QL])),Fo(e)&&t.enablingFeature("eiGroupEISelectionOnDevice"),Dn(e,PH)&&t.enablingFeature("adSupport"),t.enablingFeature("heroStyles")
const i=null!==(o=null===(r=e.userDefaults)||void 0===r?void 0:r.bool(UT))&&void 0!==o&&o
e.bag.enableDeviceDrivenDiscoveryContent&&i&&t.resourceType===PH&&t.addingQuery("pairedDevices","visionPro")}async function Ng(e,t){const n=e.required(G4),i=t.url===Ny,a=-1!==t.url.indexOf(_z.todayCardPreview)
if(i)return await n.fetchPage(e,t.url,HJ)
if(a){const r=oY.from(t.url)
return r.param(Hz.fetchData,FV),await n.fetchPage(e,r.build(),HJ)}{const n=function(e){return dl(e,new wJ(e).forType(PH).withSparseCount(1).withSparseLimit(2))}(e)
Fg(e,n,!0)
const i=(0,kv.isSome)(t.experimentIdHeader)?{"X-Apple-User-Experiment-Ids":t.experimentIdHeader}:void 0
return await async function(e,t,n,i){var a
const c=new Pm.FetchTimingMetricsBuilder,u=e.addingFetchTimingMetricsBuilder(c),d=Jn(u,t,{headers:null!=n?n:void 0})
d.then(t=>{Dn(e,PH)&&function(e,t){const n=Ln(e,t,!0)
r(n)||(e.ads.setTimeoutForCurrentOnDeviceAdFetch(t,n),function(e,t,n){e.timeoutManager.setTimeout(t,n)}(e,n,C3))}(e,PH),oc(e,e.user.dsid,t)})
const p=D(d),h=function(e,t){const n={}
if(s(t)){const r=new wJ(e).withIdsOfType(t,OH).includingAdditionalPlatforms(Mg(e)).includingAttributes($g(e))
n[Im.OnboardingCards]=R(Jn(e,r,{}))}Dn(e,PH)&&(n[Im.Ads]=R(ww(e,PH))),function(e){const t=lo(e),n=Rt(e,e.bag.todayTabArcadePersonalizationRate)
return t&&n}(e)&&(n[Im.ODP]=R(async function(e,t){return await async function(e,t,n,r){const o=[t,e.timeoutManager.makePromise(r,void 0)]
return await Promise.race(o).then(e=>e)}(e,async function(e){try{const t=await async function(e,t){if(o(t.user.dsid)){const e=`${k3}: User is currently not signed in.`
throw Iv.unexpectedType(dV,e,null),new Error(e)}try{const n=l((await t.onDeviceRecommendationsManager.performRequest({type:"fetchUseCases",tab:e,dsId:t.user.dsid})).useCases)
if(o(n)){const t=`${k3}: ODP returned no use cases for tab: ${e}`
throw Iv.unexpectedType(dV,t,null),new Error(t)}return n}catch(t){const n=`${k3}: Failed to fetch ODP use cases for tab: ${e}, with error: ${t}`
throw Iv.unexpectedType(dV,n,null),new Error(n)}}(PH,e),n=t.map(async t=>await async function(e,t){try{const n=await async function(e,t){if(o(t.user.dsid))throw new Error(`${k3}: User is currently not signed in.`)
try{return await t.onDeviceRecommendationsManager.performRequest({type:wS,dsId:t.user.dsid,useCase:e})}catch(t){const n=`${k3}: Failed to perform ODP Today recommendation for useCase: ${e}, with error: ${t}`
throw Iv.unexpectedType(dV,n,null),new Error(n)}}(t,e),i=await async function(e,t){const n=l(t[gS])
if(o(n)){const t=`${k3}: ODP returned no candidates for useCase: ${e}`
throw Iv.unexpectedType(dV,t,null),new Error(t)}const i=y(t[eG]),a=n.map(e=>function(e){const t=f(e.id),n=f(e.type)
if(r(t))return
let o,i=[]
switch(n){case FE:i=l(e.candidates).map(e=>f(e.id)).filter(e=>(0,kv.isSome)(e)),o=sG
break
case zU:o=OH
break
default:return}let a=[]
if(a.push({id:t,type:o}),s(i)){const e=i.map(e=>({id:e,type:OH}))
a=a.concat(e)}return new R3(t,o,i,a)}(e)).filter(kv.isSome)
if(r(i)||o(a)){const t=`${k3}: ODP candidates could not be parsed for useCase: ${e}`
throw Iv.unexpectedType(dV,t,null),new Error(t)}return{candidates:a,metrics:i}}(t,n),a=i.metrics,c=i.candidates
if(0===c.length)return
const u=c[0],d=await async function(e,t,n,r){const o=new wJ(r,t.data,!0).addingQuery(Hz.onDevicePersonalizationUseCase,e).addingQuery(Hz.filterRecommendable,FV)
Gr(r,o)
try{const i=await Jn(r,o)
return new E3(e,[t],n,i)}catch(e){const n=`${k3}: Failed to fetch Media API data for: ${t.data}, with error: ${e}`
throw Iv.unexpectedType(dV,n,null),new Error(n)}}(t,u,a,e)
return d}catch(n){return void e.console.log(`${k3}: Failed to perform ODP Today recommendation for useCase: ${t}, with error: ${n}`)}}(e,t)),i=(await _(n)).map(e=>e.success?e.value:void 0).filter(kv.isSome)
return new O3(i)}catch(t){return void e.console.log(`${k3}: Failed to perform ODP for Today recommendations: ${t}`)}}(e),0,C3)}(e)))
const i=e.amsEngagement
if(i&&Fo(e)){const e={timeout:1e3,eventType:YX,tab:PH}
n[Im.AMDData]=R(i.performRequest(e))}return n}(e,null!==(a=null==i?void 0:i.onboardingCardIds)&&void 0!==a?a:[]),w=await ac(e,p,h)
return c.measureModelConstruction(()=>{var t,n
const r=V(w.additionalData[Im.OnboardingCards]),i=w.additionalData[Im.Ads],s=w.additionalData[Im.ODP],a=w.additionalData[Im.AMDData],c=function(e,t,n,r,i){const s=[]
let a=o(r)
const c=Bo(e,t)
let u=0
for(const i of t){if(o(i.contents))continue
const t=co(e,PH,i.contents,!0,c)
i.contents=t.personalizedData,i.onDevicePersonalizationProcessingType=t.processingType
let d=!0
const p={label:i.label,title:i.title,meta:i.meta,date:i.date,onDevicePersonalizationProcessingType:i.onDevicePersonalizationProcessingType,isTodayForAppsModule:H(i)}
if(!a){for(const e of r)s.push({type:wm.EditorialItem,data:e,isDataHydrated:le(e),isFirstItemInModule:d,moduleMetadata:{...p},containedAdSlots:[u]})
d=!1,a=!0,u+=1}for(let t of i.contents){const r=f(t,"meta.personalizationData.onDeviceUseCase")
switch(t.type){case OH:if((0,kv.isSome)(r)){const e=null==n?void 0:n.storyData(r);(0,kv.isSome)(e)&&(t=e)}s.push({type:wm.EditorialItem,data:t,isDataHydrated:le(t),isFirstItemInModule:d,moduleMetadata:{...p},containedAdSlots:[u]}),d=!1,u+=1
break
case sG:const a=l(t,cD)
if(o(a))continue
let f
if((0,kv.isSome)(r)&&(f=null==n?void 0:n.storyGroupData(r)),(0,kv.isSome)(f))t=f
else{const n=co(e,PH,a,!0,c)
t[WG].associations[jj][wG]=n.personalizedData,i.onDevicePersonalizationProcessingType=n.processingType}s.push({type:wm.EditorialItemGroup,data:t,isDataHydrated:le(t),isFirstItemInModule:d,moduleMetadata:{...p},containedAdSlots:Array.from({length:a.length},(e,t)=>t+u)}),d=!1,u+=a.length}}}return s}(e,null!==(n=null===(t=w.primaryPageData.results)||void 0===t?void 0:t.data)&&void 0!==n?n:[],s,r)
return Bg(u,c,w.primaryPageData,i,a)})}(e,n,i,t)}}function Bg(e,t,n,r,i){return Iv.context(aG,()=>{if(o(t))return null
const a=function(e,t,n,r,o){var i,a,c
const u=ci(e,"Today",PH,n,null,null!==(i=Nn(e,PH,r,t))&&void 0!==i?i:si(e,PH,n,null===(a=null==r?void 0:r.onDeviceAd)||void 0===a?void 0:a.positionInfo,t)),d=fo(e)
u.recoMetricsData=Pf(u.recoMetricsData,null,d)
const f=new dQ(t,u,{rootPosition:0,locationStack:[]},tr(n),$o(0,o))
if(Dn(e,PH)){const n=jn(e,PH);(0,kv.isSome)(n)&&(f.eligibleAdLocations=n.map(e=>e.slot))
const o=po(0,u.iAdInfo)
if(go(e,o,r),f.adIncidentRecorder=o,f.adPlacementBehavior=function(e){let t=Vv.insertIntoShelf
for(const n of e){let e=t
switch(n.type){case wm.EditorialItem:e=Vg(n.data)
break
case wm.EditorialItemGroup:const t=l(n.data,cD)
if(s(t))for(const n of t)if(e=Vg(n),e!==Vv.insertIntoShelf)break}if(e!==Vv.insertIntoShelf){t=e
break}}return t}(t),(0,kv.isNothing)(null==r?void 0:r.failureReason)){f.adData=j(e,null==r?void 0:r.mediaResponse)
const t=null===(c=null==r?void 0:r.onDeviceAd)||void 0===c?void 0:c.positionInfo
if(s(t)){const e=t.slot-1
f.adLocation=e}}}return f}(e,t,n,r,i),c=Ug(e,a)
return c.shelves.splice(0,0,Sc(0,"todayPageHeader")),c})}function Ug(e,t){var n
const r=[],o=function(e,t){switch(e.client.buildType){case $U:case LB:const e=new oY
e.protocol=Ez,e.host=SB,e.pathname=`/${_z.todayCardPreview}`
const n=[]
for(const e of t)switch(e.type){case wm.EditorialItem:n.push(e.data.id)
break
case wm.EditorialItemGroup:const t=l(e.data.meta,lD)
n.push(`${e.data.id}:[${t.map(e=>e.id).join(",")}]`)}return e.param(Hz.ids,n.join(",")),e.param(Hz.isTodayFeedPreview,FV),decodeURIComponent(e.build())
default:return null}}(e,t.remainingContent)
let a=No(t.remainingContent)
const c=null===(n=t.remainingContent[0])||void 0===n?void 0:n.isFirstItemInModule
for(;a;){const n=t.remainingContent.shift()
if((0,kv.isNothing)(n)){a=!1
break}const o=Ko(e,t);(0,kv.isSome)(o)&&r.push(o),t.currentTodayItem=n
let i=null
switch(n.type){case wm.EditorialItem:i=Wo(e,n,t)
break
case wm.EditorialItemGroup:i=zo(e,n,t)}t.currentTodayItem=void 0,(0,kv.isSome)(i)&&r.push(i)
const s=Ko(e,t);(0,kv.isSome)(s)&&r.push(s),a=No(t.remainingContent)}c&&$n(e,r,PH,PH,t.pageInformation)
const u=new HJ(r),d=e.bag.tabsStandard.find(e=>e.id===PH),p=f(d,hH),h=f(d,"image-identifier"),w=(0,kv.isNothing)(h)||"doc.text.image"===h,g=null!=p?p:e.loc.string("PAGE_TITLE_TODAY")
return u.title=g,u.tabTitle=g,u.titleDetail=w?function(e){const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat")
return e.loc.formatDate(n,t)}(e):void 0,u.shortTitleDetail=w?function(e){const t=new Date
return e.loc.formatDate("MMM d",t)}(e):void 0,u.longTitle=w?function(e){if(!e.client.isPad)return
const t=new Date,n=e.loc.string("Today.ShelfTitle.DateFormat.IPad")
return e.loc.formatDate(n,t)}(e):void 0,u.feedPreviewUrl=o,s(t.remainingContent)?(t.pageHasDisplayedContent=t.pageHasDisplayedContent||r.some(e=>{s(e.items)}),u.nextPage=t):function(e,t,n){const r=[],o=Tc(e)
i(o)&&r.push(o)
const s=e.bag.termsAndConditionsURL
if(i(s)){const t=bc(e,s)
r.push(t)}return r}(e,t.pageInformation,t.locationTracker).forEach(e=>{u.shelves.push(e)}),Dn(e,PH)&&(u.adIncidents=ho(0,t.adIncidentRecorder)),ui(e,u,t.pageInformation),u}async function Gg(e,t){const n=t.pageHasDisplayedContent?6:12
let r=!0,o=0,i=[]
for(;r;){const e=t.remainingContent[o]
switch(e.type){case wm.EditorialItem:i.push(e.data)
break
case wm.EditorialItemGroup:i.push(e.data)
const t=l(e.data,cD)
i=[...i,...t]}o++,r=i.length<n&&o<t.remainingContent.length}const s=new Set(i.map(e=>e.id)),a=new wJ(e,i,!0,[jj,MG])
Fg(e,a,!1)
const c=await Jn(e,a,{allowEmptyDataResponse:!0}),u={}
for(const e of c.data)u[e.id]=e
for(const e of t.remainingContent)jg(e,u)
return t.remainingContent=t.remainingContent.filter(e=>e.isDataHydrated||!s.has(e.data.id)),t}function jg(e,t){var n,r,o
switch(e.type){case wm.EditorialItem:s(t[e.data.id])&&(e.data={...e.data,...t[e.data.id]}),e.isDataHydrated=le(e.data)
break
case wm.EditorialItemGroup:s(t[e.data.id])&&(e.data={...e.data,attributes:null===(n=t[e.data.id])||void 0===n?void 0:n.attributes,relationships:null===(r=t[e.data.id])||void 0===r?void 0:r.relationships,meta:{...e.data.meta,...null===(o=t[e.data.id])||void 0===o?void 0:o.meta}}),e.isDataHydrated=le(e.data)}}function Vg(e){const t=v(e,gI)
return i(t)&&t?Vv.replaceOrganic:i(t)&&!t?Vv.dropAd:Vv.insertIntoShelf}function Hg(e,t){if(i(t.iAdInfo)){const n=y(t.iAdInfo)
s(n)&&(t.iAdInfo=QX.from(e,n))}}function qg(e,t,n,r,o){return Iv.context(oA,()=>Du(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:1}))}function Wg(e,t,n,o,i,s){return Iv.context("topChartsPageFromApiResponse",()=>{var a
const c=[]
if((0,Cv.isSome)(o))for(const t of o.categories)(0,Cv.isSome)(t.genreId)&&c.push(zg(e,t))
const u=function(e){return l(e,"results.apps").filter(e=>!r(e.data))}(t),d=u.map(r=>function(e,t,n,r,o){return Iv.context("segmentFromData",()=>{const{shortName:i,longName:s}=function(e,t,n){const r=f(t,$V)
let o=f(t,"shortName"),i=f(t,GH)
if(2!==n)return{shortName:(0,Cv.unsafeUnwrapOptional)(o),longName:(0,Cv.unsafeUnwrapOptional)(i)}
const s=e.client.isPad
switch(r){case"top-free":s?(o=e.loc.string("TopCharts.iPadGames.Free.ShortName"),i=e.loc.string("TopCharts.iPadGames.Free.LongName")):(o=e.loc.string("TopCharts.Games.Free.ShortName"),i=e.loc.string("TopCharts.Games.Free.LongName"))
break
case"top-paid":s?(o=e.loc.string("TopCharts.iPadGames.Paid.ShortName"),i=e.loc.string("TopCharts.iPadGames.Paid.LongName")):(o=e.loc.string("TopCharts.Games.Paid.ShortName"),i=e.loc.string("TopCharts.Games.Paid.LongName"))}return{shortName:(0,Cv.unsafeUnwrapOptional)(o),longName:(0,Cv.unsafeUnwrapOptional)(i)}}(e,t,o),a=f(t,$V),c=ci(e,"TopChartsPage",r,n,`${a} ${s}`),l={rootPosition:0,locationStack:[]},u=[]
let d=0
const p=[]
for(const n of t.data){const t=qg(e,d,n,c,l)
if(t){if(vt(e,n,68606))continue
u.push(t),xf(l),d++}else p.push(n)}const h=[],w=new oJ(eH)
w.items=u,e.featureFlags.isEnabled("shelves_2_0_top_charts"),w.title=s,h.push(w)
const g=new c8(i,s,a,h),v=function(e,t,n,r=null,o,i){return{remainingContent:t,maxPerPage:20,highestOrdinal:0,url:n,metricsPageInformation:o,metricsLocationTracker:i}}(0,p,void 0,t.next,c,l)
return v.metricsPageInformation=c,v.metricsLocationTracker=l,v.highestOrdinal=d,g.nextPage=v,ui(e,g,c),g})}(e,r,t,n,s)).sort((e,t)=>e.chart.localeCompare(t.chart)),p=f(u,"0.href"),h=new oY(p),w=null!==(a=h.query[Xj])&&void 0!==a?a:n,g=Yg(w,h.query[xF],c),v=function(e,t){return t.every(e=>function(e){switch(e){case"top-trending-free":case"top-trending-paid":return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_TRENDING_CHARTS"):t.every(e=>function(e){switch(e){case"top-emerging-free":case"top-emerging-paid":return!0
default:return!1}}(e.chart))?e.loc.string("PAGE_TITLE_EMERGING_CHARTS"):e.loc.string("PAGE_TITLE_TOP_CHARTS")}(e,d),m=new u8(w,null==g?void 0:g.ageBandId,v,d,null==g?void 0:g.name,c),y=d.findIndex(e=>e.chart===i)
y>=0&&(m.initialSegmentIndex=y)
const A=e.fetchTimingMetricsBuilder
return(0,Cv.isSome)(A)&&A.decorate(m),m})}function zg(e,t){const n=function(e,t,n=null){let r=new wJ(e).forType(L$).addingQuery(M$,BH).addingQuery(Xj,t).includingMacOSCompatibleIOSAppsWhenSupported(!0)
return n&&(r=r.addingQuery(xF,n)),e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([aH,iH])),r}(e,t.genreId,t.ageBandId),r=t.children.map(t=>zg(e,t))
return new l8(t,at(e,n).toString(),r)}function Yg(e,t,n){for(const r of n){if(t&&r.ageBandId===t||!t&&!r.ageBandId&&r.genreId===e)return r
const n=Yg(e,t,r.children)
if(n)return n}return null}async function Jg(e,t){const n=Zg().map(e=>new sY(e)),i=new oY(t),s=n.find(e=>e.matches(i)).extractParameters(i),a=i.query[Hz.genre]||s[Hz.genre],c=i.query[Hz.chart]||s[Hz.chart],l=i.query[Hz.charts],u=i.query[Hz.ages]
return await async function(e,t,n,i,s){if(o(n)){const e=dc(0,i)
n=void 0!==e?`${i},${e}`:i}else n.includes(i)||(n+=`,${i}`)
const a=new bv.FetchTimingMetricsBuilder,c=e.addingFetchTimingMetricsBuilder(a),l=fc(c,t,n,s)
let u
return u=pc(e,n,t),await Promise.all([l,u]).then(([n,o])=>a.measureModelConstruction(()=>{const s=Wn(e,o),a=r(s)?Vn(t):Hn(s)
return Wg(c,n,t,s,i,a)}))}(e,a,l,c,u)}async function Kg(e,t){const n=bt(0,t)
if(0===n.length)return await Promise.resolve(new c8(null,null,null,[]))
let r=new wJ(e,n).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ze(e))
return e.appleSilicon.isSupportEnabled&&(r=r.includingAdditionalPlatforms([aH,iH])),await Jn(e,r).then(n=>{const r=St(0,t)
return Qg(e,n,t,r)})}function Zg(e){return[{path:`/{apiVersion}/catalog/{countryCode}/${_z.charts}`,query:[`${Hz.genre}`,`${Hz.isPPT}?`,`${Hz.charts}?`]},{path:`/{countryCode}/${_z.charts}/{platform}/{chartType}/{genre}`,query:[`${Hz.chart}`]},{path:`/{countryCode}/${_z.charts}/{platform}/{chart}/{genre}`,query:[`${Hz.charts}?`]},{path:`/{countryCode}/${_z.charts}/{platform}`},{path:`/{countryCode}/{platform}/${_z.charts}`},{path:`/{countryCode}/{platform}/${_z.charts}/{genre}`}]}function Qg(e,t,n,r){return Iv.context("topChartSegmentFromLookupResponse",()=>{const o=[]
let i=n.highestOrdinal
const s=V(t)
for(const t of s)vt(e,t,68606)||(o.push(Xg(e,i,t,n.metricsPageInformation,n.metricsLocationTracker)),xf(n.metricsLocationTracker),i++)
const a=[]
if(o.length>0){const e=new oJ(eH)
e.items=o,a.push(e),r.highestOrdinal=i}const c=new c8(null,null,null,a)
return c.nextPage=r,c})}function Xg(e,t,n,r,o){return Iv.context(oA,()=>Du(e,n,{ordinal:e.loc.decimal(t+1),metricsOptions:{pageInformation:r,locationTracker:o},artworkUseCase:1}))}function ev(e,t){const n=Bo(e,[t])
if(i(t.contents)){const r=co(e,"todayWidget",t.contents,!0,n)
t.contents=r.personalizedData}return t}function tv(e,t,n,r,s,a){const c=[]
let l=0,u=0,d=0
for(const a of t.contents){if(ue(a)){l++
continue}const t=Ae(a,sV),f=av(e,a,n,r),p=null===f?ov(e,t):[],h=sv(a),w=[null==f?void 0:f.backgroundColor,1===p.length&&null!==p[0]?p[0].backgroundColor:void 0,z("1C68E2")].find(e=>void 0!==e)
if(0===p.length&&null===f){u++
continue}const g=nv(e,a,r)
let v=null,m=null,y=null
if(t.length>0&&t[0].type===DH){const e=ie(t[0],jL)
if(o(e)){d++
continue}y=ie(t[0],HL),v=new Date(e)
const n=ie(t[0],VL)
m=i(n)?new Date(n):null}const A=is(a)
c.push(new g8(a.id,g,h,w,K(w),p,rv(e,a,n,g,s),A===dD,f,y,v,m))}return null!==a&&t.contents.length===l+u+d&&a(`All ${t.contents.length} cards in this ${r?"primary":"secondary"} module were filtered due to being unhydrated (${l}), missing artwork (${u}) or missing metadata (${d})`),c}function nv(e,t,n){let r=ie(t,CV)
if(!n){const n=is(t)
switch(n){case am.AppOfTheDay:case am.GameOfTheDay:r=Do(e,t,n,null)}}return r.replace(/\n/g," ")}function rv(e,t,n,r,i){let a
switch(n){case SF:a=0
break
case bI:a=1
break
case fD:a=2
break
default:a=-1}const c={widgetId:i,size:a,targetId:t.id,name:r},l=encodeURIComponent(JSON.stringify(c))
switch(Hu(0,t)){case 4:const n=Ae(t,Yj),r=s(n)&&1===n.length?n[0]:Ae(t,sV)[0],i=ye(e,r,SH)
if(o(i))break
return`${Oz}:/${_z.product}/${Hz.id}${i.id}?${Hz.appEventId}=${r.id}${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${l}`
case 3:const a=Ae(t,sV)[0]
return`${Oz}:/${_z.product}/${Hz.id}${a.id}?${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${l}`
case 1:return f(ne(t,uH),AH)}return`${Oz}:/${_z.story}/${Hz.id}${t.id}?${Hz.invalidateWidgetsOnFailure}=true&${Hz.metrics}=${l}`}function ov(e,t){return t.map(t=>{if(t.type===kV)return null
if(cd(e,t)){const n=function(e,t){switch(yn(e,t)){case"com.apple.AppStore.BridgeStoreExtension":return TA
case"com.apple.MobileSMS":return null
default:return Zj}}(e,t)
if((0,kv.isSome)(n)){const r=iv(e,t,n)
if((0,kv.isSome)(r))return nd(e,r,{cropCode:"bb",useCase:25,allowingTransparency:!0,withJoeColorPlaceholder:!0})}}const n=function(e,t){switch(yn(e,t)){case"com.apple.AppStore.BridgeStoreExtension":return Wk
case"com.apple.MobileSMS":return zk
default:return _H}}(e,t),r=iv(e,t,n),o=function(e,t){const n=yn(e,t),r=ad(e)
let o
switch(n){case"com.apple.AppStore.BridgeStoreExtension":o=r?"ic":"bb"
break
case"com.apple.MobileSMS":o="bb"
break
default:o=r?"ia":"bb"}return o}(e,t)
return nd(e,r,{cropCode:o,useCase:25,allowingTransparency:!0,withJoeColorPlaceholder:!0})}).filter(e=>null!==e)}function iv(e,t,n){return ze(e,t,Qe(e,t),n)}function sv(e){var t
const n=ne(e,rj)
let r=null
s(n)&&(r=f(n,GH))
let o=null
const i=Ae(e,sV)
switch(i.length>0&&(o=ie(i[0],GH)),ie(e,tV)){case am.AppOfTheDay:case am.GameOfTheDay:return null!==(t=null!=o?o:r)&&void 0!==t?t:""
default:return null!=r?r:""}}function av(e,t,n,r,o){let i=null
is(t)===dD&&(i=function(e,t,n,r){let o=null,i=null
const s=["editorialVideo.storyCardMotion16x9.previewFrame","editorialVideo.storyCenteredMotion16x9.previewFrame","editorialVideo.storeFrontVideo4x3.previewFrame"]
for(const e of s)if(i=ne(t,e),(0,kv.isSome)(i))break
return i&&(o=nd(e,i,{withJoeColorPlaceholder:!0,useCase:26}),r||(o.crop="sr")),o}(e,t,0,r))
const s=[{artworkKeyPath:yI,crop:"sr"},{artworkKeyPath:pL,crop:"sr"}]
switch(is(t)){case am.AppOfTheDay:case am.GameOfTheDay:const e=n===SF?SI:"nr"
s.push({artworkKeyPath:tD,crop:r?e:"fn"})
break
case am.Video:case am.FullBleedImage:const t=n===SF?PI:II
s.push({artworkKeyPath:ex,crop:r?t:"fn"})
break
case am.AppEventCard:const o=n===SF?SI:"nr"
s.push({artworkKeyPath:nD,crop:r?o:"fn"})
break
default:const i=n===SF?PI:II
s.push({artworkKeyPath:rD,crop:r?i:"fn"})}let a=null
for(const n of s)if(a=nd(e,ne(t,n.artworkKeyPath),{cropCode:n.crop,useCase:26,withJoeColorPlaceholder:!0}),(0,kv.isSome)(a))break
return null!=a?a:i}async function cv(e,t){let n
switch(t.family){case 1:n=bI
break
case 2:n=fD
break
default:n=SF}let a=null
return typeof t.originalResponseHash!==rB&&null!==t.originalResponseHash&&""!==t.originalResponseHash&&typeof t.originalResponseDate!==rB&&null!==t.originalResponseDate&&""!==t.originalResponseDate&&(a={hash:t.originalResponseHash,creationDate:t.originalResponseDate}),await async function(e,t,n,a,c){return await new Promise((n,l)=>{if(!function(e,t,n,r){return!r||Rt(e,e.bag.todayWidgetLivePreviewRolloutRate)}(e,0,0,a))return void l("No live preview will be shown due to losing the todayWidgetLivePreviewRolloutRate lottery.")
const u=new m8,d=e=>l(e)
Jn(e,u.make(e)).then(a=>{const l=p(a,sm.contentMaxAge),u=function(e,t){return r(e)||r(e.results)||o(e.results.data)?(t("Unable to create primary module; no results or data."),null):o(e.results.data[0].contents)?(t("Unable to create primary module; no contents."),null):e.results.data[0].contents.length===e.results.data[0].contents.filter(e=>ue(e)).length?(t("Unable to create primary module; none of the cards are hydrated."),null):{label:"",title:"",meta:{},contents:e.results.data[0].contents}}(a,d)
if(null===u)return
const f=function(e){const t={label:"",title:"",meta:{},contents:[]}
if(r(e)||r(e.results)||o(e.results.data))return t
const n=e.results.data.slice(1)
return 0===n.length?t:{label:"",title:"",meta:{},contents:n.map(e=>e.contents).reduce((e,t)=>e.concat(t))}}(a),h=function(t,n,r,o,i){const a=(c=JSON.stringify(t.contents.concat(n.contents).map(e=>e.id))+(null!==r?r.toString():""),e.cryptography.hash("sha256",c))
var c
return null!==i&&s(i.hash)&&s(i.creationDate)&&i.hash===a?i:{hash:a,creationDate:(new Date).toUTCString()}}(u,f,l,0,c),w=function(e,t,n){null===n&&e.console.error("No TTL value was found--deferring to JS client for refresh time.")
const r=new Date(t.creationDate)
return r.setSeconds(r.getSeconds()+n),e.console.info(`Media API provided TTL: ${n} so timeline refresh date will be ${r}`),r}(e,h,l),g=ev(e,u),v=ev(e,f),m=function(e,t,n,s,a,c,l,u,d){if(r(t))return d("Unable to create a TodayWidgetContainer; primaryModule is null."),null
const f=tv(e,t,s,!0,u,d)
if(0===f.length)return null
const p=tv(e,n,s,!1,u,null),h=function(e,t,n,r,s,a){const c=ft(t),l=ht(c,n),u={}
for(let e=0;e<r.length;e++){const t=e%r.length*2
u[r[e].storyId]=a===fD?s.slice(t,t+2):[]}const d=function(e,t,n){return function(e,r){const o=[],i=[]
return e.forEach(e=>{return void 0!==(r=e).eventStartDate&&null!==r.eventStartDate&&t<ft(r.eventStartDate)&&ft(r.eventStartDate)<=n?o.push(e):i.push(e)
var r}),[o,i]}(e)}(r,c,n),f=d[0]
let p=d[1]
const h=[...Array(l)].map(()=>[]),w=[...Array(l)].map((e,t)=>new Date(c.getTime()+60*t*60*1e3)),g=new Map
r.concat(s).forEach(t=>{if(i(t.eventStartDate)){const n=Yi(t.eventBadgeKind,t.eventStartDate,t.eventEndDate)
g[t.storyId]=Ji(e,n,t.eventStartDate,t.eventEndDate)}}),f.forEach(e=>{var t
for(let n=((ht(c,e.eventStartDate)-1)%(t=r.length)+t)%t;n<h.length&&!(e.eventEndDate<=w[n]);n+=r.length)for(let t=0;t<r.length&&!(h.length<=n+t);t++)if(0===h[n+t].length){h[n+t].push(b(e))
for(const r of u[e.storyId])h[n+t].push(b(r))
break}})
for(let e=0;e<h.length;e++){if(h[e].length>0)continue
const t=w[e]
if(p=p.filter(e=>void 0===e.eventEndDate||null===e.eventEndDate||e.eventEndDate>t),0===p.length)break
const n=p.shift()
p.push(n),h[e].push(b(n))
for(const t of u[n.storyId])h[e].push(b(t))}return h.map((e,t)=>{const n=w[t],r=e.map(e=>{const n=g[e.storyId],r=function(e,t){if(o(t))return null
const n=t.filter(t=>null===t.displayFromDate||t.displayFromDate<=e)
return 0===n.length?null:n.pop()}(w[t],n)
return null!==r?(e.heading=r.displayText,e.eventStartDate=r.countdownToDate):e.eventStartDate=null,e})
return new w8(r,n)})}(e,new Date(c.creationDate),l,f,p,s)
return new h8(h,l,c.creationDate,c.hash)}(e,g,v,t,0,h,w,TI,d)
null!==m&&n(m)}).catch(e=>{l(e)})})}(e,n,t.isSnapshot,t.isPreview,a)}function lv(e){return Je(e,_v.ArcadeDownloadPackOnboarding)||km.LayoutB}var uv,dv,fv,pv,hv,wv,gv,vv,mv,yv,Av,Tv,bv,Sv,Pv,Iv,Cv,kv,Ov,Ev,Rv,Dv,_v,xv,Lv,Mv,$v,Fv,Nv,Bv,Uv,Gv,jv,Vv,Hv,qv,Wv,zv,Yv,Jv,Kv,Zv,Qv,Xv,em,tm,nm,rm,om,im,sm,am,cm,lm,um,dm,fm,pm,hm,wm,gm,vm,mm,ym,Am,Tm,bm,Sm,Pm,Im,Cm,km,Om,Em,Rm,Dm,_m={}
e.r(_m),e.d(_m,{downloadingOrdering:()=>w0,downloadingOrderingCompact:()=>g0,notPurchasedOrdering:()=>p0,notPurchasedOrderingCompact:()=>h0,notPurchasedSpotlightIndex:()=>u0,purchasedOrdering:()=>d0,purchasedOrderingCompact:()=>f0,purchasedSpotlightIndex:()=>l0}),uv={},e.r(uv),e.d(uv,{downloadingOrdering:()=>S0,downloadingOrderingCompact:()=>P0,notPurchasedOrdering:()=>T0,notPurchasedOrderingCompact:()=>b0,notPurchasedSpotlightIndex:()=>m0,purchasedOrdering:()=>y0,purchasedOrderingCompact:()=>A0,purchasedSpotlightIndex:()=>v0}),dv={},e.r(dv),e.d(dv,{notPurchasedOrdering:()=>O0,notPurchasedSpotlightIndex:()=>C0,purchasedOrdering:()=>k0,purchasedSpotlightIndex:()=>I0}),fv={},e.r(fv),e.d(fv,{notPurchasedOrdering:()=>_0,notPurchasedSpotlightIndex:()=>R0,purchasedOrdering:()=>D0,purchasedSpotlightIndex:()=>E0}),pv={},e.r(pv),e.d(pv,{notPurchasedOrdering:()=>$0,notPurchasedSpotlightIndex:()=>L0,purchasedOrdering:()=>M0,purchasedSpotlightIndex:()=>x0}),hv={},e.r(hv),e.d(hv,{notPurchasedOrdering:()=>U0,notPurchasedSpotlightIndex:()=>N0,purchasedOrdering:()=>B0,purchasedSpotlightIndex:()=>F0}),wv={},e.r(wv),e.d(wv,{notPurchasedOrdering:()=>H0,notPurchasedSpotlightIndex:()=>j0,purchasedOrdering:()=>V0,purchasedSpotlightIndex:()=>G0}),gv={},e.r(gv),e.d(gv,{notPurchasedOrdering:()=>Y0,notPurchasedSpotlightIndex:()=>W0,purchasedOrdering:()=>z0,purchasedSpotlightIndex:()=>q0}),vv={},e.r(vv),e.d(vv,{notPurchasedOrdering:()=>Q0,notPurchasedSpotlightIndex:()=>K0,purchasedOrdering:()=>Z0,purchasedSpotlightIndex:()=>J0}),mv={},e.r(mv),e.d(mv,{downloadingOrdering:()=>i1,downloadingOrderingCompact:()=>s1,notPurchasedOrdering:()=>r1,notPurchasedOrderingCompact:()=>o1,notPurchasedSpotlightIndex:()=>e1,purchasedOrdering:()=>t1,purchasedOrderingCompact:()=>n1,purchasedSpotlightIndex:()=>X0}),yv={},e.r(yv),e.d(yv,{downloadingOrdering:()=>p1,downloadingOrderingCompact:()=>h1,notPurchasedOrdering:()=>d1,notPurchasedOrderingCompact:()=>f1,notPurchasedSpotlightIndex:()=>c1,purchasedOrdering:()=>l1,purchasedOrderingCompact:()=>u1,purchasedSpotlightIndex:()=>a1})
const xm="arcadeGeneric",Lm="arcadeGroupingLockup",Mm="tapToRate",$m="lockupList",Fm="TabChangeAction",Nm="expanded",Bm="GameCenterInvitePlayerAction",Um="continuation",Gm="signup",jm="purchases",Vm="donate",Hm="is32bitOnly",qm="requires32bit",Wm="is.workflow.my.app",zm="com.apple.mobileme.fmf1",Ym="iPad",Jm="com.apple.NanoCompass.watchkitapp",Km="com.apple.DeepBreathing",Zm="com.apple.Depth",Qm="com.apple.Mandrake",Xm="SCS.ApDPCS01",ey="ACTION_SETTINGS",ty="shareSheet",ny="com.apple.InstallAssistant.",ry="AppleAccount.AABranding",oy="Send Gift",iy="initiate",sy="EDITORIALTAKEOVER",ay="SLPLOAD",cy="iad.format.text",ly="mapiFetchFail",uy="localizationNotAvailable",dy="ODP_NOAD",fy="adsLocaleMetadata",py="SHARE_APP_EVENT_SUBTITLE",hy="j:mm",wy="inAppEvent",gy="systemimage://bell.fill",vy="appPromotionTitle",my="OfferItems.FormattedDate.RedemptionDate.DateFormat",yy="OfferItems.Available.Now",Ay="@@date@@",Ty="arcade-see-all-games-button",by="GAME_CENTER",Sy="marketingArtwork",Py="seed",Iy="upsell",Cy="PAGE_FACETS_FILTERS_CONTROLLER_SUPPORT",ky="PAGE_FACETS_FILTERS_COMING_SOON",Oy="PAGE_FACETS_SORT_BY_TITLE",Ey="controllerSupport",Ry="PAGE_FACETS_INCLUDE_TITLE",Dy="000000",_y="ARCADE_SUBSCRIBE_PAGE_NOT_NOW",xy="displayBreakoutMaterial",Ly="material",My="textGradient",$y="plusLight",Fy="MMMM d, y",Ny="x-as3-internal:/today/test",By="notificationSettings",Uy="invalidateWidgetsOnFailure",Gy="PageData",jy="ProductBuilder",Vy="contingent-items:branch",Hy="contingentItemOffer",qy="contingent-items:association.trunks",Wy="trunks",zy="offer-items:salables",Yy="discountOffer",Jy="fileSizeByDevice",Ky="promotionalText",Zy="backgroundAssetsInfo",Qy="backgroundAssetsInfoWithOptional",Xy="installSizeByDeviceInBytes",eA="editorial-item-shelves",tA="viewEditorialItem",nA="preview",rA="redownload",oA="lockupFromApiChartItem",iA="contentRatingsBySystem.appsApple.name",sA="ageRating.value",aA="ageRating.contentLevels",cA="br.l.official",lA="br.l",uA="br.10.official",dA="br.10",fA="br.12.official",pA="br.12",hA="br.14.official",wA="br.14",gA="br.16.official",vA="br.16",mA="br.18.official",yA="br.18",AA="impressionableAppIconFromData",TA="circularIconArtwork",bA="appBinaryTraits",SA="requiresRosetta",PA="iphone5",IA="iphone6",CA="iphone6+",kA="maxEssentialInstallSizeInBytes",OA="maxDownloadSizeInBytes",EA="maxInstallSizeInBytes",RA="editorialArtwork.contentLogoTrimmed",DA="posterCardVideo16x9",_A="enabled",xA="concerns",LA="ACTION_REVIEW_REPORT",MA="TOAST_CONCERN_REPORTED_TITLE",$A="TOAST_CONCERN_REPORTED_DESCRIPTION",FA="systemimage://square.and.pencil",NA="userReviewId",BA="systemimage://hand.thumbsup",UA="systemimage://hand.thumbsdown",GA="guid",jA="formBody",VA="CONTROLLER_RECOMMENDED",HA="NOT_SUPPORTED",qA="CAPABILITY_GAME_CENTER_TITLE",WA="resource://ProductCapabilityGameCenter",zA="safariExtensions",YA="above",JA="hasApps",KA="hasGames",ZA="DEVELOPER_APPS_AND_GAMES",QA="DEVELOPER_GAMES",XA="DEVELOPER_APPS",eT="associations.apps.data",tT="prefersHiddenPageTitle",nT="enrichedEditorialNotes.name",rT="enrichedEditorialNotes.tagline",oT="enrichedEditorialNotes.callToAction",iT="shelf_id",sT="arcadeSeeAllGamesFooter",aT="footer",cT="three",lT="largeBrick",uT="ARCADE_PREORDER_COMING_SOON",dT="REPORT_A_PROBLEM",fT="Shelves.Accessibility.Label",pT="Shelves.Accessibility.RoleDescription",hT="featuredCategories",wT="editorialCard",gT="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_GAME",vT="breakoutTall",mT="renderGroupingPage",yT="noPersonalizationAvailable",AT="groupingAppEvent",TT="suppressText",bT="layoutStyle.layoutSize",ST="link.url",PT="GameCenter.ContinuePlayingShelf.Title",IT="videoCard",CT="impressionIndex",kT="Achievements Hero",OT="inprogress",ET="gameCenterFriendingViaPush",RT="legacy",DT="FRIEND_SUGGESTION",_T="smallContactCard",xT="INVITE",LT="FROM_CONTACTS",MT="inviteFriend",$T="removeFriendSuggestion",FT="friendSuggestion",NT="redownloadButtonTintUsingOfferTheme",BT="parentShelfItems",UT="displayDeviceDrivenContent",GT="CategoryGrouping",jT="null",VT="smallBreakout",HT="tagBrick",qT="advertPressed",WT="offerButtonPress",zT="MEDRIVER_",YT="promotedContent",JT="editorialContext",KT="Watch",ZT="Messages",QT="developerName",XT="firstVersionSupportingInAppPurchaseApi",eb="widthConstrainedLockup",tb="OfferButton.Title.Subscribe",nb="descending",rb="editorialItemActionFromData",ob="displaySubStyle",ib="iad.lineItem",sb="clientIdentifierOverride",ab="targetId",cb="contentRestrictionReasons",lb="clientCorrelationKey",ub="crossfireReferralCandidate",db="media",fb="hasiAdData",pb="viewedInfo",hb="viewedInfoDetailed",wb="cookie",gb="ownerDsid",vb="pageExit",mb="trampoline",yb="trampolineContext",Ab="widgetContext",Tb="contingentItemId",bb="browserChoice",Sb="browserChoiceScreenBuy",Pb="clip",Ib="buttonName",Cb="actionContext",kb="selectedPageFacets",Ob="Apps",Eb="searchGhostHint",Rb="didYouMean",Db="displaysArcadeUpsell",_b="franchise",xb="isOnboardingCard",Lb="optimizationEntityId",Mb="optimizationId",$b="iAdOdmlSuccess",Fb="metadata",Nb="iAdIsSpecifiedCreativeUsed",Bb="APPSTORE_SEARCH_LANDING_PAGE",Ub="APPSTORE_SEARCH_RESULT_PAGE",Gb="APPSTORE_TODAY_TAB",jb="APPSTORE_PRODUCT_PAGE",Vb="APPSTORE_PRODUCT_PAGE_DOWNLOAD",Hb="iAdSlotId",qb="iAdPageCustomId",Wb="macSoftware",zb="iosSoftware",Yb="pending",Jb="channelPartner",Kb="eligibilityType",Zb="upsellScenario",Qb="modeType",Xb="FreeTrial",eS="PayUpFront",tS="PayAsYouGo",nS="rebuy=true",rS="OfferButton.FlowPreview.Get",oS="OfferButton.FlowPreview.Preorder",iS="preorderedSubscribed",sS="productPageBrowserChoice",aS="preorderSubscribed",cS="INTRO_PRICE_OFFER_SUBTITLE",lS="Offer.InlineInAppPurchases",uS="OfferButton.ExternalPurchases.Subtitle",dS="weight_parameter",fS="meta.personalizationData.isPinned",pS="meta.personalizationData.segId",hS="OnDeviceRecommendationsPageController",wS="fetchRecommendations",gS="candidates",vS="PRODUCT_PRIVACY_LEARN_MORE_TEMPLATE",mS="<br><br>",yS="privacyPolicy",AS="PRODUCT_PRIVACY_DEFINITIONS_LINK",TS="privacyDefinitions",bS="ACTION_SEE_DETAILS",SS="USAGE_DATA",PS="systemimage://person.circle",IS="NOT_COMPATIBLE_BANNER",CS="UNSUPPORTED_CAPABILITIES",kS="UNSUPPORTED_WATCHOS_VERSION",OS="experimentLocale",ES="pageCustomId",RS="ProductPage.Section.ScreenshotsPreview.Title",DS="user",_S="reviewsContainer",xS="displayable-kind",LS="urlQuery",MS="editorsChoiceItem",$S="ratingCount",FS="APP_SUPPORT",NS="REVIEWS_MOST_HELPFUL",BS="REVIEWS_MOST_FAVORABLE",US="REVIEWS_MOST_CRITICAL",GS="recent",jS="REVIEWS_MOST_RECENT",VS="reviewsPageActionFromReviewsData",HS="genreName",qS="BADGE_AGE_RATING_YEARS",WS="BADGE_AGE_RATING",zS="BADGE_PLAYERS_HEADING",YS="{maxPlayers}",JS="BADGE_NO_RATINGS_CAPTION",KS="storefrontContentRating",ZS="{subtitle}",QS="marker",XS="accessibilityParagraph",eP="prefersReadableContentAlignedTitle",tP="VOICE_CONTROL",nP="AccessibilityDetails.Header.NoLearnMoreLink",rP="AccessibilityDetails.Header.NoLearnMoreLink.NoDeveloperName",oP="ProductPage.Accessibility.Header.NoSupportedFeatures.NoLearnMoreLink",iP="ProductPage.Accessibility.Header.NoReportedFeatures.NoLearnMoreLink",sP="gameCenterPlayerGameAchievementSummary",aP="ProductPage.Section.EditorsNotes.Title",cP="ProductPage.Section.FeaturedIn.Title",lP="largeGameCenterPlayer",uP="hasEula",dP="productMediaItem",fP="createTapToRateProductReviewAction",pP="ProductPage.RatingsAndReviews.Footer.LearnMore",hP="ProductPage.Section.MostRecentVersion.Title",wP="overview",gP="titledParagraph",vP="detail",mP="releaseNotes",yP="ProductPage.Section.Videos.Title",AP="textPair",TP="product-page-info-section",bP="deviceFamily",SP="InfoList.AgeRating.LearnMore",PP="advisories",IP="seventeenPlus",CP="gracRegistrationNumber",kP="twelvePlus",OP="Seller",EP="isTrader",RP="Search.Facets.iPadAndIPhone",DP="Search.Facets.iPhoneOnly",_P="SEARCH_FACET_FREE",xP="SEARCH_FACET_",LP="filter[price]",MP="filter[genre]",$P="filter[ages]",FP="terms",NP="naturalLanguage",BP="clusterId",UP="results.contents",GP="timeSinceOnScreen",jP="recentSearches",VP="midScrollGuidedSearch",HP="SEARCH_TRANSPARENCY_LINK",qP="rewrite",WP="ads-result",zP="EDITORIAL_SEARCH_RESULT_TYPE_DEVELOPER_TITLE_CASE",YP="whenInstalled",JP="mixed",KP="guidedLabel",ZP="search-revisions",QP="singleColumnList",XP="@@chartPosition@@",eI="developerInfo",tI="divider",nI="scrollablePill",rI="displayType",oI="appMarkerType",iI="Acquisition",sI="InlineImage",aI="AppLockup",cI="InlineVideo",lI="quote",uI="Small",dI="Medium",fI="Large",pI="itunes.apple.com",hI="meta.personalizationData.optimizationId",wI="meta.personalizationData.optimizationEntityId",gI="meta.personalizationData.replaceIfAdPresent",vI="editorialBackground",mI="LCS.ApLCXW01",yI="editorialArtwork.storyCardStatic16x9",AI="UAS.ApXWC01",TI="com.apple.AppStore.Widgets.Today",bI="systemMedium",SI="DCEC.AppWS01",PI="MCGC.AppWS01",II="MCGC.AppWL01",CI="PersonalizedRecommendations.Toggle.Title",kI="PersonalizedRecommendations.Toggle.Footer",OI="PERSONALIZATION_PURCHASES",EI="RECOMMENDATIONS",RI="engagement-data",DI="ArcadeOnboarding",_I="extend",xI="ALL_ARCADE_GAMES",LI="arcadeSubscribePage",MI="release",$I="nonnull",FI="token.pageInformation",NI="token.excludeAttribution",BI="isAppInstalled",UI="token.targetType",GI="token.metricsKind",jI="systemInformation",VI="token.productVariantData",HI="token.inAppEventId",qI="Purchases",WI="gameCenterProfile",zI="OnDeviceRecommendationsPageController:handleShelf not implemented",YI="ProductData",JI="Product page preloading is disabled",KI="lookup",ZI="app-bundle",QI="search-recommendation-sections",XI="trending-contents",eC="TodayData",tC="TodayForApps",nC="Arcade.DownloadPack.Suggestions.GetAllButtonTitle",rC="asString",oC="asNumber",iC="asBoolean",sC="asJSONValue",aC="catalog",cC="engagement",lC="view/see-all",uC="its_qt",dC="adId",fC="prefix",pC="username",hC="password",wC="port",gC="-caseInsensitive",vC="signatureResumption",mC="checkForLongUrl",yC="getPass",AC="certId",TC="hsb",bC="metrics-identifiers",SC="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/accountSummary",PC="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/redeemLandingPage",IC="IPHONE_BRAND_NAME",CC="IPAD_BRAND_NAME",kC="APPLE_TV_BRAND_NAME",OC="APPLE_WATCH_BRAND_NAME",EC="MAC_BRAND_NAME",RC="SearchResultsPageIntent",DC="arcadeTabNavBar",_C="existing",xC="magnifyingglass",LC="person.crop.square",MC="visionpro",$C="list",FC="timer",NC="textFollowsTintColor",BC="bundle",UC="editorial",GC="com.apple.appstorecomponentsd",jC="com.apple.AppStore.Widgets",VC="com.apple.visionproapp",HC="primaryTerm",qC="https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/signupWizard",WC="iPhone",zC="isStandaloneWithCompanionForWatchOS",YC="isDeliveredInIOSAppForWatchOS",JC="isXROSCompatible",KC="free",ZC="Mac",QC="systemimage://square.and.arrow.up",XC="results.data",ek="accountDetails",tk="createAccount",nk="sendGift",rk="addFunds",ok="Redeem",ik="cppAssetsMissing",sk="customers-also-bought-apps-download",ak="past",ck="module",lk="appPromotion",uk="trunk-app",dk="useTrunkArtwork",fk="editorialArtwork.brandLogo",pk="systemimage://questionmark.circle",hk="comingSoonApps",wk="marketingVideo",gk="supportsSharePlay",vk="filter[ageRating]",mk="filter[supportsGameController]",yk="filter[isMultiplayer]",Ak="subscribe",Tk="custom",bk="Arcade.Welcome.Family.Button.ExploreArcade",Sk="breakoutTextAlignment",Pk="left",Ik="right",Ck="black",kk="arcadeSubscribe",Ok="hiddenPurchases",Ek="isViewOnly",Rk="action.kind",Dk="action.url",_k="Goto",xk="standalone-merchandised-in-apps",Lk="see-all-contents",Mk="requirementsByDeviceFamily",$k="licenses",Fk="internetContentProviderInfo",Nk="review-summary",Bk="categorizations",Uk="future",Gk="ageBandId",jk="customAttributes",Vk="appShowcase",Hk="placeholderBackground",qk="checksum",Wk="circularArtwork",zk="ovalArtwork",Yk="iphone_6_5",Jk="iphone_d73",Kk="iphone_d74",Zk="editorialArtwork.splashFullScreen",Qk="editorialArtwork.topShelf",Xk="customVideoPreviewsByTypeForAd",eO="BreakoutLarge",tO="textColor3",nO="application/json",rO="Alert.GenericError.Title",oO="Alert.GenericError.Message",iO="decimalPad",sO="siri",aO="hasInAppPurchases",cO="systemGreen",lO="jpeg",uO="DEVELOPER_WATCH",dO="DEVELOPER_LATEST_RELEASE",fO="DEVELOPER_BUNDLES",pO="DEVELOPER_APPLE_ARCADE",hO="arcadeFooter",wO="ignoreITunesShortNotes",gO="editorialNotes.short",vO="HERO_CAROUSEL_OVERLAY_BUTTON_TITLE_VIEW",mO="collectionIcons",yO="shelf_page_header",AO="navigationBar",TO="TermsAndConditions.Title",bO="two",SO="ribbonBar",PO="onDevicePersonalization",IO="Genre",CO="collectionModule",kO="collectionLockup",OO="breakoutFullScreen",EO="Browse Categories",RO="hasSeeAll",DO="designTag",_O="editorialStoryCard",xO="nonarcade",LO="isArcade",MO="date",$O="contentGraphicTrimmed",FO="Lockup.Heading.Arcade",NO="userRating.ratingCount",BO="userRating.value",UO="discounts",GO="inAppPurchaseInstall",jO="item.offer.buyParams",VO="offerId",HO="isVerifiedForAppleSiliconMac",qO="genreNames",WO="data-metrics-impressions-low-latency",zO="exit",YO="overridePageContext",JO="userId",KO="dsId",ZO="refAppType",QO="widget",XO="SoftwareBundle",eE="context",tE="BrowserChoice",nE="com.apple.AppStore.clipOverlay",rE="paymentTopicFromBag",oE="overlayClip",iE="offerReleaseDate",sE="buyInitiate",aE="See All",cE="searchOriginatingTerm",lE="recents",uE="undoSpellCorrection",dE="applySpellCorrection",fE="userTypedHint",pE="submit",hE="impressionOptions",wE="tag",gE="iAdEligible",vE="impressionParentId",mE="searchGhostHintPrefix",yE="searchGhostHintTermPhase",AE="searchGhostHintTerm",TE="input",bE="meta.metrics",SE="dsid",PE="@@durationCount@@",IE="@@postTrialPriceDuration@@",CE="test",kE="PREORDER_NOTIFY_AUTOMATIC_DOWNLOAD_MESSAGE",OE="arcade-preorder",EE="preorderedNotSubscribed",RE="confirmation",DE="preorderNotSubscribed",_E="OfferButton.IntroPrice.FreeTrial",xE="discountOwnedParent",LE="discountUnownedParent",ME="use_signals",$E="meta.personalizationData.grpId",FE="editorialItemGroup",NE="DATA_NOT_PROVIDED",BE="PRODUCT_PRIVACY_LEARN_MORE_LINK",UE="PRODUCT_PRIVACY_LEARN_MORE_NO_LINK",GE="privacyDetail",jE="privacyCard",VE="experimentId",HE="helpful",qE="mostHelpfulReviews",WE="wasReset",zE="ratingsDetails",YE="RATINGS_STATUS_NOT_ENOUGH_RATINGS_OR_REVIEWS",JE="supportUrl",KE="chartPositions",ZE="highMotion",QE="{minPlayers}",XE="{releaseDate}",eR="value",tR="{count}",nR="deviceCompatibility",rR="Offer.Expanded.Title.ComingSoon",oR="externalVersionId",iR="webBrowser",sR="supportsClickEventsOnSwiftUIHostingCell",aR="AccessibilityDetails.Title",cR="ProductPage.Section.Information.Title",lR="ProductPage.Section.Supports.Title",uR="safetyAndComplianceUrl",dR="voyager_bundles_2025A",fR="darkOverlay",pR="productReviewAction",hR="ProductPage.Section.Reviews.MostHelpfulReviews.Title",wR="productRatingsAndReviewsComponent",gR="versionDisplay",vR="standardInformationShelf",mR="InfoList.AgeRating.Title",yR="Install.Size.String",AR="{fileSize}",TR="iads",bR="dataSetId",SR="SEARCH_FACET_ANY_PRICE",PR="SEARCH_FACET_ANY_CATEGORY",IR="SEARCH_FACET_RELEVANCE",CR="kinds",kR="macOSCompatibleIOSApps",OR="landing:new-protocol",ER="lastNLSQueryDate",RR="top-apps",DR="showLabelInSearch",_R="guidedToken",xR="secondaryGenreShortDisplayNames",LR="SearchRevisions",MR="{searchTerm}",$R="no-results",FR="searchChartsAndCategories",NR="alternateLabel",BR="contentIds",UR="associations.app-events.data",GR="associations.app-events.attributes.forceAppEvent",jR="mediumAdLockupWithScreenshotsBackground",VR="adItem",HR="condensedAdLockupWithIconBackground",qR="displayTerm",WR="supportsGameController",zR="rankedSecondaryGenre",YR="onDeviceSearchHistory",JR="editorialLink",KR="upsellForNonacquisitionCanvas",ZR="arcadeIcons",QR="AppMarker",XR="framedArtwork",eD="isAcquisition",tD="editorialArtwork.dayCard",nD="editorialArtwork.eventCard",rD="editorialArtwork.generalCard",oD="ignoreEditorialArt",iD="headerName",sD="headerBadge",aD="headerTagline",cD="meta.associations.recommendations.data",lD="associations.recommendations.data",uD="todaySection",dD="Video",fD="systemLarge",pD="personalization-data",hD="ACCOUNT_SETTINGS",wD="upsellRecovery",gD="token.metricsPlatformDisplayStyle",vD="https",mD="channel-apps",yD="done",AD="chin",TD="Arcade.DownloadPack.Suggestions.PrimaryButtonTitle",bD="strict",SD="customIconArtwork",PD="ratings",ID="suffix",CD="language",kD="askToBuy",OD="launchRepair",ED="arcadeProductPage",RD="editorialItemCanvas",DD="blue",_D="applewatch",xD="river",LD="FlowAction",MD="pageChange",$D="com.apple.AppStore",FD="com.apple.TVAppStore.AppStoreTopShelfExtension",ND="originalUrl",BD="updates",UD="checkForPreorders",GD="meta.discountOffer",jD="isIOSBinaryMacOSCompatible",VD="de7bbd8e",HD="presentModal",qD="viewGenre",WD="CONTROLLER_OPTIONAL",zD="SIRI_REMOTE_OR_CONTROLLER_REQUIRED",YD="SIRI_REMOTE_REQUIRED",JD="purchaseHistory",KD="familySharing",ZD="manageSubscriptions",QD="push",XD="NOAD",e_="METADATA",t_="deepLink",n_="png",r_="events-and-offers",o_="close",i_="redemptionExpirationDate",s_="details",a_="Arcade.SeeAllGames.Button.Title",c_="systemBlue",l_="with",u_="personal-recommendations",d_="comingSoon",f_="wordmark",p_="external",h_="Action.OK",w_="messagesScreenshots",g_="supportsFunCamera",v_="supportURLForLanguage",m_="websiteUrl",y_="top-in-app-purchasables",A_="unlistedApps",T_="cabAdSupport",b_="merchandised-in-apps",S_="textColor1",P_="670",I_="roundPrerendered",C_="tvRect",k_="appleWatch_2021",O_="appleWatch_2018",E_="appleWatch",R_="iphone_5_8",D_="editorialArtwork.bannerUber",__="splashVideo4x3",x_="arcadeShowcase",L_="StoryMedium",M_="systemimage://exclamationmark.circle",$_="prefersNonStandardBackButton",F_="textOnly",N_="subscriptionHero",B_="interactive",U_="pageHeader",G_="hasChevron",j_="textLightensOnHighlight",V_="hasSeparator",H_="TwoUp",q_="Asymmetrical",W_="smallBrick",z_="cppData",Y_="contingentItems",J_="prefersLargeTitleWhenRoot",K_="singleModule",Z_="materialText",Q_="arcadeDownloadPackCard",X_="displayCount",ex="editorialArtwork.mediaCard",tx="nonArcade",nx="locked",rx="friendingViaPush",ox="inAppPurchaseTiledLockup",ix="standardApp",sx="platformAttributes.ios.bundleId",ax="abExperiment",cx="editorialBadgeType",lx="editorialPriority",ux="isSubscription",dx="appExtVrsId",fx="parentId",px="multiple-system-operators",hx="targetType",wx="pageReferrer",gx="crossfireReferral",vx="advertDeviceWindow",mx="cardType",yx="iAdMetadata",Ax="iAdImpressionId",Tx="SearchFocus",bx="Focus",Sx="position",Px="prevPage",Ix="platformDisplayStyle",Cx="application/x-www-form-urlencoded",kx="hintsEntity",Ox="hint",Ex="idType",Rx="ad_container",Dx="iAdAppStoreClientRequestId",_x="impressionId",xx="customProductPage",Lx="update",Mx="complete",$x="OfferButton.Title.Get",Fx="{appName}",Nx="notSubscribed",Bx="OfferButton.IntroPrice.Trial",Ux="size",Gx="meta.personalizationData.score",jx="PRODUCT_PRIVACY_TITLE",Vx="{developerName}",Hx="privacyType",qx="identifier",Wx="systemimage://exclamationmark.triangle",zx="install",Yx="text/markdown",Jx="chartPosition",Kx="BADGE_MFI_HEADING",Zx="systemimage://person.crop.square",Qx="MMM d, yyyy",Xx="watchOS",eL="xrOS",tL="prefersIndirectTouch",nL="PRIVACY_POLICY",rL="ProductPage.Section.SafetyAndCompliance.Title",oL="componentBackgroundStandout",iL="APP_STORE_EDITORS_NOTES",sL="framedVideo",aL="search-hints",cL="landing",lL="slp",uL="searchResult",dL="imageWithLabel",fL="MC.ApSCFB01",pL="editorialArtwork.storyCenteredStatic16x9",hL="header-contents",wL="materialGradient",gL="fractionalWidth",vL="multiplex",mL="customers-also-bought-apps-with-download-intent",yL="user-reviews",AL="searchLanding:see-all",TL="customArtwork",bL="hash",SL="dynamic",PL="apps-media-api-edge-host",IL="groupingLockup",CL="joystickcontroller.fill",kL="actionLinks",OL="message",EL="productReview",RL="multiApp",DL="singleLockup",_L="guidedSearch",xL="com.apple.Arcade.ArcadeTopShelfExtension",LL="purchased",ML="fields",$L="requiresGameController",FL="CONTROLLER_REQUIRED",NL="dynamicUI",BL="webView",UL="Account",GL="lockupArtwork",jL="startDate",VL="endDate",HL="badgeKind",qL="eventModule",WL="inAppEventId",zL="topic",YL="branch-app",JL="<b>",KL="</b>",ZL="<br>",QL="winback",XL="secondaryText",eM="buy",tM="breakoutCallToActionLabel",nM="target",rM="mixedMediaLockup",oM="pageMetrics",iM="personalizationTransparency",sM="editorial-elements",aM="alternate-apps",cM="related-editorial-items",lM="developer-other-apps",uM="privacy",dM="accessibility",fM="supportedGameCenterFeatures",pM="privacyDetails",hM="round",wM="appleWatch_2022",gM="appleWatch_2024",vM="textColor2",mM="heic",yM="shortEditorialNotes",AM="largeHeroBreakout",TM="mediaPageHeader",bM="editorialNotes.callToAction",SM="AllGames",PM="ThreeUp",IM="largeImageLockup",CM="personalizationData",kM="systemimage://magnifyingglass",OM="categoryBrick",EM="Lockup.Footer.GamesApp",RM="searchLandingTrendingSection",DM="doNotFilter",_M="onDevicePersonalizationUseCase",xM="customDeepLink",LM="hints",MM="pageContext",$M="refApp",FM="impressionType",NM="extRefApp2",BM="extRefUrl2",UM="offerType",GM="searchPrefix",jM="iAdTemplateType",VM="ARCADE_PREORDER_LOCKUP_COMING_SOON",HM="{price}",qM="checkmark",WM="trial",zM="miniTodayCard",YM="intermediateDetailPage",JM="ProductPage.ReviewSummary.Body.Title",KM="languages",ZM="controller",QM="select",XM="allProductReviewActions",e$="productReviewsHeader",t$="LICENSE_AGREEMENT",n$="tv_product_page_2024E",r$="genreShortDisplayName",o$="multirooms",i$="textLabel",s$="FullWidth",a$="work",c$="play",l$="develop",u$="app-distribution",d$="ArcadeData",f$="SearchData",p$="attributes",h$="many",w$="arcadeComingSoon",g$="appstore",v$="false",m$="textLinksShelf",y$="four-screenshots",A$="boolean",T$="redeem",b$="gift",S$="meta.contingentItemOffer",P$="minimumWatchOSVersion",I$="price",C$="search-results",k$="search-landing",O$="EventDetails",E$="supportsStreamlinedBuy",R$="additionalTerms",D$="toggle",_$="appTrailerLockup",x$="privacyPolicyUrl",L$="charts",M$="types",$$="ipod",F$="pill",N$="unadorned",B$="multiplayer-activities",U$="splashVideo16x9",G$="splashVideo3x4",j$="screenshotsLockup",V$="EditorialLockupLargeVariant",H$="EditorialLockupMediumVariant",q$="Action.LearnMore",W$="mac-os-compatible-ios-apps",z$="system-apps",Y$="xros-apps",J$="prefersOverlayedPageHeader",K$="largeBreakout",Z$="editorial-shelves-collection:contents",Q$="canvas",X$="canonicalId",eF="layoutDirection",tF="placeholder",nF="rowCount",rF="mediumStoryCard",oF="mso",iF="listItem",sF="com.apple.games",aF="links",cF="genres",lF="named",uF="cardDisplayStyle",dF="actionUrl",fF="impressionQueue",pF="eventVersion",hF="advertRotation",wF="softwareType",gF="PREORDER_NOTIFY_MESSAGE",vF="NOT_COMPATIBLE_BANNER_TEMPLATE",mF="{linkTitle}",yF="systemimage://gamecontroller.fill",AF="spacer",TF="rooms",bF="targetPlatform",SF="systemSmall",PF="navigation",IF="few",CF="appEvent",kF="new",OF="appIcon",EF="GET",RF="code",DF="externalUrl",_F="categories",xF="ages",LF="share",MF="minPlayers",$F="maxPlayers",FF="customScreenshotsByTypeForAd",NF="productVideo",BF="hide_arcade_header_on_arcade_tab",UF="textColor4",GF="toast",jF="location",VF="roundedRect",HF="shelf_header",qF="singleSelection",WF="arcadeDownloadPackCategories",zF="sellerInfo",YF="accessibilityDetails",JF="inAppPurchaseLockup",KF="largeLockup",ZF="roundedRectPrerendered",QF="ipadPro",XF="ipad_10_5",eN="enrichedEditorialNotes",tN="EditorialLockupLarge",nN="EditorialLockupMedium",rN="isGameCenterEnabled",oN="imessage-apps",iN="lockupSmall",sN="posterLockup",aN="editorial-elements:contents",cN="offerItems",lN="largeStoryCard",uN="suggested",dN="medium",fN="arcadeApp",pN="ARCADE_ACTION_TITLE_EXPLORE",hN="EXPLORE",wN="pageUrl",gN="extRefUrl",vN="refUrl",mN="trending",yN="BADGE_MFI_SUPPORTED",AN="userRating",TN="arcadeProductPageInlineMessage",bN="productPageInlineMessage",SN="rank",PN="Search Results",IN="coercedValue",CN="arcadeTabHeader",kN="disabled",ON="appletv",EN="always",RN="term",DN="menuItem",_N="actionType",xN="back",LN="LearnMore",MN="badge",$N="branch",FN="salables",NN="releaseDate",BN="comingSoonGrouping",UN="isCanvasAvailable",GN="versionHistory",jN="ipadPro_2018",VN="ipad_11",HN="expectedReleaseDate",qN="watch-apps",WN="atv-apps",zN="editorial-shelves-header",YN="primary-contents",JN="badge-content",KN="Horizontal",ZN="lightOverArtwork",QN="mediumImageLockup",XN="editorial_id",eB="meta.personalizationData.appId",tB="achievement",nB="todayBrick",rB="undefined",oB="subscribed",iB="click",sB="pageFields",aB="contentRating",cB="iAdContainerId",lB="hostApp",uB="pageDetails",dB="SearchLanding",fB="{title}",pB="NOT_COMPATIBLE_BANNER_LINK_TITLE",hB="compatibilityAnnotation",wB="ppid",gB="relationship",vB="allProductReviews",mB="tapToRateProductReviewAction",yB="writeAReviewProductReviewAction",AB="notPurchasedRatingsAndReviews",TB="purchasedRatingsAndReviews",bB="Any",SB="apps.apple.com",PB="apps-and-games",IB="eula",CB="host",kB="inAppPurchase",OB="hero",EB="NO_BADGE",RB="story",DB="isFirstPartyHideableApp",_B="iap",xB="remoteControllerRequirement",LB="internal",MB="APPLOCKUP",$B="customers-also-bought-apps",FB="iad",NB="productArtwork",BB="recurringSubscriptionPeriod",UB="numOfPeriods",GB="@@count@@",jB="arcadeSeeAllGames",VB="upsellBreakout",HB="topCharts",qB="width",WB="Hero",zB="POST",YB="mac-apps",JB="ios-apps",KB="brick",ZB="showExpectedReleaseDate",QB="editorialNotes.badge",XB="editorialCopy",eU="href",tU="editorialBadgeInfo",nU="iAdPlacementId",rU="pageId",oU="iAdId",iU="userProductReviews",sU="discover",aU="number",cU="bundleParents",lU="textCards",uU="isStandaloneForWatchOS",dU="chartHref",fU="description.standard",pU="annotation",hU="contexts",wU="clear",gU="height",vU="previewFrame",mU="supportsArcade",yU="one",AU="tvOS",TU="facet",bU="actionDetails",SU="iAdSlotInfo",PU="{osVersion}",IU="editorsChoiceProductReviews",CU="Achievements",kU="bundleChildren",OU="trailing",EU="tvos",RU="tabs",DU="dismiss",_U="priceFormatted",xU="offerName",LU="bgColor",MU="deviceFamilies",$U="debug",FU="prefersLargeTitle",NU="editorialClientParams",BU="heroCarousel",UU="query",GU="offers",jU="create",VU="detailPage",HU="rating",qU="linkableText",WU="generic",zU="editorialItem",YU="notPurchasedLinks",JU="brandedSingleApp",KU="finance",ZU="buyParams",QU="transparent",XU="upsellMarketingItem",eG="metrics",tG="videoPreviewsByType",nG="{learnMoreLink}",rG="colored",oG="tagline",iG="pageType",sG="editorial-item-groups",aG="renderPage",cG="cancel",lG="other",uG="inAppPurchases",dG="subscriptions",fG="paragraph",pG="todayCard",hG="protocol",wG="data",gG="latest-release-app",vG="eventType",mG="iAdMissedOpportunityReason",yG="productReviewsFooter",AG="category",TG="presentModalFormSheet",bG="editorialElementKind",SG="screenshotsByType",PG="grouping",IG="SearchResults",CG="reviewSummary",kG="short",OG="searchResults",EG="object",RG="appletvos",DG="flowPreview",_G="developers",xG="editorialNotes.name",LG="editorialNotes.tagline",MG="editorial-cards",$G="token",FG="genreDisplayName",NG="image",BG="purchasedLinks",UG="searchLanding",GG="its_contentId",jG="pathname",VG="Search",HG="tile",qG="open",WG="meta",zG="view",YG="No page routes specified",JG="web",KG="platform",ZG="contingent-items",QG="text/x-apple-as3-nqml",XG="marketing-items",ej="color",tj="tags",nj="expectedReleaseDateDisplayFormat",rj="editorialNotes",oj="type",ij="gameCenter",sj="smallStoryCard",aj="completed",cj="collections",lj="card",uj="Software",dj="overlay",fj="iOS",pj="groupings",hj="rgb",wj="adamId",gj="collection",vj="fractionalHeight",mj="text/plain",yj="macOS",Aj="offer-items",Tj="challenges",bj="leaderboards",Sj="editorialQuote",Pj="mostRecentVersion",Ij="sort",Cj="artistName",kj="arcade-apps",Oj="ACTION_SEE_ALL",Ej="preorder",Rj="impressions",Dj="text",_j="productPage",xj="realityDevice",Lj="preorderDisclaimer",Mj="never",$j="xros",Fj="children",Nj="isAppleWatchSupported",Bj="multiplayer",Uj="requiredCapabilities",Gj="osx",jj="recommendations",Vj="absolute",Hj="featuredIn",qj="grid",Wj="account",zj="ageRating",Yj="primary-content",Jj="product",Kj="compatibilityControllerRequirement",Zj="iconArtwork",Qj="ignoredValue",Xj="genre",eV="minimumOSVersion",tV="displayStyle",nV="productPageYMALDuringDownload",rV="kind",oV="searchTerm",iV="macRequiredCapabilities",sV="card-contents",aV="productRatings",cV="developer",lV="subtitle",uV="Room",dV="defaultValue",fV="editorsChoice",pV="infer",hV="accessibilityDeveloperLink",wV="accessibilityHeader",gV="coercible",vV="editorial-pages",mV="games",yV="accessibilityFeatures",AV="moreByDeveloper",TV="privacyFooter",bV="videos",SV="hasMacIPAPackage",PV="appEvents",IV="informationRibbon",CV="label",kV="in-apps",OV="small",EV="action",RV="privacyTypes",DV="video",_V="messages",xV="productPageYMAL",LV="mediumLockup",MV="similarItems",$V="chart",FV="true",NV="privacyHeader",BV="white",UV="light",GV="capabilities",jV="swoosh",VV="isPreorder",HV="Arcade",qV="none",WV="friendsPlaying",zV="bundleId",YV="sequential",JV="search",KV="large",ZV="its_id",QV="static",XV="article",eH="smallLockup",tH="center",nH="description",rH="ios",oH="editorialVideo",iH="ipad",sH="default",aH="iphone",cH="lockup",lH="editorialArtwork",uH="link",dH="information",fH="achievements",pH="reviews",hH="title",wH="inline",gH="string",vH="topLockup",mH="dark",yH="header",AH="url",TH="unknown",bH="screenshots",SH="app",PH="today",IH="app-bundles",CH="pad",kH="vision",OH="editorial-items",EH="leading",RH="phone",DH="app-events",_H="artwork",xH="arcade",LH="standard",MH="watch",$H="mac",FH="contents",NH="button",BH="apps",UH="navigate",GH="name",jH="page",VH="shelf"
Av=e(8706),Tv=e(9100),bv=e(8836),Sv=e(1222)
const HH=(0,(Pv=e(900)).makeMetatype)("app-store:storeMetrics"),qH=(0,Pv.makeMetatype)("app-store:amsEngagement"),WH=(0,Pv.makeMetatype)("app-store:device"),zH=(0,Pv.makeMetatype)("app-store:user"),YH=(0,Pv.makeMetatype)("games:player"),JH=(0,Pv.makeMetatype)("app-store:metricsIdentifiers"),KH=(0,Pv.makeMetatype)("app-store:arcade"),ZH=(0,Pv.makeMetatype)("app-store:gameCenter"),QH=(0,Pv.makeMetatype)("app-store:resilientDeepLinks"),XH=(0,Pv.makeMetatype)("app-store:ads"),eq=(0,Pv.makeMetatype)("app-store:onDeviceRecommendationsManager"),tq=(0,Pv.makeMetatype)("app-store:onDeviceSearchHistoryManager"),nq=(0,Pv.makeMetatype)("app-store:featureFlags"),rq=(0,Pv.makeMetatype)("app-store:mediaTokenService"),oq=(0,Pv.makeMetatype)("app-store:adsLocalizer"),iq=(0,Pv.makeMetatype)("app-store:appDistribution"),sq=(0,Pv.makeMetatype)("app-store:timeoutManager"),aq=(0,Pv.makeMetatype)("app-store:treatmentStore"),cq=(0,Pv.makeMetatype)("app-store:userDefaults")
Iv=e(4172),Cv=e(2450)
const lq={}
class uq{constructor(e){this.implementation=e}}class dq extends uq{get isSupportEnabled(){return i(this.implementation)&&this.implementation.isSupportEnabled}get isRosettaAvailable(){return i(this.implementation)&&this.implementation.isRosettaAvailable}}dq.type=(0,Pv.makeMetatype)("app-store:as-wrapper"),kv=e(5542)
class fq extends uq{constructor(){super(...arguments),this.cache={}}registerBagKeys(e){this.implementation.registerBagKeys(e)}string(e,t=!1){return this.fromCache(e,t,()=>this.implementation.string(e))}double(e,t=!1){return this.fromCache(e,t,()=>this.implementation.double(e))}integer(e,t=!1){return this.fromCache(e,t,()=>this.implementation.integer(e))}boolean(e,t=!1){return this.fromCache(e,t,()=>this.implementation.boolean(e))}array(e,t=!1){return this.fromCache(e,t,()=>this.implementation.array(e))}dictionary(e,t=!1){return this.fromCache(e,t,()=>this.implementation.dictionary(e))}url(e,t=!1){return this.fromCache(e,t,()=>this.implementation.url(e))}fromCache(e,t=!1,n){if(t)return n()
{const t=this.cache[e]
if((0,kv.isSome)(t))return t.value
{const t=n()
return this.cache[e]={value:t},t}}}}class pq extends uq{constructor(e,t){super(new fq(e)),this.underlyingBag=e}get todayAdMediumLockupScreenshotEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-enabled"))&&void 0!==e&&e}get todayAdMediumLockupScreenshotAnimationEnabled(){var e
return null===(e=this.implementation.boolean("today-ad-medium-lockup-screenshots-animation-enabled"))||void 0===e||e}get trendingSearchesURL(){return this.implementation.url("trending-searches")}get searchHintsURL(){return this.implementation.url("searchHints")}get personalizedUserReviewURL(){return this.implementation.url("personalizedUserReviewUrl")}get personalizedUserReviewEnabled(){return this.implementation.boolean("personalizedUserReviewEnabled")}get userRateURL(){return this.implementation.url("p2-application-user-rate-content")}get writeReviewURL(){return this.implementation.url("p2-application-user-write-review")}get accessoryRoomURL(){return this.implementation.url("p2-accessory-room")}get passbookMainURL(){return this.implementation.url("passbook")}get libraryLinkURL(){return this.implementation.url("library-link")}get metricsConfiguration(){return y(this.implementation.dictionary(eG))}get metricsPaymentNamespaceEnabled(){if(o(this.metricsPaymentTopic))return!1
const e=y(this.implementation.dictionary(bC)),t=h(e,"APPSTORE_PAYMENTS_ENGAGEMENT"),n=h(e,"APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT")
return(0,kv.isSome)(t)&&0!==t.length&&(0,kv.isSome)(n)&&0!==n.length}get metricsPaymentTopic(){var e
return null!==(e=f(this.metricsConfiguration,"topics.APPSTORE_PAYMENTS_ENGAGEMENT_TOPIC"))&&void 0!==e?e:null}get personalizationUserIdEnabled(){const e=h(y(this.implementation.dictionary(bC)),"APPSTORE_PERSONALIZATION")
return(0,kv.isSome)(e)&&0!==Object.keys(e).length}get language(){return this.implementation.string(CD)}get mediaApiLanguage(){return this.implementation.string("language-tag")||this.implementation.string(CD)}get termsAndConditionsURL(){return this.implementation.url("p2-service-terms-url")}get usePostForAppStoreSearch(){return this.implementation.boolean("usePostForAppStoreSearch")}get isMonetaryGiftingEnabled(){return this.implementation.boolean("isBuyingScheduledGiftCertificateEnabled")}get accountTopUpURL(){return this.implementation.url("AddFundsUrl")}get accountTopUpTitle(){return this.implementation.string("account-top-up-title")}get isContentGiftingEnabled(){return this.implementation.boolean("isScheduledGiftingEnabled")}get buyButtonMetadataURL(){return this.implementation.url("personalized-buy-buttons/software")}get isTVAppEnabled(){return this.implementation.boolean("uvSearch/nowplaying-enabled")}get emailSupportLinkURL(){return this.implementation.url("supportLinkUrl")}get voteUrl(){return this.implementation.url("voteUrl")}get enableReviewSummarization(){return this.implementation.boolean("enable-review-summarization")}get reviewSummaryReportConcernData(){return y(this.implementation.dictionary("review-summarization-report-concern"))}get reportConcernUrl(){return this.implementation.url("reportConcernUrl")}get reportConcernExplanation(){return this.implementation.string("reportConcernExplanation")}get reportConcernReasons(){return l(m(this.implementation.array("reportConcernReasons")))}get reportProblemEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-report-problem-enabled"))&&void 0!==e&&e}get productPageReportProblemURL(){return this.implementation.string("product-page-report-problem-url")}get productPageReportProblemSADSubscriptionArray(){return l(m(this.implementation.array("product-page-report-problem-sad-subscriptions")))}get productPageReportProblemSecondPartyAppArray(){const e=l(m(this.implementation.array("product-page-report-problem-second-party-apps")))
return o(e)?["1473505534","1416238567","640199958","1529498570","915061776","1130498044","1070072560"]:e}get createAccountUrl(){var e
return null!==(e=this.implementation.url("createAccountUrl"))&&void 0!==e?e:qC}get mediaCountryCode(){return this.implementation.string("countryCode")}get mediaHost(){return this.implementation.url("apps-media-api-host")}mediaEdgeHost(e){return e.host.clientIdentifier===GC?this.implementation.url(PL):this.implementation.string(PL)}get mediaAPICatalogMixedShouldUseEdge(){var e
return null!==(e=this.implementation.boolean("apps-media-api-catalog-mixed-should-use-edge"))&&void 0!==e&&e}get mediaEdgeSearchHost(){return this.implementation.string("apps-media-api-search-edge-host")}get mediaPreviewHost(){return this.implementation.string("apps-media-api-preview-host")}get mediaRealmHost(){return this.implementation.string("notification-settings-media-api-host")}get edgeEndpoints(){return l(m(this.implementation.array("apps-media-api-edge-end-points")))}get mediaAdvertRequestLimit(){var e
return null!==(e=this.implementation.double("apps-media-api-search-ads-limit"))&&void 0!==e?e:4}get searchSortOptions(){return l(m(this.implementation.array("searchSortOptions")))}get ageBands(){return l(m(this.implementation.array("ageBands")))}get redirectUrlWhitelistedQueryParams(){let e=l(m(this.implementation.array("processRedirectUrl/whitelistedQueryParams")))
return o(e)&&(e=["affC",dC,"advp","at","ct","itsct","itscg","itscc","itcCt",uC,"ls","partnerId","pt","qtkid","uo"]),e}get redirectUrlEndpoint(){var e
return null!==(e=this.implementation.string("processRedirectUrl/endpoint"))&&void 0!==e?e:"https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl"}get aristotleParentAppAdamId(){var e
return null!==(e=this.implementation.string("aristotle-app-id"))&&void 0!==e?e:"383941000"}get arcadeAppAdamId(){return this.implementation.string("app-store-app-id")}get arcadeProductFamilyId(){var e
return null!==(e=this.implementation.string("arcade-iap-family-id"))&&void 0!==e?e:this.implementation.string("ocelot-iap-family-id")}get arcadeProductId(){var e
return null!==(e=this.implementation.string("arcade-iap-offer-name"))&&void 0!==e?e:this.implementation.string("ocelot-iap-offer-name")}get arcadeCategoryBarSAGUpliftDisplayRate(){var e
return null!==(e=this.implementation.double("arcade-category-bar-see-all-games-display-rate"))&&void 0!==e?e:0}get isArcadeEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-enabled"))&&void 0!==e&&e}get isAppsGroupingTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-groupings-tags-enabled"))&&void 0!==e&&e}get isAppsProductPageTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-product-page-tags-enabled"))&&void 0!==e&&e}get isAppsSlpTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-slp-tags-enabled"))&&void 0!==e&&e}get searchResultsLearnMoreEditorialId(){return this.implementation.string("transparencyLawEditorialItemId")}get systemApps(){return l(m(this.implementation.array("hideableSystemApps")))}get nonDeletableSystemApps(){const e=m(this.implementation.array("nonDeletableSystemApps"))
return s(e)?l(e):[{id:1635387927,"bundle-id":Zm},{id:1635862301,"bundle-id":Qm},{id:1584216343,"bundle-id":"com.apple.findmy.finddevices"},{id:1584215960,"bundle-id":"com.apple.NanoWorldClock"},{id:1584215812,"bundle-id":"com.apple.HeartRate"},{id:1584215851,"bundle-id":"com.apple.SessionTrackerApp"},{id:1146562108,"bundle-id":"com.apple.NanoPhone"},{id:1146560473,"bundle-id":"com.apple.MobileSMS"},{id:1584215428,"bundle-id":"com.apple.NanoPhotos"},{id:1459455352,"bundle-id":Km},{id:1067456176,"bundle-id":Jm}]}get tabsStandard(){return l(m(this.implementation.array("tabs/standard")))}get watchAppsGroupingURL(){var e
return null!==(e=this.implementation.url("watchAppsGrouping"))&&void 0!==e?e:"https://apps.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=1472048385"}get requireAgeVerification(){return this.implementation.boolean("requireAgeVerification")}get ageRatingLearnMoreEditorialItemId(){return this.implementation.string("ageRatingLearnMoreEditorialItemId")}get appleSiliconMacUnverifiedBadgeEditorialItemId(){return this.implementation.string("appleSiliconMacUnverifiedBadgeEditorialItemId")}get safariExtensionsGroupingURL(){return this.implementation.url("safariExtensionsGrouping")}get familySubscriptionsLearnMoreEditorialItemId(){return this.implementation.string("familySubscriptionsLearnMoreEditorialItemId")}get dynamicUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/dynamic-url-patterns")))}get financeUIRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/url-patterns")))}get webViewRegexStrings(){return l(m(this.implementation.array("commerce-ui-urls/v2-url-patterns")))}get arcadePreOrderUpsellLimitSeconds(){var e
return null!==(e=this.implementation.double("arcadePreOrderUpsellLimitSeconds"))&&void 0!==e?e:86400}get recentlyPlayedGamesWindowInSeconds(){var e
return null!==(e=this.implementation.double("recentlyPlayedGamesWindowInSeconds"))&&void 0!==e?e:7776e3}get gamesFriendsPlayedWindowInSeconds(){var e
return null!==(e=this.implementation.integer("games-friends-played-window-in-seconds"))&&void 0!==e?e:15778800}get enableComingSoonToggle(){return this.implementation.boolean("enableComingSoonToggle")}get enableAppAccessibilityLabels(){var e
return null!==(e=this.implementation.boolean("enable-app-accessibility-labels"))&&void 0!==e&&e}get enablePrivacyNutritionLabels(){var e
return null!==(e=this.implementation.boolean("enable-privacy-nutrition-labels"))&&void 0!==e&&e}get enableSellerInfo(){var e
return null!==(e=this.implementation.boolean("enable-seller-info"))&&void 0!==e&&e}get enableSellerICPAnnotation(){var e
return null!==(e=this.implementation.boolean("enable-seller-icp"))&&void 0!==e&&e}get enableFeaturedCategoriesOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-featured-categories-on-groupings"))&&void 0!==e&&e}get enableCategoryBricksOnGroupings(){var e
return null!==(e=this.implementation.boolean("enable-category-bricks-on-groupings"))&&void 0!==e&&e}get arcadeOfferEditorialItemId(){return this.implementation.string("arcadeOfferEditorialItemId")}get sponsoredSearchODMLTimeout(){var e
return null!==(e=this.implementation.double("sponsored-search-odml-timeout"))&&void 0!==e?e:3}get isSearchLandingAdsEnabled(){var e
return null!==(e=this.implementation.boolean("isSearchLandingAdsEnabled"))&&void 0!==e&&e}get isLLMSearchTagsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-tags-enabled"))&&void 0!==e&&e}get searchLandingAdFetchTimeout(){var e
return null!==(e=this.implementation.double("search-landing-ad-fetch-timeout"))&&void 0!==e?e:.175}get searchLandingPageOffscreenRefreshInterval(){var e
return null!==(e=this.implementation.double("search-landing-offscreen-refresh-interval-in-seconds"))&&void 0!==e?e:60}get searchLandingPageRefreshUpdateDelayInterval(){var e
return null!==(e=this.implementation.double("search-landing-page-update-delay-interval-in-seconds"))&&void 0!==e?e:.3}get appPrivacyLearnMoreEditorialItemId(){return this.implementation.string("appPrivacyLearnMoreEditorialItemId")}get ratingsAndReviewsLearnMoreEditorialId(){return this.implementation.string("ratings-and-reviews-learn-more-editorial-item-id")}get reviewSummarizationLearnMoreEditorialItemId(){return this.implementation.string("review-summarization-learn-more-editorial-item-id")}get suppressedPrivacyAppIds(){return l(m(this.implementation.array("suppressedPrivacyLabels")))}get suppressedAccessibilityAppIds(){return l(m(this.implementation.array("suppressed-accessibility-labels")))}get appPrivacyDefinitionsEditorialItemId(){return this.implementation.string("appPrivacyDefinitionsEditorialItemId")}get todayWidgetLivePreviewRolloutRate(){var e
return null!==(e=this.implementation.double("todayWidgetLivePreviewRolloutRate"))&&void 0!==e?e:1}get hero3RolloutRate(){var e
return null!==(e=this.implementation.double("arcade-hero-shelf-tagline-style-rollout-rate"))&&void 0!==e?e:1}get arcadeTrialEnrolledStateRate(){var e
return null!==(e=this.implementation.double("arcade-trial-enrolled-state-rate"))&&void 0!==e?e:0}get marketingItemSelectionTimeout(){var e
return null!==(e=this.implementation.double("marketing-item-selection-timeout"))&&void 0!==e?e:1}get enableAppEvents(){var e
return null!==(e=this.implementation.boolean("enableAppEvents"))&&void 0!==e&&e}get enableProductPageVariants(){var e
return null!==(e=this.implementation.boolean("enableProductPageVariants"))&&void 0!==e&&e}get enableArcadeTrialEligibleBadging(){return this.implementation.boolean("enable-arcade-trial-eligible-badging")}get heroCarouselAutoScrollDuration(){var e
return null!==(e=this.implementation.double("heroCarouselAutoScrollDuration"))&&void 0!==e?e:7}get enableAdditionalLoggingForPPV(){var e
return null!==(e=this.implementation.boolean("enableAdditionalLoggingForPPV"))&&void 0!==e&&e}get enableOnDevicePersonalization(){const e=this.implementation.boolean("enable-on-device-personalization")
return!!r(e)||e}get enableAutomaticPageRefresh(){var e
return null===(e=this.implementation.boolean("enable-automatic-page-refresh"))||void 0===e||e}get widgetSuggestionsFromTodayTabRolloutRate(){var e
return null!==(e=this.implementation.double("today-widget-suggestions-from-today-tab-rollout-rate"))&&void 0!==e?e:1}get todayWidgetSmartStackJitterMinutes(){var e
return null!==(e=this.implementation.double("today-widget-smart-stack-jitter-minutes"))&&void 0!==e?e:45}get enableSystemAppReviews(){var e
return null!==(e=this.implementation.boolean("enable-system-app-reviews"))&&void 0!==e&&e}get enableCPPInSearchAds(){return this.implementation.boolean("enableCPPsInSearchAds")||!1}get cancelPreorderItemSrv(){return this.implementation.url("cancelPreorderItemSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancel"}get getCancellablePreorderItemsSrv(){return this.implementation.url("getCancellablePreorderItemsSrv")||"https://buy.itunes.apple.com/commerce/preorders/cancellable"}get enabledAdPlacements(){return l(m(this.implementation.array("enabled-ad-placements")))}get adPlacementTimeouts(){return h(y(this.implementation.dictionary("ad-placement-timeouts")))}get inAppPurchasesLearnMoreEditorialItemId(){return this.implementation.string("in-app-purchases-learn-more-editorial-item-id")}get enableExternalPurchases(){var e
return null!==(e=this.implementation.boolean("enable-external-purchase"))&&void 0!==e&&e}get enabledExternalPurchasesPlacements(){return l(m(this.implementation.array("enabled-external-purchase-placements")))}get externalPurchasesLearnMoreEditorialItemId(){return this.implementation.string("external-purchase-learn-more-editorial-item-id")}get externalBrowserLearnMoreEditorialItemId(){return this.implementation.string("external-browser-learn-more-editorial-item-id")}get sharePlayAppsEditorialItemId(){return this.implementation.string("share-play-apps-editorial-item-id")}get externalPurchasesIncludeProductPageBannerIcon(){var e
return null!==(e=this.implementation.boolean("external-purchase-product-page-banner-include-icon"))&&void 0!==e&&e}get externalPurchasesProductPageAnnotationVariant(){return this.implementation.string("external-purchase-product-page-annotation-variant")}get newEventsForODJAreEnabled(){var e
return null!==(e=this.implementation.boolean("new-events-for-odj-are-enabled"))&&void 0!==e&&e}get defaultChart(){return y(this.implementation.dictionary("default-chart"))}get accountUrl(){var e
return null!==(e=this.implementation.url("accountUrl"))&&void 0!==e?e:SC}get redeemUrl(){var e
return null!==(e=this.implementation.url("redeemUrl"))&&void 0!==e?e:PC}get charityUrl(){var e
return null!==(e=this.implementation.url("charityUrl"))&&void 0!==e?e:"https://buy.itunes.apple.com/WebObjects/MZFinance.woa/wa/buyCharityGiftWizard"}get manageSubscriptionsUrl(){var e
return null!==(e=this.implementation.url("manageSubscriptionsUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/subscriptions/manage?context=deeplink"}get manageSubscriptionsV2Url(){var e
return null!==(e=this.implementation.url("manageSubscriptionsV2Url"))&&void 0!==e?e:"https://apps.mzstatic.com/content/54a1317a0ad442d3965d64ef6bfaae1c/"}get adsOverrideLanguage(){return this.implementation.string("ads-override-language")}get gameControllerRecommendedRolloutRate(){var e
return null!==(e=this.implementation.double("game-controller-recommended-rollout-rate"))&&void 0!==e?e:0}get gameControllerLearnMoreEditorialItemId(){return this.implementation.string("game-controller-learn-more-editorial-item-id")}get spatialControlsLearnMoreEditorialItemId(){return this.implementation.string("spatial-controllers-learn-more-editorial-item-id")}get mediaAPISearchFocusEnabled(){var e
return null!==(e=this.implementation.boolean("apps-search-focus-suggestions-enabled"))&&void 0!==e&&e}get supportsSearchLandingPageV2(){var e
return null!==(e=this.implementation.boolean("supports-apps-slp-v2"))&&void 0!==e&&e}get enableSearchLandingPageV2ByTreatment(){var e
return null!==(e=this.implementation.boolean("enable-apps-slp-v2-by-treatment"))&&void 0!==e&&e}get searchLandingPageV2RolloutRate(){var e
return null!==(e=this.implementation.double("apps-slp-v2-rollout-rate"))&&void 0!==e?e:0}get todayTabArcadePersonalizationRate(){var e
return null!==(e=this.implementation.double("today-tab-arcade-personalization-rate"))&&void 0!==e?e:0}get gameCenterExtendSupportedFeatures(){var e
return null!==(e=this.implementation.boolean("game-center-extend-supported-features"))&&void 0!==e&&e}get adPlacementEligibleSlotPositions(){const e=y(this.implementation.dictionary("ad-placement-eligible-slot-positions"))
return s(e)?e:{today:[{shelfIdentifier:"0",slot:0},{shelfIdentifier:"0",slot:1}],"product-page-ymal":[{shelfIdentifier:$B,slot:0}]}}get managePreordersUrl(){var e
return null!==(e=this.implementation.url("preordersUrl"))&&void 0!==e?e:"https://finance-app.itunes.apple.com/preorders"}get modifyAccount(){var e
return null!==(e=this.implementation.url("modifyAccount"))&&void 0!==e?e:SC}get purchaseHistoryUrl(){return this.implementation.url("purchaseHistoryUrl")}get signup(){var e
return null!==(e=this.implementation.url(Gm))&&void 0!==e?e:qC}get redeemCodeLanding(){var e
return null!==(e=this.implementation.url("redeemCodeLanding"))&&void 0!==e?e:PC}get reportProblemUrl(){return this.implementation.string("reportProblemUrl")}get unrestrictedServerSideTabBadging(){var e
return null!==(e=this.implementation.boolean("unrestricted-server-side-tab-badging"))&&void 0!==e&&e}get todayAdCondensedEnabled(){var e
return null!==(e=this.implementation.boolean("today-ad-condensed-enabled"))&&void 0!==e&&e}get enableVisionAppStoreBinCompatChecks(){var e
return null!==(e=this.implementation.boolean("enable-vision-app-store-bincompat-checks"))&&void 0!==e&&e}get safariExtensionsEditorialPageId(){return this.implementation.url("safari-extensions-editorial-page-id")}get buddyOnboardingEditorialItemId(){return this.implementation.string("buddy-onboarding-editorial-item-id")}get productPageFriendsPlayingClickEventsEnabled(){var e
return null!==(e=this.implementation.boolean("product-page-friends-playing-click-events-enabled"))&&void 0!==e&&e}get highMotionLearnMoreEditorialItemId(){return this.implementation.string("high-motion-learn-more-editorial-item-id")}get todayAdMediumLockupScreenshotsRiverSpeed(){return this.implementation.double("today-ad-medium-lockup-screenshots-river-speed")}get arcadeDownloadPackCategoriesCollectionId(){return this.implementation.string("arcade-download-packs-onboarding-collection-id")}get arcadeDownloadPackShelfTTLInSeconds(){var e
return null!==(e=this.implementation.integer("arcade-starter-pack-ttl-in-seconds"))&&void 0!==e?e:0}get enableOfferItems(){var e
return null!==(e=this.implementation.boolean("enable-winback-offers"))&&void 0!==e&&e}get appDistributionMediaAPIHost(){return this.implementation.string("app-distribution-media-api-host")}get appDistributionLanguageTag(){return this.implementation.string("app-distribution-language-tag")}get supportsAppDistribution(){var e
return null!==(e=this.implementation.boolean("supports-app-distribution"))&&void 0!==e&&e}get arcadeDownloadPackPostSubscribeTrigger(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-post-subscribe-trigger"))||void 0===e||e}get enableContingentOffers(){var e
return null!==(e=this.implementation.boolean("enable-contingent-offers"))&&void 0!==e&&e}get arcadeDownloadPackRolloutRate(){var e
return null!==(e=this.implementation.double("arcade-download-packs-rollout-rate"))&&void 0!==e?e:0}get enableVisionPlatform(){var e
return null!==(e=this.implementation.boolean("enable-vision-platform"))&&void 0!==e&&e}get supportedMixedMediaRequestUsecases(){var e
return null!==(e=h(y(this.implementation.dictionary("supported-mixed-media-request-usecases"))))&&void 0!==e?e:{}}get arcadeDownloadPacksMetricsEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-metrics-events-enabled"))||void 0===e||e}get arcadeDownloadPacksImpressionEventsEnabled(){var e
return null===(e=this.implementation.boolean("arcade-download-packs-impression-events-enabled"))||void 0===e||e}get visionOnlyAppLearnMoreEditorialItemId(){return this.implementation.string("vision-only-app-learn-more-editorial-item-id")}get arcadeDownloadPacksCIPDeeplinkIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-cip-deeplink-trigger"))&&void 0!==e&&e}get arcadeDownloadPacksHardwareTabBadgeUpsellIntegrationEnabled(){var e
return null!==(e=this.implementation.boolean("arcade-download-packs-hw-tabbadge-trigger"))&&void 0!==e&&e}get aboutAppStoreUrl(){return this.implementation.string("about-app-store-url")}get aboutInAppPurchasesEditorialItemId(){return this.implementation.string("about-in-app-purchases-editorial-item-id")}get requestARefundUrl(){return this.implementation.string("request-a-refund-url")}get personalizedRecommendationsToggleEnabled(){var e
return null!==(e=this.implementation.boolean("enable-personalized-recommendations-toggle"))&&void 0!==e&&e}get metricsIdMigrationEnabled(){var e
return null===(e=this.implementation.boolean("metrics-id-migration-enabled"))||void 0===e||e}get isNaturalLanguageSearchEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-enabled"))&&void 0!==e&&e}get isNaturalLanguageSearchResultsEnabled(){var e
return null!==(e=this.implementation.boolean("apps-natural-language-search-results-enabled"))&&void 0!==e&&e}get metricsIdentifiersShouldCache(){var e
return null===(e=this.implementation.boolean("metrics-identifiers-should-cache"))||void 0===e||e}get changePaymentMethodUrl(){return this.implementation.string("change-payment-method-url")}get aboutFrenchAppStoreEditorialItemId(){return this.implementation.string("about-app-store-editorial-item-id")}get isOnDemandShelfFetchingEnabled(){var e
return null===(e=this.implementation.boolean("on-demand-product-shelf-fetching-enabled"))||void 0===e||e}get isMetricsUserIdFallbackEnabled(){var e
return null!==(e=this.implementation.boolean("metrics-user-id-fallback-enabled"))&&void 0!==e&&e}get isMetricsAb2DataFallbackEnabled(){var e
return null===(e=this.implementation.boolean("metrics-ab2data-fallback-enabled"))||void 0===e||e}get enableRecoOnDeviceReordering(){var e
return null!==(e=this.implementation.boolean("enable-on-device-reco-reordering"))&&void 0!==e&&e}get ribbonBarVisionEditorialItemIds(){return l(m(this.implementation.array("ribbon-bar-vision-editorial-item-ids")))}get searchFilterEditorialItemIds(){const e=l(m(this.implementation.array("search-filter-editorial-item-ids")))
return new Set(e)}get accessibilityLearnMoreEditorialItemId(){return this.implementation.string("accessibility-learn-more-editorial-item-id")}get enableDeviceDrivenDiscoveryContent(){var e
return null!==(e=this.implementation.boolean("enable-device-driven-discovery-content"))&&void 0!==e&&e}get enableProductPageInstallSize(){var e
return null!==(e=this.implementation.boolean("enable-product-page-install-size"))&&void 0!==e&&e}get enableIconArtwork(){var e
return null!==(e=this.implementation.boolean("enable-icon-artwork"))&&void 0!==e&&e}get iconArtworkRolloutRate(){var e
return null!==(e=this.implementation.double("icon-artwork-rollout-rate"))&&void 0!==e?e:0}get enableUpdatedAgeRatings(){var e
return null!==(e=this.implementation.boolean("enable-app-store-age-ratings"))&&void 0!==e&&e}get enableAgeRatingFilter(){var e
return null!==(e=this.implementation.boolean("enable-age-rating-filter"))&&void 0!==e&&e}get enableTwoPhaseOfferConfirmation(){var e
return null!==(e=this.implementation.boolean("enable-two-phase-offer-confirmation"))&&void 0!==e&&e}get externalPurchasesProductPageBannerTextVariant(){return this.implementation.string("external-purchase-product-page-banner-text-variant")}get externalPurchasesProductPageBannerIconVariant(){return this.implementation.string("external-purchase-product-page-banner-icon-variant")}get maxGamesForFetchingEvents(){var e
return null!==(e=this.implementation.integer("max-games-for-fetching-events"))&&void 0!==e?e:30}get mockHomeFeedURL(){return this.implementation.string("mock-home-feed-url")}get disablePlayTogetherEndpoint(){var e
return null!==(e=this.implementation.boolean("disable-play-together-endpoint"))&&void 0!==e&&e}get metricsTopic(){var e
{const t="xp_ase_appstore_ue"
return null!==(e=this.implementation.string("metrics_topic"))&&void 0!==e?e:t}}get playTogetherGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("play-together-arcade-game-recommendations"))&&void 0!==e?e:"1803255513"}get playTogetherGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("play-together-non-arcade-game-recommendations"))&&void 0!==e?e:"1804480915"}get multiplayerActivityGameRecommendationsArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-arcade-game-recommendations"))&&void 0!==e?e:"1821553042"}get multiplayerActivityGameRecommendationsNonArcade(){var e
return null!==(e=this.implementation.string("multiplayer-activity-non-arcade-game-recommendations"))&&void 0!==e?e:"1821553152"}get showArcadeSubscriberAccessBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-subscriber-access-badge"))&&void 0!==e&&e}get showArcadeNonSubscriberBadge(){var e
return null!==(e=this.implementation.boolean("show-arcade-non-subscriber-badge"))&&void 0!==e&&e}get gamesCrossUseConsentLearnMoreURL(){return this.implementation.string("games-crossuse-consent-learn-more-url")}get gamesPlayNowHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesPlayNowHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-play-now-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get gamesEditorialHeroCarouselAutoAdvanceInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-interval"))&&void 0!==e?e:10}get gamesEditorialHeroCarouselAutoAdvanceMaxInterval(){var e
return null!==(e=this.implementation.double("games-editorial-hero-carousel-auto-advance-max-interval"))&&void 0!==e?e:30}get enablePreviewPlatformForWeb(){var e
return null!==(e=this.implementation.boolean("enable-preview-platform-for-web"))&&void 0!==e&&e}get completedChallengesInActiveShelfTimeThreshold(){var e
return null!==(e=this.implementation.integer("completed-challenges-in-active-shelf-time-threshold"))&&void 0!==e?e:86400}get requestReviewEnabled(){var e
return null===(e=this.implementation.boolean("request-review-enabled"))||void 0===e||e}get requestReviewMinAppLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-app-launch-count"))&&void 0!==e?e:15}get requestReviewMinGameLaunchCount(){var e
return null!==(e=this.implementation.integer("request-review-min-game-launch-count"))&&void 0!==e?e:5}get enableLicenses(){var e
return null!==(e=this.implementation.boolean("enable-licenses"))&&void 0!==e&&e}get chartDetailPageItemCount(){var e
return null!==(e=this.implementation.integer("chart-detail-page-item-count"))&&void 0!==e?e:25}get enableIPadOnlyFallbackIcons(){var e
return null!==(e=this.implementation.boolean("enable-ipad-only-fallback-icons"))&&void 0!==e&&e}}pq.type=(0,Pv.makeMetatype)("app-store:bag-wrapper")
class hq{constructor(){this.$incidents=void 0}isValid(){return!0}}class wq extends hq{constructor(e=null){super(),this.impressionMetrics=e}}class gq extends hq{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,p,h,w,g,v,m,y,A,T,b){super(),this.buyParams=e,this.vendor=t,this.appName=n,this.bundleId=r,this.appPlatforms=o,this.isPreorder=null!=i&&i,this.excludeAttribution=null==s||s,this.metricsPlatformDisplayStyle=a,this.isRedownload=null!=l&&l,this.lineItem=c,this.preflightPackageUrl=void 0===u?null:u,this.isArcadeApp=d,this.isHalva=f,this.supportsVisionOSCompatibleIOSBinary=p,this.inAppEventId=h,this.extRefApp2=w,this.extRefUrl2=g,this.additionalHeaders=v,this.appCapabilities=m,this.isDefaultBrowser=y,this.remoteDownloadIdentifiers=A,this.hasMacIPAPackage=T,this.contentRating=b}}class vq extends hq{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,p,h,w,g,v,m,y,A,T,b,S=!1,P=!1){super(),this.offerType=e,this.adamId=t,this.bundleId=n,this.parentAdamId=o,this.style=null==r?pV:r,this.environment=null==i?UV:i,this.offerTint=null==s?{type:DD}:s,this.titles=null==a?{}:a,this.titleSymbolNames=null==c?{}:c,this.subtitles=null==l?{}:l,this.hasInAppPurchases=u,this.hasExternalPurchases=d,this.isDeletableSystemApp=f,this.isFree=p,this.isPreorder=h,this.offerLabelStyle=null==w?qV:w,this.hasDiscount=g,this.contentRating=v,this.subscriptionFamilyId=m,this.useAdsLocale=y,this.priceFormatted=A,this.isStreamlinedBuy=T,this.appCapabilities=b,this.isRedownloadDisallowed=S,this.isOpenBundleAllowed=P}newOfferDisplayPropertiesChangingAppearance(e,t,n,r){return new vq(this.offerType,this.adamId,this.bundleId,null==t||!e&&this.style===kN?this.style:t,this.parentAdamId,null==n?this.environment:n,null==r?this.offerTint:r,this.titles,this.titleSymbolNames,this.subtitles,this.hasInAppPurchases,this.hasExternalPurchases,this.isDeletableSystemApp,this.isFree,this.isPreorder,this.offerLabelStyle,this.hasDiscount,this.contentRating,this.subscriptionFamilyId,this.useAdsLocale,this.priceFormatted,this.isStreamlinedBuy,this.appCapabilities,this.isRedownloadDisallowed,this.isOpenBundleAllowed)}}class mq extends hq{constructor(e,t,n){super(),this.offerAction=t,this.offerDisplayProperties=n,this.personalizedOfferType=e}}!function(e){e[e.scaleToFill=0]="scaleToFill",e[e.scaleAspectFit=1]="scaleAspectFit",e[e.scaleAspectFill=2]="scaleAspectFill",e[e.redraw=3]="redraw",e[e.center=4]="center",e[e.top=5]="top",e[e.bottom=6]="bottom",e[e.left=7]="left",e[e.right=8]="right",e[e.topLeft=9]="topLeft",e[e.topRight=10]="topRight",e[e.bottomLeft=11]="bottomLeft",e[e.bottomRight=12]="bottomRight"}(Ov||(Ov={}))
class yq extends hq{constructor(e,t,n){super(),this.format=e,this.quality=t,this.supportsWideGamut=n}isValid(){return this.format&&void 0!==this.supportsWideGamut}}class Aq extends hq{constructor(e,t,n,r,o,i){super(),this.checksum=null,this.backgroundColor=null,this.textColor=null,this.style=null,this.crop="bb",this.contentMode=null,this.imageScale=null,this.template=e,this.width=t,this.height=n,this.variants=r,this.backgroundColor=o,this.textColor=i}isPortrait(){return this.height>=this.width}isLandscape(){return!this.isPortrait()}isValid(){return""!==this.template&&this.width>0&&this.height>0&&this.variants.length>0}}class Tq extends hq{constructor(e,t){super(),this.artwork=e,this.mediaPlatform=t}}class bq extends hq{constructor(e,t,n,r,o,i,s){super(),this.appPlatform=e,this.supplementaryAppPlatforms=r||[],this.deviceCornerRadiusFactor=o,this.mediaType=t,this.systemImageName=n,this.deviceBorderThickness=i,this.outerDeviceCornerRadiusFactor=s}isEqualTo(e){this.supplementaryAppPlatforms.sort(),e.supplementaryAppPlatforms.sort()
const t=this.supplementaryAppPlatforms.join(",")===e.supplementaryAppPlatforms.join(",")
return e.appPlatform===this.appPlatform&&e.mediaType===this.mediaType&&e.systemImageName===this.systemImageName&&t&&e.deviceCornerRadiusFactor===this.deviceCornerRadiusFactor}}class Sq{constructor(e,t){this.width=e,this.height=t}static fromNativeSize(e){return new Sq(e.width,e.height)}isEqualTo(e){return e.width===this.width&&e.height===this.height}}class Pq extends hq{constructor(e,t,n,r,o,i){super(),this.itemName=e,this.url=t,this.developer=n,this.category=r,this.fileSize=o,this.mediaType=i}}class Iq extends hq{constructor(e,t,n,r){super(),this.context=XV,this.id=e,this.text=t,this.subtitle=n,this.artwork=r}}class Cq extends hq{constructor(e,t,n){super(),this.context=CF,this.text=e,this.subtitle=t,this.artwork=n}}class kq extends hq{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(),this.context=Jj,this.adamId=e,this.storeFrontIdentifier=t,this.name=n,this.platform=r,this.icon=o,this.screenshots=i,this.videos=s,this.isMessagesOnlyApp=a,this.subtitle=c,this.genreName=l,this.messagesAppIcon=u,this.notesMetadata=d}}class Oq extends hq{constructor(e,t,n){super(),this.context=WU,this.text=e,this.subtitle=t,this.artwork=n}}class Eq extends hq{constructor(e,t,n){super(),this.metadata=e,this.url=t,this.shortUrl=n}}class Rq extends hq{constructor(e,t,n){super(),this.reasonId=e,this.name=t,this.uppercaseName=n}}class Dq extends hq{constructor(e,t=mj){super(),this.rawText=e,this.rawTextType=t}}class _q extends wq{constructor(e,t,n){super(),this.text=e,this.mediaType=t||mj,this.style=n||LH,this.alignment="localized",this.isCollapsed=!1,this.suppressVerticalMargins=!1,this.wantsCollapsedNewlines=!0}}class xq extends hq{constructor(e,t=null,n=null){super(),this.actions=e,this.offerDisplayProperties=t,this.offerActionIndex=n}}class Lq extends wq{}class Mq extends wq{}class $q extends hq{constructor(e){super(),this.isFallbackStyle=!1,this.type=e}}class Fq extends wq{constructor(e,t,n,r,o,i){super(),this.bundleId=e,this.completedAchievements=t,this.totalAchievements=n,this.completedText=r,this.action=o,this.achievements=i}}class Nq extends wq{constructor(e,t,n,r,o,i,s,a){super(),this.id=e,this.title=t,this.subtitle=n,this.buttonText=r,this.contactId=o,this.buttonAction=i,this.removeButtonAction=s,this.shouldShowMessagesBadge=a}}class Bq extends hq{constructor(e){super(),this.type=e}}class Uq extends hq{constructor(e,t,n,r){super(),this.id=e,this.title=t,this.subtitle=n,this.status=r}}class Gq extends hq{constructor(e,t,n,r){super(),this.adamId=e,this.platformId=t,this.isArcade=n,this.records=r}}class jq extends hq{constructor(e,t){super(),this.playerId=e,this.timestamp=t}}class Vq extends hq{constructor(e,t,n){super(),this.videoUrl=e,this.preview=t,this.allowsAutoPlay=n.allowsAutoPlay,this.looping=n.looping,this.canPlayFullScreen=n.canPlayFullScreen,this.playbackControls={...n.playbackControls},this.autoPlayPlaybackControls={...n.autoPlayPlaybackControls},this.templateMediaEvent=null}}class Hq{constructor(e,t,n,r){this.fileSizeByDevice=e,this.maxDownloadSizeInBytes=t,this.maxInstallSizeInBytes=n,this.maxEssentialInstallSizeInBytes=r}}class qq extends wq{constructor(e,t,n){super(),this.badge=e,this.title=t,this.subtitle=n}}class Wq extends qq{constructor(e,t,n,r,o,i,s,a,c,l){super(e,t,n),this.artwork=r,this.video=o,this.collectionIcons=i,this.useGeneratedBackgroundGradient=s,this.backgroundColor=a,this.style=c,this.backgroundStyle=l}}const zq={top:0,left:0,bottom:0,right:0}
!function(e){e.Mini="mini",e.ExtraWide="extraWide",e.None="none"}(Ev||(Ev={})),function(e){e.TopRight="topRight",e.TopLeft="topLeft",e.MiddleLeft="middleLeft"}(Rv||(Rv={})),function(e){e.SquareByWidth="squareByWidth",e.SquareByHeight="squareByHeight",e.FreeForm="freeForm"}(Dv||(Dv={}))
class Yq{constructor(e,t,n,r,o){this.width=e,this.height=t,this.asRatioOfSize=null!=n&&n,this.location=r,this.constraint=o}}Yq.defaultTileArtworkSafeArea={width:.4,height:.4,asRatioOfSize:!0,constraint:Dv.SquareByWidth,location:{relativeLocation:Rv.TopRight}},Yq.defaultPillArtworkSafeArea={width:.28,height:1,asRatioOfSize:!0,constraint:Dv.FreeForm,location:{relativeLocation:Rv.MiddleLeft}},Yq.defaultTileTextSafeArea={width:.15,height:0,asRatioOfSize:!0},Yq.defaultPillTextSafeArea={width:.28,height:0,asRatioOfSize:!0}
class Jq{constructor(){this.clearCache=()=>{this.cache={}},this.cache={}}get(e,t){return t()}}const Kq="com.apple.AppStore",Zq="com.apple.AppStore.BridgeStoreExtension",Qq="com.apple.MobileSMS",Xq="com.apple.Arcade",eW="com.apple.TVAppStore",tW="com.apple.AppStore.ProductPageExtension"
class nW extends uq{get buildType(){return nW.cache.get("buildType",()=>this.implementation.buildType)}get buildVersion(){return this.implementation.buildVersion}get deviceType(){return nW.cache.get("deviceType",()=>this.implementation.deviceType)}get guid(){return this.implementation.guid}get isActivityAvailable(){return this.implementation.isActivityAvailable}get isElectrocardiogramInstallationAllowed(){return this.implementation.isElectrocardiogramInstallationAllowed}get isScandiumInstallationAllowed(){return this.implementation.isScandiumInstallationAllowed}get isSidepackingEnabled(){return this.implementation.isSidepackingEnabled}get isTinkerWatch(){return nW.cache.get("isTinkerWatch",()=>this.implementation.isTinkerWatch)}get screenCornerRadius(){return nW.cache.get("screenCornerRadius",()=>this.implementation.screenCornerRadius)}get screenSize(){return nW.cache.get("screenSize",()=>Sq.fromNativeSize(this.implementation.screenSize))}get storefrontIdentifier(){return this.implementation.storefrontIdentifier}get supportsHEIF(){return nW.cache.get("supportsHEIF",()=>this.implementation.supportsHEIF)}get thinnedApplicationVariantIdentifier(){return nW.cache.get("thinnedApplicationVariantIdentifier",()=>this.implementation.thinnedApplicationVariantIdentifier)}get isMandrakeSupported(){return this.implementation.isMandrakeSupported}get isCharonSupported(){return this.implementation.isCharonSupported}get maxAppContentRating(){return this.implementation.maxAppContentRating}get hostBundleId(){return nW.cache.get("hostBundleId",()=>this.implementation.hostBundleId)}isPairedSystemVersionAtLeast(e){var t,n,r
return null!==(r=null===(n=(t=this.implementation).isPairedSystemVersionAtLeast)||void 0===n?void 0:n.call(t,e))&&void 0!==r&&r}deletableSystemAppCanBeInstalledOnWatchWithBundleID(e){return this.implementation.deletableSystemAppCanBeInstalledOnWatchWithBundleID(e)}deviceHasCapabilities(e){return this.implementation.deviceHasCapabilities(e)}deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t){return(!this.isPad||!e.includes("healthkit"))&&this.implementation.deviceHasCapabilitiesIncludingCompatibilityCheckIsVisionOSCompatibleIOSApp(e,t)}isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n){return this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(e,t,n)}canDevicePerformAppActionWithAppCapabilities(e,t){return this.implementation.canDevicePerformAppActionWithAppCapabilities(e,t)}isAutomaticDownloadingEnabled(){return this.implementation.isAutomaticDownloadingEnabled()}isAuthorizedForUserNotifications(){return this.implementation.isAuthorizedForUserNotifications()}isActivePairedWatchSystemVersionBelow(e){const t=e.split("."),n=p(t[0])||0,r=p(t[1])||0,o=p(t[2])||0
return!this.implementation.isActivePairedWatchSystemVersionAtLeastMajorVersionMinorVersionPatchVersion(n,r,o)}get isPhone(){return this.deviceType===RH}get isPad(){return this.deviceType===CH}get isiOS(){return this.isPhone||this.isPad}get isMac(){return this.deviceType===$H}get isTV(){return"tv"===this.deviceType}get isWatch(){return this.deviceType===MH}get isVision(){return this.deviceType===kH}get isWeb(){return this.deviceType===JG}get isCompanionVisionApp(){return this.hostBundleId===VC}get remoteDownloadIdentifiers(){return this.implementation.remoteDownloadIdentifiers}}nW.type=(0,Pv.makeMetatype)("app-store:client-wrapper"),nW.cache=new Jq
class rW extends uq{async orderedVisibleIAPs(e,t,n,r){return await new Promise((o,i)=>{const s=t.filter(e=>null!=e),a=n.filter(e=>null!=e)
this.implementation.orderedVisibleIAPs(e,s,a,r,(e,t)=>{t?i(t):o(e)})})}async visibilityForIAPs(e){return await new Promise((t,n)=>{this.implementation.visibilityForIAPs(e,(e,n)=>{t(n?{}:e)})})}}rW.type=(0,Pv.makeMetatype)("app-store:client-ordering-wrapper")
class oW extends uq{info(...e){return this.implementation.info(...e)}error(...e){return this.implementation.error(...e)}log(...e){return this.implementation.log(...e)}warn(...e){return this.implementation.warn(...e)}}oW.type=(0,Pv.makeMetatype)("app-store:console-wrapper")
class iW extends uq{get clientIdentifier(){return iW.cache.get("clientIdentifier",()=>this.implementation.clientIdentifier)}get clientVersion(){return iW.cache.get("clientVersion",()=>this.implementation.clientVersion)}get deviceLocalizedModel(){return this.implementation.deviceLocalizedModel}get deviceModel(){return iW.cache.get("deviceModel",()=>this.implementation.deviceModel)}get deviceModelFamily(){return iW.cache.get("deviceModelFamily",()=>this.implementation.deviceModelFamily)}get devicePhysicalModel(){return iW.cache.get("devicePhysicalModel",()=>this.implementation.devicePhysicalModel)}get deviceMarketingFamilyName(){return iW.cache.get("deviceMarketingFamilyName",()=>this.implementation.deviceMarketingFamilyName)}get osBuild(){return iW.cache.get("osBuild",()=>this.implementation.osBuild)}get platform(){return this.implementation.platform}isOSAtLeast(e,t,n){return this.implementation.isOSAtLeast(e,t,n)}get isiOS(){return this.platform===fj}get isMac(){return this.platform===yj}get isTV(){return this.platform===AU}get isWatch(){return this.platform===Xx}get isWeb(){return this.platform===JG}get isWindows(){return"Windows"===this.platform}get isVision(){return this.platform===eL}}iW.type=(0,Pv.makeMetatype)("app-store:host-wrapper"),iW.cache=new Jq
class sW{constructor(){this.locData={},this.language="en"}updateLocalizationData(e,t){this.locData=e,this.language=t}localize(e,t){let n=this.locData[e]
return void 0!==n&&typeof n===gH||(n=e),t&&(n=this.replaceTokens(n,t)),n=this.replaceMarkupTokens(n,t),n}localizeWithCount(e,t,n,r){let o,i,s=null
return 0===n&&(o=`${t}.zero`,this.isLocalized(e,o)&&(s=o)),null===s&&(s=t,i=this.pluralCategory(e,n),i!==lG&&(o=`${t}.${i}`,this.isLocalized(e,o)&&(s=o))),r||(r={}),void 0===r.count&&(r.count=this.formatNumber(n.toString())),void 0===r.number&&(r.number=this.formatNumber(n.toString())),this.localize(null!=s?s:t,r)}replaceTokens(e,t){return Object.entries(t).forEach(([t,n])=>{const r="@@"+t+"@@"
e=this.replaceSubstring(e,r,n)}),e}replaceMarkupTokens(e,t){if(e.indexOf("##")<=-1)return e
let n
return t?(n={...sW.MARKUP_PARAMS},Object.entries(t).forEach(([e,t])=>{n[e]=t})):n=sW.MARKUP_PARAMS,Object.entries(n).forEach(([t,n])=>{const r="##"+t+"##"
e=e.replace(new RegExp(r,"gi"),n)}),e=e.replace(/##([^##]+)##/gi,"<$1>")}replaceSubstring(e,t,n){return e.split(t).join(n)}formatNumber(e){let t=this.locData._decimalSeparator
void 0!==t&&typeof t===gH||(t=".")
let n=this.locData._thousandsSeparator
void 0!==n&&typeof n===gH||(n=".")
const r=parseFloat(e).toString().split("."),o=r[0].split("")
for(let e=o.length-3;e>0;e-=3)o.splice(e,0,n)
return r[0]=o.join(""),r.join(t)}isLocalized(e,t){const n=this.locData[t]
return void 0!==n&&typeof n===gH&&(-1===t.indexOf(".")||n!==t&&(0!==n.indexOf("**")||n.lastIndexOf("**")!==n.length-2)||(e.console.error("Unlocalized key in keys dictionary",t),!1))}pluralCategory(e,t){const n=sW.pluralCategoryFnByLanguage[this.language]
return void 0!==n?n(t):(e.console.warn("Missing plural category function for: "+this.language),lG)}}sW.MARKUP_PARAMS={nbsp:"&nbsp;",gt:"&gt;",lt:"&lt;",copy:"\xa9"},sW.pluralCategoryDefault=function(e){return lG},sW.pluralCategoryOne=function(e){return 1===e?yU:lG},sW.pluralCategoryArabic=function(e){const t=e>>0
if(t!==e)return lG
if(0===t)return"zero"
if(1===t)return yU
if(2===t)return bO
const n=t%100
return n>=11?h$:n>=3?IF:lG},sW.pluralCategoryFrench=function(e){return e<2&&e>=0?yU:lG},sW.pluralCategoryHebrew=function(e){const t=e>>0
return t!==e?lG:1===t?yU:2===t?bO:0==t%10&&t>10?h$:lG},sW.pluralCategoryPolish=function(e){const t=e>>0
if(t!==e)return lG
if(1===t)return yU
const n=t%10
if(n<=4&&n>=2){const e=t%100
if(e>14||e<12)return IF}return h$},sW.pluralCategoryRomanian=function(e){const t=e>>0
if(t!==e)return IF
if(0===t)return IF
if(1===t)return yU
const n=e%100
return n<=19&&n>=1?IF:lG},sW.pluralCategoryRussian=function(e){const t=e>>0
if(t!==e)return lG
const n=t%10
if(n>=5||0===n)return h$
const r=t%100
return r<=14&&r>=11?h$:1===n?yU:IF},sW.pluralCategoryFnByLanguage={zh:sW.pluralCategoryDefault,id:sW.pluralCategoryDefault,ja:sW.pluralCategoryDefault,ko:sW.pluralCategoryDefault,ms:sW.pluralCategoryDefault,th:sW.pluralCategoryDefault,vi:sW.pluralCategoryDefault,en:sW.pluralCategoryOne,ca:sW.pluralCategoryOne,da:sW.pluralCategoryOne,nl:sW.pluralCategoryOne,de:sW.pluralCategoryOne,el:sW.pluralCategoryOne,fi:sW.pluralCategoryOne,hu:sW.pluralCategoryOne,it:sW.pluralCategoryOne,nb:sW.pluralCategoryOne,no:sW.pluralCategoryOne,pt:sW.pluralCategoryOne,es:sW.pluralCategoryOne,sv:sW.pluralCategoryOne,tr:sW.pluralCategoryOne,ar:sW.pluralCategoryArabic,fr:sW.pluralCategoryFrench,iw:sW.pluralCategoryHebrew,pl:sW.pluralCategoryPolish,ro:sW.pluralCategoryRomanian,ru:sW.pluralCategoryRussian}
class aW extends uq{constructor(e,t){super(e),this.locFile=null,this.ampLoc=new sW,this.LOC_STRING_CACHE={},this.objectGraph=t}get identifier(){return this.implementation.identifier}get safeIdentifier(){return this.implementation.identifier.split("_")[0]}string(e,t){return this.implementation.string(e)}tryString(e){const t=this.implementation.string(e)
if(t===e||t===`**${e}**`)throw Iv.context("tryString",()=>{Iv.unexpectedType(IN,"Localization key",e,null)}),new Error(`No value exists for localization key '${e}'`)
return t}stringWithFallback(e,t){const n=this.implementation.string(e)
return n===`**AppStore.${e}**`?t:n}stringForPreferredLocale(e,t,n,r){if(o(n))return this.string(t,r)
const i=`${t}_${n}`
let s=this.LOC_STRING_CACHE[i]
if(!s)if(s=this.implementation.stringForPreferredLocale(t,n),s&&s!==t)this.LOC_STRING_CACHE[i]=s
else{const e=this.ampLoc.localize(t)
s=e!==t?e:r||t}return s}stringWithCount(e,t,n){let r=this.implementation.stringWithCount(e,t)
if(!r||r===e){const o=this.ampLoc.localizeWithCount(this.objectGraph,e,t,n)
o&&(r=o)}return r}stringWithCounts(e,t,n){return this.implementation.stringWithCounts(e,t)}uppercased(e){return e?e.toLocaleUpperCase(this.safeIdentifier):null}decimal(e,t){let n=this.implementation.decimal(e,t)
return n||(n=typeof e===aU?`* ${e.toString()} *`:this.nullString()),n}fileSize(e){let t=this.implementation.fileSize(e)
return t||(t=this.nullString()),t}formattedCount(e){let t=this.implementation.formattedCount(e)
return t||(t=this.nullString()),t}formattedCountForPreferredLocale(e,t,n){if(o(n))return this.formattedCount(t)
let r=this.implementation.formattedCountForPreferredLocale(t,n)
return r||(r=this.nullString()),r}timeAgoWithContext(e,t){let n=this.implementation.timeAgoWithContext(e,t)
return n||(n=this.nullString()),n}formatDate(e,t){let n=this.implementation.formatDate(e,t)
return n||(n=this.nullString()),n}formatDateWithContext(e,t,n){let r=this.implementation.formatDateWithContext(e,t,n)
return r||(r=this.nullString()),r}formatDateInSentence(e,t,n){let r=this.implementation.formatDateInSentence(e,t,n)
return r||(r=this.nullString()),r}relativeDate(e){let t=this.implementation.relativeDate(e)
return t||(t=this.nullString()),t}formatDuration(e,t){let n=this.implementation.formatDuration(e,t)
return n||(n=this.nullString()),n}applyLocalizations(e,t,n){this.isLocFileLoaded(e)||(this.locFile=e,this.ampLoc.updateLocalizationData(t,n.slice(0,2)))}isLocFileLoaded(e){return this.locFile===e}normalizedLocale(e,t,n){if("yue-hant"===(t=t.toLowerCase())){const t=e.packageProperties.asString("macauStorefrontIdentifier")
return typeof n===gH&&typeof t===gH&&-1!==n.indexOf(t)?"zh-ma":"zh-hk"}return t}nullString(){return"* null *"}load(e){if(void 0===e.bag.language||null===e.bag.language)throw new Error("Bag language is not available. Unable to load localizations.")
const t=this.normalizedLocale(e,e.bag.language,e.client.storefrontIdentifier),n=`local/${t}`
if(!this.isLocFileLoaded(n)){const r=e.packageProperties.asDictionary(`localizations.${t}`)
if(null!=r)this.applyLocalizations(n,r,t)
else{const r=e.packageProperties.asDictionary("localizations.en-us")
null!=r&&this.applyLocalizations(n,r,t)}}}deviceDisplayName(e){if(e.host.deviceLocalizedModel)return e.host.deviceLocalizedModel
switch(e.client.deviceType){case RH:const e=this.string(IC)
return e===IC?WC:e
case CH:const t=this.string(CC)
return t===CC?Ym:t
case"tv":const n=this.string(kC)
return n===kC?"Apple\xa0TV":n
case MH:const r=this.string(OC)
return r===OC?"Apple\xa0Watch":r
case $H:const o=this.string(EC)
return o===EC?ZC:o
default:return null}}}aW.type=(0,Pv.makeMetatype)("app-store:loc-wrapper")
class cW extends uq{value(e){return n(this.implementation,e)}enabled(e){var t,n
const r=this.value(e)
return typeof r!==rB?Boolean(r):!!(0,Cv.isSome)(null===(t=this.implementation)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.implementation)||void 0===n?void 0:n.clientFeatures[e])}isNotEnabled(e){return!this.enabled(e)}asDictionary(e){return h(this.implementation,e)}asString(e){return f(this.implementation,e)}asNumber(e){return p(this.implementation,e)}asArray(e){return l(this.implementation,e)}}cW.type=(0,Pv.makeMetatype)("app-store:package-properties-wrapper")
class lW extends uq{constructor(e,t){super(e),this.cache={},this.packageProperties=t}isEnabled(e){return this.fromCache(e,()=>{var t,n
return!(!(0,kv.isSome)(this.implementation)||!this.implementation.isEnabled(e))||!!(0,kv.isSome)(null===(t=this.packageProperties)||void 0===t?void 0:t.clientFeatures)&&Boolean(null===(n=this.packageProperties)||void 0===n?void 0:n.clientFeatures[e])})}isNotEnabled(e){return!this.isEnabled(e)}fromCache(e,t){const n=this.cache[e]
if((0,kv.isSome)(n))return n
{const n=t()
return this.cache[e]=n,n}}}lW.type=(0,Pv.makeMetatype)("app-store:client-capabilities-wrapper")
class uW extends uq{retrieveString(e){const t=this.implementation.retrieveString(e)
return(null==t?void 0:t.length)>0&&"<null>"!==t?t:null}storeString(e,t){this.implementation.storeString(t,e)}}uW.type=(0,Pv.makeMetatype)("app-store:storage-wrapper"),(Om=_v||(_v={})).ArcadeDownloadPackOnboarding="Tf5Kjqz",Om.CondensedTodayAds="tBc9hUt",Om.ProductPagePreloading="m0henFo",Om.ProductPageVariants="fNPb5Km",Om.ProductPageYMALRowCount="isj11bm",Om.SearchLandingPage="WqjkRLH"
class dW{constructor(){this.cachedTreatments={},this.cachedRawTreatments={}}async loadTreatments(e){const t=this.experimentAreasForPlatform(e)
if(t.length>0)try{this.cachedRawTreatments=await e.treatmentStore.treatmentsForAreas(t)
for(const[e,t]of Object.entries(this.cachedRawTreatments)){const n=t.identifier
this.cachedTreatments[e]={...t,identifier:n.split(":")[0]}}}catch(t){e.console.error("Failed to load treatments",t)}}currentTreatmentForExperiment(e){return this.cachedTreatments[e]}createAb2Data(){const e=[]
for(const[t,n]of Object.entries(this.cachedRawTreatments))e.push({areaId:t,bucket:-2,treatmentId:n.identifier})
return e}experimentAreasForPlatform(e){const t=[]
switch(e.client.deviceType){case RH:case CH:t.push(_v.ArcadeDownloadPackOnboarding,_v.CondensedTodayAds,_v.ProductPagePreloading,_v.ProductPageVariants,_v.ProductPageYMALRowCount,_v.SearchLandingPage)}return t}}dW.metatype=(0,Pv.makeMetatype)("app-store:experimentCache"),function(e){e.client="clientId",e.user="userId",e.canonical="canonicalAccountIdentifierOverride"}(xv||(xv={})),function(e){e.client="APPSTORE_ENGAGEMENT_CLIENT",e.user="APPSTORE_ENGAGEMENT"}(Lv||(Lv={})),function(e){e.client="APPSTORE_PAYMENTS_ENGAGEMENT_CLIENT",e.user="APPSTORE_PAYMENTS_ENGAGEMENT"}(Mv||(Mv={})),function(e){e.user="APPSTORE_PERSONALIZATION"}($v||($v={}))
const fW={[xv.client]:{keyType:xv.client,bagNamespace:Mv.client,crossSyncDevice:!1},[xv.user]:{keyType:xv.user,bagNamespace:Mv.user,crossSyncDevice:!0}},pW={[xv.client]:{keyType:xv.client,bagNamespace:Lv.client,crossSyncDevice:!1},[xv.user]:{keyType:xv.user,bagNamespace:Lv.user,crossSyncDevice:!0}},hW={[xv.user]:{keyType:xv.user,bagNamespace:$v.user,crossSyncDevice:!0}}
class wW{constructor(e=pW){this.cachedMetricsIds={},this.cachedMetricsFields={},this.shouldAddDsIdFallbackField=!1,this.userDsId=null,this.identifierContextMapping=e}async loadValues(e,t){e.bag.isMetricsUserIdFallbackEnabled&&!e.user.isUnderThirteen?(this.shouldAddDsIdFallbackField=!0,this.userDsId=e.user.dsid):(this.shouldAddDsIdFallbackField=!1,this.userDsId=null)
const n=[]
for(const r of t){const t=await this.loadValuesForIdType(e,r)
n.push(t)}for(const{idType:e,id:t,fields:r}of n)t&&(this.cachedMetricsIds[e]=t),r&&(this.cachedMetricsFields[e]=r)}async loadValuesForIdType(e,t){const n={idType:t},r=this.identifierContextMapping[t]
if(r){try{const o=await Iv.context("MetricsIdentifiersCache:loadValues:metricsFields",async()=>await e.metricsIdentifiers.getMetricsFieldsForContexts([r]))
if((0,kv.isSome)(o)){n[ML]=o
const e=o[t];(0,kv.isSome)(e)&&typeof e===gH&&e.length>0&&(n.id=e)}}catch(n){e.console.error(`Unable to fetch metrics fields for idType ${t}`,n)}if((0,kv.isNothing)(n.id))try{const t=await Iv.context("MetricsIdentifiersCache:loadValues:metricsIdentifier",async()=>await e.metricsIdentifiers.getIdentifierForContext(r));(0,kv.isSome)(t)&&(n.id=t)}catch(n){e.console.error(`Unable to fetch metrics identifier for idType ${t}`,n)}}return n}getMetricsIdForType(e){return this.cachedMetricsIds[e]}getMetricsFieldsForTypes(e){const t=e.map(e=>{var t
return null!==(t=this.cachedMetricsFields[e])&&void 0!==t?t:{}}),n=Object.assign({},...t)
return this.shouldAddDsIdFallbackField&&-1!==e.indexOf(xv.user)&&this.addDsIdFallbackFieldIfNecessary(n),n}addDsIdFallbackFieldIfNecessary(e){const t=e[xv.user];((0,kv.isNothing)(t)||typeof t!==gH||0===t.length||t.length===wW.clientGeneratedUserIdLength)&&(0,kv.isSome)(this.userDsId)&&this.userDsId.length>0&&(e[KO]=this.userDsId)}setCanonicalAccountIdentifierOverride(e){e.length>=0&&(this.cachedMetricsFields[xv.canonical]={[xv.canonical]:e})}}wW.defaultMetatype=(0,Pv.makeMetatype)("app-store:metricsIdentifiersCache"),wW.paymentMetatype=(0,Pv.makeMetatype)("app-store:paymentMetricsIdentifiersCache"),wW.personalizationMetatype=(0,Pv.makeMetatype)("app-store:personalizationMetricsIdentifiersCache"),wW.clientGeneratedUserIdLength=24
const gW=(0,Pv.makeMetatype)("app-store:locale"),vW=(0,Pv.makeMetatype)("app-store:seo"),mW=(0,Pv.makeMetatype)("app-store:active-intent")
class yW{constructor(e){this.implementation=e,this.inferredPreviewPlatform=void 0}setInferredPreviewPlatform(e){this.inferredPreviewPlatform=e}get previewPlatform(){var e
return null!==(e=this.inferredPreviewPlatform)&&void 0!==e?e:this.implementation.previewPlatform}get platform(){if((0,Cv.isSome)(this.previewPlatform))switch(this.previewPlatform){case iH:case aH:case $H:case MH:return this.previewPlatform
case"tv":return ON
case kH:return xj
default:A(this.previewPlatform)}}get attributePlatform(){if((0,Cv.isSome)(this.previewPlatform))switch(this.previewPlatform){case aH:case iH:return rH
case $H:return Gj
case"tv":return RG
case kH:return $j
case MH:return MH
default:A(this.previewPlatform)}}get appPlatform(){if((0,Cv.isSome)(this.previewPlatform))switch(this.previewPlatform){case iH:return CH
case aH:return RH
case $H:return $H
case"tv":return"tv"
case kH:return kH
case MH:return MH
default:A(this.previewPlatform)}}}class AW{constructor(e){this.objectGraph=e}get activeStorefront(){return this.objectGraph.bag.mediaCountryCode}get activeLanguage(){return this.objectGraph.bag.language}setActiveLocale(e){}normalize(e){return{storefront:this.activeStorefront,language:this.activeLanguage}}deriveLocaleForUrl(e){return e}}const TW={bag:Sv.bag,dispatcher:(0,Pv.makeMetatype)("dispatcher"),host:Sv.host,localizer:Sv.localizer,network:Sv.net,plist:Sv.plist,platform:Sv.platform,router:(0,Pv.makeMetatype)("router"),client:(0,Pv.makeMetatype)("client"),debugSettings:(0,Pv.makeMetatype)("debugSettings"),nativeIntentDispatcher:(0,Pv.makeMetatype)("nativeIntentDispatcher"),personNameComponentsFormatter:(0,Pv.makeMetatype)("personNameComponentsFormatter")}
class bW extends Tv.ObjectGraph{configureDefaults(e,t,n,r,o,i,s,a,c,l,u,d,f,p,h,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,x,L,M){let $=this.addingCryptography(t).addingHost(n).addingNetwork(r).addingPlatform(o).addingPlist(i).addingRandom(s).addingServices(a).addingCookieProvider(c).addingBag(e).addingConsole(l).addingStoreMetrics(u).addingAMSEngagement(d).addingLoc(f).addingAdsLoc(p).addingDevice(h).addingClient(w).addingPackageProperties(g).addingUser(v).addingPlayer(m).addingMetricsIdentifiers(y).addingClientOrdering(A).addingArcade(T).addingGameCenter(b).addingDeepLinks(S).addingAppleSilicon(P).addingStorage(I).addingAds(C).addingOnDeviceRecommendationsManager(k).addingOnDeviceSearchHistoryManager(O).addingFeatureFlags(E).addingClientCapabilities(R,g).addingMediaToken(D).addingAppDistribution(_).addingTimeoutManager(x).addingAdsLoc(p).addingTreatmentStore(L).addingUserDefaults(M)
return $.loc.load($),$=$.addingLocale(new AW($)),$}get bag(){return this.required(pq.type)}addingBag(e){return this.addingBagWrapper(new pq(e,this.host)).adding(Sv.bag,e)}addingBagWrapper(e){return this.adding(pq.type,e)}get console(){return this.required(oW.type)}addingConsole(e){return this.addingConsoleWrapper(new oW(e))}addingConsoleWrapper(e){return this.adding(oW.type,e)}get cryptography(){return this.required(Sv.cryptography)}addingCryptography(e){return this.adding(Sv.cryptography,e)}get host(){return this.required(iW.type)}addingHost(e){return this.addingHostWrapper(new iW(e))}addingHostWrapper(e){return this.adding(iW.type,e)}get locale(){return this.required(gW)}addingLocale(e){return this.adding(gW,e)}get network(){return this.required(Sv.net)}addingNetwork(e){return this.adding(Sv.net,e)}get platform(){return this.required(Sv.platform)}addingPlatform(e){return this.adding(Sv.platform,e)}get plist(){return this.required(Sv.plist)}addingPlist(e){return this.adding(Sv.plist,e)}get random(){return this.required(Sv.random)}addingRandom(e){return this.adding(Sv.random,e)}get services(){return this.required(Sv.services)}addingServices(e){return this.adding(Sv.services,e)}get cookieProvider(){return this.required(Sv.cookieProvider)}addingCookieProvider(e){return this.adding(Sv.cookieProvider,e)}get fetchTimingMetricsBuilder(){return this.optional(bv.fetchTimingMetricsBuilderType)}addingFetchTimingMetricsBuilder(e){return this.adding(bv.fetchTimingMetricsBuilderType,e)}get storeMetrics(){return this.required(HH)}addingStoreMetrics(e){return this.adding(HH,e)}get amsEngagement(){return this.optional(qH)}addingAMSEngagement(e){return this.adding(qH,e)}get loc(){return this.required(aW.type)}addingLoc(e){return this.addingLocWrapper(new aW(e,this))}addingLocWrapper(e){return this.adding(aW.type,e)}get adsLoc(){return this.required(oq)}addingAdsLoc(e){return this.adding(oq,e)}get device(){return this.required(WH)}addingDevice(e){return this.adding(WH,e)}get client(){return this.required(nW.type)}addingClient(e){return this.addingClientWrapper(new nW(e))}addingClientWrapper(e){return this.adding(nW.type,e)}get packageProperties(){return this.required(cW.type)}addingPackageProperties(e){return this.addingPackagePropertiesWrapper(new cW(e))}addingPackagePropertiesWrapper(e){return this.adding(cW.type,e)}get clientCapabilities(){return this.required(lW.type)}addingClientCapabilities(e,t){return this.addingClientCapabilitiesWrapper(new lW(e,t))}addingClientCapabilitiesWrapper(e){return this.adding(lW.type,e)}get user(){return this.required(zH)}addingUser(e){return this.adding(zH,e)}get player(){}addingPlayer(e){return this.adding(YH,e)}get metricsIdentifiers(){return this.required(JH)}addingMetricsIdentifiers(e){return this.adding(JH,e)}get clientOrdering(){return this.required(rW.type)}addingClientOrdering(e){return this.addingClientOrderingWrapper(new rW(e))}addingClientOrderingWrapper(e){return this.adding(rW.type,e)}get arcade(){return this.required(KH)}addingArcade(e){return this.adding(KH,e)}get gameCenter(){return this.required(ZH)}addingGameCenter(e){return this.adding(ZH,e)}get deepLinks(){return this.required(QH)}addingDeepLinks(e){return this.adding(QH,e)}get appleSilicon(){return this.required(dq.type)}addingAppleSilicon(e){return this.addingAppleSiliconWrapper(new dq(e))}addingAppleSiliconWrapper(e){return this.adding(dq.type,e)}get storage(){return this.required(uW.type)}addingStorage(e){return this.addingStorageWrapper(new uW(e))}addingStorageWrapper(e){return this.adding(uW.type,e)}get ads(){return this.required(XH)}addingAds(e){return this.adding(XH,e)}get onDeviceRecommendationsManager(){return this.required(eq)}addingOnDeviceRecommendationsManager(e){return this.adding(eq,e)}get onDeviceSearchHistoryManager(){return this.required(tq)}addingOnDeviceSearchHistoryManager(e){return this.adding(tq,e)}get featureFlags(){return this.required(nq)}addingFeatureFlags(e){return this.adding(nq,e)}get mediaToken(){return this.required(rq)}addingMediaToken(e){return this.adding(rq,e)}get appDistribution(){return this.required(iq)}addingAppDistribution(e){return this.adding(iq,e)}get timeoutManager(){return this.required(sq)}addingTimeoutManager(e){return this.adding(sq,e)}get treatmentStore(){return this.required(aq)}addingTreatmentStore(e){return this.adding(aq,e)}get experimentCache(){return this.optional(dW.metatype)}get metricsIdentifiersCache(){return this.optional(wW.defaultMetatype)}get paymentMetricsIdentifiersCache(){return this.optional(wW.paymentMetatype)}get personalizationMetricsIdentifiersCache(){return this.optional(wW.personalizationMetatype)}get userDefaults(){if(this.client.isiOS)return this.required(cq)}addingUserDefaults(e){return this.adding(cq,e)}isAvailable(e){return i(this.optional(e))}get activeIntent(){return this.optional(mW)}addingActiveIntent(e){return this.adding(mW,new yW(e))}get seo(){return this.optional(vW)}addingSEO(e){return this.adding(vW,e)}get dispatcher(){return this.required(TW.dispatcher)}get nativeIntentDispatcher(){return this.required(TW.nativeIntentDispatcher)}get debugSettings(){return this.required(TW.debugSettings)}get router(){return this.required(TW.router)}get localizer(){return this.required(TW.localizer)}get personNameComponentsFormatter(){return this.required(TW.personNameComponentsFormatter)}}class SW{static createSharedMetricsReferralContext(e){SW.shared||(SW.shared=new SW(e))}constructor(e){this.currentReferral=null,this.isMetricsReferralContextRequired=!0,this.isEventDetailClickEventOverrideNecessary=!e.host.isOSAtLeast(16,2,0)}get shouldUseJSReferralData(){return this.isMetricsReferralContextRequired&&i(this.currentReferral)}get activeReferralData(){return this.shouldUseJSReferralData&&null!==this.currentReferral&&this.currentReferral.isActive?this.currentReferral.data:null}setReferralDataForProduct(e,t){var n,o,i
if(!this.isMetricsReferralContextRequired||r(t))return
const s=null!==(n=f(t,SH))&&void 0!==n?n:null,a=null!==(o=f(t,DF))&&void 0!==o?o:null,c=null!==(i=g(t,rV))&&void 0!==i?i:null
this.currentReferral={id:`${e}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,kind:c,refUrl:null},isActive:!1,productPageExtensionInfo:null}}setReferralDataForProductPageExtensionIfNecessary(e){var t,o
if(!this.isMetricsReferralContextRequired)return
const i=f(e,rU),s=f(e,$M)
if(!PW.isProductPageExtension(e)||!PW.isValidPageEvent(e)||r(i)||r(s))return
const a=null!==(t=f(e,gN))&&void 0!==t?t:null,c=f(e,ZO)
let l
switch(c){case mb:l=y(n(e,yb))
break
case QO:l=y(n(e,Ab))
break
default:l={}}const u=null!==(o=f(e,vN))&&void 0!==o?o:null
this.currentReferral={id:`${i}_${Date.now()}`,data:{extRefApp2:s,extRefUrl2:a,refUrl:u,kind:{name:c,context:l}},isActive:!1,productPageExtensionInfo:{productId:i}},this.addReferralContextToMetricsFieldsIfNecessary(e)}beginReferralContextForPageIfNecessary(e){this.isMetricsReferralContextRequired&&PW.isValidPageEvent(e)&&PW.isReferralForEvent(this.currentReferral,e)&&null!==this.currentReferral&&(this.currentReferral.isActive=!0)}endReferralContextIfNecessaryForPageEvent(e){this.isMetricsReferralContextRequired&&PW.isValidPageEvent(e)&&PW.isReferralForEvent(this.currentReferral,e)&&(this.currentReferral=null)}addReferralContextToMetricsFieldsIfNecessary(e){var t
this.isMetricsReferralContextRequired&&(e[SW.referralContextEventField]=null===(t=this.currentReferral)||void 0===t?void 0:t.id)}removeReferralContextInfoFromMetricsEvent(e){this.isMetricsReferralContextRequired&&delete e[SW.referralContextEventField]}addReferralDataToEventIfNecessary(e){if(!r(this.activeReferralData)&&PW.shouldAddReferralDataToEvent(e)&&(!PW.isEventDetailsClickEvent(e)||this.isEventDetailClickEventOverrideNecessary)&&(PW.isEventDetailsClickEvent(e)&&(e[iG]=O$),e[$M]=this.activeReferralData.extRefApp2,e[gN]=this.activeReferralData.extRefUrl2,s(this.activeReferralData.refUrl)&&(e[vN]=this.activeReferralData.refUrl),null!==this.activeReferralData&&null!==this.activeReferralData.kind))switch(e[ZO]=this.activeReferralData.kind.name,e[ZO]){case mb:e[yb]=this.activeReferralData.kind.context
break
case QO:e[Ab]=this.activeReferralData.kind.context}}}SW.referralContextEventField="referralContextId"
class PW{static isProductPageExtension(e){return f(e,SH)===PW.productPageExtensionAppId}static isValidPageEvent(e){const t=f(e,iG)
return!(0,kv.isNothing)(t)&&PW.validPageEventTypes.has(t)}static isReferralForEvent(e,t){var n
if(r(e))return!1
const o=t[SW.referralContextEventField],s=f(t,rU)
return i(o)?o===e.id:!(!PW.isProductPageExtension(t)||!i(s))&&s===(null===(n=null==e?void 0:e.productPageExtensionInfo)||void 0===n?void 0:n.productId)}static shouldAddReferralDataToEvent(e){return e.eventType!==iB||this.isEventDetailsClickEvent(e)}static isEventDetailsClickEvent(e){if(e.eventType!==iB)return!1
const t=e.location,n=null==t?void 0:t[0]
return i(n)&&n.locationType===O$}}PW.productPageExtensionAppId="com.apple.AppStore.ProductPageExtension",PW.eventDetailsPageType=O$,PW.validPageEventTypes=new Set([uj,XO,PW.eventDetailsPageType])
const IW=(Fv=e(447)).PageInvocationPoint
IW[JV]=JV,IW[FC]=FC,IW[Mj]=Mj,IW[MD]=MD
class CW{constructor(e,t,n,r,o=!1){this.fields=e,this.includingFields=t,this.excludingFields=n,this.topic=r,this.shouldFlush=o}}class kW extends hq{constructor(e){super(),this.fields=e}}class OW extends hq{constructor(e){super(),this.data=e||[],this.custom={}}addMetricsData(e){this.data.push(e)}addManyMetricsData(e){for(const t of e)this.addMetricsData(t)}clearAll(){this.data.length=0}}class EW extends hq{constructor(){super(),this.instructions=[],this.custom={}}addInstruction(e){this.instructions.push(e)}addManyInstructions(e){for(const t of e)this.addInstruction(t)}addData(e,t){const n={data:e,invocationPoints:t}
this.instructions.push(n)}addManyData(e,t){for(const n of e)this.addData(n,t)}}class RW{constructor(e,t,n){this.fields=e,this.id=t,this.custom=n}}class DW extends RW{constructor(e,t){super(e.fields,e.id,e.custom||{}),void 0!==this.custom&&(this.custom.isFast=t),this.isFast=t}}class _W extends wq{constructor(e,t=new OW){super(),this.title=null,this.artwork=null,this.presentationStyle=[],this.actionClass=e,this.$kind=e,this.actionMetrics=t}}class xW extends _W{constructor(e){super(Fm),this.navigationTab=e,this.actions=[],this.popToRoot=!1}}class LW extends _W{constructor(e,t){super("TabBadgeAction"),this.navigationTab=e,this.text=t}}class MW extends _W{constructor(e,t=!0,n=new OW){super("ExternalUrlAction",n),this.url=e,this.isSensitive=t}}class $W extends _W{constructor(e){super("CompoundAction")
const t=[]
for(const n of e)(0,Cv.isSome)(n.actionMetrics)&&(this.actionMetrics.addManyMetricsData(n.actionMetrics.data),Object.assign(this.actionMetrics.custom,n.actionMetrics.custom),n.actionMetrics.clearAll()),t.push(n)
this.actions=t}}class FW extends _W{constructor(e,t,n,r){super("OfferAction"),this.title=e,this.adamId=t,this.parentAdamId=r,this.purchaseConfiguration=n,n&&(this.bundleId=n.bundleId,this.lineItem=n.lineItem),this.includeBetaApps=!1}}class NW extends _W{constructor(e,t){super("OfferConfirmationAction"),this.buyAction=e,this.confirmationInitiationAction=t}}class BW extends _W{constructor(){super("OfferAlertAction"),this.title=null,this.message=null,this.footerMessage=null,this.isCancelable=!0,this.shouldCheckForAvailableDiskSpace=!1,this.checkRestrictionsForContentRating=null,this.remoteControllerRequirement=EB,this.spatialControllerRequirement=null,this.shouldCheckForGameController=!1,this.shouldIncludeActiveAccountInFooterMessage=!1,this.shouldPromptForConfirmation=!1,this.completionAction=null}}class UW extends _W{constructor(e,t){super("CancelPreorderAction"),this.preorderAdamId=e,this.isArcade=t}}class GW extends _W{constructor(e,t,n,r,o){super("InAppPurchaseAction"),this.productIdentifier=e,this.appAdamId=t,this.appBundleId=n,this.installRequiredAction=r,this.minimumShortVersionSupportingInAppPurchaseFlow=o}}class jW extends _W{constructor(e,t){super("OfferStateAction"),this.title=t.title,this.adamId=e,this.defaultAction=t,this.includeBetaApps=!1}}class VW extends _W{constructor(e,t=SH){super("OpenAppAction"),this.adamId=e,this.destination=t}}class HW extends _W{constructor(e){super("OpenGamesUIAction"),this.target=e}}class qW extends _W{constructor(e){super("ArcadePackOfferAction"),this.offerActions=e}}class WW extends _W{constructor(e){super("SelectAppAction"),this.adamId=e}}class zW extends _W{constructor(e){super("HttpAction"),this.url=e,this.method=EF,this.headers={},this.body=null,this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class YW{constructor(e,t,n,r){this.key=e,this.target=t,this.inputType=n,this.title=r,this.isRequired=!0,this.maximumLength=null}}class JW extends _W{constructor(e){super("HttpTemplateAction"),this.message=null,this.url=e,this.method=EF,this.headers={},this.body=null,this.bodyDictionary={},this.parameters=[],this.isStoreRequest=!1,this.needsAuthentication=!1,this.needsMediaToken=!1,this.retryCount=0,this.disableCache=!1,this.successAction=null,this.failureAction=null}}class KW extends JW{}class ZW extends _W{constructor(e,t){super("WriteReviewAction"),this.adamId=e,this.url=t}}class QW extends _W{constructor(e,t,n){super(null!=n?n:"PageTabChangeAction"),this.selectedTabId=e,this.title=t}}class XW extends _W{constructor(){super("GameCenterDashboardAction")}}class ez extends _W{constructor(e){super("SheetAction"),this.actions=e,this.isCancelable=!1,this.cancelTitle=null,this.message=null,this.style=sH,this.isCustom=!1,this.destructiveActionIndex=null}}class tz extends _W{constructor(e){super("AlertAction"),this.style=e,this.title=null,this.message=null,this.isCancelable=!1,this.cancelTitle=null,this.cancelAction=null,this.buttonActions=[],this.buttonTitles=[],this.destructiveActionIndex=null,this.imageName=null}}class nz extends wq{constructor(e,t){super(),this.activityType=e,this.action=t}}class rz extends _W{constructor(e,t,n=Nm){super("ShareSheetAction"),this.data=e,this.activities=t,this.shareSheetStyle=n}}class oz extends _W{constructor(e){super("ReportConcernAction"),this.reasons=e}}class iz extends _W{constructor(e,t,n,r){super("ReviewSummaryReportConcernAction"),this.concerns=e,this.title=t,this.explanation=n,this.sendAction=r}}class sz extends _W{constructor(e,t){super("ProductPageScrollAction"),this.section=e,this.clicksOnScroll=t}}class az extends _W{constructor(e,t,n,r){super("ArcadeAction"),this.productIdentifier=e,this.appAdamId=t,this.postSubscribeAction=r,this.subscriptionToken=n}}class cz extends _W{constructor(e,t,n){super("FamilyCircleAction"),this.clientName=e,this.eventType=t,this.additionalParameters=n}}class lz extends _W{constructor(){super("BlankAction")}}class uz extends _W{constructor(e){super("SearchAdAction"),this.action=e}}class dz extends _W{constructor(e,t){super("RateLimitedAction"),this.actionKey=e,this.primaryAction=t}}class fz extends _W{constructor(e,t,n,r){super("ArcadeSubscriptionStateAction"),this.notSubscribedAction=e,this.purchasingAction=t,this.subscribedAction=n,this.unknownAction=r}}class pz extends _W{constructor(e){super("GameCenterPlayerProfileAction"),this.playerId=e}}class hz extends _W{constructor(e){super("GameCenterAchievementsAction"),this.bundleId=e}}class wz extends _W{constructor(e){super(Bm),this.contactId=e}}class gz extends _W{constructor(e){super(Bm),this.invitationType=e}}class vz extends _W{constructor(e){super("GameCenterDenylistPlayerAction"),this.contactId=e}}class mz extends _W{constructor(e,t){super("EngagementToggleAction"),this.identifier=e,this.value=t}}class yz extends _W{constructor(e,t,n,r,o,i){super("ShelfBasedPageScrollAction"),this.shelfId=e,this.notPurchasedShelfId=t,this.purchasedShelfId=n,this.adamId=r,this.index=o,this.clicksOnScroll=i}}class Az extends _W{constructor(){super("InvalidateAllWidgetsAction")}}class Tz extends _W{constructor(e,t,n){super("AppLaunchTrampolineAction"),this.bundleId=e,this.payloadUrl=t,this.fallbackAction=n}}class bz extends _W{constructor(e,t,n,r,o,i,s,a,c){super("CreateCalendarEventAction"),this.startDate=e,this.endDate=t,this.isAllDay=n,this.name=r,this.location=o,this.notes=i,this.url=s,this.notAuthorizedAction=a,this.availability=c}}class Sz extends _W{constructor(e){super("CopyTextAction"),this.text=e}}class Pz extends _W{constructor(){super("ClearAppUsageDataAction")}}class Iz extends _W{constructor(){super("ClearSearchHistoryAction")}}class Cz extends _W{constructor(e){super("AdInteractionAction"),this.adActionMetrics=e}}class kz extends _W{constructor(e){super("CrossfireReferralAction"),this.referrerData=e}}const Oz="x-as3-internal",Ez=vD,Rz="itms-apps",Dz="appstore-ui",_z={shelf:VH,store:"WebObjects/MZStore.woa/wa",storeElements:"WebObjects/MZStoreElements.woa/wa",lookup:KI,docTypeLookup:"docTypeLookup",install:zx,grouping:"viewGrouping",viewArtist:"viewArtist",viewSoftware:"viewSoftware",today:PH,arcade:xH,arcadeUpsellPreview:"arcadeUpsellPreview",arcadeSeeAllGames:jB,arcadeSeeAllGamesLoadMore:"arcadeSeeAllGamesLoadMore",genre:Xj,viewGenre:qD,recommendationsSeeAll:"recommendationsSeeAll",screenshots:bH,room:"viewRoom",multiRoom:"viewMultiRoom",charts:L$,product:SH,game:"game",siri:sO,productBundle:ZI,developer:cV,artist:"artist",ratings:PD,reviews:pH,viewReviews:"viewContentsUserReviews",personalizedReviews:"personalizedReviews",article:XV,story:RB,editorialItem:zU,viewEditorialItem:tA,todayCardPreview:"todayCardPreview",mso:oF,resetAndRedirect:"resetAndRedirect",account:Wj,personalizationTransparency:iM,href:eU,eula:IB,tvEula:"tv-eula",privacyPolicy:yS,safetyCompliance:"safety-compliance",appsForYou:"apps-for-you",storeFront:"storeFront",tab:"tab",searchLandingPage:"searchLandingPage",searchTrendingApps:"searchTrendingApps",privacyDetail:GE,privacyDefinitions:TS,reportAProblem:"reportaproblem.apple.com/store",gameCenterProfile:WI,onDeviceRecommendations:"onDeviceRecommendations",editorialPage:"editorialPage",accessibilityDetails:YF,test:CE,shelfTypes:"shelfTypes",groupingTest:PG,builtIn:"builtIn",shelfTextTest:"shelfText",shelfLockupsTest:"shelfLockups",shelfMiscTest:"shelfMisc",lockupTest:"lockupTest",articleTestArtwork:"articleArtworkTest",articleTestSingleAppIcon:"articleSingleAppIconTest",articleTestSingleAppIconHeroArt:"articleSingleAppIconHeroArtTest",articleTestBrandedApp:"articleBrandedAppTest",articleTestMultiAppTwo:"articleMultiAppTwoTest",articleTestMultiAppThree:"articleMultiAppThreeTest",articleTestGrid:"articleGridTest",articleTestInAppPurchase:"articleInAppPurchaseTest"},xz="storepreview.apple.com",Lz=Jj,Mz=LI,$z=jB,Fz="familyCircle",Nz="spamBlockingExtensions",Bz=zA,Uz="launchApp",Gz="sharePlayApps",jz="buddyOnboarding",Vz=new Set([xz,"preview.apps.apple.com"]),Hz={id:"id",ids:"ids",productVariantID:wB,countryCode:"cc",language:"l",featuredContentId:"fcId",fetchData:"fetchData",isTodaySection:"isTodaySection",isTodayFeedPreview:"isTodayFeedPreview",genre:Xj,bundleIdentifier:"bundleIdentifier",bundleId:zV,offerName:xU,charts:L$,ages:xF,chart:$V,types:M$,v0:"v0",action:EV,type:oj,context:eE,isArcade:LO,isSubscribed:"isSubscribed",isTrialAvailable:"isTrialAvailable",isTrialEnrolled:"isTrialEnrolled",groupingFeaturedContentId:"groupingFeaturedContentId",editorialPageShelfType:"editorialPageShelfType",nativeGroupingShelfId:"nativeGroupingShelfId",isArcadeSeeAllGamesShelf:"isArcadeSeeAllGamesShelf",isGameCenterActivityFeedShelf:"isGameCenterActivityFeedShelf",isGameCenterPlayerShelf:"isGameCenterPlayerShelf",isGameCenterPlayerRibbonItem:"isGameCenterPlayerRibbonItem",isGameCenterAchievementsShelf:"isGameCenterAchievementsShelf",isGameCenterContinuePlayingShelf:"isGameCenterContinuePlayingShelf",isGameCenterPopularWithYourFriendsShelf:"isGameCenterPopularWithYourFriendsShelf",isGameCenterSuggestedFriendsShelf:"isGameCenterSuggestedFriendsShelf",isGameCenterReengagementShelf:"isGameCenterReengagementShelf",isOnDeviceRecommendationsShelf:"isOnDeviceRecommendationsShelf",isOnDeviceSearchHistoryShelf:"isOnDeviceSearchHistoryShelf",isSearchFocusHeaderShelf:"isSearchFocusHeaderShelf",isArcadeDownloadPackShelfPlaceholder:"isArcadeDownloadPackShelfPlaceholder",onDeviceRecommendationsUseCase:"onDeviceRecommendationsUseCase",onDevicePersonalizationUseCase:_M,isPurchasesApp:"isPurchasesApp",isViewOnly:Ek,includeUnlistedApps:"includeUnlistedApps",enabled:_A,href:eU,recoMetrics:"recoMetrics",showingFallbackMedia:"showingFallbackMedia",path:"path",useReleaseId:"useReleaseId",clientIdentifierOverride:sb,subscribePageMessage:OL,editorialItem:zU,askToBuyId:"askToBuyId",appId:"appId",isPPT:"isPPT",sort:Ij,grouping:PG,code:RF,includePostSubscribeAttribution:"includePostSubscribeAttribution",campaignToken:"ct",providerToken:"pt",qToken:uC,advertisementId:dC,token:$G,parseContext:"parseContext",privacyTypeId:"privacyTypeId",requestDescriptor:"requestDescriptor",ageRating:zj,controllerSupport:Ey,multiplayerSupport:"multiplayerSupport",comingSoon:d_,binCompatGames:"binCompatGames",gamePreviews:"gamePreviews",offerHints:"offerHints",invalidateWidgetsOnFailure:Uy,metrics:eG,appEventId:"eventid",offerItemId:"offerItemId",appEventDeepLink:t_,useCaseShort:"uc",collectionId:"collection-id",seedId:"seed-id",isShelfWithAd:"isShelfWithAd",shelfWithAdPlacementType:"shelfWithAdPlacementType",shelfRefreshType:"refreshType",isPreloading:"isPreloading",name:GH,shelfType:"shelfType",shelfId:"shelfId",onbaordingCardIds:"onboardingCardIds",preview:nA,todayCardConfig:"todayCardConfig",experimentId:VE,shortEditorialNotes:yM,arcadeSubscriptionStatus:"subscriptionStatus",webBrowser:iR,editorialPageId:"editorialPageId",editorialCardId:"filter[canvas:cardId]",filterRecommendable:"filter[recommendable]",deviceFamily:bP},qz="inAppPurchaseId",Wz="productUrl",zz=ux,Yz="minExternalVersionId",Jz=wj,Kz=Ij,Zz="availableAdamIds",Qz=SH,Xz=pH,eY="productPageSimilarItems",tY=/^([a-z][a-z0-9.+-]*:)(\/\/)?([\S\s]*)/i,nY=/([^=?&]+)=?([^&]*)/g,rY=[bL,UU,jG,CB]
class oY{constructor(e){if(this.query={},!e)return
let t=e
const n=tY.exec(e)
if(n){let e=n[1]
e&&(e=e.split(":")[0]),this.protocol=e,t=n[3]}let r={remainder:t,result:void 0}
for(const e of rY){if(!r.remainder)break
switch(e){case bL:r=T(r.remainder,"#",ID),this.hash=r.result
break
case UU:r=T(r.remainder,"?",ID),r.result&&(this.query=oY.queryFromString(r.result))
break
case jG:r=T(r.remainder,"/",ID),r.result&&(this.pathname="/"+r.result)
break
case CB:if(r.remainder){const e=T(r.remainder,"@",fC),t=e.result,n=e.remainder
if(t){const e=t.split(":")
this.username=decodeURIComponent(e[0]),this.password=decodeURIComponent(e[1])}if(n){const e=n.split(":")
this.host=e[0],this.port=e[1]}}break
default:throw new Error("Unhandled case!")}}}set(e,t){if(!t)return this
switch(e===UU&&typeof t===gH&&(t=oY.queryFromString(t)),e){case hG:this.protocol=t
break
case pC:this.username=t
break
case hC:this.password=t
break
case wC:this.port=t
break
case jG:this.pathname=t
break
case UU:this.query=t
break
case bL:this.hash=t
break
default:this[e]=t}return this}get(e){switch(e){case hG:return this.protocol
case pC:return this.username
case hC:return this.password
case wC:return this.port
case jG:return this.pathname
case UU:return this.query
case bL:return this.hash
default:return this[e]}}append(e,t){const n=this.get(e)
let r
if(e===UU)typeof t===gH&&(t=oY.queryFromString(t)),r=typeof n===gH?{existingValue:n,...t}:{...n,...t}
else{let o=n
o||(o="")
let i=o
if(e===jG){const e=o.length
e&&"/"===o[e-1]||(i+="/")}i+=t,r=i}return this.set(e,r)}param(e,t){return e?(this.query||(this.query={}),this.query[e]=t,this):this}removeParam(e){return e&&this.query?(void 0!==this.query[e]&&delete this.query[e],this):this}path(e){return this.append(jG,e)}pathExtension(){var e
if((0,Cv.isNothing)(this.pathname))return null
const t=null===(e=this.pathname.split("/").filter(e=>e.length>0).pop())||void 0===e?void 0:e.split(".")
return void 0===t||t.filter(e=>""!==e).length<2?null:t.pop()}pathComponents(){return this.pathname?this.pathname.split("/").filter(e=>e.length>0):[]}popPathComponent(){if(!this.pathname)return null
const e=this.pathname.slice(this.pathname.lastIndexOf("/")+1)
return 0===e.length?null:(this.pathname=this.pathname.slice(0,this.pathname.lastIndexOf("/")),e)}build(){return this.toString()}toString(){let e=""
return this.protocol&&(e+=this.protocol+"://"),this.username&&(e+=encodeURIComponent(this.username),this.password&&(e+=":"+encodeURIComponent(this.password)),e+="@"),this.host&&(e+=this.host,this.port&&(e+=":"+this.port)),this.pathname&&(e+=this.pathname,e.endsWith("/")&&this.pathname.length>0&&(e=e.slice(0,-1))),this.query&&Object.keys(this.query).length&&(e+="?"+oY.toQueryString(this.query)),this.hash&&(e+="#"+this.hash),e}static queryFromString(e){const t={}
let n=nY.exec(e)
for(;n;){const r=decodeURIComponent(n[1]),o=decodeURIComponent(n[2])
t[r]=o,n=nY.exec(e)}return t}static toQueryString(e){let t="",n=!0
for(const r of Object.keys(e)){n||(t+="&"),n=!1,t+=encodeURIComponent(r)
const o=e[r]
o&&o.length&&(t+="="+encodeURIComponent(o))}return t}static from(e){return new oY(e)}static fromComponents(e,t,n,r,o){const i=new oY
return i.protocol=e,i.host=t,i.pathname=n,i.query=r,i.hash=o,i}}const iY=[Ez,Rz,"itms-appss","itms-messages","itms-messagess","itms-watch","itms-watchs","macappstore","macappstores","com.apple.tvappstore","com.apple.TVAppStore","com.apple.Arcade"]
class sY{constructor(e){var t
this.identifier=e.identifier,this._protocol=null==(t=e.protocol)?null:t,this._hostName=e.hostName,e.path?(this._pathComponents=e.path.split("/").filter(e=>e.length>0),this._pathParameterMap=function(e){const t={}
return e.forEach((e,n)=>{I(e)&&(t[e]=n)}),t}(this._pathComponents)):(this._pathComponents=null,this._pathParameterMap=null),this._pathExtension=e.pathExtension,this._query=function(e){const t=[]
if(!e)return t
for(const n of e){const e=n.split("=")
let r=e[0]
const o=-1!==r.indexOf("?")
r=r.replace("?","")
const i=-1!==r.indexOf(gC)
r=r.replace(gC,"")
let s=null
e.length>1&&(s=decodeURIComponent(e[1])),t.push({key:r,value:s,optional:o,caseInsensitive:i})}return t}(e.query),this._hash=e.hash,this._regex=e.regex,e.exclusions?this._exclusions=e.exclusions.map(function(e){return new sY(e)}):this._exclusions=null}matches(e){var t,n
if(this._regex){if(!this._regex.length)return!1
let t=!1
for(const n of this._regex)if(n.test(e.toString())){t=!0
break}if(!t)return!1}if(this._protocol&&e.protocol!==this._protocol)return!1
if(this._hostName&&e.host!==this._hostName)return!1
if(this._pathComponents){const t=this._pathComponents,n=e.pathComponents()
if(t.length!==n.length)return!1
const r=t.length
for(let e=0;e<r;e++){const r=t[e]
if(!I(r)&&r!==n[e])return!1}}if(this._pathExtension&&e.pathExtension()!==this._pathExtension)return!1
if(this._query)for(const r of this._query){let o
if(r.caseInsensitive)for(const[n,i]of Object.entries(null!==(t=e.query)&&void 0!==t?t:{}))r.key.toLocaleLowerCase()===n.toLocaleLowerCase()&&(o=i)
else o=null===(n=e.query)||void 0===n?void 0:n[r.key]
if(!o&&!r.optional)return!1
if(r.value&&r.value!==o)return!1}if(this._hash&&e.hash!==this._hash)return!1
if(this._exclusions)for(const t of this._exclusions){if(t._exclusions)throw Error("Matching exclusion rules with further exclusion rules may introduce significant code-complexity and/or reduce the ease with which developers are able to reason about your desired goals. Are there any simpler options?")
if(t.matches(e))return!1}return!0}extractParameters(e){var t,n
const r={}
if(null!==this._pathComponents&&null!==this._pathParameterMap){const t=e.pathComponents()
for(const e of Object.keys(this._pathParameterMap)){const n=C(e),o=k(t[this._pathParameterMap[e]],e)
r[n]=decodeURIComponent(o)}}if(this._query)for(const o of this._query)r[o.key]=null!==(n=null===(t=e.query)||void 0===t?void 0:t[o.key])&&void 0!==n?n:void 0
return r}}class aY{constructor(){this._routeMappings=[]}associate(e,t){const n=[]
for(const t of e)n.push(new sY(t))
this._routeMappings.push({route:n,object:t})}routedObjectForUrl(e){let t=typeof e===gH?new oY(e):e
t=function(e){let t=typeof e===gH?new oY(e):e
if(!P(t))return t
const n=t.query,r=null==n?void 0:n[AH]
return(!t.host||0===t.host.length)&&null!=r&&(t=new oY(r),(null==n?void 0:n[SE])&&(t=t.append(UU,{dsid:n[SE]})),(null==n?void 0:n[vC])&&(t=t.append(UU,{signatureResumption:n[vC]}))),oY.fromComponents(Ez,t.host,t.pathname,t.query,t.hash)}(t),t=function(e){var t,n,r
const o=typeof e===gH?new oY(e):e
if(!P(o))return o
const i=o.build()
let s,a=(0,Cv.isNothing)(o.query)?void 0:b(o.query)
const c={},l=[{key:"MZSearch.woa",action:JV},{key:JV,action:JV},{key:"buyLandingPage",action:b$},{key:"buyCharityGiftWizard",action:Vm},{key:"longUrlHandler",action:mC},{key:UD,action:UD}],u={"accessory-lookup":"accessoryLookup","finance-app":Wj,viewEula:IB,software:BH,primaryTerm:JV}
let d=!1
for(const e of Object.keys(c))if(o.host&&-1!==o.host.indexOf(e)){d=!0,s=c[e]
break}let f=!1
for(const e of l){const t=e.key
if(o.pathname&&-1!==o.pathComponents().indexOf(t)){f=!0,s=e.action,void 0!==(null==a?void 0:a[t])&&delete a[t]
break}}for(const e of Object.keys(u)){const r=void 0!==(null===(t=o.query)||void 0===t?void 0:t[e])&&null!==o.query[e],i=(null===(n=o.query)||void 0===n?void 0:n[EV])&&-1!==o.query[EV].indexOf(e)
if(r||i){s=u[e],void 0!==(null==a?void 0:a[e])&&delete a[e]
break}}if(s===Wj&&-1!==i.indexOf(yC)&&(s="addToPassbook",void 0!==a&&delete a[yC]),s){const e=null,t=null,n={action:s}
s===T$&&void 0!==a&&(a[RF]||a[AC])?n[RF]=a[RF]||a[AC]:s!==Wj&&s!==UD&&s!==mC||!f&&!d||(n[ND]=o.toString())
const i=null===(r=o.query)||void 0===r?void 0:r[HC]
return s===JV&&void 0!==i&&void 0!==a&&(a[HC]=i),a={...a,...n},oY.fromComponents(o.protocol,t,e,a,o.hash)}return o}(t)
for(const e of this._routeMappings)for(const n of e.route)if(n.matches(t))return{normalizedUrl:t,parameters:n.extractParameters(t),object:e.object,matchedRuleIdentifier:n.identifier}
return{normalizedUrl:t,parameters:null,object:null,matchedRuleIdentifier:null}}}const cY=Symbol("PromiseResult")
class lY extends Error{constructor(e){super(function(e){return e.map(e=>e instanceof Error?e.message:JSON.stringify(e)).join("")}(e)),this.reasons=e,this.reasons=e}}class uY extends Error{constructor(e){super(e.message),this.reason=e,this.reason=e}}class dY extends _W{constructor(e,t){super(LD),this.$kind="flowAction",this.page=e,this.pageUrl=t,this.pageData=null,this.referrerData=void 0,this.presentationContext=pV,this.animationBehavior=pV,this.origin="inapp"}}class fY extends hq{constructor(e){super(),this.annotationGroups=e}}class pY extends wq{constructor(e){super(),this.art=e}}class hY extends hq{constructor(e,t){super(),this.type=e,this.lockup=t}}class wY extends hq{constructor(e,t,n,r,o,i,s,a,c){super(),this.message=e,this.focusedMessage=t,this.action=n,this.fullProductAction=r,this.leadingArtwork=o,this.leadingArtworkTintColor=i,this.includeBackgroundBorder=s,this.kind=a,this.hideCriteria=c}}class gY extends hq{constructor(e,t,n,r,o){super(),this.unknownBanner=e,this.buyBanner=t,this.downloadBanner=n,this.updateBanner=r,this.openBanner=o}}class vY extends hq{constructor(e){super(),this.lockup=e}}class mY extends hq{}class yY extends hq{constructor(e,t,n,r,o,i){super(),this.items=e,this.mediaPlatform=t,this.allPlatforms=n,this.platformDescription=r,this.allPlatformsDescription=o,this.allPlatformsDescriptionPlacement=i}}class AY extends hq{constructor(e,t,n,r,o,i,s){super(),this.type=e,this.title=t,this.caption=n,this.captionTrailingArtwork=r,this.linkAction=o,this.artwork=i,this.artworkTintColor=s}}class TY extends hq{constructor(e,t,n,r){super(),this.paragraph=e,this.developerAction=r,this.tags=n,this.developerLinks=t}}class bY extends hq{constructor(e){super(),this.text=e,this.presentationStyle=[],this.clickAction=null}}class SY extends hq{}class PY extends wq{isValid(){return!!this.title&&!(!this.icon||!this.icon.isValid())&&super.isValid()}}class IY extends PY{constructor(){super(),this.screenshots=[],this.screenshotsDisplayStyle=y$}isValid(){return!(!this.screenshots||!this.screenshots.length)&&super.isValid()}}class CY extends PY{constructor(){super(),this.screenshots=[],this.trailers=[],this.overrideLockupPosition=null,this.screenshotsDisplayStyle="control",this.metadataRibbonItems=[],this.showMetadataInformationInLockup=!1,this.alignedRegionArtwork=null,this.alignedRegionVideo=null}}class kY extends wq{constructor(e){super(),this.viewType=e,this.moduleType=null,this.labelText=null,this.borderedText=null,this.highlightedText=null,this.starRating=null,this.secondaryViewPlacement=EH,this.artwork=null,this.maxCharacterCount=null,this.truncationLegibilityCharacterCountThreshold=null,this.allowsTruncation=null}}class OY extends PY{isValid(){return!(!this.trailers||!this.trailers.isValid())&&!(!this.editorialTagline||0===this.editorialTagline.length)&&super.isValid()}}class EY extends hq{constructor(e,t){super(),e&&(this.videos=e),t&&(this.mediaPlatform=t)}isValid(){return this.videos&&this.videos.length>0&&super.isValid()}}class RY extends PY{}class DY extends wq{}class _Y extends wq{constructor(e,t,n,r,o=!1){super(),this.isDark=!1,this.artwork=e,this.lockup=t,this.caption=n,this.title=r,this.isDark=o}isValid(){return this.lockup.isValid()&&this.artwork.isValid()}}class xY extends hq{constructor(e,t,n){super(),this.text=e,this.style=t,this.mediaType=n,this.wantsCollapsedNewlines=!0}}class LY extends wq{constructor(){super(),this.adamId=null,this.caption=null,this.title=null,this.subtitle=null,this.artwork=null,this.shelfBackground=null,this.clickAction=null,this.decorations=[],this.flowPreviewActionsConfiguration=null,this.appEventFormattedDates=null,this.mediaOverlayStyle=null}isValid(){return!!this.clickAction&&!(!this.artwork||!this.artwork.isValid())&&!(!this.caption||!this.title)&&super.isValid()}}class MY extends wq{constructor(){super(),this.flowPreviewActionsConfiguration=null}}class $Y extends wq{constructor(e,t){super(),this.title=e,this.clickAction=t,this.artwork=null,this.accessibilityLabel=null}}class FY extends wq{constructor(){super(),this.artworks=null,this.accessibilityLabel=null,this.shortEditorialDescription=null,this.clickAction=null,this.personalizationStyle=qV,this.shelfBackground=null,this.flowPreviewActionsConfiguration=null,this.editorialDisplayOptions={},this.artworkSafeArea=null,this.textSafeArea=null}isValid(){var e,t,n,r
const o=null!==(t=null===(e=this.artworks)||void 0===e?void 0:e.every((e,t)=>(0,Cv.isSome)(e)&&e.isValid()))&&void 0!==t&&t,i=(null!==(r=null===(n=this.collectionIcons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0,s=(0,Cv.isSome)(this.backgroundColor)
return(0,Cv.isSome)(this.clickAction)&&(o||i||s)&&super.isValid()}}class NY extends wq{constructor(e,t,n,r=!0){super(),this.descriptionText=e,this.summaryText=t,this.clickAction=n,this.linkPresentationEnabled=r}}class BY extends hq{constructor(e,t){super(),this.styledText=e,this.linkedSubstrings=t}}class UY extends hq{constructor(e,t,n,r){super(),this.text=e,this.clickAction=t,this.systemImageName=n,this.adamIdForPurchaseHistoryFilter=r}}class GY extends hq{constructor(e){super(),this.buttons=e}}class jY extends hq{constructor(e,t){super(),this.title=e,this.action=t}}class VY extends wq{constructor(e,t,n=mj,r=null,o=null,i=null){super(),this.artwork=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===A$?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class HY extends wq{constructor(e,t,n=mj,r=null,o=null,i=null){super(),this.video=e,this.isFullWidth=t,this.hasRoundedCorners=typeof i===A$?i:!this.isFullWidth,this.ordinal=o,this.caption=r,this.captionMediaType=n}}class qY extends hq{constructor(e,t,n,r){super(),this.type=e,this.title=t,this.hasDivider=n,this.action=r}}class WY extends wq{constructor(e,t,n,r){super(),this.text=e,this.credit=t,this.artwork=n,this.isFullWidthArtwork=r||!1}}class zY extends wq{constructor(e,t){super(),this.text=e,this.attribution=t}}class YY extends hq{constructor(e,t,n){super(),this.style=e,this.color=t,this.isFullWidth=n}}class JY extends wq{constructor(e,t,n,r,o){super(),this.badges=e,this.hasTopSeparator=t,this.hasBottomSeparator=n,this.separatorsAreFullWidth=r,this.alignment=o}}class KY extends wq{constructor(e,t){super(),this.title=e,this.buttonAction=t}}class ZY extends hq{constructor(e,t,n,r,o,i){super(),this.badgeType=n,this.badge=n.title,this.title=e,this.description=t,this.callToActionButtonAction=r,this.backgroundStyle=o,this.textAlignment=i}}class QY extends wq{constructor(e,t,n,r,o,i,s){super(),this.details=e,this.detailsDisplayProperties=t,this.heading=n,this.artwork=r,this.video=o,this.collectionIcons=i,this.backgroundColor=s,this.editorialDisplayOptions={}}}class XY extends wq{constructor(e,t,n){super(),this.details=e,this.iconArtwork=t,this.backgroundColor=n}}class eJ extends wq{}class tJ extends wq{constructor(e,t){super(),this.unsubscribedAction=e,this.subscribedAction=t}}class nJ extends wq{constructor(e,t,n,r,o,i,s,a,c){super(),this.badgeGlyph=e,this.badge=t,this.title=n,this.subtitle=r,this.achievement=o,this.backgroundColor=s,this.backgroundArtwork=a,this.lockup=i,this.heroAction=c}}class rJ extends wq{constructor(e,t,n){super(),this.placement=e,this.context=t,this.deliveryMethod=null!=n?n:"pushAndPull"}}!function(e){e.OnPageLoad="onPageLoad",e.OnShelfWillAppear="onShelfWillAppear"}(Nv||(Nv={})),function(e){e.ViewAligned="viewAligned",e.CenterAligned="centerAligned"}(Bv||(Bv={}))
class oJ extends wq{constructor(e,t=null,n=null){super(),this.contentType=e,this.marker=t,this.items=n||[],this.header=void 0,this.url=null,this.mergeWhenFetched=!1,this.fetchStrategy=Nv.OnPageLoad,this.batchGroup=null,this.seeAllAction=null,this.footerTitle=null,this.footerAction=null,this.eyebrow=null,this.eyebrowArtwork=null,this.footerStyle=null,this.title=null,this.titleArtwork=null,this.subtitle=null,this.isHorizontal=!1,this.isHidden=!1,this.rowsPerColumn=null,this.background={type:qV},this.contentsMetadata={type:qV},this.isPersonalized=!1,this.shouldFilterApps=!1}}!function(e){e.TopLeading="topLeading",e.Top="top",e.TopTrailing="topTrailing",e.Trailing="trailing",e.BottomTrailing="bottomTrailing",e.Bottom="bottom",e.BottomLeading="bottomLeading",e.Leading="leading"}(Uv||(Uv={})),function(e){e.Grid="grid",e.Hero="hero",e.Standard="standard"}(Gv||(Gv={})),function(e){e.Icon="icon",e.Category="category"}(jv||(jv={}))
class iJ extends wq{constructor(e,t,n,r,o,i,s){super(),this.title=e,this.artwork=t,this.video=n,this.heading=r,this.badge=o,this.description=i,this.clickAction=s,this.shelfBackground=null,this.collectionIcons=null,this.editorialDisplayOptions={}}}class sJ extends PY{isValid(){const e=this.posterArtwork,t=this.posterVideo
return!(!e&&!t)&&super.isValid()}}class aJ extends hq{}class cJ extends hq{constructor(){super(),this.id=random.nextUUID()}}class lJ extends hq{constructor(e){super(),this.shelves=e,this.title=null,this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new EW}}class uJ extends hq{constructor(){super(),this.pageMetrics=new EW,this.pageRenderMetrics={}}}class dJ extends lJ{}class fJ extends lJ{}class pJ extends lJ{}class hJ extends lJ{constructor(e){super(e),this.pageSegments=[]}}class wJ{constructor(e,t,n,r){var i
this.contentsResourceTypes=new Set,this.ids=new Set,this.idsByResourceType=new Map,this.originalOrdering=[],this.relationshipIncludes=new Set,this.attributeIncludes=new Set,this.platform=null,this.supplementaryMetadataAssociations=[],this.additionalPlatforms=new Set,this.additionalQuery={},this.relationshipLimits={},this.searchTerm=null,this.searchTypes=[],this.context=null,this.useCustomAttributes=!1,this.countryCodeOverride=void 0,this.objectGraph=e,this.platform=L(e),this.isMixedMediaRequest=null!=n&&n,this.supplementaryMetadataAssociations=null!=r?r:[],this.includeAppBinaryTraitsAttribute=!0,(null===(i=e.activeIntent)||void 0===i?void 0:i.platform)&&(this.platform=e.activeIntent.platform),o(t)||(typeof t===gH?this.href=t:Array.isArray(t)&&this.withDataItems(t,r,n))}addDataToIDsByResourceType(e){const t=e.type,n=e.id
let r=this.idsByResourceType.get(t);(0,Cv.isNothing)(r)&&(r=new Set),r.add(n),this.idsByResourceType.set(t,r)}forType(e){return this.resourceType=e,this}withDataItems(e,t,n){if(0===e.length)return this
this.isMixedMediaRequest=this.isMixedMediaRequest||null!=n&&n
for(const r of e)if(this.ids.add(r.id),this.addDataToIDsByResourceType(r),(0,Cv.isSome)(n)&&n&&(0,Cv.isSome)(t)&&t.length>0)for(const e of t){const t=G(e,r);(0,Cv.isSome)(t)&&t.length>0&&t.forEach(e=>{this.addDataToIDsByResourceType(e)})}return 1===this.idsByResourceType.size?(this.resourceType=this.idsByResourceType.keys().next().value,this.isMixedMediaRequest=!1):this.idsByResourceType.size>1&&!this.isMixedMediaRequest&&(this.resourceType=FH,this.contentsResourceTypes=new Set(Array.from(this.idsByResourceType.keys()))),this.originalOrdering.push(...e),this}withIdOfType(e,t){return this.withDataItems([{id:e,type:t}])}withIdsOfType(e,t){return this.withDataItems(e.map(e=>({id:e,type:t})))}includingRelationships(e){for(const t of e)this.relationshipIncludes.add(t)
return this}includingScopedRelationships(e,t){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let n=this.scopedRelationshipIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedRelationshipIncludes.set(e,n),this}includingMetaKeys(e,t){this.metaIncludes||(this.metaIncludes=new Map)
let n=this.metaIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.metaIncludes.set(e,n),this}includingViews(e){this.viewsIncludes||(this.viewsIncludes=new Set)
for(const t of e)this.viewsIncludes.add(t)
return this}includingKindsKeys(e,t){this.kindIncludes||(this.kindIncludes=new Map)
let n=this.kindIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.kindIncludes.set(e,n),this}includingAssociateKeys(e,t){this.associateIncludes||(this.associateIncludes=new Map)
let n=this.associateIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.associateIncludes.set(e,n),this}includingRelationshipsForUpsell(e){const t=XG
if(e){this.scopedRelationshipIncludes||(this.scopedRelationshipIncludes=new Map)
let e=this.scopedRelationshipIncludes.get(OH)
e||(e=new Set),e.add(t),this.scopedRelationshipIncludes.set(OH,e)}else this.relationshipIncludes.add(t)
{this.metaIncludes||(this.metaIncludes=new Map)
let e=this.metaIncludes.get(XG)
e||(e=new Set),e.add(eG),this.metaIncludes.set(XG,e)}return this}includingAttributes(e){for(const t of e)this.attributeIncludes.add(t)
return this}includingScopedAttributes(e,t){this.scopedAttributeIncludes||(this.scopedAttributeIncludes=new Map)
let n=this.scopedAttributeIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAttributeIncludes.set(e,n),this}includingAgeRestrictions(){const e=this.objectGraph.client.maxAppContentRating
return e<1e3&&(this.ageRestriction=e),this}includingAdditionalPlatforms(e){for(const t of e)this.additionalPlatforms.add(t)
return this}includingScopedAvailableIn(e,t){this.scopedAvailableInIncludes||(this.scopedAvailableInIncludes=new Map)
let n=this.scopedAvailableInIncludes.get(e)
n||(n=new Set)
for(const e of t)n.add(e)
return this.scopedAvailableInIncludes.set(e,n),this}includingScopedSparseLimit(e,t){return this.scopedSparseLimit||(this.scopedSparseLimit=new Map),this.scopedSparseLimit.set(e,t),this}addingQuery(e,t){return(0,Cv.isSome)(t)?this.additionalQuery[e]=t:delete this.addingQuery[e],this}addingQueryValues(e){return this.additionalQuery={...this.addingQuery,...e},this}addingRelationshipLimit(e,t){return this.relationshipLimits[e]=t,this}withSearchTerm(e){return this.searchTerm=e,this}searchingOverTypes(e){for(const t of e)this.searchTypes.push(t)
return this}addingContext(e){return this.context=e,this}includingMacOSCompatibleIOSAppsWhenSupported(e=!1){return this.objectGraph.appleSilicon.isSupportEnabled&&(e||this.enablingFeature(kR),this.includingScopedAttributes(BH,[HO])),this}includingAppBinaryTraitsAttribute(e=!0){return this.includeAppBinaryTraitsAttribute=e,this}usingCustomAttributes(e){return this.useCustomAttributes=e,this}alwaysUseIdsAsQueryParam(e){return this.useIdsAsQueryParam=e,this}attributingTo(e){return this.canonicalUrl=e,this}withFilter(e,t){return this.filterType=e,this.filterValue=t,this}withLimit(e){return this.limit=e,this}withSparseLimit(e){return null!==e&&(this.sparseLimit=e),this}withSparseCount(e){return null!==e&&(this.sparseCount=e),this}enablingFeature(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(e),this}enablingFeatures(e){return this.enabledFeatures||(this.enabledFeatures=[]),this.enabledFeatures.push(...e),this}asPartialResponseLimitedToFields(e){return this.fields=e,this}includesResourceType(e){return this.resourceType===e||!!i(this.contentsResourceTypes)&&this.contentsResourceTypes.has(e)}withCountryCodeOverride(e){return this.countryCodeOverride=e,this}}const gJ=new RegExp("#?([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])([0-9,a-f,A-F][0-9,a-f,A-F])?"),vJ=Y(0,0,0),mJ=Y(1,1,1)
!function(e){e.insertIntoShelf="insertIntoShelf",e.replaceOrganic="replaceOrganic",e.dropAd="dropAd"}(Vv||(Vv={}))
class yJ extends wq{constructor(e){super(),this.kind=e}bestBackgroundColor(){}}class AJ extends yJ{constructor(e,t,n,r){super(e),this.artworks=t,this.videos=n,this.artworkLayoutsWithMetrics=r}bestBackgroundColor(){var e,t,n
return null!==(t=null===(e=this.videos[0])||void 0===e?void 0:e.preview.backgroundColor)&&void 0!==t?t:null===(n=this.artworks[0])||void 0===n?void 0:n.backgroundColor}}class TJ extends AJ{constructor(e,t){super(OB,e,t,[])}isValid(){const e=this.artworks.every(e=>e.isValid())&&this.artworks.length>0,t=this.videos.every(e=>e.isValid())&&this.videos.length>0
return(e||t)&&super.isValid()}}class bJ extends AJ{constructor(e,t,n,r){super(_H,e,t,n),this.titleBackingGradient=r}}class SJ extends yJ{constructor(e){super(OF),this.icon=e}bestBackgroundColor(){return this.icon.backgroundColor}}class PJ extends AJ{constructor(e,t,n,r,o){super(JU,t,n,r),this.icon=e,this.titleBackingGradient=o}bestBackgroundColor(){var e
return null!==(e=super.bestBackgroundColor())&&void 0!==e?e:this.icon.backgroundColor}}class IJ extends AJ{constructor(e,t,n,r,o,i){super($C,t,n,r),this.lockups=e,this.marketingText=o,this.isMediaDark=i}}class CJ extends yJ{constructor(e,t){super(RL),this.lockups=e,this.additionalText=t}}class kJ extends yJ{constructor(e){super(kB),this.lockup=e}bestBackgroundColor(){return this.lockup.icon.backgroundColor}}class OJ extends yJ{constructor(e){super(xD),this.lockups=e,this.lockupImpressionLimit=10}}class EJ extends AJ{constructor(e,t,n){super(DV,[],e,t),this.description=n}}class RJ extends AJ{constructor(e,t,n,r,o,i,s){super(CF,r,o,i),this.formattedDates=e,this.startDate=t,this.tintColor=n,this.blurStyle=s}}class DJ extends yJ{constructor(e){super("mediumLockupWithAlignedRegion"),this.mediumAdLockupWithAlignedRegionBackground=e}}class _J extends yJ{constructor(e){super("mediumLockupWithScreenshots"),this.mediumAdLockupWithScreenshotsBackground=e}}class xJ extends yJ{constructor(e){super(DL),this.condensedAdLockupWithIconBackground=e}bestBackgroundColor(){var e
return null===(e=this.condensedAdLockupWithIconBackground)||void 0===e?void 0:e.backgroundArtwork.backgroundColor}}class LJ extends hq{constructor(e){super(),this.kind=e}}class MJ extends LJ{constructor(e){super(cH),this.lockup=e,this.displaysIcon=!0}}class $J extends LJ{constructor(e,t,n,r){super("marketingLockup"),this.lockup=e,this.paragraph=t,this.hideBackground=n,this.artworkBackgroundColor=r}}class FJ extends LJ{constructor(e){super($m),this.lockups=e}}class NJ extends LJ{constructor(e,t){super(fG),this.paragraph=e,this.style=t}}class BJ extends LJ{constructor(e){super(EV),this.action=e}}class UJ extends LJ{constructor(e,t,n){super("threeLine"),this.heading=e,this.title=t,this.description=n}}class GJ extends LJ{constructor(e){super("arcadeLockup"),this.arcadeLockup=e}}class jJ extends wq{constructor(){super(),this.heading=void 0,this.title=void 0,this.shortTitle=void 0,this.titleArtwork=void 0,this.media=void 0,this.heroMedia=void 0,this.overlay=void 0,this.style=void 0,this.clickAction=void 0,this.backgroundColor=void 0,this.inlineDescription=void 0,this.collapsedHeading=void 0,this.editorialDisplayOptions=void 0,this.supportsMediaMirroring=void 0}}class VJ extends wq{constructor(e){super(),this.cards=e}}class HJ extends hq{constructor(e,t,n,r,o,i){super(),this.shelves=e,this.title=n,this.titleDetail=o,this.shortTitleDetail=i,this.tabTitle=r,this.nextPage=null,this.onboardingCardIds=t||[],this.pageMetrics=new EW,this.pageRenderMetrics={}}}const qJ={artwork:TL,iconArtwork:SD,screenshotsByType:"customScreenshotsByType",promotionalText:"customPromotionalText",videoPreviewsByType:"customVideoPreviewsByType",customScreenshotsByTypeForAd:FF,customVideoPreviewsByTypeForAd:Xk,customDeepLink:xM}
class WJ extends hq{constructor(e,t,n,r){super(),this.details=e,this.dismissButtonTitle=t,this.offerButtonAction=n,this.offerDisplayProperties=r,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class zJ extends hq{constructor(e,t,n){super(),this.headline=e,this.body=t,this.artwork=n}}class YJ extends hq{constructor(e,t,n,r,o){super(),this.title=e,this.subtitle=t,this.items=n,this.continueAction=r,this.familyAction=o}}class JJ extends hq{constructor(e,t){super(),this.individualContent=e,this.familyMemberContent=t,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class KJ extends hq{constructor(e,t,n,r,o){super(),this.serviceType=e,this.placement=t,this.seed=r,this.clientOptions=o,this.metricsOverlay={topic:n}}}class ZJ extends hq{constructor(e,t){super(),this.clientOptions=t,this.metricsOverlay={topic:e}}}class QJ extends hq{constructor(e,t){super(),this.primaryIcon=e,this.icons=t}}class XJ extends hq{constructor(e){super(),this.action=e}}class eK extends wq{constructor(e,t,n,r,o){super(),this.id=e,this.title=t,this.artwork=n,this.gradientStartColor=r,this.gradientEndColor=o,this.selectActionMetrics=new OW,this.deselectActionMetrics=new OW}}class tK extends hq{constructor(e,t,n,r,o,i,s){super(),this.title=e,this.categories=t,this.maxNumberOfCategoriesToChoose=n,this.maxNumberOfCategoriesToChooseTemplate=r,this.numberOfChosenCategoriesTemplate=o,this.primaryAction=i,this.dismissAction=s,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class nK extends hq{constructor(e,t){super(),this.lockup=e,this.categoryId=t}}class rK extends hq{constructor(e,t,n,r,o,i,s){super(),this.title=e,this.suggestions=t,this.getAllAction=n,this.getAllButtonStyle=r,this.primaryAction=o,this.primaryActionKind=i,this.primaryActionSecondaryTitle=s,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class oK{constructor(e,t){this.items=e,this.commonBuyParams=t}}class iK{constructor(e,t){this.purchase=e,this.buyParams=t}}class sK{constructor(e){if(this._values={},(0,Cv.isSome)(e)&&e.length>0){const t=e.split("&")
for(const e of t){const[t,n]=e.split("="),r=decodeURIComponent(t),o=(0,Cv.isNothing)(n)?"":decodeURIComponent(n)
this._values[r]=o}}}_searchKey(e,t){if(0===e.length)throw new Error("key may not be zero length")
return(0,Cv.isNothing)(t)||0===t.length?e:`${t}${e.charAt(0).toUpperCase()}${e.slice(1)}`}get(e,t="mt"){const n=this._searchKey(e,t)
return this._values[n]}set(e,t,n="mt"){const r=this._searchKey(e,n)
return(0,Cv.isNothing)(t)?delete this._values[r]:this._values[r]=t,this}toString(){let e=""
for(const t of Object.keys(this._values)){const n=this._values[t]
e.length>0&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(n)}return e}toEncodedMap(){const e={}
for(const t of Object.keys(this._values)){const n=this._values[t],r=encodeURIComponent(t),o=encodeURIComponent(n)
e[r]=o}return e}toRawMap(){return{...this._values}}}const aK="jet_adamId",cK="_jet-internal:derived-data",lK=sH
class uK extends hq{constructor(){super(),this.shelfOrderings={},this.shelfMapping={},this.presentationOptions=[],this.isIncomplete=!1,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class dK extends uK{}class fK extends wq{constructor(e,t,n,r,o,i,s,a,c){super(),this.title=e,this.artwork=t,this.collectionIcons=n,this.backgroundColor=r,this.badge=o,this.action=i,this.density=s,this.artworkSafeArea=a,this.textSafeArea=c}}class pK extends wq{constructor(e,t,n,r,o,i){super(),this.lockup=e,this.screenshots=t,this.isAnimated=n,this.secondaryTextColor=r,this.backgroundColor=o,this.riverSpeed=i}}class hK extends wq{constructor(e,t){super(),this.lockup=e,this.backgroundArtwork=t}}class wK{constructor(e,t,n,r,o,i,s=null,a){this.id=e,this.title=t,this.searchLandingItemDisplayStyle=s,this.displayStyle=n,this.displayCount=r,this.hasSeeAll=o,this.seeAllLink=i,this.searchShelfKind=a}}!function(e){e.Suggestion="Query",e.CategoriesAndCharts="EditorialLink",e.Apps="AppsLockup",e.EditorialCollection="EditorialCollection"}(Hv||(Hv={})),function(e){e[e.Default=0]="Default",e[e.CategoriesAndCharts=1]="CategoriesAndCharts"}(qv||(qv={})),function(e){e.Density1="density_1",e.Density2="density_2",e.Density3="density_3"}(Wv||(Wv={})),function(e){e.Chiclet="chiclet",e.App="app",e.Symbol="symbol"}(zv||(zv={}))
const gK=(e,t)=>e||t
Yv=e(8371)
let vK=null
const mK=[aH,iH,$H,kH,MH,"tv"]
class yK extends hq{constructor(e,t,n,r,o,i,s){super(),this.instanceId=e,this.adamId=t,this.bundleId=n,this.advertType=r,this.invocation=o,this.purchaseType=i,this.reportingDestination=s}}class AK extends hq{constructor(e,t,n,r,o,i,s,a,c,l=pV){super(),this.type=e,this.key=t,this.content=n,this.heading=o,this.caption=i,this.longCaption=s,this.leadingValue=l,this.accessibilityTitle=a,this.accessibilityCaption=c,this.style=r,this.isMonochrome=!0}}class TK extends hq{constructor(e,t){super(),this.type=e,this.shelfId=t}}class bK extends hq{constructor(e,t){super(),this.title=e,this.subtitle=t}}class SK extends PY{constructor(){super(),this.pageMetrics=new EW,this.pageRenderMetrics={}}}const PK=new Set([yH,vH,bH]),IK=new Set([hV,yV,wV,fH,kL,PV,kU,cU,GV,nH,Sj,Hj,WV,uG,dH,IV,YU,BG,AV,Pj,Lj,TV,NV,RV,pH,MV,dG,lU,m$,bV])
class CK extends hq{constructor(e,t,n,r){super(),this.id=e,this.title=t,this.selectedActionTitle=n,this.url=r}}class kK extends lJ{constructor(){super([])}}class OK extends hq{}class EK extends wq{}class RK extends hq{}class DK extends hq{constructor(){super(...arguments),this.componentType=Mm}}class _K extends hq{constructor(){super(...arguments),this.componentType="productReviewActions"}}class xK extends hq{constructor(e){super(),this.showsBadge=!1,this.title=null,this.notes=e,this.isCollapsed=!0}}class LK extends hq{}class MK extends hq{}class $K extends hq{}class FK extends OK{constructor(){super(...arguments),this.componentType="starRatings"}}class NK extends OK{constructor(){super(...arguments),this.componentType="starRatingsHistogram"}}class BK extends OK{constructor(){super(...arguments),this.componentType="noRatings"}}class UK extends hq{constructor(e){super(),this.componentType=OL,this.messageText=e}}class GK extends wq{constructor(e,t,n,r,o,i,s){super(),this.body=e,this.bodyNoTitle=t,this.subtitle=n,this.subtitleArtwork=r,this.subtitleArtworkAlignment=o,this.bodyMediaType=i,this.flowPreviewActionsConfiguration=s}}class jK extends wq{constructor(){super(...arguments),this.componentType=EL}}const VK="notPurchasedOrdering"
class HK extends uK{constructor(){super(...arguments),this.appPlatforms=[]}}class qK{static get contentType(){return Cx}constructor(){this._params=""}param(e,t){if(e&&t){const n=this._params.length>0?"&":""
this._params+=`${n}${encodeURIComponent(e)}=${encodeURIComponent(t)}`}return this}build(){return this._params}}const WK="externalDeepLinkUrl",zK="isCppDeepLinkDisabled",YK=new class{constructor(){this._app="",this._clientId="",this._pages=[]}get _requestId(){const e=Date.now().toString(36).toUpperCase(),t=Math.floor(1e5*Math.random()).toString(36).toUpperCase()
return this._clientId+"z"+e+"z"+t}get _prevPage(){return this._pages.length>=2?this._pages[this._pages.length-2]:void 0}useApp(e){""!==this._app||r(e)||(this._app=e)}useClientId(e){r(e)||(this._clientId=e)}usePageHistory(e){if(0!==e.length){this._pages.length=0
for(const t of e){const e=f(t)
r(e)||this._pages.push(e)}}}useNativeValues(e){const t=f(e,"nativeApp")
this.useApp(t)
const n=f(e,"nativeClientId")
this.useClientId(n)
const r=l(e,"nativePageHistory")
this.usePageHistory(r)}getPageHistoryFor(e){const t=this._pages.slice()
return this._pages.length>=5&&this._pages.shift(),this._pages.push(e),t}get params(){return{app:this._app,clientId:this._clientId,requestId:this._requestId,prevPage:this._prevPage,eventTime:Date.now()}}}
let JK=null
const KK={containerId:"mtContainerId",placementId:"mtIadPlacementId",templateType:"mtIadTemplateType"};(Dm=Jv||(Jv={})).ArcadeSeeAllGames="editorial-shelves-arcade-see-all-games",Dm.Collection="editorial-shelves-collection",Dm.Chart="editorial-shelves-chart",Dm.Tag="editorial-shelves-tag",Dm.Engagement="editorial-shelves-engagement",Dm.Text="editorial-shelves-text",Dm.Image="editorial-shelves-image",Dm.VideoClip="editorial-shelves-video-clip",Dm.Header="editorial-shelves-header",Dm.Recommendations="editorial-shelves-recommendation",Dm.GameCenter="editorial-shelves-game-center",Dm.Upsell="editorial-shelves-upsell",Dm.Marker="editorial-shelves-marker",(Rm=Kv||(Kv={})).Hero="Hero",Rm.TextOnly="TextOnly",Rm.TextWithArtwork="TextWithArtwork",Rm.BrickSmall="BrickSmall",Rm.BrickMedium="BrickMedium",Rm.BrickLarge="BrickLarge",Rm.Charts="Charts",Rm.EditorialLockupHierarchicalPortrait="EditorialLockupHierarchicalPortrait",Rm.EditorialLockupHierarchicalRows="EditorialLockupHierarchicalRows",Rm.EditorialLockupMedium="EditorialLockupMedium",Rm.EditorialLockupMediumVariant="EditorialLockupMediumVariant",Rm.EditorialLockupLarge="EditorialLockupLarge",Rm.EditorialLockupLargeVariant="EditorialLockupLargeVariant",Rm.LockupMedium="LockupMedium",Rm.Lockup4Up="Lockup4Up",Rm.Poster="Poster",Rm.StorySmall="StorySmall",Rm.StoryMedium="StoryMedium",Rm.LockupSmall="LockupSmall",Rm.LockupLarge="LockupLarge",Rm.BreakoutLarge="BreakoutLarge",function(e){e.QuickLinks="QuickLinks"}(Zv||(Zv={})),(Em=Qv||(Qv={})).Vertical="Vertical",Em.Horizontal="Horizontal",Em.Condensed="Condensed",function(e){e.ShowInstalled="ShowInstalled",e.ShowAllPlatforms="ShowAllPlatforms",e.ShowOnlyPreorder="ShowOnlyPreorder"}(Xv||(Xv={})),function(e){e.AllGames="AllGames",e.ArcadeGames="ArcadeGames"}(em||(em={})),function(e){e.FriendsArePlaying="FriendsArePlaying",e.ContinuePlaying="ContinuePlaying"}(tm||(tm={})),function(e){e.ArcadeTabHeader="ArcadeTabHeader"}(nm||(nm={})),function(e){e.Arcade="Arcade"}(rm||(rm={}))
class ZK extends hq{constructor(e,t,n,r,o){super(),this.showLiveIndicator=e,this.displayFromDate=t,this.displayText=n,this.countdownToDate=r,this.countdownStringKey=o}}!function(e){e.AppEvent="appEvent",e.ContingentOffer="contingentOffer",e.OfferItem="offerItem"}(om||(om={}))
class QK extends wq{constructor(e){super(),this.promotionType=e}}class XK extends QK{constructor(e,t,n,r,o,i,s,a,c,l,u,d,f,p,h){super(om.AppEvent),this.appEventId=e,this.moduleArtwork=t,this.moduleVideo=n,this.title=r,this.subtitle=o,this.detail=i,this.startDate=s,this.endDate=a,this.kind=c,this.requirements=l,this.lockup=u,this.hideLockupWhenNotInstalled=d,this.formattedDates=f,this.mediaOverlayStyle=p,this.includeBorderInDarkMode=h,this.clickAction=null}}class eZ extends hq{constructor(e,t,n,r,o,i){super(),this.appEvent=e,this.artwork=t,this.video=n,this.shareAction=r,this.mediaOverlayStyle=o,this.includeBorderInDarkMode=i,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class tZ extends hq{constructor(e,t,n,r,o,i,s,a,c,l,u){super(),this.appEventId=e,this.title=t,this.detail=n,this.artworkUrl=r,this.displayTime=o,this.scheduledAction=i,this.notAuthorizedAction=s,this.failureAction=a,this.destinationUrl=c,this.scheduleClickEvent=l,this.cancelScheduleClickEvent=u}}class nZ extends QK{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(om.ContingentOffer),this.backgroundArtwork=e,this.isStreamlinedBuy=n,this.mediaOverlayStyle=t,this.titleFormatted=o,this.subtitle=i,this.additionalInfo=l,this.description=s,this.label=a,this.badge=c,this.offerLockup=d,this.trunkAppIcon=u,this.learnMoreTitle=r,this.clickAction=null}}class rZ extends wq{constructor(e){super(),this.promotionType=e}}class oZ extends rZ{constructor(e,t,n){super(om.ContingentOffer),this.contingentOffer=e,this.artwork=t,this.mediaOverlayStyle=n,this.pageMetrics=new EW,this.pageRenderMetrics={},this.learnMoreActionMetrics=new OW,this.backButtonActionMetrics=new OW,this.closeButtonActionMetrics=new OW}}class iZ extends QK{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(om.OfferItem),this.moduleArtwork=e,this.moduleVideo=t,this.isStreamlinedBuy=r,this.mediaOverlayStyle=n,this.titleFormatted=o,this.description=a,this.badge=c,this.offerLockup=d,this.subtitle=s,this.endDate=l,this.expiryDateFormatted=i,this.iapArtwork=u,this.clickAction=null}}class sZ extends rZ{constructor(e,t,n,r,o,i,s){super(om.OfferItem),this.offerItem=e,this.artwork=t,this.learnMoreTitle=i,this.video=n,this.mediaOverlayStyle=r,this.pageMetrics=new EW,this.additionalInfo=s,this.pageRenderMetrics={},this.learnMoreActionMetrics=new OW,this.backButtonActionMetrics=new OW,this.closeButtonActionMetrics=new OW}}class aZ extends hq{constructor(){super(),this.pageMetrics=new EW,this.pageRenderMetrics={}}}class cZ extends aZ{}class lZ extends wq{constructor(e,t){super(),this.message=e,this.action=t}}class uZ extends aZ{constructor(e=[]){super(),this.shelves=[],this.shelves=e}}!function(e){e.visionOS="xros",e.iOS="ios"}(im||(im={}))
class dZ extends hq{constructor(e,t){super(),this.type=e,this.values=t}}class fZ extends hq{constructor(e,t,n=null){super(),this.name=e,this.value=t,this.isSelected=t===n}}class pZ extends hq{constructor(e,t,n){super(),this.instanceId=e,this.eventPayloads=t,this.searchAd=n}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}setMissedOpportunityReason(e){this.eventPayloads.placed.missedOpportunityReason=e}}class hZ extends hq{constructor(e,t,n,r,o){super(),this.instanceId=e,this.iAd=t,this.eventPayloads=n,this.impressionId=r,this.transparencyAction=o}setTemplateType(e){this.eventPayloads.placed.iAdTemplateType=e}setDuplicatePosition(e){this.eventPayloads.placed.duplicatePosition=e}}class wZ extends _W{constructor(e){super("AdTransparencyAction"),this.adTransparencyData=e}}class gZ extends _W{constructor(e,t,n,r,o,i,s,a){super("SearchAction"),this.spellCheckEnabled=!1,this.title=e,this.term=t,this.url=n,this.origin=r,this.entity=o,this.source=i,this.presentationStyle=null!=s?s:[NC],this.referrerData=a}}class vZ extends hq{constructor(e,t){super(),this.hints=e,this.ghostHintTerm=t,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class mZ extends hq{constructor(e,t,n=null){super(),this.primaryText=e,this.secondaryText=t,this.messageClickAction=n}}class yZ extends wq{constructor(e){super(),this.resultType=e,this.clickAction=null}}class AZ extends yZ{constructor(e){super("content"),this.lockup=e}}class TZ extends yZ{constructor(e){super(kB),this.lockup=e}}class bZ extends yZ{constructor(e){super(BC),this.lockup=e}}class SZ extends yZ{constructor(){super("advert"),this.lockups=[],this.displaysScreenshots=!0,this.itemBackground="ad"}}class PZ extends yZ{constructor(){super(CF)}}class IZ extends yZ{constructor(e){super(UC),this.title=e}}class CZ extends yZ{constructor(e,t,n,r,o){super("lockupCollection"),this.heading=e,this.headingArtwork=o,this.title=t,this.items=n,this.detailAction=r}}class kZ extends yZ{constructor(e,t){super(_L),this.title=e,this.tokens=t}}class OZ extends wq{constructor(e){super(),this.linkableText=e}}let EZ=null
const RZ="jet_native_advert_instanceid"
class DZ extends hq{constructor(e,t,n,r,o){super(),this.name=e,this.genreId=t,this.artwork=n,this.ageBandId=r,this.children=o}}class _Z extends hq{constructor(e){super(),this.categories=e}}!function(e){e.requestedUrl="_jet-internal:metricsHelpers_requestedUrl",e.timingValues="_jet-internal:metricsHelpers_timingValues",e.pageInformation="_jet-internal:metricsHelpers_pageInformation",e.contentMaxAge="_jet-internal:responseMetadata_contentMaxAge"}(sm||(sm={}))
const xZ="X-Apple-AppStore-UserId-Secondary"
class LZ extends Error{}class MZ extends Error{}const $Z="x-apple-application-instance",FZ="x-apple-application-site"
class NZ extends hq{constructor(e,t,n,r,o=!1,i=!1){super(),this.strategy=e,this.updateDelayInterval=t,this.timeSinceOnScreenInterval=n,this.timeToLiveEndDate=r,this.refreshWhileVisible=o,this.refreshForDeviceDrivenContentChange=i}}const BZ=new Set([117,122,118,195,194,197,369,370,371,372,373,374,375,376,377,378,379,380,395,396,397,398,399,400,491,492,493,504,505,506,520,521,522,523,524,525,530,531,532,533,567,571]),UZ=new Set([491,492,493]),GZ=new Set([530,531,532,533]),jZ=new Set([567,571]),VZ=new Set([311,312,476]),HZ=new Set([...VZ,518]),qZ=new Set([557,418,431,429,430,420,304,305,260,497]),WZ=new Set([413,414,254,255,256,266,271,436])
let zZ=null
const YZ=[gG,z$,kj,IH,JB,oN,qN,WN],JZ=[gG,Y$,kj,JB],KZ=[gG,kj,IH,YB],ZZ=[gG,z$,kj,IH,JB,oN,qN,WN,Y$,YB],QZ=qN
let XZ=null
const eQ=[nH,NB,NF],tQ="RoutableArticlePageIntent",nQ=[nH,Jy,w_,eV,x$,Ky,SG,g_,v_,GN,tG,m_,nj,Mk,xB,Zy,Qy,gk,Xy,"miniGamesDeepLink","gameDisplayName"],rQ=/id([0-9]+)\/?$/i,oQ={915249334:"1462947752"}
class iQ{}class sQ extends Error{}class aQ extends iQ{constructor(e){super(),this.rawData=e,this.appId=null,this.groupId=null,this.score=0,this.segScores=new Map,this.modifiedScore=0,this.onDeviceScore=0}}class cQ extends iQ{constructor(e){super(),this.rawData=e,this.isExactMatch=!1,this.isWildcardMatch=!1,this.isUnpersonalizedMatch=!1,this.isFallbackMatch=!1,this.appId=null,this.groupId=null,this.score=0,this.modifiedScore=0,this.onDeviceScore=0}}const lQ="-1"
class uQ{constructor(e,t,n){this.locationTracker={rootPosition:0,locationStack:[]},this.parsedCardCount=0,this.currentRowIndex=0,this.pageInformation=e,this.locationTracker=null!=t?t:{rootPosition:0,locationStack:[]},this.refreshController=n}}class dQ extends uQ{constructor(e,t,n,r,o){super(t,n,r),this.pageHasDisplayedContent=!1,this.remainingContent=e,this.adPlacementBehavior=Vv.insertIntoShelf,this.recoImpressionData=o}}!function(e){e.AppEventCard="AppEventCard",e.AppOfTheDay="AppOfTheDay",e.FullBleedImage="FullBleedImage",e.GameOfTheDay="GameOfTheDay",e.Grid="Grid",e.InAppPurchase="InAppPurchase",e.List="List",e.NumberedList="NumberedList",e.River="River",e.ShortImage="ShortImage",e.SingleApp="SingleApp",e.Video="Video"}(am||(am={})),function(e){e.SmallCard="smallCard",e.MediumCard="mediumCard"}(cm||(cm={})),function(e){e.NoArtwork="no-artwork",e.ContentArtworkWithTitle="content-artwork-with-title",e.CategoryArtworkWithTitle="category-artwork-with-title",e.CategoryArtworkWithBadge="category-artwork-with-badge"}(lm||(lm={})),function(e){e.AppOfTheDay="app-of-the-day",e.GameOfTheDay="game-of-the-day"}(um||(um={})),function(e){e.Eyebrow="eyebrow",e.Title="title"}(dm||(dm={})),function(e){e.LinearGradient="linear-gradient"}(fm||(fm={})),function(e){e.Inline="inline",e.Article="article"}(pm||(pm={}))
const fQ={collapsedContentMode:Ov.bottomLeft,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:zq},pQ={collapsedContentMode:Ov.bottomLeft,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},hQ={collapsedContentMode:Ov.topLeft,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},wQ={maxWidth:250,ltr:fQ,rtl:fQ,collapsedSize:{type:vj,height:1},priority:Ev.Mini},gQ={objectPath:tD,cardArtLayoutMetrics:[wQ,{maxWidth:704,ltr:pQ,rtl:pQ,collapsedSize:{type:vj,height:1.062}},{ltr:hQ,rtl:hQ,collapsedSize:{type:gL,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:NG},vQ={collapsedContentMode:Ov.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Ov.bottomLeft,expandedLayoutInsets:zq},mQ={collapsedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedContentMode:Ov.bottomLeft,expandedLayoutInsets:zq},yQ={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},AQ={maxWidth:250,ltr:vQ,rtl:vQ,collapsedSize:{type:vj,height:1},priority:Ev.Mini},TQ={objectPath:nD,cardArtLayoutMetrics:[AQ,{maxWidth:704,ltr:mQ,rtl:mQ,collapsedSize:{type:vj,height:1.062}},{ltr:yQ,rtl:yQ,collapsedSize:{type:gL,width:1}}],crops:["sr"],sourceWidth:800,sourceHeight:490,type:NG},bQ={collapsedContentMode:Ov.bottomLeft,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedLayoutInsets:zq},SQ={collapsedContentMode:Ov.bottomLeft,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},PQ={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},IQ={maxWidth:250,ltr:bQ,rtl:bQ,collapsedSize:{type:vj,height:1},priority:Ev.Mini},CQ={objectPath:rD,cardArtLayoutMetrics:[IQ,{maxWidth:704,ltr:SQ,rtl:SQ,collapsedSize:{type:vj,height:1.062}},{ltr:PQ,rtl:PQ,collapsedSize:{type:gL,width:1}}],crops:[fL],sourceWidth:800,sourceHeight:490,type:NG},kQ=Ov.topRight,OQ={top:-108,left:495,bottom:0,right:0},EQ=Ov.topLeft,RQ={top:-108,left:-495,bottom:0,right:0},DQ={type:Vj,width:1124,height:482},_Q={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:kQ,expandedLayoutInsets:OQ},xQ={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-117,left:0,bottom:0,right:0},expandedContentMode:EQ,expandedLayoutInsets:RQ},LQ={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:-165,left:524,bottom:0,right:0},expandedContentMode:kQ,expandedLayoutInsets:OQ},MQ={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:-165,left:-524,bottom:0,right:0},expandedContentMode:EQ,expandedLayoutInsets:RQ},$Q={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:kQ,expandedLayoutInsets:OQ},FQ={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-55,left:0,bottom:0,right:0},expandedContentMode:EQ,expandedLayoutInsets:RQ},NQ={objectPath:"editorialVideo.listCardMotion21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:_Q,rtl:xQ,collapsedSize:{type:Vj,width:914,height:392},expandedSize:DQ,priority:Ev.Mini},{ltr:LQ,rtl:MQ,collapsedSize:{type:Vj,width:1188,height:509},expandedSize:DQ},{ltr:$Q,rtl:FQ,collapsedSize:{type:Vj,width:1456,height:624},expandedSize:DQ,priority:Ev.ExtraWide}],crops:[],sourceWidth:1208,sourceHeight:518,type:DV},BQ={collapsedContentMode:Ov.bottomRight,collapsedLayoutInsets:zq,expandedContentMode:Ov.topRight,expandedLayoutInsets:zq},UQ={collapsedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedContentMode:Ov.topLeft,expandedLayoutInsets:zq},GQ={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Ov.right,expandedLayoutInsets:zq},jQ={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:-49,left:0,bottom:0,right:0},expandedContentMode:Ov.left,expandedLayoutInsets:zq},VQ={collapsedContentMode:Ov.scaleAspectFill,collapsedLayoutInsets:zq,expandedContentMode:Ov.bottomRight,expandedLayoutInsets:{top:50,left:495,bottom:0,right:0}},HQ={collapsedContentMode:Ov.scaleAspectFill,collapsedLayoutInsets:zq,expandedContentMode:Ov.bottomRight,expandedLayoutInsets:{top:50,left:-495,bottom:0,right:0}},qQ={objectPath:"editorialArtwork.listCardStatic21x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:BQ,rtl:UQ,sourceCropOverrideLTR:"LCS.ApLCS01",sourceCropOverrideRTL:"LCS.ApLCS02",sourceSizeOverride:new Sq(550,264),priority:Ev.Mini},{ltr:GQ,rtl:jQ,collapsedSize:{type:Vj,width:672,height:279}},{ltr:VQ,rtl:HQ,expandedSize:{type:Vj,width:1124,height:482},sourceCropOverrideLTR:mI,sourceCropOverrideRTL:mI,priority:Ev.ExtraWide}],crops:["LCS.ApLCL01","LCS.ApLCL02"],sourceWidth:688,sourceHeight:286,type:NG},WQ={collapsedContentMode:Ov.bottomLeft,collapsedLayoutInsets:{top:0,left:-8,bottom:0,right:0},expandedContentMode:Ov.bottomLeft,expandedLayoutInsets:zq},zQ={collapsedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedContentMode:Ov.bottomLeft,expandedLayoutInsets:zq},YQ={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottomLeft,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},JQ={maxWidth:250,ltr:WQ,rtl:WQ,collapsedSize:{type:vj,height:1},priority:Ev.Mini},KQ={objectPath:ex,cardArtLayoutMetrics:[JQ,{maxWidth:704,ltr:zQ,rtl:zQ,collapsedSize:{type:vj,height:1.062}},{ltr:YQ,rtl:YQ,collapsedSize:{type:gL,width:1}}],crops:[fL],sourceWidth:800,sourceHeight:490,type:NG},ZQ={collapsedContentMode:Ov.center,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},QQ={objectPath:"editorialVideo.storeFrontVideo",cardArtLayoutMetrics:[{ltr:ZQ,rtl:ZQ,collapsedSize:{type:vj,height:1},expandedSize:{type:vj,height:1}}],crops:[],sourceWidth:875,sourceHeight:492,type:DV},XQ={collapsedContentMode:Ov.center,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},eX={objectPath:"editorialVideo.storeFrontVideo4x3",cardArtLayoutMetrics:[{ltr:XQ,rtl:XQ,collapsedSize:{type:vj,height:1},expandedSize:{type:vj,height:1}}],crops:[],sourceWidth:656,sourceHeight:492,type:DV},tX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},nX={collapsedContentMode:Ov.top,expandedContentMode:Ov.top,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},rX={objectPath:"editorialVideo.storyCardMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:tX,rtl:tX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},{ltr:nX,rtl:nX,collapsedSize:{type:vj,height:1}}],sourceWidth:800,sourceHeight:450,type:DV,crops:["sr"]},oX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},iX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},sX={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},aX={maxWidth:250,ltr:oX,rtl:oX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},cX={objectPath:yI,cardArtLayoutMetrics:[aX,{maxWidth:704,ltr:iX,rtl:iX,collapsedSize:{type:vj,height:1.08}},{ltr:sX,rtl:sX}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:NG},lX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},uX={collapsedContentMode:Ov.top,expandedContentMode:Ov.top,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},dX={objectPath:"editorialVideo.storyCenteredMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:lX,rtl:lX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},{ltr:uX,rtl:uX,collapsedSize:{type:vj,height:1}}],sourceWidth:800,sourceHeight:450,type:DV,crops:["sr"]},fX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},pX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},hX={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},wX={maxWidth:250,ltr:fX,rtl:fX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},gX={maxWidth:704,ltr:pX,rtl:pX,collapsedSize:{type:vj,height:1.08}},vX={ltr:hX,rtl:hX},mX={objectPath:pL,cardArtLayoutMetrics:[wX,gX,vX],crops:["sr"],sourceWidth:800,sourceHeight:450,type:NG},yX={objectPath:pL,cardArtLayoutMetrics:[wX,gX,vX],crops:["nr"],sourceWidth:1280,sourceHeight:586,type:NG},AX={type:Vj,width:1200,height:675},TX={top:-130,left:0,bottom:0,right:0},bX={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-16,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},SX={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:-116,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},PX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:-116,left:-70,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},IX={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:-116,left:70,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},CX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},kX={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:-148,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},OX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},EX={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:-170,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:TX},RX={objectPath:"editorialVideo.universalAMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:bX,rtl:bX,collapsedSize:{type:Vj,width:455,height:256},expandedSize:AX,priority:Ev.Mini},{maxWidth:699,ltr:SX,rtl:SX,collapsedSize:{type:Vj,width:1094,height:614},expandedSize:AX},{maxWidth:899,ltr:PX,rtl:IX,collapsedSize:{type:Vj,width:1092,height:614},expandedSize:AX},{maxWidth:1090,ltr:CX,rtl:kX,collapsedSize:{type:Vj,width:1392,height:783},expandedSize:AX},{ltr:OX,rtl:EX,collapsedSize:{type:Vj,width:1600,height:900},expandedSize:AX}],crops:[AI],sourceWidth:1600,sourceHeight:900,type:DV},DX={collapsedContentMode:Ov.top,collapsedLayoutInsets:{top:16,left:0,bottom:0,right:0},expandedContentMode:Ov.top,expandedLayoutInsets:zq},_X={collapsedContentMode:Ov.scaleAspectFill,collapsedLayoutInsets:zq,expandedContentMode:Ov.scaleAspectFill,expandedLayoutInsets:zq},xX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:{top:0,left:-70,bottom:0,right:0},expandedContentMode:Ov.center,expandedLayoutInsets:zq},LX={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:{top:0,left:70,bottom:0,right:0},expandedContentMode:Ov.center,expandedLayoutInsets:zq},MX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},$X={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},FX={collapsedContentMode:Ov.topLeft,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},NX={collapsedContentMode:Ov.topRight,collapsedLayoutInsets:zq,expandedContentMode:Ov.center,expandedLayoutInsets:zq},BX={objectPath:"editorialArtwork.universalAStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:DX,rtl:DX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},{maxWidth:699,ltr:_X,rtl:_X},{maxWidth:899,ltr:xX,rtl:LX},{maxWidth:1090,ltr:MX,rtl:$X,collapsedSize:{type:Vj,width:1400,height:527}},{ltr:FX,rtl:NX,collapsedSize:{type:Vj,width:1600,height:604}}],crops:[AI],sourceWidth:1600,sourceHeight:604,type:NG},UX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},GX={collapsedContentMode:Ov.top,expandedContentMode:Ov.top,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},jX={objectPath:"editorialVideo.categoryDetailMotion16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:UX,rtl:UX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},{ltr:GX,rtl:GX,collapsedSize:{type:vj,height:1}}],sourceWidth:800,sourceHeight:450,type:DV,crops:["sr"]},VX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},HX={collapsedContentMode:Ov.bottom,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},qX={collapsedContentMode:Ov.scaleAspectFill,expandedContentMode:Ov.bottom,collapsedLayoutInsets:zq,expandedLayoutInsets:zq},WX={objectPath:"editorialArtwork.categoryDetailStatic16x9",cardArtLayoutMetrics:[{maxWidth:250,ltr:VX,rtl:VX,collapsedSize:{type:Vj,width:455,height:256},priority:Ev.Mini},{maxWidth:704,ltr:HX,rtl:HX,collapsedSize:{type:vj,height:1.08}},{ltr:qX,rtl:qX}],crops:["sr"],sourceWidth:800,sourceHeight:450,type:NG},zX="isOnBoardingCard"
hm=e(172)
const YX="appStore.getEngagementEvents"
!function(e){e.EditorialItem="editorialItem",e.EditorialItemGroup="editorialItemGroup"}(wm||(wm={}))
const JX="X-AppStore-iAdClickToken",KX="X-AppStore-iAdLineItem",ZX="X-AppStore-iAdDismissAdActionMetrics"
class QX{constructor(e,t,n,r,o,s,a){this.placementType=t,this.placementId=null===t?null:this.placementIdFromType(t),this.pageFields={},this.clickFields={},this.impressionsFields={},this.fastImpressionFields={},this.iAdClickEventFields={},this._iAdApplied=!1,this._iAdAdamId=void 0,this.positionInfo=a,this.slotInfo=n,this.setInitialAdData(e,r,o),i(s)&&(this.pageFields[$b]=s),this.fastImpressionFields[gE]=!0}static from(e,t){var n,r,o,i
const s=new QX(e,f(t.placementType),l(t.slotInfo),null!==(n=f(t.iAdId))&&void 0!==n?n:void 0,null!==(r=f(t.appStoreClientRequestId))&&void 0!==r?r:void 0,null!==(o=v(t.wasOdmlSuccessful))&&void 0!==o?o:void 0,g(t.positionInfo))
return s._iAdApplied=u(t._iAdApplied),s._iAdAdamId=null!==(i=f(t._iAdAdamId))&&void 0!==i?i:void 0,Object.assign(s.pageFields,t.pageFields),Object.assign(s.clickFields,t.clickFields),Object.assign(s.impressionsFields,t.impressionsFields),Object.assign(s.fastImpressionFields,t.fastImpressionFields),Object.assign(s.iAdClickEventFields,t.iAdClickEventFields),s.updateContainerId(f(t.containerId)),s}static createInitialSlotInfos(e,t,n,r){var o
switch(t){case xV:case nV:const i=QX.containerIdFromType(t),s=null!==(o=null==n?void 0:n.slot)&&void 0!==o?o:0
return[{containerId:i,slots:[{slotId:`${i}_${s}`,slotIndex:s,hasAdData:!1}]}]
case PH:const a=jn(e,t),c=(0,Cv.isNothing)(a)?[]:a.map(e=>e.slot),l={},u=(0,Cv.isSome)(n)?n.slot-1:null
let d=!1
return c.forEach(e=>{var t
const n=d?e-1:e,o=null==r?void 0:r.find(e=>e.containedAdSlots.includes(n)),i=u===e,s=function(e,t,n){return(0,Cv.isNothing)(n)?"0":n.type===wm.EditorialItemGroup?(!(n.containedAdSlots.length>1)||e===n.containedAdSlots[0]||n.containedAdSlots[n.containedAdSlots.length-1],"0"):"0"}(n,0,o),a=null!==(t=l[s])&&void 0!==t?t:{containerId:s,slots:[]}
l[s]=a
const c={slotId:`${s}_${e}`,slotIndex:e,hasAdData:!1}
a.slots.push(c),d=d||i}),Object.values(l)
default:return null}}get iAdIsPresent(){return this._iAdApplied}get iAdAdamId(){return this._iAdAdamId}updateForAdResponse(e,t){var n
r(t)||(this.placementType=t.placementType,this.placementId=this.placementIdFromType(this.placementType),this.positionInfo=null===(n=t.onDeviceAd)||void 0===n?void 0:n.positionInfo,this.setInitialAdData(e,t.iAdId,t.clientRequestId))}setInitialAdData(e,t,n){if((0,Cv.isNothing)(n))return
const r=(0,Cv.isNothing)(t)?"-1":t
switch(this.pageFields[_4.hasIAdData]=!0,this.placementType){case PH:case xV:case nV:this.impressionsFields[_4.hasIAdData]=!0}switch(this.pageFields[Dx]=n,this.placementType){case PH:case xV:case nV:this.clickFields[Dx]=n,this.impressionsFields[Dx]=n}if(this.pageFields[oU]=r,this.impressionsFields[oU]=r,this.clickFields[oU]=r,this.updateContainerId(null),this.updateSlotInfo(),s(this.slotInfo)&&(this.pageFields[SU]=this.slotInfo,this.clickFields[SU]=this.slotInfo,this.impressionsFields[SU]=this.slotInfo),null!==this.placementId&&this.placementId.length>0)switch(this.pageFields[nU]=this.placementId,this.clickFields[nU]=this.placementId,this.impressionsFields[nU]=this.placementId,this.placementType){case PH:case xV:case nV:this.fastImpressionFields[nU]=this.placementId}}updateContainerId(e){this.placementType===PH?(this.containerId=null!=e?e:null,i(this.containerId)&&(this.clickFields[cB]=this.containerId,this.fastImpressionFields[cB]=this.containerId)):(this.containerId=null===this.placementType?null:QX.containerIdFromType(this.placementType),i(this.containerId)&&(this.pageFields[cB]=this.containerId,this.clickFields[cB]=this.containerId,this.fastImpressionFields[cB]=this.containerId))}containerIdForSlotIndex(e){if((0,Cv.isNothing)(e)||(0,Cv.isNothing)(this.slotInfo))return null
for(const t of this.slotInfo)for(const n of t.slots)if(n.slotIndex===e)return t.containerId
return this.containerId}apply(e,t){if((0,Cv.isNothing)(t)||o(t))return
const n=t.id,r=ne(t,FB)
if(this._iAdAdamId=n,r){this.impressionsFields[_4.hasIAdData]=!0,this.clickFields[_4.hasIAdData]=!0
const o=vf(r[_x])
this.fastImpressionFields[Ax]=o,this.clickFields[Ax]=o
const i=vf(r[Fb])
this.clickFields[yx]=i,this.fastImpressionFields[yx]=i,this.pageFields[wj]=n,this.pageFields.iAd={iAdFormat:yf(g(m(r),"format")),iAdAlgoId:vf(r.algoId),iAdImpressionId:vf(r[_x]),iAdMetadata:vf(r[Fb])}
const s=Qe(e,t)
this.updateIAdMetricsFieldsForProductVariantData(s,this.clickFields),Object.assign(this.iAdClickEventFields,r),this._iAdApplied=!0,this.setMissedOpportunity(e,void 0,this.placementType)}this.updateSlotInfo(),s(this.slotInfo)&&(this.pageFields[SU]=this.slotInfo,this.clickFields[SU]=this.slotInfo,this.impressionsFields[SU]=this.slotInfo)}applyClickFieldsFromPageRequest(e,t){this._iAdApplied=!0,this._iAdAdamId=e,Object.assign(this.clickFields,t),Object.keys(this.pageFields).forEach(e=>delete this.pageFields[e])}setSpecifiedAlignedRegionUsed(e){this.fastImpressionFields[Nb]=e,this.clickFields[Nb]=e}setTemplateType(e){this.pageFields[jM]=e,this.impressionsFields[jM]=e,this.clickFields[jM]=e}setMissedOpportunity(e,t,n){if(this.missedOpportunityReason=t,i(t))switch(this.clickFields[mG]=t,this.placementType){case PH:case xV:case nV:break
default:this.pageFields[mG]=t,this.impressionsFields[mG]=t}else delete this.clickFields[mG],n===nV?(this.pageFields[mG]=null,this.impressionsFields[mG]=null):(delete this.pageFields[mG],delete this.impressionsFields[mG])
i(t)?(this.pageFields[mG]=t,this.impressionsFields[mG]=t):(delete this.pageFields[mG],delete this.impressionsFields[mG]),this.updateSlotInfo(),s(this.slotInfo)&&(this.pageFields[SU]=this.slotInfo,this.clickFields[SU]=this.slotInfo,this.impressionsFields[SU]=this.slotInfo)}placementIdFromType(e){switch(e){case UG:return Bb
case OG:return Ub
case PH:return Gb
case xV:return jb
case nV:return Vb
default:throw new Error(`This method should never be called with value: ${e}`)}}static placementTypeFromPlacementId(e,t){switch(t){case Bb:return UG
case Ub:return OG
case Gb:return PH
case jb:return xV
case Vb:return nV
default:return e.console.log(`Failed to get placementType from placementId ${t}. Defaulting to searchResults`),OG}}static containerIdFromType(e){switch(e){case xV:return $B
case nV:return sk
default:return null}}fastImpressionsFieldsForCurrentItem(e,t){switch(this.placementType){case xV:case nV:case PH:let r
if((0,Cv.isSome)(t))r=t
else{const t=Df(e)
r=null!==t&&t.locationType===pG?(n=e).locationStack.length<2?null:n.locationStack[1].position:Rf(e)}const o=b(this.fastImpressionFields)
if(o[Hb]=`${this.containerIdForSlotIndex(r)}_${r}`,r!==this.adjustedSlotIndex){const e=[gE,nU,cB,Hb]
Object.keys(o).forEach(t=>{e.includes(t)||delete o[t]})}return o
default:return this.fastImpressionFields}var n}get adjustedSlotIndex(){var e
const t=null===(e=this.positionInfo)||void 0===e?void 0:e.slot
return i(t)?t-1:null}updateSlotInfo(){if(!(0,Cv.isNothing)(this.slotInfo))switch(this.placementType){case xV:case nV:for(const e of this.slotInfo)for(const t of e.slots)t.hasAdData=this.iAdIsPresent,i(this.missedOpportunityReason)&&(t.missedOpportunityReason=this.missedOpportunityReason)
break
case PH:const e=this.adjustedSlotIndex
for(const t of this.slotInfo)for(const n of t.slots){const t=e===n.slotIndex,r=this.iAdIsPresent&&t
let o=this.missedOpportunityReason
!t&&i(e)&&(o=XD),n.hasAdData=r,i(o)&&(n.missedOpportunityReason=o)}}}updateIAdMetricsFieldsForProductVariantData(e,t){(0,Cv.isSome)(e)&&it(e,xx)?t[qb]=e.productPageId:delete t[qb]}updateIAdMetricsFieldsForAlignedRegion(e,t){}get fastImpressionsEventVersion(){switch(this.placementType){case xV:case nV:case PH:return 5
default:return 4}}get shouldIncludeAdRotationFields(){switch(this.placementType){case xV:case nV:case PH:return!1
default:return!0}}}class XX{constructor(e={}){this.baseFields=e}}const e0="data.search.dataSetId",t0=bR,n0=new Set([Dx,oU,SU,$b,gE,cB,Ax,yx,wj,"iAd",nU,mG,fb,jM,vG,fF])
class r0{constructor(e,t,n){this.periodDuration=e,this.periodCount=t,this.type=n}isEqualTo(e){return e.periodDuration===this.periodDuration&&e.periodCount===this.periodCount&&e.type===this.type}}const o0=new Set([am.Grid,am.List,am.NumberedList,am.River]),i0={11:"43",30:"44"},s0=HE,a0="ReviewsPage.ShelfId"
class c0{constructor(e,t,n){this.sectionType=e,this.shelfId=t,this.shelfBasedMappedIds=n}createProductPageSection(e){return PK.has(this.sectionType)?new TK(this.sectionType,null):new TK(this.sectionType,this.shelfId)}createShelfIdList(){return this.shelfBasedMappedIds||[this.shelfId]}}const l0=5,u0=5,d0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(VH,PV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,vB,XM,yG]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],f0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(VH,PV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,CG,iU,IU,yG,mB,yB]),new c0(VH,mB),new c0(VH,iU),new c0(VH,IU),new c0(VH,yB),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],p0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(bH,bH),new c0(VH,nH),new c0(VH,PV),new c0(VH,Sj),new c0(VH,bV),new c0(VH,fV),new c0(VH,pH,[aV,vB,yG]),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],h0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(bH,bH),new c0(VH,nH),new c0(VH,PV),new c0(VH,Sj),new c0(VH,bV),new c0(VH,fV),new c0(VH,pH,[aV,CG,iU,IU,yG]),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],w0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,MV),new c0(VH,kU),new c0(VH,cU),new c0(VH,PV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,vB,XM,yG]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV)],g0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,bN),new c0(VH,Lj),new c0(VH,MV),new c0(VH,kU),new c0(VH,cU),new c0(VH,PV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,CG,iU,IU,yG,mB,yB]),new c0(VH,mB),new c0(VH,iU),new c0(VH,IU),new c0(VH,yB),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV)],v0=5,m0=5,y0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(VH,PV),new c0(VH,Pj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,vB,XM,yG]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],A0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(VH,PV),new c0(VH,Pj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,CG,iU,IU,yG,mB,yB]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],T0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,bV),new c0(VH,fV),new c0(VH,pH,[aV,vB,yG]),new c0(VH,PV),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],b0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,bV),new c0(VH,fV),new c0(VH,pH,[aV,CG,iU,IU,yG]),new c0(VH,PV),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],S0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(VH,MV),new c0(VH,PV),new c0(VH,Pj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,XM,vB,yG]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV)],P0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,TN),new c0(VH,Lj),new c0(VH,MV),new c0(VH,PV),new c0(VH,Pj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,fV),new c0(VH,pH,[aV,mB,CG,iU,IU,yG,yB]),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV)],I0=5,C0=5,k0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(VH,PV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,pH),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],O0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,Lj),new c0(VH,kU),new c0(VH,cU),new c0(bH,bH),new c0(VH,nH),new c0(VH,PV),new c0(VH,Sj),new c0(VH,bV),new c0(VH,pH),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,dG),new c0(VH,uG),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,AV),new c0(VH,MV)],E0=5,R0=5,D0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,Lj),new c0(VH,PV),new c0(VH,Pj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,pH),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],_0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,IV),new c0(VH,Lj),new c0(bH,bH),new c0(VH,nH),new c0(VH,Sj),new c0(VH,bV),new c0(VH,pH),new c0(VH,PV),new c0(VH,fH),new c0(VH,WV),new c0(VH,Pj),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,Hj),new c0(VH,MV),new c0(VH,AV)],x0=5,L0=5,M0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,bV),new c0(bH,bH),new c0(VH,lU),new c0(VH,fH),new c0(VH,WV),new c0(VH,TB),new c0(VH,AV),new c0(VH,MV),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,m$)],$0=[new c0(yH,yH),new c0(vH,vH),new c0(bH,bH),new c0(VH,lU),new c0(VH,bV),new c0(VH,AB),new c0(VH,fH),new c0(VH,WV),new c0(VH,AV),new c0(VH,MV),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,m$)],F0=5,N0=5,B0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,bV),new c0(bH,bH),new c0(VH,lU),new c0(VH,fH),new c0(VH,WV),new c0(VH,TB),new c0(VH,MV),new c0(VH,AV),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,m$)],U0=[new c0(yH,yH),new c0(vH,vH),new c0(bH,bH),new c0(VH,lU),new c0(VH,bV),new c0(VH,AB),new c0(VH,fH),new c0(VH,WV),new c0(VH,MV),new c0(VH,AV),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,m$)],G0=3,j0=3,V0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,Pj),new c0(bH,bH),new c0(VH,nH),new c0(VH,NV),new c0(VH,RV),new c0(VH,kL)],H0=[new c0(yH,yH),new c0(vH,vH),new c0(bH,bH),new c0(VH,nH),new c0(VH,Pj),new c0(VH,NV),new c0(VH,RV),new c0(VH,kL)],q0=5,W0=5,z0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,Lj),new c0(VH,bV),new c0(bH,bH),new c0(VH,lU),new c0(VH,e$),new c0(VH,TB),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,AV),new c0(VH,MV)],Y0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,Lj),new c0(bH,bH),new c0(VH,lU),new c0(VH,bV),new c0(VH,e$),new c0(VH,AB),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,AV),new c0(VH,MV)],J0=5,K0=5,Z0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,Lj),new c0(VH,fH),new c0(VH,WV),new c0(VH,bV),new c0(bH,bH),new c0(VH,lU),new c0(VH,e$),new c0(VH,TB),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,BG),new c0(VH,GV),new c0(VH,MV),new c0(VH,AV)],Q0=[new c0(yH,yH),new c0(vH,vH),new c0(VH,Lj),new c0(bH,bH),new c0(VH,lU),new c0(VH,bV),new c0(VH,e$),new c0(VH,AB),new c0(VH,fH),new c0(VH,WV),new c0(VH,NV),new c0(VH,RV),new c0(VH,TV),new c0(VH,wV),new c0(VH,yV),new c0(VH,hV),new c0(VH,dH),new c0(VH,YU),new c0(VH,GV),new c0(VH,MV),new c0(VH,AV)],X0=l0,e1=u0,t1=[...d0],n1=[...f0],r1=[...p0],o1=[...h0],i1=[...w0],s1=[...g0],a1=v0,c1=m0,l1=[...y0],u1=[...A0],d1=[...T0],f1=[...b0],p1=[...S0],h1=[...P0]
class w1 extends hq{constructor(e){super(),this.productMedia=e,this.pageMetrics=new EW,this.pageRenderMetrics={}}}const g1="product_media"
class v1 extends hq{constructor(e){super(),this.style=e}isValidUber(e,t){function n(e){return null!=e&&0!==Object.keys(e).length}return n(this.artwork)||n(this.compactArtwork)||n(this.video)||n(this.compactVideo)||(e||t)&&n(this.iconArtwork)}}class m1{supports(e,t,n,r){return this._supports(e,t,n,r)}_supports(e,t,n,r){const o=this.supportedFeaturedContentIds.has(n)
let s
return s=!i(r)||this.supportedNativeGroupingShelfIds.has(r),o&&s}createShelf(e,t,n,o,a){var c,l,u
const d=t,f=this.initialShelfDataFromGroupingMediaApiData(e,d),p=this.shelfTokenFromBaseTokenAndMediaApiData(e,d,o,n),h=this.shelfMetricsOptionsFromBaseMetricsOptions(e,p,a),w=s(h)
w&&this.shouldImpressShelf()&&kf(0,h,p.title),s(f.shelfContents)&&(f.shelfContents=Mo(f.shelfContents,null!==(c=n.recoImpressionData)&&void 0!==c?c:{},null!==(l=null==a?void 0:a.recoMetricsData)&&void 0!==l?l:{}))
const g=this._createShelf(e,p,f,n)
if(w&&this.shouldImpressShelf()&&(Ef(h.locationTracker),i(g)&&(Bf(e,g,h),(null===(u=g.url)||void 0===u?void 0:u.length)>0&&s(g.impressionMetrics)&&p.showingPlaceholders))){const e=g.url
try{const t=oY.from(e).pathComponents().pop(),n=JSON.parse(decodeURIComponent(t))
n.originalPlaceholderShelfImpressionMetrics=g.impressionMetrics,function(e,t,n){const o=oY.from(t.url),i=oY.from(Nr(0,t,n))
for(const e of Object.keys(o.query))r(i.query[e])&&(i.query[e]=o.query[e])
t.url=i.build()}(0,g,n)}catch{g.url=e}}return this.finalizeInitialShelfForDisplay(e,g,p,f,n),w&&this.shouldPrepareLocationTrackerForNextPosition()&&xf(n.metricsLocationTracker),g}constructor(e){this.supportedFeaturedContentIds=new Set([]),this.supportedNativeGroupingShelfIds=new Set([]),this.builderClass=e}incompleteShelfFetchStrategy(e){return Nv.OnShelfWillAppear}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return n}shouldImpressShelf(){return!0}shouldPrepareLocationTrackerForNextPosition(){return!0}finalizeInitialShelfForDisplay(e,t,n,r,i){var a,c
if(o(t))return
n.isSearchLandingPage&&Jr(0,t,n),(null===(a=t.url)||void 0===a?void 0:a.length)>0&&s(i.additionalShelfParameters)&&(t.url=oY.from(t.url).append(UU,i.additionalShelfParameters).build()),t.fetchStrategy=this.incompleteShelfFetchStrategy(e)
const l=(0,kv.isSome)(t)&&(null===(c=t.url)||void 0===c?void 0:c.length)>0
o(t.items)&&!l&&(t.isHidden=!0),t.accessibilityMetadata=ha(e,t)}finalizeSecondaryShelfForDisplay(e,t,n,i){if(!o(t)){if(n.remainingItems.length){const t=n.remainingItems.map(e=>e.id)
e.console.warn("Could not load items for: "+t.join(","))}var a,c
if(t&&(t.mergeWhenFetched=((c=n).shelfStyle,!(c.showingPlaceholders||c.shelfStyle===Q_||c.shelfStyle===SO&&(0,kv.isSome)(c.initialHydratedItems)&&c.initialHydratedItems.length>0)),t.networkTimingMetrics=i.responseTimingValues,t.nextPreferredContentRefreshDate=null==(a={timeToLive:null,nextPreferredContentRefreshDate:null,refreshWhileVisibleForNextPreferredContentRefreshDate:!1})?void 0:a.nextPreferredContentRefreshDate),s(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])
!n.hasExistingContent&&o(t.items)&&(t.isHidden=!0),n.isSearchLandingPage&&Jr(0,t,n),t.accessibilityMetadata=ha(e,t)}}async handleShelf(e,t,n,r){const o=n[$G],i=JSON.parse(o)
i.isFirstRender=!1
try{const r=await this.secondaryShelfDataForShelfUrl(e,t,i,n),o=this._createShelf(e,i,r,null)
return this.finalizeSecondaryShelfForDisplay(e,o,i,r),o}catch(e){if(i&&!i.hasExistingContent){const e=new oJ(i.shelfStyle)
return e.isHidden=!0,e}throw e}}shelfRoute(e){return s(this.supportedNativeGroupingShelfIds)?function(e,t){const n=[]
for(const t of e)n.push(wa(-1,t,void 0))
return n}(this.supportedNativeGroupingShelfIds):ga(this.supportedFeaturedContentIds)}static async secondaryGroupingShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const r=function(e,t,n){var r
const o=(null===(r=t.relationshipToFetch)||void 0===r?void 0:r.length)>0
let i=V(n)
if(o){const r={}
for(const e of n.data)r[e.id]=e
i=[]
for(const n of t.remainingItems){const o=ye(e,n,t.relationshipToFetch)
s(o)&&(n.relationships[t.relationshipToFetch].data=[r[o.id]]),i.push(n)}}return i}(e,n,t)
return{shelfContents:r,responseTimingValues:t[sm.timingValues]}})}static async secondaryGroupingShelfMediaApiData(e,t,n,r){const o=t.build()
let i
return i=Or(e,t)?new wJ(e,o):Ur(e,n),i?(i.includingAdditionalPlatforms(function(e){return N(e)}(e)),i.includingAttributes(function(e){const t=[lH,Nj,Uj,JN]
return e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}(e)),i.usingCustomAttributes(Ze(e)),i.attributingTo(t.build()),await Jn(e,i).then(e=>(Br(n,i.ids),e))):await Promise.reject(new Error(`Could not construct media API request for: ${t}`))}}class y1 extends m1{constructor(){super("GroupingAppEventShelfController"),this.supportedFeaturedContentIds=new Set([519,518])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
if(!((null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0)){const t=[],r=[],o=[]
for(const e of n.remainingItems)switch(e.type){case ZG:r.push(e)
break
case Aj:o.push(e)
break
case DH:t.push(e)}const i=new wJ(e,t)
st(e,i,t)
const s=new wJ(e,r)
st(e,s,r)
const a=new wJ(e,o)
st(e,a,o)
const c=await Promise.all([this.fetchRemainingItems(e,i),this.fetchRemainingItems(e,s),this.fetchRemainingItems(e,a)]),l={...c[0],...c[1],...c[2]},u=[]
for(const e of n.remainingItems){const t=l[e.id];(0,kv.isSome)(t)&&u.push(t)}return Br(n,new Set([...a.ids,...s.ids,...i.ids])),{shelfContents:u}}try{const o=await m1.secondaryGroupingShelfMediaApiData(e,t,n,r),s=j(e,o),a=this.initialShelfDataFromGroupingMediaApiData(e,s)
a.responseTimingValues=o[sm.timingValues]
const c=ie(s,$r(0,n.featuredContentId))
return i(c)&&(null==c?void 0:c.length)>0&&(a.shelfTitle=c),a}catch{return{shelfContents:[]}}}async fetchRemainingItems(e,t){const n={}
if(t.ids.size>0){Gr(e,t)
try{await Jn(e,t).then(e=>{(e=>{for(const t of e.data)n[t.id]=t})(e)})}catch(n){e.console.error("Error fetching remaining items",t.ids)}}return n}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=518===n.featuredContentId
let i=null
const a=this.initialShelfDataFromGroupingMediaApiData(e,t)
o&&s(a.shelfContents)&&(i=this.personalizedDataResultFromDataItems(e,a.shelfContents))
const c={...n,shouldPersonalizeData:o,personalizedDataResult:i},l=s(a.shelfContents),u=!ae(t,yT)
return!l&&u?(c.recommendationsHref=t.href,c.isValidRecommendationsShelf=!0):c.isValidRecommendationsShelf=l,c}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(s(t.personalizedDataResult)){const e=Pf(n.recoMetricsData,t.personalizedDataResult.processingType,null)
r.recoMetricsData=e}return r}_createShelf(e,t,n,i){var a
if(!$i(e))return null
if(!t.isValidRecommendationsShelf)return null
const c={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:t.metricsPageInformation.recoMetricsData}
let l=n.shelfContents
s(t.personalizedDataResult)&&t.isFirstRender&&(l=t.personalizedDataResult.personalizedData)
const u=[]
for(const e of l)r(e.attributes)||Mr(t)?(t.isDeferring=!0,t.remainingItems.push(e)):u.push(e)
const d=qi(e,u,null,!1,!1,c,!1,!0,t.isArcadePage,!1)
nr(d.nextAppEventPromotionStartDate,null==i?void 0:i.refreshController)
const f=d.appPromotions,p=new oJ(lk)
return p.isHorizontal=!0,p.title=null!==(a=n.shelfTitle)&&void 0!==a?a:t.title,p.items=f,o(p.items)&&t.isFirstRender&&da(e,p,t,t.featuredContentId),p.url=Nr(0,p,t),o(p.items)&&o(p.url)?t.isFirstRender?null:y1.makeHiddenShelf(t):p}personalizedDataResultFromDataItems(e,t){const n=new Set
for(const e of t){const t=f(e,eB);(null==t?void 0:t.length)>0&&n.add(t)}const r=uo(e,n)
return co(e,AT,t,!1,r,null,null,null,!0)}static makeHiddenShelf(e){const t=new oJ(e.shelfStyle)
return t.isHidden=!0,t}}class A1 extends m1{constructor(){super("GroupingArcadeFooterShelfController"),this.supportedFeaturedContentIds=new Set([-1]),this.supportedNativeGroupingShelfIds=new Set([1])}shouldImpressShelf(){return!1}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:q(t),responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=gp(e,this.numberOfIconsForArcadeAppGrid(e.client.deviceType))
return await Jn(e,o).then(t=>{const n=this.initialShelfDataFromGroupingMediaApiData(e,t)
return n.responseTimingValues=t[sm.timingValues],n})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldIncludeShelfUrl:n.isFirstRender}
return o.showingPlaceholders=n.isFirstRender,o}_createShelf(e,t,n,o){const i=new Lq,a=new oJ(hO)
a.items=[i]
const c={targetType:sT,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:e.loc.string(a_),id:t.id,kind:aT,softwareType:HV}
Bf(e,i,c),kf(0,c,c.title),i.buttonAction=up(e,NN,t.metricsPageInformation,t.metricsLocationTracker)
const l={targetType:NH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,title:i.buttonAction.title,id:Ty,kind:NH,softwareType:HV}
Bf(e,i.buttonAction,l),Ef(c.locationTracker)
const u=e.bag.termsAndConditionsURL
if(!r(u)&&"tv"!==e.client.deviceType){const t=e.loc.string(TO),n=new MW(u),r=new bY(t)
r.clickAction=n,r.presentationStyle=[G_,j_,V_],i.footnote=r}if(a.background={type:ej,color:Z(Hk)},s(n.shelfContents)){const r={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
i.icons=od(e,n.shelfContents,r,{useCase:2})}else i.icons=[]
return t.shouldIncludeShelfUrl&&(a.url=Fr(t)),a}numberOfIconsForArcadeAppGrid(e){return e===RH?9:20}}class T1 extends m1{constructor(){super("GroupingBrickShelfController"),this.supportedFeaturedContentIds=new Set([421,422,423,261])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,Fj)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(e=>({shelfContents:Yr(e.shelfContents,Ae(n.featuredContentData,Fj))}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=se(t,TT)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=yn(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,tV)===OV
let d
if(l){d=new oJ(OM)
const n=p(t.featuredContentData.attributes,bT)
d.rowsPerColumn=null!=n?n:M(e),Df(t.metricsLocationTracker).name=EO}else d=new oJ(KB)
d.isHorizontal=!0
for(const n of r.shelfContents){const r=T1.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s)
r?(a.push(r),xf(t.metricsLocationTracker)):c.push(n)}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.children.data"))&&(t.featuredContentData.relationships[Fj].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=p(t.featuredContentData.attributes,X_)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const h=u(t.featuredContentData.attributes,RO)
if(l&&h){const n=new oJ(OM)
n.items=this.sortCategories(e,a),n.presentationHints={isSeeAllContext:!0}
const r=new lJ([n])
r.title=t.title
const o=new dY(jH)
o.title=e.loc.string(Oj),o.pageData=r,d.seeAllAction=o,ap(e,o,null,{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}const w=d&&o(d.items)&&t.isFirstRender
if(w&&da(e,d,t,t.featuredContentId),!w&&T1.shouldDisplayChooseYourFavoritesBrick(e,t,l,s)){const n=T1.createChooseYourFavoritesBrick(e,t.metricsPageInformation,t.metricsLocationTracker)
d.items.splice(0,0,n)}return t.presentationHints=d.presentationHints,d.url=Nr(0,d,t),d}static shouldDisplayChooseYourFavoritesBrick(e,t,n,r){return t.isArcadePage&&n&&e.featureFlags.isEnabled("arcade_choose_your_favorites_brick_Future")&&(0,kv.isSome)(null==r?void 0:r.additionalShelfParameters)&&((null==r?void 0:r.additionalShelfParameters.isSubscribed)===FV||(null==r?void 0:r.additionalShelfParameters.isTrialEnrolled)===FV)}static createBrick(e,t,n,r,o,s,a){const c={targetType:n?HG:KB,pageInformation:r,locationTracker:o,recoMetricsData:W(t)},l=Wr(e,t,s,!1,null,c,a)
if(!l)return null
const u=new FY,d={useCase:18}
if(n){const t=id(e,l.content,Am.categoryBreakout,Wv.Density1)
u.artworks=t}else if(l.artwork&&261!==(null==s?void 0:s.featuredContentId)){let t=h(l.artwork,N_)
t||(t=h(l.artwork,"originalFlowcaseBrick"))
const n=Vr(e,t,d)
u.artworks=[n]}else{const n=Hr(e,t,1060,520,d)
u.artworks=[n]}u.accessibilityLabel=l.title,u.shortEditorialDescription=l.title,u.clickAction=l.action,435===ce(t,bG)&&(u.personalizationStyle=oF)
const f=ye(e,t,FH)
if(i(f)){const n=rp(e,f,c)
u.flowPreviewActionsConfiguration=Ss(e,t,!0,null==s?void 0:s.clientIdentifierOverride,u.clickAction,c,n)}return Bf(e,u,Hf(e,t,l.title,c)),u.artworkSafeArea=Yq.defaultTileArtworkSafeArea,u.textSafeArea=Yq.defaultTileTextSafeArea,u.isValid()?u:null}static createChooseYourFavoritesBrick(e,t,n){const r=new FY,o=new Aq("",1060,520,[],z("efac78"))
r.artworks=[o]
const i=e.loc.string("ARCADE_CHOOSE_YOUR_FAVORITES_BRICK_TITLE")
r.accessibilityLabel=i,r.shortEditorialDescription=i
const s=new dY(WF)
var a
return s.presentationContext=TG,s.pageData=TH,r.clickAction=s,Bf(e,r,(a={targetType:KB,pageInformation:t,locationTracker:n,recoMetricsData:null},Iv.context("impressionOptionsForArcadeChooseYourFavoritesBrick",()=>({...a,id:"",kind:null,softwareType:null,title:"choose_your_games_brick"})))),r.artworkSafeArea=Yq.defaultTileArtworkSafeArea,r.textSafeArea=Yq.defaultTileTextSafeArea,r}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,tV)===OV&&(r.title=EO),r}sortCategories(e,t){return t.sort((t,n)=>{try{return t.shortEditorialDescription.localeCompare(n.shortEditorialDescription,e.loc.safeIdentifier,{usage:Ij})}catch(e){return 0}})}}class b1 extends m1{constructor(){super("GroupingRibbonBarShelfController"),this.supportedFeaturedContentIds=new Set([556])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,o){var i
const s=[],a=new oJ(SO)
a.isHorizontal=!0
const c=Rt(e,e.bag.arcadeCategoryBarSAGUpliftDisplayRate)
if(t.isArcadePage&&t.isFirstRender&&c){const n=b1.createSeeAllGamesRibbonItem(e,t.metricsPageInformation,t.metricsLocationTracker)
s.push(n),xf(t.metricsLocationTracker)}let l=null!==(i=n.shelfContents)&&void 0!==i?i:[];(0,kv.isSome)(t.initialHydratedItems)&&t.initialHydratedItems.length>0&&(l=t.initialHydratedItems.concat(l))
const u=[]
let d=!1
for(const n of l){if(r(n.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(n),b1.shouldPriorizeItemWithData(e,n)&&(d=!0)
continue}let i=!1;(0,kv.isSome)(t.featuredContentData)&&(i=(0,Yv.attributeAsString)(t.featuredContentData,tV)===F_)
const a=b1.createRibbonItem(e,n,t.metricsPageInformation,t.metricsLocationTracker,i,t,o);(0,kv.isSome)(a)&&(b1.shouldPriorizeItemWithData(e,n)?s.unshift(a):s.push(a),u.push(n)),xf(t.metricsLocationTracker)}return a.items=s,d&&u.length>0&&(t.initialHydratedItems=u),a.url=Nr(0,a,t),a}static createRibbonItem(e,t,n,r,o,i,s){var a,c,l
const u={targetType:TU,pageInformation:n,locationTracker:r,recoMetricsData:W(t)}
let d
if(t.type===tj){if(!xr(e,PG))return null
d=zr(e,t)}else d=Wr(e,t,i,!1,null,u,s)
const f=rp(e,t,u)
f.targetType=u.targetType
const p=ju(e,t,f,null==i?void 0:i.clientIdentifierOverride),h=null!==(a=null==d?void 0:d.action)&&void 0!==a?a:p,w=null!==(c=Zd(e,t,GH))&&void 0!==c?c:(0,Yv.attributeAsString)(t,GH),g=null!==(l=null==d?void 0:d.title)&&void 0!==l?l:w,v=new $Y(g,h),m=Yn(e,t)
let y
if(o)y=null
else if((0,kv.isSome)(m))y=nd(e,m,{useCase:29})
else{let t
t=i.isArcadePage?"resource://arcade-ribbon-bar-fallback-icon":"resource://appstore-ribbon-bar-fallback-icon",y=Se(e,t,36,36)}return v.artwork=y,v.accessibilityLabel=g,Bf(e,v,Hf(e,t,g,u)),v.isValid()?v:null}static createSeeAllGamesRibbonItem(e,t,n){const r=e.loc.string("Arcade.CategoryBar.AllGames.Title"),o=up(e,NN,t,n,r,SM,qV,TU),i=new $Y(r,o),s=Se(e,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACACAYAAADHy7H2AAABdWlDQ1BrQ0dDb2xvclNwYWNlRGlzcGxheVAzAAAokXWQvUvDUBTFT6tS0DqIDh0cMolD1NIKdnFoKxRFMFQFq1OafgltfCQpUnETVyn4H1jBWXCwiFRwcXAQRAcR3Zw6KbhoeN6XVNoi3sfl/Ticc7lcwBtQGSv2AijplpFMxKS11Lrke4OHnlOqZrKooiwK/v276/PR9d5PiFlNu3YQ2U9cl84ul3aeAlN//V3Vn8maGv3f1EGNGRbgkYmVbYsJ3iUeMWgp4qrgvMvHgtMunzuelWSc+JZY0gpqhrhJLKc79HwHl4plrbWD2N6f1VeXxRzqUcxhEyYYilBRgQQF4X/8044/ji1yV2BQLo8CLMpESRETssTz0KFhEjJxCEHqkLhz634PrfvJbW3vFZhtcM4v2tpCAzidoZPV29p4BBgaAG7qTDVUR+qh9uZywPsJMJgChu8os2HmwiF3e38M6Hvh/GMM8B0CdpXzryPO7RqFn4Er/QcXKWq8UwZBywAAAARjSUNQDA0AAW4D4+8AAAB4ZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAASAAAAAEAAABIAAAAAQACoAIABAAAAAEAAACCoAMABAAAAAEAAACAAAAAACBAcQEAAAAJcEhZcwAACxMAAAsTAQCanBgAAAIGaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yMTk2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjIxNjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KIUPY5gAAGmtJREFUeAHtXXuMJMV5r+qZ2Qe7h299bA7O3B0GGwOXBwEsbMXCC1H+QJjHgpbHEcyBEiLl4cgJxLKElIkUS4DtQCCSpZOSEAx3hjW+YwmclAfa4MQScfBL2Tg5ED5uyfFYw0Lu9nZvHl35/b7qmu3Z65numZ3dndnpupvt7np+31e/+qq6uuorpVKXSiCVQCqBVAKpBFIJpBJIJZBKIJVAKoF6EtD1ApcbZpRa0fxJHwpAMe3hVprfleS1ZRVlRkayqr8/ozbPa7Wh36gTW3118KBRw8NG7djR2sqamrJ0D73mqdmztRqY8QQKc8M+yirpfN5fSWgYA/zdOJarKnfoNQNabLkrwe/MjFbnnqvV9LRXkfGm+bLOT5ZaweuygWCuvLKXhOgDB060gqDl5mHyylNTY6SpoMfHy8vNL5ze5PPIe2pF8g6X08i9GRvrUacf0/qR5cm/aSCIUA5N9uhHJxcc4ebma7aoTHabMmYLNPZpaDcbAJE+hGfg13RZLn939Y0xnucVlPGPI/9ZlPUO7t9Qpb7XUfnHXDyza6QvTJ/zb+YqgD9woAAmRLuhAvpVdmG70t6ZyujTkecQaBnwld/jad0yXgNayyjjBCB+FGX8HH5vqkJxWo8/e9jxIoCYmfH1ZHMaoimCTR7dgJr0dV755o6xYVUo3YiKvgJEfgJyolAAANWjPKuxhdimSnJsLrm6jgY6GuVSHc/jbhbiP4xq+gGENqH37vtHpjK7dgEMj1bAuiSnRI8EgdN45pbRzyDX6wDyS5D4LFw/jDIHlNYefja/leCVOVt+i7gj2N/B7xXw+qLKZZ/Uj40LKAgINIYCwhpyDZNs7rorp3fvJjHK3Dx6p9LmbuXp86XSSajvs5oYTrXMSqIvZcRLSxwydCIH0lABymThw58UpMrl4xDQ8ypT/rJ+fOLV5WgGJ1gzduWwyvU+AAauA68bAQBwB5aMKYOeEoq2/LaQz4qwOCYBZ/ixZWVQak5D7Qjrvoj4Z/B/WD+x/yFcVRi4fE7imHlixwGhUz1m57V/CUK+IML3/XmQeYI1LjVkQDDIRNVL/ga1whsE0xvRws8n+yMWo8KFuxP6uWcXbiPhr0iDCRApi7JOUdlMRpXK00iyC9rhhWbA4Pg1t157AYh/Gt3eeQAZKxxdklQ8LsIjKygkS0un47eaboYt5WWRLysbKyOXOa+ShhLlP2SIH3lmmTkIfQCNERSZx1Qx+9vUCA7ACE/kyEAiZzgI4xsAnNl53UMqm/0CxF6EBkAfrUogrQe13YP7HpCHrgPjAotgkEgcoOO0fad9to8MQqDghF2rPCM9gYSfe+YVz4xHvyDfIF4GVwhDyu1FIHk6BhB8gJa7FTL/trn1+k9xrMBuAmGJHMdABL0Zu3obyj2gvAxB8AESUy2TPvLJH8smDSw3+JFGchPQKtfwPdPjORwuz6xOGw+PEkF4DvyQP8uB5pMye3GlvAENM6vK/hy6iM/72eJfw08JGKQL51O8o1ATOSCsH5nPm1tHb0eCR1E4+6HjATEWo4lyWoVI5Mq2nKKocd9Mqb7yp/XfTBwNd21JKDE7R19QWe9yAOs9xOcbAytbGkSS9Csex/JKFcOBbAYNdFCVS3ejm/g6/LTK53WS12kyFesCNTNvdl6FkbH5kiTQAQgokvYRi5DG/gEioIiyxi/PoZ3tUAven0hg4SA1VV1n7ro4xwgCeguC9/FIbWLFzsB2cVb27FuoHU5Aa6HT0F80O2/4OPyMOnIkll+ykggIiGcz0z03Ievz8eMoPFEBLGS1HWsrACdVbRndFwcPNxLI0kXw3bue2/2ynaQx5nehCRiTKjnIsl7CNQ0jJPqkm8hlPoLX6RtIDQf28qofQ1osEKANMuwSmA9e1H5d3g6UKUCwmBuIyX2tgwUR0oqL6HC3o9FcJiQtLHAME+lkgAhWzW2jv4gIv4IfB4bCq80uMlm7eLI+MYhExWhzBTW5JWwytp5jIyAjafnm86ObIMxz2bTg7LDfltK+fy1Q2UkUMd5C/24uFmLPss08kvDhYSuTkvokQM8xgaiEyLjt6ekFWuw8lfPPFBKPHI3FcDwQBgZsnEIZo2ezOQBCe4ogmiq+dPky8DbqYxJl06Xx6tIzO6Kza2NfO4eBhmvYdaOu/K1CrfsGUof0eCDMzVk0efoM5DOIH/vPWITVKXO1g0gr1CWclqlgJaPoyRrqkh+P6Hy9XUDfSZxaylGnmm9LPZiXxlQ/3FPjnPqqy0k8EAYGbPZKnYYsOXKmqqybKcLbz0mXZjaaO6/h9LfCnEg071uutl2BNsMSL5gUk/vO+MO6KXNGIqPVJpKMLt2+TNehP1oY4QRvv22BoD0KkGqns0RTBVnTr+Yx60h37FhVCL3YakLv3IP4tkXvTnPkCxqQF3Nqhfg/y5/EbyUMN/FAGBwMpGH6pJ/l9GhnQYH8BjzoHIa5diRtRwthWSiVt5qOb0pIgVlKbbuU6ljt/WSrO6gh+fKbiN54ICxmY+cN7IBk0bez7sCvtnxE0p23vjuwCESmjIl59x0gMkGbe9bjtZr0RoBQnbJLnoCIjuwfpHoaWAOSAiEW0J2sEWKZq0RIgVARRfRN56qDaH5q+aZAqCEZ+25Ud6BdI2VneqdAqFtv3aIPkrw+1hVUGrheJJBqhPVSk8vkIwXCMgW4XpKnQFgvNblMPlIgLFOA6yV5CoT1UpPL5CMFwjIFuF6Sp0BYLzW5TD5SICxTgOsleQqE9VKTy+Sju4DQPZ8OGoZFdwGhgU8Hss4P4uwW7HQXEBpuJ0zQwQtTGuA3BUIDwlrPUZMDwV8XLQOWG7z4DmKSVe747eAVSl7yxbfxQKgs+4YtBDqsjxVJxotTorfJH9fVl1WxYDe4vhpBWT5vuZqcxN4QE2zkcYCIiN++XpZf2q9I6OKB4JZ9e3oOwuFSf2ydIBwSlrDW0cKAhdE/1Z+z9pQqy/SrCUR0jBMF7tz42ylcLjJh+Q3Wmpu5xYD6d/FAOLrZCsMo2ggoQEpMExZv/RLaKVTDKtnMAi2ewAba0Ek8CADGxgKZwFobIdF5jnx5sl1PLM5JZdFgxkn8hlmLB4Lb+6j020jIVsJ9AXUzDRfQJvdYlS6V+q6zjqZmZ2ttXrH7HgxM2DFNJ+3jIIta9nlmxWCGljrDxp08OalbZ/FAGJgJMtBv4IatJD5Nm9R+QAbpB8286NfpJxZRxsejgRCMiXxP2VFEwD3TdYTjzm+Y+AHZ7wMM/ys019rwG2IovlJ7zrWbQgc3TQNVh4OWFYOvUAlrfSstBDt+YKUT28T/S8iZPZuW16KrOBg7QDA/oqUVOETtEGdHbtgA62UxxH0dw/ppofzcVthH2L27tGiASv8gkF8WBUS3qDaTmd3Harjf8V2A+HtC3uIO75OphS1n8SzkXkI/+xbQwrTRoDk59Zr5hAiELRvAWOvv673P0kor9HhgI7oOdbEaQVrO7CwrHq68Hy3r/3DD7fEwPkG/tnacBOD4gHz+u96z/0cQmFZnnVXTMil3Q7PrgLmg95DuOZ3xepCmRF5Dwm47pjkIgCOd/apYQgdRfpYeYgoogU3qWCAwM1g8PyF2B/dMvIiCngPiOKBKsOteUq/lH2qtHrRsvE+bB4WQsbG+0Nb3aNoqLShzP/rZBcgYecB0RnTs9vC13cIJmNfjtv/n1HkX/b0QNpKMvERAEMG99JKYnINhx7vxO4TZBNpLoBptx4ZCmggCDxZYqdof0Xue+SdnJhDPdR20QVmMiO15+hXg/R4YsuxHAlgdsR1N3cSrHCjCtwiF9Vt9GrTBDOrmXtFstMuc0Ix/IiCQN752iRnbb00cwSBqDGJBgd6HQIgTOgXPe6GNaVbRuXJJQ0AHbDNnswOqWN6LLuGPA1rswDcBYQQDoyHtX6lS8avI61T0MZQX8hdArDG/jgZcjRgLg3FwQwOot+vH9/04eDNKPLPYsLZzBp/NTaPnm4x5XGcyF0F9oiJgRl7DAB/JWn0wOD5YUbCJCGMYtNquzdf1E8+IoU1p4Qn6SqSvODKFjMmPglX2P4KQv4IfbRlyjEGgIIwVsurT0MAk/uG0AvQIOdRBBlr6FYwM7szt3fevYj0/P1l2tJP+OOcEGBevKjxQsbS1qNXO0buN9u+EMM6B9WDbfTC2AJaCopDwv6WOZBtmbMdIwUjJ1gnen43C24F/v+aYhjGtrcjE2iBMKsvgM4UK49y/hLt7UfTleMR5FEHBlldGY3T88L+lzvKLLDnwreSM+X5W9mF471XHyvfpCZgYXi0z/Y6KxVdKsE3DjtnSZyGDSxF+Pn4fAXE018uBC8HBltpqh/GJwakx+igynsH1Z3j+iSrr7+on9/2UhQld4+NFCGtZNYPEWo2N8U1C3jbMbVd/VJUzn0URF+J3NkJ/AddTUQrMC0Ej2YEbvFrmSD/VPFU/p/rfRBn/A2h+X/WbSdqYZknNgoBpF+HFpwadPcXlEE5xOflgDDnxZMg7RRVP6VWZEx5U17LKqiItA42Yy5RUrjyvtl00t/QtgK9MPF+qMp1clbj5BwEWvlG48yrCOSGMpgf7wWuupbyykIH+sppTBTUwcDxS1jipRs0NF924JkxX0vuWVA6EkAGROcXvEkNDpShBJSWomXgCyHfxVvPWIDVPWbVAC9SjQwDBsQin35dZAfXKqRUmA0HMjkr4zEzRnaFRK34S/5YAYWlBUjGc3+apZLOzK1KGfD3cglPkpnCGBL4boJBlqf+lPCR9DroNT9EA15EV5pen5o2M+PySuFb8JpVLGi+VQCqBVAKpBFIJpBJYHxJYkYFcOlhcAXBwaV0wWFz6utyK0loChPT1sbVHD8dVbNu9Pq7phFJ/L05lObGgtk1gQkk+NFXkl04oVUSR+KZpjVA1xcyDwjf2XYYp5k+h5PPwSzLFzLL57i9Xvo/jxj3DuzIv4OLRT1wQKXKKuYAp5t6VnmLeecPZmLe6DMQ0MsXs+JAvVHwIXBXPITm4cF4Zp/2mmDmzxnl30QgHf3gPiNyFejwHVdnAR6eKXAI+cRHn/Gs9O3/5umM/wbgPMfbjz/uQ2ve0b+7T33rmu4zNrqvZ6VdWDPPAH2NuueaX8SX6Xjxejt+m6I9OFQAzWcg5vsJXBrOOnV8oetWthPNP1UcnUMT1INOQxB5V6LkPPB5zdVOVPMEDM2/IVT5D3zZ6Po6gfVy182doo76m9+7/EhlsBgwEAQTEmsJn6Ou4puErWPTRiwoIfYaWcInDeKvkKp+hQWIOdYDP0OVXcLzEHfqJiX9b8c/Q7nxlc/M1l+CI3OchlGHj++GjUByw3HWV5FJphaEK4cKUTB9W7OwFGHaSkGbAIOluvfYBlcndo0ol7uvA52xZCsmyHJ/uyuir4Ryf0IE8cE9jraL+EACKownNGFZjPS8DSpxfCcJc3Lp0Jf48LJqA5yv/5vVnYGXSU/iwPIyVSh+gIAqB+fDHe/5W27lyQ3RAbZZKOC85cwuO9f2LgCCutUzkCBpGxGmwv6eyAgIu2uWaBpQhfVGb8Esc4FO/MVxsewq+gP8dzu6+UO9+uchP5+QhiSMzsU7GAoOD7I+w3sP/GhavfhRL1fgNnF/A1qLiSUk9R5rIm48zEKnGfx8rjH5DxjU447peQoY5zWFuuu4cCPirqljkfknml0hezGO1nAjftvl+0PpznctywcyfBzxgHIdP8glcMsampno52IIwP4M8P4fv7XaZFrHY3o78FaTFaPNFIXV8fEGAXY/uodesXDycg53JADhchqcS7Kevl+kKh9mteb3Qgsexcukq1Vu+SkqcTFZuLBAANlljINlpM4pxAU8Osy0kUe+TjJAVikWgYo8T1i8q9UmMbX4VHkYdOsSVzZGOIKFalQPRtQboRaNkk/W0kVmuimewWi6L67zOZqG4/WtYMNcquG6uHiGxQFB3XZyVg6a56kepi4OegN1EfNp6Ja9WGLUWV/na171PS7GVjb0RRLjT1U0Pl93x0FN2LaL52ln9OdpwxSY/n+rrEnPL1TyrEzu/Aw0nD9F/4iuzsMEOsLZs2oYstqIfsjm5kqPzbR9f2nPQ2H/Bv0rbY36HXsOCX1u5JxE6Pe1kciEGxQxuf73nmLDdA/Z5+iW812zHC8VWCTq4IZYHx7TL6uTr3HBQ5cUzEci181SzneRIP2gmDhTBrIIRdTTvFQMa5uOdxGSFVmu/4gS43YjxDWZ44bCqqSbwg4TRwggC5VLZMJrZjMy4KpkDxQAc4YhtfY/XbTYKc5osqiWpQ0O1eCd/5PCMQPt1Dq/ConTZJYAA7OJQd7oYIxmMUksYDLNugzsSWG2ERPBeqjsRCJYXowfVcB9XG2OH8MlrKaXVVOwmmKEACDZt5/wlcLG5hxfwAIc7Q2MZvK/l4oHwapDUNwPInHmybdneqFau7eQvUggI0qpXzRe5kzvybGh6C4PCn+Z8A9tYZzlb3cHOCj2QlPh4IFT6zOCDEiAgZdkCk5azpvFYuQEBGZXrsRMsH4sgybWakRFum2M8gN6yGxG7nb0sv+GPgDHUxgPBZeB1pEAc9e7KV6t4CI8wusO7fDV26Tvr6pvE9Zs4YmdJIKW2UQmkQIiV2LrQhLFcdhcQ4juFisAwOJDYbnBRCVinN90FhG6p1SbA2l1AaEJA3ZIkBUK31HQMnykQYgTULcEpELqlpmP4TIEQI6BuCU6B0C01HcNnCoQYAXVLcAqEbqnpGD5TIMQIqFuCUyB0S03H8JkCIUZA3RKcAqFGTWMtVld9mUiBUAMIzruBD5YuSUdeUyDEVlsHr1CK5W0xQgqERVlE3nXomkXLi04O4uRA8GU/A5eBdrK2xEYXY/ctRFZ73vrSrK8cm8f9csmFGZnlmnrW47WasHgguLOhPb1g1/lj6VbnDaQC8OJsJy3WTlRwqmO1NPJ2gChmdjSOD1bJF39WZ7SGT8H6ZcuJsccfJyAnHgib3ZHAPu0hYPNrh42nq8b+eh6G9GFVBK6yTF+e5A/QYipb5nl8sGwSWQzvkDtyjHrlRdO4h3V/mq+ShPN213ggLO4c5hmC3BnMTbF1M3WZt9VVKlW/7w65UDMz0Xs4jzxrN/362p6Z2Hnaj3XDA09xsTzI+suYDj0eCG7vo2/eRM7OSkonAYG0Cp8wlPAW7pW0epq7j3KzZ1uRaWNPve0kTi3l4AubkXy/gObKOlPqxjGP2i6KXednd/24p6jr3JwVWE/msCqZd6AuN9uxQlTktvTj8Naenq6DkQEO+dCPHMAYoI7TeqpOaHsG2YE8BsOG2/pgds+bFkKtfYQ6g+Qkm2Dt7melH9v3LiB1MOg3NTdAtr2zLYRvADQ2hfOE9MtC86GsVf9RDLguwy//ByzGua4wKmZb+qFafFiTI20/VUXvDSFySwvsI4jtpMAAFeT6z7TGAcT14L7c9i+SFqz8S+tih1SP+RcRTF8fLb5EOncsjt478RPw+GNEsqYA8NABjvv50A2SWPMCjYdZmmt0gyGG4scINrJVK8Xckyjkv6FyqHrqqppQGat+K/VvK46nt2YCyydP6Uf3vy+2IisCiiaN5oUlxJhv4OBP3pbr97DR+ayyLzlegMYegkGtN2A752mWL6aScd51HC2JgEBkmV27+nB9Txn/gSDTUyAcWiyzAIwraRXD5QWBHQJed7WXGQDN/6mKOUt3z9FYALvDyfTeZ/4WBjsnoWo3gkm+k7NHtBBbRX7qFmWp4V+2fpyoh27B6Af14xOvCq1btsTyy/wTAYERFU5YF9t9FI5RD0M4tEwGIWPixQTawYHCXSVh6I8l2nq4OLX8wuHuninj4kMM+EfjWbCb5G1EPz+L1vFbAPEx0QY0RJnAVeYTcrnbYatxGjaYPsw8UTwFbodlji53XZqvo9VdGe7uw2ncvQtbGs/lG4onlcxnmQEVK3dZlcsNQht8U+/dZw2M5kcySc92CBftiqt5lSPoYa6NEWDd8yGooT+UwaPv44BqAQRbDF9VZG42EBdjyzytna519+TBysVeOf6kOVk6N60b3oDqwl2YROQfJpeBS3DPkdIAgJqRCjR6FwTzgjMfjLDEzvGLE2AvAE3fhtlh2J8uc2x0HKW6lkaS2aBCsnQ8ktZqHuxz2H/pPcljGscvnwOeOafBf4s8s8wc6mBApF72vwnNR9Cz0YrhdKZO4kLEJ4kOCtB/OtVpbrn2DhBxN34XSD9MGPgyk8FWR0HZCmrxpAyKCQAjAyNUgsnChz/IDL9ymbOHBzCv8mWNE9/NH1zZG/u6WIN9J1AxVedl7kc1wNakNyTVTlZxLC/oKaFYxy8hwcpqnVvUPwRcBuXhPGiUyDPLOXg35hAKfVjv2fcgC3WG03mf1DUMBGZszbqO+FQ7ENSw6indCGKuADGfQCgNONEoZ08wSGMSCqd1zomZwBPVaOaROWwR493ZmB8CDBP6if3/wAJlbBNxUm0jxISBZG69/tcg/FGUdQnyOAtXWJqDBtKoFYKQbiV4Zb7CL76XwPAPfu/g9wqUx4so9ym95zuv45nmgxvSBExD1zTJ0ocemsRxwJOVDxuwbLpFZbLbQPAWkASbwGoDiuAbBs5LDqtIKbv5P2LGycNA1UfL17Mo6x0MCN9Qpb7XORZwGTfTHbi0S69ije3SA0WdFy1Hgfer7MJ2tMozURmnIz4MV0FFa8M3DrbcVjq8tcAMsIeZXaPeRcUfUYXitB5/9rArhADgtLl7/XX+Sa9NA8EV4MzVtfocZpd/o1c0Go0pVYKvAFC4frzRbCLjC/hhl3ol8o4sMIGnAOD0Y7rZrs8VsWwguIzcOUpq8zz0QD/eJbb6cirZML7t0+3Y4RS6S9L8dWrK0s2pU34bGJixLXBu2Ec5paQj5WYJELD9zl1ZVThoZyhZ7tBrBrTY9/VW8koiye8MjhzmEcu0DOtkvGm+rPN28N4sLy5dy4DgMgxfUfMrmj/LQgGtA1iY+CbuV5rfduK1CfGkSVIJpBJIJZBKIJVAKoFUAqkEUgmkEuhoCfw/vJfHMO4YqncAAAAASUVORK5CYII=",36,36)
var a
return i.artwork=s,i.accessibilityLabel=r,Bf(e,i,(a={targetType:TU,pageInformation:t,locationTracker:n,recoMetricsData:null},Iv.context("impressionOptionsForArcadeSeeAllGamesRibbonItem",()=>({...a,id:SM,idType:qV,kind:null,softwareType:null,title:"All Games"})))),i}static createTagsRibbonShelf(e,t){const n=Te(t,Bk),r=new oJ("ribbonFlow"),o=[]
for(const t of n){const n=(0,Yv.attributeAsString)(t,GH)
let r=null
switch(t.type){case cF:r=(0,Yv.attributeAsString)(t,AH)
break
case tj:r=Er(e,f(t,eU))}if((0,kv.isNothing)(r))continue
const i=e.required(G4).fetchFlowPage(r),s=new dY(i)
if(s.pageUrl=r,(0,kv.isSome)(n)){const e=new $Y(n,s)
o.push(e)}}return r.items=o,r.isHorizontal=!0,r}static shouldPriorizeItemWithData(e,t){var n,r
return null!==(r=null===(n=e.userDefaults)||void 0===n?void 0:n.bool(UT))&&void 0!==r&&r&&e.bag.ribbonBarVisionEditorialItemIds.includes(t.id)&&e.bag.enableDeviceDrivenDiscoveryContent}}class S1 extends m1{constructor(){super("GroupingCategoryShelfController"),this.supportedFeaturedContentIds=new Set([425])}initialShelfDataFromGroupingMediaApiData(e,t){const n=ye(e,t,Fj)
return n?{shelfContents:Ae(n,Fj)}:{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r).then(t=>{const r=ye(e,n.featuredContentData,Fj)
return r?{shelfContents:Yr(t.shelfContents,Ae(r,Fj))}:{shelfContents:[]}})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,i){var a
if(o(n.shelfContents))return null
const c=[]
let l=!1
for(const o of n.shelfContents){const n=ye(e,o,PG)
if(r(n))continue
const a=Zr(0,n)
if(r(o.attributes)||r(n.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const d={targetType:iF,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(o)},f=ju(e,n,{...d,id:a},t.clientIdentifierOverride)
Bf(e,f,{...d,kind:uH,softwareType:u(null==i?void 0:i.isArcadePage)?HV:null,title:f.title,id:a})
const p=ne(n,_H)
p.width>p.height&&(l=!0),s(p)&&(f.artwork=nd(e,p,{allowingTransparency:!0,useCase:20})),c.push(f),xf(t.metricsLocationTracker)}const d=this.shelfForCategoryActions(e,c,t)
if(d.title=t.title,d.subtitle=t.subtitle,d.url=Nr(0,d,t),l){const e=null!==(a=d.presentationHints)&&void 0!==a?a:{}
d.presentationHints={...e,itemsHaveRectangularArtwork:!0}}return d}shelfForCategoryActions(e,t,n){const r=new oJ(EV)
let o
switch(e.client.deviceType){case"tv":r.isHorizontal=!0,o=8
break
case $H:r.isHorizontal=!1,o=null
break
case JG:r.isHorizontal=!0,r.rowsPerColumn=3,o=24
break
default:r.isHorizontal=!1,o=6}if(null!==o&&t.length>o){r.items=t.slice(0,o)
const i=new dY(jH)
i.title=e.loc.string(Oj),ap(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),r.seeAllAction=i
const s=new oJ(EV)
s.isHorizontal=!1,this.sortCategories(e,t),s.items=t
const a=new lJ([s])
a.title=e.loc.string("PAGE_TITLE_CATEGORIES"),i.pageData=a}else r.items=t
return r}sortCategories(e,t){t.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:Ij})}catch(e){return 0}})}}class P1 extends m1{constructor(){super("GroupingEditorialCardShelfController"),this.supportedFeaturedContentIds=new Set([415,416,501,417,258])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,Fj)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){const i=new oJ(wT)
i.isHorizontal=!0
const s=this.personalizationDataContainerForEditorialCardItemsDataArray(e,n.shelfContents),a=[]
for(const i of n.shelfContents){const n=P1.makeEditorialCard(e,i,s,r,t)
!o(n)&&n.isValid()&&(a.push(n),xf(t.metricsLocationTracker))}return delete t.maxItemCount,i.items=a,i.url=Nr(0,i,t),i}static makeEditorialCard(e,t,n,o,s){var a,c,l
const u={targetType:OB,pageInformation:null==s?void 0:s.metricsPageInformation,locationTracker:null==s?void 0:s.metricsLocationTracker,recoMetricsData:W(t),id:t.id,idType:XN},d=ce(t,bG),p=Wr(e,t,s,501===d,n,u,o,()=>{null==s||s.remainingItems.push(t)})
if(!p)return null;(null===(c=null===(a=p.content)||void 0===a?void 0:a.id)||void 0===c?void 0:c.length)>0&&(u.id=p.content.id,u.idType=ZV,u.adamId=p.content.id)
const w=new LY
let g=ie(t,"designBadge")
g||(g=p.caption),w.caption=g
let v=ie(t,hH)
v||(v=p.title),w.title=v
let m=Qr(ie(t,DO))
m||(m=p.subtitle),w.subtitle=m
const y={useCase:19,withJoeColorPlaceholder:!0}
if(p.artwork&&258!==(null==s?void 0:s.featuredContentId)){let t=h(p.artwork,N_)
r(t)&&i(p.appEvent)&&(t=h(p.artwork,"eventCard")),w.artwork=Vr(e,t,y)}else w.artwork=Hr(e,t,416,204,y)
if(w.clickAction=p.action,i(p.appEvent)&&(w.appEventFormattedDates=p.appEvent.formattedDates),w.lockup=p.lockup,i(w.artwork)&&i(w.artwork.backgroundColor)){const e=K(w.artwork.backgroundColor)
if(w.mediaOverlayStyle=e?mH:UV,i(w.lockup)&&i(w.lockup.offerDisplayProperties)){const t=e?mH:UV
w.lockup.offerDisplayProperties=w.lockup.offerDisplayProperties.newOfferDisplayPropertiesChangingAppearance(!1,QU,t)}}w.adamId=f(p.content,"id")
const A=ye(e,t,FH)
if(i(A)){const n=rp(e,A,u)
n.targetType=u.targetType,w.flowPreviewActionsConfiguration=Ss(e,t,!1,null==s?void 0:s.clientIdentifierOverride,w.clickAction,u,n)}const T=Hf(e,null!==(l=p.content)&&void 0!==l?l:t,p.title,u)
if(i(p.onDevicePersonalizationDataProcessingType)){const e=Pf(T.recoMetricsData,p.onDevicePersonalizationDataProcessingType,null)
T.recoMetricsData=e}return i(p.appEvent)&&(T.inAppEventId=p.appEvent.appEventId,i(p.appEvent.lockup)&&(T.relatedSubjectIds=[p.appEvent.lockup.adamId])),i(s)&&Bf(e,w,T),w}personalizationDataContainerForEditorialCardItemsDataArray(e,t){var n,r
if(!lo(e))return null
const o=new Set
for(const e of t){const t=501===ce(e,bG),i=(null===(n=f(e,AH))||void 0===n?void 0:n.length)>0,s=(null===(r=ie(e,ST))||void 0===r?void 0:r.length)>0,a=ge(e,FH,!1)
if(t&&!i&&!s&&a){const t=Ae(e,FH)
for(const e of t){const t=f(e,eB);(null==t?void 0:t.length)>0&&o.add(t)}}}return uo(e,o)}}class I1 extends m1{constructor(){super("GroupingEditorialStoryCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}shelfRoute(e){return ga(this.supportedFeaturedContentIds,["shelfContentType=editorialStoryCard"])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&Kr(0,ie(t,tV))===_O}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,Fj)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=ie(t,tV)
return o.shelfStyle=Kr(0,i),o}_createShelf(e,t,n,r){const i=[]
for(const r of n.shelfContents){if(!le(r)||Mr(t)){t.remainingItems.push(r),t.isDeferring=!0
continue}const n=I1.makeStoryCard(e,r,t)
o(n)||(i.push(n),xf(t.metricsLocationTracker))}const s=new oJ(t.shelfStyle)
return s.title=t.title,s.items=i,s.isHorizontal=!0,s.background={type:B_},s.url=Nr(0,s,t),s.isHorizontal=!0,s}static makeStoryCard(e,t,n){let s=ne(t,"editorialArtwork.subscriptionHero")
o(s)&&(s=ne(t,ex))
const a=nd(e,s,{cropCode:"fn",withJoeColorPlaceholder:!0,useCase:16})
if(r(a))return null
const c=ie(t,xG),l=ie(t,CV),u=ie(t,gO),d=new iJ(c,a,null,l,{type:Dj,title:l},u),f=Ro(e,t,null,new uQ(null==n?void 0:n.metricsPageInformation,null==n?void 0:n.metricsLocationTracker))
i(f)&&(d.clickAction=f.clickAction)
const p=K(a.backgroundColor)?mH:UV
return d.shelfBackground={type:_H,artwork:a,style:p},d}}class C1 extends m1{constructor(){super("GroupingGameCenterActivityFeedController"),this.batchGroupKey=ij,this.supportedFeaturedContentIds=new Set([548])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterActivityFeedShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],activities:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=this.gameCategoryFilter(n.gamesFilter)
return await e.gameCenter.fetchActivityFeedCards(o,20).then(e=>({shelfContents:[],activities:e}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Nv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingActivityFeedShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.activityFeedShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingActivityFeedShelfForGrouping(e,t,n){if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const r=this.activityFeedShelfForGrouping(e,{shelfContents:[],activities:[]},t,n),o=oY.from(Fr(t))
return r.url=o.param(Hz.isGameCenterActivityFeedShelf,FV).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}activityFeedShelfForGrouping(e,t,n,r){if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const o=this.activityFeedShelf(e,t.activities,n,r),i=e.loc.string("Arcade.ActivityFeed.RecentActivity")
return o.header=hp(e,i),eo(e,o,o.seeAllAction),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o}activityFeedShelf(e,t,n,r=!1){const o=new oJ("gameCenterActivityFeedCard")
let i
return o.isHorizontal=!0,o.mergeWhenFetched=!0,o.batchGroup=this.batchGroupKey,o.items=t,o.isHidden=0===o.items.length,t.forEach((t,o)=>{const i={id:"friendActivity",idType:QV,targetType:"chiclet",kind:null,softwareType:r?HV:null,title:"",pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}
Bf(e,t,i)
const s=new OW,a=new OW,c=new OW,l=new OW,u=new OW;[{targetId:"playerName",metrics:s},{targetId:"profileImage",metrics:a},{targetId:"leaderboardAchievement",metrics:c},{targetId:tB,metrics:l},{targetId:t.adamID||"gameIcon",metrics:u}].forEach(t=>function(e,t,n,r,o){const i={actionType:UH,id:r,idType:QV,location:Cf(0,o,n)},s=Zf(e,r,uH,i)
t.addMetricsData(s)}(e,t.metrics,n.title,t.targetId,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),t.profileActionMetrics=s,t.profileAvatarActionMetrics=a,t.leaderboardActionMetrics=c,t.achievementActionMetrics=l,t.appActionMetrics=u,xf(n.metricsLocationTracker)}),e.featureFlags.isGSEUIEnabled(VD)||(i=new XW,i.title=e.loc.string("Arcade.ActivityFeed.AllActivity",e.loc.string(Oj)),ap(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})),o.seeAllAction=i,o}gameCategoryFilter(e){return e===tx?xO:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,title:"Friend Activity",badges:{gameCenter:!0},idType:iT}}}class k1 extends m1{constructor(){super("GroupingGameCenterPopularWithYourFriendsController"),this.batchGroupKey=ij,this.supportedFeaturedContentIds=new Set([495])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterPopularWithYourFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.gameCenter.fetchGamesPopularWithFriends(this.gameCategoryFilter(n.gamesFilter),30)
return await o.then(async t=>{const n=t.map(e=>this.gameplayHistoryFromData(e)).sort((e,t)=>t.records.length-e.records.length).filter(t=>this.isCompatibleGameCenterPlatform(e,t.platformId)).map(e=>e.adamId)
if(0===n.length){const e={shelfContents:[]}
return await Promise.resolve(e)}const r=new wJ(e).withIdsOfType(n.slice(0,100),BH).includingAgeRestrictions()
return Gr(e,r),await Jn(e,r,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[sm.timingValues]}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Nv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingPopularWithFriendsShelfForGrouping(e,n,t):this.popularWithFriendsShelfForGrouping(e,n,t)}pendingPopularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelfForGrouping(e,t,n),o=oY.from(Fr(n))
return r.url=o.param(Hz.isGameCenterPopularWithYourFriendsShelf,FV).build(),r}popularWithFriendsShelfForGrouping(e,t,n){const r=this.popularWithFriendsShelf(e,t.shelfContents,n)
return r.mergeWhenFetched=!0,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header.title=n.title,r.header.subtitle=n.subtitle,r}popularWithFriendsShelf(e,t,n){const r=n.shelfStyle||LV,o=new oJ(r)
o.isHorizontal=!0
const s=[]
for(let o=0;o<t.length;o++){const a=t[o],c={metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(a),anonymizationOptions:{anonymizationString:`"GAME"${o+1}`}},artworkUseCase:td(0,r),canDisplayArcadeOfferButton:of(0,r),shouldHideArcadeHeader:e.featureFlags.isEnabled(BF)&&n.isArcadePage,shouldShowFriendsPlayingShowcase:!0},l=Ve(e,a,rN)
if(ae(a,VV)||!l)continue
const u=Du(e,a,c)
u.clickAction=va(e,u.clickAction),i(u)&&(s.push(u),xf(c.metricsOptions.locationTracker))}let a
switch(e.client.deviceType){case RH:a=2
break
case CH:case $H:case"tv":a=6
break
default:a=0}if(o.header=hp(e),s.length<a)return o.isHidden=!0,o
if(o.items=s.slice(0,12),o.isHidden=!1,o.batchGroup=ij,s.length>12){const t=new oJ(LV)
t.items=s,t.rowsPerColumn=1
const r=new lJ([t])
r.title=n.title
const i=new dY(jH)
i.title=e.loc.string(Oj),i.pageData=r,ap(e,i,null,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker}),eo(e,o,i)}return o.footerTitle=e.loc.string(EM),o.footerAction=pp(),o.footerStyle={$kind:mV,bundleID:sF,width:16,height:16},o}isCompatibleGameCenterPlatform(e,t){return 1===t}gameplayHistoryFromData(e){const t=f(e,wj),n=p(e,"platformId"),r=u(e,LO),o=this.gameplayHistoryRecordFromData(l(e,"records"))
return new Gq(t,n,r,o)}gameplayHistoryRecordFromData(e){return e.map(e=>{const t=f(e,"playerId"),n=p(e,"timestamp")
return new jq(t,n)})}gameCategoryFilter(e){return e===tx?xO:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:GG}}}class O1 extends m1{constructor(){super("GroupingGameCenterContinuePlayingShelfController"),this.batchGroupKey="gameCenterContinuePlaying",this.supportedFeaturedContentIds=new Set([500])}_supports(e,t,n,r){return super._supports(e,t,n,r)&&this.supportsVideoCardShelf(e,e.host.platform)}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterContinuePlayingShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=Date.now(),i=this.maximumNumberOfRecentGamesToRequest(),s=e.gameCenter.fetchRecentlyPlayedGamesWithinSeconds(this.gameCategoryFilter(n.gamesFilter),i,e.bag.recentlyPlayedGamesWindowInSeconds)
return await s.then(async t=>{const n=Date.now()
let r
if(e.console.log("grouping-gamecenter-builder: requestForContinuePlaying NATIVE took "+(n-o).toString(10)+" milliseconds."),0===t.length){const e={shelfContents:[]}
return await Promise.resolve(e)}{const n=new wJ(e).withIdsOfType(t.slice(0,this.maximumNumberOfRecentGamesToShow()),BH).includingAgeRestrictions()
Gr(e,n),r=Jn(e,n,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[sm.timingValues]}))}return await r})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Nv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingContinuePlayingForGrouping(e,t):this.continuePlayingShelfForGrouping(e,n.shelfContents,t)}pendingContinuePlayingForGrouping(e,t){const n=this.continuePlayingShelfForGrouping(e,[],t)
if(!n)return null
const r=oY.from(Fr(t))
return n.url=r.param(Hz.isGameCenterContinuePlayingShelf,FV).build(),n.batchGroup=this.batchGroupKey,n}continuePlayingShelfForGrouping(e,t,n){return Iv.context("continuePlayingShelfForGrouping",()=>{const r=this.videoCardContinuePlayingShelf(e,t,n)
return r.mergeWhenFetched=!1,r.batchGroup=this.batchGroupKey,r.isHidden=0===r.items.length,r.header=hp(e,e.loc.string(PT),n.subtitle),r})}supportsVideoCardShelf(e,t){switch(t){case fj:case AU:case yj:return!0
default:return!1}}videoCardContinuePlayingShelf(e,t,n){return Iv.context("videoCardContinuePlayingShelf",()=>{const r=new oJ(IT)
r.isHorizontal=!0,r.batchGroup=this.batchGroupKey
const o=[]
for(const r of t){if(vt(e,r))continue
const t=this.editorialSplashVideoCardForContinuePlaying(e,r,n)
t&&o.push(t)}return r.items=o,r})}editorialSplashVideoCardForContinuePlaying(e,t,n){return Iv.context("editorialSplashVideoCardForContinuePlaying",()=>{var r
const o={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:cH},i=e.featureFlags.isEnabled(BF)&&u(n.isArcadePage),s=Jd(e,t),a={metricsOptions:o,artworkUseCase:1,offerEnvironment:mH,offerStyle:BV,canDisplayArcadeOfferButton:!0,shouldHideArcadeHeader:i,isSubtitleHidden:s&&!i},c=this.editorialSplashVideoWithTopShelfStill(e,t)
if(!c||!c.preview)return null
const l=Du(e,t,a)
if(!l)return null
l.clickAction=va(e,l.clickAction)
const d=this.clickActionForVideoCard(e,t,e.host.platform,o,n.clientIdentifierOverride)
if(!d)return null
const f=new MY
f.video=c,f.lockup=l,f.overlayStyle=mH,f.clickAction=d
const p=rp(e,t,o)
f.flowPreviewActionsConfiguration=Ss(e,t,!0,n.clientIdentifierOverride,f.clickAction,o,p)
const h=Hf(e,t,l.title,o)
return Bf(e,f,h),null===(r=f.impressionMetrics)||void 0===r||delete r.fields[CT],f})}editorialSplashVideoWithTopShelfStill(e,t){return Iv.context("editorialSplashVideoWithTopShelfStill",()=>{let n=null
const r=Be(e,t,Qk)
return i(r)&&(n=nd(e,r,{withJoeColorPlaceholder:!0,useCase:23,cropCode:"sr"})),Fd(e,t,n)})}clickActionForVideoCard(e,t,n,r,o){let i=ju(e,t,rp(e,t,r),o)
if(i=va(e,i),n===AU){const n=new VW(t.id,SH)
sp(e,n,{actionType:qG,id:t.id,contextualAdamId:t.id,anonymizationOptions:r.anonymizationOptions,pageInformation:r.pageInformation,locationTracker:r.locationTracker})
const o=new jW(t.id,i)
return o.openAction=n,o.cancelAction=i,o}return i}maximumNumberOfRecentGamesToRequest(){return 200}maximumNumberOfRecentGamesToShow(){return 10}gameCategoryFilter(e){return e===tx?xO:e}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:GG,title:e.loc.string(PT)}}}class E1 extends m1{constructor(){super("GroupingGameCenterReengagementShelfController"),this.batchGroupKey=ij,this.supportedFeaturedContentIds=new Set([494])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterReengagementShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],achievementData:null,achievementSummaryData:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchRengagementDataForLocalPlayer().then(async t=>{const n=f(t,wj),r=y(t[tB]),i=y(t.achievementSummary)
if(o(n)){const e={shelfContents:[],responseTimingValues:null,achievementData:null,achievementSummaryData:null}
return await Promise.resolve(e)}const s=new wJ(e).withIdOfType(n,BH).includingAgeRestrictions()
return Gr(e,s),await Jn(e,s,{}).then(e=>({shelfContents:e.data,responseTimingValues:e[sm.timingValues],achievementData:r,achievementSummaryData:i}))})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingGameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage):this.gameCenterReengagementShelf(e,n,t,null==r?void 0:r.isArcadePage)}pendingGameCenterReengagementShelf(e,t,n,r){const o=this.gameCenterReengagementShelf(e,t,n,r)
if(!o)return null
const i=oY.from(Fr(n))
return o.url=i.param(Hz.isGameCenterReengagementShelf,FV).build(),o.batchGroup=this.batchGroupKey,o}gameCenterReengagementShelf(e,t,n,r=!1){return Iv.context("gameCenterReengagementShelf",()=>{if(!s(t.shelfContents))return null
const o=new oJ("gameCenterReengagement")
o.isHorizontal=!1,o.mergeWhenFetched=!1,o.batchGroup=this.batchGroupKey
const i={id:n.id,kind:null,softwareType:r?HV:null,targetType:fH,title:kT,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:GG,fcKind:n.featuredContentId,badges:{gameCenter:!0}},a=$d(e,t.shelfContents[0],21)
let c=Z("componentBackground"),l=null
s(a)&&(l=a.preview,c=l.backgroundColor)
const u={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},offerStyle:BV,artworkUseCase:td(0,eH),isSubtitleHidden:!0}}
kf(0,i,i.title)
const d=Gu(e,t.shelfContents,u)[0]
d.clickAction=va(e,d.clickAction),Ef(n.metricsLocationTracker)
let f=null
s(d)&&(f=new hz(d.bundleId),f.title=kT,sp(e,f,i))
const p=e.loc.string("GameCenter.Reengagement.Badge.GameCenter"),h=this.achievementFromData(e,t.achievementData),w=this.achievementCountsFromData(e,t.achievementSummaryData),g=this.shelfMetadataForAchievement(e,h,w),v=new nJ("gamecenter.fill",p,g.title,g.subtitle,h,d,c,l,f)
return o.items=[v],Bf(e,v,i),o})}achievementStatusFromData(e,t){const n=f(t,oj),r=new Bq(n)
return r.percent=p(t,"percent"),r.date=f(t,MO),r.artwork=new Aq(f(t,"artwork.template"),p(t,"artwork.width"),p(t,"artwork.height"),[]),r}achievementFromData(e,t){const n=f(t,"id"),r=f(t,hH),o=f(t,lV),i=this.achievementStatusFromData(e,h(t,"status"))
return new Uq(n,r,o,i)}achievementCountsFromData(e,t){return{completed:p(t,"completedAchievements"),total:p(t,"totalAchievements")}}shelfMetadataForAchievement(e,t,n){if(!i(t))return{title:"",subtitle:null}
if(0===n.completed)return{title:e.loc.string("GameCenter.Reengagement.Achievement.First.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.First.Subtitle")}
switch(t.status.type){case nx:case"hidden":case OT:return{title:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Title"),subtitle:e.loc.string("GameCenter.Reengagement.Achievement.KeepPlaying.Subtitle")}
case aj:const t=e.loc.stringWithCount("GameCenter.AchievementSummary.TotalToCompleteCount",n.total),r=e.loc.stringWithCount("GameCenter.AchievementSummary.NumberCompletedCount",n.completed),o=e.loc.string("GameCenter.AchievementSummary.CompletedCount.Subtitle").replace("@@completedCount@@",r).replace("@@totalCount@@",t)
return{title:e.loc.string("GameCenter.Reengagement.Achievement.CompletedCount.Title"),subtitle:o}
default:return{title:"",subtitle:null}}}}class R1 extends m1{constructor(){super("GroupingGameCenterSuggestedFriendsController"),this.batchGroupKey=ij,this.supportedFeaturedContentIds=new Set([496])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isGameCenterSuggestedFriendsShelf]}]}initialShelfDataFromGroupingMediaApiData(e,t){return{$kind:rx,shelfContents:[],suggestedFriends:[]}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await e.gameCenter.fetchSuggestedFriends(10).then(t=>e.clientCapabilities.isEnabled(ET)?{$kind:rx,shelfContents:[],suggestedFriends:t}:{$kind:RT,shelfContents:[],suggestedFriends:t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}incompleteShelfFetchStrategy(e){return Nv.OnPageLoad}_createShelf(e,t,n,r){return t.isFirstRender?this.pendingSuggestedFriendsShelfForGrouping(e,t,null==r?void 0:r.isArcadePage):this.suggestedFriendsShelfForGrouping(e,n,t,null==r?void 0:r.isArcadePage)}pendingSuggestedFriendsShelfForGrouping(e,t,n){if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const r=this.suggestedFriendsShelfForGrouping(e,{$kind:e.clientCapabilities.isEnabled(ET)?rx:RT,shelfContents:[],suggestedFriends:[]},t,n),o=oY.from(Fr(t))
return r.url=o.param(Hz.isGameCenterSuggestedFriendsShelf,FV).build(),r.isHidden=0===r.items.length,r.batchGroup=this.batchGroupKey,r}suggestedFriendsShelfForGrouping(e,t,n,r){if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
let o
return o=t.$kind===rx?this.suggestedFriendsShelf(e,t.suggestedFriends,n,r):this.legacySuggestedFriendsShelf(e,t.suggestedFriends,n,r),o.header=hp(e,n.title,n.subtitle),o.batchGroup=this.batchGroupKey,o.isHidden=0===o.items.length,o.footerTitle=e.loc.string(EM),o.footerAction=pp(),o.footerStyle={$kind:mV,bundleID:sF,width:16,height:16},o}suggestedFriendsShelf(e,t,n,r=!1){const o=DT
if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const i=new oJ(_T)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=ij
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i],l=e.loc.string(xT),u=e.loc.string(LT),d={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
let f,p
c.supportsFriendingViaPush&&c.contactAssociationID?(f={contact:{contactID:c.contactID,contactAssociationID:c.contactAssociationID}},p=!1):(f={messages:{contactID:c.contactID}},p=!0)
const h=new gz(f)
sp(e,h,{...d,actionType:MT})
const w=new vz(c.contactID)
sp(e,w,{...d,actionType:$T})
const g={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:FT,softwareType:r?HV:null,anonymizationOptions:{anonymizationString:a}},v=new Nq(c.contactID,c.fullName,u,l,c.contactID,h,w,p)
Bf(e,v,g),s.push(v),xf(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}legacySuggestedFriendsShelf(e,t,n,r=!1){const o=DT
if(e.client.deviceType!==RH&&e.client.deviceType!==CH)return null
const i=new oJ(_T)
i.isHorizontal=!0,i.mergeWhenFetched=!0,i.batchGroup=ij
const s=[]
for(let i=0;i<t.length;i++){const a=`${o}${i+1}`,c=t[i]
c.buttonText=e.loc.string(xT),c.subtitle=e.loc.string(LT)
const l={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,id:a,anonymizationOptions:{anonymizationString:a}}
c.buttonAction=new wz(c.contactId),sp(e,c.buttonAction,{...l,actionType:MT}),c.removeButtonAction=new vz(c.contactId),sp(e,c.removeButtonAction,{...l,actionType:$T}),Bf(e,c,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,title:a,id:a,kind:FT,softwareType:r?HV:null,anonymizationOptions:{anonymizationString:a}}),s.push(c),xf(n.metricsLocationTracker)}return i.items=s,i.isHidden=0===i.items.length,i}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return{...n,badges:{gameCenter:!0},idType:GG}}}class D1 extends wq{isValid(){const e=void 0!==this.callToActionText&&null!==this.callToActionText&&void 0!==this.clickAction&&null!==this.clickAction,t=void 0!==this.titleText&&null!==this.titleText,n=void 0!==this.lockup&&null!==this.lockup,r=void 0!==this.collectionIcons&&null!==this.collectionIcons
return t&&(n||r||e)}}class _1 extends wq{isValid(){const e=(0,Cv.isSome)(this.collectionIcons)&&this.collectionIcons.length>0,t=(0,Cv.isSome)(this.artwork)&&this.artwork.isValid(),n=(0,Cv.isSome)(this.video)&&this.video.isValid(),r=t||n||e,o=(0,Cv.isSome)(this.overlay)&&this.overlay.isValid()
return r&&o}}class x1 extends wq{constructor(){super(...arguments),this.items=[],this.rtlItems=[]}}class L1 extends hq{constructor(e,t,n){super(),this.card=e,this.shelves=t,this.shareAction=n,this.isIncomplete=!1,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class M1 extends wq{constructor(e,t,n,r,o,i,s){super(),this.details=e,this.displayProperties=n,this.offerButtonAction=r,this.buttonCallToAction=o,this.offerDisplayProperties=t,this.artwork=i,this.video=s}}const $1=Z(oL),F1=Z(oL),N1=Z(oL)
class B1{constructor(){this.index=0,this.todayShelfRecoMetricsData={},this.hasFocusableElements=!1,this.hasNonFocusableElements=!1,this.isResilientDeepLink=!1,this.allowUnpublishedAppEventPreviews=!1}}const U1=[aI,sI,cI,QR]
class G1 extends m1{constructor(){super("GroupingHeroCarouselShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&ie(t,tV)===OB}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,i){if(0!==i.shelves.length)return null
const a=new oJ(BU),c=t.featuredContentData,l={targetType:jV,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(c)},u=new x1
u.autoScrollConfiguration={isAutoScrollEnabled:e.bag.heroCarouselAutoScrollDuration>0,autoScrollInterval:e.bag.heroCarouselAutoScrollDuration}
const d=Hf(e,c,BU,l)
d.autoAdvanceInterval=u.autoScrollConfiguration.autoScrollInterval,Bf(e,a,d),kf(0,d,BU)
for(const i of n.shelfContents){if(r(i.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(i)
continue}const n=cf(e,i)
if(ka(0,i)&&!le(n)){t.isDeferring=!0,t.remainingItems.push(i),t.relationshipToFetch=Yj
continue}const s={targetType:K$,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(i)},a=ya(e,i),c=ma(e,i)
if(o(a.video)&&o(c.artwork))continue
const l=new _1,d=Ga(0,i),f=za(e,i),p=Hf(e,i,f,s)
p.isPreorder=Ve(e,d,VV),Bf(e,l,p),kf(0,p,f)
const h=a.artworkData||c.artworkData,w=a.backgroundColor||c.backgroundColor,g={metricsPageInformation:t.metricsPageInformation,metricsLocationTracker:t.metricsLocationTracker,canDisplayArcadeOfferButton:of(0,t.shelfStyle),lockupArtworkUseCase:td(0,t.shelfStyle),isContainedInPreorderExclusiveShelf:497===t.featuredContentId}
l.overlay=qa(e,i,g),l.backgroundColor=w,l.titleEffect=Ea(0,h),l.artwork=c.artwork,l.video=a.video
const v=Oa(e,i),m={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(i),targetType:K$,id:i.id}
v&&(sp(e,v,m),l.clickAction=v),u.items.push(l),Ef(p.locationTracker),xf(p.locationTracker)}return s(u.items)&&(a.items=[u],i.pageTitleEffect=u.items[0].titleEffect),a.url=Nr(0,a,t),Ef(d.locationTracker),xf(d.locationTracker),a}}class j1 extends m1{constructor(){super("GroupingHorizontalCardShelfController"),this.supportedFeaturedContentIds=new Set([475])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&Kr(0,ie(t,tV))!==_O}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n},i=ie(t,tV)
return o.shelfStyle=Kr(0,i),o}_createShelf(e,t,n,r){var o
const i=function(e){return t.remainingItems.push(e),!1}
let s
if(e.featureFlags.isEnabled("mini_today_cards_grouping")){const r=new uQ(t.metricsPageInformation,t.metricsLocationTracker)
s=Sp(e,null!==(o=n.shelfContents)&&void 0!==o?o:[],t.title,t.subtitle,r)}else{const r={metricsLocationTracker:t.metricsLocationTracker,metricsPageInformation:t.metricsPageInformation}
let o
if(t.shelfStyle===sj)o=t.shelfStyle
else switch(e.client.deviceType){case $H:case"tv":case JG:o=t.shelfStyle
break
case MH:o=pG
break
default:o=nB}s=bp(e,n.shelfContents,o,t.title,t.subtitle,r,i),s.contentType===sj&&Array.isArray(s.items)&&(s.items=s.items.filter(e=>!(e instanceof jJ)||Ap(0,e.media.kind,sj)))}return s.url=Nr(0,s,t),s.isHorizontal=!0,s}}class V1 extends m1{constructor(e=null){super(e||"GroupingLargeBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&ie(t,tV)===KV}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}isInHeroPosition(){return!1}_createShelf(e,t,n,i){const a=s(i)&&o(i.pageTitleEffect)&&0===i.shelves.length,c=s(n.shelfContents)?[n.shelfContents[0]]:[],l=[]
for(const n of c){if(r(n.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(n)
continue}const s={targetType:this.isInHeroPosition()?"heroBreakout":K$,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(n)},c=ya(e,n),u=ma(e,n),d=c.artworkData||u.artworkData,f=V1.createLargeBreakout(e,n,t,this.isInHeroPosition(),a,s)
o(f)||(l.push(f),a&&(i.pageTitleEffect=Ea(0,d)))}const u=new oJ(AM)
return u.isHorizontal=!1,u.items=l,u.url=Nr(0,u,t),0===i.shelves.length&&(u.presentationHints={isFirstShelf:!0}),u}static createLargeBreakout(e,t,n,r,i,s){const a=cf(e,t)
if(ka(0,t)&&!le(a))return n.isDeferring=!0,n.remainingItems.push(t),n.relationshipToFetch=Yj,null
const c=ya(e,t),l=ma(e,t)
if(o(c.video)&&o(l.artwork))return null
const u=c.backgroundColor||l.backgroundColor,d=r?null:ie(t,"breakoutBadge")
let f
const p=ie(t,CV)
f=Ve(e,t,ZB)?e.loc.uppercased(af(e,a,p)):p
let h={type:qV};(null==f?void 0:f.length)>0&&(h={type:Dj,title:f})
const w=Zd(e,t,GH)||Ge(e,a,GH),g=Zd(e,t,kG)||Ge(e,a,oG),v=Aa(e,t,!0,0,!1),m=ba(e,t,0,!1),y=new ZY(w,g,h,null,v,Sa(0,m,t)),A=new QY(y,{position:m||EH},d,l.artwork,c.video,null,u),T=Hf(e,t,A.details.title,s),b=Ve(e,Ga(0,t),VV)
T.isPreorder=b,Bf(e,A,T),kf(0,T,A.details.title)
const S=Oa(e,t),P={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,recoMetricsData:W(t),targetType:NH,id:t.id}
return sp(e,S,P),A.details.callToActionButtonAction=S,A.clickAction=S,Ef(s.locationTracker),A.flowPreviewActionsConfiguration=Ss(e,t,!0,n.clientIdentifierOverride,S,s,P),A}}class H1 extends m1{constructor(){super("GroupingLinkShelfController"),this.supportedFeaturedContentIds=new Set([437,265])}initialShelfDataFromGroupingMediaApiData(e,t){let n=Ae(t,Fj)
return o(n)&&(n=oe(t,aF)),{shelfContents:n}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o={...n,shouldHideShelf:ae(t,"hide"),areContentLinks:s(Ae(t,Fj))}
return o.clientIdentifierOverride=yn(e,t),o}_createShelf(e,t,n,i){if(t.shouldHideShelf)return null
const s=[]
for(let a=0;a<n.shelfContents.length;a++){const c=n.shelfContents[a],l={targetType:uH,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker}
t.areContentLinks&&(l.recoMetricsData=W(c))
let d=null
if(t.isSearchLandingPage){const n=this.trendingSearchLinkFromData(e,c,t.metricsLocationTracker)
if(r(n)||r(n.action))continue
Bf(e,null==n?void 0:n.action,{...l,kind:uH,softwareType:u(null==i?void 0:i.isArcadePage)?HV:null,title:n.action.title,id:`${a}`,idType:YV}),d=n}else{const n=Wr(e,c,t,!1,null,l,null)
if(o(n)||o(n.action.title))continue
d=n.action
const r=Zr(0,c)
r&&Bf(e,d,{...l,kind:uH,softwareType:u(null==i?void 0:i.isArcadePage)?HV:null,title:d.title,id:r})}o(d)||(s.push(d),xf(t.metricsLocationTracker))}if(o(s))return null
if(t.isSearchLandingPage&&e.client.isPhone&&s.length>=6)for(const t of s)t instanceof uz&&(t.action.artwork=Se(e,kM))
const a=new oJ(EV)
return a.isHorizontal=!1,a.items=s,a.title=t.title,a.subtitle=t.subtitle,a.presentationHints={isWidthConstrained:!0},a.url=Nr(0,a,t),t.isSearchLandingPage&&(e.client.isPhone||e.client.isPad)&&(a.contentsMetadata={type:RM,numberOfColumns:s.length>=6?2:1}),a}trendingSearchLinkFromData(e,t,n){const r=f(t,CV)
if((0,kv.isNothing)(r)||0===r.length)return null
const o=new gZ(r,r,null,uN)
return lp(e,o,NH,n),xf(n),new uz(o)}}const q1={shelfIdentifier:"first",slot:0},W1="SLPPage",z1="RoomPageIntent"
class Y1{constructor(e){this.builderClass=e}async handleShelf(e,t,n,r){throw new Error(`${this.builderClass} does not implement handleShelf`)}async handlePagination(e,t,n,r,o){throw new Error(`${this.builderClass} does not implement handlePagination`)}shelfRoute(e){return[{protocol:Oz,path:`${this.shelfPath}{data}`}]}paginationRoute(e){return[{protocol:Oz,path:`${this.paginationPath}`}]}shelfUrl(e){return`${Oz}:${this.shelfPath}${encodeURIComponent(JSON.stringify(e))}`}get shelfPath(){return`/${this.builderClass}/${_z.shelf}/`}get paginationUrl(){return`${Oz}:${this.paginationPath}`}get paginationPath(){return`/${this.builderClass}/${_z.lookup}/`}static createFlowAction(e,t,n){const r=new dY(t)
return r.pageUrl=n.build(),r.pageData=e,r}}!function(e){e.Page="page",e.Shelf="shelf",e.Pagination="pagination"}(gm||(gm={}))
class J1 extends Y1{defaultAttributes(e){return[]}defaultTab(e){return null}prepareRequest(e,t,n,r,o){t.includingAdditionalPlatforms(this.defaultPlatforms(e)),t.includingAttributes(this.defaultAttributes(e)),t.usingCustomAttributes(Ze(e))}defaultAction(e,t,n,r){return J1.createFlowAction(t,this.pageType(),r)}async handlePage(e,t,n,r,o){return await rc(`${this.builderClass}.handlePage`,async()=>{var r
let i
const s=t.build()
if(Or(e,t)?i=new wJ(e,s):((0,kv.isSome)(o)&&(n[Hz.includeUnlistedApps]="1"),i=this.generatePageRequest(e,t,n)),!i)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,i,gm.Page,t,n),i.attributingTo(s)
const a=null!==(r=e.fetchTimingMetricsBuilder)&&void 0!==r?r:new bv.FetchTimingMetricsBuilder,c=void 0===e.fetchTimingMetricsBuilder?e.addingFetchTimingMetricsBuilder(a):e
let l
l=D(Jn(c,i)),l.then(t=>{oc(e,e.user.dsid,t)})
const u=this.generateAdditionalPageRequirements(e,t,n),d=await ac(e,l,u)
let f={originalData:d.primaryPageData}
this.supportsDataAugmenting()&&(f=await this.augmentData(c,t,n,d.primaryPageData))
const p=await a.measureModelConstructionAsync(async()=>await this.renderPage(c,f.originalData,n,d.additionalData,f.additionalData,o)),h=this.defaultTab(p),w=this.defaultAction(e,p,n,t),g=n[Hz.isPPT]
if(t.removeParam(Hz.isPPT),null===h||g)return w
{const e=new xW(h)
return e.actions=[w],e}},async e=>await this.handlePageError(e,t,n))}async handlePageError(e,t,n){throw e}async handleShelf(e,t,n,r){return await rc(`${this.builderClass}.handleShelf`,async()=>{let r
const o=t.build()
if(r=Or(e,t)?new wJ(e,o):this.generateShelfRequest(e,t,n),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,gm.Shelf,t,n),r.attributingTo(t.build())
const i=await Jn(e,r),s=await this.renderShelf(e,i,n)
return this.shelfRequiresAdditionalModification(s,n)?await this.performAdditionalShelfModifications(e,s,n):s},async e=>await this.handleShelfError(e,n))}async performAdditionalShelfModifications(e,t,n){return t}shelfRequiresAdditionalModification(e,t){return!1}async handleShelfError(e,t){throw e}async handlePagination(e,t,n,r,o){return await rc(`${this.builderClass}.handlePagination`,async()=>{let r
const i=t.build()
if(r=Or(e,t)?new wJ(e,i):this.generatePaginationRequest(e,t,n,o),!r)throw new Error(`Could not construct media API request for: ${t}`)
this.prepareRequest(e,r,gm.Pagination,t,n),r.attributingTo(t.build())
const s=await Jn(e,r)
return await this.renderPaginatedPage(e,s,o)},async e=>await this.handlePaginationError(e,n,o))}async handlePaginationError(e,t,n){throw e}generateAdditionalPageRequirements(e,t,n){return{}}generateShelfRequest(e,t,n){throw new Error(`generateShelfRequest is not supported on: ${this.builderClass}`)}generatePaginationRequest(e,t,n,r){throw new Error(`generatePaginationRequest is not supported on: ${this.builderClass}`)}supportsDataAugmenting(){return!1}async augmentData(e,t,n,r){const o={url:t,parameters:n}
return await Ra(e,r,this.additionalDataKeysNeededForData,this.fetchAdditionalDataForKey,o)}additionalDataKeysNeededForData(e,t,n){return null}fetchAdditionalDataForKey(e,t){return null}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async renderPaginatedPage(e,t,n){throw new Error(`renderPaginatedPage is not supported on: ${this.builderClass}`)}}vm=e(1974)
const K1=LV
class Z1{constructor(){this.profile=cH,this.maxPerPage=20}}class Q1 extends J1{defaultAttributes(e){return lc(e)}defaultPlatforms(e){return N(e)}pageType(){return jH}generatePaginationRequest(e,t,n,r){return new wJ(e,r.remainingContent)}async renderPaginatedPage(e,t,n){const r=n
return await this.pageWithContent(e,t,r)}async pageWithContent(e,t,n,r=!0){return await rc("pageWithContent",async()=>function(e,t,n,r=!0){var o
const i=n.preferredShelfContentType||K1,s=new oJ(i),a={id:null,kind:null,softwareType:null,targetType:jV,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:GG,recoMetricsData:null!==(o=W(t))&&void 0!==o?o:{}}
Bf(e,s,a),kf(0,a,n.title),s.isHorizontal=!1,s.shouldFilterApps=n.shouldFilter
const c=V(t)
r&&(n.remainingContent=[]),s.items=Gu(e,c,{contentUnavailable:(e,t)=>(r&&(n.remainingContent=Pt(0,c,e)),!0),lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,artworkUseCase:td(0,i)}})
const l=new lJ([s])
return n.remainingContent.length&&(l.nextPage=n),l}(e,t,n,r))}}class X1 extends Q1{requestWithFilter(e,t,n){return new wJ(e).forType(BH).includingMacOSCompatibleIOSAppsWhenSupported(!0).withFilter(t,n)}async renderPage(e,t,n,r){return await rc(aG,async()=>{const r=new Z1
r.url=this.paginationUrl,r.metricsPageInformation=this.pageInformation(e,t,n),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const o=await this.pageWithContent(e,t,r)
return ui(e,o,r.metricsPageInformation),o})}}const{routes:e2,makeCanonicalUrl:t2}=cc(nc,"/room/{id}"),{routes:n2,makeCanonicalUrl:r2}=cc(nc,"/{platform}/room/{id}")
class o2 extends m1{constructor(e=null){super(e||"GroupingLockupShelfController"),this.supportedFeaturedContentIds=new Set([...BZ,...qZ])}initialShelfDataFromGroupingMediaApiData(e,t){const n=ve(t,FH)
let r=n?n.data:null
return r&&0!==r.length||(r=Ae(t,Fj)),{shelfContents:r}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return hc(e,t,n,r)}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
if(r.displayStyle=t.shelfStyle,557===t.featuredContentId){const n=f(ne(ye(e,t.featuredContentData,Lk),rj),GH)
r.title=n,r.idType=GG,r.badges={forYou:!0},r.targetType="swooshBreakout"}return r}_createShelf(e,t,n,r){if(557===t.featuredContentId){const t=!s(n.shelfContents),r=e.client.isPad
if(t||r)return null}return wc(e,t,n,r)}}class i2 extends m1{constructor(){super("GroupingPersonalizedLockupShelfController"),this.supportedFeaturedContentIds=VZ}shelfRoute(e){return ga(this.supportedFeaturedContentIds,[`${Hz.isOnDeviceRecommendationsShelf}?`,`${Hz.onDeviceRecommendationsUseCase}?`])}initialShelfDataFromGroupingMediaApiData(e,t){const n=ve(t,FH)
let r=n?n.data:null
return r&&0!==r.length||(r=Ae(t,Fj)),{shelfContents:r||[],containsODPShelfContents:!1,recoMetrics:W(n),candidates:null,isHiddenShelf:!1,responseTimingValues:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){var o
const i=r[Hz.onDeviceRecommendationsUseCase]
return(null==i?void 0:i.length)>0?await to(e,i,VH).then(e=>({shelfContents:V(e.dataContainer),containsODPShelfContents:!0,recoMetrics:e.recoMetrics,candidates:e.candidates,isHiddenShelf:!1})).catch(async o=>o instanceof sQ?await i2.fetchODPFallbackContent(e,t,n,r).catch(e=>i2.makeHiddenShelfData(n)):i2.makeHiddenShelfData(n)):(null===(o=n.recommendationsHref)||void 0===o?void 0:o.length)>0?await m1.secondaryGroupingShelfMediaApiData(e,t,n,r).then(t=>{const n=j(e,t),r=this.initialShelfDataFromGroupingMediaApiData(e,n)
return r.responseTimingValues=t[sm.timingValues],r.shelfTitle=ie(n,GH),r}):await m1.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>{const t={shelfContents:V(e)||[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!1,responseTimingValues:e[sm.timingValues]}
return t.shelfTitle=n.title,t})}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){const o=hc(e,t,n,r)
return this.addPersonalizationValuesToShelfToken(e,o,t,r),o}_createShelf(e,t,n,r){var s,a
if(!t.isValidRecommendationsShelf)return null
let c=null
if((0,kv.isNothing)(t.title)&&(t.title=n.shelfTitle),n.containsODPShelfContents){c=this.personalizedShelf(e,n,t,r)
const o=(new oY).set(hG,Oz).path(`${_z.onDeviceRecommendations}`).param(Hz.onDeviceRecommendationsUseCase,t.onDeviceRecommendationsUseCase).param(Hz.token,JSON.stringify(t)).build(),i=new dY(jH,o)
i.title=e.loc.string(Oj),i.pageData=this.odpSeeAllPage(e,n.shelfTitle,K1),eo(e,c,i),c.mergeWhenFetched=!1}else n.isHiddenShelf?c=i2.makeHiddenShelf(t):i(t.recommendationsHref)?(c=this.personalizedShelf(e,n,t,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t)):(c=wc(e,t,n,r),c.url=this.addOnDeviceQueryParamsIfNecessary(e,c.url,t))
const l=(0,kv.isSome)(c.header),u=l&&o(null===(s=c.header)||void 0===s?void 0:s.title),d=!l&&o(c.title),f=(null===(a=n.shelfTitle)||void 0===a?void 0:a.length)>0
return u&&f?c.header.title=n.shelfTitle:d&&f&&(c.title=n.shelfTitle),c}personalizedShelf(e,t,n,r){const o=Df(n.metricsLocationTracker)
o&&o.fcKind===n.featuredContentId&&Ef(n.metricsLocationTracker)
const i={id:n.id,kind:null,softwareType:u(null==r?void 0:r.isArcadePage)?HV:null,targetType:jV,title:n.title,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,idType:GG,fcKind:n.featuredContentId,recoMetricsData:t.recoMetrics,displayStyle:n.shelfStyle}
kf(0,i,n.title)
const s=wc(e,n,t,r)
return Ef(n.metricsLocationTracker),Bf(e,s,i),s}addPersonalizationValuesToShelfToken(e,t,n,r){const o=476===t.featuredContentId
if(!r.hasAuthenticatedUser&&!t.isSearchLandingPage&&!o)return void e.console.log(`Skipping recommendations shelf with fcID ${t.featuredContentId}: No user logged-in`)
const i=ie(n,_M)
if((null==i?void 0:i.length)>0)return t.onDeviceRecommendationsUseCase=i,t.recommendationsHref=n.href,void(t.isValidRecommendationsShelf=!0)
const a=s(Ae(n,FH)),c=!ae(n,yT)
!a&&c?(t.recommendationsHref=n.href,t.isValidRecommendationsShelf=!0):t.isValidRecommendationsShelf=a}addOnDeviceQueryParamsIfNecessary(e,t,n){var r
if(o(t))return null
if((null===(r=n.onDeviceRecommendationsUseCase)||void 0===r?void 0:r.length)>0){const e=new oY(t)
return e.param(Hz.isOnDeviceRecommendationsShelf,FV),e.param(Hz.onDeviceRecommendationsUseCase,n.onDeviceRecommendationsUseCase),e.build()}return t}odpSeeAllPage(e,t,n){const r=new oJ(n||K1)
r.isHorizontal=!1,r.items=BT
const o=new lJ([r])
return o.isIncomplete=!0,o.title=t,o}static async fetchODPFallbackContent(e,t,n,r){return await new Promise((r,o)=>{const i=Ur(e,n)
if(!i){const e=`OnDeviceRecommendationsShelfController: Could not construct media API request for: ${t}`
return Iv.unexpectedType(dV,e,null),void o(new Error(e))}Gr(e,i),i.attributingTo(t.build()),Jn(e,i).then(t=>{const n=ve(j(e,t),FH),o=W(n),i={shelfContents:V(n),containsODPShelfContents:!1,recoMetrics:o,candidates:null,responseTimingValues:t[sm.timingValues]}
r(i)}).catch(e=>{const n=`OnDeviceRecommendationsShelfController: Failed to fetch fallback shelf contents: ${t}`
Iv.unexpectedType(dV,n,null),o(e)})})}static makeHiddenShelfData(e){return{shelfContents:[],containsODPShelfContents:!1,recoMetrics:null,candidates:null,isHiddenShelf:!0}}static makeHiddenShelf(e){const t=new oJ(e.shelfStyle)
return t.isHidden=!0,t}}class s2 extends m1{constructor(){super("GroupingSmallBreakoutShelfController"),this.supportedFeaturedContentIds=new Set([480])}_supports(e,t,n,r){return!!super._supports(e,t,n,r)&&ie(t,tV)===OV}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}shouldImpressShelf(){return!1}_createShelf(e,t,n,o){const i=[]
for(const o of n.shelfContents){if(r(o.attributes)||Mr(t)){t.isDeferring=!0,t.remainingItems.push(o)
continue}const n=cf(e,o)
if(ka(0,o)&&!le(n)){t.isDeferring=!0,t.remainingItems.push(o),t.relationshipToFetch=Yj
continue}const s={targetType:VT,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(o)}
let a
const c=ie(o,CV)
a=Ve(e,o,ZB)?e.loc.uppercased(af(e,n,c)):c
let l={type:qV};(null==a?void 0:a.length)>0&&(l={type:Dj,title:a})
const u=Zd(e,o,GH)||Ge(e,n,GH),d=Zd(e,o,kG)||Ge(e,n,oG),p=sd(e,n,{useCase:5,withJoeColorPlaceholder:!0}),h=z(f(Re(n,qe(e,o),_H),UF))||(null==p?void 0:p.backgroundColor),w=new ZY(u,d,l,null,Ta(0,h),null),g=new XY(w,p,h),v=Hf(e,o,g.details.title,s),m=Ve(e,Ga(0,o),VV)
v.isPreorder=m,Bf(e,g,v),kf(0,v,g.details.title)
const y=Oa(e,o),A={pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,recoMetricsData:W(o),targetType:NH,id:o.id}
sp(e,y,A),g.details.callToActionButtonAction=y,g.clickAction=y,Ef(s.locationTracker),g.flowPreviewActionsConfiguration=Ss(e,o,!0,null==t?void 0:t.clientIdentifierOverride,y,s,A),i.push(g)}const s=new oJ(VT)
return s.isHorizontal=!1,s.items=i,s.url=Nr(0,s,t),0===o.shelves.length&&(s.presentationHints={isFirstShelf:!0}),s}}class a2 extends m1{constructor(){super("ArcadeDownloadPackShelfController"),this.shelfId="arcadeDownloadPackShelf",this.supportedFeaturedContentIds=new Set([566])}shelfRoute(e){return[...super.shelfRoute(e),{protocol:Oz,path:`/${_z.grouping}/${_z.shelf}/{token}`,query:[Hz.isArcadeDownloadPackShelfPlaceholder]}]}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return hc(e,t,n,r)}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:[],categoriesContents:[],apps:[],title:""}}async secondaryShelfDataForShelfUrl(e,t,n,r){const o=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Cv.isNothing)(o)||0===o.apps.length)return{shelfContents:[],categoriesContents:[],apps:[],title:""}
const i=o.apps,s=this.shelfTitle(e,we(o.subscriptionStatus))
if((0,Cv.isSome)(t.query[Hz.isArcadeDownloadPackShelfPlaceholder]))return{shelfContents:[],categoriesContents:[],apps:i,title:s}
const a=i.map(e=>e.adamId),c=i.map(e=>e.categoryId),l=BH,u=OH,d=new wJ(e).addingQuery(`ids[${l}]`,Array.from(a).join(",")).addingQuery(`ids[${u}]`,Array.from(c).join(",")).includingAdditionalPlatforms(N(e)).includingAttributes(vr(e))
return await Jn(e,d).then(async e=>({shelfContents:e.data.filter(e=>e.type===l),categoriesContents:e.data.filter(e=>e.type===u),apps:i,title:s,responseTimingValues:e[sm.timingValues]}))}_createShelf(e,t,n,r){if(t.isFirstRender){const n=e.arcade.getDownloadPackGames(e.bag.arcadeDownloadPackShelfTTLInSeconds)
if((0,Cv.isNothing)(n)||0===n.apps.length){const n=this.emptyShelfWithRefreshUrl(e)
return n.refreshUrl=this.shelfRefreshURL(t),xf(r.metricsLocationTracker),n}{const o=this.placeholderShelf(e,t,n.apps,this.shelfTitle(e,we(n.subscriptionStatus)))
return xf(r.metricsLocationTracker),o}}if(n.apps.length>0&&((0,Cv.isNothing)(n.shelfContents)||0===n.shelfContents.length))return this.placeholderShelf(e,t,n.apps,n.title)
{const r=this.shelfMetrics(n.title,t)
kf(0,r,n.title)
const o=this.downloadPackShelf(e,t,n)
return o.refreshUrl=this.shelfRefreshURL(t),Ef(t.metricsLocationTracker),Bf(e,o,r),o}}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){return null}emptyShelfWithRefreshUrl(e){const t=new oJ(this.useCustomDownloadPackCardShelf(e)?Q_:eH)
return t.id=this.shelfId,t.isHidden=!0,t}placeholderShelf(e,t,n,r){const o=this.useCustomDownloadPackCardShelf(e)?this.downloadPackCardPlaceholderShelf(e,t,n.length):this.smallLockupsPlaceholderShelf(e,t,n)
return o.url=oY.from(Fr(t)).build(),o.title=r,o}downloadPackCardPlaceholderShelf(e,t,n){const r=new oJ(Q_)
r.id=this.shelfId
const o=new Mq
return o.numberOfPlaceholders=n,r.items=[o],t.shelfStyle=r.contentType,r}smallLockupsPlaceholderShelf(e,t,n){const r=new oJ(eH)
return r.id=this.shelfId,r.items=[],r.isHorizontal=!0,r.rowsPerColumn=2,r.items=Array(n.length).fill(new eJ),r.placeholderContentType=r.contentType,r.contentType=tF,t.showingPlaceholders=!0,t.remainingItems=n.map(e=>({id:e.adamId,type:BH})),r}downloadPackShelf(e,t,n){const r=this.categoriesMapFromResponse(e,n.categoriesContents,n.apps),o=this.useCustomDownloadPackCardShelf(e),i=o?Q_:eH,s=this.lockupsFromResponse(e,t,r,o,o,td(0,i),(0,Cv.isSome)(n.shelfContents)?n.shelfContents:[],n.apps),a=new oJ(i)
if(a.id=this.shelfId,a.title=n.title,o){const e=new Mq
e.lockups=s,a.items=[e]}else a.items=s,a.isHorizontal=!0,a.rowsPerColumn=2
return a.isHidden=0===s.length,a}useCustomDownloadPackCardShelf(e){return e.client.isPhone}shelfRefreshURL(e){return oY.from(Fr(e)).param(Hz.isArcadeDownloadPackShelfPlaceholder,FV).build()}lockupsFromResponse(e,t,n,r,o,i,s,a){return Iv.context("lockupsFromResponse",()=>{const c=new Map
for(const e of s)c.set(e.id,e)
const l=t.metricsLocationTracker,u=t.metricsPageInformation,d=[]
for(const t of a){const s=c.get(t.adamId)
if((0,Cv.isNothing)(s))continue
const a=Du(e,s,{offerStyle:o?QU:void 0,offerEnvironment:o?mH:void 0,metricsOptions:{pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},metricsClickOptions:{id:s.id,pageInformation:u,locationTracker:l,badges:{categoryId:t.categoryId}},artworkUseCase:i,shouldHideArcadeHeader:!0,isSubtitleHidden:r});(0,Cv.isNothing)(a)||(ed(a,e),xf(l),r?a.heading=n.get(a.adamId):a.subtitle=n.get(a.adamId),d.push(a))}return d})}categoriesMapFromResponse(e,t,n){const r=new Map
for(const o of n){const n=t.find(e=>e.id===o.categoryId)
if(!n)continue
const i=Zd(e,n,GH)
r.set(o.adamId,i)}return r}shelfTitle(e,t){return e.loc.string(t===kF?"Arcade.DownloadPack.ShelfTitle.NewUser":"Arcade.DownloadPack.ShelfTitle")}shelfMetrics(e,t){return{id:t.id,kind:null,softwareType:HV,targetType:jV,title:e,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:GG,fcKind:t.featuredContentId}}}class c2 extends m1{constructor(){super("GroupingTagBrickShelfController"),this.supportedFeaturedContentIds=new Set([584,587])}initialShelfDataFromGroupingMediaApiData(e,t){var n
return(0,kv.isSome)(t)?{shelfContents:null!==(n=Ae(t,FH))&&void 0!==n?n:null}:{shelfContents:null}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfMediaApiData(e,t,n,r).then(e=>({shelfContents:e.data}))}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,o){let i=se(t,TT)
r(i)&&(i=!0)
const s={...n,showSupplementaryText:!i}
return s.clientIdentifierOverride=yn(e,t),s}_createShelf(e,t,r,s){const a=[],c=[],l=f(t.featuredContentData.attributes,tV)===OV,d=new oJ(HT),h=p(t.featuredContentData.attributes,bT)
if(d.rowsPerColumn=null!=h?h:M(e),d.isHorizontal=!0,(0,kv.isSome)(r.shelfContents))for(const n of r.shelfContents){const r=c2.createBrick(e,n,l,t.metricsPageInformation,t.metricsLocationTracker,t,s);(0,kv.isSome)(null==r?void 0:r.shortEditorialDescription)?((0,kv.isSome)(r)&&a.push(r),xf(t.metricsLocationTracker)):(t.remainingItems.push(n),c.push(n))}if(i(t.presentationHints)&&(d.presentationHints=t.presentationHints),i(t.showSupplementaryText)&&(d.presentationHints={...d.presentationHints,showSupplementaryText:t.showSupplementaryText}),delete t.maxItemCount,i(n(t.featuredContentData,"relationships.contents.data"))&&(0,kv.isSome)(t.featuredContentData.relationships)&&(t.featuredContentData.relationships[FH].data=c),d.title=t.title,d.subtitle=t.subtitle,l){const e=p(t.featuredContentData.attributes,X_)
d.items=a.slice(0,null!=e?e:a.length)}else d.items=a
const w=u(t.featuredContentData.attributes,RO)
if(l&&w){const n=new oJ(OM)
n.items=a,n.presentationHints={isSeeAllContext:!0}
const r=new lJ([n])
r.title=t.title
const o=new dY(jH)
o.title=e.loc.string(Oj),o.pageData=r,d.seeAllAction=o,ap(e,o,"",{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker})}return d&&o(d.items)&&t.isFirstRender&&da(e,d,t,t.featuredContentId),t.presentationHints=d.presentationHints,d.url=Nr(0,d,t),d}static createBrick(e,t,n,r,o,s,a){var c,l,u
const d=null!==(c=W(t))&&void 0!==c?c:void 0,f={targetType:n?HG:KB,pageInformation:r,locationTracker:o,recoMetricsData:d},p=zr(e,t)
if(!p){const e=new FY
return e.shortEditorialDescription=ie(t,GH),e}const h=new FY,w=qr(e,t,0,0,0,f)
if(w.length>0){const e=w[0].backgroundColor
h.collectionIcons=w,(0,kv.isSome)(e)&&(null==e?void 0:e.type)===hj&&(h.backgroundColor=null!==(l=lf(e))&&void 0!==l?l:void 0)}h.accessibilityLabel=p.title,h.shortEditorialDescription=p.shortEditorialDescription,h.clickAction=p.action,435===ce(t,bG)&&(h.personalizationStyle=oF)
const g=ye(e,t,FH)
if(i(g)){const n=rp(e,g,f),r=null!==(u=null==s?void 0:s.clientIdentifierOverride)&&void 0!==u?u:null
h.flowPreviewActionsConfiguration=Ss(e,t,!0,r,h.clickAction,f,n)}return Bf(e,h,Hf(e,t,p.title,f)),h.artworkSafeArea=Yq.defaultTileArtworkSafeArea,h.textSafeArea=Yq.defaultTileTextSafeArea,h.isValid()?h:null}shelfMetricsOptionsFromBaseMetricsOptions(e,t,n){const r={...n}
return f(t.featuredContentData.attributes,tV)===OV&&(r.title=EO),r}}const l2=[new y1,new A1,new T1,new b1,new S1,new P1,new I1,new O1,new k1,new E1,new R1,new C1,new G1,new j1,new V1,new H1,new o2,new i2,new s2,new a2,new class extends m1{constructor(){super("GroupingMediaPageHeaderShelfController"),this.supportedFeaturedContentIds=new Set([585])}initialShelfDataFromGroupingMediaApiData(e,t){return{shelfContents:Ae(t,FH)}}async secondaryShelfDataForShelfUrl(e,t,n,r){return await m1.secondaryGroupingShelfDataForShelfUrl(e,t,n,r)}shelfTokenFromBaseTokenAndMediaApiData(e,t,n,r){return n}_createShelf(e,t,n,r){var o
if(!xr(e,PG))return null
const i=n.shelfContents[0]
let s
if((0,kv.isSome)(i)){s=null!==(o=f((0,Yv.attributeAsDictionary)(i,rj),GH))&&void 0!==o?o:null
const t=nd(e,h(Ia(e,i),"categoryDetailStatic16x9"),{withJoeColorPlaceholder:!0,useCase:0,cropCode:"CDS.ApTCHM01"})
if((0,kv.isSome)(s)&&(0,kv.isSome)(t)){const e=K(t.backgroundColor),n=new Wq(null,s,null,t,null,null,!1,null,null,e?mH:UV),r=new oJ(TM)
return r.items=[n],r}return null}return null}},new c2]
class u2 extends hq{constructor(e,t,n,r,o,i){super(),this.bodyText=e,this.isDetailHeader=t,this.privacyTypes=n,this.bodyActions=r,this.supplementaryItems=o,this.seeDetailsAction=i}}class d2 extends hq{constructor(e,t){super(),this.bodyText=e,this.action=t}}class f2 extends hq{constructor(e,t,n){super(),this.bodyText=e,this.actions=t,this.privacyTypesCount=n}}class p2 extends wq{constructor(e,t,n,r,o,i,s,a){super(),this.identifier=e,this.title=t,this.detail=n,this.artwork=r,this.style=o,this.purposes=i,this.categories=s,this.clickAction=a,this.wantsScrollFocus=!1}}class h2 extends hq{constructor(e,t,n){super(),this.identifier=e,this.title=t,this.categories=n}}class w2 extends hq{constructor(e,t,n,r,o=[]){super(),this.identifier=e,this.title=t,this.artwork=n,this.style=r,this.dataTypes=o,this.prefersSmallArtwork=!1}}const g2=["284417353","1464590764","314638464","284993479","1351056256"]
class v2{setShelfId(e,t){this.shelfId=e,this.index=t,IK.has(e)&&(this.section=new TK(VH,e))}}class m2{constructor(e,t,n=0){this.sequenceId=0,this.metricsPageInformation=e,this.locationTracker=t,this.sequenceId=n}addImpressionsToShelf(e,t,n,r,o,i,s){Bf(e,t,{id:null!=r?r:`${this.sequenceId}`,idType:null!=o?o:YV,kind:null,softwareType:null,targetType:n,title:null!=s?s:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,recoMetricsData:i}),this.sequenceId++}getSequenceId(){return this.sequenceId}addImpressionsFieldsToSimilarItemsShelf(e,t,n,r){t&&(Bf(e,t,{id:m2.similarItemsShelfId,kind:null,softwareType:null,targetType:n,title:t.title,pageInformation:this.metricsPageInformation,locationTracker:this.locationTracker,idType:r}),this.sequenceId++)}static resetLocationTrackerForSimilarItemsDuringDownloadShelf(e,t){const n=t.sourceLocationTracker
_f(n,0),Df(n).id=m2.similarItemsDuringDownloadShelfId}static addImpressionsFieldsToSimilarItemsDuringDownloadShelf(e,t,n){t&&Bf(e,t,{id:m2.similarItemsDuringDownloadShelfId,kind:null,softwareType:null,targetType:MV,title:n.title,pageInformation:n.sourcePageInformation,locationTracker:n.sourceLocationTracker,idType:gB})}}m2.similarItemsShelfId=$B,m2.similarItemsDuringDownloadShelfId=sk
class y2 extends hq{constructor(e,t,n){super(),this.title=e,this.description=t,this.artwork=n}}class A2 extends wq{constructor(e,t,n){super(),this.title=e,this.artwork=t,this.features=n}}class T2 extends wq{constructor(e,t){super(),this.text=e,this.actions=t}}class b2 extends hq{constructor(e,t,n,r){super(),this.title=e,this.summary=n,this.items=t,this.items_V3=[],this.shouldAlwaysPresentExpanded=!1,this.linkAction=r}}class S2 extends hq{constructor(e,t={}){super(),this.text=e,this.heading=t.heading,this.headingArtworks=t.headingArtworks,this.listText=t.listText,this.textPairs=t.textPairs}}class P2 extends hq{constructor(e,t,n){super(),this.title=e,this.annotations=t,this.forceExpanded=n}}const{routes:I2,makeCanonicalUrl:C2}=cc(Ir,"/{platform}/story/{id}"),{routes:k2,makeCanonicalUrl:O2}=cc(Ir,"/story/{id}"),E2=[Al,bl,qc,Qc,Sl,Wc,tl,cl,al,sl,Jc,Pl,el,nl,Xc],R2=[bl,qc,Qc,Sl,Wc,tl,cl,al,sl,Jc,Pl,el,Al,nl,Xc],D2=[Al,qc,function(e,t,n,r,o,i){const s=Ue(e,t,GN)
if(0===s.length)return null
const a=s[0]
let c=null
const l=f(a,NN)
if(l){const t=e.loc.string("ProductPage.VersionAnnotation.Value.DateFormat")
c=e.loc.formatDate(t,new Date(l))}const u=f(a,gR)
if(0===s.length)return null
let d
if(u&&c)d=e.loc.string("ProductPage.VersionAnnotation.Value").replace("@@version@@",u).replace(Ay,c)
else{if(!u)return null
d=u}const p=new S2(d),h=o?"":e.loc.string("ProductPage.VersionAnnotation.Title"),w=new b2(h,[p])
return w&&!r?w:null},bl,nl,Xc],_2=[Wc,al,Jc,function(e,t,n,r,o,i){const s=[],a=Yc(e,t);(0,kv.isSome)(a)&&s.push(a)
const c=Zc(e,t)
if((0,kv.isSome)(c)&&s.push(c),0===s.length)return null
const l=e.loc.string("InfoList.AgeRating.Title.KR"),u=new b2(l,s)
return u.shouldAlwaysPresentExpanded=!0,u}],x2="DeveloperPageIntent",L2=[xl,ql,Dl,Gl,Nl,function(e,t,n,r){var o
return null!==(o=Ll(e,t))&&void 0!==o?o:Ml(e,t)},Ul],M2=[Hl,Bl,_l,xl,ql],$2=[Hl,xl,ql,Ll,function(e,t,n,r){if(!Ve(e,t,rN))return null
const o=e.loc.string("BADGE_FRIENDS_HEADING","Friends"),i=LH,s=WV,a=WV,c={maxNumberOfAvatarsToDisplay:3,maxNumberOfFriendsBeforeTruncation:99,adamId:t.id}
return new AK(s,a,c,i,o,"",null,"",o,pV)},_l,Dl,Gl,Nl,Ml,Ul,function(e,t,n,o){if(gt(e).isSystemAppFromData(t))return null
const i=Ld(e,t)
if(r(i)||r(i.fileSizeByDevice))return null
const s=function(e,t){let n
if(n=(0,Cv.isSome)(t.maxEssentialInstallSizeInBytes)?t.fileSizeByDevice+t.maxEssentialInstallSizeInBytes:(0,Cv.isSome)(t.maxInstallSizeInBytes)?t.fileSizeByDevice+t.maxInstallSizeInBytes:t.fileSizeByDevice,n<=0)return null
const r=e.loc.fileSize(n).trim().split(/\s+/)
return 2!==r.length?null:{size:r[0],unit:r[1]}}(e,i)
if(!s)return null
const a={paragraphText:s.size},c=s.unit,l=e.loc.string("BADGE_SIZE_HEADING")
return new AK(fG,Ux,a,LH,l,c,null,null,c,zG)}]
!function(e){e.StoryCenteredMotion16x9="storyCenteredMotion16x9",e.StoryCenteredStatic16x9="storyCenteredStatic16x9",e.StoryDetailMotion3x4="storyDetailMotion3x4",e.StoryDetailStatic3x4="storyDetailStatic3x4",e.HeroMotion16x9="heroMotion16x9",e.HeroStatic16x9="heroStatic16x9",e.HeroMotionRTL16x9="heroMotionRTL16x9",e.HeroStaticRTL16x9="heroStaticRTL16x9",e.LargeBreakoutMotion16x9="largeBreakoutMotion16x9",e.LargeBreakoutStatic16x9="largeBreakoutStatic16x9",e.LargeBreakoutRTLMotion16x9="largeBreakoutRTLMotion16x9",e.LargeBreakoutRTLStatic16x9="largeBreakoutRTLStatic16x9",e.StoryCardMotion3x4="storyCardMotion3x4",e.StoryCardStatic3x4="storyCardStatic3x4",e.StorySearchStatic16x9="storySearchStatic16x9",e.SubscriptionHero="subscriptionHero",e.UniversalAMotion16x9="universalAMotion16x9",e.UniversalAStatic16x9="universalAStatic16x9",e.BrickStatic16x9="brickStatic16x9",e.BrickStaticRTL16x9="brickStaticRTL16x9"}(mm||(mm={})),function(e){e.Hero="hero",e.LargeBreakout="largeBreakout",e.StoryCard="storyCard",e.StoryDetail="storyDetail",e.StoryDetailLandscape="storyDetailLandscape",e.Search="search",e.Brick="brick",e.EditorialLockup="editorialLockup",e.EditorialPage="editorialPage"}(ym||(ym={}))
const F2={hero:[mm.HeroMotion16x9,mm.HeroStatic16x9,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],largeBreakout:[mm.LargeBreakoutMotion16x9,mm.LargeBreakoutStatic16x9,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyCard:[mm.StoryCardMotion3x4,mm.StoryCardStatic3x4,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyDetail:[mm.StoryDetailMotion3x4,mm.StoryDetailStatic3x4,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyDetailLandscape:[mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9,mm.StoryDetailMotion3x4,mm.StoryDetailStatic3x4],search:[mm.StorySearchStatic16x9,mm.StoryCenteredStatic16x9,mm.UniversalAStatic16x9],brick:[mm.BrickStatic16x9,mm.HeroStatic16x9,mm.StoryCenteredStatic16x9,mm.UniversalAStatic16x9],editorialLockup:[mm.SubscriptionHero],editorialPage:[mm.StoryCardStatic3x4,mm.HeroStatic16x9,mm.StoryCenteredStatic16x9,mm.SubscriptionHero]},N2={hero:[mm.HeroMotionRTL16x9,mm.HeroStaticRTL16x9,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],largeBreakout:[mm.LargeBreakoutRTLMotion16x9,mm.LargeBreakoutRTLStatic16x9,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyCard:[mm.StoryCardMotion3x4,mm.StoryCardStatic3x4,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyDetail:[mm.StoryDetailMotion3x4,mm.StoryDetailStatic3x4,mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9],storyDetailLandscape:[mm.StoryCenteredMotion16x9,mm.StoryCenteredStatic16x9,mm.UniversalAMotion16x9,mm.UniversalAStatic16x9,mm.StoryDetailMotion3x4,mm.StoryDetailStatic3x4],search:[mm.StorySearchStatic16x9,mm.StoryCenteredStatic16x9,mm.UniversalAStatic16x9],brick:[mm.BrickStaticRTL16x9,mm.HeroStatic16x9,mm.StoryCenteredStatic16x9,mm.UniversalAStatic16x9],editorialLockup:[mm.SubscriptionHero],editorialPage:[mm.StoryCardStatic3x4,mm.HeroStatic16x9,mm.StoryCenteredStatic16x9,mm.SubscriptionHero]},B2={chartPositions:function(e,t,n,r,i){var s,a
const c=function(e,t){const n=Be(e,t,KE)
if(o(n))return null
const r=Ud(0,e.host.clientIdentifier)
return o(r)?null:h(n,r)}(e,t)
if(o(c))return null
const l=p(c,Sx)
if((0,Cv.isNothing)(l)||l>50)return null
const u=null!==(s=f(c,"genreShortName"))&&void 0!==s?s:f(c,HS)
if(null!=u){if(r.has(u))return null
r.add(u)}let d
d=e.bag.isLLMSearchTagsEnabled?new kY("highlightedText"):new kY("borderedTextLabel"),d.moduleType=KE
const w=(0,Cv.isSome)(null===(a=n.searchAdOpportunity)||void 0===a?void 0:a.searchAd)||(0,Cv.isSome)(n.searchAd)?e.bag.adsOverrideLanguage:null,g=(0,Cv.isSome)(w)?e.adsLoc:e.loc
{const t=g.string("MetadataRibbon.ChartPosition").replace(XP,e.loc.formattedCountForPreferredLocale(e,l,w))
e.bag.isLLMSearchTagsEnabled?(d.highlightedText=t,d.labelText=g.string("MetadataRibbon.ChartPositionAndCategory.Tags").replace(XP,e.loc.formattedCountForPreferredLocale(e,l,w)).replace("@@category@@",u)):(d.labelText=u,d.borderedText=t)}return d.secondaryViewPlacement=EH,Uf(e,d,Wf(i,Jx,d.labelText,QV)),[d]},genreDisplayName:function(e,t,n,r,i){const s=Yn(e,t,!0),a=(0,kv.isSome)(s),c=Ru(e,t)
if(o(c))return null
if(null!=c){if(r.has(c))return null
r.add(c)}const l=new kY(a?dL:i$)
if(l.moduleType=FG,l.labelText=c,a){const t=nd(e,s,{useCase:20})
t.crop="sr",l.artwork=t}return Uf(e,l,Wf(i,FG,l.labelText,QV)),[l]},genreShortDisplayName:function(e,t,n,r,o){const i=Yn(e,t,!0),s=(0,kv.isSome)(i),a=ie(t,r$)
if(null!=a){if(r.has(a))return null
r.add(a)}if((0,kv.isNothing)(a)||0===a.length)return null
const c=new kY(s?dL:i$)
return c.moduleType=r$,c.labelText=a,s&&(c.artwork=nd(e,i,{useCase:20,cropCode:"sr"})),Uf(e,c,Wf(o,FG,c.labelText,QV)),[c]},secondaryGenreShortDisplayNames:function(e,t,n,r,i){const s=oe(t,xR)
return o(s)?null:s.map(t=>{const n=new kY(i$)
n.moduleType=r$,n.labelText=t
const r=Wf(i,FG,n.labelText,QV)
return Uf(e,n,r),xf(i.locationTracker),n}).filter(e=>null!=e.labelText&&!r.has(e.labelText))},developerInfo:function(e,t,n,r,o){var i
let s=n.developerName
if((0,kv.isNothing)(s)&&(s=null!==(i=ie(t,Cj))&&void 0!==i?i:ie(t,QT)),null!=s){if(r.has(s))return null
r.add(s)}if((0,kv.isSome)(s)&&s.length>0){const t=new kY(dL)
t.moduleType=eI,t.labelText=s,t.artwork=Se(e,Zx)
const n=6
return t.maxCharacterCount=16,t.truncationLegibilityCharacterCountThreshold=Math.min(n,s.length),t.allowsTruncation=s.length>=n,Uf(e,t,Wf(o,eI,t.labelText,QV)),[t]}return null},editorialBadgeInfo:function(e,t,n,r,o){var i
if(n.isEditorsChoice){const t=new kY(fV)
return t.moduleType=tU,t.useAdsLocale=((0,Cv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd)||(0,Cv.isSome)(n.searchAd))&&(0,Cv.isSome)(e.bag.adsOverrideLanguage),Uf(e,t,Wf(o,tU,"Editors Choice",QV)),[t]}return null},userRating:function(e,t,n,r,o){const s=Ve(e,t,VV)
if(i(n.ratingCount)&&i(n.rating)&&!s){const t=new kY("starRating")
return t.moduleType=AN,t.starRating=n.rating,t.labelText=n.ratingCount,Uf(e,t,Wf(o,AN,"User Rating",QV)),[t]}return null},supportsGameController:function(e,t,n,r,o){var i
let s=!1
switch(Ge(e,t,xB)){case FL:case WD:s=!0}if(Ve(e,t,WR)&&(s=!0),!s)return null
const a=new kY(dL)
a.moduleType=WR
const c=((0,Cv.isSome)(n.searchAd)||(0,Cv.isSome)(null===(i=n.searchAdOpportunity)||void 0===i?void 0:i.searchAd))&&(0,Cv.isSome)(e.bag.adsOverrideLanguage)
return a.labelText=c?e.adsLoc.string(yN):e.loc.string(yN),a.artwork=Se(e,yF),Uf(e,a,Wf(o,WR,"Supports Game Controller",QV)),[a]},tag:function(e,t,n,r,o){const i=t,s=new kY(i$)
return s.moduleType=wE,s.labelText=ie(i,GH),(0,kv.isNothing)(s.labelText)||0===s.labelText.length||r.has(s.labelText)?null:(Uf(e,s,Wf(o,i.id,s.labelText,"tag_id")),r.add(s.labelText),[s])},divider:function(e,t,n,r,o){const i=new kY(tI)
return i.moduleType=tI,i.labelText="|",[i]}}
class U2{constructor(){this.runsOnIntel=!0,this.runsOnAppleSilicon=!0,this.requiresRosetta=!1}}!function(e){e[e.seeAllPage=0]="seeAllPage",e[e.categoryBreakout=1]="categoryBreakout",e[e.other=2]="other"}(Am||(Am={}))
class G2{constructor(e,t){this.videos=e,this.mediaPlatform=t}}const j2=new Sq(414,896),V2=new Sq(375,812),H2=new Sq(414,736),q2=new Sq(375,667),W2=new Sq(320,568),z2=new Sq(320,480),Y2=(new Sq(768,1024),new Sq(810,1080)),J2=new Sq(834,1112),K2=new Sq(834,1194),Z2=new Sq(1194,834),Q2=new Sq(1024,1366),X2=new Sq(1024,1366),e4=new Sq(1366,1024),t4=new Sq(744,1133),n4=new Sq(1133,744),r4=new Sq(1032,1376),o4=new Sq(1376,1032),i4=new Sq(834,1210),s4=new Sq(1210,834),a4=new Sq(312,390),c4=new Sq(368,448),l4=new Sq(396,484),u4=new Sq(410,502),d4=new Sq(416,496),f4=new Sq(410,502),p4=new Sq(820,1180),h4=new Sq(360,780),w4=new Sq(390,844),g4=new Sq(428,926),v4=new Sq(393,852),m4=new Sq(430,932),y4=new Sq(402,874),A4=new Sq(440,956),T4=new Sq(420,912),b4=new Sq(422,514),S4=[Kk,Yk,Jk,R_,CA,IA,PA,aH],P4=112.5,I4=4.5,C4="#9BA9BD",k4={colorHex:C4,maxSaturation:4,maxBrightness:9},O4=[k4],E4=[{colorHex:"#F7816F",minHue:0,maxHue:16},{colorHex:"#FF9034",minHue:17,maxHue:33},{colorHex:"#E3B059",minHue:34,maxHue:59},{colorHex:"#74BD66",minHue:60,maxHue:129},{colorHex:"#72C792",minHue:130,maxHue:169},{colorHex:"#61BFE2",minHue:170,maxHue:209},{colorHex:"#6EA3E9",minHue:210,maxHue:239},{colorHex:"#7D69FA",minHue:240,maxHue:259},{colorHex:"#B363F7",minHue:260,maxHue:289},{colorHex:"#EE7CBD",minHue:290,maxHue:360}]
class R4{constructor(){this.position=0}}const D4="::"
class _4{constructor(e){this._options=Object.freeze(e)}get defaultTopic(){return this._options.defaultTopic}_reduceFieldAccuracy(e,t){for(const n of t){const t=f(n,"fieldName")
if(r(t))continue
const o=p(e,t)
if(r(o))continue
let i=p(n,"magnitude")
r(i)&&(i=1048576)
let s=p(n,"significantDigits")
if(r(s)&&(s=2),i<=0||s<0){e[t]=Number.NaN
continue}const a=o/i
e[t]=Ie(a,s)}}_urlScrubbingAdParameters(e){const t=new oY(e)
return t.removeParam(JX),t.removeParam(KX),t.removeParam(ZX),t.build()}_urlScrubbingExtRefUrl(e){const t=new oY(e)
return t.username="",t.password="",t.pathname=void 0,t.query=void 0,t.hash=void 0,t.build()}_derezFastImpressions(e){const t=f(e,fF),n=p(e,pF)
if(t===WO){if(4===n){const t=l(e,Rj)
e[Rj]=t.map(e=>{if((0,Cv.isNothing)(e))return e
const t=l(e,pb)
return 0===t.length||(e[pb]=t.map(e=>{if((0,Cv.isNothing)(e))return e
const t=p(e,"d")
return e.s=0,(0,Cv.isSome)(t)&&(e.d=Ie(t,2)),e})),e})}if(5===n){const t=l(e,Rj)
e[Rj]=t.map(e=>{if((0,Cv.isNothing)(e))return e
delete e[mx],(o(f(e,yx))||o(f(e,Ax)))&&delete e.id
const t=h(e,hb)
return(0,Cv.isNothing)(t)||o(t)||(Object.entries(t).forEach(([e,n])=>{const r=l(n)
t[e]=r.map(e=>{if((0,Cv.isNothing)(e))return e
const t=p(e,"d")
return e.s=0,(0,Cv.isSome)(t)&&(e.d=Ie(t,2)),e})}),e[hb]=t),e})}}}_stripContentRatingImpressionFields(e){const t=l(e,Rj)
e[Rj]=t.map(e=>((0,Cv.isSome)(e)&&(delete e[aB],delete e[zV]),e))}_decorateSearchResultImpressions(e){const t=f(e,iG),n=f(e,rU)
t===VG&&n!==LM&&function(e){const t=l(e,Rj)
let n
for(const e of t){const t=f(e,FM)
if((0,Cv.isSome)(e)&&t===IG){n=e[_x]
break}}n&&(e[Rj]=t.map(e=>{const t=f(e,FM),r=t===lj||t===qL
return(0,Cv.isSome)(e)&&r&&(e[vE]=n),e}))}(e)}_decorateSearchFocusImpressions(e){const t=f(e,iG),n=f(e,rU)
t===Tx&&n===bx&&function(e){var t
const n=l(e,Rj)
let r
for(const e of n)if("R8804"===f(e,X$)){r=null!==(t=f(e,_x))&&void 0!==t?t:void 0
break}r&&(e[Rj]=n.map(e=>{const t=f(e,X$),n=f(e,FM)
return o(t)&&n===uH&&null!=e&&null==f(e,vE)&&(e[vE]=r),e}))}(e)}_decorateAll(e,t,n){var o,i,s
const a=this._options.bagProvider,c=a("metricsBase",n)
r(c)||typeof c!==EG||Object.assign(t,c),t.clientBuildType=this._options.buildType,t.resourceRevNum=this._options.jsVersion,t.xpSendMethod="jet-js",this._options.buyDecorator.useApp(f(t,SH)),delete t[aK]
const u=function*(e){if((0,Cv.isNothing)(e))return
const t=e.split(";")
for(const e of t){const t=e.indexOf("=")
if(-1===t){const t=decodeURIComponent(e).trim()
yield{key:t,value:""}}else{const n=decodeURIComponent(e.substring(0,t)).trim(),r=decodeURIComponent(e.substring(t+1)).trim()
yield{key:n,value:r}}}}(f(t,wb))
for(const e of u)if("xp_ci"===e.key){this._options.buyDecorator.useClientId(e.value)
break}delete t[wb]
const d=null!==(i=null===(o=e.metricsIdentifiersCache)||void 0===o?void 0:o.getMetricsFieldsForTypes([xv.client]))&&void 0!==i?i:{}
Object.assign(t,d),delete t.clientGeneratedId
const p=f(t,iG),h=f(t,rU)
if(!r(p)&&!r(h)){const e=f(a("compoundSeparator",n))||"_"
t[jH]=`${p}${e}${h}`}const w=l(a("deResFields",n))
this._reduceFieldAccuracy(t,w)
const g=[wN,dF,gN,vN,AH,"parentPageUrl"]
for(const e of g){const n=f(t,e);(0,Cv.isSome)(n)&&n.length>0&&(t[e]=e===gN?this._urlScrubbingExtRefUrl(n):this._urlScrubbingAdParameters(n))}const v=f(t,YO)
if((0,Cv.isSome)(v)&&(delete t[YO],t[MM]=v),e.bag.isMetricsUserIdFallbackEnabled){const n=f(t,JO)
let r=null;((0,Cv.isNothing)(n)||0===n.length||n.length===_4.clientGeneratedUserIdLength)&&(r=null!==(s=e.user.dsid)&&void 0!==s?s:null),(0,Cv.isSome)(r)&&r.length>0&&(t[KO]=r)}}_decorateClick(e){!function(e){const t=f(e,GM),n=f(e,mE)
r(t)&&(0,kv.isSome)(n)&&(null==n?void 0:n.length)>0&&(e[GM]=n),f(e,yE)===Yb&&delete e[AE]}(e),this._decorateSearchResultImpressions(e),this._decorateSearchFocusImpressions(e),SW.shared.addReferralDataToEventIfNecessary(e),this._filterBuyParams(e)
const t=f(e,iG)
!(0,Cv.isNothing)(t)&&t.toLowerCase().includes(JV)||delete e[Rj],Yf(e)}_decorateImpressions(e,t){if(o(t[Rj]))return!1
this._derezFastImpressions(t),this._decorateSearchResultImpressions(t),this._stripContentRatingImpressionFields(t)
const n=f(t,vN)
return(0,Cv.isSome)(n)&&n.length>0&&(t[oV]=Tf(n),delete t[vN]),Yf(t),delete t[fF],!0}_decorateMedia(e){const t=p(e,Sx)
r(t)||(e[Sx]=Math.round(t))}_filterBuyParams(e){const t=f(e,"actionDetails.buyParams")
if((0,Cv.isSome)(t)&&t.length>0){const n=new sK(t);[gb].forEach(e=>{n.set(e,null,null)}),(0,Cv.isSome)(e[bU])&&(e[bU][ZU]=n.toString())}}_decoratePage(e,t){const n=f(t,jH)
r(n)||(t.pageHistory=this._options.buyDecorator.getPageHistoryFor(n)),SW.shared.setReferralDataForProductPageExtensionIfNecessary(t),SW.shared.beginReferralContextForPageIfNecessary(t),SW.shared.addReferralDataToEventIfNecessary(t)
const o=f(t,vN)
if(!r(o)){const e=mf(o),n=Tf(o)
null!==e&&e.length>0&&(t[$M]=e),null!==n&&n.length>0&&(t[oV]=n)}}_decoratePageChange(e,t){this._decoratePage(e,t)}_decorateSearch(e){e[pF]=3,function(e){var t
const n=null!==(t=e[bU])&&void 0!==t?t:{},o=n[GM],i=f(e,mE)
r(o)&&(0,kv.isSome)(i)&&(null==i?void 0:i.length)>0&&(n[GM]=i,e[bU]=n),f(e,yE)===Yb&&delete e[AE],e[_N]===TE&&delete e[AE]}(e)}_decoratePageExit(e){SW.shared.endReferralContextIfNecessaryForPageEvent(e)}_filterExtraneous(e){!function(e){delete e[mE],delete e[yE],delete e.searchGhostHintTermLastDisplayed}(e),SW.shared.removeReferralContextInfoFromMetricsEvent(e)}makeEvent(e,t){const n=f(t,vG)
if(this._options.isLoggingEnabled&&e.console.log(`Building event for topic: ${n}`),t[SH]===GC)return new kW({})
const r=f(t,zL)||this._options.defaultTopic
let o
this._decorateAll(e,t,r),o=e.user.isUnderThirteen,o&&(delete t[KO],delete t[JO],delete t.canonicalAccountIdentifierOverride)
const i=t[gN]
switch(i&&""===i&&delete t[gN],n){case iB:this._decorateClick(t)
break
case zO:break
case Rj:if(!this._decorateImpressions(e,t))return new kW({})
break
case db:this._decorateMedia(t)
break
case jH:this._decoratePage(e,t)
break
case MD:this._decoratePageChange(e,t)
break
case vb:this._decoratePageExit(t)
break
case JV:this._decorateSearch(t)}return this._filterExtraneous(t),e.bag.metricsIdMigrationEnabled&&function(e){delete e[SE],delete e.DSID}(t),new kW(t)}}_4.clientGeneratedUserIdLength=24,_4.hasIAdData=fb,kv.Color.fromRGB(1,90/255,80/255),new Set([_H,OF,qj,RL,DV])
const x4=new Set([JU,_H,OF,qj,RL,DV]),L4=new Set([JU,_H,OF,qj,RL,DV]),M4=new Set([JU,_H,qj,DV]),$4=(new Set([JU,_H,xD,OF,DV]),"write-review"),F4=pH,N4="appPromotionRequirementKey"
Q(z("F0F0F8"),z("303031")),function(e){e.MoreByDeveloper="moreByDeveloper",e.SimilarItems="similarItems",e.SmallStory="smallStory"}(Tm||(Tm={}))
class B4{constructor(e,t,n,r,o,i,s,a,c,l,u,d){this.isFirstRender=!0,this.isBundleShelf=!1,this.showingPlaceholders=!1,this.productId=e,this.onDemandShelfType=d,this.remainingItems=t,this.title=n,this.shouldInferSeeAllFromFetchesItems=r,this.capabilities=o,this.contentType=i,this.offerStyle=s,this.spotlightInAppProductIdentifier=a,this.refreshUrl=c,this.recoMetricsData=l,this.supportsArcade=u}}const U4=[JU,qj,_H,DV],G4=(0,Pv.makeMetatype)("app-store:page-router")
class j4{constructor(){this.registeredBuilders=new Set,this.pageRouter=new aY,this.shelfRouter=new aY,this.paginationRouter=new aY}registerPageBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.pageRouter.associate(t.pageRoute(e),t),this.shelfRouter.associate(t.shelfRoute(e),t),this.paginationRouter.associate(t.paginationRoute(e),t)}registerShelfBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.shelfRouter.associate(t.shelfRoute(e),t)}registerPaginationBuilder(e,t){if(this.registeredBuilders.has(t.builderClass))throw new Error(`routing: Registering duplicate builderClass ${t.builderClass}`)
this.registeredBuilders.add(t.builderClass),this.paginationRouter.associate(t.paginationRoute(e),t)}fetchFlowPage(e){const t=this.pageRouter.routedObjectForUrl(e)
if(!t.object)return"unknown"
const n=t.object
return n.builderClass===jy&&t.parameters[Hz.action]!==F4&&t.parameters[Hz.action]!==$4?Jj:n.pageType()}async fetchPage(e,t,n){return await this.fetchAction(e,t,null).then(async r=>await new Promise((o,i)=>{if(!r)throw new Error(`Promise resolved to null action for: ${t}`)
if(r.actionClass!==LD){if(r.actionClass===Fm){const e=r
if(1===e.actions.length&&e.actions[0].actionClass===LD){const t=e.actions[0].pageData
return S(t,n)?void o(t):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(t)}`))}}i(new Error("Action is not a flowAction or a tabChangeAction that contains a single flowAction."))}else{const s=r.pageData
if(!S(s,n)){const a=r.pageUrl
return a&&a!==t?void this.fetchPage(e,a,n).then(e=>{o(e)}).catch(e=>{i(e)}):void i(new Error(`pageData is not expected type ${n.name}, ${JSON.stringify(s)}`))}o(s)}}))}async fetchAction(e,t,n,r=new Set){var o
const i=this.pageRouter.routedObjectForUrl(t)
if(!i.object)return await this.redirectAndRefetchActionIfPossible(e,i.normalizedUrl,r)
const s=i.object
return await s.handlePage(e,i.normalizedUrl,null!==(o=i.parameters)&&void 0!==o?o:{},i.matchedRuleIdentifier,n)}async fetchMoreOfPage(e,t){const n=t.url
if(!n)throw new Error("Page token missing required `url` property")
const r=this.paginationRouter.routedObjectForUrl(n)
if(!r.object)throw new Error(`fetchMoreOfPage: Unhandled pagination url: ${n}`)
const o=r.object
return await o.handlePagination(e,r.normalizedUrl,r.parameters,r.matchedRuleIdentifier,t)}async fetchShelves(e,t){const n=Object.keys(t),r=n.map(e=>t[e]),o=await _(r.map(async t=>{if((0,kv.isNothing)(t))throw new Error("fetchShelves: Null shelf url")
const n=this.shelfRouter.routedObjectForUrl(t)
if((0,kv.isNothing)(n.object))throw new Error(`fetchShelves: Unhandled shelf url: ${t}`)
const r=n.object
return await r.handleShelf(e,n.normalizedUrl,n.parameters,n.matchedRuleIdentifier)})),i={shelves:{},errors:{}}
for(const[e,t]of o.entries()){const r=n[e];(0,kv.isNothing)(r)||(t.success?i.shelves[r]=t.value:i.errors[r]=t.error)}if(Object.keys(i.shelves).length>0)return i
{const e=Object.keys(i.errors).map(e=>i.errors[e].message)
throw 0===e.length?new Error(`Could not load any shelves: ${JSON.stringify(t)}`):new Error(e.join("\n"))}}async redirectAndRefetchActionIfPossible(e,t,n=new Set){const r=t.toString()
if(n.has(r))throw new Error(`redirectAndRefetchActionIfPossible: Redirect cycle detected for URL: ${r}`)
n.add(r)
const o=await x(e.network.fetch({url:r,method:EF}))
if(!o.success)throw new Error(`redirectAndRefetchActionIfPossible: Failed to fetch page at url: ${t}`)
const i=o.value
if(this.hasGotoURLInResponse(e,i))return new lz
if(200===i.status&&i.redirected&&i.url)return await this.fetchAction(e,i.url,null,n)
throw new Error(`redirectAndRefetchActionIfPossible: Unhandled page url: ${t}`)}hasGotoURLInResponse(e,t){if(o(t.body))return!1
try{const n=m(e.plist.parse(t.body)),r=f(n,Rk),o=f(n,Dk)
return!(r!==_k||!(0,kv.isSome)(o))}catch{return!1}}fetchBuilder(e){const t=this.pageRouter.routedObjectForUrl(e)||this.shelfRouter.routedObjectForUrl(e)||this.paginationRouter.routedObjectForUrl(e)
return t?t.object:null}}class V4{constructor(){this.$intentKind="GenericPageIntent"}async perform(e,t){const n=t.required(G4)
return await n.fetchPage(t,e.url,lJ)}}class H4{constructor(){this.$intentKind="GenericPageMoreIntent"}async perform(e,t){const n=t.required(G4)
return await n.fetchMoreOfPage(t,e.pageToken)}}class q4{constructor(){this.$intentKind="ShelvesIntent"}async perform(e,t){const n=t.required(G4)
return await n.fetchShelves(t,e.requests)}}class W4{constructor(){this.$intentKind="ActionIntent"}async perform(e,t){return await Fp(t,e)}}class z4{constructor(){this.$intentKind="MetricsFieldLintingIntent"}async perform(e,t){const n=$t(t).makeEvent(t,y(e.fields))
return await Promise.resolve(n)}}class Y4{constructor(){this.$intentKind="AppUpdateLockupsIntent"}async perform(e,t){const n=this.createUpdateLockups(t,e.appUpdateMetadata)
return await Promise.resolve(n)}createUpdateLockups(e,t){const n={lockupOptions:{metricsOptions:{pageInformation:li(e,UL,"Updates",""),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:1}}
return this.updatesLockupsFromData(e,t,n)}updatesLockupsFromData(e,t,n){return Iv.context("updatesLockupsFromData",()=>{const a=[]
return null==t||t.forEach((t,c)=>{var l
const u=t.updateMetadata
if(r(u.attributes))return void(n.contentUnavailable&&n.contentUnavailable(c,u))
const d=n.lockupOptions
let p=80894
if(i(n.filter)&&(p=n.filter),vt(e,u,p))return
const h=Du(e,u,d)
if(r(h)||!h.isValid())return
const w=Re(u,qe(e,u),"latestVersionInfo"),g=f(w,gR),v=f(w,NN)
h.releaseDate=new Date(v),h.installDate=t.updateInstallDate
const m=t.isUpdateAvailable||t.isUpdating?h.releaseDate:h.installDate
let y=this.timeAgoStringForDate(e,m)
o(y)&&(y=e.loc.string("UPDATES_VERSION_FORMAT").replace("{updateVersion}",g)),s(y)&&(h.subtitle=y)
const A=f(w,mP);(0,kv.isSome)(A)&&(h.whatsNew=new _q(A.trim())),h.version=g,h.size=null===(l=Ld(e,u))||void 0===l?void 0:l.fileSizeByDevice,h.externalVersionId=He(e,u,oR),a.push(h),xf(n.lockupOptions.metricsOptions.locationTracker)}),a})}timeAgoStringForDate(e,t){if((0,kv.isNothing)(t))return
const n=(new Date).getTime()-t.getTime(),r=Math.floor(n/864e5)
switch(r){case 0:return e.loc.string("LOCKUPS_TODAY")
case 1:return e.loc.string("LOCKUPS_YESTERDAY")
case 2:case 3:return e.loc.string("LOCKUPS_DAYS_AGO_FORMAT").replace("{daysAgo}",r.toString())
default:const n=Qx
return e.loc.formatDate(n,t)}}}class J4 extends hq{constructor(e,t){super(),this.title=e,this.sections=t||[],this.pageMetrics=new EW,this.pageRenderMetrics={}}}class K4 extends hq{constructor(e,t){super(),this.personalizationEnabledPage=e,this.personalizationDisabledPage=t}}class Z4 extends hq{constructor(e,t){super(),this.title=e,this.footer=t,this.contents=[]}addContentItem(e){this.contents.push(e)}}class Q4 extends hq{constructor(e){super(),this.type=e}}class X4 extends Q4{constructor(e,t,n){super(uH),this.title=e,this.action=t,this.displayType=n||EV}}class e5 extends Q4{constructor(e,t){super("infoListItem"),this.title=e,this.value=t}}class t5 extends Q4{constructor(e){super(Dj),this.text=e}}class n5 extends hq{constructor(){super(...arguments),this.links={},this.pageMetrics=new EW,this.pageRenderMetrics=null}}class r5 extends Q4{constructor(e,t){super("personalizedRecommendationsToggle"),this.title=e,this.defaultValue=t}}class o5{constructor(){this.$intentKind="AccountLinksIntent"}async perform(e,t){return Bp(t)}}class i5 extends Y1{constructor(e,t){super("AccountController"),t.exportingService("AccountData",{fetchAccountLinks:async t=>Bp(e)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class s5 extends Y1{constructor(){super("DynamicUIBuilder")}pageType(){return NL}async handlePage(e,t,n,r,o){const i=new dY(NL)
i.pageUrl=t.toString(),i.referrerUrl=t.build()
const s=new ZJ(e.bag.metricsTopic)
if(e.bag.arcadeDownloadPacksCIPDeeplinkIntegrationEnabled&&Rt(e,e.bag.arcadeDownloadPackRolloutRate)){const e=new dY(WF),t=kF
e.pageData=t,e.presentationContext=TG,s.carrierLinkSuccessAction=e}return i.pageData=s,i}pageRoute(e){const t=e.bag.dynamicUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class a5 extends Y1{constructor(){super("FinancePageBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=new dY(KU)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.financeUIRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}const c5="https://itunes.apple.com/WebObjects/MZStore.woa/wa/genericPageTemplate?pageComponent=finance_internet_eraser_page&additionalResources=p7financebootstrap"
class l5{constructor(){this.$intentKind="GenericAccountPageIntent"}async perform(e,t){return await Up(t,e.url)}}class u5{constructor(){this.$intentKind="PersonalizationTransparencyPageIntent"}async perform(e,t){return await async function(e){const t=e.required(G4),n=`${Oz}:///${_z.account}/${_z.personalizationTransparency}`
return await t.fetchPage(e,n,K4)}(t)}}class d5 extends Y1{constructor(e,t){super("PersonalizationTransparencyBuilder"),t.exportingService(Gy,{fetchGenericAccount:async t=>await Up(e,t.url)})}async handlePage(e,t,n,r,o){return await async function(e,t,n){let r,o
if(e.bag.personalizedRecommendationsToggleEnabled){o=iM
const t=await Gp(e),n=jp(e)
r=new K4(t,n)}else o=Wj,r=v(n[Hz.enabled])?await Gp(e):jp(e)
return Y1.createFlowAction(r,o,t)}(e,t,n)}pageRoute(e){return e.bag.personalizedRecommendationsToggleEnabled?[{protocol:Oz,path:`/${_z.account}/${_z.personalizationTransparency}`},{path:`${_z.personalizationTransparency}`}]:[{protocol:Oz,path:`/${_z.account}/${_z.personalizationTransparency}`,query:[Hz.enabled]},{path:`${_z.personalizationTransparency}`,query:[Hz.enabled]}]}pageType(){return Wj}}class f5 extends Y1{constructor(){super("ShowAccountPageBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){let i,s=[]
{i=BD
const e=new dY(Wj)
e.presentationContext=TG,e.animationBehavior=Mj,s=[e]}const a=new xW(i)
return a.actions=s,a}pageRoute(e){return[{hostName:"showAccountPage"},{hostName:"showPurchasesPage"}]}}class p5 extends Y1{constructor(){super("ShowSubscriptionPageBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){return new dY(KU,e.bag.manageSubscriptionsUrl)}pageRoute(e){return[{hostName:"showSubscriptionsPage"}]}}class h5 extends Y1{constructor(){super("ShowUpdatesPageBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=new xW(BD)
if(e.client.deviceType!==$H){const e=new dY(Wj)
e.presentationContext=TG,e.animationBehavior=Mj,i.actions=[e]}return i}pageRoute(e){return[{hostName:"showUpdatesPage"},{path:"updates"},{path:"{countryCode}/updates"},{query:[`${Hz.action}=updates`]}]}}class w5 extends Y1{constructor(){super("StorefrontChangeController")}async handlePage(e,t,n,r,o){const i={url:t.toString(),signingStyle:KG}
return await e.network.fetch(i),null}pageRoute(e){return[{protocol:Ez,path:`/${_z.store}/${_z.resetAndRedirect}`}]}pageType(){return TH}}class g5 extends Y1{constructor(){super("WebUIPageBuilder")}pageType(){return BL}async handlePage(e,t,n,r,o){const i=new dY(BL)
return i.pageUrl=t.toString(),i}pageRoute(e){const t=e.bag.webViewRegexStrings,n=[]
for(const e of t)n.push(new RegExp(e,"i"))
return[{regex:n}]}}class v5{constructor(){this.$intentKind="UpdateAppEventNotificationIntent"}async perform(e,t){return await qp(t,e)}}class m5 extends Y1{constructor(e,t){super("AppEventsController"),t.exportingService("AppEvents",{updateAppEventNotification:async t=>await qp(e,t)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class y5 extends Y1{constructor(){super("AppClipSubscribeBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const s=f(n[Hz.appId])
if(!i(s))throw new Error(`No adamId supplied in appClipSubscribe url: ${t}`)
const a=new wJ(e).withIdOfType(s,BH).includingAdditionalPlatforms(N(e)),c=Du(e,j(e,await Jn(e,a)),{metricsOptions:{pageInformation:new XX({}),locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:null}),l=(new oY).set(hG,Rz).set(CB,SB).path(_z.product).path(s).build(),u=new dY(Jj)
u.pageUrl=l
const d=dp(e,pe(WU),s,c.buttonAction),p=new xW(xH)
return p.actions=[u,d],p}pageRoute(e){return[{hostName:"appClipSubscribe",query:[Hz.appId,Hz.context]}]}}class A5 extends Y1{constructor(){super("ArcadeOfferRedirectHandler")}pageType(){return XV}defaultTab(e){return xH}pageRoute(e){return[{path:"arcade/offers",query:[`${Hz.offerHints}?`]},{path:"/{countryCode}/arcade/offers",query:[`${Hz.offerHints}?`]}]}async handlePage(e,t,n,r,o){var i
const s=null!==(i=n[Hz.offerHints])&&void 0!==i?i:"deeplink_hardware_firstchance",a={offerHints:s},c=new KJ(xH,pe(WU),e.bag.metricsTopic,null,a)
c.offerHints=s
const l=new dY(XU)
return l.pageData=c,l.referrerUrl=t.build(),l}}class T5 extends hq{constructor(e,t,n=null,r){super(),this.title=e,this.value=t,this.systemImageName=r,this.metricsValue=n}}T5.defaultValue="pageFacetsDefaultValue",T5.trueValue=new T5(FV,v$),T5.falseValue=new T5(v$,v$)
class b5 extends hq{constructor(e,t,n,r,o=[],i=null,s=null,a=null,c=!1,l=!1,u=!1){super(),this.id=e,this.parameterName=t,this.title=n,this.displayType=r,this.defaultOptions=i,this.options=o,this.metricsParameterName=s,this.clickAction=a,this.displayOptionsInline=c,this.showsSelectedOptions=l,this.isHiddenFromMenu=u}}class S5 extends hq{constructor(e=[],t=null){super(),this.title=t,this.facets=e}}class P5 extends hq{constructor(e,t,n){super(),this.facetGroups=e,this.allowsResetButton=t,this.resetButtonTitle=n}static isDefinedNonNullNonEmpty(e){return(0,Cv.isSome)(e)&&0!==Object.keys(e).length}}P5.requestValuesForSelectedFacetOptions=function(e){if(P5.isDefinedNonNullNonEmpty(e)){const t=e.filter(e=>P5.isDefinedNonNullNonEmpty(e.value)).map(e=>e.value).join(",").split("&"),n=t[0],r=t.splice(1),o={}
for(const e of r){const t=e.split("=")
2===t.length&&(o[t[0]]=t[1])}return{value:n,additionalKeyValuePairs:o}}return null}
const I5="-releaseDateByDay&sort=name",C5="-lastUpdatedByDay&sort=name",k5="alphabet&sort=name",O5="category&sort=-releaseDate",E5="groupBy",R5=l_,D5=hk,_5=BN,x5="filter[platform]",L5={}
let M5=!1,$5=null,F5=null,N5=null,B5=null,U5=null,G5=null,j5=null,V5=null,H5=null,q5=null,W5=null
const z5={}
z5[Hz.sort]=E5,z5[Hz.ageRating]=vk,z5[Hz.controllerSupport]=mk,z5[Hz.multiplayerSupport]=yk,z5[Hz.comingSoon]=R5,z5[Hz.binCompatGames]=x5
const Y5=Ny
class J5{constructor(){this.$intentKind="ArcadeSeeAllGamesPageIntent"}async perform(e,t){return await eh(t,e.requestDescriptor)}}class K5{constructor(){this.$intentKind="ArcadeSeeAllGamesPageMoreIntent"}async perform(e,t){return await th(t,e.pageToken)}}class Z5 extends J1{constructor(e,t){super("ArcadeSeeAllGamesPageBuilder"),this.pageSize=20,t.exportingService(d$,{fetchArcadeSeeAllGames:async t=>await eh(e,t),fetchMoreArcadeSeeAllGames:async t=>await th(e,t.pageToken)})}defaultPlatforms(e){return N(e)}defaultAttributes(e){const t=[lH,oH,Nj,Uj,tG,SG,nj]
return e.appleSilicon.isSupportEnabled&&t.push(iV),t}defaultTab(e){return xH}pageType(){return jB}pageRoute(e){return[{identifier:jB,path:`/${_z.arcadeSeeAllGames}`,query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]},{identifier:jB,hostName:`${$z}`,query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]},{path:"/{countryCode}/{platform}/arcade/see-all",query:[`${Hz.requestDescriptor}?`,`${Hz.sort}?`,`${Hz.ageRating}?`,`${Hz.controllerSupport}?`,`${Hz.multiplayerSupport}?`,`${Hz.comingSoon}?`]}]}paginationRoute(e){return[{identifier:jB,protocol:Oz,path:`/${_z.arcadeSeeAllGames}/${_z.arcadeSeeAllGamesLoadMore}`}]}shelfRoute(e){return[{protocol:Oz,path:`/${_z.arcadeSeeAllGames}/${_z.shelf}/`,query:[`${Hz.token}`]}]}generatePageRequest(e,t,n){return Iv.context("generatePageRequest",()=>{const t=nh(e,n),r=wp(e).includingAdditionalPlatforms(N(e)).includingRelationships([]).withSparseLimit(10).includingAttributes(Jp(e)).usingCustomAttributes(Ze(e))
return function(e,t){let n=!1
for(const e of Object.keys(t)){if(e===R5&&s(t[e])){const r=t[E5]
if(s(r))switch(r[0].value){case I5:case C5:t[e][0].value=_5
break
case k5:t[e][0].value=D5
break
case O5:t[e][0].value=D5,n=!0}}e===x5&&o(t[e])&&(t[e]=L5[Hz.binCompatGames].false)}n&&e.withSparseCount(4)
for(const n of Object.keys(t)){const r=P5.requestValuesForSelectedFacetOptions(t[n])
if(s(r)){s(r.value)&&e.addingQuery(n,r.value)
for(const t of Object.keys(r.additionalKeyValuePairs))e.addingQuery(t,r.additionalKeyValuePairs[t])}}}(r,s(t.selectedFacetOptions)?t.selectedFacetOptions:zp(e)),r})}async renderPage(e,t,n,o){return await rc(aG,async()=>{const o=g(t),i=nh(e,n),a=ci(e,uV,jB,o),c=function(e,t,n){return{url:oY.fromComponents(Oz,null,`/${_z.arcadeSeeAllGames}/${_z.arcadeSeeAllGamesLoadMore}`).build(),metricsPageInformation:n,metricsLocationTracker:{rootPosition:0,locationStack:[]},remainingGroups:[],lastShelfIndex:0,isCompactMode:t.isCompactMode}}(0,i,a),u=new hJ(Kp(e,l(o,"results.groups"),c))
u.title=e.loc.string(xI),u.pageFacets=function(e){Wp(e),e.featureFlags.isEnabled("see_all_games_segmented_nav_2024A")
const t=e.loc.string("PAGE_FACETS_FILTERS_AGE_RATINGS"),n=new b5(Hz.ageRating,vk,t,qF,[U5,G5,j5,V5],[U5],"age",Yp(e,Ij)),r=e.featureFlags.isEnabled("arcade_see_all_games_menu_uplift")||!1,o=new b5(Hz.sort,E5,e.loc.string(Oy),qF,[$5,F5,N5,B5],r?[$5]:null,Ij,Yp(e,Ij)),i=e.loc.string(Cy),s=new b5(Hz.controllerSupport,mk,i,D$,[H5],null,Ey,Yp(e,Ij)),a=e.loc.string("PAGE_FACETS_FILTERS_MULTIPLAYER_GAMES"),c=new b5(Hz.multiplayerSupport,yk,a,D$,[q5],null,Bj,Yp(e,Ij)),l=new b5(Hz.comingSoon,R5,e.loc.string(ky),D$,[W5],[W5],d_,Yp(e,d_))
l.isHiddenFromMenu=r
const u=new P5([],!1,null)
switch(e.client.deviceType){case $H:u.facetGroups.push(new S5([n])),e.bag.enableComingSoonToggle&&u.facetGroups.push(new S5([l],e.loc.string(Ry))),u.facetGroups.push(new S5([s,c],e.loc.string("PAGE_FACETS_SUPPORTS_TITLE"))),u.facetGroups.push(new S5([o]))
break
case"tv":u.facetGroups.push(new S5([n],e.loc.string("PAGE_FACETS_AGE_RATINGS_TITLE_LOWERCASE")))
const t=[s,c]
e.bag.enableComingSoonToggle&&t.push(l),u.facetGroups.push(new S5(t,e.loc.string("PAGE_FACETS_FILTERS_TITLE"))),u.facetGroups.push(new S5([o],e.loc.string("PAGE_FACETS_SORT_BY_TITLE_LOWERCASE")))
break
default:o.displayOptionsInline=!0,u.facetGroups.push(new S5([o],e.loc.string(Oy))),n.showsSelectedOptions=!0,u.facetGroups.push(new S5([s,c,n],e.loc.string("PAGE_FACETS_FILTER_BY_TITLE"))),e.bag.enableComingSoonToggle&&u.facetGroups.push(new S5([l],e.loc.string(Ry)))}return u}(e),u.selectedFacetOptions=s(i.selectedFacetOptions)?i.selectedFacetOptions:zp(e),u.pageSegments=[],ui(e,u,a)
const d=u.pageMetrics.instructions
if(!r(d))for(const e of d)e.data.includingFields.push(kb)
return c.remainingGroups.length>0&&(u.nextPage=c),u})}generatePaginationRequest(e,t,n,r){const o=g(r)
let i=[],s=20,a=!0
for(const e of o.remainingGroups)a=a&&(e.data.length<s||0===i.length),a&&(i=i.concat(e.data),s-=e.data.length)
return new wJ(e,i).includingAdditionalPlatforms(N(e)).includingAttributes(Jp(e)).usingCustomAttributes(Ze(e))}async renderPaginatedPage(e,t,n){const r=g(n),o=[]
let i=20
const a={}
for(const e of t.data)a[e.id]=e
let c=!0
for(const e of r.remainingGroups){if(c=c&&(e.data.length<i||0===o.length),c){for(let t=0;t<e.data.length;t++){const n=a[e.data[t].id]
s(n)&&(e.data[t]=n)}i-=e.data.length}o.push(e)}r.remainingGroups=[]
const l=Kp(e,o,r),u=new hJ(l)
return u.title=e.loc.string(xI),r.remainingGroups.length>0&&(u.nextPage=r),u}generateShelfRequest(e,t,n){const r=g(JSON.parse(n[$G])).remainingContent.slice(0,20),o=new wJ(e,r).includingAdditionalPlatforms(N(e)).includingAttributes(Jp(e)).usingCustomAttributes(Ze(e))
return st(e,o,r),o}async renderShelf(e,t,n){const r=g(JSON.parse(n[$G]))
return r.remainingContent=t.data.concat(r.remainingContent.slice(20,r.remainingContent.length)),r.isFirstRender=!1,Zp(e,r)}}class Q5{constructor(){this.$intentKind="ArcadeSubscribePageIntent"}async perform(e,t){return await rh(t,e.url)}}class X5 extends J1{constructor(e,t){super("ArcadeSubscribeBuilder"),t.exportingService(d$,{fetchSubscribePage:async t=>await rh(e,t.url)})}defaultPlatforms(e){return N(e)}defaultTab(e){return xH}defaultAttributes(e){const t=[lH,Nj,Uj]
return e.appleSilicon.isSupportEnabled&&t.push(iV),t}pageType(){return kk}pageRoute(e){return[{hostName:"arcadeSubscribePageCustomContext",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{hostName:`${Mz}`,query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.subscribePageMessage}?`,`${Hz.askToBuyId}?`,`${Hz.editorialItem}?`,`${Hz.includePostSubscribeAttribution}?`]}]}generatePageRequest(e,t,n){return vp(e,this.marketingItemContextFromParameters(n),f(n,Hz.appId)).attributingTo(t.build())}async renderPage(e,t,n,o){var a
const c=o[X5.contextualAppRequirementKey]
let u=null
s(c)&&(u=j(e,c))
const d=l(t,XC).map(e=>y(e)),p=e.arcade.getMarketingItemFromMarketingItems(d),h=p,w=La(e,h,0,!1,!1,f_),g=this.marketingItemContextFromParameters(n),m=e.client.isPhone,A=g===pe(OD),T=new vq(xH,e.bag.arcadeAppAdamId,null,rG,null,A&&m?"arcadeLaunchRepairCompactSheet":LI,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
T.titles[oB]=e.loc.string(pN,hN)
const b=f(n,Hz.appId),S=function(e,t,n,r){var o
const s=ci(e,"Upsell",n,r)
return i(r)&&(s.mercuryMetricsData=null!==(o=Sf(0,r))&&void 0!==o?o:void 0),s}(e,0,h.id,h)
S.offerType=Ak,S.baseFields.upsellType=this.metricsUpsellType(g),S.baseFields.subscriptionSKU=e.bag.arcadeProductId
const P={pageInformation:S,locationTracker:{rootPosition:0,locationStack:[]}},I=$a(e,{marketingItemData:p},_a(0,h),P,!1)
if(!(I instanceof az))throw new Error("Only buy actions are supported on the upsell page")
const C=new WJ(w,e.loc.string(_y),I,T)
let k
C.askToBuyMessage=f(n,Hz.subscribePageMessage),C.askToBuyId=f(n,Hz.askToBuyId),ui(e,C,S)
let O=!1
if(s(u)){C.primaryIcon=rd(e,u,P,{useCase:3})
const t=se(u,VV),r=rp(e,u,P)
r.excludeAttribution=!v(n[Hz.includePostSubscribeAttribution]),k=Kt(e,u,sH,g,t,r),O=!0}if(!v(n[Hz.includePostSubscribeAttribution])){const e=C.pageMetrics.instructions
if(!r(e))for(const t of e)t.data.includingFields.push(gx)}let E=[]
const R=o[X5.contextualIconsRequirementKey]
if(s(R)&&(E=q(R)),i(p)&&(E=Ae(p,FH)),s(E)){const t=[]
for(const n of E)if(n.id===b){if(!O){C.primaryIcon=rd(e,n,P,{useCase:3})
const t=se(u,VV),r=rp(e,n,P)
k=Kt(e,n,sH,g,t,r)}}else t.push(rd(e,n,P,{useCase:2}))
C.icons=t}return i(k)&&(I.postSubscribeAction=k),A&&i(b)&&(C.openAppAction=new VW(b)),s(C.icons)||i(C.primaryIcon)||(C.artwork=this.genericArtworkFromData(e,h)),A&&(C.singleIcon=C.primaryIcon,(null===(a=C.singleIcon)||void 0===a?void 0:a.art)&&(C.singleIcon.art.contentMode=Ov.scaleAspectFit)),C.subscribedOfferButtonAction=new xW(xH),C}genericArtworkFromData(e,t){if(!i(t))return null
const n=e.client.isPhone,r=function(e,t,n){const r=function(e,t){return Ia(e,t)}(e,t)
return h(r,n)}(e,t,n?vT:OO)
if(!s(r))return null
let o=null,a=p(r,gU)
return n?(o="of",a=a-296-1602):(o="og",a=a-344-772),nd(e,r,{cropCode:o,allowingTransparency:!0,useCase:7,overrideHeight:a})}metricsUpsellType(e){return i(e)?e:pe(WU)}marketingItemContextFromParameters(e){let t=f(e,Hz.context)
const n=f(e,Hz.askToBuyId)
switch(o(t)&&s(n)&&(t=kD),t){case OD:return pe(OD)
case kD:return pe(kD)
default:return t}}}X5.contextualIconsRequirementKey="contextualIconsRequirement",X5.contextualAppRequirementKey="contextualPrimaryIconRequirement"
const e6="amdImpressionData"
class t6 extends J1{constructor(e=null){super(e||"AbstractGroupingPageController")}generateAdditionalPageRequirements(e,t,n){var r
const o=super.generateAdditionalPageRequirements(e,t,n),i=e.amsEngagement
if(!i||!Fo(e))return o
const s=[mV,BH,xH],a=null===(r=e.bag.tabsStandard.find(e=>e.url===t.toString()))||void 0===r?void 0:r.id
if(!s.includes(a))return o
const c={timeout:1e3,eventType:YX,tab:a}
return o[e6]=R(i.performRequest(c)),o}async renderPage(e,t,n,r,o,s){return await rc(mT,async()=>{const a=function(e,t){const n=j(e,t)
return n&&ge(n,RU)?Ac(e,n):null}(e,t),c=function(e,t,n){const r=j(e,t)
if((0,Cv.isNothing)(r))return null
const o=ci(e,IO,r.id,t),s=fo(e)
return o.recoMetricsData=Pf(o.recoMetricsData,null,s),{shelves:[],metricsPageInformation:o,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:ie(r,"id"),pageGenreId:null,hasAuthenticatedUser:i(e.user.dsid),refreshController:tr(t),recoImpressionData:$o(0,null==n?void 0:n[e6])}}(e,t,r)
return(0,Cv.isNothing)(a)||(0,Cv.isNothing)(c)?null:this.renderGroupingPage(e,a,c,n,r,o,s)})}}class n6{constructor(){this.$intentKind="ArcadePageIntent"}async perform(e,t){return await ih(t,e)}}class r6 extends t6{constructor(e,t){super("ArcadePageBuilder"),t.exportingService(d$,{fetchPage:async t=>await ih(e,t)})}defaultPlatforms(e){return N(e)}defaultAttributes(e){const t=[lH,Nj,Uj,JN]
return e.appleSilicon.isSupportEnabled&&t.push(iV),t}pageType(){return xH}pageRoute(e){return[{protocol:Ez,path:`/${_z.store}/${_z.grouping}`,query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`,Hz.id]},{hostName:xz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.grouping}`,query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`,Hz.id,`${Hz.useReleaseId}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]},{protocol:Ez,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]},{protocol:Ez,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}",query:[Hz.isArcade,`${Hz.isTrialAvailable}?`,`${Hz.isTrialEnrolled}?`,`${Hz.isSubscribed}?`]}]}generatePageRequest(e,t,n){const r=n[Hz.id],o=v(n[Hz.isSubscribed]),s=v(n[Hz.isTrialEnrolled])
if(!a(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
const c=[lH,oH,Nj,Uj,nj,ZB]
e.appleSilicon.isSupportEnabled&&c.push(iV),e.bag.enableUpdatedAgeRatings&&c.push(zj),ad(e)&&c.push(Zj)
let l=new wJ(e).includingAgeRestrictions().includingAttributes(c).includingMacOSCompatibleIOSAppsWhenSupported()
$i(e)&&(l.enablingFeature(PV),l.includingScopedAttributes(DH,eQ),l.includingScopedRelationships(DH,[SH])),Fi(e)&&(l.enablingFeature(Y_),ar(l)),Ni(e)&&(l.enablingFeature(cN),lr(l))
const u=U(e)
if(i(u)&&l.addingQuery(hU,u),o){const t=!0,n=Rt(e,e.bag.arcadeTrialEnrolledStateRate)
t&&s&&n?l.addingQuery(RU,"trial-enrolled"):l.addingQuery(RU,"subscriber")}else l.addingQuery(RU,"nonsubscriber"),l.includingRelationshipsForUpsell(!1)
l.withIdOfType(r,pj)
const d=t.query[Hz.useReleaseId]
return Vz.has(t.host)&&(null==d?void 0:d.length)>0&&(l=l.addingQuery(MI,d),l.isStorePreviewRequest=!0),l.enablingFeature(PO),l.enablingFeature(hT),l.withSparseCount($(e)),l.includingScopedSparseLimit(aN,F(e)),l.attributingTo(t.build())}renderGroupingPage(e,t,n,r,i,a,c){return Iv.context(aG,()=>{const i=v(r[Hz.isSubscribed]),c=v(r[Hz.isTrialAvailable]),l=v(r[Hz.isTrialEnrolled]),u={}
u[Hz.isArcade]="true",u[Hz.isSubscribed]=`${i}`,u[Hz.isTrialAvailable]=`${c}`,u[Hz.isTrialEnrolled]=`${l}`,n.additionalShelfParameters=u,n.isArcadePage=!0,n.metricsPageInformation.isCrossfireReferralCandidate=!0
let d=null,f=null
if(!i){const r=mp(e,t.originalGroupingData)
if(r)d=r.marketingItemData
else if(a){Iv.unexpectedNull(dV,$I,"relationships.upsell")
const e=yp(0,a.get(wD))
e&&(d=e.marketingItemData)}if(s(d)&&s(d.attributes)){const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,mercuryMetricsData:Sf(0,d)}
f=Da(e,d,t),s(n)&&o(n.pageTitleEffect)&&0===n.shelves.length&&(n.pageTitleEffect=function(e,t){const n=ya(e,t,!0),r=ma(e,t)
return Ea(0,n.artworkData||r.artworkData,!0)}(e,d)),xf(n.metricsLocationTracker)}}const p=r6.insertUpsellBreakoutShelfIntoParseContextIfNecessary(f,i,n)
mc(e,t,n)
const h=new pJ(n.shelves)
ui(e,h,n.metricsPageInformation),h.tabTitle=ie(t.originalGroupingData,GH)
const w=ie(t.originalGroupingData,GH)
e.host.clientIdentifier,p||(h.title=w)
const g=new $q(ej)
g.color=Z("primaryText"),g.isFallbackStyle=!0,e.clientCapabilities.isEnabled("arcadeStandardLargeTitle")?h.presentationOptions=[J_]:h.presentationOptions=[]
let m=!1
if(n.shelves.length>0){const e=n.shelves[0].contentType===AM,t=n.shelves[0].contentType===VB,r=n.shelves[0].contentType===BU
m=e||t||r}if(m&&(h.presentationOptions.push(J$),h.titleEffect=n.pageTitleEffect||g),!i&&s(f)){h.subscriptionOfferAction=r6.createSubscribeAction(e,f,{id:null,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:NH}),h.subscriptionOfferDisplayProperties=new vq(xH,e.bag.arcadeAppAdamId,null,rG,null,xH,null,null,null,null,null,null,null,null,null,null,null,null,e.bag.arcadeProductFamilyId)
const t={pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},r={marketingItemData:d}
h.subscriptionLockup=Bu(e,r,t,pe(CN),rG,AO)}const y={id:"arcade-see-all-games-footer",presentationHints:{},featuredContentId:-1,featuredContentData:null,nativeGroupingShelfId:1,metricsPageInformation:n.metricsPageInformation,metricsLocationTracker:n.metricsLocationTracker,pageGenreId:n.pageGenreId,title:null,shouldFilter:!1,remainingItems:[],isFirstRender:!0,isDeferring:!1,showOrdinals:!1,hasExistingContent:!1,showingPlaceholders:!1,ordinalIndex:1,isSearchLandingPage:n.isSearchLandingPage,isArcadePage:null==n?void 0:n.isArcadePage}
if(this.insertUnifiedMessageShelves(e,h),h.shelves.length>0){const t=r6.groupingArcadeFooterShelfController.createShelf(e,null,n,y,null)
h.shelves.push(t)}if(0===h.shelves.length)throw new Error(`Missing content for Arcade grouping ${JSON.stringify(r)}`)
return h.autoUpsellAction=dp(e,pe(WU),null,null),oh(h),h})}static insertUpsellBreakoutShelfIntoParseContextIfNecessary(e,t,n){return Iv.context("insertShelfForUpsellBreakoutIfNecessary",()=>{if(o(e))return t||Iv.unexpectedNull(Qj,$I,VB),!1
const r=new oJ(VB)
return r.items=[e],r.presentationHints={isFirstShelf:!0},n.shelves.push(r),!0})}static createSubscribeAction(e,t,n){if(o(t))return null
{const r=dp(e,pe(DC),null,null,n)
return r.title=t.offerButtonAction.title,r}}createTermsAndConditionsShelf(e){return!r(e.bag.termsAndConditionsURL)&&e.client.deviceType,null}supportsDataAugmenting(){return!0}additionalDataKeysNeededForData(e,t,n){if(r(n))return null
const o=j(e,t),i=v(n.parameters[Hz.isSubscribed]),s=mp(e,o)
return!i&&r(s)?new Set([wD]):null}fetchAdditionalDataForKey(e,t){return Iv.context("fetchAdditionalDataForKey",async()=>{let n
return t===wD&&(n=vp(e,pe(CN)),Iv.unexpectedNull(Qj,XG,"upsellRecovery.marketingItem")),r(n)?null:await Jn(e,n).catch(()=>null)})}insertUnifiedMessageShelves(e,t){t.shelves.length<=0||(t.shelves.splice(1,0,Sc(0,"arcadePageHeader")),t.shelves.splice(6,0,Sc(0,"arcadePageMid")),t.shelves.push(Sc(0,"arcadePageFooter")))}}r6.groupingArcadeFooterShelfController=new A1
const o6={width:1680,height:3636,url:"https://is3-ssl.mzstatic.com/image/thumb/Features123/v4/9a/d4/48/9ad448b5-ddbb-f295-fae3-2a2e69bf5604/source/{w}x{h}{c}.{f}",bgColor:Dy,textColor1:"f7c981",textColor2:"f8a710",textColor3:"c6a067",textColor4:"c6850d"},i6={width:4320,height:3240,url:"https://is3-ssl.mzstatic.com/image/thumb/Features124/v4/57/71/7f/57717f8b-c486-4faf-7558-a4f88186855d/source/{w}x{h}{c}.{f}",bgColor:Dy,textColor1:"fdc97a",textColor2:"f73a03",textColor3:"caa161",textColor4:"c52e02"}
class s6{constructor(){this.$intentKind="ArcadeWelcomePageIntent"}async perform(e,t){return await ah(t,e.url)}}class a6 extends Y1{constructor(e,t){super("ArcadeWelcomeBuilder"),t.exportingService(d$,{fetchArcadeWelcomePage:async t=>await ah(e,t.url)})}pageType(){return"arcadeWelcome"}async handlePage(e,t,n,r,o){const i=await this.generatePage(e,n,r)
return Y1.createFlowAction(i,this.pageType(),t)}pageRoute(e){return[{hostName:"arcadeWelcomePage",query:[`${Hz.context}?`]}]}async generatePage(e,t,n){return function(e,t){return function(e,t){const n={rootPosition:0,locationStack:[]},r=function(e,t){if(he(t)){const t=new lz
return t.title=e.loc.string("ARCADE_WELCOME_TV_CONTINUE_BUTTON"),t}return sh(0,e.loc.string("ARCADE_WELCOME_CONTINUE_BUTTON"))}(e,t)
sp(e,r,{id:"arcade-welcome-continue",actionType:UH,pageInformation:new XX,locationTracker:n,targetType:NH})
const o=function(e,t){return he(t)?sh(0,e.loc.string(bk)):null}(e,t)
o&&sp(e,o,{id:"arcade-welcome-create-family",actionType:UH,pageInformation:new XX,locationTracker:n,targetType:NH})
let i=o6,s="oe"
e.client.isPad&&(i=i6,s="og")
const a=new YJ(e.loc.string("ARCADE_WELCOME_INDIVIDUAL_TITLE"),e.loc.string("Arcade.Welcome.Family.Description"),[new zJ(null,null,nd(e,i,{useCase:24,cropCode:s}))],r,o)
if(he(t)){a.nonDismissingContinueAction=sh(0,e.loc.string(bk)),r.title=a.nonDismissingContinueAction.title
const t=new lz
t.title=e.loc.string(_y),a.dismissingFamilyAction=t,o.title=a.dismissingFamilyAction.title}else a.nonDismissingContinueAction=sh(0,e.loc.string(bk)),r.title=a.nonDismissingContinueAction.title
return new JJ(a,a)}(e,t)}(e,t[Hz.context])}}class c6 extends Y1{constructor(){super("FamilyCircleBuilder")}pageType(){return TH}defaultTab(e){return xH}async handlePage(e,t,n,r,o){var i
const s=new xW(xH),a=null!==(i=t.query[vG])&&void 0!==i?i:iy,c=new cz(HV,a,t.query)
return s.actions.push(c),s}pageRoute(e){return[{hostName:`${Fz}`},{path:`${Fz}`}]}}class l6{constructor(){this.$intentKind="ArcadeUpsellGridIntent"}async perform(e,t){return await ch(t,e.contentDictionary)}}class u6 extends Y1{constructor(e,t){super("MarketingItemUpsellBuilder"),t.exportingService(d$,{fetchUpsellGrid:async t=>await ch(e,t.contentDictionary)})}pageType(){return XU}pageRoute(e){return[{hostName:`${Mz}`,query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`],exclusions:[{query:[`${Hz.askToBuyId}`]}]},{path:"arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`]},{path:"{countryCode}/arcade/subscribe",query:[`${Hz.appId}?`,`${Hz.context}?`,`${Hz.includePostSubscribeAttribution}?`]}]}async handlePage(e,t,n,r,o){var i
const s=pe(f(n,Hz.context)),a=f(n,Hz.appId),c=new KJ(xH,s,e.bag.metricsTopic,a),l=new dY(XU),u=null===(i=e.metricsIdentifiersCache)||void 0===i?void 0:i.getMetricsFieldsForTypes([xv.user,xv.client,xv.canonical])
return(0,kv.isSome)(u)&&(c.metricsOverlay={...c.metricsOverlay,...u}),l.pageData=c,l}}class d6{constructor(){this.$intentKind="ArcadeSubscriptionDecorationIntent"}async perform(e,t){return await lh(t,e.json)}}class f6 extends Y1{constructor(e,t){super("ArcadePurchaseDecorationController"),t.exportingService(qI,{decorateArcadePurchase:async t=>await lh(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class p6{constructor(){this.$intentKind="PersonalizedOfferContextIntent"}async perform(e,t){return await uh(t,e.offerToken)}}class h6 extends Y1{constructor(e,t){super("CompleteCollectionController"),t.exportingService("CMCPersonalizationData",{fetchPersonalizedOfferContext:async t=>await uh(e,t.offerToken)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class w6{constructor(){this.$intentKind="PurchaseDecorationIntent"}async perform(e,t){return await dh(t,e.json)}}class g6{constructor(){this.$intentKind="PurchasesDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await dh(t,r))
return n}}class v6{constructor(){this.$intentKind="BatchPurchaseDecorationIntent"}async perform(e,t){const n=[]
for(const r of e.json)n.push(await dh(t,r))
const r=n.map(e=>e.buyParams),[o,i]=function(e){const t=[]
for(const n of e)t.push(new sK(n).toRawMap())
const n=function(e){if(0===e.length)return{}
const t={},n=e[0]
for(const r of Object.keys(n)){let o=!0
for(let t=1;t<e.length;t++)if(e[t][r]!==n[r]){o=!1
break}o&&(t[r]=n[r])}return t}(t)
for(const e of t)for(const t of Object.keys(n))delete e[t]
return[t,n]}(r),s=[]
for(let e=0;e<n.length;e++)s.push(new iK(n[e],o[e]))
return new oK(s,i)}}class m6 extends Y1{constructor(e,t){super("PurchaseDecorationController"),t.exportingService(qI,{decoratePurchase:async t=>await dh(e,t.intent)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class y6{constructor(){this.$intentKind="IconArtworkIntent"}async perform(e,t){return await fh(t,e.adamIds)}}class A6 extends Y1{constructor(e,t){super("IconLookupController"),t.exportingService("ContentData",{fetchIconArtwork:async t=>await fh(e,t.adamIds)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class T6 extends Y1{constructor(){super("ContentLink")}pageType(){return jH}async handlePage(e,t,n,o,s){if(r(f(n,Hz.path)))throw new Error(`Unhandled search url: ${t}`)
const a=await x(e.network.fetch({url:t.build(),method:EF}))
if(!a.success)throw new Error(`Unhandled search url: ${t}`)
const c=a.value
if(this.hasGotoURLInResponse(e,c))return new lz
if(i(c.url))return await e.required(G4).fetchAction(e,c.url,s)
throw new Error(`Unhandled search url: ${t}`)}pageRoute(e){return[{hostName:"search.itunes.apple.com",path:"WebObjects/MZContentLink.woa/wa/link",query:[Hz.path]}]}hasGotoURLInResponse(e,t){const n=t.body
if((0,kv.isNothing)(n)||0===n.length)return!1
try{const t=m(e.plist.parse(n)),r=f(t,Rk),o=f(t,Dk)
return!!(r===_k&&(0,kv.isSome)(o)&&o.length>0)}catch{return!1}}}class b6 extends Y1{constructor(){super("ExperimentLink")}pageType(){return TH}async handlePage(e,t,n,r,o){const i={url:t.toString()},s=await x(e.network.fetch(i))
if(!s.success)throw s.error
const a=s.value
if(a.status>=200&&a.status<300){const e=new tz(sH)
return e.title="You have been enrolled in the AB test",e.message=`Test ${t.query.ab2} is now active on your device.`,e.buttonTitles=["OK"],e.buttonActions=[new xW(pV)],e}throw new Error(`unexpected response status: ${a.status} from ${a.url}`)}pageRoute(e){return[{protocol:Ez,hostName:"xp.apple.com",path:"register",query:["ab2"]}]}}class S6{constructor(e,t){e&&(this.appStoreClientRequestId=t,this.iAdId=e[oU],this.requestData=e.dataBlob,this.routingInfo=e.iAdRoutingInfo,this.canary=e.canary)}validAdRequest(){const e=(0,kv.isSome)(this.requestData)&&this.requestData.length>0,t=(0,kv.isSome)(this.routingInfo)&&this.routingInfo.length>0
return e&&t}}const P6=["UI1_3x2"],I6=[["TEXT"],["LV1","LI1"],["PI4","PI3","PI2","PI1","PV4","PV3","PV2","PV1"],P6],C6=[BH,RR]
class k6 extends Y1{constructor(){super("FallbackActionBuilder")}async handlePage(e,t,n,i,s){return await async function(e,t,n,i){var s
const a=t.query[EV]
switch(a){case Wj:const n=new dY(KU)
n.presentationContext=TG,n.animationBehavior=EN
const c=t.query[ND]
return c?n.pageUrl=c:t.query[Um]?n.pageUrl=oY.fromComponents(null,a,null,{continuation:t.query[Um]}).toString():n.pageUrl=a,await Promise.resolve(n)
case Gm:const l=new dY(KU)
return l.presentationContext=TG,l.animationBehavior=EN,l.pageUrl=function(e){let t=e.bag.createAccountUrl
return(r(t)||typeof t!==gH)&&(t=qC),new oY(t)}(e).build(),await Promise.resolve(l)
case LL:let u,d=[]
{u=BD
const e=new dY(Wj)
e.presentationContext=TG,e.animationBehavior=Mj
const t=new dY(jm)
t.animationBehavior=Mj,d=[e,t]}const f=new xW(u)
return f.actions=d,await Promise.resolve(f)
case UD:const p=t.query[ND]
if(p.length>0){const t={url:p,signingStyle:KG}
return e.network.fetch(t),await Promise.resolve(new lz)}return await Promise.reject(new Error("Original url is missing when creating deep-link for checkForPreorders."))
case T$:const h=new dY(KU)
h.presentationContext=TG,h.animationBehavior=EN
const w=new oY(a)
return t.query[RF]&&t.query[RF].length>0&&w.param(Hz.code,t.query[RF]),h.pageUrl=w.build(),await Promise.resolve(h)
case b$:const g=new dY(KU)
return g.presentationContext=TG,g.animationBehavior=EN,g.pageUrl=a,await Promise.resolve(g)
case Vm:const v=new dY(KU)
return v.presentationContext=TG,v.animationBehavior=EN,v.pageUrl="charity",await Promise.resolve(v)
case JV:let m=t.query[RN]
if(m||(m=null!==(s=t.query.q)&&void 0!==s?s:t.query[HC]),m&&m.length>0){const t=m
if(m=m.replace(/\+/g," ").trim(),t.endsWith("+")&&m.length>0&&(m+="+"),o(m))return await Promise.reject(new Error("Empty search term."))
const n=at(e,wh(e,{term:m,origin:DF})).toString(),r=new gZ(m,m,n,DF,null,null,null,i)
lp(e,r,NH,{rootPosition:0,locationStack:[]})
{const e=new dY(JV)
return e.pageData=r,await Promise.resolve(e)}}{const e=new xW(JV)
return await Promise.resolve(e)}}return await Promise.reject(new Error(`FlowAction was not able to be created for this action URL: ${t}`))}(e,t,0,s)}pageRoute(e){return[{query:[`${Hz.action}=account`]},{query:[`${Hz.action}=signup`]},{query:[`${Hz.action}=purchased`]},{query:[`${Hz.action}=checkForPreorders`]},{query:[`${Hz.action}=redeem`]},{query:[`${Hz.action}=gift`]},{query:[`${Hz.action}=donate`]},{query:[`${Hz.action}=search`]}]}pageType(){return TH}}class O6 extends Y1{constructor(){super("GameCenterProfileLinkController")}defaultTab(e){return xH}pageType(){return TH}async handlePage(e,t,n,r,o){let i=!1
if(e.host.clientIdentifier===Xq)i=!0
else for(const t of e.bag.tabsStandard)if("ocelot"===f(t,"id")){i=!0
break}const s=new xW(i?xH:mV),a=n[Hz.id]||"GameCenter.localPlayer"
return s.actions.push(new pz(a)),s}pageRoute(e){return[{identifier:WI,path:`/${_z.gameCenterProfile}`,query:[`${Hz.id}?`]}]}}class E6 extends Y1{constructor(){super("LibraryLink")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=`https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewGenre?id=${t.query.g}&mt=8`
return await e.required(G4).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${Hz.action}=library-link`]}]}}class R6 extends Y1{constructor(){super("HiddenPurchasesLinkController")}pageType(){return Ok}async handlePage(e,t,n,r,o){const i=new dY(Ok)
return i.presentationContext=HD,i}pageRoute(e){const t=[]
return t.push({hostName:"showHiddenPurchases"}),t}}class D6 extends Y1{constructor(){super("LongUrlBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const a=t.query[ND]
if((0,kv.isNothing)(a)||0===a.length)throw new Error("Original url is missing when creating deep-link for checkForLongUrl.")
const c=await x(e.network.fetch({url:a,method:EF,signingStyle:KG}))
if(!c.success)throw new Error(`Unable to fetch long url: ${a}`)
const l=c.value
let u
const d=l.headers["Content-Type"]
if(l.ok&&l.redirected&&i(l.url))u=l.url
else{if(l.ok&&a!==l.url)return e.console.log(`[LongUrlBuilder] Url redirect was already processed. Original url: ${a}. Redirected url: ${l.url}`),new lz
if(l.ok&&s(d)&&-1!==d.toLowerCase().indexOf("text/xml")){const t=m(e.plist.parse(l.body)),n=f(t,Rk),r=f(t,Dk)
n===_k&&r&&(u=r)}}if((null==u?void 0:u.length)>0)return await e.required(G4).fetchAction(e,u,o)
throw new Error(`Unable to map long url for: ${a}`)}pageRoute(e){return[{query:[`${Hz.action}=checkForLongUrl`]}]}}class _6 extends Y1{constructor(){super("MultiplexingBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=new wJ(e).withIdOfType(n.id,vL)
return await Jn(e,i).then(async t=>await this.actionFromMultiplexResponse(e,t))}pageRoute(e){return[{protocol:Ez,path:"WebObjects/MZStore.woa/wa/viewFeature",query:[Hz.id]}]}async actionFromMultiplexResponse(e,t){const n=h(t,"results.target"),r=h(t,"results.target-link")
return n?await this.targetDataToAction(e,n):r?await this.targetLinkDataToAction(r):null}async targetDataToAction(e,t){const n=f(t,eU)
if(!n)return null
const r=Er(e,n)
return await e.required(G4).fetchAction(e,r,null)}async targetLinkDataToAction(e){const t=f(e,AH),n=new oY(t),r=this.addProtocolToURLIfNeeded(n).toString()
return await Promise.resolve(new MW(r,!1))}addProtocolToURLIfNeeded(e){return e.protocol||(e.protocol=vD),e}}class x6 extends Y1{constructor(){super("NotificationSettingsLinkController")}pageType(){return TH}async handlePage(e,t,n,r,o){return new dY(By)}pageRoute(e){const t=[]
return t.push({path:"notifications/settings"}),t}}class L6 extends Y1{constructor(){super("TabSelectionBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=t.pathComponents(),s=i.length-1
let a,c
return a=s>=0?i[s]:t.query[EV],null!=a&&this.currentDeviceSupportsUrlAction(e,a)&&(c=new xW(a),c.popToRoot=t.query.popToRoot===FV),void 0===c&&(c=new xW(PH)),c}pageRoute(e){const t=[PH,"home",mV,BH,sU,jU,a$,c$,l$,_F,xH,PB],n=[]
for(const e of t){const t=`${Hz.action}=${e}`,r=`${e}`
n.push({query:[t]}),n.push({path:r}),n.push({path:`{countryCode}/${r}`})}return n.push({path:"{countryCode}/ipad"}),n.push({path:"{countryCode}/iphone"}),L6.supportedIOSTabs.forEach(e=>{n.push({path:`{countryCode}/ipad/${e}`}),n.push({path:`{countryCode}/iphone/${e}`})}),n}currentDeviceSupportsUrlAction(e,t){return!!L6.supportedIOSTabs.includes(t)}}L6.supportedMacTabs=[sU,xH,jU,a$,c$,l$,_F,JV],L6.supportedIOSTabs=[PH,BH,mV,xH,JV],L6.supportedTvTabs=[sU,BH,mV,xH,JV],L6.supportedVisionOSTabs=[PB,xH,JV]
class M6 extends Y1{constructor(){super("PassbookBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){const i=this.assemblePassbookRoomURL(e,t).build()
return await e.required(G4).fetchAction(e,i,o)}pageRoute(e){return[{query:[`${Hz.action}=passbook`]}]}assemblePassbookRoomURL(e,t){let n=e.bag.passbookMainURL
return null!=n&&typeof n===gH||(n="https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewFeature?id=717384713&mt=8"),new oY(n)}}class $6 extends Y1{constructor(){super("WatchCategoryBuilder")}pageType(){return TH}async handlePage(e,t,n,r,o){if(e.client.deviceType!==RH)throw new Error(`Unsupported url for current platform: ${t}`)
const i=e.bag.watchAppsGroupingURL,s=await x(e.required(G4).fetchAction(e,i,o))
if(!s.success)throw s.error
const a=s.value,c=new xW(BH)
return c.actions=[a],c}pageRoute(e){return[{query:[`${Hz.action}=watchCategory`]}]}}class F6 extends Z1{}const N6=[gG,kj,IH,YB,W$],B6=[gG,kj,z$,IH,JB,oN,qN,WN],U6=[gG,Y$,kj,JB],G6=[gG,z$,IH,JB,YB,kj,Y$,WN,qN,oN]
class j6{}class V6 extends Y1{constructor(){super("DeveloperBuilder")}async handlePage(e,t,n,r,o){const i=function(e,t){const n=Rr(t)
if(!a(n))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return mr(e,new wJ(e).withIdOfType(t,_G))}(e,n)}(e,t)
return await Jn(e,i).then(t=>vh(e,t)).then(e=>Y1.createFlowAction(e,jH,t))}pageRoute(e){return[{protocol:Ez,path:`/${_z.developer}/{id}`},{protocol:Ez,path:`/${_z.developer}/{developerName}/{id}`},{protocol:Ez,path:`/{countryCode}/${_z.developer}/{developerName}/{id}`},{protocol:Ez,path:`/{countryCode}/${_z.artist}/{developerName}/{id}`},{protocol:Ez,path:`/${_z.store}/${_z.viewArtist}`,query:[Hz.id,`${Hz.v0}?`]}]}async handleShelf(e,t,n,r){const i=n[$G],s=JSON.parse(i),a=new wJ(e,s.remainingData).includingAdditionalPlatforms(N(e)).includingAttributes(vr(e)).includingMacOSCompatibleIOSAppsWhenSupported()
return function(e,t,n){const r=Th(e,n.title,n.developerId,V(t),n.relationship,n.contentType,n.lockupListOptions,n.lockupListOptions.lockupOptions.metricsOptions.pageInformation,n.lockupListOptions.lockupOptions.metricsOptions.locationTracker,n.roomUrl,(0,kv.isSome)(n.roomUrl))
return r.mergeWhenFetched=!0,!n.hasExistingContent&&o(r.items)&&(r.isHidden=!0),r}(e,await Jn(e,a),s)}shelfRoute(e){return[{protocol:Oz,path:`/${_z.developer}/${_z.shelf}/{token}`}]}pageType(){return jH}}class H6 extends Y1{constructor(){super("DeveloperHrefBuilder")}async handlePage(e,t,n,r,o){const i=n[Hz.href],s=function(e,t){return mr(e,new wJ(e,t))}(e,i)
return await Jn(e,s).then(t=>vh(e,t)).then(e=>Y1.createFlowAction(e,jH,t))}pageRoute(e){return[{protocol:Oz,path:`/${_z.developer}/${_z.href}`,query:[Hz.href]}]}pageType(){return jH}}class q6 extends Q1{constructor(){super("DeveloperRoomBuilder")}pageRoute(e){return[{protocol:Oz,path:`/${_z.developer}/${_z.room}/{token}`}]}paginationRoute(e){return[{protocol:Oz,path:`${this.paginationPath}`,query:[`${Hz.token}`]}]}generatePageRequest(e,t,n){const o=n[$G],i=JSON.parse(o)
if(r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new wJ(e,i.url).withSparseLimit(i.maxPerPage).includingAdditionalPlatforms(N(e)).includingAttributes(vr(e))}async renderPage(e,t,n,r){return await rc(aG,async()=>{const r=n[$G],o=JSON.parse(r),i=ci(e,uV,`${o.developerId}_${o.relationshipId}`,t)
o.metricsPageInformation=i,o.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=await this.pageWithContent(e,t,o)
return s.title=o.title,this.configurePaginationForPage(s,o,t.next),ui(e,s,i),s})}generatePaginationRequest(e,t,n,r){var o
const i=r,a=bt(0,i)
let c
return s(a)?c=new wJ(e,a):(null===(o=i.nextHref)||void 0===o?void 0:o.length)>0&&(c=new wJ(e,i.nextHref).withSparseLimit(i.maxPerPage)),c.includingAdditionalPlatforms(N(e)).includingAttributes(vr(e)),c}async renderPaginatedPage(e,t,n){const r=n,o=s(r.remainingContent),i=await this.pageWithContent(e,t,r,!o),a=St(0,r)
return this.configurePaginationForPage(i,a,o?r.nextHref:t.next),i}configurePaginationForPage(e,t,n){const r=(null==n?void 0:n.length)>0,o=s(t.remainingContent)
r||o?(t.nextHref=n,t.url=`${this.paginationUrl}?${Hz.token}=${JSON.stringify(t)}`,e.nextPage=t):e.nextPage=null}}class W6 extends J1{constructor(){super("EditorialPageController")}defaultPlatforms(e){return N(e)}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o)
const s=r.pathname===`/${_z.editorialPage}/${_z.shelf}`
let a
t.includingScopedRelationships("editorial-shelves",[FH]).includingScopedRelationships(vV,[YN]),s?t.includingAssociateKeys(BH,[MG]).includingAssociateKeys(OH,[MG]):t.includingRelationships([Q$]).withSparseCount(5).withSparseLimit(12).includingAssociateKeys(Z$,[MG]).includingAssociateKeys(tj,[BH]),nw(e,t),a=r.query[Hz.context]||U(e),i(a)&&t.addingQuery(hU,a)}generatePageRequest(e,t,n){var r
let i
i=t.host===Bz?e.bag.safariExtensionsEditorialPageId:t.query[Hz.id]||n[Hz.id]
const s=n[Hz.name]
if(o(i)&&o(s))throw new Error(`Unable to map ${t.build()} to a media api url`)
const a=new wJ(e)
let c=!1
return(null===(r=t.pathname)||void 0===r?void 0:r.includes(tj))&&(a.forType(tj),c=!0),c||a.forType(vV),(null==i?void 0:i.length)>0&&(c?a.withIdOfType(i,tj):a.withIdOfType(i,vV)),(null==s?void 0:s.length)>0&&a.addingQuery(Hz.name,s),a.attributingTo(t.build())}pageRoute(e){return[{protocol:Oz,path:`${_z.editorialPage}`,query:[`${Hz.name}`,`${Hz.isArcade}?`]},{protocol:Oz,path:`${_z.editorialPage}`,query:[`${Hz.id}`,`${Hz.isArcade}?`]},{protocol:Ez,path:"/{countryCode}/editorial-page/id{id}"},{protocol:Ez,path:"/editorial-page/id{id}"},{protocol:Ez,path:"/{countryCode}/{platform}/editorial/{id}"},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/editorial/{countryCode}/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/{realm}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/editorial/editorial-pages/{id}",query:[`${Hz.name}?`,`${Hz.isArcade}?`]},{path:"{apiVersion}/catalog/{countryCode}/tags/{id}",query:[`${Hz.deviceFamily}?`]}]}pageType(){return jH}async renderPage(e,t,n,a,c,l){return await rc("renderEditorialPage",async()=>await async function(e,t,n){var a,c
const l=j(e,t)
if(!s(l))return null
const u=Ae(l,Q$)
if(!s(u))return null
let d="Editorial"
f(l,oj)===tj&&(d="TagRoom")
const p=ci(e,d,l.id,t),h={rootPosition:0,locationStack:[]},w=fo(e)
p.recoMetricsData=Pf(p.recoMetricsData,null,w)
const g=tr(t),{isArcadePage:v}=n,m=[]
let y=null,A=null
if(!i(l.attributes))return null
y={id:l.id,type:l.type,attributes:l.attributes,relationships:l.relationships,meta:l.meta}
let T=!1
for(const t of u){const n=m.length,o=Qh(e,y.id,t,v,n,p,h),i=Gh(e,y,o)
if(!r(i)){if(0===m.length){const e=i.presentationHints
i.presentationHints={...e,isFirstShelf:!0}}o.type===Jv.Upsell&&(T=!0),i.contentType===VB&&(A=tw(e,o)),m.push(i)}}const b=v?new pJ(m):new lJ(m)
b.title=T?null:null!==(a=ie(l,xG))&&void 0!==a?a:ie(l,GH),b.canonicalURL=ie(l,AH),b.shareAction=function(e,t){var n
const s=ie(t,AH),a=ie(t,xG)
if(r(s)||r(a))return null
const c=function(e,t,n,r,i,s){return Iv.context("shareSheetDataForGenericPage",()=>{if(o(n))return null
const e=new Oq(t,r,null!=s?s:void 0)
return new Eq(e,n,null)})}(0,a,s,e.loc.string("SHARE_EDITORIAL_PAGE_SUBTITLE"),0,null===(n=cu(e,t,ym.EditorialPage))||void 0===n?void 0:n.artwork)
if((0,kv.isNothing)(c))return null
const l=function(e,t){const n=[]
if((null==t?void 0:t.length)>0){const r=As(e,t)
i&&n.push(r)}return n}(e,s)
return new rz(c,l)}(e,l),b.pageRefreshPolicy=rr(e,g),v&&i(A)&&(b.subscriptionLockup=A),v&&(p.isCrossfireReferralCandidate=!0),ui(e,b,p)
const S=(null===(c=m[m.length-1])||void 0===c?void 0:c.contentType)===hO
if(e.client.deviceType!==MH&&"tv"!==e.client.deviceType&&!S){const t=e.bag.termsAndConditionsURL
if(!r(t)){const n=bc(e,t)
m.push(n)}}if(m.length>0){const e=m[0].contentType===AM,t=m[0].contentType===VB,n=m[0].contentType===BU,r=m[0].contentType===TM;(e||t||n||r)&&b.presentationOptions.push(J$),r&&(b.presentationOptions.push($_),b.presentationOptions.push(tT))}return oh(b),b}(e,t,{isArcadePage:v(n,Hz.isArcade)}))}shelfRoute(e){return[{protocol:Oz,path:`/${_z.editorialPage}/${_z.shelf}/`,query:[`${Hz.token}`]}]}generateShelfRequest(e,t,n){const r=n[Hz.token],o=JSON.parse(decodeURIComponent(r)),i=s(o.remainingItems),a=!i&&(0,Cv.isSome)(o.recommendationsHref)&&o.recommendationsHref.length>0
if(i){const t=o.remainingItems,n=new wJ(e,t,!0,[MG])
return st(e,n,t),n}if(a){const t=new wJ(e,o.recommendationsHref)
return $i(e)&&(t.enablingFeature(PV),t.includingMetaKeys(aN,[CM,z_]),t.includingScopedAttributes(DH,[nH,NB,NF]),t.includingScopedRelationships(DH,[SH])),Ni(e)&&(t.enablingFeature(cN),lr(t)),t}return null}async renderShelf(e,t,n){var i
const a=n[Hz.token],c=JSON.parse(decodeURIComponent(a)),l=s(c.remainingItems),u=!l&&(null===(i=c.recommendationsHref)||void 0===i?void 0:i.length)>0
if(c.isFirstRender=!1,l)c.remainingItems=this.buildHydratedShelfItems(e,c.remainingItems,t)
else if(u){c.data={...c.data,...j(e,t)}
const n=Ae(c.data,FH)
c.remainingItems=s(n)?n:[],Xh(e,c.data,c)}const d=Gh(e,void 0,c)
return o(d)&&!c.hasExistingContent?this.makeHiddenShelf():(function(e,t,n){if(!o(n.originalPlaceholderShelfImpressionMetrics))if(r(t.impressionMetrics))t.impressionMetrics=n.originalPlaceholderShelfImpressionMetrics
else for(const e in n.originalPlaceholderShelfImpressionMetrics.fields)Object.prototype.hasOwnProperty.call(n.originalPlaceholderShelfImpressionMetrics.fields,e)&&(t.impressionMetrics.fields[e]=n.originalPlaceholderShelfImpressionMetrics.fields[e])}(0,d,c),!c.hasExistingContent&&o(d.items)&&(d.isHidden=!0),d)}buildHydratedShelfItems(e,t,n){var r,o,i,s
const a=new Map,c=V(n)
for(const t of c)a[this.dataMapKey(e,t.type,t.id)]=t
const l=[]
for(const n of t){const t=a[this.dataMapKey(e,n.type,n.id)]
if((0,Cv.isSome)(t)){const c=pn(0,n)
if((0,Cv.isSome)(c)){const n=a[this.dataMapKey(e,MG,c.id)]
if((0,Cv.isSome)(n)){const e=null!==(r=t.meta)&&void 0!==r?r:{},a=null!==(o=y(e.associations))&&void 0!==o?o:{},c=null!==(i=y(a[MG]))&&void 0!==i?i:{},l=null!==(s=y(n))&&void 0!==s?s:{}
c.data=[l],a[MG]=c,e.associations=a,t.meta=e}}l.push(t)}}return l}dataMapKey(e,t,n){return`${t}_${n}`}makeHiddenShelf(){const e=new oJ(tF)
return e.isHidden=!0,e}}const z6="EditorialShelfCollectionPageIntent",{routes:Y6,makeCanonicalUrl:J6}=cc(rw,"/collections/{id}"),{routes:K6,makeCanonicalUrl:Z6}=cc(rw,"/{platform}/collections/{id}")
class Q6 extends J1{constructor(){super("EditorialShelfCollectionPageController")}defaultPlatforms(e){return N(e)}defaultAttributes(e){return function(e){const t=[lH,oH,Nj,Uj,nj,ZB,JN,Kj]
return e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj),t}(e)}pageType(){return jH}pageRoute(e){return[{protocol:Ez,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`},{protocol:Ez,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`},{protocol:Ez,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-collection/{${Hz.shelfId}}`}]}generatePageRequest(e,t,n){if(o(n[Hz.shelfId]))throw new Error(`Unable to map ${t.build()} to a media api url`)
return new wJ(e).forType("editorial-shelves-collection").attributingTo(t.build())}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([FH]).includingScopedRelationships(vV,[YN]).includingAssociateKeys(Z$,[MG]),nw(e,t)}async renderPage(e,t,n,r,o,i){return await rc("renderEditorialShelfCollectionPage",async()=>function(e,t){const n=j(e,t)
if(!s(n))return null
const r=ci(e,uV,n.id,t),o=tr(t),i=(mn(0,n),Qh(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=[],c=(0,Cv.unwrapOptional)(Gh(e,void 0,i))
c.title=null,c.eyebrow=null,c.isHorizontal=!1
const l=ie(n,xG)
if((0,Cv.isSome)(l)){const e=new oJ(U_)
let t
e.id=yO,t=new qq(null,l,ie(n,LG)),e.items=[t],a.push(e)}a.push(c)
const u=new lJ(a)
return u.pageRefreshPolicy=rr(e,o),ui(e,u,r),u}(e,t))}}const X6="com.apple.Arcade.ArcadeHardware1",e3="com.apple.Arcade.TrialEligible1",t3=[X6,e3]
class n3{constructor(){this.$intentKind="EngagementEventIntent"}async perform(e,t){return await iw(t,e)}}class r3{constructor(){this.$intentKind="BadgingEventIntent"}async perform(e,t){return await sw(t,e)}}class o3 extends Y1{constructor(e,t){super("UserEngagementController"),t.exportingService("AppStoreEngagement",{fetchEngagementTask:async t=>await iw(e,t),fetchBadgingTask:async t=>await sw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class i3 extends t6{constructor(){super("GroupingPageBuilder")}defaultPlatforms(e){return N(e)}defaultAttributes(e){const t=[lH,Nj,Uj,JN]
return e.appleSilicon.isSupportEnabled&&t.push(iV),t}prepareRequest(e,t,n,r,o){if(function(e,t){t.includingAdditionalPlatforms(N(e)),t.includingAgeRestrictions(),t.usingCustomAttributes(Ze(e)),t.includingMacOSCompatibleIOSAppsWhenSupported(),$i(e)&&(t.enablingFeature(PV),t.includingMetaKeys(aN,[CM,z_]),t.includingScopedAttributes(DH,eQ),t.includingScopedRelationships(DH,[SH])),xr(e,PG)&&cr(t),Fi(e)&&(t.enablingFeature(Y_),ar(t)),Ni(e)&&(t.enablingFeature(cN),lr(t)),t.enablingFeature("categoryHeaders"),t.enablingFeature(PO),e.bag.enableFeaturedCategoriesOnGroupings&&t.enablingFeature(hT),e.bag.enableCategoryBricksOnGroupings&&t.enablingFeature("categoryBricks")}(e,t),n===gm.Page){const n=r.query.id
let o,i
const s=r.pathComponents();-1!==s.indexOf(qD)?o=n:-1!==s.indexOf(Xj)?o=Rr(r):i=n,a(i)?t=t.withIdOfType(i,pj):a(o)&&(t=t.addingQuery(Xj,o)),t.withSparseCount($(e)),t.includingScopedSparseLimit(aN,F(e))}const s=r.query[Hz.context]||U(e)
i(s)&&t.addingQuery(hU,s)
const c=r.query[Hz.useReleaseId]
r.host===xz&&(null==c?void 0:c.length)>0&&(t.isStorePreviewRequest=!0,t=t.addingQuery(MI,c))}pageType(){return jH}pageRoute(e){return[{protocol:Ez,path:`/${_z.store}/${_z.grouping}`,query:[Hz.id,`${Hz.context}?`]},{hostName:xz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.grouping}`,query:[Hz.id,`${Hz.useReleaseId}?`]},{protocol:Ez,path:`/{countryCode}/${_z.genre}/{genreName}/{id}`},{protocol:Ez,path:`/{countryCode}/${_z.genre}/{id}`},{protocol:Ez,path:`/{countryCode}/{platform}/${_z.grouping}/{id}`},{protocol:Ez,path:`/${_z.store}/${_z.viewGenre}`,query:[Hz.id]},{hostName:xz,path:`/WebObjects/{storePreviewInstance}/wa/${_z.viewGenre}`,query:[Hz.id,`${Hz.useReleaseId}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Ez,path:"{apiVersion}/{realm}/editorial/{countryCode}/groupings/{id}"},{protocol:Ez,path:"{apiVersion}/editorial/{countryCode}/groupings/{id}"},{protocol:Ez,hostName:`${Bz}`}]}generatePageRequest(e,t,n){var r
let o,s,c=t.query.id
if(t.host===Bz&&(null===(r=e.bag.safariExtensionsGroupingURL)||void 0===r?void 0:r.length)>0){const n=oY.from(e.bag.safariExtensionsGroupingURL)
i(n)&&(c=Rr(n),t.query.id=c)}const l=t.pathComponents()
if(-1!==l.indexOf(qD)?o=c:-1!==l.indexOf(Xj)?o=Rr(t):s=c,!a(s)&&!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
const u=function(e){const t=[lH,oH,Nj,Uj,nj,ZB,JN]
e.appleSilicon.isSupportEnabled&&t.push(iV),e.bag.enableUpdatedAgeRatings&&t.push(zj),ad(e)&&t.push(Zj)
const n=new wJ(e).forType(pj).includingAgeRestrictions().includingAttributes(t).includingRelationshipsForUpsell(!0)
return xr(e,PG)&&cr(n),n}(e)
return u.attributingTo(t.build())}renderGroupingPage(e,t,n,o,i,s,a){return Iv.context(mT,()=>function(e,t,n){var o
if(n.pageGenreId=ce(t.originalGroupingData,Xj)||(r(o=ie(t.originalGroupingData,"chartUrl"))?null:p(oY.from(o).query,Xj)),mc(e,t,n),"tv"!==e.client.deviceType&&e.client.deviceType!==JG){const t=Tc(e,n.metricsPageInformation,n.metricsLocationTracker)
t&&n.shelves.push(t)}if(e.client.deviceType!==MH&&"tv"!==e.client.deviceType){const t=e.bag.termsAndConditionsURL
if(!r(t)){const r=bc(e,t)
n.shelves.push(r)}}const i=function(e,t,n){let r=null
switch(n){case 36:r=e.host.clientIdentifier===Kq?e.loc.string("GROUPING_APPS"):e.loc.string("GROUPING_APP_STORE","App Store")
break
case 39:r=e.loc.string("GROUPING_DISCOVER")
break
default:r=Ju(0,t)}return r}(e,t.originalGroupingData,n.pageGenreId),s=new lJ(n.shelves)
switch(e.client.deviceType){case"tv":s.title=i
break
case MH:s.title=i,s.presentationOptions=[J_]
break
case JG:s.title=i,s.presentationOptions=[J_]
const e=s.shelves[0].contentType;[BU,wT,lN].includes(e)&&s.presentationOptions.push(J$)
break
default:s.title=i,s.presentationOptions=[J_]}return n.shelves[0].contentType===TM&&(s.presentationOptions.push($_),s.presentationOptions.push(tT),s.presentationOptions.push(J$)),s.pageRefreshPolicy=rr(e,null==n?void 0:n.refreshController),ui(e,s,n.metricsPageInformation),function(e,t,n){if(!(t.shelves.length<=0))switch(n){case 36:t.shelves.splice(0,0,Sc(0,"appsPageHeader")),t.shelves.splice(6,0,Sc(0,"appsPageMid")),t.shelves.push(Sc(0,"appsPageFooter"))
break
case 6014:t.shelves.splice(0,0,Sc(0,"gamesPageHeader")),t.shelves.splice(6,0,Sc(0,"gamesPageMid")),t.shelves.push(Sc(0,"gamesPageFooter"))}}(0,s,n.pageGenreId),oh(s),s}(e,t,n))}}class s3 extends Y1{constructor(){super(hS)}pageRoute(e){return[{protocol:Oz,path:`${_z.onDeviceRecommendations}`,query:[Hz.onDeviceRecommendationsUseCase,Hz.token]}]}async handlePage(e,t,n,r,o){const i=n[Hz.onDeviceRecommendationsUseCase]
return await to(e,i,VH).then(r=>{const o=JSON.parse(n[Hz.token]),i=new Z1
i.title=o.title
const s=this.makePage(e,r.dataContainer,r.recoMetrics,i),a=new dY(jH,t.build())
return a.pageData=s,a})}makePage(e,t,n,r){const o=fo(e)
r.url=this.paginationUrl,r.metricsPageInformation=ci(e,uV,"onDevicePersonalizationSeeAll",t),r.metricsPageInformation.recoMetricsData=Pf(n,null,o),r.shouldFilter=!1,r.metricsLocationTracker={rootPosition:0,locationStack:[]}
const i=new oJ(K1),s={id:null,kind:null,softwareType:null,targetType:jV,title:r.title,pageInformation:r.metricsPageInformation,locationTracker:r.metricsLocationTracker,idType:GG,recoMetricsData:n}
Bf(e,i,s),kf(0,s,r.title),i.isHorizontal=!1,i.shouldFilterApps=r.shouldFilter
const a=V(t)
r.remainingContent=[],i.items=Gu(e,a,{contentUnavailable:(e,t)=>(r.remainingContent=Pt(0,a,e),!0),lockupOptions:{metricsOptions:{pageInformation:s.pageInformation,locationTracker:s.locationTracker},clientIdentifierOverride:r.clientIdentifierOverride,artworkUseCase:td(0,i.contentType)}})
const c=new lJ([i])
return c.title=r.title,r.remainingContent.length&&(c.nextPage=r),ui(e,c,r.metricsPageInformation),c}async handleShelf(e,t,n,r){throw new Error(zI)}shelfRoute(e){return[]}pageType(){return jH}}class a3{constructor(){this.$intentKind="InAppPurchaseInstallPageIntent"}async perform(e,t){return await aw(t,e.url)}}class c3 extends Y1{constructor(e,t){super("InAppPurchaseInstallController"),t.exportingService(YI,{fetchInstallPage:async t=>await aw(e,t.url)})}async handlePage(e,t,n,r,o){const i=n[Hz.id],s=n[qz],a=new wJ(e).withIdOfType(s,kV),c=await Jn(e,a,{}),l=function(e,t,n){const r={pageId:n||"",pageType:"IAPInstallPage",parentId:vf(t)}
return new XX(r)}(0,i,s),u=j(e,c)
let d
const f={metricsOptions:{pageInformation:l,locationTracker:{rootPosition:0,locationStack:[]}},artworkUseCase:1}
s&&u&&(d=_u(e,u,f),d.theme=mH)
const p=ye(e,u,SH)
let h
i&&p&&(h=Du(e,p,f))
const w=new uJ
w.isComplete=!0,w.lockup=d,w.parentLockup=h
const g=jt(e,u)
return w.preInstallOfferDescription=Ii(e,g),function(e,t,n){ui(e,t,n)}(e,w,l),Y1.createFlowAction(w,GO,t)}pageRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.install}`,query:[`${Hz.id}`,`${qz}?`]}]}pageType(){return GO}}class l3 extends Y1{constructor(e,t){super("MetricsLinterController"),t.exportingService("Metrics",{async lintEvent(t){const n=$t(e).makeEvent(e,t.fields)
return await Promise.resolve(n)}})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class u3{constructor(e,t,n,r){this.name=e,this.url=t,this.artwork=n,this.roomUber=r}}class d3 extends hq{constructor(e,t){super(),this.apps=e,this.appsToAlwaysShow=t}}class f3{constructor(){this.$intentKind="MSOProviderDataIntent"}async perform(e,t){return await cw(t,e.providerAdamId)}}class p3{constructor(){this.$intentKind="MSOPageIntent"}async perform(e,t){return await lw(t,e)}}class h3 extends Y1{constructor(e,t){super("MSOBuilder"),t.exportingService("MSOData",{fetchProviderData:async t=>await cw(e,t.providerAdamId),fetchPage:async t=>await lw(e,t)})}async handlePage(e,t,n,r,o){const i=function(e){const t=e[Zz]
return t?t.split(","):[]}(n),s=function(e,t){return uw(e,Rr(t))}(e,t.removeParam(Zz)),a=dw(e,await Jn(e,s),i)
return Y1.createFlowAction(a,oF,t)}pageRoute(e){return[{protocol:Ez,path:`/{countryCode}/${_z.mso}/{appName}/{id}`,query:[`${Zz}?`]},{protocol:Ez,path:`/${_z.mso}/{providerName}/{id}`,query:[`${Zz}?`]},{protocol:Ez,path:`/{countryCode}/${_z.mso}/{id}`,query:[`${Zz}?`]},{protocol:Ez,path:`/${_z.mso}/{id}`,query:[`${Zz}?`]},{protocol:Ez,path:`/${_z.mso}`,query:[Hz.id,`${Zz}?`]},{protocol:Ez,path:`{countryCode}/${_z.mso}`,query:[Hz.id,`${Zz}?`]}]}async handleShelf(e,t,n,r){const o=n[$G],i=JSON.parse(o),s=new wJ(e,i.remainingContent).includingAdditionalPlatforms(N(e)).includingAttributes([lH,oH,eV])
return function(e,t,n){const r=V(t),o=n
o.remainingContent=[]
const i={lockupOptions:{metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},artworkUseCase:td(0,n.preferredShelfContentType)},contentUnavailable:function(e,t){return o.remainingContent=Pt(0,o.remainingContent,e),o.remainingContent.push(r[e]),!1}},s=new oJ(n.preferredShelfContentType)
return s.shouldFilterApps=n.shouldFilter,s.items=Gu(e,r,i),s.mergeWhenFetched=!0,s.url=fw(o),s}(e,await Jn(e,s),i)}shelfRoute(e){return[{protocol:Oz,path:`/${_z.mso}/${_z.shelf}/{token}`}]}pageType(){return oF}}class w3{constructor(){this.$intentKind="CancelPreorderIntent"}async perform(e,t){return await pw(t,e)}}class g3 extends Y1{constructor(e,t){super("CancelPreorderController"),t.exportingService("Preorder",{cancelPreorder:async t=>await pw(e,t)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class v3 extends J1{constructor(){super("EulaBuilder")}defaultPlatforms(e){return N(e)}generatePageRequest(e,t,n){const o=t.query.resourceId,i=t.query.resourceType
if(r(o)||r(i))throw new Error(`Unable to map ${t.build()} to a media api url`)
const s=new wJ(e).withIdOfType(o,IB)
return s.targetResourceType=i,s}pageRoute(e){return[{protocol:Oz,path:`${_z.eula}`}]}pageType(){return jH}async renderPage(e,t,n,r){return await rc(aG,async()=>{const n=f(t,"results.eula.text").split(/\n{1,2}/),r=[]
for(const e of n){const t=new _q(e)
t.wantsCollapsedNewlines=!1,t.suppressVerticalMargins=!0,r.push(t)}const o=new oJ(fG)
o.isHorizontal=!1,o.items=r
const i=new lJ([o])
return i.title=e.loc.string(t$),i})}}class m3 extends Y1{constructor(){super("PersonalizedReviewsBuilder")}async handlePage(e,t,n,r,o){throw new Error("PersonalizedReviewsBuilder:handlePage not implemented")}pageRoute(e){return[]}async handleShelf(e,t,n,r){const o=n[$G],i=JSON.parse(o),s=new wJ(e).withIdOfType(i.adamId,pH)
try{const t=await Jn(e,s)
return qs(e,e.client.guid,i,t)}catch{return qs(e,e.client.guid,i)}}shelfRoute(e){return[{protocol:Oz,path:`/${_z.personalizedReviews}/${_z.shelf}/{token}`}]}pageType(){return TH}}class y3 extends J1{constructor(){super("PrivacyDetailBuilder")}defaultPlatforms(e){return N(e)}pageType(){return GE}pageRoute(e){return[{protocol:Oz,path:`${_z.privacyDetail}/${_z.product}/{id}`,query:[`${Hz.privacyTypeId}?`]},{protocol:Oz,path:`${_z.privacyDetail}/${_z.productBundle}/{id}`,query:[`${Hz.privacyTypeId}?`]}]}generatePageRequest(e,t,n){const r=Rr(t)
if((0,Cv.isNothing)(r)||0===r.length)throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
let o=BH
const i=[pM,Cj,x$]
return-1!==t.pathname.indexOf(_z.productBundle)&&(o=IH),new wJ(e).withIdOfType(r,o).addingQuery(ML,i.join(","))}async renderPage(e,t,n,s){return await rc(aG,async()=>{const s=n[Hz.privacyTypeId]
return function(e,t,n){return Iv.context("privacyDetailPageFromResponse",()=>{const s=j(e,t)
if(o(s))return null
const a=ci(e,"PrivacyDetails",s.id,t),c={rootPosition:0,locationStack:[]}
let l=[]
if(!Dc(e)){const t=function(e,t,n,r){const o=new oJ(NV)
o.isHorizontal=!1
const i=_c(e,t,!0,!0,n,r)
return o.items=[i],o.presentationHints={isFirstShelf:!0},o}(e,s,a,c)
i(t)&&l.push(t)}const u=function(e,t,n,s,a){const c=ne(t,pM)
if(o(c))return[]
const l=Pc(e,c,t,VU,!0,n,s)
if(0===l.length)return[]
const u=[]
for(const t of l)if(r(a)||t.identifier===a||e.client.deviceType!==MH){const e=new oJ(Hx)
i(t.identifier)&&t.identifier===a?(t.wantsScrollFocus=!0,e.id="privacyTypeShelf_"+t.identifier):t.wantsScrollFocus=!1,e.items=[t],e.presentationHints={isSingleDensity:!0},u.push(e)
for(const e of t.purposes){const t=new oJ("privacyCategory")
t.title=e.title,t.items=e.categories,u.push(t)}}return u}(e,s,a,c,n)
l=l.concat(u)
const d=new lJ(l)
d.title=e.loc.string(jx)
for(const e of u)if((0,Cv.isSome)(e.id)){d.loadCompletedAction=new yz(e.id)
break}return ui(e,d,a),d})}(e,t,s)})}}class A3 extends J1{constructor(){super("AccessibilityDetailsBuilder")}defaultPlatforms(e){return[]}pageType(){return YF}pageRoute(e){return[{protocol:Oz,path:`${_z.accessibilityDetails}/${_z.product}/{id}`,query:[`${Hz.deviceFamily}`]},{protocol:Oz,path:`${_z.accessibilityDetails}/${_z.productBundle}/{id}`,query:[`${Hz.deviceFamily}`]}]}generatePageRequest(e,t,n){const r=Rr(t)
if((0,Cv.isNothing)(r)||yr(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
const o=function(e){switch(e[Hz.deviceFamily]){case aH:return aH
case iH:return iH
case $H:return $H
case EU:return ON
case xj:return xj
case MH:return MH
default:return null}}(n)
if((0,Cv.isNothing)(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing required platform.`)
let i=BH;(0,Cv.isSome)(t.pathname)&&-1!==t.pathname.indexOf(_z.productBundle)&&(i=IH)
const s=new wJ(e).withIdOfType(r,i).includingAttributes([YF,Cj])
return s.platform=o,s}async renderPage(e,t,n,r){return await rc(aG,async()=>{const r=j(e,t)
if((0,Cv.isNothing)(r))return null
const o=n[Hz.deviceFamily]
if((0,Cv.isNothing)(o))return null
const i=ci(e,"AppAccessibilityDetails",r.id,t),s={rootPosition:0,locationStack:[]},a=[]
{const t=Uc(e,r,o,!0,null,i,s)
a.push(t)
const n=jc(e,r,!0,i,s);(0,Cv.isSome)(n)&&a.push(n)
const c=Gc(e,r,o,!0,null,i,s);(0,Cv.isSome)(c)&&a.push(c)}const c=new lJ(a)
return c.title=e.loc.string(aR),c.presentationOptions=[FU,tL,eP],ui(e,c,i),c})}}class T3 extends Y1{constructor(){super("ProductInAppPurchaseBuilder")}async handlePage(e,t,n,r,o){const i=n[Wz],s=Dr(e,new oY(i)),a={},c=n[zz]===FV
a.spotlightSection=ta(c),a.spotlightInAppProductIdentifier=n[Hz.offerName]
const l=iu(e,await Jn(e,s),a)
return Y1.createFlowAction(l,Jj,t)}pageRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.lookup}`,query:[Wz,Hz.offerName,zz]}]}pageType(){return Jj}}class b3{constructor(){this.$intentKind="ShelfBasedProductPageIntent"}async perform(e,t){return await hw(t,e)}}class S3 extends J1{constructor(e,t){super(jy),t.exportingService(YI,{fetchPage:async t=>await async function(e,t){if(t.preloading&&Ke(e))return await Promise.reject(new Error(JI))
if(0!==Kn(e,new oY(t.url)).length&&$p(e,t.url),t.preloading){const e=new oY(t.url)
e.param(Hz.isPreloading,FV),t.url=e.build()}const n=S3.generateProductPageOptions(e,void 0,new oY(t.url))
let r=e.required(G4).fetchPage(e,t.url,SK)
if(!r){const o=new wJ(e,t.url)
r=Jn(e,o).then(r=>iu(e,r,n,{},null,t.preloading))}return await r.then(n=>(e.host.clientIdentifier===tW?n&&oM in n&&wi(0,n):i(t.referrerData)&&n&&oM in n&&wi(0,n),n))}(e,t),fetchShelfBasedPage:async t=>await hw(e,t)})}defaultPlatforms(e){return N(e)}pageType(){return Jj}defaultTab(e){return S3.representsArcadeApp(e)?xH:super.defaultTab(e)}defaultAction(e,t,n,r){if(t instanceof dY)return t
const o=super.defaultAction(e,t,n,r)
if(!(t instanceof SK||t instanceof HK))return o
const i=1===t.appPlatforms.length&&"tv"===t.appPlatforms[0]
if(n[Hz.action]!==$4||i){if(n[Hz.action]!==F4||i)return o
{const e=t.shelfMapping[pH]||t.shelfMapping[aV]
let n=null
return e&&e.seeAllAction&&(n=e.seeAllAction,n.animationBehavior=Mj),o.animationBehavior=Mj,new $W([o,n])}}{const n=S3.representsBundle(t)
let r=null,i=null,s=null,a=null
t instanceof SK?(r=t.adamId,i=t.icon,s=t.title,a=t.subtitle):t instanceof HK&&(r=t.lockup.adamId,i=t.lockup.icon,s=t.lockup.title,a=t.lockup.subtitle)
const c=js(e,r,n,i,!1,a,s)
return o.animationBehavior=Mj,new $W([o,c])}}static generateProductPageOptions(e,t,n){const r={clientIdentifierOverride:n.query[Hz.clientIdentifierOverride]},o=null==t?void 0:t[Hz.offerName]
if(o){const e=t[zz]===FV
r.spotlightSection=ta(e),r.spotlightInAppProductIdentifier=o}const s=n.query[JX]
s&&(r.iAdClickFields=JSON.parse(s))
const a=n.query[KX]
a&&(r.iAdLineItem=a)
const c=n.query[ZX];(0,kv.isSome)(c)&&(r.iAdDismissAdActionMetrics=JSON.parse(c))
const l=n.query[WK]
i(l)&&(r.externalDeepLinkUrl=l)
const u=n.query[zK]
i(u)&&(r.isCppDeepLinkDisabled=JSON.parse(u))
const d=null==t?void 0:t[Hz.webBrowser]
return(0,kv.isSome)(d)&&(r.webBrowser="1"===d),e.client.isCompanionVisionApp&&(r.clientIdentifierOverride="com.apple.visionproapp"),r}pageRoute(e){return _p()}generatePageRequest(e,t,n){var o
const i=n[Hz.bundleIdentifier],s=n[Hz.ids],a=n[Hz.productVariantID],c="1"===n[Hz.includeUnlistedApps]||"1"===n[Hz.isViewOnly]
let l=null
if(i){const t=gt(e).adamIdFromSystemBundleId(i)
l=(0,kv.isSome)(t)?_r(e,t,!1,void 0,!1,c):function(e,t,n,r){const o=nQ
e.bag.enablePrivacyNutritionLabels&&!gr(e,t)&&o.push(uM),br(e)&&!Pr(e,t)&&o.push(dM),e.appleSilicon.isSupportEnabled&&o.push(iV),e.bag.enableUpdatedAgeRatings&&o.push(zj),ad(e)&&o.push(Zj),e.bag.enableLicenses&&o.push($k)
const i=new wJ(e).forType(BH).withFilter(zV,t).includingAdditionalPlatforms(N(e)).includingRelationships([cV,$B,lM,pH,IH,cM,aM]).includingAttributes(o).addingRelationshipLimit(pH,B(e)).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ze(e))
return(0,Cv.isSome)(n)&&i.addingQuery(Hz.productVariantID,n),Dn(e,xV)&&i.enablingFeature(T_),r&&i.enablingFeature(A_),Fi(e)?i.includingViews([xk]):i.includingRelationships([b_]),i}(e,i,a,c)}else if(n[Hz.action]===KI&&s){const r=(null===(o=t.pathname)||void 0===o?void 0:o.length)>0&&-1!==t.pathname.indexOf(ZI)
l=_r(e,s,v(n,Hz.isPurchasesApp),a,r,c)}else l=Dr(e,t,c)
if(r(l))throw new Error(`Unable to map ${t.build()} to a media api url`)
return l}generateAdditionalPageRequirements(e,t,n){const r=super.generateAdditionalPageRequirements(e,t,n),o=function(e){for(const[t,n]of Object.entries(e))if(t.toLocaleLowerCase()===Hz.appEventId.toLocaleLowerCase())return n
return null}(n),i=n[Hz.offerItemId]
if((null==o?void 0:o.length)>0&&$i(e)){const t=new wJ(e).withIdOfType(o,DH).includingAdditionalPlatforms(N(e)).includingScopedAttributes(DH,eQ).includingScopedAvailableIn(DH,[ak,Uk])
r[N4]=R(Jn(e,t))}else if(s(i)&&Ni(e)){const t=new wJ(e).withIdOfType(i,Aj).includingAdditionalPlatforms(N(e))
lr(t),r[N4]=R(Jn(e,t))}return r}async renderPage(e,t,n,r,o,i){return await rc(aG,async()=>{const o=ci(e,uj,"",t),a=S3.generateProductPageOptions(e,n,new oY(o.pageUrl)),c=j(e,t),l=S3.alternativeAppForPlatform(e,c,We(e))
if(null!==l)return l
const u="1"===n[Hz.isViewOnly]
s(i)&&SW.shared.setReferralDataForProduct(c.id,i)
const d=iu(e,t,a,r,i,v(n[Hz.isPreloading]),u),f=e.fetchTimingMetricsBuilder
return(0,kv.isSome)(f)&&f.decorate(d),d})}shelfRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.shelf}/{token}`}]}generateShelfRequest(e,t,n){return xp(e,0,n)}async renderShelf(e,t,n){return await Lp(e,t,n)}shelfRequiresAdditionalModification(e,t){return!0}async performAdditionalShelfModifications(e,t,n){return await new Promise(r=>{const o=n[$G],i=JSON.parse(o),s=t.items
if(i.contentType===JF&&s){const n=[],o=[]
for(const e of s){const t=e.productIdentifier
ta(e.isSubscription).shelfId===i.inAppShelfId&&(n.push(t),e.isVisibleByDefault&&o.push(t))}e.clientOrdering.orderedVisibleIAPs(i.appBundleId,n,o,i.spotlightInAppProductIdentifier).then(e=>{t.items=S3.filteredInAppLockupsUsingOrdering(s,e),r(t)})}else new Set([sj,nB,zM]).has(t.contentType)&&0===t.items.length&&(t.isHidden=!0),r(t)})}async handleShelfError(e,t){const n=t[$G],r=JSON.parse(n)
if(r&&!r.hasExistingContent){const e=new oJ(r.contentType)
return e.isHidden=!0,e}return await super.handleShelfError(e,t)}static alternativeAppForPlatform(e,t,n){if(!Ee(t,n)){const r=Ae(t,aM)
if(s(r))for(const t of r){const r=Ge(e,t,AH)
if(Ee(t,n)&&(null==r?void 0:r.length)>0)return new dY(TH,r)}}return null}static representsBundle(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&iG in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[iG]===XO}static representsArcadeApp(e){return!!(e.pageMetrics&&e.pageMetrics.pageFields&&iG in e.pageMetrics.pageFields)&&e.pageMetrics.pageFields[wF]===HV}static filteredInAppLockupsUsingOrdering(e,t){const n={}
for(const t of e)n[t.productIdentifier]=t
const r=[]
for(const e of t){const t=n[e]
if(t){const e=b(t)
r.push(e)}}return r}}class P3 extends Y1{async handlePage(e,t,n,r,o){throw new Error(`handlePage is not supported on: ${this.builderClass}`)}async renderPage(e,t,n){throw new Error(`renderPage is not supported on: ${this.builderClass}`)}async handleShelf(e,t,n,r){const o=await x(this.renderShelf(e,t,n))
return o.success?o.value:await this.handleShelfError(o.error,n)}async renderShelf(e,t,n){throw new Error(`renderShelf is not supported on: ${this.builderClass}`)}async handleShelfError(e,t){throw e}}class I3 extends P3{constructor(){super("ProductBuilderNative")}pageType(){return Jj}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterPlayerShelf,Hz.token]},{protocol:Oz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterPlayerRibbonItem]},{protocol:Oz,path:`/${_z.product}/${_z.shelf}`,query:[Hz.isGameCenterAchievementsShelf,Hz.token]}]}async renderShelf(e,t,n){if(t.query[Hz.isGameCenterPlayerShelf]){const r=t.query[Hz.id],o=await e.gameCenter.fetchFriendsThatPlayGame(r),i=n[Hz.token]
return Ol(e,o,!0,JSON.parse(i))}if(t.query[Hz.isGameCenterPlayerRibbonItem]){const n=t.query[Hz.id],r=await e.gameCenter.fetchFriendsThatPlayGame(n)
return Ol(e,r,!1)}if(t.query[Hz.isGameCenterAchievementsShelf]){const r=t.query[Hz.bundleId],o=await e.gameCenter.fetchAchievementSummaryForGame(r)
let i=null
if(o.length>0){const t=pp(0,{achievements:{bundleID:r}}),n=e.loc.string("PRODUCT_ACHIEVEMENT_SUMMARY_COMPLETED","Completed"),s=o[0].achievements
let a=null
const c=s.filter(e=>e.status.type===aj)
if(c.length>0&&(a=c[0]),null===a){const e=s.filter(e=>e.status.type===OT||e.status.type===nx)
e.sort((e,t)=>t.status.percent-e.status.percent),e.length>0&&(a=e[0])}null!==a&&(i=new Fq(o[0].bundleId,o[0].completedAchievements,o[0].totalAchievements,n,t,[a]))}const s=n[Hz.token],a=function(e,t,n){const r=new oJ(sP)
if(r.isHorizontal=!0,t){const o={pageInformation:n.destinationPageInformation,locationTracker:n.sourceLocationTracker,kind:fH,title:CU,id:"achievements_summary",idType:ZV,softwareType:null,targetType:fH,badges:{gameCenter:!0}}
Bf(e,r,o),sp(e,t.action,o),r.items=[t]}return r.mergeWhenFetched=!0,r.batchGroup=ij,r.isHidden=0===r.items.length,r}(e,i,JSON.parse(s))
return a}return await super.renderShelf(e,t,n)}}const C3="todayTabPersonalization",k3="OnDeviceRecommendationsTodayShelfController"
class O3{constructor(e){this.recommendations=e}storyData(e){var t
const n=this.recommendationForUseCase(e),r=null==n?void 0:n.candidate(OH)
if(!(0,kv.isNothing)(n)&&!(0,kv.isNothing)(r))return null===(t=null==n?void 0:n.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===r.id)}storyGroupData(e){var t,n
const r=this.recommendationForUseCase(e),o=null==r?void 0:r.candidate(sG)
if((0,kv.isNothing)(r)||(0,kv.isNothing)(o))return
const i=null===(t=null==r?void 0:r.dataContainer)||void 0===t?void 0:t.data.find(e=>e.id===(null==o?void 0:o.id)),s=null===(n=null==r?void 0:r.dataContainer)||void 0===n?void 0:n.data.filter(e=>o.candidateIDs.includes(e.id))
return(0,kv.isNothing)(i)||(0,kv.isNothing)(s)?void 0:(i[WG]={associations:{recommendations:{data:s}}},i)}recommendationForUseCase(e){return this.recommendations.find(t=>t.useCase===e)}}class E3{constructor(e,t,n,r){this.useCase=e,this.candidates=t,this.recoMetrics=n,this.dataContainer=r}candidate(e){return this.candidates.find(t=>t.type===e)}}class R3{constructor(e,t,n,r){this.id=e,this.type=t,this.candidateIDs=n,this.data=r}}class D3 extends P3{constructor(){super("ProductPageShelfWithAdController")}pageType(){return Jj}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.shelf}/{token}`,query:[Hz.isShelfWithAd,Hz.shelfWithAdPlacementType]}]}async renderShelf(e,t,n){const r=n[Hz.shelfWithAdPlacementType],o=t.query[Hz.id],i=ww(e,r,o).catch(()=>null),s=xp(e,0,n)
s.attributingTo(t.build())
const a=Jn(e,s)
return await Promise.all([a,i]).then(([t,r])=>Lp(e,t,n,r,!0))}}class _3 extends P3{constructor(){super("ProductPageSimilarItemsShelfRefreshController")}pageType(){return Jj}pageRoute(e){return[]}shelfRoute(e){return[{protocol:Oz,path:`/${_z.product}/${_z.shelf}/{token}`,query:[`${Hz.shelfRefreshType}=${eY}`]}]}async renderShelf(e,t,n){const r=t.query[Hz.id]
let o=Promise.resolve(null),i=!1
i=Dn(e,nV),i&&(o=ww(e,nV,r).catch(()=>null))
const s=function(e,t){const n=[lH,oH,eV]
return e.bag.enableUpdatedAgeRatings&&n.push(zj),ad(e)&&n.push(Zj),new wJ(e).withIdOfType(t,mL).enablingFeature(WG).includingAdditionalPlatforms(N(e)).includingAttributes(n).enablingFeature(T_)}(e,r)
s.attributingTo(t.build())
const a=Jn(e,s).catch(async()=>{const r=xp(e,0,n)
return r.attributingTo(t.build()),await Jn(e,r)})
return await Promise.all([a,o]).then(async([t,r])=>await Lp(e,t,n,r,i))}}class x3 extends Y1{constructor(){super("ReviewsAdapterBuilder")}async handlePage(e,t,n,r,o){const i=Dr(e,t),s=iu(e,await Jn(e,i))
let a,c
if(ou(e)){const e=s
a=e.shelfMapping[aV],c=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}else{const e=s
a=e.shelfMapping[pH],c=1===e.appPlatforms.length&&"tv"===e.appPlatforms[0]}const l=Y1.createFlowAction(s,Jj,t)
let u=null
return a&&a.seeAllAction&&!c&&(u=a.seeAllAction,u.animationBehavior=Mj),u?(l.animationBehavior=Mj,new $W([l,u])):l}pageRoute(e){return[{protocol:Ez,path:`/{countryCode}/${_z.product}/{appName}/{id}`,hash:Xz},{protocol:Ez,path:`/${_z.store}/${_z.viewReviews}`,query:[Hz.id]}]}async handlePagination(e,t,n,r,o){const i=n[Jz],s=n[Kz],a=l(o.remainingContent),c=new wJ(e,o.nextHref).includingAdditionalPlatforms(N(e)).addingQuery(Ij,s),u=await Jn(e,c,{})
return Ks(e,e.client.guid,i,a,u,!1,s)}paginationRoute(e){return[{protocol:Oz,path:`/${_z.reviews}/${_z.shelf}/{adamId}/{sort}`}]}pageType(){return Jj}}class L3 extends Y1{constructor(){super("SortedReviewsBuilder")}async handlePage(e,t,n,r,o){const a=n[Jz],c=n[Kz],l=new wJ(e).withIdOfType(a,yL).includingAdditionalPlatforms(N(e)).addingQuery(Ij,c),u=await Jn(e,l,{}),d=n[Hz.token]
let f=null
if(s(d))try{f=JSON.parse(d)}catch(e){}const p=Ks(e,e.client.guid,a,[],u,!0,c,f)
return i(null==f?void 0:f.reviewActionsShelf)&&p.shelves.unshift(f.reviewActionsShelf),i(null==f?void 0:f.reviewSummaryShelf)&&p.shelves.unshift(f.reviewSummaryShelf),i(null==f?void 0:f.ratingsShelf)&&p.shelves.unshift(f.ratingsShelf),Y1.createFlowAction(p,pH,t)}pageRoute(e){return[{protocol:Oz,path:`/${_z.reviews}/{adamId}/{sort}`,query:[`${Hz.token}?`]}]}pageType(){return pH}}class M3 extends X1{constructor(){super("AccessoryProtocolRoomBuilder")}pageInformation(e,t,n){return di(0,"accessory")}generatePageRequest(e,t,n){const r=[]
for(const e of Object.keys(t.query))e.startsWith("id")&&r.push(t.query[e])
return this.requestWithFilter(e,"deviceProtocol",r.join(","))}pageRoute(e){return[{query:[`${Hz.action}=accessoryLookup`]}]}}class $3 extends Y1{constructor(){super("CollectionDeepLinkingController")}pageType(){return jH}pageRoute(e){return[{protocol:Ez,path:"{countryCode}/{tab}/recommendations",query:[`${Hz.useCaseShort}`,`${Hz.collectionId}?`,`${Hz.seedId}?`]}]}async handlePage(e,t,n,r,o){const i=n[_z.tab],s=n[Hz.useCaseShort],a=n[Hz.collectionId],c=n[Hz.seedId]
let l=new wJ(e).forType(u_).addingQuery(GH,i).addingQuery("filter[recoUseCase]",s).includingRelationships([FH]).includingAdditionalPlatforms(N(e))
l.enablingFeature(PO),(null==a?void 0:a.length)>0&&(l=l.addingQuery(gj,a)),(null==c?void 0:c.length)>0&&(l=l.addingQuery(Py,c))
const u=await x(Jn(e,l))
if(!u.success)throw new Error(`CollectionDeeplinkingController: Failed to fetch Media API data for useCase: ${s}`)
const d=u.value,f=ie(j(e,d),_M),p=await((null==f?void 0:f.length)>0?this.makeODPPage(e,s,f,d):this.makeCollectionPage(e,s,d))
let h
const w=this.createTabChangeActionForRequest(i),g=new dY(jH,t.build())
return g.pageData=p,null!=w?(w.actions=[g],h=w):h=g,h}async makeODPPage(e,t,n,r){const o=new Promise((o,i)=>{to(e,n,jH).then(n=>{const i=j(e,r),s=new Z1
s.title=ie(i,hH),s.metricsPageInformation=ci(e,uV,t,r),s.metricsPageInformation.recoMetricsData=Pf(W(r),null,n.recoMetrics),s.shouldFilter=!1,s.metricsLocationTracker={rootPosition:0,locationStack:[]}
const a=this.makePage(e,s,n.dataContainer)
o(a)}).catch(e=>{i(e)})})
return await o}async makeCollectionPage(e,t,n){const r=j(e,n),o=ve(r,FH),i=new Z1
return i.url=this.paginationUrl,i.title=ie(r,hH),i.metricsPageInformation=ci(e,uV,t,n),i.metricsPageInformation.recoMetricsData=W(n),i.shouldFilter=!1,i.metricsLocationTracker={rootPosition:0,locationStack:[]},await Promise.resolve(this.makePage(e,i,o))}makePage(e,t,n){return Iv.context("makePage",()=>{const r=t.preferredShelfContentType||K1,o=new oJ(r),i={id:null,kind:null,softwareType:null,targetType:jV,title:t.title,pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker,idType:GG,recoMetricsData:W(n)}
Bf(e,o,i),kf(0,i,t.title),o.isHorizontal=!1,o.shouldFilterApps=t.shouldFilter
const s=V(n)
t.remainingContent=[],o.items=Gu(e,s,{contentUnavailable:(e,n)=>(t.remainingContent=Pt(0,s,e),!0),lockupOptions:{metricsOptions:{pageInformation:t.metricsPageInformation,locationTracker:t.metricsLocationTracker},clientIdentifierOverride:t.clientIdentifierOverride,artworkUseCase:td(0,r)}})
const a=new lJ([o])
return a.title=t.title,t.remainingContent.length&&(a.nextPage=t),a})}createTabChangeActionForRequest(e){const t=e
return new Set([PH,BH,mV,JV,BD,xH,sU,jU,a$,c$,l$,_F,Wj,PB]).has(t)?new xW(t):null}async handleShelf(e,t,n,r){throw new Error(zI)}shelfRoute(e){return[]}paginationRoute(e){return[{protocol:Oz,path:`${this.paginationPath}`}]}async handlePagination(e,t,n,r,o){return await rc(`${this.builderClass}.handlePagination`,async()=>{const n=o,r=new wJ(e,n.remainingContent)
if(!r)throw new Error(`Could not construct media API request for: ${t}`)
r.includingAdditionalPlatforms(N(e))
const i=[lH,oH,Nj,Uj]
e.appleSilicon.isSupportEnabled&&i.push(iV),e.bag.enableUpdatedAgeRatings&&i.push(zj),ad(e)&&i.push(Zj),r.includingAttributes(i),r.usingCustomAttributes(Ze(e)),r.attributingTo(t.build())
const s=await Jn(e,r)
return this.makePage(e,n,s)})}}class F3 extends Q1{constructor(){super("RecommendationRoomBuilder")}generatePageRequest(e,t,n){const r=Rr(t),o=n[Hz.grouping]
if(!this.isValidId(r))throw new Error(`Unable to map ${t.build()} to a media api url. Missing id.`)
if(!this.isValidId(o))throw new Error(`Unable to map ${t.build()} to a media api url. Missing grouping.`)
return new wJ(e).withIdOfType(r,sM).addingQuery(PG,o).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}async renderPage(e,t,n){return await rc(aG,async()=>{const r=j(e,t),o=ve(r,FH),i=n[Hz.grouping],s=ci(e,uV,`${r.id}-${i}`,t),a=new Z1
a.remainingContent=o.data,a.url=this.paginationUrl,a.shouldFilter=!ae(r,DM),a.metricsPageInformation=s,a.metricsLocationTracker={rootPosition:0,locationStack:[]},a.title=ie(r,GH)
const c=await this.pageWithContent(e,o,a)
return c.title=a.title,ui(e,c,s),c})}pageRoute(e){return[{protocol:Ez,path:`/{countryCode}/${_z.appsForYou}/{title}/{id}`,query:[Hz.grouping]},{protocol:Ez,path:`/{countryCode}/${_z.appsForYou}/{id}`,query:[Hz.grouping]},{protocol:Ez,path:`/${_z.appsForYou}/{title}/{id}`,query:[Hz.grouping]},{protocol:Ez,path:`/${_z.appsForYou}/{id}`,query:[Hz.grouping]}]}isValidId(e){return!(r(e)||isNaN(e))}}class N3 extends Q1{constructor(){super("RoomBuilder")}generatePageRequest(e,t,n){let r=t.query[Hz.featuredContentId]
if(this.isValidRoomId(r)||(r=n.id),!this.isValidRoomId(r))throw new Error(`Unable to map ${t.build()} to a media api url`)
return function(e,t){return new wJ(e).withIdOfType(t,TF).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,r)}prepareRequest(e,t,n,r,o){!function(e,t){t.includingAdditionalPlatforms(N(e)).includingAttributes(lc(e)).usingCustomAttributes(Ze(e)).includingAgeRestrictions().includingMacOSCompatibleIOSAppsWhenSupported(!0)}(e,t)}async renderPage(e,t,n,r){return await rc(aG,async()=>{const n=j(e,t),r=ve(n,FH),o=ci(e,uV,n.id,t),i=new Z1
i.remainingContent=r.data,i.url=this.paginationUrl,i.shouldFilter=!ae(n,DM),i.metricsPageInformation=o,i.metricsLocationTracker={rootPosition:0,locationStack:[]}
const s=ie(n,bG)
var a
i.preferredShelfContentType=null==(a=Number(s))?null:431===a?ox:null,i.clientIdentifierOverride=yn(e,n),i.title=ie(n,hH)
const c=await this.pageWithContent(e,r,i)
return c.title=i.title,ui(e,c,o),c})}pageRoute(e){return[{protocol:Ez,path:`/${_z.store}/${_z.room}`,query:[Hz.featuredContentId]},{protocol:Ez,path:`/${_z.storeElements}/${_z.recommendationsSeeAll}`},{protocol:Ez,path:"{apiVersion}/editorial/{countryCode}/rooms/{id}"},{protocol:Ez,path:"/{countryCode}/collection/today-view-widgets",query:[Hz.featuredContentId]},{protocol:Ez,path:"/{countryCode}/collections/id{id}"}]}isValidRoomId(e){return a(e)}}!function(e){e[e.Landing=0]="Landing",e[e.Results=1]="Results",e[e.ChartsAndCategories=2]="ChartsAndCategories",e[e.Focus=3]="Focus"}(bm||(bm={}))
class B3{constructor(){this.$intentKind="SearchChartsAndCategoriesPageIntent"}async perform(e,t){return await Cw(e,t)}}class U3 extends Y1{constructor(e,t){super("SearchChartsAndCategoriesPageBuilder"),t.exportingService(f$,{fetchSearchChartsAndCategoriesPage:async t=>await Cw(t,e)})}pageType(){return FR}pageRoute(e){return[{path:"/{apiVersion}/recommendations/{countryCode}/search-recommendations/{search-recommendations-id}"}]}async handlePage(e,t,n,r,o){return await rc(`${this.builderClass}.handlePage`,async()=>{const n=new wJ(e,t.toString()).forType(AL).includingAgeRestrictions().includingScopedRelationships(QI,[FH]).enablingFeature(WG).enablingFeature(p$).addingQuery(Hz.name,k$)
xr(e,lL)&&cr(n)
const r=await this.fetchCategoriesAndChartsPage(e,n)
return Y1.createFlowAction(r,this.pageType(),t)})}async fetchCategoriesAndChartsPage(e,t){const n=Jn(e,t)
return await n.then(t=>bw(e,t))}}class G3 extends wq{constructor(e,t,n,r,o){super(),this.value=e,this.isSelected=t,this.leadingIcon=n,this.displayName=r,this.clickAction=o}}class j3 extends hq{constructor(e,t,n){super(),this.searchTerm=e,this.selectedTokens=t,this.optimizationTerm=n}}class V3 extends _W{constructor(e,t){super("GuidedSearchTokenToggleAction"),this.targetToken=e,this.searchOrigin=t}}class H3 extends _W{constructor(e,t){super("SearchEntityChangeAction"),this.entity=e,this.searchOrigin=t}}const q3=[new class{canDisplay(e){return(0,kv.isSome)(e.alignedRegionArtwork)||(0,kv.isSome)(e.alignedRegionVideo)}get representativeDisplayStyle(){return"UI1_3x2"}displayStyle(e,t,n){return(0,kv.isSome)(t.alignedRegionArtwork)?"UI1_3x2":"UV1_3x2"}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isLandscape())&&void 0!==r&&r}get representativeDisplayStyle(){return"LV1"}displayStyle(e,t,n){return"LV1"}},new class{canDisplay(e){var t,n,r
const o=null===(n=null===(t=e.videos)||void 0===t?void 0:t[0])||void 0===n?void 0:n.preview
return null!==(r=null==o?void 0:o.isPortrait())&&void 0!==r&&r}get representativeDisplayStyle(){return"PV4"}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=eg(e,n)
return 4===o&&r>=3?"PV4":3===o&&r>=2?"PV3":r>=1?"PV2":"PV1"}},new class{canDisplay(e){return e.landscapeScreenshots.length>0}get representativeDisplayStyle(){return"LI1"}displayStyle(e,t,n){return"LI1"}},new class{canDisplay(e){return e.portraitScreenshots.length>0}get representativeDisplayStyle(){return"PI4"}displayStyle(e,t,n){const r=t.portraitScreenshots.length,o=eg(e,n)
return 4===o&&r>=3?"PI4":3===o&&r>=2?"PI3":r>=1?"PI2":"PI1"}},new class{canDisplay(e){return!0}get representativeDisplayStyle(){return"TEXT"}displayStyle(e,t,n){return"TEXT"}}],W3=(e,t)=>{const n=e.isLandscape()
return n===t.isLandscape()?0:n?-1:1}
!function(e){e[e.EmptyResults=0]="EmptyResults",e[e.Picker=1]="Picker",e[e.NonNative=2]="NonNative"}(Sm||(Sm={}))
class z3{constructor(){this.$intentKind="SearchHintsIntent"}async perform(e,t){return await vg(t,e.term)}}class Y3 extends Y1{constructor(e,t){super("SearchHintsBuilder"),t.exportingService(f$,{fetchHints:async t=>await vg(e,t.term)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class J3{constructor(e,t,n,r){this.title=e,this.maxItems=t,this.shelfDisplayStyle=n,this.itemDisplayStyle=r}}class K3 extends Y1{constructor(){super("SearchLandingPageBuilder")}pageRoute(e){return[{protocol:Oz,path:`${_z.searchLandingPage}`}]}shelfRoute(e){return[{protocol:Oz,path:`${_z.searchLandingPage}/${_z.shelf}`,query:[Hz.isOnDeviceSearchHistoryShelf]},{protocol:Oz,path:`${_z.searchLandingPage}/${_z.shelf}`,query:[Hz.isSearchFocusHeaderShelf]}]}pageType(){return jH}async handlePage(e,t,n,r,o){return await rc(`${this.builderClass}.handlePage`,async()=>{const n=await this.fetchPage(e)
return Y1.createFlowAction(n,this.pageType(),t)})}async handleShelf(e,t,n,r){return await rc(`${this.builderClass}.handleShelf`,async()=>{var o,s,a
const c=v(null!==(o=n[Hz.isOnDeviceSearchHistoryShelf])&&void 0!==o?o:t.query[Hz.isOnDeviceSearchHistoryShelf]),l=c?function(e){if(!(0,Cv.isNothing)(e))return JSON.parse(decodeURIComponent(e))}(null!==(s=n[Hz.token])&&void 0!==s?s:t.query[Hz.token]):void 0,u=v(null!==(a=n[Hz.isSearchFocusHeaderShelf])&&void 0!==a?a:t.query[Hz.isSearchFocusHeaderShelf])
return c&&i(l)?await this.handleSearchHistoryShelfAsync(e,l):u?Dg(e):await super.handleShelf(e,t,n,r)})}handleSearchHistoryShelf(e,t,n,r){e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems).then(n=>{const r=li(e,Tx,bx," ")
return kf(0,{locationTracker:{rootPosition:0,locationStack:[]},id:YR,pageInformation:r},t.title),kg(e,t,r,{rootPosition:0,locationStack:[]},n)}).then(n,r)}async handleSearchHistoryShelfAsync(e,t){const n=await e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(t.maxItems),r=li(e,Tx,bx," ")
return kf(0,{locationTracker:{rootPosition:0,locationStack:[]},id:YR,pageInformation:r},t.title),kg(e,t,r,{rootPosition:0,locationStack:[]},n)}async fetchPage(e){return await async function(e){const t=Dn(e,UG)?ww(e,UG).catch(()=>null):null
return await async function(e,t){return function(e){return!e.bag.supportsSearchLandingPageV2||!Rt(e,e.bag.searchLandingPageV2RolloutRate)}(e)?await async function(e,t){const n=new wJ(e).forType(cL).includingAgeRestrictions().includingAdditionalPlatforms(N(e)).usingCustomAttributes(Ze(e))
n.targetResourceType=pj
const r=ic(e,e.user.dsid);(null==r?void 0:r.length)>0&&n.addingQuery(BP,r)
const s=new bv.FetchTimingMetricsBuilder,a=e.addingFetchTimingMetricsBuilder(s),c=Jn(a,n)
return await Promise.all([c,t]).then(([e,t])=>s.measureModelConstruction(()=>function(e,t,n){const r=l(t,UP)[0]
if(o(r))return null
if(!ge(r,RU))return null
const s=ie(r,"id"),a=ci(e,IO,r.id,t),c=fo(e)
a.recoMetricsData=Pf(a.recoMetricsData,null,c),a.iAdInfo=Nn(e,UG,n)
const u=po(0,a.iAdInfo)
go(e,u,n)
const d={shelves:[],metricsPageInformation:a,metricsLocationTracker:{rootPosition:0,locationStack:[]},pageGenreAdamId:s,pageGenreId:ce(r,Xj),hasAuthenticatedUser:i(e.user.dsid),isSearchLandingPage:!0,adStitcher:ec(e,n),adIncidentRecorder:u}
mc(e,Ac(e,r),d)
const f=new fJ(d.shelves),p=new NZ(GP,e.bag.searchLandingPageRefreshUpdateDelayInterval,e.bag.searchLandingPageOffscreenRefreshInterval,null)
return f.pageRefreshPolicy=p,f.adIncidents=ho(0,d.adIncidentRecorder),ui(e,f,d.metricsPageInformation),f}(a,e,t)))}(e,t):e.bag.mediaAPISearchFocusEnabled?await async function(e,t){const n=Eg(e).enablingFeature("search-focus-suggestions"),r=new bv.FetchTimingMetricsBuilder,i=e.addingFetchTimingMetricsBuilder(r),s=Jn(i,n),a=e.amsEngagement
let c=null
if(a&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:YX,tab:JV}
c=a.performRequest(e)}return await Promise.all([s,t,c]).then(async([e,t,n])=>await r.measureModelConstructionAsync(async()=>await async function(e,t,n,r){const i=Rg(e,t,n,r)
return await async function(e,t){var n
if(o(t.data))return null
const r=ci(e,Tx,bx,t," "),i=fo(e)
r.recoMetricsData=Pf(r.recoMetricsData,null,i)
const s={shelves:[],metricsLocationTracker:{rootPosition:0,locationStack:[]},metricsPageInformation:r,pageType:bm.Focus},a=function(e,t,n){const r=e.data
if(o(r))return null
for(const e of r){if(o(e))continue
const r=h(e,WG)
if(yg(null==r?void 0:r.category)===t.pageType&&n===ie(e,_M))return e}return null}(t,s,jP)
if((0,Cv.isNothing)(a))return _g(e,t,s)
const c=null!==(n=ce(a,X_))&&void 0!==n?n:0,l=e.onDeviceSearchHistoryManager.fetchRecentsWithLimit(c)
return await l.then(n=>(s.searchHistory=n,_g(e,t,s)))}(e,t).then(e=>(i.searchFocusPage=e,i))}(i,e,t,n)))}(e,t):await async function(e,t){const n=Eg(e),r=new bv.FetchTimingMetricsBuilder,o=e.addingFetchTimingMetricsBuilder(r),i=Jn(o,n),s=e.amsEngagement
let a
if(s&&e.bag.enableRecoOnDeviceReordering){const e={timeout:500,eventType:YX,tab:JV}
a=s.performRequest(e)}return await Promise.all([i,t,a]).then(([e,t,n])=>r.measureModelConstruction(()=>Rg(o,e,t,n)))}(e,t)}(e,t).catch(async n=>{if((0,Cv.isSome)(e.bag.trendingSearchesURL))return await async function(e,t){const n={url:e.bag.trendingSearchesURL},r=e.network.fetch(n).then(e=>{if(!e.ok)throw Error(`Bad Status code ${e.status} for ${n.url}`)
return JSON.parse(e.body)})
return await Promise.all([r,t]).then(([t,n])=>{var r
const o=new fJ(function(e,t){return Iv.context("trendingSearchesShelfForResponse",()=>{const n={rootPosition:0,locationStack:[]},r=l(t,"trendingSearches").map(t=>{const r=f(t,CV),o=new gZ(r,r,f(t,AH),mN)
return e.client.isPhone&&(o.artwork=Se(e,kM)),lp(e,o,NH,n),xf(n),o})
let o=0
switch(e.client.deviceType){case CH:o=10
break
case RH:o=7}const i=new oJ(EV)
return i.title=r.length>0?f(t,"header.label"):null,i.isHorizontal=!1,i.items=r.slice(0,o),[i]})}(e,t)),i=li(e,dB,mN,"")
return i.iAdInfo=Nn(e,UG,n),null===(r=i.iAdInfo)||void 0===r||r.setMissedOpportunity(e,ay,UG),ui(e,o,i),o})}(e,t)
throw n})}(e)}}const{routes:Z3,makeCanonicalUrl:Q3}=cc(function(e){return function(e){const{platform:t,...n}=e
return{...n,platform:Tt(t),$kind:RC}}({...e,origin:"userText"})},"/{platform}/search",[RN])
class X3{constructor(){this.$intentKind=RC,this.routes=Z3}async perform(e,t){return t.client.isWeb&&!e.platform&&(e.platform=aH),await function(e,t,n){return n(e.addingActiveIntent({previewPlatform:t.platform}))}(t,e,async t=>{const n=await xg(t,e)
return(0,kv.isNothing)(n.canonicalURL)&&(n.canonicalURL=Q3(t,e)),n})}actionFor(e,t){const n=new dY(JV)
return n.destination=e,n.pageUrl=Q3(t,e),n}}class e8{constructor(){this.$intentKind="SearchResultsPageMoreIntent"}async perform(e,t){return await Lg(t,e.pageToken)}}class t8 extends Y1{constructor(e,t){super("SearchResultsBuilder"),t.exportingService(f$,{fetchResults:async t=>await async function(e,t){const n=new bv.FetchTimingMetricsBuilder,r=e.addingFetchTimingMetricsBuilder(n),o=await ph(r,t)
return null===o?fg(r,t.facets):await async function(e,t){return await hg(e,t)}(r,o)}(e,t),fetchMoreResults:async t=>await async function(e,t){return await async function(e,t){return await Iv.context("paginatedSearchResultsWithToken",async()=>{const n=cg(0,t),r=lg(0,t)
return 0===n.length?await Promise.resolve(fg(e)):await hh(e,n).then(async n=>{const o=V(n)
return await ig(e,t.requestMetadata,t.responseMetadata,t.metricsOptions,o).then(e=>{const t=new cZ
return t.results=e.builtSearchResults,t.nextPage=r,t})})})}(e,t)}(e,t.pageToken),fetchSearchResultsPage:async t=>await xg(e,t),fetchMoreOfSearchResultsPage:async t=>await Lg(e,t.pageToken)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}class n8{constructor(){this.$intentKind="ArticlePageIntent"}async perform(e,t){return await t.required(G4).fetchPage(t,e.url,L1)}}class r8 extends Y1{constructor(e,t){super("ArticleBuilder"),t.exportingService(eC,{fetchArticle:async t=>await e.required(G4).fetchPage(e,t.url,L1)})}async handlePage(e,t,n,c,l){const u=new bv.FetchTimingMetricsBuilder,d=e.addingFetchTimingMetricsBuilder(u),p=JSON.parse(f(t.query,Hz.recoMetrics)),h=function(e,t,n){const r=t.pathComponents()
if(r.indexOf(RB)<0&&r.indexOf(zU)<0&&r.indexOf(tA)<0&&t.host!==Nz&&t.host!==Gz&&t.host!==jz)throw new Error(`Unable to map ${t.build()} to a media api url`)
let o
if(o=t.host===Nz?e.packageProperties.asString("spamBlockingExtensionsEditorialItemID"):t.host===Gz?e.bag.sharePlayAppsEditorialItemId:t.host===jz?e.bag.buddyOnboardingEditorialItemId:Rr(t),!a(o))throw new Error(`Unable to map ${t.build()} to a media api url`)
if(!a(o))throw new Error(`Unable to map ${t} to a media api url`)
const i=function(e,t,n){const r=new wJ(e).withIdOfType(t.id,OH).includingAdditionalPlatforms(N(e)).includingAttributes(function(e){const t=[SG,tG,Uj,eV,lH,oH,NU,yM,eN]
return e.bag.enableUpdatedAgeRatings&&t.push(zj),e.appleSilicon.isSupportEnabled&&t.push(iV),ad(e)&&t.push(Zj),t}(e)).includingRelationships([Q$]).includingRelationshipsForUpsell(!0).includingMacOSCompatibleIOSAppsWhenSupported(!0).usingCustomAttributes(Ze(e))
return(0,kv.isNothing)(n)&&r.includingAgeRestrictions(),$i(e)&&(r.enablingFeature(PV),r.includingScopedAttributes(DH,eQ),r.includingScopedRelationships(DH,[SH]),r.includingScopedRelationships(eA,[DH]),r.includingScopedAvailableIn(DH,[ak])),Ni(e)&&(r.enablingFeature(cN),r.includingScopedRelationships(Aj,[FN]),r.includingAssociateKeys(OH,[MG]),r.includingMetaKeys(zy,[Yy]),r.includingScopedAttributes(Aj,[hH,lV,R$,i_])),r}(e,Ir({...Cr(e),id:o}),n),c=t.query[Hz.editorialCardId]
s(c)&&i.withFilter("canvas:cardId",c)
const l=t.query[Hz.preview]
return Vz.has(t.host)&&(null==l?void 0:l.length)>0&&(i.addingQuery(nA,l),i.isStorePreviewRequest=!0),i.attributingTo(t.build())}(e,t,l),w=await Jn(d,h),g=await async function(e,t){return await Ra(e,t,Fa,Na)}(e,w),v=new B1
v.todayShelfRecoMetricsData=p,v.showingFallbackMediaInline=Boolean(n[Hz.showingFallbackMedia]),v.additionalData=g.additionalData
const y=f(t.query,Hz.todayCardConfig);(null==y?void 0:y.length)>0&&(v.todayCardConfig=JSON.parse(y)),v.allowUnpublishedAppEventPreviews=(0,kv.isSome)(n[Hz.preview]),v.isResilientDeepLink=e.deepLinks.hasResilientDeepLinks(),e.client.isCompanionVisionApp&&(v.clientIdentifierOverride="com.apple.visionproapp")
const A=u.measureModelConstruction(()=>function(e,t,n){return Iv.context("articlePageWithResponse",()=>{var s
const a=j(e,t)
n.metricsPageInformation=ci(e,zU,a.id,t),n.metricsLocationTracker={rootPosition:0,locationStack:[]},n.pageId=a.id
const c=new uQ(n.metricsPageInformation,n.metricsLocationTracker,n.refreshController),l=function(e,t){if(!i(t))return null
if((0,kv.isSome)(t.todayCardConfig))return t.todayCardConfig
const n={useOTDTextStyle:!1,enableFullScreenVideo:!0,enableListCardToMultiAppFallback:!1,canDisplayArcadeOfferButton:!0,isHeroCard:!1}
switch(n.clientIdentifierOverride=t.clientIdentifierOverride,n.useOTDTextStyle=!1,n.allowUnpublishedAppEventPreviews=t.allowUnpublishedAppEventPreviews,n.currentRowIndex=void 0,e.client.deviceType){case $H:n.prevailingCropCodes={defaultCrop:"en"},n.coercedCollectionTodayCardDisplayStyle=am.Grid,n.heroDisplayContext=pm.Article
break
case"tv":n.prevailingCropCodes={defaultCrop:"ek","editorialArtwork.storyCenteredStatic16x9":"SCS.ApDHXL01"},n.coercedCollectionTodayCardDisplayStyle=am.Grid,n.heroDisplayContext=pm.Article
break
case JG:n.coercedCollectionTodayCardDisplayStyle=am.River,n.prevailingCropCodes={defaultCrop:"sr","editorialArtwork.dayCard":fL}}return n}(e,n)
let u=ts(e,a,l,c)
const d=null==u?void 0:u.media;(0,kv.isNothing)(u)&&(u=null)
const p=null!==(s=null==u?void 0:u.title)&&void 0!==s?s:void 0,h=ie(a,rV)
n.crossLinkSubtitle=ms(e,a),n.clientIdentifierOverride=l.clientIdentifierOverride,kf(0,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker,targetType:XV,id:n.pageId,idType:ZV},p)
const w=function(e,t,n,r){return Iv.context("renderArticle",()=>{var o
const s=[],a=null!==(o=Ae(t,Q$))&&void 0!==o?o:[]
for(const n of a){r.module=ie(n,rI),r.subStyle=null,s.length
const o=Ua(e,n,t,r)
if(o.length>0)for(const e of o)e.title=r.titleForNextShelf,s.push(e),r.titleForNextShelf=null
r.index++,xf(r.metricsLocationTracker)}if(r.showingFallbackMediaInline&&0===s.length){const e=function(e,t){if(t instanceof IJ||t instanceof OJ){const e=new oJ(eH)
return e.items=t.lockups,e}return null}(0,n)
i(e)&&s.push(e)}return s})}(e,a,d,n),g=w[w.length-1],v=n.isResilientDeepLink||"OfferItem"===h?null:function(e,t,n){const s=Ga(0,t)
let a=null
const c=Kd(e,t,GH),l=Kd(e,t,kG)
if(c&&l&&(a=e.loc.string("ShareSheet.TitleSubtitle.Format","{title}: {subtitle}").replace(fB,c).replace(ZS,l)),!a&&c&&(a=c),!a&&l&&(a=l),!a&&s){const n=ie(s,GH),r=ie(t,uF)
switch(r){case am.GameOfTheDay:a=e.loc.string("SHARE_SHEET_GAME_OF_DAY_TITLE_FORMAT").replace(fB,n)
break
case am.AppOfTheDay:a=e.loc.string("SHARE_SHEET_APP_OF_DAY_TITLE_FORMAT").replace(fB,n)
break
default:e.console.log(`No title for article with unknown style: ${r}`)}}const u=ie(t,AH)
let d
switch(ie(t,uF)){case am.Grid:case am.List:case am.River:d=Se(e,"resource://ShareCollectionThumbnail",40,40)
break
default:d=null}const f=function(e,t,n,o,s,a){return r(a)?null:Iv.context("shareSheetDataForArticle",()=>{let r=s;(0,kv.isNothing)(r)&&(0,kv.isSome)(a)&&(r=function(e,t){const n=is(t)
{const r=vs(e,t,pm.Article,n)
if(i(r))return r}return us(e,ne(t,ls(0,n)),void 0)}(e,a))
const o=e.loc.string("ShareSheet.Story.Subtitle"),c=new Iq(a.id,t,o,r)
return new Eq(c,n,null)})}(e,a,u,0,d,t)
if(!i(f))return null
const p=function(e,t,n,r){const s=[]
if((null==t?void 0:t.length)>0){const n=As(e,t)
i(n)&&s.push(n)}if((null==n?void 0:n.length)>0){const t=As(e,n,"Copy Card Preview Link")
i(t)&&s.push(t)}if((0,kv.isSome)(r)){let t
e.featureFlags.isGSEUIEnabled(VD)&&e.featureFlags.isEnabled("open_in_story_share_sheet")&&(t=function(e,t){if(o(e))return
const n=new MW(e)
return n.title=t,new nz("com.apple.AppStore.openInGameCenterActivity",n)}(`games:///story/id${r}`,e.loc.string("ShareSheet.OpenInGameCenter.Title"))),i(t)&&s.push(t)}return s}(e,u,function(e,t,n){if((0,kv.isNothing)(t))return null
switch(e.client.buildType){case $U:case LB:const e=new oY
return e.protocol=Ez,e.host=SB,e.pathname=`/${_z.todayCardPreview}`,e.param(Hz.ids,`${t}`),e.param(Hz.isTodayFeedPreview,FV),e.param(Hz.isTodaySection,n.useOTDTextStyle?FV:v$),decodeURIComponent(e.build())
default:return null}}(e,t.id,n),t.id)
return new rz(f,p)}(e,a,l)
if(i(v)){sp(e,v,{targetType:NH,id:n.pageId,actionType:LF,pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker})
const t=function(e,t,n){if(t&&n){const e=t.items.length
if(e>0&&-1!==U1.indexOf(n)){const n=t.items[e-1]
switch(t.contentType){case XR:case sL:return n&&n.isFullWidth
default:return!0}}}return!1}(0,g,n.module),r=function(e,t,n,r){if(!i(t)||e.client.isCompanionVisionApp)return null
const o=new qY(LF,e.loc.string("SHARE_STORY"),!r,t),s=new oJ("roundedButton")
return s.items=[o],s}(e,v,0,t)
r&&w.push(r)}const y=new L1(u,w,v)
if(y.editorialStoryCard=null,y.title=null==u?void 0:u.title,y.subtitle=null==u?void 0:u.inlineDescription,function(e,t,n,r){const o=Ga(0,n)
if(o){const i=It(0,n)
return void(t.footerLockup=function(e,t,n,r){return Du(e,t,{offerStyle:ja(e),metricsOptions:{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},clientIdentifierOverride:n.clientIdentifierOverride,externalDeepLinkUrl:r,crossLinkSubtitle:n.crossLinkSubtitle,artworkUseCase:0,canDisplayArcadeOfferButton:of(0,eH)})}(e,o,r,i))}const s=ae(n,eD)
if(i(r.additionalData)&&s){const o=mp(e,n)
t.arcadeFooterLockup=function(e,t,n){return Bu(e,t,{pageInformation:n.metricsPageInformation,locationTracker:n.metricsLocationTracker},pe(zU),pV,null)}(e,o,r)}}(e,y,a,n),y.shouldTerminateOnClose=n.isResilientDeepLink,ui(e,y,n.metricsPageInformation,e=>{let t=p
if((null==u?void 0:u.media)instanceof PJ&&(null==u?void 0:u.overlay)instanceof MJ&&(t=(null==u?void 0:u.overlay).lockup.title),!t)return
let n=f(m(e[uB]),gV)
n=n||f(m(e[rU])),e[uB]=n?`${n}_${t}`:`unknown_${t}`}),y.canonicalURL=ie(a,AH),(0,kv.isSome)(a)){const e=ie(a,AH);(0,kv.isSome)(e)&&(y.viewArticleAction=new MW(e,!0))}return y})}(d,g.originalData,v)),T=Y1.createFlowAction(A,XV,t)
{const e=new xW(PH)
return e.actions=[T],e}}pageRoute(e){return[{protocol:Ez,path:`/{countryCode}/${_z.editorialItem}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/{countryCode}/${_z.editorialItem}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/{countryCode}/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/{countryCode}/{platform}/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/{countryCode}/${_z.story}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/${_z.story}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/${_z.story}/{seoSlug}/{id}`,query:[`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:`/${_z.store}/${_z.viewEditorialItem}`,query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:"WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,path:"{apiVersion}/editorial/{countryCode}/editorial-items/{seoSlug}/{id}",query:[Hz.id,`${Hz.showingFallbackMedia}?`,`${Hz.preview}?`,`${Hz.todayCardConfig}?`]},{protocol:Ez,hostName:`${Nz}`},{protocol:Oz,path:`/${_z.story}/{id}`,query:[`${Hz.metrics}?`,`${Hz.invalidateWidgetsOnFailure}?`]},{protocol:Ez,hostName:`${Gz}`},{protocol:Ez,hostName:`${jz}`}]}pageType(){return XV}}Pm=e(1415),function(e){e.OnboardingCards="onboardingCards",e.Ads="ads",e.ODP="ODP",e.AMDData="amdData"}(Im||(Im={}))
class o8 extends Y1{constructor(){super("TodayCardPreviewBuilder")}pageType(){return PH}pageRoute(e){return[{protocol:Ez,path:`/${_z.todayCardPreview}`,query:[`${Hz.ids}?`,`${Hz.isTodaySection}?`,`${Hz.isTodayFeedPreview}?`,`${Hz.preview}?`,`${Hz.experimentId}?`,`${Hz.fetchData}?`]}]}async handlePage(e,t,n,r,i){return await rc(`${this.builderClass}.pageHandler`,async()=>{var r
const i=new dY(this.pageType())
if(i.pageUrl=t.build(),!v(n[Hz.fetchData]))return i
const a=null===(r=n[Hz.experimentId])||void 0===r?void 0:r.split(","),c=n[Hz.ids]
if(s(a)&&o(c)){const t={}
for(const e of a){const n=e.split(":")[0],r=e.split(":")[1]
t[n]=r}const n=s(t)?JSON.stringify(t):void 0,r=await Ng(e,{experimentIdHeader:n,url:"",onboardingCardIds:[]})
return i.pageData=r,i}{const n=Bg(e,this.createFlattenedTodayItemsFromUrl(t),o8.emptyTodayPageResponse,null,null)
return i.pageData=n,i}})}createFlattenedTodayItemsFromUrl(e){const t=[],n=f(e.query[Hz.ids]),r=(0,kv.isSome)(e.query[Hz.isTodayFeedPreview])&&v(e.query[Hz.isTodayFeedPreview]),o=(0,kv.isSome)(e.query[Hz.isTodaySection])&&v(e.query[Hz.isTodaySection])
if(!s(n))return t
const i=n.match(/([a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?:\[[^\]]+\]|[a-zA-Z0-9]+(?:_[a-zA-Z0-9]+)?)/g)
let a=r,c=0
for(const e of i){const n=e.split(":")[0],r=o8.storyGroupIdRegex.exec(e)
if((0,kv.isSome)(r)){const e=r[1].split(",").map(e=>this.createUnhydratedEditorialItemFromId(e,o))
t.push({type:wm.EditorialItemGroup,data:{id:n,type:sG,relationships:{},meta:{associations:{recommendations:{data:e}}}},isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...o8.previewModuleData},containedAdSlots:Array.from({length:e.length},(e,t)=>t+c)}),a=!1,c+=e.length}else t.push({type:wm.EditorialItem,data:this.createUnhydratedEditorialItemFromId(e,o),isDataHydrated:!1,isFirstItemInModule:a,moduleMetadata:{...o8.previewModuleData},containedAdSlots:[c]}),a=!1,c+=1}return t}createUnhydratedEditorialItemFromId(e,t){const n=e.split(":")[0],r=e.split(":")[1],o=(0,kv.isSome)(r)?{"editorial-cards":{data:[{id:`${n}-${r}`,type:MG}]}}:{}
return{id:n,type:OH,relationships:{},meta:{personalizationData:{isOfTheDay:t},associations:o}}}}o8.storyGroupIdRegex=/\[(.*)\]/,o8.previewModuleData={label:tC,title:"Today Preview",meta:{},isTodayForAppsModule:!1},o8.emptyTodayPageResponse={results:{data:[]}}
class i8{constructor(){this.$intentKind="TodayPageIntent"}async perform(e,t){const n=e.isRunningPPTs?JSON.stringify({NyCxKBD:"client-perf"}):void 0
return await Ng(t,{url:e.url,onboardingCardIds:e.onboardingCardIds,experimentIdHeader:n})}}class s8{constructor(){this.$intentKind="TodayPageMoreIntent"}async perform(e,t){const n=e.pageToken
return Hg(t,n.pageInformation),await Gg(t,n),Ug(t,n)}}class a8 extends Y1{constructor(e,t){super("TodayPageBuilder"),t.exportingService(eC,{fetchPage:async t=>await Ng(e,{url:t.url,onboardingCardIds:t.onboardingCardIds}),async fetchMoreOfPage(t){const n=t.pageToken
return Hg(e,n.pageInformation),await Gg(e,n),Ug(e,n)}})}defaultTab(e){return PH}pageType(){return PH}pageRoute(e){return[]}async handlePage(e,t,n,r,o){throw new Error("handlePage not implemented for TodayBuilder")}}class c8 extends hq{constructor(e,t,n,r){super(),this.shortName=e,this.longName=t,this.chart=n,this.shelves=r,this.nextPage=null,this.pageMetrics=new EW,this.pageRenderMetrics={}}}class l8 extends DZ{constructor(e,t,n){super(e.name,e.genreId,e.artwork,e.ageBandId,n),this.shortName=this.name,this.longName=this.name,this.url=t}}class u8 extends hq{constructor(e,t,n,r,o,i){super(),this.genreId=e,this.ageBandId=t,this.title=n,this.segments=r,this.categoriesButtonTitle=o,this.categories=i,this.initialSegmentIndex=0}}class d8{constructor(){this.$intentKind="TopChartsPageIntent"}async perform(e,t){return await Jg(t,e.url)}}class f8{constructor(){this.$intentKind="TopChartsPageMoreIntent"}async perform(e,t){return await Kg(t,e.pageToken)}}class p8 extends Y1{constructor(e,t){super("TopChartsBuilder"),t.exportingService("TopChartData",{fetchPage:async t=>await Jg(e,t.url),fetchMoreOfSegment:async t=>await Kg(e,t.pageToken)})}pageRoute(e){return Zg()}async handlePage(e,t,n,i,a){const c=n[Hz.isPPT]
t.removeParam(Hz.isPPT)
let l=t.query[Hz.chart],u=n[Hz.genre]
o(u)&&(u=f(e.bag.defaultChart,"genre-id"),o(l)&&(l=f(e.bag.defaultChart,"chart-id")))
let d=n[Hz.charts]
if(o(d)){const e=dc(0,l)
d=void 0!==e?`${l},${e}`:l}else d.includes(l)||(d+=`,${l}`)
const p=fc(e,u,d,n[Hz.ages])
let h
h=pc(e,d,u)
const[w,g]=await Promise.all([p,h]),v=Wn(e,g)
let m,y
if(m=Wg(e,w,u,v,l,r(v)?Vn(u):Hn(v)),y=HB,c&&s(m.segments)){const t=m.segments[0],n=t.nextPage,r=bt(0,n)
if(s(r)){const o=new wJ(e,r),i=await Jn(e,o),s=St(0,n)
s.remainingContent=[],s.maxPerPage=0
const a=Qg(e,i,n,s),c=t.shelves.concat(a.shelves),l=new c8(t.shortName,t.longName,t.chart,c)
l.pageMetrics=t.pageMetrics,l.nextPage=null,m.segments[0]=l}}return Y1.createFlowAction(m,y,t)}pageType(){return HB}async handlePagination(e,t,n,r,o){return await rc(`${this.builderClass}.handlePagination`,async()=>function(e){var t,n
const r=new lJ(e.shelves)
return r.title=null!==(t=e.longName)&&void 0!==t?t:e.shortName,r.pageMetrics=e.pageMetrics,r.pageRenderMetrics=e.pageRenderMetrics,s(null===(n=null==e?void 0:e.nextPage)||void 0===n?void 0:n.remainingContent)&&(r.nextPage=e.nextPage),r}(await Kg(e,o)))}}class h8 extends hq{constructor(e,t,n,r){super(),this.collections=e,this.refreshDate=t,this.originalResponseDate=n,this.originalResponseHash=r}}class w8 extends hq{constructor(e,t){super(),this.cards=e,this.displayDate=t}}class g8 extends hq{constructor(e,t,n,r,o,i,s,a,c,l,u,d){super(),this.storyId=e,this.heading=t,this.title=n,this.backgroundColor=r,this.isDark=o,this.iconArtwork=i,this.url=s,this.eventBadgeKind=l,this.editorialArtwork=c,this.isVideoArtwork=a,this.eventStartDate=u,this.eventEndDate=d}}class v8{make(e){const t=new wJ(e).forType(this.typeForUseCase()).withIdsOfType(this.ids(),this.typeForUseCase()).addingContext(this.context()).includingAttributes(this.attributesForUseCase()).asPartialResponseLimitedToFields(this.fieldsForRequest()).withSparseCount(this.sparseCountForUseCase()).withSparseLimit(this.sparseLimitForUseCase()).enablingFeature(this.enablingFeature(e)).usingCustomAttributes(this.shouldUseCustomAttributes(e)),n=this.addingQuery()
if(null!==n)for(const e of n)t.addingQuery(e.key,e.value)
return t}}class m8 extends v8{context(){return QO}typeForUseCase(){return PH}attributesForUseCase(){return[lH,oH,eV]}sparseCountForUseCase(){return null}sparseLimitForUseCase(){return null}addingQuery(){return null}ids(){return[]}fieldsForRequest(){return[NR,_H,HL,uF,Wk,tV,ob,lH,JT,rj,oH,VL,"id",UN,rV,CV,uH,eV,GH,zk,jL]}enablingFeature(e){return $i(e)?PV:null}shouldUseCustomAttributes(e){return Ze(e)}}class y8{constructor(){this.$intentKind="WidgetIntent"}async perform(e,t){const n=e.widgetKind
if(n===TI)return await cv(t,e)
throw Error(`Invalid widgetKind of '${n}'`)}}class A8 extends Y1{constructor(e,t){super("WidgetController"),t.exportingService("WidgetData",{fetchTodayWidget:async t=>await cv(e,t)})}async handlePage(e,t,n,r,o){throw new Error(YG)}pageRoute(e){return[]}pageType(){return TH}}Cm=e(5881)
class T8{constructor(){this.dispatcher=new Cm.IntentDispatcher}register(e){this.dispatcher.register(e)}async dispatch(e,t){const n=await this.createIntentObjectGraphWithAsyncValues(t)
return await this.dispatcher.dispatch(e,n)}controller(e){return this.dispatcher.controller(e)}get registeredControllers(){return this.dispatcher.registeredControllers}async createIntentObjectGraphWithAsyncValues(e){const t=new dW,n=new wW,r=new wW(hW)
let o
if(e instanceof bW){let i=e
i=i.addingBag(i.bag.underlyingBag),await t.loadTreatments(i),await n.loadValues(i,[xv.client,xv.user]),e.bag.personalizationUserIdEnabled&&await r.loadValues(e,[xv.user]),i.clientCapabilities.isEnabled(rE)&&i.bag.metricsPaymentNamespaceEnabled&&(o=new wW(fW),await o.loadValues(i,[xv.client,xv.user])),e=i}return e.adding(dW.metatype,t).adding(wW.defaultMetatype,n).adding(wW.paymentMetatype,o||n).adding(wW.personalizationMetatype,r)}}class b8 extends Av.LegacyRuntime{constructor(e,t){super(e,t,{})}exportingService(e,t){this.wrapServiceInValidation(t)
const n={...this.serviceWithName(e)||{},...t}
return super.exportingService(e,n)}exportingServiceName(e,t,n){const r={}
r[t]=n,this.exportingService(e,r)}wrapServiceInValidation(e){for(const t of Object.keys(e)){const n=e[t]
n instanceof Function&&(e[t]=function(...e){const t=n.apply(this,e)
return t instanceof Promise?t.then(e=>(Iv.recordValidationIncidents(e),e)):(Iv.recordValidationIncidents(t),t)})}}}!function(e){e.Control="Tf5Kjqz00",e.LayoutA="Tf5Kjqz01",e.LayoutB="Tf5Kjqz02"}(km||(km={}))
class S8{constructor(){this.$intentKind="ArcadeDownloadPackCategoriesPageIntent",this.maxNumberOfCategoriesToChoose=4}async perform(e,t){return await this.fetchDownloadPackPage(t,we(e.subscriptionStatus))}async fetchDownloadPackPage(e,t){const n=new lz
n.title=e.loc.string("Arcade.DownloadPack.CategorySelection.PrimaryButtonTitle")
const r=new lz
r.title=e.loc.string("Arcade.DownloadPack.CategorySelection.SecondaryButtonTitle")
const o=await this.fetchCategories(e),i=new tK(e.loc.string(t===_C?"Arcade.DownloadPack.CategorySelection.Title.CurrentUser":"Arcade.DownloadPack.CategorySelection.Title"),o,this.maxNumberOfCategoriesToChoose,"Arcade.DownloadPack.CategorySelection.MaxCount","Arcade.DownloadPack.CategorySelection.Selected.Full",n,r),s=new XX({pageId:"SelectCategories",pageType:DI}),a={rootPosition:0,locationStack:[]}
return e.bag.arcadeDownloadPacksMetricsEventsEnabled&&(n.actionMetrics.addMetricsData(Zf(e,"Ok",NH,{actionType:UH})),r.actionMetrics.addMetricsData(Zf(e,"Skip",NH,{actionType:DU})),o.forEach(t=>{t.selectActionMetrics.addMetricsData(Zf(e,t.id,TU,{actionType:QM})),t.deselectActionMetrics.addMetricsData(Zf(e,t.id,TU,{actionType:"remove"}))}),ui(e,i,s)),e.bag.arcadeDownloadPacksImpressionEventsEnabled&&o.forEach(t=>{const n={id:t.id,idType:ZV,kind:NH,locationTracker:a,pageInformation:s,softwareType:HV,targetType:TU,title:t.title}
Bf(e,t,n),xf(a)}),i}async fetchCategories(e){const t=e.bag.arcadeDownloadPackCategoriesCollectionId,n=new wJ(e).withIdOfType(t,cj).addingQuery(_I,vI).includingAdditionalPlatforms(N(e))
return await Jn(e,n).then(t=>this.categoriesFromResponse(e,t))}categoriesFromResponse(e,t){return Iv.context("categoriesFromResponse",()=>{const n=V(t),r=[]
for(const t of n){const n=t.id,o=Zd(e,t,GH),i=h(Be(e,t,lH),$O)
if((0,kv.isNothing)(i))continue
const s=nd(e,i,{useCase:20}),a=Ue(e,t,"editorialBackground.stops").map(e=>z(f(e,ej))).filter(e=>(0,kv.isSome)(e))
if(0===a.length){e.console.log(`Empty gradient for category: ${n}`)
continue}const c=a[0],l=1===a.length?a[0]:a[1],u=new eK(n,o,s,c,l)
r.push(u)}return r.sort((t,n)=>{try{return t.title.localeCompare(n.title,e.loc.safeIdentifier,{usage:Ij})}catch(e){return 0}})})}}class P8{constructor(){this.$intentKind="ArcadeDownloadPackSuggestionsPageIntent",this.maxGamesCount=4}async perform(e,t){const n={rootPosition:0,locationStack:[]},r=new XX({pageId:"DownloadStarterPack",pageType:DI})
return await this.fetchSuggestedGames(t,e.categories,this.maxGamesCount,r,n).then(o=>this.createSuggestionsPage(o,t,we(e.subscriptionStatus),r,n))}async fetchSuggestedGames(e,t,n,r,o){const i=new wJ(e).forType(u_).addingQuery("include[personal-recommendations]",FH).addingQuery("associate[apps]",AG).addingQuery("limit[personal-recommendations:contents]",`${n}`).addingQuery("omit[resource:apps]","autos").addingQuery("sparseLimit[apps:association.category]","0").addingQuery("sparseLimit[personal-recommendations:contents]",`${n}`).addingQuery(EV,"arcade-onboarding").includingAdditionalPlatforms(N(e)),s=this.fetchOptions(t,OH)
return await Jn(e,i,s).then(n=>this.suggestionFromResponse(e,t,n,r,o))}suggestionFromResponse(e,t,n,r,o){return Iv.context("suggestionFromResponse",()=>{const i={}
for(const e of t)i[e.id]=e
const s=V(ve(j(e,n),FH)),a=[]
for(const t of s){const n=l(t.meta,"associations.category.data")[0].id,s=Du(e,t,{offerStyle:QU,offerEnvironment:mH,metricsOptions:{pageInformation:r,locationTracker:o,badges:{categoryId:n}},metricsClickOptions:{id:t.id,pageInformation:r,locationTracker:o,badges:{categoryId:n}},artworkUseCase:1,isSubtitleHidden:!0});(0,kv.isNothing)(s)||(s.heading=i[n].title,xf(o),ed(s,e),a.push(new nK(s,n)))}return a})}createSuggestionsPage(e,t,n,r,o){const i=e.map(e=>this.offerAction(e.lockup.buttonAction)).filter(e=>(0,kv.isSome)(e)),s=new qW(i)
s.title=function(e){switch(lv(e)){case km.Control:return e.loc.string(nC)
case km.LayoutA:case km.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.DownloadAllButtonTitle")
default:return e.loc.string(nC)}}(t)
const a=i.map(e=>e.adamId),c=new lz
c.title=function(e){switch(lv(e)){case km.Control:return e.loc.string(TD)
case km.LayoutA:case km.LayoutB:return e.loc.string("Arcade.DownloadPack.Suggestions.NotNowButtonTitle")
default:return e.loc.string(TD)}}(t)
const l=new rK(t.loc.string(n===kF?"Arcade.DownloadPack.Suggestions.Title.NewUser":"Arcade.DownloadPack.Suggestions.Title"),e,s,function(e){switch(lv(e)){case km.Control:return AD
case km.LayoutA:return"withinLockups"
case km.LayoutB:default:return AD}}(t),c,function(e){switch(lv(e)){case km.Control:case km.LayoutA:return yD
case km.LayoutB:return"getAll"
default:return yD}}(t),function(e){switch(lv(e)){case km.Control:return null
case km.LayoutA:case km.LayoutB:return e.loc.string(TD)
default:return null}}(t))
return t.bag.arcadeDownloadPacksMetricsEventsEnabled&&(sp(t,s,{id:"GetAll",actionType:eM,subjectIds:a,actionDetails:{subjectIds:a},pageInformation:r,locationTracker:o,targetType:NH}),c.actionMetrics.addMetricsData(Zf(t,"Done",NH,{actionType:UH})),ui(t,l,r)),l}offerAction(e){return e instanceof FW?e:e instanceof jW?e.defaultAction instanceof FW?e.defaultAction:e.buyAction instanceof FW?e.buyAction:null:null}fetchOptions(e,t){const n={selected:e.map(e=>({id:e.id,type:t}))}
return{method:zB,headers:{"Content-Type":nO},requestBodyString:JSON.stringify(n)}}}class I8 extends Y1{constructor(e,t){super("ArcadeDownloadPackBuilder")}pageRoute(e){return Rt(e,e.bag.arcadeDownloadPackRolloutRate)?[{hostName:"arcadeDownloadPack",query:[`${Hz.arcadeSubscriptionStatus}?`]}]:[]}async handlePage(e,t,n,r,o){const i=new dY(WF),s=f(n,Hz.arcadeSubscriptionStatus)
return i.pageData=we(s),i}pageType(){return WF}}class C8 extends J1{constructor(){super("EditorialShelfRecommendationPageController")}defaultPlatforms(e){return N(e)}defaultAttributes(e){const t=[lH,oH,Nj,Uj,nj,ZB,JN,Kj]
return e.appleSilicon.isSupportEnabled&&t.push(iV),t}pageType(){return jH}pageRoute(e){return[{protocol:Ez,path:`WebObjects/MZStorePlatform.woa/ra/{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]},{protocol:Ez,path:`{apiVersion}/{realm}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]},{protocol:Ez,path:`{apiVersion}/editorial/{countryCode}/editorial-shelves-recommendation/{${Hz.shelfId}}`,query:[`${Hz.editorialPageId}?`]}]}generatePageRequest(e,t,n){const r=n[Hz.shelfId],o=n[Hz.editorialPageId]
if((0,kv.isNothing)(r)||0===r.length||(0,kv.isNothing)(o)||0===o.length)throw new Error(`Unable to map ${t.build()} to a media api url`)
const i=new wJ(e,t.toString())
return i.addingQuery(Hz.editorialPageId,o),i}prepareRequest(e,t,n,r,o){super.prepareRequest(e,t,n,r,o),t.includingRelationships([FH]),nw(e,t)}async renderPage(e,t,n,r,o,i){return await rc("renderEditorialShelfRecommendationPage",async()=>{const n=j(e,t)
if(!s(n))return null
const r=ci(e,uV,n.id,t),o=tr(t),i=(mn(0,n),Qh(e,void 0,n,!1,0,r,{rootPosition:0,locationStack:[]},!1,null)),a=Gh(e,void 0,i)
let c
a.title=null,a.eyebrow=null,a.isHorizontal=!1,c=new qq(null,ie(n,xG),ie(n,LG))
const l=new oJ(U_)
l.id=yO,l.items=[c]
const u=new lJ([l,a])
return u.pageRefreshPolicy=rr(e,o),ui(e,u,r),u})}}(0,Av.exportBootstrap)(function(e){const[t,n]=function(){const e=new j4,t=function(e,t,n){var r,o
const i=function(e,t,n,r,o,i,s,a,c,l,u,d,f,p,h,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,x,L,M,$,F){return e.configureDefaults(n,r,o,i,s,a,c,l,u,d,f,p,h,w,g,v,m,y,A,T,b,S,P,I,C,k,O,E,R,D,_,x,L,M,$,F).adding(G4,t)}(new bW("app-store"),e,bag,cryptography,host,net,platform,plist,random,services,cookieProvider,console,ask.storeMetrics,ask.amsEngagement,ask.loc,ask.adsLoc,ask.device,ask.client,ask.props,ask.user,ask.player,ask.metricsIdentifiers,ask.clientOrdering,ask.arcade,ask.gameCenter,ask.resilientDeepLinks,ask.appleSilicon,ask.storage,ask.ads,ask.onDeviceRecommendationsManager,ask.onDeviceSearchHistoryManager,null!==(r=ask.featureFlags)&&void 0!==r?r:{isEnabled:()=>!1,isGSEUIEnabled:()=>!1},null!==(o=ask.clientCapabilities)&&void 0!==o?o:{isEnabled:()=>!1},mediaToken,ask.appDistribution,ask.timeoutManager,ask.treatmentStore,ask.userDefaults)
return SW.createSharedMetricsReferralContext(i),i}(e),n=new T8,r=new b8(n,t)
return function(e,t){const n=e.required(G4)
t.exportingService(Gy,{fetchGeneric:async t=>await n.fetchPage(e,t.url,lJ),fetchMoreOfGeneric:async t=>await n.fetchMoreOfPage(e,t.pageToken),fetchShelves:async t=>await n.fetchShelves(e,t.requests),fetchAction:async t=>await Fp(e,t)})}(t,r),e.registerPageBuilder(t,new a8(t,r)),e.registerPageBuilder(t,new r8(t,r)),e.registerPageBuilder(t,new o8),e.registerPageBuilder(t,new p8(t,r)),e.registerShelfBuilder(t,new y1),e.registerShelfBuilder(t,new A1),e.registerShelfBuilder(t,new T1),e.registerShelfBuilder(t,new c2),e.registerShelfBuilder(t,new S1),e.registerShelfBuilder(t,new b1),e.registerShelfBuilder(t,new P1),e.registerShelfBuilder(t,new I1),e.registerShelfBuilder(t,new C1),e.registerShelfBuilder(t,new O1),e.registerShelfBuilder(t,new k1),e.registerShelfBuilder(t,new E1),e.registerShelfBuilder(t,new R1),e.registerShelfBuilder(t,new G1),e.registerShelfBuilder(t,new j1),e.registerShelfBuilder(t,new V1),e.registerShelfBuilder(t,new H1),e.registerShelfBuilder(t,new o2),e.registerShelfBuilder(t,new i2),e.registerShelfBuilder(t,new s2),e.registerPageBuilder(t,new s3),e.registerPageBuilder(t,new r6(t,r)),e.registerPageBuilder(t,new Z5(t,r)),e.registerPageBuilder(t,new u6(t,r)),e.registerPageBuilder(t,new A5),e.registerPageBuilder(t,new X5(t,r)),e.registerPageBuilder(t,new a6(t,r)),e.registerPageBuilder(t,new c6),e.registerPageBuilder(t,new y5),e.registerPageBuilder(t,new I8(t,r)),e.registerShelfBuilder(t,new a2),e.registerPageBuilder(t,new W6),e.registerPageBuilder(t,new Q6),e.registerPageBuilder(t,new C8),e.registerPageBuilder(t,new i3),e.registerPageBuilder(t,new I3),e.registerPageBuilder(t,new D3),e.registerPageBuilder(t,new _3),e.registerPageBuilder(t,new S3(t,r)),e.registerPageBuilder(t,new T3),e.registerPageBuilder(t,new x3),e.registerPageBuilder(t,new L3),e.registerPageBuilder(t,new m3),e.registerPageBuilder(t,new v3),e.registerPageBuilder(t,new y3),e.registerPageBuilder(t,new A3),e.registerPageBuilder(t,new K3),e.registerPageBuilder(t,new U3(t,r)),e.registerPageBuilder(t,new t8(t,r)),e.registerPageBuilder(t,new Y3(t,r)),e.registerPageBuilder(t,new V6),e.registerPageBuilder(t,new H6),e.registerPageBuilder(t,new q6),e.registerPageBuilder(t,new i5(t,r)),e.registerPageBuilder(t,new d5(t,r)),e.registerPageBuilder(t,new s5),e.registerPageBuilder(t,new g5),e.registerPageBuilder(t,new a5),e.registerPageBuilder(t,new w5),e.registerPageBuilder(t,new f5),e.registerPageBuilder(t,new p5),e.registerPageBuilder(t,new h5),e.registerPageBuilder(t,new L6),e.registerPageBuilder(t,new M6),e.registerPageBuilder(t,new E6),e.registerPageBuilder(t,new R6),e.registerPageBuilder(t,new T6),e.registerPageBuilder(t,new D6),e.registerPageBuilder(t,new $6),e.registerPageBuilder(t,new b6),e.registerPageBuilder(t,new k6),e.registerPageBuilder(t,new _6),e.registerPageBuilder(t,new O6),e.registerPageBuilder(t,new x6),e.registerPageBuilder(t,new h3(t,r)),e.registerPageBuilder(t,new c3(t,r)),e.registerPageBuilder(t,new N3),e.registerPageBuilder(t,new F3),e.registerPageBuilder(t,new M3),e.registerPageBuilder(t,new $3),e.registerPageBuilder(t,new o3(t,r)),e.registerPageBuilder(t,new A8(t,r)),e.registerPageBuilder(t,new m5(t,r)),e.registerPageBuilder(t,new l3(t,r)),e.registerPageBuilder(t,new h6(t,r)),e.registerPageBuilder(t,new m6(t,r)),e.registerPageBuilder(t,new f6(t,r)),e.registerPageBuilder(t,new g3(t,r)),e.registerPageBuilder(t,new A6(t,r)),[n,r]}()
return t.register(new o5),t.register(new W4),t.register(new Y4),t.register(new n6),t.register(new J5),t.register(new K5),t.register(new Q5),t.register(new d6),t.register(new l6),t.register(new s6),t.register(new S8),t.register(new P8),t.register(new n8),t.register(new r3),t.register(new v6),t.register(new w3),t.register(new n3),t.register(new l5),t.register(new V4),t.register(new H4),t.register(new y6),t.register(new a3),t.register(new z4),t.register(new p3),t.register(new f3),t.register(new u5),t.register(new p6),t.register(new w6),t.register(new g6),t.register(new z3),t.register(new X3),t.register(new e8),t.register(new B3),t.register(new b3),t.register(new q4),t.register(new i8),t.register(new s8),t.register(new d8),t.register(new f8),t.register(new v5),t.register(new y8),n})})()})()

//# sourceMappingURL=main.js.map